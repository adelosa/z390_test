       IDENTIFICATION DIVISION.
       PROGRAM-ID.    TESTFUN1.
       AUTHOR.        DON HIGGINS.
       DATE-WRITTEN.  10/13/08.
      * TEST FUNCTIONS - LENGTH OF, ADDRESS OF                              
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       77 PTR-1   USAGE POINTER.    
       77 PTR-2   USAGE POINTER.           
       77 PTR-3   USAGE POINTER.           
       77 W1      PIC 9(9) COMP VALUE 0.           
       77 ERRORS  COMP-3 PIC 9(4)   VALUE 0.
       77 TESTS   COMP-3 PIC 9(4)   VALUE 0.
       77 ADDR-1  PIC X(20).
       77 ADDR-2  PIC X(20).
       77 TP1     COMP-3 PIC S9.
       77 TP2     COMP-3 PIC S9.
       77 TZ1     PIC S9.
       77 TZ2     PIC S99.
       77 TX3     PIC X(3).
       77 TRM1    PIC X(3) VALUE 'ABC'.
       PROCEDURE DIVISION.
       MAINLINE.
           DISPLAY 'TESTFUN1 FUNCTIONS STARTING'
           NOTE TEST COMMENT SENTENCE
           DISPLAY 'TEST LENGTH OF'
           MOVE LENGTH OF PTR-1 TO W1
            IF W1 = 4 ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           DISPLAY 'TEST ADDRESS OF'
           MOVE ADDRESS OF ADDR-1 TO PTR-1
           MOVE ADDRESS OF ADDR-2 TO PTR-2
           SUBTRACT PTR-1 FROM PTR-2
            IF PTR-2 = 20 ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           DISPLAY 'TEST NUMERIC'
           MOVE 1 TO TP1
            IF TP1 = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE SPACES TO TP1
            IF TP1 NOT = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE LOW-VALUES TO TP1
            IF TP1 NOT = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE HIGH-VALUES TO TP1
            IF TP1 NOT = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE 123 TO TP2
            IF TP2 = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE SPACES TO TP2
            IF TP2 NOT = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE 1 TO TZ1
            IF TZ1 = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE SPACES TO TZ1
            IF TZ1 NOT = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE -12 TO TZ2
            IF TZ2 = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE SPACES TO TZ2
            IF TZ2 NOT = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE '123' TO TX3
            IF TX3 = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE SPACES TO TX3
            IF TX3 NOT = NUMERIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE 'ABC' TO TX3
            IF TX3 = ALPHABETIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           MOVE SPACES TO TX3
           IF TX3 NOT = ALPHABETIC ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           TRANSFORM TRM1 CHARACTERS FROM 'CBA' TO '321'
           IF TRM1 = '123' ADD 1 TO TESTS ELSE ADD 1 TO ERRORS.
           DISPLAY 'TOTAL TESTS  =' TESTS
           DISPLAY 'TOTAL ERRORS =' ERRORS
           IF ERRORS > 0  
              MOVE 16 TO RETURN-CODE
           ELSE
              DISPLAY 'TESTFUN1 ENDED OK'
           END-IF
           STOP RUN.
