*%/*                                                                    00050052
         MACRO                                                          00100052
&NAME    SDUMP &HDR=,&HDRAD=,&DCB=,&ASID=,&ASIDLST=,&ECB=,&SDATA=,     X00150052
               &STORAGE=,&LIST=,&SUMLIST=,&BUFFER=,&QUIESCE=,&BRANCH=, X00200052
               &LISTA=,&TYPE=,&SUMLSTA=,&SUSPEND=,&SUBPLST=,&KEYLIST=, X00250052
               &MF=,&SRB=,                                         @L4CX00300052
               &ID=,&IDAD=,&SYMREC=,&PSWREGS=,&PLISTVER=           @T1C 00350052
.********************************************************************** 00400052
.*   MACRO NAME = SDUMP                                               * 00450052
.*                                                                    * 00500052
.*   DESCRIPTIVE NAME = SDUMP EXECUTABLE MACRO                        * 00550052
.*                                                                    * 00600052
.*   COPYRIGHT =                                                      * 00650052
.*               LICENSED MATERIALS - PROPERTY OF IBM                 * 00700052
.*               THIS MACRO IS "RESTRICTED MATERIALS OF IBM"          * 00750052
.*               5695-047 (C) COPYRIGHT IBM CORP 1980, 1990           * 00800052
.*               SEE COPYRIGHT INSTRUCTIONS                           * 00850052
.*                                                                    * 00900052
.*   STATUS = HBB4420                                                 * 00950052
.*                                                                    * 01000052
.*   FUNCTION = PROVIDES THE INTERFACE BETWEEN THE CALLER AND SVC     * 01050052
.*              DUMP.  LIST AND EXECUTE FORMS EXIST TO GENERATE       * 01100052
.*              THE SDUMP PARAMETER LIST AND PROPER LINKAGE TO THE    * 01150052
.*              SVC DUMP SERVICE.                                     * 01200052
.*                                                                    * 01250052
.*   NOTES = THE PARAMETER LIST GENERATED BY THE STANDARD AND LIST    * 01300052
.*           FORMS OF THIS MACRO IS AT LEAST 40 BYTES IN LENGTH.      * 01350052
.*           IF ANY OF THE NEW JBB1226 PARAMETERS ARE SPECIFIED, THE  * 01400052
.*           PARAMETER LIST LENGTH IS 48 BYTES.                       * 01450052
.*           IF ANY OF THE NEW HBB2102 PARAMETERS ARE SPECIFIED,      * 01500052
.*           THE PARAMETER LIST LENGTH IS 68 BYTES.                   * 01550052
.*                                                                    * 01600052
.*           IF MDUMP OPTIONS ARE SPECIFIED, THE PARAMETER LIST       * 01650052
.*             IS 128 BYTES.                                          * 01700052
.*           IF SDUMPX IS INVOKED, THE PARAMETER LIST IS 112 BYTES.   * 01750052
.*              (OR 128 IF MDUMP OPTIONS ARE SPECIFIED).              * 01800052
.*                                                                    * 01850052
.*   CHANGE ACTIVITY = FIX PROBLEM WITH ECB OPTION 6/22/79    @ZMB0025* 01900052
.*                     OS/VS2 JBB1226:                        @G383P1U* 01950052
.*                     1. SUPPORT FOR NEW KEYWORDS:                   * 02000052
.*                        LISTA,SUMLSTA,TYPE=XMEM             @G383P1U* 02050052
.*                     2. SUPPORT FOR NEW KEYWORD                     * 02100052
.*                        SUSPEND= YES OR NO                          * 02150052
.*                        SUPPORT FOR SDUMP EXITS             @G386P31* 02200052
.*                     3. SUPPORT FOR NEW KEYWORD: TYPE=XMEME @G38AP31* 02250052
.*                     APAR OZ51194 - MF=(E,(1)) ON EXECUTE   @ZA51194* 02300052
.*                        FORM WITH NO OTHER PARAMETERS       @ZA51194* 02350052
.*                        GENERATES AN OR IMMEDIATE.          @ZA51194* 02400052
.*                     OS/VS2 JBB1326:                            @L1A* 02450052
.*                     @L1= RAS JBB1326 810130 PD31:PAGE PROTECT  @L1A* 02500052
.*                     OS/VS2 HBB2102:                        @G860P31* 02550052
.*                     1. SUPPORT ALLNUC, SUBPLST, KEYLIST            * 02600052
.*                     2. ADD RESERVED FIELDS FOR SLIP AND SYSMDUMP   * 02650052
.*                     3. ADD BLOCK COMMENTS TO AID DEBUGGING         * 02700052
.*                     4. SUPPORT SPLEVEL                     @G860P1X* 02750052
.*                     5. ADD TYPE=NOLOCAL PARAMETER TO PREVENT       * 02800052
.*                        SDUMP FROM OBTAINING A LOCAL LOCK.  @ZMC2707* 02850052
.*  FLAG  REASON  RELEASE   DATA  ORIGIN                          @L2A* 02900052
.*  $L2=  RASENH  JBB2220  841119  PD2F: SUPPORT TYPE=FAILRC      @L2A* 02950052
.*  $L3=    AR    HBB3310  850920  PDXB: AR                           * 03000052
.*  $L4=  RTMRAS  HBB3310  860728  PDA8: SLIP SYNCHRONOUS SDV DUMP    * 03050052
.*  $P1= PC40145  HBB3310  860829  PD2F: CORRECT SPELLING IN MESG2E   * 03100052
.*  $P2= PC40810  HBB3310  870312  PDA8: SRB KEYWORD PROCESSING       * 03150052
.*  $T1=  OY21535 JBB2220  881101  PDXB: MDUMP SUPPORT                * 03200052
.*  $T2=  OY21535 HBB3310  881101  PDXB: MDUMP SUPPORT                * 03250052
.*        D52GHTN                      : VSE/ESA DATASPACE SUPPORT    * 03275052
.*                                                                    * 03300052
.*  OY23383 - WHEN DBCS OPTION IS SPECIFIED, COLUMNS 71 AND   @YA23383* 03350052
.*            72 ARE RECOGNIZED AS EXTENDED CONCATINATION     @YA23383* 03400052
.*            IF THEY CONTAIN LIKE CHARACTERS. CHANGING       @YA23383* 03450052
.*            "XX" IN COLS 71 AND 72 TO "XC".                 @YA23383* 03500052
.*                                                                    * 03550052
.*  $L5=DATA CAPT HBB4420  900000  PDHT: RAPID DATA CAPTURE           * 03600052
.*                                                                    * 03650052
.********************************************************************** 03700052
.*                                                                      03750052
.*       DEFINE SET SYMBOLS                                             03800052
.*                                                                      03850052
         GBLC  &SYSSPLV           SYSTEM/MACRO LIBRARY LEVEL   @G860P1X 03900052
         GBLB  &SDSE3LT      SET IF JBB1226  LIST FORM MACRO  @G383P1U  03950052
         GBLB  &SDSE3EX     SET IF JBB1226 EXECUTE FORM MACRO @G383P1U  04000052
         GBLB  &SDLISTF    LIST FORM WAS PREVIOUSLY SPECIFIED @G383P1U  04050052
         GBLB  &SDSP21L       SET IF HBB2102 LIST FORM MACRO  @G860P31  04100052
         GBLB  &SDSP21E     SET IF HBB2102 EXECUTE FORM MACRO @G860P31  04150052
         GBLC  &SDPLVER     SET ACCORDING TO HIGHEST PLISTVER     @T1A  04200052
         LCLA  &SDFLAG0           SDFLAG0 FIELD OF PARAMETER LIST       04250052
         LCLA  &SDFLAG1           SDFLAG1 FIELD OF PARAMETER LIST       04300052
         LCLA  &SDFLAG2           SDFLAG2 PARAMETER LIST FIELD @G383P1U 04350052
         LCLA  &SDATAF1,&SDATAF2  SDATA FIELD OF PARAMETER LIST         04400052
         LCLA  &SDATAF3           SDATA EXIT FIELDS PARM LIST  @G383P1U 04450052
         LCLA  &SDAT3             SDUSDAT3 FIELD OF PARM LIST      @T1A 04500052
         LCLA  &SDCNTL1           CONTROL FLAGS FOR IDENTIFYING NEW     04550052
.*                                RELEASES AND EXPANDED PARAMETER LIST  04600052
.*                                LENGTHS                      @G860P31 04650052
         LCLA  &SDTYPF1           TYPE FIELD OF PARAMETER LIST @G383P1U 04700052
         LCLA  &CTR1,&CTR2        COUNTERS FOR LOOP CONTROL, INDEX      04750052
         LCLA  &HDRCTR            NUMBER OF PAIRED APOSTROPHES          04800052
         LCLA  &IDCTR             NUMBER OF PAIRED APOSTROPHES     @T1A 04850052
         LCLA  &DISP              DISPLACEMENT FOR STORING ADDRESSES    04900052
         LCLA  &DISP1             DISPLACEMENT FOR STOR LIST@G860P31    04950052
         LCLA  &DISP2             DISPLACEMENT FOR HDR DATA    @G860P31 05000052
         LCLA  &STRCNT            COUNT OF STOR ADDRESSES      @G860P31 05050052
         LCLC  &GNAME             SYMBOLIC NAME-BRANCH AROUND CONSTANTS 05100052
         LCLC  &TEMP              TEMPORARY VARIABLE               @T1A 05150052
         LCLB  &SDDCB             SET IF DCB ADDRESS IS SPECIFIED       05200052
         LCLB  &SDBUFF            SET IF BUFFER IS TO BE DUMPED         05250052
         LCLB  &SDSTOR            SET IF STORAGE OR LIST IS SPECIFIED   05300052
         LCLB  &SDHDR             SET IF HDR OR HDRAD IS SPECIFIED      05350052
         LCLB  &SDECB             SET IF AN ECB ADDRESS IS SUPPLIED     05400052
         LCLB  &SDSRB            SET IF AN SRB ADDRESS IS SUPPLIED @L4A 05450052
         LCLB  &SDASID            SET IF AN ASID IS SPECIFIED           05500052
         LCLB  &SDASIDL           SET IF AN ASIDLIST IS SPECIFIED       05550052
.*                                                             @G33VPHD 05600052
         LCLB  &SDQUIET           SET IF SYSTEM IS TO BE QUIESCED       05650052
         LCLB  &SDBRNCH           SET IF INTERFACE IS BRANCH ENTRY      05700052
         LCLB  &DUMPTYP           ALWAYS SET FOR SVC DUMP               05750052
         LCLB  &SDALPSA           SET IF ALL PSA IN SYSTEM TO BE DUMPED 05800052
         LCLB  &SDPSA             SET IF CURRENT PSA IS TO BE DUMPED    05850052
         LCLB  &SDNUC             SET IF NUCLEUS IS TO BE DUMPED        05900052
         LCLB  &SDSQA             SET IF SQA IS TO BE DUMPED            05950052
         LCLB  &SDLSQA            SET IF LSQA IS TO BE DUMPED           06000052
         LCLB  &SDRGN             SET IF VIRTUAL MEMORY IS TO BE DUMPED 06050052
         LCLB  &SDLPA             SET IF ACTIVE LPA MOD FOR MEMORY REQ  06100052
         LCLB  &SDTRT             SET IF GTF INCORE TRACE BUFFERS  REQ  06150052
         LCLB  &SDCSA             SET IF CSA SUBPOOLS ARE TO BE DUMPED  06200052
         LCLB  &SDSWA             SET IF SWA FOR MEMORY TO BE DUMPED    06250052
.*                                                                      06300052
         LCLB  &SDSUMLT           SET IF SUMLIST SPECIFIED     @G33VPHD 06350052
         LCLB  &SDSMDMP           SET IF SUMDUMP SPECIFIED     @G33VPHD 06400052
         LCLB  &SDNSMDP           SET IF NO SUMDUMP SPECIFIED  @G33VPHD 06450052
         LCLB  &SDNSQA            SET IF NO SQA SPECIFIED      @G33VPHD 06500052
         LCLB  &SDNAPSA           SET IF NOALLPSA IS SPECIFIED @G33VPHD 06550052
         LCLB  &SDNEW             SET IF ENHANCED SVC DUMP     @G33VPHD 06600052
         LCLB  &SDSE3PM         SET IF JBB1226 PARMS SPECIFIED @G383P1U 06650052
         LCLB  &SDGRSQ            SET IF SDATA=GRSQ SPECIFIED  @G383P1U 06700052
.********************************************************************** 06750052
.* FOR EACH NEW SDUMP EXIT, ADD A NEW VARIABLE DEFINED SIMILAR TO       06800052
.* SDGRSQ.                                                     @G386P31 06850052
.********************************************************************** 06900052
         LCLB  &SDLISTA           SET IF LISTA PARM SPECIFIED  @G383P1U 06950052
         LCLB  &SDSMLTA           SET IF SUMLSTA SPECIFIED     @G383P1U 07000052
         LCLB  &SDSPEND           SET IF SUSPEND=YES SPECIFIED @G386P31 07050052
         LCLB  &SDTYPXM           SET IF TYPE=XMEM SPECIFIED   @ZMB0025 07100052
         LCLB  &SDTPXME           SET IF TYPE=XMEME SPECIFIED  @G38AP31 07150052
         LCLB  &SDALLNC           SET IF ALLNUC SPECIFIED      @G860P31 07200052
         LCLB  &SDSPLST           SET IF SUBPLST SPECIFIED     @G860P31 07250052
         LCLB  &SDKYLST           SET IF KEYLIST SPECIFIED     @G860P31 07300052
         LCLB  &SDSP21P           SET IF HBB2102 PARM LIST     @G860P31 07350052
         LCLB  &SDVRSNB           SET IF VERSION NUMBER IN LIST    @T1A 07400052
         LCLB  &SDTYPNL          SET IF TYPE=NOLOCAL SPECIFIED @ZMC2707 07450052
         LCLB  &SDTYPRC           SET IF TYPE=FAILRC SPECIFIED     @L2A 07500052
.* FLAGS FOR MDUMP OPTIONS                                              07550052
         LCLC  &PLVER             PLISTVER                         @T1A 07600052
         LCLB  &SDPREG            SET IF PSWREG SPECIFIED          @T1A 07650052
         LCLB  &SDSYMR            SET IF SYMREC SPECIFIED          @T1A 07700052
         LCLB  &SDID              SET IF ID OR IDAD SPECIFIED      @T1A 07750052
         LCLB  &SDIDAD            SET IF IDAD SPECIFIED            @T1A 07800052
         LCLB  &SDDEFS            SET IF DEFAULTS/DEFS SPECIFIED   @T1A 07850052
         LCLB  &SDNODEF           SET IF NODEFAULTS/NODEFS         @T1A 07900052
         LCLB  &SDIO              SET IF IO SPECIFIED              @T1A 07950052
.*                                                                      08000052
.********************************************************************** 08050052
.* DETERMINE WHAT THE SYSTEM/MACRO LIBRARY IS.  IF IT IS HBB3310,       08100052
.* ISSUE SDUMPX MACRO. IF IT IS HBB2102,                                08150052
.* THEN CONTINUE PROCESSING SDUMP MACRO.  IF IT IS NOT HBB2102, THEN    08200052
.* ISSUE SDUMP7 MACRO, AFTER REMOVING THE SUBPLST AND KEYLIST           08250052
.* PARAMETERS.  NOTE: THE ALLNUC OPTION ON THE SDATA KEYWORD WILL       08300052
.* NOT BE REMOVED.                                             @G860P1X 08350052
.********************************************************************** 08400052
.*                                                                      08450052
         GBLC  &SYSASCE           ASC ENVIRONMENT                  @L3A 08500052
         SYSSTATE TEST            WHAT IS ASC ENVIRONMENT          @L3A 08550052
         AIF ('&SYSASCE' EQ 'P').INVKSDP PRIMARY, PROCESS NORMALLY @L3A 08600052
         MNOTE 0,'*** SDUMPX MACRO SUBSTITUTED FOR SDUMP MACRO BECAUSE X08650052
               ASCENV=AR/ANY SPECIFIED ON PREVIOUSLY ISSUED SYSSTATE MAX08700052
               CRO'                                                @L3A 08750052
&NAME    SDUMPX HDR=&HDR,HDRAD=&HDRAD,DCB=&DCB,ASID=&ASID,             X08800052
               ASIDLST=&ASIDLST,ECB=&ECB,SDATA=&SDATA,                 X08850052
               STORAGE=&STORAGE,LIST=&LIST,SUMLIST=&SUMLIST,           X08900052
               BUFFER=&BUFFER,QUIESCE=&QUIESCE,BRANCH=&BRANCH,         X08950052
               LISTA=&LISTA,TYPE=&TYPE,SUMLSTA=&SUMLSTA,               X09000052
               SUSPEND=&SUSPEND,SUBPLST=&SUBPLST,KEYLIST=&KEYLIST,     X09050052
               ID=&ID,IDAD=&IDAD,SYMREC=&SYMREC,PSWREGS=&PSWREGS,      X09100052
               MF=&MF,SRB=&SRB,PLISTVER=&PLISTVER                  @T2C 09150052
         MEXIT                                                     @L3A 09200052
.INVKSDP ANOP                                                      @L3A 09250052
         SPLEVEL TEST              WHAT IS THE SYSTEM LEVEL?   @G860P1X 09300052
         AIF   ('&SYSSPLV' NE '1').INVKSP2 HBB2102, GO PROCESS @G860P1X 09350052
.*                                           NORMALLY          @G860P1X 09400052
.INVKSP1 ANOP                      INVOKE HBB2102 SDUMP7 MACRO @G860P1X 09450052
&NAME    SDUMP7 HDR=&HDR,HDRAD=&HDRAD,DCB=&DCB,ASID=&ASID,     @G860P1XC09500052
               ASIDLST=&ASIDLST,ECB=&ECB,SDATA=&SDATA,         @G860P1XC09550052
               STORAGE=&STORAGE,LIST=&LIST,SUMLIST=&SUMLIST,   @G860P1XC09600052
               BUFFER=&BUFFER,QUIESCE=&QUIESCE,BRANCH=&BRANCH, @G860P1XC09650052
               LISTA=&LISTA,TYPE=&TYPE,SUMLSTA=&SUMLSTA,       @G860P1XC09700052
               SUSPEND=&SUSPEND,MF=&MF                         @G860P1X 09750052
         MEXIT                                                 @G860P1X 09800052
.*                                                                      09850052
.********************************************************************** 09900052
.* IF ANY POSITIONAL PARAMETERS WERE SPECIFIED, THE MACRO IS            09950052
.* SPECIFIED INCORRECTLY AND IS PROBABLY MISSING A SET OF               10000052
.* PARENTHESIS.                                                @G860P1X 10050052
.********************************************************************** 10100052
.*                                                                      10150052
.INVKSP2 ANOP                                                  @G860P1X 10200052
         AIF  ('&SYSLIST(1)' NE '').MESG1A                     @G860P1X 10250052
.*                                                                      10300052
.********************************************************************** 10350052
.*                                                                      10400052
.*         SYNTAX CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                  10450052
.*                                                             @G860P31 10500052
.********************************************************************** 10550052
.*                                                                      10600052
         AIF   ('&HDR' NE '' AND '&HDRAD' NE '').MESG2A     MUTUALLY    10650052
         AIF   ('&ID' NE '' AND '&IDAD' NE '').MESG2F              @T1A 10700052
         AIF   ('&STORAGE' NE '' AND '&LIST' NE '').MESG2B   EXCLUSIVE  10750052
.*       TEST STORAGE AND LISTA - MUTUALLY EXCLUSIVE           @G383P1U 10800052
         AIF   ('&STORAGE' NE '' AND '&LISTA' NE '').MESG2C    @G383P1U 10850052
.*       TEST LIST AND LISTA - MUTUALLY EXCLUSIVE              @G383P1U 10900052
         AIF   ('&LIST' NE '' AND '&LISTA' NE '').MESG2D       @G383P1U 10950052
.*       TEST SUMLIST AND SUMLSTA - MUTUALLY EXCLUSIVE         @G383P1U 11000052
         AIF   ('&SUMLIST' NE '' AND '&SUMLSTA' NE '').MESG2E  @G383P1U 11050052
.*       TEST ASID AND ASIDLST - MUTUALLY EXCLUSIVE            @G386P31 11100052
         AIF   ('&ASID' NE '' AND '&ASIDLST' NE '').MESG10     @G383P1U 11150052
.*                                                                      11200052
.********************************************************************** 11250052
.*                                                                      11300052
.*    PARSE THE HDR PARAMETER FOR INVALID LENGTH AFTER ACCOUNTING       11350052
.*    FOR STARTING, ENDING, AND PAIRED APOSTROPHES.                     11400052
.*                                                             @G860P31 11450052
.********************************************************************** 11500052
.*                                                                      11550052
         AIF   ('&HDR' EQ '').SD3I          HDR SPECIFIED          @T1C 11600052
         AIF   ('&HDR'(1,1) NE '''').MESG9  IS FIRST CHAR APOSTROPHE    11650052
&CTR1    SETA  K'&HDR-1                     LENGTH OF USER DATA +1      11700052
         AIF   (&CTR1 LT 2).MESG9A          INVALID HDR SPECIFICATION   11750052
.*                                                            @ZMC0399  11800052
&HDRCTR  SETA  0                            NUMBER OF PAIRED APOSTROHES 11850052
&CTR2    SETA  2                            INDEX FIRST CHAR-USER DATA  11900052
.SDLOOP  ANOP                                                           11950052
         AIF   (&CTR2 GE &CTR1).SD2              END OF SCAN            12000052
         AIF   ('&HDR'(&CTR2,2) EQ '''''').SD1   PAIRED APOSTROPHES     12050052
&CTR2    SETA  &CTR2+1                           UPDATE INDEX BY 1      12100052
         AGO   .SDLOOP                           CONTINUE LOOP          12150052
.SD1     ANOP                                                           12200052
&HDRCTR  SETA  &HDRCTR+1                    ONE MORE PAIRED APOSTROPHES 12250052
&CTR2    SETA  &CTR2+2                      UPDATE INDEX BY 2           12300052
         AGO   .SDLOOP                      CONTINUE LOOP               12350052
.SD2     ANOP                                                           12400052
&CTR1    SETA  K'&HDR-2-&HDRCTR             LENGTH OF USER DATA         12450052
         AIF   (&CTR1 GT 100).MESG8         USER DATA TOO LONG          12500052
.********************************************************************** 12550052
.*                                                                      12600052
.*    PARSE THE ID PARAMETER FOR INVALID LENGTH AFTER ACCOUNTING        12650052
.*    FOR STARTING, ENDING, AND PAIRED APOSTROPHES.                     12700052
.*                                                                 @T1A 12750052
.********************************************************************** 12800052
.*                                                                      12850052
.SD3I    AIF   ('&ID' EQ '').SD3            ID SPECIFIED           @T1A 12900052
         AIF   ('&ID'(1,1) NE '''').MESG9I  FIRST CHAR APOSTROPHE  @T1A 12950052
&CTR1    SETA  K'&ID-1                      LENGTH+1               @T1A 13000052
         AIF   (&CTR1 LT 2).MESG9AI         INVALID ID SPECIFICATION   *13050052
                                                                   @T1A 13100052
&IDCTR   SETA  0                            PAIRED APOSTROPHES     @T1A 13150052
&CTR2    SETA  2                            INDEX FIRST CHAR       @T1P 13200052
.SDLOOPI ANOP                                                      @T1A 13250052
         AIF   (&CTR2 GE &CTR1).SD2I             END OF SCAN       @T1A 13300052
         AIF   ('&ID'(&CTR2,2) EQ '''''').SD1I   PAIRED            @T1A 13350052
&CTR2    SETA  &CTR2+1                           UPDATE INDEX BY 1 @T1A 13400052
         AGO   .SDLOOPI                          CONTINUE LOOP     @T1A 13450052
.SD1I    ANOP                                                      @T1A 13500052
&IDCTR   SETA  &IDCTR+1                     ONE MORE               @T1A 13550052
&CTR2    SETA  &CTR2+2                      UPDATE INDEX BY 2      @T1P 13600052
         AGO   .SDLOOPI                     CONTINUE LOOP          @T1A 13650052
.SD2I    ANOP                                                      @T1A 13700052
&CTR1    SETA  K'&ID-2-&IDCTR               LENGTH OF USER DATA    @T1A 13750052
         AIF   (&CTR1 GT 50).MESG8I         USER DATA TOO LONG     @T1A 13800052
.*                                                                      13850052
.********************************************************************** 13900052
.*                                                                      13950052
.*    CHECK FOR INVALID PARAMETERS SPECIFIED WITH MF=L                  14000052
.*                                                             @G860P31 14050052
.********************************************************************** 14100052
.*                                                                      14150052
.SD3     AIF   ('&MF' NE 'L').SD5           IS MF STANDARD OR EXECUTE   14200052
         AIF   ('&ASID' NE '').MESG5A       ASID INVALID W/MF=L         14250052
         AIF   ('&ECB' NE '').MESG5B        ECB INVALID W/MF=L          14300052
         AIF   ('&SRB' NE '').MESG5F        SRB INVALID W/MF=L     @L4A 14350052
         AIF   ('&BRANCH' NE '').MESG5C     BRANCH INVALID W/MF=L       14400052
         AIF   ('&ASIDLST' NE '').MESG5D   ASID INV W/MF=L     @G33VPHD 14450052
.*                                                                      14500052
.********************************************************************** 14550052
.*                                                                      14600052
.*  CHECK FOR VALID OPERANDS (YES OR NO) ON BUFFER, BRANCH, AND QUIESCE 14650052
.*                                                             @G860P31 14700052
.********************************************************************** 14750052
.*                                                                      14800052
.SD5     AIF   ('&BUFFER' EQ '').SD9        IS BUFFER SPECIFIED         14850052
.*                                                             @G33VPHD 14900052
         AIF   ('&BUFFER' NE 'YES' AND '&BUFFER' NE 'NO').MESG4B        14950052
.*                                                             @G33VPHD 15000052
.SD9     AIF   ('&BRANCH' EQ '').SD11       IS BRANCH SPECIFIED         15050052
         AIF   ('&BRANCH' NE 'YES' AND '&BRANCH' NE 'NO').MESG4C        15100052
.SD11    AIF   ('&QUIESCE' EQ '').SD13      IS QUIESCE SPECIFIED        15150052
         AIF   ('&QUIESCE' NE 'YES' AND '&QUIESCE' NE 'NO').MESG4D      15200052
.*                                                                      15250052
.********************************************************************** 15300052
.*                                                                      15350052
.*  CHECK FOR AN EVEN NUMBER OF STORAGE RANGES.                         15400052
.*                                                             @G860P31 15450052
.********************************************************************** 15500052
.*                                                                      15550052
.SD13    AIF   ('&STORAGE' EQ '').SD15      IS STORAGE SPECIFIED        15600052
&CTR1    SETA  N'&STORAGE/2                 NUMBER OF ADDRESS PAIRS     15650052
&CTR2    SETA  (N'&STORAGE-1)/2             NUMBER OF PAIRS MINUS 1     15700052
         AIF   (&CTR1 EQ &CTR2).MESG6       ODD NUMBER OF ADDRESSES     15750052
.SD15    ANOP                                                           15800052
.*                                                                      15850052
.********************************************************************** 15900052
.*                                                                      15950052
.*       SDFLAG0 PROCESSING                                             16000052
.*                                                             @G860P31 16050052
.********************************************************************** 16100052
.*                                                                      16150052
&SDDCB   SETB  ('&DCB' NE '')                IF DCB SPECIFIED           16200052
&SDBUFF  SETB  ('&BUFFER' EQ 'YES')          IF BUFFER TO BE DUMPED     16250052
&SDSTOR  SETB  ('&STORAGE' NE '' OR '&LIST' NE '')    STORAGE ADDR LIST 16300052
&SDHDR   SETB  ('&HDR' NE '' OR '&HDRAD' NE '')       USER DATA         16350052
         AIF   ('&ECB' NE '' AND '&SRB' NE '').MESG13B SRB AND ECB ARE  16400052
.*             MUTUALLY EXCLUSIVE                                  @L4A 16450052
&SDECB   SETB  ('&ECB' NE '')                IF ECB SPECIFIED           16500052
&SDSRB   SETB  ('&SRB' NE '')                IF SRB SPECIFIED      @L4A 16550052
&SDASID  SETB  ('&ASID' NE '')               IF ASID SPECIFIED          16600052
&SDQUIET SETB  ('&QUIESCE' NE 'NO')          IF SYSTEM TO BE QUIESCED   16650052
.*             SDQUIET IS SET FOR QUIESCE=YES OR DEFAULTED TO YES       16700052
.*             THE DEFAULT ONLY APPLIES TO THE LIST AND STANDARD FORM,  16750052
.*             AND MUST BE COMPENSATED FOR ON THE EXECUTE FORM.         16800052
&SDBRNCH SETB  ('&BRANCH' EQ 'YES')          IF LINKAGE BY BRANCH ENTRY 16850052
&SDFLAG0 SETA  128*&SDDCB+64*&SDBUFF+32*&SDSTOR+16*&SDHDR+8*&SDECB+4*&SX16900052
               DASID+2*&SDQUIET+1*&SDBRNCH                              16950052
.*                                                                      17000052
.********************************************************************** 17050052
.*                                                                      17100052
.*       SDFLAG1 PROCESSING                                             17150052
.*                                                             @G860P31 17200052
.********************************************************************** 17250052
.*                                                                      17300052
&DUMPTYP SETB  1                  ALWAYS ON FOR SVC DUMP                17350052
&SDNEW   SETB  1                  ALWAYS SET TO 1 FOR NEW SDUMP MACRO   17400052
.*                                                             @G33VPHD 17450052
&SDASIDL SETB  ('&ASIDLST' NE '') IF ASIDLIST WAS SPECIFIED             17500052
.*                                                             @G33VPHD 17550052
&SDSUMLT SETB  ('&SUMLIST' NE '') IF SUMLIST WAS SPECIFIED              17600052
.*                                                             @G33VPHD 17650052
&SDFLAG1 SETA  128*&DUMPTYP+32*&SDNEW+16*&SDASIDL+8*&SDSUMLT            17700052
.*                                                                      17750052
.********************************************************************** 17800052
.*                                                                      17850052
.*       SDFLAG2 PROCESSING                                             17900052
.*                                                             @G860P31 17950052
.********************************************************************** 18000052
.*                                                                      18050052
&SDLISTA SETB  ('&LISTA' NE '')   SET IF LISTA IS SPECIFIED    @G383P1U 18100052
&SDSMLTA SETB  ('&SUMLSTA' NE '') SET IF SUMLSTA SPECIFED      @G383P1U 18150052
&SDFLAG2 SETA  128*&SDLISTA+64*&SDSMLTA                        @G383P1U 18200052
.*                                                                      18250052
.********************************************************************** 18300052
.*                                                                      18350052
.*       SDCNTL1 PROCESSING                                             18400052
.*                                                                 @T1A 18450052
.********************************************************************** 18500052
.*                                                                      18550052
&SDPREG  SETB  ('&PSWREGS' NE '')   SET FOR PSWREGS                @T1A 18600052
&SDSRS   SETB  ('&SYMREC' NE '')    SET FOR SYMREC                 @T1A 18650052
&SDID    SETB  ('&ID' NE '' OR '&IDAD' NE '')         ID DATA      @T1A 18700052
&SDIDAD  SETB  ('&IDAD' NE '')      SET FOR IDAD                   @T1A 18750052
&SDCNTL1 SETA  32*&SDPREG+16*&SDSRS+8*&SDID                        @T1A 18800052
.*                                                                      18850052
.********************************************************************** 18900052
.*                                                                      18950052
.*       SDATA PROCESSING FOR ONLY 1 SDATA OPTION SPECIFIED.            19000052
.*                                                             @G860P31 19050052
.********************************************************************** 19100052
.*                                                                      19150052
         AIF   ('&SDATA' EQ '').SD80        IS SDATA SPECIFIED          19200052
         AIF   ('&SDATA'(1,1) EQ '(').SD60  MORE THAN 1 OPTION, IN ()   19250052
&CTR1    SETA  0                                                        19300052
&SDALPSA SETB  ('&SDATA' EQ 'ALLPSA')       SET IF ALLPSA SPECIFIED     19350052
&SDPSA   SETB  ('&SDATA' EQ 'PSA')          SET IF PSA SPECIFIED        19400052
&SDNUC   SETB  ('&SDATA' EQ 'NUC')          SET IF NUC SPECIFIED        19450052
&SDSQA   SETB  ('&SDATA' EQ 'SQA')          SET IF SQA SPECIFIED        19500052
&SDLSQA  SETB  ('&SDATA' EQ 'LSQA')         SET IF LSQA SPECIFIED       19550052
&SDRGN   SETB  ('&SDATA' EQ 'RGN')          SET IF RGN SPECIFIED        19600052
&SDLPA   SETB  ('&SDATA' EQ 'LPA')          SET IF LPA SPECIFIED        19650052
&SDTRT   SETB  ('&SDATA' EQ 'TRT')          SET IF TRT SPECIFIED        19700052
&SDCSA   SETB  ('&SDATA' EQ 'CSA')          SET IF CSA SPECIFIED        19750052
&SDSWA   SETB  ('&SDATA' EQ 'SWA')          SET IF SWA SPECIFIED        19800052
&SDSMDMP SETB  ('&SDATA' EQ 'SUMDUMP' OR '&SDATA' EQ 'SUM')             19850052
.*                         SET IF SUMDUMP OR SUM ARE SPECIFIED @G33VPHD 19900052
&SDNSQA  SETB  ('&SDATA' EQ 'NOSQA')        SET IF NOSQA SPECIFIED      19950052
.*                                                             @G33VPHD 20000052
&SDNAPSA SETB  ('&SDATA' EQ 'NOALLPSA' OR '&SDATA' EQ 'NOALL')          20050052
.*                          SET IF NOALLPSA OR NOALL SPECIFIED @G33VPHD 20100052
&SDNSMDP SETB  ('&SDATA' EQ 'NOSUMDUMP' OR '&SDATA' EQ 'NOSUM')         20150052
&SDALLNC SETB  ('&SDATA' EQ 'ALLNUC')                          @G860P31 20200052
&SDGRSQ  SETB  ('&SDATA' EQ 'GRSQ')  SET IF GRSQ SPECIFIED     @G383P1U 20250052
&SDIO    SETB  ('&SDATA' EQ 'IO')    SET IF IO SPECIFIED           @T1A 20300052
&SDDEFS  SETB  ('&SDATA' EQ 'DEFS' OR '&SDATA' EQ 'DEFAULTS')      @T1A 20350052
&SDNODEF SETB  ('&SDATA' EQ 'NODEFS' OR '&SDATA' EQ 'NODEFAULTS')  @T1A 20400052
.********************************************************************** 20450052
.* FOR EACH NEW SDUMP EXIT, ADD A 'SETB' INSTRUCTION SIMILAR TO THE ONE 20500052
.* ABOVE AND ADD THE EXIT VARIABLE INTO THE FOLLOWING SETA.    @G386P31 20550052
.********************************************************************** 20600052
&CTR1    SETA  &SDALPSA+&SDPSA+&SDNUC+&SDSQA+&SDLSQA+&SDRGN+&SDLPA+&SDTX20650052
               RT+&SDCSA+&SDSWA+&SDSMDMP+&SDNSMDP+&SDNSQA+&SDNAPSA+&SDGX20700052
               RSQ+&SDALLNC+&SDIO+&SDDEFS+&SDNODEF                 @T1C 20750052
&CTR2    SETA  1                            IF INVALID, MESG PRINTS IT  20800052
         AIF   ('&CTR1' EQ '0').MESG4A      IS SPECIFIED OPTION VALID   20850052
         AGO   .SD80                        SDATA OPTION PROCESSED      20900052
.*                                                                      20950052
.********************************************************************** 21000052
.*                                                                      21050052
.*       SDATA PROCESSING FOR 1 OR MORE SDATA OPTIONS IN PARENTHESIS.   21100052
.*                                                             @G860P31 21150052
.********************************************************************** 21200052
.*                                                                      21250052
.SD60    ANOP                     SDATA OPTIONS IN PARENTHESIS          21300052
&CTR1    SETA  N'&SDATA           NUMBER OF OPTIONS ON SDATA PARAMETER  21350052
&CTR2    SETA  0                  NUMBER BY POSITION OPERAND WORKING ON 21400052
.LOOPA1  ANOP                                                           21450052
&CTR2    SETA  &CTR2+1            NUMBER OF NEXT OPTION TO WORK ON      21500052
         AIF   ('&SDATA(&CTR2)' EQ 'ALLPSA').SETAPSA                    21550052
         AIF   ('&SDATA(&CTR2)' EQ 'PSA').SETPSA                        21600052
         AIF   ('&SDATA(&CTR2)' EQ 'NUC').SETNUC                        21650052
         AIF   ('&SDATA(&CTR2)' EQ 'SQA').SETSQA                        21700052
         AIF   ('&SDATA(&CTR2)' EQ 'LSQA').SETLSQA                      21750052
         AIF   ('&SDATA(&CTR2)' EQ 'RGN').SETRGN                        21800052
         AIF   ('&SDATA(&CTR2)' EQ 'LPA').SETLPA                        21850052
         AIF   ('&SDATA(&CTR2)' EQ 'TRT').SETTRT                        21900052
         AIF   ('&SDATA(&CTR2)' EQ 'CSA').SETCSA                        21950052
         AIF   ('&SDATA(&CTR2)' EQ 'SWA').SETSWA                        22000052
         AIF   ('&SDATA(&CTR2)' EQ 'SUMDUMP').SETSUM SUMDUMP SPEC       22050052
.*                                                             @G33VPHD 22100052
         AIF   ('&SDATA(&CTR2)' EQ 'SUM').SETSUM  SET IF SUM SPECIFIED  22150052
.*                                                             @G33VPHD 22200052
         AIF   ('&SDATA(&CTR2)' EQ 'NOSUMDUMP').SETNSUM SET IF          22250052
.*                                   NO SUMDUMP IS SPECIFIED   @G33VPHD 22300052
         AIF   ('&SDATA(&CTR2)' EQ 'NOSUM').SETNSUM  SET IF NOSUM IS    22350052
.*                                                   SPECIFIED          22400052
.*                                                             @G33VPHD 22450052
         AIF   ('&SDATA(&CTR2)' EQ 'NOSQA').SETNSQA  SET IF NOSQA SPEC  22500052
.*                                                             @G33VPHD 22550052
         AIF   ('&SDATA(&CTR2)' EQ 'NOALLPSA').SETNAPA                  22600052
.*                                                             @G33VPHD 22650052
         AIF   ('&SDATA(&CTR2)' EQ 'NOALL').SETNAPA                     22700052
.*                                                             @G33VPHD 22750052
         AIF   ('&SDATA(&CTR2)' EQ 'ALLNUC').SETANUC                    22800052
.*                                                             @G860P31 22850052
         AIF   ('&SDATA(&CTR2)' EQ 'GRSQ').SETGRSQ SET IF GRSQ @G383P1U 22900052
         AIF   ('&SDATA(&CTR2)' EQ 'IO').SETIO                     @T1A 22950052
         AIF   ('&SDATA(&CTR2)' EQ 'DEFS').SETDEFS                 @T1A 23000052
         AIF   ('&SDATA(&CTR2)' EQ 'DEFAULTS').SETDEFS             @T1A 23050052
         AIF   ('&SDATA(&CTR2)' EQ 'NODEFS').SETNODF               @T1A 23100052
         AIF   ('&SDATA(&CTR2)' EQ 'NODEFAULTS').SETNODF           @T1A 23150052
.********************************************************************** 23200052
.* FOR EACH NEW SDUMP EXIT, ADD AN 'AIF' INSTRUCTION SIMILAR TO THE ONE 23250052
.* ABOVE AND ADD THE NEW LABEL FOR THE SET.                    @G386P31 23300052
.********************************************************************** 23350052
         AGO   .MESG4A                 SDATA OPTION IS INVALID          23400052
.LOOPA2  AIF   (&CTR1 NE &CTR2).LOOPA1 MORE OPTIONS, CONTINUE LOOP      23450052
         AGO   .SD80                   ALL OPTIONS PROCESSED            23500052
.SETAPSA ANOP                          ALLPSA SPECIFIED                 23550052
         AIF   (&SDNAPSA EQ 1).MESG13  NOALLPSA AND ALLPSA IS ERROR     23600052
.*                                                             @G33VPHD 23650052
&SDALPSA SETB  1                       SET INDICATOR                    23700052
         AGO   .LOOPA2                 CONTINUE LOOP                    23750052
.SETPSA  ANOP                          PSA SPECIFIED                    23800052
&SDPSA   SETB  1                       SET INDICATOR                    23850052
         AGO   .LOOPA2                 CONTINUE LOOP                    23900052
.SETNUC  ANOP                          NUC SPECIFIED                    23950052
&SDNUC   SETB  1                       SET INDICATOR                    24000052
         AGO   .LOOPA2                 CONTINUE LOOP                    24050052
.SETSQA  ANOP                          SQA SPECIFIED                    24100052
         AIF   (&SDNSQA EQ 1).MESG12   SQA AND NOSQA IS ERROR           24150052
.*                                                             @G33VPHD 24200052
&SDSQA   SETB  1                       SET INDICATOR                    24250052
         AGO   .LOOPA2                 CONTINUE LOOP                    24300052
.SETLSQA ANOP                          LSQA SPECIFIED                   24350052
&SDLSQA  SETB  1                       SET INDICATOR                    24400052
         AGO   .LOOPA2                 CONTINUE LOOP                    24450052
.SETRGN  ANOP                          RGN SPECIFIED                    24500052
&SDRGN   SETB  1                       SET INDICATOR                    24550052
         AGO   .LOOPA2                 CONTINUE LOOP                    24600052
.SETLPA  ANOP                          LPA SPECIFIED                    24650052
&SDLPA   SETB  1                       SET INDICATOR                    24700052
         AGO   .LOOPA2                 CONTINUE LOOP                    24750052
.SETTRT  ANOP                          TRT SPECIFIED                    24800052
&SDTRT   SETB  1                       SET INDICATOR                    24850052
         AGO   .LOOPA2                 CONTINUE LOOP                    24900052
.SETCSA  ANOP                          CSA SPECIFIED                    24950052
&SDCSA   SETB  1                       SET INDICATOR                    25000052
         AGO   .LOOPA2                 CONTINUE LOOP                    25050052
.SETSWA  ANOP                          SWA SPECIFIED                    25100052
&SDSWA   SETB  1                       SET INDICATOR                    25150052
         AGO  .LOOPA2                  CONTINUE LOOP                    25200052
.SETSUM  ANOP                          SUMDUMP OR SUM SPECIFIED         25250052
.*                                                             @G33VPHD 25300052
         AIF   (&SDNSMDP EQ 1).MESG11  NOSUMDUMP AND SUMDUMP IS ERROR   25350052
.*                                                             @G33VPHD 25400052
&SDSMDMP SETB  1                       SET SUMDUMP INDICATOR            25450052
.*                                                             @G33VPHD 25500052
         AGO   .LOOPA2                 CONTINUE LOOP                    25550052
.*                                                             @G33VPHD 25600052
.SETNSUM ANOP                          NOSUMDUMP OR NOSUM SPECIFIED     25650052
.*                                                             @G33VPHD 25700052
         AIF   (&SDSMDMP EQ 1).MESG11  NOSUMDUMP AND SUMDUMP IS ERROR   25750052
.*                                                             @G33VPHD 25800052
&SDNSMDP SETB  1                       SET NOSUMDUMP INDICATOR          25850052
.*                                                             @G33VPHD 25900052
         AGO   .LOOPA2                 CONTINUE LOOP                    25950052
.*                                                             @G33VPHD 26000052
.SETNSQA ANOP                          NOSQA SPECIFIED                  26050052
.*                                                             @G33VPHD 26100052
         AIF   (&SDSQA EQ 1).MESG12    SQA AND NOSQA IS AN ERROR        26150052
.*                                                             @G33VPHD 26200052
&SDNSQA  SETB  1                       SET NOSQA INDICATOR              26250052
.*                                                             @G33VPHD 26300052
         AGO   .LOOPA2                 CONTINUE LOOP                    26350052
.*                                                             @G33VPHD 26400052
.SETNAPA ANOP                          NOALLPSA OR NOALL SPECIFIED      26450052
.*                                                             @G33VPHD 26500052
         AIF   (&SDALPSA EQ 1).MESG13  NOALLPSA AND ALLPSA IS ERROR     26550052
.*                                                             @G33VPHD 26600052
&SDNAPSA SETB  1                       SET NOALLPSA INDICATOR           26650052
.*                                                             @G33VPHD 26700052
         AGO   .LOOPA2                 CONTINUE LOOP                    26750052
.*                                                             @G33VPHD 26800052
.SETANUC ANOP                          ALLNUC OPTION SPECIFIED @G860P31 26850052
&SDALLNC SETB  1                       ALLNUC OPTION SET       @G860P31 26900052
         AGO   .LOOPA2                 CONTINUE LOOP           @G386P31 26950052
.SETGRSQ ANOP                          GRSQ OPTION SPECIFIED   @G383P1U 27000052
&SDGRSQ  SETB  1                       GRSQ OPTION SPECIFIED   @G383P1U 27050052
         AGO   .LOOPA2                 CONTINUE LOOP           @G383P1U 27100052
.SETIO   ANOP                          IO OPTION SPECIFIED         @T1A 27150052
&SDIO    SETB  1                       IO OPTION SPECIFIED         @T1A 27200052
         AGO   .LOOPA2                 CONTINUE LOOP               @T1A 27250052
.SETDEFS ANOP                          DEFS OPTION SPECIFIED       @T1A 27300052
&SDDEFS  SETB  1                       DEFS OPTION SPECIFIED       @T1A 27350052
         AGO   .LOOPA2                 CONTINUE LOOP               @T1A 27400052
.SETNODF ANOP                          NODEFS OPTION SPECIFIED     @T1A 27450052
&SDNODEF SETB  1                       NODEFS OPTION SPECIFIED     @T1A 27500052
         AGO   .LOOPA2                 CONTINUE LOOP               @T1A 27550052
.********************************************************************** 27600052
.* FOR EACH NEW SDUMP EXIT, ADD A SET OF 3 INSTRUCTIONS SIMILAR TO THE  27650052
.* 3 PREVIOUS INSTRUCTIONS.                                    @G386P31 27700052
.********************************************************************** 27750052
.SD80    ANOP         ALL SDATA OPTIONS PROCESSED,BUILD SDATA  @G33VPHD 27800052
         AIF   (&SDNODEF EQ 0 OR &SDDEFS EQ 0).SDDEFOK             @T1A 27850052
         MNOTE 12,'DEFAULTS AND NODEFAULTS ARE MUTUALLY EXCLUSIVE' @T1A 27900052
         MEXIT                                                     @T1A 27950052
.SDDEFOK ANOP                                                      @T1A 28000052
.*                                                                      28050052
.********************************************************************** 28100052
.*                                                                      28150052
.*       PLISTVER PROCESSING -- DETERMINE SPECIFIED AND/OR              28200052
.*       NECESSARY PLISTVER PROCESSING                                  28250052
.*                                                                 @T1A 28300052
.********************************************************************** 28350052
         AIF   ('&PLISTVER' EQ '').PLV01                           @T1A 28400052
         AIF   ('&PLISTVER' EQ '2').PLV00                          @T1A 28450052
         MNOTE 12,'PLISTVER MUST BE 2'                             @T1A 28500052
         MEXIT                                                     @T1A 28550052
.PLV00   ANOP                                                      @T1A 28600052
&PLVER   SETC  '&PLISTVER'                                         @T1A 28650052
         AGO   .PLV02                                              @T1A 28700052
.PLV01   ANOP                                                      @T1A 28750052
         AIF   ('&ID' NE '' OR '&IDAD' NE '' OR '&PSWREGS' NE '' OR '&S*28800052
               YMREC' NE '').PLVSET2                               @T1A 28850052
         AIF   (&SDIO NE 0 OR &SDDEFS NE 0 OR &SDNODEF NE 0).PLVSET2   *28900052
                                                                   @T1A 28950052
&PLVER   SETC  '1'                                                 @T1A 29000052
         AGO   .PLV02                                              @T1A 29050052
.PLVSET2 ANOP                                                      @T1A 29100052
&PLVER   SETC  '2'                                                 @T1A 29150052
.PLV02   ANOP                                                      @T1A 29200052
         AIF   ('&PLVER' EQ '2').PLVOK                             @T1A 29250052
         AIF   ('&ID' NE '' OR '&IDAD' NE '' OR '&PSWREGS' NE '' OR '&S*29300052
               YMREC' NE '').PLVBAD1                               @T1A 29350052
         AIF   (&SDIO NE 0 OR &SDDEFS NE 0 OR &SDNODEF NE 0).PLVBAD1   *29400052
                                                                   @T1A 29450052
         AGO   .PLVOK                                              @T1A 29500052
.PLVBAD1 ANOP                                                      @T1A 29550052
         MNOTE 12,'SPECIFIED KEYWORD(S) REQUIRE PLISTVER=2'        @T1A 29600052
         MEXIT                                                     @T1A 29650052
.PLVOK   ANOP                                                      @T1A 29700052
.*       PLVER IS SET TO THE HIGHEST PLVER EVER                         29750052
         AIF   ('&MF' EQ '').PLV03                                 @T1A 29800052
         AIF   ('&SDPLVER' NE '2' OR '&PLISTVER' NE '').PLVOK1     @T1A 29850052
&PLVER   SETC  '&SDPLVER'                                          @T1A 29900052
.PLVOK1  ANOP                                                      @T1A 29950052
         AIF   ('&SDPLVER' NE '' AND '&SDPLVER' GE '&PLVER').PLV03 @T1A 30000052
&SDPLVER SETC  '&PLVER'                                            @T1A 30050052
.PLV03   ANOP                                                      @T1A 30100052
.*                                                                      30150052
.********************************************************************** 30200052
.*                                                                      30250052
.*   AFTER PROCESSING ALL SDATA OPTIONS, BUILD THE SDATA FLAG BYTES.    30300052
.*                                                             @G860P31 30350052
.********************************************************************** 30400052
.*                                                                      30450052
&SDATAF1 SETA  128*&SDALPSA+64*&SDPSA+32*&SDNUC+16*&SDSQA+8*&SDLSQA+4*&X30500052
               SDRGN+2*&SDLPA+1*&SDTRT                                  30550052
&SDATAF2 SETA  128*&SDCSA+64*&SDSWA+32*&SDSMDMP+16*&SDNSMDP+8*&SDNAPSA+X30600052
               4*&SDNSQA+2*&SDALLNC+&SDDEFS                        @T1C 30650052
&SDATAF3 SETA  128*&SDGRSQ               CALC EXIT FLAG VALUE  @G860P31 30700052
&SDAT3   SETA  128*&SDNODEF+64*&SDIO                               @T1C 30750052
.*                                                                      30800052
.********************************************************************** 30850052
.*                                                                      30900052
.*     SUSPEND KEYWORD PROCESSING                                       30950052
.*                                                             @G860P31 31000052
.********************************************************************** 31050052
.*                                                                      31100052
         AIF   ('&SUSPEND' EQ '').SD73  CHECK IF SUSPEND       @G386P31 31150052
.*                      PARAMETER SPECIFIED ?                  @G386P31 31200052
         AIF   ('&SUSPEND' EQ 'NO').SD73  SUSPEND=NO IS SAME   @G386P31 31250052
.*                      AS NOT SPECIFYING THE SUSPEND KEYWORD  @G386P31 31300052
         AIF   ('&SUSPEND' NE 'YES').MESG16A  INVALID SUSPEND  @G386P31 31350052
.* SUSPEND=YES REQUIRES BRANCH=YES AND SUMDUMP                 @G386P31 31400052
         AIF   ('&BRANCH' NE 'YES').MESG16B    NO BRANCH=YES   @G386P31 31450052
         AIF   (&SDNSMDP EQ 1).MESG16C    NOSUMDUMP INVALID    @G386P31 31500052
&SDSPEND SETB  1             TURN ON SUSPEND=YES BIT           @G386P31 31550052
.*                                                                      31600052
.********************************************************************** 31650052
.*                                                                      31700052
.*   CHECK FOR NOSUM INVALID WITH SUMLIST OR SUMLSTA                    31750052
.*                                                             @G860P31 31800052
.********************************************************************** 31850052
.*                                                                      31900052
.SD73    AIF   (&SDNSMDP  EQ  0).SD74  IF NOSUM NOT SPECIFIED  @G860P31 31950052
         AIF   (&SDSUMLT  EQ  1).MESG15  NOSUM AND SUMLIST     @G860P31 32000052
         AIF   (&SDSMLTA  EQ  1).MESG15A  NOSUM AND SUMLSTA    @G860P31 32050052
.*                                                                      32100052
.********************************************************************** 32150052
.*                                                                      32200052
.*   TYPE PARAMETER PROCESSING FOR SINGLE TYPE OPTION                   32250052
.*                                                             @G860P31 32300052
.********************************************************************** 32350052
.*                                                                      32400052
.SD74    AIF   ('&TYPE' EQ '').SD90    IS TYPE PARAMETER SPEC  @G860P31 32450052
         AIF   ('&TYPE'(1,1) EQ '(').SD75 MORE THAN ONE OPTION @G383P1U 32500052
&CTR1    SETA  0              INITIALIZE LOOP COUNTER          @G383P1U 32550052
&SDTYPXM SETB  ('&TYPE' EQ 'XMEM')  SET IF TYPE=XMEM SPECIFIED @G383P1U 32600052
&SDTPXME SETB  ('&TYPE' EQ 'XMEME') SET IF TYPE=XMEME          @G38AP1U 32650052
&SDTYPNL SETB  ('&TYPE' EQ 'NOLOCAL') SET IF TYPE=NOLOCAL      @ZMC2707 32700052
&SDTYPRC SETB  ('&TYPE' EQ 'FAILRC') SET IF TYPE=FAILRC            @L2A 32750052
&CTR1    SETA  &SDTYPXM+&SDTPXME+&SDTYPNL+&SDTYPRC   CALCULATE     @L2C 32800052
.*                           VALID OPTIONS                         @L2A 32850052
&CTR2    SETA  1             INITIALIZE FOR MNOTE              @G383P1U 32900052
         AIF   ('&CTR1'  EQ  '0').MESG4E  NO VALID OPTIONS     @G383P1U 32950052
         AGO   .SD90         TYPE OPTION PROCESSED             @G383P1U 33000052
.*                                                                      33050052
.********************************************************************** 33100052
.*                                                                      33150052
.*   TYPE PARAMETER PROCESSING FOR TYPE OPTIONS IN PARENTHESIS          33200052
.*                                                             @G860P31 33250052
.********************************************************************** 33300052
.*                                                                      33350052
.SD75    ANOP         TYPE PARAMETERS IN PARENTHESIS           @G383P1U 33400052
&CTR1    SETA  N'&TYPE       NUMBER OF TYPE PARAMETERS         @G383P1U 33450052
&CTR2    SETA  0             INDEX OF OPERAND ADDRESSED        @G383P1U 33500052
.SD76    ANOP                TOP OF OPTION LOOP                @G383P1U 33550052
&CTR2    SETA  &CTR2+1       INDEX NEXT OPTION TO WORK ON      @G383P1U 33600052
         AIF    ('&TYPE(&CTR2)' EQ 'XMEM').SETTPXM   XMEM SPEC @G383P1U 33650052
         AIF    ('&TYPE(&CTR2)' EQ 'XMEME').SETTXME XMEME SPEC @G38AP1U 33700052
         AIF    ('&TYPE(&CTR2)' EQ 'NOLOCAL').SETTPNL NOLOCAL SPEC      33750052
.*                                                             @ZMC2707 33800052
         AIF    ('&TYPE(&CTR2)' EQ 'FAILRC').SETTPRC FAILRC SPEC   @L2A 33850052
         AGO    .MESG4E      EXIT PARAMETER INVALID            @G383P1U 33900052
.SETTPXM ANOP                XMEM SPECIFIED                    @G383P1U 33950052
&SDTYPXM SETB  1             SET INDICATOR                     @G383P1U 34000052
         AGO   .SD77         GOTO CHECK FOR END OF TYPE LOOP   @G38AP31 34050052
.SETTPNL ANOP                NOLOCAL SPECIFIED                 @ZMC2707 34100052
&SDTYPNL SETB  1             SET INDICATOR                     @ZMC2707 34150052
         AGO   .SD77         GOTO CHECK FOR END OF TYPE LOOP   @G38AP31 34200052
.SETTPRC ANOP                FAILRC SPECIFIED                      @L2A 34250052
&SDTYPRC SETB  1             SET INDICATOR                         @L2A 34300052
         AGO   .SD77         GOTO CHECK FOR END OF TYPE LOOP       @L2A 34350052
.SETTXME ANOP                XMEME SPECIFIED                   @G38AP31 34400052
&SDTPXME SETB  1             SET INDICATOR                     @G38AP31 34450052
.SD77    AIF   (&CTR1 NE &CTR2).SD76  MORE OPTIONS CONTINUE    @G38AP31 34500052
         AIF   (&SDTYPXM EQ 1 AND &SDTPXME EQ 1).MESG4F    CHECK FOR    34550052
.*                          MUTUALLY EXCLUSIVE TYPE PARAMETERS @G38AP31 34600052
.SD90    ANOP               BUILD TYPE FLAG BYTES              @G383P1U 34650052
&SDTYPF1 SETA  128*&SDTYPXM+64*&SDTPXME+32*&SDTYPNL+16*&SDTYPRC         34700052
.*                                        CALC TYPE FLAG VALUE     @L2C 34750052
.*                                                                      34800052
.********************************************************************** 34850052
.*                                                                      34900052
.*   PROCESS SUBPLST AND KEYLIST OPERANDS                               34950052
.*                                                             @G860P31 35000052
.********************************************************************** 35050052
.*                                                                      35100052
         AIF   ('&KEYLIST' NE '' AND '&SUBPLST' EQ '').MESG17A @G860P31 35150052
.*             KEYLIST IS INVALID WITHOUT SUBPLST              @G860P31 35200052
&SDKYLST SETB  ('&KEYLIST' NE '')            SET KEYLIST FLAG  @G860P31 35250052
&SDSPLST SETB  ('&SUBPLST' NE '')            SET SUBPLST FLAG  @G860P31 35300052
.*                                                                      35350052
.********************************************************************** 35400052
.*                                                                      35450052
.*   DETERMINE IF ANY JBB1226 OPTIONS WERE CHOSEN.  THIS IS USED TO     35500052
.*   CALCULATE THE LENGTH OF THE PARAMETER LIST.                        35550052
.*                                                             @G860P31 35600052
.********************************************************************** 35650052
.*                                                                      35700052
         AIF   (&SDTYPF1  NE  0).SETS3PM     IF TYPE SPECIFIED @G383P1U 35750052
         AIF   (&SDATAF3  NE  0).SETS3PM   IF EXIT SDATA SPEC  @G383P1U 35800052
         AIF   (&SDLISTA  NE  0).SETS3PM    IF LISTA SPECIFIED @G383P1U 35850052
         AIF   (&SDSPEND  NE  0).SETS3PM  IF SUSPEND SPECIFIED @G386P31 35900052
         AIF   (&SDSE3LT  EQ  1).SETS3PM  CHECK GLOBAL LIST    @G860P31 35950052
         AIF   (&SDSE3EX  EQ  1).SETS3PM  CHECK GLOBAL EXECUTE @G860P31 36000052
         AIF   (&SDSMLTA  EQ  0).SDFORM1   IF SUMLSTA SPECD    @G383P1U 36050052
.SETS3PM ANOP                 INDICATE NEW PARM LIST SPECIFIED @G383P1U 36100052
&SDSE3PM SETB  1         SET JBB1226 PARMAMETER LIST INDICATOR @G383P1U 36150052
.SDFORM1 ANOP                                                  @G383P1U 36200052
.*                                                                      36250052
.********************************************************************** 36300052
.*                                                                      36350052
.*   DETERMINE IF ANY HBB2102 OPTIONS WERE CHOSEN.  THIS IS USED TO     36400052
.*   CALCULATE THE LENGTH OF THE PARAMETER LIST.                        36450052
.*                                                             @G860P31 36500052
.********************************************************************** 36550052
.*                                                                      36600052
         AIF   (&SDALLNC  EQ  1).SETSP21   IF ALLNUC SPECIFIED @G860P31 36650052
         AIF   (&SDSRB    EQ  1).SETSP21   IF SRB  SPECIFIED       @P2A 36700052
         AIF   (&SDTYPNL  EQ  1).SETSP21  IF NOLOCAL SPECIFIED @ZMC2707 36750052
         AIF   (&SDTYPRC  EQ  1).SETSP21   IF FAILRC SPECIFIED     @L2A 36800052
         AIF   (&SDSP21L  EQ  1).SETSP21   GLOBAL LIST FORM    @G860P31 36850052
         AIF   (&SDSP21E  EQ  1).SETSP21   GLOBAL EXECUTE FORM @G860P31 36900052
         AIF   (&SDSPLST  EQ  0).SDFORM3   SUBPLST SPECIFIED   @G860P31 36950052
.SETSP21 ANOP                 INDICATE NEW PARM LIST SPECIFIED @G860P31 37000052
&SDSP21P SETB  1         SET HBB2102 PARAMETER LIST INDICATOR  @G860P31 37050052
&SDSE3PM SETB  1      DEFAULT JBB1226 WHEN HBB2102 IS PRESENT  @G860P31 37100052
.SDFORM3 ANOP                                                  @G860P31 37150052
         AIF   ('&PLVER' NE '2').SDFORM4                           @T1A 37200052
&SDSP21P SETB  1         SET HBB2102 PARMAMETER LIST INDICATOR     @T1C 37250052
&SDVRSNB SETB  1         INDICATE VERSION BIT AND NUMBER           @T1A 37300052
&SDSE3PM SETB  1      DEFAULT JBB1226 WHEN HBB2102 IS PRESENT      @T1C 37350052
.SDFORM4 ANOP                                                      @T1A 37400052
.*                                                                      37450052
.********************************************************************** 37500052
.*                                                                      37550052
.*   MAKE FINAL CORRECTIONS TO THE SDFLAG BYTES.                        37600052
.*                                                             @G860P31 37650052
.********************************************************************** 37700052
.*                                                                      37750052
.*       RESET SDFLAG1 FOR JBB1226 BIT                         @G383P1U 37800052
&SDFLAG1 SETA  &SDFLAG1+1*&SDSE3PM  SET SDFLAG1 FOR JBB1226 PARMS       37850052
.*                                                             @G383P1U 37900052
.*       RESET SDFLAG2 FOR JBB1226 SUSPEND PARAMETER           @G386P31 37950052
&SDFLAG2 SETA  &SDFLAG2+32*&SDSPEND+16*&SDSPLST+8*&SDKYLST     @G860P31 38000052
.*       SET SDFLAG2 FOR JBB1226 AND HBB2102 PARAMETERS        @G860P31 38050052
&SDCNTL1 SETA  &SDCNTL1+128*&SDSP21P+64*&SDVRSNB+&SDSRB            @T2C 38100052
.*       SET SDCNTL1 FOR HBB2102 PARMS + LATER ADDITIONS       @G860P31 38150052
.*                                                                      38200052
.********************************************************************** 38250052
.*                                                                      38300052
.*  SET UP DISPLACEMENTS AND LENGTHS FOR THE 3 TYPES OF EXPANSIONS.     38350052
.*                                                                      38400052
.*  1. CALCULATE THE NUMBER OF ADDRESSES SPECIFIED WITH STORAGE.        38450052
.*  2. CALCULATE LENGTH OF THE FIXED PART OF THE PARAMETER LIST.        38500052
.*  3. CALCULATE THE DISPLACEMENT OF THE STORAGE LIST.                  38550052
.*  4. CALCULATE THE DISPLACEMENT OF THE USER DATA (HDR).               38600052
.*                                                             @G860P31 38650052
.********************************************************************** 38700052
.*                                                                      38750052
&STRCNT  SETA  0                  DEFAULT COUNT OF 0           @G860P31 38800052
         AIF   ('&STORAGE' EQ '').SD91 CHECK FOR STORAGE       @G860P31 38850052
&STRCNT  SETA  N'&STORAGE         NUMBER OF STORAGE ADDRESSES  @G860P31 38900052
.SD91    ANOP                     NOW CALC DISPLACEMENTS       @G860P31 38950052
&DISP1   SETA  40                 SU33 DEFAULT PARM LIST LEN   @G860P31 39000052
         AIF   (&SDSE3PM EQ 0).SD92 CHECK FOR JBB1226          @G860P31 39050052
&DISP1   SETA  48                 JBB1226 PARAMETER LIST LENGTH         39100052
.*                                                             @G860P31 39150052
         AIF   (&SDSP21P EQ 0).SD92 CHECK FOR HBB2102          @G860P31 39200052
&DISP1   SETA  68                 HBB2102 PARAMETER LIST LENGTH         39250052
.*                                                             @G860P31 39300052
.SD92    ANOP                     FIXED PARAMETER LIST LENGTH  @G860P31 39350052
.*                                IS NOW KNOWN                 @G860P31 39400052
         AIF   ('&PLVER' NE '2').SD93  CHECK FOR MDUMP VERSION     @T1A 39450052
&DISP1   SETA  128                MDUMP LENGTH                     @T1A 39500052
.SD93    ANOP                                                      @T1A 39550052
&DISP2   SETA  &DISP1+(4*&STRCNT) THE USER DATA STARTS AFTER   @G860P31 39600052
.*                                THE STORAGE LIST             @G860P31 39650052
.*                                                                      39700052
.********************************************************************** 39750052
.*                                                                      39800052
.*   DETERMINE WHICH MACRO FORMAT EXPANSION TO DO.                      39850052
.*   STANDARD FORM, EXECUTE OR LIST.                                    39900052
.*                                                             @G860P31 39950052
.********************************************************************** 40000052
.*                                                                      40050052
         AIF   ('&MF' EQ '').STFORM          IS IT STANDARD FORM        40100052
         AIF   ('&MF' EQ 'L').LSTFORM        IS IT LIST FORM            40150052
         AIF   ('&MF'(1,3) NE '(E,').MESG7   ELSE, IF NOT EXECUTE, ERR  40200052
.*                                                                      40250052
.*                                                                      40300052
.*                                                                      40350052
.********************************************************************** 40400052
.*                                                                      40450052
.*       EXECUTE FORM EXPANSION OF MACRO                                40500052
.*                                                             @G860P31 40550052
.********************************************************************** 40600052
.*                                                                      40650052
.*                                                                      40700052
.*                                                                      40750052
         AIF   (&SDSE3PM  EQ  0).SDEX1 IF ANY JBB1226 PARMS WERE        40800052
.*                                                   SPECIFIED @G383P1U 40850052
&SDSE3EX SETB  1       INDICATE JBB1226 PARMS SPECIFIED ON EXEC FORM    40900052
.*                     THIS IS SO FUTURE LIST FORMS OF THE SDUMP MACRO  40950052
.*                     USE THE JBB1226 PARAMETER LIST LENGTH.  @G860P31 41000052
         AIF   (&SDSP21P  EQ  0).SDEX1 IF ANY HBB2102 PARM SPECIFIED    41050052
.*                                                             @G860P31 41100052
&SDSP21E SETB  1       INDICATE HBB2102 PARMS SPECIFIED ON EXEC FORM    41150052
.*                     THIS IS SO FUTURE LIST FORMS OF THE SDUMP MACRO  41200052
.*                     USE THE HBB2102 PARAMETER LIST LENGTH.  @G860P31 41250052
.SDEX1   ANOP                                                  @G383P1U 41300052
         AIF   ('&NAME' EQ '').SDEX2        IS NAME SPECIFIED           41350052
&NAME    DS    0H                                                       41400052
.SDEX2   AIF   ('&MF(2)' EQ '').MESG5E      ERROR IF MISSING   @G860P31 41450052
         IHBSETR   &MF(2),1                 LOAD REG 1 WITH LIST ADDR   41500052
.************************* EXECUTE FORM  ****************************** 41550052
.*                                                                      41600052
.* MAKE SURE NO STORAGE IS ALTERED ON AN EXECUTE FORM OF THE            41650052
.*  SDUMP MACRO WHEN THE ONLY PARAMETER SPECIFIED IS MF.                41700052
.*                                                            @ZA51194  41750052
.********************************************************************** 41800052
         AIF   ('&HDR' NE '' OR  '&HDRAD' NE '' OR '&DCB' NE '' OR '&AS*41850052
               ID' NE '' OR '&ASIDLST' NE '' OR '&ECB' NE '' OR '&SDATA*41900052
               ' NE '' OR '&STORAGE' NE '' OR '&LIST' NE '').SDEX2A     41950052
.*                                                             @ZA51194 42000052
         AIF   ('&SUMLIST' NE '' OR '&BUFFER' NE '' OR '&QUIESCE' NE ''*42050052
               OR '&LISTA' NE '' OR '&TYPE' NE '' OR '&SUMLSTA' NE '' O*42100052
               R '&SUSPEND' NE '' OR '&BRANCH' NE '').SDEX2A   @ZA51194 42150052
         AIF   ('&SUSPEND' NE '' OR '&SUBPLST' NE '' OR '&KEYLIST' NE '*42200052
               ' OR '&SRB' NE '').SDEX2A                           @L4C 42250052
         AIF   ('&SYMREC' NE '' OR '&ID' NE '' OR '&IDAD' NE '' OR '&PS*42300052
               WREGS' NE '').SDEX2A                                @T1A 42350052
         AIF   ('&PLISTVER' EQ '').SDEX49                          @T1A 42400052
         MVI   43(1),&PLVER                 SET VERSION NUMBER     @T1A 42450052
         AGO   .SDEX49                                         @ZA51194 42500052
.*                                                             @ZA51194 42550052
.SDEX2A  ANOP                                                           42600052
.*                                                                      42650052
.*                                                                      42700052
.************************* EXECUTE FORM  ****************************** 42750052
.*                                                                      42800052
.*       PROCESS 1ST 4 FLAG BYTES                                       42850052
.*                                                             @G860P31 42900052
.********************************************************************** 42950052
.*                                                                      43000052
         AIF   ('&PLVER' EQ '1').SDEX61                            @T1A 43050052
         MVI   43(1),&PLVER                 SET VERSION NUMBER     @T1A 43100052
.SDEX61  ANOP                                                      @T1A 43150052
         AIF   ('&QUIESCE' NE '').SDEX3     IS QUIESCE SPECIFIED        43200052
&SDFLAG0 SETA  &SDFLAG0-2                   NO, LEAVE AS SPECIFIED ON L 43250052
.*             SUBTRACT 2 TO REMOVE THE DEFAULTED QUIESCE=YES  @G860P31 43300052
.SDEX3   AIF   ('&SDFLAG0' EQ '0').SDEX3A   ANY OPTIONS TO TURN ON      43350052
         OI    0(1),&SDFLAG0                SET OPTION FLAGS            43400052
.SDEX3A  AIF   ('&BUFFER' EQ 'NO').SDEX4    BUFFER NOT REQUESTED        43450052
         AGO   .SDEX6                       GO CHECK FOR QUIESCE        43500052
.SDEX4   ANOP                                                           43550052
         NI    0(1),X'BF'                   TURN OFF BUFFER FLAG        43600052
.SDEX6   AIF   ('&QUIESCE' EQ 'NO').SDEX8   QUIESCE NOT REQUESTED       43650052
         AGO   .SDEX10                      GO SET SVC DUMP FLAG        43700052
.SDEX8   ANOP                                                           43750052
         NI    0(1),X'FD'                   TURN OFF QUIESCE FLAG       43800052
.SDEX10  ANOP                                                           43850052
         AIF  ('&SDFLAG1' EQ '0').SDEX11 ANY OPTIONS TO TURN ON         43900052
.*                                                             @G383P1U 43950052
         OI    1(1),&SDFLAG1                SET OPTION BITS             44000052
.SDEX11  ANOP                                                  @G33VPHD 44050052
         AIF   ('&SDATA' EQ '').SDEX12      IS SDATA OPTIONS SPECIFIED  44100052
         MVI   2(1),&SDATAF1                SET OPTION FLAGS            44150052
         MVI   3(1),&SDATAF2                SET OPTION FLAGS            44200052
         AIF   ('&PLVER' EQ '1').SDEX62                            @T1A 44250052
         MVI   46(1),&SDAT3                 SET OPTION FLAGS            44300052
.SDEX62  ANOP                                                      @T1A 44350052
.*                                                                      44400052
.************************* EXECUTE FORM  ****************************** 44450052
.*                                                                      44500052
.*       PROCESS DCB OPTION                                             44550052
.*                                                             @G860P31 44600052
.********************************************************************** 44650052
.*                                                                      44700052
.SDEX12  AIF   ('&DCB' EQ '').SDEX15        IS DCB SPECIFIED            44750052
         IHBSETR   &DCB,0                   LOAD REG 0 WITH DCB ADDR    44800052
         ST    0,4(1,0)               ADDR OF DCB INTO PARAM LISTYM1995 44850052
.SDEX15  ANOP                                                           44900052
.*                                                                      44950052
.************************* EXECUTE FORM  ****************************** 45000052
.*                                                                      45050052
.*       PROCESS LIST, LISTA, OR STORAGE OPTION                         45100052
.*                                                             @G860P31 45150052
.********************************************************************** 45200052
.*                                                                      45250052
         AIF   ('&LIST' EQ '').SDEX16       IS LIST SPECIFIED  @G383P1U 45300052
         IHBSETR   &LIST,0                  LOAD REG 0 WITH LIST ADDR   45350052
         ST    0,8(1,0)               ADDR OF LIST INTO PARAM LSTYM1995 45400052
         AGO   .SDEX25                      GO CHECK FOR USER DATA      45450052
.SDEX16  ANOP                LISTA OPTION PROCESSING           @G383P1U 45500052
         AIF   ('&LISTA' EQ '').SDEX20   IS LISTA SPECIFIED    @G383P1U 45550052
         IHBSETR    &LISTA,0      LOAD R0 WITH LISTA ADDRESS   @G383P1U 45600052
         ST    0,8(1)             PUT LISTA ADDR IN PARM LIST  @G383P1U 45650052
         AGO   .SDEX25            GO CHECK FOR USERS DATA      @G383P1U 45700052
.SDEX20  AIF   ('&STORAGE' EQ '').SDEX25    IS STORAGE SPECIFIED        45750052
         LA    15,&DISP1.(1)      NEW ADDRESS OF THE STORAGE LIST AT    45800052
.*                                THE END OF THE PARAMETER LIST POINTED 45850052
.*                                TO BY MF=(E,PARM ADDRESS)    @G860P31 45900052
         ST    15,8(1)            PLACE NEW STORAGE LIST ADDRESS IN THE 45950052
.*                                PARAMETER LIST               @G860P31 46000052
&DISP    SETA  -4                 DISPLACEMENT OF ADDR IN STORAGE LIST  46050052
&CTR1    SETA  N'&STORAGE         NUMBER OF ADDRESSES SPECIFIED         46100052
&CTR2    SETA  0                  POSITION NUMBER OF ADDR WORKING ON    46150052
.LOOPC1  ANOP                                                           46200052
&DISP    SETA  &DISP+4                 DISP OF NEXT ADDR IN STORAGE LST 46250052
&CTR2    SETA  &CTR2+1                 POSITION NUMBER OF NEXT ADDRESS  46300052
         IHBSETR   &STORAGE(&CTR2),0   PUT STORAGE ADDRESS IN REG 0     46350052
         ST    0,&DISP.(0,15)          STORAGE ADDR INTO STORAGE LIST   46400052
&CTR1    SETA  &CTR1-1                 NUMBER OF REMAINING ADDRESSES    46450052
         AIF   (&CTR1 NE 0).LOOPC1   ANY MORE ADDRESSES                 46500052
         OI    &DISP.(15),X'80'      SET END OF LIST INDICATOR          46550052
.*                                                                      46600052
.************************* EXECUTE FORM  ****************************** 46650052
.*                                                                      46700052
.*       PROCESS USER DATA, HDR OR HDRAD                                46750052
.*                                                             @G860P31 46800052
.********************************************************************** 46850052
.*                                                                      46900052
.SDEX25  AIF   ('&HDRAD' EQ '').SDEX30      IS HDRAD SPECIFIED          46950052
         IHBSETR   &HDRAD,0                 LOAD REG0 WITH HDR RCD ADDR 47000052
         ST    0,12(1,0)              ADDR OF USER DATA INTO LISTYM1995 47050052
         AGO   .SDEX35                      GO CHECK FOR ECB            47100052
.SDEX30  AIF   ('&HDR' EQ '').SDEX35        IS HDR SPECIFIED            47150052
&GNAME   SETC  'IHB'.'&SYSNDX'              GET A UNIQUE SYMBOL         47200052
         BAL   15,&GNAME                    BRANCH AROUND USER DATA     47250052
&CTR1    SETA  K'&HDR-2-&HDRCTR             LENGTH OF USER DATA         47300052
         DC    AL1(&CTR1)                   LENGTH OF USER DATA         47350052
         DC    C&HDR                        USER DATA                   47400052
.*       CNOP  2,4                                                      47450052
&GNAME   DS    0H                                                       47500052
         ST    15,12(1,0)             ADDR OF USER DATA INTO LISTYM1995 47550052
.*                                                                      47600052
.************************* EXECUTE FORM  ****************************** 47650052
.*                                                                      47700052
.*       PROCESS ECB OPTION                                             47750052
.*                                                             @G860P31 47800052
.********************************************************************** 47850052
.*                                                                      47900052
.SDEX35  AIF   ('&ECB' EQ '').SDEX38        IS ECB SPECIFIED       @L4C 47950052
         AIF   ('&ECB'(1,1) EQ '(').SDEX37  IS ADDR OF ECB IN A REG     48000052
         L     15,&ECB                      ADDRESS OF ECB              48050052
         ST    15,16(1,0)             ADDR OF ECB INTO PARAM LISTYM1995 48100052
         AGO   .SDEX40                      GO CHECK FOR ASID           48150052
.SDEX37  ANOP                                                           48200052
         ST    &ECB,16(1,0)           ADDR OF ECB INTO PARAM LISTYM1995 48250052
.*                                                                      48300052
.************************* EXECUTE FORM  ****************************** 48350052
.*                                                                      48400052
.*       PROCESS SRB OPTION                                             48450052
.*                                                                 @L4A 48500052
.********************************************************************** 48550052
.*                                                                 @L4A 48600052
.SDEX38  AIF   ('&SRB' EQ '').SDEX40        IS SRB SPECIFIED       @L4A 48650052
         AIF   ('&SRB'(1,1) EQ '(').SDEX39 IS ADDR OF SRB IN A REG @L4A 48700052
         L     15,&SRB                      ADDRESS OF SRB         @L4A 48750052
         ST    15,16(1,0)             ADDR OF SRB INTO PARAM LIST  @L4A 48800052
         AGO   .SDEX40                      GO CHECK FOR ASID      @L4A 48850052
.SDEX39  ANOP                                                      @L4A 48900052
         ST    &SRB,16(1,0)           ADDR OF SRB INTO PARAM LIST  @L4A 48950052
.*                                                                 @L4A 49000052
.************************* EXECUTE FORM  ****************************** 49050052
.*                                                                      49100052
.*       PROCESS ASID OR ASIDLST OPTION                                 49150052
.*                                                             @G860P31 49200052
.********************************************************************** 49250052
.*                                                                      49300052
.SDEX40  AIF   ('&ASID' EQ '').SDEX45       IS ASID SPECIFIED           49350052
         AIF   ('&ASID'(1,1) EQ '(').SDEX42 IS ASID IN A REGISTER       49400052
         LH    0,&ASID                      ASID OF MEMORY TO BE DUMPED 49450052
         STH   0,22(1,0)              ASID INTO PARAMETER LIST   YM1995 49500052
         AGO   .SDEX47                  GO CHECK FOR SUMLIST   @GXXXPXX 49550052
.*                                                             @G33VPHD 49600052
.SDEX42  ANOP                                                           49650052
         STH   &ASID,22(1,0)          ASID INTO PARAMETER LIST   YM1995 49700052
         AGO   .SDEX47                      GO CHECK FOR SUMLIST        49750052
.*                                                             @G33VPHD 49800052
.SDEX45  AIF   ('&ASIDLST' EQ '').SDEX47 IF ASIDLIST SPECIFIED          49850052
.*                                                             @G33VPHD 49900052
         IHBSETR   &ASIDLST,0           LOAD REG 0 WITH ASIDLIST ADDR   49950052
.*                                                             @G33VPHD 50000052
         ST    0,24(1)                  ADDR ASIDLIST INTO PARM LIST    50050052
.*                                                             @G33VPHD 50100052
.*                                                                      50150052
.************************* EXECUTE FORM  ****************************** 50200052
.*                                                                      50250052
.*       PROCESS SUMLIST OR SUMLSTA OPTION                              50300052
.*                                                             @G860P31 50350052
.********************************************************************** 50400052
.*                                                                      50450052
.SDEX47  AIF   ('&SUMLIST' EQ '').SDEX48 IF SUMLIST SPECIFIED  @G383P1U 50500052
         IHBSETR   &SUMLIST,0           LOAD REG 0 WITH SUMLIST ADDR    50550052
.*                                                             @G33VPHD 50600052
         ST    0,28(1)                  ADDR SUMLIST INTO PARM LIST     50650052
.SDEX48  ANOP                                                  @G383P1U 50700052
         AIF   ('&SUMLSTA' EQ '').SDEX48A IS SUMLSTA SPECIFIED @G383P1U 50750052
         IHBSETR    &SUMLSTA,0    LOAD R0 WITH SUMLSTA ADDRESS @G383P1U 50800052
         ST    0,28(1)           MOVE SUMLSTA ADDR TO PARMLIST @G383P1U 50850052
.*                                                                      50900052
.************************* EXECUTE FORM  ****************************** 50950052
.*                                                                      51000052
.*       PROCESS FLAG BYTES FOR SDFALG2, TYPE OPTION, AND EXITS.        51050052
.*                                                             @G860P31 51100052
.********************************************************************** 51150052
.*                                                                      51200052
.SDEX48A AIF   ('&SDFLAG2' EQ '0').SDEX48B  ANY FLAG2 FIELDS   @G383P1U 51250052
         OI    40(1),&SDFLAG2    SET OPTION FLAGS              @G383P1U 51300052
.SDEX48B AIF   ('&SDCNTL1' EQ '0').SDEX48C  ANY CNTL OPTIONS   @G860P31 51350052
         OI    41(1),&SDCNTL1               SET CONTROL FLAGS  @G860P31 51400052
.SDEX48C AIF   ('&SDTYPF1' EQ '0').SDEX48D  ANY TYPE OPTIONS   @G383P1U 51450052
         OI    42(1),&SDTYPF1               SET TYPE FLAGS     @G383P1U 51500052
.SDEX48D AIF   ('&SDATAF3' EQ '0').SDEX48E  ANY EXIT OPTIONS   @G383P1U 51550052
         OI    44(1),&SDATAF3               SET EXIT FLAGS     @G383P1U 51600052
.*                                                                      51650052
.************************* EXECUTE FORM  ****************************** 51700052
.*                                                                      51750052
.*       PROCESS  SUBPLST  AND  KEYLIST  OPTIONS.                       51800052
.*                                                             @G860P31 51850052
.********************************************************************** 51900052
.*                                                                      51950052
.SDEX48E AIF   (&SDSPLST EQ 0).SDEXM00 IS SUBPLST SPECIFIED        @T1A 52000052
         IHBSETR &SUBPLST,0           LOAD SUBPLST ADDRESS     @G860P31 52050052
         ST    0,48(1)                      STORE SUBPLST ADDR @G860P31 52100052
         AIF   (&SDKYLST EQ 0).SDEXM00 IS KEYLIST SPECIFIED        @T1A 52150052
         IHBSETR &KEYLIST,0           LOAD KEYLIST ADDRESS     @G860P31 52200052
         ST    0,52(1)                      STORE KEYLIST ADDR @G860P31 52250052
.*                                                                      52300052
.************************* EXECUTE FORM  ****************************** 52350052
.*                                                                      52400052
.*       PROCESS  PSWREGS OPTION                                        52450052
.*                                                                 @T1A 52500052
.********************************************************************** 52550052
.*                                                                      52600052
.SDEXM00 AIF   (&SDPREG EQ 0).SDEXM01 IS PSWREGS SPECIFIED         @T1A 52650052
         IHBSETR &PSWREGS,0           LOAD PSWREGS ADDRESS         @T1A 52700052
         ST    0,104(,1)                    STORE PSWREGS ADDR     @T1A 52750052
.*                                                                      52800052
.************************* EXECUTE FORM  ****************************** 52850052
.*                                                                      52900052
.*       PROCESS  SYMREC OPTION                                         52950052
.*                                                                 @T1A 53000052
.********************************************************************** 53050052
.*                                                                      53100052
.SDEXM01 AIF   (&SDSRS EQ 0).SDEXM02  IS SYMREC SPECIFIED          @T1A 53150052
         IHBSETR &SYMREC,0            LOAD SYMREC ADDRESS          @T1A 53200052
         ST    0,112(,1)                    STORE SYMREC ADDR      @T1A 53250052
.*                                                                      53300052
.************************* EXECUTE FORM  ****************************** 53350052
.*                                                                      53400052
.*       PROCESS ID/IDAD                                                53450052
.*                                                                 @T1A 53500052
.********************************************************************** 53550052
.*                                                                      53600052
.SDEXM02 AIF   ('&IDAD' EQ '').SDEXM03      IS IDAD SPECIFIED      @T1A 53650052
         IHBSETR   &IDAD,0                  GET ADDRESS OF ID      @T1A 53700052
         ST    0,120(0,1)                   SAVE IDAD INTO LIST    @T1A 53750052
         AGO   .SDEXM04                     CHECK FURTHER          @T1A 53800052
.SDEXM03 AIF   ('&ID' EQ '').SDEXM04        IS ID SPECIFIED        @T1A 53850052
&GNAME   SETC  'IHB'.'&SYSNDX.'.'A'         GET A UNIQUE SYMBOL    @T1A 53900052
         BAL   15,&GNAME                    BRANCH AROUND DATA     @T1A 53950052
&CTR1    SETA  K'&ID-2-&IDCTR               LENGTH OF USER DATA    @T1A 54000052
&TEMP    SETC  'IHB'.'&SYSNDX.'.'I'                                @T1A 54050052
&TEMP    DC    AL1(&CTR1)                   LENGTH OF ID           @T1A 54100052
         DC    C&ID                         ID                     @T1A 54150052
&GNAME   DS    0H                                                  @T1A 54200052
         ST    15,120(0,1)                  SAVE IDAD INTO LIST    @T1A 54250052
.SDEXM04 ANOP                                                      @T1A 54300052
.*                                                                      54350052
.*                                                                      54400052
.************************* EXECUTE FORM  ****************************** 54450052
.*                                                                      54500052
.*       CLOSE OUT THE EXECUTE FORM EXPANSION.                          54550052
.*                                                             @G860P31 54600052
.********************************************************************** 54650052
.*                                                                      54700052
.SDEX49  ANOP                                                  @G383P1U 54750052
         AIF   (&SDLISTF  EQ  0).SDEX49B  IF NO PREV LIST FORM @G860P31 54800052
         AIF   (&SDSE3LT  EQ  1).SDEX49A  IF JBB1226 LIST FORM @G383P1U 54850052
         AIF   (&SDSE3EX  EQ  1).MESG14  EXEC AND LIST DONT MATCH       54900052
.*                                                             @G383P1U 54950052
.SDEX49A AIF   (&SDSP21L  EQ  1).SDEX49B  IF HBB2102 LIST FORM @G860P31 55000052
         AIF   (&SDSP21E  EQ  1).MESG14  EXEC AND LIST DONT MATCH       55050052
.*                                                             @G860P31 55100052
.SDEX49B AIF   ('&BRANCH' EQ 'YES').SDEX50  IS A BRANCH ENTRY  @G383P1U 55150052
         AGO   .SDVSEC1                     GO CHECK FOR VSE   @D52GHTN 55200052
         SVC   51                           INVOKE SVC DUMP VIA SVC     55250052
.SDVSEC1 ANOP                               CHECK FOR VSE/ESA  @D52GHTN 55300052
         L     15,16(0,0)                   ADDRESS OF CVT     @D52GHTN 55350052
         TM    X'74'(15),X'A8'              IS VSE/ESA ACTIVE? @G52GHTN 55400052
         BZ    *+10                         IF NO, GO CALL MVS CODE     55450052
         SVC   123                          CALL VSE/ESA SDUMP @G52GHTN 55500052
         B     *+6                          AND BRANCH TO CONTINUE ...  55550052
         SVC   51                           INVOKE MVS SVC DUMP VIA SVC 55600052
         AGO   .SDEND                       GO END MACRO PROCESSING     55650052
.SDEX50  ANOP                                                           55700052
         L     15,16(0,0)                   ADDRESS OF CVT       YM1995 55750052
         L     15,1028(15,0)            ADDRESS OF SVC DUMP ENTRYYM1995 55800052
         BALR  14,15                        INVOKE SVC DUMP VIA BAL     55850052
         AGO   .SDEND                       GO END MACRO PROCESSING     55900052
.*                                                                      55950052
.*                                                                      56000052
.*                                                                      56050052
.************************ LIST FORM *********************************** 56100052
.*                                                                      56150052
.*       LIST FORM EXPANSION BEGINS HERE                                56200052
.*                                                             @G860P31 56250052
.********************************************************************** 56300052
.*                                                                      56350052
.*                                                                      56400052
.*                                                                      56450052
.LSTFORM ANOP                                                           56500052
&SDLISTF SETB  1         INDICATE LIST FORM HAS BEEN SPECIFIED @G383P1U 56550052
         AIF   (&SDSE3PM  EQ  0).SDLST01  ANY JBB1226 PARMS WERE        56600052
.*                                                   SPECIFIED @G860P31 56650052
&SDSE3LT SETB  1       INDICATE JBB1226 PARMS SPECIFIED ON LIST FORM    56700052
.*                     THIS IS SO FUTURE EXECUTE FORMS OF SDUMP MACRO   56750052
.*                     USE THE JBB1226 PARAMETER LIST LENGTH.  @G860P31 56800052
         AIF   (&SDSP21P  EQ  0).SDLST01  IF  HBB2102 PARM SPECIFIED    56850052
.*                                                             @G860P31 56900052
&SDSP21L SETB  1       INDICATE HBB2102 PARMS SPECIFIED ON LIST FORM    56950052
.*                     THIS IS SO FUTURE EXECUTE FORMS OF  SDUMP MACRO  57000052
.*                     USE THE HBB2102  PARAMETER LIST LENGTH. @G860P31 57050052
.SDLST01 ANOP                                                  @G860P31 57100052
&NAME    DS    0F                           SDUMP PARAMETER LIST        57150052
.*                                                                      57200052
.************************ LIST FORM *********************************** 57250052
.*                                                                      57300052
.*       PROCESS 1ST 4 FLAG BYTES  AND  DCB                             57350052
.*                                                             @G860P31 57400052
.********************************************************************** 57450052
.*                                                                      57500052
         DC    AL1(&SDFLAG0)                FLAG BYTE                   57550052
         DC    AL1(&SDFLAG1)                FLAG BYTE                   57600052
         DC    AL1(&SDATAF1)                FLAG BYTE                   57650052
         DC    AL1(&SDATAF2)                FLAG BYTE                   57700052
         AIF   ('&DCB' EQ '').SDLST10       IS DCB SPECIFIED            57750052
         AIF   ('&DCB'(1,1) EQ '(').MESG1   IS DCB ADDRESS IN A REG     57800052
         DC    A(&DCB)                      ADDRESS OF DCB              57850052
         AGO   .SDLST15                     GO CHECK FOR STORAGE ADDR   57900052
.SDLST10 ANOP                                                           57950052
         DC    A(0)                         ADDRESS OF DCB              58000052
.*                                                                      58050052
.************************ LIST FORM *********************************** 58100052
.*                                                                      58150052
.*       PROCESS STORAGE, LIST OR LISTA OPTION.                         58200052
.*                                                             @G860P31 58250052
.********************************************************************** 58300052
.*                                                                      58350052
.SDLST15 AIF   ('&SDSTOR' NE '0').SDLST16   STORAGE/LIST SPEC @G383P1U  58400052
         AIF   ('&LISTA' EQ '').SDLST24     IS LISTA SPECIFIED @G383P1U 58450052
         AIF   ('&LISTA'(1,1) EQ '(').MESG1  CHECK FOR R FORM  @G383P1U 58500052
         DC    A(&LISTA)               ADDRESS OF STORAGE LIST @G383P1U 58550052
         AGO   .SDLST25                     LISTA OPTION DONE  @G383P1U 58600052
.SDLST16 AIF   ('&LIST' EQ '').SDLST20      IS LIST SPECIFIED           58650052
         AIF   ('&LIST'(1,1) EQ '(').MESG1  IS LIST ADDRESS IN A REG    58700052
         DC    A(&LIST)                     ADDRESS OF STORAGE LIST     58750052
         AGO   .SDLST25                     GO CHECK FOR USER DATA      58800052
.SDLST20 ANOP                               STORAGE SPECIFIED  @G860P31 58850052
         DC    A(*-8+&DISP1)        ADDRESS OF STORAGE LIST    @G860P31 58900052
.*             (*-8) POINTS TO THE FRONT OF THE PARAMETER LIST @G860P31 58950052
.*             DISP1 IS THE OFFSET TO THE END OF THE PARAMETER @G860P31 59000052
.*             LIST, WHICH IS WHERE THE STORAGE ADDRESSES ARE  @G860P31 59050052
.*             BUILT INTO THE PARAMETER LIST.                  @G860P31 59100052
         AGO   .SDLST25                SKIP NULL DECLARE       @G383P1U 59150052
.SDLST24 ANOP                                                           59200052
         DC    A(0)                         ADDRESS OF STORAGE LIST     59250052
.*                                                                      59300052
.************************ LIST FORM *********************************** 59350052
.*                                                                      59400052
.*       PROCESS USER DATA, HDR OR HDRAD OPTION.                        59450052
.*                                                             @G860P31 59500052
.********************************************************************** 59550052
.*                                                                      59600052
.SDLST25 ANOP                                                           59650052
         AIF   ('&SDHDR' EQ '0').SDLST38    IS USER DATA SPECIFIED      59700052
         AIF   ('&HDRAD' NE '').SDLST35     IS HDRAD SPECIFIED          59750052
         DC    A(*-12+&DISP2)               HDR ADDRESS        @G860P31 59800052
.*             (*-12) IS THE ADDRESS OF THE BEGINNING OF THE   @G860P31 59850052
.*             DISP2 IS THE OFFSET OF THE USER DATA (HDR) FROM @G860P31 59900052
.*             THE BEGINNING OF THE PARAMETER LIST.  DISP2     @G860P31 59950052
.*             IS EQUAL TO THE LENGTH OF THE FIXED PART OF THE @G860P31 60000052
.*             PARAMETER LIST PLUS THE LENGTH OF THE STORAGE   @G860P31 60050052
.*             ADDRESS LIST.                                   @G860P31 60100052
         AGO   .SDLST40                     GO DEFINE REST OF PARAM LST 60150052
.SDLST35 AIF   ('&HDRAD'(1,1) EQ '(').MESG1 IS ADDR OF USER DATA IN REG 60200052
         DC    A(&HDRAD)                    ADDRESS OF USER DATA        60250052
         AGO   .SDLST40                     GO DEFINE REST OF PARAM LST 60300052
.SDLST38 ANOP                                                           60350052
         DC    A(0)                         ADDRESS OF USER DATA        60400052
.*                                                                      60450052
.************************ LIST FORM *********************************** 60500052
.*                                                                      60550052
.*       SAVE SPOTS FOR ECB/SRB, ASID, AND ASIDLST.  THESE OPTIONS ARE  60600052
.*       NOT ALLOWED ON THE LIST FORM.                                  60650052
.*                                                                 @L4C 60700052
.********************************************************************** 60750052
.*                                                                      60800052
.SDLST40 ANOP                                                           60850052
         DC    A(0)                         ADDRESS OF ECB/SRB     @L4A 60900052
         DC    AL2(0)                       CURRENT ASID                60950052
         DC    AL2(0)                       OTHER ASID                  61000052
         DC    A(0)                         ADDRESS OF ASID LIST        61050052
.*                                                                      61100052
.************************ LIST FORM *********************************** 61150052
.*                                                                      61200052
.*       PROCESS SUMLIST OR SUMLSTA OPTION.                             61250052
.*                                                             @G860P31 61300052
.********************************************************************** 61350052
.*                                                                      61400052
         AIF   (&SDSUMLT EQ 0).SDLST45 IF SUMLIST NO SPECIFIED @G383P1U 61450052
         AIF   ('&SUMLIST'(1,1) EQ '(').MESG1 REGISTER INVALID @G383P1U 61500052
         DC    A(&SUMLIST)                 ADDRESS OF SUMLIST  @G383P1U 61550052
         AGO   .SDLST50                                        @G383P1U 61600052
.SDLST45 ANOP                                                  @G383P1U 61650052
         AIF   (&SDSMLTA EQ 0).SDLST49 IF SUMLSTA NO SPECIFIED @G383P1U 61700052
         AIF   ('&SUMLSTA'(1,1) EQ '(').MESG1 REGISTER INVALID @G383P1U 61750052
         DC    A(&SUMLSTA)                  ADDRESS OF SUMLSTA @G383P1U 61800052
         AGO   .SDLST50                                        @G383P1U 61850052
.SDLST49 ANOP                                                  @G383P1U 61900052
         DC    A(0)           ADDRESS OF SUMLIST/SUMLSTA LIST  @G383P1U 61950052
.*                                                                      62000052
.************************ LIST FORM *********************************** 62050052
.*                                                                      62100052
.*       2 WORDS RESERVED FOR SLIP AND SYSMDUMP PURPOSES.               62150052
.*                                                             @G860P31 62200052
.********************************************************************** 62250052
.*                                                                      62300052
.SDLST50 ANOP                                                           62350052
         DC    A(0)                      RESERVED              @G33VPHD 62400052
         DC    A(0)                      RESERVED              @G33VPHD 62450052
.*                                                                      62500052
.************************ LIST FORM *********************************** 62550052
.*                                                                      62600052
.*       JBB1226 EXPANDED PARAMETER LIST STARTS HERE.                   62650052
.*                                                             @G860P31 62700052
.********************************************************************** 62750052
.*                                                                      62800052
         AIF   (&SDSE3PM  EQ  0).SDLST59 IF NO JBB1226 PARMS THEN SKIP  62850052
.*                                       THE EXPANDED SECTION  @G383P1U 62900052
         DC    AL1(&SDFLAG2)             FLAG BYTE             @G383P1U 62950052
         DC    AL1(&SDCNTL1)             CONTROL FLAG BYTE     @G860P31 63000052
         DC    AL1(&SDTYPF1)             TYPE FLAG BYTE        @G383P1U 63050052
         AIF   ('&PLVER' EQ '1').SDSTF23                           @T1A 63100052
         DC    AL1(&PLVER.)              VERSION                   @T1A 63150052
         AGO   .SDSTF24                                            @T1A 63200052
.SDSTF23 ANOP                                                      @T1A 63250052
         DC    AL1(0)                    VERSION                   @T1A 63300052
.SDSTF24 ANOP                                                      @T1A 63350052
         DC    AL1(&SDATAF3)             EXIT FLAG BYTE        @G383P1U 63400052
         DC    AL1(0)                    RESERVED SDATA/EXIT       @T1C 63450052
         DC    AL1(&SDAT3)               SDATA OPTIONS             @T1A 63500052
         DC    AL1(0)                    RESERVED SDATA OPTIONS    @T1A 63550052
.*                                                                      63600052
.************************ LIST FORM *********************************** 63650052
.*                                                                      63700052
.*     HBB2102 EXPANDED PARAMETER LIST STARTS HERE.                     63750052
.*                                                             @G860P31 63800052
.********************************************************************** 63850052
.*                                                                      63900052
         AIF   (&SDSP21P  EQ  0).SDLST59 IF NO HBB2102 PARMS THEN SKIP  63950052
.*                                       THE EXPANDED SECTION  @G860P31 64000052
         AIF   (&SDSPLST  EQ  0).SDLST55 CHECK FOR SUBPLST     @G860P31 64050052
         AIF   ('&SUBPLST'(1,1) EQ '(').MESG1 REG FORM INVALID @G860P31 64100052
         DC    A(&SUBPLST)               ADDRESS OF SUBPLST    @G860P31 64150052
         AIF   (&SDKYLST  EQ  0).SDLST56 CHECK FOR KEYLIST     @G860P31 64200052
         AIF   ('&KEYLIST'(1,1) EQ '(').MESG1 REG FORM INVALID @G860P31 64250052
         DC    A(&KEYLIST)               ADDRESS OF KEYLIST    @G860P31 64300052
         AGO   .SDLST57                  SKIP NEXT 2 DC STMTS  @G860P31 64350052
.SDLST55 ANOP                           FILL IN RESERVED SLOTS @G860P31 64400052
         DC    A(0)                      ADDRESS OF SUBPLST    @G860P31 64450052
.SDLST56 ANOP                           FILL IN RESERVED SLOTS @G860P31 64500052
         DC    A(0)                      ADDRESS OF KEYLIST    @G860P31 64550052
.SDLST57 ANOP                           FILL IN RESERVED SLOTS @G860P31 64600052
         DC    A(0)                      RESERVED                  @T1C 64650052
.*                                       RESERVED FOR SLIP              64700052
         AIF   ('&PLVER' EQ '2').PLVER2A                           @T1A 64750052
         DC    2A(0)                     RESERVED                  @T1A 64800052
         AGO   .PLVER2B                                            @T1A 64850052
.PLVER2A ANOP                                                      @T1A 64900052
         DC    11A(0)                    RESERVED FOR SP3.1.0      @T1C 64950052
         AIF   (&SDPREG  EQ  0).SDLST61 CHECK FOR PSWREGS          @T1A 65000052
         AIF   ('&PSWREGS'(1,1) EQ '(').MESG1 REG FORM INVALID     @T1A 65050052
         DC    A(&PSWREGS)               ADDRESS OF PSWREGS        @T1A 65100052
         DC    A(0)                      RESERVED FOR SDUMPX       @T1A 65150052
         AGO   .SDLST62                  SKIP NEXT DC STMT         @T1A 65200052
.SDLST61 ANOP                            FILL IN RESERVED SLOTS    @T1A 65250052
         DC    A(0)                      ADDRESS OF PSWREGS        @T1A 65300052
         DC    A(0)                      RESERVED FOR SDUMPX       @T1A 65350052
.SDLST62 ANOP                            END OF PSWREGS            @T1A 65400052
         AIF   (&SDSRS EQ  0).SDLST63 CHECK FOR SYMREC             @T1A 65450052
         AIF   ('&SYMREC'(1,1) EQ '(').MESG1 REG FORM INVALID      @T1A 65500052
         DC    A(&SYMREC)                ADDRESS OF SYMREC         @T1A 65550052
         DC    A(0)                      RESERVED FOR SDUMPX       @T1A 65600052
         AGO   .SDLST64                  SKIP NEXT DC STMT         @T1A 65650052
.SDLST63 ANOP                            FILL IN RESERVED SLOTS    @T1A 65700052
         DC    A(0)                      ADDRESS OF SYMREC         @T1A 65750052
         DC    A(0)                      RESERVED FOR SDUMPX       @T1A 65800052
.SDLST64 ANOP                            END OF SYMREC             @T1A 65850052
         AIF   (&SDIDAD  EQ  0).SDLST65 CHECK FOR IDAD             @T1A 65900052
         AIF   ('&IDAD'(1,1) EQ '(').MESG1 REG FORM INVALID        @T1A 65950052
         DC    A(&IDAD)                  ADDRESS OF IDAD           @T1A 66000052
         DC    A(0)                      RESERVED FOR SDUMPX       @T1A 66050052
         AGO   .SDLST67                  SKIP NEXT DC STMT         @T1A 66100052
.SDLST65 ANOP                            FILL IN RESERVED SLOTS    @T1A 66150052
         AIF   (&SDID    EQ  0).SDLST66 CHECK FOR ID               @T1A 66200052
         AIF   ('&ID'(1,1) EQ '(').MESG1 REG FORM INVALID          @T1A 66250052
         DC    A(IHB&SYSNDX.I)           ADDRESS OF ID             @T1A 66300052
         DC    A(0)                      RESERVED FOR SDUMPX       @T1A 66350052
         AGO   .SDLST67                  SKIP NEXT DC STMT         @T1A 66400052
.SDLST66 ANOP                            END OF ID/IDAD            @T1A 66450052
         DC    A(0)                      ADDRESS OF ID             @T1A 66500052
         DC    A(0)                      RESERVED FOR SDUMPX       @T1A 66550052
.SDLST67 ANOP                            END OF ID/IDAD            @T1A 66600052
.PLVER2B ANOP                                                      @T1A 66650052
.*                                                                      66700052
.************************ LIST FORM *********************************** 66750052
.*                                                                      66800052
.*       BUILD USER STORAGE LIST.                                       66850052
.*                                                             @G860P31 66900052
.********************************************************************** 66950052
.*                                                                      67000052
.SDLST59 ANOP                                                  @G383P1U 67050052
         AIF   ('&STORAGE' EQ '').SDLST60   BUILD STORAGE LIST          67100052
.*                                                             @G33VPHD 67150052
&CTR1    SETA  N'&STORAGE                   NUMBER OF STORAGE ADDRESSES 67200052
&CTR2    SETA   0                           POSITION NO. OF ADDRESS     67250052
.LOOPD1  ANOP                                                           67300052
&CTR2    SETA  &CTR2+1                      NUMBER OF NEXT ADDRESS      67350052
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').MESG1  ADDR IN A REG     67400052
         DC    A(&STORAGE(&CTR2))           STORAGE ADDRESS             67450052
&CTR1    SETA  &CTR1-1                      NUMBER OF REMAINING ADDR.S  67500052
         AIF   ('&CTR1' GT '1').LOOPD1      IF NOT LAST ADDRESS, LOOP   67550052
&CTR2    SETA  &CTR2+1                      NUMBER OF LAST ADDRESS      67600052
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').MESG1  ADDR IN A REG     67650052
         DC    AL4(X'80000000'+&STORAGE(&CTR2))  LAST ADDRESS           67700052
.*                                                                      67750052
.************************ LIST FORM *********************************** 67800052
.*                                                                      67850052
.*       BUILD USER DATA FOR HDR OPTION.                                67900052
.*                                                             @G860P31 67950052
.********************************************************************** 68000052
.*                                                                      68050052
.SDLST60 ANOP                                                           68100052
.*                                                             @G33VPHD 68150052
         AIF   ('&HDR' EQ '').SDLST70       IS USER DATA SPECIFIED @T1C 68200052
&CTR1    SETA  K'&HDR-2-&HDRCTR             LENGTH OF USER DATA         68250052
         DC    AL1(&CTR1)                   LENGTH OF USER DATA         68300052
         DC    C&HDR                        USER DATA                   68350052
.************************ LIST FORM *********************************** 68400052
.*                                                                      68450052
.*       BUILD USER DATA FOR ID OPTION.                                 68500052
.*                                                                 @T1A 68550052
.********************************************************************** 68600052
.*                                                                      68650052
.SDLST70 ANOP                                                      @T1A 68700052
         AIF   ('&ID' EQ '').SDEND          IS USER DATA SPECIFIED @T1A 68750052
&CTR1    SETA  K'&ID-2-&IDCTR               LENGTH OF USER DATA    @T1A 68800052
&TEMP    SETC  'IHB'.'&SYSNDX.'.'I'                                @T1A 68850052
&TEMP    DC    AL1(&CTR1)                   LENGTH OF USER DATA    @T1A 68900052
         DC    C&ID                         USER DATA              @T1A 68950052
         AGO   .SDEND                       END MACRO PROCESSING   @T1A 69000052
.*                                                                      69050052
.*                                                                      69100052
.*                                                                      69150052
.********************* STANDARD FORM ********************************** 69200052
.*                                                                      69250052
.*       STANDARD FORM EXPANSION STARTS HERE.                           69300052
.*                                                             @G860P31 69350052
.********************************************************************** 69400052
.*                                                                      69450052
.*                                                                      69500052
.*                                                                      69550052
.STFORM  ANOP                                                           69600052
&GNAME   SETC  'IHB'.'&SYSNDX'              OBTAIN UNIQUE SYMBOL-LABEL  69650052
         CNOP  0,4                                                      69700052
         AIF   ('&NAME' EQ '').SDSTF10      IS NAME SPECIFIED           69750052
&NAME    DS    0F                                                       69800052
.SDSTF10 ANOP                                                           69850052
.*                                                                      69900052
.********************* STANDARD FORM ********************************** 69950052
.*                                                                      70000052
.*       BUILD PARAMETER LIST TEMPLATE AND BRANCH TO CODE.              70050052
.*                                                             @G860P31 70100052
.********************************************************************** 70150052
.*                                                                      70200052
         BAL   1,&GNAME                     BRANCH AROUND PARAM LIST    70250052
         DC    AL1(&SDFLAG0)                FLAG BYTE                   70300052
         DC    AL1(&SDFLAG1)                FLAG BYTE                   70350052
         DC    AL1(&SDATAF1)                FLAG BYTE                   70400052
         DC    AL1(&SDATAF2)                FLAG BYTE                   70450052
         DC    A(0)                         ADDRESS OF DCB              70500052
.*                                                                      70550052
.********************* STANDARD FORM ********************************** 70600052
.*                                                                      70650052
.*       CALCULATE ADDRESS OF STORAGE AND/OR HDR PARM AREA              70700052
.*                                                             @G860P31 70750052
.********************************************************************** 70800052
.*                                                                      70850052
         AIF   ('&STORAGE' EQ '').SDST110   STORAGE SPECIFIED? @G860P31 70900052
         DC    A(*-8+&DISP1)                ADDRESS OF STORAGE @G860P31 70950052
         AGO   .SDST111                     GO CHECK HDR       @G860P31 71000052
.SDST110 ANOP                                                  @G860P31 71050052
         DC    A(0)                         ADDRESS OF STORAGE LIST     71100052
.SDST111 AIF   ('&HDR' EQ '').SDST112       HDR SPECIFIED?     @G860P31 71150052
         DC    A(*-12+&DISP2)               ADDRESS OF HDR     @G860P31 71200052
         AGO   .SDST113                     GO CHECK HDR       @G860P31 71250052
.SDST112 ANOP                                                  @G860P31 71300052
         DC    A(0)                         ADDRESS OF HEADER RECORD    71350052
.SDST113 ANOP                               CONTINUE STANDARD  @G860P31 71400052
.*                                                                      71450052
.********************* STANDARD FORM ********************************** 71500052
.*                                                                      71550052
.*       CONTINUE STANDARD FORM EXPANSION AFTER HDR.                    71600052
.*                                                             @G860P31 71650052
.********************************************************************** 71700052
.*                                                                      71750052
         DC    A(0)                         ADDRESS OF ECB/SRB     @L4A 71800052
         DC    AL2(0)                       CURRENT ASID                71850052
         DC    AL2(0)                       OTHER ASID                  71900052
         DC    A(0)                         ADDRESS OF ASID LIST        71950052
.*                                                             @G33VPHD 72000052
         DC    A(0)                         ADDRESS OF SUMLIST          72050052
         DC    A(0)                         RESERVED           @G33VPHD 72100052
         DC    A(0)                         RESERVED           @G33VPHD 72150052
.*                                                                      72200052
.********************* STANDARD FORM ********************************** 72250052
.*                                                                      72300052
.*       GENERATE JBB1226 EXPANSION OF PARAMETER LIST                   72350052
.*                                                             @G860P31 72400052
.********************************************************************** 72450052
.*                                                                      72500052
         AIF   (&SDSE3PM  EQ  0).SDSTF11    NEW PARM LIST      @G383P1U 72550052
         DC    AL1(&SDFLAG2)                FLAG BYTE          @G383P1U 72600052
         DC    AL1(&SDCNTL1)                CONTROL FLAGS      @G860P31 72650052
         DC    AL1(&SDTYPF1)                TYPE FLAG BYTE     @G383P1U 72700052
         AIF   ('&PLVER' EQ '1').SDSTF21                           @T1A 72750052
         DC    AL1(&PLVER.)                 VERSION                @T1A 72800052
         AGO   .SDSTF22                                            @T1A 72850052
.SDSTF21 ANOP                                                      @T1A 72900052
         DC    AL1(0)                       VERSION                @T1A 72950052
.SDSTF22 ANOP                                                      @T1A 73000052
         DC    AL1(&SDATAF3)                EXIT FLAG BYTE     @G383P1U 73050052
         DC    AL1(0)                       RESERVED               @T1C 73100052
         DC    AL1(&SDAT3)                  SDATA OPTIONS          @T1A 73150052
         DC    AL1(0)                       RESERVED               @T1A 73200052
.*                                                                      73250052
.********************* STANDARD FORM ********************************** 73300052
.*                                                                      73350052
.*    GENERATE HBB2102 EXPANSION OF PARAMETER LIST                      73400052
.*                                                             @G860P31 73450052
.********************************************************************** 73500052
.*                                                                      73550052
         AIF   (&SDSP21P  EQ  0).SDSTF11   HBB2102 PARM LIST   @G860P31 73600052
         DC    A(0)                         SUBPLST ADDRESS    @G860P31 73650052
         DC    A(0)                         KEYLIST ADDRESS    @G860P31 73700052
         DC    A(0)                         RESERVED           @G860P31 73750052
.*                                     RESERVED FOR SLIP       @G860P31 73800052
         AIF   ('&PLVER' EQ '2').SDSTP2                            @T1A 73850052
         DC    A(0)                         RESERVED           @G860P31 73900052
.*                                     RESERVED FOR SYSMDUMP SYMPTOM    73950052
.*                                     STRING POINTER          @G860P31 74000052
         DC    A(0)                         RESERVED           @G860P31 74050052
         AGO   .SDSTP99                SKIP PLISTVER=2             @T1A 74100052
.SDSTP2  ANOP                          PLISTVER=2                  @T1A 74150052
         DC    11A(0)                       RESERVED FOR SP3.1.0   @T1A 74200052
         DC    2A(0)                        PSWREGS                @T1A 74250052
         DC    2A(0)                        SYMREC                 @T1A 74300052
         AIF   ('&ID' EQ '').SDSTP00        ID SPECIFIED?          @T1A 74350052
         DC    A(IHB&SYSNDX.I)              ADDRESS OF ID          @T1A 74400052
         DC    A(0)                         RESERVED               @T1A 74450052
         AGO   .SDSTP01                     ONWARD                 @T1A 74500052
.SDSTP00 ANOP                                                      @T1A 74550052
         DC    2A(0)                        ID                     @T1A 74600052
.SDSTP01 ANOP                                                      @T1A 74650052
.SDSTP99 ANOP                                                      @T1A 74700052
.*                                                                      74750052
.********************* STANDARD FORM ********************************** 74800052
.*                                                                      74850052
.*    RESERVE SPACE FOR STORAGE, HDR, ID PARAMETER                      74900052
.*                                                                 @T1C 74950052
.********************************************************************** 75000052
.*                                                                      75050052
.SDSTF11 ANOP                   OLD PARMS SPECIFIED            @G383P1U 75100052
         AIF   ('&STORAGE' EQ '').SDSTF20   IS STORAGE SPECIFIED        75150052
&CTR1    SETA  N'&STORAGE                   NUMBER OF STORAGE ADDRESSES 75200052
         DC    &CTR1.F'0'                   STORAGE ADDRESSES           75250052
.SDSTF20 ANOP                                                           75300052
         AIF   ('&HDR' EQ '').SDSTF30       IS HDR SPECIFIED            75350052
&CTR1    SETA  K'&HDR-2-&HDRCTR             LENGTH OF USER DATA         75400052
         DC    AL1(&CTR1)                   LENGTH OF USER DATA         75450052
         DC    C&HDR                        USER DATA                   75500052
.*       CNOP  2,4                                                      75550052
.SDSTF30 ANOP                                                           75600052
         AIF   ('&ID' EQ '').SDSTF41        IS ID SPECIFIED        @T1A 75650052
&CTR1    SETA  K'&ID-2-&IDCTR               LENGTH OF USER DATA    @T1A 75700052
&TEMP    SETC  'IHB&SYSNDX.I'                                      @T1A 75750052
&TEMP    DC    AL1(&CTR1)                   LENGTH OF USER DATA    @T1A 75800052
         DC    C&ID                         USER DATA              @T1A 75850052
.SDSTF41 ANOP                                                      @T1A 75900052
&GNAME   DS    0H                                                       75950052
.*                                                                      76000052
.********************* STANDARD FORM ********************************** 76050052
.*                                                                      76100052
.*       STORE THE DCB ADDRESS INTO PARAMETER LIST .                    76150052
.*                                                             @G860P31 76200052
.********************************************************************** 76250052
.*                                                                      76300052
         AIF   ('&DCB' EQ '').SDSTF35       IS DCB SPECIFIED            76350052
         IHBSETR   &DCB,0                   ADDRESS OF DCB IN REG 0     76400052
         ST    0,4(1,0)                     SAVE DCB ADDRESS            76450052
.*                                                                      76500052
.********************* STANDARD FORM ********************************** 76550052
.*                                                                      76600052
.*       PROCESS LIST, LISTA, OR STORAGE OPTION.                        76650052
.*                                                             @G860P31 76700052
.********************************************************************** 76750052
.*                                                                      76800052
.SDSTF35 AIF   ('&LIST' EQ '').SDSTF37      IS LIST SPECIFIED  @G383P1U 76850052
         IHBSETR   &LIST,0                  ADDR OF STORAGE LIST IN R0  76900052
         ST    0,8(1,0)                     SAVE LIST ADDRESS           76950052
         AGO   .SDSTF50                     GO CHECK FOR USER DATA      77000052
.SDSTF37 AIF   ('&LISTA' EQ '').SDSTF40  IS LISTA SPECIFIED    @G383P1U 77050052
         IHBSETR   &LISTA,0                 LIST ADDR TO R0    @G383P1U 77100052
         ST    0,8(1)                       STORE LIST ADDR    @G383P1U 77150052
         AGO   .SDSTF50              GO CHECK FOR TITLE        @G383P1U 77200052
.SDSTF40 AIF   ('&STORAGE' EQ '').SDSTF50   STORAGE ADDRESSES SPECIFIED 77250052
&CTR1    SETA  N'&STORAGE          NUMBER OF STORAGE ADDRESSES @G860P31 77300052
&CTR2    SETA  0                   POSITION COUNTER            @G860P31 77350052
&DISP    SETA  &DISP1-4            DISPLACEMENT OF THE STORAGE @G860P31 77400052
.*                                 ADDRESSES INTO THE PARAMETER LIST    77450052
.LOOPE1  ANOP                                                           77500052
&CTR2    SETA  &CTR2+1                 NUMBER OF ADDRESS WORKING ON     77550052
&DISP    SETA  &DISP+4                 DISP OF ADDRESS INTO LIST        77600052
         IHBSETR   &STORAGE(&CTR2),0        ADDRESS INTO R0             77650052
         ST    0,&DISP.(1,0)                STORE INTO LIST      YM1995 77700052
         AIF   ('&CTR1' NE '&CTR2').LOOPE1  ANY  MORE ADDRESSES         77750052
         OI    &DISP.(1),X'80'              END OF LIST INDICATOR       77800052
.*                                                                      77850052
.********************* STANDARD FORM ********************************** 77900052
.*                                                                      77950052
.*       PROCESS HDRAD TO PLACE ADDRESS IN PARAMETER LIST.              78000052
.*       IF HDR WAS SPECIFIED, THE ADDRESS IS ALREADY IN THE            78050052
.*       PARAMETER LIST BECAUSE THE MACRO GENERATES THE LOCATION.       78100052
.*                                                             @G860P31 78150052
.********************************************************************** 78200052
.*                                                                      78250052
.SDSTF50 AIF   ('&HDRAD' EQ '').SDSTF70     IS HDRAD SPECIFIED @G860P31 78300052
         IHBSETR   &HDRAD,0                 ADDR OF USER DATA IN REG 0  78350052
         ST    0,12(1,0)         ADDR OF USER DATA INTO PARAM LSTYM1995 78400052
.*                                                                      78450052
.********************* STANDARD FORM ********************************** 78500052
.*                                                                      78550052
.*       PROCESS ECB OPTION.                                            78600052
.*                                                             @G860P31 78650052
.********************************************************************** 78700052
.*                                                                      78750052
.SDSTF70 AIF   ('&ECB' EQ '').SDSTF74       IS ECB SPECIFIED       @L4C 78800052
         AIF   ('&ECB'(1,1) EQ '(').SDSTF72 IS ECB ADDRESS IN A REG     78850052
         L     0,&ECB                       ADDRESS OF ECB              78900052
         ST    0,16(1,0)              ADDR OF ECB INTO PARAM LISTYM1995 78950052
         AGO   .SDSTF80                     GO CHECK FOR ASID      @L4C 79000052
.SDSTF72 ANOP                                                           79050052
         ST    &ECB,16(1,0)           ADDR OF ECB INTO PARAM LISTYM1995 79100052
.*                                                                      79150052
.********************* STANDARD FORM ********************************** 79200052
.*                                                                      79250052
.*       PROCESS SRB OPTION.                                            79300052
.*                                                                 @L4A 79350052
.********************************************************************** 79400052
.*                                                                 @L4A 79450052
.SDSTF74 AIF   ('&SRB' EQ '').SDSTF80       IS SRB SPECIFIED       @L4A 79500052
         AIF   ('&SRB'(1,1) EQ '(').SDSTF76 IS SRB ADDR IN A REG   @L4A 79550052
         L     0,&SRB                       ADDRESS OF SRB         @L4A 79600052
         ST    0,16(1,0)              ADDR OF SRB INTO PARAM LIST  @L4A 79650052
         AGO   .SDSTF80                     GO CHECK FOR ASID      @L4A 79700052
.SDSTF76 ANOP                                                      @L4A 79750052
         ST    &SRB,16(1,0)           ADDR OF SRB INTO PARAM LIST  @L4A 79800052
.*                                                                 @L4A 79850052
.********************* STANDARD FORM ********************************** 79900052
.*                                                                      79950052
.*       PROCESS ASID OR ASIDLST OPTION.                                80000052
.*                                                             @G860P31 80050052
.********************************************************************** 80100052
.*                                                                      80150052
.SDSTF80 AIF   ('&ASID' EQ '').SDSTF90      IS ASID SPECIFIED           80200052
         AIF   ('&ASID'(1,1) EQ '(').SDSTF82     IS ASID IN A REGISTER  80250052
         LH    0,&ASID                      ASID OF MEMORY TO BE DUMPED 80300052
         STH   0,22(1,0)              ASID INTO PARAMETER LIST   YM1995 80350052
         AGO   .SDSTF90                     GO CHECK FOR BRANCH ENTRY   80400052
.SDSTF82 ANOP                                                           80450052
         STH   &ASID,22(1,0)          ASID INTO PARAMETER LIST   YM1995 80500052
.SDSTF90 AIF   ('&ASIDLST' EQ '').SDSTF93  IS ASIDLIST SPECIFIED        80550052
.*                                                             @G33VPHD 80600052
         IHBSETR   &ASIDLST,0           ADDR OF ASIDLIST IN R0          80650052
.*                                                             @G33VPHD 80700052
         ST    0,24(1)                  ADDR ASIDLIST INTO PARM LIST    80750052
.*                                                             @G33VPHD 80800052
.*                                                                      80850052
.********************* STANDARD FORM ********************************** 80900052
.*                                                                      80950052
.*       PROCESS SUMLIST OR SUMLSTA OPTION.                             81000052
.*                                                             @G860P31 81050052
.********************************************************************** 81100052
.*                                                                      81150052
.SDSTF93 AIF   ('&SUMLIST' EQ '').SDSTF94 IS SUMLIST SPECIFIED          81200052
         IHBSETR   &SUMLIST,0                                           81250052
         ST    0,28(1)                                                  81300052
         AGO   .SDSTF95                DONE SO DO ENTRY LOGIC  @G383P1U 81350052
.SDSTF94 AIF   ('&SUMLSTA' EQ '').SDSTF95  SUMLSTA SPECIFIED   @G383P1U 81400052
         IHBSETR   &SUMLSTA,0        GET SUMLSTA ADDR IN R0    @G383P1U 81450052
         ST    0,28(1)               SUMLSTA ADDR TO PARM LIST @G383P1U 81500052
.*                                                                      81550052
.********************* STANDARD FORM ********************************** 81600052
.*                                                                      81650052
.*       PROCESS SUBPLST AND KEYLIST OPTIONS.                           81700052
.*                                                             @G860P31 81750052
.********************************************************************** 81800052
.*                                                                      81850052
.SDSTF95 AIF   ('&SUBPLST' EQ '').SDSTM00 IS SUBPLST SPECIFIED @G860P31 81900052
         IHBSETR   &SUBPLST,0          LOAD SUBPLST ADDRESS    @G860P31 81950052
         ST    0,48(1)                 STORE SUBPLST ADDRESS   @G860P31 82000052
         AIF   ('&KEYLIST' EQ '').SDSTM00 IS KEYLIST SPECIFIED @G860P31 82050052
         IHBSETR   &KEYLIST,0          LOAD KEYLIST ADDRESS    @G860P31 82100052
         ST    0,52(1)                 STORE KEYLIST ADDRESS   @G860P31 82150052
.*                                                                      82200052
.********************* STANDARD FORM ********************************** 82250052
.*                                                                      82300052
.*       PROCESS PSWREGS OPTION.                                        82350052
.*                                                             @G860P31 82400052
.********************************************************************** 82450052
.*                                                                      82500052
.SDSTM00 AIF   ('&PSWREGS' EQ '').SDSTM01 IS PSWREGS SPECIFIED     @T1A 82550052
         IHBSETR   &PSWREGS,0                                      @T1A 82600052
         ST    0,104(0,1)                   SAVE PSWREG ADDR       @T1A 82650052
.*                                                                      82700052
.********************* STANDARD FORM ********************************** 82750052
.*                                                                      82800052
.*       PROCESS SYMREC  OPTION.                                        82850052
.*                                                             @G860P31 82900052
.********************************************************************** 82950052
.*                                                                      83000052
.SDSTM01 AIF   ('&SYMREC' EQ '').SDSTM02 IS SYMREC SPECIFIED       @T1A 83050052
         IHBSETR   &SYMREC,0                                       @T1A 83100052
         ST    0,112(0,1)                   SAVE SYMREC ADDR       @T1A 83150052
.********************* STANDARD FORM ********************************** 83200052
.*                                                                      83250052
.*       PROCESS IDAD TO PLACE ADDRESS IN PARAMETER LIST.               83300052
.*       IF ID WAS SPECIFIED, THE ADDRESS IS ALREADY IN THE             83350052
.*       PARAMETER LIST BECAUSE THE MACRO GENERATES THE LOCATION.       83400052
.*                                                                 @T1A 83450052
.********************************************************************** 83500052
.*                                                                      83550052
.SDSTM02 AIF   ('&IDAD' EQ '').SDST999      IS IDAD SPECIFIED      @T1A 83600052
         IHBSETR   &IDAD,0                  ADDR ID DATA IN R0     @T1A 83650052
         ST    0,120(0,1)                   SAVE IDAD ADDR         @T1A 83700052
.*                                                                      83750052
.*                                                                      83800052
.********************* STANDARD FORM ********************************** 83850052
.*                                                                      83900052
.*       STANDARD FORM CLOSEOUT.                                        83950052
.*                                                             @G860P31 84000052
.********************************************************************** 84050052
.*                                                                      84100052
.SDST999 AIF   ('&BRANCH' EQ 'YES').SDSTF99  BRANCH ENTRY          @T1C 84150052
.*                                                             @G33VPHD 84200052
         AGO   .SDVSEC2                     GO CHECK FOR VSE   @D52GHTN 84250052
         SVC   51                           INVOKE SVC DUMP VIA SVC     84300052
.SDVSEC2 ANOP                               CHECK FOR VSE/ESA  @D52GHTN 84350052
         L     15,16(0,0)                   ADDRESS OF CVT     @D52GHTN 84400052
         TM    X'74'(15),X'A8'              IS VSE/ESA ACTIVE? @G52GHTN 84450052
         BZ    *+10                         IF NO, GO CALL MVS CODE     84500052
         SVC   123                          CALL VSE/ESA SDUMP @G52GHTN 84550052
         B     *+6                          AND BRANCH TO CONTINUE ...  84600052
         SVC   51                           INVOKE MVS SVC DUMP VIA SVC 84650052
         AGO   .SDEND                       GO END MACRO PROCESSING     84700052
.SDSTF99 ANOP                                                           84750052
.*                                                             @G33VPHD 84800052
         L     15,16(0,0)                   ADDRESS OF CVT       YM1995 84850052
         L     15,1028(15,0)                SVC DUMP ENTRY ADDR  YM1995 84900052
         BALR  14,15                        INVOKE SVC DUMP VIA BAL     84950052
         AGO   .SDEND                       GO END MACRO PROCESSING     85000052
.*                                                                      85050052
.*                                                                      85100052
.*                                                                      85150052
.********************************************************************** 85200052
.*                                                                      85250052
.*       ERROR MESSAGES                                                 85300052
.*                                                             @G860P31 85350052
.********************************************************************** 85400052
.*                                                                      85450052
.*                                                                      85500052
.MESG1   MNOTE 12,'REGISTER NOTATION INVALID W/MF=L'                    85550052
         MEXIT                                                          85600052
.MESG1A  MNOTE 12,'POSITIONAL PARAMETERS ARE NOT ALLOWED - &SYSLIST(1)' 85650052
.*                                                             @G860P1X 85700052
         MEXIT                                                          85750052
.MESG2A  MNOTE 12,'HDR AND HDRAD ARE MUTUALLY EXCLUSIVE'                85800052
         MEXIT                                                          85850052
.MESG2B  MNOTE 12,'STORAGE AND LIST ARE MUTUALLY EXCLUSIVE'             85900052
         MEXIT                                                          85950052
.MESG2C  MNOTE 12,'STORAGE AND LISTA ARE MUTUALLY EXCLUSIVE'   @G383P1U 86000052
         MEXIT                                                 @G383P1U 86050052
.MESG2D  MNOTE 12,'LIST AND LISTA ARE MUTUALLY EXCLUSIVE'      @G383P1U 86100052
         MEXIT                                                 @G383P1U 86150052
.MESG2E  MNOTE 12,'SUMLIST AND SUMLSTA ARE MUTUALLY EXCLUSIVE'     @P1C 86200052
         MEXIT                                                 @G383P1U 86250052
.MESG2F  MNOTE 12,'ID AND IDAD ARE MUTUALLY EXCLUSIVE'             @T1C 86300052
         MEXIT                                                 @G383P1U 86350052
.MESG4A  MNOTE 12,'INVALID SDATA OPERAND SPECIFIED &SDATA(&CTR2)'       86400052
         MEXIT                                                          86450052
.MESG4B  MNOTE 12,'INVALID BUFFER OPERAND SPECIFIED &BUFFER'            86500052
         MEXIT                                                          86550052
.MESG4C  MNOTE 12,'INVALID BRANCH OPERAND SPECIFIED &BRANCH'            86600052
         MEXIT                                                          86650052
.MESG4D  MNOTE 12,'INVALID QUIESCE OPERAND SPECIFIED &QUIESCE'          86700052
         MEXIT                                                 @G383P1U 86750052
.MESG4E  MNOTE 12,'INVALID TYPE OPERAND SPECIFIED &TYPE(&CTR2)'         86800052
.*                                                             @G383P1U 86850052
         MEXIT                                                 @G383P1U 86900052
.MESG4F  MNOTE 12,'MUTUALLY EXCLUSIVE TYPE OPERANDS: XMEM AND XMEME'    86950052
.*                                                             @G38AP31 87000052
         MEXIT                                                 @G38AP31 87050052
.MESG5A  MNOTE 12,'ASID OPERAND INVALID W/MF=L'                         87100052
         MEXIT                                                          87150052
.MESG5B  MNOTE 12,'ECB OPERAND INVALID W/MF=L'                          87200052
         MEXIT                                                          87250052
.MESG5C  MNOTE 12,'BRANCH OPERAND INVALID W/MF=L'                       87300052
         MEXIT                                                          87350052
.MESG5D  MNOTE 12,'ASIDLST OPERAND INVALID W/MF=L'                      87400052
         MEXIT                                                          87450052
.MESG5E  MNOTE 12,'MISSING PARAMETER LIST ADDRESS WITH MF=(E,ADDR)'     87500052
.*                                                             @G860P31 87550052
         MEXIT                                                          87600052
.MESG5F  MNOTE 12,'SRB OPERAND INVALID W/MF=L'                          87650052
.*                                                                 @L4A 87700052
         MEXIT                                                     @L4A 87750052
.MESG6   MNOTE 12,'ODD NUMBER OF STORAGE ADDRESSES'                     87800052
         MEXIT                                                          87850052
.MESG7   MNOTE 12,'MACRO FORM IS INVALID'                               87900052
         MEXIT                                                          87950052
.MESG8   MNOTE 12,'USER DATA TOO LONG'                                  88000052
         MEXIT                                                          88050052
.MESG8I  MNOTE 12,'LENGTH OF ID OPERAND IS TOO LONG'               @T1A 88100052
         MEXIT                                                     @T1A 88150052
.MESG9   MNOTE 12,'INITIAL CHARACTER OF HDR OPERAND NOT AN APOSTROPHE'  88200052
         MEXIT                                                          88250052
.MESG9I  MNOTE 12,'INITIAL CHARACTER OF ID OPERAND NOT AN APOSTROPHE'  *88300052
                                                                   @T1A 88350052
         MEXIT                                                     @T1A 88400052
.*                                                             @G33VPHD 88450052
.MESG9A  MNOTE 12,'INVALID HDR SPECIFICATION'                           88500052
         MEXIT                                                          88550052
.MESG9AI MNOTE 12,'INVALID ID SPECIFICATION'                       @T1A 88600052
         MEXIT                                                     @T1A 88650052
.*                                                             @G860P31 88700052
.MESG10  MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS: ASID AND ASIDLST'       88750052
.*                                                             @G33VPHD 88800052
         MEXIT                                                          88850052
.*                                                             @G33VPHD 88900052
.MESG11  MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS: SUMDUMP/SUM AND NOSUMDUX88950052
               MP/NOSUM'                                                89000052
.*                                                             @G33VPHD 89050052
         MEXIT                                                          89100052
.*                                                             @G33VPHD 89150052
.MESG12  MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS:SQA AND NOSQA'           89200052
.*                                                             @G33VPHD 89250052
         MEXIT                                                          89300052
.*                                                             @G33VPHD 89350052
.MESG13  MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS: ALLPSA AND NOALLPSA'    89400052
.*                                                             @G33VPHD 89450052
         MEXIT                                                          89500052
.MESG13B MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS: SRB AND ECB'            89550052
.*                                                                 @L4A 89600052
         MEXIT                                                     @L4A 89650052
.MESG14  MNOTE 12,'EXECUTE MACRO FORM USES A LIST FORM PARAMETER LIST WX89700052
               HOSE LENGTH IS LESS THAN THE PARAMETER LIST LENGTH USED X89750052
               BY THE EXECUTE MACRO FORM'                      @G383P1U 89800052
         MEXIT                                                 @G383P1U 89850052
.MESG15  MNOTE 12,'NOSUMDUMP SPECIFIED WITH SUMLIST INVALID'   @G383P1U 89900052
         MEXIT                                                 @G383P1U 89950052
.MESG15A MNOTE 12,'NOSUMDUMP SPECIFIED WITH SUMLSTA INVALID'   @G383P1U 90000052
         MEXIT                                                 @G386P31 90050052
.MESG16A MNOTE 12,'INVALID SUSPEND OPERAND SPECIFIED &SUSPEND' @G386P31 90100052
         MEXIT                                                 @G386P31 90150052
.MESG16B MNOTE 12,'BRANCH=YES IS REQUIRED WITH SUSPEND=YES'    @G386P31 90200052
         MEXIT                                                 @G386P31 90250052
.MESG16C MNOTE 12,'SDATA=NOSUM/NOSUMDUMP INVALID WITH SUSPEND=YES'      90300052
.*                                                             @G386P31 90350052
         MEXIT                                                          90400052
.MESG17A MNOTE 12,'SUBPLST REQUIRED WITH KEYLIST'              @G860P31 90450052
.SDEND   MEXIT                                                          90500052
         MEND                                                           90550052
* */                                                                    90600052
* SDUMP: MACRO KEYS(HDR,HDRAD,DCB,ASID,ASIDLST,ECB,SDATA,STORAGE,       90650052
*           LIST,SUMLIST,BUFFER,QUIESCE,BRANCH,LISTA,TYPE,SUMLSTA,      90700052
*           PLISTVER,ID,IDAD,SYMREC,PSWREGS,                            90750052
*           SUSPEND,SUBPLST,KEYLIST,MF,RETCODE,RELATED,SRB); /*  @T2C*/ 90800052
*                                                                       90850052
*        DCL SYSASCE CHAR EXT;    /* GLOBAL FOR SYSSTATE MACRO   @L3A*/ 90900052
*        ANS('?SYSSTATE (TEST);'); /* OBTAIN DEFAULT SYSASCE     @L3A*/ 90950052
*        IF SYSASCE = 'P' THEN    /* INVOKE NORMAL SDUMP         @L3A*/ 91000052
*          ANS('?'||MACLABEL||'SDUMPP '||MACLIST||MACKEYS||';');        91050052
*        ELSE DO;                 /* INVOKE SDUMPX               @L3A*/ 91100052
*          ANS MSG('SDUMPX MACRO SUBSTITUTED FOR SDUMP MACRO'||         91150052
*                  ' BECAUSE ASCENV=AR/ANY SPECIFIED ON PREVIOUSLY'||   91200052
*                  ' ISSUED SYSSTATE MACRO'); /*                 @L3A*/ 91250052
*          ANS('?'||MACLABEL||'SDUMPXP '||MACLIST||MACKEYS||';'); /*    91300052
*                                    INVOKE X-VERSION            @L3A*/ 91350052
*        END;                     /*                             @L3A*/ 91400052
* %END SDUMP;                                                           91450052
