*% GO TO MODCPLS ;   /*                                                 00050000
      MACRO                                                             00100000
&NAME     MODCTB  &ID=,&AREA=,&LEN=,&DISP=,&SEL=,&SEP=,&PID=,&MFG=      00150000
.*                                                                      00200000
         LCLA  &TID,&TMFG,&TOFF,&TAR,&TSEL,&TPID,&TSEP,&TFLAG           00250000
         LCLA  &TLEN,&TDISP                                             00300000
         LCLC  &TOPE,&TADDR,&BADDR                                      00350000
.*                                                                      00400000
.**************************************************************         00450061
*                                                             *@D51MDGL 00500000
.*       IBM VSE / ADVANCED FUNCTIONS                         *@D51MDGL 00550000
*        SUPERVISOR - MODCTB  - 5686-066-06-15G               *@D61DDEM 00600061
.*                                                                      00650000
         AGO   .CPRIGHT                                                 00700000
.*                                                                      00750000
*        LICENSED MATERIALS - PROGRAM PROPERTY OF IBM         *@D51MDGL 00800000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"          *@D51MDGL 00850000
*        5686-066 (C) COPYRIGHT IBM CORP. 1979, 1995          *@D61DDEM 00900061
*        SEE COPYRIGHT INSTRUCTIONS                           *@D51MDGL 00950000
.*                                                                      01000000
.CPRIGHT ANOP                                                           01050000
*                                                             *@D51MDGL 01100000
.**************************************************************         01150061
.*                                                                      01200000
.**** START OF SPECIFICATIONS ***************************************** 01250000
.*                                                                      01300000
.*01* MODULE-TYPE = MACRO                                               01350000
.*                                                                      01400000
.*01* DESCRIPTIVE NAME = MODIFY PUB CONTROL BLOCKS             @D61DDEM 01450061
.*  COPYRIGHT        =  NONE                                            01500000
.*  STATUS           =  NEW MACRO - FIRST RELEASE 34.0                  01550000
.*  FUNCTION         =  MACRO CHECKS USER GIVEN PARAMETERS TO           01600061
.*                      MODIFY A PUB CONTROL BLOCK VIA SVC 98. @D61DDEM 01650061
.*                      A PARAMETER LIST IS BUILT.                      01700061
.*  NOTES            =                                                  01750000
.*  DEPENDENCIES     =                                                  01800000
.*  RESTRICTIONS     =                                                  01850000
.*  REGISTER CONVENT.=  REGISTER 1 USED BY MACRO AS POINTER TO          01900000
.*                      PARAMETER LIST FOR SVC 98                       01950000
.*                      REGISTER 15 USED AS RETURNCODE REGISTER         02000000
.*  PATCH LABEL      =  NONE                                            02050000
.*  MACRO TYPE       =  BILINGUAL                                       02100000
.*  PROCESSOR        =  ASM / PLS2                                      02150000
.*  MACRO SIZE       =                                                  02200000
.*  ATTRIBUTES       =                                                  02250000
.*  ENTRY POINT      =  MODCTB                                          02300000
.*  PURPOSE          =  SEE FUNCTION                                    02350000
.*  LINKAGE          =                                                  02400000
.*  CALLER           =                                                  02450000
.*  INPUT            =  1. ASM :                                        02500000
.* (CALLING SEQUENCE)    LABEL   MODCTB   ID=<PUB2|MNTLIST     @D61DDGL 02533361
.*                                        |MNTNEXT|ATLSETUP>   @D61DDEM 02566661
.*                                        AREA=(NAME1 | (R1) ),         02600000
.*                                        LEN=(NAME2 | (R2) ),          02650000
.*                                        MFG=(NAME6 | (R6) )  (OPT)    02666661
.*  PARAMETERS NOT FOR ID=ATLSETUP, BUT ALL OTHERS:            @D61DDEM 02683261
.*                                        DISP=(NAME3 | (R3) ), (OPT)   02700000
.*                                        SEL=(NAME4 | (R4) ), OR       02750000
.*                                        SEP=(NAME4 | (R4) ),          02800000
.*                                        PID=(NAME5 | (R5) ), (OPT)    02850000
.*                      2. PLS :                                        02950000
.*                      ?LABEL:  MODCTB   ID<(PUB2)|(MNTLIST)|(MNTNEXT) 02983361
.*                                        |(ATLSETUP)>         @D61DDEM 03016661
.*                                        AREA((NAME1) | ((R1)) )       03050000
.*                                        LEN((NAME2) | ((R2)) )        03100000
.*                                        DISP((NAME2) | ((R2)) )       03150000
.*                                        SEL((NAME4) | ((R4)) ) OR     03200000
.*                                        SEP((NAME4) | ((R4)) )        03250000
.*                                        PID((NAME5) | ((R5)) ) (OPT)  03300000
.*                                        MFG((NAME6) | ((R6)) );(OPT)  03350000
.*                      OPERANDS :                                      03400000
.*                      ID = INDICATES REQUESTED INFORMATION            03450000
.*                      AREA = ADDR WHERE INFORMATION IS TO RETRIEVE    03500000
.*                      LEN  = LENGTH OF AREA                           03550000
.*                      DISP = DISPLACEMENT WITHIN PUB2 TABLE           03600000
.*                             (DEFAULT IS ZERO)                        03650000
.*                      SEL  = ADDR OF HALFWORD CONTAINING LOGICAL UNIT 03700000
.*                      SEP  = ADDR OF HALFWORD CONTAINING PHYSICAL     03750000
.*                             UNIT ('CUU')                             03800000
.*                      PID  = ADDR OF HALFWORD CONTAINING THE PIK      03850000
.*                             (DEFAULT : PIK OF PART. OF ISSUING PROG) 03900000
.*                      MFG  = ADDR OF 16 BYTE WORKAREA WHERE THE       03950000
.*                             PARMLIST FOR SVC IS TO BE STORED.        04000000
.*                                                                      04050000
.*  OUTPUT           =  PARMLIST OF FOLLOWING FORMAT GENERATED :        04100000
.*                                                                      04150000
.*           REG1 --> 0 -------------------------------------           04200000
.*                      |  ID    |  FLAG  |   RESERVED      |           04250000
.*                    4 -------------------------------------           04300000
.*                      |    LENGTH       |   DISPLACEMENT  |           04350000
.*                    8 -------------------------------------           04400000
.*                      |         ADDR (AREA)               |           04450000
.*                   12 -------------------------------------           04500000
.*                      |         ADDR ((SEL) | (SEP))      |           04550000
.*                   16 -------------------------------------           04600000
.*                      |         ADDR (PIK)                |           04650000
.*                      -------------------------------------           04700000
.*                                                                      04750000
.*  EXIT NORMAL      =  COMPILER :                                      04800000
.*                      PARMLIST GENERATED                              04850000
.*                      EXECUTION:                                      04900000
.*                      REGISTER 15  =  0                               04950000
.*  EXIT ERROR       =  COMPILER :                                      05000000
.*                      MNOTES INDICATING THE ERROR                     05050000
.*                      EXECUTION:                                      05100000
.*                      REGISTER 15  =  4    INVALID PIK SPECIFIED      05150000
.*                                      8    LOGICAL OR PHYSICAL UNIT   05200000
.*                                           NOT SUPPORTED              05250000
.*                                     12    LOGICAL UNIT NOT ASSIGNED  05300000
.*                                     16    INVALID LENGTH OR DISP-    05350000
.*                                           SPECIFICATION              05400000
.*  EXTERNAL REFEREN.=  NONE                                            05450000
.*  ROUTINES         =  SVC 98                                          05500000
.*  DATA AREAS       =  NONE                                            05550000
.*  CONTROL BLOCKS   =  NONE                                            05600000
.*  TABLES           =  OWN TABLE GENERATED                             05650000
.*  MACROS           =  NONE                                            05700000
.*  CHANGE ACTIVITIES=  NEW MACRO   FIRST RELEASE 34           @D34YDWK 05750000
.*  MODIFIED REGISTER=  REGISTER 1 , 15                                 05800000
.*                      ID=ATLSETUP ADDED                      @D61DDEM 05850061
.*                                                                      05900000
.*                                                                      05950000
.** END OF SPECICATIONS *********************************************** 06000000
.*                                                                      06050000
.********************************************************************** 06100000
.*                                                                      06150000
.* CHECK FOR NEEDED OPERANDS,IF NOT SUPPLIED SUPPRESS MACRO-GENERATION  06200000
.*                                                                      06250000
.********************************************************************** 06300000
         AIF   (T'&ID NE 'O').CHAREA                                    06350000
&TOPE    SETC  'ID'                                                     06400000
.NOTE1   MNOTE 8,'&TOPE-OPERAND NOT GIVEN,GENERATION SUPPRESSED'        06450000
         MEXIT                                                          06500000
.CHAREA  ANOP                                                           06550000
         AIF   (T'&AREA NE 'O').CHLEN                                   06600000
&TOPE    SETC  'AREA'                                                   06650000
         AGO   .NOTE1                                                   06700000
.CHLEN   ANOP                                                           06750000
         AIF   (T'&LEN NE 'O').CHSEL                                    06800000
&TOPE    SETC  'LEN'                                                    06850000
         AGO   .NOTE1                                                   06900000
.CHSEL   ANOP                                                           06950000
         AIF   ('&ID' EQ 'ATLSETUP').CHID4                              06975061
         AIF   (T'&SEL NE 'O').CHSEP                                    07000000
         AIF   (T'&SEP NE 'O').CHID1                                    07050000
&TOPE    SETC  'SEL- OR'.' SEP'                                         07100000
         AGO   .NOTE1                                                   07150000
.CHSEP   ANOP                                                           07200000
         AIF   (T'&SEP EQ 'O').CHID1                                    07250000
&TOPE    SETC  'SEL- AND'.' SEP-'                                       07300000
.NOTE2   MNOTE 8,'&TOPE OPERAND GIVEN, GENERATION SUPPRESSED'           07350000
         MEXIT                                                          07400000
.********************************************************************** 07450000
.*                                                                      07500000
.* CHECK VALIDITY OF GIVEN ID-OPERAND AND SET ID-FLAG                   07550000
.*                                                                      07600000
.********************************************************************** 07650000
.CHID1   ANOP                                                           07700000
         AIF   ('&ID' NE 'PUB2').CHID2                                  07750061
&TID     SETA  240                                                      07800000
         AGO   .CHMFG                                                   07807161
.CHID2   AIF   ('&ID' NE 'MNTLIST').CHID3                               07814261
&TID     SETA  241                                                      07821361
         AGO   .CHMFG                                                   07828461
.CHID3   AIF   ('&ID' NE 'MNTNEXT').CHID4                               07835561
&TID     SETA  242                                                      07842661
         AGO   .CHMFG                                                   07850000
.CHID4   AIF   ('&ID' NE 'ATLSETUP').CHID0                     @D61DDEM 07862561
&TID     SETA  243                                             @D61DDEM 07875061
&TOPE    SETC  'SEL- OR'.' SEP-'                               @D61DDEM 07877561
         AIF   (T'&SEL NE 'O' OR T'&SEP NE 'O').NOTE2          @D61DDEM 07880061
&TOPE    SETC  'PID- OR'.'DISP'                                @D61DDEM 07882561
         AIF   (T'&PID NE 'O' OR T'&DISP NE 'O').NOTE2         @D61DDEM 07885061
         AGO   .CHMFG                                          @D61DDEM 07887561
.CHID0   ANOP                                                           07900000
         MNOTE 8,'UNKNOWN ID-OPERAND GIVEN,GENERATION SUPPRESSED'       07950000
         MEXIT                                                          08000000
.********************************************************************** 08050000
.*                                                                      08100000
.* CHECK IF USERAREA FOR PARAMETER-LIST GIVEN  (MFG=OPERAND)            08150000
.*                                                                      08200000
.********************************************************************** 08250000
.CHMFG   ANOP                                                           08300000
         AIF   (T'&MFG EQ 'O').NOMFG       NO MFG-PARM,BUILD INLINECODE 08350000
&NAME    DS    0H                          MACRO ALIGNMENT              08400000
         AIF   ('&MFG'(1,1) EQ '(').RMFG   REGISTER FORMAT              08450000
&TADDR   SETC  '+'.'&MFG'                  USERAREA ADDRESSED BY VAR.   08500000
         MVC   &MFG.(20),MODC&SYSNDX       COPY PARMLIST TO USERAREA    08550000
&TMFG    SETA  1                                                        08600000
         AGO   .HLEN                                                    08650000
.RMFG    ANOP                                                           08700000
         AIF   ('&MFG' EQ '(1)').R1MFG     REGISTER  GIVEN              08750000
&TADDR   SETC  '&MFG'                      USERAREA ADDRESSED BY REG    08800000
         MVC   0(20,&MFG(1)),MODC&SYSNDX   COPY PARMLIST TO USERAREA    08850000
&TMFG    SETA  2                                                        08900000
         AGO   .HLEN                                                    08950000
.R1MFG   ANOP                                                           09000000
&TADDR   SETC  '&MFG'                      USERAREA ADDRESSED BY REG1   09050000
         MVC   0(20,&MFG(1)),MODC&SYSNDX   COPY PARMLIST TO USERAREA    09100000
&TMFG    SETA  3                                                        09150000
         AGO   .HLEN                                                    09200000
.NOMFG   ANOP                                                           09250000
&NAME    CNOP  0,4                         MACRO ALIGNMENT              09300000
&TADDR   SETC  '+MODC'.'&SYSNDX'                                        09350000
&TMFG    SETA  0                                                        09400000
.********************************************************************** 09450000
.*                                                                      09500000
.* CHECK AND SET LEN PARAMETER                                          09550000
.*                                                                      09600000
.********************************************************************** 09650000
.HLEN    ANOP                                                           09700000
&TOFF    SETA  4                                                        09750000
         AIF   ('&LEN'(1,1) EQ '(').RLEN   REGISTER FORM                09800000
&TLEN    SETA  1                           INDICATE VARIABLE PARM       09850000
         AGO   .HDISP                                                   09900000
.RLEN    ANOP                                                           09950000
         STH   &LEN(1),&TOFF.&TADDR        STORE LENGTH                 10000000
.********************************************************************** 10050000
.*                                                                      10100000
.* CHECK AND SET DISP PARAMETER                                         10150000
.*                                                                      10200000
.********************************************************************** 10250000
.HDISP   ANOP                                                           10300000
&TOFF    SETA  6                                                        10350000
         AIF   (T'&DISP NE 'O').CDISP      REGISTER FORM                10400000
&TDISP   SETA  0                           INDICATE DISP OMITTED        10450000
         AGO   .HAREA                                                   10500000
.CDISP   ANOP                                                           10550000
         AIF   ('&DISP'(1,1) EQ '(').RDISP REGISTER FORM                10600000
&TDISP   SETA  1                           INDICATE VARIABLE PARM       10650000
         AGO   .HAREA                                                   10700000
.RDISP   ANOP                                                           10750000
         STH   &DISP(1),&TOFF.&TADDR       STORE DISPLACEMENT           10800000
.********************************************************************** 10850000
.*                                                                      10900000
.* EVALUATE AND SET AREA PARAMETER                                      10950000
.*                                                                      11000000
.********************************************************************** 11050000
.HAREA   ANOP                                                           11100000
&TOFF    SETA  8                                                        11150000
         AIF   ('&AREA'(1,1) EQ '(').RAR   REGISTER FORM                11200000
&TAR     SETA  1                           INDICATE VARIABLE PARM       11250000
         AGO   .HSEL                                                    11300000
.RAR     ANOP                                                           11350000
         ST    &AREA(1),&TOFF.&TADDR       STORE AREA ADDRESS           11400000
.********************************************************************** 11450000
.*                                                                      11500000
.* EVALUATE AND SET SEL PARAMETER                                       11550000
.*                                                                      11600000
.********************************************************************** 11650000
.HSEL    ANOP                                                           11700000
&TOFF    SETA  12                                                       11750000
         AIF   (T'&SEL EQ 'O').HSEP                                     11800000
&TFLAG   SETA  0                           SET FLAG FOR LOGICAL UNIT    11850000
         AIF   ('&SEL'(1,1) EQ '(').RSEL   REGISTER FORM                11900000
&TSEL    SETA  1                           INDICATE VARIABLE PARM       11950000
         AGO   .HPID                                                    12000000
.RSEL    ANOP                                                           12050000
         ST    &SEL(1),&TOFF.&TADDR        STORE SEL-ADDRESS            12100000
         AGO   .HPID                       GO CHECK PID OPERAND         12150000
.********************************************************************** 12200000
.*                                                                      12250000
.* EVALUATE AND SET SEP PARAMETER                                       12300000
.*                                                                      12350000
.********************************************************************** 12400000
.HSEP    ANOP                                                           12450000
         AIF   (T'&SEP EQ 'O').HPID                            @D61DDEM 12475061
&TFLAG   SETA  1                           INDICATE PHYSICAL UNIT       12500000
         AIF   ('&SEP'(1,1) EQ '(').RSEP   REGISTER FORM                12550000
&TSEP    SETA  1                           INDICATE VARIABLE PARM       12600000
         AGO   .HPID                                                    12650000
.RSEP    ANOP                                                           12700000
         ST    &SEP(1),&TOFF.&TADDR        STORE SEP-ADDRESS            12750000
&TSEP    SETA  2                           INDICATE REG.NOTAT.          12800000
.********************************************************************** 12850000
.*                                                                      12900000
.* EVALUATE AND SET PID PARAMETER                                       12950000
.*                                                                      13000000
.********************************************************************** 13050000
.HPID    ANOP                                                           13100000
&TOFF    SETA  16                                                       13150000
         AIF   (T'&PID EQ 'O').GENBR                                    13200000
         AIF   (&TSEP EQ 0).GPID           SEL OPERAND GIVEN            13250000
.NOTE3   MNOTE 1,'PID-OPERAND IGNORED WHILE SEP SPECIFIED'              13300000
         AGO   .GENBR                      NO SKIP PID PROCESSING       13350000
.GPID    ANOP                                                           13400000
         AIF   ('&PID'(1,1) EQ '(').RPID   REGISTER FORM                13450000
&TPID    SETA  1                           INDICATE VARIABLE PARM       13500000
         AGO   .GENBR                                                   13550000
.RPID    ANOP                                                           13600000
         ST    &PID(1),&TOFF.&TADDR        STORE ADDRESS OF PIK         13650000
.********************************************************************** 13700000
.*                                                                      13750000
.* GENERATE BRANCH INSTRUCTION                                          13800000
.*                                                                      13850000
.********************************************************************** 13900000
.GENBR   ANOP                                                           13950000
&BADDR   SETC  'MODC'.'&SYSNDX'.'+20'                                   14000000
         AIF   (&TMFG NE 0).BR1                                         14050000
         BAL   1,&BADDR                    LOAD PARMLIST ADDR & BRANCH  14100000
         AGO   .GENCON                                                  14150000
.BR1     ANOP                                                           14200000
         AIF   (&TMFG NE 1).BR2                                         14250000
         LA    1,&MFG                      LOAD PARMLIST ADDR.          14300000
         AGO   .BR3                                                     14350000
.BR2     ANOP                                                           14400000
         AIF   (&TMFG NE 2).BR3                                         14450000
         LR    1,&MFG(1)                   LOAD PARMLIST ADDR.          14500000
.BR3     B     &BADDR                      BRANCH AROUND PARMLIST       14550000
.********************************************************************** 14600000
.*                                                                      14650000
.* GENERATE CONSTANTS                                                   14700000
.*                                                                      14750000
.********************************************************************** 14800000
.GENCON  ANOP                                                           14850000
MODC&SYSNDX DC    AL1(&TID)                ID-FLAG                      14900000
         DC    AL1(&TFLAG)                 FLAG LOGICAL | PHYSICAL UNIT 14950000
         DC    AL2(0)                      RESERVED                     15000000
         AIF   (&TLEN EQ 1).GC10                                        15050000
         DC    AL2(0)                      LENGTH OF AREA               15100000
         AGO   .GC20                                                    15150000
.GC10    ANOP                                                           15200000
         DC    AL2(&LEN)                   LENGTH OF AREA               15250000
.GC20    ANOP                                                           15300000
         AIF   (&TDISP EQ 1).GC21                                       15350000
         DC    AL2(0)                      DISPLACEMENT IN PUB2 TABLE   15400000
         AGO   .GC30                                                    15450000
.GC21    ANOP                                                           15500000
         DC    AL2(&DISP)                  DISPLACEMENT IN PUB2 TABLE   15550000
.GC30    ANOP                                                           15600000
         AIF   (&TAR EQ 1).GC31                                         15650000
         DC    AL4(0)                      AREA ADDRESS                 15700000
         AGO   .GC40                                                    15750000
.GC31    ANOP                                                           15800000
         DC    AL4(&AREA)                  AREA ADDRESS                 15850000
.GC40    ANOP                                                           15900000
         AIF   (T'&SEL EQ 'O').GC41        IF PHYSICAL UNIT BRANCH      15950000
         AIF   (&TSEL EQ 1).GC42                                        16000000
         DC    AL4(0)                      LOGICAL UNIT ADDRESS         16050000
         AGO   .GC50                                                    16100000
.GC42    ANOP                                                           16150000
         DC    AL4(&SEL)                   LOGICAL UNIT ADDRESS         16200000
         AGO   .GC50                                                    16250000
.GC41    ANOP                                                           16300000
         AIF   (&TSEP EQ 1).GC43                                        16350000
         DC    AL4(0)                      PHYSICAL UNIT ADDRESS        16400000
         AGO   .GC50                                                    16450000
.GC43    ANOP                                                           16500000
         DC    AL4(&SEP)                   PHYSICAL UNIT ADDRESS        16550000
.GC50    ANOP                                                           16600000
         AIF   (&TPID EQ 1).GC51                                        16650000
         DC    AL4(0)                      POINTER TO PIK               16700000
         AGO   .CLREGF                                                  16750000
.GC51    ANOP                                                           16800000
         DC    AL4(&PID)                   POINTER TO PIK               16850000
.CLREGF  ANOP                                                           16900000
         SR    15,15                       CLEAR RETURN CODE REGISTER   16950000
         SVC   98                          CALL SVC ROUTINE             17000000
         MEND                                                        */ 17050000
*%MODCPLS : ;                                                           17100000
*%MODCTB:  MACRO  KEYS(ID,AREA,LEN,DISP,SEL,SEP,PID,MFG);               17150000
* /*******************************************************************/ 17200000
* /*                                                                 */ 17250000
* /*  LIST MACRO INVOCATION IN SOURCE                       @D61DDEM */ 17253561
* /*                                                                 */ 17257061
* /*******************************************************************/ 17260561
*    ANS ('/* '||MACLABEL||' '||MACNAME||' '||MACLIST||' '||MACKEYS||   17264061
*         '*/') COL(MACLMAR);                                           17267561
* ANS ('/*                                                  */')        17271061
* COL(MACLMAR);                                                         17274561
* ANS ('/*    SUPERVISOR - MODCTB - 5686-066-06-15G         */')        17278061
* COL(MACLMAR);                                                         17281561
* ANS ('/*                                                  */')        17285061
* COL(MACLMAR);                                                         17288561
* /*******************************************************************/ 17292061
* /*                                                                 */ 17295561
* /*  PLS PART OF MODCTB MACRO . DESCRIPTION SEE ASM PART            */ 17300000
* /*                                                                 */ 17350000
* /*******************************************************************/ 17400000
*    DCL (IKEY,ILIST,CMFG,CDIS,IDIS)CHAR;  /*                        */ 17450000
*    DCL (CAR,CPID,CSEL,CSEP,CLEN)CHAR;    /*  DCL FOR VALUES        */ 17500000
*    DCL (IID,IFLAG,IAR,IPID,ISEL,ILEN)CHAR;/*  DCL FOR INTERNAL     */ 17550000
*    DCL (IRES,IREG)CHAR;                  /*  USE                   */ 17600000
*    DCL (TID,TFLAG)FIXED;                 /*                        */ 17650000
* /*******************************************************************/ 17700000
* /*                                                                 */ 17750000
* /* CHECK REQUIRED PARAMETERS GIVEN                                 */ 17800000
* /*                                                                 */ 17850000
* /*******************************************************************/ 17900000
*    IF NUMBER(ID) = 0  THEN               /* ID GIVEN               */ 17950000
*      DO;                                 /* NO                     */ 18000000
*        IKEY = 'ID';                      /* SET PARM FOR MNOTE     */ 18050000
*        GO TO MERR1;                      /* WRITE MNOTE            */ 18100000
*      END;                                /*                        */ 18150000
*     ELSE;                                /*                        */ 18200000
*    IF NUMBER(AREA) = 0 THEN              /* AREA GIVEN             */ 18250000
*      DO;                                 /* NO                     */ 18300000
*        IKEY = 'AREA';                    /* SET PARM FOR MNOTE     */ 18350000
*        GO TO MERR1;                      /* WRITE MNOTE            */ 18400000
*      END;                                /*                        */ 18450000
*     ELSE;                                /*                        */ 18500000
*    IF NUMBER(LEN) = 0 THEN               /* LENGTH GIVEN           */ 18550000
*      DO;                                 /* NO                     */ 18600000
*        IKEY = 'LEN';                     /* SET PARM FOR MNOTE     */ 18650000
*        GO TO MERR1;                      /* WRITE MNOTE            */ 18700000
*      END;                                /*                        */ 18750000
*     ELSE                                 /*                        */ 18800000
*      DO;                                 /* SAVE AREA      @D35YDWK*/ 18850000
*        CLEN = LEN(1);                    /* LENGTH WITHOUT @D35YDWK*/ 18900000
*      END;                                /* PARENTHESES    @D35YDWK*/ 18950000
* /* CHECK PARAMETERS NOT SUPPORTED FOR ID=ATLSETUP          @D61DDEM*/ 18952061
*    IF ID(1) = 'ATLSETUP' THEN DO;        /* CHECK PARM FOR ATLSETUP*/ 18954061
*     IF NUMBER(DISP) ¬=0 THEN             /* DISP NOT SUP.  @D61DDEM*/ 18956061
*       DO;                                /*                @D61DDEM*/ 18958061
*         IKEY = 'DISP';                   /* SET PARM F.MSG @D61DDEM*/ 18960061
*         GO TO MERR3;                     /* WRITE MNOTE    @D61DDEM*/ 18962061
*       END;                               /*                @D61DDEM*/ 18964061
*     IF NUMBER(PID) ¬=0 THEN              /* PID NOT SUPP.  @D61DDEM*/ 18966061
*       DO;                                /*                @D61DDEM*/ 18968061
*         IKEY = 'PID';                    /* SET PARM F.MSG @D61DDEM*/ 18970061
*         GO TO MERR3;                     /* WRITE MNOTE    @D61DDEM*/ 18972061
*       END;                               /*                @D61DDEM*/ 18974061
*     IF NUMBER(SEL) ¬=0 THEN              /* SEL NOT SUPP.  @D61DDEM*/ 18976061
*       DO;                                /*                @D61DDEM*/ 18978061
*         IKEY = 'SEL';                    /* SET PARM F.MSG @D61DDEM*/ 18980061
*         GO TO MERR3;                     /* WRITE MNOTE    @D61DDEM*/ 18982061
*       END;                               /*                @D61DDEM*/ 18984061
*     IF NUMBER(SEP) ¬=0 THEN              /* SEP NOT SUPP.  @D61DDEM*/ 18986061
*       DO;                                /*                @D61DDEM*/ 18988061
*         IKEY = 'SEP';                    /* SET PARM F.MSG @D61DDEM*/ 18990061
*         GO TO MERR3;                     /* WRITE MNOTE    @D61DDEM*/ 18992061
*       END;                               /*                @D61DDEM*/ 18994061
*    END ;                                 /*                @D61DDEM*/ 18994861
*    IF ID(1) = 'ATLSETUP' THEN            /* CHECK PARM FOR ATLSETUP*/ 18995661
*      GO TO CHID;                         /* SKIP CHECK FOR @D61DDEM*/ 18996461
* /*                                          OTHER FUNCTIONS@D61DDEM*/ 18997261
* /* CHECK PARAMETERS FOR OTHER FUNCTIONS                    @D61DDEM*/ 18998061
*    IF NUMBER(DISP) ¬= 0 THEN             /* IF DISP SPEC.: @D35YDWK*/ 19000000
*      DO;                                 /* IF EXTRA PARENS@D35YDWK*/ 19050000
*       IF DISP(1,1:1) = '(' THEN          /* SAVE DISP.     @D35YDWK*/ 19100000
*          CDIS = DISP(1,1);               /* WITHOUT THEM   @D35YDWK*/ 19150000
*       ELSE                               /* OTHERWISE      @D35YDWK*/ 19200000
*         DO;                              /* SAVE           @D35YDWK*/ 19250000
*           CDIS = DISP(1);                /* DISPLACEMENT   @D35YDWK*/ 19300000
*         END;                             /* VALUE          @D35YDWK*/ 19350000
*      END;                                /* END DISP       @D35YDWK*/ 19400000
*     ELSE ;                               /* DISP OMITTED   @D35YDWK*/ 19450000
*    IF NUMBER(SEL) = 0 THEN               /* SEL GIVEN              */ 19500000
*      DO;                                 /* NO                     */ 19550000
*       IF NUMBER(SEP) = 0 THEN            /* SEP GIVEN              */ 19600000
*         DO;                              /* NO                     */ 19650000
*          IKEY = 'SEL- OR SEP';           /* SET IKEY VALUE FOR MSG */ 19700000
*          GO TO MERR1;                    /* WRITE MNOTE            */ 19750000
*         END;                             /*                        */ 19800000
*        ELSE                              /* YES                    */ 19850000
*         GO TO CHID;                      /* GO CHECK ID            */ 19900000
*      END ;                               /*                        */ 19950000
*     ELSE                                 /* YES SEL GIVEN          */ 20000000
*      DO;                                 /*                        */ 20050000
*       IF NUMBER(SEP) ¬= 0 THEN           /* SEP ALSO GIVEN         */ 20100000
*         DO;                              /* YES                    */ 20150000
*          IKEY = 'SEL- AND SEP-';         /* SET IKEY FOR MNOTE     */ 20200000
*          GO TO MERR2;                    /* GO WRITE MSG           */ 20250000
*         END;                             /*                        */ 20300000
*        ELSE                              /*                        */ 20350000
*         GO TO CHID ;                     /* GO CHECK ID            */ 20400000
*      END;                                /*                        */ 20450000
* MERR1:                                   /* WRITE MNOTE FOR        */ 20500000
* ANS MSG('IKEY OPERAND NOT GIVEN,GENERATION SUPPRESSED;')RESCAN ;      20550000
* RETURN CODE(8);                          /* MISSING OPERAND        */ 20600000
* MERR2:                                   /* WRITE MNOTE FOR        */ 20650000
* ANS MSG('IKEY OPERAND GIVEN,GENERATION SUPPRESSED;')RESCAN ;          20700000
* RETURN CODE(8);                          /* SEL AND SEP GIVEN      */ 20750000
* MERR3:                                   /* WRITE MNOTE FOR        */ 20762561
* ANS MSG('IKEY OPERAND NOT SUPPORTED FOR ID=ATLCUU;')RESCAN ;          20775061
* RETURN CODE(8);                          /* NOT SUPPORTED OPERANDS */ 20787561
* /*******************************************************************/ 20800000
* /*                                                                 */ 20850000
* /*  CHECK VALIDITY OF GIVEN ID                                     */ 20900000
* /*                                                                 */ 20950000
* /*******************************************************************/ 21000000
* CHID :                                   /* CHECK ID VALIDITY      */ 21050000
*    IF ID(1) = 'PUB2' THEN                /*                        */ 21100000
*       TID = 240 ;                        /* SET ID-FLAG            */ 21150000
*     ELSE                                 /* ID IS FOR MOUNT LIST   */ 21157161
*    IF ID(1) = 'MNTLIST' THEN             /*                        */ 21164261
*       TID = 241 ;                        /* SET ID-FLAG            */ 21171361
*     ELSE                                 /* ID IS FOR MOUNT NEXT   */ 21178461
*    IF ID(1) = 'MNTNEXT' THEN             /*                        */ 21185561
*       TID = 242 ;                        /* SET ID-FLAG            */ 21192661
*     ELSE                                 /* ID IS FOR ATLSETUP     */ 21204061
*    IF ID(1) = 'ATLSETUP' THEN            /*               @D61DDEM */ 21215461
*       TID = 243 ;                        /* SET ID-FLAG   @D61DDEM */ 21226861
*     ELSE                                 /* ID NOT VALID           */ 21238261
*      DO;                                 /* WRITE MSG              */ 21250000
* ANS MSG('INVALID ID-OPERAND GIVEN,GENERATION SUPPRESSED;')NORESCAN;   21300000
* RETURN CODE(8);                          /* EXIT TO CALLER         */ 21350000
*      END;                                /*                        */ 21400000
* /*******************************************************************/ 21450000
* /*                                                                 */ 21500000
* /* SET NAMES OF DCL FIELDS AND REGISTER WITH MACINDEX              */ 21550000
* /*                                                                 */ 21600000
* /*******************************************************************/ 21650000
*    ILIST ='MODC'||MACINDEX;              /* SET NAME OF TABLE      */ 21700000
*    IID ='MODI'||MACINDEX;                /* SET NAME OF ID FLD     */ 21750000
*    IFLAG ='MODF'||MACINDEX;              /* SET NAME OF FLAG FLD   */ 21800000
*    IRES ='MODX'||MACINDEX;               /* SET NAME RESERVED FLD  */ 21850000
*    ILEN ='MODL'||MACINDEX;               /* SET NAME OF LENGTH FLD */ 21900000
*    IDIS ='MODD'||MACINDEX;               /* SET NAME OF DISPL.FLD  */ 21950000
*    IAR ='MODA'||MACINDEX;                /* SET NAME OF AREA FLD   */ 22000000
*    ISEL ='MODU'||MACINDEX;               /* SET NAME OF UNIT FLD   */ 22050000
*    IPID ='MODP'||MACINDEX;               /* SET NAME OF PIK FLD    */ 22100000
*    IREG ='MOD1'||MACINDEX;               /* SET NAME OF REGISTER1  */ 22150000
* /*******************************************************************/ 22200000
* /*                                                                 */ 22250000
* /*  DECLARE PARAMETER LIST AND REGISTER 1 AND SET ADDRESS          */ 22300000
* /*                                                                 */ 22350000
* /*******************************************************************/ 22400000
*    ANS ('DCL IREG REG(1) PTR(31);')RESCAN SKIP COL(10);               22450000
*    ANS ('/* MODCTB PTR TO PARMLST  */')COL(41);                       22500000
*    IF NUMBER(MFG) = 0 THEN               /* MFG = 0 INLINE         */ 22550000
*    DO;                                   /*                        */ 22600000
*    ANS ('DCL 1 ILIST BDY(WORD),')RESCAN SKIP COL(10);                 22650000
*    ANS ('/* MODCTB PARMLIST */') COL(50);                             22700000
*    END;                                  /*                        */ 22750000
*   ELSE                                   /* CHECK MFG OPERAND      */ 22800000
*    DO;                                   /*                        */ 22850000
*    ANS ('DCL 1 ILIST BASED(*),')RESCAN SKIP COL(10);                  22900000
*    ANS ('/* MODCTB PARMLIST */') COL(50);                             22950000
*    END;                                  /*                        */ 23000000
*    ANS ('5 IID PTR(8),')RESCAN SKIP COL(15);                          23050000
*    ANS ('/* ID-FLAG                */')COL(41);                       23100000
*    ANS ('5 IFLAG PTR(8),')RESCAN SKIP COL(15);                        23150000
*    ANS ('/* LOGICAL | PHYSIC.UNIT  */')COL(41);                       23200000
*    ANS ('5 IRES FIXED(16),')RESCAN SKIP COL(15);                      23250000
*    ANS ('/* RESERVED               */')COL(41);                       23300000
*    ANS ('5 ILEN FIXED(16),')RESCAN SKIP COL(15);                      23350000
*    ANS ('/* LENGTH OF AREA         */')COL(41);                       23400000
*    ANS ('5 IDIS FIXED(16),')RESCAN SKIP COL(15);                      23450000
*    ANS ('/* DISPLACEMENT FOR PUB2  */')COL(41);                       23500000
*    ANS ('5 IAR PTR(31),')RESCAN SKIP COL(15);                         23550000
*    ANS ('/* ADDRESS OF AREA        */')COL(41);                       23600000
*    ANS ('5 ISEL PTR(31),')RESCAN SKIP COL(15);                        23650000
*    ANS ('/* ADDRESS OF SPEC. UNIT  */')COL(41);                       23700000
*    ANS ('5 IPID PTR(31);')RESCAN SKIP COL(15);                        23750000
*    ANS ('/* ADDRESS OF SPEC. PIK   */')COL(41);                       23800000
*    ANS ('RFY IREG RSTD;')RESCAN SKIP COL(MACCOL);                     23850000
*    ANS ('/* RESTRICTED USE OF REG1 */')COL(41);                       23900000
*    IF NUMBER(MFG) = 0 THEN               /* MFG = 0 INLINE         */ 23950000
*    DO;                                   /*                        */ 24000000
*    ANS ('IREG=ADDR(ILIST);')RESCAN SKIP COL(MACCOL);                  24050000
*    ANS ('/* SET PARMLIST ADDR  */') COL(41);                          24100000
*    END;                                  /*                        */ 24150000
*   ELSE                                   /* CHECK MFG OPERAND      */ 24200000
*    DO;                                   /* IF REGISTER    @D35YDWK*/ 24250000
*    IF MFG(1,1:1) = '(' THEN              /* NOTATION USED  @D35YDWK*/ 24300000
*        CMFG = MFG(1);                    /* SAVE IT        @D35YDWK*/ 24350000
*       ELSE                               /*                @D35YDWK*/ 24400000
*        DO;                               /*                @D35YDWK*/ 24450000
*         IF INDEX(MFG(1),'ADDR(') ¬= 0 THEN /* IF PTR EXPR. @D35YDWK*/ 24500000
*            CMFG = MFG(1);                /* SAVE IT        @D35YDWK*/ 24550000
*           ELSE                           /* ELSE CREATE    @D35YDWK*/ 24600000
*            CMFG = 'ADDR('||MFG(1)||')';  /* PTR EXPRESSION @D35YDWK*/ 24650000
*        END;                              /*                @D35YDWK*/ 24700000
*    ANS ('IREG = CMFG;')RESCAN SKIP COL(MACCOL);                       24750000
*    ANS ('/* SET PARMLIST ADDR  */') COL(41);                          24800000
*    ANS ('RFY ILIST BASED(IREG);')RESCAN SKIP COL(MACCOL);             24850000
*    ANS ('/* ADRESSABLE PARMLIST*/') COL(41);                          24900000
*    END;                                   /*                       */ 24950000
* /*******************************************************************/ 25000000
* /*                                                                 */ 25050000
* /*  SET ID FOR SVC ROUTINE                                         */ 25100000
* /*                                                                 */ 25150000
* /*******************************************************************/ 25200000
*    ANS ('IID = TID;')RESCAN SKIP COL(MACCOL);                         25250000
*    ANS ('/* SET ID FOR SVC 98  */') COL(41);                          25300000
* /*******************************************************************/ 25350000
* /*                                                                 */ 25400000
* /*  SET LENGTH OPERAND                                             */ 25450000
* /*                                                                 */ 25500000
* /*******************************************************************/ 25550000
*    ANS ('ILEN = CLEN;')RESCAN SKIP COL(MACCOL);                       25600000
*    ANS ('/* SET LENGTH PARM    */') COL(41);                          25650000
* /*******************************************************************/ 25700000
* /*                                                                 */ 25750000
* /*  SET DISP OPERAND                                               */ 25800000
* /*                                                                 */ 25850000
* /*******************************************************************/ 25900000
*    IF NUMBER(DISP) = 0 THEN              /* IF DISP = OMITTED      */ 25950000
*       DO;                                /* SET DISP TO ZERO       */ 26000000
*    ANS ('IDIS = 0 ;')RESCAN SKIP COL(MACCOL);                         26050000
*    ANS ('/* SET DISPL. PARM    */') COL(41);                          26100000
*       END;                               /*                        */ 26150000
*      ELSE                                /* NOT OMITTED            */ 26200000
*       DO;                                /* SET SPECIFIED DISP     */ 26250000
*    ANS ('IDIS = CDIS;')RESCAN SKIP COL(MACCOL);                       26300000
*    ANS ('/* SET DISPL. PARM    */') COL(41);                          26350000
*       END;                               /* END DISP               */ 26400000
* /*******************************************************************/ 26450000
* /*                                                                 */ 26500000
* /*  CHECK AND SET USER AREA ADDRESS                                */ 26550000
* /*                                                                 */ 26600000
* /*******************************************************************/ 26650000
*    IF AREA(1,1:1) = '(' THEN             /* REGISTER NOTATION USED */ 26700000
*        CAR = AREA(1,1);                  /* SET REGISTER           */ 26750000
*       ELSE                               /* NOT REGISTER           */ 26800000
*        DO;                               /* CHECK FOR ADDR USED    */ 26850000
*         IF INDEX(AREA(1),'(') ¬= 0 THEN  /* IF YES                 */ 26900000
*             CAR = AREA(1) ;              /* SET ADDR CONSTANT      */ 26950000
*            ELSE                          /* NOT ADDR               */ 27000000
*             CAR = 'ADDR('||AREA(1)||')'; /* SET ADDR CONSTANT      */ 27050000
*        END;                              /*                        */ 27100000
*    ANS ('IAR = CAR ;')RESCAN SKIP COL(MACCOL);                        27150000
*    ANS ('/* MOVE AREA ADDRESS  */') COL(41);                          27200000
* /*******************************************************************/ 27250000
* /*                                                                 */ 27300000
* /*  SET SEL ADDR                                                   */ 27350000
* /*                                                                 */ 27400000
* /*******************************************************************/ 27450000
*    IF NUMBER(SEL) = 0 THEN               /* SEL NOT GIVEN          */ 27500000
*       GO TO SSEP;                        /* BRANCH TO SEP          */ 27550000
*    TFLAG = 0;                            /* FLAG LOGICAL UNIT      */ 27600000
*    IF SEL(1,1:1) = '(' THEN              /* REGISTER NOTATION USED */ 27650000
*        CSEL = SEL(1,1);                  /* SET REGISTER           */ 27700000
*       ELSE                               /* NOT REGISTER           */ 27750000
*        DO;                               /* CHECK FOR ADDR USED    */ 27800000
*         IF INDEX(SEL(1),'(') ¬= 0 THEN   /* IF YES                 */ 27850000
*             CSEL = SEL(1) ;              /* SET ADDR CONSTANT      */ 27900000
*            ELSE                          /* NOT ADDR               */ 27950000
*             CSEL = 'ADDR('||SEL(1)||')'; /* SET ADDR CONSTANT      */ 28000000
*        END;                              /*                        */ 28050000
*    ANS ('ISEL = CSEL;')RESCAN SKIP COL(MACCOL);                       28100000
*    ANS ('/* MOVE SEL ADDRESS   */') COL(41);                          28150000
*    GO TO SFLAG;                          /* GO SET FLAG            */ 28200000
* /*******************************************************************/ 28250000
* /*                                                                 */ 28300000
* /*  SET SEP ADDR                                                   */ 28350000
* /*                                                                 */ 28400000
* /*******************************************************************/ 28450000
* SSEP:                                    /* SET SEP ADDRESS        */ 28500000
*    IF NUMBER(SEP) = 0 THEN               /* SEP NOT GIVEN  @D61DDEM*/ 28516661
*       GO TO SPID;                        /* BRANCH TO PID  @D61DDEM*/ 28533261
*    TFLAG = 1;                            /* FLAG PHYSICAL UNIT     */ 28550000
*    IF SEP(1,1:1) = '(' THEN              /* REGISTER NOTATION USED */ 28600000
*        CSEP = SEP(1,1);                  /* SET REGISTER           */ 28650000
*       ELSE                               /* NOT REGISTER           */ 28700000
*        DO;                               /* CHECK FOR ADDR USED    */ 28750000
*         IF INDEX(SEP(1),'(') ¬= 0 THEN   /* IF YES                 */ 28800000
*             CSEP = SEP(1) ;              /* SET ADDR CONSTANT      */ 28850000
*            ELSE                          /* NOT ADDR               */ 28900000
*             CSEP = 'ADDR('||SEP(1)||')'; /* SET ADDR CONSTANT      */ 28950000
*        END;                              /*                        */ 29000000
*    ANS ('ISEL = CSEP;')RESCAN SKIP COL(MACCOL);                       29050000
*    ANS ('/* MOVE SEP ADDRESS   */') COL(41);                          29100000
* /*******************************************************************/ 29150000
* /*                                                                 */ 29200000
* /*  SET FLAG FOR LOGICAL OR PHYSICAL UNIT                          */ 29250000
* /*                                                                 */ 29300000
* /*******************************************************************/ 29350000
* SFLAG:                                   /*                        */ 29400000
*    ANS ('IFLAG = TFLAG;')RESCAN SKIP COL(MACCOL);                     29450000
*    ANS ('/* SET LOG.|PHYS.UNIT */') COL(41);                          29500000
* /*******************************************************************/ 29550000
* /*                                                                 */ 29600000
* /*  CHECK AND SET PID OPERAND                                      */ 29650000
* /*                                                                 */ 29700000
* /*******************************************************************/ 29750000
* SPID:                                    /* SET PID ADDRESS@D61DDEM*/ 29775061
*    IF NUMBER(PID) = 0 THEN               /* PID OPERAND GIVEN      */ 29800000
*       DO;                                /* NO PID ADDRESS = ZERO  */ 29850000
*    ANS ('IPID = 0;')RESCAN SKIP COL(MACCOL);                          29900000
*    ANS ('/* SET PID ADDRESS    */') COL(41);                          29950000
*       END;                               /*                        */ 30000000
*      ELSE                                /*                        */ 30050000
*       DO;                                /* MOVE GIVEN PID ADDRESS */ 30100000
*        IF TFLAG = 0 THEN                 /* SEL OPERAND SPECIFIED  */ 30150000
*            DO;                           /* YES                    */ 30200000
*             IF PID(1,1:1) = '(' THEN     /* REGISTER NOTATION USED */ 30250000
*                CPID = PID(1,1);          /* SET REGISTER           */ 30300000
*               ELSE                       /* NOT REGISTER           */ 30350000
*                DO;                       /* CHECK FOR ADDR USED    */ 30400000
*                 IF INDEX(PID(1),'(') ¬= 0 THEN   /* IF YES         */ 30450000
*                     CPID = PID(1) ;      /* SET ADDR CONSTANT      */ 30500000
*                    ELSE                  /* NOT ADDR               */ 30550000
*                     CPID = 'ADDR('||PID(1)||')';  /* ADDR CONSTANT */ 30600000
*                END;                      /*                        */ 30650000
*         ANS ('IPID = CPID;')RESCAN SKIP COL(MACCOL);                  30700000
*         ANS ('/* SET PID ADDRESS    */') COL(41);                     30750000
*            END;                          /*                        */ 30800000
*        ELSE                              /* NO SET PID = ZERO      */ 30850000
*         DO;                              /*                        */ 30900000
*         ANS ('IPID = 0;')RESCAN SKIP COL(MACCOL);                     30950000
*         ANS ('/* SET PID ADDRESS    */') COL(41);                     31000000
*         ANS MSG('PID-OPERAND IGNORED WHILE SEP SPECIFIED;')NORESCAN;  31050000
*         END;                             /*                        */ 31100000
*       END;                               /* END PID PROCESSING     */ 31150000
* /*******************************************************************/ 31200000
* /*                                                                 */ 31250000
* /*  EXECUTE SVC 98                                                 */ 31300000
* /*                                                                 */ 31350000
* /*******************************************************************/ 31400000
*    ANS ('GEN (SR    15,15);')NORESCAN SKIP COL(MACCOL);               31450000
*    ANS ('/* CLEAR RETCODE REG. */') COL(41);                          31500000
*    ANS ('SVC(98);')NORESCAN SKIP COL(MACCOL);                         31550000
*    ANS ('/* EXECUTE SVC        */') COL(41);                          31600000
*    ANS ('RFY IREG UNRSTD;')RESCAN SKIP COL(MACCOL);                   31650000
*    ANS ('/* UNRESTRICT REG.1   */') COL(41);                          31700000
* MEND:  RETURN CODE(0);                   /*                        */ 31750000
*%END ;                                    /*                        */ 31800000
