*********************************************************************** 00002600
*                                                                     * 00005200
* MODULE-NAME = NIB                                                   * 00007800
*                                                                     * 00010400
* DESCRIPTIVE-NAME = NODE INFORMATION BLOCK                           * 00013000
*                                                                     * 00015600
* COPYRIGHT: LICENSED MATERIALS - PROPERTY OF IBM                     * 00023400
*                                                                     * 00031200
*            THIS PRODUCT CONTAINS "RESTRICTED MATERIALS OF IBM"      * 00031400
*                                                                     * 00031600
*            5695-117 (C) COPYRIGHT IBM CORP. 1989, 1993.             * 00031800
*            ALL RIGHTS RESERVED.                                     * 00032000
*                                                                     * 00032200
*            U.S. GOVERNMENT USERS RESTRICTED RIGHTS -                * 00032400
*            USE, DUPLICATION OR DISCLOSURE RESTRICTED BY             * 00032600
*            GSA ADP SCHEDULE CONTRACT WITH IBM CORP.                 * 00032800
*                                                                     * 00033000
*            SEE COPYRIGHT INSTRUCTIONS.                              * 00033200
*                                                                     * 00033400
* FUNCTION:  THE NIB MACRO PROVIDES CONTROL BLOCKS THAT ARE USED TO   * 00039000
*     INDICATE TO VTAM WHICH NODE OR NODES ARE TO BE THE OBJECT OF ANY* 00041600
*     GIVEN CONNECTION OR I/O REQUEST                                 * 00044200
*                                                                     * 00046800
* NOTES:  EACH NIB MACRO GENERATES ONE CONTROL BLOCK, CALLED A NODE   * 00049400
*     ENTRY.                                                          * 00052000
*                                                                     * 00054600
* CHANGE-ACTIVITY:                                                    * 00062400
*     NEW MACRO - FIRST RELEASE   31  DOS/VS                          * 00065000
*                                 03  OS/VS1                          * 00067600
*                                 03  OS/VS2                          * 00070200
*     03/21/79 - SNA4.2 - D4651.00                            @G98AKMC* 00072800
*     08/20/79 - SNA4.2 - OZ41382                             @ZA41382* 00075400
*                                                                     * 00078000
* $MAC(NIB),COMP(API),PROD(VTAM): NODE INFORMATION BLOCK              * 00080600
*                                                                     * 00083200
* FLAG REASON   RELEASE DATE   ORIGIN  FLAG DESCRIPTORS               * 00085800
* ---- -------- ------- ------ ------  ---------------------------    * 00088400
* $F1= FM8@@CLD HVT3303 890126 109772: RCR0006 MTS API SUPPORT        * 00091000
* $BB= ACC@@AMS HVT3401 891025 615520: PL/AS CONVERSION               * 00091800
* $B1= AN@@@MST HVT3401 891011 571190: NON-GEN TERMINAL SUPPORT       * 00092600
* $KF= NQNSTG2  NQNAME2 910625 457572: ENHANCED NQN SUPPORT (2)       * 00093100
* $I1= FG@@@MST GENRES  921109 879315: Generic Resource               * 00093300
* $W1= P117054  VMVSCS  941029 947688: Add conditional CS             * 00093400
*                                                                     * 00093600
*********************************************************************** 00096200
*                                                                       00100047
         MACRO                                                          06450047
&LBL     NIB   &NAME=,&MODE=,&USERFLD=,&CONDN=X'0',&PROC=,&LISTEND=YES,*06500047
               &SDT=SYSTEM,&EXLST=0,&RESPLIM=1,&LOGMODE=,&BNDAREA=,    *06505000
               &ENCR=NONE,&MTSAREA=,&ASDAREA=,&NETID=,&GNAME=      @I1C 06510000
*                                                                       06515000
.*A-000000-999999                                              @XL03HLQ 06520047
         LCLC  &CHAR1,&CHAR2,&CHAR3,&CHAR4,&SRCH                        06550047
         LCLC  &SYMCHAR                                                 06560047
         LCLA  &NIBFXD,&DBI,&VALUE,&OFS,&BYTE(4),&INDEX,&KEYI,&T2       06600047
         LCLA  &SYMLEN,&SYMADCD,&SYMRC,&SYMCTR                          06610047
         LCLB  &DBIT(24)                                       @ZA41382 06650047
&BYTE(1) SETA  0                                                        06700047
&BYTE(2) SETA  0                                                        06750047
&BYTE(3) SETA  0                                                        06800047
&BYTE(4) SETA  0                                                        06850047
.*                                                                      06860047
.* **************** ENTER NIB IDENTIFIER AND SUBTYPE ****************   06870047
.*                                                                      06880047
&LBL     DS    0F             ALIGN TO FULLWORD BOUNDARY                06900047
         DC    X'D0',X'00'            ID,SUBTYPE                        06950047
.*                                                                      06960047
.* *********************** TEST CONDN OPERAND ***********************   06970047
.*                                                                      06980047
         AIF   (K'&CONDN EQ 0).NIBOUT1                                  07000047
&CHAR1   SETC  '&CONDN'(1,2)                                            07200047
&NIBFXD  SETA  K'&CONDN                                                 07250047
&CHAR2   SETC  '&CONDN'(&NIBFXD,1)                                      07300047
         AIF   ('&CHAR1' EQ 'C''').NIBCKQ1                              07350047
         AIF   ('&CHAR1' EQ 'X''').NIBCKQ1                              07400047
         AIF   ('&CHAR1' EQ 'F''').NIBCKQ1                              07450047
         AIF   ('&CHAR1' EQ 'H''').NIBCKQ1                              07460047
         AIF   ('&CHAR1' EQ 'A(').NIBCKP1                               07470047
         AIF   ('&CHAR1' EQ 'Y(').NIBCKP1                               07500047
         AIF   ('&CHAR1' LT '0').NIBERU1                                07510047
         AIF   ('&CHAR1' LE '9').NIBNUM1                                07520047
         AIF   ('&CHAR1' LT '00').NIBERU1                               07550047
.NIBNUM1 ANOP                                                           07560047
         DC    AL1(&CONDN)    COND. FIELD SPECIFIED AS NUMERIC          07600047
         AGO   .NIBSYM1                                                 07650047
.NIBERU1 MNOTE 12,'INVALID KEYWORD VALUE CONDN=&CONDN'                  07700047
.NIBOUT1 DC    AL1(0)         COND FIELD DEFAULTED                      07750047
         AGO   .NIBSYM1                                                 07760047
.NIBCKP1 AIF   ('&CHAR2' EQ ')').NIBGOP1                                07800047
         AGO   .NIBERQ1                                                 07850047
.NIBCKQ1 AIF   ('&CHAR2' EQ '''').NIBGOP1                               07900047
.NIBERQ1 MNOTE 12,'INVALID KEYWORD VALUE CONDN=&CONDN'                  08150047
         MNOTE 0,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      08160047
         AGO   .NIBOUT1                                                 08200047
.NIBGOP1 ANOP                                                           08250047
&NIBFXD  SETA  K'&CONDN                                                 08300047
&CHAR3   SETC  '&CONDN'(3,&NIBFXD-3)                                    08350047
&CHAR4   SETC  '&CHAR1'(2,1)                                            08400047
&CHAR1   SETC  '&CHAR1'(1,1)                                            08450047
         DC    &CHAR1.L1&CHAR4&CHAR3&CHAR2 COND FIELD GIVEN/DEFAULT     08500047
.*                                                                      08510047
.* ************** ENTER NIB LENGTH AND COMMUNICATION ID *************   08520047
.*                                                                      08530047
.NIBSYM1 ANOP                                                           08550047
         DC    FL1'64'                LENGTH OF BLOCK                   08600047
         DC    F'0'                   CID - FILLED IN                   08650047
.*                                                                      08660047
.* ********************** TEST USERFLD OPERAND ***********************  08670047
.*                                                                      08680047
         AIF   (K'&USERFLD EQ 0).NIBOUT                                 08700047
&CHAR1   SETC  '&USERFLD'(1,2)                                          08900047
&NIBFXD  SETA  K'&USERFLD                                               08950047
&CHAR2   SETC  '&USERFLD'(&NIBFXD,1)                                    09000047
         AIF   ('&CHAR1' EQ 'C''').NIBCKQ                               09050047
         AIF   ('&CHAR1' EQ 'X''').NIBCKQ                               09100047
         AIF   ('&CHAR1' EQ 'F''').NIBCKQ                               09150047
         AIF   ('&CHAR1' EQ 'A(').NIBCKP                                09200047
         AIF   ('&CHAR1' EQ 'V(').NIBCKP                                09250047
         AIF   ('&CHAR1' LT '0').NIBERU                                 09252047
         AIF   ('&CHAR1' LE '9').NIBNUM                                 09254047
         AIF   ('&CHAR1' LT '00').NIBERU                    @XM36505    09260047
.NIBNUM  ANOP                                                           09270047
         DC    A(&USERFLD)            USER FIELD SPECIFIED AS NUMERIC   09300047
         AGO   .NIBSYM                                                  09350047
.NIBERU  MNOTE 12,'INVALID KEYWORD VALUE USERFLD=&USERFLD'              09400047
.NIBOUT  DC    A(0)                   USER FIELD DEFAULTED              09450047
         AGO   .NIBSYM                                                  09460047
.NIBCKP  AIF   ('&CHAR2' EQ ')').NIBGOP                                 09500047
         AGO   .NIBERQ                                                  09550047
.NIBCKQ  AIF   ('&CHAR2' EQ '''').NIBGOP                                09600047
.NIBERQ  MNOTE 12,'INVALID KEYWORD VALUE USERFLD=&USERFLD'              09650047
         MNOTE 0,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      09850047
         AGO   .NIBOUT                                                  09900047
.NIBGOP  ANOP                                                           09950047
&NIBFXD  SETA  K'&USERFLD                                               10000047
&CHAR3   SETC  '&USERFLD'(3,&NIBFXD-3)                                  10050047
&CHAR4   SETC  '&CHAR1'(2,1)                                            10100047
&CHAR1   SETC  '&CHAR1'(1,1)                                            10150047
         DC    &CHAR1.L4&CHAR4&CHAR3&CHAR2 USER FIELD GIVEN             10200047
.*                                                                      10210047
.* ************************ TEST NAME OPERAND ************************  10220047
.*                                                                      10230047
.NIBSYM  AIF   (K'&NAME EQ 0).NIBNMB  IS NAME SUPPLIED?                 10250047
         DC    CL8'&NAME'             NAME OPERAND SUPPLIED             10300047
         AGO   .NIBCK2                CONTINUE                          10350047
.NIBNMB  ANOP                                                           10400047
         DC    CL8' '                 NAME OPERAND DEFAULTED            10450047
.*                                                                      10460047
.* ************************ TEST MODE OPERAND ************************  10470047
.*                                                                      10480047
.NIBCK2  ANOP                                                           10500047
.NIBMOD  AIF   (K'&MODE EQ 0).NIBDFM     BRANCH IF MODE DEFAULTED       10550047
         DC    CL8'&MODE'             MODE OPERAND SPECIFIED            10600047
.NIBDFM  ANOP                                                           10700047
.*                                                                      10704000
.* ************************ TEST NETID OPERAND ***********************  10708000
.*                                                                      10712000
.NIBNET  AIF   (K'&NETID EQ 0).NIBDEF IS THE NETID SUPPLIED?       @KFA 10714600
         AIF   (K'&MODE NE 0).NIBNE1  MODE ALSO SUPPLIED           @KFA 10717200
         DC    CL8'&NETID'            NETID OPERAND SUPPLIED       @KFA 10720000
         AGO   .NIBPRC1               CONTINUE                     @KFA 10724000
.NIBDEF  ANOP                                                      @KFA 10728000
         AIF   (K'&MODE NE 0).NIBPRC1 ONLY ONE FIELD SUPPORTED     @KFA 10732000
         DC    CL8' '                 MODE OPERAND DEFAULTED            10736000
         AGO   .NIBPRC1               CONTINUE                     @KFA 10740000
.NIBNE1  ANOP                                                      @KFA 10744000
         MNOTE 4,'NETID AND MODE SPECIFIED'                        @KFA 10748000
.*                                                                      10752047
.* ************ SET DEVICE CHARACTERISTICS AREA TO ZEROES ************  10760047
.*                                                                      10770047
.NIBPRC1 ANOP                                                           10800047
         DC    XL8'00'                DEVICE CHARACTERISTICS AREA       10850047
.*                                                                      10860047
.* ***************** TEST PROC(ESSING OPTION) OPERAND ***************** 10870047
.*                                                                      10880047
         AIF   (K'&PROC EQ 0).NIBGNP     DO PROCESS OPERAND IF GIVEN    10900047
&INDEX   SETA  1              INITIALIZE SUBSCRIPT                      10950047
&NIBFXD  SETA  N'&PROC     INITIALIZE LIMIT OF OPERANDS                 11000047
.NPRCLP  ANOP                                                           11050047
&SRCH    SETC  '&PROC(&INDEX)'                                          11100047
         AIF   ('&SRCH' NE 'MSG').NEQU001                               11150047
         AIF   (&DBIT(1)).NPRCERR                                       11200047
&DBIT(1) SETB  1                                                        11250047
&BYTE(4) SETA  &BYTE(4)+4                                               11300047
         AGO   .NPRCUP                                                  11350047
.NPRCERR MNOTE 4,'DUPLICATE PROCESS OPTION-&SRCH'                       11400047
.NPRCUP  ANOP                                                           11450047
&INDEX   SETA  &INDEX+1                                                 11500047
         AIF   (&INDEX LE &NIBFXD).NPRCLP                               11550047
         AGO   .NPRCGEN                                                 11600047
.NEQU001 AIF   ('&SRCH' NE 'TRANS').NEQU002                             11650047
         AIF   (&DBIT(1)).NPRCERR                                       11700047
&DBIT(1) SETB  1                                                        11750047
&BYTE(4) SETA  &BYTE(4)+2                                               11800047
         AGO   .NPRCUP                                                  11850047
.NEQU002 AIF   ('&SRCH' NE 'CONT').NEQU003                              11900047
         AIF   (&DBIT(1)).NPRCERR                                       11950047
&DBIT(1) SETB  1                                                        12000047
&BYTE(4) SETA  &BYTE(4)+1                                               12050047
         AGO   .NPRCUP                                                  12100047
.NEQU003 AIF   ('&SRCH' NE 'BLOCK').NEQU004                             12150047
         AIF   (&DBIT(1)).NPRCERR                                       12200047
&DBIT(1) SETB  1                                                        12250047
&BYTE(4) SETA  &BYTE(4)+8                                               12300047
         AGO   .NPRCUP                                                  12350047
.NEQU004 ANOP                                                           12400047
         AIF   ('&SRCH' NE 'TRUNC').NEQU005                             12450047
         AIF   (&DBIT(2)).NPRCERR                                       12500047
&DBIT(2) SETB  1                                                        12550047
&BYTE(1) SETA  &BYTE(1)+64                                              12600047
         AGO   .NPRCUP                                                  12650047
.NEQU005 ANOP                                                           12700047
         AIF   ('&SRCH' NE 'KEEP').NEQU006                              12750047
         AIF   (&DBIT(2)).NPRCERR                                       12800047
&DBIT(2) SETB  1                                                        12850047
         AGO   .NPRCUP                                                  12900047
.NEQU006 AIF   ('&SRCH' NE 'LGOUT').NEQU007                             12950047
         AIF   (&DBIT(3)).NPRCERR                                       13000047
&DBIT(3) SETB  1                                                        13050047
         AGO   .NPRCUP                                                  13100047
.NEQU007 AIF   ('&SRCH' NE 'NLGOUT').NEQU008                            13150047
         AIF   (&DBIT(3)).NPRCERR                                       13200047
&DBIT(3) SETB  1                                                        13250047
&BYTE(2) SETA  &BYTE(2)+32                                              13300047
         AGO   .NPRCUP                                                  13350047
.NEQU008 AIF   ('&SRCH' NE 'CONFTXT').NEQU009                           13400047
         AIF   (&DBIT(4)).NPRCERR                                       13450047
&DBIT(4) SETB  1                                                        13500047
&BYTE(2) SETA  &BYTE(2)+1                                               13550047
         AGO   .NPRCUP                                                  13600047
.NEQU009 AIF   ('&SRCH' NE 'NCONFTXT').NEQU010                          13650047
         AIF   (&DBIT(4)).NPRCERR                                       13700047
&DBIT(4) SETB  1                                                        13750047
         AGO   .NPRCUP                                                  13800047
.NEQU010 AIF   ('&SRCH' NE 'TMFLL').NEQU011                             13850047
         AIF   (&DBIT(5)).NPRCERR                                       13900047
&DBIT(5) SETB  1                                                        13950047
         AGO   .NPRCUP                                                  14000047
.NEQU011 AIF   ('&SRCH' NE 'NTMFLL').NEQU012                            14050047
         AIF   (&DBIT(5)).NPRCERR                                       14100047
&DBIT(5) SETB  1                                                        14150047
&BYTE(2) SETA  &BYTE(2)+4                                               14200047
         AGO   .NPRCUP                                                  14250047
.NEQU012 AIF   ('&SRCH' NE 'ERPIN').NEQU013                             14300047
         AIF   (&DBIT(6)).NPRCERR                                       14350047
&DBIT(6) SETB  1                                                        14400047
         AGO   .NPRCUP                                                  14450047
.NEQU013 AIF   ('&SRCH' NE 'NERPIN').NEQU014                            14500047
         AIF   (&DBIT(6)).NPRCERR                                       14550047
&DBIT(6) SETB  1                                                        14600047
&BYTE(3) SETA  &BYTE(3)+64                                              14650047
         AGO   .NPRCUP                                                  14700047
.NEQU014 AIF   ('&SRCH' NE 'ERPOUT').NEQU015                            14750047
         AIF   (&DBIT(7)).NPRCERR                                       14800047
&DBIT(7) SETB  1                                                        14850047
         AGO   .NPRCUP                                                  14900047
.NEQU015 AIF   ('&SRCH' NE 'NERPOUT').NEQU016                           14950047
         AIF   (&DBIT(7)).NPRCERR                                       15000047
&DBIT(7) SETB  1                                                        15050047
&BYTE(2) SETA  &BYTE(2)+64                                              15100047
         AGO   .NPRCUP                                                  15150047
.NEQU016 AIF   ('&SRCH' NE 'MONITOR').NEQU017                           15200047
         AIF   (&DBIT(8)).NPRCERR                                       15250047
&DBIT(8) SETB  1                                                        15300047
&BYTE(3) SETA  &BYTE(3)+4                                               15350047
         AGO   .NPRCUP                                                  15400047
.NEQU017 AIF   ('&SRCH' NE 'NMONITOR').NEQU018                          15450047
         AIF   (&DBIT(8)).NPRCERR                                       15500047
&DBIT(8) SETB  1                                                        15550047
         AGO   .NPRCUP                                                  15600047
.NEQU018 AIF   ('&SRCH' NE 'ELC').NEQU019                               15650047
         AIF   (&DBIT(9)).NPRCERR                                       15700047
&DBIT(9) SETB  1                                                        15750047
&BYTE(2) SETA  &BYTE(2)+2                                               15800047
         AGO   .NPRCUP                                                  15850047
.NEQU019 AIF   ('&SRCH' NE 'NELC').NEQU020                              15900047
         AIF   (&DBIT(9)).NPRCERR                                       15950047
&DBIT(9) SETB  1                                                        16000047
         AGO   .NPRCUP                                                  16050047
.NEQU020 AIF   ('&SRCH' NE 'NEIB').NEQU021                              16100047
         AIF   (&DBIT(10)).NPRCERR                                      16150047
&DBIT(10) SETB  1                                                       16200047
         AGO   .NPRCUP                                                  16250047
.NEQU021 AIF   ('&SRCH' NE 'EIB').NEQU022                               16300047
         AIF   (&DBIT(10)).NPRCERR                                      16350047
&DBIT(10) SETB 1                                                        16400047
&BYTE(4) SETA  &BYTE(4)+128                                             16450047
         AGO   .NPRCUP                                                  16500047
.NEQU022 AIF   ('&SRCH' NE 'CA').NEQU023                                16550047
         AIF   (&DBIT(11)).NPRCERR                                      16600047
&DBIT(11) SETB 1                                                        16650047
&BYTE(1) SETA  &BYTE(1)+4                                               16660047
         AGO   .NPRCUP                                                  16700047
.NEQU023 AIF   ('&SRCH' NE 'CS').NEQU024                                16750047
         AIF   (&DBIT(11)).NPRCERR                                      16800047
&DBIT(11) SETB 1                                                        16850047
&BYTE(1) SETA  &BYTE(1)+2                                               16900047
         AGO   .NPRCUP                                                  16950047
.NEQU024 AIF   ('&SRCH' NE 'RPLC').NEQU045                      @W1C    16960000
         AIF   (&DBIT(11)).NPRCERR                                      16970047
&DBIT(11) SETB 1                                                        16980047
&BYTE(1) SETA  &BYTE(1)+1                                               16990047
         AGO   .NPRCUP                                                  16992047
.NEQU045 AIF   ('&SRCH' NE 'CONDCS').NEQU025                    @W1A    16993300
         AIF   (&DBIT(11)).NPRCERR                              @W1A    16994600
&DBIT(11) SETB 1                                                @W1A    16995900
&BYTE(4) SETA  &BYTE(4)+64                                      @W1A    16997200
         AGO   .NPRCUP                                          @W1A    16998500
.NEQU025 AIF   ('&SRCH' NE 'LGIN').NEQU026                              17000047
         AIF   (&DBIT(12)).NPRCERR                                      17050047
&DBIT(12) SETB 1                                                        17100047
         AGO   .NPRCUP                                                  17150047
.NEQU026 AIF   ('&SRCH' NE 'NLGIN').NEQU027                             17200047
         AIF   (&DBIT(12)).NPRCERR                                      17250047
&DBIT(12) SETB 1                                                        17300047
&BYTE(3) SETA  &BYTE(3)+32                                              17350047
         AGO   .NPRCUP                                                  17400047
.NEQU027 AIF   ('&SRCH' NE 'TIMEOUT').NEQU028                           17450047
         AIF   (&DBIT(13)).NPRCERR                                      17500047
&DBIT(13) SETB 1                                                        17550047
         AGO   .NPRCUP                                                  17600047
.NEQU028 AIF   ('&SRCH' NE 'NTIMEOUT').NEQU029                          17650047
         AIF   (&DBIT(13)).NPRCERR                                      17700047
&DBIT(13) SETB 1                                                        17750047
&BYTE(3) SETA  &BYTE(3)+16                                              17800047
         AGO   .NPRCUP                                                  17850047
.NEQU029 AIF   ('&SRCH' NE 'NBINARY').NEQU030                           17900047
         AIF   (&DBIT(14)).NPRCERR                                      17950047
&DBIT(14) SETB 1                                                        18000047
         AGO   .NPRCUP                                                  18050047
.NEQU030  AIF  ('&SRCH' NE 'BINARY').NEQU031                            18100047
         AIF   (&DBIT(14)).NPRCERR                                      18150047
&DBIT(14) SETB 1                                                        18200047
&BYTE(1) SETA  &BYTE(1)+32                                              18250047
         AGO   .NPRCUP                                                  18300047
.NEQU031 AIF   ('&SRCH' NE 'NDFASYX').NEQU032                           18310047
         AIF   (&DBIT(15)).NPRCERR                                      18320047
&DBIT(15) SETB  1                                                       18330047
         AGO   .NPRCUP                                                  18340047
.NEQU032 AIF   ('&SRCH' NE 'DFASYX').NEQU033                            18342047
         AIF   (&DBIT(15)).NPRCERR                                      18344047
&DBIT(15) SETB  1                                                       18346047
&BYTE(1) SETA  &BYTE(1)+16                                              18348047
         AGO   .NPRCUP                                                  18348447
.NEQU033 AIF   ('&SRCH' NE 'NRESPX').NEQU034                            18348547
         AIF   (&DBIT(16)).NPRCERR                                      18348647
&DBIT(16) SETB  1                                                       18348747
         AGO   .NPRCUP                                                  18348847
.NEQU034 AIF   ('&SRCH' NE 'RESPX').NEQU035                 @XL03HMP    18348947
         AIF   (&DBIT(16)).NPRCERR                                      18349347
&DBIT(16) SETB  1                                                       18349447
&BYTE(1) SETA  &BYTE(1)+8                                               18349547
          AGO   .NPRCUP                                                 18350547
.NEQU035 AIF   ('&SRCH' NE 'SYSRESP').NEQU036               @XL03HMP    18351547
         AIF   (&DBIT(17)).NPRCERR                          @XL03HMP    18352547
&DBIT(17) SETB  1                                           @XL03HMP    18353547
         AGO   .NPRCUP                                      @XL03HMP    18354547
.NEQU036 AIF   ('&SRCH' NE 'APPLRESP').NEQU037              @XL03HMP    18355547
         AIF   (&DBIT(17)).NPRCERR                          @XL03HMP    18356547
&DBIT(17) SETB  1                                           @XL03HMP    18357547
&BYTE(2) SETA  &BYTE(2)+16                                  @XL03HMP    18358547
          AGO   .NPRCUP                                     @XL03HMP    18359547
.NEQU037 AIF   ('&SRCH' NE 'NORDRESP').NEQU038              @XL03HMP    18360547
         AIF   (&DBIT(18)).NPRCERR                          @XL03HMP    18361547
&DBIT(18) SETB  1                                           @XL03HMP    18362547
         AGO   .NPRCUP                                      @XL03HMP    18363547
.NEQU038 AIF   ('&SRCH' NE 'ORDRESP').NEQU039               @NEGBIND    18364547
         AIF   (&DBIT(18)).NPRCERR                          @XL03HMP    18365547
&DBIT(18) SETB  1                                           @XL03HMP    18366547
&BYTE(2) SETA  &BYTE(2)+8                                   @XL03HMP    18367547
          AGO   .NPRCUP                                     @XL03HMP    18368547
.NEQU039 AIF   ('&SRCH' NE 'NEGBIND').NEQU040               @NEGBIND    18369547
         AIF   (&DBIT(19)).NPRCERR                          @NEGBIND    18370547
&DBIT(19) SETB  1                                           @NEGBIND    18371547
&BYTE(2) SETA  &BYTE(2)+128                                 @NEGBIND    18372547
          AGO   .NPRCUP                                     @NEGBIND    18373547
.NEQU040 AIF   ('&SRCH' NE 'NNEGBIND').NEQU043              @G98AKMC    18374547
         AIF   (&DBIT(19)).NPRCERR                          @NEGBIND    18375847
&DBIT(19) SETB  1                                           @NEGBIND    18377147
          AGO   .NPRCUP                                     @NEGBIND    18378447
.NEQU043 AIF   ('&SRCH' NE 'CPUID').NEQU044                 @ZA41382    18379947
         AIF   (&DBIT(21)).NPRCERR                          @ZA41382    18380147
&DBIT(21) SETB  1                                           @ZA41382    18380347
          AGO   .NPRCUP                                     @ZA41382    18380547
.NEQU044 AIF   ('&SRCH' NE 'NCPUID').NEQU099                @ZA41382    18380747
         AIF   (&DBIT(21)).NPRCERR                          @ZA41382    18380947
&DBIT(21) SETB  1                                           @ZA41382    18381147
&BYTE(3) SETA  &BYTE(3)+128                                 @ZA41382    18381347
          AGO   .NPRCUP                                     @ZA41382    18381547
.NEQU099  ANOP                                                          18383347
          MNOTE  12,'INVALID PROCESS OPTION-&SRCH'                      18393347
         AGO   .NPRCUP             RETURN TO VALIDATE PARMS @XM36505    18400047
.NPRCGEN ANOP                                                           18450047
         AIF   (&DBIT(1)).NPRCGN2                                       18500047
&DBIT(1) SETB  1                                                        18550047
&BYTE(4) SETA  &BYTE(4)+2                                               18600047
.NPRCGN2 ANOP                                                           18650047
         AIF   (&DBIT(11)).NPRCGN3                                      18660047
&DBIT(11) SETB  1                                                       18670047
&BYTE(1) SETA  &BYTE(1)+1                                               18680047
.NPRCGN3 ANOP                                                           18690047
         DC    AL1(&BYTE(1),&BYTE(2),&BYTE(3),&BYTE(4)) PROCESS OPTIONS 18700047
         AGO   .NIBFLGS                                                 18750047
.NIBGNP  ANOP                 NO PROCESS OPERAND GIVEN. GEN ONE.        18800047
         DC    AL1(1,0,0,2)     PROCESS OPTIONS DEFAULTED.              18850047
.*                                                                      18870047
.* *********************** TEST LISTEND OPERAND *********************** 18880047
.*                                                                      18890047
.NIBFLGS AIF   ('&LISTEND' EQ 'YES').NIBLSY                             18900047
         AIF   ('&LISTEND' EQ 'NO').NIBLSN                              18950047
         MNOTE 12,'INVALID KEYWORD VALUE FOR LISTEND=&LISTEND'          19000047
.NIBLSN  ANOP                                                           19050047
&BYTE(1) SETA  X'80'               MORE NIBS TO FOLLOW                  19100047
         AGO   .NIBSDT                                                  19150047
.NIBLSY  ANOP                                                           19200047
&BYTE(1) SETA  0                   END OF NIB LIST                      19250047
.*                                                                      19252047
.* ************************ TEST SDT OPERAND ************************   19254047
.*                                                                      19256047
.NIBSDT  ANOP                                                           19260047
         AIF   ('&SDT' EQ 'SYSTEM').NIBSYS                              19280047
         AIF   ('&SDT' EQ 'APPL').NIBAPPL                               19290047
         MNOTE 12,'INVALID KEYWORD VALUE FOR SDT=&SDT'                  19292047
.NIBAPPL ANOP                                                           19292447
&BYTE(1) SETA  &BYTE(1)+32         APPLICATION MUST ISSUE SDT MACRO     19292847
.NIBSYS  ANOP                                                           19294047
         AIF   ('&ENCR' EQ 'NONE').NIBENN                               19294347
         AIF   ('&ENCR' EQ 'REQD').NIBENR                               19294647
         AIF   ('&ENCR' EQ 'SEL').NIBENS                                19294947
         MNOTE 12,'INVALID KEYWORD VALUE FOR ENCR=&ENCR'                19295247
         AGO   .NIBENN                                                  19295547
.NIBENR  ANOP                                                           19295847
&BYTE(1) SETA  &BYTE(1)+2                                               19296147
         AGO   .NIBENN                                                  19296447
.NIBENS  ANOP                                                           19296747
&BYTE(1) SETA  &BYTE(1)+4                                               19297047
.NIBENN  ANOP                                                           19297347
         AIF   ('&ASDAREA' EQ '').NIBNDA                           @B1A 19297400
&BYTE(1) SETA  &BYTE(1)+1                                          @B1A 19297500
.NIBNDA  ANOP                                                      @B1A 19297600
         DC    AL1(&BYTE(1))          NIBLIST STATUS, SDT MACRO STATUS  19298047
.*                                      NIBASDPA STATUS            @B1A 19298600
.*                                                                      19299247
.* *********************** ENTER RESERVED BYTE ***********************  19299647
.*                                                                      19299747
.NIBCMN  ANOP                                                           19300047
         DC    X'00'                  RESERVED FOR VTAM                 19350047
.*                                                                      19360047
.* ********************** TEST RESPLIM OPERAND **********************   19370047
.*                                                                      19380047
.NRSPLIM ANOP                                                           19400047
         AIF   ('&RESPLIM' EQ '1').NIBOUT2                              19450047
&CHAR1   SETC  '&RESPLIM'(1,2)                                          19500047
&NIBFXD  SETA  K'&RESPLIM                                               19550047
&CHAR2   SETC  '&RESPLIM'(&NIBFXD,1)                                    19600047
         AIF   ('&CHAR1' EQ 'C''').NIBCKQ2                              19650047
         AIF   ('&CHAR1' EQ 'X''').NIBCKQ2                              19700047
         AIF   ('&CHAR1' EQ 'H''').NIBCKQ2                              19750047
         AIF   ('&CHAR1' EQ 'F''').NIBCKQ2                              19760047
         AIF   ('&CHAR1' EQ 'A(').NIBCKP2                               19770047
         AIF   ('&CHAR1' EQ 'Y(').NIBCKP2                               19800047
         AIF   ('&CHAR1' EQ 'S(').NIBCKP2                               19810047
         AIF   ('&CHAR1' LT '0').NIBERU2                                19820047
         AIF   ('&CHAR1' LE '9').NIBNUM2                                19830047
         AIF   ('&CHAR1' LT '00').NIBERU2                               19850047
.NIBNUM2 ANOP                                                           19860047
         DC    AL2(&RESPLIM)          LIMIT SPECIFIED AS NUMERIC        19900047
         AGO   .NEXLST                                                  19950047
.NIBERU2 MNOTE 12,'INVALID KEYWORD VALUE RESPLIM=&RESPLIM'              20000047
.NIBOUT2 DC    AL2(1)                 LIMIT FIELD DEFAULTED             20050047
         AGO   .NEXLST                                                  20100047
.NIBCKP2 AIF   ('&CHAR2' EQ ')').NIBGOP2                                20150047
         AGO   .NIBERQ2                                                 20200047
.NIBCKQ2 AIF   ('&CHAR2' EQ '''').NIBGOP2                               20250047
.NIBERQ2 MNOTE 12,'INVALID KEYWORD VALUE RESPLIM=&RESPLIM'              20300047
         MNOTE 0,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      20350047
         AGO   .NIBOUT2                                                 20400047
.NIBGOP2  ANOP                                                          20450047
&NIBFXD  SETA  K'&RESPLIM                                               20500047
&CHAR3   SETC  '&RESPLIM'(3,&NIBFXD-3)                                  20550047
&CHAR4   SETC  '&CHAR1'(2,1)                                            20600047
&CHAR1   SETC  '&CHAR1'(1,1)                                            20650047
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2 LIMIT FIELD                  20700047
.*                                                                      20710047
.* ************************ TEST EXLST OPERAND **********************   20720047
.*                                                                      20730047
.NEXLST  ANOP                                                           20750047
         AIF   ('&EXLST' EQ '0').NIBOUT3                                20800047
&CHAR1   SETC  '&EXLST'(1,2)                                            20850047
&NIBFXD  SETA  K'&EXLST                                                 20900047
&CHAR2   SETC  '&EXLST'(&NIBFXD,1)                                      20950047
         AIF   ('&CHAR1' EQ 'C''').NIBCKQ3                              21000047
         AIF   ('&CHAR1' EQ 'X''').NIBCKQ3                              21050047
         AIF   ('&CHAR1' EQ 'F''').NIBCKQ3                              21100047
         AIF   ('&CHAR1' EQ 'A(').NIBCKP3                               21150047
         AIF   ('&CHAR1' EQ 'V(').NIBCKP3                               21160047
&CHAR1   SETC  '&CHAR1'(1,1)                                 @XM39414   21170047
         AIF   ('&CHAR1' LT 'A').NIBERU3                     @XM39414   21175047
         AIF   ('&CHAR1' LE 'I').NIBNUM3                     @XM39414   21180047
         AIF   ('&CHAR1' LT 'J').NIBERU3                     @XM39414   21185047
         AIF   ('&CHAR1' LE 'R').NIBNUM3                     @XM39414   21190047
         AIF   ('&CHAR1' LT 'S').NIBERU3                     @XM39414   21195047
         AIF   ('&CHAR1' LE 'Z').NIBNUM3                     @XM39414   21200047
         AIF   ('&CHAR1' LT '0').NIBERU3                     @XM39414   21205047
         AIF   ('&CHAR1' GT '9').NIBERU3                     @XM39414   21210047
.NIBNUM3 ANOP                                                           21222047
         DC    AL4(&EXLST)            EXLST SPECIFIED AS 0 OR ADDRESS   21230047
         AGO   .NIBSYM3                                                 21240047
.NIBERU3 MNOTE 12,'INVALID KEYWORD VALUE EXLST=&EXLST'                  21242047
.NIBOUT3 DC    AL4(0)                 EXLST FIELD DEFAULTED             21244047
         AGO   .NIBSYM3                                                 21246047
.NIBCKP3 AIF   ('&CHAR2' EQ ')').NIBGOP3                                21248047
         AGO   .NIBERQ3                                                 21248447
.NIBCKQ3 AIF   ('&CHAR2' EQ '''').NIBGOP3                               21600047
.NIBERQ3  MNOTE 12,'INVALID KEYWORD VALUE EXLST=&EXLST'                 21650047
          MNOTE 0,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'     21700047
         AGO   .NIBOUT3                                                 21750047
.NIBGOP3  ANOP                                                          21800047
&NIBFXD  SETA  K'&EXLST                                                 21850047
&CHAR3   SETC  '&EXLST'(3,&NIBFXD-3)                                    21900047
&CHAR4   SETC  '&CHAR1'(2,1)                                            21950047
&CHAR1   SETC  '&CHAR1'(1,1)                                            22000047
         DC    &CHAR1.L4&CHAR4&CHAR3&CHAR2 EXIT FIELD                   22050047
.*                                                                      22060047
.* ********** LOGMODE & GNAME OPERANDS (MUTUALLY EXCLUSIVE) *********** 22070000
.*                                                                      22080047
.NIBSYM3 ANOP                                                           22100047
         AIF   (K'&GNAME EQ 0).NOGNAM     GNAME OMITTED            @I1A 22107600
         AIF   (K'&LOGMODE NE 0).GNCONFL  LOGMODE ALSO SPECIFIED   @I1A 22115200
         DC    CL8'&GNAME'        GNAME                            @I1A 22122800
         AGO   .NIBLMEN                                            @I1A 22130400
.GNCONFL ANOP                             CONFLICTING KEYWORDS     @I1A 22138000
         MNOTE 12,'GNAME AND LOGMODE KEYWORDS MUTUALLY EXCLUSIVE'      X22145600
                                                                   @I1A 22153200
         DC    XL8'0'             LOGMODE                          @I1A 22160800
         AGO   .NIBLMEN                                            @I1A 22168400
.NOGNAM  ANOP                                                      @I1A 22176000
         AIF    (('&LOGMODE' NE '') AND ('&LOGMODE' NE '0')).NIBLMCH   X22183600
                                          LOGMODE NOT OMITTED OR 0 @I1C 22191200
         DC     XL8'0'            LOGMODE                               22200047
         AGO   .NIBLMEN                                                 22250047
.NIBLMCH AIF   ('&LOGMODE' NE 'C'' ''').NIBLMSY                         22300047
         DC    CL8' '             LOGMODE                               22350047
         AGO   .NIBLMEN                                                 22400047
.NIBLMSY ANOP                                                           22450047
         DC    CL8'&LOGMODE'      LOGMODE                               22750047
         AGO   .NIBLMEN                                                 22800047
.NIBLMER MNOTE 12,'INVALID KEYWORD SYNTAX LOGMODE=&LOGMODE'             22850047
.NIBLMEN ANOP                                                           22900047
.*                                                                      22950047
.* ********** BNDAREA & MTSAREA OPERANDS (MUTUALLY EXCLUSIVE) ********* 23000000
.*                                                                      23050047
         AIF   (K'&BNDAREA NE 0).HAVBND                            @F1A 23087500
         AIF   (K'&MTSAREA NE 0).HAVMTS                            @F1A 23125000
         AGO   .BNDDEF                                             @F1A 23162500
.*                                                                      23200047
.HAVBND  AIF   (K'&MTSAREA NE 0).HAVBOTH                           @F1A 23203800
         DC    A(&BNDAREA)        BNDAREA                               23207600
         AGO   .SETASDP                                            @B1C 23211400
.*                                                                      23215200
.HAVMTS  DC    A(&MTSAREA)        MTSAREA                          @F1A 23219000
         AGO   .SETASDP                                            @B1C 23222800
.*                                                                      23226600
.HAVBOTH MNOTE 12,'BNDAREA AND MTSAREA KEYWORDS MUTUALLY EXCLUSIVE'     23230400
.*                                                                 @F1A 23234200
.*                                                                      23238000
.BNDDEF  DC    A(0)               BNDAREA DEFAULT                  @F1A 23241800
.*                                                                      23245600
.* ************************ RESERVED AREA ********************          23250047
.*                                                                      23300047
.SETASDP ANOP                                                      @B1C 23350000
         AIF   ('&ASDAREA' EQ '').NOASDPA                          @B1A 23400000
         DC    A(&ASDAREA)        ASDP AREA                        @B1A 23450000
         AGO   .MACEND                                             @B1A 23500000
.NOASDPA ANOP                                                      @B1A 23550000
         DC    A(0)                                                     23600000
.MACEND  ANOP                                                      @B1A 23650000
         MEND                                                           51450000
