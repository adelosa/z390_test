         MACRO                                                          00050000
&NAME    DTFPR &DEVICE=1403,&DEVADDR=,&IOAREA1=,&IOAREA2=,&WORKA=,&IORE100100000
               G=,&RECFORM=FIXUNB,&BLKSIZE=,&RECSIZE=,&PRINTOV=,&CTLCHR100150000
               =,&CONTROL=,&MODNAME=,&SEPASMB=,&UCS=,&RDONLY=,&STLIST=,100200000
               &FUNC=,&ERROPT=,&ASOCFLE=,&TRC=                 @D14BDBF 00250000
         LCLA  &COL  COLUMN COUNT (MFCM)                             JJ 00300000
         LCLA  &MFSW  SWITCHES                                       JJ 00350000
         LCLA  &HOPPER  HOPPER INDICATOR (MFCM)                      JJ 00400000
         LCLA  &HEADS  PRINT HEAD SPECIFIER (MFCM)                   JJ 00450000
         LCLA  &RCC  READ COMMAND CODE (MFCM)                        JJ 00500000
         LCLA  &PRCC  LOAD PRINT HEAD BUFFER COMMAND CODE            JJ 00550000
         LCLA  &NCH                                                  JJ 00600000
         LCLA  &COR                                            @DL29357 00650000
         LCLA  &AL1,&AL2,&AL8,&AL,&BLKS,&AL9,&ASF,&AL5,&AL6,&T,&E   4-0 00700000
         LCLA  &F,&V                                           @DA01147 00750000
         LCLB  &BTRY                                                3-9 00800000
         LCLC  &CG2,&IOA2,&WKAR,&RECF,&CNTL,&PROV,&IOA1,&RECZ,&IOG,&CG1 00850000
         LCLC  &FUNCT                                               4-0 00900000
         LCLC  &VER3        INDICATOR FOR VERSION3 EXTENSION   @D14BDBF 00950000
.* IBM DISK OPERATING SYSTEM                                            01000000
* IOCS AND DEV INDEPENDENT I/O DTFPR  5686-007-02-C440         @U31TUJS 01050000
.* COPYRIGHT =                                                 @D14ZDKH 01100000
.*        5686-007 (C) COPYRIGHT IBM CORP. 1981,1989           @U31TUJS 01150000
.*        LICENSED MATERIAL - PROGRAM PROPERTY OF IBM          @D14ZDKH 01200000
.*        REFER TO COPYRIGHT INSTRUCTIONS                      @D14ZDHK 01250000
.*        FORM NUMBER G120-2083                                @D14ZDKH 01300000
.*                                                             @D14BDBF 01350000
.************************************************************* @D14BDBF 01400000
.* CHANGE ACTIVITIES STARTING WITH REL. 2.1:                   @D14BDBF 01450000
.*                                                             @D14BDBF 01500000
.* ISP SUPPORT (BLOCKSIZE=300)                                 @D14ADBF 01550000
.* ISP SUPPORT (BLOCKSIZE=300)                                 @D14ZDKH 01600000
.* PRINTER PERFORMANCE IMPROVEMENTS                            @D14BDBF 01650000
.* SET MAX BLKSIZE FOR PRT1 TO 512                             @D51GDAL 01700000
.* &VER3 AND &AL5 HANDLING CORRECTED                           @DA40454 01725052
.*                                                             @D14BDBF 01750000
.************************************************************* @D14BDBF 01800000
         AIF   (K'&NAME LT 8).NAMOK                                     01850000
         MNOTE 9,'FILE NAME EXCEEDS SEVEN CHAR LIMIT, MACRO GENERATION *01900000
               TERMINATED'                                              01950000
         MEXIT                                                          02000000
.NAMOK   ANOP                                                           02050000
&CG1      SETC  '&DEVICE'(1,4)                                          02100000
         AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').JJ10    @DL2994J 02150000
&E       SETA  4                                                     JJ 02200000
         AIF   (T'&CONTROL EQ 'O').JJ00                              JJ 02250000
         MNOTE 0,'INVALID CONTROL PARAMETER. IGNORED'                JJ 02300000
.JJ00    AIF   (T'&CTLCHR EQ 'O').JJ01                               JJ 02350000
         MNOTE 0,'INVALID CTLCHR PARAMETER. IGNORED'                 JJ 02400000
.JJ01    AIF   (T'&PRINTOV EQ 'O').JJ02                              JJ 02450000
         MNOTE 0,'INVALID PRINTOV PARAMETER. IGNORED'                JJ 02500000
.JJ02    AIF   (T'&STLIST EQ 'O').JJ03                               JJ 02550000
         MNOTE 0,'INVALID STLIST PARAMETER. IGNORED'                 JJ 02600000
.JJ03    AIF   (T'&UCS EQ 'O').JJ04                                  JJ 02650000
         MNOTE 0,'INVALID UCS PARAMETER. IGNORED'                    JJ 02700000
.JJ04    AIF   (T'&ERROPT EQ 'O').JJ05                               JJ 02750000
         MNOTE 0,'INVALID  ERROPT PARAMETER. IGNORED'                JJ 02800000
.JJ05    AIF   (K'&DEVICE LT 5).JJ06                                 JJ 02850000
         AIF   ('&DEVICE'(5,1) EQ 'P').JJ10                          JJ 02900000
         AIF   ('&DEVICE'(5,1) NE 'S').JJ06                          JJ 02950000
&HOPPER  SETA  128                                                   JJ 03000000
         AGO   .JJ10                                                 JJ 03050000
.JJ06    MNOTE 0,'INVALID DEVICE SPECIFIED. ''&CG1.P'' ASSUMED'      JJ 03100000
.JJ10    ANOP                                                        JJ 03150000
&AL6     SETA 9                                                     4-0 03200000
         AIF   ('&CG1' EQ '1403' OR '&CG1' EQ '1443' OR '&CG1' EQ '1404*03250000
               ' OR '&CG1' EQ '1445' OR '&CG1' EQ '3211').E00001    3-9 03300000
         AIF  ('&CG1' EQ '3525' OR '&CG1' EQ '2245').E00001         4-0 03350000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').E00001   @DL2994J 03400000
         AIF   ('&CG1' EQ '5203' OR '&CG1' EQ '3203').E00001   @DL29355 03450000
         AIF   ('&CG1' EQ 'PRT1').E00001                       @D14BDBF 03500000
         AIF   ('&CG1' EQ '3800').E00001                       @D14BDBF 03550000
&CG1     SETC  '1403'                                               3-9 03600000
         MNOTE 0,'DEVICE SPECIFIED WRONGLY. 1403 ASSUMED'               03650000
.E00001  ANOP                                                  @D14BDBF 03700000
&VER3    SETC  '1'      INDICATE VERSION3 EXTENSION IN DTFPR   @D14BDBF 03750000
.E0001A  ANOP                                                  @D14BDBF 03800000
          AIF   (T'&IOAREA1 NE 'O').E1                                  03850000
         MNOTE 0,'NO IOAREA1 SPECIFIED. SET TO *'                       03900000
&IOA1     SETC  '*'                                                     03950000
          AGO   .E2                                                     04000000
.E1       ANOP                                                          04050000
&IOA1     SETC  '&IOAREA1'                                              04100000
.E2       AIF   (T'&BLKSIZE EQ 'N').E0002                               04150000
         AIF   ('&CG1' NE '3525' AND '&CG1' NE '2560').JLG10         JJ 04200000
&BLKS    SETA  64                                                   4-0 04250000
         AGO   .JLG12                                               4-0 04300000
.JLG10   ANOP                                                       4-0 04350000
         AIF   ('&CG1' NE '5425' AND '&CG1' NE '5203').JLG10A  @DL2994J 04400000
&BLKS    SETA  96                                                    JJ 04450000
         AGO   .JLG12                                                JJ 04500000
.JLG10A  ANOP                                                        JJ 04550000
         AIF   ('&CG1' NE '3800').JLG10B                       @D34YSRJ 04600000
&BLKS    SETA  136       DEFAULT BLKSIZE FOR 3800 WITHOUT TRC  @D14ZDKH 04650000
         AIF   ('&TRC' NE 'YES').JLG12                         @D14ZDKH 04700000
&BLKS    SETA  137       DEFAULT BLKSIZE FOR 3800 WITH TRC     @D14ZDKH 04750000
         AGO   .JLG12                                          @D34YSRJ 04800000
.JLG10B  ANOP                                                  @D14ADBF 04850000
&BLKS    SETA  121                                                  4-0 04900000
.JLG12   AIF   (T'&BLKSIZE EQ 'O').E0003                            4-0 04950000
         MNOTE 0,'IMPROPER BLKSIZE.  SET TO &BLKS.'                 4-0 05000000
          AGO   .E0003                                                  05050000
.E0002    ANOP                                                          05100000
&BLKS     SETA  &BLKSIZE                                                05150000
.E0003   ANOP                                                           05200000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').E0003A   @DA01147 05250000
         AIF   (T'&CONTROL NE 'O').E0003A                      @DA01147 05300000
         AIF   (T'&CTLCHR EQ 'O').E0003A                       @DA01147 05350000
&V       SETA  1                                               @DA01147 05400000
.E0003A  AIF   ('&RECFORM' NE 'UNDEF').E3                      @DA01147 05450000
&RECF    SETC  'U'                                                  3-8 05500000
&RECZ     SETC  '2'                                                     05550000
          AIF   ('&RECSIZE' NE '').B1                                   05600000
         MNOTE 0,'NO RECSIZE SPECIFIED. SET TO REG 2'                   05650000
         AGO   .JJ16                                                 JJ 05700000
.B1       AIF   (T'&RECSIZE(1) EQ 'N').B2                               05750000
          AGO   .B3                                                     05800000
.B2      AIF   (&RECSIZE(1) GE 2 AND &RECSIZE(1) LE 12).B4          3-8 05850000
.B3       MNOTE 0,'IMPROPER RECSIZE. SET TO REG 2'                      05900000
         AGO   .JJ16                                                 JJ 05950000
.B4       ANOP                                                          06000000
&RECZ     SETC  '&RECSIZE(1)'                                           06050000
.JJ16    AGO   .JLG24                                          @DA01147 06100000
.E3      AIF   ('&RECSIZE' EQ '').E4                                    06150000
         MNOTE 0,'RECSIZE INVALID PARAMETER. IGNORED'                   06200000
.E4      AIF   ('&RECFORM' NE 'VARUNB').FX1                         3-8 06250000
&RECF    SETC  'V'                                                  3-8 06300000
&AL1     SETA  &AL1+8                  UPDATE SWITCH FOR VARUNB         06350000
&AL2     SETA  &AL2+4                  UPDATE CORRECT. FOR VARUNB       06400000
&V       SETA  &V+4                                            @DA01147 06450000
         AGO   .JLG24                                          @DA01147 06500000
.FX1     AIF   ('&RECFORM' EQ 'FIXUNB').FX2                         3-8 06550000
         MNOTE 0,'IMPROPER RECFORM. ''FIXUNB'' ASSUMED'             3-8 06600000
.FX2     ANOP                                                       3-8 06650000
&RECF    SETC  'F'                                                  3-8 06700000
&AL1     SETA  &AL1+16                 UPDATE SWITCH FOR FIXED      3-8 06750000
.JLG24   ANOP                                                       4-0 06800000
         AIF   ('&CG1' NE '3800').JLG25                        @D34YSRJ 06850000
         AIF   ('&TRC' NE 'YES').JLG25                         @D34YSRJ 06900000
&V       SETA  &V+1                    ALLOW FOR TRC           @D34YSRJ 06950000
.JLG25   ANOP                                                  @D34YSRJ 07000000
         AIF   ('&CG1' EQ '5425' OR '&CG1' EQ '2560').Q005     @DA01147 07050000
         AIF   (&BLKS LE &V).Q05                               @DA01147 07100000
         AIF   ('&CG1' EQ '3525').Q1010                        @DA01147 07150000
         AIF   ('&CG1' EQ '2245').Q1000                        @DA01147 07200000
         AIF   ('&CG1' EQ '3211' OR '&CG1' EQ 'PRT1').Q100     @D34CDMO 07250000
         AIF   ('&CG1' EQ '1443').Q10                               3-8 07300000
         AIF   ('&CG1' EQ '3800').Q01                          @D34YSRJ 07350000
         AIF   ('&CG1' EQ '5203' OR '&CG1' EQ '3203').P1       @DL29357 07400000
.Q005    AIF   (&BLKS GT &V).JLG24A1                           @DA01147 07450000
&BLKS    SETA  &V+1                                            @DA01147 07500000
         MNOTE 0,'BLKSIZE LOWER THAN OR EQUAL &V. &BLKS ASSUMED'       X07550000
                                                               @DA01147 07600000
.JLG24A1 ANOP                                                  @DA01147 07650000
         AIF   ('&CG1' NE '5425').JLG24A                       @DL2994J 07700000
&MFSW    SETA  64                                                    JJ 07750000
&CNTL    SETC  'V'                                                   JJ 07800000
         AIF   (&BLKS LE 128+&V).JJLG1                         @DM08030 07850000
&BLKS    SETA  128+&V                                          @DM08030 07900000
         MNOTE 0,'INVALID BLKSIZE. &BLKS ASSUMED'              @DM08030 07950000
         AGO   .JJLG1                                                JJ 08000000
.JLG24A  ANOP                                                        JJ 08050000
         AIF   ('&CG1' NE '2560').JJ30                               JJ 08100000
         AIF   (&BLKS LE 384+&V).JJ15                          @DA01147 08150000
&BLKS    SETA  384+&V                                          @DA01147 08200000
         MNOTE 0,'INVALID BLKSIZE. &BLKS ASSUMED'              @DA01147 08250000
.JJ15    ANOP                                                        JJ 08300000
&MFSW    SETA  128                                                   JJ 08350000
&CNTL    SETC  'U'                                                   JJ 08400000
.JJLG1   ANOP                                                        JJ 08450000
&E       SETA  4  POST AT DEVICE END BIT IN CCB                @DL2994J 08500000
&PROV    SETC  'U'                                                   JJ 08550000
&FUNCT   SETC  'U VW X'                                              JJ 08600000
         AIF   (T'&FUNC EQ 'O' OR '&FUNC' EQ 'W').ERRX               JJ 08650000
&ASF     SETA  5                                                     JJ 08700000
         AIF   ('&FUNC' EQ 'RPW').JJ20                               JJ 08750000
&ASF     SETA  3                                                     JJ 08800000
         AIF   ('&FUNC' EQ 'PW').JJ20                                JJ 08850000
&ASF     SETA  2                                                     JJ 08900000
         AIF   ('&FUNC' EQ 'RW').JJ20                                JJ 08950000
         MNOTE 9,'INVALID FUNC PARAMETER. MACRO NOT GENERATED'       JJ 09000000
         MEXIT                                                       JJ 09050000
.JJ20    ANOP                                                        JJ 09100000
&PROV    SETC  '&FUNCT'(&ASF+1,1)                                    JJ 09150000
&AL5     SETA  &AL5+&ASF                                             JJ 09200000
         AIF   (T'&ASOCFLE NE 'O').JLG110                            JJ 09250000
         MNOTE 9,'NO ASOCFLE PARAMETER. MACRO NOT GENERATED'         JJ 09300000
         MEXIT                                                       JJ 09350000
.JJ30    ANOP                                                        JJ 09400000
         AIF   (&BLKS LE 132+&V).P1                            @DA01147 09450000
&BLKS    SETA  132+&V                                          @DA01147 09500000
         AGO   .Q15                                                 3-8 09550000
.******* FOR 3800 : **************                             @D14ADBF 09600000
.Q01     ANOP                                                  @D34YSRJ 09650000
         AIF   (&BLKS LE 384+&V).P1                            @D14ADBF 09700000
&BLKS    SETA  384+&V                                          @D14ADBF 09750000
         AGO   .Q15                                            @D34YSRJ 09800000
.*********************************                             @D14ADBF 09850000
.Q10     ANOP                                                  @DA01147 09900000
         AIF   (&BLKS LE 144+&V).P1                            @DA01147 09950000
&BLKS    SETA  144+&V                                          @DA01147 10000000
         AGO   .Q15                                                 3-8 10050000
.Q1010   ANOP                                                  @DA01147 10100000
         AIF   (&BLKS LE 64+&V).P1                             @DA01147 10150000
&BLKS    SETA  64+&V                                           @DA01147 10200000
         AGO   .Q15                                            @DA01147 10250000
.Q1000   ANOP                                                  @DA01147 10300000
         AIF   (&BLKS LE 800+&V).P1                            @DA01147 10350000
&BLKS    SETA  800+&V                                          @DA01147 10400000
         AGO   .Q15                                                 4-0 10450000
.Q100    ANOP                                                  @DA01147 10500000
         AIF   (&BLKS LE 512+&V).P1                            @D51GDAL 10550000
&BLKS    SETA  512+&V    FOR PRT1 PRINTER                      @D51GDAL 10600000
.Q15     MNOTE 0,'BLKSIZE GREATER THAN &BLKS. &BLKS ASSUMED'        3-8 10650000
         AGO   .P1                                             @DA01147 10700000
.Q05     ANOP                                                  @DA01147 10750000
&BLKS    SETA  &V+1                                            @DA01147 10800000
         MNOTE 0,'BLKSIZE LOWER THAN OR EQUAL &V. &BLKS ASSUMED'       C10850000
                                                               @DA01147 10900000
.P1      ANOP                                                           10950000
&CNTL    SETC  'C'                                                      11000000
         AIF   ('&CONTROL' EQ 'YES').P2                                 11050000
         AIF   (T'&CONTROL EQ 'O').P25                                  11100000
         MNOTE 0,'IMPROPER CONTROL YES ASSUMED'                         11150000
.P2      AIF   (T'&CTLCHR EQ 'O').P35                                   11200000
         MNOTE 0,'CTLCHR AND CONTROL BOTH SPECIFIED. CTLCHR IGNORED'    11250000
         AGO   .P35                                                     11300000
.P25     ANOP                                                           11350000
&CNTL    SETC  'A'                                                      11400000
         AIF   ('&CTLCHR' NE 'ASA').P3A                             4-0 11450000
         AIF   ('&CG1' NE '2245').P35                               4-0 11500000
&CNTL    SETC  'M'                                                  4-0 11550000
         AGO   .P35                                                 4-0 11600000
.P3A     ANOP                                                       4-0 11650000
&CNTL    SETC  'Y'                                                      11700000
         AIF   ('&CTLCHR' EQ 'YES').P35                                 11750000
         AIF   (T'&CTLCHR EQ 'O').P3                                    11800000
         MNOTE 0,'IMPROPER CTLCHR. ''YES'' ASSUMED'                     11850000
         AGO   .P35                                                     11900000
.P3      ANOP                                                           11950000
&CNTL    SETC  'Z'                                                      12000000
.P35     ANOP                                                           12050000
         AIF   (T'&TRC EQ 'O').P35C                            @D34YSRJ 12100000
         AIF   ('&CG1' EQ '3800').P35A                         @D34YSRJ 12150000
         MNOTE 0,'''TRC'' NOT VALID FOR &CG1, IGNORED.'        @D34YSRJ 12200000
         AGO   .P35C                                           @D34YSRJ 12250000
.P35A    ANOP                                                  @D34YSRJ 12300000
         AIF   ('&TRC' EQ 'NO').P35C                           @D34YSRJ 12350000
         AIF   ('&TRC' EQ 'YES').P35B                          @D34YSRJ 12400000
         MNOTE 0,'IMPROPER ''TRC''.  ''NO'' ASSUMED.'          @D34YSRJ 12450000
         AGO   .P35C                                           @D34YSRJ 12500000
.P35B    ANOP                                                  @D34YSRJ 12550000
&AL5     SETA  &AL5+6   TRC=YES, X'04' + X'02'                 @D34YSRC 12600000
.P35C    ANOP                                                  @D34YSRJ 12650000
         AIF   ('&CG1' NE '5203' AND '&CG1' NE '3203').P351    @DL29357 12700000
         AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'Y').NOCCHR      @DL29357 12750000
&COR     SETA  &COR+1                                          @DL29357 12800000
.NOCCHR  AIF   ('&RECF' NE 'V').NOVAR                          @DL29357 12850000
&COR     SETA  &COR+4                                          @DL29357 12900000
.NOVAR   AIF   ('&CG1' EQ '5203').Q5203                        @DL29357 12950000
         AIF   (&BLKS GT &COR).P3203                           @DL29357 13000000
&BLKS    SETA  121                                             @DL29357 13050000
         AGO   .ENOTE                                          @DL29357 13100000
.P3203   AIF   (&BLKS LE 132+&COR).P351                        @DL29357 13150000
&BLKS    SETA  132+&COR                                        @DL29357 13200000
         MNOTE 0,'BLKSIZE GT 132+&COR,&BLKS ASSUMED.'          @DL29357 13250000
         AGO   .P351                                           @DL29357 13300000
.Q5203   AIF   (&BLKS GT &COR).P5203                           @DL29357 13350000
&BLKS    SETA  96                                              @DL29357 13400000
.ENOTE   MNOTE 0,'BLKSIZE LE THAN MINIMUM &COR,&BLKS ASSUMED.'          13450000
         AGO   .P351                                           @DL29357 13500000
.P5203   AIF   (&BLKS LE 96+&COR).P351                         @DL29357 13550000
         AIF   (&BLKS LE 132+&COR).NOTE                        @DL29357 13600000
&BLKS    SETA  132+&COR                                        @DL29357 13650000
         MNOTE 0,'BLKSIZE GREATER THAN 132+&COR,&BLKS ASSUMED. PLEASE  *13700000
               CHECK WHETHER YOUR 5203 HAS 132 PRINT POSITS.'  @DL29357 13750000
         AGO   .P351                                           @DL29357 13800000
.NOTE    MNOTE *,'BLKSIZE = &BLKS,GREATER THAN 96 + &COR . PLEASE CHECK*13850000
                WHETHER YOUR 5203 HAS 120/132 PRINT POSITIONS' @DL29357 13900000
.P351    ANOP                                                  @DL29357 13950000
&PROV    SETC  'Z'                                                      14000000
         AIF   (T'&PRINTOV EQ 'O').P4                                   14050000
&E       SETA  4                                                    4-0 14100000
&F       SETA  4                                                    4-0 14150000
         AIF   ('&PRINTOV' EQ 'YES').Z1                                 14200000
         MNOTE 0,'IMPROPER PRINTOV. ''YES'' ASSUMED'                    14250000
.Z1      ANOP                                                           14300000
&PROV    SETC  'P'                                                      14350000
.P4      AIF   ('&CG1' EQ '2245').ERR45                             4-0 14400000
         AGO   .P4K                                                 4-0 14450000
.ERR45   AIF   (T'&ERROPT EQ 'O').ERRX                         @DA01036 14500000
         AIF   ('&ERROPT' NE 'RETRY').ERRADR                        4-0 14550000
         MNOTE 3,'ERROPT WITH RETRY NOT VALID FOR 2245,IGNORED'     4-0 14600000
         AGO   .ERRX                                                4-0 14650000
.P4K     AIF   ('&CG1' NE '3525').JLG98                             4-0 14700000
&AL5     SETA  &AL5+16                 SET PIKELAKE BIT             4-0 14750000
&AL6     SETA  5                       SET CCW CODE                 4-0 14800000
         AIF   (T'&FUNC EQ 'O').JLG78                               4-0 14850000
&ASF     SETA  5                                                    4-0 14900000
         AIF   ('&FUNC' EQ 'RPWT').JLG60                            4-0 14950000
         AIF   ('&FUNC' EQ 'RPW').JLG70                             4-0 15000000
&ASF     SETA  3                                                    4-0 15050000
         AIF   ('&FUNC' EQ 'PWT').JLG60                             4-0 15100000
         AIF   ('&FUNC' EQ 'PW').JLG70                              4-0 15150000
&ASF     SETA  2                                                    4-0 15200000
         AIF   ('&FUNC' EQ 'RWT').JLG60                             4-0 15250000
         AIF   ('&FUNC' EQ 'RW').JLG70                              4-0 15300000
&ASF     SETA  0                                                    4-0 15350000
         AIF   ('&FUNC' EQ 'WT').JLG60                              4-0 15400000
         AIF   ('&FUNC' EQ 'W').JLG70                               4-0 15450000
.JLG53   MNOTE 9,'IMPROPER FUNC PARAMETER.  MACRO NOT GENERATED.'   4-0 15500000
         MEXIT                                                      4-0 15550000
.JLG60   ANOP                                                       4-0 15600000
&T       SETA  1                                                    4-0 15650000
.JLG70   ANOP                                                       4-0 15700000
&AL5     SETA  &AL5+&ASF                                            4-0 15750000
         AIF   (&ASF EQ 0).JLG74                                    4-0 15800000
         AIF   (T'&ASOCFLE NE 'O').JLG74                            4-0 15850000
         MNOTE 9,'MISSING ASOCFLE PARAMETER. MACRO TERMINATED.'     4-0 15900000
         MEXIT                                                      4-0 15950000
.JLG74   AIF   (&T NE 1 OR '&CNTL' EQ 'Z').JLG76                    4-0 16000000
         MNOTE 0,'CTLCHR/CONTROL AND T ARE SPECIFIED. T IGNORED.'   4-0 16050000
         AGO   .JLG78                                               4-0 16100000
.JLG76   AIF   (&T NE 1).JLG78                                      4-0 16150000
&CNTL    SETC  'T'                                                  4-0 16200000
&AL5     SETA  &AL5+128                                             4-0 16250000
.JLG78   ANOP                                                       4-0 16300000
&E       SETA  0                                                    4-0 16350000
         AIF   (T'&ERROPT EQ 'O').JLG45                             4-0 16400000
         AIF   ('&ERROPT' NE 'IGNORE').JLG40                        4-0 16450000
         AIF   (T'&IOAREA2 EQ 'O' AND T'&WORKA EQ 'O').J40          4-0 16500000
         MNOTE 0,'WORKA/IOAREA2 AND ERROPT SPEC. ERROPT IGNORED.'   4-0 16550000
         AGO   .JLG45                                               4-0 16600000
.J40     ANOP                                                       4-0 16650000
&E       SETA  6                                                    4-0 16700000
&AL5     SETA  &AL5+64                                              4-0 16750000
         AGO   .JLG45                                               4-0 16800000
.JLG40   MNOTE 0,'INVALID ERROPT PARAMETER. IGNORED.'               4-0 16850000
.JLG45   ANOP                                                       4-0 16900000
         AIF   ('&PROV' EQ 'P').JLG92                               4-0 16950000
&FUNCT   SETC  'O RS T'                                             4-0 17000000
&PROV    SETC  '&FUNCT'(&ASF+1,1)                                   4-0 17050000
         AGO   .JLG95                                               4-0 17100000
.JLG92   ANOP                                                       4-0 17150000
&FUNCT   SETC  'I FC D'                                             4-0 17200000
&PROV    SETC  '&FUNCT'(&ASF+1,1)                                   4-0 17250000
.JLG95   AIF   (&ASF EQ 0).ERRX                                     4-0 17300000
         AGO   .JLG110                                              4-0 17350000
.JLG98   AIF   (T'&FUNC EQ 'O').JLG100                              4-0 17400000
         MNOTE 0,'FUNC NOT VALID FOR &CG1.. IGNORED'                 JJ 17450000
.JLG100  AIF   (T'&ERROPT EQ 'O').ERRX                              4-0 17500000
         AIF   ('&CG1' EQ '3211' OR '&CG1' EQ 'PRT1').ERROK    @D34CDMO 17550000
         MNOTE 3,'ERROPT NOT VALID FOR &CG1, IGNORED'               3-9 17600000
         AGO   .ERRX                                                3-9 17650000
.ERROK   AIF   ('&ERROPT' NE 'RETRY').ERRADR                        3-9 17700000
&BTRY    SETB  1                                                    3-9 17750000
&E       SETA  4                                                    4-0 17800000
&F       SETA  4                                                    4-0 17850000
.*                                                             @DA40454 17862552
.* IN CASE OF ERROPT EQ 'RETRY' BIT 7 OF BYTE 16 HAS NOT       @DA40454 17875052
.* TO BE SET, BECAUSE IT IS IMPLICITLY SET BY &VER3 BIT        @DA40454 17887552
.*                                                             @DA40454 17900052
.* &AL5     SETA  1                                            @DA40454 17912552
.*                                                             @DA40454 17925052
         AGO   .ERRX                                                3-9 17950000
.ERRADR  ANOP                                                       4-0 18000000
.*                                                             @DA40454 18007152
.* ERROPT=NAME ASSUMED. ERROPT BIT 1 IN BYTE 16 OF DTF IS      @DA40454 18014252
.* TO BE SET.                                                  @DA40454 18021352
.*                                                             @DA40454 18028452
&AL5     SETA  &AL5+64                                         @DA40454 18035552
.*                                                             @DA40454 18042652
&E       SETA  6                                                    4-0 18050000
&F       SETA  4                                                    4-0 18100000
         AIF   ('&PROV' EQ 'P').ERRP                                4-0 18150000
&PROV    SETC  'E'                                                  3-9 18200000
         AGO   .ERRX                                                3-9 18250000
.ERRP    ANOP                                                       3-9 18300000
&PROV    SETC  'B'                                                  3-9 18350000
.ERRX    AIF   (T'&ASOCFLE EQ 'O').JLG110                           4-0 18400000
         MNOTE 0,'ASOCFLE FOR SINGLE FILE IGNORED'                   JJ 18450000
.JLG110  ANOP                                                       4-0 18500000
&IOA2    SETC  'Z'                                                      18550000
         AIF   (T'&IOAREA2 EQ 'O').P45                                  18600000
&IOA2    SETC  'I'                                                      18650000
&AL1      SETA  &AL1+4                                                  18700000
.P45     ANOP                                                           18750000
&WKAR    SETC  'Z'                                                      18800000
         AIF   (T'&WORKA EQ 'O').P47                                    18850000
          AIF   ('&WORKA' EQ 'YES').HARA1                               18900000
          MNOTE 0,'IMPROPER WORKA. ''YES'' ASSUMED'                     18950000
.HARA1    ANOP                                                          19000000
&WKAR    SETC  'W'                                                      19050000
         AIF   ('&DEVICE' NE '2245').P47                       @DA01036 19100000
&WKAR    SETC  'T'                                             @DA01036 19150000
.P47      ANOP                                                          19200000
&IOG      SETC  '2'                                                     19250000
          AIF   (T'&IOAREA2 NE 'O').A1                                  19300000
          AIF   (T'&IOREG EQ 'O').A10                                   19350000
          MNOTE 0,'IOREG NOT NEEDED FOR FILE WITH ONE IOAREA'           19400000
          AGO   .A3                                                     19450000
.A1       AIF   (T'&IOREG NE 'O').A2                                    19500000
          AIF   (T'&WORKA NE 'O').A10                                   19550000
          MNOTE 0,'NO IOREG OR WORKA SPECIFIED FOR A TWO IOAREA FILE'   19600000
          AGO   .A10                                                    19650000
.A2       AIF   (T'&WORKA EQ 'O').A3                                    19700000
          MNOTE 0,'BOTH IOREG AND WORKA STATED. BOTH CONSIDERED'        19750000
.A3       AIF   (T'&IOREG(1) EQ 'N').A4                                 19800000
          AGO   .A5                                                     19850000
.A4       AIF   ('&IOREG(1)' GE '2' AND '&IOREG(1)' LE '13').A6         19900000
.A5      MNOTE 0,'IMPROPER IOREG. SET TO REG 2'                         19950000
          AGO   .A10                                                    20000000
.A6       ANOP                                                          20050000
&IOG      SETC  '&IOREG(1)'                                             20100000
.A10      AIF   (T'&WORKA EQ 'O').E10                                   20150000
&AL1     SETA  &AL1+2                  UPDATE SWITCH FOR WORKA          20200000
.E10     AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'Y' AND '&CNTL' NE 'M').EX20250000
               11                                              @DA01147 20300000
&AL1     SETA  &AL1+32                                         @DL29357 20350000
&AL2     SETA  &AL2+1                                          @DL29357 20400000
         AGO   .E11                                            @DL29357 20450000
.E101    AIF   ('&CTLCHR' EQ '').E11                           @DL29357 20500000
&AL1     SETA  &AL1+32                 UPDATE SWITCH FOR CTLCHR         20550000
&AL2     SETA  &AL2+1                  ADD 1 IN IOAR CORRECT.=CTLCHR    20600000
.E11     AIF   ('&STLIST' EQ '').GG                                     20650000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').GG       @DL2994J 20700000
         AIF   ('&CG1' EQ '1403').STOK                              3-9 20750000
         MNOTE 0,'''STLIST'' NOT VALID FOR &CG1, IGNORED'           3-9 20800000
         AGO   .GG                                                  3-9 20850000
.STOK    AIF   ('&STLIST' EQ 'YES').GGG                             3-9 20900000
         MNOTE 0,'IMPROPER STLIST, YES ASSUMED'                     3-8 20950000
.GGG     ANOP                                                           21000000
&RECF    SETC  'F'                                                      21050000
&CNTL    SETC  'S'                                                      21100000
&PROV    SETC  'Z'                                                      21150000
.GG      AIF   (T'&SEPASMB EQ 'O').NEW2                                 21200000
         AIF   ('&SEPASMB' EQ 'YES').NEW3                               21250000
         MNOTE 0,'IMPROPER SEPASMB.''YES'' ASSUMED'                     21300000
.NEW3    AIF   (T'&NAME NE 'O').NEW1                                    21350000
         MNOTE 9,'NO FILENAME SPECIFIED.GENERATION TERMINATED'          21400000
         MEXIT                                                          21450000
.NEW1    PUNCH '  CATALOG &NAME..OBJ   REPLACE=YES'            @D14ZDKH 21500000
&NAME.C  CSECT                                                          21550000
         ENTRY &NAME                                                    21600000
.NEW2    DC    0D'0'                                                    21650000
         AIF   ('&VER3' NE '1').E131                           @D14BDBF 21700000
.*              GENERATE DTFPRT HEADER                         @D14BDBF 21750000
         DC    AL2(IJJZ&SYSNDX-IJGZ&SYSNDX)  LENGTH OF EXTN    @D14BDBF 21800000
         DC    AL2(0)    RESERVED                              @D14BDBF 21850000
         DC    AL4(IJGZ&SYSNDX)           ADDR OF EXTENSION    @D14BDBF 21900000
         SPACE 1                                               @D14BDBF 21950000
.E131    ANOP                                                  @D14BDBF 22000000
         AIF   ('&CG1' NE '2560').JJ10AA                       @DA06223 22050000
&NCH     SETA  1                                                     JJ 22100000
.JJ10AA  ANOP                                                        JJ 22150000
&NAME    DC    X'00008&E.0&NCH.0&F.00'   RES. COUNT, COM. BYTES BTS  JJ 22200000
.E14     AIF   ('&DEVADDR' EQ '').P50                                   22250000
          AIF   (K'&DEVADDR NE 6).P50                                   22300000
          AIF   ('&DEVADDR'(1,3) NE 'SYS').P50                          22350000
&CG2     SETC  '&DEVADDR'(4,3)                                          22400000
          AIF   ('&CG2' LT '000' OR '&CG2' GT '254').P52       @DA31417 22450000
          AIF   ('&CG2'(2,1) LT '0' OR '&CG2'(2,1) GT '9' OR '&CG2'(3,1*22500000
               )  LT '0' OR '&CG2'(3,1) GT '9').P50                     22550000
&AL8     SETA  1                                                        22600000
&AL9     SETA  &CG2                                                     22650000
         AGO   .P51                                                     22700000
.P50XX   MNOTE 0,'DEVADDR INVALID FOR &CG1.. ''FFFF'' ASSUMED'       JJ 22750000
&AL8     SETA  255                                                   JJ 22800000
&AL9     SETA  255                                                   JJ 22850000
         AGO   .P51                                                  JJ 22900000
.P52     AIF   ('&CG1' EQ '2245').P50XX                              JJ 22950000
         AIF   ('&CG1' EQ '3525' OR '&CG1' EQ '2560').P50XX          JJ 23000000
         AIF   ('&CG1' EQ '5425').P50XX                        @DL2994J 23050000
&AL9     SETA  3                                                        23100000
         AIF   ('&CG2' EQ 'LST').P51                                    23150000
&AL9     SETA  4                                                    3-8 23200000
         AIF   ('&CG2' EQ 'LOG').P51                                3-8 23250000
.P50      ANOP                                                          23300000
&AL8     SETA  255                                                      23350000
&AL9     SETA  255                                                      23400000
         MNOTE 0,'IMPROPER OR MISSING DEVADDR. ''FFFF'' GENERATED'      23450000
.P51     DC    AL1(&AL8)               LOGICAL UNIT CLASS               23500000
         DC   AL1(&AL9)                LOGICAL UNIT                     23550000
         AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').JJ34    @DL2994J 23600000
         DC    A(*+40)  CCW ADDRESS                                  JJ 23650000
         AGO   .JJ35                                                 JJ 23700000
.JJ34    DC    A(*+32)                 CCW  ADDR.                    JJ 23750000
.JJ35    DC    4X'00'                  CCB-ST BYTE,CSW CCW ADDRESS   JJ 23800000
.*                                                             @DA40454 23807652
.* IN CASE OF NON-3525 MODE THE BIT 7 OF BYTE 16 HAS TO BE     @DA40454 23815252
.* SET TO INDICATE VERSION 3                                   @DA40454 23822852
.* 3525 MODE IS ENTERED BY 2560, 3525, 5424 AND 5425 IN        @DA40454 23830452
.* COMBINATION WITH THE FUNC PARAMETER. IN CASE OF 2560,       @DA40454 23838052
.* 5424 AND 5425 FUNC=W IS ASSUMED IF NOT SPECIFIED.           @DA40454 23845652
.*                                                             @DA40454 23853252
         AIF   ('&CG1' NE '2560' AND '&CG1' NE '5424' AND              123860852
               '&CG1' NE '5425' AND '&CG1' NE '3525').JJ352    @DA40454 23868452
         AIF   ('&CG1' EQ '3525' AND T'&FUNC EQ '0').JJ352     @DA40454 23876052
         AGO   .JJ351                                          @DA40454 23883652
.JJ352   ANOP                                                  @DA40454 23891252
&AL5     SETA  &AL5+1     INDICATE VER3 EXTENSION AVAILABLE    @D14ZDBF 23900000
.JJ351   DC    AL1(&AL5)               SWITCH 3                @D14BDBF 23950000
.*                                                             @DA40454 23975052
.FOX1    AIF   (T'&MODNAME EQ 'O').P535                             3-9 24000000
         DC    VL3(&MODNAME)                                        3-9 24050000
         AGO   .P536                                                3-9 24100000
.P535    AIF   (T'&RDONLY EQ 'O').P535B                             3-9 24150000
         AIF   ('&RDONLY' EQ 'YES').P535C                           3-3 24200000
         MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED.'                3-3 24250000
.P535C   AIF   ('&WKAR' EQ 'Z').P535A                               3-3 24300000
&WKAR    SETC  'V'                                                  3-3 24350000
         AIF   ('&DEVICE' NE '2245').P535B                     @DA01036 24400000
&WKAR    SETC  'R'                                             @DA01036 24450000
         AGO   .P535B                                               3-3 24500000
.P535A   ANOP                                                       3-3 24550000
&WKAR    SETC  'Y'                                                  3-3 24600000
.P535B   DC    VL3(IJD&RECF&CNTL&PROV&IOA2&WKAR) ADDR OF LOGIC MODUL3-8 24650000
.P536    AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').P536A   @DL2994J 24700000
         DC    X'07'  DTF TYPE                                       JJ 24750000
         DC    AL1(&AL1)  SWITCHES                                   JJ 24800000
         DC    X'00'  NOT USED                                       JJ 24850000
         AIF   ('&CG1' NE '2560').JJ41                               JJ 24900000
&HEADS   SETA  128                                                   JJ 24950000
         AIF   (&BLKS-&AL2 LE 64).JJ41                               JJ 25000000
&HEADS   SETA  &HEADS+64                                             JJ 25050000
         AIF   (&BLKS-&AL2 LE 128).JJ41                              JJ 25100000
&HEADS   SETA  &HEADS+32                                             JJ 25150000
         AIF   (&BLKS-&AL2 LE 192).JJ41                              JJ 25200000
&HEADS   SETA  &HEADS+16                                             JJ 25250000
         AIF   (&BLKS-&AL2 LE 256).JJ41                              JJ 25300000
&HEADS   SETA  &HEADS+8                                              JJ 25350000
         AIF   (&BLKS-&AL2 LE 320).JJ41                              JJ 25400000
&HEADS   SETA  &HEADS+4                                              JJ 25450000
.JJ41    ANOP                                                        JJ 25500000
IJDY&SYSNDX DC AL1(&HEADS)  PRINT HEAD SELECTION BYTE                JJ 25550000
         DC    A(&IOA1+&AL2)  ADDR OF IOAREA1                        JJ 25600000
         AGO   .P56B                                                 JJ 25650000
.P536A   DC    X'08'                   DTF TYPE  (PRINTER)           JJ 25700000
         DC    AL1(&AL1)               SWITCHES                         25750000
         DC    AL1(&AL6)                NORMAL  COMM. CODE          4-0 25800000
         DC    AL1(&AL6)                CONTROL COMM. CODE          4-0 25850000
          DC    A(&IOA1+&AL2)          ADDRESS OF DATA IN IOAREA1       25900000
.P56     AIF   (T'&UCS EQ 'O' OR '&UCS' EQ 'OFF').P56A                  25950000
         AIF   ('&CG1' EQ '1403' OR '&CG1' EQ '3211').J115          4-0 26000000
         AIF   ('&CG1' EQ 'PRT1').J115                         @D34CDMO 26050000
         AIF   ('&CG1' EQ '5203' OR '&CG1' EQ '3203').J115     @DL29355 26100000
         AIF   ('&CG1' EQ '3800').J115                         @D34YSRJ 26150000
         MNOTE 0,'''UCS'' NOT VALID FOR &CG1,IGNORED'               4-0 26200000
         AIF   ('&CG1' EQ '3525').P56B                              4-0 26250000
         AGO   .P56A                                                4-0 26300000
.J115    AIF   ('&CNTL' NE 'S').P56X                                4-0 26350000
         DC    X'80'                                                3-5 26400000
         DC    2X'00'                   NOT USED                    3-5 26450000
         DC    X'00'                    SAVE AREA FOR STLIST BYTE   3-5 26500000
         AGO   .P56C                                                3-5 26550000
.P56X    DC    X'80000000'              BUCKET                      3-5 26600000
         AGO   .P56C                                                3-5 26650000
.P56A    AIF   ('&CNTL' NE 'S').P56B                                3-9 26700000
         DC    3X'00'                   NOT USED                    3-5 26750000
         DC    X'00'                    SAVE AREA FOR STLIST BYTE   3-5 26800000
         AGO   .P56C                                                3-5 26850000
.P56B    DC    4X'00'                   BUCKET                      3-5 26900000
.P56C    AIF   ('&RECFORM' EQ 'UNDEF').E18                          3-5 26950000
         NOPR  0                       PUT LENGTH IN REG12 (ONLY UNDEF. 27000000
         AGO   .E20                                                     27050000
.E18      LR    12,&RECZ                                                27100000
.E20     AIF   ('&IOREG' NE '').E021                                    27150000
         NOP   0                       LOAD USER POINTER REG            27200000
         AGO   .E24                                                     27250000
.E021     LA    &IOG,0(14)             LOAD USER POINTER REG            27300000
.E24     AIF   ('&CG1' EQ '2560').JJ45                               JJ 27350000
         AIF   ('&CG1' EQ '5425').JJ47                         @DL2994J 27400000
         AIF   ('&CNTL' NE 'S').E24A                                 JJ 27450000
IJJY&SYSNDX DC X'00'                    STLIST CONTROL BYTE         3-5 27500000
         DC    X'00'                    SPACE-SKIP SWITCH           3-5 27550000
         CCW   11,IJJY&SYSNDX,X'60',1                               3-5 27600000
         AGO   .E50                                                 3-5 27650000
.E24A    DC    2X'00'                   NOT USED                    3-5 27700000
.E50      AIF   (T'&IOAREA2 EQ 'O').E25                                 27750000
          CCW   &AL6,&IOAREA2+&AL2,X'20',&BLKS-&AL2                 4-0 27800000
         AGO   .E26                                                 3-9 27850000
.E25      CCW   &AL6,&IOA1+&AL2,X'20',&BLKS-&AL2                    4-0 27900000
.E26     AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').ADRMOD            3-9 27950000
         AIF   ('&CG1' EQ '3525').J120                              4-0 28000000
         DC    A(&ERROPT)                                           3-9 28050000
.J120    AIF   (&ASF EQ 0).ADRMOD                                   4-0 28100000
         DC    A(&ASOCFLE)                                          4-0 28150000
.ADRMOD  ANOP                                                           28200000
         AIF   ('&VER3' NE '1').J200                           @D14BDBF 28250000
         AIF   ('&CNTL' NE 'A').J130   CTLCHR=ASA              @D14BDBF 28300000
IJGZ&SYSNDX DC    X'80'                SWITCH 4                @D14BDBF 28350000
         AGO   .J200                                           @D14BDBF 28400000
.J130    AIF   ('&CNTL' NE 'Y').J140   CTLCHR=YES              @D14BDBF 28450000
IJGZ&SYSNDX DC    X'40'                SWITCH 4                @D14BDBF 28500000
         AGO   .J200                                           @D14BDBF 28550000
.J140    ANOP                          CONTROL=YES             @D14BDBF 28600000
IJGZ&SYSNDX DC    X'00'                SWITCH 4                @D14BDBF 28650000
.J200    ANOP                                                  @D14BDBF 28700000
IJJZ&SYSNDX EQU *                                                       28750000
         MEXIT                                                       JJ 28800000
.JJ45    ANOP                                                        JJ 28850000
&COL     SETA  &BLKS-&AL2                                            JJ 28900000
.JJ46    AIF   (&COL LE 64).JJ47                                     JJ 28950000
&COL     SETA  64                                                    JJ 29000000
.JJ47    DC    H'0'                                                  JJ 29050000
         AIF   (K'&FUNC LE 1).JJ48                                   JJ 29100000
         DC    A(&ASOCFLE)  ADDRESS OF ASSOCIATED FILE               JJ 29150000
         AGO   .JJ48A                                                JJ 29200000
.JJ48    DC    F'0'                                                  JJ 29250000
.JJ48A   DC    AL1(&MFSW)  SWITCHES                                  JJ 29300000
         DC    3X'00'  RESERVED FOR FUTURE USE                       JJ 29350000
         AIF   ('&CG1' EQ '5425').JJ60                         @DL2994J 29400000
         AIF   (K'&FUNC GT 1).JJ49                                   JJ 29450000
&RCC     SETA  &HOPPER+34                                            JJ 29500000
         CCW   &RCC,*,X'70',1   READ CCW                             JJ 29550000
.JJ49    ANOP                                                        JJ 29600000
&PRCC    SETA  7*16+7                                                JJ 29650000
         AIF   (&BLKS-&AL2 NE 64).JJ49A                              JJ 29700000
         AIF   ('&RECF' NE 'F').JJ49A                                JJ 29750000
&PRCC    SETA  16+7                                                  JJ 29800000
.JJ49A   ANOP                                                        JJ 29850000
         AIF   (T'&IOAREA2 EQ 'O').JJ50                              JJ 29900000
         CCW   &PRCC,&IOAREA2+&AL2,X'60',&BLKS-&AL2 LOAD PR HEAD BUFFER 29950000
         AGO   .JJ51                                                 JJ 30000000
.JJ50    CCW   &PRCC,&IOA1+&AL2,X'60',&BLKS-&AL2 LOAD PR HEAD BUFFER JJ 30050000
.JJ51    CCW   X'45',IJDY&SYSNDX,X'20',&COL                          JJ 30100000
IJGZ&SYSNDX DC    X'00'                SWITCH 4                @D14BDBF 30150000
IJJZ&SYSNDX EQU *                                                       30200000
         MEXIT                                                       JJ 30250000
.JJ60    ANOP                                                        JJ 30300000
&PRCC    SETA  &HOPPER+65                                            JJ 30350000
         AIF   (K'&FUNC LE 1).JJ61                                   JJ 30400000
&PRCC    SETA  &PRCC+4                                               JJ 30450000
.JJ61    AIF   (T'&IOAREA2 EQ 'O').JJ62                              JJ 30500000
         CCW   &PRCC,&IOAREA2+&AL2,X'20',&BLKS-&AL2  PRINT CCW       JJ 30550000
         AGO   .JJ63                                                 JJ 30600000
.JJ62    CCW   &PRCC,&IOAREA1+&AL2,X'20',&BLKS-&AL2   PRINT CCW      JJ 30650000
.JJ63    ANOP                                                        JJ 30700000
         MEND                                                        JJ 30750000
