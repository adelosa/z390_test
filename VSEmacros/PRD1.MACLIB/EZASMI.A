.*------------------------------------------------------------*         00010000
.*                                            March 1995  ROS *         00020000
.* Level: TCP3.4                                              *         00020100
.*                                                            *         00030000
.* Macro name:                                                *         00030100
.*      EZASMI                                                *         00040000
.*                                                            *         00050000
.* COPYRIGHT:                                                 *         00060000
.*   LICENSED MATERIALS - PROPERTY OF IBM                     *         00070000
.*   THIS PRODUCT CONTAINS "RESTRICTED MATERIALS OF IBM"      *         00080000
.*   5686-066 (C) COPYRIGHT IBM CORP. 1995 2001               *@D66JDHH 00090000
.*   ALL RIGHTS RESERVED.                                     *         00100000
.*   US GOVERNMENT USERS RESTRICTED RIGHTS -                  *         00110000
.*   USE, DUPLICATION OR DISCLOSURE RESTRICTED BY GSA ADP     *         00120000
.*   SCHEDULE CONTRACT WITH IBM CORP.                         *         00130000
.*   SEE IBM COPYRIGHT INSTRUCTIONS.                          *         00140000
.*                                                            *         00150000
.* Function:                                                  *         00160000
.*      Provide S/390 Assembler Sockets Interface             *         00170000
.*      The TYPE parameter corresponds to the C Socket        *         00180000
.*      calls.  The following socket calls are supported:     *         00190000
.*              ACCEPT                                        *         00200000
.*              BIND                                          *         00210000
.*              CANCEL                                        *         00220000
.*              CLOSE                                         *         00230000
.*              CONNECT                                       *         00240000
.*              FCNTL                                         *         00250000
.*              GETCLIENTID                                   *         00260000
.*              GETHOSTID                                     *         00270000
.*              GETHOSTNAME                                   *         00280000
.*              GETHOSTBYNAME                                 *         00290000
.*              GETHOSTBYADDR                                 *         00300000
.*              GETPEERNAME                                   *         00310000
.*              GETSOCKNAME                                   *         00320000
.*              GETSOCKOPT                                    *         00330000
.*              GSKINIT                                       *@D66JDHH 00330000
.*              GSKGETCIPHINF                                 *@D66JDHH 00330000
.*              GSKGETDNBYLAB                                 *@D66JDHH 00330000
.*              GSKFREEMEM                                    *@D66JDHH 00330000
.*              GSKSSOCCLOSE                                  *@D66JDHH 00330000
.*              GSKSSOCINIT                                   *@D66JDHH 00330000
.*              GSKSSOCREAD                                   *@D66JDHH 00330000
.*              GSKSSOCRESET                                  *@D66JDHH 00330000
.*              GSKSSOCWRITE                                  *@D66JDHH 00330000
.*              GSKUNINIT                                     *@D66JDHH 00330000
.*              GIVESOCKET                                    *         00340000
.*              GLOBAL  (Specific to this interface)          *         00350000
.*              INITAPI (Specific to this interface)          *         00360000
.*              IOCTL                                         *         00370000
.*              LISTEN                                        *         00380000
.*              READ                                          *         00390000
.*              READV                                         *         00400000
.*              RECV                                          *         00410000
.*              RECVFROM                                      *         00420000
.*              RECVMSG                                       *         00430000
.*              SELECT                                        *         00440000
.*              SELECTEX                                      *         00450000
.*              SEND                                          *         00460000
.*              SENDMSG                                       *         00470000
.*              SENDTO                                        *         00480000
.*              SETSOCKOPT                                    *         00490000
.*              SHUTDOWN                                      *         00500000
.*              SOCKET                                        *         00510000
.*              SYNC                                          *         00520000
.*              TAKESOCKET                                    *         00530000
.*              TASK     (Specific to this interface)         *         00540000
.*              TERMAPI  (Specific to this interface)         *         00550000
.*              WRITE                                         *         00560000
.*              WRITEV                                        *         00570000
.*                                                            *         00580000
.*      PARAMETER ORGANIZATION                                *         00590000
.*      The parameters are organized into groups.  Each       *         00600000
.*      group is used in one or more of the function types    *         00610000
.*      listed above.  Each group is represented by a macro   *         00620000
.*      switch &PGn where n is the number of the group.       *         00630000
.*      The groups are as follows.                            *         00640000
.*                                                            *         00650000
.*      The RETCODE parameter is used in every function       *         00660000
.*      type except type 9.  It is tested as a part of        *         00670000
.*      the type 9 test.                                      *         00680000
.*                                                            *         00690000
.*      GROUP   PARAMETERS      REQUIRED FOR TYPES            *         00700000
.*      -----   ----------      ------------------            *         00710000
.*      PG1     S               ACCEPT, BIND, CLOSE, CONNECT, *         00720000
.*                              FCNTL, GETPEERNAME,           *         00730000
.*                              GETSOCKNAME, GETSOCKOPT,      *         00740000
.*                              GIVESOCKET, IOCTL, LISTEN,    *         00750000
.*                              READ, READV, RECV, RECVFROM,  *         00760000
.*                              RECVMSG,SENDMSG,SENDTO,       *         00770000
.*                              READ, RECV, RECVFROM, SENDTO, *         00780000
.*                              SETSOCKOPT, SHUTDOWN, WRITE   *         00790000
.*                              WRITEV,GSKSSOCINIT            *@D66JDHH 00800000
.*      PG2     NS              ACCEPT, SOCKET, TAKESOCKET    *         00810000
.*      PG3     NAME            ACCEPT, BIND, CONNECT,        *         00820000
.*                              GETHOSTNAME, GETPEERNAME,     *         00830000
.*                              GETSOCKNAME, RECVFROM, SENDTO *         00840000
.*                              GETHOSTBYNAME                 *         00850000
.*      PG4     ERRNO           ACCEPT, BIND, CLOSE, CONNECT  *         00860000
.*                              FCNTL, GETCLIENTID,           *         00870000
.*                              GETHOSTNAME, GETPEERNAME,     *         00880000
.*                              GETSOCKNAME, GETSOCKOPT,      *         00890000
.*                              GIVESOCKET, IOCTL             *         00900000
.*                              LISTEN, READ, RECV, RECVFROM, *         00910000
.*                              SELECT, SENDTO, SETSOCKOPT,   *         00920000
.*                              SHUTDOWN, SOCKET, TAKESOCKET, *         00930000
.*                              WRITE, SYNC, GETHOSTBYNAME    *         00940000
.*                              GETHOSTBYADDR, CANCEL         *         00950000
.*                              GSKINIT, GSKUNINIT,           *@D66JDHH 00950000
.*                              GSKGETCIPHINF, GSKSSOCINIT,   *@D66JDHH 00950000
.*                              GSKSSOCREAD, GSKSSOCWRITE,    *@D66JDHH 00950000
.*                              GSKSSOCCLOSE, GSKSSOCRESET,   *@D66JDHH 00950000
.*                              GSKGETDNBYLAB, GSKFREEMEM     *@D66JDHH 00950000
.*      PG5     COMMAND         FCNTL                         *         00960000
.*      PG6     CLIENTID        GETCLIENTID, GIVESOCKET       *         00970000
.*      PG7     NAMELEN         GETHOSTNAME, TAKESOCKET       *         00980000
.*                              GETHOSTBYNAME                 *         00990000
.*      PG8     OPTNAME,        GETSOCKOPT, SETSOCKOPT        *         01000000
.*              OPTLEN,                                       *         01010000
.*              OPTVAL                                        *         01020000
.*      PG9     STORAGE         GLOBAL, TASK                  *         01030000
.*              RETCODE         all types except GLOBAL,TASK  *         01040000
.*      PG10    MAXSOC          INITAPI, SELECT               *         01050000
.*      PG11    SUBTASK,        INITAPI                       *         01060000
.*              APITYPE,                                      *         01070000
.*              IDENT                                         *         01080000
.*      PG12    REQARG          IOCTL,FCNTL                   *         01090000
.*      PG13    RETARG          IOCTL                         *         01100000
.*      PG14    BACKLOG         LISTEN                        *         01110000
.*      PG15    BUF             READ, RECV, RECVFROM, SEND,   *         01120000
.*                              SENDTO, WRITE                 *         01130000
.*                              GSKSSOCREAD, GSKSSOCWRITE     *@D66JDHH 01130000
.*      PG16    FLAGS           RECV, RECVFROM, SEND, SENDTO  *         01140000
.*      PG17    TIMEOUT         SELECT                        *         01150000
.*              RSNDMSK,                                      *         01160000
.*              WSNDMSK,                                      *         01170000
.*              ESNDMSK,                                      *         01180000
.*              RRETMSK,                                      *         01190000
.*              WRETMSK,                                      *         01200000
.*              ERETMSK                                       *         01210000
.*      PG18    HOW             SHUTDOWN                      *         01220000
.*      PG19    AF, SOCKTYPE,   SOCKET                        *         01230000
.*              PROTO                                         *         01240000
.*      PG20    SOCRECV         TAKESOCKET                    *         01250000
.*      PG21    HOSTENT         GETHOSTBYNAME, GETHOSTBYADDR  *         01260000
.*      PG22    HOSTADDR        GETHOSTBYNAME                 *         01270000
.*      PG23    IOV,IOVCNT      READV, WRITEV                 *         01280000
.*      PG24    HOSTADDR        GETHOSTBYADDR                 *         01290000
.*      PG25    SELECB          SELECTEX                      *         01300000
.*      PG26    NBYTE           READ, RECV, RECVFROM, SEND,   *         01310000
.*                              SENDTO, WRITE                 *         01320000
.*                              GSKSSOCREAD, GSKSSOCWRITE     *@D66JDHH 01130000
.*      PG27    ALET            READ, RECV, RECVFROM, SEND,   *         01330000
.*                              SENDTO, WRITE                 *         01340000
.*      PG28    ECB, REQAREA    ACCEPT, BIND, CLOSE, CONNECT  *         01350000
.*                              FCNTL, GETCLIENTID,           *         01360000
.*                              GETHOSTNAME, GETPEERNAME,     *         01370000
.*                              GETSOCKNAME, GETSOCKOPT,      *         01380000
.*                              GIVESOCKET, IOCTL             *         01390000
.*                              LISTEN, READ, RECV, RECVFROM, *         01400000
.*                              SELECT, SENDTO, SETSOCKOPT,   *         01410000
.*                              SHUTDOWN, SOCKET, TAKESOCKET, *         01420000
.*                              WRITE, SYNC, CANCEL, GETHOSTID*         01430000
.*      PG29    CALAREA         CANCEL                        *         01440000
.*      PG30    SECTYPE         GSKINIT, GSKSSOCINIT          *@D66JDHH 01440000
.*      PG31    KEYRING         GSKINIT                       *@D66JDHH 01440000
.*              V3TIMEOUT                                     *@D66JDHH 01440000
.*              CAROOTS                                       *@D66JDHH 01440000
.*              AUTHTYPE                                      *@D66JDHH 01440000
.*      PG32    CIPHLEVEL       GSKGETCIPHINF                 *@D66JDHH 01450000
.*              SECLEVEL                                      *@D66JDHH 01450000
.*      PG33    HANDSHAKE       GSKSSOCINIT                   *@D66JDHH 01450000
.*              DNAME                                         *@D66JDHH 01450000
.*              V3CIPHER                                      *@D66JDHH 01450000
.*              V3CIPHSEL                                     *@D66JDHH 01450000
.*              CERTINFO                                      *@D66JDHH 01450000
.*              REASCODE                                      *@D66JDHH 01450000
.*              SKREAD                                        *@D66JDHH 01450000
.*              SKWRITE                                       *@D66JDHH 01450000
.*      PG34    SSOCDATA        GSKSSOCREAD, GSKSSOCWRITE,    *@D66JDHH 01450000
.*                              GSKSSOCCLOSE, GSKSSOCRESET    *@D66JDHH 01450000
.*      PG35    KEYLABEL        GSKGETDNBYLAB                 *@D66JDHH 01450000
.*      PG36    AREA            GSKFREEMEM                    *@D66JDHH 01450000
.*                                                            *         01450000
.*      MACRO ORGANIZATION                                    *         01460000
.*                                                            *         01470000
.*      The macro is divided into four  parts.  The first     *         01480000
.*      part, beginning at entry checks the TYPE parameter    *         01490000
.*      for a valid entry.  If it is a valid entry, the       *         01500000
.*      switches are set indicating which parameters are      *         01510000
.*      required for this type and which parameters would     *         01520000
.*      be inappropriate for this type.  If a parameter       *         01530000
.*      is optional, no switch is set.                        *         01540000
.*                                                            *         01550000
.*      The second part of the macro, beginning at label      *         01560000
.*      .TYP50 analyzes the parameters entered.  If the       *         01570000
.*      TYPE specified requires a parameter which has not     *         01580000
.*      been entered, a level 12 MNOTE is issued and          *         01590000
.*      macro generation is terminated.  If a parameter       *         01600000
.*      is specified which is not appropriate for the TYPE    *         01610000
.*      specified, a level 4 MNOTE is issues and generation   *         01620000
.*      continues.                                            *         01630000
.*                                                            *         01640000
.*      The third part of the macro, beginning at label       *         01650000
.*      .PCHECK generates instructions.  There are two inner  *         01660000
.*      macros, EZASMIL and EZASMIS which develop             *         01670000
.*      instructions to put the address of an argument into   *         01680000
.*      R0.  The macro generates an ST to put this address    *         01690000
.*      into its correct position in the parameter list.      *         01700000
.*                                                            *         01710000
.*      With the exception of TYPE=TASK and TYPE=GLOBAL,      *         01720000
.*      all expansions of the macro expand into a LINK to     *         01730000
.*      EZASOH03.  This linkage is generated by the fourth    *         01740000
.*      part of the macro.  There are two parm lists.  Both   *         01750000
.*      are contained in the task storage EZASMTIE. One       *         01760000
.*      has a standard format for all calls and is passed     *         01770000
.*      to EZACIC03 via register 1.  This list contains       *         01780000
.*      the addresses of the global storage, the task         *         01790000
.*      storage and other parameters.  The other parameter    *         01800000
.*      list is a part of the task storage and is located     *         01810000
.*      by EZACIC03 using the field TIEAPARM.                 *         01820000
.*                                                            *         01830000
.*   CHANGE-ACTIVITY =                                        *         01840000
.* CFD List:                                                  *         01850000
.*                                                            *         01860000
.* $MAC(EZASMI) PROD(TCPIP): S/390 Assembler Sockets Interface*         01870000
.*                                                            *         01880000
.*   $P1= MV10908  V3R2 950607  ROS: PTR MV10908, APITYPE     *         01890000
.*   $P2= MV11023  V3R2 950929 HERR: Reject APITYPE 3 no ASYNC*         01900000
.*   $P3= MV11077  V3R2 950929 HERR: TOKEN should be zeroes   *         01910000
.*   $P4= MV11090  V3R2 951013 HERR: Fixed bugs in following  *         01920000
.*                                   macros since MF= added:  *         01930000
.*                             RECVMSG - add len to MVC insts *         01940000
.*                                     - Use R14 for NAME parm*         01950000
.*                             SENDMSG - add len to MVC insts *         01960000
.*                             SOCKET - Use R14 on NS parm    *         01970000
.*                             TAKESOCKET - Use R14 on SOCRECV*         01980000
.*                                        - Use R14 on NS parm*         01990000
.*   $P5= MV11228  V3R2 951221 HERR: Allow SELECTEX as valid  *         02000000
.*                                   first macro.             *         02010000
.*   $P6= MV11196  V3R2 951222 HERR: Add SO_REUSEADDR to      *         02020000
.*                                   GETSOCKOPT call.         *         02030000
.*   $P7= MV11239  V3R2 960104 HERR: Don't turn on hi-order   *         02040000
.*                                   bit for SELECTEX         *         02050000
.*   $P8= MV11256  V3R2 960111 HERR: LA offs hi-order bit for *         02060000
.*                                   SELECB parm on SELECTEX  *         02070000
.*   $P9= MV11535  V3R2 960307 HERR: SELECB=(2) generates LA  *         02080000
.*                                   instead of LR instruct.  *         02090000
.*   $PA= MV11633  V3R2 960320 HERR: Add ERRET to LOAD for    *         02100000
.*                                   EZASOH03.                *         02110000
.* $L1= D45MDEYE HTCP320 951214 KAA: RAS DCR - Mod Eyecatchers*         02120000
.* $01= PN83089  HTCP320 960513 HERR: Forward fit of PN83089  *         02134990
.* $02= PN90677  HTCP320 961030 HERR:F_GETFL command produces *         02139980
.*                                   incorrect value for FCNTL*         02144970
.* $03= PN90475  HTCP320 961025 LSHORT: Set R15 return code & *         02145970
.*                                      add &CALLAREA         *         02146970
.* $  = PQ02770  HTCP320 970326 LSHORT: Remove bad diagnostics*         02147970
.*   $PB= MV15129  V3R4 970725  paj: Add SIOCGMONDATA support *         02147980
.* Flag Reason   Release  Date   Origin    Description        *         02148180
.* ---- -------- -------- ------ --------  -------------------*         02148380
.* $A1= PQ11231  HTCP310  971205 LSHORT:   Route of PQ08338.  *         02148580
.*                                         Delete EZASOH03    *         02148780
.*                                         after TERMAPI.     *         02148980
.* $A2= PQ16494  HTCP320  980705 LSHORT:   Route of PQ13154 & *         02149370
.*                                         PQxxxxx.           *         02149560
.*                                                            *         02149750
.* @D65CDHH      VSE 250  991202           VSE/ESA Adaptation *         02149750
.* @D66JDHH      VSE 260  010321           SSL Support        *         02149750
.* @DY45684      VSE 250  010803           Probl w/ List and  m@DY45684         
.*                                         Execute Macro Form *         02149750
.* End CFD List:                                              *         02150000
.*------------------------------------------------------------*         02160000
               MACRO                                                    02170000
&LABEL   EZASMI &TYPE=,        TYPE OF FUNCTION REQUESTED              *02180000
               &S=,            SOCKET DESCRIPTOR PARAMETER             *02190000
               &NS=,           NEW SOCKET DESCRIPTOR PARAMETER         *02200000
               &SOCRECV=,      SOCKET RECEIVED BY TAKESOCKET           *02210000
               &NAME=,         SOCKET ADDRESS STRUCTURE                *02220000
               &ERRNO=,        FIELD FOR RETURNED ERROR NUMBER         *02230000
               &RETCODE=,      FIELD FOR RETURN CODE                   *02240000
               &ECB=,          ADDRESS OF USER'S ECB AREA              *02250000
               &REQAREA=,      ADDRESS OF USER'S REQUEST AREA          *02260000
               &ERROR=,        ADDRESS TO BRANCH TO IF ERROR OCCURS    *02270000
               &COMMAND=,      COMMAND CODE FOR FCNTL/IOCTL            *02280000
               &REQARG=,       REQUEST ARGUMENT FOR FCNTL/IOCTL        *02290000
               &RETARG=,       RETURN ARGUMENT FOR IOCTL               *02300000
               &NAMELEN=,      LENGTH OF NAME FIELD                    *02310000
               &OPTNAME=,      OPTION NAME FOR GETSOCKOPT/SETSOCKOPT   *02320000
               &OPTLEN=,       VALUE LENGTH FOR GETSOCKOPT/SETSOCKOPT  *02330000
               &OPTVAL=,       OPTION VALUE FOR GETSOCKOPT/SETSOCKOPT  *02340000
               &CLIENT=,       CLIENT STRUCTURE                        *02350000
               &MAXSOC=,       MAX NUMBER OF SOCKETS - INITAPI/SELECT  *02360000
               &MAXSNO=,       MAX NUMBER OF SOCKETS RETURNED          *02370000
               &UEEXIT=,       UNSOLICITED EVENT EXIT CONTROL          *02380000
               &ASYNC=,        ASYNCHRONOUS PROCESSING CONTROL         *02390000
               &SUBTASK=,      SUBTASK IDENTIFIER                      *02400000
               &IDENT=,        TCP/IP AND USER ADDRESS SPACE IDENTIFIER*02410000
               &APITYPE=,      API TYPE FIELD                          *02420000
               &BACKLOG=,      BACKLOG LENGTH FOR LISTEN               *02430000
               &NBYTE=,        LENGTH OF BUFFER/DATA                   *02440000
               &BUF=,          DATA BUFFER                             *02450000
               &IOVCNT=,       NUMBER OF DATA BUFFERS                  *02460000
               &IOV=,          INPUT/OUTPUT VECTOR                     *02470000
               &ALET=,         ALET                                    *02480000
               &CALAREA=,      CALL BEING CANCELLED'S ECB/REQAREA      *02490000
               &CALLAREA=,     CALL BEING CANCELLED'S ECB/REQAREA  @03A*02495000
               &FLAGS=,        FLAGS FIELD FOR RECV AND SEND           *02500000
               &TIMEOUT=,      TIMEOUT VALUE FOR SELECT                *02510000
               &RSNDMSK=,      CONTROL MASK FOR READ EVENTS            *02520000
               &WSNDMSK=,      CONTROL MASK FOR WRITE EVENTS           *02530000
               &ESNDMSK=,      CONTROL MASK FOR EXCEPTION EVENTS       *02540000
               &RRETMSK=,      RETURN  MASK FOR READ EVENTS            *02550000
               &WRETMSK=,      RETURN  MASK FOR WRITE EVENTS           *02560000
               &ERETMSK=,      RETURN  MASK FOR EXCEPTION EVENTS       *02570000
               &HOW=,          SHUTDOWN DESCRIPTION PARAMETER          *02580000
               &SOCTYPE=,      STREAM OR DATAGRAM SOCKET               *02590000
               &AF=,           ADDRESSING FAMILY                       *02600000
               &PROTO=,        PROTOCOL                                *02610000
               &STORAGE=,      STORAGE PARAMETER FOR GLOBAL/TASK       *02620000
               &HOSTENT=,      HOSTENT PARAMETER 4 GETHOSTBYNAME/ADDR  *02630000
               &HOSTADR=,      HOSTADDR PARAMETER FOR GETHOSTBYADDR    *02640000
               &CICS=,         GENERATE CODE FOR CICS                  *02650000
               &TASK=,         SPECIFY TASK AREA TO REFERENCE          *02660000
               &MF=,           TYPE OF MACRO GENERATION (L,E,N)        *02670000
               &MSG=,          MESSAGE ARRAY FOR RECVMSG AND SENDMSG   *02680000
               &SELECB=,       ECB FOR EXTERNAL POSTING OF SELECTEX    *02690000
               &SECTYPE=,      MINIMUM SECURITY LEVEL          @D66JDHH*02690000
               &KEYRING=,      KEYRING NAME                    @D66JDHH*02690000
               &V3TIMEOUT=,    TIMEOUT FOR SSL V3 SESSION ID   @D66JDHH*02690000
               &CAROOTS=,      CERTIFICATE AUTHORITY ROOT      @D66JDHH*02690000
               &AUTHTYPE=,     METHOD FOR CERTIFICATE VERIFIC. @D66JDHH*02690000
               &CIPHLEVEL=,    CIPHER LEVEL                    @D66JDHH*02690000
               &SECLEVEL=,     SECURITY LEVEL                  @D66JDHH*02690000
               &HANDSHAKE=,    SSL HANDSHAKE LEVEL             @D66JDHH*02690000
               &DNAME=,        DISTINGUISHED NAME OF KEY       @D66JDHH*02690000
               &V3CIPHER=,     SSL V3 CIPHER LIST              @D66JDHH*02690000
               &V3CIPHSEL=,    SSL V3 CIPHER SPECS SELECTED    @D66JDHH*02690000
               &CERTINFO=,     CERTIFICATE INFORMATION         @D66JDHH*02690000
               &REASCODE=,     FAILURE REASON CODE             @D66JDHH*02690000
               &SKREAD=,       READ ROUTINE FOR GSK CALLS      @D66JDHH*02690000
               &SKWRITE=,      WRITE ROUTINE FOR GSK CALLS     @D66JDHH*02690000
               &SSOCDATA=,     GSKSSOCDATA POINTER             @D66JDHH*02690000
               &KEYLABEL=,     LABEL FOR THE KEY               @D66JDHH*02690000
               &AREA=,         AREA TO BE FREED                @D66JDHH*02690000
               &DUMMY=DUMMY                                             02700000
.*  GLOBAL FOR SPLEVEL MACRO                                            02710000
         GBLC  &SYSSPLV                                                 02720000
.*  GLOBAL FOR TRANSPORT LEVEL                                          02730000
         GBLC  &TRNSPRT                                                 02740000
.*  GLOBAL USED FOR COMMUNICATION WITH EZASMIS                          02750000
         GBLC  &CONST                                                   02760000
.*  GLOBAL USED FOR COMMUNICATION WITH EZASMIP                          02770000
         GBLB  &NOGEN                                                   02780000
&NOGEN   SETB  0               INITIALIZE GENERATION SWITCH             02790000
.*  COMMAND CODE                                                        02800000
         LCLC  &CMD                                                     02810000
.*  MACRO SWITCHES FOR PARAMETER CHECK LOGIC                            02820000
         LCLB  &PG1,&PG2,&PG3,&PG4,&PG5,&PG6,&PG7,&PG8,&PG9             02830000
         LCLB  &PG10,&PG11,&PG12,&PG13,&PG14                            02840000
         LCLB  &PG15,&PG16,&PG17,&PG18,&PG19                            02850000
         LCLB  &PG20,&PG21,&PG22,&PG23,&PG24                            02860000
         LCLB  &PG25,&PG26,&PG27,&PG28,&PG29                            02870000
         LCLB  &PG30,&PG31,&PG32,&PG33,&PG34                  @D66JDHH          
         LCLB  &PG35,&PG36                                    @D66JDHH          
         LCLB  &PGRET,&TIEGEN,&LABGEN                                   02880000
         LCLB  &LOAD                                                    02890000
         LCLA  &LOM                                                     02900000
.*  MACRO GENERATION TYPE                                               02910000
         LCLC  &MACFORM                                                 02920000
.*  TEMPORARY CHARACTER FIELD                                           02930000
         LCLC  &TEMPCH                                                  02940000
.*  NAME OF ERRORNO PARAMETER FIELD                                     02950000
         LCLC  &ERRPARM                                                 02960000
.*  FULLWORD CONSTANTS                                                  02970000
         LCLC  &FC1,&FC2,&FC3,&FC4,&FC5                                 02980000
         LCLC  &RC1                                                     02990000
.*  HALFWORD CONSTANTS                                                  03000000
         LCLC  &HC1,&HC2,&HC3,&HC4,&HC5                                 03010000
.*  CHARACTER CONSTANTS                                                 03020000
         LCLC  &CC2,&CC3                                                03030000
.*                                                                      03040000
.*------------------------------------------------------------*         03050000
.* Determine if MF was specified and set macro variable       *         03060000
.*------------------------------------------------------------*         03070000
.MF00    ANOP                                                           03080000
         AIF   (K'&MF EQ 0).MF03       Default to standard              03090000
         AIF   ('&MF(1)' NE 'E').MF01  Is it execute form               03100000
&MACFORM SETC  'E'               Yes, set macro variable                03110000
         AGO   .TYP00                                                   03120000
.MF01    ANOP                                                           03130000
         AIF   ('&MF' NE 'L').MF02     Is it list form                  03140000
&MACFORM SETC  'L'               Yes, set macro variable                03150000
         AGO   .LIST00           Go generate parameter list             03160000
.MF02    ANOP                                                           03170000
         AIF   ('&MF' NE 'N').MF03     Is it no-call form               03180000
&MACFORM SETC  'N'               Yes, set macro variable                03190000
         AGO   .TYP00            Go generate parameter list             03200000
.MF03    ANOP                                                           03210000
&MACFORM SETC  'S'               Standard form is default               03220000
.TYP00   ANOP     Check for correct type                                03230000
.*------------------------------------------------------------*         03240000
.* Determine if a correct TYPE was specified                  *         03250000
.*------------------------------------------------------------*         03260000
         AIF   (K'&TYPE  NE 0).TYP0    TEST FOR TYPE SPECIFIED          03270000
         MNOTE 12,'EZASM001 No TYPE Specified'                          03280000
         MEXIT                                                          03290000
.TYP0    ANOP                                                           03300000
         AIF   ('&TYPE' EQ 'EQU').TYPEQU  Go generate EQUATES @D65CDHH  03310000
         AIF   ('&TYPE' NE 'INITAPI').TYP1  Is it INITAPI               03310000
&CMD     SETC  '00'          Yes, set command code                      03320000
&PG4     SETB  1             Set Parameter Group 4                      03330000
&PG10    SETB  1             Set Parameter Group 10                     03340000
&PG11    SETB  1             Set Parameter Group 11                     03350000
         AGO   .TYP50        Go check parameter list                    03360000
.TYP1    ANOP                                                           03370000
         AIF   ('&TYPE' NE 'ACCEPT').TYP2  Is it ACCEPT                 03380000
&CMD     SETC  '01'          Yes, set command code                      03390000
&PG1     SETB  1             Set Parameter Group 1                      03400000
&PG2     SETB  1             Set Parameter Group 2                      03410000
&PG3     SETB  1             Set Parameter Group 3                      03420000
&PG4     SETB  1             Set Parameter Group 4                      03430000
&PG28    SETB  1             Set Parameter Group 28                     03440000
         AGO   .TYP50        Go check parameter list                    03450000
.TYP2    ANOP                                                           03460000
         AIF   ('&TYPE' NE 'BIND').TYP3  Is it BIND                     03470000
&CMD     SETC  '02'          Yes, set command code                      03480000
&PG1     SETB  1             Set Parameter Group 1                      03490000
&PG3     SETB  1             Set Parameter Group 3                      03500000
&PG4     SETB  1             Set Parameter Group 4                      03510000
&PG28    SETB  1             Set Parameter Group 28                     03520000
         AGO   .TYP50        Go check parameter list                    03530000
.TYP3    ANOP                                                           03540000
         AIF   ('&TYPE' NE 'CLOSE').TYP4  Is it CLOSE                   03550000
&CMD     SETC  '03'          Yes, set command code                      03560000
&PG1     SETB  1             Set Parameter Group 1                      03570000
&PG4     SETB  1             Set Parameter Group 4                      03580000
&PG28    SETB  1             Set Parameter Group 28                     03590000
         AGO   .TYP50        Go check parameter list                    03600000
.TYP4    ANOP                                                           03610000
         AIF   ('&TYPE' NE 'CONNECT').TYP5  Is it CONNECT               03620000
&CMD     SETC  '04'          Yes, set command code                      03630000
&PG1     SETB  1             Set Parameter Group 1                      03640000
&PG3     SETB  1             Set Parameter Group 3                      03650000
&PG4     SETB  1             Set Parameter Group 4                      03660000
&PG28    SETB  1             Set Parameter Group 28                     03670000
         AGO   .TYP50        Go check parameter list                    03680000
.TYP5    ANOP                                                           03690000
         AIF   ('&TYPE' NE 'FCNTL').TYP6  Is it FCNTL                   03700000
&CMD     SETC  '05'          Yes, set command code                      03710000
&PG1     SETB  1             Set Parameter Group 1                      03720000
&PG4     SETB  1             Set Parameter Group 4                      03730000
&PG5     SETB  1             Set Parameter Group 5                      03740000
&PG12    SETB  1             Set Parameter Group 12                     03750000
&PG28    SETB  1             Set Parameter Group 28                     03760000
         AGO   .TYP50        Go check parameter list                    03770000
.TYP6    ANOP     There is no type 6                                    03780000
.TYP7    ANOP                                                           03790000
         AIF   ('&TYPE' NE 'GETHOSTID').TYP8  Is it GETHOSTID           03800000
&CMD     SETC  '07'          Yes, set command code                      03810000
&PG4     SETB  1             Set Parameter Group 4                      03820000
&PG28    SETB  1             Set Parameter Group 28                     03830000
         AGO   .TYP50        Go check parameter list                    03840000
.TYP8    ANOP                                                           03850000
         AIF   ('&TYPE' NE 'GETHOSTNAME').TYP9  Is it GETHOSTNAME       03860000
&CMD     SETC  '08'          Yes, set command code                      03870000
&PG3     SETB  1             Set Parameter Group 3                      03880000
&PG4     SETB  1             Set Parameter Group 4                      03890000
&PG7     SETB  1             Set Parameter Group 7                      03900000
&PG28    SETB  1             Set Parameter Group 28                     03910000
         AGO   .TYP50        Go check parameter list                    03920000
.TYP9    ANOP                                                           03930000
         AIF   ('&TYPE' NE 'GETPEERNAME').TYP10 Is it GETPEERNAME       03940000
&CMD     SETC  '09'          Yes, set command code                      03950000
&PG1     SETB  1             Set Parameter Group 1                      03960000
&PG3     SETB  1             Set Parameter Group 3                      03970000
&PG4     SETB  1             Set Parameter Group 4                      03980000
&PG28    SETB  1             Set Parameter Group 28                     03990000
         AGO   .TYP50        Go check parameter list                    04000000
.TYP10   ANOP                                                           04010000
         AIF   ('&TYPE' NE 'GETSOCKNAME').TYP11 Is it GETSOCKNAME       04020000
&CMD     SETC  '10'          Yes, set command code                      04030000
&PG1     SETB  1             Set Parameter Group 1                      04040000
&PG3     SETB  1             Set Parameter Group 3                      04050000
&PG4     SETB  1             Set Parameter Group 4                      04060000
&PG28    SETB  1             Set Parameter Group 28                     04070000
         AGO   .TYP50        Go check parameter list                    04080000
.TYP11   ANOP                                                           04090000
         AIF   ('&TYPE' NE 'GETSOCKOPT').TYP12 Is it GETSOCKOPT         04100000
&CMD     SETC  '11'          Yes, set command code                      04110000
&PG1     SETB  1             Set Parameter Group 1                      04120000
&PG4     SETB  1             Set Parameter Group 4                      04130000
&PG8     SETB  1             Set Parameter Group 8                      04140000
&PG28    SETB  1             Set Parameter Group 28                     04150000
         AGO   .TYP50        Go check parameter list                    04160000
.TYP12   ANOP                                                           04170000
         AIF   ('&TYPE' NE 'IOCTL').TYP13 Is it IOCTL                   04180000
&CMD     SETC  '12'          Yes, set command code                      04190000
&PG1     SETB  1             Set Parameter Group 1                      04200000
&PG4     SETB  1             Set Parameter Group 4                      04210000
&PG5     SETB  1             Set Parameter Group 5                      04220000
&PG12    SETB  1             Set Parameter Group 12                     04230000
&PG13    SETB  1             Set Parameter Group 13                     04240000
&PG28    SETB  1             Set Parameter Group 28                     04250000
         AGO   .TYP50        Go check parameter list                    04260000
.TYP13   ANOP                                                           04270000
         AIF   ('&TYPE' NE 'LISTEN').TYP14 Is it LISTEN                 04280000
&CMD     SETC  '13'          Yes, set command code                      04290000
&PG1     SETB  1             Set Parameter Group 1                      04300000
&PG4     SETB  1             Set Parameter Group 4                      04310000
&PG14    SETB  1             Set Parameter Group 14                     04320000
&PG28    SETB  1             Set Parameter Group 28                     04330000
         AGO   .TYP50        Go check parameter list                    04340000
.TYP14   ANOP                                                           04350000
         AIF   ('&TYPE' NE 'READ').TYP15 Is it READ                     04360000
&CMD     SETC  '14'          Yes, set command code                      04370000
&PG1     SETB  1             Set Parameter Group 1                      04380000
&PG4     SETB  1             Set Parameter Group 4                      04390000
&PG15    SETB  1             Set Parameter Group 15                     04400000
&PG26    SETB  1             Set Parameter Group 26                     04410000
&PG27    SETB  1             Set Parameter Group 27                     04420000
&PG28    SETB  1             Set Parameter Group 28                     04430000
         AGO   .TYP50        Go check parameter list                    04440000
.TYP15   ANOP                                                           04450000
         AIF   ('&TYPE' NE 'READV').TYP16 Is it READV                   04460000
&CMD     SETC  '15'          Yes, set command code                      04470000
&PG1     SETB  1             Set Parameter Group 1                      04480000
&PG4     SETB  1             Set Parameter Group 4                      04490000
&PG22    SETB  1             Set Parameter Group 22                     04500000
&PG28    SETB  1             Set Parameter Group 28                     04510000
         AGO   .TYP50        Go check parameter list                    04520000
.TYP16   ANOP                                                           04530000
         AIF   ('&TYPE' NE 'RECV').TYP17  Is it RECV                    04540000
&CMD     SETC  '16'          Yes, set command code                      04550000
&PG1     SETB  1             Set Parameter Group 1                      04560000
&PG4     SETB  1             Set Parameter Group 4                      04570000
&PG15    SETB  1             Set Parameter Group 15                     04580000
&PG16    SETB  1             Set Parameter Group 16                     04590000
&PG26    SETB  1             Set Parameter Group 26                     04600000
&PG27    SETB  1             Set Parameter Group 27                     04610000
&PG28    SETB  1             Set Parameter Group 28                     04620000
         AGO   .TYP50        Go check parameter list                    04630000
.TYP17   AIF   ('&TYPE' NE 'RECVFROM').TYP18  Is it RECVFROM            04640000
&CMD     SETC  '17'          Yes, set command code                      04650000
&PG1     SETB  1             Set Parameter Group 1                      04660000
&PG3     SETB  1             Set Parameter Group 3                      04670000
&PG4     SETB  1             Set Parameter Group 4                      04680000
&PG15    SETB  1             Set Parameter Group 15                     04690000
&PG16    SETB  1             Set Parameter Group 16                     04700000
&PG26    SETB  1             Set Parameter Group 26                     04710000
&PG27    SETB  1             Set Parameter Group 27                     04720000
&PG28    SETB  1             Set Parameter Group 28                     04730000
         AGO   .TYP50        Go check parameter list                    04740000
.TYP18   ANOP                                                           04750000
         AIF   ('&TYPE' NE 'RECVMSG').TYP19  Is it RECVMSG              04760000
&CMD     SETC  '18'          Yes, set command code                      04770000
&PG1     SETB  1             Set Parameter Group 1                      04780000
&PG4     SETB  1             Set Parameter Group 4                      04790000
&PG16    SETB  1             Set Parameter Group 16                     04800000
&PG23    SETB  1             Set Parameter Group 23                     04810000
&PG28    SETB  1             Set Parameter Group 28                     04820000
         AGO   .TYP50        Go check parameter list                    04830000
.TYP19   ANOP                                                           04840000
         AIF   ('&TYPE' NE 'SELECT').TYP20  IS IT SELECT                04850000
&CMD     SETC  '19'          Yes, set command code                      04860000
&PG4     SETB  1             Set Parameter Group 4                      04870000
&PG10    SETB  1             Set Parameter Group 10                     04880000
&PG17    SETB  1             Set Parameter Group 17                     04890000
&PG28    SETB  1             Set Parameter Group 28                     04900000
         AGO   .TYP50        Go check parameter list                    04910000
.TYP20   ANOP                                                           04920000
         AIF   ('&TYPE' NE 'SEND').TYP21 Is it SEND                     04930000
&CMD     SETC  '20'          Yes, set command code                      04940000
&PG1     SETB  1             Set Parameter Group 1                      04950000
&PG4     SETB  1             Set Parameter Group 4                      04960000
&PG15    SETB  1             Set Parameter Group 15                     04970000
&PG16    SETB  1             Set Parameter Group 16                     04980000
&PG26    SETB  1             Set Parameter Group 26                     04990000
&PG27    SETB  1             Set Parameter Group 27                     05000000
&PG28    SETB  1             Set Parameter Group 28                     05010000
         AGO   .TYP50        Go check parameter list                    05020000
.TYP21   ANOP                                                           05030000
         AIF   ('&TYPE' NE 'SENDMSG').TYP22  Is it SENDMSG              05040000
&CMD     SETC  '21'          Yes, set command code                      05050000
&PG1     SETB  1             Set Parameter Group 1                      05060000
&PG4     SETB  1             Set Parameter Group 4                      05070000
&PG16    SETB  1             Set Parameter Group 16                     05080000
&PG23    SETB  1             Set Parameter Group 23                     05090000
&PG28    SETB  1             Set Parameter Group 28                     05100000
         AGO   .TYP50        Go check parameter list                    05110000
.TYP22   ANOP                                                           05120000
         AIF   ('&TYPE' NE 'SENDTO').TYP23 Is it SENDTO                 05130000
&CMD     SETC  '22'          Yes, set command code                      05140000
&PG1     SETB  1             Set Parameter Group 1                      05150000
&PG3     SETB  1             Set Parameter Group 3                      05160000
&PG4     SETB  1             Set Parameter Group 4                      05170000
&PG15    SETB  1             Set Parameter Group 15                     05180000
&PG16    SETB  1             Set Parameter Group 16                     05190000
&PG26    SETB  1             Set Parameter Group 26                     05200000
&PG27    SETB  1             Set Parameter Group 27                     05210000
&PG28    SETB  1             Set Parameter Group 28                     05220000
         AGO   .TYP50        Go check parameter list                    05230000
.TYP23   ANOP                                                           05240000
         AIF   ('&TYPE' NE 'SETSOCKOPT').TYP24 Is it SETSOCKOPT         05250000
&CMD     SETC  '23'          Yes, set command code                      05260000
&PG1     SETB  1             Set Parameter Group 1                      05270000
&PG4     SETB  1             Set Parameter Group 4                      05280000
&PG8     SETB  1             Set Parameter Group 8                      05290000
&PG28    SETB  1             Set Parameter Group 28                     05300000
         AGO   .TYP50        Go check parameter list                    05310000
.TYP24   ANOP                                                           05320000
         AIF   ('&TYPE' NE 'SHUTDOWN').TYP25 Is it SHUTDOWN             05330000
&CMD     SETC  '24'          Yes, set command code                      05340000
&PG1     SETB  1             Set Parameter Group 1                      05350000
&PG4     SETB  1             Set Parameter Group 4                      05360000
&PG18    SETB  1             Set Parameter Group 18                     05370000
&PG28    SETB  1             Set Parameter Group 28                     05380000
         AGO   .TYP50        Go check parameter list                    05390000
.TYP25   ANOP                                                           05400000
         AIF   ('&TYPE' NE 'SOCKET').TYP26 Is it SOCKET                 05410000
&CMD     SETC  '25'          Yes, set command code                      05420000
&PG2     SETB  1             Set Parameter Group 2                      05430000
&PG4     SETB  1             Set Parameter Group 4                      05440000
&PG19    SETB  1             Set Parameter Group 19                     05450000
&PG28    SETB  1             Set Parameter Group 28                     05460000
         AGO   .TYP50        Go check parameter list                    05470000
.TYP26   ANOP                                                           05480000
         AIF   ('&TYPE' NE 'WRITE').TYP27 Is it WRITE                   05490000
&CMD     SETC  '26'          Yes, set command code                      05500000
&PG1     SETB  1             Set Parameter Group 1                      05510000
&PG4     SETB  1             Set Parameter Group 4                      05520000
&PG15    SETB  1             Set Parameter Group 15                     05530000
&PG26    SETB  1             Set Parameter Group 26                     05540000
&PG27    SETB  1             Set Parameter Group 27                     05550000
&PG28    SETB  1             Set Parameter Group 28                     05560000
         AGO   .TYP50        Go check parameter list                    05570000
.TYP27   ANOP       There is no type 27                                 05580000
         AIF   ('&TYPE' NE 'WRITEV').TYP28 Is it WRITEV                 05590000
&CMD     SETC  '27'          Yes, set command code                      05600000
&PG1     SETB  1             Set Parameter Group 1                      05610000
&PG4     SETB  1             Set Parameter Group 4                      05620000
&PG22    SETB  1             Set Parameter Group 22                     05630000
&PG28    SETB  1             Set Parameter Group 28                     05640000
         AGO   .TYP50        Go check parameter list                    05650000
.TYP28   ANOP       There is no type 28                                 05660000
.TYP29   ANOP       There is no type 29                                 05670000
.TYP30   ANOP                                                           05680000
         AIF   ('&TYPE' NE 'GETCLIENTID').TYP31 Is it GETCLIENTID       05690000
&CMD     SETC  '30'          Yes, set command code                      05700000
&PG4     SETB  1             Set Parameter Group 4                      05710000
&PG6     SETB  1             Set Parameter Group 6                      05720000
&PG28    SETB  1             Set Parameter Group 28                     05730000
         AGO   .TYP50        Go check parameter list                    05740000
.TYP31   ANOP                                                           05750000
         AIF   ('&TYPE' NE 'GIVESOCKET').TYP32 Is it GIVESOCKET         05760000
&CMD     SETC  '31'          Yes, set command code                      05770000
&PG1     SETB  1             Set Parameter Group 1                      05780000
&PG4     SETB  1             Set Parameter Group 4                      05790000
&PG6     SETB  1             Set Parameter Group 6                      05800000
&PG28    SETB  1             Set Parameter Group 28                     05810000
         AGO   .TYP50        Go check parameter list                    05820000
.TYP32   ANOP                                                           05830000
         AIF   ('&TYPE' NE 'TAKESOCKET').TYP33 Is it TAKESOCKET         05840000
&CMD     SETC  '32'          Yes, set command code                      05850000
&PG2     SETB  1             Set Parameter Group 2                      05860000
&PG4     SETB  1             Set Parameter Group 4                      05870000
&PG6     SETB  1             Set Parameter Group 6                      05880000
&PG20    SETB  1             Set Parameter Group 20                     05890000
&PG28    SETB  1             Set Parameter Group 28                     05900000
         AGO   .TYP50        Go check parameter list                    05910000
.TYP33   ANOP                                                           05920000
         AIF   ('&TYPE' NE 'GLOBAL').TYP34  Is it GLOBAL                05930000
&CMD     SETC  '33'          Yes, set command code                      05940000
&PG9     SETB  1             Set parameter group 9                      05950000
         AGO   .TYP50        Go check parameter list                    05960000
.TYP34   ANOP                                                           05970000
         AIF   ('&TYPE' NE 'TASK').TYP35  Is it TASK                    05980000
&CMD     SETC  '34'          Yes, set command code                      05990000
&PG9     SETB  1             Set parameter group 9                      06000000
         AGO   .TYP50        Go check parameter list                    06010000
.TYP35   ANOP                                                           06020000
         AIF   ('&TYPE' NE 'SYNC').TYP36  Is it SYNC                    06030000
         MNOTE 0,'EZASMI TYPE=SYNC NOT SUPPORTED'                       06040000
         MEXIT                                                          06050000
.TYP36   ANOP                                                           06060000
         AIF   ('&TYPE' NE 'TERMAPI').TYP37  IS IT TERMAPI              06070000
&CMD     SETC  '36'          Yes, set command code                      06080000
         AGO   .TYP50        Go check parameter list                    06090000
.TYP37   ANOP                                                           06100000
         AIF   ('&TYPE' NE 'SELECTEX').TYP38  IS IT SELECTEX            06110000
&CMD     SETC  '37'          YES, SET COMMAND CODE                      06120000
&PG4     SETB  1             Set Parameter Group 4                      06130000
&PG10    SETB  1             Set Parameter Group 10                     06140000
&PG17    SETB  1             Set Parameter Group 17                     06150000
&PG25    SETB  1             Set Parameter Group 25                     06160000
         AGO   .TYP50        Go check parameter list                    06170000
.TYP38   ANOP                                                           06180000
         AIF   ('&TYPE' NE 'GETIBMOPT').TYP39 IS IT GETIBMOPT           06190000
&CMD     SETC  '38'          Yes, set command code                      06200000
&PG4     SETB  1             Set parameter group 4                      06210000
&PG5     SETB  1             Set parameter group 5                      06220000
&PG15    SETB  1             Set parameter group 15                     06230000
         AGO   .TYP50        Go check parameter list                    06240000
.TYP39   ANOP                                                           06250000
.TYP40   ANOP                                                           06260000
         AIF   ('&TYPE' NE 'GETHOSTBYNAME').TYP41 IS IT GETHOSTBYNAME   06270000
&CMD     SETC  '40'          Yes, set command code                      06280000
&PG3     SETB  1             Set parameter group 3                      06290000
&PG7     SETB  1             Set parameter group 7                      06300000
&PG21    SETB  1             Set parameter group 21                     06310000
         AGO   .TYP50        Go check parameter list                    06320000
.TYP41   ANOP                                                           06330000
         AIF   ('&TYPE' NE 'GETHOSTBYADDR').TYP42 IS IT GETHOSTBYADDR   06340000
&CMD     SETC  '41'          Yes, set command code                      06350000
&PG21    SETB  1             Set parameter group 21                     06360000
&PG24    SETB  1             Set parameter group 24                     06370000
         AGO   .TYP50        Go check parameter list                    06380000
.TYP42   ANOP                                                           06390000
         AIF   ('&TYPE' NE 'CANCEL').TYP60 IS IT CANCEL        @D66JDHH 06400000
&CMD     SETC  '42'          Yes, set command code                      06410000
&PG4     SETB  1             Set parameter group 4                      06420000
&PG28    SETB  1             Set parameter group 28                     06430000
&PG29    SETB  1             Set parameter group 29                     06440000
         AGO   .TYP50        Go check parameter list                    06450000
.TYP60   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKINIT').TYP61 IS IT GSKINIT      @D66JDHH         
&CMD     SETC  '60'          Yes, set command code             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
&PG30    SETB  1             Set parameter group 30            @D66JDHH 06460000
&PG31    SETB  1             Set parameter group 31            @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP61   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKUNINIT').TYP62 IS IT GSKUNINIT  @D66JDHH         
&CMD     SETC  '61'          Yes, set command code             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP62   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKGETCIPHINF').TYP63              @D66JDHH         
&CMD     SETC  '62'          Yes, set command code             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
&PG32    SETB  1             Set parameter group 32            @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP63   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKSSOCINIT').TYP64                @D66JDHH         
&CMD     SETC  '63'          Yes, set command code             @D66JDHH 06460000
&PG1     SETB  1             Set parameter group 1             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
&PG30    SETB  1             Set parameter group 30            @D66JDHH 06460000
&PG33    SETB  1             Set parameter group 33            @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP64   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKSSOCREAD').TYP65                @D66JDHH         
&CMD     SETC  '64'          Yes, set command code             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
&PG15    SETB  1             Set parameter group 15            @D66JDHH 06460000
&PG26    SETB  1             Set parameter group 26            @D66JDHH 06460000
&PG34    SETB  1             Set parameter group 34            @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP65   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKSSOCWRITE').TYP66               @D66JDHH         
&CMD     SETC  '65'          Yes, set command code             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
&PG15    SETB  1             Set parameter group 15            @D66JDHH 06460000
&PG26    SETB  1             Set parameter group 26            @D66JDHH 06460000
&PG34    SETB  1             Set parameter group 34            @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP66   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKSSOCCLOSE').TYP67               @D66JDHH         
&CMD     SETC  '66'          Yes, set command code             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
&PG34    SETB  1             Set parameter group 34            @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP67   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKSSOCRESET').TYP68               @D66JDHH         
&CMD     SETC  '67'          Yes, set command code             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
&PG34    SETB  1             Set parameter group 34            @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP68   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKGETDNBYLAB').TYP69              @D66JDHH         
&CMD     SETC  '68'          Yes, set command code             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
&PG35    SETB  1             Set parameter group 35            @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP69   ANOP                                                  @D66JDHH 06460000
         AIF   ('&TYPE' NE 'GSKFREEMEM').TYP43                 @D66JDHH         
&CMD     SETC  '69'          Yes, set command code             @D66JDHH 06460000
&PG4     SETB  1             Set parameter group 4             @D66JDHH 06460000
&PG36    SETB  1             Set parameter group 36            @D66JDHH 06460000
         AGO   .TYP50        Go check parameter list           @D66JDHH 06450000
.TYP43   ANOP                                                           06460000
         MNOTE 12,'EZASM002 TYPE parameter is invalid.'                 06470000
         MEXIT                                                          06480000
.TYP50   ANOP                                                           06490000
.* RETCODE required for everything except GLOBAL, TASK and TERMAPI      06500000
         AIF   ('&TYPE' EQ 'GLOBAL').TYP50A                             06510000
         AIF   ('&TYPE' EQ 'TASK').TYP50A                               06520000
         AIF   ('&TYPE' EQ 'TERMAPI').TYP50A                            06530000
&PGRET   SETB  1                                                        06540000
.TYP50A  ANOP                                                           06550000
.*--------------------------------------------------------------------* 06560000
.*  Check for Valid Parameters Depending on TYPE Specified            * 06570000
.*--------------------------------------------------------------------* 06580000
.*-----------------Test PGRET parameters----------------------*         06590000
.*  Check RETCODE parameter                                             06600000
         EZASMIP &PGRET,&RETCODE,RETCODE,&TYPE,REQ=YES                  06610000
.*-----------------Test PG01 parameters-----------------------*         06620000
.*  Check S Parameter                                                   06630000
         EZASMIP &PG1,&S,S,&TYPE,REQ=YES                                06640000
.*-----------------Test PG02 parameters-----------------------*         06650000
.*  Check NS Parameter                                                  06660000
         EZASMIP &PG2,&NS,NS,&TYPE,REQ=NO                               06670000
.*-----------------Test PG03 parameters-----------------------*         06680000
.*  Check NAME Parameter                                                06690000
         EZASMIP &PG3,&NAME,NAME,&TYPE,REQ=YES                          06700000
.*-----------------Test PG04 parameters-----------------------*         06710000
.*  Check ERRNO Parameter                                               06720000
         AIF   ('&TYPE' EQ 'GETHOSTID').PG4A                            06730000
         EZASMIP &PG4,&ERRNO,ERRNO,&TYPE,REQ=YES                        06740000
         AGO   .PG4B                                                    06750000
.PG4A    ANOP                                                           06760000
         EZASMIP &PG4,&ERRNO,ERRNO,&TYPE,REQ=NO                         06770000
.PG4B    ANOP                                                           06780000
.*-----------------Test PG05 parameters-----------------------*         06790000
.*  Check COMMAND Parameter                                             06800000
         EZASMIP &PG5,&COMMAND,COMMAND,&TYPE,REQ=YES                    06810000
.*-----------------Test PG06 parameters-----------------------*         06820000
.*  Check CLIENT Parameter                                              06830000
         EZASMIP &PG6,&CLIENT,CLIENT,&TYPE,REQ=YES                      06840000
.*-----------------Test PG07 parameters-----------------------*         06850000
.*  Check NAMELEN Parameter                                             06860000
         EZASMIP &PG7,&NAMELEN,NAMELEN,&TYPE,REQ=YES                    06870000
.*-----------------Test PG08 parameters-----------------------*         06880000
.*  Check OPTNAME, OPTLEN, and OPTVAL Parameters                        06890000
         EZASMIP &PG8,&OPTNAME,OPTNAME,&TYPE,REQ=YES                    06900000
         EZASMIP &PG8,&OPTLEN,OPTLEN,&TYPE,REQ=YES                      06910000
         EZASMIP &PG8,&OPTVAL,OPTVAL,&TYPE,REQ=YES                      06920000
.*-----------------Test PG09 parameters-----------------------*         06930000
.*  Check STORAGE parameter                                             06940000
         EZASMIP &PG9,&STORAGE,STORAGE,&TYPE,REQ=YES                    06950000
.*-----------------Test PG10 parameters-----------------------*         06960000
.*  Check MAXSOC parameter - Not required for SELECT/EX                 06970000
         AIF   ('&TYPE' EQ 'SELECT').PG10A                              06980000
         AIF   ('&TYPE' EQ 'SELECTEX').PG10A                            06990000
         EZASMIP &PG10,&MAXSOC,MAXSOC,&TYPE,REQ=YES                     07000000
         AGO   .PG10A1                                                  07010000
.PG10A   ANOP                                                           07020000
         EZASMIP &PG10,&MAXSOC,MAXSOC,&TYPE,REQ=NO                      07030000
.PG10A1  ANOP                                                           07040000
.*-----------------Test PG11 parameters-----------------------*         07050000
.*  Check SUBTASK parameter                                             07060000
         EZASMIP &PG11,&SUBTASK,SUBTASK,&TYPE,REQ=NO                    07070000
.*  Check APITYPE parameter                                             07080000
         EZASMIP &PG11,&APITYPE,APITYPE,&TYPE,REQ=NO                    07090000
.*  Check MAXSNO parameter                                              07100000
         EZASMIP &PG11,&MAXSNO,MAXSNO,&TYPE,REQ=YES                     07110000
.*  Check IDENT parameter                                               07120000
         EZASMIP &PG11,&IDENT,IDENT,&TYPE,REQ=NO                        07130000
.*  Check UEEXIT parameter                                              07140000
         EZASMIP &PG11,&UEEXIT,UEEXIT,&TYPE,REQ=NO                      07150000
.*  Check ASYNC parameter                                               07160000
         EZASMIP &PG11,&ASYNC,ASYNC,&TYPE,REQ=NO                        07170000
.*-----------------Test PG12 parameters-----------------------*         07180000
.*  Check REQARG parameter                                              07190000
         EZASMIP &PG12,&REQARG,REQARG,&TYPE,REQ=YES                     07200000
.*-----------------Test PG13 parameters-----------------------*         07210000
.*  Check RETARG parameter                                              07220000
         EZASMIP &PG13,&RETARG,RETARG,&TYPE,REQ=YES                     07230000
.*-----------------Test PG14 parameters-----------------------*         07240000
.*  Check BACKLOG Parameter                                             07250000
         EZASMIP &PG14,&BACKLOG,BACKLOG,&TYPE,REQ=YES                   07260000
.*-----------------Test PG15 parameters-----------------------*         07270000
.*  Check BUF Parameter                                                 07280000
         EZASMIP &PG15,&BUF,BUF,&TYPE,REQ=YES                           07290000
.*-----------------Test PG16 parameters-----------------------*         07300000
.*  Check FLAGS Parameter                                               07310000
         EZASMIP &PG16,&FLAGS,FLAGS,&TYPE,REQ=NO                        07320000
.*-----------------Test PG17 parameters-----------------------*         07330000
.*  Check Optional Parameters for SELECT                                07340000
.*  Check TIMEOUT Parameter                                             07350000
         EZASMIP &PG17,&TIMEOUT,TIMEOUT,&TYPE,REQ=NO                    07360000
.*  Check RSNDMSK Parameter                                             07370000
         EZASMIP &PG17,&RSNDMSK,RSNDMSK,&TYPE,REQ=NO                    07380000
.*  Check WSNDMSK Parameter                                             07390000
         EZASMIP &PG17,&WSNDMSK,WSNDMSK,&TYPE,REQ=NO                    07400000
.*  Check ESNDMSK Parameter                                             07410000
         EZASMIP &PG17,&ESNDMSK,ESNDMSK,&TYPE,REQ=NO                    07420000
.*  Check RRETMSK Parameter                                             07430000
         EZASMIP &PG17,&RRETMSK,RRETMSK,&TYPE,REQ=NO                    07440000
.*  Check WRETMSK Parameter                                             07450000
         EZASMIP &PG17,&WRETMSK,WRETMSK,&TYPE,REQ=NO                    07460000
.*  Check ERETMSK Parameter                                             07470000
         EZASMIP &PG17,&ERETMSK,ERETMSK,&TYPE,REQ=NO                    07480000
.*-----------------Test PG18 parameters-----------------------*         07490000
.*  Check HOW Parameter                                                 07500000
         EZASMIP &PG18,&HOW,HOW,&TYPE,REQ=YES                           07510000
.*-----------------Test PG19 parameters-----------------------*         07520000
.*  Check AF Parameter                                                  07530000
         EZASMIP &PG19,&AF,AF,&TYPE,REQ=YES                             07540000
.*  Check SOCTYPE Parameter                                             07550000
         EZASMIP &PG19,&SOCTYPE,SOCTYPE,&TYPE,REQ=YES                   07560000
.*  Check PROTO Parameter                                               07570000
         EZASMIP &PG19,&PROTO,PROTO,&TYPE,REQ=NO                        07580000
.*-----------------Test PG20 parameters-----------------------*         07590000
.*  Check SOCRECV Parameter                                             07600000
         EZASMIP &PG20,&SOCRECV,SOCRECV,&TYPE,REQ=YES                   07610000
.*-----------------Test PG21 parameters-----------------------*         07620000
.*  Check HOSTENT Parameter                                             07630000
         EZASMIP &PG21,&HOSTENT,HOSTENT,&TYPE,REQ=YES                   07640000
.*-----------------Test PG22 parameters-----------------------*         07650000
.*  Check IOVCNT AND IOV Parameters                                     07660000
         EZASMIP &PG22,&IOVCNT,IOVCNT,&TYPE,REQ=YES                     07670000
         EZASMIP &PG22,&IOV,IOV,&TYPE,REQ=YES                           07680000
.*-----------------Test PG23 parameters-----------------------*         07690000
.*  Check MSG Parameter                                                 07700000
         EZASMIP &PG23,&MSG,MSG,&TYPE,REQ=YES                           07710000
.*-----------------Test PG24 parameters-----------------------*         07720000
.*  Check HOSTADDR Parameter                                            07730000
         EZASMIP &PG24,&HOSTADR,HOSTADR,&TYPE,REQ=YES                   07740000
.*-----------------Test PG25 parameters-----------------------*         07750000
.*  Check SELECB Parameter                                              07760000
         EZASMIP &PG25,&SELECB,SELECB,&TYPE,REQ=YES                     07770000
.*-----------------Test PG26 parameters-----------------------*         07780000
.*  Check NBYTE Parameter                                               07790000
         EZASMIP &PG26,&NBYTE,NBYTE,&TYPE,REQ=YES                       07800000
.*-----------------Test PG27 parameters-----------------------*         07810000
.*  Check ALET parameter                                                07820000
         EZASMIP &PG27,&ALET,ALET,&TYPE,REQ=NO                          07830000
.*-----------------Test PG28 parameters-----------------------*         07840000
.*  CHECK ECB AND REQAREA PARAMETERS                                    07850000
         EZASMIP &PG28,&ECB,ECB,&TYPE,REQ=NO                            07860000
         EZASMIP &PG28,&REQAREA,REQAREA,&TYPE,REQ=NO                    07870000
         AIF   ('&TYPE' NE 'SYNC').PG28END                              07880000
.PG2801  ANOP                                                           07890000
         AIF   (K'&ECB NE 0).PG28END                                    07900000
         AIF   (K'&REQAREA NE 0).PG28END                                07910000
         MNOTE 12,'EZA003,ECB or REQAREA Required for Type &TYPE'       07920000
         MEXIT                                                          07930000
.PG28END ANOP                                                           07940000
.*-----------------Test PG29 parameters-----------------------*         07950000
.*  Check CALAREA Parameter                                             07960000
         AIF   (K'&CALLAREA NE 0).PG29B                            @03A 07965000
         EZASMIP &PG29,&CALAREA,CALAREA,&TYPE,REQ=YES                   07970000
         AGO   .PG29C                                              @03A 07971000
.*  Or if specified as CALLAREA                                    @03A 07972000
.PG29B   ANOP                                                      @03A 07973000
         EZASMIP &PG29,&CALLAREA,CALLAREA,&TYPE,REQ=YES            @03A 07974000
.PG29C   ANOP                                                      @03A 07975000
.*-----------------Test PG30 parameters-----------------------*@D66JDHH 07950000
.*  Check SECTYPE Parameter                                    @D66JDHH 07960000
         EZASMIP &PG30,&SECTYPE,SECTYPE,&TYPE,REQ=YES          @D66JDHH 07970000
.*-----------------Test PG31 parameters-----------------------*@D66JDHH 07950000
.*  Check KEYRING Parameter                                    @D66JDHH 07960000
         EZASMIP &PG31,&KEYRING,KEYRING,&TYPE,REQ=NO           @D66JDHH 07970000
.*  Check V3TIMEOUT Parameter                                  @D66JDHH 07960000
         EZASMIP &PG31,&V3TIMEOUT,V3TIMEOUT,&TYPE,REQ=NO       @D66JDHH 07970000
.*  Check CAROOTS Parameter                                    @D66JDHH 07960000
         EZASMIP &PG31,&CAROOTS,CAROOTS,&TYPE,REQ=NO           @D66JDHH 07970000
.*  Check AUTHTYPE Parameter                                   @D66JDHH 07960000
         EZASMIP &PG31,&AUTHTYPE,AUTHTYPE,&TYPE,REQ=NO         @D66JDHH 07970000
.*-----------------Test PG32 parameters-----------------------*@D66JDHH 07950000
.*  Check CIPHLEVEL Parameter                                  @D66JDHH 07960000
         EZASMIP &PG32,&CIPHLEVEL,CIPHLEVEL,&TYPE,REQ=YES      @D66JDHH 07970000
.*  Check SECLEVEL Parameter                                   @D66JDHH 07960000
         EZASMIP &PG32,&SECLEVEL,SECLEVEL,&TYPE,REQ=YES        @D66JDHH 07970000
.*-----------------Test PG33 parameters-----------------------*@D66JDHH 07950000
.*  Check HANDSHAKE Parameter                                  @D66JDHH 07960000
         EZASMIP &PG33,&HANDSHAKE,HANDSHAKE,&TYPE,REQ=YES      @D66JDHH 07970000
.*  Check DNAME Parameter                                      @D66JDHH 07960000
         EZASMIP &PG33,&DNAME,DNAME,&TYPE,REQ=NO               @D66JDHH 07970000
.*  Check V3CIPHER Parameter                                   @D66JDHH 07960000
         EZASMIP &PG33,&V3CIPHER,V3CIPHER,&TYPE,REQ=NO         @D66JDHH 07970000
.*  Check V3CIPHSEL Parameter                                  @D66JDHH 07960000
         EZASMIP &PG33,&V3CIPHSEL,V3CIPHSEL,&TYPE,REQ=YES      @D66JDHH 07970000
.*  Check CERTINFO Parameter                                   @D66JDHH 07960000
         EZASMIP &PG33,&CERTINFO,CERTINFO,&TYPE,REQ=NO         @D66JDHH 07970000
.*  Check REASCODE Parameter                                   @D66JDHH 07960000
         EZASMIP &PG33,&REASCODE,REASCODE,&TYPE,REQ=YES        @D66JDHH 07970000
.*  Check SKREAD Parameter                                     @D66JDHH 07960000
         EZASMIP &PG33,&SKREAD,SKREAD,&TYPE,REQ=NO             @D66JDHH 07970000
.*  Check SKWRITE Parameter                                    @D66JDHH 07960000
         EZASMIP &PG33,&SKWRITE,SKWRITE,&TYPE,REQ=NO           @D66JDHH 07970000
.*-----------------Test PG34 parameters-----------------------*@D66JDHH 07950000
.*  Check SSOCDATA Parameter                                   @D66JDHH 07960000
         EZASMIP &PG34,&SSOCDATA,SSOCDATA,&TYPE,REQ=YES        @D66JDHH 07970000
.*-----------------Test PG35 parameters-----------------------*@D66JDHH 07950000
.*  Check KEYLABEL Parameter                                   @D66JDHH 07960000
         EZASMIP &PG35,&KEYLABEL,KEYLABEL,&TYPE,REQ=YES        @D66JDHH 07970000
.*-----------------Test PG36 parameters-----------------------*@D66JDHH 07950000
.*  Check AREA Parameter                                       @D66JDHH 07960000
         EZASMIP &PG36,&AREA,AREA,&TYPE,REQ=YES                @D66JDHH 07970000
.*----------------------------------------------------------------*     07980000
.*                                                                *     07990000
.*      TEST FOR SEVER ERROR IN PARAMETER CHECKING                *     08000000
.*                                                                *     08010000
.*----------------------------------------------------------------*     08020000
         AIF   (NOT &NOGEN).NOEXIT                                      08030000
         MEXIT                    Fatal errors, exit MACRO              08040000
.NOEXIT  ANOP                                                           08050000
.*----------------------------------------------------------------*     08060000
.*                                                                *     08070000
.*      BEGINNING OF HPNS CODE GENERATION                         *     08080000
.*                                                                *     08090000
.*----------------------------------------------------------------*     08100000
.HPNS00  ANOP                                                           08110000
.*----------------------------------------------------------------*     08120000
.*  Put out delimiter and first two parameters which are common   *     08130000
.*  to all of the executable macro instructions.                  *     08140000
.*----------------------------------------------------------------*     08150000
         AIF   ('&CMD' EQ '33').HPCHECK TYPE=GLOBAL-not executable      08160000
         AIF   ('&CMD' EQ '34').HPCHECK TYPE=TASK-not executable        08170000
*--------------------------------------------------------------------*  08180000
&LABEL   DS    0H                 Beginning of EZASMI Generation        08190000
.*----------------------------------------------------------------*     08200000
.*  Develop instructions to make task storage addressable         *     08210000
.*----------------------------------------------------------------*     08220000
         AIF   (K'&TASK NE 0).TASK00  Task was not specified            08230000
         LA    15,EZASMTIE      Get address of task storage             08240000
         AGO   .TASK10                                                  08250000
.TASK00  ANOP                                                           08260000
         EZASMIL &TASK,15                                               08270000
.TASK10  ANOP                                                           08280000
.*----------------------------------------------------------------*     08290000
.*  Develop instructions to parameter list addressable            *     08300000
.*----------------------------------------------------------------*     08310000
         AIF   ('&MACFORM' EQ 'S').PLIST00  Standard form of macro      08320000
         AIF   ('&MACFORM' NE 'N').PLIST01  No-call form of macro       08330000
.PLIST00 ANOP                                                           08340000
         LA    1,E$APARMS-EZASMTIE(15)  Use parm list in task stg.      08350000
         AGO   .PLIST03                                                 08360000
.PLIST01 ANOP                                                           08370000
         AIF   (K'&MF(2) NE 0).PLIST02                                  08380000
         MNOTE 12,'EZAXXX,No LIST specified for E form of macro'        08390000
         MEXIT                                                          08400000
.PLIST02 ANOP                                                           08410000
         EZASMIL &MF(2),1 Reg 1 points to parm list                     08420000
.PLIST03 ANOP                                                           08430000
.*----------------------------------------------------------------*     08440000
.*       In HPNS, the first 4 parameters for EZASOH03 are         *     08450000
.*       always the same.  Process the TOKEN, ERRNO, RETCODE      *     08460000
.*       and COMMAND parameters before going to specific          *     08470000
.*       function generation.                                     *     08480000
.*       Since VSE does not use the TOKEN field, this field is @DY45684         
.*       used as indication for the macro format.              @DY45684         
.*       A token field address of 0 indicates the EXECUTE form @DY45684         
.*       of the EZASMI macro.                                  @DY45684         
.*----------------------------------------------------------------*     08490000
.*  Process token field                                                 08500000
         AIF   ('&MACFORM' EQ 'E').PLIST04  Execute Form of mac@DY45684 08320000
         LA    0,E$ASMTOK-EZASMTIE(15) Get address of token field       08510000
         AGO   .PLIST05                                        @DY45684         
.PLIST04 ANOP                                                  @DY45684 08570000
         LA    0,0                Indicate ParmList for E-Form @DY45684         
.PLIST05 ANOP                                                  @DY45684 08570000
         ST    0,00(1)            Address of TOKEN field                08520000
.*  Process ERRNO parameter                                             08530000
         AIF   (K'&ERRNO GT 0).HPNS05                                   08540000
         LA    0,128(1)           Get address of ERRNO field            08550000
         AGO   .HPNS10                                                  08560000
.HPNS05  ANOP                                                           08570000
         EZASMIL &ERRNO           Go process ERRNO parameter            08580000
.HPNS10  ANOP                                                           08590000
         ST    0,04(1)            Address of ERRNO field                08600000
.*  Process RETCODE parameter                                           08610000
         AIF   (K'&RETCODE GT 0).HPNS15                                 08620000
         LA    0,132(1)           Get address of RETCODE field in TIE   08630000
         AGO   .HPNS20                                                  08640000
.HPNS15  ANOP                                                           08650000
         EZASMIL &RETCODE         Go process RETCODE parameter          08660000
.HPNS20  ANOP                                                           08670000
         ST    0,08(1)            Address of RETCODE field              08680000
         NI    08(1),X'FF'-X'80'  reset high order bit         @D65CDHH         
.*  Process COMMAND parameter                                           08690000
         LA    0,E$H1&SYSNDX      Set up command                        08700000
         ST    0,12(1)            Address of FUNCTION field             08710000
.*--------------------------------------------------------------------* 08720000
.*  Parameters are checked.  Develop Macro Instructions               * 08730000
.*--------------------------------------------------------------------* 08740000
.HPCHECK ANOP                                                           08750000
         AIF   ('&CMD' EQ '00').HINI0                                   08760000
         AIF   ('&CMD' EQ '01').HACC0                                   08770000
         AIF   ('&CMD' EQ '02').HBND0                                   08780000
         AIF   ('&CMD' EQ '03').HCLS0                                   08790000
         AIF   ('&CMD' EQ '04').HCON0                                   08800000
         AIF   ('&CMD' EQ '05').HFCN0                                   08810000
         AIF   ('&CMD' EQ '07').HGHI0                                   08820000
         AIF   ('&CMD' EQ '08').HGHN0                                   08830000
         AIF   ('&CMD' EQ '09').HGPN0                                   08840000
         AIF   ('&CMD' EQ '10').HGSN0                                   08850000
         AIF   ('&CMD' EQ '11').HGSO0                                   08860000
         AIF   ('&CMD' EQ '12').HIOC0                                   08870000
         AIF   ('&CMD' EQ '13').HLIS0                                   08880000
         AIF   ('&CMD' EQ '14').HREA0                                   08890000
         AIF   ('&CMD' EQ '15').HRDV0                                   08900000
         AIF   ('&CMD' EQ '16').HRCF0                                   08910000
         AIF   ('&CMD' EQ '17').HRCF0                                   08920000
         AIF   ('&CMD' EQ '18').HRCM0                                   08930000
         AIF   ('&CMD' EQ '19').HSEL0                                   08940000
         AIF   ('&CMD' EQ '20').HSND0                                   08950000
         AIF   ('&CMD' EQ '21').HSDM0                                   08960000
         AIF   ('&CMD' EQ '22').HSDT0                                   08970000
         AIF   ('&CMD' EQ '23').HSSO0                                   08980000
         AIF   ('&CMD' EQ '24').HSHU0                                   08990000
         AIF   ('&CMD' EQ '25').HSOC0                                   09000000
         AIF   ('&CMD' EQ '26').HWRT0                                   09010000
         AIF   ('&CMD' EQ '27').HWTV0                                   09020000
         AIF   ('&CMD' EQ '30').HGCI0                                   09030000
         AIF   ('&CMD' EQ '31').HGVS0                                   09040000
         AIF   ('&CMD' EQ '32').HTKS0                                   09050000
         AIF   ('&CMD' EQ '33').HGLO0                                   09060000
         AIF   ('&CMD' EQ '34').HTAS0                                   09070000
         AIF   ('&CMD' EQ '36').HTRM0                                   09080000
         AIF   ('&CMD' EQ '37').HSEL0                                   09090000
         AIF   ('&CMD' EQ '38').GIBM0                                   09100000
         AIF   ('&CMD' EQ '39').SIBM0                                   09110000
         AIF   ('&CMD' EQ '40').HGBN0                                   09120000
         AIF   ('&CMD' EQ '41').HGBA0                                   09130000
         AIF   ('&CMD' EQ '42').HCAN0                                   09140000
         AIF   ('&CMD' EQ '60').HGSKIN0                        @D66JDHH 09140000
         AIF   ('&CMD' EQ '61').HGSKUI0                        @D66JDHH 09140000
         AIF   ('&CMD' EQ '62').HGSKGC0                        @D66JDHH 09140000
         AIF   ('&CMD' EQ '63').HGSKSI0                        @D66JDHH 09140000
         AIF   ('&CMD' EQ '64').HGSKSR0                        @D66JDHH 09140000
         AIF   ('&CMD' EQ '65').HGSKSW0                        @D66JDHH 09140000
         AIF   ('&CMD' EQ '66').HGSKSC0                        @D66JDHH 09140000
         AIF   ('&CMD' EQ '67').HGSKST0                        @D66JDHH 09140000
         AIF   ('&CMD' EQ '68').HGSKGD0                        @D66JDHH 09140000
         AIF   ('&CMD' EQ '69').HGSKFM0                        @D66JDHH 09140000
.*--------------------------------------------------------------------* 09150000
.*  Process for TYPE=INITAPI.                                         * 09160000
.*--------------------------------------------------------------------* 09170000
.HINI0   ANOP     Process TYPE=INITAPI                                  09180000
         AIF   (K'&ECB EQ 0).HINIA1      Was parameter used?            09190000
         MNOTE 12,'EZA007,ECB not permitted for INITAPI'                09200000
         AGO   .GENCON            Go put out final instructions         09210000
.HINIA1  ANOP                                                           09220000
.*  Process MAXSOC parameter                                            09230000
         EZASMIS &MAXSOC,H,2001,2,&SYSNDX Go process MAXSOC Parameter   09240000
&HC2     SETC  '&CONST'                                                 09250000
         ST    0,16(1)            Address of MAXSOC field               09260000
.*  Process APITYPE parameter                                           09270000
         AIF   (K'&APITYPE EQ 0).HINIA2      Was parameter used?        09280000
         EZASMIS &APITYPE,H,4,3,&SYSNDX Go process APITYPE parameter    09290000
&HC3     SETC  '&CONST' DO NOT CHANGE HC3, unless you change       @P2C 09300000
.*       the value at label HINIH30 as well.                       @P2A 09310000
         AIF   ('&HC3' EQ '').HINIA3                               @P1A 09320000
         AIF   ('&HC3' EQ 'H''2''').HINIA3                              09330000
         AIF   ('&HC3' EQ 'H''3''').HINIA3                              09340000
         MNOTE 4,'EZAXXX APITYPE must be 2 or 3'                        09350000
.HINIA2  ANOP                                                           09360000
&HC3     SETC  'H''2'''                                                 09370000
         LA    0,E$H3&SYSNDX      Default APITYPE=2                     09380000
.HINIA3  ANOP                                                           09390000
         ST    0,20(1)            Address of APITYPE field              09400000
.*  Process IDENT parameter which produces TCPNAME and ADSNAME          09410000
         AIF   (K'&IDENT EQ 0).HINID00  No IDENT specified              09420000
         EZASMIL &IDENT                                                 09430000
&HC4     SETC  'H''8'''                                                 09440000
         ST    0,24(1)            Set address of TCPNAME                09450000
         AH    0,E$H4&SYSNDX      Get address of ADSNAME                09460000
         ST    0,28(1)            Set address of ADSNAME                09470000
         AGO   .HINID10                                                 09480000
.HINID00 ANOP                                                           09490000
         XC    24(4,1),24(1)      Show no TCPNAME specified             09500000
         XC    28(4,1),28(1)      Show no ADSNAME specified             09510000
.HINID10 ANOP                                                           09520000
.*  Process SUBTASK parameter                                           09530000
         AIF   (K'&SUBTASK EQ 0).HINIE00                                09540000
         EZASMIL &SUBTASK         Go process SUBTASK  parameter         09550000
         ST    0,32(1)            Address of SUBTASK field              09560000
         AGO   .HINIF00                                                 09570000
.HINIE00 ANOP                                                           09580000
         XC    32(4,1),32(1)      No SUBTASK parameter                  09590000
.HINIF00 ANOP                                                           09600000
.*  Process MAXSNO parameter                                            09610000
         EZASMIL &MAXSNO          Go process MAXSNO  parameter          09620000
         ST    0,36(1)            Address of MAXSNO field               09630000
.*  Process UEEXIT parameter                                            09640000
         AIF   (K'&UEEXIT EQ 0).HINIG00                                 09650000
         EZASMIL &UEEXIT,14        Go process UEEXIT                    09660000
         L     0,0(14)            Get address of exit address           09670000
         ST    0,76(1)            Set exit address                      09680000
         L     0,4(14)            Get address of token                  09690000
         ST    0,80(1)            Set token                             09700000
         LA    0,76(1)            Get address of parameter list         09710000
         ST    0,40(1)            Address of UEEXIT                     09720000
         AGO   .HINIG10                                                 09730000
.HINIG00 ANOP                                                           09740000
         XC    40(4,1),40(1)      No UEEXIT specified                   09750000
.HINIG10 ANOP                                                           09760000
.*  Process ASYNC parameter                                             09770000
         AIF   (K'&ASYNC EQ 0).HINIH30                                  09780000
         AIF   ('&ASYNC' EQ '''NO''').HINIH30                           09790000
         AIF   ('&ASYNC(1)' EQ '''NO''').HINIH30                        09800000
         XC    92(12,1),92(1) Clear tripleword for ASYNC parameters     09810000
         AIF   ('&ASYNC(1)' EQ '''EXIT''').HINIH10                      09820000
         AIF   ('&ASYNC(1)' EQ '''ECB''').HINIH00                       09830000
         MNOTE 8,'EZA007,First sub-parameter invalid for ASYNC parameteX09840000
               r'                                                       09850000
         AGO   .HINIH00                                                 09860000
.HINIH00 ANOP                     Process for ECB                       09870000
         OI    100(1),B'00000001' Indicate ECB Processing               09880000
         AGO   .HINIH20                                                 09890000
.HINIH10 ANOP                     Process for EXIT                      09900000
         AIF   (K'&ASYNC(2) NE 0).HINIH15                               09910000
         MNOTE 12,'EZAXXX SECOND SUB-PARAMETER REQUIRED FOR ASYNC IF ''X09920000
               EXIT'' IS SPECIFIED'                                     09930000
         AGO   .GENCON            Go put out final instructions         09940000
.HINIH15 ANOP                                                           09950000
         OI    100(1),B'00000010' Indicate EXIT Processing              09960000
         EZASMIL &ASYNC(2),14          Go process second sub-parm       09970000
         L     0,0(14)            Get address of exit address           09980000
         ST    0,92(1)            Set exit address                      09990000
         L     0,4(14)            Get address of token                  10000000
         ST    0,96(1)            Set token                             10010000
         AIF   (K'&ASYNC(3) EQ 0).HINIH20  Test for SRB processing      10020000
         AIF   ('&ASYNC(3)' NE 'SRB').HINIH20                           10030000
         OI    100(1),B'00000100' Indicate SRB Processing               10040000
.HINIH20 ANOP                                                           10050000
         LA    0,92(1)            Get address of tripleword             10060000
         ST    0,44(1)            Address of ASYNC parameter            10070000
         AGO   .HINIH40                                                 10080000
.HINIH30 ANOP                                                           10090000
         AIF   ('&HC3' NE 'H''3''').HINIH35 Invalid if APITYPE = 3 @P2A 10100000
         MNOTE 12,'EZA008 ASYNC PARAMETER REQUIRED FOR APITYPE = 3'     10110000
         AGO   .GENCON            Go put out final instructions         10120000
.HINIH35 ANOP                                                           10130000
         XC    44(4,1),44(1)      No ASYNC specified                    10140000
.HINIH40 ANOP                                                           10150000
         OI    44(1),X'80'        Mark last parameter                   10160000
         AGO   .HPARM00           Go put out final instructions         10170000
.*--------------------------------------------------------------------* 10180000
.*  Process for TYPE=ACCEPT.                                          * 10190000
.*--------------------------------------------------------------------* 10200000
.HACC0   ANOP     Process TYPE=ACCEPT                                   10210000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             10220000
&HC2     SETC  '&CONST'                                                 10230000
         ST    0,16(1)            Address of S parameter                10240000
.*  Process NAME parameter                                              10250000
         EZASMIL &NAME            Go process NAME parameter             10260000
         ST    0,20(1)            Address of NAME parameter             10270000
.*  Process NS parameter                                                10280000
         AIF   (K'&NS NE 0).HACC10 Was NS Specified                     10290000
         SLR   0,0                New socket number not specified       10300000
         AGO   .HACC20                                                  10310000
.HACC10  ANOP                                                           10320000
         EZASMIS &NS,H,4095,3,&SYSNDX,14 Go process NS parameter        10330000
&HC3     SETC  '&CONST'                                                 10340000
         LH    0,0(14)            Put halfword value in Reg 0           10350000
         ST    0,120(1)           Store it as fullword                  10360000
.HACC15  ANOP                                                           10370000
         LA    0,120(1)           Get address of fullword socket number 10380000
.HACC20  ANOP                                                           10390000
         ST    0,24(1)            Address of NS parameter               10400000
.*  Process ECB or REQAREA  parameter                                   10410000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              10420000
         ST    0,28(1)            Address of ECB/REQAREA parameter      10430000
         OI    28(1),X'80'        Mark last parameter                   10440000
         AGO   .HPARM00           Go put out final instructions         10450000
.*--------------------------------------------------------------------* 10460000
.*  Process for TYPE=BIND.                                            * 10470000
.*--------------------------------------------------------------------* 10480000
.HBND0   ANOP     Process TYPE=BIND                                     10490000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             10500000
&HC2     SETC  '&CONST'                                                 10510000
         ST    0,16(1)            Address of S parameter                10520000
.*  Process NAME parameter                                              10530000
         EZASMIL &NAME            Go process NAME parameter             10540000
         ST    0,20(1)            Address of NAME parameter             10550000
.*  Process ECB or REQAREA  parameter                                   10560000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              10570000
.HBND10  ANOP                                                           10580000
         ST    0,24(1)            Address of ECB/REQAREA parameter      10590000
         OI    24(1),X'80'        Mark last parameter                   10600000
         AGO   .HPARM00           Go put out final instructions         10610000
.*--------------------------------------------------------------------* 10620000
.*  Process for TYPE=CANCEL.                                          * 10630000
.*--------------------------------------------------------------------* 10640000
.HCAN0   ANOP     Process TYPE=CANCEL                                   10650000
.*  Process CALAREA parameter                                           10660000
         AIF   (K'&CALLAREA NE 0).HCAN05                           @03A 10665000
         EZASMIL &CALAREA         Go process CALAREA parameter          10670000
         AGO   .HCAN07                                             @03A 10672000
.HCAN05  ANOP                                                      @03A 10674000
         EZASMIL &CALLAREA        Go process CALLAREA parameter    @03A 10676000
.HCAN07  ANOP                                                           10678000
         ST    0,16(1)            Address of CALAREA parameter          10680000
.*  Process ECB or REQAREA  parameter                                   10690000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              10700000
.HCAN10  ANOP                                                           10710000
         ST    0,20(1)            Address of ECB/REQAREA parameter      10720000
         OI    20(1),X'80'        Mark last parameter                   10730000
         AGO   .HPARM00           Go put out final instructions         10740000
.*--------------------------------------------------------------------* 10750000
.*  Process for TYPE=CLOSE.                                           * 10760000
.*--------------------------------------------------------------------* 10770000
.HCLS0   ANOP     Process TYPE=CLOSE                                    10780000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             10790000
&HC2     SETC  '&CONST'                                                 10800000
         ST    0,16(1)            Address of S parameter                10810000
.*  Process ECB or REQAREA  parameter                                   10820000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              10830000
.HCLS10  ANOP                                                           10840000
         ST    0,20(1)            Address of ECB/REQAREA parameter      10850000
         OI    20(1),X'80'        Mark last parameter                   10860000
         AGO   .HPARM00           Go put out final instructions         10870000
.*--------------------------------------------------------------------* 10880000
.*  Process for TYPE=CONNECT.                                         * 10890000
.*--------------------------------------------------------------------* 10900000
.HCON0   ANOP     Process TYPE=CONNECT                                  10910000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             10920000
&HC2     SETC  '&CONST'                                                 10930000
         ST    0,16(1)            Address of S parameter                10940000
.*  Process NAME parameter                                              10950000
         EZASMIL &NAME            Go process NAME parameter             10960000
         ST    0,20(1)            Address of NAME parameter             10970000
.*  Process ECB or REQAREA  parameter                                   10980000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              10990000
.HCON10  ANOP                                                           11000000
         ST    0,24(1)            Address of ECB/REQAREA parameter      11010000
         OI    24(1),X'80'        Mark last parameter                   11020000
         AGO   .HPARM00           Go put out final instructions         11030000
.*--------------------------------------------------------------------* 11040000
.*  Process for TYPE=FCNTL.                                           * 11050000
.*--------------------------------------------------------------------* 11060000
.HFCN0    ANOP     Process TYPE=FCNTL                                   11070000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             11080000
&HC2     SETC  '&CONST'                                                 11090000
         ST    0,16(1)            Address of S parameter                11100000
.*  Process COMMAND Parameter                                           11110000
         AIF   ('&COMMAND'(1,1) NE '''').HFCNC0  Passed as literal?     11120000
         AIF   ('&COMMAND' NE '''F_GETFL''').HFCNC00  Is it F_GETFL?    11130000
&FC1     SETC  'F''3'''                                                 11140000
         LA    0,E$F1&SYSNDX      Set COMMAND to  F_GETFL               11150000
         ST    0,20(1)            Address of COMMAND parameter          11160000
         XC    140(16,1),140(1)   Set temporary field to 0              11170000
         LA    0,140(1)           Set REQARG to 0                       11180000
         AGO   .HFCNE0            Go check ECB/REQAREA             @02C 11194990
.HFCNC00 ANOP                                                           11200000
         AIF   ('&COMMAND' NE '''F_SETFL''').HFCNC01  Is it F_SETFL?    11210000
&FC1     SETC  'F''4'''                                                 11220000
         LA    0,E$F1&SYSNDX      Set COMMAND to  SET                   11230000
.*       ST    0,20(1)            Address of COMMAND parameter     @02C 11244990
         AGO   .HFCNA3            Go set Parameter 7 address            11250000
.HFCNC01 ANOP                                                           11260000
         MNOTE 8,'EZASM008 Invalid literal specified for COMMAND'       11270000
&FC1     SETC  'F''3'''                                                 11280000
         LA    0,E$F1&SYSNDX      Set COMMAND to  QUERY                 11290000
         AGO   .HFCNA3                                                  11300000
.HFCNC0  ANOP                                                           11310000
         EZASMIL &COMMAND                                               11320000
.HFCNA3  ANOP                                                           11330000
         ST    0,20(1)            Address of COMMAND parameter          11340000
.*  Process REQARG  Parameter                                           11350000
         EZASMIL &REQARG                                                11360000
.HFCNE0  ANOP                                                      @02A 11365000
         ST    0,24(1)            Address of REQARG parameter           11370000
.*  Process ECB or REQAREA  parameter                                   11380000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              11390000
.HFCN10  ANOP                                                           11400000
         ST    0,28(1)            Address of ECB/REQARG parameter       11410000
         OI    28(1),X'80'        Mark last parameter                   11420000
         AGO   .HPARM00           Go put out final instructions         11430000
.*--------------------------------------------------------------------* 11440000
.*  Process for TYPE=GETHOSTID.                                       * 11450000
.*--------------------------------------------------------------------* 11460000
.HGHI0   ANOP     Process TYPE=GETHOSTID                                11470000
.*  Process ECB or REQAREA  parameter                                   11480000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              11490000
.HGHI10  ANOP                                                           11500000
         ST    0,16(1)            Address of ECB/REQAREA parameter      11510000
         OI    16(1),X'80'        Mark last parameter                   11520000
         AGO   .HPARM00           Go put out final instructions         11530000
.*--------------------------------------------------------------------* 11540000
.*  Process for TYPE=GETHOSTNAME                                      * 11550000
.*--------------------------------------------------------------------* 11560000
.HGHN0   ANOP     Process TYPE=GETHOSTNAME                              11570000
.*  Process NAMELEN Parameter                                           11580000
         EZASMIS &NAMELEN,F,255,1,&SYSNDX                               11590000
&FC1     SETC  '&CONST'                                                 11600000
         ST    0,16(1)            Address of NAMELEN parameter          11610000
.*  Process NAME Parameter                                              11620000
         EZASMIL &NAME                                                  11630000
         ST    0,20(1)            Address of NAME parameter             11640000
.*  Process ECB or REQAREA  parameter                                   11650000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              11660000
.HGHN10  ANOP                                                           11670000
         ST    0,24(1)            Address of ECB/REQAREA parameter      11680000
         OI    24(1),X'80'        Mark last parameter                   11690000
         AGO   .HPARM00           Go put out final instructions         11700000
.*--------------------------------------------------------------------* 11710000
.*  Process for TYPE=GETPEERNAME                                      * 11720000
.*--------------------------------------------------------------------* 11730000
.HGPN0   ANOP     PROCESS TYPE=GETPEERNAME                              11740000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             11750000
&HC2     SETC  '&CONST'                                                 11760000
         ST    0,16(1)            Address of S parameter                11770000
.*  Process NAME parameter                                              11780000
         EZASMIL &NAME            Go process NAME parameter             11790000
         ST    0,20(1)            Address of NAME parameter             11800000
.*  Process ECB or REQAREA  parameter                                   11810000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              11820000
         ST    0,24(1)            Address of ECB/REQAREA parameter      11830000
         OI    24(1),X'80'        Mark last parameter                   11840000
         AGO   .HPARM00           Go put out final instructions         11850000
.*--------------------------------------------------------------------* 11860000
.*  Process for TYPE=GETSOCKNAME                                      * 11870000
.*--------------------------------------------------------------------* 11880000
.HGSN0   ANOP     Process TYPE=GETSOCKNAME                              11890000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             11900000
&HC2     SETC  '&CONST'                                                 11910000
         ST    0,16(1)            Address of S parameter                11920000
.*  Process NAME parameter                                              11930000
         EZASMIL &NAME            Go process NAME parameter             11940000
         ST    0,20(1)            Address of NAME parameter             11950000
.*  Process ECB or REQAREA  parameter                                   11960000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              11970000
         ST    0,24(1)            Address of ECB/REQAREA parameter      11980000
         OI    24(1),X'80'        Mark last parameter                   11990000
         AGO   .HPARM00           Go put out final instructions         12000000
.*--------------------------------------------------------------------* 12010000
.*  Process for TYPE=GETSOCKOPT                                       * 12020000
.*--------------------------------------------------------------------* 12030000
.HGSO0   ANOP     Process TYPE=GETSOCKOPT                               12040000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             12050000
&HC2     SETC  '&CONST'                                                 12060000
         ST    0,16(1)            Address of S parameter                12070000
.*  Process OPTNAME Parameter                                           12080000
         AIF   ('&OPTNAME'(1,1) NE '''').HGSON0  Passed as literal?     12090000
         AIF   ('&OPTNAME' NE '''SO_BROADCAST''').HGSON00               12100000
&FC2     SETC  'X''00000020'''                                          12110000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_BROADCAST           12120000
         AGO   .HGSON3                                                  12130000
.HGSON00 ANOP                                                           12140000
         AIF   ('&OPTNAME' NE '''SO_ERROR''').HGSON01                   12150000
&FC2     SETC  'X''00001007'''                                          12160000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_ERROR               12170000
         AGO   .HGSON3                                                  12180000
.HGSON01 ANOP                                                           12190000
         AIF   ('&OPTNAME' NE '''SO_LINGER''').HGSON02                  12200000
&FC2     SETC  'X''00000080'''                                          12210000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_LINGER              12220000
         AGO   .HGSON3                                                  12230000
.HGSON02 ANOP                                                           12240000
         AIF   ('&OPTNAME' NE '''SO_OOBINLINE''').HGSON03               12250000
&FC2     SETC  'X''00000100'''                                          12260000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_OOBINLINE           12270000
         AGO   .HGSON3                                                  12280000
.HGSON03 ANOP                                                           12290000
         AIF   ('&OPTNAME' NE '''SO_SNDBUF''').HGSON04                  12300000
&FC2     SETC  'X''00001001'''                                          12310000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_SNDBUF              12320000
         AGO   .HGSON3                                                  12330000
.HGSON04 ANOP                                                           12340000
         AIF   ('&OPTNAME' NE '''SO_TYPE''').HGSON05                    12350000
&FC2     SETC  'X''00001008'''                                          12360000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_TYPE                12370000
         AGO   .HGSON3                                                  12380000
.HGSON05 ANOP                                                           12390000
         AIF   ('&OPTNAME' NE '''SO_REUSEADDR''').HGSON55          @P6A 12400000
&FC2     SETC  'X''00000004'''                                     @P6A 12410000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_REUSEADDR      @P6A 12420000
         AGO   .HGSON3                                             @P6A 12430000
.HGSON55 ANOP                                                      @P6A 12440000
         AIF   ('&OPTNAME' NE '''SO_KEEPALIVE''').HGSON06               12450000
&FC2     SETC  'X''00000008'''                                          12460000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_KEEPALIVE           12470000
         AGO   .HGSON3                                                  12480000
.HGSON06 ANOP                                                           12490000
         MNOTE 8,'EZASM008 Invalid literal specified for OPTNAME'       12500000
         XC    140(16,1),140(1)   Set temporary field to 0              12510000
         LA    0,140(1)           Set parameter 4 address               12520000
         AGO   .HGSON3                                                  12530000
.HGSON0  ANOP                                                           12540000
         EZASMIL &OPTNAME                                               12550000
.HGSON3  ANOP                                                           12560000
         ST    0,20(1)            Address of OPTNAME parameter          12570000
.*  Process OPTVAL Parameter                                            12580000
         EZASMIL &OPTVAL                                                12590000
         ST    0,24(1)            Address of OPTVAL parameter           12600000
.*  Process OPTLEN Parameter                                            12610000
         EZASMIL &OPTLEN                                                12620000
         ST    0,28(1)            Address of OPTLEN parameter           12630000
.*  Process ECB or REQAREA  parameter                                   12640000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              12650000
         ST    0,32(1)            Address of ECB/REQAREA parameter      12660000
         OI    32(1),X'80'        Mark last parameter                   12670000
         AGO   .HPARM00           Go put out final instructions         12680000
.*--------------------------------------------------------------------* 12690000
.*  Process for TYPE=IOCTL                                            * 12700000
.*--------------------------------------------------------------------* 12710000
.HIOC0   ANOP     Process TYPE=IOCTL                                    12720000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             12730000
&HC2     SETC  '&CONST'                                                 12740000
         ST    0,16(1)            Address of S parameter                12750000
.*  Process COMMAND Parameter                                           12760000
         AIF   ('&COMMAND'(1,1) NE '''').HIOCC0 Passed as literal?      12770000
         AIF   ('&COMMAND' NE '''FIONBIO''').HIOCC00                    12780000
&FC1     SETC  'X''8004A77E'''                                          12790000
         LA    0,E$F1&SYSNDX      Get value for FIONBIO                 12800000
         AGO   .HIOCC3                                                  12810000
.HIOCC00 ANOP                                                           12820000
         AIF   ('&COMMAND' NE '''FIONREAD''').HIOCC01                   12830000
&FC1     SETC  'X''4004A77F'''                                          12840000
         LA    0,E$F1&SYSNDX      Get value for FIONREAD                12850000
         AGO   .HIOCC3                                                  12860000
.HIOCC01 ANOP                                                           12870000
         AIF   ('&COMMAND' NE '''SIOCADDRT''').HIOCC02                  12880000
&FC1     SETC  'X''8030A70A'''                                          12890000
         LA    0,E$F1&SYSNDX      Get value for SIOCADDRT               12900000
         AGO   .HIOCC3                                                  12910000
.HIOCC02 ANOP                                                           12920000
         AIF   ('&COMMAND' NE '''SIOCATMARK''').HIOCC03                 12930000
&FC1     SETC  'X''4004A707'''                                          12940000
         LA    0,E$F1&SYSNDX      Get value for SIOCATMARK              12950000
         AGO   .HIOCC3                                                  12960000
.HIOCC03 ANOP                                                           12970000
         AIF   ('&COMMAND' NE '''SIOCDELRT''').HIOCC04                  12980000
&FC1     SETC  'X''8030A70B'''                                          12990000
         LA    0,E$F1&SYSNDX      Get value for SIOCDELRT               13000000
         AGO   .HIOCC3                                                  13010000
.HIOCC04 ANOP                                                           13020000
         AIF   ('&COMMAND' NE '''SIOCGIFADDR''').HIOCC05                13030000
&FC1     SETC  'X''C020A70D'''                                          13040000
         LA    0,E$F1&SYSNDX      Get value for SIOCGIFADDR             13050000
         AGO   .HIOCC3                                                  13060000
.HIOCC05 ANOP                                                           13070000
         AIF   ('&COMMAND' NE '''SIOCGIFBRDADDR''').HIOCC06             13080000
&FC1     SETC  'X''C020A712'''                                          13090000
         LA    0,E$F1&SYSNDX      Get value for SIOCGIFBRDADDR          13100000
         AGO   .HIOCC3                                                  13110000
.HIOCC06 ANOP                                                           13120000
         AIF   ('&COMMAND' NE '''SIOCGIFCONF''').HIOCC07                13130000
&FC1     SETC  'X''C008A714'''                                          13140000
         LA    0,E$F1&SYSNDX      Get value for SIOCGIFCONF             13150000
         AGO   .HIOCC3                                                  13160000
.HIOCC07 ANOP                                                           13170000
         AIF   ('&COMMAND' NE '''SIOCGIFDSTADDR''').HIOCC08             13180000
&FC1     SETC  'X''C020A70F'''                                          13190000
         LA    0,E$F1&SYSNDX      Get value for SIOCGIFDSTADDR          13200000
         AGO   .HIOCC3                                                  13210000
.HIOCC08 ANOP                                                           13220000
         AIF   ('&COMMAND' NE '''SIOCGIFFLAGS''').HIOCC09               13230000
&FC1     SETC  'X''C020A711'''                                          13240000
         LA    0,E$F1&SYSNDX      Get value for SIOCGIFFLAGS            13250000
         AGO   .HIOCC3                                                  13260000
.HIOCC09 ANOP                                                           13270000
         AIF   ('&COMMAND' NE '''SIOCGIFMETRIC''').HIOCC0A              13280000
&FC1     SETC  'X''C020A717'''                                          13290000
         LA    0,E$F1&SYSNDX      Get value for SIOCGIFMETRIC           13300000
         AGO   .HIOCC3                                                  13310000
.HIOCC0A ANOP                                                           13320000
         AIF   ('&COMMAND' NE '''SIOCGIFNETMASK''').HIOCC0B             13330000
&FC1     SETC  'X''C020A715'''                                          13340000
         LA    0,E$F1&SYSNDX      Get value for SIOCGIFNETMASK          13350000
         AGO   .HIOCC3                                                  13360000
.HIOCC0B ANOP                                                           13370000
         AIF   ('&COMMAND' NE '''SIOCSIFDSTADDR''').HIOCC0C             13380000
&FC1     SETC  'X''8020A70E'''                                          13390000
         LA    0,E$F1&SYSNDX      Get value for SIOCSIFDSTADDR          13400000
         AGO   .HIOCC3                                                  13410000
.HIOCC0C ANOP                                                           13420000
         AIF   ('&COMMAND' NE '''SIOCSIFFLAGS''').HIOCC0D               13430000
&FC1     SETC  'X''8020A710'''                                          13440000
         LA    0,E$F1&SYSNDX      Get value for SIOCSIFFLAGS            13450000
         AGO   .HIOCC3                                                  13460000
.HIOCC0D ANOP                                                           13470000
         AIF   ('&COMMAND' NE '''SIOCSIFMETRIC''').HIOCC0E              13480000
&FC1     SETC  'X''8020A718'''                                          13490000
         LA    0,E$F1&SYSNDX      Get value for SIOCSIFMETRIC           13500000
         AGO   .HIOCC3                                                  13510000
.HIOCC0E AIF   ('&COMMAND' NE '''SIOCGMONDATA''').HIOCC0F        @PBA   13510100
&FC1     SETC  'X''C018D902'''                                   @PBA   13510200
         LA    0,E$F1&SYSNDX      Get value for SIOCGMONDATA     @PBA   13510300
         AGO   .HIOCC3                                           @PBA   13510400
.HIOCC0F ANOP                                                    @PBC   13520000
         MNOTE 8,'EZASM008 Invalid literal specified for COMMAND'       13530000
         XC    140(16,1),140(1)   Set temporary field to 0              13540000
         LA    0,140(1)           Set COMMAND field to null             13550000
         AGO   .HIOCC3                                                  13560000
.HIOCC0  ANOP                                                           13570000
         EZASMIL &COMMAND                                               13580000
.HIOCC3  ANOP                                                           13590000
         ST    0,20(1)            Address of COMMAND parameter          13600000
.*  Process REQARG  Parameter                                           13610000
         EZASMIL &REQARG                                                13620000
         ST    0,24(1)            Address of REQARG parameter           13630000
.*  Process RETARG  Parameter                                           13640000
         EZASMIL &RETARG                                                13650000
         ST    0,28(1)            Address of RETARG parameter           13660000
.*  Process ECB or REQAREA  parameter                                   13670000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              13680000
         ST    0,32(1)            Address of ECB/REQAREA parameter      13690000
         OI    32(1),X'80'        Mark last parameter                   13700000
         AGO   .HPARM00           Go put out final instructions         13710000
.*--------------------------------------------------------------------* 13720000
.*  Process for TYPE=GLOBAL                                           * 13730000
.*--------------------------------------------------------------------* 13740000
.HGLO0   ANOP     Process TYPE=GLOBAL                                   13750000
         AIF   (K'&LABEL EQ 0).HGWA1                                    13760000
&TEMPCH  SETC  '&LABEL'                                                 13770000
&LABGEN  SETB  1                                                        13780000
         AGO   .HGWA2                                                   13790000
.HGWA1   ANOP                                                           13800000
&TEMPCH  SETC  'EZASMGWA'                                               13810000
&LABGEN  SETB  0                                                        13820000
.HGWA2   ANOP                                                           13830000
         AIF   ('&STORAGE' EQ 'DSECT').HGWA3                            13840000
&TEMPCH  DS    0D  MAP GLOBAL WORK AREA FOR TCP/IP...                   13850000
         AGO   .HGWA4                                                   13860000
.HGWA3   ANOP                                                           13870000
&TEMPCH  DSECT MAP GLOBAL WORK AREA FOR TCP/IP ...                      13880000
.HGWA4   ANOP                                                           13890000
*                                                                       13900000
         AIF   (NOT &LABGEN).HGWA5                                      13910000
EZASMGWA EQU   *                                                        13920000
.HGWA5   ANOP                                                           13930000
         AIF   ('&CICS' EQ 'YES').HGWA6                                 13940000
*********************************************************************** 13950000
*                                                                     * 13960000
*                  GLOBAL WORK AREA FOR SOCKETS EXTENDED              * 13970000
*                                                                     * 13980000
*********************************************************************** 13990000
*                                                                       14000000
GWABEGIN EQU   *     BEGINNING OF GWA                                   14010000
GWAUSCNT DC    F'0'         USE COUNT FOR THIS GWA                      14020000
GWA03PSA DC    F'0'         ADDRESS OF EZASOH03                         14030000
         DS    0D           FORCE DOUBLEWORD LENGTH                     14040000
GWAEND   EQU   * END OF THE GLOBAL WORK AREA (GWA) ...                  14050000
GWALENTH EQU   GWAEND-GWABEGIN LENGTH OF THIS GWA ...                   14060000
         MEXIT                                                          14070000
.HGWA6   ANOP                                                           14080000
*********************************************************************** 14090000
*                                                                     * 14100000
*                  GLOBAL WORK AREA (GWA) FOR TCP/IP                  * 14110000
*                  -      -    -              --- --                  * 14120000
*********************************************************************** 14130000
*                                                                       14140000
GWABEGIN EQU   *     BEGINNING OF GWA                                   14150000
GWACMEYE DS    0CL328 CONNECTION MANAGER GLOBAL WORK AREA EYECATCHER... 14160000
GWACMDSC DS    CL8 CONNECTION MANAGER INITIALIZES TO 'GWATCPIP' ...     14170000
*                                                                       14180000
GWACMHER DS    0CL30 CONNECTION MANAGER (ENABLE/DISABLE-API) HERITAGE   14190000
GWACMID  DS    0CL24 CONNECTION MANAGER (ENABLE/DISABLE-API) ID  @L1A   14200000
GWACMNAM DS    CL08  CONNECTION MANAGER PART NAME  @L1C ...             14210000
GWACMDTE DS    CL08  CONNECTION MANAGER COMP DATE  @L1C ...             14220000
GWACMSRV DS    CL08  CONNECTION MANAGER SERVICE LVL@L1C ...             14230000
GWACMRSV DS    CL06  CONNECTION MANAGER RESERVED   @L1C                 14240000
*                                                                       14250000
GWATRHER DS    0CL30 TASK-RELATED USER EXIT (TRUE) HERITAGE ...         14260000
GWATRID  DS    0CL24 TASK-RELATED USER EXIT (TRUE) ID            @L1A   14270000
GWATRNAM DS    CL08  TASK-RELATED USER EXIT PART NAME  @L1C ...         14280000
GWATRDTE DS    CL08  TASK-RELATED USER EXIT COMP DATE  @L1C ...         14290000
GWATRSRV DS    CL08  TASK-RELATED USER EXIT SERVICE LVL@L1C ...         14300000
GWATRRSV DS    CL06  TASK-RELATED USER EXIT RESERVED   @L1C             14310000
*                                                                       14320000
GWAMSHER DS    0CL30 MASTER SERVER (LISTENER) HERITAGE ...              14330000
GWAMSID  DS    0CL24 MASTER SERVER (LISTENER) ID                 @L1A   14340000
GWAMSNAM DS    CL08  MASTER SERVER PART NAME  @L1C ...                  14350000
GWAMSDTE DS    CL08  MASTER SERVER COMP DATE  @L1C ...                  14360000
GWAMSSRV DS    CL08  MASTER SERVER SERVICE LVL@L1C ...                  14370000
GWAMSRSV DS    CL06  MASTER SERVER RESERVED   @L1C                      14380000
*                                                                       14390000
GWASTHER DS    0CL30 ATTACHED MVS/SP SUBTASK HERITAGE ...               14400000
GWASTID  DS    0CL24 ATTACHED MVS/SP SUBTASK ID                  @L1A   14410000
GWASTNAM DS    CL08  ATTACHED MVS/SP SUBTASK PART NAME  @L1C ...        14420000
GWASTDTE DS    CL08  ATTACHED MVS/SP SUBTASK COMP DATE  @L1C ...        14430000
GWASTSRV DS    CL08  ATTACHED MVS/SP SUBTASK SERVICE LVL@L1C ...        14440000
GWASTRSV DS    CL06  ATTACHED MVS/SP SUBTASK RESERVED   @L1C            14450000
*                                                                       14460000
GWACMIBM DS    CL154 IBM COPYRIGHT STATEMENT (NO LONGER USED @L1C)      14470000
         DS    CL42 ****BINARY ZEROES AVAILABLE AREA****                14480000
*                                                                       14490000
GWAUSCNT DS    A USE COUNT FOR THIS GWA                                 14500000
GWABKWRD DS    A TASK CHAIN ANCHOR BACKWARD ADDRESS ...                 14510000
GWAFOWRD DS    A TASK CHAIN ANCHOR FORWARD ADDRESS ...                  14520000
*                                                                       14530000
GWACAPPL DS    CL8 VTAM APPLID OF THE CICS SYSTEM. MUST MATCH WHAT WAS- 14540000
*                  SPECIFIED IN THE PORT STATEMENT IN PROFILE.TCPIP ... 14550000
GWATRUEN DS    CL8 TASK-RELATED USER EXIT (TRUE) LOAD MODULE NAME ...   14560000
GWASTSKN DS    CL8 MVS ATTACHED SUBTASK LOAD MODULE NAME ...            14570000
GWATCPID DS    CL8 TCPIPUSERID AS SPECIFIED IN TCPIP.DATA DATASET ...   14580000
GWACSA   DS    A CICS COMMON SYSTEM AREA (CSA) ADDRESS USED BY DFHWTO M 14590000
GWAMSTSK DS    PL4 MASTER SERVER (LISTENER) CICS TASK NUMBER ...        14600000
         ORG   GWABKWRD-(TIEBKWRD-EZASMTIE) SET THE LOCATION COUNTER TO 14610000
*  INITIALIZE THE BACKWARD AND FORWARD CHAIN ADDRESSES (WHICH HAVE THE  14620000
*  SAME DISPLACEMENT IN THE GLOBAL WORK AREA AS THE REAL ONES HAVE      14630000
*  IN THE TIE) TO THE DUMMY TASK LOCAL WORK AREA. THE TWO ANCHORS       14640000
*  MUST BE ADJACENT, EVEN THOUGH THEY MAY BE PLACED ANYWHERE IN THE     14650000
*  GWA. THIS IS BECAUSE THE CONNECTION MANAGER (TCP00000) AND THE TRUE  14660000
*  (TCP00001) USE THE ASSEMBLER 'STORE MULTIPLE' INSTRUCTION TO         14670000
*  INITIALIZE AND UPDATE THE CONTENTS OF THESE AREAS.                   14680000
*                                                                       14690000
*  TO DETERMINE WHETHER OR NOT A TASK IS ON THE CHAIN, COMPARE EITHER   14700000
*  OF THE CHAIN ANCHORS (GWABKWRD OR GWAFOWRD) TO THE DUMMY TASK        14710000
*  ADDRESS (GWADMYTA). IF THERE ARE NO TASKS ON THE CHAIN, BOTH WILL    14720000
*  POINT TO THE DUMMY TASK ADDRESS. IF THERE IS ONLY ONE TASK ON THE    14730000
*  CHAIN, BOTH ANCHORS WILL POINT TO IT'S LOCAL WORK AREA. IF THERE ARE 14740000
*  SEVERAL ON THE CHAIN, THE ANCHORS WILL POINT TO DIFFERENT LOCAL WORK 14750000
*  AREAS.                                                               14760000
*                                                                       14770000
GWADMYTA DS    0A GWA'S DUMMY TASK LOCAL WORK AREA ADDRESS ...          14780000
         ORG   , SET THE LOCATION COUNTER TO HIGHEST PREVIOUS SETTING.. 14790000
*                                                                       14800000
GWAQDLAY DS    PL4 QUIESCENT SHUTDOWN DELAY VALUE (0HHMMSS+) ...        14810000
GWAPORT  DS    H TCP/IP PORT NUMBER MASTER SERVER (LISTENER) WILL       14820000
*                LISTEN AT FOR INBOUND CICS TRANSACTION INITIATION      14830000
*                REQUESTS AND MUST MATCH WHAT WAS SPECIFIED IN THE      14840000
*                TCP/IP PORT STATEMENT OF PROFILE.TCPIP DATASET FOR     14850000
*                THIS CICS APPLID ...                                   14860000
GWATSTAT DS    C TASK-RELATED USER EXIT (TRUE) STATUS (ALL CICS TASKS). 14870000
GWATENAB EQU   C'E' TRUE IS ENABLED ...                                 14880000
GWATIMED EQU   C'I' CONNECTION MANAGER IN IMMEDIATE SHUTDOWN MODE ...   14890000
GWATQUIE EQU   C'Q' CONNECTION MANAGER IN QUIESCENT SHUTDOWN MODE ...   14900000
GWATSHUT EQU   C'S' MASTER SERVER (LISTENER) DETECTED CICS SHUTDOWN ... 14910000
*                                                                       14920000
GWARSHUT DS    C REQUESTED SHUTDOWN TYPE VIA CONNECTION MANAGER ...     14930000
GWAISHUT EQU   C'I' IMMEDIATE SHUTDOWN REQUESTED ...                    14940000
GWAQSHUT EQU   C'Q' QUIESCENT SHUTDOWN REQUESTED ...                    14950000
*                                                                       14960000
GWACSTAT DS    B CICS EXECUTION STATUS ...                              14970000
GWACXST2 EQU   B'00000000' CICS V2 EXECUTION STATUS ...                 14980000
GWACXSI1 EQU   B'00000001' CICS V2 1ST-STAGE OF INITIALIZATION ...      14990000
GWACXSI2 EQU   B'00000010' CICS V2 2ND-STAGE OF INITIALIZATION ...      15000000
GWACXSI3 EQU   B'00000100' CICS V2 3RD-STAGE OF INITIALIZATION ...      15010000
GWACXSQ1 EQU   B'00010000' CICS V2 1ST-STAGE OF QUIESCE ...             15020000
GWACXSQ2 EQU   B'00100000' CICS V2 2ND-STAGE OF QUIESCE ...             15030000
*                                                                       15040000
GWACCORD EQU   B'10000000' CICS V3 ORDERLY (NORMAL) SHUTDOWN ...        15050000
GWACCIMM EQU   B'01000000' CICS V3 IMMEDIATE SHUTDOWN ...               15060000
GWACCABY EQU   B'00100000' CICS V3 ABENDING, TCB'S DISPATACHABLE(RETRY) 15070000
GWACCABN EQU   B'00010000' CICS V3 ABENDING, TCB'S DISPATACHABLE(NORTY) 15080000
GWACOPCA EQU   B'00000001' CICS V3 OPER CANCELLED, TCB'S NOT DISPATACHA 15090000
*                                                                       15100000
GWAVOSYS DS    B VERSION OPERATING SYSTEM ...                           15110000
GWAMV3   EQU   B'00000011' MVS/ESA VERSION 3 IS EXECUTING ...           15120000
GWAMV2   EQU   B'00000010' MVS/XA VERSION 2 IS EXECUTING ...            15130000
GWAMV1   EQU   B'00000001' MVS/SP VERSION 1 RELEASE 3 IS EXECUTING ...  15140000
*                                                                       15150000
GWAOPREL DS    H OPERATING SYSTEM RELEASE NUMBER ...                    15160000
GWACIVRM DS    0CL4 CICS VERSION, RELEASE AND MODIFICATION LEVEL ...    15170000
GWACIVER DS    CL2 CICS VERSION NUMBER ...                              15180000
GWACIREL DS    CL1 CICS RELEASE NUMBER ...                              15190000
GWACIMOD DS    CL1 CICS MODIFICATION LEVEL ...                          15200000
*                                                                       15210000
GWACSKTN DS    PL4 CSKD ACTIVE TASK NUMBER ...                          15220000
GWACSKDA DS    A   ADDRESS OF CSKD's ECB ...                            15230000
GWACSKEC DS    F   CSKD's ECB ...                                       15240000
GWA03PSA DS    F   ADDRESS OF EZASOH03                                  15250000
         DS    0D  Force Doubleword length                              15260000
GWAEND   EQU   * END OF THE GLOBAL WORK AREA (GWA) ...                  15270000
GWALENTH EQU   GWAEND-GWABEGIN LENGTH OF THIS GWA ...                   15280000
         MEXIT                                                          15290000
.*--------------------------------------------------------------------* 15300000
.*  Process for TYPE=LISTEN                                           * 15310000
.*--------------------------------------------------------------------* 15320000
.HLIS0   ANOP     Process TYPE=LISTEN                                   15330000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             15340000
&HC2     SETC  '&CONST'                                                 15350000
         ST    0,16(1)            Address of S parameter                15360000
.*  Process BACKLOG Parameter                                           15370000
         EZASMIS &BACKLOG,F,4095,1,&SYSNDX                              15380000
&FC1     SETC  '&CONST'                                                 15390000
         ST    0,20(1)            Address of BACKLOG parameter          15400000
.*  Process ECB or REQAREA  parameter                                   15410000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              15420000
         ST    0,24(1)            Address of ECB/REQAREA parameter      15430000
         OI    24(1),X'80'        Mark last parameter                   15440000
         AGO   .HPARM00           Go put out final instructions         15450000
.*--------------------------------------------------------------------* 15460000
.*  Process for TYPE=READ                                             * 15470000
.*--------------------------------------------------------------------* 15480000
.HREA0   ANOP     Process TYPE=READ                                     15490000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             15500000
&HC2     SETC  '&CONST'                                                 15510000
         ST    0,16(1)            Address of S parameter                15520000
.*  Process NBYTE Parameter                                             15530000
         EZASMIS &NBYTE,F,32767,1,&SYSNDX                               15540000
&FC1     SETC  '&CONST'                                                 15550000
         ST    0,20(1)            Address of NBYTE parameter            15560000
.*  Process BUF Parameter                                               15570000
         EZASMIL &BUF                                                   15580000
         ST    0,24(1)            Address of BUF parameter              15590000
.*  Process ALET Parameter                                              15600000
         EZASMIL &ALET                                                  15610000
.HREA10  ANOP                                                           15620000
         ST    0,28(1)            Address of ALET parameter             15630000
.*  Process ECB or REQAREA  parameter                                   15640000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              15650000
         ST    0,32(1)            Address of ECB/REQAREA parameter      15660000
         OI    32(1),X'80'        Mark last parameter                   15670000
         AGO   .HPARM00           Go put out final instructions         15680000
.*--------------------------------------------------------------------* 15690000
.*  Process for TYPE=READV                                            * 15700000
.*--------------------------------------------------------------------* 15710000
.HRDV0   ANOP     Process TYPE=READV                                    15720000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             15730000
&HC2     SETC  '&CONST'                                                 15740000
         ST    0,16(1)            Address of S parameter                15750000
.*  Process IOVCNT Parameter                                            15760000
         EZASMIS &IOVCNT,F,32767,1,&SYSNDX                              15770000
&FC1     SETC  '&CONST'                                                 15780000
         ST    0,20(1)            Address of IOVCNT parameter           15790000
.*  Process IOV Parameter                                               15800000
         EZASMIL &IOV                                                   15810000
         ST    0,24(1)            Address of IOV parameter              15820000
.*  Process ECB or REQAREA  parameter                                   15830000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              15840000
         ST    0,28(1)            Address of ECB/REQAREA parameter      15850000
         OI    28(1),X'80'        Mark last parameter                   15860000
         AGO   .HPARM00           Go put out final instructions         15870000
.*--------------------------------------------------------------------* 15880000
.*  Process for TYPE=RECVFROM or TYPE=RECV                            * 15890000
.*--------------------------------------------------------------------* 15900000
.HRCF0   ANOP     Process TYPE=RECVFROM/RECV                            15910000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             15920000
&HC2     SETC  '&CONST'                                                 15930000
         ST    0,16(1)            Address of S parameter                15940000
.*  Process NBYTE Parameter                                             15950000
         EZASMIS &NBYTE,F,32767,2,&SYSNDX                               15960000
&FC2     SETC  '&CONST'                                                 15970000
         ST    0,20(1)            Address of NBYTE parameter            15980000
.*  Process BUF Parameter                                               15990000
         EZASMIL &BUF                                                   16000000
         ST    0,24(1)            Address of BUF parameter              16010000
.*  Process ALET Parameter                                              16020000
         EZASMIL &ALET                                                  16030000
.HRCF10  ANOP                                                           16040000
         ST    0,28(1)            Address of ALET parameter             16050000
.*  Process FLAGS Parameter                                             16060000
         EZASMIF &FLAGS,RECV,1,&SYSNDX   Go process FLAGS parameter     16070000
         AIF   ('&CONST' EQ '').HRCF15                                  16080000
&FC1     SETC  '&CONST'                                                 16090000
.HRCF15  ANOP                                                           16100000
         ST    0,32(1)            Address of FLAGS parameter            16110000
.*  Process ECB or REQAREA  parameter                                   16120000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              16130000
         ST    0,36(1)            Address of ECB/REQAREA parameter      16140000
.*  Process NAME Parameter                                              16150000
         AIF   ('&TYPE' EQ 'RECVFROM').HRCF60 Is it RECVFROM            16160000
         OI    36(1),X'80'        Indicate last parameter               16170000
         AGO   .HRCF70                                                  16180000
.HRCF60  ANOP                                                           16190000
         EZASMIL &NAME            Go process NAME parameter             16200000
         ST    0,40(1)            Address of NAME parameter             16210000
         OI    40(1),X'80'        Indicate last parameter               16220000
.HRCF70  ANOP                                                           16230000
         AGO   .HPARM00           Go put out final instructions         16240000
.*--------------------------------------------------------------------* 16250000
.*  Process for TYPE=RECVMSG                                          * 16260000
.*--------------------------------------------------------------------* 16270000
.HRCM0   ANOP     Process TYPE=RECVMSG                                  16280000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             16290000
&HC2     SETC  '&CONST'                                                 16300000
         ST    0,16(1)            Address of S parameter                16310000
.*  Process MSG Parameter                                               16320000
         EZASMIL &MSG,14                                           @P4C 16330000
         MVC   20(4,1),12(14)     Parameter 6 is address of IOVCNT @P4C 16340000
         MVC   24(4,1),8(14)      Parameter 7 is address of IOV    @P4C 16350000
.*  Process FLAGS Parameter                                             16360000
         EZASMIF &FLAGS,RECV,1,&SYSNDX   Go process FLAGS parameter     16370000
         AIF   ('&CONST' EQ '').HRCM15                                  16380000
&FC1     SETC  '&CONST'                                                 16390000
.HRCM15  ANOP                                                           16400000
         ST    0,28(1)            Address of FLAGS parameter            16410000
.*  Process ECB or REQAREA  parameter                                   16420000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              16430000
         ST    0,32(1)            Address of ECB/REQAREA parameter      16440000
         MVC   36(4,1),0(14)      Parameter 10 is address of NAME  @P4C 16450000
         OI    36(1),X'80'        Indicate last parameter               16460000
         AGO   .HPARM00           Go put out final instructions         16470000
.*--------------------------------------------------------------------* 16480000
.*  Process for TYPE=SELECT                                           * 16490000
.*--------------------------------------------------------------------* 16500000
.HSEL0   ANOP     PROCESS TYPE=SELECT and SELECTEX                      16510000
         AIF   (K'&MAXSOC EQ 0).HSELE1         No MAXSOC value          16520000
.*  Process MAXSOC Parameter                                            16530000
         EZASMIS &MAXSOC,F,2001,1,&SYSNDX                               16540000
&FC1     SETC  '&CONST'                                                 16550000
         ST    0,20(1)            Address of MAXSOC parameter           16560000
         LR    14,0               Put parameter address in reg 14       16570000
         L     0,0(14)            Calculate Length of Mask              16580000
&HC2     SETC  'H''31'''                                                16590000
         AH    0,E$H2&SYSNDX      LOM = ((MAXSOC+31)/32)*4              16600000
         SRA   0,5                Divide by 32                          16610000
         LR    14,0               Save number of words in mask value    16620000
         SLA   0,2                Multiply by 4                         16630000
         STH   0,136(1)           Put value in temporary field          16640000
         LA    0,136(1)           Get address of temporary field        16650000
         ST    0,16(1)            Address of LOM parameter              16660000
         AGO   .HSELE2                                                  16670000
.HSELE1  ANOP                                                           16680000
         SLR   0,0                No MAXSOC specified                   16690000
         ST    0,20(1)            Address of MAXSOC parameter           16700000
         ST    0,16(1)            Address of NFDS   parameter           16710000
.HSELE2  ANOP                                                           16720000
.*  Process TIMEOUT Parameter                                           16730000
         EZASMIL &TIMEOUT                                               16740000
         LTR   14,0               Was a TIMEOUT value specified?        16750000
         BE    E$S1&SYSNDX        No                                    16760000
         L     0,0(14)            Yes, test value                       16770000
         LTR   0,0                Is it negative                        16780000
         BNM   E$S1&SYSNDX        No, store address                     16790000
         SLR   14,14              Yes, set address to zero              16800000
&TEMPCH  SETC  'E$S1'.'&SYSNDX'                                         16810000
&TEMPCH  DS    0H                                                       16820000
         ST    14,24(1)           Address of TIMEOUT                    16830000
.*  Process RSNDMSK Parameter                                           16840000
         EZASMIL &RSNDMSK                                               16850000
         ST    0,28(1)            Address of RSNDMSK                    16860000
.*  Process WSNDMSK Parameter                                           16870000
         EZASMIL &WSNDMSK                                               16880000
         ST    0,32(1)            Address of WSNDMSK                    16890000
.*  Process ESNDMSK Parameter                                           16900000
         EZASMIL &ESNDMSK                                               16910000
         ST    0,36(1)            Address of ESNDMSK                    16920000
.*  Process RRETMSK Parameter                                           16930000
         AIF   (K'&RRETMSK EQ 0).HSELF1       No RRETMSK value          16940000
         EZASMIL &RRETMSK                                               16950000
         AGO   .HSELF2                                                  16960000
.HSELF1  ANOP                     No RRETMSK value specified            16970000
         AIF   (K'&RSNDMSK EQ 0).HSELF1A  No RSNDMSK specified          16980000
         MNOTE 12,'EZASM005 RRETMSK required if RSNDMSK specified'      16990000
         AGO   .GENCON            Go put out final instructions         17000000
.HSELF1A ANOP                                                           17010000
         SLR   0,0                                                      17020000
.HSELF2  ANOP                                                           17030000
         ST    0,40(1)            Address of RRETMSK                    17040000
.*  Process WRETMSK Parameter                                           17050000
         AIF   (K'&WRETMSK EQ 0).HSELG1       No WRETMSK value          17060000
         EZASMIL &WRETMSK                                               17070000
         AGO   .HSELG2                                                  17080000
.HSELG1  ANOP                     No WRETMSK value specified            17090000
         AIF   (K'&WSNDMSK EQ 0).HSELG1A No WSNDMSK specified           17100000
         MNOTE 12,'EZASM005 WRETMSK required if WSNDMSK specified'      17110000
         AGO   .GENCON            Go put out final instructions         17120000
.HSELG1A ANOP                                                           17130000
         SLR   0,0                                                      17140000
.HSELG2  ANOP                                                           17150000
         ST    0,44(1)            Address of WRETMSK                    17160000
.*  Process ERETMSK Parameter                                           17170000
         AIF   (K'&ERETMSK EQ 0).HSELH1       No ERETMSK value          17180000
         EZASMIL &ERETMSK                                               17190000
         AGO   .HSELH2                                                  17200000
.HSELH1  ANOP                     No ERETMSK value specified            17210000
         AIF   (K'&ESNDMSK EQ 0).HSELH1A  No ESNDMSK specified          17220000
         MNOTE 12,'EZASM005 ERETMSK required if ESNDMSK specified'      17230000
         AGO   .GENCON            Go put out final instructions         17240000
.HSELH1A ANOP                                                           17250000
         SLR   0,0                                                      17260000
.HSELH2  ANOP                                                           17270000
         ST    0,48(1)            Address of ERETMSK                    17280000
         AIF   ('&TYPE' EQ 'SELECTEX').HSELJ0  Is this SELECTEX         17290000
.*  Process ECB or REQAREA  parameter                                   17300000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              17310000
         ST    0,52(1)            Address of ECB                        17320000
         OI    52(1),X'80'        No, mark end of parameter list        17330000
         AGO   .HPARM00           Go put out final instructions         17340000
.HSELJ0  ANOP                     Process SELECB                        17350000
         AIF   (K'&SELECB(2) EQ 0).HSELJ1  Keyword LIST not given@P9C   17360000
         EZASMIL &SELECB(1)       Process first keyword          @P9C   17370000
         ST    0,52(1)            Address of SELECB              @P9C   17380000
         AIF   ('&SELECB(2)' EQ '''LIST''').HSELJ4               @P9C   17390000
         MNOTE 4,'EZASM006 Literal specified not equal to LIST'         17400000
         AGO   .HPARM00           Go put out final instructions         17410000
.HSELJ1  ANOP                     Process SELECB                 @P9C   17420000
         EZASMIL &SELECB                                         @P9C   17430000
         ST    0,52(1)            Address of SELECB              @P9C   17440000
         AGO   .HPARM00           Go put out final instructions  @P9C   17450000
.HSELJ4  ANOP                                                           17460000
         OI    52(1),B'10000000' Indicate ECB list processing           17470000
.*       Line deleted by PTR MV11239                             @P7C * 17480000
         AGO   .HPARM00           Go put out final instructions         17490000
.*--------------------------------------------------------------------* 17500000
.*  Process for TYPE=SEND or  SENDTO                                  * 17510000
.*--------------------------------------------------------------------* 17520000
.HSND0   ANOP     Process TYPE=SEND                                     17530000
.HSDT0   ANOP     Process TYPE=SENDTO                                   17540000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             17550000
&HC2     SETC  '&CONST'                                                 17560000
         ST    0,16(1)            Address of S parameter                17570000
.*  Process NBYTE Parameter                                             17580000
         EZASMIS &NBYTE,F,32767,1,&SYSNDX                               17590000
&FC1     SETC  '&CONST'                                                 17600000
         ST    0,20(1)            Address of NBYTE parameter            17610000
.*  Process BUF parameter                                               17620000
         EZASMIL &BUF                                                   17630000
         ST    0,24(1)            Address of BUF parameter              17640000
.*  Process ALET Parameter                                              17650000
         AIF   (K'&ALET NE 0).HSND05  Was ALET Specified                17660000
         SLR   0,0                ALET not specified                    17670000
         AGO   .HSND10                                                  17680000
.HSND05  ANOP                                                           17690000
         EZASMIL &ALET                                                  17700000
.HSND10  ANOP                                                           17710000
         ST    0,28(1)            Address of ALET parameter             17720000
.*  Process FLAGS Parameter                                             17730000
         EZASMIF &FLAGS,SEND,2,&SYSNDX   Go process FLAGS parameter     17740000
         AIF   ('&CONST' EQ '').HSND15                                  17750000
&FC2     SETC  '&CONST'                                                 17760000
.HSND15  ANOP                                                           17770000
         ST    0,32(1)            Address of FLAGS parameter            17780000
.*  Process ECB or REQAREA  parameter                                   17790000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              17800000
         ST    0,36(1)            Address of ECB/REQAREA parameter      17810000
         AIF   ('&TYPE' EQ 'SENDTO').HSNDF15 Is it SENDTO               17820000
         OI    36(1),X'80'        Indicate last parameter               17830000
         AGO   .HSNDF20                                                 17840000
.HSNDF15 ANOP                                                           17850000
         EZASMIL &NAME            Go process NAME parameter             17860000
         ST    0,40(1)            Address of NAME parameter             17870000
         OI    40(1),X'80'        Indicate last parameter               17880000
.HSNDF20 ANOP                                                           17890000
         AGO   .HPARM00           Go put out final instructions         17900000
.*--------------------------------------------------------------------* 17910000
.*  Process for TYPE=SENDMSG                                          * 17920000
.*--------------------------------------------------------------------* 17930000
.HSDM0   ANOP     Process TYPE=SENDMSG                                  17940000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             17950000
&HC2     SETC  '&CONST'                                                 17960000
         ST    0,16(1)            Address of S parameter                17970000
.*  Process MSG parameter                                               17980000
         EZASMIL &MSG,14                                                17990000
         MVC   20(4,1),12(14)     Parameter 6 is pointer to IOVCNT @P4C 18000000
         MVC   24(4,1),8(14)      Parameter 7 is pointer to IOV    @P4C 18010000
.*  Process FLAGS Parameter                                             18020000
         EZASMIF &FLAGS,SEND,2,&SYSNDX   Go process FLAGS parameter     18030000
         AIF   ('&CONST' EQ '').HSDM15                                  18040000
&FC2     SETC  '&CONST'                                                 18050000
.HSDM15  ANOP                                                           18060000
         ST    0,28(1)            Address of FLAGS parameter            18070000
.*  Process ECB or REQAREA  parameter                                   18080000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              18090000
         ST    0,32(1)            Address of ECB/REQAREA parameter      18100000
.HSDMF15 ANOP                                                           18110000
         MVC   36(4,1),0(14)      Parameter 10 is pointer to NAME       18120000
         OI    36(1),X'80'        Indicate last parameter               18130000
.HSDMF20 ANOP                                                           18140000
         AGO   .HPARM00           Go put out final instructions         18150000
.*--------------------------------------------------------------------* 18160000
.*  Process for TYPE=SETSOCKOPT                                       * 18170000
.*--------------------------------------------------------------------* 18180000
.HSSO0   ANOP     Process TYPE=SETSOCKOPT                               18190000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             18200000
&HC2     SETC  '&CONST'                                                 18210000
         ST    0,16(1)            Address of S parameter                18220000
.*  Process OPTNAME Parameter                                           18230000
         AIF   ('&OPTNAME'(1,1) NE '''').HSSON0  Passed as literal?     18240000
         AIF   ('&OPTNAME' NE '''SO_BROADCAST''').HSSON00               18250000
&FC2     SETC  'X''00000020'''                                          18260000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_BROADCAST           18270000
         AGO   .HSSON3                                                  18280000
.HSSON00 ANOP                                                           18290000
         AIF   ('&OPTNAME' NE '''SO_LINGER''').HSSON02                  18300000
&FC2     SETC  'X''00000080'''                                          18310000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_LINGER              18320000
         AGO   .HSSON3                                                  18330000
.HSSON02 ANOP                                                           18340000
         AIF   ('&OPTNAME' NE '''SO_OOBINLINE''').HSSON03               18350000
&FC2     SETC  'X''00000100'''                                          18360000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_OOBINLINE           18370000
         AGO   .HSSON3                                                  18380000
.HSSON03 ANOP                                                           18390000
         AIF   ('&OPTNAME' NE '''SO_REUSEADDR''').HSSON05               18400000
&FC2     SETC  'X''00000004'''                                          18410000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_REUSEADDR           18420000
         AGO   .HSSON3                                                  18430000
.HSSON05 ANOP                                                           18440000
         AIF   ('&OPTNAME' NE '''SO_KEEPALIVE''').HSSON06               18450000
&FC2     SETC  'X''00000008'''                                          18460000
         LA    0,E$F2&SYSNDX      Set OPTNAME to SO_KEEPALIVE           18470000
         AGO   .HGSON3                                                  18480000
.HSSON06 ANOP                                                           18490000
         MNOTE 8,'EZASM008 Invalid literal specified for OPTNAME'       18500000
         XC    140(16,1),140(1)   Set temporary field to 0              18510000
         LA    0,140(1)           Set OPTNAME to nulls                  18520000
         AGO   .HSSON3                                                  18530000
.HSSON0  ANOP                                                           18540000
         EZASMIL &OPTNAME                                               18550000
.HSSON3  ANOP                                                           18560000
         ST    0,20(1)            Address of OPTNAME parameter          18570000
.*  Process OPTVAL Parameter                                            18580000
         EZASMIL &OPTVAL                                                18590000
         ST    0,24(1)            Address of OPTVAL parameter           18600000
.*  Process OPTLEN Parameter                                            18610000
         EZASMIL &OPTLEN                                                18620000
         ST    0,28(1)            Address of OPTLEN parameter           18630000
.*  Process ECB or REQAREA  parameter                                   18640000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              18650000
         ST    0,32(1)            Address of ECB/REQAREA parameter      18660000
         OI    32(1),X'80'        Mark last parameter                   18670000
         AGO   .HPARM00           Go put out final instructions         18680000
.*--------------------------------------------------------------------* 18690000
.*  Process for TYPE=SHUTDOWN                                         * 18700000
.*--------------------------------------------------------------------* 18710000
.HSHU0   ANOP     Process TYPE=SHUTDOWN                                 18720000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             18730000
&HC2     SETC  '&CONST'                                                 18740000
         ST    0,16(1)            Address of S parameter                18750000
.*  Process HOW Parameter                                               18760000
         EZASMIS &HOW,F,3,1,&SYSNDX  Go process HOW parameter           18770000
&FC1     SETC  '&CONST'                                                 18780000
         ST    0,20(1)            Address of HOW parameter              18790000
.*  Process ECB or REQAREA  parameter                                   18800000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              18810000
         ST    0,24(1)            Address of ECB/REQAREA parameter      18820000
         OI    24(1),X'80'        Mark last parameter                   18830000
         AGO   .HPARM00           Go put out final instructions         18840000
.*--------------------------------------------------------------------* 18850000
.*  Process for TYPE=SOCKET                                           * 18860000
.*--------------------------------------------------------------------* 18870000
.HSOC0   ANOP     Process TYPE=SOCKET                                   18880000
.*  Process AF Parameter                                                18890000
         AIF   ('&AF'(1,1) NE '''').HSOCA0 Passed as literal?           18900000
         AIF   ('&AF'(2,4) NE 'INET').HSOCA00  INET Specified?          18910000
&FC1     SETC  'F''02'''                                                18920000
         LA    0,E$F1&SYSNDX      AF ='INET' Specified                  18930000
         AGO   .HSOCA3                                                  18940000
.HSOCA00 ANOP                                                           18950000
         MNOTE 8,'EZASM006 Invalid AF specified, INET assumed'          18960000
&FC1     SETC  'F''02'''                                                18970000
         LA    0,E$F1&SYSNDX      AF ='INET' Assumed                    18980000
         AGO   .HSOCA3                                                  18990000
.HSOCA0  ANOP                                                           19000000
         EZASMIL &AF                                                    19010000
.HSOCA3  ANOP                                                           19020000
         ST    0,16(1)            Address of AF parameter               19030000
.*  Process SOCTYPE Parameter                                           19040000
         AIF   ('&SOCTYPE'(1,1) NE '''').HSOCC1  Was Literal specified  19050000
         AIF   ('&SOCTYPE' NE '''STREAM''').HSOCCT1  Stream socket?     19060000
&FC2     SETC  'F''01'''                                                19070000
         LA    0,E$F2&SYSNDX      Get address of constant for STREAM    19080000
         AGO   .HSOCC1A                                                 19090000
.HSOCCT1 ANOP                                                           19100000
         AIF   ('&SOCTYPE' NE '''DATAGRAM''').HSOCCT2  Datagram socket? 19110000
&FC2     SETC  'F''02'''                                                19120000
         LA    0,E$F2&SYSNDX      Get address of constant for DATAGRAM  19130000
         AGO   .HSOCC1A                                                 19140000
.HSOCCT2 ANOP                                                           19150000
         AIF   ('&SOCTYPE' NE '''RAW''').HSOCCT3  Raw socket?           19160000
&FC2     SETC  'F''03'''                                                19170000
         LA    0,E$F2&SYSNDX      Get address of constant for RAW       19180000
         AGO   .HSOCC1A                                                 19190000
.HSOCCT3 ANOP                                                           19200000
         MNOTE 8,'EZASM009, Invalid socket type specified, STREAM assumX19210000
               ed'                                                      19220000
&FC2     SETC  'F''01'''                                                19230000
         LA    0,E$F2&SYSNDX      Get address of constant for STREAM    19240000
         AGO   .HSOCC1A                                                 19250000
.HSOCC1  ANOP                                                           19260000
         EZASMIL &SOCTYPE                                               19270000
.HSOCC1A ANOP                                                           19280000
         ST    0,20(1)            Address of SOCTYPE parameter          19290000
.*  Process PROTO Parameter                                             19300000
         AIF   (K'&PROTO NE 0).HSOCC2         Was Protocol specified?   19310000
         XC    140(16,1),140(1)   Set temporary field to 0              19320000
         LA    0,140(1)           No Protocol specified, set to 0       19330000
         AGO   .HSOCC3                                                  19340000
.HSOCC2  ANOP                                                           19350000
         EZASMIL &PROTO                                                 19360000
.HSOCC3  ANOP                                                           19370000
         ST    0,24(1)            Address of PROTO parameter            19380000
.*  Process NS parameter                                                19390000
         AIF   (K'&NS NE 0).HSOC10 Was NS Specified                     19400000
         SLR   0,0                Parameter was not specified           19410000
         AGO   .HSOC20                                                  19420000
.HSOC10  ANOP                                                           19430000
         EZASMIS &NS,H,4095,2,&SYSNDX,14 Go process NS parameter   @P4C 19440000
&HC2     SETC  '&CONST'                                                 19450000
         LH    0,0(14)            Put halfword value in Reg 0      @P4C 19460000
         ST    0,120(1)          Store it as fullword                   19470000
.HSOC15  ANOP                                                           19480000
         LA    0,120(1)          Get address of fullword socket number  19490000
.HSOC20  ANOP                                                           19500000
         ST    0,28(1)            Address of NS parameter               19510000
.*  Process ECB or REQAREA  parameter                                   19520000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              19530000
         ST    0,32(1)            Address of ECB/REQAREA parameter      19540000
         OI    32(1),X'80'        Mark last parameter                   19550000
         AGO   .HPARM00           Go put out final instructions         19560000
.*--------------------------------------------------------------------* 19570000
.*  Process for TYPE=TASK                                             * 19580000
.*--------------------------------------------------------------------* 19590000
.HTAS0   ANOP                                                           19600000
         AIF   (K'&LABEL EQ 0).HTAS1                                    19610000
&TEMPCH  SETC  '&LABEL'                                                 19620000
&LABGEN  SETB  1                                                        19630000
         AGO   .HTAS2                                                   19640000
.HTAS1   ANOP                                                           19650000
&TEMPCH  SETC  'EZASMTIE'                                               19660000
&LABGEN  SETB  0                                                        19670000
.HTAS2   ANOP                                                           19680000
         AIF   ('&STORAGE' EQ 'DSECT').HTAS3                            19690000
&TEMPCH  DS    0D  MAP THE TASK INTERFACE ELEMENT APPENDAGE FOR TCPIP   19700000
         AGO   .HTAS4                                                   19710000
.HTAS3   ANOP                                                           19720000
&TEMPCH  DSECT MAP THE TASK INTERFACE ELEMENT (TIE) APPENDAGE FOR TCPIP 19730000
.HTAS4   ANOP                                                           19740000
*                                                                       19750000
         AIF   (NOT &LABGEN).HTAS5                                      19760000
EZASMTIE EQU   *                                                        19770000
.HTAS5   ANOP                                                           19780000
         AIF   ('&CICS' NE 'YES').HTAS06                                19790000
*********************************************************************** 19800000
*                                                                     * 19810000
*          TASK INTERFACE ELEMENT (TIE) APPENDAGE FOR TCP/IP          * 19820000
*          -    -         -                           --- --          * 19830000
*********************************************************************** 19840000
*                                                                       19850000
TIETREYE DS    0CL328 TASK-RELATED USER EXIT (TRUE) EYECATCHER ...      19860000
TIETRDSC DS    CL8 TRUE INITIALIZES THIS TO 'EZACICTI' ...              19870000
*                                                                       19880000
TIETRHER DS    0CL30 TASK-RELATED USER EXIT (TRUE) HERITAGE             19890000
TIETRID  DS    0CL24 TASK-RELATED USER EXIT (TRUE) ID            @L1A   19900000
TIETRNAM DS    CL08  TASK-RELATED USER EXIT PART NAME  @L1C ...         19910000
TIETRDTE DS    CL08  TASK-RELATED USER EXIT COMP DATE  @L1C ...         19920000
TIETRSRV DS    CL08  TASK-RELATED USER EXIT SERVICE LVL@L1C ...         19930000
TIETRRSV DS    CL06  TASK-RELATED USER EXIT RESERVED   @L1C             19940000
*                                                                       19950000
TIECMHER DS    0CL30 CONNECTION MANAGER (ENABLE/DISABLE-API) HERITAGE   19960000
TIECMID  DS    0CL24 CONNECTION MANAGER (ENABLE/DISABLE-API) ID  @L1A   19970000
TIECMNAM DS    CL08  CONNECTION MANAGER PART NAME  @L1C ...             19980000
TIECMDTE DS    CL08  CONNECTION MANAGER COMP DATE  @L1C ...             19990000
TIECMSRV DS    CL08  CONNECTION MANAGER SERVICE LVL@L1C ...             20000000
TIECMRSV DS    CL06  CONNECTION MANAGER RESERVED   @L1C                 20010000
*                                                                       20020000
TIEMSHER DS    0CL30 MASTER SERVER (LISTENER) HERITAGE ...              20030000
TIEMSID  DS    0CL24 MASTER SERVER (LISTENER) ID                 @L1A   20040000
TIEMSNAM DS    CL08  MASTER SERVER PART NAME  @L1C ...                  20050000
TIEMSDTE DS    CL08  MASTER SERVER COMP DATE  @L1C ...                  20060000
TIEMSSRV DS    CL08  MASTER SERVER SERVICE LVL@L1C ...                  20070000
TIEMSRSV DS    CL06  MASTER SERVER RESERVED   @L1C                      20080000
*                                                                       20090000
TIESTHER DS    0CL30 SUBTASK'S HERITAGE ...                             20100000
TIESTID  DS    0CL24 SUBTASK'S ID                                @L1A   20110000
TIESTNAM DS    CL08  ATTACHED MVS SUBTASK PART NAME  @L1C ...           20120000
TIESTDTE DS    CL08  ATTACHED MVS SUBTASK COMP DATE  @L1C ...           20130000
TIESTSRV DS    CL08  ATTACHED MVS SUBTASK SERVICE LVL@L1C ...           20140000
TIESTRSV DS    CL06  ATTACHED MVS SUBTASK RESERVED   @L1C               20150000
*                                                                       20160000
TIETRIBM DS    CL154 IBM COPYRIGHT STATEMENT (NO LONGER USED @L1C)      20170000
         DS    CL46 ****BINARY ZEROES FILLER COMPATABILITY WITH GWA**** 20180000
*                                                                       20190000
TIEBKWRD DS    A   TASK CHAIN ANCHOR BACKWARD ADDRESS ...               20200000
TIEFOWRD DS    A   TASK CHAIN ANCHOR FORWARD ADDRESS ...                20210000
*                                                                       20220000
TIESTTCB DS    A   SUBTASK'S TASK CONTROL BLOCK (TCB) ADDRESS ...       20230000
*                                                                       20240000
TIESTPSA DS    F   SUBTASK'S PROGRAM STORAGE ADDRESS                    20250000
TIESTPSL DS    F   SUBTASK'S PROGRAM STORAGE LENGTH (ROUNDED UP TO 4K). 20260000
TIESTISA DS    A   SUBTASK'S GETMAIN FOR ISOLATED STORAGE ADDRESS ...   20270000
TIESTISL DS    F   SUBTASK'S GETMAIN FOR ISOLATED STORAGE LENGTH ...    20280000
TIESTCSA DS    A   SUBTASK'S GETMAIN FOR COMMON STORAGE ADDRESS ...     20290000
TIESTCSL DS    F   SUBTASK'S GETMAIN FOR COMMON STORAGE LENGTH ...      20300000
TIESTLMA DS    A   SUBTASK'S GETMAIN FOR LARGE MESSAGE/ANSWER ADDRESS.. 20310000
TIESTLML DS    F   SUBTASK'S GETMAIN FOR COMMON STORAGE LENGTH ...      20320000
*                                                                       20330000
         DS    0F  EVENT CONTROL BLOCKS (ECB'S) ...                     20340000
TIECTECB DS    F   CICS TASK(TRUE) EVENT COMPLETE ECB POSTED BY SUBTASK 20350000
TIESTECB DS    F   SUBTASK'S ECB POSTED BY TRUE SIGNALLING NEXT EVENT.. 20360000
TIESDECB DS    F   SUBTASK'S ECB POSTED BY TRUE SIGNALLING DETACH TCB.. 20370000
TIESIECB DS    F   SUBTASK'S ECB POSTED BY ASYNC EXTERNAL INTERRUPT ... 20380000
*                                                                       20390000
TIECECBL DS    0A  CICS TASK (TRUE) WAIT EXTERNAL ECBLIST= ADDRESSES... 20400000
TIECFECB DS    A (TIECTECB) CICS WAIT EXTERNAL FIRST ECBLIST= ADDRESS.. 20410000
TIECLECB EQU   TIECFECB (X'80000000') CICS WAIT EXTERNAL LAST ECB ENTRY 20420000
*                                                                       20430000
TIESTLST DS    0A  ECB LIST FOR MULTIPLE WAIT ISSUED BY SUBTASK ...     20440000
TIESTADS DS    A   ADDRESS OF TIESTECB  (SUBTASK EVENT ECB) ...         20450000
TIECDADS DS    A   ADDRESS OF TIECKECB  (TASK TERMINATION ECB) ...      20460000
TIESTEND DS    0A  END OF ECB LIST ...                                  20470000
TIEIUADS DS    A   ADDRESS OF TIEIUECB  (IUCV EXIT EVENT ECB) ...       20480000
*                                                                       20490000
TIEAUDIT DS    0F AUDIT TRAIL DATA ...                                  20500000
         DS    0F CURRENT CALL PARAMETER DATA INITIALIZED FOR EACH CALL 20510000
TIECDATA DS    0XL28  CURRENT CALL DATA INITIALIZED FOR EACH CALL ...   20520000
TIETRGCL DS    0F IUCV TARGET MESSAGE CLASS ...                         20530000
TIESOKCL DS    H  IUCV SOCKET/FUNCTION CALL ...                         20540000
TIESOKDS DS    H  TCP/IP SOCKET DESCRIPTOR ...                          20550000
TIEAPARM DS    A  APPLICATION/CICS CALL PARAMETER LIST ADDRESS IN GPR 1 20560000
TIEERRNO DS    F  ERROR NUMBER RETURNED BY TRUE, SUBTASK OR TCP/IP ...  20570000
TIEUENAD DS    A  USER/CALLER ERROR NUMBER DATA-AREA ADDRESS ...        20580000
TIERCODE DS    F  RETURN CODE RETURNED BY TRUE, SUBTASK OR TCP/IP ...   20590000
TIEURCAD DS    A  USER/CALLER RETURN CODE DATA-AREA ADDRESS ...         20600000
TIEMACRC DS    F  OPERATING SYSTEM MACRO RETURN CODE RETURNED IN GPR 15 20610000
*                                                                       20620000
         DS    0F SAVED CALL PARAMETER DATA FROM PREVIOUS CALL ...      20630000
TIESDATA DS    0XL28  SAVED CALL PARAMETER DATA FROM PREVIOUS CALL ...  20640000
TIESTRGC DS    0F IUCV TARGET MESSAGE CLASS ...                         20650000
TIESSOKC DS    H  IUCV SOCKET/FUNCTION CALL ...                         20660000
TIESSOKD DS    H  TCP/IP SOCKET DESCRIPTOR ...                          20670000
TIESAPAR DS    A  APPLICATION/CICS CALL PARAMETER LIST ADDRESS IN GPR 1 20680000
TIESERRN DS    F  ERROR NUMBER RETURNED BY TRUE, SUBTASK OR TCP/IP ...  20690000
TIESUENA DS    A  USER/CALLER ERROR NUMBER DATA-AREA ADDRESS ...        20700000
TIESRCOD DS    F  RETURN CODE RETURNED BY TRUE, SUBTASK OR TCP/IP ...   20710000
TIESURCA DS    A  USER/CALLER RETURN CODE DATA-AREA ADDRESS ...         20720000
TIESMACR DS    F  OPERATING SYSTEM MACRO RETURN CODE RETURNED IN GPR 15 20730000
*                                                                       20740000
TIEFSTAT DS    B TASK-RELATED USER EXIT (TRUE) FUNCTION STATUS FLAGS... 20750000
TIEFUNIT EQU   B'00000000' TRUE UNINITIALIZED (NEVER CALLED) ...        20760000
TIEFAPP  EQU   B'00000001' TRUE CALLED BY APPLICATION (DFHRMCAL) ...    20770000
TIEFEDF  EQU   B'00000010' TRUE CALLED BY DIAGNOSTIC FACILITY (V3-V3+). 20780000
TIEFMON  EQU   B'00000100' TRUE CALLED BY MONITOR FACILITY (V1-V2) ...  20790000
TIEFSYN  EQU   B'00001000' TRUE CALLED BY SYNCPOINT MANAGER ...         20800000
TIEFTRM  EQU   B'00010000' TRUE CALLED BY TASK TERMINATION ...          20810000
TIEFSTM  EQU   B'00100000' TRUE CALLED BY SYSTEM TERMINATION (V3-V3+).. 20820000
TIEFUNK  EQU   B'10000000' TRUE CALLED BY AN UNKNOWN SOURCE ...         20830000
*                                                                       20840000
TIEASTAT DS    B APPLICATION STATUS FLAGS (CALLING APPLICATION) ...     20850000
TIEAUNIT EQU   B'00000000' APPLICATION UNINITIALIZED (HAS NEVER CALLED) 20860000
TIEAINIT EQU   B'00000001' APPLICATION'S INITIAL (FIRST) CALL TO TRUE.. 20870000
TIEAACTV EQU   B'00000010' APPLICATION IS ACTIVE ...                    20880000
TIEAMPAI EQU   B'00000100' APPLICATION HAS MULTIPLE IUCV PATHS TO TCPIP 20890000
TIEAWSUB EQU   B'00001000' APPLICATION IS WAITING FOR SUBTASK SERVICE.. 20900000
TIEATTRM EQU   B'01000000' APPLICATION IS AT TASK TERMINATION ...       20910000
TIEASTRM EQU   B'10000000' APPLICATION IS AT SYSTEM TERMINATION ...     20920000
*                                                                       20930000
TIESSTAT DS    B SUBTASK STATUS FLAGS (ATTACHED SUBTASK) ...            20940000
TIESUNIT EQU   B'00000000' SUBTASK UNINITIALIZED (NEVER ATTACHED) ...   20950000
TIESINIT EQU   B'00000001' SUBTASK'S INITIAL ENTRY (FIRST TIME ENTERED) 20960000
TIESACTV EQU   B'00000010' SUBTASK IS ACTIVE ...                        20970000
TIESATCH EQU   B'00000100' SUBTASK ATTACHED FOR THIS CICS TASK ...      20980000
TIESWTRU EQU   B'00001000' SUBTASK WAITING ON TRUE TO POST IT'S ECB ... 20990000
TIESWINT EQU   B'00010000' SUBTASK WAITING ON INTERRUPT HANDLER TO POST 21000000
TIESERRS EQU   B'00100000' SUBTASK HAS DETECTED ERRORS ...              21010000
TIESABND EQU   B'01000000' SUBTASK HAS ABNORMALLY TERMINATED (ABEND)... 21020000
TIESDTCH EQU   B'10000000' SUBTASK HAS DETACHED FROM MVS ...            21030000
*                                                                       21040000
TIETSTAT DS    B TASK-RELATED USER EXIT (TRUE) STATUS FLAGS ...         21050000
TIETUNIT EQU   B'00000000' TRUE UNINITIALIZED (NEVER ENTERED) ...       21060000
TIETINIT EQU   B'00000001' TRUE'S INITIAL ENTRY (FIRST TIME ENTERED)... 21070000
TIETACTV EQU   B'00000010' TRUE IS ACTIVE ...                           21080000
TIETEAPP EQU   B'00000100' TRUE IS ENABLED FOR APPLICATION CALLS ...    21090000
TIETWSUB EQU   B'00001000' TRUE WAITING ON SUBTASK TO POST IT'S ECB ... 21100000
TIETETRM EQU   B'00010000' TRUE ENABLED FOR TERMINATION MANAGER CALLS.. 21110000
TIETDAPP EQU   B'00100000' TRUE IS DISABLED FOR APPLICATION CALLS ...   21120000
TIETDTRM EQU   B'01000000' TRUE DISABLED FOR TERMINATION MANAGER CALLS. 21130000
*                                                                       21140000
TIENINIT EQU   B'11111110' AND OFF INITIAL BIT 7 ...                    21150000
TIENACTV EQU   B'11111101' AND OFF ACTIVE BIT 6 ...                     21160000
TIENEAPP EQU   B'11111011' AND OFF ENABLED FOR APPLICATION CALLS BIT 5. 21170000
TIENWSUB EQU   B'11110111' AND OFF WAITING ON SUBTASK BIT 4 ...         21180000
TIENWTRU EQU   B'11110111' AND OFF WAITING ON TRUE BIT 4 ...            21190000
*                                                                       21200000
TIETRACE DS    BL1 TRACING FLAGS ...                                    21210000
TIETROFF EQU   B'00000000' TRACING IS OFF/INACTIVE FOR THIS TASK ...    21220000
TIETRUSR EQU   B'00000001' SINGLE USER TRACING TURNED ON BY USER TASK.. 21230000
TIETRTRU EQU   B'00000010' SINGLE USER TRACING TURNED ON BY THE TRUE... 21240000
TIETRGTF EQU   B'00000100' GENERALIZED TRACE FACILITY ACTIVE FOR SUBTSK 21250000
TIETRCON EQU   B'10000000' UNDOCUMENTED SUBTASK CONSOLE TRACING ACTIVE. 21260000
TIENTUSR EQU   B'11111110' AND OFF USER TRACING BIT ...                 21270000
TIENRTRU EQU   B'11111101' AND OFF TRUE USER TRACING BIT ...            21280000
*                                                                       21290000
         DS    BL3 RESERVED FOR FUTURE USE ...                          21300000
*                                                                       21310000
TIESUBID DS    XL8 TCP/IP SUBTASKID (LAST OR ONLY) ...                  21320000
TIEIPATH DS    H PATHID (LAST OR ONLY) IF SUCCESSFUL IUCV CONNECT ...   21330000
TIEIPTYP DS    XL1 IUCV EXTERNAL INTERRUPT TYPE RECEIVED ...            21340000
TIEIPAUD DS    XL3 IUCV AUDIT TRAIL BYTES ...                           21350000
TIEIPUSR DS    XL16 IUCV USER DATA ...                                  21360000
*                                                                       21370000
TIEAPLID DS    CL8 VTAM APPLID OF THIS CICS REGION ...                  21380000
TIEOPID  DS    CL3 CICS OPERATOR IDENTIFICATION FROM SIGN-ON TABLE ...  21390000
TIETRMID DS    CL4 CICS TERMINAL IDENTIFICATION FROM EIBTRMID ...       21400000
TIETRNID DS    CL4 CICS TRANSACTION IDENTIFICATION FROM EIBTRNID ...    21410000
TIETASKN DS    PL4 CICS TASK NUMBER FROM EIBTASKN ...                   21420000
TIEDOWEK DS    CL3 DAY-OF-WEEK ABBREVIATED(SUN MON TUE WED THU FRI SAT) 21430000
TIEDATFM DS    CL8 DATE FORMAT AS SPECIFIED IN SIT DATFORM= OPTION ...  21440000
TIECLKTM DS    CL8 24-HOUR CLOCK TIME IN THE FORM HH:MM:SS ...          21450000
*                                                                       21460000
TIESTATS DS    13F RESERVED FOR FUTURE STATISTICAL DATA ...             21470000
.HTAS06  ANOP                                                           21480000
*                                                                       21490000
*********************************************************************** 21500000
*                                                                     * 21510000
*                   TASK STORAGE FOR SOCKETS EXTENDED                 * 21520000
*                                                                     * 21530000
*********************************************************************** 21540000
*                                                                       21550000
E$SMI    DC    F'-1'        EZASMI Indicator                   @D65CDHH         
E$ASMH00 DC    F'0'         ADDRESS OF EZASOH00                @D65CDHH 21555000
E$ASMTOK DC    XL16'00'     TOKEN FIELD FOR USE BY EZASOHO3             21560000
TIECLEN  EQU   *-EZASMTIE   COPY LENGTH FOR SKREAD/SKWRITE SUBR@D66JDHH         
E$APARMS DC    30F'0'       PARAMETER LIST FOR ASSEMBLER MACROS         21574990
E$APLEN  EQU   *-E$APARMS   LENGTH OF PARAMETER LIST                    21580000
&TIEGEN  SETB  1                                                        21590000
         AGO   .LIST02  Go generate parameter list and work areas       21600000
.*--------------------------------------------------------------------* 21610000
.*  Process for MF=L                                                  * 21620000
.*--------------------------------------------------------------------* 21630000
.LIST00  ANOP     Process MF=L                                          21640000
         AIF  (K'&LABEL NE 0).LIST01  Check for label                   21650000
         MNOTE 12,'EZAXXX LABEL MUST BE SPECIFIED ON LIST MACRO'        21660000
         MEXIT                                                          21670000
.LIST01  ANOP                                                           21680000
&LABEL   DS    0D                                                       21690000
         DC    30F'0'    MACRO PARAMETER LIST         +000 to +116      21700000
.LIST02  ANOP                                                           21710000
*                                                                       21720000
         DC    F'0'  WORK FIELD FOR SOCKET CONVERSIONS E$USOCK +120     21730000
         DC    F'0'  WORK FIELD FOR SOCKET CONVERSIONS E$TSOCK +124     21740000
         DC    F'0'  WORK FIELD FOR ERRNO RETURN E$ERRNO       +128     21750000
         DC    F'0'  WORK FIELD FOR RETCODE RETURN E$RETCDE    +132     21760000
         DC    F'0'  WORK FIELD FOR LOM CALCULATION E$ASMLOM   +136     21770000
         DC    XL16'00' DUMMY FIELD FOR UNSPECIFIED VALUES     +140     21780000
         DS    0D    FORCE DOUBLEWORD LENGTH                            21790000
         AIF   (NOT &TIEGEN).LIST03                                     21800000
*                                                                       21810000
TIEEND   EQU   * END OF THE TASK INTERFACE ELEMENT (TIE) APPENDAGE ...  21820000
TIELENTH EQU   TIEEND-EZASMTIE LENGTH OF THIS TIE APPENDAGE ...         21830000
.LIST03  ANOP                                                           21840000
.TYPEQU  ANOP                                                 @D65CDHH          
         AIF   ('&MACFORM' NE 'S').LIST04  Not standard form  @DY45684          
* ERRNO values returned by EZASMI/EZASOKET interface          @D65CDHH          
EZAINVFU EQU   20000  Invalid Function for EZASOKET           @D65CDHH          
EZAINVPA EQU   20001  Incorrect parameters for EZASOKET       @D65CDHH          
EZAERL00 EQU   20100  Error loading EZASOH00                  @D65CDHH          
EZAERL03 EQU   20101  Error loading EZASOH03                  @D65CDHH          
EZAERPII EQU   20102  Init of LE CEEPIPI environment failed   @D65CDHH          
EZAERPIC EQU   20103  Call to LE CEEPIPI environment failed   @D65CDHH          
EZAERPIT EQU   20104  Termination of LE CEEPIPI failed        @D65CDHH          
EZAERGTS EQU   20105  LE CEEGTST call failed                  @D65CDHH          
EZAERL01 EQU   20106  Error loading EZASOH01                  @D65CDHH          
EZAERGTV EQU   20107  Not enough partition GETVIS             @D65CDHH          
EZAERNIN EQU   20108  First call not INITAPI                  @D65CDHH          
EZAERNLE EQU   20109  Non-LE call under CICS                  @D65CDHH          
EZAERLPI EQU   20110  Error loading CEEPIPI                   @D65CDHH          
.LIST04  ANOP                                                 @DY45684          
         MEXIT                                                          21850000
.*--------------------------------------------------------------------* 21860000
.*  Process for TYPE=WRITE                                            * 21870000
.*--------------------------------------------------------------------* 21880000
.HWRT0   ANOP     Process TYPE=WRITE                                    21890000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             21900000
&HC2     SETC  '&CONST'                                                 21910000
         ST    0,16(1)            Address of S parameter                21920000
.*  Process NBYTE Parameter                                             21930000
         EZASMIS &NBYTE,F,32767,1,&SYSNDX                               21940000
&FC1     SETC  '&CONST'                                                 21950000
         ST    0,20(1)            Address of NBYTE parameter            21960000
.*  Process BUF Parameter                                               21970000
         EZASMIL &BUF                                                   21980000
         ST    0,24(1)            Address of BUF parameter              21990000
.*  Process ALET Parameter                                              22000000
         AIF   (K'&ALET NE 0).HWRT05  Was ALET Specified                22010000
         SLR   0,0                ALET not specified                    22020000
         AGO   .HWRT10                                                  22030000
.HWRT05  ANOP                                                           22040000
         EZASMIL &ALET                                                  22050000
.HWRT10  ANOP                                                           22060000
         ST    0,28(1)            Address of ALET parameter             22070000
.*  Process ECB or REQAREA  parameter                                   22080000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              22090000
         ST    0,32(1)            Address of ECB/REQAREA parameter      22100000
         OI    32(1),X'80'        Indicate last parameter               22110000
         AGO   .HPARM00           Go put out final instructions         22120000
.*--------------------------------------------------------------------* 22130000
.*  Process for TYPE=WRITEV                                           * 22140000
.*--------------------------------------------------------------------* 22150000
.HWTV0   ANOP     Process TYPE=WRITEV                                   22160000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             22170000
&HC2     SETC  '&CONST'                                                 22180000
         ST    0,16(1)            Address of S parameter                22190000
.*  Process IOVCNT Parameter                                            22200000
         EZASMIS &IOVCNT,F,32767,1,&SYSNDX                              22210000
&FC1     SETC  '&CONST'                                                 22220000
         ST    0,20(1)            Address of IOVCNT parameter           22230000
.*  Process IOV Parameter                                               22240000
         EZASMIL &IOV                                                   22250000
         ST    0,24(1)            Address of IOV parameter              22260000
.*  Process ECB or REQAREA  parameter                                   22270000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              22280000
         ST    0,28(1)            Address of ECB/REQAREA parameter      22290000
         OI    28(1),X'80'        Indicate last parameter               22300000
         AGO   .HPARM00           Go put out final instructions         22310000
.*--------------------------------------------------------------------* 22320000
.*  Process for TYPE=GETCLIENTID.                                     * 22330000
.*--------------------------------------------------------------------* 22340000
.HGCI0   ANOP     Process TYPE=GETCLIENDID                              22350000
.*  Process CLIENT parameter                                            22360000
         EZASMIL &CLIENT                                                22370000
         ST    0,16(1)            Address of CLIENT parameter           22380000
.*  Process ECB or REQAREA  parameter                                   22390000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              22400000
         ST    0,20(1)            Address of ECB/REQAREA parameter      22410000
         OI    20(1),X'80'        Indicate last parameter               22420000
         AGO   .HPARM00           Go put out final instructions         22430000
.*--------------------------------------------------------------------* 22440000
.*  Process for TYPE=GIVESOCKET.                                      * 22450000
.*--------------------------------------------------------------------* 22460000
.HGVS0   ANOP     Process TYPE=GIVESOCKET                               22470000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter             22480000
&HC2     SETC  '&CONST'                                                 22490000
         ST    0,16(1)            Address of S parameter                22500000
.*  Process CLIENT parameter                                            22510000
         EZASMIL &CLIENT                                                22520000
         ST    0,20(1)            Address of CLIENT parameter           22530000
.*  Process ECB or REQAREA  parameter                                   22540000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              22550000
         ST    0,24(1)            Address of ECB/REQAREA parameter      22560000
         OI    24(1),X'80'        Indicate last parameter               22570000
         AGO   .HPARM00           Go put out final instructions         22580000
.*--------------------------------------------------------------------* 22590000
.*  Process for TYPE=TAKESOCKET                                       * 22600000
.*--------------------------------------------------------------------* 22610000
.HTKS0   ANOP     Process TYPE=TAKESOCKET                               22620000
.*  Process CLIENT parameter                                            22630000
         EZASMIL &CLIENT                                                22640000
         ST    0,16(1)            Address of CLIENT parameter           22650000
.*  Process SOCRECV parameter                                           22660000
         EZASMIL &SOCRECV,14                                       @P4C 22670000
         LH    0,0(14)            Put halfword value in Reg 0      @P4C 22680000
         ST    0,124(1)           Store it as fullword                  22690000
         LA    0,124(1)           Get address of fullword value         22700000
         ST    0,20(1)            Address of SOCRECV parameter          22710000
.*  Process NS parameter                                                22720000
         AIF   (K'&NS NE 0).HTKS10 Was NS Specified                     22730000
         SLR   0,0                Parameter was not specified           22740000
         AGO   .HTKS20                                                  22750000
.HTKS10  ANOP                                                           22760000
         EZASMIS &NS,H,4095,2,&SYSNDX,14 Go process NS parameter   @P4C 22770000
&HC2     SETC  '&CONST'                                                 22780000
         LH    0,0(14)            Put halfword value in Reg 0      @P4C 22790000
         ST    0,120(1)          Store it as fullword                   22800000
.HTKS15  ANOP                                                      @P4A 22810000
         LA    0,120(1)      Get address of fullword socket number @P4A 22820000
.HTKS20  ANOP                                                           22830000
         ST    0,24(1)            Address of NS parameter               22840000
.*  Process ECB or REQAREA  parameter                                   22850000
         EZASMIA &ECB,&REQAREA,ECB,REQAREA                              22860000
         ST    0,28(1)            Address of ECB/REQAREA parameter      22870000
         OI    28(1),X'80'        Indicate last parameter               22880000
         AGO   .HPARM00           Go put out final instructions         22890000
.*--------------------------------------------------------------------* 22900000
.*  Process for TYPE=TERMAPI                                          * 22910000
.*--------------------------------------------------------------------* 22920000
.HTRM0   ANOP     Process TYPE=TERMAPI                                  22930000
         OI    12(1),X'80'       MARK LAST PARAMETER                    22940000
         AGO   .HPARM00           Go put out final instructions         22950000
.*--------------------------------------------------------------------* 22960000
.*  Process for TYPE=GETIBMOPT/SETIBMOPT                              * 22970000
.*--------------------------------------------------------------------* 22980000
.GIBM0   ANOP     Process TYPE=GETIBMOPT                                22990000
.SIBM0   ANOP     Process TYPE=SETIBMOPT                                23000000
.*  Process COMMAND parameter                                           23010000
         EZASMIS &COMMAND,F,255,2,&SYSNDX                               23020000
&FC2     SETC  '&CONST'                                                 23030000
         ST    0,16(1)            Address of COMMAND parameter          23040000
.*  Process BUF parameter                                               23050000
         EZASMIL &BUF                                                   23060000
         ST    0,20(1)            Address of BUF parameter              23070000
         OI    20(1),X'80'        Mark last parameter                   23080000
         AGO   .HPARM00           Go put out final instructions         23090000
.*--------------------------------------------------------------------* 23100000
.*  Process for TYPE=GETHOSTBYNAME                                    * 23110000
.*--------------------------------------------------------------------* 23120000
.HGBN0   ANOP     Process TYPE=GETHOSTBYNAME                            23130000
.*  Process NAMELEN parameter                                           23140000
         EZASMIS &NAMELEN,F,255,2,&SYSNDX                          @01C 23150000
&FC2     SETC  '&CONST'                                            @01C 23160000
         ST    0,16(1)            Address of NAMELEN parameter          23170000
.*  Process NAME parameter                                              23180000
         EZASMIL &NAME                                                  23190000
         ST    0,20(1)            Address of NAME parameter             23200000
.*  Process HOSTENT parameter                                           23210000
         EZASMIL &HOSTENT                                               23220000
         ST    0,24(1)            Address of HOSTENT parameter          23230000
         OI    24(1),X'80'        Mark last parameter                   23240000
         AGO   .HPARM00           Go put out final instructions         23250000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GETHOSTBYADDR                                    * 23270000
.*--------------------------------------------------------------------* 23280000
.HGBA0   ANOP     Process TYPE=GETHOSTBYADDR                            23290000
.*  Process HOSTADDR parameter                                          23300000
         EZASMIL &HOSTADR                                               23310000
         ST    0,16(1)            Address of HOSTADDR parameter         23320000
.*  Process HOSTENT parameter                                           23330000
         EZASMIL &HOSTENT                                               23340000
         ST    0,20(1)            Address of HOSTENT parameter          23350000
         OI    20(1),X'80'        Mark last parameter                   23360000
         AGO   .HPARM00           Go put out final instructions         23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKINIT                                  @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKIN0 ANOP     Process TYPE=GSKINIT                         @D66JDHH 23290000
.*  Process SECTYPE parameter                                  @D66JDHH 23300000
         EZASMIL  &SECTYPE                                     @D66JDHH         
         ST    0,16(1)            Address of SECTYPE parm      @D66JDHH         
.*  Process KEYRING parameter                                  @D66JDHH 23300000
         AIF   (K'&KEYRING NE 0).HGSKIN3  KEYRING spec?        @D66JDHH 17660000
         SLR   0,0                KEYRING not specified        @D66JDHH 17670000
         AGO   .HGSKIN4                                        @D66JDHH 17680000
.HGSKIN3 ANOP                                                  @D66JDHH         
         EZASMIL  &KEYRING                                     @D66JDHH         
.HGSKIN4 ANOP                                                  @D66JDHH         
         ST    0,20(1)            Address of KEYRING parm      @D66JDHH         
.*  Process V3TIMEOUT parameter                                @D66JDHH 17650000
         AIF   (K'&V3TIMEOUT NE 0).HGSKIN5  V3TIMEOUT spec?    @D66JDHH 17660000
         SLR   0,0                V3TIMEOUT not specified      @D66JDHH 17670000
         AGO   .HGSKIN6                                        @D66JDHH 17680000
.HGSKIN5 ANOP                                                  @D66JDHH 17690000
         EZASMIS &V3TIMEOUT,F,86401,1,&SYSNDX  Proc V3TIMEOUT  @D66JDHH 21900000
&FC1     SETC  '&CONST'                                        @D66JDHH 21910000
.HGSKIN6 ANOP                                                  @D66JDHH 17710000
         ST    0,24(1)            Address of V3TIMEOUT parm    @D66JDHH 17720000
.*  Process CAROOTS parameter                                  @D66JDHH 17650000
         AIF   (K'&CAROOTS NE 0).HGSKIN7  CAROOTS spec?        @D66JDHH 17660000
         SLR   0,0                CAROOTS not specified        @D66JDHH 17670000
         AGO   .HGSKIN8                                        @D66JDHH 17680000
.HGSKIN7 ANOP                                                  @D66JDHH 17690000
         EZASMIS &CAROOTS,F,2,2,&SYSNDX  Proc CAROOTS          @D66JDHH 21900000
&FC2     SETC  '&CONST'                                        @D66JDHH 21910000
.HGSKIN8 ANOP                                                  @D66JDHH 17710000
         ST    0,28(1)            Address of CAROOTS parm      @D66JDHH 17720000
.*  Process AUTHTYPE  parameter                                @D66JDHH 17650000
         AIF   (K'&AUTHTYPE NE 0).HGSKIN9  AUTHTYPE spec?      @D66JDHH 17660000
         SLR   0,0                AUTHTYPE not specified       @D66JDHH 17670000
         AGO   .HGSKINA                                        @D66JDHH 17680000
.HGSKIN9 ANOP                                                  @D66JDHH 17690000
         EZASMIS &AUTHTYPE,F,4,3,&SYSNDX  Proc AUTHTYPE        @D66JDHH 21900000
&FC3     SETC  '&CONST'                                        @D66JDHH 21910000
.HGSKINA ANOP                                                  @D66JDHH 17710000
         ST    0,32(1)            Address of AUTHTYPE  parm    @D66JDHH 17720000
         OI    32(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKUNINIT                                @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKUI0 ANOP     Process TYPE=GSKUNINIT                       @D66JDHH 23290000
         OI    12(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKGETCIPHINF                            @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKGC0 ANOP     Process TYPE=GSKGETCIPHINF                   @D66JDHH 23290000
.*  Process CIPHLEVEL parameter                                @D66JDHH 23300000
         EZASMIS &CIPHLEVEL,F,3,2,&SYSNDX  Proc CIPHLEVEL Parm @D66JDHH 21900000
&FC2     SETC  '&CONST'                                        @D66JDHH 21910000
         ST    0,16(1)            Address of CIPHLEVEL parm    @D66JDHH         
.*  Process SECLEVEL parameter                                 @D66JDHH 23300000
         EZASMIL  &SECLEVEL                                    @D66JDHH         
         ST    0,20(1)            Address of SECLEVEL parm     @D66JDHH         
         OI    20(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKSSOCINIT                              @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKSI0 ANOP     Process TYPE=GSKSSOCINIT                     @D66JDHH 23290000
         EZASMIS &S,H,4095,2,&SYSNDX Go process S parameter    @D66JDHH 21900000
&HC2     SETC  '&CONST'                                        @D66JDHH 21910000
         ST    0,16(1)            Address of S parameter       @D66JDHH 21920000
.*  Process HANDSHAKE parameter                                @D66JDHH 23300000
         EZASMIS &HANDSHAKE,F,4,1,&SYSNDX   Process Handshake  @D66JDHH 21900000
&FC1     SETC  '&CONST'                                        @D66JDHH 21910000
         ST    0,20(1)            Address of HANDSHAKE parm    @D66JDHH         
.*  Process DNAME parameter                                    @D66JDHH 17650000
         AIF   (K'&DNAME NE 0).HGSKSI1  DANME spec?            @D66JDHH 17660000
         SLR   0,0                DNAME not specified          @D66JDHH 17670000
         AGO   .HGSKSI2                                        @D66JDHH 17680000
.HGSKSI1 ANOP                                                  @D66JDHH 17690000
         EZASMIL &DNAME                                        @D66JDHH 17700000
.HGSKSI2 ANOP                                                  @D66JDHH 17710000
         ST    0,24(1)            Address of DNAME parameter   @D66JDHH 17720000
.*  Process SECTYPE parameter                                  @D66JDHH 23300000
         EZASMIL  &SECTYPE                                     @D66JDHH         
         ST    0,28(1)            Address of SECTYPE parm      @D66JDHH         
.*  Process V3CIPHER parameter                                 @D66JDHH 17650000
         AIF   (K'&V3CIPHER NE 0).HGSKSI5  V3CIPHER spec?      @D66JDHH 17660000
         SLR   0,0                V3CIPHER not specified       @D66JDHH 17670000
         AGO   .HGSKSI6                                        @D66JDHH 17680000
.HGSKSI5 ANOP                                                  @D66JDHH 17690000
         EZASMIL &V3CIPHER                                     @D66JDHH 17700000
.HGSKSI6 ANOP                                                  @D66JDHH 17710000
         ST    0,32(1)            Address of V3CIPHER parm     @D66JDHH 17720000
.*  Process V3CIPHSEL parameter                                @D66JDHH 23300000
         EZASMIL  &V3CIPHSEL                                   @D66JDHH         
         ST    0,36(1)            Address of V3CIPHSEL parm    @D66JDHH         
.*  Process CERTINFO  parameter                                @D66JDHH 23300000
         AIF   (K'&CERTINFO NE 0).HGSKSIB  CERTINFO spec?      @D66JDHH 17660000
         SLR   0,0                V3CIPHER not specified       @D66JDHH 17670000
         AGO   .HGSKSIC                                        @D66JDHH 17680000
.HGSKSIB ANOP                                                  @D66JDHH 17690000
         EZASMIL  &CERTINFO                                    @D66JDHH         
.HGSKSIC ANOP                                                  @D66JDHH 17690000
         ST    0,40(1)            Address of CERTINFO parm     @D66JDHH         
.*  Process REASCODE  parameter                                @D66JDHH 23300000
         EZASMIL  &REASCODE                                    @D66JDHH         
         ST    0,44(1)            Address of REASCODE parm     @D66JDHH         
.*  Process SKREAD parameter                                   @D66JDHH 17650000
         AIF   (K'&SKREAD NE 0).HGSKSI7  SKREAD spec?          @D66JDHH 17660000
         SLR   0,0                SKREAD not specified         @D66JDHH 17670000
         AGO   .HGSKSI8                                        @D66JDHH 17680000
.HGSKSI7 ANOP                                                  @D66JDHH 17690000
         EZASMIL &SKREAD                                       @D66JDHH 17700000
.HGSKSI8 ANOP                                                  @D66JDHH 17710000
         ST    0,48(1)            Address of SKREAD parm       @D66JDHH 17720000
.*  Process SKWRITE parameter                                  @D66JDHH 17650000
         AIF   (K'&SKWRITE NE 0).HGSKSI9  SKWRITE spec?        @D66JDHH 17660000
         SLR   0,0                SKWRITE not specified        @D66JDHH 17670000
         AGO   .HGSKSIA                                        @D66JDHH 17680000
.HGSKSI9 ANOP                                                  @D66JDHH 17690000
         EZASMIL &SKWRITE                                      @D66JDHH 17700000
.HGSKSIA ANOP                                                  @D66JDHH 17710000
         ST    0,52(1)            Address of SKWRITE parm      @D66JDHH 17720000
         OI    52(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKSSOCREAD                              @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKSR0 ANOP     Process TYPE=GSKSSOCREAD                     @D66JDHH 23290000
.*  Process SSOCDATA parameter                                 @D66JDHH 23300000
         EZASMIL  &SSOCDATA                                    @D66JDHH         
         ST    0,16(1)            Address of SSOCDATA parm     @D66JDHH         
.*  Process NBYTE Parameter                                    @D66JDHH 21930000
         EZASMIS &NBYTE,F,32767,1,&SYSNDX                      @D66JDHH 21940000
&FC1     SETC  '&CONST'                                        @D66JDHH 21950000
         ST    0,20(1)            Address of NBYTE parameter   @D66JDHH 21960000
.*  Process BUF parameter                                      @D66JDHH 23300000
         EZASMIL  &BUF                                         @D66JDHH         
         ST    0,24(1)            Address of BUF parm          @D66JDHH         
         OI    24(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKSSOCWRITE                             @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKSW0 ANOP     Process TYPE=GSKSSOCWRITE                    @D66JDHH 23290000
.*  Process SSOCDATA parameter                                 @D66JDHH 23300000
         EZASMIL  &SSOCDATA                                    @D66JDHH         
         ST    0,16(1)            Address of SSOCDATA parm     @D66JDHH         
.*  Process NBYTE Parameter                                    @D66JDHH 21930000
         EZASMIS &NBYTE,F,32767,1,&SYSNDX                      @D66JDHH 21940000
&FC1     SETC  '&CONST'                                        @D66JDHH 21950000
         ST    0,20(1)            Address of NBYTE parameter   @D66JDHH 21960000
.*  Process BUF parameter                                      @D66JDHH 23300000
         EZASMIL  &BUF                                         @D66JDHH         
         ST    0,24(1)            Address of BUF parm          @D66JDHH         
         OI    24(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKSSOCCLOSE                             @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKSC0 ANOP     Process TYPE=GSKSSOCCLOSE                    @D66JDHH 23290000
.*  Process SSOCDATA parameter                                 @D66JDHH 23300000
         EZASMIL  &SSOCDATA                                    @D66JDHH         
         ST    0,16(1)            Address of SSOCDATA parm     @D66JDHH         
         OI    16(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKSSOCRESET                             @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKST0 ANOP     Process TYPE=GSKSSOCRESET                    @D66JDHH 23290000
.*  Process SSOCDATA parameter                                 @D66JDHH 23300000
         EZASMIL  &SSOCDATA                                    @D66JDHH         
         ST    0,16(1)            Address of SSOCDATA parm     @D66JDHH         
         OI    16(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKGETDNBYLAB                            @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKGD0 ANOP     Process TYPE=GSKGETDNBYLAB                   @D66JDHH 23290000
.*  Process KEYLABEL parameter                                 @D66JDHH 23300000
         EZASMIL  &KEYLABEL                                    @D66JDHH         
         ST    0,16(1)            Address of KEYLABEL parm     @D66JDHH         
         OI    16(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23260000
.*  Process for TYPE=GSKFREEMEM                               @D66JDHH* 23270000
.*--------------------------------------------------------------------* 23280000
.HGSKFM0 ANOP     Process TYPE=GSKFREEMEM                      @D66JDHH 23290000
.*  Process AREA parameter                                     @D66JDHH 23300000
         EZASMIL  &AREA                                        @D66JDHH         
         ST    0,16(1)            Address of AREA parm         @D66JDHH         
         OI    16(1),X'80'        Mark last parameter          @D66JDHH 23360000
         AGO   .HPARM00           Go put out final instruction @D66JDHH 23370000
.*--------------------------------------------------------------------* 23380000
.*  Common Process for final instructions - HPNS                      * 23390000
.*--------------------------------------------------------------------* 23400000
.HPARM00 ANOP                                                           23410000
         AIF   ('&MACFORM' EQ 'N').GENCON MF=N does not generate call   23420000
.*----------------------------------------------------------------*@A2A 23430890
.*  Develop instructions to make task storage addressable         *@A2A 23431780
.*----------------------------------------------------------------*@A2A 23432670
         AIF   (K'&TASK NE 0).TASK30  Task was not specified       @A2A 23433560
         LA    14,EZASMTIE        Get address of task storage  @D65CDHH 23434450
         AGO   .TASK40                                             @A2A 23435340
.TASK30  ANOP                                                      @A2A 23436230
         EZASMIL &TASK,14                                      @D65CDHH 23437120
.TASK40  ANOP                                                      @A2A 23438010
         L     15,E$ASMH00-EZASMTIE(14) Get addr of EZASOH00   @D65CDHH  3438900
         LTR   15,15              Has it been loaded                    23440000
         BNE   E$T1&SYSNDX                                              23450000
.*  Check for a valid 'first' function and load EZASOH00 if needed      23460000
         AIF   ('&CMD' EQ '00').HPARMST  INITAPI                        23470000
         AIF   ('&CMD' EQ '07').HPARMST  GETHOSTID                      23480000
         AIF   ('&CMD' EQ '08').HPARMST  GETHOSTNAME                    23490000
         AIF   ('&CMD' EQ '19').HPARMST  SELECT                         23500000
         AIF   ('&CMD' EQ '25').HPARMST  SOCKET                         23510000
         AIF   ('&CMD' EQ '30').HPARMST  GETCLIENTID                    23520000
         AIF   ('&CMD' EQ '32').HPARMST  TAKESOCKET                     23530000
         AIF   ('&CMD' EQ '37').HPARMST  SELECTEX                       23540000
         AIF   ('&CMD' EQ '38').HPARMST  GETIBMOPT                      23550000
         AIF   ('&CMD' EQ '39').HPARMST  SETIBMOPT                      23560000
         AIF   ('&CMD' EQ '40').HPARMST  GETHOSTBYNAME                  23570000
         AIF   ('&CMD' EQ '41').HPARMST  GETHOSTBYADDR                  23580000
         LM    14,15,04(1)   Get address of ERRNO/RETCODE fields        23590000
         MVC   0(4,15),E$R2&SYSNDX Move return code to field            23600000
         L     15,E$R2&SYSNDX     Set R15 to -1                    @03A 23606000
         AIF   (K'&ERRNO EQ 0).HPARMN2 macro may have no ERRNO parm     23610000
&RC1     SETC  'F''20108'''                                    @D65CDHH 23620000
         MVC   0(4,14),E$R1&SYSNDX Move error number to field           23630000
.HPARMN2 ANOP                                                           23640000
.*       B     E$SE&SYSNDX        Return error to user                  23650000
         AGO   .HPARMS1                                                 23660000
.HPARMST ANOP                                                           23670000
&LOAD    SETB  1                  Issuing load macro                    23680000
         CDLOAD EZASOH00,RETPNF=YES  LOAD EZASOH00 phase       @D65CDHH 23700000
         AIF   (K'&TASK NE 0).TASK50  Task was not specified   @D65CDHH         
         LA    14,EZASMTIE           Get addr of task storage  @D65CDHH         
         AGO   .TASK60                                         @D65CDHH         
.TASK50  ANOP                                                  @D65CDHH         
         EZASMIL &TASK,14                                      @D65CDHH         
.TASK60  ANOP                                                  @D65CDHH         
         LTR   15,15              CDLOAD of EZASOH00 successful ?       23730000
         BZ    E$SL&SYSNDX        Yes, go use it                        23740000
         LA    14,E$APARMS-EZASMTIE(14)  Use plist in task stg @D65CDHH 08350000
         LM    14,15,4(14)        Get ERRNO/RETCODE addresses           23750000
         MVC   0(4,15),E$R2&SYSNDX Move -1 to field                     23760000
         L     15,E$R2&SYSNDX     Set R15 to -1                    @03A 23766000
         AIF   (K'&ERRNO EQ 0).HPARMS1 macro may have no ERRNO parm     23770000
&RC1     SETC  'F''20100'''                                    @D65CDHH 23780000
         MVC   0(4,14),E$R1&SYSNDX Move error number to field           23790000
.HPARMS1 ANOP                                                           23800000
         AIF   (K'&ERROR EQ 0).HPARME1  Was ERROR specified             23810000
         AIF   ('&ERROR'(1,1) NE '(').ERREG1  Passed as register?       23820000
&TEMPCH  SETC  '&ERROR'(2,K'&ERROR-2)                                   23830000
         BR    &TEMPCH            Branch to user error routine          23840000
         AGO   .HPARMEE                                                 23850000
.ERREG1  ANOP                                                           23860000
         AIF   ('&ERROR'(1,1) NE '*').ERREG2  Indirect address?         23870000
&TEMPCH  SETC  '&ERROR'(2,K'&ERROR-1) Yes, set the variable name        23880000
         LA    14,&TEMPCH         Get the address                       23890000
         BR    14                 Branch to user error routine          23900000
         AGO   .HPARMEE                                                 23910000
.ERREG2  ANOP                                                           23920000
         B     &ERROR             Branch to user error routine          23930000
         AGO   .HPARMEE                                                 23940000
.HPARME1 ANOP                                                           23950000
         B     E$T2&SYSNDX                                              23960000
.HPARMEE ANOP                                                           23970000
         AIF   (NOT &LOAD).HPARMEF                                      23980000
&TEMPCH  SETC  'E$SL'.'&SYSNDX'                                         23990000
&TEMPCH  DS    0H                                                       24000000
         MVC   E$SMI-EZASMTIE(4,14),E$R2&SYSNDX  Set indicator @D65CDHH         
         ST    1,E$ASMH00-EZASMTIE(14) Save addr of EZASOH00   @D65CDHH  4028900
         LR    15,1                    Copy addr of EZASOH00   @D65CDHH  4030000
.HPARMEF ANOP                                                           24040000
&TEMPCH  SETC  'E$T1'.'&SYSNDX'                                         24050000
&TEMPCH  DS    0H                                                       24060000
         AIF   ('&MACFORM' EQ 'E').TASK65  EXECUTE Form?       @DY45684         
         LR    1,14                    Copy addr of WorkArea   @D65CDHH         
         AGO   .TASK66                                         @DY45684         
.TASK65  ANOP                                                  @DY45684         
         EZASMIL &MF(2),1              get addr of Parm List   @DY45684         
.TASK66  ANOP                                                  @DY45684         
         BASSM 14,15                   Go to EZASOH00          @D65CDHH 24070000
         AIF   ('&CMD' NE '36').DONTDEL TERMAPI?                   @A1A 24072000
         CDDELETE EZASOH00        Decrement CDE use count      @D65CDHH 24074000
.*----------------------------------------------------------------*@A2A 24076090
.*  Develop instructions to make task storage addressable         *@A2A 24076180
.*----------------------------------------------------------------*@A2A 24076270
         AIF   (K'&TASK NE 0).TASK70  Task was not specified       @A2A 24076360
         LA    15,EZASMTIE        Get address of task storage      @A2A 24076450
         AGO   .TASK80                                             @A2A 24076540
.TASK70  ANOP                                                      @A2A 24076630
         EZASMIL &TASK,15                                          @A2A 24076720
.TASK80  ANOP                                                      @A2A 24076810
         SLR   0,0                     Clear reg for store         @A2A 24076900
         ST    0,E$ASMH00-EZASMTIE(15) Clear EZASOH00 pointer  @D65CDHH 24076990
.DONTDEL ANOP                                                      @A1A 24078000
.HINE01  ANOP                                                           24080000
.*--------------------------------------------------------------------* 24090000
.*  Common Process for constants - HPNS                               * 24100000
.*--------------------------------------------------------------------* 24110000
.GENCON  ANOP                                                           24120000
         B     E$T2&SYSNDX                                              24130000
         AIF   (K'&CC2 EQ 0).CC2                                        24140000
&TEMPCH  SETC  'E$C2'.'&SYSNDX'                                         24150000
&TEMPCH  DC    &CC2                                                     24160000
.CC2     AIF   (K'&CC3 EQ 0).CC3                                        24170000
&TEMPCH  SETC  'E$C3'.'&SYSNDX'                                         24180000
&TEMPCH  DC    &CC3                                                     24190000
.CC3     ANOP                                                           24200000
         AIF   (K'&RC1 EQ 0).RC1                                        24210000
&TEMPCH  SETC  'E$R1'.'&SYSNDX'                                         24220000
&TEMPCH  DC    &RC1                                                     24230000
.RC1     ANOP                                                           24240000
&TEMPCH  SETC  'E$R2'.'&SYSNDX'                                         24250000
&TEMPCH  DC    F'-1'                                                    24260000
         AIF   (K'&FC1 EQ 0).FC1                                        24270000
&TEMPCH  SETC  'E$F1'.'&SYSNDX'                                         24280000
&TEMPCH  DC    &FC1                                                     24290000
.FC1     AIF   (K'&FC2 EQ 0).FC2                                        24300000
&TEMPCH  SETC  'E$F2'.'&SYSNDX'                                         24310000
&TEMPCH  DC    &FC2                                                     24320000
.FC2     AIF   (K'&FC3 EQ 0).FC3                                        24330000
&TEMPCH  SETC  'E$F3'.'&SYSNDX'                                         24340000
&TEMPCH  DC    &FC3                                                     24350000
.FC3     AIF   (K'&FC4 EQ 0).FC4                                        24360000
&TEMPCH  SETC  'E$F4'.'&SYSNDX'                                         24370000
&TEMPCH  DC    &FC4                                                     24380000
.FC4     AIF   (K'&FC5 EQ 0).FC5                                        24390000
&TEMPCH  SETC  'E$F5'.'&SYSNDX'                                         24400000
&TEMPCH  DC    &FC5                                                     24410000
.FC5     ANOP                                                           24420000
&TEMPCH  SETC  'E$H1'.'&SYSNDX'                                         24430000
&TEMPCH  DC    H'&CMD'                                                  24440000
         AIF   (K'&HC2 EQ 0).HC2                                        24450000
&TEMPCH  SETC  'E$H2'.'&SYSNDX'                                         24460000
&TEMPCH  DC    &HC2                                                     24470000
.HC2     AIF   (K'&HC3 EQ 0).HC3                                        24480000
&TEMPCH  SETC  'E$H3'.'&SYSNDX'                                         24490000
&TEMPCH  DC    &HC3                                                     24500000
.HC3     AIF   (K'&HC4 EQ 0).HC4                                        24510000
&TEMPCH  SETC  'E$H4'.'&SYSNDX'                                         24520000
&TEMPCH  DC    &HC4                                                     24530000
.HC4     ANOP                                                           24540000
&TEMPCH  SETC  'E$T2'.'&SYSNDX'                                         24550000
&TEMPCH  DS    0H                                                       24560000
*---------------------------------------------------------------------* 24570000
         MEND                                                           24580000
