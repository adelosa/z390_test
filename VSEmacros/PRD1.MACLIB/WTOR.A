*/********************************************************************/ 00000100
*/*                                                                  */ 00000200
*/* MACRO NAME=       WTOR                                   @G860PSS*/ 00000300
*/*                                                                  */ 00000400
*/* DESCRIPTIVE NAME= WRITE TO OPERATOR WITH REPLY (WTOR)    @G860PSS*/ 00000500
*/*                                                                  */ 00000600
*/* COPYRIGHT=                                                   @01C*/ 00000700
*/*                   5695-047                                   @L5C*/ 00000800
*/*                   THIS MODULE IS "RESTRICTED MATERIALS OF IBM"   */ 00000900
*/*                   (C) COPYRIGHT IBM CORP. 1981, 1990             */ 00001000
*/*                   LICENSED MATERIALS - PROPERTY OF IBM           */ 00001100
*/*                                                                  */ 00001200
*/* STATUS=           HBB4410                                    @L5C*/ 00001300
*/*                                                                  */ 00001400
*/* METHOD OF ACCESS=                                                */ 00001500
*/*                   BAL  - SPECIFY WTOR                    @G860PSS*/ 00001600
*/*                                                                  */ 00001700
*/* INVOCATION=                                                  @L1A*/ 00001800
*/*              SPECIFY WTOR MESG,RYAD,LENGTH,ECB,              @L1A*/ 00001900
*/*                           DESC=,MSGTYP=,MCSFLAG=,QID=,MF=,   @L1A*/ 00002000
*/*                           CONSID=,JOBID=,KEY=,TOKEN=,        @L1A*/ 00002100
*/*                           SYSNAME=,JOBNAME=,ROUTCDE=,        @01C*/ 00002200
*/*                           CONSNAME=,RPLYISUR=,CART=,         @L4C*/ 00002300
*/*                           LINKAGE=,SYNCH=,                   @L5A*/ 00002400
*/*                           TEXT=(ADDRESS,RYAD,LENGTH,ECB)     @L4A*/ 00002500
*/*                                                                  */ 00002600
*/*                                    OR                        @L1A*/ 00002700
*/*                                                                  */ 00002800
*/*                      WTOR WQEBLK=                            @L1A*/ 00002900
*/*                                                                  */ 00003000
*/*             WHERE:                                           @L1A*/ 00003100
*/*               MESG     THE MESSAGE TEXT FOR A MESSAGE        @L1A*/ 00003200
*/*                        TO BE WRITTEN.                        @L1A*/ 00003300
*/*                                                                  */ 00003400
*/*               RYAD     THE MESSAGE'S REPLY ADDRESS           @L1A*/ 00003500
*/*                                                                  */ 00003600
*/*               LENGTH   THE MESSAGE'S REPLY LENGTH            @L1A*/ 00003700
*/*                                                                  */ 00003800
*/*               ECB      THE MESSAGE'S ECB ADDRESS             @L1A*/ 00003900
*/*                                                                  */ 00004000
*/*                                                                  */ 00004100
*/*               ROUTCDE= ROUTING CODES TO BE ASSIGNED TO THE   @L1A*/ 00004200
*/*                        MESSAGE.                              @L1A*/ 00004300
*/*                                                                  */ 00004400
*/*               DESC=    DESCRIPTOR CODES TO BE ASSIGNED TO    @L1A*/ 00004500
*/*                        THE MESSAGE.                          @L1A*/ 00004600
*/*                                                                  */ 00004700
*/*               MSGTYP=  SPECIFIES HOW THE MESSAGE IS TO BE    @L1A*/ 00004800
*/*                        ROUTED. VALID VALUES ARE:             @L1A*/ 00004900
*/*                          N, Y, SESS, JOBNAMES, STATUS        @L1A*/ 00005000
*/*                                                                  */ 00005100
*/*               MCSFLAG= SPECIFIES ATTRIBUTES OF THE           @L1A*/ 00005200
*/*                        MESSAGE. VALID VALUES ARE:            @L1A*/ 00005300
*/*                          REG0, RESP, REPLY, BRDCST,          @L1A*/ 00005400
*/*                          HRDCPY, QREG0, NOTIME, CMD, NOCPY   @L1A*/ 00005500
*/*                                                                  */ 00005600
*/*               QID=     REMOTE ENTRY SERVICES (RSS) QUEUE     @L1A*/ 00005700
*/*                        ID (OS/VS1 ONLY).                     @L1A*/ 00005800
*/*                                                                  */ 00005900
*/*               MF=      SPECIFIES THE TYPE OF EXPANSION       @L1A*/ 00006000
*/*                        REQUIRED. VALID VALUES ARE:           @L1A*/ 00006100
*/*                             I  -  THIS IS THE DEFAULT        @L1A*/ 00006200
*/*                             (L,<LISTNAME>)                   @L1A*/ 00006300
*/*                             (E,<LISTNAME>)                   @L1A*/ 00006400
*/*                             (E,<LISTNAME>,EXTENDED)          @L1A*/ 00006500
*/*                        THE 'EXTENDED' PARAMETER MUST BE      @L1A*/ 00006600
*/*                        USED IN AN EXECUTE FORM INVOCATION    @L1A*/ 00006700
*/*                        WHERE A WPX EXISTS AND EITHER THE     @L1A*/ 00006800
*/*                        REPLY ADDRESS, REPLY LENGTH, ECB      @L2C*/ 00006900
*/*                        ADDRESS OR REPLY CONSOLE NAME         @L2A*/ 00007000
*/*                        ADDRESS ARE TO BE INSERTED.           @L1A*/ 00007100
*/*                                                                  */ 00007200
*/*               CONSID=  SPECIFIES THE 4-BYTE ID OF THE        @L1A*/ 00007300
*/*                        CONSOLE TO RECEIVE A MESSAGE.         @L1A*/ 00007400
*/*                        IF A REGISTER IS USED, THE REGISTER   @L1A*/ 00007500
*/*                        CONTAINS THE 4-BYTE ID.               @L1A*/ 00007600
*/*                                                                  */ 00007700
*/*              CONSNAME= SPECIFIES THE 2-8 BYTE NAME OF THE    @L2A*/ 00007800
*/*                        CONSOLE TO RECEIVE A MESSAGE.         @L2A*/ 00007900
*/*                        IF A REGISTER IS USED, THE REGISTER   @L2A*/ 00008000
*/*                        CONTAINS THE ADDRESS OF THE 2-8 BYTE  @L2A*/ 00008100
*/*                        CONSOLE NAME                          @L2A*/ 00008200
*/*                                                                  */ 00008300
*/*            RPLYISUR=   THE ADDRESS OF A 12 BYTE AREA         @L2A*/ 00008400
*/*                        WHERE THE REPLYING CONSOLE WILL       @L2A*/ 00008500
*/*                        INSERT ITS 8 BYTE NAME AND 4 BYTE ID  @L2A*/ 00008600
*/*                                                                  */ 00008700
*/*               JOBID=   SPECIFIES THE 8-BYTE ID WITH WHICH    @L1A*/ 00008800
*/*                        THE JES IDENTIFIES THE ISSUER OF      @L1A*/ 00008900
*/*                        THIS WTOR. THE KEYWORD IS FOR USE BY  @L1A*/ 00009000
*/*                        JES2 AND JES3.  IF A REGISTER IS      @L1A*/ 00009100
*/*                        USED, THE REGISTER CONTAINS THE       @L1A*/ 00009200
*/*                        ADDRESS OF THE 8-BYTE ID.             @L1A*/ 00009300
*/*                                                                  */ 00009400
*/*               JOBNAME= SPECIFIES THE 8-BYTE NAME WITH WHICH  @L1A*/ 00009500
*/*                        THE JES IDENTIFIES THE ISSUER OF      @L1A*/ 00009600
*/*                        THIS WTOR. THE KEYWORD IS FOR USE BY  @L1A*/ 00009700
*/*                        JES2 AND JES3.  IF A REGISTER IS      @L1A*/ 00009800
*/*                        USED THE REGISTER CONTAINS THE        @L1A*/ 00009900
*/*                        ADDRESS OF THE 8-BYTE NAME.           @L1A*/ 00010000
*/*                                                                  */ 00010100
*/*               KEY=     SPECIFIES AN 8-BYTE KEY TO BE         @L1A*/ 00010200
*/*                        ASSOCIATED WITH THIS MESSAGE.  IF A   @L1A*/ 00010300
*/*                        REGISTER IS USED, THE REGISTER        @L1A*/ 00010400
*/*                        SPECIFIES THE ADDRESS OF THE 8-BYTE   @L1A*/ 00010500
*/*                        KEY.                                  @L1A*/ 00010600
*/*                                                                  */ 00010700
*/*               TOKEN=   SPECIFIES A 4-BYTE TOKEN TO BE        @L1A*/ 00010800
*/*                        ASSOCIATED WITH THIS MESSAGE.  THE    @L1A*/ 00010900
*/*                        FIELD IS USED TO IDENTIFY A GROUP     @L1A*/ 00011000
*/*                        OF MESSAGES THAT CAN BE DELETED BY    @L1A*/ 00011100
*/*                        TOKEN.  THE TOKEN SHOULD BE UNIQUE    @L1A*/ 00011200
*/*                        WITHIN AN ADDRESS SPACE. IF A         @L1A*/ 00011300
*/*                        REGISTER IS USED, THE REGISTER        @L1A*/ 00011400
*/*                        CONTAINS THE 4-BYTE VALUE.            @L1A*/ 00011500
*/*                                                                  */ 00011600
*/*               SYSNAME= SPECIFIES AN 8-BYTE SYSTEM NAME TO BE @L1A*/ 00011700
*/*                        ASSIGNED TO THIS MESSAGE.  IT IS THE  @L1A*/ 00011800
*/*                        SYSTEM NAME OF WHERE THIS WTOR        @L1A*/ 00011900
*/*                        ORIGINATED.  IF A REGISTER IS         @L1A*/ 00012000
*/*                        USED, THE REGISTER CONTAINS THE       @L1A*/ 00012100
*/*                        ADDRESS OF THE 8-BYTE NAME.           @L1A*/ 00012200
*/*                                                                  */ 00012300
*/*               WQEBLK=  SPECIFIES A WQE CONTROL BLOCK TO BE   @L1A*/ 00012400
*/*                        USED AS INPUT FOR THE WTOR. IF A      @L1A*/ 00012500
*/*                        REGISTER IS USED, THE REGISTER        @L1A*/ 00012600
*/*                        SPECIFIES THE ADDRESS OF THE WQE      @L1A*/ 00012700
*/*                        CONTROL BLOCK TO BE USED AS INPUT TO  @L1A*/ 00012800
*/*                        THE WTOR. THIS KEYWORD IS MUTUALLY    @L1A*/ 00012900
*/*                        EXCLUSIVE WITH ALL OTHER KEYWORDS.    @L1A*/ 00013000
*/*                        THIS KEYWORD IS ONLY VALID ON THE     @L1A*/ 00013100
*/*                        STANDARD FORM (MF=I) OF THE MACRO.    @L1A*/ 00013200
*/*                                                                  */ 00013300
*/*               CART=    SPECIFIES THE 4-BYTE ADDRESS OF THE   @L3A*/ 00013400
*/*                        8 BYTE COMMAND AND RESPONSE TOKEN.    @L3A*/ 00013500
*/*                        THE CART IS USED TO ASSOCIATE A WTO   @L3A*/ 00013600
*/*                        RESPONSE WITH THE ORIGINATING COMMAND.@L3A*/ 00013700
*/*                        IF A REGISTER IS USED, THE REGISTER   @L3A*/ 00013800
*/*                        CONTAINS THE 4-BYTE ADDRESS VALUE.    @L3A*/ 00013900
*/*                        IF AN 8-BYTE FIELD IS USED, THE       @L3A*/ 00014000
*/*                        ADDRESS OF THE FIELD IS STORED IN THE @L3A*/ 00014100
*/*                        WPL.                                  @L3A*/ 00014200
*/*                                                                  */ 00014300
*/*               TEXT=    SPECIFIES A DATA AREA                 @P8A*/ 00014400
*/*                        CONTAINING A 2 BYTE MESSAGE LENGTH    @L4A*/ 00014500
*/*                        FIELD FOLLOWED BY THE ACTUAL MESSAGE  @L4A*/ 00014600
*/*                        TEXT. IF A REGISTER IS USED, THE      @L4A*/ 00014700
*/*                        REGISTER CONTAINS THE ADDRESS OF THE  @L4A*/ 00014800
*/*                        DATA AREA. IF A FIELD IS USED, THE    @L4A*/ 00014900
*/*                        ADDRESS OF THE FIELD IS STORED        @L4A*/ 00015000
*/*                        IN THE WPL. THE TEXT KEYWORD IS       @L4A*/ 00015100
*/*                        MUTUALLY EXCLUSIVE WITH INLINE        @L4A*/ 00015200
*/*                        MESSAGE TEXT. THE TEXT KEYWORD MAY BE @L4A*/ 00015300
*/*                        SPECIFIED ON THE LIST FORM OF THE     @L4A*/ 00015400
*/*                        MACRO WITHOUT A KEYWORD VALUE TO      @L4A*/ 00015500
*/*                        SET UP THE PROPER FORM OF THE WTO     @L4A*/ 00015600
*/*                        PARAMETER LIST.                       @L4A*/ 00015700
*/*                        IF THE TEXT KEYWORD IS USED, THE      @L4A*/ 00015800
*/*                        ADDITIONAL POSITIONAL PARAMETERS,     @L4A*/ 00015900
*/*                        RYAD, LENGTH, ECB ADDRESS, MUST BE    @L4A*/ 00016000
*/*                        SPECIFIED AS THE SECOND, THIRD AND    @L4A*/ 00016100
*/*                        FOURTH POSITIONAL PARAMETERS ON THE   @L4A*/ 00016200
*/*                        TEXT KEYWORD.                         @L4A*/ 00016300
*/*                                                              @L4A*/ 00016400
*/*              LINKAGE=  SPECIFIES HOW CONTROL IS TO PASS TO   @L5A*/ 00016500
*/*                        THE WTOR FUNCTION.  LINKAGE IS NOT    @L5A*/ 00016600
*/*                        VALID IN THE LIST (MF=L) FORM OF THE  @L5A*/ 00016700
*/*                        MACRO.                                @L5A*/ 00016800
*/*                        THE VALID VALUES ARE-                 @L5A*/ 00016900
*/*                             BRANCH                           @L5A*/ 00017000
*/*                             SVC - THIS IS THE DEFAULT        @L5A*/ 00017100
*/*                                                                  */ 00017200
*/*                SYNCH=  SPECIFIES WHETHER THE WTOR REQUEST    @L5A*/ 00017300
*/*                        IS TO BE PROCESSED SYNCHRONOUSLY      @L5A*/ 00017400
*/*                        WITH RESPECT TO THE CALLER.           @L5A*/ 00017500
*/*                        THE VALID VALUES ARE-                 @L5A*/ 00017600
*/*                             YES                              @L5A*/ 00017700
*/*                             NO  - THIS IS THE DEFAULT        @L5A*/ 00017800
*/*                                                                  */ 00017900
*/* FUNCTION =                                                   @L1A*/ 00018000
*/*     BUILDS A WTOR PARAMETER LIST (WPL) AND/OR THE CODE       @L1A*/ 00018100
*/*     WHICH WILL INVOKE SVC 35 TO ISSUE THE MESSAGE            @L1A*/ 00018200
*/*                                                                  */ 00018300
*/* OPERATION =                                                  @L1A*/ 00018400
*/*     - IF LIST OR STANDARD FORM IS SPECIFIED, WTOR INVOKES    @L1A*/ 00018500
*/*          THE WTO MACRO TO DETERMINE WHICH KEYWORDS HAVE BEEN @L1A*/ 00018600
*/*          USED.  IF AN EXTENDED FORM OF THE WPL (WPX) IS TO   @L1A*/ 00018700
*/*          BE BUILT, WTO BUILDS IT USING THE INFORMATION       @L1A*/ 00018800
*/*          PASSED BY THIS MACRO.  WTO ALSO HANDLES PARAMETER   @L1A*/ 00018900
*/*          LIST GENERATION IF THIS IS AN INVOCATION WHERE THE  @L1A*/ 00019000
*/*          WQEBLK KEYWORD IS USED. IF AN OLD-FORMAT WPL        @L1A*/ 00019100
*/*          IS TO BE BUILT, HOWEVER, THEN THIS MACRO WILL       @L1A*/ 00019200
*/*          GENERATE THE PARAMETER LIST.                        @L1A*/ 00019300
*/*     - IF EXECUTE FORM IS SPECIFIED, INSERT RUN-TIME KEYWORD  @L1A*/ 00019400
*/*          VALUES INTO THE ALREADY-EXISTING PARAMETER LIST     @L1A*/ 00019500
*/*                                                                  */ 00019600
*/* USAGE =                                                      @L1C*/ 00019700
*/*     ANY PROGRAM MAY USE THIS MACRO TO                    @G860PSS*/ 00019800
*/*     BUILD THE WTOR PARAMETER LIST.  HOWEVER                  @L1C*/ 00019900
*/*     WQEBLK, JOBID, SYSNAME, AND JOBNAME                      @01C*/ 00020000
*/*     ARE FOR CONTROL PROGRAM USE ONLY.                        @L1C*/ 00020100
*/*                                                                  */ 00020200
*/* SUBPOOL AND KEY=                                             @L1A*/ 00020300
*/*     ANY AND ANY. THE PARAMETER LIST MAY RESIDE           @G860PSS*/ 00020400
*/*     ABOVE THE 16M LINE.                                  @G860PSS*/ 00020500
*/*                                                                  */ 00020600
*/* RESTRICTIONS =                                               @PAA*/ 00020700
*/*                                                              @PAA*/ 00020800
*/*   "LINKAGE" SPECIFIED AS OR DEFAULTED TO "SVC" REQUIRES      @PAA*/ 00020900
*/*     THE CALLER TO:                                           @PAA*/ 00021000
*/*     - BE IN TASK MODE                                        @PAA*/ 00021100
*/*     - HOLD NO LOCKS                                          @PAA*/ 00021200
*/*     - BE ENABLED FOR INTERRUPTS                              @PAA*/ 00021300
*/*     - BE IN PRIMARY ASC MODE                                 @PAA*/ 00021400
*/*     - BE IN NON-CROSS-MEMORY MODE                            @PAA*/ 00021500
*/*     - "AUTHORIZED" PARAMETERS REQUIRE SUPERVISOR STATE,      @PAA*/ 00021600
*/*        PROTECT KEY 0-7.                                      @PAA*/ 00021700
*/*                                                              @PAA*/ 00021800
*/*   "LINKAGE=BRANCH" WITH "SYNCH=YES" CAN BE USED              @PAA*/ 00021900
*/*     WHEN IN SRB MODE-                                        @PAA*/ 00022000
*/*       A WTOR ISSUED FROM SRB MODE WILL NOT HAVE A JOBNAME OR @PAA*/ 00022100
*/*       JOBID ASSOCIATED WITH IT.                              @PAA*/ 00022200
*/*       IT WILL NOT BE AUTOMATICALLY DOM'D WHEN THE TASK ENDS. @PAA*/ 00022300
*/*     WHEN DISABLED FOR INTERRUPTS-                            @PAA*/ 00022400
*/*       WTOR PARAMETER LIST AND ALL STORAGE ADDRESSED BY IT    @PAA*/ 00022500
*/*       MUST BE IN FIXED OR DREF STORAGE.                      @PAA*/ 00022600
*/*     WHEN LOCKS HELD                                          @PAA*/ 00022700
*/*     WHEN THE PRIMARY ADDRESS SPACE IS NOT THE SAME AS        @PAA*/ 00022800
*/*     THE HOME ADDRESS SPACE-                                  @PAA*/ 00022900
*/*       CALLER MUST BE IN PRIMARY ASC MODE.                    @PAA*/ 00023000
*/*                                                              @PAA*/ 00023100
*/*   IF "LINKAGE=BRANCH" IS SPECIFIED-                          @PAA*/ 00023200
*/*       WQEBLK KEYWORD CANNOT BE SPECIFIED, ABEND IF ATTEMPTED @PAA*/ 00023300
*/*       MESSAGE TEXT MAY NOT CONTAIN DBCS DATA.                @PAA*/ 00023400
*/*       CALLER MUST BE IN SUPERVISOR STATE, PROTECT KEY 0-7.   @PAA*/ 00023500
*/*       CALLER MUST BE IN PRIMARY ASC MODE.                    @PAA*/ 00023600
*/*                                                              @PAA*/ 00023700
*/*                                                                  */ 00023800
*/* DEPENDENCIES =                                               @L1A*/ 00023900
*/*     - LIST AND EXECUTE FORM MUST REFERENCE THE SAME VERSION  @L1A*/ 00024000
*/*          OF THE PARAMETER LIST (WPL)                         @L1A*/ 00024100
*/*                                                                  */ 00024200
*/* MODULE TYPE = MACRO                                          @L1A*/ 00024300
*/*                                                                  */ 00024400
*/* ENTRY POINT = N/A                                            @L1A*/ 00024500
*/*                                                                  */ 00024600
*/* INPUT = SEE INVOCATION                                       @L1A*/ 00024700
*/*                                                                  */ 00024800
*/* OUTPUT =                                                     @L1A*/ 00024900
*/*     PARAMETER LIST TO ISSUE SVC 35 AND/OR THE                @L1A*/ 00025000
*/*     INSTRUCTIONS REQUIRED TO MODIFY THE PARAMETER            @L1A*/ 00025100
*/*     LIST AND ISSUE SVC 35.                                   @L1A*/ 00025200
*/*                                                                  */ 00025300
*/* EXIT, NORMAL                                                 @L1A*/ 00025400
*/*  CONDITION - NO ERRORS DETECTED BY THE WTOR (OR WTO) MACRO   @L1A*/ 00025500
*/*  OUTPUT    - NO MNOTE ISSUED. SEVERITY CODE = 0              @L1A*/ 00025600
*/*                                                                  */ 00025700
*/* EXIT, NORMAL                                                 @L1A*/ 00025800
*/*  CONDITION - INFORMATIONAL MNOTE CONDITION DETECTED BY THE   @L1A*/ 00025900
*/*                WTOR (OR WTO) MACRO                           @L1A*/ 00026000
*/*  OUTPUT    - MNOTE WITH SEVERITY CODE 0 ISSUED WHEN DATA     @L1A*/ 00026100
*/*                IS SPECIFIED FOR A RUN-TIME KEYWORD ON A      @L1A*/ 00026200
*/*                LIST FORM INVOCATION. THE DATA IS IGNORED.    @L1A*/ 00026300
*/*               .A LINE OF INLINE TEXT IS LONGER THAN THE      @PEM*/ 00026400
*/*                  DOCUMENTED ALLOWED MAXIMUM LENGTH.          @PEM*/ 00026500
*/*                                                                  */ 00026600
*/* EXIT, NORMAL                                                 @L1A*/ 00026700
*/*  CONDITION - WARNING CONDITION DETECTED BY THE WTOR          @L1A*/ 00026800
*/*              (OR WTO) MACRO                                  @L1A*/ 00026900
*/*  OUTPUT    - MNOTE WITH SEVERITY CODE 4 ISSUED WHEN:         @L1A*/ 00027000
*/*               .A RUN-TIME KEYWORD IS SPECIFIED WITHOUT DATA  @L1A*/ 00027100
*/*                  DURING A STANDARD/EXECUTE FORM INVOCATION.  @L1A*/ 00027200
*/*                  THE KEYWORD IS IGNORED.                     @L1A*/ 00027300
*/*               .AN INVALID ROUTING CODE IS SPECIFIED          @L1A*/ 00027400
*/*               .AN INVALID RANGE OF ROUTING CODES IS          @L1A*/ 00027500
*/*                  SPECIFIED                                   @L1A*/ 00027600
*/*               .RESERVED ROUTING CODES (29-40) ARE        @YA10057*/ 00027700
*/*                  SPECIFIED                               @YA10057*/ 00027800
*/*               .AN INVALID DESCRIPTOR CODE IS SPECIFIED       @L1A*/ 00027900
*/*               .INVALID OR MUTUALLY EXCLUSIVE MCSFLAG         @L1A*/ 00028000
*/*                  VALUES ARE SPECIFIED                        @L1A*/ 00028100
*/*               .AN INVALID MSGTYPE VALUE IS SPECIFIED         @L1A*/ 00028200
*/*               .AN INVALID QID VALUE IS SPECIFIED             @L1A*/ 00028300
*/*                                                                  */ 00028400
*/* EXIT, ERROR                                                  @L1A*/ 00028500
*/*  CONDITION - TERMINATING ERROR CONDITION DETECTED BY         @L1A*/ 00028600
*/*                THE WTOR (OR WTO) MACRO                       @L1A*/ 00028700
*/*  OUTPUT    - MNOTE WITH SEVERITY CODE 12 ISSUED WHEN:        @L1A*/ 00028800
*/*               .THE WQEBLK KEYWORD IS SPECIFIED ALONG WITH    @L1A*/ 00028900
*/*                  OTHER KEYWORDS                              @L1A*/ 00029000
*/*               .THE CONSID KEYWORD IS SPECIFIED WITH THE      @L2A*/ 00029100
*/*                   CONSNAME KEYWORD                           @L2A*/ 00029200
*/*               .THE NUMBER OF TEXT LINES REQUESTED IS NOT 1   @L1A*/ 00029300
*/*               .THE TEXT KEYWORD IS SPECIFIED ALONG WITH      @L4A*/ 00029400
*/*                   INLINE MESSAGE TEXT                        @L4A*/ 00029500
*/*               .MORE THAN 14 LINES OF TEXT                    @L5A*/ 00029600
*/*               ."SYNCH=YES" IS SPECIFIED WITHOUT              @L5A*/ 00029700
*/*                   "LINKAGE=BRANCH"                           @L5A*/ 00029800
*/*               ."LINKAGE=BRANCH" IS SPECIFIED WITHOUT         @L5A*/ 00029900
*/*                   "SYNCH=YES"                                @L5A*/ 00030000
*/*               ."SYNCH=YES" IS SPECIFIED WITH THE WQEBLK      @L5A*/ 00030100
*/*                   KEYWORD                                    @L5A*/ 00030200
*/*               ."SYNCH=YES" IS SPECIFIED WITH                 @L5A*/ 00030300
*/*                   "MCSFLAG=HRDCPY"                           @L5A*/ 00030400
*/*                                                                  */ 00030500
*/* EXTERNAL REFERENCES = N/A                                    @L1A*/ 00030600
*/*                                                                  */ 00030700
*/* TABLES = N/A                                                 @L1A*/ 00030800
*/*                                                                  */ 00030900
*/* MACROS =                                                     @L1A*/ 00031000
*/*     THE PARAMETER LIST GENERATED BY THIS MACRO IS MAPPED     @L1A*/ 00031100
*/*     BY THE MACRO IEZWPL. HOWEVER, IEZWPL IS NOT REQUIRED     @L1A*/ 00031200
*/*     TO USE THIS MACRO.                                       @L1A*/ 00031300
*/*                                                                  */ 00031400
*/*                                                                  */ 00031500
*/* CHANGE ACTIVITY = G860PSS                                @G860PSS*/ 00031600
*/*                                                                  */ 00031700
*/* $L1=COEXWTO2, JBB2220, 841128, PDF9: JES3/MCS COEXISTENCE        */ 00031800
*/* $P1=PA21155,  JBB2220, 860910, PDF9: JES3/MCS COEXISTENCE        */ 00031900
*/* $P2=PA21240,  JBB2220, 861008, PDF9: JES3/MCS COEXISTENCE        */ 00032000
*/*                   YA10057                                        */ 00032100
*/*                   YA11509 - NO CODE CHANGES.                     */ 00032200
*/*                   YA17152 - REDEFINE COMMON GLOBAL ACRONYMS      */ 00032300
*/* $L2=CNMG2,    HBB4410, 870424, PDR3: CONSOLE MERGE STAGE II      */ 00032400
*/* $L3=TSOOP,    HBB4410, 870622, PDBU: TSO OPERATOR                */ 00032500
*/* $L4=KNWTO,    HBB4410, 870916, PDCM: KANJI/WTO                   */ 00032600
*/* $P3=PEO0021,  HBB4410, 880120, PDBU: CONSOLE MERGE STAGE II      */ 00032700
*/* $P4=PEO0158,  HBB4410, 880210, PDBU: CONSOLE MERGE STAGE II      */ 00032800
*/* $L5=CNITGDHE, HBB4410, 890313, PDHE: CONSOLE INTEGRATION         */ 00032900
*/* $P5=PH25014,  HBB4410, 890503, PDHD: CONSOLE INTEGRATION         */ 00033000
*/* $P6=PH25015,  HBB4410, 890503, PDHD: CONSOLE INTEGRATION         */ 00033100
*/* $P7=PH25024,  HBB4410, 890503, PDHE: CONSOLE INTEGRATION         */ 00033200
*/* $P8=PEO1712,  HBB4410, 890612, PDCM: TEXT PARAMETER DESCRIPTION  */ 00033300
*/* $D1=DEO0124,  HBB4410, 890612, PDCM: DCR 124                     */ 00033400
*/* $D2=DEO0184,  HBB4410, 890619, PDHE: DCR 184                     */ 00033500
*/* $P9=PEO2841,  HBB4410, 891020, PDHE: INITIALIZE &MLW GLOBAL      */ 00033600
*/* $PA=PEO2883,  HBB4410, 891127, PDHE: RESTRICTIONS IN PROLOG      */ 00033700
*/* $PB=PEO3063,  HBB4410, 900105, PDF9: UPDATE TEXT GENERATE        */ 00033800
*/* $PC=PEO3640,  HBB4410, 900305, PDCY: ALLOW NULL TEXT KEYWORD     */ 00033900
*/*                                      VALUE ON LIST FORM OF MACRO */ 00034000
*/* $PD=PEO3824,  HBB4410, 900330, PDHD: WARNING ABOUT LINE TYPES    */ 00034100
*/*                                      WITH TEXT ON EXEC FORM      */ 00034200
*/* $PE=PEO4290,  HBB4410, 900504, PDHE: CHANGE MNOTE SEVERITY       */ 00034300
*/* $01=OY37350,  HBB4410, 901019, PDHE: PEO4845 REMOVE UNSUPPORTED  */ 00034400
*/*                                      PARAMETER                   */ 00034500
*/* $02=OY52324,  HBB4410, 920327, PDHE: TEXT ADDRESS IN REGISTER    */ 00034600
*/*                                                                  */ 00034700
*/* MESSAGES (MNOTES) =                                          @L1A*/ 00034800
*/*                                                                  */ 00034900
*/*  - SEVERITY 0 MNOTES:                                        @L1A*/ 00035000
*/*     - 'KKKKKKKK' DATA IGNORED ON THE LIST FORM OF WTOR.      @L1A*/ 00035100
*/*           WHERE 'KKKKKKKK' MAY BE KEY, CONSID, JOBID,        @L1A*/ 00035200
*/*           JOBNAME, TOKEN, SYSNAME, CONSNAME,                 @01C*/ 00035300
*/*           RPLYISUR, CART, TEXT, OR LINKAGE                   @L5C*/ 00035400
*/*     - INLINE TEXT EXCEEDS ALLOWED MAXIMUM. TEXT LINE         @PEM*/ 00035500
*/*            (NUMBER N) HAS BEEN TRUNCATED.                    @PEM*/ 00035600
*/*          WHERE 'NUMBER N' APPLIES TO THE LINE NUMBER ON A    @PEM*/ 00035700
*/*          MULTI LINE MESSAGE                                  @PEM*/ 00035800
*/*                                                                  */ 00035900
*/*  - SEVERITY 4 MNOTES:                                        @L1A*/ 00036000
*/*     - RESERVED ROUTING CODE(S) 29-40 IGNORED.            @YA10057*/ 00036100
*/*     - INVALID RANGE OF ROUTING CODES IGNORED.                @L1A*/ 00036200
*/*     - 'KKKKKKKK' KEYWORD IGNORED. NO VALUE SPECIFIED.        @L1A*/ 00036300
*/*           WHERE 'KKKKKKKK' MAY BE WQEBLK, CONSID, JOBID,     @L1A*/ 00036400
*/*           JOBNAME, KEY, TOKEN, SYSNAME, CONSNAME,            @01C*/ 00036500
*/*           CART OR TEXT.                                      @L4A*/ 00036600
*/*     - ROUTCDE  N  IS INVALID ROUTING CODE. IT IS IGNORED.    @L1A*/ 00036700
*/*     - DESC  N  IS INVALID DESCRIPTOR CODE. IT IS IGNORED.    @L1A*/ 00036800
*/*     - MSGTYP FIELD INVALID. N IS ASSUMED                     @L1A*/ 00036900
*/*     - MCSFLAG= &MCSFLAG(&I) IS INVALID. IT IS IGNORED.       @L1A*/ 00037000
*/*     - HRDCPY AND NOCPY MUTUALLY EXCLUSIVE, MCSFLAG=HRDCPY    @L1A*/ 00037100
*/*         ASSUMED                                              @L1A*/ 00037200
*/*     - QID FIELD IS INVALID. ZERO ASSUMED.                    @L1A*/ 00037300
*/*     - LINKAGE IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXX @L5A*/ 00037400
*/*     - SYNCH IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXX @L5A*/ 00037500
*/*                                                                  */ 00037600
*/*  - SEVERITY 12 MNOTES:                                       @L1A*/ 00037700
*/*     - NO TEXT GENERATED. 'WQEBLK' IS MUTUALLY EXCLUSIVE      @L1A*/ 00037800
*/*         WITH ALL OTHER KEYWORDS.                             @L1A*/ 00037900
*/*     - NO TEXT GENERATED. 'CONSID' IS MUTUALLY EXCLUSIVE      @L2A*/ 00038000
*/*         WITH CONSNAME KEYWORDS.                              @L2A*/ 00038100
*/*     - NUMBER OF LINES REQUESTED IS NOT 1 - GENERATION        @L1A*/ 00038200
*/*         TERMINATED                                           @L1A*/ 00038300
*/*     - NO TEXT GENERATED. INLINE TEXT IS MUTUALLY EXCLUSIVE   @L4A*/ 00038400
*/*         WITH 'TEXT'.                                         @L4A*/ 00038500
*/*     - NO TEXT GENERATED.  'SYNCH=YES' REQUIRES               @L5A*/ 00038600
*/*         'LINKAGE=BRANCH'                                     @L5A*/ 00038700
*/*     - NO TEXT GENERATED.  'LINKAGE=BRANCH' REQUIRES          @L5A*/ 00038800
*/*         'SYNCH=YES'                                          @L5A*/ 00038900
*/*     - NO TEXT GENERATED.  'SYNCH=YES' IS MUTUALLY EXCLUSIVE  @L5A*/ 00039000
*/*         WITH THE WQEBLK KEYWORD                              @L5A*/ 00039100
*/*     - NO TEXT GENERATED.  'SYNCH=YES' IS MUTUALLY EXCLUSIVE  @L5A*/ 00039200
*/*         WITH 'MCSFLAG=HRDCPY'                                @L5A*/ 00039300
*/*     - NO TEXT GENERATED.  SPECIFIED LINKAGE VALUE WAS NOT    @L5A*/ 00039400
*/*         SVC OR BRANCH.                                       @L5A*/ 00039500
*/*     - NO TEXT GENERATED.  SPECIFIED SYNCH VALUE WAS NOT      @L5A*/ 00039600
*/*         YES OR NO.                                           @L5A*/ 00039700
*/*     - TOO MANY LINES OF TEXT.  MAX=14 WHEN SYNCH=YES         @L5A*/ 00039800
*/*                                                                  */ 00039900
*/* NOTES     = THE WPL IS GENERATED BY THIS MACRO IN DIFFERENT  @L1A*/ 00040000
*/*             FORMATS DEPENDING ON THE KEYWORDS PROVIDED.      @L1A*/ 00040100
*/*             A STANDARD WPL IS GENERATED IF ONLY THE          @L1A*/ 00040200
*/*             FOLLOWING KEYWORDS ARE SPECIFIED: ROUTCDE(1-16), @L1A*/ 00040300
*/*             DESC, MCSFLAG, MSGTYPE, QID.                     @L1A*/ 00040400
*/*             IF ANY OTHER KEYWORDS ARE SPECIFIED, A DIFFERENT @L1A*/ 00040500
*/*             STRUCTURE (WPX - MAPPED BY IEZWPL) IS BUILT      @L1A*/ 00040600
*/*             FOLLOWING THE MESSAGE TEXT.                      @L1A*/ 00040700
*/*                                                                  */ 00040800
*/*             IN ORDER TO SUPPORT ASSEMBLER F, THIS MACRO      @P2A*/ 00040900
*/*             MUST BE STRUCTURED SUCH THAT THERE ARE NO        @P2A*/ 00041000
*/*             INSTRUCTIONS MORE THAN 3 LINES IN LENGTH.        @P2A*/ 00041100
*/*                                                                  */ 00041200
*/*             IF LINKAGE=BRANCH IS SPECIFIED THE CONTENTS OF   @L5A*/ 00041300
*/*             REGISTER 14 WILL BE DESTROYED.                   @L5A*/ 00041400
*/*                                                                  */ 00041500
*/********************************************************************/ 00041600
*/* C ALLOW THE ISSUER TO PROVIDE 31 BIT POINTERS            @G860PSS*/ 00041700
*/* A PROVIDE MVS/370 FORMAT PARM LIST                       @G860PSS*/ 00041800
*/* A MODIFY THE MACRO TO PROCESS WQEBLK, 128 ROUTING CODES,     @L1A*/ 00041900
*/*   CONSID, JOBID, KEY, TOKEN, SYSNAME, DOMID, JOBNAME AND THE @L1A*/ 00042000
*/*   'EXTENDED' MF PARAMETER.                                   @L1A*/ 00042100
*/* C LIMIT STATEMENT LENGTHS TO 3 LINES MAX TO SUPPORT ASM F    @P1A*/ 00042200
*/* C REFIX PA21155 SO THAT WPX IS ALWAYS CORRECTLY GENERATED    @P2A*/ 00042300
*/* C ALLOW ROUTING CODE 41 TO BE SPECIFIED                  @YA10057*/ 00042400
*/* NO CODE CHANGE. REASSEM FOR PTF PACKAGING PROBLEM ONLY.  @YA11509*/ 00042500
*/* C REDEFINE GLOBAL NAMES  @LEN ,&MCS ,&WTOLEN UNIQUELY    @YA17152*/ 00042600
*/* A MODIFY THE MACRO TO PROCESS CONSNAME AND REPLY CONSOLE     @L2A*/ 00042700
*/*   NAME/ID ADDRESS                                            @L2A*/ 00042800
*/* A MODIFY THE MACRO TO PROCESS CART                           @D1C*/ 00042900
*/* A MODIFY THE MACRO TO PROCESS TEXT KEYWORD                   @L4A*/ 00043000
*/* C FIXED REPLY ADDRESS AND ECB ADDRESS FOR WTOR STANDARD FORM @P3A*/ 00043100
*/* C PUT BACK CODE TO INITIALIZE REPLY/ECB ADDRESSES FOR WTOR   @P4A*/ 00043200
*/* C MODIFY THE MACRO TO PROCESS LINKAGE AND SYNCH KEYWORDS     @L5A*/ 00043300
*/* C ALLOW LINKAGE TO BE NULL IN THE LIST FORM                  @P5A*/ 00043400
*/* C UPDATE SYNCH=NO IN THE EXECUTE FORM                        @P6A*/ 00043500
*/* C TEXT KEYWORD MULTILINE EXECUTE FORM NOT LOADING ADDRESS OF @P7A*/ 00043600
*/*   THE FIRST LINE OF TEXT                                     @P7A*/ 00043700
*/* A INITIALIZE GLOBAL VARIABLE &MLW                            @P9A*/ 00043800
*/* A ADD RESTICTIONS TO PROLOG                                  @PAA*/ 00043900
*/* C UPDATE GENERATE FOR MESSAGE TEXT                           @PBA*/ 00044000
*/* C ALLOW NULL KEYWORD VALUE ON LIST FORM OF MACRO             @PCA*/ 00044100
*/* C WARNING MESSAGE IF LINE TYPE GIVEN ON EXEC FORM            @PDA*/ 00044200
*/* C CHANGE SEVERITY ON TEXT LENGTH MNOTE                       @PEA*/ 00044300
*/* C REMOVE UNSUPPORTED KEYWORD                                 @01A*/ 00044400
*/* C TEXT ADDRESS IN REGISTER                                   @02A*/ 00044500
*/********************************************************************/ 00044600
* /*                                                                    00044700
         MACRO                                                          00050000
&NAME    WTOR  &MESG,&RYAD,&LENGTH,&ECB,&MF=I,&MSGTYP=,&ROUTCDE=,      X00100000
               &DESC=,&MCSFLAG=,&QID=,&WQEBLK=¬,&CONSID=¬,&JOBID=¬,    X00150000
               &KEY=¬,&TOKEN=¬,&SYSNAME=¬,&JOBNAME=¬,                  X00200000
               &CONSNAME=¬,&RPLYISUR=¬,&CART=¬,&TEXT=¬,&LINKAGE=¬,     X00250000
               &SYNCH=¬                                            @01C 00300000
.********************************************************************** 02900000
.*       DECLARE THE GLOBAL AND LOCAL VARIABLES                    @L1C 02929700
.********************************************************************** 02959400
         GBLA  &IHBLEN             MESSAGE LENGTH (SET BY WTO) @YA17152 02989100
         GBLB  &IHBWTOR            THIS IS A WTOR                  @L1C 03018800
         GBLB  &IHBMCS             MCS FLAGS (SET BY WTO)      @YA17152 03048500
         GBLB  &SWM                GENERATE MSGTYP FLAGS (WTO)     @L1C 03078200
         GBLB  &WTOERR             WTO ISSUED A TERMINATING MNOTE  @L1C 03107900
         GBLB  &IWPXBIT            A WPX HAS BEEN BUILT            @L1C 03137600
         GBLB  &IWQEBIT            A WQEBLK SETUP HAS OCCURRED     @L1A 03167300
         GBLB  &TEXTKEY            TEXT KEYWORD SPECIFIED          @L4A 03197000
         GBLB  &RAREG              REPLY ADDRESS IN REGISTER IND.  @L1C 03226700
         GBLB  &RLREG              REPLY LENGTH IN REGISTER IND.   @L1C 03256400
         GBLB  &EAREG              ECB ADDRESS IN REGISTER IND.    @L1C 03286100
         GBLB  &RCNREG             REPLY CONSOLE NAME/ID ADDRESS IN    X03315800
                                   REGISTER IND.                   @L2A 03345500
         GBLB  &RCNSPEC            REPLY CONSOLE NAME/ID ADDRESS       X03375200
                                   KEYWORD SPECIFIED               @L2A 03404900
         GBLB  &MLW                MULTI-LINE WTO/R SPECIFIED      @L5A 03434600
         GBLC  &TEXTVAL            TEXT ADDRESS, IF SPECIFIED      @L4A 03464300
         GBLC  &SYSSPLV            SYSTEM PRODUCT LEVEL            @L1C 03494000
         GBLC  &CD(16)             FLAGS SET BY WTO MACRO          @L1A 03523700
         GBLC  &WTORYA             REPLY ADDRESS FOR WTO MACRO     @L1A 03553400
         GBLC  &WTOLENR            REPLY LENGTH FOR WTOR       @YA17152 03583100
         GBLC  &WTOECB             ECB ADDRESS FOR WTO MACRO       @L1A 03612800
         GBLC  &WTORCN             REPLY CONSOLE NAME/ID ADDRESS FOR   X03642500
                                   WTO MACRO                       @L2A 03672200
         GBLC  &GNAME              LABEL AFTER PARAMETER LIST      @L1C 03701900
         GBLC  &ILMEQU             INLINE MESSAGE TEXT VALUE       @L5A 03731600
         LCLA  &J                  LOOP VARABLE                @D61CDFG 03746461
         LCLA  &K                  LENGTH FIELD                    @L5M 03761300
         LCLA  &H                  PROCESSED MAJOR INDEX           @L5A 03791000
         LCLA  &MAXLINS            MAXIMUM NUMBER OF LINES ALLOWED WHEN+03820700
                                   SYNCH = YES                     @L5A 03850400
         LCLA  &MLINDX             MULTI-LINE OFFSET INDEX         @L5A 03880100
         LCLB  &EMCS(16)           EXTENDED MCSFLAG SAVEAREA       @L4C 03909800
         LCLC  &VALH               TEXT LINE VALUE                 @L5A 03939500
         LCLC  &VALH1              TEXT ADDRESS VALUE              @L5A 03969200
         LCLB  &LTWARN             LINE TYPE WARNING ISSUED        @PDA 03998900
         LCLC  &NSUPOP             UNSUPPORTED OPERAND         @D61CDFG 03999361
&NSUPOP  SETC  'JOBID'                                         @D61CDFG 03999761
         AIF   ('&JOBID' NE '¬').NSUPOP                        @D61CDFG 04000161
&NSUPOP  SETC  'JOBNAME'                                       @D61CDFG 04000561
         AIF   ('&JOBNAME' NE '¬').NSUPOP                      @D61CDFG 04000961
&NSUPOP  SETC  'KEY'                                           @D61CDFG 04001361
         AIF   ('&KEY' NE '¬').NSUPOP                          @D61CDFG 04001761
&NSUPOP  SETC  'LINKAGE'                                       @D61CDFG 04002161
         AIF   ('&LINKAGE' NE '¬').NSUPOP                      @D61CDFG 04002561
&NSUPOP  SETC  'MSGTYP'                                        @D61CDFG 04002961
         AIF   ('&MSGTYP' NE '').NSUPOP                        @D61CDFG 04003361
&NSUPOP  SETC  'QID'                                           @D61CDFG 04003761
         AIF   ('&QID' NE '').NSUPOP                           @D61CDFG 04004161
&NSUPOP  SETC  'SYNCH'                                         @D61CDFG 04004561
         AIF   ('&SYNCH' NE '¬').NSUPOP                        @D61CDFG 04004961
&NSUPOP  SETC  'SYSNAME'                                       @D61CDFG 04005361
         AIF   ('&SYSNAME' NE '¬').NSUPOP                      @D61CDFG 04005761
&NSUPOP  SETC  'TOKEN'                                         @D61CDFG 04006161
         AIF   ('&TOKEN' NE '¬').NSUPOP                        @D61CDFG 04006561
&NSUPOP  SETC  'WQEBLK'                                        @D61CDFG 04006961
         AIF   ('&WQEBLK' NE '¬').NSUPOP                       @D61CDFG 04007361
&J       SETA  0                                               @D61CDFG 04007761
.MCFLOOP AIF   (&J GE N'&MCSFLAG OR T'&MCSFLAG EQ 'O').CHK123  @D61CDFG 04008161
&J       SETA  &J+1                MORE MCSFLAG VALUES         @D61CDFG 04008561
&NSUPOP  SETC  'BRDCST'                                        @D61CDFG 04008961
         AIF   ('&MCSFLAG(&J)' EQ '&NSUPOP').NSUPOP            @D61CDFG 04009361
&NSUPOP  SETC  'CMD'                                           @D61CDFG 04009761
         AIF   ('&MCSFLAG(&J)' EQ '&NSUPOP').NSUPOP            @D61CDFG 04010161
&NSUPOP  SETC  'NOCPY'                                         @D61CDFG 04010561
         AIF   ('&MCSFLAG(&J)' EQ '&NSUPOP').NSUPOP            @D61CDFG 04010961
&NSUPOP  SETC  'NOTIME'                                        @D61CDFG 04011361
         AIF   ('&MCSFLAG(&J)' EQ '&NSUPOP').NSUPOP            @D61CDFG 04011761
&NSUPOP  SETC  'QREG0'                                         @D61CDFG 04012161
         AIF   ('&MCSFLAG(&J)' EQ '&NSUPOP').NSUPOP            @D61CDFG 04012561
&NSUPOP  SETC  'REG0'                                          @D61CDFG 04012961
         AIF   ('&MCSFLAG(&J)' EQ '&NSUPOP').NSUPOP            @D61CDFG 04013361
&NSUPOP  SETC  'REPLY'                                         @D61CDFG 04013761
         AIF   ('&MCSFLAG(&J)' EQ '&NSUPOP').NSUPOP            @D61CDFG 04014161
         AGO   .MCFLOOP                                        @D61CDFG 04014561
.CHK123  SPLEVEL TEST                                          @D61CDFG 04014961
         AIF   ('&SYSSPLV' GE '4').GEN140                      @D61CDFG 04015361
&NSUPOP  SETC  'CART'                                          @D61CDFG 04015761
         AIF   ('&CART' NE '¬').NSUPOP                         @D61CDFG 04016161
&NSUPOP  SETC  'CONSID'                                        @D61CDFG 04016561
         AIF   ('&CONSID' NE '¬').NSUPOP                       @D61CDFG 04016961
&NSUPOP  SETC  'CONSNAME'                                      @D61CDFG 04017361
         AIF   ('&CONSNAME' NE '¬').NSUPOP                     @D61CDFG 04017761
&NSUPOP  SETC  'MCSFLAG'                                       @D61CDFG 04018161
         AIF   ('&MCSFLAG' NE '').NSUPOP                       @D61CDFG 04018561
&NSUPOP  SETC  'RPLYISUR'                                      @D61CDFG 04018961
         AIF   ('&RPLYISUR' NE '¬').NSUPOP                     @D61CDFG 04019361
&NSUPOP  SETC  'TEXT'                                          @D61CDFG 04019761
         AIF   ('&TEXT' NE '¬').NSUPOP                         @D61CDFG 04020161
         AIF   ('&MF' NE 'I').GEN13MF                          @D61CDFG 04020561
&NAME    WTOR123 &MESG,&RYAD,&LENGTH,&ECB,                             X04022561
               ROUTCDE=&ROUTCDE,DESC=&DESC                     @D61CDFG 04022661
         MEXIT                                                 @D61CDFG 04022761
.GEN13MF ANOP                                                  @D61CDFG 04022861
         AIF   ('&MF' EQ 'L' OR '&MESG' NE '' OR                       X04022961
                '&ROUTCDE' NE '' OR '&DESC' NE '').GEN13OK     @D61CDFG 04023061
&NAME    WTOR123 ,&RYAD,&LENGTH,&ECB,MF=&MF                             04023161
         MEXIT                                                 @D61CDFG 04023261
.GEN13OK ANOP                                                  @D61CDFG 04023361
&NAME    WTOR123 &MESG,&RYAD,&LENGTH,&ECB,                             X04023461
               ROUTCDE=&ROUTCDE,DESC=&DESC,MF=&MF              @D61CDFG 04023561
         MEXIT                                                 @D61CDFG 04023661
.NSUPOP  MNOTE 12,'OPERAND OR OPTION ''&NSUPOP'' NOT SUPPORTED ON VSE' X04023761
                                                               @D61CDFG 04024961
         MEXIT                                                 @D61CDFG 04026161
.GEN140  ANOP                                                  @D61CDFG 04027361
&MAXLINS SETA  14                  MAXIMUM NUMBER OF LINES ALLOWED WHEN+04028600
                                   SYNCH = YES                     @L5A 04058300
&MLW     SETB  0                   INITIALIZE MULTILINE FLAG       @P9A 04088000
.********************************************************************** 04117700
.*       INVOKE THE SPLEVEL MACRO TO DETERMINE WHICH FORMAT OF @G860PSS 04147400
.*       THE PARAMETER LIST SHOULD BE BUILT. IF THE MVS/370    @G860PSS 04177100
.*       FORMAT IS REQUIRED, INVOKE THE WTOR7 MACRO.           @G860PSS 04206800
.********************************************************************** 04236500
         SPLEVEL TEST                                          @G860PSS 04266200
         AIF   ('&SYSSPLV' NE '1').NOT370 WHICH FORMAT?        @G860PSS 04295900
&NAME    WTOR7 &MESG,&RYAD,&LENGTH,&ECB,MF=&MF,MSGTYP=&MSGTYP,         X04325600
               ROUTCDE=&ROUTCDE,DESC=&DESC,MCSFLAG=&MCSFLAG,QID=&QID   X04355300
                                                               @G860PSS 04385000
         MEXIT                                                 @G860PSS 04414700
.NOT370  ANOP                                                  @G860PSS 04444400
.********************************************************************** 04474100
.*       DEFINE THE LABEL TO BRANCH TO AFTER THE PARAMETER     @G860PSS 04503800
.*       LIST                                                  @G860PSS 04533500
.********************************************************************** 04563200
&GNAME   SETC  'IHB'.'&SYSNDX'                                          04592900
.********************************************************************** 04622600
.*       SYNTAX CHECK THE LINKAGE AND SYNCH KEYWORDS               @L5A 04652300
.*       ISSUE ERROR MESSAGES WHERE APPROPRIATE                    @L5A 04682000
.********************************************************************** 04711700
         AIF   ('&LINKAGE(1)' EQ '¬').CHKSYNC    LINKAGE NOT NAMED @L5A 04741400
         AIF   ('&LINKAGE(1)' EQ '' AND '&MF' EQ 'L').CHKSYNC      @P5A 04771100
         AIF   ('&LINKAGE(1)' NE 'SVC' AND                             +04800800
                '&LINKAGE(1)' NE 'BRANCH').ERROR10   ISSUE MESSAGE @L5A 04830500
         AIF   ('&LINKAGE(1)' EQ 'BRANCH' AND                          +04860200
                '&SYNCH(1)' NE 'YES').ERROR16        ISSUE MESSAGE @L5A 04889900
         AIF   (N'&LINKAGE LE 1 AND                                    +04919600
                N'&LINKAGE(1) LE 1).CHKSYNC     MORE THAN ONE OPERAND  +04949300
                                                  SPECIFIED?       @L5A 04979000
         MNOTE 4,'*** ''LINKAGE=&LINKAGE'' IS TOO LONG.  ARGUMENTS ARE +05008700
               IGNORED AFTER ''&LINKAGE(1,1)''.'                   @L5A 05038400
.CHKSYNC ANOP                                                           05068100
         AIF   ('&SYNCH(1)' EQ '¬').CHKTXTM        SYNCH NOT NAMED @L5A 05097800
         AIF   ('&SYNCH(1)' NE 'YES' AND                               +05127500
                '&SYNCH(1)' NE 'NO').ERROR12         ISSUE MESSAGE @L5A 05157200
         AIF   ('&SYNCH(1)' EQ 'YES' AND                               +05186900
                '&WQEBLK(1)' NE '¬').ERROR13         ISSUE MESSAGE @L5A 05216600
         AIF   ('&SYNCH(1)' EQ 'YES' AND                               +05246300
               '&MF' NE 'L' AND                                        +05276000
                '&LINKAGE(1)' NE 'BRANCH').ERROR15   ISSUE MESSAGE @P5C 05305700
         AIF   (N'&SYNCH LE 1 AND                                      +05335400
                N'&SYNCH(1) LE 1).CHKTXTM       MORE THAN ONE OPERAND  +05365100
                                                  SPECIFIED?       @L5A 05394800
         MNOTE 4,'*** ''SYNCH=&SYNCH'' IS TOO LONG.  ARGUMENTS ARE IGNO+05424500
               RED AFTER ''&SYNCH(1,1)''.'                         @L5A 05454200
.********************************************************************** 05483900
.*       VERIFY THAT INLINE TEXT AND THE TEXT KEYWORD WERE NOT     @L4A 05513600
.*       BOTH SPECIFIED                                            @L4A 05543300
.********************************************************************** 05573000
.CHKTXTM ANOP                                                      @L5A 05602700
         AIF   ('&TEXT' EQ '¬' OR  '&MESG' EQ '').TEXTOK  BRANCH IF    X05632400
                                           NOT BOTH                @L4A 05662100
         MNOTE 12,'NO TEXT GENERATED. ''TEXT'' AND INLINE TEXT ARE MUTUX05691800
               ALLY EXCLUSIVE.'                                    @L4A 05721500
         MEXIT                                                     @L4A 05751200
.TEXTOK  ANOP                                                      @L4A 05780900
.********************************************************************** 05810600
.*       FILL IN THE REPLY ADDRESS, REPLY LENGTH, ECB AND          @L1A 05840300
.*       REPLY CONSOLE NAME/ID ADDRESS FOR THE WTO MACRO TO USE    @L2C 05870000
.*       IN CASE IT NEEDS TO BUILD A WPX FOR THIS MACRO.           @L1A 05899700
.********************************************************************** 05929400
&RAREG   SETB  0                           INITIALIZE REPLY ADDRESS    X05959100
                                           IN REGISTER INDICATOR   @L1A 05988800
&RLREG   SETB  0                           INITIALIZE REPLY LENGTH     X06018500
                                           IN REGISTER INDICATOR   @L1A 06048200
&EAREG   SETB  0                           INITIALIZE ECB ADDRESS      X06077900
                                           IN REGISTER INDICATOR   @L1A 06107600
&RCNREG  SETB  0                           INITIALIZE REPLY CONSOLE    X06137300
                                           ADDRESS IN REGISTER IND.@L2A 06167000
&RCNSPEC SETB  0                           INITIALIZE REPLY CONSOLE    X06196700
                                           KEYWORD INDICATOR       @L2A 06226400
&TEXTKEY SETB  ('&TEXT' NE '¬' AND '&TEXT' NE '')                  @L4A 06256100
&TEXTVAL SETC  '¬'                         INITIALIZE TEXT ADDRESS @L4A 06285800
         AIF   (&TEXTKEY).TXTVALS          BRANCH IF TEXT KEY USED @L4A 06315500
         AIF   (N'&MESG EQ 1).SINGLIN      CHECK IF MULTI-LINE     @L5A 06345200
&K       SETA  K'&MESG                     INLINE MULTI-LINE TEXT      +06374900
                                           LENGTH INCLUDING PARENS @L5A 06404600
.SINGLIN ANOP                                                           06434300
&WTORYA  SETC  '&RYAD'                     FILL IN REPLY ADDRESS FOR   X06464000
                                           WTO MACRO               @L1A 06493700
&WTOLENR SETC  '&LENGTH'                   FILL IN REPLY LENGTH FOR    X06523400
                                           WTO MACRO           @YA17152 06553100
&WTOECB  SETC  '&ECB'                      FILL IN ECB ADDRESS FOR     X06582800
                                           WTO MACRO               @L1A 06612500
         AGO   .REGVAL                     CONTINUE                @L4A 06642200
.TXTVALS ANOP                              TEXT KEYWORD USED       @L4A 06671900
&TEXTVAL SETC  '&TEXT(1)'                  FILL IN TEXT ADDRESS FOR    X06701600
                                           WTO MACRO               @L4A 06731300
&WTORYA  SETC  '&TEXT(2)'                  FILL IN REPLY ADDRESS FOR   X06761000
                                           WTO MACRO               @L4A 06790700
&WTOLENR SETC  '&TEXT(3)'                  FILL IN REPLY LENGTH FOR    X06820400
                                           WTO MACRO           @YA17152 06850100
&WTOECB  SETC  '&TEXT(4)'                  FILL IN ECB ADDRESS FOR     X06879800
                                           WTO MACRO               @L4A 06909500
.REGVAL  ANOP                                                      @L4A 06939200
         AIF   ('&WTORYA' EQ '').RCNWTO  IF NO REPLY ADDRESS, CHECK    X06968900
                                           FOR REPLY CONS/NAME ID  @L4A 06998600
         AIF   ('&WTORYA'(1,1) NE '(').RCNWTO IF REPLY ADDRESS NOT IN  X07028300
                                           REGISTER, LEAVE AS IS   @L4A 07058000
&RAREG   SETB  1                           REPLY ADDR IN REGISTER  @L1A 07087700
         AIF   (&TEXTKEY).RATEXT           BRANCH IF TEXT KEY USED @L4A 07117400
&WTORYA  SETC  '&RYAD(1)'                  FILL IN REG VALUE OF REPLY  X07147100
                                           ADDRESS FOR WTO MACRO   @L1A 07176800
         AGO   .RCNWTO                     GO CHECK REPLY CONSNAME @L4A 07206500
.RATEXT  ANOP                              REGISTER/TEXT KEYWORD   @L4A 07236200
&K       SETA  K'&WTORYA                   SET LENGTH OF VALUE     @L4A 07265900
&WTORYA  SETC  '&WTORYA'(2,&K-2)           EXTRACT REGISTER VALUE  @L4A 07295600
.RCNWTO  ANOP                              CHECK REPLY CONSOLE NAME@L2A 07325300
&WTORCN  SETC  ''                          SET REPLY CONSOLE NAME/ID   X07355000
                                           TO NO VALUE             @L2A 07384700
         AIF   ('&RPLYISUR' EQ '¬').RLWTO  IF NO REPLY CONSOLE NAME/ID X07414400
                                           CHECK FOR REPLY LENGTH  @L2A 07444100
&RCNSPEC SETB  1                           REPLY CONSOLE NAME/ID ADDR  X07473800
                                           KEYWORD SPECIFIED       @L2A 07503500
         AIF   ('&RPLYISUR' EQ '').RLWTO   IF NO REPLY CONSOLE NAME/ID X07533200
                                           DATA CHECK FOR REPLY LENGTH X07562900
                                                                   @L2A 07592600
         AIF   ('&RPLYISUR'(1,1) NE '(').NOREG  IF RPLY CNSOLE NAME/ID X07622300
                                           NOT IN REGISTER GO SET VALUEX07652000
                                           IN GLOBAL VARIABLE.     @L2A 07681700
&RCNREG  SETB  1                           REPLY CONSOLE NAME/ID ADDR  X07711400
                                           IN REGISTER INDICATOR   @L2A 07741100
&WTORCN  SETC  '&RPLYISUR(1)'              YES,IN REGISTER SET GLOBAL  X07770800
                                           VARIABLE FOR WTO        @L2A 07800500
         AGO   .RLWTO                      CHECK FOR REPLY LENGTH  @L2A 07830200
.NOREG   ANOP                                                      @L2A 07859900
&WTORCN  SETC  '&RPLYISUR'                 NOT IN REGISTER SET GLOBAL  X07889600
                                           VARIABLE FOR WTO        @L2A 07919300
.RLWTO   ANOP                              CHECK REPLY LENGTH      @L1A 07949000
         AIF   ('&WTOLENR' EQ '').EAWTO    IF NO REPLY LENGTH, CHECK   X07978700
                                           FOR ECB ADDRESS     @YA17152 08008400
         AIF   ('&WTOLENR'(1,1) NE '(').EAWTO IF REPLY LENGTH NOT IN A X08038100
                                           REG, LEAVE AS IS    @YA17152 08067800
&RLREG   SETB  1                           REPLY LEN  IN REGISTER  @L1A 08097500
         AIF   (&TEXTKEY).RLTEXT           BRANCH IF TEXT KEY USED @L4A 08127200
&WTOLENR SETC  '&LENGTH(1)'                FILL IN REG VALUE OF REPLY  X08156900
                                           LENGTH FOR WTO      @YA17152 08186600
         AGO   .EAWTO                      GO CHECK ECB ADDRESS    @L4A 08216300
.RLTEXT  ANOP                              REGISTER/TEXT KEYWORD   @L4A 08246000
&K       SETA  K'&WTOLENR                  SET LENGTH OF VALUE @YA17152 08275700
&WTOLENR SETC  '&WTOLENR'(2,&K-2)          EXTRACT REG VALUE   @YA17152 08305400
.EAWTO   ANOP                              CHECK ECB ADDRESS       @L1A 08335100
         AIF   ('&WTOECB' EQ '').DOWQE     IF NO ECB ADDRESS, CHECK    X08364800
                                           FOR WQEBLK              @L4A 08394500
         AIF   ('&WTOECB'(1,1) NE '(').DOWQE IF ECB ADDRESS NOT IN A   X08424200
                                           REGISTER, LEAVE AS IS   @L4A 08453900
&EAREG   SETB  1                           ECB ADDR IN REGISTER    @L1A 08483600
         AIF   (&TEXTKEY).EATEXT           BRANCH IF TEXT KEY USED @L4A 08513300
&WTOECB  SETC  '&ECB(1)'                   FILL IN REG VALUE OF ECB    X08543000
                                           ADDRESS FOR WTO MACRO   @L1A 08572700
         AGO   .DOWQE                      GO CHECK FOR WQEBLK     @L4A 08602400
.EATEXT  ANOP                              REGISTER/TEXT KEYWORD   @L4A 08632100
&K       SETA  K'&WTOECB                   SET LENGTH OF VALUE     @L4A 08661800
&WTOECB  SETC  '&WTOECB'(2,&K-2)           EXTRACT REGISTER VALUE  @L4A 08691500
.DOWQE   ANOP                              CHECK FOR WQEBLK        @L1A 08721200
.********************************************************************** 08750900
.*       MAKE THE FOLLOWING CHECKS:                            @G860PSS 08780600
.*           WQEBLK         - IF NOT SPECIFIED ALONE, ISSUE ERROR  @L1A 08810300
.*                            MESSAGE.  THE WTO MACRO WILL MAKE    @L1A 08840000
.*                            THE REST OF THE EXCLUSIVITY CHECKS.  @L1A 08869700
.*           CONSNAME AND CONSID HAVE NOT BOTH BEEN SPECIFIED      @L2A 08899400
.*           MLWTOR         - IF SO, ISSUE ERROR MESSAGE       @G860PSS 08929100
.*           INLINE REQUEST - IF SO, GO PROCESS                @G860PSS 08958800
.*           LIST REQUEST   - IF SO, GO PROCESS                @G860PSS 08988500
.********************************************************************** 09018200
         AIF   ('&WQEBLK' NE '¬' AND ('&MESG' NE '' OR '&TEXT' NE ''   X09047900
                OR '&RYAD' NE '' OR '&LENGTH' NE '' OR '&RPLYISUR' NE  X09077600
                '¬' OR '&ECB' NE '' OR '&MF' NE 'I')).ERROR8       @L2C 09107300
         AIF   ('&CONSNAME' NE '¬' AND  '&CONSID' NE '¬').ERROR9   @L2A 09137000
.******************************************************************@L5A 09166700
.*       CHECK IF THIS IS A LINKAGE=BRANCH,SYNCH=YES INVOCATION.   @L5A 09196400
.*       MULTI-LINE WTORS ARE ALLOWED ONLY IF SYNCH=YES            @L5A 09226100
.*       OTHERWISE SINGLE-LINE WTORS ONLY.                         @L5A 09255800
.*       IF MULTI-LINE IS ALLOWED CHECK FOR THE MAXIMUM NUMBER OF  @L5A 09285500
.*       LINES ALLOWED AS DEFINED BY VARIABLE &MAXLINS.            @L5A 09315200
.******************************************************************@L5A 09344900
         AIF   ('&SYNCH(1)' NE 'YES').NONSYNC                      @L5A 09374600
         AIF   (N'&SYSLIST(1) GT &MAXLINS).ERROR17    MULTI-LINE ONLY  +09404300
                                           ALLOWED WITH SYNCH=YES  @L5A 09434000
         AIF   (N'&TEXT(1)    GT &MAXLINS).ERROR17    MULTI-LINE ONLY  +09463700
                                           ALLOWED WITH SYNCH=YES  @L5A 09493400
&MLW     SETB  (N'&TEXT(1) GT 1 OR N'&SYSLIST(1) GT 1)  SET MULTI-LINE +09523100
                                           FLAG BIT                @L5A 09552800
         AGO   .CHK4MFI                                            @L5A 09582500
.NONSYNC ANOP                                                      @L5A 09612200
         AIF   (N'&SYSLIST(1) GT 1).ERROR7 ERROR IF MULTI-LINE WTOR     09641900
         AIF   (N'&TEXT(1) GT 1).ERROR7   ERROR IF MULTI-LINE WTOR @L4A 09671600
.CHK4MFI ANOP                                                      @L5A 09701300
         AIF   ('&MF' EQ 'I').IROUT        STANDARD FORM           @L1C 09731000
         AIF   ('&MF' EQ 'L').LROUT        LIST FORM               @L1C 09760700
.********************************************************************** 09790400
.*       CHECK FOR A PARAMETER LIST NAME AND AN EXECUTE FORM.  @G860PSS 09820100
.*       IF NOT VALID, GO ISSUE ERROR MESSAGE                  @G860PSS 09849800
.********************************************************************** 09879500
         AIF   (N'&MF LE 1).ERROR1         ERROR IF BAD MF STRUCTURE    09909200
         AIF   ('&MF(1)' NE 'E').ERROR1    ERROR IF NOT EXECUTE FORM    09938900
.********************************************************************** 09968600
.*                                                             @G860PSS 09998300
.*       EXECUTE FORM                                          @G860PSS 10028000
.*                                                             @G860PSS 10057700
.********************************************************************** 10087400
.********************************************************************** 10117100
.*       SET UP REG1 TO POINT TO THE USER PARM LIST                @L1A 10146800
.********************************************************************** 10176500
&NAME    IHBINNRA &MF(2)                ADDRESS OF PARM LIST INTO R1    10206200
.********************************************************************** 10235900
.*       IF THE THIRD FIELD IN THE MACRO FORMAT KEYWORD IS         @L1A 10265600
.*       BLANK, IT MEANS THAT NO WPX HAS BEEN BUILT SO THE         @L1A 10295300
.*       REPLY ADDRESS, REPLY LENGTH, AND ECB ADDRESS ARE STORED   @L1A 10325000
.*       IN THE WTOR PREFIX IF SPECIFIED.                          @L1A 10354700
.*                                                                      10400000
.*       IF THE THIRD FIELD IN THE MACRO FORMAT KEYWORD IS         @L1A 10410000
.*       'EXTENDED', IT MEANS THAT A WPX HAS BEEN BUILT SO THE     @L1A 10420000
.*       REPLY ADDRESS, REPLY LENGTH, ECB ADDRESS AND OTHER VALID  @L1A 10430000
.*       KEYWORDS ARE STORED INTO THE WPX IF SPECIFIED.            @L1A 10440000
.*                                                                      10450000
.*       IF THE THIRD FIELD IN THE MACRO FORMAT KEYWORD IS         @L1A 10450100
.*       NOT EITHER OF THE ABOVE, AN ERROR MESSAGE IS ISSUED.      @L1A 10450200
.*                                                                 @L4A 10450300
.*       IF THE TEXT KEYWORD HAS BEEN SPECIFIED, ITS VALUE IS      @L4A 10450400
.*       STORED INTO THE PARAMETER LIST INSTEAD OF INLINE TEXT.    @L4A 10450500
.*       IN THIS CASE, THE TEXT KEYWORD IS ASSUMED TO HAVE BEEN    @L4A 10450600
.*       SPECIFIED ON THE LIST FORM OF THE MACRO. THE TEXT         @L4A 10450700
.*       KEYWORD RESULTS IN THE GENERATION OF A WPX.               @L4A 10450800
.********************************************************************** 10450900
         AIF   ('&JOBID'   NE '¬' OR '&JOBNAME' NE '¬' OR              X10451000
                '&KEY'     NE '¬' OR '&TOKEN'   NE '¬' OR              X10451100
                '&SYSNAME' NE '¬').WPXFILL                         @01C 10451200
         AIF   ('&CONSID'  NE '¬' OR '&CART'    NE '¬' OR              X10451300
                '&CONSNAME' NE '¬' OR '&TEXT' NE '¬').WPXFILL      @L4C 10451400
         AIF   ('&RPLYISUR' NE '¬').WPXFILL IF ANY RUN-TIME KEYWORDS   X10451500
                                       ARE SPECIFIED, FILL IN THE PRE  X10451600
                                       BUILT WPX                   @L2C 10451700
         AIF   ('&SYNCH'  NE '¬').WPXFILL                          @P6A 10451800
         AIF   ('&MF(3)' EQ '').OLDFILL STORE IN PREFIX            @L1A 10451900
         AIF   ('&MF(3)' NE 'EXTENDED').ERROR1 INVALID MF TYPE     @L1A 10452000
.********************************************************************** 10452100
.*       THE FOLLOWING CODE WILL SET UP REG14 TO POINT TO THE      @L1A 10452200
.*       BYTE AFTER THE TEXT IN THE WPX.                           @L1A 10452300
.********************************************************************** 10452400
.WPXFILL ANOP                           WILL INSERT INTO WPX       @L1A 10452500
         LR    14,1                     FIRST BYTE OF PARM LIST    @L1A 10452600
         SR    15,15                    CLEAR REG 15               @L1A 10452700
         AH    15,0(1,0)                ADD LENGTH OF TEXT + 4     @L1A 10452800
         AR    14,15                    ADDR OF BYTE AFTER TEXT    @L1A 10452900
.********************************************************************** 10453000
.*       IF THE TEXT KEYWORD IS SPECIFIED, COPY IT INTO THE        @L3A 10453100
.*       PARAMETER LIST                                            @L3A 10453200
.********************************************************************** 10453300
.CHKTEXT AIF   ('&TEXTVAL' EQ '¬').CHEKLEN GO ISSUE SVC            @L4A 10453400
         AIF   ('&TEXTVAL' NE '').TXTDAT VERIFY DATA SPECIFIED     @L4A 10453500
         MNOTE 4,'''TEXT'' KEYWORD IGNORED. NO VALUE SPECIFIED.'   @L4A 10453600
         AGO   .CHEKLEN                 GO CHECK LENGTH            @L4A 10453700
.TXTDAT  ANOP                           DATA SPECIFIED             @L4A 10453800
&EMCS(9) SETB  1                        INDICATE IN EXT MCSFLAGS   @L4A 10453900
         AIF   ('&TEXT(1,2)' EQ '').ETEXTL1    LINE TYPE NOT SPEC. @PDA 10454000
         MNOTE 0,'LINE TYPE ON EXECUTE FORM IGNORED.'              @PDA 10454100
&LTWARN  SETB  1                        ISSUE WARNING ONCE ONLY    @PDA 10454200
.ETEXTL1 ANOP                                                      @PDA 10454300
         AIF   (&MLW).WPXETXT           IF MULTI-LINE MOVE ADDRESSES   +10454400
                                        INTO MINOR OF WPX          @L5A 10454500
         AIF   ('&TEXTVAL'(1,1) EQ '(').TXTREG  TEXT IN REG        @02C 10454600
         LA    15,&TEXTVAL              LOAD TEXT                  @L4A 10454700
         ST    15,4(1,0)                MOVE TEXT INTO PARM LIST   @L4A 10454800
         AGO   .CHEKLEN                 GO CHECK LENGTH            @L4A 10454900
.TXTREG  ANOP                           TEXT IS IN REGISTER        @L4A 10455000
&K       SETA  K'&TEXTVAL                                               10455100
&TEXTVAL SETC  '&TEXTVAL'(2,&K-2)                                       10455200
         ST    &TEXTVAL,4(1,0)          MOVE TEXT INTO PARM LIST   @L4A 10455300
         AGO   .CHEKLEN                 GO CHECK LENGTH            @L4C 10455400
.********************************************************************** 10455500
.*       MOVE THE TEXT ADDRESSES INTO THE PARAMETER LIST           @L5A 10455600
.********************************************************************** 10455700
.WPXETXT ANOP                           MULTI-LINE WTOR W/TEXT     @L5A 10455800
         AIF   ('&TEXT(1,1,1)'(1,1) EQ '(').TXTREG2  TEXT IN REG   @P7C 10455900
         LA    15,&TEXT(1,1,1)          LOAD TEXT                  @P7C 10456000
         ST    15,4(1,0)                MOVE TEXT INTO PARM LIST   @L5A 10456100
         AGO   .WPXTXT2                 GO CHECK LENGTH            @L5A 10456200
.TXTREG2 ANOP                           TEXT IS IN REGISTER        @L5A 10456300
&K       SETA  K'&TEXT(1,1,1)           SET LENGTH WITH PARENS     @02C 10456400
&VALH1   SETC  '&TEXT(1,1,1)'(2,&K-2)   STRIP PARENS               @02C 10456500
         ST    &VALH1,4(1,0)            MOVE TEXT INTO PARM LIST   @L5A 10456600
.WPXTXT2 ANOP                           GO CHECK LENGTH            @L5A 10456700
&MLINDX  SETA  4                        OFFSET TO TEXT ADDRESS     @L5A 10456800
&H       SETA  2                        PROCEED TO SECOND LINE     @L5A 10456900
         AIF   (&H GT N'&TEXT(1)).CHEKLEN LOOP DONE GO CHECK FOR REPLY +10457000
                                        LENGTH SPECIFICATION       @L5A 10457100
         XR    15,15                    CLEAR INDEX FOR INSERTS    @L5A 10457200
         IC    15,3(14)                 SET LENGTH OF WPX          @L5A 10457300
         LA    14,4(15,14)              POINT TO MULTILINE ENTRIES @L5A 10457400
.EMLW00  ANOP                           BEGIN LOOP FOR MINORS      @L5A 10457500
         AIF   (&H GT N'&TEXT(1)).CHEKLEN LOOP DONE GO CHECK FOR REPLY +10457600
                                        LENGTH SPECIFICATION       @L5A 10457700
&VALH    SETC  '&TEXT(1,&H)'            EXTRACT CURRENT VALUE      @L5A 10457800
&VALH1   SETC  '&TEXT(1,&H,1)'          EXTRACT TEXT ADDRESS       @L5A 10457900
&VALH2   SETC  '&TEXT(1,&H,2)'          EXTRACT LINE TYPE          @PDA 10458000
         AIF   ('&VALH2)' EQ '').ETEXTL2       LINE TYPE NOT SPEC. @PDA 10458100
         AIF   (&LTWARN).ETEXTL2        WARNING ALREADY ISSUED     @PDA 10458200
         MNOTE 0,'LINE TYPE ON EXECUTE FORM IGNORED.'              @PDA 10458300
&LTWARN  SETB  1                        ISSUE WARNING ONCE ONLY    @PDA 10458400
.ETEXTL2 ANOP                                                      @PDA 10458500
         AIF   ('&VALH1'  EQ     '').EMLW02 BRANCH IF NULL LINE    @L5A 10458600
         AIF   ('&VALH1'(1,1) EQ '(').EMLW01 BRANCH IF SPECIFIED       +10458700
                                        IN REGISTER                @L5A 10458800
         LA    15,&VALH1                LOAD ADDR OF TEXT FIELD    @L5A 10458900
         ST    15,&MLINDX.(14)          STORE TEXT ADDR INTO PLIST @L5A 10459000
         AGO   .EMLW02                  CONTINUE PROCESSING        @L5A 10459100
.EMLW01  ANOP                           TEXT IN REGISTER           @L5A 10459200
&K       SETA  K'&VALH1                 SET LENGTH OF ARGUMENT     @L5A 10459300
&VALH1   SETC  '&VALH1'(2,&K-2)         STRIP OFF PARENS FROM REG  @L5A 10459400
         ST    &VALH1,&MLINDX.(14)      STORE TEXT ADDRESS         @L5A 10459500
.EMLW02  ANOP                           UPDATE POINTERS            @L5A 10459600
&H       SETA  &H+1                     UPDATE NUMBER OF LINES     @L5A 10459700
&MLINDX  SETA  &MLINDX+8                INDEX TO NEXT PLIST ENTRY  @L5A 10459800
         AGO   .EMLW00                  CONTINUE LOOPING           @L5A 10459900
.********************************************************************** 10460000
.*       IF THE LENGTH IS SPECIFIED, COPY IT INTO THE              @L1A 10460100
.*       PARAMETER LIST                                            @L1A 10460200
.********************************************************************** 10460300
.CHEKLEN AIF   ('&WTOLENR' EQ '').CHEKRPY GO CHECK REPLY ADDR  @YA17152 10460400
         AIF   (&RLREG).LENREG          LENGTH IN REG              @L4C 10460500
         MVI   2(14),&WTOLENR           MOVE LENGTH INTO PARAMETER     X10460600
                                        LIST                   @YA17152 10460700
         AGO   .CHEKRPY                 GO CHECK REPLY ADDRESS     @L1A 10460800
.LENREG  STC   &WTOLENR,2(14,0)         MOVE LENGTH INTO PARAMETER     X10460900
                                        LIST                   @YA17152 10461000
.********************************************************************** 10461100
.*       IF THE REPLY ADDRESS IS SPECIFIED, COPY IT INTO THE       @L1A 10461200
.*       PARAMETER LIST                                            @L1A 10461300
.********************************************************************** 10461400
.CHEKRPY AIF   ('&WTORYA' EQ '').CHEKRCN GO CHECK RPLY CONS NAME   @L4C 10461500
         AIF   (&RAREG).RPYREG          REPLY ADDRESS IN REG       @L4C 10461600
         LA    15,&WTORYA               OBTAIN REPLY ADDRESS       @L4C 10461700
         ST    15,8(14,0)               MOVE REPLY ADDRESS INTO PARM   X10461800
                                        LIST                       @L1A 10461900
         AGO   .CHEKRCN                 GO CHECK REPLY CONSOLE NAME@L2C 10462000
.RPYREG  ST    &WTORYA,8(14,0)          MOVE REPLY ADDRESS INTO PARM   X10462100
                                        LIST                       @L4C 10462200
.********************************************************************** 10462300
.*       IF THE REPLY CONSOLE NAME/ID ADDRESS IS SPECIFIED, THEN   @L2A 10462400
.*       IT INTO THE PARAMETER LIST                                @L2A 10462500
.********************************************************************** 10462600
.CHEKRCN AIF   ('&RPLYISUR' EQ '¬').CHEKECB  GO CHECK ECB ADDRESS  @L2A 10462700
         AIF   ('&RPLYISUR' NE '').RCNDAT VERIFY DATA SPECIFIED    @L2A 10462800
         MNOTE 4,'''RPLYISUR'' KEYWORD IGNORED. NO VALUE SPECIFIED.'   X10462900
                                                                   @L2A 10463000
         AGO   .CHEKECB                 GO CHECK ECB ADDRESS       @L2A 10463100
.RCNDAT  ANOP                                                      @L2A 10463200
         AIF   ('&RPLYISUR'(1,1) EQ '(').RCNREG  REPLY CONSOLE NAME/ID X10463300
                                        ADDRESS IN REGISTER        @L2A 10463400
         LA    15,&RPLYISUR             OBTAIN REPLY CONSOLE NAME/ID   X10463500
                                        ADDRESS                    @L2A 10463600
         ST    15,92(14,0)              MOVE REPLY CONSOLE NAME/ID     X10463700
                                        ADDRESS IN PARM LIST       @L2A 10463800
         AGO   .CHEKECB                 GO CHECK ECB ADDRESS       @L2A 10463900
.RCNREG  ST    &RPLYISUR(1),92(14,0)    MOVE REPLY CONSOLE NAME/ID     X10464000
                                        ADDRESS IN PARM LIST       @L2A 10464100
.********************************************************************** 10464200
.*       IF THE ECB ADDRESS IS SPECIFIED, COPY IT INTO THE         @L1A 10464300
.*       PARAMETER LIST                                            @L1A 10464400
.********************************************************************** 10464500
.CHEKECB AIF   ('&WTOECB' EQ '').CHEKCON GO CHECK CONSID           @L4C 10464600
         AIF   (&EAREG).ECBREG          ECB ADDRESS IN REG         @L4C 10464700
         LA    15,&WTOECB               LOAD ECB ADDRESS           @L4C 10464800
         ST    15,12(14,0)              MOVE ECB ADDRESS INTO PARM     X10464900
                                        LIST                       @L1A 10465000
         AGO   .CHEKCON                 GO CHECK CONSID            @L1A 10465100
.ECBREG  ST    &WTOECB,12(14,0)         MOVE ECB ADDRESS INTO PARM     X10465200
                                        LIST                       @L4C 10465300
.********************************************************************** 10465400
.*       IF THE CONSID IS SPECIFIED, COPY IT INTO THE              @L1A 10465500
.*       PARAMETER LIST                                            @L1A 10465600
.********************************************************************** 10465700
.CHEKCON AIF   ('&CONSID' EQ '¬').CHKCNNA GO CHECK CONSNAME        @L2C 10465800
         AIF   ('&CONSID' NE '').CONDAT VERIFY DATA SPECIFIED      @L1A 10465900
         MNOTE 4,'''CONSID'' KEYWORD IGNORED. NO VALUE SPECIFIED.' @L1A 10466000
         AGO   .CHKCNNA                 GO CHECK CONSNAME          @L2C 10466100
.CONDAT  ANOP                           DATA SPECIFIED             @L1A 10466200
&EMCS(2) SETB  1                        INDICATE IN EXT MCSFLAGS   @L1A 10466300
         AIF   ('&CONSID'(1,1) EQ '(').CONREG CONSID IN REG        @L1A 10466400
         L     15,&CONSID               LOAD CONSID                @L1A 10466500
         ST    15,72(14,0)              MOVE CONSID INTO PARM LIST @L1A 10466600
         AGO   .CHKCNNA                 GO CHECK CONSNAME          @L2C 10466700
.CONREG  ST    &CONSID(1),72(14,0)      MOVE CONSID INTO PARM LIST @L1A 10466800
.********************************************************************** 10466900
.*       IF THE CONSNAME IS SPECIFIED, COPY IT INTO THE            @L2A 10467000
.*       PARAMETER LIST                                            @L2A 10467100
.********************************************************************** 10467200
.CHKCNNA AIF   ('&CONSNAME' EQ '¬').CHEKJOB GO CHECK JOBID         @L2A 10467300
         AIF   ('&CONSNAME' NE '').CNNADT VERIFY DATA SPECIFIED    @L2A 10467400
         MNOTE 4,'''CONSNAME'' KEYWORD IGNORED. NO VALUE SPECIFIED.'   X10467500
                                                                   @L2A 10467600
         AGO   .CHEKJOB                 GO CHECK JOBID             @L2A 10467700
.CNNADT  ANOP                           DATA SPECIFIED             @L2A 10467800
&EMCS(7) SETB  1                        INDICATE IN EXT MCSFLAGS   @L1A 10467900
         AIF   ('&CONSNAME'(1,1) EQ '(').CNNAREG CONSNAME IN REG   @L2A 10468000
         MVC   84(8,14),&CONSNAME(1)     MOVE CONSNAME INTO LIST   @L2A 10468100
         AGO   .CHEKJOB                 GO CHECK JOBID             @L2A 10468200
.CNNAREG MVC   84(8,14),0(&CONSNAME(1))  MOVE CONSNAME INTO LIST   @L2A 10468300
.********************************************************************** 10468400
.*       IF THE JOBID IS SPECIFIED, COPY IT INTO THE               @L1A 10468500
.*       PARAMETER LIST                                            @L1A 10468600
.********************************************************************** 10468700
.CHEKJOB AIF   ('&JOBID' EQ '¬').CHKJOB2 GO CHECK JOBNAME          @L1A 10468800
         AIF   ('&JOBID' NE '').JOBDAT  VERIFY DATA SPECIFIED      @L1A 10468900
         MNOTE 4,'''JOBID'' KEYWORD IGNORED. NO VALUE SPECIFIED.'  @L1A 10469000
         AGO   .CHKJOB2                 GO CHECK JOBNAME           @L1A 10469100
.JOBDAT  ANOP                           DATA SPECIFIED             @L1A 10469200
         AIF   ('&JOBID'(1,1) EQ '(').JOBREG JOBID IN REG          @L1A 10469300
         MVC   44(8,14),&JOBID(1)       MOVE JOBID INTO PARM LIST  @L1A 10469400
         AGO   .CHKJOB2                 GO CHECK JOBNAME           @L1A 10469500
.JOBREG  MVC   44(8,14),0(&JOBID(1))    MOVE JOBID INTO PARM LIST  @L1A 10469600
.********************************************************************** 10469700
.*       IF THE JOBNAME IS SPECIFIED, COPY IT INTO THE             @L1A 10469800
.*       PARAMETER LIST                                            @L1A 10469900
.********************************************************************** 10470000
.CHKJOB2 AIF   ('&JOBNAME' EQ '¬').CHEKKEY GO CHECK KEY            @L1A 10470100
         AIF   ('&JOBNAME' NE '').JOBDAT2 VERIFY DATA SPECIFIED    @L1A 10470200
         MNOTE 4,'''JOBNAME'' KEYWORD IGNORED. NO VALUE SPECIFIED.'    X10470300
                                                                   @L1A 10470400
         AGO   .CHEKKEY                 GO CHECK KEY               @L1A 10470500
.JOBDAT2 ANOP                           DATA SPECIFIED             @L1A 10470600
         AIF   ('&JOBNAME'(1,1) EQ '(').JOBREG2 JOBNAME IN REG     @L1A 10470700
         MVC   52(8,14),&JOBNAME(1)     MOVE JOBNAME INTO LIST     @L1A 10470800
         AGO   .CHEKKEY                 GO CHECK KEY               @L1A 10470900
.JOBREG2 MVC   52(8,14),0(&JOBNAME(1))  MOVE JOBNAME INTO LIST     @L1A 10471000
.********************************************************************** 10471100
.*       IF THE KEY IS SPECIFIED, COPY IT INTO THE                 @L1A 10471200
.*       PARAMETER LIST                                            @L1A 10471300
.********************************************************************** 10471400
.CHEKKEY AIF   ('&KEY' EQ '¬').CHEKTOK  GO CHECK TOKEN             @L1A 10471500
         AIF   ('&KEY' NE '').KEYDAT    VERIFY DATA SPECIFIED      @L1A 10471600
         MNOTE 4,'''KEY'' KEYWORD IGNORED. NO VALUE SPECIFIED.'    @L1A 10471700
         AGO   .CHEKTOK                 GO CHECK TOKEN             @L1A 10471800
.KEYDAT  ANOP                           DATA SPECIFIED             @L1A 10471900
         AIF   ('&KEY'(1,1) EQ '(').KEYREG KEY IN REG              @L1A 10472000
         MVC   60(8,14),&KEY(1)         MOVE KEY INTO PARM LIST    @L1A 10472100
         AGO   .CHEKTOK                 GO ISSUE SVC               @L1A 10472200
.KEYREG  MVC   60(8,14),0(&KEY(1))      MOVE KEY INTO PARM LIST    @L1A 10472300
.********************************************************************** 10472400
.*       IF THE TOKEN IS SPECIFIED, COPY IT INTO THE               @L1A 10472500
.*       PARAMETER LIST                                            @L1A 10472600
.********************************************************************** 10472700
.CHEKTOK AIF   ('&TOKEN' EQ '¬').CHEKSYS GO CHECK SYSNAME          @L1A 10472800
         AIF   ('&TOKEN' NE '').TOKDAT  VERIFY DATA SPECIFIED      @L1A 10472900
         MNOTE 4,'''TOKEN'' KEYWORD IGNORED. NO VALUE SPECIFIED.'  @L1A 10473000
         AGO   .CHEKSYS                 GO CHECK SYSNAME           @L1A 10473100
.TOKDAT  ANOP                           DATA SPECIFIED             @L1A 10473200
         AIF   ('&TOKEN'(1,1) EQ '(').TOKREG TOKEN IN REG          @L1A 10473300
         L     15,&TOKEN                LOAD TOKEN                 @L1A 10473400
         ST    15,68(14,0)              MOVE TOKEN INTO PARM LIST  @L1A 10473500
         AGO   .CHEKSYS                 GO CHECK SYSNAME           @L1A 10473600
.TOKREG  ST    &TOKEN(1),68(14,0)       MOVE TOKEN INTO PARM LIST  @L1A 10473700
.********************************************************************** 10473800
.*       IF THE SYSNAME IS SPECIFIED, COPY IT INTO THE             @L1A 10473900
.*       PARAMETER LIST                                            @L1A 10474000
.********************************************************************** 10474100
.CHEKSYS AIF   ('&SYSNAME' EQ '¬').CHKCART GO CHECK CART           @01C 10474200
         AIF   ('&SYSNAME' NE '').SYSDAT VERIFY DATA SPECIFIED     @L1A 10474300
         MNOTE 4,'''SYSNAME'' KEYWORD IGNORED. NO VALUE SPECIFIED.'    X10474400
                                                                   @L1A 10474500
         AGO   .CHKCART                  GO CHECK CART             @01C 10474600
.SYSDAT  ANOP                           DATA SPECIFIED             @L1A 10474700
         AIF   ('&SYSNAME'(1,1) EQ '(').SYSREG SYSNAME IN REG      @L1A 10474800
         MVC   76(8,14),&SYSNAME(1)     MOVE SYSNAME INTO PARM LIST@L1A 10474900
         AGO   .CHKCART                 GO CHECK CART              @01C 10475000
.SYSREG  MVC   76(8,14),0(&SYSNAME(1))  MOVE SYSNAME INTO PARM LIST@L1A 10475100
.********************************************************************** 10475200
.*       IF THE CART IS SPECIFIED, COPY IT INTO THE                @L3A 10475300
.*       PARAMETER LIST                                            @L3A 10475400
.********************************************************************** 10475500
.CHKCART AIF   ('&CART' EQ '¬').CHKSYN  GO CHECK SYNCH             @P6C 10475600
         AIF   ('&CART' NE '').CRTDAT VERIFY DATA SPECIFIED        @L3A 10475700
         MNOTE 4,'''CART'' KEYWORD IGNORED. NO VALUE SPECIFIED.'   @L3A 10475800
         AGO   .CHKSYN                  GO CHECK SYNCH             @P6C 10475900
.CRTDAT  ANOP                           DATA SPECIFIED             @L3A 10476000
         AIF   ('&CART'(1,1) EQ '(').CRTREG    CART IN REG         @L3A 10476100
         LA    15,&CART                 LOAD CART                  @L3A 10476200
         ST    15,96(14,0)              MOVE CART INTO PARM LIST   @L3A 10476300
         AGO   .CHKSYN                  GO CHECK SYNCH             @P6C 10476400
.CRTREG  ST    &CART(1),96(14,0)        MOVE CART INTO PARM LIST   @L3A 10476500
         AGO   .CHKSYN                  GO CHECK SYNCH             @P6C 10476600
.********************************************************************** 10476700
.*       IF SYNCH=YES IS SPECIFIED, SET THE CORRECT EMCSFLAG       @P6A 10476800
.********************************************************************** 10476900
.CHKSYN  AIF   ('&SYNCH(1)' EQ '¬').ESVC GO INVOKE WTOR            @P6A 10477000
         AIF   ('&SYNCH(1)' NE '').SYNDAT VERIFY DATA SPECIFIED    @P6A 10477100
         MNOTE 4,'''SYNCH'' KEYWORD IGNORED. NO VALUE SPECIFIED.'  @P6A 10477200
         AGO   .ESVC                    GO INVOKE WTOR             @P6A 10477300
.SYNDAT  ANOP                           DATA SPECIFIED             @P6A 10477400
         AIF   ('&SYNCH(1)' NE 'YES').ESVC                         @P6A 10477500
&EMCS(14) SETB  1           SET SYNCH BIT ON IN EMCS               @P6A 10477600
.********************************************************************** 10477700
.*       NO WPX HAS BEEN BUILT, SO STORE THE REPLY ADDRESS, REPLY  @L1A 10477800
.*       LENGTH, AND ECB ADDRESS IN THE WTOR PREFIX IF THEY ARE    @L1A 10477900
.*       SPECIFIED.                                                @L1A 10478000
.********************************************************************** 10478100
.********************************************************************** 10478200
.*       IF REPLY ADDRESS SPECIFIED, STORE VALUE IN PARAMETER  @G860PSS 10478300
.*       LIST                                                  @G860PSS 10478400
.********************************************************************** 10478500
.OLDFILL AIF   ('&RYAD' EQ '').EECBCK   BR IF NO REPLY ADDR        @L1C 10478600
         AIF   ('&RYAD'(1,1) EQ '(').ERPYREG BR IF REPLY ADDR IN A     X10478700
                                        REG                    @G860PSS 10478800
         LA    15,&RYAD                 LOAD REPLY ADDR        @G860PSS 10478900
         ST    15,0(1,0)                STORE RPLY ADDR        @G860PSS 10479000
         AGO   .EHIGHBT                 GO SET HIGH BIT        @G860PSS 10479100
.********************************************************************** 10479200
.*       REPLY ADDRESS WAS IN A REGISTER                       @G860PSS 10479300
.********************************************************************** 10479400
.ERPYREG ST    &RYAD(1),0(1,0)          STORE REPLY ADDR       @G860PSS 10479500
.********************************************************************** 10479600
.*       SET HIGH BIT IN PARAMETER LIST TO INDICATE A WTOR     @G860PSS 10479700
.********************************************************************** 10479800
.EHIGHBT OI    0(1),X'80'               INDICATE WTOR          @G860PSS 10479900
.********************************************************************** 10480000
.*       IF THE ECB ADDRESS WAS SPECIFIED, PUT IT IN THE       @G860PSS 10480100
.*       PARAMETER LIST                                        @G860PSS 10480200
.********************************************************************** 10480300
.EECBCK  AIF   ('&ECB' EQ '').ELENCK    BR IF NO ECB ADDR      @G860PSS 10480400
         AIF   ('&ECB'(1,1) EQ '(').EECBREG BR IF ECB ADDR IS IN A     X10480500
                                        REG                    @G860PSS 10480600
         LA    14,&ECB                  LOAD ADDRESS OF ECB    @G860PSS 10480700
         ST    14,4(1,0)                STORE ECB ADDRESS      @G860PSS 10480800
         AGO   .ELENCK                  GO CHECK FOR LENGTH    @G860PSS 10480900
.********************************************************************** 10481000
.*       ECB IS IN A REG SO STORE IT IN THE PARAMETER LIST     @G860PSS 10481100
.********************************************************************** 10481200
.EECBREG ST    &ECB(1),4(1,0)           STORE ECB ADDRESS      @G860PSS 10481300
.********************************************************************** 10481400
.*       IF THE LENGTH IS SPECIFIED, COPY IT INTO THE          @G860PSS 10481500
.*       PARAMETER LIST                                        @G860PSS 10481600
.********************************************************************** 10481700
.ELENCK  AIF   ('&LENGTH' EQ '').EQIDCK BR IF NO LENGTH        @G860PSS 10481800
         AIF   ('&LENGTH'(1,1) EQ '(').ELENREG BR IF LENGTH IN A       X10481900
                                        REGISTER               @G860PSS 10482000
         MVI   8(1),&LENGTH             STORE REPLY LENGTH     @G860PSS 10482100
         AGO   .EQIDCK                  GO CHECK THE QID       @G860PSS 10482200
.********************************************************************** 10482300
.*       LENGTH SPECIFIED IN A REGISTER                        @G860PSS 10482400
.********************************************************************** 10482500
.ELENREG STC   &LENGTH(1),8(1,0)        STORE REPLY LENGTH     @G860PSS 10482600
.********************************************************************** 10482700
.*       WAS THE QID SPECIFIED?                                @G860PSS 10482800
.********************************************************************** 10482900
.EQIDCK  ANOP                           QID PROCESSING         @G860PSS 10483000
         AIF   (T'&QID EQ 'O').ESVC     BR IF NO QID           @G860PSS 10483100
         LA    14,8(1,0)                ADDR OF PARM LIST        YM1995 10483200
         SR    15,15                    CLEAR REGISTER         @G860PSS 10483300
         IC    15,9(1,0)                LENGTH OF TEXT + 4     @G860PSS 10483400
         AR    14,15                    ADDR OF BYTE AFTER TEXT        X10483500
                                                               @G860PSS 10483600
         AIF   ('&QID'(1,1) EQ '(').EQIDREG BR IF QID IN REG   @G860PSS 10483700
         MVC   6(2,14),&QID             QID FIELD                X02050 10483800
         AGO   .ESVC                    GO ISSUE SVC           @G860PSS 10483900
.********************************************************************** 10484000
.*       THE QID IS IN A REGISTER                              @G860PSS 10484100
.********************************************************************** 10484200
.EQIDREG ANOP                                                  @G860PSS 10484300
         MVC   6(2,14),0(&QID(1))       QID FIELD                X02050 10484400
.********************************************************************** 10484500
.*       CHECK TO SEE IF ANY OF THE EXTENDED MCSFLAGS NEEDS TO     @L1C 10484600
.*       BE SET                                                    @L1C 10484700
.********************************************************************** 10484800
.ESVC    ANOP                                                  @G860PSS 10484900
         AIF   (NOT &EMCS(2) AND NOT &EMCS(7) AND NOT &EMCS(9) AND     X10485000
                NOT &EMCS(14)).ESYNC                 IF CONSID OR NAME X10485100
                          OR SYNCH=YES SPECIFIED                   @01C 10485200
.********************************************************************** 10485300
.*       TURN ON THE EXTENDED MCSFLAGS WHICH MAY NEED TO BE        @L1A 10485400
.*       SET IF IT IS THE EXECUTE FORM OF THE MACRO                @L1A 10485500
.********************************************************************** 10485600
         OI    4(14),B'&EMCS(1)&EMCS(2)&EMCS(3)&EMCS(4)&EMCS(5)&EMCS(6)X10485700
               &EMCS(7)&EMCS(8)'        SET EXTENDED MCS FLAGS     @L1A 10485800
         OI    5(14),B'&EMCS(9)&EMCS(10)&EMCS(11)&EMCS(12)&EMCS(13)&EMCX10485900
               S(14)&EMCS(15)&EMCS(16)' SET EXTENDED MCS FLAGS2    @L4A 10486000
.ESYNC   AIF   ('&SYNCH(1)' NE 'NO').ESVC2  IF SYNCH=NO SPECIFIED, @P6A 10486100
         NI    5(14),B'11111011'        TURN OFF SYNCH BIT         @P6A 10486200
.ESVC2   AGO   .EXECUTE                 ISSUE WTOR SVC             @L5C 10486300
.********************************************************************** 10486400
.*                                                             @G860PSS 10486500
.*       LIST FORM IS REQUESTED                                @G860PSS 10486600
.*                                                             @G860PSS 10486700
.********************************************************************** 10486800
.LROUT   ANOP                                                           10486900
         AIF   ('&MESG' EQ '' AND ('&TEXT' EQ '¬' OR                   X10487000
                '&TEXT' EQ '')).ERROR2  ERROR IF                       X10487100
                                      NO MESSAGE TEXT SPECIFIED    @PCC 10487200
         AIF   (&RAREG).ERROR3                  ERROR IF REPLY ADDRESS X10487300
                                      SPECIFIED IN A REGISTER      @L4C 10487400
         AIF   (&EAREG).ERROR3                  ERROR IF REPLY ADDRESS X10487500
                                      SPECIFIED IN A REGISTER      @L4C 10487600
         AIF   (&RLREG).ERROR3                  ERROR IF REPLY ADDRESS X10487700
                                      SPECIFIED IN A REGISTER      @L4C 10487800
&NAME    DS    0F                                                       10487900
.********************************************************************** 10488000
.*                                                                      10500000
.*       INVOKE THE WTO MACRO.  IF THE WTO MACRO DETERMINES        @L1A 10550000
.*       THAT A WPX NEEDS TO BE BUILT, IT WILL GENERATE THE        @L1A 10600000
.*       ENTIRE PARAMETER LIST FOR THE WTOR MACRO AND RETURN.      @L1A 10650000
.*       IN THIS SITUATION, THIS MACRO WILL JUST RETURN SINCE      @L1A 10700000
.*       NO MORE PROCESSING NEEDS TO BE DONE.                      @L1A 10750000
.*                                                                      12400000
.*       IF THE WTO MACRO DETERMINES THAT NO WPX NEEDS TO BE       @L1A 12428500
.*       BUILT, THEN IT WILL NOT GENERATE THE PARAMETER LIST       @L1A 12457000
.*       BUT WILL SET UP THE FIELDS THAT THIS MACRO NEEDS          @L1A 12485500
.*       IN ORDER TO GENERATE THE PARAMETER LIST. IN THIS          @L1A 12514000
.*       SITUATION, WTOR GENERATES THE ENTIRE PARAMETER LIST       @L1A 12542500
.*       STARTING WITH THE WTOR PREFIX.                            @L1A 12571000
.*                                                                      12600000
.********************************************************************** 12604000
&IHBWTOR SETB  1                                                   @L1C 12608000
         WTO   &MESG,MF=&MF,MSGTYP=&MSGTYP,ROUTCDE=&ROUTCDE,DESC=&DESC,X12612000
               MCSFLAG=&MCSFLAG,QID=&QID,WQEBLK=&WQEBLK,CONSID=&CONSID,X12616000
               JOBID=&JOBID,KEY=&KEY,TOKEN=&TOKEN,SYSNAME=&SYSNAME,    X12620000
               JOBNAME=&JOBNAME,                                       X12624000
               CONSNAME=&CONSNAME,CART=&CART,TEXT=&TEXT(1),            +12628000
               LINKAGE=&LINKAGE,SYNCH=&SYNCH                       @01C 12632000
&IHBWTOR SETB  0                                                   @L1C 12636000
         AIF   (&IWPXBIT OR                                            X12640000
                &WTOERR).END          JUST EXIT IF WTO EITHER BUILT A  X12644000
                                      WPX OR ISSUED A SEVERE MNOTE @L1C 12648000
.********************************************************************** 12652000
.*       IF THE REPLY ADDRESS IS NOT SPECIFIED, USE A 0. IF        @P4A 12656000
.*       THE REPLY ADDRESS IS IN A REGISTER, REJECT WITH           @P4A 12660000
.*       ERROR MESSAGE SINCE IT IS NOT ALLOWED FOR THE LIST        @P4A 12664000
.*       FORM                                                      @P4A 12668000
.********************************************************************** 12672000
         AIF   ('&RYAD' EQ '').LRPY0    BR IF NO REPLY ADDR        @P4A 12676000
         DC    A(X'80000000'+&RYAD)     REPLY ADDRESS              @P4A 12680000
         AGO   .LECBCK                  GO CHECK FOR ECB ADDR      @P4A 12684000
.LRPY0   DC    A(0)                     REPLY ADDRESS              @P4A 12688000
.********************************************************************** 12692000
.*       IF THE ECB ADDRESS IS NOT SPECIFIED, USE A 0. IF          @P4A 12696000
.*       THE ECB ADDRESS IS IN A REGISTER, REJECT WITH             @P4A 12700000
.*       ERROR MESSAGE SINCE IT IS NOT ALLOWED FOR THE LIST        @P4A 12704000
.*       FORM                                                           12708000
.********************************************************************** 12712000
.LECBCK  AIF   ('&ECB' EQ '').LECB0     BR IF NO ECB ADDR          @P4A 12716000
         DC    A(&ECB)                  ECB ADDRESS                @P4A 12720000
         AGO   .LLENCK                  GO CHECK FOR LENGTH        @P4A 12724000
.LECB0   DC    A(0)                     ECB ADDRESS                @P4A 12728000
.********************************************************************** 12732000
.*       IF THE LENGTH IS NOT SPECIFIED, USE A 0. IF THE       @G860PSS 12736000
.*       LENGTH IS IN A REGISTER, REJECT WITH ERROR MESSAGE    @G860PSS 12740000
.*       SINCE IT IS NOT ALLOWED FOR THE LIST FORM.            @G860PSS 12744000
.********************************************************************** 12748000
.LLENCK  AIF   ('&LENGTH' EQ '').LLEN0  BR IF NO LENGTH        @G860PSS 12752000
         DC    AL1(&LENGTH)             REPLY LENGTH           @G860PSS 12756000
         AGO   .BUILDIT                 BUILD REST OF PARM LIST    @L1C 12760000
.LLEN0   DC    AL1(0)                   REPLY LENGTH           @G860PSS 12764000
.********************************************************************** 12768000
.*       BUILD THE TEXT LENGTH FIELD                               @L1A 12772000
.********************************************************************** 12776000
.BUILDIT AIF   ('&SYSSPLV' NE '1').ONELEN IF 370, DC FOR 1 BYTE    @L1A 12780000
         DC    AL2(&IHBLEN)             TEXT LENGTH + 4        @YA17152 12784000
         AGO   .GENMCS                  GO BUILD MCS FLAGS         @L1A 12788000
.ONELEN  ANOP                           THIS IS MVS/370            @L1A 12792000
         DC    AL1(&IHBLEN)             TEXT LENGTH + 4        @YA17152 12796000
.********************************************************************** 12800000
.*       BUILD THE MCS FLAGS                                       @L1A 12804000
.********************************************************************** 12808000
.GENMCS  ANOP                                                      @L1A 12812000
         DC    B'&CD(7)&CD(8)'          MCSFLAGS                   @L1A 12816000
         AIF   (&IHBLEN EQ 4).SKIPDC    SKIP DC IF NO TEXT     @YA17152 12820000
.********************************************************************** 12824000
.*       BUILD THE MESSAGE TEXT                                    @L1A 12828000
.********************************************************************** 12832000
         DC    C&ILMEQU                 MESSAGE TEXT               @PBC 12836000
.SKIPDC  AIF   (NOT &IHBMCS).CHECKMF    DONT DECLARE ROUTING/DESC CODE X12840000
                                        IF NONE SPECIFIED      @YA17152 12844000
.********************************************************************** 12848000
.*       BUILD THE DESCRIPTOR CODES                                @L1A 12852000
.********************************************************************** 12856000
         DC    B'&CD(1)&CD(2)'          DESCRIPTOR CODES           @L1A 12860000
.********************************************************************** 12864000
.*       BUILD THE ROUTING CODES                                   @L1A 12868000
.********************************************************************** 12872000
         DC    B'&CD(3)&CD(4)'          ROUTING CODES              @L1A 12876000
         AIF   ('&MSGTYP(1)' NE 'Y' AND NOT &SWM).CHECKMF          @L1A 12880000
.********************************************************************** 12884000
.*       BUILD THE MESSAGE TYPE FIELD                              @L1A 12888000
.********************************************************************** 12892000
         DC    B'&CD(5)&CD(6)'          MESSAGE TYPE               @L1A 12896000
         AIF   (T'&QID EQ 'O' OR '&QID(1)' EQ 'N').CHECKMF         @L1A 12900000
         AIF   (T'&QID EQ 'N').GENDCS1                             @L1A 12904000
         AIF   ('&QID(1)' EQ 'Y').GENDCS0                          @L1A 12908000
         MNOTE 4,'QID FIELD IS INVALID. ZERO ASSUMED.'             @L1A 12912000
.********************************************************************** 12916000
.*       BUILD THE QID FIELD                                       @L1A 12920000
.********************************************************************** 12924000
.GENDCS0 ANOP                           DECLARE QID VALUE OF 0     @L1A 12928000
         DC    AL2(0)                   QID FIELD                  @L1A 12932000
         AGO   .CHECKMF                 CHECK MACRO FORMAT         @L1A 12936000
.GENDCS1 ANOP                           DECLARE QID WITH DATA      @L1A 12940000
         DC    AL2(&QID)                QID FIELD                  @L1A 12944000
.********************************************************************** 12948000
.*       IF AN INLINE REQUEST, CONTINUE GENERATING THE CODE.   @G860PSS 12952000
.********************************************************************** 12956000
.CHECKMF AIF   ('&MF' EQ 'I').IRETURN      IF STANDARD FORM, INSERT    X12960000
                                           ANY REGISTER VALUES     @L1C 12964000
         AGO   .END                        LIST FORM. GO TO END.        12968000
.********************************************************************** 12972000
.*                                                             @G860PSS 12976000
.*       THIS IS AN INLINE REQUEST. THE CNOP AND BAL INSTRUCTIONS  @L1C 12980000
.*       OCCUR FOR ALL WTORS IN THIS MACRO BUT THE DS INSTRUCTION  @L1A 12984000
.*       (AFTER PARAMETER LIST GENERATION) IS DONE HERE ONLY FOR   @L1A 12988000
.*       WTORS WHERE A WPX DOES NOT EXIST AND WQEBLK WAS NOT       @L1A 12992000
.*       SPECIFIED.                                                @L1A 12996000
.*                                                             @G860PSS 13000000
.********************************************************************** 13004000
.IROUT   AIF   ('&WQEBLK' NE '¬').WQEB  IF WQEBLK SPECIFIED, LET THE   X13008000
                                        WTO MACRO DO CNOP AND BAL  @P1C 13012000
         AIF   ('&WTORYA' EQ '').ERROR5 ERROR IF NO REPLY ADDRESS  @L4A 13016000
         AIF   ('&WTOECB' EQ '').ERROR6 ERROR IF NO ECB ADDRESS    @L4A 13020000
         AIF   ('&WTOLENR' EQ '').ERROR4 ERROR IF NO REPLY LENGTH      X13024000
                                                               @YA17152 13028000
         CNOP  0,4                                                      13032000
&NAME    BAL   1,&GNAME.A               BRANCH AROUND LIST              13036000
.WQEB    ANOP                           SET UP TO INVOKE WTO MACRO @L1A 13040000
.********************************************************************** 13044000
.*                                                                      13050000
.*       INVOKE THE WTO MACRO.  IF THE WTO MACRO DETERMINES        @L1A 13100000
.*       THAT A WPX NEEDS TO BE BUILT, IT WILL GENERATE THE        @L1A 13150000
.*       ENTIRE PARAMETER LIST, ISSUE THE SVC AND RETURN.          @L1A 13200000
.*       IN THIS SITUATION, THIS MACRO WILL JUST RETURN SINCE      @L1A 13250000
.*       NO MORE PROCESSING NEEDS TO BE DONE.                      @L1A 13300000
.*                                                                      13350000
.*       IF THE WTO MACRO DETERMINES THAT NO WPX NEEDS TO BE       @L1A 13400000
.*       BUILT, THEN IT WILL NOT GENERATE THE PARAMETER LIST       @L1A 13450000
.*       BUT WILL SET UP THE FIELDS THAT THIS MACRO NEEDS IN       @L1A 13500000
.*       ORDER TO GENERATE THE PARAMETER LIST AND ISSUE THE        @L1A 13550000
.*       SVC.  IN THIS SITUATION, WTOR GENERATES THE ENTIRE        @L1A 13600000
.*       PARAMETER LIST STARTING WITH THE WTOR PREFIX.             @L1A 13650000
.*                                                                      13700000
.********************************************************************** 13750000
&IHBWTOR SETB  1                                                   @L1A 13800000
         WTO   &MESG,MF=&MF,MSGTYP=&MSGTYP,ROUTCDE=&ROUTCDE,DESC=&DESC,X13850000
               MCSFLAG=&MCSFLAG,QID=&QID,WQEBLK=&WQEBLK,CONSID=&CONSID,X13900000
               JOBID=&JOBID,KEY=&KEY,TOKEN=&TOKEN,SYSNAME=&SYSNAME,    X13950000
               JOBNAME=&JOBNAME,CONSNAME=&CONSNAME,                    X14000000
               LINKAGE=&LINKAGE,SYNCH=&SYNCH,                          +14050000
               CART=&CART,TEXT=&TEXT(1)                            @01C 14100000
&IHBWTOR SETB  0                                                   @L1A 14150000
         AIF   (&IWPXBIT OR &IWQEBIT OR &WTOERR).END  JUST EXIT IF     X14200000
                                        WQEBLK CALL, OR WTO WITH WPX,  X14250000
                                        OR IF SEVERE ERROR FOUND   @P2C 14300000
.********************************************************************** 14350000
.*       CHECK THE REPLY ADDRESS TO SEE IF IT IS SPECIFIED         @P4A 14400000
.*       AND IF IT IS IN A REGISTER                                @P4A 14450000
.********************************************************************** 14500000
         AIF   ('&RYAD'(1,1) EQ '(').IRPA0 BR IF REG SPECIFIED     @P4A 14550000
         DC    A(X'80000000'+&RYAD)     REPLY ADDRESS              @P4A 14600000
         AGO   .IECBCKA                 GO CHECK FOR ECB           @P4A 14650000
.IRPA0   DC    A(0)                     REPLY ADDRESS              @P4A 14700000
.********************************************************************** 14750000
.*       CHECK THE ECB ADDRESS TO SEE IF IT IS SPECIFIED           @P4A 14800000
.*       AND IF IT IS IN A REGISTER                                @P4A 14850000
.********************************************************************** 14900000
.IECBCKA AIF   ('&ECB'(1,1) EQ '(').IECB0  BR IF REG SPECIFIED     @P4A 14950000
         DC    A(&ECB)                  ECB ADDRESS                @P4A 15000000
         AGO   .ILENCKA                 GO CHECK FOR LENGTH        @P4A 15050000
.IECB0   DC    A(0)                     REPLY ADDRESS              @P4A 15100000
.********************************************************************** 15150000
.*       CHECK THE LENGTH TO SEE IF IT IS SPECIFIED AND IF     @G860PSS 15200000
.*       IT IS IN A REGISTER                                   @G860PSS 15250000
.********************************************************************** 15300000
.ILENCKA AIF   ('&LENGTH'(1,1) EQ '(').ILEN0 BR IF LEN IN REG      @P3C 15350000
         DC    AL1(&LENGTH)             REPLY LENGTH           @G860PSS 15400000
         AGO   .BUILDIT                 BUILD REST OF PARM LIST    @L1A 15450000
.ILEN0   DC    AL1(0)                   REPLY LENGTH           @G860PSS 15500000
.********************************************************************** 15550000
.*       GO BUILD THE REST OF THE PARAMETER LIST                   @L1C 15600000
.********************************************************************** 15650000
         AGO   .BUILDIT                 BUILD REST OF PARM LIST    @L1A 15700000
.********************************************************************** 15750000
.*                                                             @G860PSS 15800000
.*       CONTROL IS RETURNED HERE AFTER THE PARAMETER LIST     @G860PSS 15850000
.*       IS BUILT FOR THE INLINE EXPANSION                     @G860PSS 15900000
.*                                                             @G860PSS 15950000
.********************************************************************** 16000000
.IRETURN ANOP                                                           16050000
.*  THE FOLLOWING INSTRUCTION IS EXECUTED HERE ONLY IF A WPX       @L1A 16100000
.*  DOES NOT EXIST AND WQEBLK WAS NOT SPECIFIED. WHEN A WPX        @L1A 16150000
.*  EXISTS, THE WTO MACRO DOES THIS.                               @L1A 16200000
&GNAME.A DS    0H                                                       16250000
.********************************************************************** 16300000
.*       IF THE REPLY ADDRESS IS IN A REGISTER, STORE IT IN    @G860PSS 16350000
.*       THE PARAMETER LIST                                    @G860PSS 16400000
.********************************************************************** 16450000
         AIF   ('&RYAD'(1,1) NE '(').IECBCKB BR IF NOT IN REG      @P3C 16500000
         ST    &RYAD(1),0(1,0)          STORE REPLY ADDRESS    @G860PSS 16550000
         OI    0(1),X'80'               INDICATE WTOR              @P3C 16600000
.********************************************************************** 16650000
.*       IF ECB ADDRESS IS IN A REGISTER, SAVE ITS ADDRESS IN  @G860PSS 16700000
.*       THE PARAMETER LIST                                    @G860PSS 16750000
.********************************************************************** 16800000
.IECBCKB AIF   ('&ECB'(1,1) NE '(').ILENCKB BR IF NOT IN REG       @P3C 16850000
         ST    &ECB(1),4(1,0)           STORE ECB ADDRESS      @G860PSS 16900000
.********************************************************************** 16950000
.*       IF THE LENGTH IS IN A REGISTER, SAVE ITS ADDRESS IN   @G860PSS 17000000
.*       THE PARAMETER LIST                                    @G860PSS 17050000
.********************************************************************** 17100000
.ILENCKB AIF   ('&LENGTH'(1,1) NE '(').EXECUTE  BR IF NOT IN REG   @L5C 17150000
         STC   &LENGTH(1),8(1,0)        STORE REPLY LENGTH     @G860PSS 17200000
.EXECUTE ANOP                           ISSUE WTOR SVC             @L5C 17250000
         AIF   ('&LINKAGE(1)' EQ 'BRANCH').WTOBALR                 @L5A 17300000
         SIMSVC .                                              @D61CDFG 17325061
         SVC   35                       ISSUE SVC 35               @L5A 17350000
         AGO   .END                                                @L5A 17400000
.WTOBALR ANOP                           LINKAGE=BRANCH INVOCATION  @L5A 17450000
         L     15,16(0,0)               ADDRESS OF CVT             @L5A 17500000
         L     15,200(0,15)             ADDRESS OF SCVT            @L5A 17550000
         L     15,20(0,15)              WTOR BRANCH ENTRY POINT    @L5A 17600000
         BALR  14,15                    BRANCH TO ENTRY POINT WTOR @L5A 17650000
         AGO   .END                                            @G860PSS 17700000
.********************************************************************** 17750000
.*                                                             @G860PSS 17800000
.*       ERROR MESSAGES                                        @G860PSS 17850000
.*                                                             @G860PSS 17900000
.********************************************************************** 17950000
.********************************************************************** 18000000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 18050000
.* 12,INVALID MF OPERAND SPECIFIED-MF                          @G860PSS 18100000
.********************************************************************** 18150000
.ERROR1  IHBERMAC 35,,&MF                                               18200000
         MEXIT                                                          18250000
.********************************************************************** 18300000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 18350000
.* 12,MESSAGE OPERAND REQ'D-NOT SPECIFIED                      @G860PSS 18400000
.********************************************************************** 18450000
.ERROR2  IHBERMAC 19                                                    18500000
         MEXIT                                                          18550000
.********************************************************************** 18600000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 18650000
.* 12,INVALID REGISTER NOTATION WITH MF=L FORM                 @G860PSS 18700000
.********************************************************************** 18750000
.ERROR3  IHBERMAC 69                                                    18800000
         MEXIT                                                          18850000
.********************************************************************** 18900000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 18950000
.* 12,LENGTH OPERAND REQ'D-NOT SPECIFIED                       @G860PSS 19000000
.********************************************************************** 19050000
.ERROR4  IHBERMAC 14                                                    19100000
         MEXIT                                                          19150000
.********************************************************************** 19200000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 19250000
.* 12,SECOND OPERAND REQ'D-NOT SPECIFIED                       @G860PSS 19300000
.********************************************************************** 19350000
.ERROR5  IHBERMAC 03                                                    19400000
         MEXIT                                                          19450000
.********************************************************************** 19500000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 19550000
.* 12,ECB OPERAND REQ'D-NOT SPECIFIED                          @G860PSS 19600000
.********************************************************************** 19650000
.ERROR6  IHBERMAC 11                                                    19700000
         MEXIT                                                          19750000
.********************************************************************** 19800000
.*       ISSUE ERROR MESSAGE:                                  @G860PSS 19850000
.* 12,MLWTO/WTOR MUTUALLY EXCLUSIVE--GENERATION TERMINATED     @G860PSS 19900000
.********************************************************************** 19950000
.ERROR7  IHBERMAC 246                                                   20000000
         MEXIT                                                          20050000
.ERROR8  ANOP                                                      @L1A 20100000
         MNOTE 12,'NO TEXT GENERATED. ''WQEBLK'' IS MUTUALLY EXCLUSIVE X20150000
               WITH ALL OTHER KEYWORDS.'                           @L1A 20200000
         MEXIT                                                     @L1A 20250000
.ERROR9  ANOP                                                      @L2A 20300000
         MNOTE 12,'NO TEXT GENERATED. ''CONSID'' IS MUTUALLY EXCLUSIVE X20350000
               WITH CONSNAME KEYWORD.'                             @L2A 20400000
         MEXIT                                                     @L2A 20450000
.ERROR10 ANOP                                                      @L5A 20500000
         MNOTE 12,'NO TEXT GENERATED. SPECIFIED LINKAGE VALUE WAS NOT  +20550000
               SVC OR BRANCH.'                                     @L5A 20600000
         MEXIT                                                     @L5A 20650000
.ERROR12 ANOP                                                      @L5A 20700000
         MNOTE 12,'NO TEXT GENERATED. SPECIFIED SYNCH VALUE WAS NOT    +20750000
               YES OR NO.'                                         @L5A 20800000
         MEXIT                                                     @L5A 20850000
.ERROR13 ANOP                                                      @L5A 20900000
         MNOTE 12,'NO TEXT GENERATED. ''SYNCH=YES'' IS MUTUALLY        +20950000
               EXCLUSIVE WITH THE WQEBLK KEYWORD.'                 @L5A 21000000
         MEXIT                                                     @L5A 21050000
.ERROR14 ANOP                                                      @L5A 21100000
         MNOTE 12,'NO TEXT GENERATED. ''SYNCH=YES'' IS MUTUALLY        +21150000
               EXCLUSIVE WITH ''MCSFLAG=HRDCPY''.'                 @L5A 21200000
         MEXIT                                                     @L5A 21250000
.ERROR15 ANOP                                                      @L5A 21300000
         MNOTE 12,'NO TEXT GENERATED. ''SYNCH=YES'' REQUIRES           +21350000
               ''LINKAGE=BRANCH''.'                                @L5A 21400000
         MEXIT                                                     @L5A 21450000
.ERROR16 ANOP                                                      @L5A 21500000
         MNOTE 12,'NO TEXT GENERATED. ''LINKAGE=BRANCH'' REQUIRES      +21550000
               ''SYNCH=YES''.'                                     @L5A 21600000
         MEXIT                                                     @L5A 21650000
.ERROR17 ANOP                                                      @L5A 21700000
         MNOTE 12,'TOO MANY LINES OF TEXT. MAX=&MAXLINS WHEN SYNCH=YES'+21750000
                                                                   @L5A 21800000
         MEXIT                                                     @L5A 21850000
.END     MEND                                                      @L2A 21900000
**/                                                                     21950000
*%WTOR: MACRO KEYS(                                                     22000000
*                   ROUTCDE,      /*ROUTING CODES FOR MESSAGE        */ 22050000
*                   DESC,         /*MESSAGE DESCRIPTOR CODES         */ 22100000
*                   MSGTYP,       /*ROUTE TO MESSAGE CONSOLES        */ 22150000
*                   MCSFLAG,      /*MESSAGE ATTRIBUTES               */ 22200000
*                   RTCD,         /*SVC RETURN CODE                  */ 22250000
*                   WQEBLK,       /*ADDRESS OF WQE               @L1C*/ 22300000
*                   CONSID,       /*4 BYTE CONSOLE ID TO GET MSG @L1C*/ 22350000
*                   CONSNAME,     /*NAME OF CONSOLE TO GET MSG   @L2A*/ 22400000
*                   RPLYISUR,     /*CONSOLE NAME/ID FOR MESSAGE  @L3A*/ 22450000
*                   JOBID,        /*JOB ID OF ISSUER FOR JES     @L1C*/ 22500000
*                   JOBNAME,      /*JOB NAME OF ISSUER FOR JES   @L1C*/ 22550000
*                   KEY,          /*KEY ASSOCIATED WITH MSG      @L1C*/ 22600000
*                   TOKEN,        /*TOKEN ASSOCIATED WITH MSG    @L1C*/ 22650000
*                   SYSNAME,      /*SYSTEM NAME OF ISSUER        @L1C*/ 22700000
*                   CART,         /*CART ADDRESS                 @L3A*/ 22750000
*                   TEXT,         /*MESSAGE TEXT ADDRESS         @L4A*/ 22800000
*                   LINKAGE,      /*HOW CONTROL IS PASSED        @L5A*/ 22850000
*                   SYNCH,        /*SYNCHRONOUSLY PROCESSED      @L5A*/ 22900000
*                   CPFLG,        /*CONTROL PROGRAM ONLY FLAGS   @D2A*/ 22950000
*                   MF            /*LIST FORMAT                      */ 23000000
*                          );                                           23050000
* DECLARE SYSSPLV CHARACTER EXTERNAL; /* LEVEL INDICATOR     @G860PSS*/ 23100000
*                                                                       23150000
*/********************************************************************/ 23200000
*/*     DETERMINE WHICH FORMAT OF THE PARAMETER LIST SHOULD  @G860PSS*/ 23250000
*/*     BE BUILT.                                            @G860PSS*/ 23300000
*/********************************************************************/ 23350000
*    ANS('? SPLEVEL (TEST);');  /* DETERMINE LEVEL           @G860PSS*/ 23400000
*    IF SYSSPLV = '1' THEN      /* BUILD MVS/370 FORMAT          @L1C*/ 23450000
*       ANS('?'||MACLABEL||'WTORP7 '||MACLIST||MACKEYS||';');           23500000
*    ELSE                       /* BUILD MVS/XA FORMAT           @L1C*/ 23550000
*       ANS('?'||MACLABEL||'WTORP '||MACLIST||MACKEYS||';'); /*         23600000
*                                                            @G860PSS*/ 23650000
*%END WTOR;                                                             23700000
