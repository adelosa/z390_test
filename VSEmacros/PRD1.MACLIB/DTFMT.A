         MACRO                                                          00050000
&NAME    DTFMT &BLKSIZE=,&CKPTREC=,&DEVADDR=,&EOFADDR=,&ERROPT=,&FILABL-00100000
               =,&IOAREA1=,&IOAREA2=,&IOREG=,&LABADDR=,&NOTEPNT=,&READ=-00150000
               ,&RECFORM=FIXUNB,&RECSIZE=,&REWIND=,&TYPEFLE=INPUT,&VARB-00200000
               LD=,&WLRERR=,&WORKA=,&TPMARK=,&MODNAME=,&SEPASMB=,&HDRIN-00250000
               FO=,&RDONLY=,&ERREXT=,&ASCII=,&BUFOFF=,&LENCHK=      3-8 00300000
         GBLB  &IJFINIT                                             3-8 00350000
         GBLC  &IJFMOD(14)                                          3-8 00400000
         LCLA  &BUFOFST,&BYTE16,&CLASS,&NUM,&PTR                    3-8 00450000
         LCLA  &FTY,&LSWI,&OSW1,&OSW2,&WSWI,&WERR,&BLKS,&RECS       3-8 00500000
         LCLA  &RNOT                                           @D61YDWP 00525000
         LCLB  &USA,&EXTERR,&OPTERR                            @DA01010 00550000
         LCLC  &FORMAT,&A,&B,&C,&D,&E,&TEST                         3-8 00600000
         LCLC  &LIORE,&LVBLD,&UNIT,&IOA1,&LRSZ                     3-10 00650000
         LCLC  &MODNAM                                         @D147DRR 00700000
&A       SETC  'W'                                                  3-8 00750000
&B       SETC  'Z'                                                  3-8 00800000
&C       SETC  'Z'                                                  3-8 00850000
&D       SETC  'Z'                                                  3-8 00900000
&E       SETC  'Z'                                                  3-8 00950000
&MODNAM  SETC  'IJJTCTL'                                       @D147DRR 01000000
&FORMAT  SETC  '&RECFORM'                                           3-8 01050000
.* IBM  DISK OPERATING SYSTEM                                           01100000
.* CHANGE ACTIVITY                                             @DA34599 01150000
.* MSGIE254 WHEN FILABL=NO IS SPECIFIED FOR A WORK FILE        @DA34599 01200000
.* @D65IDAK BLKSIZE < 64K                                      @D65IDAK 01210006
.* @DY45700 BLKS IN PARENTHESIS                                @DY45700 01220009
.*                                                                      01250000
         AGO   .ZZZ                                            @U31TUJS 01300000
*    THIS MACRO IS "RESTRICTED MATERIALS OF IBM"               @U31TUJS 01350000
*    5686-066 (C) COPYRIGHT IBM CORP. 1977,1999                @D65IDAK 01400006
*    ALL RIGHTS RESERVED                                       @U31TUJS 01450000
*    LICENSED MATERIALS - PROPERTY OF IBM                      @U31TUJS 01500000
*    SEE COPYRIGHT INSTRUCTIONS, G120-2083                     @U31TUJS 01550000
.ZZZ     ANOP                                                  @U31TUJS 01600000
* MAGNETIC TAPE IOCS - DTFMT - 5686-066-06-55C0                @D65IDAK 01650006
.************* TEST PARAMETERS                                      3-8 01700000
         AIF   ('&NAME' NE '').T00                                  3-8 01750000
         MNOTE 0,'NO FILENAME SPECIFIED'                                01800000
.T00     AIF   (T'&ASCII EQ 'O').T01                                3-8 01850000
         AIF   ('&TYPEFLE' NE 'WORK').T00A                          3-8 01900000
         MNOTE 0,'ASCII NOT ALLOWED WITH WORKFILES,IGNORED'         3-8 01950000
         AGO   .T01                                                 3-8 02000000
.T00A    AIF   ('&FORMAT' NE 'SPNUNB' AND '&FORMAT' NE 'SPNBLK').T00B  -02050000
                                                                    3-8 02100000
         MNOTE 0,'ASCII NOT ALLOWED WITH SPANNED RECORDS,IGNORED'   3-8 02150000
         AGO   .T01                                                 3-8 02200000
.T00B    AIF   ('&ASCII' EQ 'YES').T00C                             3-8 02250000
         MNOTE 0,'IMPROPER ASCII,''YES'' ASSUMED'                   3-8 02300000
.T00C    ANOP                                                       3-8 02350000
&BLKS    SETA  &BLKSIZE                                        @DA10927 02400000
&USA     SETB  1                                                    3-8 02450000
.T01     AIF   ('&IOAREA1' EQ '').T01A                         @DA03677 02500000
         AIF   ('&IOAREA2' EQ '').T01A                         @DA03677 02550000
         AIF   ('&IOAREA1' NE '&IOAREA2').T01A                 @DA03677 02600000
         MNOTE 0,'IOAREA1 AND IOAREA2 ARE EQUAL'               @DA03677 02650000
.T01A    AIF   (T'&BLKSIZE EQ 'N' OR T'&BLKSIZE EQ 'U').T025   @DA29203 02700000
.T024    AIF   ('&FORMAT' NE 'SPNUNB' AND '&FORMAT' NE 'SPNBLK').SP40  -02750000
                                                                    3-8 02800000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').SP50                        3-7 02850000
.SP40    ANOP                                                       3-7 02900000
         MNOTE 0,'IMPROPER OR MISSING BLKSIZE.SET TO 12'                02950000
&BLKS    SETA  12                                                       03000000
         AGO   .T03                                                     03050000
.T025    AIF   ('&BLKSIZE'(1,1) EQ '(').T024                            03100000
         AIF   (NOT &USA OR '&FORMAT'(1,3) NE 'FIX').T25A           3-8 03150000
         AIF   ('&TYPEFLE' NE 'OUTPUT' OR &BLKSIZE GT 17).T25A      3-8 03200000
         MNOTE 0,'BLKSIZE LESS THAN 18 WITH OUTPUT,ASCII,FIXED RECORDS.-03250000
                 SET TO 18.'                                        3-8 03300000
&BLKS    SETA    18                                                 3-8 03350000
         AGO   .T03                                                 3-8 03400000
.T25A    AIF   ('&FORMAT' NE 'SPNUNB' AND '&FORMAT' NE 'SPNBLK').SP45  -03450000
                                                                    3-8 03500000
         AIF   ('&TYPEFLE' EQ 'OUTPUT' AND &BLKSIZE LE 17).SP50     3-7 03550000
.SP45    ANOP                                                       3-7 03600000
         AIF   (&BLKSIZE GE 12).T026                                3-8 03650000
         MNOTE 0,'BLKSIZE LESS THAN 12 BYTES.SET TO 12'                 03700000
&BLKS    SETA  12                                                       03750000
         AGO   .T03                                                     03800000
.T026    AIF   (NOT &USA OR &BLKS LE 2048).T026A                    3-8 03850000
         MNOTE 0,'BLKSIZE VIOLATES ASCII STANDARDS'            @DA10927 03900000
.T026A   AIF   (NOT &USA OR &BLKS LT 10000 OR '&FORMAT' NE 'VARUNB' AND-03950000
                '&FORMAT' NE 'VARBLK').T027                         3-8 04000000
         AIF   ('&BUFOFF' NE '4' OR T'&LENCHK EQ 'O' AND '&TYPEFLE' NE -04050000
                'OUTPUT').T027                                      3-8 04100000
         MNOTE 0,'BLKSIZE GT 9999,BLOCKPREFIX CANNOT CONTAIN BLOCKSIZE'-04150000
                                                                    3-8 04200000
.T027    AIF   (&BLKSIZE LE 65535).T027B                                04250008
         MNOTE 0,'BLKSIZE GREATER THAN 65535 BYTES.SET TO 65535'        04300008
&BLKS    SETA  65535                                         @D65IDAK   04350009
         AGO   .T03                                                     04400000
.SP50    MNOTE 0,'BLKSIZE LESS THAN 18 WITH TYPEFLE = OUTPUT AND RECFORX04450000
               M = SPNBLK OR RECFORM = SPNUNB. SET TO 18.'          3-7 04500000
&BLKS    SETA  18                                                   3-7 04550000
         AGO   .T03                                                 3-7 04600000
.T027B   ANOP                                                           04650000
&BLKS    SETA  &BLKSIZE                                                 04700000
&RECS    SETA  &BLKS                                                3-8 04750000
.T03     AIF   (T'&CKPTREC EQ 'O' OR NOT &USA).T03A                 3-8 04800000
         MNOTE 0,'INVALID CKPTREC,IGNORED'                          3-8 04850000
         AGO   .T05                                                 3-8 04900000
.T03A    AIF   (T'&CKPTREC EQ 'O' OR '&CKPTREC' EQ 'YES').T05       3-8 04950000
         MNOTE 0,'IMPROPER CKPTREC,''YES'' ASSUMED'                 3-8 05000000
.T05     AIF   ('&TYPEFLE' EQ 'OUTPUT' OR T'&EOFADDR NE 'O').T07        05050000
         MNOTE 0,'NO EOFADDR SPEC.SET TO *'                    @DA00726 05100000
.T07     ANOP                                                  @DA01010 05150000
         AIF   (T'&ERROPT EQ 'O' AND T'&ERREXT EQ 'O').T07A    @DA15941 05200000
         AIF   (T'&ERROPT NE 'O' AND T'&ERREXT NE 'O').T07A    @DA15941 05250000
         AIF   (T'&ERROPT EQ 'O').T07AA                        @DA15941 05300000
         AIF   ('&TYPEFLE' NE 'OUTPUT').T07A                   @DA15941 05350000
         MNOTE 0,'ERREXT NOT SPECIFIED. ERROPT IGNORED.'            3-8 05400000
         AGO   .T07AAA                                         @DA15941 05450000
.T07AA   MNOTE 0,'ERROPT NOT SPECIFIED. ERREXT IGNORED.'       @DA15941 05500000
.T07AAA  ANOP                                                  @DA15941 05550000
&OPTERR  SETB  1                                               @DA01010 05600000
         AGO   .T08                                                 3-8 05650000
.T07A    AIF   ('&ERROPT' EQ 'SKIP' OR '&ERROPT' EQ 'IGNORE' OR '&ERROP-05700000
               T' EQ '' OR T'&ERROPT EQ 'I' OR T'&ERROPT EQ 'T').T08    05750000
         AIF   (T'&ERROPT EQ 'M' OR T'&ERROPT EQ 'U').T08               05800000
         MNOTE *,'***** ERROPT POSSIBLE ERROR *****'                    05850000
.T08     AIF   (T'&ERREXT EQ 'O' OR &OPTERR).T09A                   3-8 05900000
         AIF   ('&ERROPT' NE '' AND ('&TYPEFLE' NE 'OUTPUT' OR '&ERROPT-05950000
               ' NE 'IGNORE' AND '&ERROPT' NE 'SKIP')).T08A         3-8 06000000
         AIF   ('&TYPEFLE' EQ 'OUTPUT' AND ('&ERROPT' NE 'IGNORE' AND  -06050000
               '&ERROPT' NE 'SKIP')).T08A                      @DA30466 06100000
         MNOTE 0,'INVALID COMBINATION OF ERROPT AND ERREXT,ERREXT IGNOR-06150000
               ED'                                                  3-8 06200000
         AGO   .T09A                                                3-8 06250000
.T08A    AIF   (T'&ERREXT EQ 'O').T09A                              3-8 06300000
&EXTERR  SETB  1                                                    3-8 06350000
         AIF   ('&ERREXT' EQ 'YES').T09A                            3-8 06400000
         MNOTE 0,'IMPROPER ERREXT,''YES'' ASSUMED'                  3-8 06450000
.T09A    AIF   ('&RDONLY' EQ 'YES' OR T'&RDONLY EQ 'O').T09C        3-4 06500000
         MNOTE 0,'IMPROPER RDONLY PARAMETER, YES ASSUMED'           3-4 06550000
.T09C    AIF   ('&TYPEFLE' EQ 'WORK').T14                           3-4 06600000
         AIF   ('&FILABL' EQ 'STD' OR '&FILABL' EQ 'NSTD' AND NOT &USA -06650000
               OR '&FILABL' EQ 'NO').T09                            3-8 06700000
         MNOTE 0,'INVALID OR OMITTED FILABL, '' NO '' ASSUMED'          06750000
.T09     AIF   ('&IOAREA1' NE '').T12                               3-8 06800000
         MNOTE 0,'IOAREA1 NOT SPEC.SET TO *'                   @DA00726 06850000
&IOA1    SETC  '*'                                             @DA02108 06900000
.T12     AIF   (T'&IOREG EQ 'O').T14                                    06950000
         AIF   ('&IOREG'(1,1) EQ '(').T13                               07000000
         MNOTE 0,'IOREG NOT WITHIN PARENTHESES'                @DA00726 07050000
         AIF   ('&IOREG' LT '2' OR '&IOREG' GT '12').T135A              07100000
&LIORE   SETC  '&IOREG'                                                 07150000
         AGO   .T14                                                     07200000
.T13     ANOP                                                           07250000
&LIORE   SETC  '&IOREG(1)'                                              07300000
         AIF   (&LIORE GE 2 AND &LIORE LE 12).T14                   3-8 07350000
.T135A   MNOTE 0,'IOREG NOT A REG. 2-12.SET TO REG 2'                   07400000
&LIORE   SETC  '2'                                                      07450000
.T14     AIF   (T'&NOTEPNT EQ 'O').T16                                  07500000
         AIF   ('&TYPEFLE' EQ 'WORK').T15A                              07550000
         MNOTE 0,'NOTEPNT INVALID PARAMETER.IGNORED'                    07600000
         AGO   .T16                                                     07650000
.T15A    AIF   ('&NOTEPNT' EQ 'YES' OR '&NOTEPNT' EQ 'POINTS').T16      07700000
         MNOTE 0,'IMPROPER NOTEPNT.''YES'' ASSUMED'                     07750000
.T16     AIF   ('&READ' EQ '' OR '&READ' EQ 'BACK' OR '&READ' EQ 'FORWA-07800000
               RD').T17                                                 07850000
         MNOTE 0,'IMPROPER READ.''FORWARD'' ASSUMED'                    07900000
.T17     AIF   ('&FORMAT' EQ 'FIXUNB' OR '&FORMAT' EQ 'VARUNB' OR '&FOR-07950000
               MAT' EQ 'VARBLK').T18                                3-8 08000000
         AIF   ('&FORMAT' EQ 'FIXBLK').T19                          3-8 08050000
         AIF   ('&FORMAT' EQ 'UNDEF').T22                           3-8 08100000
         AIF   ('&FORMAT' EQ 'SPNUNB' OR '&FORMAT' EQ 'SPNBLK').SP00   -08150000
                                                                    3-8 08200000
         MNOTE 0,'IMPROPER RECFORM.''FIXUNB'' ASSUMED'                  08250000
&FORMAT  SETC  'FIXUNB'                                             3-8 08300000
.T18     AIF   ('&RECSIZE' EQ '').T26                                   08350000
         MNOTE 0,'RECSIZE NOT NEEDED,IGNORED'                           08400000
         AGO   .T26                                                     08450000
.T19     AIF   ('&RECSIZE' NE '').T20                                   08500000
         MNOTE 0,'NO RECSIZE SPEC. SET TO BLKSIZE'             @DA00726 08550000
         AGO   .T26                                                     08600000
.T20     AIF   (T'&RECSIZE EQ 'N').T21                                  08650000
         MNOTE 0,'RECSIZE NOT A NUMBER,IGNORED'                         08700000
         AGO   .T26                                                     08750000
.T21     AIF   ('&RECSIZE' GE '12').T21BB                               08800000
         MNOTE *,'***** RECSIZE LESS THAN 12 BYTES *****'               08850000
.T21BB   AIF   (&BLKS-(&BLKS/&RECSIZE)*&RECSIZE EQ 0 OR &USA AND '&TYPE-08900000
               FLE' NE 'OUTPUT').T21A                               3-8 08950000
         MNOTE 0,'BLOCKSIZE NOT A MULTIPLE OF RECSIZE'         @DA00726 09000000
.T21A    ANOP                                                           09050000
&RECS    SETA  &RECSIZE                                             3-8 09100000
         AGO   .T26                                                     09150000
.T22     AIF   ('&TYPEFLE' EQ 'WORK').T24A                              09200000
         AGO   .SP05                                                3-7 09250000
.SP00    ANOP                                                       3-7 09300000
&BYTE16  SETA  4                                                    3-8 09350000
.SP05    AIF   (T'&RECSIZE NE 'O').T225                             3-8 09400000
         AIF   ('&TYPEFLE' NE 'OUTPUT' AND '&FORMAT'(1,1) NE 'S').T26  -09450000
                                                                    3-8 09500000
         MNOTE 0,'NO RECSIZE SPECIFIED.SET TO REG 2'                    09550000
&LRSZ    SETC  '2'                                                      09600000
         AGO   .T26                                                     09650000
.T225    AIF   ('&RECSIZE'(1,1) EQ '(').T24                             09700000
         MNOTE 0,'RECSIZE NOT WITHIN PARENTHESES'              @DA00726 09750000
&LRSZ    SETC  '&RECSIZE'                                               09800000
         AIF   ('&RECSIZE' LT '2' OR '&RECSIZE' GT '12').T25            09850000
         AGO   .T26                                                     09900000
.T24     ANOP                                                           09950000
&LRSZ    SETC  '&RECSIZE(1)'                                            10000000
         AIF   (&LRSZ LT 2 OR &LRSZ GT 12).T25                          10050000
         AGO   .T26                                                     10100000
.T24A    AIF   (T'&RECSIZE EQ 'O').T26                                  10150000
         MNOTE 0,'RECSIZE INVALID PARAMETER.IGNORED'                    10200000
         AGO   .T26                                                     10250000
.T25     MNOTE 0,'RECSIZE NOT A REG.2-12.SET TO REG 2'                  10300000
&LRSZ    SETC  '2'                                                      10350000
.T26     AIF   ('&REWIND' EQ '' OR '&REWIND' EQ 'UNLOAD' OR '&REWIND' E-10400000
               Q 'NORWD').T27                                           10450000
         MNOTE 0,'IMPROPER REWIND,IGNORED'                              10500000
.T27     AIF   ('&TYPEFLE' EQ 'INPUT' OR '&TYPEFLE' EQ 'OUTPUT').T28    10550000
         AIF   ('&TYPEFLE' EQ 'WORK').T37                               10600000
         MNOTE 0,'IMPROPER TYPEFLE,''INPUT'' ASSUMED'               3-8 10650000
.T28     AIF   (T'&TPMARK EQ 'O' OR '&TPMARK' EQ 'NO' OR '&TPMARK' EQ '-10700000
               YES').T29                                       @DA15201 10750000
         MNOTE 0,'IMPROPER TPMARK, ''NO'' ASSUMED'                      10800000
.T29     AIF   ('&FORMAT' EQ 'VARBLK').T30                          3-8 10850000
         AIF   ('&VARBLD' EQ '').T35                                    10900000
         MNOTE 0,'VARBLD INVALID PARAMETER.IGNORED'                     10950000
         AGO   .T35                                                     11000000
.T30     AIF   (T'&WORKA EQ 'O' OR T'&VARBLD EQ 'O').T30S           3-8 11050000
         AIF   ('&WORKA' NE 'YES' OR  T'&VARBLD EQ 'O').T30S            11100000
         MNOTE 0,'WORKA AND VARBLD SPECIFIED, VARBLD IGNORED'           11150000
.T30S    AIF   ('&TYPEFLE' NE 'OUTPUT' OR '&WORKA' EQ 'YES').T35        11200000
         AIF   ('&VARBLD' NE '').T31                                    11250000
         MNOTE 0,'NO VARBLD REG. SPEC.'                        @DA00726 11300000
         AGO   .T35                                                     11350000
.T31     AIF   ('&VARBLD'(1,1) EQ '(').T33                              11400000
         MNOTE 0,'VARBLD NOT WITHIN PARENTHESES'                        11450000
&LVBLD   SETC  '&VARBLD'                                                11500000
         AIF   ('&VARBLD' LT '2' OR '&VARBLD' GT '13').T34              11550000
         AGO   .T35                                                     11600000
.T33     ANOP                                                           11650000
&LVBLD   SETC  '&VARBLD(1)'                                             11700000
         AIF   (&LVBLD LT 2 OR &LVBLD GT 13).T34                        11750000
         AGO   .T35                                                     11800000
.T34     MNOTE 0,'VARBLD NOT A REG. 2-13.SET TO REG 2'         @DA00726 11850000
&LVBLD   SETC  '2'                                                      11900000
.T35     AIF   (T'&WORKA EQ 'O' OR '&WORKA' EQ 'YES').T38           3-8 11950000
         MNOTE 0,'IMPROPER WORKA,''YES'' ASSUMED'                   3-8 12000000
.T38     AIF   ('&FORMAT' EQ 'FIXUNB').T41                          3-8 12050000
         AIF   ('&FORMAT'(1,1) EQ 'S').SP10                         3-8 12100000
         AIF   ('&READ' EQ 'BACK' OR T'&IOAREA2 NE 'O').T40         3-8 12150000
         AIF   ('&FORMAT'(4,3) EQ 'BLK').T40                        3-8 12200000
         AGO   .T41                                                     12250000
.T37     AIF   ('&FORMAT' EQ 'FIXUNB' OR '&FORMAT' EQ 'UNDEF').T42  3-8 12300000
         MNOTE 0,'IMPROPER RECFORM,''FIXUNB'' ASSUMED' FOR WORKFILES3-8 12350000
&FORMAT  SETC  'FIXUNB'                                             3-8 12400000
         AGO   .T41                                                 3-8 12450000
.SP10    AIF   ('&WORKA' EQ 'YES').T41                              3-7 12500000
         MNOTE 0,'MISSING WORKA WITH RECFORM = SPNUNB OR RECFORM = SPNBX12550000
               LK. WORKA = YES ASSUMED.'                            3-7 12600000
         AGO   .T41                                                 3-7 12650000
.T40     AIF   (T'&WORKA NE 'O' OR T'&IOREG NE 'O').T41             3-8 12700000
         MNOTE 0,'NO WORKAREA OR IOREG SPEC. REASSEMBLE'                12750000
         AGO   .T41A                                                3-8 12800000
.T41     AIF   ('&WORKA' NE '' OR '&IOREG' NE '').T41A              3-8 12850000
         AIF   ('&IOAREA2' EQ '').T41A                              3-8 12900000
         MNOTE 0,'NO WORKA OR IOREG SPEC. REASSEMBLE'               3-8 12950000
.T41A    AIF   ('&TYPEFLE' NE 'OUTPUT').T42                         3-8 13000000
         AIF   ('&READ' NE 'BACK').T42                                  13050000
         MNOTE 0,'YOU CANNOT WRITE TAPE BACKWARDS, FORWARD ASSUMED'     13100000
.T42     AIF   (T'&WORKA EQ 'O' OR T'&IOREG EQ 'O').T43        @DA12285 13150000
         MNOTE 0,'BOTH WORKAREA  AND  IOREG SPEC. REASSEMBLE'  @DA12285 13200000
.T43     AIF   (K'&DEVADDR NE 6).ERR                                    13250000
         AIF   ('&DEVADDR'(1,3) NE 'SYS').ERR                           13300000
&UNIT    SETC  '&DEVADDR'(4,3)                                          13350000
         AIF   ('&UNIT' LT '000' OR '&UNIT' GT '254').LTRS     @DA31417 13400000
       AIF   ('&UNIT'(2,1)  LT  '0'  OR  '&UNIT'(2,1)  GT  '9').ERR     13450000
       AIF   ('&UNIT'(3,1)  LT  '0'  OR  '&UNIT'(3,1)  GT  '9').ERR     13500000
&CLASS SETA  1                         PROBLEM PROGRAM UNIT CLASS       13550000
&NUM   SETA  &UNIT                     NUMBER IN CLASS                  13600000
       AGO   .FND                      GO CHECK CCWADD ENTRY            13650000
.LTRS    AIF   (&USA).ERR                                           3-8 13700000
       AIF   ('&UNIT'  EQ  'RDR').FND     SYSRDR                    3-8 13750000
&NUM   SETA  1                                                          13800000
       AIF   ('&UNIT'  EQ  'IPT').FND     SYSIPT                        13850000
&NUM   SETA  2                                                          13900000
       AIF   ('&UNIT'  EQ  'PCH').FND     SYSPCH                        13950000
&NUM   SETA  3                                                          14000000
       AIF   ('&UNIT'  EQ  'LST').FND     SYSLST                        14050000
.ERR     MNOTE 0,'IMPROPER OR MISSING DEVADDR.SET TO ''FFFF'''          14100000
&CLASS SETA  255                                                        14150000
&NUM   SETA  255                       SET INVALID VALUE                14200000
.FND     AIF   (T'&BUFOFF EQ 'O').T202                              3-8 14250000
         AIF   (T'&BUFOFF NE 'N' OR NOT &USA).T201A                 3-8 14300000
         AIF   ('&TYPEFLE' NE 'OUTPUT' AND &BUFOFF LE 99).T201B     3-8 14350000
         AIF   ('&TYPEFLE' EQ 'OUTPUT' AND (&BUFOFF EQ 0 OR &BUFOFF EQ -14400000
               4 AND '&FORMAT'(1,1) EQ 'V')).T201B                  3-8 14450000
.T201A   MNOTE 0,'IMPROPER OR INVALID BUFOFF, IGNORED'              3-8 14500000
         AGO   .T202                                                3-8 14550000
.T201B   ANOP                                                       3-8 14600000
&BUFOFST SETA  &BUFOFF                                              3-8 14650000
         AIF   (&BUFOFST EQ 0 OR T'&IOREG NE 'O' OR T'&WORKA NE 'O').T2-14700000
               02                                                   3-8 14750000
         MNOTE 0,'IOREG OR WORKA NEEDED FOR BUFOFF NE 0'            3-8 14800000
.T202    AIF   (T'&LENCHK EQ 'O' OR &USA AND &BUFOFST EQ 4 AND '&FORMAT-14850000
               '(1,1) EQ 'V').T202A                                 3-8 14900000
         MNOTE 0,'INVALID LENCHK,IGNORED'                           3-8 14950000
         AGO   .T203                                                3-8 15000000
.T202A   AIF   (T'&LENCHK EQ 'O' OR '&LENCHK' EQ 'YES').T203        3-8 15050000
         MNOTE 0,'IMPROPER LENCHK,''YES'' ASSUMED'                  3-8 15100000
.T203    AIF   (K'&NAME LT 8).NAMOK                                 3-8 15150000
         MNOTE 9,'FILE NAME EXCEEDS SEVEN CHAR LIMIT, MACRO GENERATION *15200000
               TERMINATED'                                              15250000
         MEXIT                                                          15300000
.NAMOK   AIF   (T'&WLRERR NE 'O' AND '&TYPEFLE' EQ 'OUTPUT').WLRR   3-9 15350000
         AGO   .SEPAS                                               3-9 15400000
.WLRR    ANOP                                                       3-9 15450000
         MNOTE 0,'WLRERR PARAMETER INVALID FOR OUTPUT FILE.IGNORED' 3-9 15500000
.SEPAS   AIF   (T'&SEPASMB EQ 'O').NEW2                             3-9 15550000
         AIF   ('&SEPASMB' EQ 'YES').NEW3                               15600000
         MNOTE 0,'IMPROPER SEPASMB.''YES'' ASSUMED'                     15650000
.NEW3    AIF   (T'&NAME NE 'O').NEW1                                    15700000
         MNOTE 9,'MISSING FILE NAME, MACRO GENERATION TERMINATED'       15750000
         MEXIT                                                          15800000
.************* BUILD DTF TABLE                                      3-8 15850000
.NEW1    PUNCH '    CATALR &NAME,35.2'                         @DA12285 15900000
&NAME.C  CSECT                                                          15950000
         ENTRY &NAME                                                    16000000
.NEW2    DC    0D'0'                                                3-8 16050000
         AIF   (T'&ERROPT EQ 'O' OR &OPTERR).T464              @DA01010 16100000
         AIF   (NOT &EXTERR).RS1                                    3-8 16150000
&NAME    DC    X'000092000000'                                      3-4 16200000
         AGO   .T465                                                3-8 16250000
.RS1     ANOP                                                       3-4 16300000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').T464                   @DA15941 16350000
&NAME    DC    X'000082000000'                                      3-4 16400000
         AGO   .T465                                                    16450000
.T464    ANOP                                                       3-8 16500000
&NAME    DC    X'000080000000'         CCB                              16550000
.T465    DC    AL1(&CLASS)             LOGICAL UNIT CLASS               16600000
         DC    AL1(&NUM)               LOGICAL UNIT                     16650000
         AIF   (NOT &USA).T300                                      3-8 16700000
         DC    AL1(&BUFOFST)           BUFFER OFFSET                3-8 16750000
         DC    AL3(IJF1&SYSNDX)        CCW ADDRESS                  3-8 16800000
         AGO   .T301                                                3-8 16850000
.T300    DC    AL4(IJF1&SYSNDX)        CCW ADDRESS                  3-8 16900000
.T301    DC    4X'00'                  CCB-ST BYTE,CSW CCW ADDRESS  3-8 16950000
         AIF   (NOT &USA).T400                                      3-8 17000000
&BYTE16  SETA  2                                                    3-8 17050000
         AIF   (&BUFOFST EQ 0 OR '&TYPEFLE' NE 'OUTPUT' AND (T'&LENCHK -17100000
               EQ 'O' OR &BUFOFST NE 4 OR '&FORMAT'(1,1) NE 'V')).T400  17150000
.* THE ABOVE AIF STATEMENT WAS ADDED AT 3-8                         3-8 17200000
&BYTE16  SETA  3                                                    3-8 17250000
.T400    DC    AL1(&BYTE16)                                         3-8 17300000
.**      AIF   ('&MODNAME' EQ '').T47                                   17350000
         DC    VL3(&MODNAM)            ADDRESS OF LOGIC MODULE @D147DRR 17400000
         AGO   .T48                                                     17450000
.************* BUILD SUPERSET OF MODULES WANTED UNTIL NOW           3-8 17500000
.T47     AIF   (&IJFINIT).T47A                                      3-8 17550000
&PTR     SETA  &PTR+1                                               3-8 17600000
&IJFMOD(&PTR) SETC 'ZZZZZ'                                          3-8 17650000
         AIF   (&PTR LT 14).T47                                     3-8 17700000
.T47A    ANOP                                                       3-8 17750000
&IJFINIT SETB  1                                                    3-8 17800000
&PTR     SETA  1                                                    3-8 17850000
         AIF   (T'&RDONLY EQ 'O' AND NOT &EXTERR).T47B              3-8 17900000
&E       SETC  'N'                                                  3-8 17950000
         AIF   (T'&RDONLY EQ 'O' AND &EXTERR).T47B                  3-8 18000000
&E       SETC  'M'                                                  3-8 18050000
&PTR     SETA  8                                                    3-8 18100000
         AIF   (T'&RDONLY NE 'O' AND &EXTERR).T47B                  3-8 18150000
&E       SETC  'Y'                                                  3-8 18200000
.T47B    AIF   ('&TYPEFLE' EQ 'WORK').T47G                          3-8 18250000
&A       SETC  'F'                                                  3-8 18300000
&PTR     SETA  &PTR+1                                               3-8 18350000
         AIF   (NOT &USA).T47C                                      3-8 18400000
&A       SETC  'X'                                                  3-8 18450000
&PTR     SETA  &PTR+3                                               3-8 18500000
         AIF   ('&FORMAT'(1,1) EQ 'F').T47E                         3-8 18550000
&A       SETC  'R'                                                  3-8 18600000
&PTR     SETA  &PTR+1                                               3-8 18650000
         AIF   ('&FORMAT'(1,1) EQ 'V').T47E                         3-8 18700000
&A       SETC  'N'                                                  3-8 18750000
&PTR     SETA  &PTR+1                                               3-8 18800000
         AGO   .T47E                                                3-8 18850000
.T47C    AIF   ('&FORMAT'(1,1) EQ 'F').T47D                         3-8 18900000
&A       SETC  'V'                                                  3-8 18950000
&PTR     SETA  &PTR+1                                               3-8 19000000
         AIF   ('&FORMAT'(1,1) EQ 'V').T47D                         3-8 19050000
&A       SETC  'S'                                                  3-8 19100000
         AIF   ('&FORMAT'(1,1) EQ 'S').T47D                         3-8 19150000
&PTR     SETA  &PTR+1                                               3-8 19200000
&A       SETC  'U'                                                  3-8 19250000
.T47D    AIF   (T'&CKPTREC EQ 'O').T47E                             3-8 19300000
&C       SETC  'C'                                                  3-8 19350000
.T47E    AIF   ('&READ' NE 'BACK' OR '&TYPEFLE' EQ 'OUTPUT').T47F   3-8 19400000
&B       SETC  'B'                                                  3-8 19450000
.T47F    AIF   (T'&WORKA EQ 'O' AND '&FORMAT'(1,3) NE 'SPN').T47I   3-8 19500000
&D       SETC  'W'                                                  3-8 19550000
         AGO   .T47I                                                3-8 19600000
.T47G    AIF   (T'&ERROPT EQ 'O').T47H                              3-8 19650000
&B       SETC  'E'                                                  3-8 19700000
.T47H    AIF   (T'&NOTEPNT EQ 'O').T47I                             3-8 19750000
&C       SETC  'S'                                                  3-8 19800000
         AIF   ('&NOTEPNT' EQ 'POINTS').T47I                        3-8 19850000
&C       SETC  'N'                                                  3-8 19900000
.T47I    ANOP                                                       3-8 19950000
&TEST    SETC  '&IJFMOD(&PTR)'                                      3-8 20000000
         AIF   ('&A' LE '&TEST'(1,1)).T47J                          3-8 20050000
&A       SETC  '&TEST'(1,1)                                         3-8 20100000
.T47J    AIF   ('&B' LE '&TEST'(2,1)).T47K                          3-8 20150000
&B       SETC  '&TEST'(2,1)                                         3-8 20200000
.T47K    AIF   ('&C' LE '&TEST'(3,1)).T47L                          3-8 20250000
&C       SETC  '&TEST'(3,1)                                         3-8 20300000
.T47L    AIF   ('&D' LE '&TEST'(4,1)).T47M                          3-8 20350000
&D       SETC  '&TEST'(4,1)                                         3-8 20400000
.T47M    AIF   ('&E' LE '&TEST'(5,1)).T47N                          3-8 20450000
&E       SETC  '&TEST'(5,1)                                         3-8 20500000
.T47N    ANOP                                                       3-8 20550000
&IJFMOD(&PTR) SETC '&A'.'&B'.'&C'.'&D'.'&E'                         3-8 20600000
         DC    VL3(IJF&A&B&C&D&E)      ADDRESS OF LOGIC MODULE          20650000
.************* TRANSIENT INFORMATION DTF TYPE (BYTE 20)             3-8 20700000
.T48     ANOP                                                  @D147DRR 20750000
         AIF   ('&TYPEFLE' NE 'WORK').T48B                     @D147DRR 20800000
&FTY     SETA  10                                              @D147DRR 20850000
         AIF   (T'&FILABL EQ 'O' OR '&FILABL' EQ 'NO' ).T49    @DA34599 20900000
         AIF   ('&FILABL' NE 'STD').T48A                       @D147DRR 20950000
&FTY     SETA  15                                              @D147DRR 21000000
         AGO   .T49                                            @D147DRR 21050000
.T48A    ANOP                                                  @D147DRR 21100000
         MNOTE 0,'FILABL=''&FILABL'' IS INVALID, IGNORED'      @D147DRR 21150000
         AGO   .T49                                            @D147DRR 21200000
.T48B    ANOP                                                  @D147DRR 21250000
&FTY     SETA  11                                                       21300000
         AIF   ('&FILABL' NE 'STD').T49                                 21350000
&FTY     SETA  12                                                       21400000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').T49                             21450000
&FTY     SETA  13                                                       21500000
         AIF   ('&READ' EQ 'BACK').T49                                  21550000
&FTY     SETA  14                                                       21600000
.T49     DC    X'&FTY'                 DTF TYPE                         21650000
.************* LIOCS SWITCH (BYTE 21)                               3-8 21700000
         AIF   ('&TYPEFLE' EQ 'WORK').T148                              21750000
         AIF   ('&FORMAT'(4,3) NE 'BLK').T50                        3-8 21800000
&LSWI    SETA  64                                                       21850000
.T50     AIF   ('&IOAREA2' EQ '').T51                                   21900000
&LSWI    SETA  &LSWI+32                                                 21950000
.T51     AIF   ('&WORKA' EQ '').T52                                     22000000
.*       AIF   ('&FORMAT'(1,1) EQ 'S').T52                     @D147DRR 22050000
&LSWI    SETA  &LSWI+16                                                 22100000
.T52     AIF   ('&TYPEFLE' EQ 'OUTPUT').T53                             22150000
&LSWI    SETA  &LSWI+08                                                 22200000
.T53     AIF   ('&READ' NE 'BACK').T54                                  22250000
&LSWI    SETA  &LSWI+04                                                 22300000
.T54     AIF   (T'&CKPTREC EQ 'O' OR &USA).T55                      3-8 22350000
&LSWI    SETA  &LSWI+02                                                 22400000
.T55     DC    AL1(&LSWI)              LOGICAL IOCS SWITCHES            22450000
.************* TRANSIENT INFORM. FILE NAME (BYTE 22-28)             3-8 22500000
         AIF   ('&NAME' NE '').T55A                                     22550000
         DC    CL7' '                                          @D61YDWP 22600000
         AGO   .T55B                                                    22650000
.T55A    DC    CL7'&NAME'                                      @D61YDWP 22661500
.************* TRANSIENT INFORM. REGISTER NOTATION (BYTE 29)   @D61YDWP 22673000
.T55B    ANOP                                                  @D61YDWP 22684500
&RNOT    SETA  64                                              @D61YDWP 22696000
         AIF   ('&IOAREA1'(1,1) NE '(').T55C                   @D61YDWP 22707500
&RNOT    SETA  &RNOT+1                                         @D61YDWP 22719000
.T55C    AIF   ('&IOAREA2' EQ '').T55D                         @D61YDWP 22730500
         AIF   ('&IOAREA2'(1,1) NE '(').T55D                   @D61YDWP 22742000
&RNOT    SETA  &RNOT+2                                         @D61YDWP 22753500
.T55D    DC    AL1(&RNOT)                                      @D61YDWP 22765000
.************* TRANSIENT INFORMATION CCW OP CODE (BYTE 30)          3-8 22776500
         AIF   ('&READ' NE 'BACK').T56                                  22788000
         DC    X'0C'                                                    22800000
         AGO   .T58                                                     22850000
.T56     AIF   ('&TYPEFLE' NE 'OUTPUT').T57                             22900000
         DC    X'01'                                                    22950000
         AGO   .T58                                                     23000000
.T57     DC    X'02'                                                    23050000
.************* TRANSIENT INFORMATION SWITCH (BYTE 31)               3-8 23100000
.T58     AIF   ('&HDRINFO' NE 'YES').T58A                           3-8 23150000
&OSW2    SETA  1                                                    3-8 23200000
.T58A    AIF   ('&TYPEFLE' EQ 'WORK').T58Z                              23250000
         AIF   ('&FORMAT' NE 'UNDEF').T58D                          3-8 23300000
         AIF   ('&TYPEFLE' NE 'OUTPUT').T58C                            23350000
&OSW2    SETA  &OSW2+88      UNDEF, OUTPUT - BITS 0-4 EQUAL X'0B'       23400000
         AGO   .T58Z                                                    23450000
.T58C    ANOP                                                           23500000
&OSW2    SETA  &OSW2+104     UNDEF, INPUT - BITS 0-4 EQUAL X'0D'        23550000
         AGO   .T58Z                                                    23600000
.T58D    AIF   ('&FORMAT'(1,1) NE 'V' AND '&FORMAT'(1,1) NE 'S').T58F  -23650000
                                                                    3-8 23700000
         AIF   ('&TYPEFLE' NE 'OUTPUT').T58E                            23750000
&OSW2    SETA  &OSW2+120     VAR, OUTPUT - BITS 0-4 EQUAL X'0F'         23800000
         AGO   .T58Z                                                    23850000
.T58E    ANOP                                                           23900000
&OSW2    SETA  &OSW2+136     VAR, INPUT - BITS 0-4 EQUAL X'11'          23950000
         AGO   .T58Z                                                    24000000
.T58F    AIF   ('&TYPEFLE' NE 'OUTPUT').T58G                            24050000
&OSW2    SETA  &OSW2+96      FIX, OUTPUT - BITS 0-4 EQUAL X'0C'         24100000
         AGO   .T58Z                                                    24150000
.T58G    ANOP                                                           24200000
&OSW2    SETA  &OSW2+112     FIX, INPUT  - BITS 0-4 EQUAL X'0E'         24250000
.T58Z    AIF ('&FILABL' NE 'STD').T584                              3-8 24300000
&OSW2    SETA  &OSW2+4     TURN BIT 5 INDICAT STD LABEL/VER 3       3-3 24350000
.T584    DC    AL1(&OSW2)          SWITCHES FOR OPEN                3-8 24400000
.************* TRANSIENT INFORMATION SWITCH (BYTE 32)               3-8 24450000
&OSW2    SETA  0                                                        24500000
         AIF   ('&FILABL' NE 'STD').T59                                 24550000
&OSW1    SETA  &OSW1+128                                                24600000
         AGO   .T60                                                     24650000
.T59     AIF   ('&FILABL' NE 'NSTD' OR &USA).T60                    3-8 24700000
&OSW1    SETA  &OSW1+64                                                 24750000
.T60     AIF   ('&REWIND' NE 'UNLOAD').T61                              24800000
&OSW1    SETA  &OSW1+32                                                 24850000
         AGO   .T62                                                     24900000
.T61     AIF   ('&REWIND' NE 'NORWD').T62                               24950000
&OSW1    SETA  &OSW1+16                                                 25000000
.T62     AIF   ('&READ' NE 'BACK').T63                                  25050000
&OSW1    SETA  &OSW1+8                                                  25100000
.T63     AIF   ('&LABADDR' EQ '').T64                                   25150000
&OSW1    SETA  &OSW1+4                                                  25200000
.T64     AIF   ('&FILABL' EQ 'STD' OR '&TPMARK' EQ 'YES').T65  @DA05908 25250000
         AIF   ((T'&TPMARK EQ 'O' AND '&FILABL' EQ 'NSTD') AND NOT &USA-25300000
               ).T65                                           @DA05908 25350000
&OSW1    SETA  &OSW1+2                                                  25400000
.T65     DC    AL1(&OSW1)              SWITCH ONE FOR OPEN AND CLOSE    25450000
.************* TRANSIENT INFORM. LABELTRN,EOFRTN,BCNT (BYTE 33-43)  3-8 25500000
         AIF   ('&LABADDR' EQ '').T66                                   25550000
         DC    AL3(&LABADDR)           USER LABEL ROUTINE               25600000
         AGO   .T67                                                     25650000
.T66     DC    AL3(0)                  USER LABEL ROUTINE               25700000
.T67     AIF   ('&TYPEFLE' EQ 'OUTPUT').T68                             25750000
&OSW2    SETA  32                                                       25800000
.T68     AIF   ('&FORMAT'(1,1) NE 'V' AND '&FORMAT'(1,1) NE 'S').T681  -25850000
                                                                    3-8 25900000
&OSW2    SETA  &OSW2+2                                                  25950000
         AGO   .T682                                                    26000000
.T681    AIF   ('&FORMAT' NE 'UNDEF').T682                          3-8 26050000
&OSW2    SETA  &OSW2+1                                                  26100000
.T682    DC    AL1(&OSW2)     SWITCH FOR OPEN AND CLOSE                 26150000
         AIF   ('&EOFADDR' EQ '').T69                                   26200000
         DC    AL3(&EOFADDR)           EOF-ADDRESS                      26250000
         AGO   .T70                                                     26300000
.T69     DC    AL3(*)                                                   26350000
.T70     DC    F'0'                    BLOCKCOUNT                       26400000
         AIF   ('&FORMAT' EQ 'UNDEF').T127                          3-8 26450000
         AIF   ('&FORMAT'(1,1) EQ 'V').T100                         3-8 26500000
         AIF   ('&FORMAT'(1,1) EQ 'S').T101                         3-8 26550000
.************* FIXED                                                3-8 26600000
         AIF   ('&READ' EQ 'BACK').T71                                  26650000
         BXH   11,12,24(15)            DEBLOCKING FORWARD               26700000
         LA    14,1(14)                INCREASE BLOCKCOUNT BY ONE       26750000
         AGO   .T72                                                     26800000
.T71     BXLE  11,12,24(15)            DEBLOCKING BACKWARD              26850000
         BCTR  14,0                    DECREASE BLOCKCOUNT BY ONE       26900000
         NOPR  0                                                        26950000
.T72     AIF   ('&LIORE' EQ '').T73                                     27000000
         L     &LIORE,IJF2&SYSNDX-&NAME.(1)  LOAD USER IOREG            27050000
         AGO   .T106                                                3-8 27100000
.T73     NOP   0(0)                    LOAD USER IOREG                  27150000
.T74     AGO   .T106                                                    27200000
.T81     AIF   ('&FORMAT' EQ 'FIXBLK').T83                          3-8 27250000
&RECS    SETA  &RECS-&BUFOFST                                       3-8 27300000
.T83     AIF   ('&READ' NE 'BACK').T84                              3-8 27350000
         AIF   ('&IOAREA1' NE '').T83A                         @DA02108 27400000
IJF2&SYSNDX DC   A(&IOA1+&BLKS-&RECS)  DEBLOCKER 1             @DA02108 27450000
         DC    F'-&RECS'               DEBLOCKER 2                  3-8 27500000
         DC    A(&IOA1+&BLKS-&RECS)    DEBLOCKER 3             @DA02108 27550000
         AGO   .T87                                            @DA02108 27600000
.T83A    ANOP                                                  @DA02108 27650000
IJF2&SYSNDX DC  A(&IOAREA1+&BLKS-&RECS) DEBLOCKER 1            @DA02108 27700000
         DC    F'-&RECS'                DEBLOCKER 2            @DA02108 27750000
         DC    A(&IOAREA1+&BLKS-&RECS)  DEBLOCKER 3            @DA02108 27800000
         AGO   .T87                                                 3-8 27850000
.T84     AIF   ('&TYPEFLE' EQ 'OUTPUT').T85                             27900000
IJF2&SYSNDX   DC   F'0'                DEBLOCKER 1                      27950000
         DC    F'&RECS'                DEBLOCKER 2                  3-8 28000000
         DC    F'0'                    DEBLOCKER 3                      28050000
         AGO   .T87                                                     28100000
.T85     AIF   ('&IOAREA2' NE '').T86                              3-10 28150000
         AIF ('&IOAREA1' NE '').T85A                           @DA02108 28200000
IJF2&SYSNDX DC    A(&IOA1)             DEBLOCKER 1             @DA02108 28250000
         DC    F'&RECS'                DEBLOCKER 2                 3-10 28300000
         DC    A(&IOA1+&BLKS-1)        DEBLOCKER 3             @DA02108 28350000
         AGO   .T87                                                3-10 28400000
.T85A    ANOP                                                  @DA02108 28450000
IJF2&SYSNDX DC    A(&IOAREA1)          DEBLOCKER 1             @DA02108 28500000
         DC    F'&RECS'                DEBLOCKER 2             @DA02108 28550000
         DC    A(&IOAREA1+&BLKS-1)     DEBLOCKER 3             @DA02108 28600000
         AGO   .T87                                            @DA02108 28650000
.T86     ANOP                                                      3-10 28700000
IJF2&SYSNDX    DC    A(&IOAREA2)       DEBLOCKER 1                 3-10 28750000
         DC    F'&RECS'                DEBLOCKER 2                  3-8 28800000
         DC    A(&IOAREA2+&BLKS-1)     DEBLOCKER 3                 3-10 28850000
.T87     DC    AL2(&BLKS)                BLOCKSIZE             @D65IDAK 28900009
         AIF   ('&READ' EQ 'BACK').T88                                  28950000
         DC    AL2(&BLKS-1)              BLOCKSIZE-1           @D65IDAK 29000009
         AGO   .T89                                                     29050000
.T88     DC    AL2(&BLKS)                BLOCK SIZE            @D65IDAK 29100009
.T89     DC    AL2(&RECS-1)            RECSIZE-1               @D65IDAK 29150009
         AGO   .T117A                                                   29200000
.************* VARIABLE                                             3-8 29250000
.T100    AIF   ('&LVBLD' EQ '').T101                                    29300000
         L     &LVBLD,IJF3&SYSNDX-&NAME.(1)                             29350000
         AGO   .T102                                                    29400000
.T101    NOP   0(0)                                                     29450000
.T102    AIF   ('&READ' EQ 'BACK').T103                                 29500000
         LA    14,1(14)                INCREASE BLOCKCOUNT BY ONE       29550000
         AGO   .T104                                                    29600000
.T103    BCTR  14,0                    DECREASE BLOCKCOUNT BY ONE       29650000
         NOPR  0                                                        29700000
.T104    AIF   ('&FORMAT'(1,1) NE 'S').SP25                         3-8 29750000
         AIF   ('&TYPEFLE' NE 'OUTPUT').SP20                        3-7 29800000
         ST    &LRSZ,IJFS&SYSNDX-&NAME.(1) PICK UP USER SPN RECSIZE 3-7 29850000
         AGO   .T107                                                3-7 29900000
.SP20    L     &LRSZ,IJFS&SYSNDX-&NAME.(1) LOAD USER SPN RECSIZE REG3-7 29950000
         AGO   .T106                                                3-7 30000000
.SP25    AIF   ('&LIORE' EQ '').T105                                3-7 30050000
         L     &LIORE,IJF4&SYSNDX-&NAME.(1)  LOAD USER IOREG            30100000
         AGO   .T106                                                    30150000
.T105    NOP   0(0)                    LOAD USER IOREG                  30200000
.T106    AIF   ('&TYPEFLE' EQ 'OUTPUT').T107                            30250000
         AIF   ('&READ' EQ 'BACK').T108                            3-10 30300000
         AIF ('&IOAREA1' EQ '').T106A                          @DA02108 30350000
IJF1&SYSNDX CCW   X'02',&IOAREA1,X'00',&BLKS                   @DA02108 30400000
         AGO   .T109                                               3-10 30450000
.T106A   ANOP                                                  @DA02108 30500000
IJF1&SYSNDX CCW   X'02',&IOA1,X'00',&BLKS                      @DA02108 30550000
         AGO   .T109                                           @DA02108 30600000
.T107    ANOP                                                           30650000
         AIF ('&IOAREA1' EQ '').T107A                          @DA02108 30700000
IJF1&SYSNDX CCW   X'01',&IOAREA1,X'20',&BLKS                   @DA02108 30750000
         AGO   .T109                                               3-10 30800000
.T107A   ANOP                                                  @DA02108 30850000
IJF1&SYSNDX CCW   X'01',&IOA1,X'20',&BLKS                      @DA02108 30900000
         AGO   .T109                                           @DA02108 30950000
.T108    ANOP                                                      3-10 31000000
         AIF ('&IOAREA1' EQ '').T108A                          @DA02108 31050000
IJF1&SYSNDX CCW   X'0C',&IOAREA1+&BLKS-1,X'00',&BLKS           @DA02108 31100000
         AGO   .T109                                           @DA02108 31150000
.T108A   ANOP                                                  @DA02108 31200000
IJF1&SYSNDX CCW   X'0C',&IOA1+&BLKS-1,X'00',&BLKS              @DA02108 31250000
.T109    AIF   ('&IOAREA2' NE '').T111                             3-10 31300000
         AIF   ('&READ' EQ 'BACK').T110                            3-10 31350000
         AIF   ('&IOAREA1' EQ '').T109A                        @DA02108 31400000
         DC    A(&IOAREA1)             ONE IOAREA              @DA02108 31450000
         AGO   .T113                                           @DA02108 31500000
.T109A   DC    A(&IOA1)                ONE IOAREA              @DA02108 31550000
         AGO   .T113                                               3-10 31600000
.T110    AIF   ('&IOAREA1' EQ '').T110A                        @DA02108 31650000
         DC    A(&IOAREA1+&BLKS-1)     ONE IOAREA READ BACK    @DA02108 31700000
         AGO   .T113                                               3-10 31750000
.T110A   DC    A(&IOA1+&BLKS-1)        ONE IOAREA READ BACK    @DA02108 31800000
         AGO   .T113                                           @DA02108 31850000
.T111    AIF   ('&READ' EQ 'BACK').T112                            3-10 31900000
         DC    A(&IOAREA2)             TWO IOAREAS                 3-10 31950000
         AGO   .T113                                               3-10 32000000
.T112    DC    A(&IOAREA2+&BLKS-1)     TWO IOAREAS READ BACK       3-10 32050000
.T113    AIF   ('&FORMAT' EQ 'UNDEF').T138                          3-8 32100000
         AIF   ('&FORMAT'(1,1) NE 'V' AND '&FORMAT'(1,1) NE 'S').T81   -32150000
                                                                    3-8 32200000
         AIF   (&USA).T114                                          3-8 32250000
&BUFOFST SETA  4                                                    3-8 32300000
.T114    ANOP                                                       3-8 32350000
IJF3&SYSNDX DC    A(&BLKS)             DEBLOCKER 1                  3-8 32400000
         AIF   ('&IOAREA2' EQ '').T115                             3-10 32450000
IJF2&SYSNDX    DC    A(&IOAREA2)       DEBLOCKER 2                 3-10 32500000
         DC    2F'0'                   DEBLOCKER 3,4               3-10 32550000
IJF4&SYSNDX    DC    A(&IOAREA2+&BUFOFST)    DEBLOCKER 5           3-10 32600000
         DC    F'0'                    DEBLOCKER 6                 3-10 32650000
         AGO   .T115A                                              3-10 32700000
.T115    ANOP                                                      3-10 32750000
         AIF ('&IOAREA1' EQ '').T115B                          @DA02108 32800000
IJF2&SYSNDX DC    A(&IOAREA1)          DEBLOCKER 2             @DA02108 32850000
         AGO   .T115C                                          @DA02108 32900000
.T115B   ANOP                                                  @DA02108 32950000
IJF2&SYSNDX DC    A(&IOA1)             DEBLOCKER 2             @DA02108 33000000
.T115C   DC    2F'0'                   DEBLOCKER 3,4           @DA02108 33050000
         AIF ('&IOAREA1' EQ '').T115D                          @DA02108 33100000
IJF4&SYSNDX DC    A(&IOAREA1+&BUFOFST) DEBLOCKER 5             @DA02108 33150000
         AGO   .T115E                                          @DA02108 33200000
.T115D   ANOP                                                  @DA02108 33250000
IJF4&SYSNDX DC    A(&IOA1+&BUFOFST)    DEBLOCKER 5             @DA02108 33300000
.T115E   DC    F'0'                    DEBLOCKER 6             @DA02108 33350000
.T115A   AIF   ('&TYPEFLE' NE 'OUTPUT').T116                       3-10 33400000
         DC    AL2(&BLKS-&BUFOFST)                          @D65IDAK    33450009
         AGO   .T117                                                    33500000
.T116    DC    AL2(&BLKS)                                   @D65IDAK    33550009
.T117    DC    AL2(&BLKS-1)              BLOCKSIZE-1        @D65IDAK    33600009
         DC    AL2(0)                    RECSIZE-1          @D65IDAK    33650009
.T117A   AIF   ('&TYPEFLE' NE 'OUTPUT').T117C                           33700000
.************* ERROR AND TLBL INFORMATION                           3-8 33750000
         AIF   ('&FILABL' NE 'STD').ADRMOD3                         3-4 33800000
         DC    2X'00'                  RESERVED                         33850000
         DC    2X'00'                  RESERVED FOR OPEN                33900000
         DC    6X'00'                  FILE SERIAL NO.                  33950000
         DC    4X'00'                  VOLUME SEQUENCE NO.              34000000
         DC    4X'00'                  FILE SEQUENCE NO.                34050000
.ADRMOD3 AIF   ('&TYPEFLE' NE 'OUTPUT').ADRMOD4                @DA15941 34100000
         AIF   (&OPTERR OR '&ERROPT' EQ '').ADRMOD             @DA15941 34150000
         AGO   .ADRMOD5                                        @DA15941 34200000
.ADRMOD4 AIF   (NOT &EXTERR OR '&ERROPT' EQ '' OR '&ERROPT' EQ 'SKIP' O-34250000
               R '&ERROPT' EQ 'IGNORE').ADRMOD                 @DA15941 34300000
.ADRMOD5 AIF    ('&FILABL' EQ 'STD').GO000                     @DA15941 34350000
         AIF   ('&FORMAT' EQ 'UNDEF').GO000                         3-8 34400000
         DC    6X'00'                  NOT USED                     3-4 34450000
.GO000   AIF   ('&ERROPT' EQ 'IGNORE' OR '&ERROPT' EQ 'SKIP').GO001    -34500000
                                                               @DA15941 34550000
         DC    A(&ERROPT)                                      @DA15941 34600000
         AGO   .ADRMOD                                                  34650000
.GO001   B     28(15)                  IGNORE OPTION           @DA15941 34700000
         AGO   .ADRMOD                                         @DA15941 34750000
.T117C   DC    H'0'                    RESIDUAL COUNT               3-4 34800000
         AIF   ('&WLRERR' EQ '').T118                                   34850000
         DC    A(&WLRERR)              WLR-ADDRESS                      34900000
         AGO   .T121                                                    34950000
.T118    AIF   ('&ERROPT' EQ '' OR '&ERROPT' EQ 'IGNORE').T119      3-8 35000000
         AIF   ('&ERROPT' EQ 'SKIP').T120                               35050000
         DC    A(&ERROPT)              WLR-ADDRESS                      35100000
         AGO   .T122                                                    35150000
.T119    AIF   ('&FORMAT'(1,1) EQ 'V' OR '&FORMAT'(1,1) EQ 'S').T119A  -35200000
                                                                    3-8 35250000
         B     28(15)                  WLR ERROR IGNORE OPTION          35300000
         AGO   .T123                                                    35350000
.T119A   B     32(15)                  WLR ERROR IGNORE OPTION          35400000
         AGO   .T123                                                    35450000
.T120    B     24(15)                                                   35500000
.T121    AIF   ('&ERROPT' EQ '' OR '&ERROPT' EQ 'IGNORE').T123      3-8 35550000
         AIF   ('&ERROPT' EQ 'SKIP').T124                               35600000
.T122    DC    A(&ERROPT)              ERROR EXIT                       35650000
         AGO   .T125                                                3-8 35700000
.T123    B     28(15)                  ERROR IGNORE OPTION              35750000
         AGO   .T125                                                3-8 35800000
.T124    B     24(15)                  ERROR  SKIP OPTION               35850000
.T125    AIF   ('&FORMAT' EQ 'UNDEF').ADRMOD                        3-8 35900000
         AIF   ('&FILABL' NE 'STD').ADRMOD                              35950000
         DC    2X'00'                  RESERVED FOR OPEN                36000000
         DC    6X'00'                  FILE SERIAL NO.                  36050000
         DC    4X'00'                  VOLUME SEQUENCE NO.              36100000
         DC    4X'00'                  FILE SEQUENCE NO.                36150000
         AGO   .ADRMOD                                                  36200000
.************* UNDEFINED                                            3-8 36250000
.T127    ANOP                                                           36300000
IJF4&SYSNDX   DC   F'0'                DEBLOCKER 1                      36350000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').T128                            36400000
         AIF   ('&LRSZ' EQ '').T128                                     36450000
         L     &LRSZ,IJF4&SYSNDX-&NAME.(1)   GIVE USER RECSIZE          36500000
         AGO   .T129                                                    36550000
.T128    NOP   0(0)                          GIVE USER RECSIZE          36600000
.T129    AIF   ('&LIORE' EQ '').T130                                    36650000
         L     &LIORE,IJF2&SYSNDX-&NAME.(1)  LOAD USER IOREG            36700000
         AGO   .T106                                                3-8 36750000
.T130    NOP   0(0)                          LOAD USER IOREG            36800000
.T131    AGO   .T106                                                    36850000
.T138    AIF   ('&IOAREA2' EQ '').T139                             3-10 36900000
IJF2&SYSNDX    DC    A(&IOAREA2)       DEBLOCKER 2                 3-10 36950000
         AGO   .T140                                               3-10 37000000
.T139    ANOP                                                      3-10 37050000
         AIF ('&IOAREA1' EQ '').T139A                          @DA02108 37100000
IJF2&SYSNDX DC    A(&IOAREA1)          DEBLOCKER 2             @DA02108 37150000
         AGO   .T140                                           @DA02108 37200000
.T139A   ANOP                                                  @DA02108 37250000
IJF2&SYSNDX DC    A(&IOA1)             DEBLOCKER 2             @DA02108 37300000
.T140    AIF   ('&READ' EQ 'BACK').T141                            3-10 37350000
         LA    14,1(14)                INCREASE BLOCKCOUNT BY ONE       37400000
         AGO   .T142                                                    37450000
.T141    BCTR  14,0                DECREASE BLOCKCOUNT BY ONE       3-8 37500000
         NOPR  0                                                        37550000
.T142    DC    AL2(&BLKS)                BLOCKSIZE       @D65IDAK       37600009
         DC    AL2(&BLKS-1)              BLOCKSIZE-1     @D65IDAK       37650009
         AIF   ('&TYPEFLE' NE 'OUTPUT').T143                            37700000
         LR    12,&LRSZ                PICK UP RECSIZE                  37750000
         DC    H'0'                                                     37800000
         AIF   ('&FILABL' NE 'STD').ADRMOD                              37850000
         DC    2X'00'                  RESERVED FOR OPEN                37900000
         DC    6X'00'                  FILE SERIAL NO.                  37950000
         DC    4X'00'                  VOLUME SEQUENCE NO.              38000000
         DC    4X'00'                  FILE SEQUENCE NO.                38050000
         AGO   .ADRMOD                                                  38100000
.T143    NOPR  0                                                        38150000
         DC    H'0'                                                     38200000
         AGO   .T121                                                    38250000
.************* WORK                                                 3-8 38300000
.T148    ANOP                                                           38350000
&WSWI    SETA  32                                                       38400000
         AIF   ('&REWIND' NE 'UNLOAD').T149                             38450000
&WSWI    SETA  &WSWI+64                                                 38500000
         AGO   .T150                                                    38550000
.T149    AIF   ('&REWIND' NE 'NORWD').T150                              38600000
&WSWI    SETA  &WSWI+128                                                38650000
.T150    AIF   ('&READ' NE 'BACK').T151                                 38700000
&WSWI    SETA  &WSWI+16                                                 38750000
.T151    DC    AL1(&WSWI)              LOGICAL INDICATORS               38800000
         AIF   (T'&FILABL EQ 'O' OR '&FILABL' NE 'STD').T151A  @D147DRR 38850000
         DC    CL7'&NAME'                                      @D147DRR 38900000
         AGO   .T153                                                    38950000
.T151A   AIF   (T'&HDRINFO EQ 'O' ).T151B                      @D147DRR 39000000
         MNOTE 0,'HDRINFO NOT ALLOWED WITH UNLABELED WORKFILES,IGNORED' 39050000
.T151B   DC    X'0000'                                         @D147DRR 39100000
&NAME.L  DC    AL2(&BLKS)                RECORD LENGTH     @DY45700     39150010
         DC    AL2(&BLKS)                BLOCKSIZE         @DY45700     39200010
         AIF   ('&READ' EQ 'BACK').T152                                 39250000
         DC    X'02'                   READ FORWARD OP CODE             39300000
         AGO   .T153                                                    39350000
.T152    DC    X'0C'                   READ BACK OP CODE                39400000
.T153    AIF   ('&EOFADDR' NE '').T153A                                 39450000
         DC    AL3(*)         *****ERROR-PATCH EOF ADDRESS*****         39500000
         AGO   .T153B                                                   39550000
.T153A   DC    AL3(&EOFADDR)           END OF FILE ADDRESS              39600000
.T153B   ANOP                                                           39650000
IJF1&SYSNDX   CCW  X'02',*,X'20',1     CHANNEL PROGRAM                  39700000
         AIF   ('&READ' EQ 'BACK').T154                                 39750000
         DC    F'0'                    BLOCK COUNT                      39800000
         AGO   .T155                                                    39850000
.T154    DC    X'00400000'             BLOCK COUNT                      39900000
.T155    AIF   ('&FORMAT' EQ 'UNDEF').T156                          3-8 39950000
&WERR    SETA  16                                                   3-8 40000000
.T156    AIF   (T'&ERROPT EQ 'O' OR '&ERROPT' EQ 'SKIP').T157       3-8 40050000
         AIF   ('&ERROPT' NE 'IGNORE').T158                         3-8 40100000
&WERR    SETA  &WERR+64                                             3-8 40150000
.T157    AIF   (T'&FILABL EQ 'O' OR '&FILABL' NE 'STD').T157A  @D147DRR 40200000
         AIF   ('&HDRINFO' NE 'YES').T157A                     @D147DRR 40250000
&WERR    SETA  &WERR+32                                        @D147DRR 40300000
.T157A   DC    AL1(&WERR)              READ ERROR OPTION INDIC.@D147DRR 40350000
         AIF   (T'&FILABL EQ 'O' OR '&FILABL' NE 'STD').T157B  @D147DRR 40400000
         DC    AL3(0)                                          @D147DRR 40450000
&NAME.L  DC    AL2'&BLKS'              RECORD LENGTH           @D65IDAK 40500003
         DC    AL2'&BLKS'              BLOCKSIZE               @D65IDAK 40550003
.T157B   ANOP                                                  @D147DRR 40600000
         MEXIT                                                      3-8 40650000
.T158    DC    AL1(&WERR+128)          READ ERROR OPTION INDIC.@D147DRR 40700000
         DC    AL3(&ERROPT)            ERROR ROUTINE                3-8 40750000
         AIF   (T'&FILABL EQ 'O' OR '&FILABL' NE 'STD').T158A  @D147DRR 40800000
&NAME.L  DC    AL2'&BLKS'              RECORD LENGTH           @D65IDAK 40850003
         DC    AL2'&BLKS'              BLOCKSIZE               @D65IDAK 40900003
.T158A   ANOP                                                  @D147DRR 40950000
         MEXIT                                                      3-8 41000000
.************* ERROR AND TLBL INFORMATION                           3-8 41050000
.ADRMOD  AIF   ('&FORMAT'(1,1) NE 'S').ADRMOD1                      3-8 41100000
         AIF   ('&TYPEFLE' NE 'OUTPUT' AND '&FILABL' EQ 'STD').SP35 3-7 41150000
IJF5&SYSNDX EQU *                                                   3-7 41200000
         DC    XL(&NAME+124-IJF5&SYSNDX)'00' RESERVED               3-7 41250000
.SP35    ANOP                                                       3-7 41300000
IJFS&SYSNDX DC    F'0'                 SPANNED LOGICAL RECORD LENGTH3-7 41350000
         DC    XL1'00'                 SPANNED FLAGS BYTE           3-7 41400000
         DC    3XL1'00'                SPN POINTER WITHIN USER WORKA3-7 41450000
         MEXIT                                                      3-8 41500000
.ADRMOD1 AIF   ('&FORMAT' NE 'UNDEF').ENDMT                         3-8 41550000
         AIF   ('&TYPEFLE' NE 'OUTPUT').RSIS                        3-4 41600000
         AIF   (NOT &EXTERR OR '&ERROPT' EQ '' OR '&ERROPT' EQ 'SKIP' O-41650000
               R '&ERROPT' EQ 'IGNORE').ENDMT                       3-8 41700000
         DC    A(&ERROPT)                                           3-4 41750000
         MEXIT                                                      3-8 41800000
.RSIS    AIF   ('&WLRERR' EQ '').ERRXT                              3-8 41850000
         DC    A(&WLRERR)              WLR ADDR                         41900000
         AGO   .T162                                                    41950000
.ERRXT   AIF   ('&ERROPT' EQ '' OR '&ERROPT' EQ 'IGNORE').T160          42000000
         AIF   ('&ERROPT' EQ 'SKIP').T161                               42050000
         DC    A(&ERROPT)                                               42100000
         AGO   .T162                                                    42150000
.T160    B     28(15)                  WLR OPTION                       42200000
         AGO   .T162                                                    42250000
.T161    B     24(15)                  WLR OPTION                       42300000
.T162    AIF   ('&FILABL' NE 'STD').ENDMT                           3-8 42350000
         DC    2X'00'                  RESERVED FOR OPEN                42400000
         DC    6X'00'                  FILE SERIAL NO.                  42450000
         DC    4X'00'                  VOLUME SEQUENCE NO.              42500000
         DC    4X'00'                  FILE SEQUENCE NO.                42550000
.ENDMT   MEND                                                       3-8 42600000
