         MACRO                                                          00050000
&WTON    WTO123 &ROUTCDE=,&DESC=,&MF=                          @D61CDFG 00100053
.*##################################################################### 00150000
.*###############               ####################################### 00200000
.*###############  DECLARATION  ######### VERSION: 14.03.1990 14.00 H # 00250000
.*###############               ####################################### 00300000
.*##################################################################### 00350000
         LCLA  &BT           BIT NUMBER                                 00400000
         LCLA  &BALVAR       OFFSET FOR THE DC-BLOCK                    00450000
         LCLA  &BLCKLEN      WTO/WTOR BLOCK LENGTH                      00500000
         LCLA  &BLENLEN      WTO/WTOR BLOCK LENGTH STORAGE (BYTE)       00550000
         LCLA  &CHARLEN      LENGTH OF A VALID MESSAGE LINE             00600000
         LCLA  &CHARNR       POINTER TO THE ACTUELL CHARACTER IN A      00650000
.*                           MESSAGE                                    00700000
         LCLA  &COUNT        NUMBER OF MESSAGE LINES                    00750000
         LCLA  &DEFROUT      DEFAULT ROUTING CODE                       00800000
         LCLA  &DEFDESC      DEFAULT DESCRIPTOR CODE                    00850000
         LCLA  &DESCL        DESCRIPTOR CODE STORAGE (BYTE)             00900000
         LCLA  &DESCLEN      DESCRIPTOR CODE LENGTH                     00950000
         LCLA  &DESCNR       DESCRIPTOR CODE NUMBER                     01000000
         LCLA  &EXDHIG1      BOUNDARY 1 FOR EXCLUSIVE DESCRIPTOR CODE   01050000
         LCLA  &EXDHIG2      BOUNDARY 2 FOR EXCLUSIVE DESCRIPTOR CODE   01100000
         LCLA  &FD(10)       FIRST DIGIT OF LINETYP (&LINETYP)          01150000
         LCLA  &INSTBAL      LENGTH OF BAL-INSTRUCTION                  01200000
         LCLA  &IOOFF        I/O OFFSET (BYTE)                          01250000
         LCLA  &IOOFFL       I/O OFFSET STORAGE (BYTE)                  01300000
         LCLA  &LINETYP      LINE TYPE                                  01350000
         LCLA  &LTP          LINE TYPE STORAGE (BYTE)                   01400000
         LCLA  &MAXDESC      HIGHEST DESCRIPTOR CODE                    01450000
         LCLA  &MAXMSG       MAXIMAL POSSIBLE NUMBER OF MESSAGES        01500000
         LCLA  &MAXROUT      HIGHEST ROUTING CODE                       01550000
         LCLA  &MINDESC      LOWEST DESCRIPTOR CODE                     01600000
         LCLA  &MINROUT      LOWEST ROUTING CODE                        01650000
         LCLA  &MLINLEN      MAXIMAL LENGHT OF THE ACTUELL MESSAGE LINE 01700000
         LCLA  &NR           MESSAGE NUMBER                             01750000
         LCLA  &RCDE         ROUTING CODE STORAGE (BYTE)                01800000
         LCLA  &RCDELEN      ROUTING CODE LENGTH                        01850000
         LCLA  &RLINLEN      REAL MESSAGE-LINE LENGTH                   01900000
         LCLA  &ROUTNR       ROUTING CODE NUMBER                        01950000
         LCLA  &SCHR(10)     NUMBER OF SPEZIAL CHARACTERS (' OR &)      02000000
.*                           IN ONE MESSAGE                             02050000
         LCLA  &TLEN         TEXT LENGTH STORAGE                        02100000
.*                                                                      02150000
         LCLB  &CLINFLG      C-LINE-FLAG                                02200000
         LCLB  &DLINFLG      D-LINE-FLAG                                02250000
         LCLB  &DC(16)       2 BYTE DESCRIPTOR CODE ARRAY               02300000
         LCLB  &DELNFLG      DE-LINE-FLAG                               02350000
         LCLB  &ELINFLG      E-LINE-FLAG                                02400000
         LCLB  &ERRFLG       ERROR FLAG                                 02450000
         LCLB  &EXCLFLG      EXCLUSIVE DESCRIPTOR CODE FLAG             02500000
         LCLB  &LLINFLG      L-LINE-FLAG                                02550000
         LCLB  &MFEFLG       EXECUTE-FORM-FLAG                          02600000
         LCLB  &MFLFLG       LIST-FORM-FLAGG CODE                       02650000
         LCLB  &MSGFLG       SINGLE-LINE-MESSAGE FLAG                   02700000
         LCLB  &RC(16)       2 BYTE ROUTING CODE ARRAY                  02750000
.*                                                                      02800000
         LCLC  &ADDR         ADDRESSNAME OR REGISTER WHICH POINTS TO    02850000
.*                           THE MESSAGE TABLE                          02900000
         LCLC  &CHRBOUN      LOWER BOUNDERY FOR NON PRINTABLE CHARACTER 02950000
         LCLC  &CHARSTR      VALID MESSAGE STRING WITH PRINTABLE        03000000
.*                           CHARACTERS                                 03050000
         LCLC  &MSG(10)      ARRAY WHICH CONTAINS THE VALID MESSAGES    03100000
         LCLC  &MSGTYPE      MESSAGETYPE ('C','L','D','DE','E')         03150000
         LCLC  &OPCDE        OPCODE ("LA" OR "LR") TO LOAD REGISTER 1   03200000
         LCLC  &REGNR        REGISTER NUMBER                            03250000
         LCLC  &VALDMSG      CONTAINS MESSAGE IF MESSAGE IS VALID       03300000
.********************************************************************** 03350000
.*       IBM DISK OPERATING SYSTEM                                      03400000
.*       SUPERVISOR - WTO - 5686-032-09-C56                             03450000
         AGO   .NOCOPY                                                  03500000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                    03550000
*        5686-007 (C) COPYRIGHT IBM CORP. 1979,1989                     03600000
*        ALL RIGHTS RESERVED                                            03650000
*        LICENSED MATERIALS-PROPERTY OF IBM                             03700000
*        SEE COPYRIGHT INSTRUCTIONS, G120-2083                          03750000
************************************** ******************************** 03800000
*                                                                       03850000
* MACRO NAME:             ***************                               03900000
*                         * ########### *                               03950000
*                         * #         # *                               04000000
*                         * #  W T O  # *                               04050000
*                         * #         # *                               04100000
*                         * ########### *                               04150000
*                         ***************                               04200000
*                                                                       04250000
*                                                                       04300000
* FUNCTION:   THE WTO MACRO INSTRUCTION CAUSES A MESSAGE TO BE          04350000
*             WRITTEN TO ONE OR MORE OPERATOR CONSOLES                  04400000
*                                                                       04450000
* SYNTAX:                                                               04500000
*                                                                       04550000
*             NAME       OPTIONAL       (LABEL-NAME)                    04600000
*             WTO        MANDATORY      (MACRO-NAME)                    04650000
*             MESSAGE    MANDATORY      (FIRST MESSAGE)                 04700000
*             MESSAGE    OPTIONAL       (2 - 10 MESSAGE)                04750000
*             ROUTCDE=   OPTIONAL       (ROUTING CODE, DEFAULT=2,       04800000
*                                        MASTER CONSOLE INFORMATION)    04850000
*             DESC=      OPTIONAL       (DESCRIPTOR CODE DEFAULT=7,     04900000
*                                        APPLICATION                    04950000
*                                        PROGRAM/PROCESSOR)             05000000
*             MF=        OPTIONAL       (MACRO-FORM, DEFAULT=NORMAL)    05050000
*                                                                       05100000
*                                                                       05150000
* VARIABLES:  ARITHMETIC                                                05200000
*             &BT                BIT NUMBER IN ROUTING AND DESCRIPTION  05250000
*                                CODE                                   05300000
*             &BALVAR            OFFSET FOR DC-BLOCK                    05350000
*             &BLCKLEN           WTO/WTOR BLOCK LENGTH                  05400000
*             &BLENLEN           WTO/WTOR BLOCK LENGTH STORAGE (BYTE)   05450000
*             &CHARLEN           LENGTH OF A VALID MESSAGE LINE         05500000
*             &CHARNR            POINTER TO THE ACTUELL CHARACTER IN A  05550000
*                                MESSAGE                                05600000
*             &COUNT             COUNTS NUMBER OF MESSAGE LINES         05650000
*             &DEFROUT           DEFAULT ROUTING CODE                   05700000
*             &DEFDESC           DEFAULT DESCRIPTOR CODE                05750000
*             &DESCL             STORAGE FOR DESCRIPTOR CODE (2 BYTE)   05800000
*             &DESCLEN           DESCRIPTOR CODE LENGHT                 05850000
*             &DESCNR            DESCRIPTOR CODE NUMBER                 05900000
*             &EXDHIG1           HIGHEST EXCLUSIVE DESCRIPTOR CODE      05950000
*                                (LOWER HALF)                           06000000
*             &EXDHIG2           HIGHEST EXCLUSIVE DESCRIPTOR CODE      06050000
*                                (UPPER HALF)                           06100000
*             &FD                FIRST DIGIT OF LINETYPE (&LINETYP)     06150000
*             &INSTBAL           LENGTH OF BAL-INSTRUCTION (4 BYTE)     06200000
*             &IOOFF             I/O OFFSET IN BYTE                     06250000
*             &IOOFFL            STORAGE FOR I/O OFFSET (2 BYTE)        06300000
*             &LINETYP           CODED LINETYP, VALUES ARE:             06350000
*                                 X'80'       SINGLE LINE MSG           06400000
*                                 X'8X'       INVALID                   06450000
*                                 X'4X'       "C"-LINE, REST X-LINES    06500000
*                                 X'3X'       "L"-LINE, REST X-LINES    06550000
*                                 X'2X'       "D"-LINE, REST X-LINES    06600000
*                                 X'1X'       "DE"-LINE, REST X-LINES   06650000
*                                 X'XX'       RESERVED FOR LATER USE    06700000
*                                THE FIRST DIGIT SPEZIFIES THE LINE     06750000
*                                TYPE AND THE SECOND SPEZIFIES HOW      06800000
*                                MUCH MESSAGE LINES ARE FOLLOWING       06850000
*             &LTP               STORAGE FOR LINETYPE (1 BYTE)          06900000
*             &MAXDESC           HIGHEST DESCRIPTOR CODE                06950000
*             &MAXMSG            MAXIMAL POSSIBLE MESSAGE NUMBER        07000000
*             &MAXROUT           HIGHEST ROUTING CODE                   07050000
*             &MINDESC           LOWEST DESCRIPTOR CODE                 07100000
*             &MINROUT           LOWEST ROUTING CODE                    07150000
*             &MLINLEN           MAXIMAL LENGHT OF THE ACTUELL MESSAGE  07200000
*             &NR                MESSAGE NUMBER                         07250000
*             &RCDE              STORAGE FOR ROUTING CODE (2 BYTE)      07300000
*             &RCDELEN           ROUTING CODE LENGTH                    07350000
*             &RLINLEN           REAL LENGHT OF THE ACTUELL MESSAGE     07400000
*             &ROUTNR            ROUTING CODE NUMBER                    07450000
*                                WHICH ARE SUPPRESSED BY THE ASSEMBLER  07500000
*             &SCHR(10)          NUMBER OF SPEZIAL CHARACTERS (' OR &)  07550000
*                                IN ONE MESSAGE WHICH ARE SUPPRESSED    07600000
*                                BY THE ASSEMBLER                       07650000
*             &TLEN              STORAGE FOR TEXT LENGTH (2 BYTE)       07700000
*                                                                       07750000
*             BOOLEAN                                                   07800000
*             &CLINFLG           FLAG ("1" IF "C" LINE TYPE OCCURED)    07850000
*             &DLINFLG           FLAG ("1" IF "D" LINE TYPE OCCURED)    07900000
*             &DC                DESCRIPTOR CODE, 2 BYTE DESCRIPTION    07950000
*             &DELNFLG           FLAG ("1" IF "DE" LINE TYPE OCCURED)   08000000
*             &ELINFLG           FLAG ("1" IF "E" LINE TYPE OCCURED)    08050000
*             &ERRFLG            FLAG ("1" IF AN ERROR HAS OCCURED      08100000
*                                AND NO DATA BLOCK SHOULD BE GENERATED  08150000
*             &EXCLFLG           FLAG ("1" IF EXCLUSIVE DESCRIPTOR      08200000
*                                CODE OCCURED)                          08250000
*             &LLINFLG           FLAG ("1" IF "L" LINE TYPE OCCURED)    08300000
*             &MFEFLG            FLAG ("1" IF EXECUTEFORM IS REQUIRED)  08350000
*             &MFLFLG            FLAG ("1" IF LISTFORM IS REQUIRED)     08400000
*             &MSGFLG            FLAG ("1" IF SINGLE LINE MESSAGE)      08450000
*             &RC                ROUTING CODE, 2 BYTE DESCRIPTION       08500000
*                                                                       08550000
*             CHARACTER                                                 08600000
*             &ADDR              ADDRESSNAME OR REGISTER WHICH POINTS   08650000
*                                TO THE MESSAGE TABLE                   08700000
*             &CHRBOUN           LOWER BOUNDERY FOR NON PRINTABLE       08750000
*                                CHARACTER                              08800000
*             &CHARSTR           VALID MESSAGE STRING WITH PRINTABLE    08850000
*                                CHARACTERS                             08900000
*             &MSG(10)           ARRAY CONTAINING THE VALID MESSAGES    08950000
*             &MSGTYPE           MESSAGETYPE ('C','L','D','DE','E')     09000000
*             &OPCDE             OPCODE ("LA" OR "LR") TO LOAD          09050000
*                                REGISTER 1                             09100000
*             &REGNR             REGISTER WHICH CONTAINS THE MESSAGE-   09150000
*                                TABLE POINTER                          09200000
*             &VALDMSG           CONTAINS MESSAGE IF MESSAGE IS VALID   09250000
*                                                                       09300000
* OPERATION: 1- DECLARATION                                             09350000
*            2- INITIALISATION                                          09400000
*            3- CHECK IF LIST OR EXECUTE FORM IS REQUIRED               09450000
*            4- CHECK IF VALID MESSAGE                                  09500000
*            5- CHECK IF MULTI OR SINGLE LINE MESSAGE                   09550000
*               5.1- MULTILINE SYNTAX CHECK                             09600000
*                  5.1.1- "D" LINE                                      09650000
*                  5.1.2- "E" LINE                                      09700000
*                  5.1.3- "L" LINE                                      09750000
*                  5.1.4- "C" LINE                                      09800000
*                  5.1.5- "DE" LINE                                     09850000
*               5.2- SINGLE LINE MESSAGE                                09900000
*            6- CHECK CHARACTERS                                        09950000
*            7- CHECK MESSAGE LENGTH                                    10000000
*            8- CHECK IF THERE IS ANOTHER MESSAGE LINE                  10050000
*            9- CHECK IF VALID MULTI MESSAGE END                        10100000
*           10- CHECK IF VALID ROUTING CODE                             10150000
*           11- CHECK IF VALID DESCRIPTOR CODE                          10200000
*           12- STORE MESSAGE                                           10250000
*           13- SAVE POINTER IN REGISTER                                10300000
*           14- SUPERVISOR CALL                                         10350000
*                                                                       10400000
* SPECIAL HINTS:                                                        10450000
*                                                                       10500000
*            1- THE MAXIMAL NUMBER OF ALLOWED MESSAGE LINES IS 10       10550000
*            2- IF MORE THAN 10 MESSAGE LINES ARE GIVEN, AN ERROR       10600000
*               WILL OCCURE; THE LINES ARE NOT TRUNCED !                10650000
*            3- IN AN MULTI-LINE-MESSAGE THE LAST MESSAGE MUST BE       10700000
*               A "DE"-TYP OR A "E"-TYP                                 10750000
*            4- IF THE WTO-MACRO IS CALLED, THE I/O-OFFSET IS 0         10800000
*            5- ('MESSAGE',) IS A VALID MESSAGE-LINE. THE DEFAULT       10850000
*               LINETYP IS ASSUMED                                      10900000
*                                                                       10950000
* STORAGE LAYOUT FOR THE SUPERVISOR:                                    11000000
*                                                                       11050000
*|BLK-LEN|ROUTCDE|DESC|I/O-OFF|L-TYP|MSGLEN| MSG |L-TYP|MSGLEN| MSG |.. 11100000
*|-------|-------|----|-------|-----|------|---- |-----|------|---- |.. 11150000
*|   2   |   2   |  2 |   2   |  1  |   2  |  X  |  1  |   2  |  X  |.. 11200000
*                                                                       11250000
*********************************************************************** 11300000
.*                                                                      11350000
.*                                                                      11400000
.*                                                                      11450000
.NOCOPY  ANOP                                                           11500000
.*##################################################################### 11550000
.*################                 #################################### 11600000
.*################ INITIALISATION  #################################### 11650000
.*################                 #################################### 11700000
.*##################################################################### 11750000
&BT      SETA  0             BIT NUMBER                                 11800000
&BALVAR  SETA  0             OFFSET FOR THE DC-BLOCK                    11850000
&BLCKLEN SETA  0             WTO/WTOR BLOCK LENGTH                      11900000
&BLENLEN SETA  2             WTO/WTOR BLOCK LENGTH STORAGE (BYTE)       11950000
&CHARLEN SETA  0             LENGTH OF A VALID MESSAGE LINE             12000000
&CHARNR  SETA  0             POINTER TO THE ACTUELL CHARACTER IN A      12050000
.*                           MESSAGE                                    12100000
&COUNT   SETA  0             NUMBER OF MESSAGE LINES                    12150000
&DEFROUT SETA  2             DEFAULT ROUTING CODE                       12200000
&DEFDESC SETA  7             DEFAULT DESCRIPTOR CODE                    12250000
&DESCL   SETA  2             DESCRIPTOR CODE STORAGE (BYTE)             12300000
&DESCLEN SETA  0             DESCRIPTOR CODE LENGTH                     12350000
&DESCNR  SETA  1             DESCRIPTOR CODE LENGTH                     12400000
&EXDHIG1 SETA  6             BOUNDERY 1 FOR EXCLUSIVE DESCRIPTOR CODE   12450000
&EXDHIG2 SETA  11            BOUNDERY 2 FOR EXCLUSIVE DESCRIPTOR CODE   12500000
&INSTBAL SETA  4             LENGTH OF BAL-INSTRUCTIN IN BYTE           12550000
&IOOFF   SETA  0             I/O OFFSET (BYTE)                          12600000
&IOOFFL  SETA  2             I/O OFFSET STORAGE (BYTE)                  12650000
&LINETYP SETA  0             LINE TYPE                                  12700000
&LTP     SETA  1             LINE TYPE STORAGE (BYTE)                   12750000
&MAXDESC SETA  16            HIGHEST DESCRIPTOR CODE                    12800000
&MAXMSG  SETA  10            MAXIMAL POSSIBLE NUMBER OF MESSAGES        12850000
&MAXROUT SETA  16            HIGHEST ROUTING CODE                       12900000
&MINDESC SETA  1             LOWEST DESCRIPTOR CODE                     12950000
&MINROUT SETA  1             LOWEST ROUTING CODE                        13000000
&MLINLEN SETA  125           MAXIMAL LENGTH OF THE ACTUELL MESSAGE      13050000
&NR      SETA  1             MESSAGE NUMBER                             13100000
&RCDE    SETA  2             ROUTING CODE STORAGE (BYTE)                13150000
&RCDELEN SETA  0             ROUTING CODE LENGTH                        13200000
&RLINLEN SETA  0             REAL MESSAGE LINE LENGTH                   13250000
&ROUTNR  SETA  1             ROUTING CODE NUMBER                        13300000
&TLEN    SETA  2             TEXT LENGTH STORAGE                        13350000
.*                                                                      13400000
&CLINFLG SETB  0             C-LINE-FLAG                                13450000
&DLINFLG SETB  0             D-LINE-FLAG                                13500000
&DELNFLG SETB  0             DE-LINE-FLAG                               13550000
&ELINFLG SETB  0             E-LINE-FLAG                                13600000
&ERRFLG  SETB  0             ERROR FLAG                                 13650000
&EXCLFLG SETB  0             EXCLUSIVE DESCRIPTOR CODE FLAG             13700000
&LLINFLG SETB  0             L-LINE-FLAG                                13750000
&MFEFLG  SETB  0             EXECUTE-FORM-FLAG                          13800000
&MFLFLG  SETB  0             LIST-FORM-FLAGG CODE                       13850000
&MSGFLG  SETB  0             SINGLE-LINE-MESSAGE-FLAG                   13900000
.*                                                                      13950000
&ADDR    SETC  ''            ADDRESSNAME OR REGISTER                    14000000
&CHRBOUN SETC  ' '           LOWER BOUNDERY FOR NON PRINTABLE CHARACTER 14050000
&CHARSTR SETC  ''            VALID MESSAGE STRING WITH PRINTABLE        14100000
.*                           CHARACTERS                                 14150000
&MSGTYPE SETC  ''            MESSAGETYPE ('C','L','D','DE','E')         14200000
&OPCDE   SETC  ''            OPCODE ("LA" OR "LR") TO LOAD REGISTER 1   14250000
&REGNR   SETC  ''            REGISTER NUMBER                            14300000
&VALDMSG SETC  ''            CONTAINS MESSAGE IF MESSAGE IS VALID       14350000
.********************************************************************** 14354553
.* DETERMINE RANGE OF NON-NULL POSITIONAL PARAMETERS           @D61CDFG 14359053
.********************************************************************** 14363553
&NPOS    SETA  N'&SYSLIST                                      @D61CDFG 14368053
.NPOS1   ANOP                                                  @D61CDFG 14372553
         AIF   (&NPOS EQ 0).NPOS2                              @D61CDFG 14377053
         AIF   ('&SYSLIST(&NPOS)' NE '').NPOS2                 @D61CDFG 14381553
&NPOS    SETA  &NPOS-1                                         @D61CDFG 14386053
         AGO   .NPOS1                                          @D61CDFG 14390553
.NPOS2   ANOP                                                  @D61CDFG 14395053
.*--------------------------- SET POINTER TO STORAGE POSITION OF ------ 14400000
.*--------------------------- FIRST LINETYPE -------------------------- 14450000
&BALVAR  SETA  &INSTBAL+&BLENLEN+&RCDE+&DESCL+&IOOFFL                   14500000
.*##################################################################### 14550000
.*###############                                            ########## 14600000
.*###############  CHECK IF LIST OR EXECUTE FORM IS REQUIRED ########## 14650000
.*###############                                            ########## 14700000
.*##################################################################### 14750000
.MFCHECK ANOP                                                           14800000
.*--------------------------- CHECK IF MF IS OMITTED ------------------ 14850000
         AIF   (T'&MF(1) EQ 'O').NAMEOK                                 14900000
.*--------------------------- CHECK IF LISTFORM WAS SPECIFIED --------- 14950000
         AIF   ((N'&MF EQ 1) AND ('&MF' EQ 'L')).LSTFORM                15000000
.*--------------------------- CHECK IF EXECUTE FORM WAS SPECIFIED ----- 15050000
         AIF   ( ('&MF'(1,3) EQ '(E,' )                                X15100000
                 AND                                                   X15150000
                 ('&MF'(K'&MF,1) EQ ')' )       ).CNT1CHK               15200000
         AGO   .WRGSYNT                                                 15250000
.CNT1CHK AIF     (N'&MF EQ 2).MFEOK                                     15300000
.WRGSYNT MNOTE 16,'ERROR - INVALID SYNTAX IN MF-PARAMETER'              15350000
&ERRFLG  SETB  1                                                        15400000
         AGO   .NAMEOK                                                  15450000
.*--------------------------- CHECK EXECUTE FORM SYNTAX --------------- 15500000
.MFEOK   ANOP                                                           15550000
&MFEFLG  SETB  1                                                        15600000
         AIF   (&NPOS EQ 0).CHKRNR                             @D61CDFG 15650053
         MNOTE 4,'WARNING - EXECUTE FORM SPECIFIED; ALL MESSAGES IGNOREX15700000
               D'                                                       15750000
.CHKRNR  AIF   (N'&ROUTCDE EQ 0).CHKDNR                                 15800000
         MNOTE 4,'WARNING - EXECUTE FORM SPECIFIED; ALL ROUTING CODES IX15850000
               GNORED'                                                  15900000
.CHKDNR  AIF   (N'&DESC EQ 0).ADRORRE                                   15950000
         MNOTE 4,'WARNING - EXECUTE FORM SPECIFIED; ALL DESCRIPTOR CODEX16000000
               S IGNORED'                                               16050000
.ADRORRE ANOP                                                           16100000
.*--------------------------- CHECK IF LABEL WAS SPECIFIED ------------ 16150000
         AIF   (T'&WTON EQ 'O').NOLAB                                   16200000
.*--------------------------- WRITE LABEL ----------------------------- 16250000
&WTON    DS    0H                                                       16300000
.NOLAB   ANOP                                                           16350000
         LA    0,4                              * LOAD FUNCTIONCODE   * 16400000
.*--------------------------- CHECK IF REGISTER WAS SPECIFIED --------- 16450000
         AIF   ( ( '&MF(2)'(1,1) EQ '(' )                              X16500000
                 AND                                                   X16550000
                 ( '&MF(2)'(K'&MF(2),1) EQ ')' )              ).REGISTR 16600000
         AGO   .ADDRESS                                                 16650000
.*--------------------------- REGISTER SPECIFIED ---------------------- 16700000
.REGISTR ANOP                                                           16750000
&REGNR   SETC  '&MF(2)'(2,K'&MF(2)-2)                                   16800000
.*--------------------------- CHECK IF REGISTER 1 WAS SPECIFIED ------- 16850000
         AIF   ('&REGNR' EQ '1').SUPCALL                                16900000
.*--------------------------- REGISTER 1 WAS NOT SPECIFIED ------------ 16950000
&OPCDE   SETC  'LR'                                                     17000000
&ADDR    SETC  '&MF(2)'                                                 17050000
         AGO   .LOADREG                                                 17100000
.*--------------------------- ADDRESS SPECIFIED ----------------------- 17150000
.ADDRESS ANOP                                                           17200000
&OPCDE   SETC  'LA'                                                     17250000
&ADDR    SETC  '&MF(2)'                                                 17300000
         AGO   .LOADREG                                                 17350000
.*--------------------------- LIST FORM SPECIFIED --------------------- 17400000
.LSTFORM ANOP                                                           17450000
&MFLFLG  SETB  1                                                        17500000
.*##################################################################### 17550000
.*###############                          ############################ 17600000
.*###############  CHECK IF VALID MESSAGE  ############################ 17650000
.*###############                          ############################ 17700000
.*##################################################################### 17750000
.NAMEOK  ANOP                                                           17800000
.*--------------------------- CHECK IF MESSAGE WAS (,E) OR ('',E) ----- 17850000
         AIF   ( ( '&SYSLIST(&NR)' EQ '(,E)' )                         X17900000
                 OR                                                    X17950000
                 ( '&SYSLIST(&NR)' EQ '('''',E)' )            ).PRELAST 18000000
.*--------------------------- CHECK IF MESSAGE WAS SPECIFIED ---------- 18050000
.*--------------------------- AND NO NULL-STRING <''> ----------------- 18100000
         AIF   (T'&SYSLIST(&NR,1) NE 'O').SYNERR                        18150000
         MNOTE 16,'ERROR - MISSING TEXT PARAMETER IN LINE NR &NR'       18200000
         AGO .MSGERR                                                    18250000
.SYNERR  AIF   (K'&SYSLIST(&NR,1) GT 2).TEXTOK                          18300000
         MNOTE 16,'ERROR - SYNTAX ERROR IN MESSAGE-LINE NR &NR'         18350000
.MSGERR  ANOP                                                           18400000
&ERRFLG  SETB  1                                                        18450000
         AGO .LOOKNXT                                                   18500000
.*##################################################################### 18550000
.*###############                                         ############# 18600000
.*###############  CHECK IF MULTI OR SINGLE LINE MESSAGE  ############# 18650000
.*###############                                         ############# 18700000
.*##################################################################### 18750000
.TEXTOK  ANOP                                                           18800000
.*--------------------------- CHECK IF NOT FIRST MESSAGE LINE --------- 18850000
         AIF   (&NR GT 1).TEXT                                          18900000
.*--------------------------- CHECK IF SINGLE LINE MESSAGE BEGIN ------ 18950000
         AIF   ('&SYSLIST(&NR)'(1,1) EQ '''').MSG                       19000000
.*--------------------------- CHECK IF MULTI LINE MESSAGE BEGIN ------- 19050000
.TEXT    AIF   ('&SYSLIST(&NR)'(1,2) EQ '(''').BEGINOK                  19100000
         MNOTE 16,'ERROR - INVALID FIRST CHAR IN MESSAGE-LINE NR &NR'   19150000
         AGO .ENDE                                                      19200000
.*##################################################################### 19250000
.*###############                         ############################# 19300000
.*###############  MULTILINE SYNTAX CHECK ############################# 19350000
.*###############                         ############################# 19400000
.*##################################################################### 19450000
.BEGINOK ANOP                                                           19500000
.*--------------------------- ONLY TWO OPERANDS (MESSAGE AND LINETYPE)- 19550000
.*--------------------------- IN MESSAGE LINE ? ----------------------- 19600000
         AIF   (N'&SYSLIST(&NR) LT 3).SIORMUL                           19650000
         MNOTE 16,'ERROR - MESSAGE-LINE NR &NR HAS TOO MUCH OPERANDS'   19700000
&ERRFLG  SETB  1                                                        19750000
         AGO .LOOKNXT                                                   19800000
.*--------------------------- CHECK IF MESSAGE NOT ('...') OR ('...',)- 19850000
.SIORMUL AIF   ( ('&SYSLIST(&NR)'(K'&SYSLIST(&NR)-1,1) NE '''')        X19900000
                 AND                                                   X19950000
                 ('&SYSLIST(&NR)'(K'&SYSLIST(&NR)-1,1) NE ',')  ).MULTI 20000000
         MNOTE 0,'INFORMATION - LINE-TYPE ''D'' ASSUMED IN MESSAGE-LINEX20050000
                NR &NR'                                                 20100000
         AGO .INFO                                                      20150000
.MULTI   ANOP                                                           20200000
&MSGTYPE SETC  '&SYSLIST(&NR,2)'                                        20250000
.*--------------------------- CHECK IF LINETYPE "DE" WAS SPECIFIED ---- 20300000
         AIF   ('&MSGTYPE' EQ 'DE').LASTLIN                             20350000
.*--------------------------- CHECK IF LINETYPE "E" WAS SPECIFIED ----- 20400000
         AIF   ('&MSGTYPE' EQ 'E').PRELAST                              20450000
.*--------------------------- CHECK IF LINETYPE "L" WAS SPECIFIED ----- 20500000
         AIF   ('&MSGTYPE' EQ 'L').LABEL                                20550000
.*--------------------------- CHECK IF LINETYPE "D" WAS SPECIFIED ----- 20600000
         AIF   ('&MSGTYPE' EQ 'D').INFO                                 20650000
.*--------------------------- CHECK IF LINETYPE "C" WAS SPECIFIED ----- 20700000
         AIF   ('&MSGTYPE' EQ 'C').CONTROL                              20750000
         MNOTE 16,'ERROR - INVALID LINETYPE IN MESSAGE-LINE NR &NR'     20800000
&ERRFLG  SETB  1                                                        20850000
         AGO .LOOKNXT                                                   20900000
.*##################################################################### 20950000
.*################          ########################################### 21000000
.*################ "D" LINE ########################################### 21050000
.*################          ########################################### 21100000
.*##################################################################### 21150000
.INFO    ANOP                                                           21200000
&DLINFLG SETB  1                                                        21250000
&MLINLEN SETA  70                                                       21300000
&FD(&NR) SETA  20                                                       21350000
         AGO .MSGOK                                                     21400000
.*##################################################################### 21450000
.*################          ########################################### 21500000
.*################ "E" LINE ########################################### 21550000
.*################          ########################################### 21600000
.*##################################################################### 21650000
.PRELAST ANOP                                                           21700000
&ELINFLG SETB  1                                                        21750000
.*--------------------------- CHECK IF MESSAGE IS OMITTED ------------- 21800000
         AIF   (T'&SYSLIST(&NR,1) EQ 'O').NOMSG                         21850000
         MNOTE 0,'INFORMATION - ''E'' MESSAGE IN MESSAGE LINE NR &NR WIX21900000
               LL BE SUPPRESSED'                                        21950000
.NOMSG   ANOP                                                           22000000
.*--------------------------- CHECK IF NO FOLLOWING MESSAGE SPECIFIED - 22050000
         AIF   (&NPOS EQ &NR).ONLYE                            @D61CDFG 22100053
         MNOTE 16,'ERROR - LINETYPE ''E'' MUST BE LAST MESSAGE LINE'    22150000
&ERRFLG  SETB  1                                                        22200000
         AGO .LOOKNXT                                                   22250000
.ONLYE   ANOP                                                           22300000
.*--------------------------- IS ANOTHER MESSAGE SPECIFIED ? ---------- 22350000
         AIF   (&NR NE 1).MSGEND                                        22400000
         MNOTE 16,'ERROR - LINETYPE ''E'' REQUIRES A PRECEEDING MESSAGEX22450000
                LINE'                                                   22500000
&ERRFLG  SETB  1                                                        22550000
         AGO .LOOKNXT                                                   22600000
.*##################################################################### 22650000
.*################          ########################################### 22700000
.*################ "L" LINE ########################################### 22750000
.*################          ########################################### 22800000
.*##################################################################### 22850000
.LABEL   ANOP                                                           22900000
.*--------------------------- CHECK IF VALID 'L' MESSAGE (SEE MNOTE) -- 22950000
         AIF   (&COUNT EQ 0).LBLLINE                                    23000000
         AIF   ( (&COUNT EQ 1)                                         X23050000
                 AND ( (&CLINFLG EQ 1) OR (&LLINFLG EQ 1) ) ).LBLLINE   23100000
         AIF   ( (&COUNT EQ 2) AND (&CLINFLG EQ 1)                     X23150000
                 AND (&LLINFLG EQ 1)                        ).LBLLINE   23200000
         MNOTE 16,'ERROR - LINETYPE ''L'' IS ONLY VALID :'              23250000
         MNOTE   '               - AS FIRST MESSAGE'                    23300000
         MNOTE   '               - AS SECOND MESSAGE AFTER AN ''C'' OR X23350000
               AN ''L'' MESSAGE'                                        23400000
         MNOTE   '               - AS THIRD MESSAGE AFTER FIRST AN ''C'X23450000
               ' AND SECOND AN                      ''L'' MESSAGE'      23500000
&ERRFLG  SETB  1                                                        23550000
&MLINLEN SETA  70                                                       23600000
         AGO .MSGLEN                                                    23650000
.LBLLINE ANOP                                                           23700000
&MLINLEN SETA  70                                                       23750000
&LLINFLG SETB  1                                                        23800000
&FD(&NR) SETA  30                                                       23850000
         AGO   .MSGOK                                                   23900000
.*##################################################################### 23950000
.*################          ########################################### 24000000
.*################ "C" LINE ########################################### 24050000
.*################          ########################################### 24100000
.*##################################################################### 24150000
.CONTROL ANOP                                                           24200000
.*--------------------------- CHECK IF 'C' MESSAGE IS THE FIRST MESSAGE 24250000
         AIF   (&COUNT EQ 0).CRTLINE                                    24300000
         MNOTE 16,'ERROR - ''C'' MUST BE FIRST MESSAGE LINE'            24350000
&ERRFLG  SETB  1                                                        24400000
&MLINLEN SETA  34                                                       24450000
         AGO .MSGLEN                                                    24500000
.CRTLINE ANOP                                                           24550000
&MLINLEN SETA  34                                                       24600000
&CLINFLG SETB  1                                                        24650000
&FD(&NR) SETA  40                                                       24700000
         AGO .MSGOK                                                     24750000
.*##################################################################### 24800000
.*################           ########################################## 24850000
.*################ "DE" LINE ########################################## 24900000
.*################           ########################################## 24950000
.*##################################################################### 25000000
.LASTLIN ANOP                                                           25050000
&MLINLEN SETA  70                                                       25100000
&DELNFLG SETB  1                                                        25150000
&FD(&NR) SETA  10                                                       25200000
.*--------------------------- CHECK IF NO FOLLOWING MESSAGES SPECIFIED  25250000
         AIF   (&NPOS EQ &NR).MSGOK                            @D61CDFG 25300053
         MNOTE 16,'ERROR - ''DE'' MUST BE LAST MESSAGE LINE'            25350000
&ERRFLG  SETB  1                                                        25400000
         AGO .MSGLEN                                                    25450000
.*##################################################################### 25500000
.*###############                       ############################### 25550000
.*###############  SINGLE LINE MESSAGE  ############################### 25600000
.*###############                       ############################### 25650000
.*##################################################################### 25700000
.MSG     ANOP                                                           25750000
&MSGFLG  SETB  1                                                        25800000
&FD(&NR) SETA  80                                                       25850000
.*##################################################################### 25900000
.*###############                   ################################### 25950000
.*###############  CHECK CHARACTER  ################################### 26000000
.*###############                   ################################### 26050000
.*##################################################################### 26100000
.MSGOK   ANOP                                                           26150000
&VALDMSG SETC  '&SYSLIST(&NR,1)'(2,K'&SYSLIST(&NR,1)-2)                 26200000
&CHARLEN SETA  K'&SYSLIST(&NR,1)-2                                      26250000
&CHARNR  SETA  1                                                        26300000
&CHARSTR SETC  ''                                                       26350000
.CHKNXT1 ANOP                                                           26400000
.*--------------------------- CHECK IF CHARACTER IS PRINTABLE --------  26450000
         AIF   ('&VALDMSG'(&CHARNR,1) GT '&CHRBOUN').CHAROK             26500000
.*--------------------------- REPLACE NON PRINTABLE CHARACTER BY BLANK  26550000
&CHARSTR SETC  '&CHARSTR'.' '                                           26600000
         AGO   .STROK                                                   26650000
.CHAROK  ANOP                                                           26700000
.*--------------------------- CHECK IF CHARACTER NOT EQUAL ' ---------  26750000
         AIF   ('&VALDMSG'(&CHARNR,1) NE '''').CHKAMP                   26800000
.*--------------------------- CHARACTER EQUAL ' ----------------------  26850000
&CHARSTR SETC  '&CHARSTR'.'&VALDMSG'(&CHARNR,1)                         26900000
&CHARNR  SETA  &CHARNR+1                                                26950000
.*--------------------------- INCREMENT SPEZIAL CHARACTER COUNT ------  27000000
&SCHR(&NR) SETA  &SCHR(&NR)+1                                           27050000
.*--------------------------- CHECK IF NEXT CHAR EQUAL ' -------------  27100000
         AIF   ('&VALDMSG'(&CHARNR,1) EQ '''').CONSTR                   27150000
         MNOTE 16,'ERROR - INVALID MESSAGE TEXT IN MESSAGE LINE NR &NR' 27200000
&ERRFLG  SETB  1                                                        27250000
         AGO   .LOOKNXT                                                 27300000
.CHKAMP  ANOP                                                           27350000
.*--------------------------- CHECK IF CHARACTER NOT EQUAL & ---------- 27400000
         AIF   ('&VALDMSG'(&CHARNR,1) NE '&&'(1,1)).CONSTR              27450000
.*--------------------------- CHARACTER EQUAL & ----------------------- 27500000
&CHARSTR SETC  '&CHARSTR'.'&VALDMSG'(&CHARNR,1)                         27550000
&CHARNR  SETA  &CHARNR+1                                                27600000
.*--------------------------- NEXT CHARACTER NOT EQUAL & ? ------------ 27650000
.*--------------------------- => VARIABLE WAS SPECIFIED --------------- 27700000
         AIF   ('&VALDMSG'(&CHARNR,1) NE '&&'(1,1)).CHKLOOP             27750000
.*--------------------------- INCREMENT SPEZIAL CHARACTER COUNT ------- 27800000
&SCHR(&NR) SETA  &SCHR(&NR)+1                                           27850000
.CONSTR  ANOP                                                           27900000
&CHARSTR SETC  '&CHARSTR'.'&VALDMSG'(&CHARNR,1)                         27950000
.STROK   ANOP                                                           28000000
&CHARNR  SETA  &CHARNR+1                                                28050000
.CHKLOOP ANOP                                                           28100000
.*--------------------------- IS THERE ANOTHER CHARACTER TO BE CHECKED? 28150000
         AIF   (&CHARNR LE &CHARLEN).CHKNXT1                            28200000
&MSG(&NR) SETC  '&CHARSTR'                                              28250000
.*##################################################################### 28300000
.*###############                        ############################## 28350000
.*###############  CHECK MESSAGE LENGTH  ############################## 28400000
.*###############                        ############################## 28450000
.*##################################################################### 28500000
.*--------------------------- CHECK IF MESSAGE LENGTH LESS THAN LIMIT - 28550000
.MSGLEN  ANOP                                                           28600000
         AIF   ((K'&SYSLIST(&NR,1)-2-&SCHR(&NR)) LE &MLINLEN).PREVERR   28650000
         MNOTE 16,'ERROR - MESSAGE-LINE NR &NR EXEEDS &MLINLEN CHARACTEX28700000
               R LIMIT'                                                 28750000
&ERRFLG  SETB  1                                                        28800000
.PREVERR ANOP                                                           28850000
         AIF   (&ERRFLG NE 1).ANOTHER                                   28900000
         AGO   .LOOKNXT                                                 28950000
.*##################################################################### 29000000
.*###############                                          ############ 29050000
.*###############  CHECK IF THERE IS ANOTHER MESSAGE LINE  ############ 29100000
.*###############                                          ############ 29150000
.*##################################################################### 29200000
.ANOTHER ANOP                                                           29250000
.*--------------------------- SET POINTER TO STORAGE LOCATION OF ------ 29300000
.*--------------------------- NEXT MESSAGE LINETYPE ------------------- 29350000
&BALVAR  SETA  &BALVAR+&LTP+&TLEN+&CHARLEN-&SCHR(&NR)                   29400000
.LOOKNXT ANOP                                                           29450000
&NR      SETA  &NR+1                                                    29500000
.*--------------------------- INCREMENT VALID MSG-LINE COUNT ---------- 29550000
&COUNT   SETA  &COUNT+1                                                 29600000
&RLINLEN SETA  K'&SYSLIST(&NR)                                          29650000
.*--------------------------- CHECK IF THERE'S NO FOLLOWING MESSAGE AND 29700000
.*--------------------------- MSG-LINE COUNT LESS/EQUAL LIMIT --------- 29750000
         AIF   ( (&NPOS      LE &NR) AND (&COUNT LE &MAXMSG)           X29800053
                 AND                                                   X29850000
                 (K'&SYSLIST(&NR) EQ 0)       ).MSGEND         @D61CDFG 29900053
.*--------------------------- CHECK IF LAST MESSAGE WAS --------------- 29950000
.*--------------------------- A SINGLE LINE MESSAGE ------------------- 30000000
         AIF   (&MSGFLG EQ 1).SLMSG                                     30050000
.*--------------------------- CHECK IF VALID MESSAGE LINE COUNT ------- 30100000
.*--------------------------- IS LESS THAN LIMIT => CHECK NEXT MESSAGE  30150000
         AIF   (&COUNT LT &MAXMSG).NAMEOK                               30200000
         MNOTE 16,'ERROR - NUMBER OF MESSAGES EXEEDS &MAXMSG LINE LIMITX30250000
               '                                                        30300000
         AGO   .ENDE                                                    30350000
.SLMSG   MNOTE 16,'ERROR - A SINGLE LINE MESSAGE MUST BE THE ONLY MESSAX30400000
               GE'                                                      30450000
         AGO   .ENDE                                                    30500000
.*##################################################################### 30550000
.*###############                                   ################### 30600000
.*###############  CHECK IF VALID MULTI MESSAGE END ################### 30650000
.*###############                                   ################### 30700000
.*##################################################################### 30750000
.MSGEND  ANOP                                                           30800000
.*--------------------------- CHECK IF SINGLE LINE MESSAGE SPECIFIED -- 30850000
         AIF   (&MSGFLG EQ 1).ROUT                                      30900000
.*--------------------------- CHECK IF NO "C" AND NO "L" LINE SPECIFIED 30950000
         AIF   ( (&LLINFLG EQ 0) AND (&CLINFLG EQ 0) ).INFOOK           31000000
.*--------------------------- CHECK IF  INFO-LINE "D" OR "DE" SPECIFIED 31050000
         AIF   ( (&DLINFLG EQ 1) OR (&DELNFLG EQ 1) ).INFOOK            31100000
         MNOTE 16,'ERROR - ''C'' OR ''L'' LINES MUST BE FOLLOWED BY ''DX31150000
               '' OR ''DE'' LINES'                                      31200000
&ERRFLG  SETB  1                                                        31250000
         AGO   .ROUT                                                    31300000
.INFOOK  ANOP                                                           31350000
.*--------------------------- CHECK IF VALID MULTI-MESSAGE END -------- 31400000
         AIF   ((&ELINFLG EQ 1) OR (&DELNFLG EQ 1)).ROUT                31450000
         MNOTE 16,'ERROR - MULTI LINE MESSAGE MUST BE ENDED WITH LINE-TX31500000
               YPE ''DE'' OR ''E'''                                     31550000
&ERRFLG  SETB  1                                                        31600000
.*##################################################################### 31650000
.*###############                              ######################## 31700000
.*###############  CHECK IF VALID ROUTING CODE ######################## 31750000
.*###############                              ######################## 31800000
.*##################################################################### 31850000
.ROUT    ANOP                                                           31900000
&RCDELEN SETA  N'&ROUTCDE                                               31950000
.*--------------------------- CHECK IF ROUTINGCODE IS SPECIFIED ------- 32000000
         AIF   (T'&ROUTCDE(&ROUTNR) NE 'O').ROUTOK                      32050000
&ROUTNR  SETA  &ROUTNR+1                                                32100000
.*--------------------------- CHECK IF AN ERROR OCCURED --------------- 32150000
.*--------------------------- => NO DEFAULT WARNING ------------------- 32200000
         AIF   (&ERRFLG EQ 1).DESCCDE                                   32250000
.*--------------------------- ALL ROUTINGCODES CHECKED ? -------------- 32300000
         AIF   (&ROUTNR LE &RCDELEN).ROUT                               32350000
         MNOTE 0,'INFORMATION - ROUTING CODE ''&DEFROUT'' ASSUMED'      32400000
.DEFROUT ANOP                                                           32450000
.*--------------------------- DEFAULT ROUTING CODE BINARY CODED ------- 32500000
&RC(2)   SETB 1                                                         32550000
         AGO   .DESCCDE                                                 32600000
.ROUTOK  ANOP                                                           32650000
.*--------------------------- CHECK IF ROUTINGCODE IS OMITTED --------- 32700000
         AIF   (T'&ROUTCDE(&ROUTNR) EQ 'O').ADD1RCD                     32750000
.*--------------------------- CHECK IF ROUTINGCODE IS VALID ----------- 32800000
         AIF   ( (&ROUTCDE(&ROUTNR) GE &MINROUT)                       X32850000
                 AND                                                   X32900000
                 (&ROUTCDE(&ROUTNR) LE &MAXROUT)              ).NXTROUT 32950000
         MNOTE 16,'ERROR - INVALID ROUTING CODE ''&ROUTCDE(&ROUTNR)'' (X33000000
               VALID : &MINROUT - &MAXROUT)'                            33050000
&ERRFLG  SETB  1                                                        33100000
         AGO   .ADD1RCD                                                 33150000
.NXTROUT ANOP                                                           33200000
.*--------------------------- CHECK IF ROUTINGCODE NOT SPECIFIED BEFOR  33250000
         AIF   (NOT &RC(&ROUTCDE(&ROUTNR))).BITOUT                      33300000
         MNOTE 16,'ERROR - ROUTING CODE ''&ROUTCDE(&ROUTNR)'' SPECIFIEDX33350000
                MORE THAN ONCE'                                         33400000
&ERRFLG  SETB  1                                                        33450000
         AGO   .ADD1RCD                                                 33500000
.BITOUT  ANOP                                                           33550000
.*--------------------------- SET FLAG FOR THIS ROUTINGCODE ----------- 33600000
&BT      SETA  &ROUTCDE(&ROUTNR)                                        33650000
&RC(&BT) SETB 1                                                         33700000
.ADD1RCD ANOP                                                           33750000
.*--------------------------- ALL ROUTINGCODE PARAMETER CHECKED ? ----- 33800000
         AIF   (&RCDELEN LE &ROUTNR).DESCCDE                            33850000
.*--------------------------- GET NEXT ROUTINGCODE--------------------- 33900000
&ROUTNR  SETA  &ROUTNR+1                                                33950000
         AGO   .ROUTOK                                                  34000000
.*##################################################################### 34050000
.*###############                                 ##################### 34100000
.*###############  CHECK IF VALID DESCRIPTOR CODE ##################### 34150000
.*###############                                 ##################### 34200000
.*##################################################################### 34250000
.DESCCDE ANOP                                                           34300000
&DESCLEN SETA  N'&DESC                                                  34350000
.*--------------------------- CHECK IF DESCRIPTOR CODE NOT OMITTED ---- 34400000
         AIF   (T'&DESC(&DESCNR) NE 'O').DESCOK                         34450000
&DESCNR  SETA  &DESCNR+1                                                34500000
.*--------------------------- ALL DESCRIPTORCODES CHECKED ? ----------- 34550000
         AIF   (&DESCNR LE &DESCLEN).DESCCDE                            34600000
.*--------------------------- CHECK IF AN ERROR OCCURED --------------- 34650000
.*--------------------------- => NO DEFAULT WARNING ------------------- 34700000
         AIF   (&ERRFLG EQ 1).STORE                                     34750000
         MNOTE 0,'INFORMATION - DESCRIPTOR CODE ''&DEFDESC'' ASSUMED'   34800000
.DEFDESC ANOP                                                           34850000
.*--------------------------- DEFAULT DESCRIPTOR CODE BINARY CODED ---- 34900000
&DC(7)   SETB 1                                                         34950000
         AGO   .STORE                                                   35000000
.DESCOK  ANOP                                                           35050000
.*--------------------------- CHECK IF DESCRIPTORCODE IS OMITTED ------ 35100000
         AIF   (T'&DESC(&DESCNR) EQ 'O').ADD1DSC                        35150000
.*--------------------------- CHECK IF DESCRIPTORCODE IS VALID -------- 35200000
         AIF   ( (&DESC(&DESCNR) GE &MINDESC)                          X35250000
                 AND                                                   X35300000
                 (&DESC(&DESCNR) LE &MAXDESC)                 ).EXCLUSV 35350000
         MNOTE 16,'ERROR - INVALID DESCRIPTOR CODE ''&DESC(&DESCNR)'' (X35400000
               VALID : &MINDESC - &MAXDESC)'                            35450000
&ERRFLG  SETB  1                                                        35500000
         AGO   .ADD1DSC                                                 35550000
.EXCLUSV ANOP                                                           35600000
.*--------------------------- CHECK IF DESCRIPTORCODE IS -------------- 35650000
.*--------------------------- NOT MUTUALLY EXCLUSIVE ------------------ 35700000
         AIF   ( (&DESC(&DESCNR) GT &EXDHIG1)                          X35750000
                 AND                                                   X35800000
                 (&DESC(&DESCNR) NE &EXDHIG2)                ).NXTDESC  35850000
.*--------------------------- MUTUALLY EXCLUSIVE DESCRIPTORCODE ------- 35900000
.*--------------------------- NOT SPECIFIED BEFOR ? ------------------- 35950000
         AIF   (&EXCLFLG EQ 0).EXCLFLG                                  36000000
         MNOTE 16,'ERROR - DESCRIPTOR CODES 1 -6 AND 11 ARE MUTUALLY EXX36050000
               CLUSIVE'                                                 36100000
&ERRFLG  SETB  1                                                        36150000
         AGO   .ADD1DSC                                                 36200000
.EXCLFLG ANOP                                                           36250000
.*--------------------------- SET MUTUALLY EXCLUSIVE FLAG ------------- 36300000
&EXCLFLG SETB  1                                                        36350000
.NXTDESC ANOP                                                           36400000
.*--------------------------- CHECK IF DESCRIPTOR CODE WAS ------------ 36450000
.*--------------------------- NOT SPECIFIED BEFOR --------------------- 36500000
         AIF   (NOT &DC(&DESC(&DESCNR))).OUTBIT                         36550000
         MNOTE 16,'ERROR - DESCRIPTOR CODE ''&DESC'' SPECIFIED MORE THAX36600000
               N ONCE'                                                  36650000
&ERRFLG  SETB  1                                                        36700000
         AGO   .ADD1DSC                                                 36750000
.OUTBIT  ANOP                                                           36800000
&BT      SETA  &DESC(&DESCNR)                                           36850000
.*--------------------------- SET FLAG FOR THIS DESCRIPTORCODE -------- 36900000
&DC(&BT) SETB 1                                                         36950000
.ADD1DSC ANOP                                                           37000000
.*--------------------------- ALL DESCRIPTORCODE PARAMETER CHECKED ? -- 37050000
         AIF   (&DESCLEN LE &DESCNR).STORE                              37100000
.*--------------------------- GET NEXT DESCRIPTORCODE ----------------- 37150000
&DESCNR  SETA  &DESCNR+1                                                37200000
         AGO   .DESCOK                                                  37250000
.*##################################################################### 37300000
.*###############                 ##################################### 37350000
.*###############  STORE MESSAGE  ##################################### 37400000
.*###############                 ##################################### 37450000
.*##################################################################### 37500000
.STORE   ANOP                                                           37550000
.*--------------------------- CHECK IF AN ERROR HAS OCCURED ----------- 37600000
.*--------------------------- => DO NOT STORE ------------------------- 37650000
         AIF   (&ERRFLG EQ 1).ENDE                                      37700000
&NR      SETA  1                                                        37750000
.NXT     ANOP                                                           37800000
&RLINLEN SETA  K'&SYSLIST(&NR,1)-2-&SCHR(&NR)                           37850000
&LINETYP SETA  &FD(&NR)+&COUNT-&NR                                      37900000
.*--------------------------- CHECK IF IT IS NOT THE FIRST MESSAGE ---- 37950000
         AIF   (&NR GT 1).STORNXT                                       38000000
&ADDR    SETC  '&WTON'                                                  38050000
.*--------------------------- CHECK IF LISTFORM WAS SPECIFIED --------- 38100000
&BLCKLEN SETA  &BALVAR-&INSTBAL                                         38150000
         AIF   (&MFLFLG EQ 1).LISTFRM                                   38200000
.*--------------------------- SET OFFSET TO HALFWORD BOUNDERY --------- 38250000
&BALVAR  SETA  ((&BALVAR+1)/2*2)                                        38300000
&WTON    LA    0,4                              * LOAD FUNCTIONCODE   * 38350000
         BAL   1,*+&BALVAR                                              38400000
         AGO   .NORMAL                                                  38450000
.LISTFRM ANOP                                                           38500000
&WTON    DS    0H                               * FORCE ALIGNMENT     * 38550000
.NORMAL  ANOP                                                           38600000
         DC    AL2(&BLCKLEN)                    * WTO/WTOR BLOCK LENGTH 38650000
         DC    B'&RC(1)&RC(2)&RC(3)&RC(4)&RC(5)&RC(6)&RC(7)&RC(8)&RC(9)X38700000
               &RC(10)&RC(11)&RC(12)&RC(13)&RC(14)&RC(15)&RC(16)'      X38750000
                                                * ROUTING CODE        * 38800000
         DC    B'&DC(1)&DC(2)&DC(3)&DC(4)&DC(5)&DC(6)&DC(7)&DC(8)&DC(9)X38850000
               &DC(10)&DC(11)&DC(12)&DC(13)&DC(14)&DC(15)&DC(16)'      X38900000
                                                * DESCRIPTOR CODE     * 38950000
         DC    AL2(&IOOFF)                      * I/O OFFSET          * 39000000
.STORNXT ANOP                                                           39050000
         DC    X'&LINETYP'                      * MESSAGE LINE TYPE   * 39100000
         DC    AL2(&RLINLEN)                    * MESSAGE LENGTH      * 39150000
         DC    C'&MSG(&NR)'                                            X39200000
                                                * MESSAGE TEXT        * 39250000
&NR      SETA  &NR+1                                                    39300000
.*--------------------------- ALL MESSAGES STORED ? ------------------- 39350000
         AIF   (&COUNT LT &NR).CALLSVC                                  39400000
         AGO   .NXT                                                     39450000
.*--------------------------- LISTFORM REQUIRED ? --------------------- 39500000
.CALLSVC AIF   (&MFLFLG EQ 1).ENDE                                      39550000
         AGO   .SUPCALL                                                 39600000
.*##################################################################### 39650000
.*###############                            ########################## 39700000
.*###############  SAVE POINTER IN REGISTER  ########################## 39750000
.*###############                            ########################## 39800000
.*##################################################################### 39850000
.LOADREG ANOP                                                           39900000
         &OPCDE 1,&ADDR                         * POINTER TO LISTBLOCK* 39950000
.*##################################################################### 40000000
.*###############                  #################################### 40050000
.*###############  SUPERVISOR CALL #################################### 40100000
.*###############                  #################################### 40150000
.*##################################################################### 40200000
.SUPCALL ANOP                                                           40250000
         SVC   32                                                       40300000
.ENDE    ANOP                                                           40350000
         MEND                                                           40400000
