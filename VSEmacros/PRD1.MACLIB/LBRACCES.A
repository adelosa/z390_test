*%GOTO PLSACCES;                      /* BEGIN OF PLS COMMENT           00050000
         MACRO                                                          00100000
&LABEL   LBRACCES &MF=,                                                X00150000
               &AREA=,                                                 X00200000
               &LIBTYPE=,                                              X00250000
               &LIBUSE=,                                               X00300000
               &CHAINID=,                                              X00350000
               &LIBINFO=,                                              X00400000
               &CHAIN=,                                                X00450000
               &LAMB=,                                                 X00500000
               &FILENAM=,                                              X00550000
               &SUBLIB=,                                               X00600000
               &LEVEL=,                                                X00650000
               &DEFINE=,                                               X00700000
               &REPLACE=,                                              X00750000
               &DEFAULT=,                                              X00800000
               &CONTROL=,                                              X00850000
               &LOCKOPT=,                                              X00900000
               &KEEP=,                                                 X00920001
               &PID=,                                                  X00940001
               &WAREA=,                                                X00960001
               &LEN=                                                    00980001
         GBLC  &FC                    MF TO BE PASSED TO LBRACCCB       01000000
         GBLB  &SYNERR                ERROR DURING SYNTAX CHECK         01050000
         GBLB  &INNER                 CALL LBRACCCB AS INNER MACRO      01100000
         LCLB  &REGERR                UNALLOWED REGISTER NOTATION       01150000
         LCLC  &REG                   PREPARE STRING FOR ST INSTR.      01200000
.*                                                                      01250000
.* IBM DISK OPERATING SYSTEM                                            01300000
.*                                                                      01350000
         SPACE                                                          01400000
*  LIBRARIAN - LBRACCES - 5686-066-06-75C  - VERSION 02-06-24           01450010
         SPACE                                                          01500000
.*                                                                      01550000
         AGO   .ENDPCP                                                  01600000
.*************************************************************          01610010
.*                                                           *          01611010
.*        LICENSED MATERIALS - PROPERTY OF IBM               *          01620010
.*        "RESTRICTED MATERIALS OF IBM"                      *          01630010
.*        5686-066                                           *          01640010
.*        (C) COPYRIGHT IBM CORP. 1979  2002                 *          01641010
.*                                                           *          01642010
.*************************************************************          01643010
.*                                                                      01950000
.* A000000-999999                                              @D36JDKG 02000000
.*                                                                      02050000
.*                                                                      02100000
*/*   MODULE LBRACCES - LIBRARIAN MACRO LBRACCES                        02150000
*/**                                                                    02200000
*/****  START OF SPECIFICATIONS  *************************************/ 02250000
*/**                                                                    02300000
*/**  MACRO NAME:  LBRACCES                                             02350000
*/**                                                                    02400000
*/**  MACRO TYPE:  EXTERNAL LIBRARIAN MACRO, BILINGUAL                  02450000
*/**                                                                    02500000
*/**  DESCRIPTIVE NAME:  MACRO FOR HIGH LEVEL ACCESS TO LIBRARY         02550000
*/**                     CONTROL TABLES                                 02600000
*/**                                                                    02650000
*/**  SYNTAX OF MACRO:                                                  02700000
*/**                                                                    02750000
*/**    ASSEMBLER:                                                      02800000
*/**                                                                    02850000
*/** <LABEL> LBRACCES MF = GET|ADDLIB|REMOVE|LOCK|UNLOCK|               02900000
*/**                       EXTEND|EXTUPD                                02950000
*/**                  ,AREA = NAME | (R)                                03000000
*/**                  <,LIBTYPE = PHASE|OBJ|SOURCE|PROC|SPHASE|SOBJ|    03050000
*/**                              SSOURCE|SPROC|LBR|DUMP|ALL>  @D52EDUT 03100001
*/**                  <,LIBUSE = SEARCH | TO | FROM | CATALOG | ACCESS  03150000
*/**                             | USER>                                03200000
*/**                  <,CHAINID = NAME | (R)>                           03250000
*/**                  <,LIBINFO = NAME | (R)>                           03300000
*/**                  <,CHAIN = TEMP | PERM | BOTH>                     03350000
*/**                  <,LAMB = NAME | (R)>                              03400000
*/**                  <,FILENAM = NAME | (R)>                           03450000
*/**                  <,SUBLIB = NAME | (R)>                            03500000
*/**                  <,DEFINE = NEW | OLD | DUMMY>                     03550000
*/**                  <,REPLACE = YES | NO>                             03600000
*/**                  <,LEVEL = LIB | SUBLIB | BOTH>                    03650000
*/**                  <,DEFAULT = YES | NO>                             03700000
*/**                  <,CONTROL = S | E>                                03750000
*/**                  <,LOCKOPT = 1 | 2>                                03800000
*/**                  <,KEEP = YES | NO>                                03850000
*/**                  <,PID = NAME >                           @D52EDUT 03862501
*/**                  <,WAREA = NAME | (R)>                    @D52EDUT 03875001
*/**                  <,LEN = NAME >                           @D52EDUT 03887501
*/**                                                                    03900000
*/**    PLS2:                                                           03950000
*/**                                                                    04000000
*/** ?<LABEL:> LBRACCES MF(GET|ADDLIB|REMOVE|LOCK|UNLOCK|               04050000
*/**                       EXTEND|EXTUPD)                               04100000
*/**                    AREA(NAME | (R))                                04150000
*/**                    <LIBTYPE(PHASE|OBJ|SOURCE|PROC|SPHASE|SOBJ|     04200000
*/**                             SSOURCE|SPROC|LBR|DUMP|ALL)>  @D52EDUT 04250001
*/**                    <LIBUSE(SEARCH | TO | FROM | CATALOG | ACCESS   04300000
*/**                            | USER)>                                04350000
*/**                    <CHAINID(NAME | (R))>                           04400000
*/**                    <LIBINFO(NAME | (R))>                           04450000
*/**                    <CHAIN(TEMP | PERM | BOTH)>                     04500000
*/**                    <LAMB(NAME | (R)))>                             04550000
*/**                    <FILENAM(NAME | (R))>                           04600000
*/**                    <SUBLIB(NAME | (R))>                            04650000
*/**                    <DEFINE(NEW | OLD | DUMMY)>                     04700000
*/**                    <REPLACE(YES | NO)>                             04750000
*/**                    <LEVEL(LIB | SUBLIB | BOTH)>                    04800000
*/**                    <DEFAULT(YES | NO)>                             04850000
*/**                    <CONTROL(S | E)>                                04900000
*/**                    <LOCKOPT(1 | 2)>                                04950000
*/**                    <KEEP(YES | NO)>                                05000000
*/**                    <PID(NAME) >                           @D52EDUT 05012501
*/**                    <WAREA(NAME | (R))>                    @D52EDUT 05025001
*/**                    <LEN(NAME)>                            @D52EDUT 05037501
*/**                    ;                                               05050000
*/*   EJECT                                                             05100000
*/**  INPUT:    SPECIFICATION OF MACRO AND CONTROL BLOCK.               05150000
*/**            USER MUST SUPPLY A STORAGE AREA OF 72 BYTES, USED AS A  05200000
*/**            REGISTER SAVE AREA, AND SUPPLY ITS ADDRESS IN REGISTER  05250000
*/**            13.  IN ADDITION, THE STORAGE AREA FOR THE LIBRARY      05300000
*/**            ACCESS CONTROL BLOCK AND THE LOCK TABLE HAS TO BE       05350000
*/**            PROVIDED.  LIBINFO MUST BE SET TO ZERO OR CONTAIN THE   05400000
*/**            POINTERS FROM A PREVIOUS REQUEST.                       05450000
*/**                                                                    05500000
*/**  OUTPUT:   RETURN CODE IN REGISTER 15                              05550000
*/**            FOR 'MF = GET LIBTYPE=ALL'                              05553301
*/**            A LIST OF ALL CURRENTLY OPEN LIBRARIES IS RETURNED      05556601
*/**            IN THE SPECIFIED WORKAREA. THE FIRST WORD OF THE        05559901
*/**            WORKAREA CONTAINS A WORKPOINTER WHICH MUST NOT BE       05563201
*/**            CHANGED IF A SECOND LBRACCES CALL FOR CONTINUATION      05566501
*/**            IS NEEDED. A LIST OF CHAR(7) FIELDS FOLLOWS THIS        05569801
*/**            POINTER. HERE THE LIBRARY NAMES OF ALL OPEN LIBRARIES   05573101
*/**            FOUND ARE STORED. THE LAST ENTRY CONTAINS AN 'EOL'.     05576401
*/**            IF THE WORKAREA WAS TOO SMALL TO CONTAIN ALL LIBRARY    05579701
*/**            NAMES A RETURN CODE 4 IS RETURNED. THE LIST CAN BE      05583001
*/**            CONTINUED BY CALLING LBRACCES WITH THE SAME PARAMETERS  05586301
*/**            AGAIN.                                                  05589601
*/**                                                                    05592901
*/**            FOR OTHER CASES:                                        05596201
*/**            IF THE REQUESTED LIBRARY HAS BEEN FOUND, THE            05600000
*/**            POINTER TO LIBRARY OFFSET TABLE ENTRY AND THE           05650000
*/**            POINTERS TO LIBRARY AND SUBLIBRARY DEFINITION ENTRIES   05700000
*/**            FOR THAT LIBRARY ARE RETURNED TO THE CALLER.            05750000
*/**            FOR 'MF=ADDLIB' REQUESTS THE REQUESTED                  05800000
*/**            LIBRARY IS ADDED TO THE LIBRARY CONTROL TABLES.         05850000
*/**            THE LCT POINTERS ARE RETURNED IN LIBINFO.               05900000
*/**            FOR 'MF=EXTEND' REQUESTS THE LIBRARY WHICH MUST RESIDE  05950000
*/**            IN VSAM MANAGED SPACE IS EXTENDED BY A NEW EXTENT.      06000000
*/**            FOR 'MF=EXTUPD' REQUESTS THE EDT OF THE LIBRARY         06050000
*/**            IN VSAM MANAGED SPACE ON A SHARED DASD IS  UPDATED BY   06100000
*/**            THE ADDITIONAL EXTENT(S) ALLOCATED BY ANOTHER CPU.      06150000
*/**            IF THE REQUEST WAS FOR AN SDL ENTRY (IN PHASE SEARCH    06200000
*/**            CHAIN), ONLY THE POINTER TO THE LOT ENTRY IS            06250000
*/**            RETURNED, THE LDT/SDT POINTERS ARE SET TO ZERO.         06300000
*/**            FOR 'MF=REMOVE' THE ENTRIES GENERATED IN                06350000
*/**            THE LIBRARY CONTROL TABLES ARE RESET.                   06400000
*/**            FOR 'MF=LOCK|UNLOCK' REQUESTS THE SPECIFIED             06450000
*/**            LIBRARY IS LOCKED|UNLOCKED WITH FAIL=WAIT.              06500000
*/**            WITH THE FIRST CALL OF A LBRACCES OR A                  06550000
*/**            LBRACCCB MACRO IN A MODULE THE FOLLOWING                06600000
*/**            MAPS ARE PROVIDED WITH THE INDICATED NAMES:             06650000
*/**                                                                    06700000
*/**              SYSCOM     SYSTEM COMMUNICATION REGION                06750000
*/**              INLCLPT    LIBRARY POINTER TABLE                      06800000
*/**              INLCLOT    LIBRARY OFFSET TABLE                       06850000
*/**              LOTENTR    LIBRARY OFFSET TABLE ENTRY                 06900000
*/**              INLCLDTE   LIBRARY DEFINITION TABLE                   06950000
*/**              INLCSDTE   LIBRARY DEFINITION TABLE                   07000000
*/**              LBRACCDS   LIBRARY ACCESS CONTROL BLOCK               07050000
*/**                                                                    07100000
*/**            FOR PLS2 A MAP OF THE LOCK TABLE ENTRY WITH             07150000
*/**            NAME DTLADR IS GENERATED AS WELL.                       07200000
*/**                                                                    07250000
*/**  FUNCTION:                                                         07300000
*/**                                                                    07350000
*/**  THIS MACRO ALLOWS THE LEVEL 2 USER TO BUILD LIBRARY CHAINS,       07400000
*/**  ACCESS THEM ONCE THEY HAVE BEEN BUILT, AND DELETE THEM WHEN       07450000
*/**  THEY ARE NO LONGER NEEDED.                                        07500000
*/**                                                                    07550000
*/**  FOR MF=ADDLIB:                                                    07600000
*/**  THE REQUESTED LIBRARY/SUBLIBRARY IS ADDED TO THE LIBRARY CONTROL  07650000
*/**  TABLES FOR 'MF=ADDLIB'.  UP TO FIFTEEN LIBRARY / SUBLIBRARY       07700000
*/**  MAY BE ADDED TO A CHAIN.                                          07750000
*/**  IT IS POSSIBLE TO BUILD SINGLE LIBRARY/SUBLIBRARY ENTRIES OR      07800000
*/**  A CHAIN OF LIBRARIES/SUBLIBRARIES.                                07850000
*/**  THE ENTRIES/CHAINS ARE ADDRESSED BY THE PARAMETER TRIPLE          07900000
*/**  (LIBTYPE,LIBUSE,CHAIN) AND THE TASK ID OF THE REQUESTOR.          07950000
*/**  IF THE LIBTYPE IS NOT "LBR" A CHAIN EXISTS ONLY FOR LIBUSE=       08000000
*/**  SEARCH, BOTH FOR CHAIN=TEMP AND CHAIN=PERM. SINGLE ENTRIES        08050000
*/**  EXIST FOR LIBUSE=CATALOG|TO|FROM. THESE ENTRIES/CHAINS ARE        08100000
*/**  RESERVED FOR LIBDEF STATEMENTS.                                   08150000
*/**  IF LIBTYPE=LBR, CHAINS EXIST FOR LIBUSE=SEARCH|CATALOG|ACCESS,    08200000
*/**  ONLY FOR CHAIN=PERM. SPECIFICATION OF CHAIN=TEMP WILL ADDRESS     08250000
*/**  A SINGLE ENTRY OF THE SPECIFIED LIBUSE PARAMETER.                 08300000
*/**  FOR A TASK RUNNING UNDER ICCF, THE REQUESTOR CAN SPECIFY OWN      08350000
*/**  CHAINS/ENTRIES WITH LIBUSE=USER AND A USER-DEFINED CHAIN NAME     08400000
*/**  WITH THE CHAINID PARAMETER.                                       08450000
*/**  TO BUILD A CHAIN THE LBRACCDS HAS TO BE INITIALIZED. SUCCESSIVE   08500000
*/**  LBRACCES REQUESTS FOR THE SAME (LIBTYPE, LIBUSE, CHAIN) PARAMETER 08550000
*/**  TRIPLE CONCATENES THE LIBRARY/SUBLIBRARY COMBINATION TOGETHER,    08600000
*/**  UNLESS THE LBRACCDS CONTROL BLOCK IS INITIALIZED NEW.             08650000
*/**  SUCCESSIVE LBRACCES REQUEST FOR A SINGLE ENTRY WILL ALWAYS        08700000
*/**  REPLACE THE OLD BY THE NEW ONE.                                   08750000
*/**  IF LEVEL=LIB|BOTH IS SPECIFIED, AN OPEN IS PERFORMED FOR THE      08800000
*/**  LIBRARY. FOR PERFORMANCE REASONS, THE OPEN CAN BE AVOIDED FOR     08850000
*/**  A LIBRARY ALREADY ADDED IN A CHAIN (OR SINGLE ENTRY) WHEN LEVEL=  08900000
*/**  SUBLIB IS SPECIFIED AND THE LIBINFO VALUE RETURNED BY THAT VERY   08950000
*/**  REQUEST IS PASSED TO THE SERVICE.                                 09000000
*/**                                                                    09050000
*/**  - FOR MF=GET:                                                     09100000
*/**                                                                    09150000
*/**  FOR LIBTYPE = ALL A LIST OF ALL OPEN LIBRARIES IN THE SYSTEM      09154501
*/**  IS RETURNED. FOR THIS LIBTYPE NO OTHER MF VALUE IS VALID.         09159001
*/**  FOR ACCESSING THESE LIBRARIES THEY HAVE TO BE ADDED TO A CHAIN    09163501
*/**  VIA LBRACCES MF(ADDLIB)... AND THEN RETRIEVED VIA                 09168001
*/**  LBRACCES MF(GET)...  THIS PROCESS LOOKS QUIET ODD. BUT THE LDT    09172501
*/**  CHAINS FROM WHERE THE NAMES OF THE LIBRARIES ARE TAKEN ARE HIGHLY 09177001
*/**  DYNAMIC. TAKING ONLY OUT A NAME IS MUCH FASTER THAN ADDING THE    09181501
*/**  LIBRARY INTO A CHAIN ACCESSING IT AND THEN TRY TO FIND THE NEXT   09186001
*/**  LIBRARIES.                                                        09190501
*/**  FOR OTHER LIBTYPES                                                09195001
*/**  THE ACTIVE LIBRARY/SUBLIBRARY CHAIN (ENTRY) CAN BE RETRIEVED.     09200000
*/**  THE INVOCATIONS OF LBRACCES MAY BE CHAINED TOGETHER BY PASSING    09250000
*/**  THE LIBINFO FIELD FROM ONE TO ANOTHER.  TO BEGIN A CHAINING       09300000
*/**  SEQUENCE, LIBINFO IS SET TO ZERO                                  09350000
*/**  AND LBRACCES WITH 'MF=GET' COULD BE ISSUED.  THIS WOULD ESTABLISH 09400000
*/**  ACCESS TO THE FIRST LIBRARY / SUBLIBRARY.  TO ESTABLISH, ACCESS   09450000
*/**  TO THE SECOND LIBRARY / SUBLIBRARY,  THE LBRACCES MACRO WITH      09500000
*/**  'MF=GET' WOULD BE ISSUED AND THE SAME LIBINFO FIELD WOULD BE      09550000
*/**  USED.  THE PROCESS WOULD BE REPEATED FOR THE FURTHER LIBRARIES/   09600000
*/**  SUBLIBRARIES IN THE CHAIN.                                        09650000
*/**  IF THE 'GET' REQUEST CAN BE HONORED, THE ADDRESS OF THE           09700000
*/**  LOT ENTRY AND THE ADDRESS OF THE LDT ENTRY ARE RETURNED           09750000
*/**  AS FULLWORDS IN THAT SEQUENCE AT THE ADDRESS SPECIFIED            09800000
*/**  BY LIBINFO.  IF THE 'GET' REQUEST WAS FOR A 'P' LIBRARY,          09850000
*/**  THE POINTER TO IT IS RETURNED IN THE THIRD FULLWORD               09900000
*/**  ADDRESSED BY LIBINFO. THE SECOND WORD ADDRESSED BY LIBINFO        09950000
*/**  ALWAYS CONTAINS THE POINTER TO THE 'C' LIBRARY.                   10000000
*/**  THE FOURTH WORD ADDRESSED BY LIBINFO CONTAINS THE ADDRESS OF      10050000
*/**  THE SDT ENTRY IF SPECIFIED, OTHERWISE IT IS 0.                    10100000
*/**  FOR A CHAINING REQUEST, THE POINTERS RETURNED IN THE              10150000
*/**  PREVIOUS CALL HAVE TO BE PASSED BACK IN 'LIBINFO'.                10200000
*/**  FOR THE FIRST CHAINING REQUEST 'LIBINFO' HAS TO CONTAIN           10250000
*/**  ZEROS.                                                            10300000
*/**                                                                    10350000
*/**  - FOR MF=REMOVE:                                                  10400000
*/**                                                                    10450000
*/**  AN ENTRY/CHAIN SPECIFIED BY (LIBTYPE,LIBUSE,CHAIN) IS DELETED     10500000
*/**  FOR 'MF=REMOVE'.                                                  10550000
*/**                                                                    10600000
*/**  THE REQUESTED LIBRARY IS LOCKED OR UNLOCKED ACCORDING             10650000
*/**  TO THE MF SPECIFICATION 'LOCK|UNLOCK' WITH FAIL=WAIT.             10700000
*/**                                                                    10750000
*/**  THE REQUESTED LIBRARY IS EXTENDED IN VSAM MANAGED SPACE FOR       10800000
*/**  'MF=EXTEND'.                                                      10850000
*/**                                                                    10900000
*/**  FOR 'MF=EXTUPD' REQUESTS THE EDT OF THE LIBRARY                   10950000
*/**  IN VSAM MANAGED SPACE ON A SHARED DASD IS  UPDATED BY             11000000
*/**  THE ADDITIONAL EXTENT(S) ALLOCATED BY ANOTHER CPU.                11050000
*/**                                                                    11100000
*/**  IF A LIBRARY IS ADDED TO THE LIBRARY CONTROL TABLES, AN           11150000
*/**  OPEN HAS TO BE PERFORMED. TO ALLOW                                11200000
*/**  USAGE OF THE DOS/VSE ACCESS CONTROL FACILITY, THE OPEN IS         11250000
*/**  PERFORMED WITH THE FOLLOWING ACCESS ATTRIBUTE:                    11300000
*/**                                                                    11350000
*/**      LIBUSE          OPEN FOR                                      11400000
*/**                                                                    11450000
*/**      TO               INPUT                                        11500000
*/**      FROM             INPUT                                        11550000
*/**      SEARCH           INPUT                                        11600000
*/**      ACCESS           OUTPUT IF DEFINE=NEW                         11650000
*/**                       INPUT  IF DEFINE=OLD                         11700000
*/**      CATALOG          INPUT                                        11750000
*/**      USER             INPUT                                        11800000
*/**                                                                    11850000
*/**  REGISTER USAGE FOR LBRACCES MACRO:                                11900000
*/**                                                                    11950000
*/**    REG  0   FUNCTION INDICATOR                                     12000000
*/**    REG  1   POINTER TO CONTROL BLOCK                               12050000
*/**    REG 13   ADDRESS OF SAVEAREA                                    12100000
*/**    REG 14   RETURN ADDRESS                                         12150000
*/**    REG 15   USED AS BRANCH REGISTER AND FOR RETURN CODES           12200000
*/**                                                                    12250000
*/**    REGISTERS 0 AND 1 ARE ALSO USED BY THE MACROS GENDTL MODDTL     12300000
*/**                                                                    12350000
*/**    ALL OTHER REGISTERS REMAIN UNCHANGED                            12400000
*/**                                                                    12450000
*/**  RETURN CODES FROM LANGUAGE PROCESSOR:                             12500000
*/**     0       MACRO EXPANSION SUCCESSFUL                             12550000
*/**     4       PARAMETERS HAVE BEEN IGNORED DUE TO CONFLICTS          12600000
*/**     8       INVALID PARAMETERS SPECIFIED                           12650000
*/**                                                                    12700000
*/**  RETURN CODES FROM SERVICE FUNCTION:                               12750000
*/**     0       REQUEST HAS BEEN HONORED                               12800000
*/**     4       MF=GET:                                                12850000
*/**             SPECIFIED WORKAREA IS TOO SMALL FOR CONTAINING ALL     12866601
*/**             OPEN LIBRARIES OR                                      12883201
*/**             END OF CHAIN HAS BEEN REACHED FOR A CHAINING REQUEST   12900000
*/**             POINTERS ARE STILL POINTING TO LAST VALID LIB/SUBLIB   12950000
*/**     8       MF=GET: REQUESTED LIBRARY HAS NOT BEEN DEFINED         13000000
*/**             MF=ADDLIB: END OF CHAIN CAPACITY REACHED.              13050000
*/**             MF=EXTEND: NO EXTENSION POSSIBLE.                      13100000
*/**             MF=EXTUPD: NO UPDATE OF EDT TO BE DONE                 13150000
*/**    12       MF=ADDLIB:                                             13200000
*/**             FOR LEVEL=LIB AND DEFINE=NEW:                          13250000
*/**                 LIBRARY ALREADY EXISTS                             13300000
*/**             FOR LEVEL=LIB AND DEFINE=OLD:                          13350000
*/**                 LIBRARY DOES NOT EXIST                             13400000
*/**             FOR LEVEL=SUBLIB AND DEFINE=NEW:                       13450000
*/**                 SUBLIBRARY ALREADY EXISTS                          13500000
*/**             FOR LEVEL=SUBLIB AND DEFINE=OLD:                       13550000
*/**                 SUBLIBRARY DOES NOT EXIST                          13600000
*/**    16       EXTERNAL ERROR WITH FEEDBACK CODE (LBRRET FIELD).      13650000
*/**    20       INTERNAL ERROR WITH FEEDBACK CODE (LBRRET FIELD).      13700000
*/**                                                                    13750000
*/**    FOR LOCK AND UNLOCK THE RETURN CODES FROM THE SUPERVISOR        13800000
*/**    SERVICE LOCK|UNLOCK ARE HANDLED BY THE MACRO EXPANSION.         13850000
*/**                                                                    13900000
*/**  NOTES:                                                            13950000
*/**                                                                    14000000
*/**     CHANGE ACTIVITIES:                                             14050000
*/**                                                                    14100000
*/**        SUPPORT OF LIBRARY CONCATENATION                            14150000
*/**        VSE/AF 2.1 LIBRARIAN                              @D14LDFB  14200000
*/**        VSAM-EXTENSION OF SHARED LIBRARY                  @D21SDFB  14250000
*/**        LIBTYPE = ALL AND PID                             @D52EDUT  14275001
*/**                                                                    14300000
*/**        DY35004 INCLUDES CAF-CODE @D21SDFB.               @DY35004  14350000
*/**        PLS3 TO PLX/370 CONVERSION (FOR MSHP)             @D66GDMK  14360008
*/**        MAKE LIBRM API AMODE(ANY) CAPABLE                 @D66GDMK  14370006
*/**        SPLIT $IJBLBR.PHASE IN SVA LOW AND HIGH           @D67GDMK  14380009
*/**                                                                    14400000
*/**     <...> DENOTES, THAT THIS PARAMETER IS OPTIONAL.                14450000
*/**                                                                    14500000
*/****  END OF SPECIFICATIONS  ***************************************/ 14550000
*/*   EJECT                                                             14600000
*/**  PARAMETER DESCRIPTION:                                            14650000
*/**                                                                    14700000
*/**    MF       SPECIFIES THE MAIN FUNCTION TO BE EXECUTED:            14750000
*/**              GET    GIVE ACCESS TO LIBRARY                         14800000
*/**                     FOR LIBTYPE = ALL ONLY A LIST OF LIBRARY NAMES 14816601
*/**                     IS RETURNED                                    14833201
*/**              ADDLIB ADD LIBRARY/SUBLIBRARY (REQUIRED PARAMETERS:   14850000
*/**                                  FILENAM, SUBLIB)                  14900000
*/**              REMOVE DELETE LIBRARY/SUBLIBRARY                      14950000
*/**              LOCK   LOCK LIBRARY/SUBLIBRARY                        15000000
*/**              UNLOCK UNLOCK LIBRARY/SUBLIBRARY                      15050000
*/**              EXTEND EXTEND LIBRARY/SUBLIB IN VSAM MANAGED SPACE    15100000
*/**              EXTUPD UPDATE BACKLEVEL EDT OF A VSAM MANAGED         15150000
*/**                     DASD-SHARED LIBRARY                            15200000
*/**                                                                    15250000
*/**              THE LOCK AND UNLOCK FUNCTIONS ARE FOR THE USE OF      15300000
*/**              THE VSE LIBRARIAN PROGRAM AND SHOULD NOT BE USED      15350000
*/**              BY THE LEVEL 2 USER                                   15400000
*/**                                                                    15450000
*/**    AREA     SPECIFIES THE NAME OF THE AREA WHERE THE CONTROL       15500000
*/**             BLOCK IS ALLOCATED FOR THE LIBRARY ACCESS REQUEST.     15550000
*/**             ON THE SECOND USE OF THE SAME CONTROL BLOCK            15600000
*/**             ONLY THE PARAMETERS TO BE MODIFIED HAVE TO             15650000
*/**             BE SPECIFIED. AREA MUST BE SPECIFIED.                  15700000
*/**                                                                    15750000
*/**    LIBTYPE  SPECIFIES THE LIBRARY TYPE:                            15800000
*/**               PHASE    FOR PHASES                                  15850000
*/**               OBJ      FOR OBJECT MODULES                          15900000
*/**               SOURCE   FOR SOURCE BOOKS                            15950000
*/**               PROC     FOR PROCEDURES                              16000000
*/**               DUMP     FOR DUMPS                                   16050000
*/**               SPHASE   FOR SYSTEM PHASES                           16100000
*/**               SOBJ     FOR SYSTEM OBJECT MODULES                   16150000
*/**               SSOURCE  FOR SYSTEM SOURCE BOOKS                     16200000
*/**               SPROC    FOR SYSTEM PROCEDURES                       16250000
*/**               LBR      FOR LIBRARIAN ACCESSED LIBRARY/SUBLIBRARY.  16300000
*/**               ALL      FOR ALL OPEN LIBRARIES                      16325001
*/**                        THIS IS THE TYPE USED FOR                   16350000
*/**                        LIBRARY/SUBLIBRARIES CREATED AND MAINTAINED 16400000
*/**                        BY THE USER OF THE LEVEL 2 INTERFACE.       16450000
*/**                                                                    16500000
*/**    LIBUSE   SPECIFIES THE REQUESTED LIBRARY/SUBLIBRARY CHAIN       16550000
*/**               SEARCH  SEARCH LIBRARY/SUBLIBRARY (CHAIN)            16600000
*/**               TO      TO LIBRARY/SUBLIBRARY                        16650000
*/**               FROM    FROM LIBRARY/SUBLIBRARY                      16700000
*/**               ACCESS  ACCESS LIBRARY/SUBLIBRARY (CHAIN)            16750000
*/**               CATALOG CATALOG LIBRARY/SUBLIBRARY (CHAIN)           16800000
*/**               USER    USER-DEFINED LIBRARY/SUBLIBRARY (CHAIN)      16850000
*/**                       (ONLY WITH LIBTYPE=LBR IN ICCF-PARTITION).   16900000
*/**                                                                    16950000
*/**    LIBINFO  SPECIFIES THE NAME OF A FOUR WORD FIELD, WHERE         17000000
*/**             POINTERS TO THE LIBRARY OFFSET TABLE ENTRY AND         17050000
*/**             THE LDT AND SDT ENTRIES ARE RETURNED                   17100000
*/**             TO THE CALLER. THE FIRST LDT ENTRY POINTER             17150000
*/**             IS ALWAYS POINTING TO THE ACTUAL 'C' - LIBRARY         17200000
*/**             AND THE SECOND LDT POINTER IS POINTING TO              17250000
*/**             A 'P' - LIBRARY, IF AVAILABLE (OTHERWISE 0).           17300000
*/**             IF THE REQUEST WAS FOR AN SDL ENTRY (IN PHASE SEARCH   17350000
*/**             CHAIN), ONLY THE POINTER TO THE LOT ENTRY IS           17400000
*/**             RETURNED, THE LDT/SDT POINTERS ARE SET TO ZERO.        17450000
*/**             FOR THE FIRST CHAINING REQUEST, 'LIBINFO' MUST         17500000
*/**             BE ZERO. FOR A FOLLOWING CHAINING REQUEST AS           17550000
*/**             WELL AS FOR A 'LOCK|UNLOCK' REQUEST, THE               17600000
*/**             LOT AND LDT POINTERS RETURNED BY A PREVIOUS            17650000
*/**             'GET' REQUEST HAVE TO BE PROVIDED IN 'LIBINFO'.        17700000
*/**                                                                    17750000
*/**    CHAIN    FOR MF=GET:                                            17800000
*/**             SPECIFIES THE SEARCH ORDER                             17850000
*/**             TEMP TEMPORARY LIBRARIES/SUBLIBRARIES ONLY,            17900000
*/**             PERM PERMANENT LIBRARIES/SUBLIBRARIES ONLY,            17950000
*/**             BOTH TEMPORARY LIBRARIES FIRST, THEN PERMANENT         18000000
*/**                  LIBRARIES. BOTH IS THE DEFAULT VALUE.             18050000
*/**             THE 'CHAIN' SPECIFICATION IS IGNORED FOR               18100000
*/**             'LIBTYPE=SPHASE|SOBJ|SSOURCE|SPROC.                    18150000
*/**                                                                    18200000
*/**             FOR MF=ADDLIB|REMOVE:                                  18250000
*/**             SPECIFIES A SPECIFIC CHAIN/ENTRY AS DESCRIBED ABOVE.   18300000
*/**                                                                    18350000
*/**    CHAINID  (ONLY FOR LIBTYPE=LBR AND LIBUSE=USER IN THE ICCF      18400000
*/**             PARTITION)                                             18450000
*/**             SPECIFIES THE NAME OF THE AREA WITH THE 8 CHARACTER    18500000
*/**             CHAIN IDENTIFIER ('ACCESS, 'CATALOG', AND 'SEARCH' ARE 18550000
*/**             RESERVED NAMES).                                       18600000
*/**                                                                    18650000
*/**    LAMB     SPECIFIES THE NAME OF THE LAMB USED FOR                18700000
*/**             THE MESSAGE MODULE.                                    18750000
*/**                                                                    18800000
*/**    FILENAM  SPECIFIES THE NAME OF THE FIELD, WHERE THE SEVEN       18850000
*/**             CHARACTER FILENAME OF THE LIBRARY TO BE ADDED          18900000
*/**             TO THE CONTROL TABLES CAN BE FOUND.                    18950000
*/**             VALID ONLY FOR 'MF=ADDLIB'.                            19000000
*/**                                                                    19050000
*/**    SUBLIB   SPECIFIES THE NAME OF THE FIELD, WHERE THE EIGHT       19100000
*/**             CHARACTER SUBLIBRARY NAME TO BE ADDED TO THE CONTROL   19150000
*/**             TABLES CAN BE FOUND.                                   19200000
*/**             VALID ONLY FOR 'MF=ADDLIB'.                            19250000
*/**                                                                    19300000
*/**    DEFINE   SPECIFIES THE STATUS OF A LIBRARY / SUBLIBRARY:        19350000
*/**             OLD    THE LIBRARY / SUBLIBRARY ALREADY EXISTS         19400000
*/**             NEW    THE LIBRARY / SUBLIBRARY IS BEING BUILT         19450000
*/**                    (VALID ONLY FOR LIBTYPE=LBR)                    19500000
*/**             DUMMY  THE DEFINED SUBLIBRARY NAME IS A PLACEHOLDER    19550000
*/**                    FOR FUTURE REQUESTS                             19600000
*/**                    (ONLY FOR LIBTYPE=LBR, LIBUSE=TO).              19650000
*/**             VALID ONLY FOR 'MF=ADDLIB'.                            19700000
*/**                                                                    19750000
*/**    REPLACE  SPECIFIES WHETHER AN EXISTING LIBRARY                  19800000
*/**             IS REPLACED OR NOT (ONLY FOR DEFINE=NEW)               19850000
*/**             (RESTRICTED TO  LEVEL=LIB).                            19900000
*/**             YES    IF THE LIBRARY TO BE DEFINED  DOES ALREADY      19950000
*/**                    EXIST IT WILL BE REPLACED.                      20000000
*/**             NO     IF THE LIBRARY ALREADY EXISTS IT WILL BE NOT    20050000
*/**                    REPLACED.                                       20100000
*/**                    (NO IS THE DEFAULT VALUE.)                      20150000
*/**             VALID ONLY FOR 'MF=ADDLIB'.                            20200000
*/**                                                                    20250000
*/**    LEVEL    SPECIFIES WHETHER A LIBRARY OR A SUBLIBRARY DEFINITION 20300000
*/**             IS ADDED TO THE CONTROL TABLES.                        20350000
*/**             LIB    A LIBRARY IS ADDED                              20400000
*/**             SUBLIB A SUBLIBRARY IS ADDED                           20450000
*/**             BOTH   A LIBRARY AND A SUBLIBRARY ARE ADDED.           20500000
*/**             VALID ONLY FOR 'MF=ADDLIB'.                            20550000
*/**                                                                    20600000
*/**    DEFAULT  SPECIFIES THE DEFAULTING FOR OLD PRIVATE               20650000
*/**             LIBRARIES AND ACCESS TO LIBRARY CONTROL TABLES         20700000
*/**             DEFAULT IS VALID ONLY FOR MF=GET AND IGNORED           20750000
*/**             FOR LIBTYPE=SPHASE|SOBJ|SSOURCE|SPROC                  20800000
*/**               YES  CREATE ENTRIES FOR OLD PRIVATE LIBRARY          20850000
*/**                    RETURN TEMPORARY LIB/SUBLIB, IF AVAILABLE,      20900000
*/**                    ELSE RETURN PERMANENT LIB/SUBLIB, IF AVAIL-     20950000
*/**                    LABLE, ELSE RETURN SYSTEM LIB/SUBLIB, IF        21000000
*/**                    AVAILABLE. FOR 'LIBUSE=TO|FROM' A SYSTEM LIB/   21050000
*/**                    SUBLIB IS ONLY RETURNED, IF NO LIBDEF           21100000
*/**                    HAS BEEN GIVEN FOR THAT PARTITION.              21150000
*/**                    FOR 'DEFAULT=YES' THE 'CHAIN' SPECIFICATION     21200000
*/**                    IS IGNORED.                                     21250000
*/**                    YES IS THE DEFAULT VALUE.                       21300000
*/**               NO   DO NOT CREATE ENTRIES FOR OLD PRIVATE           21350000
*/**                    LIBRARY                                         21400000
*/**                    RETURN LIB/SUBLIB OF REQUESTED ROW AND USE, IF  21450000
*/**                    AVAILABLE.                                      21500000
*/**                                                                    21550000
*/**    CONTROL  SPECIFIES THE SHARE OPTION TOGETHER WITH               21600000
*/**    LOCKOPT  LOCKOPT                                                21650000
*/**                                                                    21700000
*/**               S   SHARE                                            21750000
*/**               E   EXCLUSIVE                                        21800000
*/**                                                                    21850000
*/**             THE FOLLOWING SHARE OPTIONS ARE AVAILABLE:             21900000
*/**             S(1)  ONLY OTHER SHARED USERS ALLOWED                  21950000
*/**             S(2)  IN ADDITION TO SHARED USERS ONE                  22000000
*/**                   EXCLUSIVE USER IS ALLOWED                        22050000
*/**             E(1)  NO OTHER USER ALLOWED                            22100000
*/**             E(2)  IN ADDITION TO ONE EXCLUSIVE USER                22150000
*/**                   OTHER SHARED USERS ARE ALLOWED                   22200000
*/**                                                                    22250000
*/**    KEEP     SPECIFIES DISPOSITION AT END OF JOB STEP               22300000
*/**               YES   DO NOT UNLOCK THE RESOURCE                     22350000
*/**               NO    UNLOCK THE RESOURCE                            22400000
*/**    PID      SECIFIES THE PARTION ID OF THE PARTION WHRE THE        22407101
*/**             SECIFIED CHAIN LIES                                    22414201
*/**    WAREA    SECIFIES THE STARTADDRESS OF THE WORKAREA FOR LIBTYPE  22421301
*/**             = ALL                                                  22428401
*/**    LEN      SECIFIES THE LENGTH OF THE WORKAREA FOR LIBTYPE        22435501
*/**             = ALL                                                  22442601
*/*     SPACE 5                                                         22450000
*/**    VALID PARAMETERS FOR 'MF=GET':                                  22500000
*/**      AREA                                                          22550000
*/**      LIBTYPE                                                       22600000
*/**      LIBUSE                                                        22650000
*/**      CHAINID                                                       22700000
*/**      LIBINFO                                                       22750000
*/**      CHAIN                                                         22800000
*/**      CHAINID                                                       22850000
*/**      LAMB                                                          22900000
*/**      DEFAULT                                                       22950000
*/**      PID                                                           22962501
*/**      WAREA                                                         22975001
*/**      LEN                                                           22987501
*/**                                                                    23000000
*/**    VALID PARAMETERS FOR 'MF=ADDLIB':                               23050000
*/**      AREA                                                          23100000
*/**      LIBTYPE                                                       23150000
*/**      LIBUSE                                                        23200000
*/**      CHAINID                                                       23250000
*/**      LIBINFO                                                       23300000
*/**      LAMB                                                          23350000
*/**      CHAIN                                                         23400000
*/**      CHAINID                                                       23450000
*/**      FILENAM                                                       23500000
*/**      SUBLIB                                                        23550000
*/**      DEFINE                                                        23600000
*/**      LEVEL                                                         23650000
*/**      PID                                                           23675001
*/**                                                                    23700000
*/**                                                                    23750000
*/**    VALID PARAMETERS FOR 'MF=REMOVE':                               23800000
*/**      AREA                                                          23850000
*/**      LIBTYPE                                                       23900000
*/**      LIBUSE                                                        23950000
*/**      CHAINID                                                       24000000
*/**      LAMB                                                          24050000
*/**      CHAIN                                                         24100000
*/**      CHAINID                                                       24150000
*/**      PID                                                           24175001
*/**                                                                    24200000
*/**    VALID PARAMETERS FOR 'MF=LOCK':                                 24250000
*/**      AREA                                                          24300000
*/**      LIBINFO                                                       24350000
*/**      CONTROL                                                       24400000
*/**      LOCKOPT                                                       24450000
*/**      KEEP                                                          24500000
*/**                                                                    24550000
*/**    VALID PARAMETERS FOR 'MF=UNLOCK':                               24600000
*/**      AREA                                                          24650000
*/**      LIBINFO                                                       24700000
*/**                                                                    24750000
*/**    VALID PARAMETERS FOR 'MF=EXTEND':                               24800000
*/**      AREA                                                          24850000
*/**      LIBINFO                                                       24900000
*/**      LAMB                                                          24950000
*/**                                                                    25000000
*/**    VALID PARAMETERS FOR 'MF=EXTUPD':                               25050000
*/**      AREA                                                          25100000
*/**      LIBINFO                                                       25150000
*/**      LAMB                                                          25200000
*/**                                                                    25250000
*/*   SPACE 5                                                           25300000
*/**    PARAMETERS SPECIFIED ON THE MACRO WHICH ARE NOT VALID           25350000
*/**    FOR THE REQUESTED MAIN FUNCTION ARE FILLED INTO THE             25400000
*/**    CONTROL BLOCK AND IGNORED BY THE SPECIFIC SERVICE               25450000
*/**    ROUTINE.                                                        25500000
*/**                                                                    25550000
*/*   EJECT                                                             25600000
.ENDPCP  ANOP                                                           25650000
.*                                                                      25700000
.*       DEFINITION OF MACRO VARIABLES                                  25750000
.*                                                                      25800000
&FC      SETC  ''                                                       25850000
&SYNERR  SETB  0                                                        25900000
         AIF   ('&LABEL' EQ '').NOLABEL                                 25950000
&LABEL   DS    0H                                                       26000000
.NOLABEL ANOP                                                           26050000
.*                                                                      26100000
.*       CHECK MAIN FUNCTION                                            26150000
.*                                                                      26200000
         AIF   (T'&MF NE 'O').CHECKMF                                   26250000
         AIF   ('&MF' NE '').CHECKMF                                    26300000
         MNOTE 8,'MF IS NOT SPECIFIED, GENERATION SUPPRESSED'           26350000
.*       SYNTAX CHECK CONTINUES                                         26400000
&SYNERR  SETB  1                                                        26450000
         AGO   .VALMF1                                                  26500000
.CHECKMF ANOP                                                           26550000
         AIF   ('&MF' EQ 'GET').VALMF                                   26600000
         AIF   ('&MF' EQ 'ADDLIB').VALMF                                26650000
         AIF   ('&MF' EQ 'REMOVE').VALMF                                26700000
         AIF   ('&MF' EQ 'LOCK').VALMF                                  26750000
         AIF   ('&MF' EQ 'UNLOCK').VALMF                                26800000
         AIF   ('&MF' EQ 'EXTEND').VALMF                       @D14LDFB 26850000
         AIF   ('&MF' EQ 'EXTUPD').VALMF                       @D21SDFB 26900000
         MNOTE 8,'MF REQUEST IS INVALID, GENERATION SUPPRESSED'         26950000
.*       SYNTAX CHECK CONTINUES                                         27000000
&SYNERR  SETB  1                                                        27050000
         AGO   .VALMF1                                                  27100000
.VALMF   ANOP                                                           27150000
&FC      SETC  '&MF'               SET FUNCTION CODE FOR CONTROL BLOCK  27200000
.VALMF1  ANOP                                                           27250000
&INNER   SETB  1                   CALL LBRACCCB AS INNER MACRO         27300000
         AIF   (T'&AREA NE 'O').AREA                                    27350000
         AIF   ('&AREA' NE '').AREA                                     27400000
         MNOTE 8,'AREA IS NOT SPECIFIED, GENERATION SUPPRESSED'         27450000
.*       SYNTAX CHECK CONTINUES                                         27500000
&SYNERR  SETB  1                                                        27550000
.AREA    ANOP                                                           27600000
.*                                                                      27650000
.*       PERFORM SYNTAX CHECK OF OTHER PARAMETERS VIA LBRACCCB MACRO    27700000
.*                                                             @D14LDFB 27750000
         LBRACCCB MF=MOD,                                              X27800000
               AREA=&AREA,                                             X27850000
               LIBTYPE=&LIBTYPE,                                       X27900000
               LIBUSE=&LIBUSE,                                         X27950000
               CHAINID=&CHAINID,                                       X28000000
               LIBINFO=&LIBINFO,                                       X28050000
               CHAIN=&CHAIN,                                           X28100000
               LAMB=&LAMB,                                             X28150000
               FILENAM=&FILENAM,                                       X28200000
               SUBLIB=&SUBLIB,                                         X28250000
               DEFINE=&DEFINE,                                         X28300000
               REPLACE=&REPLACE,                                       X28350000
               LEVEL=&LEVEL,                                           X28400000
               DEFAULT=&DEFAULT,                                       X28450000
               CONTROL=&CONTROL,                                       X28500000
               LOCKOPT=&LOCKOPT,                                       X28550000
               KEEP=&KEEP,                                     @D14LDFBX28570001
               PID=&PID,                                       @D52EDUTX28590001
               WAREA=&WAREA,                                           X28610001
               LEN=&LEN                                        @D52EDUT 28630001
         AIF   (&SYNERR).MEND                                           28650000
         AIF   ('&MF' EQ 'LOCK').LOCK                                   28700000
         AIF   ('&MF' EQ 'UNLOCK').UNLOCK                               28750000
         AIF   ('&LIBTYPE' NE 'ALL').CHLS                      @D52EDUT 28753301
.*                                                             @D52EDUT 28756601
.*       INVOCATION OF INLPLDS  IN SVA PHASE $IJBLBR           @D52EDUT 28759901
.*                                                             @D52EDUT 28763201
         LA    LBRACCR0,INLDLDS      SET CODE TO CALL INLPLDS  @D52EDUT 28766501
         ASYSCOM LBRACR15                                      @D52EDUT 28769801
         USING SYSCOM,LBRACR15                                 @D52EDUT 28773101
         L     LBRACR15,IJBPLCT      ADDRESS OF LIBRARY POINTER TABLE   28776401
         USING INLCLPT,LBRACR15                                @D52EDUT 28779701
         L     LBRACR15,LPT$ADDR   ADDRESS OF SVA PHASE $IJBLBR@D52EDUT 28783001
         DROP  LBRACR15                                        @D52EDUT 28786301
         BASSM LBRACR14,LBRACR15     BRANCH TO $IJBLBR-INLPLDS @D66GDMK 28789603
         AGO   .MEND                                           @D52EDUT 28792901
.CHLS    ANOP                                                  @D52EDUT 28796201
.*                                                                      28800000
.*       INVOCATION OF IJBLBHLS IN SVA PHASE $IJBLBR                    28850000
.*                                                                      28900000
         LA    LBRACCR0,LBRFCACC     SET CODE TO CALL IJBLBHLS          28950000
         ASYSCOM LBRACR15                                               29000000
         USING SYSCOM,LBRACR15                                          29050000
         L     LBRACR15,IJBPLCT      ADDRESS OF LIBRARY POINTER TABLE   29100000
         USING INLCLPT,LBRACR15                                         29150000
         L     LBRACR15,LPT$ADDR     ADDRESS OF SVA PHASE $IJBLBR       29200000
         DROP  LBRACR15                                                 29250000
         BASSM LBRACR14,LBRACR15    BRANCH TO $IJBLBR-IJBLBHLS @D66GDMK 29300003
         AGO   .MEND                                                    29350000
.LOCK    ANOP                                                           29400000
         LOCK  (1),FAIL=WAITC                                           29450000
         LTR   15,15                 LIBRARY IS ...                     29500000
         BZ    LBRD&SYSNDX            LOCKED                            29550000
         LA    0,24                                                     29600000
         CR    15,0                  LIBRARY ALREADY ...                29650000
         BE    LBRD&SYSNDX            LOCKED EARLIER                    29700000
         LOCK  (1),FAIL=WAIT         ERROR                              29750000
LBRD&SYSNDX  EQU   *                                                    29800000
         AGO   .MEND                                                    29850000
.UNLOCK  ANOP                                                           29900000
         UNLOCK (1)                                                     29950000
.MEND    ANOP                                                           30000000
&INNER   SETB  0                                                        30050000
&SYNERR  SETB  0                                                        30100000
         MEND                                END OF PLS COMMENT      */ 30150000
*%PLSACCES:;                                                            30200000
*%LBRACCES: MACRO KEYS(MF,                                              30250000
*                      AREA,                                            30300000
*                      LIBTYPE,                                         30350000
*                      LIBUSE,                                          30400000
*                      CHAINID,                                         30450000
*                      LIBINFO,                                         30500000
*                      CHAIN,                                           30550000
*                      CONTROL,                                         30600000
*                      LAMB,                                            30650000
*                      FILENAM,                                         30700000
*                      SUBLIB,                                          30750000
*                      DEFINE,                                          30800000
*                      REPLACE,                                         30850000
*                      LEVEL,                                           30900000
*                      DEFAULT,                                         30950000
*                      LOCKOPT,                                         31000000
*                      KEEP,                               /*@D14LDFB*/ 31020001
*                      PID ,                               /*@D52EDUT*/ 31040001
*                      WAREA,                              /*@D52EDUT*/ 31060001
*                      LEN );                              /*@D52EDUT*/ 31080001
* /*******************************************************************/ 31100000
* /*  PLS PART OF LBRACCES MACRO, DESCRIPTION SEE ASM PART           */ 31150000
* /*******************************************************************/ 31200000
* DCL (SYNERR,                       /* SYNTAX ERROR IN MACRO CALL   */ 31250000
*      INNER,                        /* CALL LBRACCCB AS INNER MACRO */ 31300000
*      RC)                           /* RETURN CODE SET BY LBRACCCB  */ 31350000
*      FIXED EXTERNAL;                                                  31400000
* DCL (FC,                           /* PASS MF TO LBRACCCB MACRO    */ 31450000
*      TAREA)                        /* FOR ADDRESSING CONTROL BLOCK */ 31500000
*      CHARACTER EXTERNAL;                                              31550000
* DCL (IN) CHARACTER;                /* FOR LISTING OF INVOKING MACRO*/ 31600000
* DCL (COL1,COLA,COLD,               /* OUTPUT COLUMNS               */ 31650000
*      RCERR) FIXED;                 /* RETURN CODE 8                */ 31700000
* COLA = MACLMAR;                                                       31750000
* COLD = COLA + 35;                                                     31800000
* COL1 = MACGLMAR;                                                      31850000
* RCERR = 8;                                                            31900000
* IN = MACLABEL || ' ' || MACNAME || ' ' || MACLIST || ' ' || MACKEYS;  31950000
* ANS (COMMENT(IN)) COL(COLA) SKIP;                                     32000000
* IN =' LIBRARIAN - LBRACCES - 5666-301-06-H07  - VERSION 85-04-09';    32050000
* ANS (COMMENT(IN)) COL(COLA) SKIP;                                     32100000
* SYNERR = 0;                                                           32150000
* INNER = 1;                                                            32200000
* RC = 0;                                                               32250000
* /*******************************************************************/ 32300000
* /*  CHECK MAIN FUNCTION                                            */ 32350000
* /*******************************************************************/ 32400000
* IF NUMBER(MF) = 0 THEN                                                32450000
*    DO;                                                                32500000
*    ANS MSG ('MF IS NOT SPECIFIED, GENERATION SUPPRESSED ')            32550000
*                                      COL(COLA) SKIP;                  32600000
* /*  SYNTAX CHECK CONTINUES                                         */ 32650000
*    GOTO INVALMF;                                                      32700000
*    END;                                                               32750000
* IF MF(1) = 'GET' THEN                                                 32800000
*    GOTO VALMF;                                                        32850000
* IF MF(1) = 'LOCK' THEN                                                32900000
*    GOTO VALMF;                                                        32950000
* IF MF(1) = 'UNLOCK' THEN                                              33000000
*    GOTO VALMF;                                                        33050000
* IF MF(1) = 'ADDLIB' THEN                                              33100000
*    GOTO VALMF;                                                        33150000
* IF MF(1) = 'REMOVE' THEN                                              33200000
*    GOTO VALMF;                                                        33250000
* IF MF(1) = 'EXTEND' THEN                                 /*@D14LDFB*/ 33300000
*    GOTO VALMF;                                           /*@D14LDFB*/ 33350000
* IF MF(1) = 'EXTUPD' THEN                                 /*@D21SDFB*/ 33400000
*    GOTO VALMF;                                           /*@D21SDFB*/ 33450000
* ANS MSG ('MF REQUEST IS INVALID, GENERATION SUPPRESSED')              33500000
*                                     COL(COLA) SKIP;                   33550000
* /*  SYNTAX CHECK CONTINUES                                         */ 33600000
* INVALMF:;                                                             33650000
* RC = RCERR;                                                           33700000
* SYNERR = 1;                                                           33750000
* FC = '';                                                              33800000
* GOTO VALMF1;                                                          33850000
* VALMF:;                                                               33900000
* FC = MF(1);                                                           33950000
* /*******************************************************************/ 34000000
* /*  PREPARE TEMPORARY STRINGS FOR INVOCATIION OF LBRACCCB MACRO    */ 34050000
* /*******************************************************************/ 34100000
* VALMF1:;                                                              34150000
* IF NUMBER(LIBTYPE) = 0 THEN                                           34200000
*    TLIB = '';                                                         34250000
* ELSE                                                                  34300000
*    TLIB = ' LIBTYPE('||LIBTYPE(1)||')';                               34350000
* IF NUMBER(LIBUSE) = 0 THEN                                            34400000
*    TUSE = '';                                                         34450000
* ELSE                                                                  34500000
*    TUSE = ' LIBUSE('||LIBUSE(1)||')';                                 34550000
* IF NUMBER(LIBINFO) = 0 THEN                                           34600000
*    TINF = '';                                                         34650000
* ELSE                                                                  34700000
*    TINF = ' LIBINFO('||LIBINFO(1)||')';                               34750000
* IF NUMBER(CHAIN) = 0 THEN                                             34800000
*    TCHN = '';                                                         34850000
* ELSE                                                                  34900000
*    TCHN = ' CHAIN('||CHAIN(1)||')';                                   34950000
* IF NUMBER(LAMB) = 0 THEN                                 /*@D14LDFB*/ 35000000
*    TLAM = '';                                            /*@D14LDFB*/ 35050000
* ELSE                                                     /*@D14LDFB*/ 35100000
*    TLAM = ' LAMB('||LAMB(1)||')';                        /*@D14LDFB*/ 35150000
* IF NUMBER(CHAINID) = 0 THEN                              /*@D14LDFB*/ 35200000
*    TCID = '';                                            /*@D14LDFB*/ 35250000
* ELSE                                                     /*@D14LDFB*/ 35300000
*    TCID = ' CHAINID('||CHAINID(1)||')';                  /*@D14LDFB*/ 35350000
* IF NUMBER(FILENAM) = 0 THEN                                           35400000
*    TFIL = '';                                                         35450000
* ELSE                                                                  35500000
*    TFIL = ' FILENAM('||FILENAM(1)||')';                               35550000
* IF NUMBER(SUBLIB) = 0 THEN                               /*@D14LDFB*/ 35600000
*    TSUB = '';                                            /*@D14LDFB*/ 35650000
* ELSE                                                     /*@D14LDFB*/ 35700000
*    TSUB = ' SUBLIB('||SUBLIB(1)||')';                    /*@D14LDFB*/ 35750000
* IF NUMBER(DEFINE) = 0 THEN                               /*@D14LDFB*/ 35800000
*    TDNE = '';                                            /*@D14LDFB*/ 35850000
* ELSE                                                     /*@D14LDFB*/ 35900000
*    TDNE = ' DEFINE('||DEFINE(1)||')';                    /*@D14LDFB*/ 35950000
* IF NUMBER(REPLACE)= 0 THEN                               /*@D14LDFB*/ 36000000
*    TREP = '';                                            /*@D14LDFB*/ 36050000
* ELSE                                                     /*@D14LDFB*/ 36100000
*    TREP = ' REPLACE('||REPLACE(1)||')';                  /*@D14LDFB*/ 36150000
* IF NUMBER(LEVEL) = 0 THEN                                /*@D14LDFB*/ 36200000
*    TLEV = '';                                            /*@D14LDFB*/ 36250000
* ELSE                                                     /*@D14LDFB*/ 36300000
*    TLEV = ' LEVEL('||LEVEL(1)||')';                      /*@D14LDFB*/ 36350000
* IF NUMBER(DEFAULT) = 0 THEN                                           36400000
*    TDEF = '';                                                         36450000
* ELSE                                                                  36500000
*    TDEF = ' DEFAULT('||DEFAULT(1)||')';                               36550000
* IF NUMBER(CONTROL) = 0 THEN                                           36600000
*    TCON = '';                                                         36650000
* ELSE                                                                  36700000
*    TCON = ' CONTROL('||CONTROL(1)||')';                               36750000
* IF NUMBER(LOCKOPT) = 0 THEN                                           36800000
*    TSHR = '';                                                         36850000
* ELSE                                                                  36900000
*    TSHR = ' LOCKOPT('||LOCKOPT(1)||')';                               36950000
* IF NUMBER(KEEP) = 0 THEN                                              37000000
*    TKEP = '';                                                         37050000
* ELSE                                                                  37100000
*    TKEP = ' KEEP('||KEEP(1)||')';                                     37150000
* IF NUMBER(PID) = 0 THEN                                  /*@D52EDUT*/ 37153801
*    TPID = '';                                            /*@D52EDUT*/ 37157601
* ELSE                                                     /*@D52EDUT*/ 37161401
*    TPID = ' PID('||PID(1)||')';                          /*@D52EDUT*/ 37165201
* IF NUMBER(WAREA) = 0 THEN                                /*@D52EDUT*/ 37169001
*    TWAR = '';                                            /*@D52EDUT*/ 37172801
* ELSE                                                     /*@D52EDUT*/ 37176601
*    TWAR = ' WAREA('||WAREA(1)||')';                      /*@D52EDUT*/ 37180401
* IF NUMBER(LEN) = 0 THEN                                  /*@D52EDUT*/ 37184201
*    TLEN = '';                                            /*@D52EDUT*/ 37188001
* ELSE                                                     /*@D52EDUT*/ 37191801
*    TLEN = ' LEN('||LEN(1)||')';                          /*@D52EDUT*/ 37195601
* /*******************************************************************/ 37200000
* /*  CHECK IF AREA HAS BEEN SPECIFIED                               */ 37250000
* /*******************************************************************/ 37300000
* IF NUMBER(AREA) = 0  THEN                                            37350001
*    GOTO VALAREA;                                                      37400000
* ANS MSG ('AREA NOT SPECIFIED, GENERATION SUPPRESSED')                 37450000
*      COL(COLA) SKIP NORESCAN;                                         37500000
* /*  SYNTAX CHECK CONTINUES                                         */ 37550000
* RC = RCERR;                                                           37600000
* /*******************************************************************/ 37650000
* /*  CALL LBRACCCB MACRO AND CONTINUE SYNTAX CHECK                  */ 37700000
* /*******************************************************************/ 37750000
* VALAREA:;                                                             37800000
* IF MACLABEL = '' THEN                                                37850000
*    ANS (MACLABEL||';') COL(COLA) SKIP RESCAN;                         37900000
* ANS ('? LBRACCCB MF(MOD) AREA('||AREA(1)||')'                         37950000
*     ||TLIB||TUSE||TINF||TCHN||TFIL||TSUB||TDNE||TLAM||TCID||TREP||    38000000
*     TLEV||TDEF||TCON||TSHR||TKEP||                                    38037501
*     TPID||TWAR||TLEN||';')                                            38075001
*     COL(COLA) SKIP RESCAN;                               /*@D52EDUT*/ 38112501
* IF RC = 0 THEN                                                       38150000
*    GOTO MEND;                                                         38200000
* IF MF(1) = 'LOCK' THEN                                                38250000
*    GOTO LOCK;                                                         38300000
* IF MF(1) = 'UNLOCK' THEN                                              38350000
*    GOTO UNLOCK;                                                       38400000
* IF LIBTYPE(1) = 'ALL' THEN                              /*@D52EDUT*/ 38401701
*    GOTO CHLS;                                            /*@D52EDUT*/ 38403401
* /*******************************************************************/ 38405101
* /*  PREPARE CALL TO PHASE $IJBLBR AND EXECUTE MODULE INLDLDS       */ 38406801
* /*******************************************************************/ 38408501
* ANS ('RFY (LBRACCR0,LBRACR14,LBRACR15) RSTD;')                        38410201
*      COL(COLA) SKIP RESCAN;                              /*@D52EDUT*/ 38411901
* ANS ('LBRACCR0 = INLDLDS;') COL(COLA) SKIP NORESCAN;     /*@D52EDUT*/ 38413601
* ANS ('/* SET CODE TO CALL INLPLDS */') COL(COLD)NORESCAN;/*@D52EDUT*/ 38415301
* ANS ('GENERATE REFS(INLCLPT,LPT$ADDR,LBRACR14,LBRACR15,IJBPLCT);')    38417008
*      COL(COLA) SKIP RESCAN;                              /*@D66GDMK*/ 38418708
* ANS ('ASYSCOM LBRACR15') COL(COL1+9) SKIP NORESCAN;      /*@D52EDUT*/ 38420401
* ANS ('USING SYSCOM,LBRACR15') COL(COL1+9) SKIP NORESCAN; /*@D52EDUT*/ 38422101
* ANS ('L     LBRACR15,IJBPLCT') COL(COL1+9) SKIP NORESCAN;/*@D52EDUT*/ 38423801
* ANS ('ADDRESS OF LIBRARY POINTER TABLE') COL(COLD)                    38425501
*      NORESCAN;                                           /*@D52EDUT*/ 38427201
* ANS ('USING INLCLPT,LBRACR15') COL(COL1+9) SKIP NORESCAN;/*@D52EDUT*/ 38428901
* ANS ('L     LBRACR15,LPT$ADDR') COL(COL1+9)SKIP NORESCAN;/*@D52EDUT*/ 38430601
* ANS ('ADDRESS OF SVA PHASE $IJBLBR') COL(COLD) NORESCAN; /*@D52EDUT*/ 38432301
* ANS ('DROP  LBRACR15') COL(COL1+9) SKIP NORESCAN;        /*@D52EDUT*/ 38434001
* ANS ('BASSM LBRACR14,LBRACR15') COL(COL1+9)SKIP NORESCAN;/*@D66GDMK*/ 38435704
* ANS ('BRANCH TO $IJBLBR-INLPLDS ') COL(COLD) NORESCAN;   /*@D52EDUT*/ 38437401
* ANS (MACCONC||'ENDGEN;') COL(COLA) SKIP NORESCAN;        /*@D52EDUT*/ 38439206
* ANS ('RFY (LBRACCR0,LBRACCR1,LBRACR14,LBRACR15,LBRACCDS);')           38440801
*        COL(COLA) SKIP RESCAN;                            /*@D52EDUT*/ 38442501
* GOTO MEND;                                               /*@D52EDUT*/ 38444201
* CHLS:;                                                   /*@D52EDUT*/ 38445901
* /*******************************************************************/ 38450000
* /*  PREPARE CALL TO PHASE $IJBLBR AND EXECUTE MODULE IJBLBHLS      */ 38500000
* /*******************************************************************/ 38550000
* ANS ('RFY (LBRACCR0,LBRACR14,LBRACR15) RSTD;')                        38600000
*      COL(COLA) SKIP RESCAN;                                           38650000
* ANS ('LBRACCR0 = LBRFCACC;') COL(COLA) SKIP NORESCAN;                 38700000
* ANS ('/* SET CODE TO CALL IJBLBHLS */') COL(COLD) NORESCAN;           38750000
* ANS ('GENERATE REFS(INLCLPT,LPT$ADDR,LBRACR14,LBRACR15,IJBPLCT);')    38800008
*      COL(COLA) SKIP RESCAN;                              /*@D66GDMK*/ 38850008
* ANS ('ASYSCOM LBRACR15') COL(COL1+9) SKIP NORESCAN;                   38900000
* ANS ('USING SYSCOM,LBRACR15') COL(COL1+9) SKIP NORESCAN;              38950000
* ANS ('L     LBRACR15,IJBPLCT') COL(COL1+9) SKIP NORESCAN;             39000000
* ANS ('ADDRESS OF LIBRARY POINTER TABLE') COL(COLD) NORESCAN;          39050000
* ANS ('USING INLCLPT,LBRACR15') COL(COL1+9) SKIP NORESCAN;             39100000
* ANS ('L     LBRACR15,LPT$ADDR') COL(COL1+9) SKIP NORESCAN;            39150000
* ANS ('ADDRESS OF SVA PHASE $IJBLBR') COL(COLD) NORESCAN;              39200000
* ANS ('DROP  LBRACR15') COL(COL1+9) SKIP NORESCAN;                     39250000
* ANS ('BASSM LBRACR14,LBRACR15') COL(COL1+9) SKIP NORESCAN;/*D66GDMK*/ 39300004
* ANS ('BRANCH TO $IJBLBR-IJBLBHLS') COL(COLD) NORESCAN;                39350000
* ANS (MACCONC||'ENDGEN;') COL(COLA) SKIP NORESCAN;                     39400000
* ANS ('RFY (LBRACCR0,LBRACCR1,LBRACR14,LBRACR15,LBRACCDS);')           39450000
*        COL(COLA) SKIP RESCAN;                                         39500000
* GOTO MEND;                                                            39550000
* LOCK:;                                                                39600000
* ANS ('GENERATE REFS(LBRACCR1);') COL(COLA) SKIP;                      39650000
* ANS ('LOCK (LBRACCR1),FAIL=WAITC') COL(COL1+9) SKIP RESCAN;           39700000
* ANS ('LTR 15,15') COL(COL1+9) SKIP NORESCAN;                          39750000
* ANS ('BZ LBRD'||MACINDEX||'') COL(COL1+9) SKIP NORESCAN;              39800000
* ANS ('LA 0,24') COL(COL1+9) SKIP NORESCAN;                            39850000
* ANS ('CR 15,0') COL(COL1+9) SKIP NORESCAN;                            39900000
* ANS ('BE LBRD'||MACINDEX||'') COL(COL1+9) SKIP NORESCAN;              39950000
* ANS ('LOCK (LBRACCR1),FAIL=WAIT') COL(COL1+9) SKIP RESCAN;            40000000
* ANS ('LBRD'||MACINDEX||' EQU *') COL(MACGLMAR);                       40050000
* ANS (MACCONC||'ENDGEN;') COL(COLA) SKIP RESCAN;                       40100000
* GOTO MEND;                                                            40150000
* UNLOCK:;                                                              40200000
* ANS ('GENERATE REFS(LBRACCR1);') COL(COLA) SKIP;                      40250000
* ANS ('UNLOCK (LBRACCR1)') COL(COL1+9) SKIP RESCAN;                    40300000
* ANS (MACCONC||'ENDGEN;') COL(COLA) SKIP RESCAN;                       40350000
* MEND:;                                                                40400000
* INNER = 0;                                                            40450000
* SYNERR = 0;                                                           40500000
* RETURN CODE(RC);                                                      40550000
* %END;                                                                 40600000
*/*   ENDMODULE LBRACCES                                           */   40650000
