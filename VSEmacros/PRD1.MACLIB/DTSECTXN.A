         MACRO                                                          00001000
&LABEL   DTSECTXN &TRANSEC=,   ACCESS CLASSES                  @D64CDCSX00002000
               &NAME=,         TRANSACTION NAME                @D64CDCSX00003000
               &TYPE=,         GENERIC Transaction Name        @D66CDCSX00003000
               &SUBTYPE=       REQUEST SUBTYPE                 @D64CDCS 00004000
         GBLA  &MAX            **NUMBER OF ARRAY ENTRIES       @D64CDCS 00005000
         GBLC  &C(5000)        **TYPE= TRANSLATED CODE(B,C,..) @DA45424 00006000
         GBLC  &I(5000)        **SUBTYPE=                      @DA45424 00007000
         GBLC  &L(5000)        **LOGGING OPTIONS               @DA45424 00008000
         GBLC  &N(5000)        **NAME=                         @DA45424 00009000
         GBLC  &S(5000)        **ACCESS CLASSES                @DA45424 00010000
         GBLC  &T(5000)        **TYPE=                         @DA45424 00011000
         GBLC  &TYPO           **TYPE=TXN or GTXN              @D66CDCS 00012000
         GBLC  &CHARC          WORK ARRAY                               00013000
         GBLC  &CHART          WORK ARRAY                               00014000
         GBLA  &COUNT          COUNTERS                                 00015000
         GBLA  &IX             INDEX                                    00016000
         GBLB  &ABSW           SWITCHES                                 00017000
         GBLB  &AUTSW          *                                        00018000
         GBLB  &FINSW          *                                        00019000
         GBLB  &INITSW         *                                        00020000
         GBLB  &LOGSW          *                                        00021000
         GBLB  &WARNSW         *                                        00022000
         GBLC  &BLANKS         BLANK FIELD                              00023000
         GBLC  &XACC           ACCESS CLASSES TO DTSECTIN               00024000
         GBLC  &XLOG           LOGGING OPTIONS TO DTSECTIN              00025000
         GBLC  &XGLEN          PASS VALID LENGTH TO DTSECTIN   @D64CDCS 00026000
         LCLA  &LCA1           LOCAL COUNTER                            00027000
         LCLA  &LCA2           *                                        00028000
         LCLA  &LCA3           *                                        00029000
         LCLA  &LCA4           *                                        00030000
         LCLA  &LCA5           *                                        00031000
         LCLA  &LCA6           *                                        00032000
         LCLA  &LCA7           *                                        00033000
         LCLA  &LCA8           *                                        00034000
         LCLA  &LCA9           *                                        00035000
         LCLA  &LCAPSTR        *                               @D64CDCS 00036000
         LCLA  &SPAN                                                    00037000
         LCLA  &NAMEML         MAX LENGTH OF NAME                       00038000
         LCLA  &NAMEAL         ACTUAL LENGTH OF NAME                    00039000
         LCLA  &LIX            LOCAL WORK INDEX                         00040000
         LCLA  &PIX            *                                        00041000
         LCLA  &IXCUR          *                                        00042000
         LCLA  &IXNXT          *                                        00043000
         LCLA  &KPASS                                                   00044000
         LCLA  &START                                                   00045000
         LCLA  &SUBEND                                                  00046000
         LCLB  &SORTSW         SORT RTN SWITCHES                        00047000
         LCLB  &ENDSW          *                                        00048000
         LCLB  &GROUPSW        *                                        00049000
         LCLB  &LCB1                                                    00050000
         LCLB  &ACCTBL(32)     ACCESS LEVELS LOCAL ARRAY                00051000
         LCLB  &LOGTBL(32)     LOGGING LEVELS LOCAL ARRAY               00052000
         LCLC  &AUTTBL(32)     AUTHORIZATION LEVEL             @D64CDCS 00053000
         LCLC  &CC             SORT EXCHANGE AREAS                      00054000
         LCLC  &LL             *                                        00055000
         LCLC  &NN             *                                        00056000
         LCLC  &SS             *                                        00057000
         LCLC  &TT             *                                        00058000
         LCLC  &LY(32)         ACCESS LOCAL WORK ARRAY                  00059000
         LCLC  &AO             PASS PARMS TO INNER                      00060000
         LCLC  &BO             *                               @D64CDCS 00061000
         LCLC  &DO             *                               @D64CDCS 00062000
         LCLC  &CO             *                                        00063000
         LCLC  &IO             *                                        00064000
         LCLC  &KO             * TRANSACTION ARRAY             @D64CDCS 00065000
         LCLC  &LO             * GENERIC TRANSACTION ARRAY     @D66CDCS 00065000
         LCLC  &MO             *                               @D64CDCS 00066000
         LCLC  &NO             *                                        00067000
         LCLC  &PO             *                                        00068000
         LCLC  &TO             *                                        00069000
         LCLC  &ZO             *                               @D64CDCS 00070000
         LCLC  &LCC1                                                    00071000
         LCLC  &LCC2                                                    00072000
         LCLC  &LCC3                                                    00073000
         LCLC  &LCC4                                           @D64CDCS 00074000
         LCLC  &FIRST                                          @D64CDCS 00075000
         LCLC  &SECOND                                         @D64CDCS 00076000
         LCLC  &USERID          USER-ID FROM NAME PARAMETER             00077000
         LCLC  &VOLID           VOLID FROM NAME PARAMETER      @D64CDCS 00078000
         LCLC  &FILEID          FILE-ID FROM NAME PARAMETER    @D64CDCS 00079000
         LCLC  &LIBNAME         LIB-NAME FROM NAME PARAMETER   @D64CDCS 00080000
         LCLC  &SLIBNAM         SUB-LIBNAME FROM NAME PARAMETER@D64CDCS 00081000
         LCLC  &MEMBER          MEMBERNAME OF NAME PARAMETER   @D64CDCS 00082000
         LCLC  &TXNNAME         TRANSACTION FROM NAME PARAMETER@D64CDCS 00083000
         LCLC  &REGNAME         CICS REGION NAME               @D64CDCS 00084000
         LCLC  &DSNT                                                    00085000
         LCLC  &GDSNT                                          @D64CDCS 00086000
         LCLC  &MEMT                                           @D64CDCS 00087000
         LCLC  &GMEMT                                          @D64CDCS 00088000
         LCLC  &SLBT                                           @D64CDCS 00089000
         LCLC  &GSLBT                                          @D64CDCS 00090000
         LCLC  &LIBT                                                    00091000
         LCLC  &GLIBT                                          @D64CDCS 00092000
         LCLC  &TXNT                                           @D66CDCS 00091000
         LCLC  &GTXNT                                          @D66CDCS 00092000
         LCLC  &OPTT                                                    00093000
         LCLC  &USET                                                    00094000
         LCLC  &PASS(8)         CONSTRUCT PASSWORD                      00095000
         AGO    .CIBM53                                                 00096000
*************************************************************           00097000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"        *           00098000
*        5686-066 (C) COPYRIGHT IBM CORP 1996               *           00099000
*        ALL RIGHTS RESERVED                                *           00100000
*        LICENSED MATERIALS - PROPERTY OF IBM               *           00101000
.*       SEE COPYRIGHT INSTRUCTIONS, G120-2083              *           00102000
*************************************************************           00103000
.CIBM53  ANOP                                                           00104000
.*                                                                      00105000
.*                                                                      00106000
.*       GLOBAL ARRAYS                                                  00107000
.*                                                                      00108000
.*       THE ARRAYS 'A,C,I,L,...,Z' ARE USED TO TEMPORARILY HOLD        00109000
.*       EXTERNAL MACRO CALLS.  EACH ENTRY EQUALS ONE DTSECTXN MACRO    00110000
.*       CALL.  THE GLOBAL 'MAX' MUST ESTABLISH THE NUMBER OF ARRAY     00111000
.*       ENTRIES AND EACH ARITHMETIC AND CHARACTER ARRAY MUST HAVE      00112000
.*       THE SAME NUMBER OF ENTRIES SPECIFIED AS 'MAX'.                 00113000
.*                                                                      00114000
.*       THE NUMBER OF TABLE ENTRIES IS DEPENDENT UPON THE INSTALLATION 00115000
.*       BUT THE NUMBER USED HERE SHOULD APPROXIMATE THE ACTUAL ENTRIES 00116000
.*       USED SINCE THE BUFSIZE OR WORK AREAS OF THE ASSEMBLER MUST BE  00117000
.*       LARGE ENOUGH TO HOLD THE ARRAYS.(THE CURRENT MAXIMUM IS 32767  00118000
.*       ENTRIES, SEE USAGE OF GROUP= ABOVE TO MINIMIZE TABLE ENTRIES)  00119000
.*                                                                      00120000
.********************************************************************** 00121000
          AGO  .START                                                   00122000
         TITLE 'DOS/VSE TRANSACTION CONTROL TABLE  - DTSECTXN -  OUTER X00123000
               MACRO DEFINITION'                                        00124000
*/*  EJECT                                                              00125000
*/**                                                                    00126000
*/**     MODULE DTSECTXN  REL 2.0 VERSION 06   JANUARY,2001             00127000
*/**                                                                    00128000
*/**     DOS/VSE TRANSACTION CONTROL RESOURCE TABLE                     00129000
*/**                                                                    00130000
*/**  FUNCTION                                                          00131000
*/**     THIS MACRO IS PROVIDED TO ESTABLISH THE DOS/VSE TRANSACTION    00132000
*/**     CONTROL RESOURCE TABLE.  AFTER THE DEFINITIONS ARE MADE AND    00133000
*/**     THE TABLE ASSEMBLED ERROR-FREE, IT MUST BE LINK-EDITED IN BG   00134000
*/**     AS SVA-ELIGIBLE AND AVAILABLE TO THE DOS/VSE ACCESS CONTROL    00135000
*/**     FACILILTY WHICH PERFORMS THE REQUIRED ACCESS VALIDATION        00136000
*/**     PER THE TABLE ENTRIES.                                         00137000
*/**                                                                    00138000
*/**     ROUTINES THAT USE THIS TABLE AND ARE                           00139000
*/**     DEPENDENT UPON ITS FORMAT ARE THE TRANSACTION CONTROL          00140000
*/**     APPENDAGE ROUTINE(DTSECTRN)                                    00141000
*/**     THERE EXISTS ALSO A DEPENDENCIE TO DTSECTIN MACRO (DTSECTAB)   00142000
*/**     THEREFORE, ANY CHANGES THAT AFFECT THE                         00143000
*/**     GENERATED TABLE FORMAT MUST ALSO BE MADE TO THE ABOVE          00144000
*/**     MENTIONED MODULES.                                             00145000
*/**                                                                    00146000
*/**     DTSECTXN NAME=TXNNAME                                       X  00147000
*/**              <,TRANSEC=(CLASS)>                                 X  00148000
*/**              <,TYPE=GENERIC>                                    X  00148000
*/**              <,SUBTYPE=INITIAL|FINAL>                              00149000
*/**                                                                    00150000
*/**                                                                    00151000
*/**                                                                    00152000
*/**    TYPE=   GENERIC - the transaction name is accepted as generic   00153000
*/**            name (no generic for region specification)              00154000
*/**            TYPE=G, TYPE=GE,... TYPE=GENERIC is accepted                    
*/**                                                                    00155000
*/**    TYPO=   FOR USAGE OF DTSECTIN INNER MACRO, TYPE HAS TO BE       00153000
*/**            SET TO TXN or GTXN                                      00154000
*/**                                                                    00155000
*/**                                                                    00156000
*/**    NAME= <CICS_REGION_PREFIX.>TXNNAME                              00157000
*/**            CICS_REGION-PREFIX IS A 1-8 ALPHAMERIC IDENTIFIER       00158000
*/**            TXNNAME IS A 1 TO 4 ALPHAMERIC TRANSACTION NAME         00159000
*/**            CHARACTERS ALLOWED ARE A->Z, 0->9, $, #, @              00160000
*/**            a->z,/,%,?,!,:,| " =,¬,;,<,>,¢             @DCR450      00161490
*/**                                                                    00162000
*/**                                                                    00163000
*/**                                                                    00164000
*/**   TRANSEC= DEFINES 1 TO 64 ACCESS CLASSES TO CONTROL               00165000
*/**            ACCESS TO THE TRANSACTIONS                              00166000
*/**            ONLY ONE ACCESS CLASS PER TRANSACTION ALLOWED           00167000
*/**                                                                    00168000
*/**                                                                    00169000
*/**                                                                    00170000
*/**                                                                    00171000
*/**     OTHER PARAMETER                                                00172000
*/**                                                                    00173000
*/** SUBTYPE=   THE FIRST MACRO CALL IN THE SOURCE ASSEMBLY JOB         00174000
*/**            STREAM MUST INDICATE INITIAL AS A SUBTYPE AND THE       00175000
*/**            LAST MUST INDICATE FINAL.                               00176000
*/**                                                                    00177000
*/**     THE GENERATION OF THE TABLE IS DONE IN TWO STEPS.  FIRST,      00178000
*/**     ALL THE MACRO CALLS ARE PROCESSED AND THE PARAMETERS PLACED    00179000
*/**     IN ARRAYS.  THE FIRST MACRO CALL MUST CONTAIN THE SUBTYPE=     00180000
*/**     INITIAL AND THE LAST CALL SUBTYPE=FINAL.                       00181000
*/**                                                                    00182000
*/**     THEN THE CALLS ARE SORTED WITHIN THE ARRAYS IN ORDER TO        00183000
*/**     CONSTRUCT THE DOS/VSE TRANSACTION CONTROL TABLE IN BINARY      00184000
*/**     SEQUENCE TO BE ACCESSED BY THE DOS/VSE TRANSACTION CONTROL     00185000
*/**     APPENDAGE ROUTINE, DTSECTRN.  AFTER THE MACRO CALLS HAVE       00186000
*/**     BEEN ORDERED, THAT IS SORTED WITHIN EACH TYPE, THE INNER       00187000
*/**     MACRO DTSECTIN IS CALLED FOR EACH OUTER DTSECTXN INVOCATION    00188000
*/**     AND THE RESULTANT TRANSACTION CONTROL TABLE IS ORGANIZED       00189000
*/**     IN THE FOLLOWING WAY FOR ENTRIES PRESENT:                      00190000
*/**                                                                    00191000
*/**       TRANSACTION CONTROL TABLE                                    00192000
*/**          SUB-TABLE FOR TXN ENTRIES                                 00193000
*/**              SUB-TABLE DESCRIPTOR FOR THE TRANSACTION ENTRIES      00194000
*/**                                                                    00195000
*/**                                                                    00196000
.*/** ENDMODULE DTSECTXN                                                00197000
.*/* EJECT                                                              00198000
.START   ANOP                                                           00199000
.*********************************************************************  00200000
         AIF   ('&SUBTYPE' NE 'INITIAL').SEC00                          00201000
         AIF   (&FINSW EQ 1).SEC07                             @D64CDCS 00202000
         AIF   (&INITSW EQ 1).ERR00                                     00203000
.*********************************************************************  00204000
.*                                                                      00205000
.*       INITIALIZATION                                                 00206000
.*                                                                      00207000
.*********************************************************************  00208000
&MAX     SETA  5000                  **NR OF ARRAY ENTRIES**   @DA45424 00209000
&BLANKS  SETC  '                                             '          00210000
&IX      SETA  1                                                        00211000
&INITSW  SETB  1                                                        00212000
&LOGSW   SETB  0                                               @D64CDCS 00213000
&CHARC   SETC  '-(+$*)/.%#@=ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789<;>?:'  00215000
&CHART   SETC  'IRZ$@6HQY+.5GPX=*4FOW)/3ENV#02DMU-91CLT8SBK(7AJ%:?<;>'  00216000
.*       'CHARC' AND 'CHART' CHANGES MUST BE CO-ORDINATED WITH THE      00217000
.*       'TRTAB' IN THE 'DTSLOGON' ACCESS CONTROL MODULE.               00218000
  MNOTE *,'NO TABLE GENERATION WILL OCCUR IF SUBTYPE=FINAL NOT GIVEN ONX00219000
                LAST MACRO CALL'                                        00220000
.*********************************************************************  00221000
.*                                                                      00222000
.*       DETERMINE THE TYPE OF ENTRY, ASSIGN THE TYPE-CODE WHICH        00223000
.*       DETERMINES THE SORT SEQUENCE, E.G., TYPE=TXN  IS TYPE-CODE     00224000
.*       'K', AND PLACE IN A BLANKED FIELD FOR SORTING.                 00225000
.*                                                                      00226000
.*********************************************************************  00227000
.SEC00   ANOP                                                           00228000
&COUNT   SETA  &COUNT+1                                                 00229000
         AIF   (&COUNT EQ &MAX).ERR40                                   00230000
         AIF   (&INITSW EQ 1).SEC05                                     00231000
         AIF   (&LOGSW EQ 1).MEXIT                                      00232000
         AGO   .ERR10                                                   00233000
.SEC05   ANOP                                                           00234000
     AIF ('&SUBTYPE' EQ 'FINAL' AND &FINSW EQ 1 AND &LOGSW EQ 0).ERR30 X00235000
                                                               @D64CDCS 00236000
         AIF   (&FINSW NE 1).SEC06                             @D64CDCS 00237000
.SEC07   ANOP                                                  @D64CDCS 00238000
         AIF   (&LOGSW EQ 1).MEXIT                             @D64CDCS 00239000
         AGO   .ERR15                                          @D64CDCS 00240000
.SEC06   ANOP                                                  @D64CDCS 00241000
&T(&IX)  SETC  '&TYPO'                                         @D66CDCS 00242000
&NAMEAL  SETA  K'&NAME                                                  00243000
         AIF   ('&TYPE' EQ 'GENERIC').SECGEN                   @D66CDCS 00244000
         AIF   ('&TYPE' EQ 'GENERI').SECGEN                    @D66CDCS 00244000
         AIF   ('&TYPE' EQ 'GENER').SECGEN                     @D66CDCS 00244000
         AIF   ('&TYPE' EQ 'GENE').SECGEN                      @D66CDCS 00244000
         AIF   ('&TYPE' EQ 'GEN').SECGEN                       @D66CDCS 00244000
         AIF   ('&TYPE' EQ 'GE').SECGEN                        @D66CDCS 00244000
         AIF   ('&TYPE' EQ 'G').SECGEN                         @D66CDCS 00244000
         AIF   (K'&TYPE EQ 0).SEC30                            @D66CDCS 00259000
&COUNT   SETA  &COUNT-1                                        @D64CDCS 00245000
  MNOTE 8,'TYPE ''&TYPE'' IS NOT VALID. STATEMENT IGNORED'     @D66CDCS 00246000
&WARNSW  SETB  1                                               @D64CDCS 00247000
         MEXIT                                                 @D64CDCS 00248000
.*********************************************************************  00249000
.*                                                                      00250000
.SEC30   ANOP  TYPE=TXN                                        @D64CDCS 00251000
.*                                                                      00252000
.*********************************************************************  00253000
&TYPO    SETC  'TXN'                                           @D66CDCS 00214000
&C(&IX)  SETC  'K'            INDICATE TRANSACTION             @D64CDCS 00254000
&LCA1    SETA  0                                               @D64CDCS 00255000
&LCA2    SETA  0                                               @D64CDCS 00256000
&LCA3    SETA  0                                               @D64CDCS 00257000
&NAMEML  SETA  12                                              @D64CDCS 00258000
&T(&IX)  SETC  'TXN'                                           @D66CDCS 00242000
         AIF   (K'&NAME EQ 0).TXNERR                           @D64CDCS 00259000
         AIF   (K'&NAME LT 14).TXN10                           @D64CDCS 00260000
         AGO   .TXN100                                                  00261000
.TXNERR  ANOP                                                  @D64CDCS 00262000
&COUNT   SETA  &COUNT-1                                        @D64CDCS 00263000
&WARNSW  SETB  1                                               @D64CDCS 00264000
  MNOTE 8,'MISSING KEYWORD PARAMETER NAME=...'                 @D64CDCS 00265000
         MEXIT                                                 @D64CDCS 00266000
.REG100  ANOP                                                  @D64CDCS 00267000
&COUNT   SETA  &COUNT-1                                        @D64CDCS 00268000
&WARNSW  SETB  1                                               @D64CDCS 00269000
  MNOTE 4,'REGION/TXN NAME IS INCORRECT. STATEMENT IGNORED'    @D64CDCS 00270000
         MEXIT                                                 @D64CDCS 00271000
.TXN100  ANOP                                                  @D64CDCS 00272000
&COUNT   SETA  &COUNT-1                                        @D64CDCS 00273000
&WARNSW  SETB  1                                               @D64CDCS 00274000
  MNOTE 4,'TRANSACTION NAME IS INCORRECT. STATEMENT IGNORED'   @D64CDCS 00275000
         MEXIT                                                 @D64CDCS 00276000
.*       VALIDATE CICS_REGION                                  @D64CDCS 00277000
.TXN10   ANOP                                                  @D64CDCS 00278000
&LCA1    SETA  &LCA1+1                                         @D64CDCS 00279000
         AIF   (&LCA1 GT 9).TXN200                             @D64CDCS 00280000
         AIF   (&LCA1 GT &NAMEAL).TXN200                       @D64CDCS 00281000
         AIF   ('&NAME'(&LCA1,1) EQ '.').CHAROK1               @D64CDCS 00282000
         AIF   ('&NAME'(&LCA1,1) EQ '$').CHAROK1               @D64CDCS 00283000
         AIF   ('&NAME'(&LCA1,1) EQ '#').CHAROK1               @D64CDCS 00284000
         AIF   ('&NAME'(&LCA1,1) EQ '@').CHAROK1               @D64CDCS 00285000
         AIF   ('&NAME'(&LCA1,1) EQ '/').CHAROK1               @DCR0450 00285050
         AIF   ('&NAME'(&LCA1,1) EQ '%').CHAROK1               @DCR0450 00285100
         AIF   ('&NAME'(&LCA1,1) EQ '¢').CHAROK1               @DCR0450 00285150
         AIF   ('&NAME'(&LCA1,1) EQ '?').CHAROK1               @DCR0450 00285200
         AIF   ('&NAME'(&LCA1,1) EQ '!').CHAROK1               @DCR0450 00285250
         AIF   ('&NAME'(&LCA1,1) EQ ':').CHAROK1               @DCR0450 00285300
         AIF   ('&NAME'(&LCA1,1) EQ '|').CHAROK1               @DCR0450 00285350
         AIF   ('&NAME'(&LCA1,1) EQ '"').CHAROK1               @DCR0450 00285400
         AIF   ('&NAME'(&LCA1,1) EQ '=').CHAROK1               @DCR0450 00285450
         AIF   ('&NAME'(&LCA1,1) EQ '¬').CHAROK1               @DCR0450 00285500
         AIF   ('&NAME'(&LCA1,1) EQ ';').CHAROK1               @DCR0450 00285550
         AIF   ('&NAME'(&LCA1,1) EQ '<').CHAROK1               @DCR0450 00285600
         AIF   ('&NAME'(&LCA1,1) EQ '>').CHAROK1               @DCR0450 00285650
         AIF   ('&NAME'(&LCA1,1) LT 'a').REG100                @DCR0450 00285700
         AIF   ('&NAME'(&LCA1,1) LE 'i').CHAROK1               @DCR0450 00285750
         AIF   ('&NAME'(&LCA1,1) LT 'j').REG100                @DCR0450 00285800
         AIF   ('&NAME'(&LCA1,1) LE 'r').CHAROK1               @DCR0450 00285850
         AIF   ('&NAME'(&LCA1,1) LT 's').REG100                @DCR0450 00285900
         AIF   ('&NAME'(&LCA1,1) LE 'z').CHAROK1               @DCR0450 00285950
         AIF   ('&NAME'(&LCA1,1) LT 'A').REG100                @D64CDCS 00286000
         AIF   ('&NAME'(&LCA1,1) LE 'I').CHAROK1               @D64CDCS 00287000
         AIF   ('&NAME'(&LCA1,1) LT 'J').REG100                @D64CDCS 00288000
         AIF   ('&NAME'(&LCA1,1) LE 'R').CHAROK1               @D64CDCS 00289000
         AIF   ('&NAME'(&LCA1,1) LT 'S').REG100                @D64CDCS 00290000
         AIF   ('&NAME'(&LCA1,1) LE 'Z').CHAROK1               @D64CDCS 00291000
         AIF   ('&NAME'(&LCA1,1) LE '9').CHAROK1               @D64CDCS 00292000
         AGO   .REG100                                         @D64CDCS 00293000
.CHAROK1 ANOP                                                  @D64CDCS 00294000
         AIF   ('&NAME'(&LCA1,1) NE '.').TXN10                 @D64CDCS 00295000
&LCC1    SETC  '&NAME'(1,&LCA1-1)                              @D64CDCS 00296000
         AGO   .TXN300                                                  00297000
.*       NO REGION SPECIFIED OR WRONG NAME                     @D64CDCS 00298000
.TXN200  ANOP                                                  @D64CDCS 00299000
         AIF   (&LCA1 GT 5).TXN100                             @D64CDCS 00300000
&LCC1    SETC  '        '           NO REGION SPECIFIED        @D64CDCS 00301000
&LCA1    SETA  0                    NO REGION SPECIFIED        @D64CDCS 00302000
.*       VALIDATE TRANSACTION NAME                             @D64CDCS 00303000
.TXN300  ANOP                                                  @D64CDCS 00304000
&LCA2    SETA  &NAMEAL-&LCA1                                   @D64CDCS 00305000
&LCA3    SETA  &LCA1                                           @D64CDCS 00306000
         AIF   (&LCA2 GT 4).TXN100                             @D64CDCS 00307000
         AIF   (&LCA2 LE 0).TXN100                             @D64CDCS 00308000
.TXN300B ANOP                                                  @D64CDCS 00309000
&LCA3    SETA  &LCA3+1                                         @D64CDCS 00310000
         AIF   (&LCA3 GT &NAMEAL).CHAROK3                      @D64CDCS 00311000
         AIF   ('&NAME'(&LCA3,1) EQ '$').CHAROK2               @D64CDCS 00312000
         AIF   ('&NAME'(&LCA3,1) EQ '#').CHAROK2               @D64CDCS 00313000
         AIF   ('&NAME'(&LCA3,1) EQ '@').CHAROK2               @D64CDCS 00314000
         AIF   ('&NAME'(&LCA3,1) EQ '/').CHAROK2               @DCR0450 00314050
         AIF   ('&NAME'(&LCA3,1) EQ '%').CHAROK2               @DCR0450 00314100
         AIF   ('&NAME'(&LCA3,1) EQ '¢').CHAROK2               @DCR0450 00314150
         AIF   ('&NAME'(&LCA3,1) EQ '?').CHAROK2               @DCR0450 00314200
         AIF   ('&NAME'(&LCA3,1) EQ '!').CHAROK2               @DCR0450 00314250
         AIF   ('&NAME'(&LCA3,1) EQ ':').CHAROK2               @DCR0450 00314300
         AIF   ('&NAME'(&LCA3,1) EQ '|').CHAROK2               @DCR0450 00314350
         AIF   ('&NAME'(&LCA3,1) EQ '"').CHAROK2               @DCR0450 00314400
         AIF   ('&NAME'(&LCA3,1) EQ '=').CHAROK2               @DCR0450 00314450
         AIF   ('&NAME'(&LCA3,1) EQ '¬').CHAROK2               @DCR0450 00314500
         AIF   ('&NAME'(&LCA3,1) EQ ';').CHAROK2               @DCR0450 00314550
         AIF   ('&NAME'(&LCA3,1) EQ '<').CHAROK2               @DCR0450 00314600
         AIF   ('&NAME'(&LCA3,1) EQ '>').CHAROK2               @DCR0450 00314650
         AIF   ('&NAME'(&LCA3,1) LT 'a').TXN100                @DCR0450 00314700
         AIF   ('&NAME'(&LCA3,1) LE 'i').CHAROK2               @DCR0450 00314750
         AIF   ('&NAME'(&LCA3,1) LT 'j').TXN100                @DCR0450 00314800
         AIF   ('&NAME'(&LCA3,1) LE 'r').CHAROK2               @DCR0450 00314850
         AIF   ('&NAME'(&LCA3,1) LT 's').TXN100                @DCR0450 00314900
         AIF   ('&NAME'(&LCA3,1) LE 'z').CHAROK2               @DCR0450 00314950
         AIF   ('&NAME'(&LCA3,1) LT 'A').TXN100                @D64CDCS 00315000
         AIF   ('&NAME'(&LCA3,1) LE 'I').CHAROK2               @D64CDCS 00316000
         AIF   ('&NAME'(&LCA3,1) LT 'J').TXN100                @D64CDCS 00317000
         AIF   ('&NAME'(&LCA3,1) LE 'R').CHAROK2               @D64CDCS 00318000
         AIF   ('&NAME'(&LCA3,1) LT 'S').TXN100                @D64CDCS 00319000
         AIF   ('&NAME'(&LCA3,1) LE 'Z').CHAROK2               @D64CDCS 00320000
         AIF   ('&NAME'(&LCA3,1) LE '9').CHAROK2               @D64CDCS 00321000
         AGO   .TXN100                                         @D64CDCS 00322000
.CHAROK2 ANOP                                                  @D64CDCS 00323000
         AGO   .TXN300B                                        @D64CDCS 00324000
.CHAROK3 ANOP                                                  @D64CDCS 00325000
&REGNAME SETC  '&LCC1&BLANKS'(1,8)                             @D64CDCS 00326000
&LCC1    SETC  '&NAME'(&NAMEAL-&LCA2+1,&LCA2)                  @D64CDCS 00327000
&TXNNAME SETC  '&LCC1&BLANKS'(1,4)                             @D64CDCS 00328000
&N(&IX)  SETC  '&REGNAME&TXNNAME'                              @D64CDCS 00329000
         AGO   .SEC60                                          @D64CDCS 00330000
.*********************************************************************  00249000
.*                                                                      00250000
.SECGEN  ANOP  TYPE=GTXN                                       @D66CDCS 00251000
.*                                                                      00252000
.*********************************************************************  00253000
&C(&IX)  SETC  'L'            INDICATE GENERIC TRANSACTION     @D66CDCS 00254000
&TYPO    SETC  'GTXN'         INDICATE GENERIC TRANSACTION     @D66CDCS         
&LCA1    SETA  0                                               @D66CDCS 00255000
&LCA2    SETA  0                                               @D66CDCS 00256000
&LCA3    SETA  0                                               @D66CDCS 00257000
&NAMEML  SETA  12                                              @D66CDCS 00258000
&T(&IX)  SETC  'GTXN'                                          @D66CDCS 00242000
         AIF   (K'&NAME EQ 0).GXNERR                           @D66CDCS 00259000
         AIF   (K'&NAME LT 14).GXN10                           @D66CDCS 00260000
         AGO   .GXN100                                                  00261000
.GXNERR  ANOP                                                  @D66CDCS 00262000
&COUNT   SETA  &COUNT-1                                        @D66CDCS 00263000
&WARNSW  SETB  1                                               @D66CDCS 00264000
  MNOTE 8,'MISSING KEYWORD PARAMETER NAME=...'                 @D66CDCS 00265000
         MEXIT                                                 @D66CDCS 00266000
.GRG100  ANOP                                                  @D66CDCS 00267000
&COUNT   SETA  &COUNT-1                                        @D64CDCS 00268000
&WARNSW  SETB  1                                               @D66CDCS 00269000
  MNOTE 4,'REGION/TXN NAME IS INCORRECT. STATEMENT IGNORED'    @D66CDCS 00270000
         MEXIT                                                 @D66CDCS 00271000
.GXN100  ANOP                                                  @D66CDCS 00272000
&COUNT   SETA  &COUNT-1                                        @D66CDCS 00273000
&WARNSW  SETB  1                                               @D66CDCS 00274000
  MNOTE 4,'TRANSACTION NAME IS INCORRECT. STATEMENT IGNORED'   @D66CDCS 00275000
         MEXIT                                                 @D66CDCS 00276000
.*       VALIDATE CICS_REGION                                  @D66CDCS 00277000
.GXN10   ANOP                                                  @D66CDCS 00278000
&LCA1    SETA  &LCA1+1                                         @D66CDCS 00279000
         AIF   (&LCA1 GT 9).GXN200                             @D66CDCS 00280000
         AIF   (&LCA1 GT &NAMEAL).GXN200                       @D66CDCS 00281000
         AIF   ('&NAME'(&LCA1,1) EQ '.').CHAROK4               @D66CDCS 00282000
         AIF   ('&NAME'(&LCA1,1) EQ '$').CHAROK4               @D66CDCS 00283000
         AIF   ('&NAME'(&LCA1,1) EQ '#').CHAROK4               @D66CDCS 00284000
         AIF   ('&NAME'(&LCA1,1) EQ '@').CHAROK4               @D66CDCS 00285000
         AIF   ('&NAME'(&LCA1,1) EQ '/').CHAROK4               @D66CDCS 00285050
         AIF   ('&NAME'(&LCA1,1) EQ '%').CHAROK4               @D66CDCS 00285100
         AIF   ('&NAME'(&LCA1,1) EQ '¢').CHAROK4               @D66CDCS 00285150
         AIF   ('&NAME'(&LCA1,1) EQ '?').CHAROK4               @D66CDCS 00285200
         AIF   ('&NAME'(&LCA1,1) EQ '!').CHAROK4               @D66cdcs 00285250
         AIF   ('&NAME'(&LCA1,1) EQ ':').CHAROK4               @D66cdcs 00285300
         AIF   ('&NAME'(&LCA1,1) EQ '|').CHAROK4               @D66cdcs 00285350
         AIF   ('&NAME'(&LCA1,1) EQ '"').CHAROK4               @D66cdcs 00285400
         AIF   ('&NAME'(&LCA1,1) EQ '=').CHAROK4               @D66cdcs 00285450
         AIF   ('&NAME'(&LCA1,1) EQ '¬').CHAROK4               @D66cdcs 00285500
         AIF   ('&NAME'(&LCA1,1) EQ ';').CHAROK4               @D66cdcs 00285550
         AIF   ('&NAME'(&LCA1,1) EQ '<').CHAROK4               @D66cdcs 00285600
         AIF   ('&NAME'(&LCA1,1) EQ '>').CHAROK4               @D66cdcs 00285650
         AIF   ('&NAME'(&LCA1,1) LT 'a').GRG100                @D66cdcs 00285700
         AIF   ('&NAME'(&LCA1,1) LE 'i').CHAROK4               @D66cdcs 00285750
         AIF   ('&NAME'(&LCA1,1) LT 'j').GRG100                @D66cdcs 00285800
         AIF   ('&NAME'(&LCA1,1) LE 'r').CHAROK4               @D66cdcs 00285850
         AIF   ('&NAME'(&LCA1,1) LT 's').GRG100                @D66cdcs 00285900
         AIF   ('&NAME'(&LCA1,1) LE 'z').CHAROK4               @D66cdcs 00285950
         AIF   ('&NAME'(&LCA1,1) LT 'A').GRG100                @D66cdcs 00286000
         AIF   ('&NAME'(&LCA1,1) LE 'I').CHAROK4               @D66cdcs 00287000
         AIF   ('&NAME'(&LCA1,1) LT 'J').GRG100                @D66cdcs 00288000
         AIF   ('&NAME'(&LCA1,1) LE 'R').CHAROK4               @D66dccs 00289000
         AIF   ('&NAME'(&LCA1,1) LT 'S').GRG100                @D66cdcs 00290000
         AIF   ('&NAME'(&LCA1,1) LE 'Z').CHAROK4               @D66cdcs 00291000
         AIF   ('&NAME'(&LCA1,1) LE '9').CHAROK4               @D66cdcs 00292000
         AGO   .GRG100                                         @D66cdcs 00293000
.CHAROK4 ANOP                                                  @D66CDCS 00294000
         AIF   ('&NAME'(&LCA1,1) NE '.').GXN10                 @D66CDCS 00295000
&LCC1    SETC  '&NAME'(1,&LCA1-1)                              @D66CDCS 00296000
         AGO   .TXN300                                                  00297000
.*       NO REGION SPECIFIED OR WRONG NAME                     @D66CDCS 00298000
.GXN200  ANOP                                                  @D66CDCS 00299000
         AIF   (&LCA1 GT 5).GXN100                             @D66CDCS 00300000
&LCC1    SETC  '        '           NO REGION SPECIFIED        @D66CDCS 00301000
&LCA1    SETA  0                    NO REGION SPECIFIED        @D66CDCS 00302000
.*       VALIDATE TRANSACTION NAME                             @D66CDCS 00303000
.GXN300  ANOP                                                  @D66CDCS 00304000
&LCA2    SETA  &NAMEAL-&LCA1                                   @D66CDCS 00305000
&LCA3    SETA  &LCA1                                           @D66CDCS 00306000
         AIF   (&LCA2 GT 4).GXN100                             @D66CDCS 00307000
         AIF   (&LCA2 LE 0).GXN100                             @D66CDCS 00308000
.GXN300B ANOP                                                  @D66CDCS 00309000
&LCA3    SETA  &LCA3+1                                         @D66CDCS 00310000
         AIF   (&LCA3 GT &NAMEAL).CHAROK6                      @D66CDCS 00311000
         AIF   ('&NAME'(&LCA3,1) EQ '$').CHAROK5               @D66CDCS 00312000
         AIF   ('&NAME'(&LCA3,1) EQ '#').CHAROK5               @D66CDCS 00313000
         AIF   ('&NAME'(&LCA3,1) EQ '@').CHAROK5               @D66CDCS 00314000
         AIF   ('&NAME'(&LCA3,1) EQ '/').CHAROK5               @D66cdcs 00314050
         AIF   ('&NAME'(&LCA3,1) EQ '%').CHAROK5               @D66cdcs 00314100
         AIF   ('&NAME'(&LCA3,1) EQ '¢').CHAROK5               @D66cdcs 00314150
         AIF   ('&NAME'(&LCA3,1) EQ '?').CHAROK5               @D66cdcs 00314200
         AIF   ('&NAME'(&LCA3,1) EQ '!').CHAROK5               @D66cdcs 00314250
         AIF   ('&NAME'(&LCA3,1) EQ ':').CHAROK5               @D66cdcs 00314300
         AIF   ('&NAME'(&LCA3,1) EQ '|').CHAROK5               @D66cdcs 00314350
         AIF   ('&NAME'(&LCA3,1) EQ '"').CHAROK5               @D66cdcs 00314400
         AIF   ('&NAME'(&LCA3,1) EQ '=').CHAROK5               @D66cdcs 00314450
         AIF   ('&NAME'(&LCA3,1) EQ '¬').CHAROK5               @D66cdcs 00314500
         AIF   ('&NAME'(&LCA3,1) EQ ';').CHAROK5               @D66cdcs 00314550
         AIF   ('&NAME'(&LCA3,1) EQ '<').CHAROK5               @D66cdcs 00314600
         AIF   ('&NAME'(&LCA3,1) EQ '>').CHAROK5               @D66cdcs 00314650
         AIF   ('&NAME'(&LCA3,1) LT 'a').gXN100                @D66cdcs 00314700
         AIF   ('&NAME'(&LCA3,1) LE 'i').CHAROK5               @D66cdcs 00314750
         AIF   ('&NAME'(&LCA3,1) LT 'j').gXN100                @D66cdcs 00314800
         AIF   ('&NAME'(&LCA3,1) LE 'r').CHAROK5               @D66cdcs 00314850
         AIF   ('&NAME'(&LCA3,1) LT 's').gXN100                @D66cdcs 00314900
         AIF   ('&NAME'(&LCA3,1) LE 'z').CHAROK5               @D66cdcs 00314950
         AIF   ('&NAME'(&LCA3,1) LT 'A').gXN100                @D66cdcs 00315000
         AIF   ('&NAME'(&LCA3,1) LE 'I').CHAROK5               @D66cdcs 00316000
         AIF   ('&NAME'(&LCA3,1) LT 'J').gXN100                @D66cdcs 00317000
         AIF   ('&NAME'(&LCA3,1) LE 'R').CHAROK5               @D66CDCS 00318000
         AIF   ('&NAME'(&LCA3,1) LT 'S').gXN100                @D66CDCS 00319000
         AIF   ('&NAME'(&LCA3,1) LE 'Z').CHAROK5               @D66CDCS 00320000
         AIF   ('&NAME'(&LCA3,1) LE '9').CHAROK5               @D66CDCS 00321000
         AGO   .GXN100                                         @D66CDCS 00322000
.CHAROK5 ANOP                                                  @D66CDCS 00323000
         AGO   .GXN300B                                        @D66CDCS 00324000
.CHAROK6 ANOP                                                  @D66CDCS 00325000
&REGNAME SETC  '&LCC1&BLANKS'(1,8)                             @D66CDCS 00326000
&LCC1    SETC  '&NAME'(&NAMEAL-&LCA2+1,&LCA2)                  @D66CDCS 00327000
&TXNNAME SETC  '&LCC1&BLANKS'(1,4)                             @D66CDCS 00328000
&N(&IX)  SETC  '&REGNAME&TXNNAME'                              @D66CDCS 00329000
         AGO   .SEC60                                          @D66CDCS 00330000
.*********************************************************************  00331000
.*                                                                      00332000
.SEC60   ANOP  SET SOME GLOBALS WITHOUT CHECK NO GLOBALS SET   @D64CDCS 00333000
.*                                                                      00334000
.*********************************************************************  00335000
.*********************************************************************  00336000
.*                                                                      00337000
.*       VALIDATE THE ACCESS CLASS PARAMETER(1-64 CLASSES)              00338000
.*       AND ASSIGN ANY AUTHORIZATION LEVELS                            00339000
.*                                                                      00340000
.*********************************************************************  00341000
&LCA1    SETA  1                                                        00342000
&LCA2    SETA  &LCA1+1                                                  00343000
&LCB1    SETB  0                                               @D64CDCS 00344000
         AIF   (T'&TRANSEC NE 'O').SS05                        @D64CDCS 00345000
&COUNT   SETA  &COUNT-1                                        @D64CDCS 00346000
&WARNSW  SETB  1                                               @D64CDCS 00347000
  MNOTE 4,'ACCESS CLASS MISSING/INCORRECT. STATEMENT IGNORED'  @D64CDCS 00348000
         MEXIT                                                 @D64CDCS 00349000
.SS05    ANOP                                                  @D64CDCS 00350000
         AIF   ('&TRANSEC'(1,1) EQ '(').SS30                   @D64CDCS 00351000
&COUNT   SETA  &COUNT-1                                        @D64CDCS 00352000
&WARNSW  SETB  1                                               @D64CDCS 00353000
  MNOTE 4,'INVALID TRANSEC=&TRANSEC, STATEMENT IGNORED'        @D64CDCS 00354000
&WARNSW  SETB  1                                                        00355000
         MEXIT                                                 @D64CDCS 00356000
.SS10    ANOP                                                           00357000
&COUNT   SETA  &COUNT-1                                        @D64CDCS 00358000
&WARNSW  SETB  1                                                        00359000
  MNOTE 4,'INVALID TRANSEC=&TRANSEC(&LCA2) PARAMETER, IGNORED'          00360000
         MEXIT                                                 @D64CDCS 00361000
&WARNSW  SETB  1                                                        00362000
.SS15    ANOP                                                           00363000
  MNOTE 4,'ONLY ONE ACCESS CLASS ALLOWED. PARAMETER, IGNORED'  @D64CDCS 00364000
&WARNSW  SETB  1                                                        00365000
         AGO   .SS90                                                    00366000
.SS20    ANOP                                                           00367000
&LCA1    SETA  &LCA1+1                                         @D64CDCS 00368000
&LCA2    SETA  &LCA1+1                                         @D64CDCS 00369000
.SS30    AIF   ('&TRANSEC(&LCA1)' EQ '').SS90                           00370000
         AIF   (&LCB1 EQ 1).SS15                               @D64CDCS 00371000
&LCB1    SETB  1                                               @D64CDCS 00372000
         AIF   (K'&TRANSEC(&LCA1) LT 3).SS80                   @D64CDCS 00373000
&LCA9    SETA  1                                                        00374000
&LCA3    SETA  K'&TRANSEC(&LCA1)                               @D64CDCS 00375000
&LCC1    SETC  '&TRANSEC(&LCA1)'                               @D64CDCS 00376000
.SS40    AIF   ('&LCC1'(&LCA9,1) EQ '-').SS05 INVALID ACCESS   @D64CDCS 00377000
         AIF   (&LCA9 EQ &LCA3).SS80                           @D64CDCS 00378000
&LCA9    SETA  &LCA9+1                                                  00379000
         AIF   (&LCA9 GT 3).SS10                               @D64CDCS 00380000
         AGO   .SS40                                                    00381000
.SS80    AIF   (T'&TRANSEC(&LCA1) NE 'N').SS10                 @D64CDCS 00382000
         AIF   (&TRANSEC(&LCA1) LT 1 OR &TRANSEC(&LCA1) GT 64).SS10     00383000
         AIF   (&TRANSEC(&LCA1) LT 33).SS100   ADD TO LOGGING  @D64CDCS 00384000
&LCA3    SETA  &TRANSEC(&LCA1)-32                              @D64CDCS 00385000
&ACCTBL(&LCA3) SETB 1                                          @D64CDCS 00386000
         AGO   .SS20                                           @D64CDCS 00387000
.SS90    ANOP                                                           00388000
&LIX     SETA  1                                                        00389000
.SS110   ANOP                                                           00390000
&LY(&LIX) SETC '0'                                                      00391000
         AIF   (&ACCTBL(&LIX) NE 1).SS250                      @D64CDCS 00392000
&LY(&LIX) SETC '1'                                                      00393000
.SS250   ANOP                                                  @D64CDCS 00394000
&LIX     SETA  &LIX+1                                                   00395000
         AIF   (&LIX LT 33).SS110                                       00396000
&LCC2    SETC  '&LY(32)&LY(31)&LY(30)&LY(29)&LY(28)&LY(27)&LY(26)&LY(25X00397000
               )&LY(24)&LY(23)&LY(22)&LY(21)&LY(20)&LY(19)&LY(18)&LY(17X00398000
               )'                                                       00399000
&LCC3    SETC  '&LY(16)&LY(15)&LY(14)&LY(13)&LY(12)&LY(11)&LY(10)&LY(9)X00400000
               &LY(8)&LY(7)&LY(6)&LY(5)&LY(4)&LY(3)&LY(2)&LY(1)'        00401000
&S(&IX)  SETC  '&LCC2&LCC3'                                             00402000
         AGO   .AA90                                           @D64CDCS 00403000
.*********************************************************************  00404000
.*                                                                      00405000
.*       ASSIGN ACCESS CLASSES (FROM 1-32 INTO DTSECTAB LOG PARM)       00406000
.*                                                                      00407000
.*********************************************************************  00408000
.SS100   ANOP                                                           00409000
&LCA3    SETA  &TRANSEC(&LCA1)                                 @D64CDCS 00410000
&LOGTBL(&LCA3) SETB 1                                                   00411000
         AGO   .SS20                                                    00412000
.AA90    ANOP                                                           00413000
&LIX     SETA  1                                                        00414000
.AA110   ANOP                                                           00415000
&LY(&LIX) SETC '0'                                                      00416000
         AIF   (&LOGTBL(&LIX) NE 1).AA120                               00417000
&LY(&LIX) SETC '1'                                                      00418000
.AA120   ANOP                                                           00419000
&LIX     SETA  &LIX+1                                                   00420000
         AIF   (&LIX LT 33).AA110                                       00421000
&LCC2    SETC  '&LY(32)&LY(31)&LY(30)&LY(29)&LY(28)&LY(27)&LY(26)&LY(25X00422000
               )&LY(24)&LY(23)&LY(22)&LY(21)&LY(20)&LY(19)&LY(18)&LY(17X00423000
               )'                                                       00424000
&LCC3    SETC  '&LY(16)&LY(15)&LY(14)&LY(13)&LY(12)&LY(11)&LY(10)&LY(9)X00425000
               &LY(8)&LY(7)&LY(6)&LY(5)&LY(4)&LY(3)&LY(2)&LY(1)'        00426000
&L(&IX)  SETC  '&LCC2&LCC3'                                             00427000
&IX      SETA  &IX+1                                                    00428000
         AIF   ('&SUBTYPE' NE 'FINAL').MEXIT                            00429000
         AIF   (&ABSW EQ 1).MEXIT00                                     00430000
&N(&IX)  SETC  'ELBAT FO DNE'                                           00431000
&FINSW   SETB  1                                               @D64CDCS 00432000
.*********************************************************************  00433000
.*                                                                      00434000
.*       END OF PROCESSING UNTIL SUBTYPE=FINAL DETECTED                 00435000
.*                                                                      00436000
.*       THERE IS NO WAY OF DETECTING WHEN THE LAST MACRO CALL          00437000
.*       IS PROCESSED SO IF SUBTYPE=FINAL IS NOT GIVEN, NO TABLE        00438000
.*       GENERATION WILL OCCUR FOR THIS USER ERROR CONDITION.           00439000
.*                                                                      00440000
.*                                                                      00441000
.*       AFTER SUBTYPE=FINAL HAS BEEN DETECTED, THE PROCESSED           00442000
.*       CALLS AND THE ASSOCIATED ARRAYS ARE SORTED BEFORE INVOKING     00443000
.*       THE INNER MACRO TO GENERATE THE ACCESS CONTROL RESOURCE        00444000
.*       TABLE.                                                         00445000
.*                                                                      00446000
.*********************************************************************  00447000
&SUBEND  SETA  &COUNT+1                                                 00448000
&LCC1 SETC '                                                      '    X00449000
                                                               @D64CDCS 00450000
.*                                                                      00451000
.*       SORT ON TYPE CONCATINATED TO NAME FIELD               @D149DOW 00452000
.*                                                                      00453000
.SORT00  ANOP                                                           00454000
&IXCUR   SETA  1                                               @D64CDCS 00455000
&SORTSW  SETB  0                                               @D64CDCS 00456000
.SORT05  ANOP                                                  @D64CDCS 00457000
&IXNXT   SETA  &IXCUR+1                                                 00458000
&FIRST   SETC  '&C(&IXCUR)&N(&IXCUR)&LCC1'(1,57)               @D64CDCS 00459000
&SECOND  SETC  '&C(&IXNXT)&N(&IXNXT)&LCC1'(1,57)               @D64CDCS 00460000
.SORT10  AIF   ('&N(&IXNXT)' EQ 'ELBAT FO DNE').SORT50                  00461000
         ACTR  20000                                           @da45424 00462000
         AIF   (&IXNXT EQ &SUBEND).SORT50                               00463000
         AIF   ('&FIRST' LE '&SECOND').SORT40                  @D64CDCS 00464000
&CC      SETC  '&C(&IXCUR)'                                             00465000
&LL      SETC  '&L(&IXCUR)'                                             00466000
&NN      SETC  '&N(&IXCUR)'                                             00467000
&SS      SETC  '&S(&IXCUR)'                                             00468000
&TT      SETC  '&T(&IXCUR)'                                             00469000
&C(&IXCUR) SETC  '&C(&IXNXT)'                                           00470000
&L(&IXCUR) SETC  '&L(&IXNXT)'                                           00471000
&N(&IXCUR) SETC  '&N(&IXNXT)'                                           00472000
&S(&IXCUR) SETC  '&S(&IXNXT)'                                           00473000
&T(&IXCUR) SETC  '&T(&IXNXT)'                                           00474000
&C(&IXNXT) SETC  '&CC'                                                  00475000
&L(&IXNXT) SETC  '&LL'                                                  00476000
&N(&IXNXT) SETC  '&NN'                                                  00477000
&S(&IXNXT) SETC  '&SS'                                                  00478000
&T(&IXNXT) SETC  '&TT'                                                  00479000
&SORTSW  SETB  1                                                        00480000
.SORT40  ANOP                                                           00481000
&IXCUR   SETA  &IXCUR+1                                                 00482000
         AGO   .SORT05                                         @D64CDCS 00483000
.SORT50  ANOP                                                           00484000
&SUBEND  SETA  &SUBEND-1                                                00485000
         AIF   (&SORTSW NE 0).SORT00                                    00486000
         ACTR  20000                                           @DA45424 00487000
.*                                                                      00488000
.*       THE OUTER MACRO CALLS AND THEIR CORRESPONDING PARAMETERS       00489000
.*       HAVE BEEN SORTED INTO ORDER SO THAT THE ACTUAL TABLE CAN       00490000
.*       BE GENERATED IN BINARY SEQUENCE BY CALLING THE INNER MACRO     00491000
.*       'DTSECTIN'.                                                    00492000
.*                                                                      00493000
&IX      SETA  1                                                        00494000
&IXCUR   SETA  1                                                        00495000
&IXNXT   SETA  &IXCUR+1                                                 00496000
&GROUPSW SETB  0                                                        00497000
&ENDSW   SETB  0                                                        00498000
.*                                                                      00499000
.*       A VECTOR TABLE IS GENERATED AT THE BEGINNING OF THE RESOURCE   00500000
.*       TABLE THAT POINTS TO ANOTHER SUB-GROUP VECTOR TABLE WHICH      00501000
.*       DESCRIBES THE INDIVIDUALLY GENERATED GROUP ENTRIES.            00502000
.*                                                                      00503000
TAB      TITLE 'DOS/VSE TRANSACTION CONTROL TABLE '                     00504000
         SPACE 5                                                        00505000
         PUNCH '     PHASE DTSECTXN,*,SVA '                             00506000
         PUNCH '     MODE  RMODE(ANY),AMODE(31)'                        00507000
         SPACE 5                                                        00508000
*                                                                       00509000
*        TRANSACTION CONTROL VECTOR TABLE                               00510000
*                                                                       00511000
         SPACE 2                                                        00512000
DTSECTXN CSECT                          RESOURCE TABLE VECTORS          00513000
&TXNT    SETC  '*-*'                                                    00514000
&GTXNT   SETC  '*-*'                                          @D66CDCS          
.SEC70   AIF   ('&C(&IXCUR)' NE '&C(&IXNXT)').SEC80                     00515000
         AIF   (&GROUPSW EQ 1).SEC440                                   00516000
&I(&IXCUR) SETC  'INITIAL'                                              00517000
&GROUPSW  SETB  1                                                       00518000
         AGO   .SEC440                                                  00519000
.SEC80   ANOP                                                           00520000
         AIF   ('&C(&IXCUR)' EQ 'K').SEC81                     @D64CDCS 00521000
         AIF   ('&C(&IXCUR)' EQ 'L').SEC82                     @D66CDCS 00521000
.SEC81   ANOP                                                           00522000
&TXNT    SETC  'TXNTAB'       TRANSACTION TABLE                @D64CDCS 00523000
         AGO   .SEC90                                                   00524000
.SEC82   ANOP                                                           00522000
&GTXNT   SETC  'GTXNTAB'      GENERIC TRANSACTION TABLE        @D66CDCS 00523000
         AGO   .SEC90                                                   00524000
.SEC90   ANOP                                                           00525000
&I(&IXCUR) SETC  'FINAL'                                                00526000
&GROUPSW  SETB  0                                                       00527000
.SEC440  AIF   (&ENDSW EQ 1).SEC105                                     00528000
&IXCUR   SETA  &IXCUR+1                                                 00529000
&IXNXT   SETA  &IXCUR+1                                                 00530000
         AIF   ('&N(&IXNXT)' NE 'ELBAT FO DNE').SEC70                   00531000
&ENDSW   SETB  1                                                        00532000
         AGO   .SEC70                                                   00533000
.SEC105  ANOP                                                           00534000
.*       NOTE:  THE DOS/VSE TRANSACTION CONTROL MODULES DTSECTRN        00535000
.*              AND THE APTYP OF THE MACRO DTSAPL ARE                   00536000
.*              DEPENDENT UPON THE FORMAT OF THE FOLLOWING TABLE        00537000
.*              HEADER.                                                 00538000
         DC    CL8'DTSECTXN'            TABLE IDENTIFIER                00539000
         DC    CL4'0106'                TABLE VERSION          @D66CDCS 00540000
         DC    A(&TXNT)     TRANSACTION TABLE                  @D64CDCS 00541000
         DC    A(&GTXNT)    GENERIC TRANSACTION TABLE          @D66CDCS 00542000
         DC    A(&TXNT)     *********** RESERVED **********    @D64CDCS 00543000
         DC    A(&TXNT)     *********** RESERVED **********    @D64CDCS 00544000
         DC    A(&TXNT)     *********** RESERVED **********    @D64CDCS 00545000
         DC    A(&TXNT)     *********** RESERVED **********    @D64CDCS 00546000
         DC    A(&TXNT)     *********** RESERVED **********    @D64CDCS 00547000
         DC    A(-1)        END OF VECTOR TABLE                         00548000
.SEC110  ANOP                                                           00549000
         ACTR  20000                                           @DA45424 00550000
         AIF   ('&NO' NE '&N(&IX)').SEC113                              00551000
         AIF   ('&CO' NE '&C(&IX)').SEC113                              00552000
&LCA1    SETA 1                                                         00553000
&LCC2    SETC ' '                                                       00554000
&NO      SETC '&NO&LCC2'                                                00555000
.SEC111  AIF   ('&NO'(&LCA1,1) EQ ' ').SEC112                           00556000
         AIF   ('&NO'(&LCA1,1) EQ '').SEC112                            00557000
&LCA1    SETA   &LCA1+1                                                 00558000
         AGO   .SEC111                                                  00559000
.SEC112  ANOP                                                           00560000
&LCA1    SETA  &LCA1-1                                                  00561000
&LCC1    SETC  '&NO'(1,12)                                   @D64CDCS   00562000
  MNOTE 4,'''&LCC1'' IS A DUPLICATE NAMED RESOURCE TABLE ENTRY'         00563000
  MNOTE 4,'***ONLY THE FIRST ENTRY OF THE DUPLICATE NAMED RESOURCE IS UX00564000
               SED'                                                     00565000
  MNOTE 4,'FOR ACCESS VALIDATION***'                                    00566000
.*                                                                      00567000
.*       LOOP THRU ARRAYS GENERATING TABLE ENTRIES                      00568000
.*                                                                      00569000
.SEC113  ANOP                                                           00570000
&CO      SETC '&C(&IX)'                 GROUP SUB-TYPE                  00571000
&IO      SETC '&I(&IX)'                 GROUP SUB-CODE                  00572000
&XLOG    SETC '&L(&IX)'                 LOGGING OPTIONS                 00573000
&NO      SETC '&N(&IX)'                 NAME                            00574000
&XACC    SETC '&S(&IX)'                 ACCESS CLASSES                  00575000
&TO      SETC '&T(&IX)'                 TYPE                            00576000
         DTSECTIN XIND=&CO,XNAME=&NO,XSUB=&IO,XTYPE=&TO    @D64CDCS     00577000
.SEC117  ANOP                                                           00578000
&IX      SETA  &IX+1                                                    00579000
         AIF    ('&N(&IX)' NE 'ELBAT FO DNE').SEC110                    00580000
         AGO   .MEXIT00                                                 00581000
.*                                                                      00582000
.*       DTSECTXN ERROR EXITS                                           00583000
.*                                                                      00584000
.ERR00   ANOP                                                           00585000
  MNOTE 4,'MORE THAN ONE SUBTYPE=INITIAL SPECIFIED'                     00586000
         AGO   .ERR99                                                   00587000
.ERR10   ANOP                                                           00588000
  MNOTE 12,'NO TABLE EXPANSION, SUBTYPE=INITIAL NOT SPECIFIED'          00589000
&LOGSW   SETB  1                                                        00590000
         AGO   .ERR99                                                   00591000
.ERR15   ANOP                                                 @D64CDCS  00592000
  MNOTE 4,'DTSECTXN MAC DEFINITION AFTER TYPE=FINAL DETECTED' @D64CDCS  00593000
&LOGSW   SETB  1                                              @D64CDCS  00594000
         AGO   .MEXIT10                                       @D64CDCS  00595000
.ERR20   ANOP                                                           00596000
  MNOTE 4,'SUBTYPE=FINAL WITHOUT SUBTYPE=INITIAL'                       00597000
         AGO  .ERR99                                                    00598000
.ERR30   ANOP                                                           00599000
  MNOTE 4,'MORE THAN ONE SUBTYPE=FINAL SPECIFIED'                       00600000
&LOGSW   SETB  1                                              @D64CDCS  00601000
         AGO  .MEXIT10                                        @D64CDCS  00602000
.ERR40   ANOP                                                           00603000
  MNOTE 4,'ARRAY OVERFLOW, MAXIMUM TABLE SOURCE STATEMENTS ALLOWED IS &X00604000
               MAX'                                                     00605000
  MNOTE 4,'CONTACT SYSTEM ADMINISTRATOR TO UPDATE DTSECTXN MAC SOURCE'  00606000
.ERR99   ANOP                                                           00607000
&ABSW    SETB  1                                                        00608000
         MEXIT                                                          00609000
.*                                                                      00610000
.*       DTSECTXN GENERAL EXIT                                          00611000
.*                                                                      00612000
.MEXIT00 ANOP                                                           00613000
         SPACE 5                                                        00614000
         AIF   (&ABSW EQ 0 AND &WARNSW EQ 0).MEXIT                      00615000
         AIF   (&ABSW EQ 0).MEXIT10                                     00616000
.MEXIT05 ANOP                                                           00617000
  MNOTE 12,'***ERROR*** TABLE EXPANSION UNUSABLE, SEE MNOTES ABOVE'     00618000
         MEXIT                                                          00619000
.MEXIT10 ANOP                                                           00620000
  MNOTE 8,'*WARNING* TABLE EXPANSION MAY BE UNUSABLE, SEE MNOTES ABOVE' 00621000
.MEXIT   MEXIT                                                          00622000
         MEND                                                           00623000
