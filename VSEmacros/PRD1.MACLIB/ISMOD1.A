.* IBM DISK OPERATING SYSTEM                                            00050000
.* ISFMS - ISMOD1 - 5686-007-02-C440                           @U31TUJS 00100000
.* COPYRIGHT = THIS MACRO IS "RESTRICTED MATERIALS OF IBM"     @D41TDKY 00150000
.*             5686-007 (C) COPYRIGHT IBM CORP. 1977,1989      @U31TUJS 00200000
.*             ALL RIGHTS RESERVED                             @U31TUJS 00250000
.*             LICENSED MATERIALS - PROPERTY OF IBM            @U31TUJS 00300000
.*             SEE COPYRIGHT INSTRUCTIONS, G120-2083           @U31TUJS 00350000
* ISFMS - ISMOD1 - 5686-007-02-C440                            @U31TUJS 00400000
         AIF   ('&NAME' EQ '').BM                                   3-9 00450000
&NAME    CSECT                                                          00500000
         AGO   .CR                                                  3-4 00550000
.BM      ANOP                                                       3-9 00600000
IJH&NM(1)&NM(2)&NM(3)&NM(4)&NM(5)  CSECT                                00650000
         AIF   (NOT &SW(25)).BN                                     3-4 00700000
         ENTRY IJH&NM(1)&NM(2).S&NM(4)&NM(5)                        3-4 00750000
IJH&NM(1)&NM(2).S&NM(4)&NM(5)  EQU *                                3-4 00800000
         AIF   ('&NM(7)' EQ '&NM(4)').BO                            3-9 00850000
         ENTRY IJH&NM(1)&NM(2).S&NM(7)&NM(5)                        3-9 00900000
IJH&NM(1)&NM(2).S&NM(7)&NM(5)  EQU *                                3-9 00950000
.BN      AIF   ('&NM(7)' EQ '&NM(4)').BO                            3-9 01000000
         ENTRY IJH&NM(1)&NM(2)&NM(3)&NM(7)&NM(5)                    3-9 01050000
IJH&NM(1)&NM(2)&NM(3)&NM(7)&NM(5)  EQU *                            3-9 01100000
.BO      AIF   ('&NM(5)' EQ '&NM(6)').BQ                            3-9 01150000
         ENTRY IJH&NM(1)&NM(2)&NM(3)&NM(4)&NM(6)                    3-4 01200000
IJH&NM(1)&NM(2)&NM(3)&NM(4)&NM(6) EQU *                             3-4 01250000
         AIF   (NOT &SW(25)).BP                                     3-9 01300000
         ENTRY IJH&NM(1)&NM(2).S&NM(4)&NM(6)                        3-4 01350000
IJH&NM(1)&NM(2).S&NM(4)&NM(6)  EQU *                                3-4 01400000
.BP      AIF   ('&NM(7)' EQ '&NM(4)').BQ                            3-9 01450000
         ENTRY IJH&NM(1)&NM(2)&NM(3)&NM(7)&NM(6)                    3-9 01500000
IJH&NM(1)&NM(2)&NM(3)&NM(7)&NM(6)  EQU *                            3-9 01550000
         AIF   (NOT &SW(25)).BQ                                     3-9 01600000
         ENTRY IJH&NM(1)&NM(2).S&NM(7)&NM(6)                        3-9 01650000
IJH&NM(1)&NM(2).S&NM(7)&NM(6)  EQU *                                3-9 01700000
.BQ      AIF   (&SW(4)).BU             ADDRTR                       3-9 01750000
         AIF   (&SW(2)).BS             ADD                          3-9 01800000
         AIF   (NOT &SW(10)).CR        RANSEQ                       3-9 01850000
         ENTRY IJHZ&B(4).R&NM(7)&NM(5),IJHZ&B(4).S&NM(7)&NM(5) @DL30SMP 01900000
IJHZ&B(4).R&NM(7)&NM(5)  EQU *                                 @DL30SMP 01950000
IJHZ&B(4).S&NM(7)&NM(5)  EQU *                                 @DL30SMP 02000000
         AIF   ('&NM(7)' EQ '&NM(4)').BR                            3-9 02050000
         ENTRY IJHZ&B(4).R&NM(4)&NM(5)                         @DL30SMP 02100000
IJHZ&B(4).R&NM(4)&NM(5)  EQU *                                 @DL30SMP 02150000
         AIF   ('&NM(5)' EQ '&NM(6)').CR                            3-9 02200000
         ENTRY IJHZ&B(4).R&NM(4)&NM(6)                         @DL30SMP 02250000
IJHZ&B(4).R&NM(4)&NM(6)  EQU *                                 @DL30SMP 02300000
.BR      AIF   ('&NM(5)' EQ '&NM(6)').CR                            3-9 02350000
         ENTRY IJHZ&B(4).R&NM(7)&NM(6),IJHZ&B(4).S&NM(7)&NM(6) @DL30SMP 02400000
IJHZ&B(4).R&NM(7)&NM(6)  EQU *                                 @DL30SMP 02450000
IJHZ&B(4).S&NM(7)&NM(6)  EQU *                                 @DL30SMP 02500000
         AGO   .CR                                                  3-9 02550000
.BS      AIF   (NOT &SW(7)).CR                                      3-9 02600000
         ENTRY IJHU&B(2).Z&NM(7)&NM(5),IJHB&B(2).Z&NM(7)&NM(5) @DL30SMP 02650000
IJHU&B(2).Z&NM(7)&NM(5)  EQU *                                 @DL30SMP 02700000
IJHB&B(2).Z&NM(7)&NM(5)  EQU *                                 @DL30SMP 02750000
         AIF   ('&NM(7)' EQ '&NM(4)').BT                            3-9 02800000
         ENTRY IJHU&B(2).Z&NM(4)&NM(5),IJHB&B(2).Z&NM(4)&NM(5) @DL30SMP 02850000
IJHU&B(2).Z&NM(4)&NM(5)  EQU *                                 @DL30SMP 02900000
IJHB&B(2).Z&NM(4)&NM(5)  EQU *                                 @DL30SMP 02950000
         AIF   ('&NM(5)' EQ '&NM(6)').CR                            3-9 03000000
         ENTRY IJHU&B(2).Z&NM(4)&NM(6),IJHB&B(2).Z&NM(4)&NM(6) @DL30SMP 03050000
IJHU&B(2).Z&NM(4)&NM(6)  EQU *                                 @DL30SMP 03100000
IJHB&B(2).Z&NM(4)&NM(6)  EQU *                                 @DL30SMP 03150000
.BT      AIF   ('&NM(5)' EQ '&NM(6)').CR                            3-9 03200000
         ENTRY IJHU&B(2).Z&NM(7)&NM(6),IJHB&B(2).Z&NM(7)&NM(6) @DL30SMP 03250000
IJHU&B(2).Z&NM(7)&NM(6)  EQU *                                 @DL30SMP 03300000
IJHB&B(2).Z&NM(7)&NM(6)  EQU *                                 @DL30SMP 03350000
         AGO   .CR                                                  3-9 03400000
.BU      AIF   (NOT &SW(10)).B4        RANSEQ - PROCESS             3-9 03450000
         AIF   (NOT &SW(7)).BW         BOTH FIXBLK AND FIXUNB       3-9 03500000
         ENTRY IJHA&B(2).Z&NM(7)&NM(5),IJHA&B(1).R&NM(7)&NM(5) @DL30SMP 03550000
         ENTRY IJHA&B(1).S&NM(7)&NM(5),IJHB&B(1).B&NM(7)&NM(5) @DL30SMP 03600000
         ENTRY IJHU&B(1).B&NM(7)&NM(5)                         @DL30SMP 03650000
IJHA&B(2).Z&NM(7)&NM(5)  EQU  *                                @DL30SMP 03700000
IJHA&B(1).R&NM(7)&NM(5)  EQU  *                                @DL30SMP 03750000
IJHA&B(1).S&NM(7)&NM(5)  EQU  *                                @DL30SMP 03800000
IJHB&B(1).B&NM(7)&NM(5)  EQU  *                                @DL30SMP 03850000
IJHU&B(1).B&NM(7)&NM(5)  EQU  *                                @DL30SMP 03900000
         AIF   ('&NM(7)' EQ '&NM(4)').BV                            3-9 03950000
         ENTRY IJHA&B(2).Z&NM(4)&NM(5),IJHA&B(1).R&NM(4)&NM(5) @DL30SMP 04000000
         ENTRY IJHA&B(1).S&NM(4)&NM(5),IJHB&B(1).B&NM(4)&NM(5) @DL30SMP 04050000
         ENTRY IJHU&B(1).B&NM(4)&NM(5)                         @DL30SMP 04100000
IJHA&B(2).Z&NM(4)&NM(5)  EQU  *                                @DL30SMP 04150000
IJHA&B(1).R&NM(4)&NM(5)  EQU  *                                @DL30SMP 04200000
IJHA&B(1).S&NM(4)&NM(5)  EQU  *                                @DL30SMP 04250000
IJHB&B(1).B&NM(4)&NM(5)  EQU  *                                @DL30SMP 04300000
IJHU&B(1).B&NM(4)&NM(5)  EQU  *                                @DL30SMP 04350000
         AIF   ('&NM(5)' EQ '&NM(6)').BX                            3-9 04400000
         ENTRY IJHA&B(2).Z&NM(4)&NM(6),IJHA&B(1).R&NM(4)&NM(6) @DL30SMP 04450000
         ENTRY IJHA&B(1).S&NM(4)&NM(6),IJHB&B(1).B&NM(4)&NM(6) @DL30SMP 04500000
         ENTRY IJHU&B(1).B&NM(4)&NM(6)                         @DL30SMP 04550000
IJHA&B(2).Z&NM(4)&NM(6)  EQU  *                                @DL30SMP 04600000
IJHA&B(1).R&NM(4)&NM(6)  EQU  *                                @DL30SMP 04650000
IJHA&B(1).S&NM(4)&NM(6)  EQU  *                                @DL30SMP 04700000
IJHB&B(1).B&NM(4)&NM(6)  EQU  *                                @DL30SMP 04750000
IJHU&B(1).B&NM(4)&NM(6)  EQU  *                                @DL30SMP 04800000
.BV      AIF   ('&NM(5)' EQ '&NM(6)').BX                            3-9 04850000
         ENTRY IJHA&B(2).Z&NM(7)&NM(6),IJHA&B(1).R&NM(7)&NM(6) @DL30SMP 04900000
         ENTRY IJHA&B(1).S&NM(7)&NM(6),IJHB&B(1).B&NM(7)&NM(6) @DL30SMP 04950000
         ENTRY IJHU&B(1).B&NM(7)&NM(6)                         @DL30SMP 05000000
IJHA&B(2).Z&NM(7)&NM(6)  EQU  *                                @DL30SMP 05050000
IJHA&B(1).R&NM(7)&NM(6)  EQU  *                                @DL30SMP 05100000
IJHA&B(1).S&NM(7)&NM(6)  EQU  *                                @DL30SMP 05150000
IJHB&B(1).B&NM(7)&NM(6)  EQU  *                                @DL30SMP 05200000
IJHU&B(1).B&NM(7)&NM(6)  EQU  *                                @DL30SMP 05250000
         AGO   .BX                     SKIP FIXBLK CHECK            3-9 05300000
.BW      AIF   (NOT &SW(6)).B0         FIXBLK                       3-9 05350000
.BX      ENTRY IJHB&B(1).R&NM(7)&NM(5),IJHB&B(1).S&NM(7)&NM(5) @DL30SMP 05400000
         ENTRY IJHB&B(2).Z&NM(7)&NM(5)                         @DL30SMP 05450000
IJHB&B(1).R&NM(7)&NM(5)  EQU  *                                @DL30SMP 05500000
IJHB&B(1).S&NM(7)&NM(5)  EQU  *                                @DL30SMP 05550000
IJHB&B(2).Z&NM(7)&NM(5)  EQU  *                                @DL30SMP 05600000
         AIF   ('&NM(7)' EQ '&NM(4)').BY                            3-9 05650000
         ENTRY IJHB&B(1).R&NM(4)&NM(5),IJHB&B(1).S&NM(4)&NM(5) @DL30SMP 05700000
         ENTRY IJHB&B(2).Z&NM(4)&NM(5)                         @DL30SMP 05750000
IJHB&B(1).R&NM(4)&NM(5)  EQU  *                                @DL30SMP 05800000
IJHB&B(1).S&NM(4)&NM(5)  EQU  *                                @DL30SMP 05850000
IJHB&B(2).Z&NM(4)&NM(5)  EQU  *                                @DL30SMP 05900000
         AIF   ('&NM(5)' EQ '&NM(6)').BZ                            3-9 05950000
         ENTRY IJHB&B(1).R&NM(4)&NM(6),IJHB&B(1).S&NM(4)&NM(6) @DL30SMP 06000000
         ENTRY IJHB&B(2).Z&NM(4)&NM(6)                         @DL30SMP 06050000
IJHB&B(1).R&NM(4)&NM(6)  EQU  *                                @DL30SMP 06100000
IJHB&B(1).S&NM(4)&NM(6)  EQU  *                                @DL30SMP 06150000
IJHB&B(2).Z&NM(4)&NM(6)  EQU  *                                @DL30SMP 06200000
.BY      AIF   ('&NM(5)' EQ '&NM(6)').BZ                            3-9 06250000
         ENTRY IJHB&B(1).R&NM(7)&NM(6),IJHB&B(1).S&NM(7)&NM(6) @DL30SMP 06300000
         ENTRY IJHB&B(2).Z&NM(7)&NM(6)                         @DL30SMP 06350000
IJHB&B(1).R&NM(7)&NM(6)  EQU  *                                @DL30SMP 06400000
IJHB&B(1).S&NM(7)&NM(6)  EQU  *                                @DL30SMP 06450000
IJHB&B(2).Z&NM(7)&NM(6)  EQU  *                                @DL30SMP 06500000
.BZ      AIF   (NOT &SW(7)).B2         IF BOTH FALL THROUGH         3-9 06550000
.B0      ENTRY IJHU&B(1).R&NM(7)&NM(5),IJHU&B(1).S&NM(7)&NM(5) @DL30SMP 06600000
         ENTRY IJHU&B(2).Z&NM(7)&NM(5)                         @DL30SMP 06650000
IJHU&B(1).R&NM(7)&NM(5)  EQU  *                                @DL30SMP 06700000
IJHU&B(1).S&NM(7)&NM(5)  EQU  *                                @DL30SMP 06750000
IJHU&B(2).Z&NM(7)&NM(5)  EQU  *                                @DL30SMP 06800000
         AIF   ('&NM(7)' EQ '&NM(4)').B1                            3-9 06850000
         ENTRY IJHU&B(1).R&NM(4)&NM(5),IJHU&B(1).S&NM(4)&NM(5) @DL30SMP 06900000
         ENTRY IJHU&B(2).Z&NM(4)&NM(5)                         @DL30SMP 06950000
IJHU&B(1).R&NM(4)&NM(5)  EQU  *                                @DL30SMP 07000000
IJHU&B(1).S&NM(4)&NM(5)  EQU  *                                @DL30SMP 07050000
IJHU&B(2).Z&NM(4)&NM(5)  EQU  *                                @DL30SMP 07100000
         AIF   ('&NM(5)' EQ '&NM(6)').B2                            3-9 07150000
         ENTRY IJHU&B(1).R&NM(4)&NM(6),IJHU&B(1).S&NM(4)&NM(6) @DL30SMP 07200000
         ENTRY IJHU&B(2).Z&NM(4)&NM(6)                         @DL30SMP 07250000
IJHU&B(1).R&NM(4)&NM(6)  EQU  *                                @DL30SMP 07300000
IJHU&B(1).S&NM(4)&NM(6)  EQU  *                                @DL30SMP 07350000
IJHU&B(2).Z&NM(4)&NM(6)  EQU  *                                @DL30SMP 07400000
.B1      AIF   ('&NM(5)' EQ '&NM(6)').B2                            3-9 07450000
         ENTRY IJHU&B(1).R&NM(7)&NM(6),IJHU&B(1).S&NM(7)&NM(6) @DL30SMP 07500000
         ENTRY IJHU&B(2).Z&NM(7)&NM(6)                         @DL30SMP 07550000
IJHU&B(1).R&NM(7)&NM(6)  EQU  *                                @DL30SMP 07600000
IJHU&B(1).S&NM(7)&NM(6)  EQU  *                                @DL30SMP 07650000
IJHU&B(2).Z&NM(7)&NM(6)  EQU  *                                @DL30SMP 07700000
.B2      ANOP                                                       3-9 07750000
         ENTRY IJHZ&B(4).B&NM(7)&NM(5),IJHZ&B(4).R&NM(7)&NM(5) @DL30SMP 07800000
         ENTRY IJHZ&B(4).S&NM(7)&NM(5)                         @DL30SMP 07850000
IJHZ&B(4).B&NM(7)&NM(5)  EQU  *                                @DL30SMP 07900000
IJHZ&B(4).R&NM(7)&NM(5)  EQU  *                                @DL30SMP 07950000
IJHZ&B(4).S&NM(7)&NM(5)  EQU  *                                @DL30SMP 08000000
         AIF   ('&NM(7)' EQ '&NM(4)').B3                            3-9 08050000
         ENTRY IJHZ&B(4).B&NM(4)&NM(5),IJHZ&B(4).R&NM(4)&NM(5) @DL30SMP 08100000
IJHZ&B(4).B&NM(4)&NM(5)  EQU  *                                @DL30SMP 08150000
IJHZ&B(4).R&NM(4)&NM(5)  EQU  *                                @DL30SMP 08200000
         AIF   ('&NM(5)' EQ '&NM(6)').CR                            3-9 08250000
         ENTRY IJHZ&B(4).B&NM(4)&NM(6),IJHZ&B(4).R&NM(4)&NM(6) @DL30SMP 08300000
IJHZ&B(4).B&NM(4)&NM(6)  EQU  *                                @DL30SMP 08350000
IJHZ&B(4).R&NM(4)&NM(6)  EQU  *                                @DL30SMP 08400000
.B3      AIF   ('&NM(5)' EQ '&NM(6)').CR                            3-9 08450000
         ENTRY IJHZ&B(4).B&NM(7)&NM(6),IJHZ&B(4).R&NM(7)&NM(6) @DL30SMP 08500000
         ENTRY IJHZ&B(4).S&NM(7)&NM(6)                         @DL30SMP 08550000
IJHZ&B(4).B&NM(7)&NM(6)  EQU  *                                @DL30SMP 08600000
IJHZ&B(4).R&NM(7)&NM(6)  EQU  *                                @DL30SMP 08650000
IJHZ&B(4).S&NM(7)&NM(6)  EQU  *                                @DL30SMP 08700000
         AGO   .CR                                                  3-9 08750000
.B4      AIF   (NOT &SW(9)).CH         NOT SEQ-IT MUST BE RANDOM    3-9 08800000
         AIF   (NOT &SW(7)).B9         BOTH                         3-9 08850000
         ENTRY IJHA&B(2).Z&NM(7)&NM(5),IJHB&B(1).S&NM(7)&NM(5) @DL30SMP 08900000
         ENTRY IJHU&B(1).S&NM(7)&NM(5)                         @DL30SMP 08950000
IJHA&B(2).Z&NM(7)&NM(5)  EQU  *                                @DL30SMP 09000000
IJHB&B(1).S&NM(7)&NM(5)  EQU  *                                @DL30SMP 09050000
IJHU&B(1).S&NM(7)&NM(5)  EQU  *                                @DL30SMP 09100000
         AIF   (NOT &SW(25)).B5        'G' ONLY IF IOAREA2          3-9 09150000
         ENTRY IJHB&B(1).G&NM(7)&NM(5),IJHU&B(1).G&NM(7)&NM(5) @DL30SMP 09200000
IJHB&B(1).G&NM(7)&NM(5)  EQU  *                                @DL30SMP 09250000
IJHU&B(1).G&NM(7)&NM(5)  EQU  *                                @DL30SMP 09300000
.B5      AIF   ('&NM(7)' EQ '&NM(4)').B7                            3-9 09350000
         ENTRY IJHA&B(2).Z&NM(4)&NM(5),IJHB&B(1).S&NM(4)&NM(5) @DL30SMP 09400000
         ENTRY IJHU&B(1).S&NM(4)&NM(5)                         @DL30SMP 09450000
IJHA&B(2).Z&NM(4)&NM(5)  EQU  *                                @DL30SMP 09500000
IJHB&B(1).S&NM(4)&NM(5)  EQU  *                                @DL30SMP 09550000
IJHU&B(1).S&NM(4)&NM(5)  EQU  *                                @DL30SMP 09600000
         AIF   (NOT &SW(25)).B6        IOAREA2                      3-9 09650000
         ENTRY IJHB&B(1).G&NM(4)&NM(5),IJHU&B(1).G&NM(4)&NM(5) @DL30SMP 09700000
IJHB&B(1).G&NM(4)&NM(5)  EQU  *                                @DL30SMP 09750000
IJHU&B(1).G&NM(4)&NM(5)  EQU  *                                @DL30SMP 09800000
.B6      AIF   ('&NM(5)' EQ '&NM(6)').CA                            3-9 09850000
         ENTRY IJHA&B(2).Z&NM(4)&NM(6),IJHB&B(1).S&NM(4)&NM(6) @DL30SMP 09900000
         ENTRY IJHU&B(1).S&NM(4)&NM(6)                         @DL30SMP 09950000
IJHA&B(2).Z&NM(4)&NM(6)  EQU  *                                @DL30SMP 10000000
IJHB&B(1).S&NM(4)&NM(6)  EQU  *                                @DL30SMP 10050000
IJHU&B(1).S&NM(4)&NM(6)  EQU  *                                @DL30SMP 10100000
         AIF   (NOT &SW(25)).B8        IOAREA2                      3-9 10150000
         ENTRY IJHB&B(1).G&NM(4)&NM(6),IJHU&B(1).G&NM(4)&NM(6) @DL30SMP 10200000
IJHB&B(1).G&NM(4)&NM(6)  EQU  *                                @DL30SMP 10250000
IJHU&B(1).G&NM(4)&NM(6)  EQU  *                                @DL30SMP 10300000
.B7      AIF   ('&NM(5)' EQ '&NM(6)').CA                            3-9 10350000
.B8      ENTRY IJHA&B(2).Z&NM(7)&NM(6),IJHB&B(1).S&NM(7)&NM(6) @DL30SMP 10400000
         ENTRY IJHU&B(1).S&NM(7)&NM(6)                         @DL30SMP 10450000
IJHA&B(2).Z&NM(7)&NM(6)  EQU  *                                @DL30SMP 10500000
IJHB&B(1).S&NM(7)&NM(6)  EQU  *                                @DL30SMP 10550000
IJHU&B(1).S&NM(7)&NM(6)  EQU  *                                @DL30SMP 10600000
         AIF   (NOT &SW(25)).CA        IOAREA2                      3-9 10650000
         ENTRY IJHB&B(1).G&NM(7)&NM(6),IJHU&B(1).G&NM(7)&NM(6) @DL30SMP 10700000
IJHB&B(1).G&NM(7)&NM(6)  EQU  *                                @DL30SMP 10750000
IJHU&B(1).G&NM(7)&NM(6)  EQU  *                                @DL30SMP 10800000
         AGO   .CA                     SKIP FIXBLK CHECK            3-9 10850000
.B9      AIF   (NOT &SW(6)).CD         FIXBLK                       3-9 10900000
.CA      ENTRY IJHB&B(2).Z&NM(7)&NM(5)                         @DL30SMP 10950000
IJHB&B(2).Z&NM(7)&NM(5)  EQU  *                                @DL30SMP 11000000
         AIF   ('&NM(7)' EQ '&NM(4)').CB                            3-9 11050000
         ENTRY IJHB&B(2).Z&NM(4)&NM(5)                         @DL30SMP 11100000
IJHB&B(2).Z&NM(4)&NM(5)  EQU  *                                @DL30SMP 11150000
         AIF   ('&NM(5)' EQ '&NM(6)').CC                            3-9 11200000
         ENTRY IJHB&B(2).Z&NM(4)&NM(6)                         @DL30SMP 11250000
IJHB&B(2).Z&NM(4)&NM(6)  EQU  *                                @DL30SMP 11300000
.CB      AIF   ('&NM(5)' EQ '&NM(6)').CC                            3-9 11350000
         ENTRY IJHB&B(2).Z&NM(7)&NM(6)                         @DL30SMP 11400000
IJHB&B(2).Z&NM(7)&NM(6)  EQU  *                                @DL30SMP 11450000
.CC      AIF   (NOT &SW(7)).CF         BOTH                         3-9 11500000
.CD      ENTRY IJHU&B(2).Z&NM(7)&NM(5)                         @DL30SMP 11550000
IJHU&B(2).Z&NM(7)&NM(5)  EQU  *                                @DL30SMP 11600000
         AIF   ('&NM(7)' EQ '&NM(4)').CE                            3-9 11650000
         ENTRY IJHU&B(2).Z&NM(4)&NM(5)                         @DL30SMP 11700000
IJHU&B(2).Z&NM(4)&NM(5)  EQU  *                                @DL30SMP 11750000
         AIF   ('&NM(5)' EQ '&NM(6)').CF                            3-9 11800000
         ENTRY IJHU&B(2).Z&NM(4)&NM(6)                         @DL30SMP 11850000
IJHU&B(2).Z&NM(4)&NM(6)  EQU  *                                @DL30SMP 11900000
.CE      AIF   ('&NM(5)' EQ '&NM(6)').CF                            3-9 11950000
         ENTRY IJHU&B(2).Z&NM(7)&NM(6)                         @DL30SMP 12000000
IJHU&B(2).Z&NM(7)&NM(6)  EQU  *                                @DL30SMP 12050000
.CF      ANOP                                                       3-9 12100000
         ENTRY IJHZ&B(4).S&NM(7)&NM(5)                         @DL30SMP 12150000
IJHZ&B(4).S&NM(7)&NM(5)  EQU  *                                @DL30SMP 12200000
         AIF   (NOT &SW(25)).CG        IOAREA2                      3-9 12250000
         ENTRY IJHZ&B(4).G&NM(7)&NM(5)                         @DL30SMP 12300000
IJHZ&B(4).G&NM(7)&NM(5)  EQU  *                                @DL30SMP 12350000
.CG      AIF   ('&NM(5)' EQ '&NM(6)').CR                            3-9 12400000
         ENTRY IJHZ&B(4).S&NM(7)&NM(6)                         @DL30SMP 12450000
IJHZ&B(4).S&NM(7)&NM(6)  EQU  *                                @DL30SMP 12500000
         AIF   (NOT &SW(25)).CR        IOAREA2                      3-9 12550000
         ENTRY IJHZ&B(4).G&NM(7)&NM(6)                         @DL30SMP 12600000
IJHZ&B(4).G&NM(7)&NM(6)  EQU  *                                @DL30SMP 12650000
         AGO   .CR                                                  3-9 12700000
.CH      AIF   (NOT &SW(7)).CJ         FIXBLK                       3-9 12750000
         ENTRY IJHA&B(2).Z&NM(7)&NM(5),IJHB&B(1).R&NM(7)&NM(5) @DL30SMP 12800000
         ENTRY IJHU&B(1).R&NM(7)&NM(5)                         @DL30SMP 12850000
IJHA&B(2).Z&NM(7)&NM(5)  EQU  *                                @DL30SMP 12900000
IJHB&B(1).R&NM(7)&NM(5)  EQU  *                                @DL30SMP 12950000
IJHU&B(1).R&NM(7)&NM(5)  EQU  *                                @DL30SMP 13000000
         AIF   ('&NM(7)' EQ '&NM(4)').CI                            3-9 13050000
         ENTRY IJHA&B(2).Z&NM(4)&NM(5),IJHB&B(1).R&NM(4)&NM(5) @DL30SMP 13100000
         ENTRY IJHU&B(1).R&NM(4)&NM(5)                         @DL30SMP 13150000
IJHA&B(2).Z&NM(4)&NM(5)  EQU  *                                @DL30SMP 13200000
IJHB&B(1).R&NM(4)&NM(5)  EQU  *                                @DL30SMP 13250000
IJHU&B(1).R&NM(4)&NM(5)  EQU  *                                @DL30SMP 13300000
         AIF   ('&NM(5)' EQ '&NM(6)').CK                            3-9 13350000
         ENTRY IJHA&B(2).Z&NM(4)&NM(6),IJHB&B(1).R&NM(4)&NM(6) @DL30SMP 13400000
         ENTRY IJHU&B(1).R&NM(4)&NM(6)                         @DL30SMP 13450000
IJHA&B(2).Z&NM(4)&NM(6)  EQU  *                                @DL30SMP 13500000
IJHB&B(1).R&NM(4)&NM(6)  EQU  *                                @DL30SMP 13550000
IJHU&B(1).R&NM(4)&NM(6)  EQU  *                                @DL30SMP 13600000
.CI      AIF   ('&NM(5)' EQ '&NM(6)').CK                            3-9 13650000
         ENTRY IJHA&B(2).Z&NM(7)&NM(6),IJHB&B(1).R&NM(7)&NM(6) @DL30SMP 13700000
         ENTRY IJHU&B(1).R&NM(7)&NM(6)                         @DL30SMP 13750000
IJHA&B(2).Z&NM(7)&NM(6)  EQU  *                                @DL30SMP 13800000
IJHB&B(1).R&NM(7)&NM(6)  EQU  *                                @DL30SMP 13850000
IJHU&B(1).R&NM(7)&NM(6)  EQU  *                                @DL30SMP 13900000
         AGO   .CK                     SKIP FIXBLK CHECK            3-9 13950000
.CJ      AIF   (NOT &SW(6)).CN         BOTH                         3-9 14000000
.CK      ENTRY IJHB&B(2).Z&NM(7)&NM(5)                         @DL30SMP 14050000
IJHB&B(2).Z&NM(7)&NM(5)  EQU  *                                @DL30SMP 14100000
         AIF   ('&NM(7)' EQ '&NM(4)').CL                            3-9 14150000
         ENTRY IJHB&B(2).Z&NM(4)&NM(5)                         @DL30SMP 14200000
IJHB&B(2).Z&NM(4)&NM(5)  EQU  *                                @DL30SMP 14250000
         AIF   ('&NM(5)' EQ '&NM(6)').CM                            3-9 14300000
         ENTRY IJHB&B(2).Z&NM(4)&NM(6)                         @DL30SMP 14350000
IJHB&B(2).Z&NM(4)&NM(6)  EQU  *                                @DL30SMP 14400000
.CL      AIF   ('&NM(5)' EQ '&NM(6)').CM                            3-9 14450000
         ENTRY IJHB&B(2).Z&NM(7)&NM(6)                         @DL30SMP 14500000
IJHB&B(2).Z&NM(7)&NM(6)  EQU  *                                @DL30SMP 14550000
.CM      AIF   (NOT &SW(7)).CP         FIXBLK                       3-9 14600000
.CN      ENTRY IJHU&B(2).Z&NM(7)&NM(5)                         @DL30SMP 14650000
IJHU&B(2).Z&NM(7)&NM(5)  EQU  *                                @DL30SMP 14700000
         AIF   ('&NM(7)' EQ '&NM(4)').CO                            3-9 14750000
         ENTRY IJHU&B(2).Z&NM(4)&NM(5)                         @DL30SMP 14800000
IJHU&B(2).Z&NM(4)&NM(5)  EQU  *                                @DL30SMP 14850000
         AIF   ('&NM(5)' EQ '&NM(6)').CP                            3-9 14900000
         ENTRY IJHU&B(2).Z&NM(4)&NM(6)                         @DL30SMP 14950000
IJHU&B(2).Z&NM(4)&NM(6)  EQU  *                                @DL30SMP 15000000
.CO      AIF   ('&NM(5)' EQ '&NM(6)').CP                            3-9 15050000
         ENTRY IJHU&B(2).Z&NM(7)&NM(6)                         @DL30SMP 15100000
IJHU&B(2).Z&NM(7)&NM(6)  EQU  *                                @DL30SMP 15150000
.CP      ANOP                                                       3-9 15200000
         ENTRY IJHZ&B(4).R&NM(7)&NM(5)                         @DL30SMP 15250000
IJHZ&B(4).R&NM(7)&NM(5)  EQU  *                                @DL30SMP 15300000
         AIF   ('&NM(7)' EQ '&NM(4)').CQ                            3-9 15350000
         ENTRY IJHZ&B(4).R&NM(4)&NM(5)                         @DL30SMP 15400000
IJHZ&B(4).R&NM(4)&NM(5)  EQU  *                                @DL30SMP 15450000
         AIF   ('&NM(5)' EQ '&NM(6)').CR                            3-9 15500000
         ENTRY IJHZ&B(4).R&NM(4)&NM(6)                         @DL30SMP 15550000
IJHZ&B(4).R&NM(4)&NM(6)  EQU  *                                @DL30SMP 15600000
.CQ      AIF   ('&NM(5)' EQ '&NM(6)').CR                            3-9 15650000
         ENTRY IJHZ&B(4).R&NM(7)&NM(6)                         @DL30SMP 15700000
IJHZ&B(4).R&NM(7)&NM(6)  EQU  *                                @DL30SMP 15750000
.CR      ANOP                                                       3-9 15800000
IJHREG0  EQU   0                       REGISTER 0                   3-9 15850000
IJHREG1  EQU   1                       REGISTER 1                   3-9 15900000
IJHREG2  EQU   2                       REGISTER 2                   3-9 15950000
IJHREG4  EQU   4                       REGISTER 4                   3-9 16000000
IJHREG5  EQU   5                       REGISTER 5                   3-9 16050000
IJHREG7  EQU   7                       REGISTER 7                   3-9 16100000
IJHREG8  EQU   8                       REGISTER 8                   3-9 16150000
IJHREG9  EQU   9                       REGISTER 9                   3-9 16200000
IJHREG10 EQU   10                      REGISTER 10                  3-9 16250000
IJHREG11 EQU   11                      REGISTER 11                  3-9 16300000
IJHREG12 EQU   12                      REGISTER 12                  3-9 16350000
IJHREG13 EQU   13                      REGISTER 13                  3-9 16400000
IJHREG14 EQU   14                      REGISTER 14                  3-9 16450000
IJHREG15 EQU   15                      REGISTER 15                  3-9 16500000
IJHZERO  EQU   0                       OPERAND FOR RR INSTRUCTIONS  3-9 16550000
IJH0     EQU   0                       OPERAND FOR LA INST'S   @DL30SMP 16600000
IJHD8    EQU   8                       DISPLACEMENT OF 8       @DL30SMP 16650000
IJHDL8   EQU   8                       CONSTANT OF 8                3-9 16700000
IJHDL44  EQU   44                      CONSTANT OF 44               3-9 16750000
IJHDL48  EQU   48                      CONSTANT OF 48               3-9 16800000
IJHSVC50 EQU   50                      ILLEGAL SVC 50               3-9 16850000
IJHSKSW  EQU   X'01'                   SEEK SWITCH BIT              3-9 16900000
IJHFILBK EQU   X'01'                   FILLED BLOCK INDICATOR       3-9 16950000
IJHWRTSW EQU   X'02'                   WRITE ISSUED INDICATOR       3-9 17000000
IJHRCYLX EQU   X'22'                   INDICATE READ CYL INDEX      3-9 17050000
IJHGETSW EQU   X'40'                   GET ISSUED SWITCH            3-9 17100000
IJHWAITF EQU   X'80'                   WAITF INDICATOR              3-9 17150000
IJHERREX EQU   X'10'                   ERREXT DTF                   3-9 17200000
IJHNOVFL EQU   X'FF'                   INDICATE END OF OVFL CHAIN   3-9 17250000
IJHVD24  EQU   24                      DISPLACEMENT OF 24      @DL30SMP 17300000
IJHVD32  EQU   32                      DISPLACEMENT OF 32      @DM08009 17350000
IJHVD56  EQU   56                      DISPLACEMENT OF 56      @DL30SMP 17400000
         AIF   (NOT &SW(11)).CR1                                    3-9 17450000
IJHDL1   EQU   1                       CONSTANT OF 1                3-9 17500000
IJHDL2   EQU   2                       CONSTANT OF 2                3-9 17550000
IJHDL3   EQU   3                       CONSTANT OF 3                3-9 17600000
IJHDL7   EQU   7                       CONSTANT OF 7                3-9 17650000
IJHM4    EQU   2                       MULTIPLICATION BY 4          3-9 17700000
IJHSVC7  EQU   7                       WAIT SVC 7                   3-9 17750000
IJHSVC35 EQU   35                      READ/HOLD SVC 35             3-9 17800000
IJHSVC36 EQU   36                      FREE SVC 36                  3-9 17850000
IJHIOA2  EQU   X'01'                   INDICATE 2 I/O AREAS         3-9 17900000
IJHGETOV EQU   X'02'                   SWITCH FOR OVERFLOW GET      3-9 17950000
IJHIO2US EQU   X'02'                   INDICATE IOAREA2 JUST USED   3-9 18000000
IJHOVFL  EQU   X'04'                   OVERFLOW SWITCH              3-9 18050000
IJHBLKD  EQU   X'08'                   INDICATE BLOCKED FILE        3-9 18100000
IJHFIRST EQU   X'08'                   FIRST TIME SWITCH            3-9 18150000
IJHRDWRK EQU   X'12'                   READ, WRITE KEY BITS         3-9 18200000
IJHOVIND EQU   X'20'                   READ OVFL RECORD SWITCH      3-9 18250000
IJHWTBIT EQU   X'80'                   TRAFFIC BIT IN CCB           3-9 18300000
IJHRDERR EQU   X'D0'                   READ ERROR BITS              3-9 18350000
IJHINVAL EQU   X'FF'                   INVALID LOGICAL UNIT         3-9 18400000
.CR1     ANOP                                                       3-9 18450000
         AIF   (NOT &SW(15)).CR2       RPS NOT SPECIFIED       @DL30SMP 18500000
IJHCCCW  EQU   IJHVCCW                 BUILD AREA FOR CCW'S    @DL30SMP 18550000
IJHREG6  EQU   6                       REGISTER 6              @DL30SMP 18600000
IJHSKCCB EQU   IJHVKCCB                CCB FOR OVERSEEK TEST   @DL30SMP 18650000
IJHSKCCW EQU   IJHVKCCW                AREA FOR OVERSEEK CCW'S @DL30SMP 18700000
IJHSVC75 EQU   75                      SVC 75 (CACUL SEC ARG)  @DL30SMP 18750000
IJHVARGF EQU   X'03'                   SAVE SEC ARG FIELD #    @DL30SMP 18800000
IJHVCCF  EQU   X'40'                   COMMAND CHAINING FLAG   @DL30SMP 18850000
IJHVCD   EQU   X'C0'                   COMMAND & DATA CHAINING @DL30SMP 18900000
*                                      SWITCHES OFF IN CCW     @DL30SMP 18950000
IJHVC1   EQU   1                       ADD VALUE FOR LA (1)    @DL30SMP 19000000
IJHVCD14 EQU   14                      CONDITION CODE 14       @DL30SMP 19050000
IJHVD0   EQU   0                       DISPLACEMENT OF 0       @DL30SMP 19100000
IJHVD1   EQU   1                       DISPLACEMENT OF 1       @DL30SMP 19150000
IJHVD2   EQU   2                       DISPLACEMENT OF 2       @DL30SMP 19200000
IJHVD3   EQU   3                       DISPLACEMENT OF 3       @DL30SMP 19250000
IJHVD4   EQU   4                       DISPLACEMENT OF 4       @DL30SMP 19300000
IJHVD5   EQU   5                       DISPLACEMENT OF 5       @DL30SMP 19350000
IJHVD8   EQU   8                       DISPLACEMENT OF 8       @DL30SMP 19400000
IJHVD9   EQU   9                       DISPLACEMENT OF 9       @DL30SMP 19450000
IJHVD16  EQU   16                      DISPLACEMENT OF 16      @DL30SMP 19500000
IJHVD25  EQU   25                      DISPLACEMENT OF 25      @DL30SMP 19550000
IJHVD28  EQU   28                      DISPLACEMENT OF 28      @DL30SMP 19600000
IJHVD30  EQU   30                      DISPLACEMENT OF 30      @DL30SMP 19650000
IJHVD33  EQU   33                      DISPLACEMENT OF 33      @DL30SMP 19700000
IJHVD36  EQU   36                      DISPLACEMENT OF 36      @DL30SMP 19750000
IJHVD40  EQU   40                      DISPLACEMENT OF 40      @DL30SMP 19800000
IJHVD44  EQU   44                      DISPLACEMENT OF 44      @DL30SMP 19850000
IJHVD45  EQU   45                      DISPLACEMENT OF 45      @DL30SMP 19900000
IJHVD48  EQU   48                      DISPLACEMENT OF 48      @DL30SMP 19950000
IJHVD62  EQU   62                      DISPLACEMENT OF 62      @DL30SMP 20000000
IJHVD64  EQU   64                      DISPLACEMENT OF 64      @DL30SMP 20050000
IJHVD70  EQU   70                      DISPLACEMENT OF 70      @DL30SMP 20100000
IJHVD71  EQU   71                      DISPLACEMENT OF 71      @DL30SMP 20150000
IJHVD172 EQU   172                     DISPLACEMENT OF 172     @DL30SMP 20200000
IJHVF20  EQU   X'20'                   SET C C FLAG OFF        @DL30SMP 20250000
IJHVHAOC EQU   X'1A'                   READ HOME ADDR OPT-CODE @DL30SMP 20300000
IJHVICC  EQU   X'C0'                   INDEX TYPE CCW CHAIN    @DL30SMP 20350000
IJHVL1   EQU   1                       LENGTH OF 1             @DL30SMP 20400000
IJHVL2   EQU   2                       LENGTH OF 2             @DL30SMP 20450000
IJHVL3   EQU   3                       LENGTH OF 3             @DL30SMP 20500000
IJHVL4   EQU   4                       LENGTH OF 4             @DL30SMP 20550000
IJHVL32  EQU   32                      LENGTH OF 32            @DL30SMP 20600000
IJHVL40  EQU   40                      LENGTH OF 40            @DL30SMP 20650000
IJHVMICI EQU   X'80'                   MI/CI TYPE CCW CHAIN    @DL30SMP 20700000
IJHVM1   EQU   X'07'                   STCM MASK LOW 3 BYTES   @DL30SMP 20750000
IJHVM2   EQU   X'02'                   MASK FOR REG BYTE 2     @DL30SMP 20800000
IJHVM3   EQU   X'08'                   MASK FOR REG BYTE 0     @DL30SMP 20850000
IJHVM4   EQU   X'0C'                   MASK FOR REG BYTES 0&1  @DL30SMP 20900000
IJHVM5   EQU   X'01'                   MASK FOR REG BYTE 3     @DL30SMP 20950000
IJHVNOOP EQU   X'03'                   NO-OP OP-CODE           @DL30SMP 21000000
IJHVOC69 EQU   X'69'                   OPT-CODE OF X'69'       @DL30SMP 21050000
IJHVPDOF EQU   X'20'                   PD OVERFLOW CCW CHAIN   @DL30SMP 21100000
IJHVRCCW EQU   X'22'                   READ SECTOR OPT-CODE    @DL30SMP 21150000
IJHVRPSF EQU   X'04'                   RPS DTFIS               @DL30SMP 21200000
IJHVRPSI EQU   X'01'                   RPS HI-INDEX DEVICE SW  @DL30SMP 21250000
IJHVRSOC EQU   X'22'                   READ SECTOR OPT-CODE    @DL30SMP 21300000
IJHVSAF0 EQU   X'0F'                   SECTOR ARG FIELD 0      @DL30SMP 21350000
IJHVSA1  EQU   X'01'                   SEC ARG FIELD # 1       @DL30SMP 21400000
IJHVSCCW EQU   X'23'                   SET SECTOR OPT-CODE     @DL30SMP 21450000
IJHVSGET EQU   X'06'                   SEQUENTIAL GET OP-CODE  @DL30SMP 21500000
IJHVSOFL EQU   X'02'                   SEQUENTIAL OFL CCW CHAIN@DL30SMP 21550000
IJHVSSC  EQU   X'10'                   SUPPRESS SECTOR CALCUL. @DL30SMP 21600000
IJHVSTI  EQU   X'01'                   SEQUENTIAL TI CCW CHAIN @DL30SMP 21650000
IJHVS2   EQU   2                       SHIFT ARGUMENT OF 2     @DL30SMP 21700000
IJHVTI   EQU   X'40'                   TI TYPE CCW CHAIN       @DL30SMP 21750000
IJHVTOC  EQU   X'08'                   TIC OPT-CODE            @DL30SMP 21800000
IJHVZERO EQU   0                       ZERO                    @DL30SMP 21850000
.CR2     ANOP                                                  @DL30SMP 21900000
         USING IJHCTBL1,1                                               21950000
         USING IJHCTBL2,2                                               22000000
         USING IJHCTBL3,3                                               22050000
         AIF   (NOT &SW(15)).CR3       RPS NOT SPECIFIED       @DL30SMP 22100000
         USING IJHVDTF,IJHREG6                                 @DL30SMP 22150000
.CR3     ANOP                                                  @DL30SMP 22200000
         USING *,15,14                                              3-4 22250000
IJHRRR01 EQU   *                                                        22300000
         AIF   (&SW(2) OR &SW(4)).CS                                3-9 22350000
         SVC   50                      NO WRITE NEW KEY ENTRY           22400000
         NOPR  0                       DUMMY                            22450000
         AGO   .CT                                                  3-9 22500000
.CS      B     IJHAWRNK                WRITE NEW KEY ENTRY          3-9 22550000
.CT      AIF   (&SW(2) OR &SW(4) OR &SW(8) OR &SW(10)).CU           3-9 22600000
         SVC   50                      NO WAITF ENTRY                   22650000
         NOPR  0                       DUMMY                            22700000
         AGO   .CV                                                  3-9 22750000
.CU      B     IJHCWATF                WAITF ENTRY                  3-9 22800000
.CV      AIF   (&SW(3) AND &SW(9)).CW                               3-9 22850000
         SVC   50                      NO GET ENTRY                     22900000
         NOPR  0                       DUMMY                            22950000
         SVC   50                      NO PUT ENTRY                     23000000
         NOPR  0                       DUMMY                            23050000
         AGO   .CX                                                  3-9 23100000
.CW      B     IJHSGETB                GET ENTRY                    3-4 23150000
         B     IJHSPUTB                PUT ENTRY                    3-4 23200000
.CX      AIF   (&SW(8)).CY                                          3-9 23250000
         SVC   50                      NO WRITE ENTRY                   23300000
         NOPR  0                       DUMMY                            23350000
         AGO   .CZ                                                  3-9 23400000
.CY      B     IJHRWRTB                WRITE ENTRY                  3-4 23450000
.CZ      AIF   (&SW(9)).C0                                          3-9 23500000
         SVC   50                      NO ESETL ENTRY                   23550000
         NOPR  0                       DUMMY                            23600000
         AGO   .C1                                                  3-9 23650000
.C0      B     IJHESTLB                ESETL ENTRY                  3-4 23700000
.C1      AIF   (&SW(8)).C2                                          3-9 23750000
         SVC   50                      NO READ ENTRY                    23800000
         NOPR  0                       DUMMY                            23850000
         AGO   .C3                                                  3-9 23900000
.C2      B     IJHREADB                READ ENTRY                   3-4 23950000
.C3      ANOP                                                       3-9 24000000
         DC    C'IJH&NM(1)&NM(2)&NM(3)&NM(4)&NM(5)'  MODULE NAME.       24050000
         DC    X'3440'  /*@@LVLID*/    VERSION AND MOD LEVEL   @D41TDKY 24100000
         NOPR  IJHZERO                 DUMMY FILLER                 3-9 24150000
         SVC   IJHSVC50                DUMMY FILLER                 3-9 24200000
         NOPR  IJHZERO                 DUMMY FILLER                 3-9 24250000
         AIF   (&SW(11) AND &SW(8)).C4                              3-9 24300000
         SVC   IJHSVC50                NO FREE MACRO ENTRY          3-9 24350000
         NOPR  IJHZERO                 DUMMY FILLER                 3-9 24400000
         AGO   .C5                                                  3-9 24450000
.C4      B     IJHFREEB                FREE MACRO ENTRY             3-9 24500000
.C5      ANOP                                                       3-9 24550000
IJHCINIT LH    2,IJHCATB2               PICK UP TABLE 2 DISPLACEMENT.   24600000
         LH    3,IJHCATB3               PICK UP TABLE 3 DISPLACEMENT.   24650000
         AR    2,1                      ADD BASE 1 TO DISPLACEMENT.     24700000
         AR    3,1                      ADD BASE 1 TO DISPLACEMENT.     24750000
         AIF   (&SW(2) OR &SW(4)).C52   ADD OR ADDRTR?         @DA10922 24800000
         BR    4                        RETURN (RETRVE)        @DA10922 24850000
         AGO   .C54                                            @DA10922 24900000
.C52     ANOP                                                  @DA10922 24950000
         TM    IJHACSTI,X'20'           FILE ALREADY CLOSED?   @DA10359 25000000
         BZR   4                        NO, RETURN.            @DA10359 25050000
         SVC   50                       YES, CANCEL.           @DA10359 25100000
.C54     ANOP                                                  @DA10922 25150000
         AIF   (NOT &SW(11)).C6                                     3-9 25200000
IJHNDXHD EQU   X'10'                                                3-9 25250000
IJHTRKHD EQU   X'20'                                                3-9 25300000
IJHBTHHD EQU   X'30'                                                3-9 25350000
******************************************************************* 3-9 25400000
*NAME          ROUTINE TO CALCULATE LOGICAL UNIT NUMBER FROM M NUM* 3-9 25450000
******************************************************************* 3-9 25500000
IJHCMCAL SR    IJHREG8,IJHREG8         INITIALIZE REGISTERS TO 0    3-9 25550000
         SR    IJHREG9,IJHREG9                                      3-9 25600000
         IC    IJHREG8,IJHCSADR        PICK UP M NUMBER IN SEEK ADDR3-9 25650000
         IC    IJHREG9,IJHCPNT         PICK UP RELATIVE POINTER     3-9 25700000
         AR    IJHREG8,IJHREG9         COMBINE                      3-9 25750000
         BCTR  IJHREG8,IJHZERO         SUBTRACT ONE                 3-9 25800000
         SLA   IJHREG8,IJHM4           MULTIPLY BY FOUR             3-9 25850000
         AR    IJHREG8,IJHREG1         ADD IN BASE                  3-9 25900000
         CLC   0(2,IJHREG8),IJHVALEX     Q- VALID EXTENT            3-9 25950000
         BNE   IJHCLGUT                BRANCH IF VALID              3-9 26000000
         MVI   IJHDL1(IJHREG8),IJHINVAL MAKE LOGICAL UNIT INVALID   3-9 26050000
IJHCLGUT MVC   IJHCCCB+6(IJHDL2),0(IJHREG8) MOVE LOGICAL UNIT NUMBER3-9 26100000
         MVC   IJHCSADR+1(IJHDL2),IJHDL2(IJHREG8) AND BB TO SEEK ADR3-9 26150000
         BR    IJHREG10                RETURN TO CALLER             3-9 26200000
******************************************************************* 3-9 26250000
*NAME          EXCP, HOLD ROUTINE                                 * 3-9 26300000
*FUNCTION      SAME AS REGULAR EXCP ROUTINE EXCEPT IT ISSUES AN   * 3-9 26350000
*              SVC 35 INSTEAD OF SVC 0                            * 3-9 26400000
*ENTRY POINT   IJHCXCPH                                           * 3-9 26450000
*NOTES         ALL OTHER FUNCTIONS ARE IDENTICAL                  * 3-9 26500000
******************************************************************* 3-9 26550000
IJHCXCPH BAL   IJHREG10,IJHCMCAL       GET LOGICAL UNIT NUMBER      3-9 26600000
         SVC   IJHSVC35                INITIATE I/O AND HOLD        3-9 26650000
         BR    IJHREG7                 RETURN                       3-9 26700000
IJHCXWTH BAL   IJHREG7,IJHCXCPH        GO TO EXCP/HOLD ROUTINE      3-9 26750000
         B     IJHCWAIT                GO TO WAIT ON I/O            3-9 26800000
.C6      ANOP                                                       3-9 26850000
*********************************************************************** 26900000
*NAME: EXCP ROUTINE.                                                  * 26950000
*FUNCTION: TO EXECUTE AN EXCP.                                        * 27000000
*ENTRY POINT: 'IJHCEXCP'.                                             * 27050000
*INPUT: #1 POINTS TO FIRST DTFIS TABLE.                               * 27100000
*OUTPUT: EXCP INITIATED.                                              * 27150000
*EXIT: BR 7, RETURN TO CALLING ROUTINE.                               * 27200000
*EXTERNAL ROUTINES: NONE.                                             * 27250000
*REGISTER USE: #1 POINTS TO FIRST DTFIS TABLE.                        * 27300000
*              #7 IS RETURN REGISTER.                                 * 27350000
*              #8 & #9 ARE WORK REGISTERS.                            * 27400000
*NOTES: NO REGISTERS ARE SAVED.                                       * 27450000
*********************************************************************** 27500000
         AIF   (NOT &SW(11)).C7                                     3-9 27550000
IJHCEXCP BAL   IJHREG10,IJHCMCAL       GET LOGICAL UNIT NUMBER      3-9 27600000
         AGO   .C8                                                  3-9 27650000
.C7      ANOP                                                       3-9 27700000
IJHCEXCP SR    8,8                      INITIALIZE REGISTERS TO 0.      27750000
         SR    9,9                                                      27800000
         IC    8,IJHCSADR               PICK UP M IN SEEK ADDRESS.      27850000
         IC    9,IJHCPNT                PICK UP RELATIVE POINTER.       27900000
         AR    8,9                      COMBINE.                        27950000
         BCTR  8,0                      SUBTRACT ONE.                   28000000
         SLA   8,2                      MULTIPLY BY 4.                  28050000
         AR    8,1                      ADD IN BASE.                    28100000
         CLC   0(2,8),IJHVALEX         Q--   VALID EXTENT           3-9 28150000
         BNE   IJHCLGUT                B  IF VALID                  3-7 28200000
         MVI   1(8),X'FF'                                           3-7 28250000
IJHCLGUT MVC   IJHCCCB+6(2),0(8)       MOVE LOG. UNIT               3-7 28300000
         MVC   IJHCSADR+1(2),2(8)         AND  BB TO SEEK ADDRESS.      28350000
.C8      ANOP                                                       3-9 28400000
         SVC   0                        INITIATE INPUT OR OUTPUT.       28450000
         BR    7                        RETURN.                         28500000
IJHVALEX DC    X'0000'                  FOR EXTENT CHECKING         3-9 28550000
         AIF   (&SW(21)).C9                                         3-9 28600000
IJHCXCOR EQU   *                                                        28650000
.C9      ANOP                                                       3-9 28700000
IJHCEXWT BAL   7,IJHCEXCP               GO TO EXCP ROUTINE.             28750000
*********************************************************************** 28800000
*NAME: WAIT ROUTINE.                                                  * 28850000
*FUNCTION: TO WAIT FOR I/O COMPLETION & TO CHECK FOR I/O ERRORS.      * 28900000
*ENTRY POINT: 'IJHCWAIT'.                                             * 28950000
*INPUT: #1,#2, & #3 POINT TO DTFIS TABLE.                             * 29000000
*       #4 POINTS TO RETURN POINT.                                    * 29050000
*OUTPUT: I/O COMPLETED & ERRORS CHECKED FOR.                          * 29100000
*EXITS: NORMAL--BR 4, RETURN TO CALLING ROUTINE.                      * 29150000
*       ERROR --BR 14, RETURN TO USER.                                * 29200000
*EXTERNAL ROUTINES: NONE.                                             * 29250000
*REGISTER USE:  #1,#2,#3 USED BUT NOT MODIFIED.                       * 29300000
*               #7,#8,#9,#10 USED AND NOT RESTORED.                     29350000
*********************************************************************** 29400000
IJHCWAIT TM    IJHCCCB+2,X'80'          WAIT FOR I/O COMPLETION.        29450000
         BO    *+6                                                      29500000
         SVC   7                                                        29550000
IJHBUMP  EQU   *                                                   3-9  29600000
IJHCERRT XC    IJHCSTBY(1),IJHCSTBY     SET STATUS BITS TO ZERO.        29650000
         LA    7,4                     SET LOOP COUNTER FOR 4      3-8  29700000
         SR    8,8                     ZERO REG 8                  3-8  29750000
         LA    10,IJHCTMTB              PICK UP TABLE ADDRESS.          29800000
IJHCLOP1 LR    9,1                     PICK UP CCB ADDRESS         3-8  29850000
         IC    8,0(10)                  GET NUMBER OF CCB BYTE TO TEST. 29900000
         AR    9,8                     GET POINTER TO CURRENT BYTE 3-8  29950000
         IC    8,1(10)                  PICK UP TESTING MASK.           30000000
         EX    8,IJHCTM                 IF ERROR CONDITION EXISTS,      30050000
         BC    5,IJHCER                   GO HERE.                      30100000
         LA    10,3(10)                BUMP TABLE POINTER           3-9 30150000
         BCT   7,IJHCLOP1              LOOP                        3-8  30200000
         NI    IJHCNTSW,X'7F'          TURN OFF INDICATOR          3-8  30250000
         NI    IJHCNTSW,X'FB'          1ST OVFLO REC IN ERROR  @DA01015 30300000
         AIF   (&SW(23)).DA                                         3-4 30350000
         BR    4                                                    3-4 30400000
         AGO   .DB                                                  3-9 30450000
.DA      ANOP                                                       3-4 30500000
         TM    2(1),X'20'               IF NOT UNRECOVERABLE I/O ERR3-4 30550000
         BCR   8,4                      RETURN                      3-4 30600000
         OI    IJHCSTBY,X'80'           SET ON UNRECOV ERROR INDICAT3-4 30650000
         B     IJHCPLST                 GO TO SET UP PARAMETER LIST 3-4 30700000
.DB      ANOP                                                       3-9 30750000
IJHCER   CH    7,IJHONE                IS ERROR WLR                3-8  30800000
         BNE   IJHCER1                 NO, BRANCH                  3-8  30850000
         TM    IJHCNTSW,X'01'          NEED SEEK CHECK             3-8  30900000
         BZ    IJHCER1                 NO                          3-8  30950000
         TM    IJHCNTSW,X'80'          FIRST TIME INDICATOR ON     3-8  31000000
         BO    IJHCER1                 YES                         3-8  31050000
         OI    IJHCNTSW,X'80'          TURN ON INDICATOR           3-8  31100000
         BR    4                       RETRY OVER/UNDER SEEK       3-8  31150000
IJHCER1  NI    IJHCNTSW,X'7F'          TURN OFF INDICATOR          3-8  31200000
         OC    IJHCSTBY(1),2(10)       SET ERROR FLAG ON           3-8  31250000
         AIF   (NOT &SW(23)).DC                                     3-9 31300000
         NI    2(1),X'DF'               SET OFF UNRECOVERABLE INDICA3-4 31350000
IJHCPLST EQU   *                                                    3-9 31400000
.DC      NI    IJHCNTSW,X'FE'          TURN OFF SEEK SWITCH         3-9 31450000
         AIF   (NOT &SW(23)).DH                                     3-9 31500000
         TM    IJHCCCB+2,IJHERREX      THIS AN ERREXT DTF           3-9 31550000
         AIF   (NOT &SW(11)).DD                                     3-9 31600000
         BZ    IJHSER2H                NO, RETURN TO USRE           3-9 31650000
         AGO   .DE                                                  3-9 31700000
.DD      BZ    IJHSER2                 NO, RETURN TO USER           3-9 31750000
.DE      ANOP                                                       3-9 31800000
         AIF   (&SW(24)).DF             RDONLY SPECIFIED       @DL30SMP 31850000
         STM   2,5,IJHCSAV2             SAVE MODULE REGISTERS 2,3,4 3-4 31900000
         STM   11,12,IJHCSAV2+16          11 AND 12                 3-4 31950000
         STM   14,1,IJHCSAV2+24         START PARAMETER LIST - DTF A3-4 32000000
         MVC   IJHCSAV2+41(3),IJHEWORK+1 IOAREA ADDRESS             3-4 32050000
         L     4,12(1)                  CCW ADDRESS IN CSW FROM CCB 3-4 32100000
         SH    4,IJHC8                  ADDRESS OF FAILING CCW      3-4 32150000
         MVC   IJHCSAV2+53(1),0(4)      COMMAND CODE FROM FAILING CC3-4 32200000
         MVC   IJHCSAV2+44(8),IJHCSADR  SEEK/SEARCH ADDRESS         3-4 32250000
         TM    IJHEWORK,X'08'           UPDATE SEEK/SEARCH ADDR     3-4 32300000
         BZ    IJHELDR                  IF NO, BRANCH               3-4 32350000
         NI    IJHEWORK,X'F7'           RESET INDICATOR             3-4 32400000
         L     4,IJHCSAV2+48            PICK UP SEEK/SEARCH ADDR    3-4 32450000
         LA    4,1(4)                   INCREMENT TO NEXT REC NO    3-4 32500000
         ST    4,IJHCSAV2+48            SAVE IT                     3-4 32550000
         CNOP  0,4                      ALIGN FOR IJHCSAV2          3-4 32600000
IJHELDR  MVC   IJHCSAV2+52(1),IJHEWORK  TYPE OF RECORD AND OPERATION3-4 32650000
IJHEUSER LA    1,IJHCSAV2+36                                        3-4 32700000
         LM    2,14,IJHCSAVE            RESTORE USER REGISTERS      3-4 32750000
         BALR  14,14                    GO TO USER                  3-4 32800000
         B     90(14)                   RETURN TO SKIP              3-4 32850000
         B     90(14)                   RETURN TO IGNORE            3-4 32900000
*                                       RETURN TO RETRY             3-4 32950000
IJHCRES  LM    14,1,60(14)              RESTORE BASE REGISTER       3-4 33000000
         STM   2,13,IJHCSAVE            SAVE USER REGISTERS         3-4 33050000
         LA    6,IJHCEXWT                                           3-4 33100000
IJHCRES2 LM    2,5,IJHCSAV2             RESTORE MODULE REGISTERS    3-4 33150000
         LM    11,12,IJHCSAV2+16                                    3-4 33200000
         BR    6                        GO TO RETRY CCW STRING      3-4 33250000
         CNOP  0,4                                                  3-4 33300000
IJHEWORK DC    XL4'0'                   CONSTANTS FOR PARAMETER LIST3-4 33350000
IJHCSAV2 DC    XL54'0'                  SAVE AREA FOR MODULE REGISTE3-4 33400000
*                                         AND ERROR INFORMATION     3-4 33450000
IJHCIGN  EQU   *                                                    3-4 33500000
IJHCSKIP LM    14,1,60(14)              RESTORE BASE REGISTERS      3-4 33550000
         STM   2,13,IJHCSAVE            SAVE USER REGS              3-4 33600000
         AGO   .DG                                                  3-4 33650000
.DF      ANOP                                                       3-4 33700000
         XR    13,0                     POINTER TO SAVE AREA        3-4 33750000
         XR    0,13                                                 3-4 33800000
         XR    13,0                                                 3-4 33850000
         LM    2,3,0(13)                RESTORE USER REGISTERS 2 AND3-4 33900000
         ST    4,0(13)                  SAVE MODULE REGISTER 4      3-4 33950000
         L     4,8(13)                  RESTORE USER REGISTER 4     3-4 34000000
         STM   11,12,4(13)              SAVE MODULE REGISTERS       3-4 34050000
         LM    11,12,36(13)             RESTORE USER REGISTERS 11 & 3-4 34100000
         ST    5,68(13)                 SAVE REG 5                  3-4 34150000
         LM    5,10,12(13)              RESTORE USER REGS 5 TO 10   3-4 34200000
         STM   14,1,12(13)              START PARAMETER LIST - DTF A3-4 34250000
         MVC   29(3,13),45(13)          IOAREA ADDRESS              3-4 34300000
         MVC   32(8,13),IJHCSADR        SEEK/SEARCH ADDRESS         3-4 34350000
         L     1,12(1)                  CCW ADDRESS IN CSW FROM CCB 3-4 34400000
         SH    1,IJHC8                  ADDRESS OF FAILING CCW      3-4 34450000
         MVC   41(1,13),0(1)            COMMAND CODE FROM FAILING CC3-4 34500000
         TM    44(13),X'08'             UPDATE SEEK/SEARCH ADDR     3-4 34550000
         BZ    IJHELDR                  IF NO, BRANCH               3-4 34600000
         NI    44(13),X'F7'             RESET INDICATOR             3-4 34650000
         L     1,36(13)                 PICK UP SEEK/SEARCH ADDR    3-4 34700000
         LA    1,1(1)                   INCREMENT TO NEXT REC NO    3-4 34750000
         ST    1,36(13)                 SAVE IT                     3-4 34800000
IJHELDR  MVC   40(1,13),44(13)          TYPE OF RECORD AND OPERATION3-4 34850000
IJHEUSER LA    1,24(13)                 POINT TO PARAMETER LIST     3-4 34900000
         AIF   (NOT &SW(15)).DF1        RPS NOT SPECIFIED      @DL30SMP 34950000
         SPACE 2                                               @DL30SMP 35000000
*************************************************************  @DL30SMP 35050000
*        SET UP FOR ERREXT RETURN FROM THE USER             *  @DL30SMP 35100000
*    THE ADDRESS OF THE RETURN POINT WITHIN THE RPS ISMOD   *  @DL30SMP 35150000
*    IS SAVED IN THE DTFIS EXTENTION. THE ADDRESS OF THE    *  @DL30SMP 35200000
*    RPS ERREXT ROUTINE (WHICH IS LOCATED WITHIN THE DTFIS  *  @DL30SMP 35250000
*    EXTENTION) IS PUT IN REGISTER 14, CAUSING THE USER     *  @DL30SMP 35300000
*    TO RETURN TO IT IF HE RETURNS VIA THE ERREXT RETURN.   *  @DL30SMP 35350000
*    THE USER REGISTER 13 CONTENTS ARE RESTORED, AND        *  @DL30SMP 35400000
*    CONTROL IS RETURNED TO THE USER.                       *  @DL30SMP 35450000
*************************************************************  @DL30SMP 35500000
         SPACE 2                                               @DL30SMP 35550000
         USING IJHVDTF,IJHREG13         DSECT FOR DTF EXTENT   @DL30SMP 35600000
         SH    IJHREG13,IJHVC184        TO THE DTF EXTENTION   @DL30SMP 35650000
         LA    IJHREG14,IJHCRTRN        LOAD ADDR EREXT RTRN   @DL30SMP 35700000
         ST    IJHREG14,IJHVMR14        SAVE ISMOD R14 IN EXT  @DL30SMP 35750000
         L     IJHREG14,IJHVAERT        PTR TO RPS ERREXT RTN  @DL30SMP 35800000
         L     IJHREG15,IJHVUR14        SET UP USER RTRN ADDR  @DL30SMP 35850000
         L     IJHREG13,IJHVUR13        RESTORE USER REG 13    @DL30SMP 35900000
         BR    IJHREG15                 RETURN TO USER (EREXT) @DL30SMP 35950000
         DROP  IJHREG13                                        @DL30SMP 36000000
         AGO   .DF2                                            @DL30SMP 36050000
.DF1     ANOP                                                  @DL30SMP 36100000
         L     14,48(13)                RESTORE USER RETURN REGISTER3-4 36150000
         BALR  14,14                    GO TO USER                  3-4 36200000
.DF2     ANOP                                                  @DL30SMP 36250000
         AIF   (NOT &SW(15)).DF3        RPS NOT SPECIFIED      @DL30SMP 36300000
IJHCRTRN EQU   *                                               @DL30SMP 36350000
.DF3     ANOP                                                  @DL30SMP 36400000
         B     62(14)                   RETURN TO SKIP              3-4 36450000
         B     62(14)                   RETURN TO IGNORE            3-4 36500000
*                                       RETURN TO RETRY             3-4 36550000
IJHCRES  LM    14,1,12(13)              RESTORE BASE REGISTERS      3-4 36600000
         STM   5,6,12(13)               SAVE USER REGS 5 AND 6      3-4 36650000
         LA    6,IJHCEXWT                                           3-4 36700000
IJHCRES2 L     5,68(13)                 RESTORE REGISTER 5          3-4 36750000
         STM   8,12,24(13)              SAVE USER REGS 8 TO 12      3-4 36800000
         LM    11,12,4(13)              RESTORE MODULE REGISTERS 11,3-4 36850000
         MVC   20(4,13),0(13)           SAVE MODULE REGISTER 4      3-4 36900000
         STM   2,4,0(13)                SAVE USER REGISTERS 2 TO 4  3-4 36950000
         BAL   4,IJHCINIT               GO TO INITIALIZE BASE REGIST3-4 37000000
         L     4,20(13)                 RESTORE MODULE REGISTER 4   3-4 37050000
         ST    7,20(13)                 SAVE USER REGISTER 7        3-4 37100000
         XR    0,13                                                 3-4 37150000
         XR    13,0                                                 3-4 37200000
         XR    0,13                                                 3-4 37250000
         BR    6                        GO TO RETRY CCW STRING      3-4 37300000
IJHCIGN  EQU   *                                                    3-4 37350000
IJHCSKIP LM    14,1,12(13)              RESTORE BASE REGISTERS      3-4 37400000
         STM   5,6,12(13)               SAVE USER REGS 5,6          3-4 37450000
.DG      ANOP                                                       3-4 37500000
         BAL   6,IJHCRES2               GO TO RESTORE REGISTERS     3-4 37550000
         EX    0,IJHCERRT               ZERO STATUS INDICATORS      3-4 37600000
         NI    3(1),X'25'              SET OFF ERROR INDICATIONS    3-4 37650000
         NI    4(1),X'BF'              IN CCB                       3-4 37700000
         BR    4                        RETURN TO MAIN LINE         3-4 37750000
IJHC8    DC    X'0008'                  CONSTANT                    3-4 37800000
.DH      AIF   (NOT &SW(11)).DM                                     3-9 37850000
IJHSER2H EQU   *                       ROUTINE TO FREE HELD TRACKS  3-9 37900000
         AIF   (NOT(&SW(2) OR &SW(4) OR &SW(8) OR &SW(10))).DM @DL30SMP 37950000
.*                                     BR IF RETRVE & SEQNTL   @DL30SMP 38000000
         TM    IJHCILN,IJHTRKHD        DATA TRACK HELD              3-9 38050000
         BZ    *+6                     NO                           3-9 38100000
         SVC   IJHSVC36                FREE DATA TRACK              3-9 38150000
         TM    IJHCILN,IJHNDXHD        INDEX TRACK HELD             3-9 38200000
         BZ    IJHONHLD                NO                           3-9 38250000
         AIF   (NOT &SW(4) OR NOT &SW(8)).DI                        3-9 38300000
         TM    IJHCRTR,IJHRDWRK        FOR AN ADD FUNCTION          3-9 38350000
         BZ    IJHCADD                 YES, GET ADD INDX ADDR       3-9 38400000
         AGO   .DJ                                                  3-9 38450000
.DI      AIF   ((&SW(4) AND NOT &SW(8))OR(&SW(2) AND NOT &SW(4))).DK    38500000
.DJ      MVC   IJHCSADR(IJHDL8),IJHRIDSV GET RAN RTRV INDEX ADDR    3-9 38550000
         AIF   (NOT &SW(4)).DL                                      3-9 38600000
         B     IJHCRAND                CONTINUE FREEING             3-9 38650000
.DK      ANOP                                                       3-9 38700000
IJHCADD  MVC   IJHCSADR(IJHDL8),IJHACTIA GET ADD INDEX ADDR         3-9 38750000
.DL      ANOP                                                       3-9 38800000
IJHCRAND BAL   IJHREG10,IJHCMCAL       GET LOGICAL UNIT ADDR        3-9 38850000
         SVC   IJHSVC36                FREE THIS TRACK              3-9 38900000
IJHONHLD NI    IJHCILN,X'FF'-IJHBTHHD  CLEAR BOTH TRACK HOLD BITS   3-9 38950000
.DM      ANOP                                                       3-9 39000000
         AIF   (&SW(24)).DN             RDONLY SPECIFIED       @DL30SMP 39050000
IJHSER2  LM    2,14,IJHCSAVE            RESTORE USER REGISTERS.     3-3 39100000
         AGO   .DO                                                  3-3 39150000
.DN      ANOP                                                       3-3 39200000
IJHSER2  LR    13,0                    POINTER TO SAVE AREA         3-3 39250000
IJHSER21 LM    2,12,0(13)               RESTORE USER REGISTERS      3-4 39300000
         L     14,48(13)                                            3-4 39350000
.DO      ANOP                                                       3-3 39400000
         AIF   (NOT &SW(23)).DP                                     3-4 39450000
         AIF   (NOT(&SW(2) OR &SW(4) OR &SW(8) OR &SW(10))).DP @DL30SMP 39500000
.*                                      BR IF RETRVE & SEQNTL  @DL30SMP 39550000
         TM    IJHCILN,X'80'            FROM WAITF ROUTINE          3-4 39600000
         BZ    IJHSER3                  IF NO, RETURN TO USER  @DL30SMP 39650000
.DO2     ANOP                                                  @DL30SMP 39700000
         NI    IJHCILN,X'7F'            TURN OFF WAITF INDICATOR    3-4 39750000
         XC    IJHCSTBY(1),IJHCSTBY     RESET STATUS BITS           3-4 39800000
         NI    2(1),X'DF'               RESET UNRECOVERABLE BIT     3-4 39850000
         B     IJHCWATR                 RETURN TO WAITF RTN    @DL30SMP 39900000
.DP      ANOP                                                       3-4 39950000
IJHSER3  EQU   *                                               @DL30SMP 40000000
         AIF   (NOT &SW(15)).DP1        RPS NOT SPECIFIED      @DL30SMP 40050000
         USING IJHVDTF,IJHREG13                                @DL30SMP 40100000
         ICM   IJHREG13,IJHVM1,IJHCCCB+IJHVD9 SET BASE FOR EXT @DL30SMP 40150000
         L     IJHREG13,IJHVUR13        RESTORE USER REG 13    @DL30SMP 40200000
         DROP  IJHREG13                                        @DL30SMP 40250000
.DP1     ANOP                                                  @DL30SMP 40300000
         BR    14                       RETURN TO USER.                 40350000
.DQ      ANOP                                                       3-4 40400000
         AIF   (NOT &SW(15)).DQ0        RPS NOT SPECIFIED      @DL30SMP 40450000
IJHVC184 DC    H'184'                   RPS SAVE AREA OFFSET   @DL30SMP 40500000
.DQ0     ANOP                                                  @DL30SMP 40550000
IJHCTM   TM    0(9),X'00'              WILL BE USED BY EX.         3-8  40600000
IJHCTMTB DC    X'040120' EOF INDICATION CCB+4, MASK 01, BIT 20 ON.      40650000
         DC    X'039280' ANY READ ERROR CCB+3, MASK 92, BIT 80 ON.      40700000
         DC    X'030810' NO REC. FOUND  CCB+3, MASK 08, BIT 10 ON.      40750000
         DC    X'054040' WLR ERROR      CCB+5, MASK 40, BIT 40 ON.      40800000
IJHONE   DC    H'1'                                                3-8  40850000
         DS    0F                                                   3-9 40900000
IJHZER0  DC    X'00000000'                                          3-9 40950000
         AIF   (NOT(&SW(2) OR &SW(4) OR &SW(8) OR &SW(10))).DR @DL30SMP 41000000
.*                                     BR IF RETRVE & SEQNTL   @DL30SMP 41050000
****  ROUTINE TO CHECK FOR OVER/UNDER SEEK  **********************  3-3 41100000
IJHSKERR DS    0C                                              @DL30SMP 41150000
         AIF   (NOT &SW(15)).DQ1       RPS NOT SPECIFIED       @DL30SMP 41200000
         ST    IJHREG6,IJHVTRS         SAVE REGISTER 6         @DL30SMP 41250000
         ICM   IJHREG6,IJHVM1,IJHCCCB+IJHVD9  SET BASE FOR EXT @DL30SMP 41300000
         CLI   IJHVCCW+IJHVD8,IJHVHAOC READ HOME ADDRESS CCW   @DL30SMP 41350000
         AGO   .DQ1A                                           @DL30SMP 41400000
.DQ1     ANOP                                                  @DL30SMP 41450000
         CLI   IJHCCCW,X'1A'           READ HOME ADDRESS  ***       3-4 41500000
.DQ1A    ANOP                                                  @DL30SMP 41550000
         BE    IJHRDHA                 YES,***                      3-4 41600000
         CLC   IJHCSADR+4(1),1(9)      SEEK GOOD ****               3-4 41650000
         BE    IJHOFFSK                YES,BRANCH                   3-9 41700000
         B     IJHRECAL                NO,RECALIBRATE  ***          3-4 41750000
IJHOFFSK NI    IJHCNTSW,X'FD'          TURN OFF RETRY SWITCH        3-9 41800000
         AIF   (NOT &SW(15)).DQ2       RPS NOT SPECIFIED       @DL30SMP 41850000
         L     IJHREG6,IJHVTRS         RESTORE REGISTER 6      @DL30SMP 41900000
.DQ2     ANOP                                                  @DL30SMP 41950000
         BC    15,4(4)                 RETURN                       3-9 42000000
IJHRDHA  CLC   IJHCSADR+4(1),2(9)      SEEK GOOD  ***               3-4 42050000
         BE    IJHOFFSK                YES,BRANCH                   3-9 42100000
IJHRECAL LA    9,IJHSKCCW              STORE CCW ADDR IN CCB        3-4 42150000
         TM    IJHCNTSW,X'02'          SECOND TIME FOR BAD SEEK     3-9 42200000
         BZ    *+12                    NO,BRANCH               @DA05855 42250000
         OI    IJHCSTBY,X'80'          UNREC DASD ERROR        @DA05855 42300000
         B     IJHSER2                 RETURN TO USER          @DA05855 42350000
         OI    IJHCNTSW,X'02'          TURN ON RETRY SWITCH         3-9 42400000
         MVC   IJHSKCCB(48),IJHCCBSK   CCB-CCW FOR OVERSEEK         3-4 42450000
         ST    9,IJHSKCCB+8                                         3-4 42500000
         LR    9,1                     SAVE DTF REGISTER            3-4 42550000
         MVC   IJHSKCCB+6(2),6(1)      LOG UNIT INTO CCB  ***       3-4 42600000
         LA    1,IJHSKCCB              POINT TO CCB                 3-9 42650000
         SVC   0                       EMPLOY RECALIBRATE CCW       3-9 42700000
         TM    IJHSKCCB+2,X'80'                                     3-9 42750000
         BO    *+6                                                  3-9 42800000
         SVC   7                                                    3-9 42850000
         MVI   IJHSKCCW+4,X'60' .      CHAIN SEEK CCW               3-9 42900000
         LA    1,IJHSKCCW+8            SET UP ADDRESS               3-8 42950000
         ST    1,IJHSKCCW+16           FOR TIC                      3-8 43000000
         MVI   IJHSKCCW+16,X'08'       PUT IN OP-CODE               3-8 43050000
         L     1,IJHCASAD              ADDR OF S/S AREA+3  ***      3-4 43100000
         ST    1,IJHSKCCW+8            STORE ADDR IN SRCH ID EQ  *  3-4 43150000
         MVI   IJHSKCCW+8,X'31'        PUT IN OP-CODE ***           3-4 43200000
         BCTR  1,0                     DECRE ADDRESS FOR  **        3-4 43250000
         BCTR  1,0                     SEEK CCW  ***                3-4 43300000
         ST    1,IJHSKCCW              STORE ADDR IN SEEK  **       3-4 43350000
         MVI   IJHSKCCW,X'07'          PUT IN OP-CODE  ***          3-4 43400000
         LA    1,IJHSKCCB              POINT TO SEEK CCB **         3-4 43450000
         SVC   0                       EXCP AND WAIT  **            3-4 43500000
         TM    IJHSKCCB+2,X'80'                                     3-4 43550000
         BO    *+6                                                  3-4 43600000
         SVC   7                                                    3-4 43650000
         LR    1,9                     RESTORE DTF REDISTER  ***    3-4 43700000
         AIF   (NOT &SW(15)).DQ3       RPS NOT SPECIFIED       @DL30SMP 43750000
         L     IJHREG6,IJHVTRS .       RESTORE REGISTER 6      @DL30SMP 43800000
.DQ3     ANOP                                                  @DL30SMP 43850000
         BR    4                       RETURN TO MAINLINE  ***          43900000
         DS    0D                      BOUNDERY ALIGNEMENT          3-4 43950000
IJHCCBSK DC    X'0000800000000000'     CCB FOR SEEK CHECK           3-4 44000000
         DC    XL4'0'                                               3-4 44050000
         DC    X'00000000'                                          3-4 44100000
         CCW   X'13',*,X'20',6                                      3-9 44150000
         CCW   X'31',*,X'60',5                                      3-4 44200000
         CCW   8,*-8,0,0                                            3-4 44250000
         CCW   3,*,0,1                                              3-4 44300000
.DR      ANOP                                                       3-9 44350000
IJHCNTSW EQU   IJHCASAD+4                                           3-4 44400000
*********************************************************************** 44450000
*NAME: GENERALIZED MOVE ROUTINE.                                      * 44500000
*FUNCTION: TO MOVE A SPECIFIED NUMBER OF BYTES.                       * 44550000
*ENTRY POINT: 'IJHCMOVE'.                                             * 44600000
*INPUT: #4 CONTAINS RETURN POINT.                                     * 44650000
*       #9 IS TO ADDRESS.                                             * 44700000
*       #10 IS FROM ADDRESS.                                          * 44750000
*       #11 CONTAINS NUMBER OF BYTES.                                 * 44800000
*OUTPUT: BYTES ARE MOVED.                                             * 44850000
*EXIT: BR 4, RETURN TO CALLING ROUTINE.                               * 44900000
*EXTERNAL ROUTINES: NONE.                                             * 44950000
*REGISTER USE: #4,#8,#9,#10,#11.                                      * 45000000
*NOTES: ONLY #4 IS NOT DESTROYED.                                     * 45050000
*********************************************************************** 45100000
IJHCMOVE LTR   11,11                    IF NO BYTES MUST BE MOVED,      45150000
         BCR   8,4                        RETURN.                       45200000
         LA    8,256                                                    45250000
IJHCREST SR    11,8                     IF LESS THAN 257 BYTES MUST BE  45300000
         BC    12,IJHCTSER                MOVED, GO HERE.               45350000
         MVC   0(256,9),0(10)           MOVE 256 BYTES.                 45400000
         AR    10,8                     BUMP TO AND FROM ADDRESSES BY   45450000
         BXH   9,8,IJHCREST               256, AND LOOP.                45500000
IJHCTSER LA    11,255(11)               FIND NUMBER OF BYTES LESS ONE.  45550000
         EX    11,IJHCMVW               MOVE REST.                      45600000
         BR    4                        RETURN.                         45650000
IJHCMVW  MVC   0(0,9),0(10)             MOVE X NUMBER OF BYTES.         45700000
