         MACRO                                                          00001009
&NAME    POWER &DBLK=,&LTAB=,&PRI=,&SUBLIB=,&STDLINE=,                 *00002009
               &STDCARD=,&JSEP=,&RBS=,&JLOG=,&PAUSE=,          @D52NDTR*00003009
               &RDREXIT=,&SNA=,&SPOOL=,                        @D34ZDQZ*00004009
               &FEED=,&MULT12=,                                @D34ZDQZ*00005009
               &CLRPRT=,&MRKFRM=,                              @D34YSWS*00006009
               &COPYSEP=,                                      @D34YSWS*00007009
               &TRACESZ=,                                      @D35BIML*00008009
               &SHARED=,&TIME=,&SYSID=,                        @D02PISS*00009009
               &NTFYMSG=,&PNET=,&RJEBSC=,                      @D03PIPW*00010009
               &MEMTYPE=,                                      @D03PILW*00011009
               &DBLKGP=,                                       @D23CDWS*00012009
               &SPLIM=,                                        @D23CDWS*00013009
               &OUTEXIT=,                                      @DC1EDIR*00014009
               &JOBEXIT=,                                      @DC1EDIR*00015009
               &NETEXIT=,                                      @DC1EDIR*00016009
               &XMTEXIT=,                                      @D51TDTR*00017009
               &MPWD=,                                         @D52KDIR*00018009
               &ACCOUNT=NO,                                    @D52NDTR*00019009
               &SECNODE=AAAA,                                  @D52HDSW*00020009
               &DUMMY=DUMMY          END OF PROTOTYPE STMT     @D34YSWS 00021009
.*                                                                      00022009
.********************************************************************** 00023009
.*                                                                    * 00024009
.* NOTE TO THE PROGRAMMER:                                            * 00025009
.*   1. IF A NEW OPERAND IS REQUIRED WHICH USES AN OLD(UNUSED) @D52HDSW 00026009
.*      FIELD OF THE GENERATION TABLE THEN SHE MUST CONSIDER   @D52HDSW 00027009
.*      WHAT EFFECT WILL OCCUR IF VSE/POWER IS STARTED USING   @D52HDSW 00028009
.*      AND OLD VSE/POWER GENERATION, E.G. IF THE FIELD        @D52HDSW 00029009
.*      REQUIRES A DEFAULT VALUE, SETTING THE DEFAULT IN THE   @D52HDSW 00030009
.*      NEW CODE WILL NOT SET THE DEFAULT VALUE IN AN OLD      @D52HDSW 00031009
.*      GENERATION, I.E. ONE MAY HAVE TO CHECK AT INITIAL-     @D52HDSW 00032009
.*      IZATION TIME IF THE DEFAULT VALUE IS REQUIRED AND IF   @D52HDSW 00033009
.*      SO, THEN SET THE DEFAULT VALUE THERE ALSO.             @D52HDSW 00034009
.*                                                                    * 00035009
.* CHANGE ACTIVITY - AS FOLLOWS                                       * 00036009
.*                                                                    * 00037009
.* USER SPECIFIED ACCOUNT RECORDS                             @D52NDTR* 00038009
.* MNOTE WHEN KEYWORD OPERAND RDREXIT=(,...)  SPECIFIED       @DA40934* 00039009
.* PWS ENHANCED SECURITY SUPPORT                              @D52HDSW* 00040009
.* ACCOUNTING IMPROVEMENT                            @D52NDTR @KX40749* 00041009
.* REMOVE RXSPOOL FOR ACCNT=YES                      @D52NDTR @KD40159* 00042009
.* MNOTE  FOR ACCOUNT=(,OPER1,OPER2,...,OPERN)       @D52NDTR @KD40373* 00043009
.* BUILD PTF2 PACKAGE: KD40373                                @DY42401* 00044009
.* EXTEND DBLK SIZE TO 64K-16                                 @D61FDAT* 00045009
.* EXPEDITED RESTART OF QUEUE ENTRIES                         @D61FDAT* 00046009
.* REDUCE DBLK FROM 65520 TO 65024, AVOID 65536 FOR FBA       @KXA0381* 00047009
.* SUPPORT FOR TURBO DISPATCHER, NP/PA EXIT WORK UNIT         @D61TDAT* 00048009
.* MSG1V02I VTAM OPEN FAILURE RTNCD=090 X'5A'                 @DA43889* 00049009
.* VSE/POWER 6.1.1 TURBO DISPATCHER SHIPMENT                  @DY44055* 00050009
.* RELEASE 6.3 UPGRADE                                        @D63PDAT* 00051009
.* ALLOW STDLINE/CARD=(N,0) FOR '1Q52I ONCE' (REMOVE DY43991) @DY44504* 00052009
.* EXTEND REAL STORAGE SUPPORT FROM 1024K TO 2048K            @D64VDAT* 00054009
.* ASSURE SLI SUPPORT IS ALWAYS ENABLED FOR FSU               @DY45161* 00054109
.* RELEASE 6.5 UPGRADE                                        @D65DDAT* 00054210
.* INCREASE DEFAULT TRACE-SIZE FROM 12K -> 24K                @D65CDAT* 00054312
.* ADJUST TRACE SIZE TO 8KB BOUNDARY, UP TO 248 K             @D65CDAT* 00054413
.* RELEASE 6.6 UPGRADE                                        @D66GDAT* 00054514
.* RELEASE 6.7 UPGRADE                                        @D67QDAT* 00054615
.* RELEASE 6.8 UPGRADE                                        @D68QDAT* 00054716
.* VERSION 7.1 UPGRADE                                        @D71QDAT* 00054817
.*                                                                    * 00054917
.********************************************************************** 00055017
.*                                                                      00055117
.* ARITHMETIC GLOBALS DEFINITION                                        00055217
         GBLA  &GBL1                   POWER + BSC TABLE LENGTH         00055317
         GBLA  &GBL2                   NUMBER OF BSC LINES              00055417
         GBLA  &GBL3                   NUMBER OF BSC REMOTES            00055517
         GBLA  &GBL4                   MACRO SEQUENCE CHECK             00055617
         GBLA  &GBL5                   POWER+BSC+SNA TBL LNGTH @D32DUSN 00055717
         GBLA  &GBL6                   NUMBER OF SNA REMOTES   @D32DUSN 00056009
         GBLA  &GBL7                   FOR REMOTE ID CHECKING  @D32DUSN 00057009
         GBLA  &GBL8                   FIRST SNA REMOTE ID     @D32DUSN 00058009
         GBLA  &NLUS                   NR OF SNA LOG UNITS     @D32DUSN 00059009
         GBLA  &LULOC                  LOCATION OF LU TABLE    @D34BDSN 00060009
.* CHARACTER GLOBALS DEFINITION                                         00061009
         GBLC  &NM                     NAME SPECIFICATION               00062009
.* ARITHMETIC LOCALS DEFINITION                                         00063009
         LCLA  &DB                     DBLK SPECIFICATION               00064009
         LCLA  &NTFY                   NTFYMSG SPECIFICATION   @D03PIPW 00065009
         LCLA  &BL                     DBLKGP SPECIFICATION    @D23CDWS 00066009
         LCLA  &SPL                    SPLIM  SPECIFICATION    @D23CDWS 00067009
         LCLA  &PY                     PRI SPECIFICATION                00068009
         LCLA  &WL                     WORK LOCAL                       00069009
         LCLA  &I                      USED AS LOOP COUNT      @D03PIPW 00070009
         LCLA  &LT(13)                 LTAB SPECIFICATION               00071009
         LCLA  &LP                     LENGTH VTAM ACB PASSWRD @D32DUSN 00072009
         LCLA  &OP                     OPTION BYTE             @D34ZDQZ 00073009
         LCLA  &TS                     BSC TRACE SIZE IN KB    @D35BIML 00074009
         LCLA  &SO                     SHARED SPOOLING OPTIONS @D02PISS 00075009
         LCLA  &TI(4)                  TIME INTERVALS          @D02PISS 00076009
         LCLA  &MXT(4)                 MAX TIME INTERVALS      @D02PISE 00077009
         LCLA  &LAPPLID                LENGTH APPLID           @D34BDSN 00078009
         LCLA  &OW                     OUTEXIT WORKAREA LENGTH @DC1EDIR 00079009
         LCLA  &RX                     JOB EXIT WORKAREA LENGTH@DC1EDIR 00080009
         LCLA  &PX                     PNET EXIT WORKAREA LNGTH@DC1EDIR 00081009
         LCLA  &TX                     XMTEXIT WORK AREA LENGTH@D51TDTR 00082009
         LCLA  &LISTP                  ACCNT KEYWORD LIST PTR  @D52NDTR 00083009
         LCLA  &KEYP                   ACCNT KEYWORD TABLE PTR @D52NDTR 00084009
         LCLA  &AKTVTAB(16)            ACCNT KEYWORD TABLE VAL @D52NDTR 00085009
         LCLA  &AKTOK(16)              ACCNT SIGNAL TABLE      @KX40749 00086009
         LCLA  &POWX                   ACCNT INFORMATION FIELD @D52NDTR 00087009
         LCLA  &NUMAKT                 NUMBER OF TABLE ENTRIES @D52NDTR 00088009
         LCLA  &NUMOP                  NUMBER OF ACCNT ENTRIES @D52NDTR 00089009
         LCLA  &AKTALL                 HIGHEST ACCOUNTING INFO @D52NDTR 00090009
.* CHARACTER LOCALS DEFINITION                                          00091009
         LCLC  &SID                    SYSTEM-ID               @D02PISS 00092009
         LCLC  &SL                     SUBLIB SPECIFICATION             00093009
         LCLC  &ST(2)                  STDLINE SPECIFICATION            00094009
         LCLC  &SD(2)                  STDCARD SPECIFICATION            00095009
         LCLC  &JB(2)                  JSEP SPECIFICATION               00096009
         LCLC  &NR(2)                  RBS SPECIFICATION                00097009
         LCLC  &RE                     JOBEXIT SPECIFICATION            00098009
         LCLC  &MTYP                   SL MEMBER TYPE          @D03PILW 00099009
         LCLC  &SECN                   SECURITY NODEID         @D52HDSW 00100009
         LCLC  &PRE                    PNET READER EXIT NAME   @D03PIPW 00101009
         LCLC  &NT                     NETWORK DEFINITION TBLE @D03PIPW 00102009
         LCLC  &AC                     ACCOUNT SPECIFICATION            00103009
         LCLC  &PP                     PAUSE PUNCH SPECIFICATION        00104009
         LCLC  &JL                     JLOG SPECIFICATION               00105009
         LCLC  &PW                     VTAM ACB PASSWORD       @D32DUSN 00106009
         LCLC  &SP                     SPOOL MGMT SPECIFICATION@D33PAJB 00107009
         LCLC  &APPLID                 VTAM APPLID             @D34BDSN 00108009
         LCLC  &CHAR1                  ALPHABETIC CHARACTER TBL@D03PIPW 00109009
         LCLC  &CHAR2                  ALPHAMERIC CHARACTER TBL@D03PIPW 00110009
         LCLC  &CHAR3                  ALPHAM-./  CHARACTER TBL@D52KDIR 00111009
         LCLC  &RJEB                   RJEBSC SPECIFICATION    @D03PIPE 00112009
         LCLC  &SH                     SHARED SPECIFICATION    @D03PIQE 00113009
         LCLC  &OE                     OUTPUT EXIT SPEC.       @DC1EDIR 00114009
         LCLC  &TRE                    XMTEXIT NAME            @D51TDTR 00115009
         LCLC  &MP(8)                  MASTER PASSWORD         @D52KDIR 00116009
         LCLC  &AKT(16)                ACCNT KEYWORD TABLE     @D52NDTR 00117009
         LCLC  &LENTRY                 LOCAL DUMMY FIELD       @D52NDTR 00118009
         LCLC  &TENTRY                 LOCAL DUMMY FIELD       @D52NDTR 00119009
         LCLC  &JXM                    JOBEXIT TD-MODE         @D61TDAT 00120009
         LCLC  &OXM                    OUTEXIT TD-MODE         @D61TDAT 00121009
         LCLC  &NXM                    NETEXIT TD-MODE         @D61TDAT 00122009
         LCLC  &XXM                    XMTEXIT TD-MODE         @D61TDAT 00123009
.* BINARY LOCALS DEFINITION                                             00124009
         LCLB  &SHR                    SHARED SPOOL            @D02PISS 00125009
         LCLB  &SSI                    SYS-ID                  @D02PISE 00126009
.*                                                                      00127009
&GBL1    SETA  280                 LENGTH OF GENERATION TABLE  @D03PIPW 00128009
&GBL5    SETA  &GBL1               SAVE LENGTH OF IT                    00129009
.*                                                                      00130009
&CHAR1   SETC  'ABCDEFGHIJKLMNOPQRSTUVWXYZ@#$'   ALPHABETIC CHARACTERS  00131009
&CHAR2   SETC  'ABCDEFGHIJKLMNOPQRSTUVWXYZ@#$0123456789'  ALPHAMERIC    00132009
&CHAR3   SETC  'ABCDEFGHIJKLMNOPQRSTUVWXYZ@#$-./0123456789' ALPHAM.-/   00133009
.*                                                             @D52KDIR 00134009
.*                                                                      00135009
         SPACE 2                                                        00136009
*********************************************************************** 00137009
*                                                                     * 00138009
*              V S E / P O W E R     L O A D E R                      * 00139009
*                                                                     * 00140009
*********************************************************************** 00141009
.*                                                                      00142009
.* IBM DISK OPERATING SYSTEM                                            00143009
         SPACE 2                                                        00144009
* VSE/POWER - POWER - 5686-CF7-03                                       00145017
         SPACE 1                                                        00146009
******************************************************                  00147009
*                                                    *                  00148009
*   LICENSED MATERIALS - PROPERTY OF IBM             *                  00149009
*   THIS MACRO IS "RESTRICTED MATERIALS OF IBM"      *                  00150009
*   5686-CF7 (C) COPYRIGHT IBM CORP. 1979, 2000      *                  00151017
*   SEE COPYRIGHT INSTRUCTIONS                       *                  00152009
*                                                    *                  00153009
******************************************************                  00154009
.*                                                                      00155009
.* MACRO SEQUENCE CHECKING **********                                   00156009
.*                                                                      00157009
         SPACE 1                                                        00158009
         AIF   (&GBL4 EQ 0).POW0      DOUBLE CHECK                      00159009
         MNOTE 5,'MACRO OUT OF SEQUENCE - MACRO IGNORED.'               00160009
         MEXIT                                                          00161009
.POW0    ANOP                                                           00162009
.*                                                                      00163009
.* CHECK FOR POSITIONAL OPERANDS                                        00164009
.*                                                                      00165009
         AIF   (N'&SYSLIST EQ 0).POW1                          @DA08671 00166009
         MNOTE 3,'POSITIONAL OPERANDS NOT ALLOWED - MACRO IGNORED.'     00167009
         MEXIT                                                 @DA08671 00168009
.POW1    ANOP                                                  @DA08671 00169009
&GBL4    SETA  1                       VALID POWER MACRO                00170009
.*                                                                      00171009
.* DBLK SPECIFICATION CHECKING **********                               00172009
.*                                                                      00173009
&DB      SETA  0                       INIT DBLK                        00174009
         AIF   (T'&DBLK EQ 'O').POW4   OMITTED                          00175009
         AIF   (T'&DBLK NE 'N').POW2   NUMERIC                          00176009
         AIF   (&DBLK EQ 0).POW4       OMITTED                          00177009
         AIF   (&DBLK LT 1000).POW2    MINIMUM                 @D23CDWS 00178009
         AIF   (&DBLK GT 65024).POW2   MAXIMUM DBLK            @KXA0381 00179009
&DB      SETA  &DBLK                   USER SPECIFIED DBLK              00180009
         AGO   .POW4                                                    00181009
.POW2    ANOP                                                           00182009
         MNOTE 3,' INVALID DBLK SPECIFICATION - DEFAULT ASSUMED'        00183009
         SPACE 1                                                        00184009
.POW4    ANOP                                                           00185009
.*                                                                      00186009
.* DBLKGP SPECIFICATION CHECKING **********                             00187009
.*                                                                      00188009
&BL      SETA  8                       SET DEFAULT DBLK GROUP  @D63PDAT 00189009
         AIF   (T'&DBLKGP EQ 'O').POW7   OMITTED               @D23CDWS 00190009
         AIF   (T'&DBLKGP NE 'N').POW6   NUMERIC               @D23CDWS 00191009
         AIF   (&DBLKGP EQ 0).POW6       IS USER ....          @D23CDWS 00192009
         AIF   (&DBLKGP EQ 1).POW6          SPECIFICATION IN   @D61FDAT 00193009
         AIF   (&DBLKGP GT 32767).POW6      VALID RANGE ?      @D23CDWS 00194009
&BL      SETA  &DBLKGP                 USER SPECIFIED VALUE    @D23CDWS 00195009
         AGO   .POW7                                           @D23CDWS 00196009
.POW6    ANOP                                                  @D23CDWS 00197009
         MNOTE 3,' INVALID DBLKGP SPECIFICATION - DEFAULT ASSUMED'      00198009
         SPACE 1                                                        00199009
.POW7    ANOP                                                  @D35DI01 00200009
.*                                                                      00201009
.* SPLIM SPECIFICATION CHECKING **********                              00202009
.*                                                                      00203009
&SPL     SETA  90                      SET DEFAULT SPLIM VALUE @D23CDWS 00204009
         AIF   (T'&SPLIM EQ 'O').POW9    BRANCH IF OMITTED     @D23CDWS 00205009
         AIF   (T'&SPLIM NE 'N').POW8    BRANCH IF NOT NUMERIC @D23CDWS 00206009
         AIF   (&SPLIM GT 100).POW8      VALID RANGE ?         @D23CDWS 00207009
&SPL     SETA  &SPLIM                  USER SPECIFIED VALUE    @D23CDWS 00208009
         AGO   .POW9                                           @D23CDWS 00209009
.POW8    ANOP                                                  @D23CDWS 00210009
         MNOTE 3,' INVALID SPLIM SPECIFICATION - DEFAULT ASSUMED'       00211009
         SPACE 1                                                        00212009
.POW9    ANOP                                                  @D23CDWS 00213009
.*                                                                      00214009
.* LTAB SPECIFICATION CHECKING **********                               00215009
.*                                                                      00216009
         AIF   (T'&LTAB EQ 'O').POW14  OMITTED                          00217009
         AIF   (N'&LTAB NE 13).POW12   13 ENTRIES                       00218009
&WL      SETA  1                       INIT LOOP COUNTER                00219009
.POW10   ANOP                                                           00220009
         AIF   (K'&LTAB(&WL) NE 2).POW12 2 DIGITS ENTRIES               00221009
         AIF   (T'&LTAB(&WL) NE 'N').POW12 SELFDEFINING TERM            00222009
&LT(&WL) SETA  &LTAB(&WL)              SET LT LOCAL                     00223009
&WL      SETA  &WL+1                   ADD TO LOOP COUNTER              00224009
         AIF   (&WL LE 13).POW10       LOOP TILL ALL CHECKED            00225009
         AGO   .POW16                                                   00226009
.POW12   ANOP                                                           00227009
         MNOTE 3,' INVALID LTAB, (10,00,05,10,15,20,25,30,35,40,45,50,5*00228009
               6) ASSUMED.'                                             00229009
         SPACE 1                                                        00230009
.POW14   ANOP                                                           00231009
&LT(1)   SETA  66                      DEFAULT                          00232009
&LT(2)   SETA  0                       .                                00233009
&LT(3)   SETA  5                       LTAB                             00234009
&LT(4)   SETA  10                      .                                00235009
&LT(5)   SETA  15                      SETTING                          00236009
&LT(6)   SETA  20                      .                                00237009
&LT(7)   SETA  25                      .                                00238009
&LT(8)   SETA  30                      .                                00239009
&LT(9)   SETA  35                      .                                00240009
&LT(10)  SETA  40                      .                                00241009
&LT(11)  SETA  45                      .                                00242009
&LT(12)  SETA  50                      .                                00243009
&LT(13)  SETA  56                      .                                00244009
         AGO   .POW24                                                   00245009
.POW16   ANOP                                                           00246009
&LT(1)   SETA  &LT(1)+&LT(13)                                           00247009
&WL      SETA  1                                                        00248009
.POW18   ANOP                                                           00249009
&WL      SETA  &WL+1                                                    00250009
         AIF   (&LT(&WL) EQ 0).POW20                                    00251009
&LT(&WL) SETA  &LT(&WL)-&LTAB(2)                                        00252009
         AIF   (&LT(&WL) GE 0).POW20                                    00253009
&LT(&WL) SETA  &LT(&WL)+&LT(1)                                          00254009
         AIF   (&LT(&WL) LT 0).POW12                                    00255009
.POW20   ANOP                                                           00256009
         AIF   (&LT(&WL) GT &LT(1)).POW12                               00257009
         AIF   (&WL LT 13).POW18                                        00258009
.POW24   ANOP                                                           00259009
.*                                                                      00260009
.* PRI SPECIFICATION CHECKING **********                                00261009
.*                                                                      00262009
&PY      SETA  3                       DEFAULT PRI                      00263009
         AIF   (T'&PRI EQ 'O').POW30   OMITTED                          00264009
         AIF   (T'&PRI NE 'N').POW28                                    00265009
         AIF   (&PRI LT 0 OR &PRI GE 10).POW28                          00266009
&PY      SETA  &PRI                    USER SPECIFIED PRI               00267009
         AGO   .POW30                                                   00268009
.POW28   ANOP                                                           00269009
         MNOTE 3,' INVALID PRI, 3 ASSUMED.'                             00270009
         SPACE 1                                                        00271009
.POW30   ANOP                                                           00272009
.*                                                                      00273009
.* NAME SPECIFICATION CHECKING **********                               00274009
.*                                                                      00275009
&NM      SETC  'POWER'                 DEFAULT NAME                     00276009
         AIF   (T'&NAME EQ 'O').POW34  OMITTED                          00277009
         AIF   (K'&NAME GT 8).POW32    MAX 7 CHARACTERS                 00278009
&NM      SETC  '&NAME'                 USER SPECIFIED NAME              00279009
         AGO   .POW34                                                   00280009
.POW32   ANOP                                                           00281009
         MNOTE 3,'INVALID NAME, DEFAULT ASSUMED.'                       00282009
.POW34   ANOP                                                           00283009
.*                                                                      00284009
.* SUBLIB SPECIFICATION CHECKING **********                             00285009
.*                                                                      00286009
&SL      SETC  'A'                     DEFAULT SUBLIB          @DY45161 00287009
&MTYP    SETC  'SOURCE  '              DEFAULT MEM TYPE        @DY45161 00288009
         AIF   (T'&SUBLIB EQ 'O').POW42  OMITTED                        00289009
         AIF   (K'&SUBLIB NE 1).POW38  ONE CHARACTER                    00290009
&WL      SETA  1                       SET LOOP COUNTER                 00291009
.POW36   ANOP                                                           00292009
         AIF   ('&SUBLIB' EQ   'ABCDFGHIJKLMNOPQRSTUVWXYZ0123456789$#@'*00293009
               (&WL,1)).POW40                                           00294009
&WL      SETA  &WL+1                   UPDATE LOOP COUNTER              00295009
         AIF   (&WL LE 38).POW36       LOOP UNTILL ALL CHECKED          00296009
.POW38   ANOP                                                           00297009
         AIF   ('&SUBLIB' NE 'NO').POW39                       @DY45161 00298009
         MNOTE 3,'SUBLIB=NO IGNORED, SLI SUPPORT GENERATED, SUBLIB=A.' *00299009
                                                               @DY45161 00300009
         AGO   .POW42                                          @DY45161 00301009
.POW39   ANOP                                                  @DY45161 00302009
         MNOTE 3,'INVALID SUBLIB, SLI SUPPORT GENERATED, SUBLIB=A.'    *00303009
                                                               @DY45161 00304009
         SPACE 1                                                        00305009
         AGO   .POW42                                                   00306009
.POW40   ANOP                                                           00307009
&SL      SETC  '&SUBLIB'               USER SPECIFIED SUBLIB            00308009
.POW42   ANOP                                                           00309009
.*                                                                      00310009
.* STDLINE SPECIFICATION CHECKING **********                            00311009
.*                                                                      00312009
         AIF   (N'&STDLINE EQ 0).POW50  OMITTED                         00313009
         AIF   (N'&STDLINE GE 3).POW48 MAX 2 ENTRIES                    00314009
&WL      SETA  2                       MAX NUMBER OF ENTRIES            00315009
.POW44   ANOP                                                           00316009
         AIF   (T'&STDLINE(&WL) EQ 'O').POW46  OMITTED                  00317009
         AIF   (T'&STDLINE(&WL) NE 'N' OR K'&STDLINE(&WL) GE 7 ).POW48  00318009
&ST(&WL) SETC  '&STDLINE(&WL)'         USER SPECIFIED STDLINE           00319009
.POW46   ANOP                                                           00320009
&WL      SETA  &WL-1                   NEXT ENTRY                       00321009
         AIF   (&WL NE 0).POW44        LOOP TILL ALL PROCESSED          00322009
         AIF   (T'&STDLINE(1) NE 'O' AND T'&STDLINE(2) NE 'O').POW52    00323009
         AIF   (T'&STDLINE(1) EQ 'O').POW47                             00324009
&ST(2)   SETC  '&ST(1)'                MAKE PARAMETERS EQUAL            00325009
         AGO   .POW52                                                   00326009
.POW47   ANOP                                                           00327009
&ST(1)   SETC  '&ST(2)'                MAKE PARAMETERS EQUAL            00328009
         AGO   .POW52                                                   00329009
.POW48   ANOP                                                           00330009
         MNOTE 3,' INVALID STDLINE, (0,0) ASSUMED.'                     00331009
         SPACE 1                                                        00332009
.POW50   ANOP                                                           00333009
&ST(1)   SETC  '0'                     DEFAULT STDLINE                  00334009
&ST(2)   SETC  '0'                     DEFAULT STDLINE                  00335009
.POW52   ANOP                                                           00336009
.*                                                                      00337009
.* STDCARD SPECIFICATION CHECKING **********                            00338009
.*                                                                      00339009
         AIF   (N'&STDCARD EQ 0).POW60 OMITTED                          00340009
         AIF   (N'&STDCARD GE 3).POW58 MAX 2 ENTRIES                    00341009
&WL      SETA  2                       MAX NUMBER OF ENTRIES            00342009
.POW54   ANOP                                                           00343009
         AIF   (T'&STDCARD(&WL) EQ 'O').POW56  OMITTED                  00344009
         AIF   (T'&STDCARD(&WL) NE 'N' OR K'&STDCARD(&WL) GE 7).POW58   00345009
&SD(&WL) SETC  '&STDCARD(&WL)'         USER SPECIFIED STDCARD           00346009
.POW56   ANOP                                                           00347009
&WL      SETA  &WL-1                   NEXT ENTRY                       00348009
         AIF   (&WL NE 0).POW54        LOOP TILL ALL PROCESSED          00349009
         AIF   (T'&STDCARD(1) NE 'O' AND T'&STDCARD(2) NE 'O').POW62    00350009
         AIF   (T'&STDCARD(1) EQ 'O').POW57                             00351009
&SD(2)   SETC  '&SD(1)'                MAKE PARAMETERS EQUAL            00352009
         AGO   .POW62                                                   00353009
.POW57   ANOP                                                           00354009
&SD(1)   SETC  '&SD(2)'                MAKE PARAMETERS EQUAL            00355009
         AGO   .POW62                                                   00356009
.POW58   ANOP                                                           00357009
         MNOTE 3,' INVALID STDCARD, (0,0) ASSUMED.'                     00358009
         SPACE 1                                                        00359009
.POW60   ANOP                                                           00360009
&SD(1)   SETC  '0'                     DEFAULT STDCARD                  00361009
&SD(2)   SETC  '0'                     DEFAULT STDCARD                  00362009
.POW62   ANOP                                                           00363009
.*                                                                      00364009
.* JSEP SPECIFICATION CHECKING **********                               00365009
.*                                                                      00366009
&JB(1)   SETC  '0'                     DEFAULT PRINT JSEP               00367009
&JB(2)   SETC  '0'                     DEFAULT PUNCH JSEP               00368009
         AIF   (N'&JSEP EQ 0).POW70    OMITTED                          00369009
         AIF   (N'&JSEP GE 3).POW68    MAX 2 ENTRIES                    00370009
&WL      SETA  2                       MAX NUMBER OF ENTRIES            00371009
.POW64   ANOP                                                           00372009
         AIF   (T'&JSEP(&WL) EQ 'O').POW66  OMITTED                     00373009
         AIF   (T'&JSEP(&WL) NE 'N' OR K'&JSEP(&WL) GE 2).POW68         00374009
&JB(&WL) SETC  '&JSEP(&WL)'            USER SPECIFIED JSEP              00375009
.POW66   ANOP                                                           00376009
&WL      SETA  &WL-1                   NEXT ENTRY                       00377009
         AIF   (&WL NE 0).POW64        LOOP TILL ALL PROCESSED          00378009
         AGO   .POW70                                                   00379009
.POW68   ANOP                                                           00380009
         MNOTE 3,' INVALID JSEP, (&JB(1),&JB(2)) ASSUMED.'              00381009
         SPACE 1                                                        00382009
.POW70   ANOP                                                           00383009
.*                                                                      00384009
.* ACCOUNT SPECIFICATION CHECKING **********                            00385009
.*                                                                      00386009
&AC      SETC  ' '                     DEFAULT ACCOUNT                  00387009
.*                                                                      00388009
.* INITIALISE ACCOUNT KEYWORD TABLE. THIS TABLE CORRESPONDS             00389009
.* TO THE ACCOUNTING INFORMATION FIELD IPW$POWX IN THE                  00390009
.* VSE/POWER GENERATION TABLE. RXSPOOL IS NO NEW ACCOUNT       @KD40373 00391009
.* RECORD TYPE, BUT IS USED TO EXCLUDE SAS OPERATION ACCOUNT   @KD40373 00392009
.* RECORDS RESULTING FROM $SPL.... JOBS.                       @KD40373 00393009
.*                                                                      00394009
&AKT(1)  SETC  'AFP'         A        ADVANCED FUNCT. PRINT.   @D52NDTR 00395009
&AKT(2)  SETC  'XCONN'       C        SAS CONNECT ACCNT RECORD @D52NDTR 00396009
&AKT(3)  SETC  'EXEC'        E        EXECUTION ACCNT RECORD   @D52NDTR 00397009
&AKT(4)  SETC  'LIST'        L        LIST ACCNT RECORD        @D52NDTR 00398009
&AKT(5)  SETC  'TRANS'       M        PNET XMIT. ACCNT RECORD  @D52NDTR 00399009
&AKT(6)  SETC  'PNET'        N        PNET NETW. ACCNT RECORD  @D52NDTR 00400009
&AKT(7)  SETC  'PUNCH'       P        PUNCH ACCNT RECORD       @D52NDTR 00401009
&AKT(8)  SETC  'READER'      R        READER ACCNT RECORD      @D52NDTR 00402009
&AKT(9)  SETC  'SNA'         S        RJE SNA ACCNT RECORD     @D52NDTR 00403009
&AKT(10) SETC  'BSC'         T        RJE BSC ACCNT RECORD     @D52NDTR 00404009
&AKT(11) SETC  'RECV'        V        PNET RECV. ACCNT RECORD  @D52NDTR 00405009
&AKT(12) SETC  'XSPOOL'      X        SAS OPER. ACCNT RECORD   @D52NDTR 00406009
&AKT(13) SETC  'RXSPOOL'     Y        RED. SAS OPER. ACCNT REC.@D52NDTR 00407009
&AKT(14) SETC  ' '                    RES. FOR FUT. ACCNT REC. @D52NDTR 00408009
&AKT(15) SETC  ' '                    RES. FOR FUT. ACCNT REC. @D52NDTR 00409009
&AKT(16) SETC  ' '                    RES. FOR FUT. ACCNT REC. @D52NDTR 00410009
.*                                                                      00411009
.* IN THE FOLLOWING TABLE THERE EXISTS AN ENTRY FOR EACH VALID @KX40749 00412009
.* OPERAND OF THE KEYWORD LIST OF THE ACCOUNT OPERAND. THIS    @KX40749 00413009
.* TABLE IS USED TO SIGNAL THAT A KEYWORD OPERAND ALREADY      @KX40749 00414009
.* APPEARED IN THE KEYWORD LIST.                               @KX40749 00415009
.*                                                                      00416009
&AKTOK(1)  SETA 0             A       ADVANCED FUNCT. PRINT.   @D52NDTR 00417009
&AKTOK(2)  SETA 0             C       SAS CONNECT ACCNT RECORD @D52NDTR 00418009
&AKTOK(3)  SETA 0             E       EXECUTION ACCNT RECORD   @D52NDTR 00419009
&AKTOK(4)  SETA 0             L       LIST ACCNT RECORD        @D52NDTR 00420009
&AKTOK(5)  SETA 0             M       PNET XMIT. ACCNT RECORD  @D52NDTR 00421009
&AKTOK(6)  SETA 0             N       PNET NETW. ACCNT RECORD  @D52NDTR 00422009
&AKTOK(7)  SETA 0             P       PUNCH ACCNT RECORD       @D52NDTR 00423009
&AKTOK(8)  SETA 0             R       READER ACCNT RECORD      @D52NDTR 00424009
&AKTOK(9)  SETA 0             S       RJE SNA ACCNT RECORD     @D52NDTR 00425009
&AKTOK(10) SETA 0             T       RJE BSC ACCNT RECORD     @D52NDTR 00426009
&AKTOK(11) SETA 0             V       PNET RECV. ACCNT RECORD  @D52NDTR 00427009
&AKTOK(12) SETA 0             X       SAS OPER. ACCNT RECORD   @D52NDTR 00428009
&AKTOK(13) SETA 0             Y       RED. SAS OPER. ACCNT REC.@D52NDTR 00429009
&AKTOK(14) SETA 0                     RES. FOR FUT. ACCNT REC. @D52NDTR 00430009
&AKTOK(15) SETA 0                     RES. FOR FUT. ACCNT REC. @D52NDTR 00431009
&AKTOK(16) SETA 0                     RES. FOR FUT. ACCNT REC. @D52NDTR 00432009
.*                                                                      00433009
.* SET UP CORRESPONDING BIT VALUES FOR RELEVANT KEYWORD TABLE           00434009
.* ENTRIES OF TABLE &AKT(1..16) AND &AKTOK(1..16)                       00435009
.*                                                                      00436009
&AKTALL      SETA  65535              VALUE FOR ALL ACCNT RECS @D52NDTR 00437009
&AKTVTAB(1)  SETA  32768       A      VALUE FOR AFP      A     @D52NDTR 00438009
&AKTVTAB(2)  SETA  16384       C      VALUE FOR XCONN    C     @D52NDTR 00439009
&AKTVTAB(3)  SETA   8192       E      VALUE FOR EXEC     E     @D52NDTR 00440009
&AKTVTAB(4)  SETA   4096       L      VALUE FOR LIST     L     @D52NDTR 00441009
&AKTVTAB(5)  SETA   2048       M      VALUE FOR TRANS    M     @D52NDTR 00442009
&AKTVTAB(6)  SETA   1024       N      VALUE FOR PNET     N     @D52NDTR 00443009
&AKTVTAB(7)  SETA    512       P      VALUE FOR PUNCH    P     @D52NDTR 00444009
&AKTVTAB(8)  SETA    256       R      VALUE FOR READER   R     @D52NDTR 00445009
&AKTVTAB(9)  SETA    128       S      VALUE FOR SNA      S     @D52NDTR 00446009
&AKTVTAB(10) SETA     64       T      VALUE FOR BSC      T     @D52NDTR 00447009
&AKTVTAB(11) SETA     32       V      VALUE FOR RECV     V     @D52NDTR 00448009
&AKTVTAB(12) SETA     16       X      VALUE FOR XSPOOL   X     @D52NDTR 00449009
&AKTVTAB(13) SETA      8       Y      VALUE FOR RXSPOOL  Y     @D52NDTR 00450009
&AKTVTAB(14) SETA      4              RES. FOR FUT. ACCNT REC. @D52NDTR 00451009
&AKTVTAB(15) SETA      2              RES. FOR FUT. ACCNT REC. @D52NDTR 00452009
&AKTVTAB(16) SETA      1              RES. FOR FUT. ACCNT REC. @D52NDTR 00453009
.*                                                                      00454009
&NUMAKT      SETA     13              TOTAL NO. OF TBL ENTRIES @D52NDTR 00455009
&NUMOP       SETA     N'&ACCOUNT      TOTAL NO. OF LST ENTRIES @D52NDTR 00456009
.*                                                                      00457009
&POWX    SETA  0                      INIT. BIT ACCUMULATOR    @D52NDTR 00458009
         AIF   (N'&ACCOUNT NE 0 AND T'&ACCOUNT EQ 'O').POW73   @KD40373 00459009
         AIF   (T'&ACCOUNT EQ 'O' OR '&ACCOUNT' EQ 'NO').POW74          00460009
         AIF   ('&ACCOUNT' EQ 'YES').POW72                              00461009
         AIF   (&NUMOP GT &NUMAKT).AKTERR  TOO MUCH OPERANDS   @KX40749 00462009
.*                                                                      00463009
.* SET UP BIT POSITIONS IN &POWX ACCORDING TO SPECIFIED                 00464009
.* KEYWORDS IN KEYWORD LIST OF THE ACCOUNT= OPERAND.                    00465009
.*                                                                      00466009
.* FOR EACH SPECIFIED KEYWORD LIST ENTRY THE OPERAND TABLE              00467009
.* &AKT IS SEARCHED FOR THE ENTRY. IF NOT FOUND, THE SPECIFIED          00468009
.* ENTRY IS NOT CORRECTLY SPECIFIED. AN MNOTE IS WRITTEN AND THE        00469009
.* NEXT LIST ENTRY IS VALIDATED. THIS IS REPEATED UNTIL THE LAST        00470009
.* KEYWORD LIST ENTRY HAS BEEN PROCESSED                                00471009
.*                                                                      00472009
.* AT FIRST IT IS CHECKED WHETHER RXSPOOL HAS BEEN SPECIFIED            00473009
.* IN THE KEYWORD LIST. IF RXSPOOL IS ENCOUNTERED XSPOOL IS             00474009
.* SET UP IN THE SIGNAL LIST AS WELL AS IN THE ACCUMULATOR              00475009
.* FIELD &POWX.                                                         00476009
.*                                                                      00477009
         SPACE 2                                                        00478009
&LISTP   SETA  0                      INIT LIST POINTER        @KX40749 00479009
.*                                                                      00480009
.DOUN0   ANOP                         DO UNTIL ENTRIES MATCH   @KX40749 00481009
&LISTP   SETA  &LISTP+1                 INCR. LIST POINTER     @KX40749 00482009
         AIF (&LISTP GT &NUMOP).ODUN0   IF END OF LIST - LEAVE @KX40749 00483009
&LENTRY  SETC  '&ACCOUNT(&LISTP)'       GET LIST ENTRY         @KX40749 00484009
         AIF ('&LENTRY' NE '&AKT(13)').DOUN0 NO MATCH-ITERATE! @KX40749 00485009
&POWX    SETA  &AKTVTAB(12)             SET UP XSPOOL          @KX40749 00486009
&AKTOK(12) SETA 1                       SIGNAL XSPOOL          @KX40749 00487009
.ODUN0   ANOP                         END UNTIL                @KX40749 00488009
         SPACE 1                                                        00489009
.*                                                                      00490009
.* IF ANY LIST ENTRY IS FOUND IN THE TABLE, THE CORRESPONDING  @KX40749 00491009
.* BIT IS TURNED ON IN THE BIT ACCUMULATOR &POWX. IN ORDER TO  @KX40749 00492009
.* AVOID THAT A VALID KEYWORD OPERAND IS SPECIFIED REPEATEDLY  @KX40749 00493009
.* THE RELEVANT SIGNAL TABLE ENTRY IS SWITCHED FROM 0 TO 1     @KX40749 00494009
.* WHEN A VALID LIST ENTRY HAS BEEN ENCOUNTERED.               @KX40749 00495009
.*                                                                      00496009
         SPACE 2                                                        00497009
&LISTP   SETA  0                      INIT. LIST POINTER       @D52NDTR 00498009
.*                                                                      00499009
.DOUN1   ANOP                         DO UNTIL END OF LIST     @D52NDTR 00500009
&LISTP   SETA  &LISTP+1                 INCR. LIST POINTER     @D52NDTR 00501009
         AIF (&LISTP GT &NUMOP).ODUN1   IF END OF LST, LEAVE   @D52NDTR 00502009
&LENTRY  SETC   '&ACCOUNT(&LISTP)'      GET LIST ENTRY         @D52NDTR 00503009
&KEYP    SETA  0                        INIT. TABLE POINTER    @D52NDTR 00504009
.DOUN2   ANOP                           DO UNTIL EOT OR FOUND  @D52NDTR 00505009
&KEYP    SETA  &KEYP+1                    INCR. TABLE PTR      @D52NDTR 00506009
         AIF (&KEYP GT &NUMAKT).ODUN2     LEAVE IF EOT REACHED @D52NDTR 00507009
&TENTRY  SETC  '&AKT(&KEYP)'              GET TABLE ENTRY      @D52NDTR 00508009
         AIF ('&TENTRY' NE '&LENTRY').DOUN2 IF NOT EQUAL, TRY NEXT     *00509009
                                          TABLE ENTRY          @D52NDTR 00510009
         AIF (&AKTOK(&KEYP) EQ 1).DOUN1 LST ENTRY ALR'Y THERE? @KX40749 00511009
&AKTOK(&KEYP) SETA 1                    ..NO, SWITCH ON        @KX40749 00512009
&POWX    SETA  &POWX+&AKTVTAB(&KEYP)    ADD VALUE TO ACCU.     @D52NDTR 00513009
&AC      SETC  'A'                      SET ACCOUNT=YES        @D52NDTR 00514009
         AGO   .DOUN1                 ITER. NXT LST ENTRY      @D52NDTR 00515009
.*                                                                      00516009
         SPACE 2                                                        00517009
.ODUN2   ANOP                         SPEC. ENTRY NOT FOUND    @D52NDTR 00518009
         MNOTE 3,'INVALID ACCOUNT RECORD SPECIFICATION:''&LENTRY'''    *00519009
                                                               @D52NDTR 00520009
         SPACE 1                                               @D52NDTR 00521009
         AGO   .DOUN1                 ITER. NXT LST ENTRY      @D52NDTR 00522009
.AKTERR  ANOP                                                  @D52NDTR 00523009
         MNOTE 3,'ACCOUNT OPERAND EXCEEDS &NUMAKT SUBPARAMETERS, ACCOUN*00524009
               T=NO ASSUMED.'                                  @KD40373 00525009
         SPACE 1                                                        00526009
.ODUN1   ANOP                         LIST PROCESSING ENDED    @D52NDTR 00527009
         AGO   .POW74                 CONTINUE WITH NEXT OPER. @D52NDTR 00528009
.POW72   ANOP                                                           00529009
&AC      SETC  'A'                    ACCOUNT=YES                       00530009
&POWX    SETA  &AKTALL                TURN ON ALL BITS         @D52NDTR 00531009
&POWX    SETA  &POWX-&AKTVTAB(13)     SWITCH OFF RXSPOOL       @KD40159 00532009
         AGO   .POW74                 CONTINUE WITH NEXT OPER. @KD40373 00533009
.POW73   MNOTE 3,'INVALID ACCOUNT SPECIFICATION, ACCOUNT=NO ASSUMED.'  *00534009
                                                               @KD40373 00535009
.POW74   ANOP                                                           00536009
.*                                                                      00537009
.* RBS SPECIFICATION CHECKING **********                                00538009
.*                                                                      00539009
&NR(1)   SETC  '0'                     DEFAULT PRINT RBS                00540009
&NR(2)   SETC  '0'                     DEFAULT PUNCH RBS                00541009
         AIF   (N'&RBS EQ 0).POW82     OMITTED                          00542009
         AIF   (N'&RBS GE 3).POW80     MAX 2 ENTRIES                    00543009
&WL      SETA  2                       MAX NUMBER OF ENTRIES            00544009
.POW76   ANOP                                                           00545009
         AIF   (T'&RBS(&WL) EQ 'O').POW78  OMITTED                      00546009
         AIF   (T'&RBS(&WL) NE 'N' OR K'&RBS(&WL) GE 7).POW80           00547009
&NR(&WL) SETC  '&RBS(&WL)'             USER SPECIFIED RBS               00548009
.POW78   ANOP                                                           00549009
&WL      SETA  &WL-1                   NEXT ENTRY                       00550009
         AIF   (&WL NE 0).POW76        LOOP TILL ALL PROCESSED          00551009
         AGO   .POW82                                                   00552009
.POW80   ANOP                                                           00553009
         MNOTE 3,' INVALID RBS, (&NR(1),&NR(2)) ASSUMED.'               00554009
         SPACE 1                                                        00555009
.POW82   ANOP                                                           00556009
.*                                                                      00557009
.* JLOG SPECIFICATION CHECKING **********                               00558009
.*                                                                      00559009
&JL      SETC  'L'                     DEFAULT JLOG                     00560009
         AIF   (T'&JLOG EQ 'O' OR '&JLOG' EQ 'YES').POW86               00561009
         AIF   ('&JLOG' EQ 'NO').POW84                                  00562009
         MNOTE 3,' INVALID JLOG, YES ASSUMED.'                          00563009
         SPACE 1                                                        00564009
         AGO   .POW86                                                   00565009
.POW84   ANOP                                                           00566009
&JL      SETC  ' '                     JLOG=NO                          00567009
.POW86   ANOP                                                           00568009
.*                                                                      00569009
.* PAUSE SPECIFICATION CHECKING **********                              00570009
.*                                                                      00571009
&PP      SETC  ' '                     DEFAULT PAUSE                    00572009
         AIF   (T'&PAUSE EQ 'O' OR '&PAUSE' EQ 'NO').POW90              00573009
         AIF   ('&PAUSE' EQ 'YES').POW88                                00574009
         MNOTE 3,' INVALID PAUSE, NO ASSUMED.'                          00575009
         SPACE 1                                                        00576009
         AGO   .POW90                                                   00577009
.POW88   ANOP                                                           00578009
&PP      SETC  'P'                     PAUSE=YES                        00579009
.POW90   ANOP                                                           00580009
.*                                                                      00581009
.* RDREXIT SPECIFICATION CHECKING **********                            00582009
.*                                                                      00583009
         AIF   (N'&RDREXIT EQ 0 OR '&RDREXIT' EQ 'NO').POW96   @DA40934 00584009
         AIF   (T'&RDREXIT(1) EQ 'O').POW92  BRANCH IF OMITTED @DA40934 00585009
         MNOTE 3,' RDREXIT OPERAND NO LONGER SUPPORTED, USE JOBEXIT OR X00586009
               NETEXIT.'                                       @DC1EDIR 00587009
         SPACE 1                                                        00588009
         AGO  .POW96                                           @DA40934 00589009
         AIF   (T'&RDREXIT EQ 'O').POW92     BRANCH IF OMITTED @DA40934 00590009
.POW92   ANOP                                                  @DA40934 00591009
         AIF   (T'&RDREXIT(2) EQ 'O').POW96  BRANCH IF OMITTED @DA40934 00592009
         MNOTE 3,' RDREXIT OPERAND NO LONGER SUPPORTED, USE JOBEXIT OR X00593009
               NETEXIT.'                                       @DA40934 00594009
         SPACE 1                                                        00595009
.POW96   ANOP                                                  @D32DUSN 00596009
.*                                                             @D32DUSN 00597009
.* SNA SPECIFICATION CHECKING **********                       @D32DUSN 00598009
.*                                                             @D32DUSN 00599009
&NLUS    SETA 0                        NR LU BLOCKS, DEFAULT 0 @D32DUSN 00600009
&LP      SETA 0                        LENGTH PSWRD, DEFAULT 0 @D32DUSN 00601009
&PW      SETC ' '                      PSSWORD, DEFAULT BLANKS @D32DUSN 00602009
&LAPPLID SETA  5                       DEFAULT LENGTH          @D34BDSN 00603009
&APPLID  SETC  'POWER'                 DEFAULT APPLID          @D34BDSN 00604009
.*                                                             @D32DUSN 00605009
         AIF  (N'&SNA EQ 0).POW106B    SNA OMITTED             @D32DUSN 00606009
         AIF  (N'&SNA LE 3).POW97      MORE THAN 3 PARAMETERS? @DA43889 00607009
         MNOTE 8,'SNA OPERAND CONTAINS TOO MANY PARAMETERS, DEFAULTS ARX00608009
               E TAKEN'                                        @DA43889 00609009
         AGO   .POW106B                TAKE DEFAULTS           @DA43889 00610009
.POW97   ANOP                                                  @DA43889 00611009
&LULOC   SETA  16                      LU TABLE LENGTH         @D02PIQE 00612009
         AIF   ('&SNA' EQ 'YES').POW106B  USED DEFAULT SETUP   @D03PIQW 00613009
.*                                                             @D32DUSN 00614009
         AIF  (T'&SNA(1) EQ 'O').POW102 LUNUM OMITTED          @D32DUSN 00615009
         AIF  (T'&SNA(1) NE 'N').POW98 LUNUM NOT NUMERIC       @D32DUSN 00616009
         AIF  (&SNA(1) LT 251).POW100                          @D22DDWS 00617009
.POW98   MNOTE 3,'INVALID NUMBER OF LOGICAL UNITS - SPECIFICATION IGNORX00618009
               ED'                                             @D32DUSN 00619009
         AGO  .POW102                                          @D32DUSN 00620009
.POW100  ANOP                                                  @D32DUSN 00621009
&NLUS    SETA &SNA(1)                  SET NR OF LOGICAL UNITS @D32DUSN 00622009
.POW102  ANOP                                                  @D32DUSN 00623009
         AIF  (T'&SNA(2) EQ 'O').POW106  PASSWORD OMITTED      @D32DUSN 00624009
         AIF  (K'&SNA(2) GT 8).POW104 PASSWORD > 8 CHARACTERS  @D32DUSN 00625009
&PW      SETC '&SNA(2)'                SET PASSWORD            @D32DUSN 00626009
&LP      SETA K'&SNA(2)                SET LENGTH PASSWORD     @D32DUSN 00627009
         AGO  .POW106                                          @D32DUSN 00628009
.POW104  ANOP                                                  @D32DUSN 00629009
         MNOTE 3,'INVALID PASSWORD - SPECIFICATION IGNORED'    @D32DUSN 00630009
.POW106  ANOP                                                  @D32DUSN 00631009
         AIF   (T'&SNA(3) EQ 'O').POW106B APPLID NOT SPECIFIED @D34BDSN 00632009
         AIF   (K'&SNA(3) GT 8).POW106A TRUNCATE TO 8          @D34BDSN 00633009
&LAPPLID SETA  K'&SNA(3)               SET COUNT               @D34BDSN 00634009
&APPLID  SETC  '&SNA(3)'               SET APPLID              @D34BDSN 00635009
         AGO   .POW106B                CONTINUE                @D34BDSN 00636009
.POW106A MNOTE 3,' APPLID LENGTH TRUNCATED TO 8'               @D34BDSN 00637009
&LAPPLID SETA  8                       SET LENGTH              @D34BDSN 00638009
&APPLID  SETC  '&SNA(3)'(1,8)          SET APPLID              @D34BDSN 00639009
.POW106B ANOP                          CONTINUE MAINLINE       @D34BDSN 00640009
.*                                                             @D33PAJB 00641009
.* SPOOL MANAGEMENT SPECIFICATION CHECKING **********          @D33PAJB 00642009
.*                                                             @D33PAJB 00643009
&SP      SETC  ' '                     DEFAULT SPOOL           @D33PAJB 00644009
         AIF   (T'&SPOOL EQ 'O' OR '&SPOOL' EQ 'NO').POW110    @D33PAJB 00645009
         AIF   ('&SPOOL' EQ 'YES').POW108                      @D33PAJB 00646009
         MNOTE 3,' INVALID SPOOL, NO ASSUMED.'                 @D33PAJB 00647009
         SPACE 1                                               @D33PAJB 00648009
         AGO   .POW110                                         @D33PAJB 00649009
.POW108  ANOP                                                  @D33PAJB 00650009
&SP      SETC  'S'                     SPOOL=YES               @D33PAJB 00651009
.POW110  ANOP                                                  @D33PAJB 00652009
.*                                                                      00653009
.* FEED 3540 SPECIFICATION CHECKING **********                          00654009
.*                                                                      00655009
&OP      SETA  0                       DEFAULT =NO             @D34ZDQD 00656009
         AIF   (T'&FEED EQ 'O' OR '&FEED' EQ 'NO').POW120      @D34ZDQD 00657009
         AIF   ('&FEED' EQ 'YES').POW118                       @D34ZDQD 00658009
         MNOTE 3,'INVALID FEED, NO ASSUMED.'                   @D34ZDQD 00659009
         SPACE 1                                                        00660009
         AGO   .POW120                 FEED = NO               @D34ZDQD 00661009
.POW118  ANOP                                                  @D34ZDQD 00662009
&OP      SETA  &OP+1                   FEED = YES              @D34ZDQD 00663009
.POW120  ANOP                          FEED = NO               @D34ZDQD 00664009
.*                                                                      00665009
.*  CHANNEL 12 SPECIFICATION CHECKING ***********                       00666009
.*                                                                      00667009
         AIF   (T'&MULT12 EQ 'O' OR '&MULT12' EQ 'NO').POW130  QD34ZDQZ 00668009
         AIF   ('&MULT12' EQ 'YES').POW128                     @D34ZDQZ 00669009
         MNOTE 3,' INVALID MULT12, NO ASSUMED.'                @D34ZDQZ 00670009
         SPACE 1                                                        00671009
         AGO   .POW130                 MULT12 = NO             @D34ZDQZ 00672009
.POW128  ANOP                                                  @D34ZDQZ 00673009
&OP      SETA  &OP+2                   MULT12 = YES            @D34ZDQZ 00674009
.POW130  ANOP                                                  @D34ZDQZ 00675009
.*                                                                      00676009
.*  CLRPRT SPECIFICATION CHECKING ***********                  @D34YSWS 00677009
.*                                                                      00678009
         AIF   (T'&CLRPRT EQ 'O' OR '&CLRPRT' EQ 'YES').POW138 @D34YSWS 00679009
         AIF   ('&CLRPRT' EQ 'NO').POW140                      @D34YSWS 00680009
         MNOTE 3,' INVALID CLRPRT, YES ASSUMED.'               @D34YSWS 00681009
.POW138  ANOP                                                  @D34YSWS 00682009
&OP      SETA  &OP+128                 CLRPRT = YES            @D34YSWS 00683009
.POW140  ANOP                                                  @D34YSWS 00684009
.*                                                                      00685009
.*  MRKFRM SPECIFICATION CHECKING ***********                  @D34YSWS 00686009
.*                                                                      00687009
         AIF   (T'&MRKFRM EQ 'O' OR '&MRKFRM' EQ 'YES').POW148 @D34YSWS 00688009
         AIF   ('&MRKFRM' EQ 'NO').POW150                      @D34YSWS 00689009
         MNOTE 3,' INVALID MRKFRM, YES ASSUMED.'               @D34YSWS 00690009
         SPACE 1                                               @D34YSWS 00691009
.POW148  ANOP                                                  @D34YSWS 00692009
&OP      SETA  &OP+64                  MRKFRM = YES            @D34YSWS 00693009
.POW150  ANOP                                                  @D34YSWS 00694009
.*                                                                      00695009
.*  COPYSEP SPECIFICATION CHECKING ***********                 @D34YSWS 00696009
.*                                                                      00697009
         AIF   (T'&COPYSEP EQ 'O' OR '&COPYSEP' EQ 'YES').POW160       *00698009
                                                               @D34YSWS 00699009
         AIF   ('&COPYSEP' EQ 'NO').POW158                     @D34YSWS 00700009
         MNOTE 3,' INVALID COPYSEP, YES ASSUMED.'              @D34YSWS 00701009
         SPACE 1                                               @D34YSWS 00702009
         AGO   .POW160                                         @D34YSWS 00703009
.POW158  ANOP                                                  @D34YSWS 00704009
&OP      SETA  &OP+32                  COPYSEP = NO            @D34YSWS 00705009
.POW160  ANOP                                                  @D34YSWS 00706009
.*                                                                      00707009
.* TRACESZ  SPECIFICATION CHECKING ******                               00708009
.*                                                                      00709009
&TS      SETA  24                         DEFAULT TRACE SIZE   @D65CDAT 00710012
         AIF   (T'&TRACESZ EQ 'O').POW180 OMITTED              @D35BIML 00711009
         AIF   (T'&TRACESZ NE 'N').POW172 NUMERIC              @D35BIML 00712009
         AIF   (&TRACESZ EQ 0).POW180     OMITTED              @D35BIML 00713009
         AIF   (&TRACESZ GT 248).POW172   MAXIMUM              @D65CDAT 00714013
&TS      SETA  ((&TRACESZ+7)/8)*8         USER SPEC.TRACE SIZE @D65CDAT 00715013
         AGO   .POW180                                         @D35BIML 00716009
.POW172  ANOP                                                  @D35BIML 00717009
         MNOTE 3,' INVALID TRACESZ, SPECIFICATION IGNORED.'    @D35BIML 00718009
         SPACE 1                                                        00719009
.POW180  ANOP                                                  @D35BIML 00720009
.*                                                                      00721009
.* SYSID  SPECIFICATION CHECKING *************                          00722009
.*                                                                      00723009
&SID     SETC  ' '                        DEFAULT SYS-ID       @D02PISS 00724009
         AIF   (T'&SYSID EQ 'O').POW200   OMITTED              @D02PISS 00725009
         AIF   (T'&SYSID NE 'N').POW198   NUMERIC              @D02PISS 00726009
         AIF   (&SYSID LT 1).POW198       INVALID ?            @D02PISS 00727009
         AIF   (&SYSID GT 9).POW198       MAXIMUM SYS-ID       @D02PISS 00728009
&SID     SETC  '&SYSID'                   USER SPEC.SYS-ID     @D02PISS 00729009
&SSI     SETB  1                          IND SYS-ID SPECIFIED @D02PISS 00730009
         AGO   .POW200                                         @D02PISS 00731009
.POW198  ANOP                                                  @D02PISS 00732009
         MNOTE 3,' INVALID SYSID, SPECIFICATION IGNORED.'      @D02PISS 00733009
         SPACE 1                                                        00734009
.POW200  ANOP                                                  @D02PISS 00735009
.*                                                                      00736009
.*   SHARED SPECIFICATION CHECKING **********************               00737009
.*                                                                      00738009
&SO      SETA  0                   DEFAULT SHARED=NO           @D02PISS 00739009
         AIF   (N'&SHARED EQ 0 OR '&SHARED' EQ 'NO').POW210    @D02PISE 00740009
         AIF   (N'&SHARED GE 3).POW208   MAX 2 ENTRIES         @D02PISS 00741009
         AIF   ('&SHARED(1)' NE 'Q').POW208                    @D02PISS 00742009
&SHR     SETB  1                   IND SHARED SPECIFIED        @D02PISE 00743009
&SH      SETC  'S'                 SET SHARED SUFFIX           @D03PIQE 00744009
         AIF   (NOT &SSI).POW206                               @D02PISS 00745009
&SO      SETA  128                 IND QUEUE FILE SHARED       @D02PISS 00746009
         AIF   (T'&SHARED(2) EQ 'O').POW210  OMITTED           @D02PISS 00747009
         AIF   ('&SHARED(2)' NE 'A').POW208                    @D02PISS 00748009
         AIF   ('&ACCOUNT' EQ 'NO').POW207                     @D52NDTR 00749009
         AIF   (&POWX EQ 0).POW207 ACCOUNT SPECIFIC. INVALID   @D52NDTR 00750009
&SO      SETA  &SO+64              IND ACCOUNT FILE SHARED     @D02PISS 00751009
         AGO   .POW210             CONTINUE                    @D02PISS 00752009
.POW206  ANOP                                                  @D02PISS 00753009
         MNOTE 8,' SHARED SPECIFICATION IGNORED, NO SYSID SPECIFIED'    00754009
         SPACE 1                                                        00755009
         AGO   .POW210             CONTINUE                    @D02PISS 00756009
         SPACE                                                          00757009
.POW207  ANOP                                                           00758009
&SO      SETA  0                                               @D02PISE 00759009
&SHR     SETB  0                   RESET SHARED SPECIFICATION  @D02PISE 00760009
         MNOTE 8,'NO ACCOUNTING SUPPORT, SHARED SPECIFICATION IGNORED'  00761009
         SPACE 1                                                        00762009
         AGO   .POW210                                                  00763009
.POW208  ANOP                                                  @D02PISS 00764009
&SO      SETA  0                   RESET SHARED SPECIFICATION  @D02PISS 00765009
&SHR     SETB  0                   RESET SHARED SPECIFICATION  @D02PISS 00766009
         MNOTE 8,' INVALID SHARED SPECIFICATION, NO ASSUMED'   @D02PISS 00767009
         SPACE 1                                                        00768009
.POW210  ANOP                                                  @D02PISS 00769009
.*                                                                      00770009
.*   TIME SPECIFICATION CHECKING **********************                 00771009
.*                                                                      00772009
&TI(1)   SETA  5                   DEFAULT FOR T1 IS 5 SEC     @D02PISS 00773009
&TI(2)   SETA  0                   DEFAULT FOR T2 IS 0 SEC     @D03PISW 00774009
&TI(3)   SETA  60                  DEFAULT FOR T3 IS 5 SEC     @D02PISS 00775009
&TI(4)   SETA  3*60                DEFAULT FOR T4 IS 3*60 SEC  @D02PISS 00776009
.*                                                                      00777009
&MXT(1)  SETA  99                  MAX VALUE FOR T1            @D02PISE 00778009
&MXT(2)  SETA  9                   MAX VALUE FOR T2            @D02PISE 00779009
&MXT(3)  SETA  999                 MAX VALUE FOR T3            @D02PISE 00780009
&MXT(4)  SETA  999                 MAX VALUE FOR T4            @D03PIQE 00781009
.*                                                                      00782009
         AIF   (N'&TIME EQ 0).POW230     OMITTED ?             @D02PISS 00783009
         AIF   (N'&TIME GT 4).POW226     MAX 4 ENTRIES         @D02PISS 00784009
&WL      SETA  1                   INIT LOOP COUNTER           @D02PISS 00785009
.POW212  ANOP                                                  @D02PISS 00786009
         AIF   (T'&TIME(&WL) EQ 'O').POW216  OMITTED ?         @D02PISS 00787009
         AIF   (T'&TIME(&WL) NE 'N').POW213  IS NUMERIC ?      @D02PISS 00788009
         AIF   (&TIME(&WL) EQ 0 AND &WL NE 2).POW213           @D02PISS 00789009
         AIF   (&TIME(&WL) LE &MXT(&WL)).POW214 MAX VALUES ?   @D02PISE 00790009
.POW213  ANOP                                                  @D02PISS 00791009
         SPACE 1                                                        00792009
         MNOTE 3,' INVALID T(&WL) &TIME(&WL), DEFAULT ASSUMED' @D02PISS 00793009
         SPACE 1                                                        00794009
         AGO   .POW216             AND CONTINUE                @D02PISS 00795009
.POW214  ANOP                                                  @D02PISS 00796009
&TI(&WL) SETA  &TIME(&WL)          SET TIME INTERVAL           @D02PISS 00797009
.POW216  ANOP                                                  @D02PISS 00798009
&WL      SETA  &WL+1               ADD ONE TO LOOP COUNTER     @D02PISS 00799009
         AIF   (N'&TIME GE &WL).POW212  LOOP TILL ALL CHECKED  @D02PISS 00800009
         AIF   (&SHR).POW230       IF SHARED SPECIFIED         @D02PISE 00801009
         MNOTE 3,' TIME SPECIFICATION IGNORED, SHARED NOT SPECIFIED'    00802009
         AGO   .POW230                                         @D02PISE 00803009
.POW226  ANOP                                                  @D02PISS 00804009
         MNOTE 3,' INVALID TIME SPECIFICATION, DEFAULT ASSUMED'         00805009
.POW230  ANOP                                                  @D02PISS 00806009
.*                                                                      00807009
.*       NTFYMSG SPECIFICATION CHECKING  ****************               00808009
.*                                                                      00809009
&NTFY    SETA  0                       SET DEFAULT             @D03PIPW 00810009
         AIF   (T'&NTFYMSG EQ 'O').POW240  IF OMITTED, BRANCH  @D03PIPW 00811009
         AIF   ('&NTFYMSG' NE 'NO').POW236 IF NOT 'NO',BRANCH  @DA37130 00812009
&NTFY    SETA  32767                   FORCE NO NTFY SUPPORT   @DA37130 00813009
         AGO   .POW240                                         @DA37130 00814009
.POW236  ANOP                                                  @DA37130 00815009
         AIF   (T'&NTFYMSG NE 'N').POW238  NUMERIC ?, YES, OK  @D03PIPW 00816009
         AIF   (&NTFYMSG LT 1).POW238  ZERO VALUE SPECIFIED ?  @D03PIPW 00817009
         AIF   (&NTFYMSG GT 999).POW238 GREATER THAN MAXIMUM ? @D03PIPW 00818009
&NTFY    SETA  &NTFYMSG                USER SPECIFIED VALUE    @D03PIPW 00819009
         AGO   .POW240                                         @D03PIPW 00820009
.POW238  ANOP                                                           00821009
         MNOTE 3,' INVALID NTFYMSG, NO NOTIFY SUPPORT GENERATED'        00822009
         SPACE 1                                                        00823009
.POW240  ANOP                                                  @D03PIPW 00824009
.*                                                                      00825009
.*       PNET SPECIFICATION CHECKING   **************************       00826009
.*                                                                      00827009
.*       THE PNET PARAMETER IS OPTIONAL AND SPECIFIES, IF PRESENT,      00828009
.*       THE PHASE NAME OF THE NETWORK DEFINTION TABLE.                 00829009
.*       ACCORDING TO THE NAMING CONVENTIONS THE PHASE NAME MUST        00830009
.*       ALPHAMERIC AND THE FIRST CHARACTER ALPHABETIC.                 00831009
.*                                                                      00832009
&NT      SETC  '        '          SET DEFAULT, NO NETWORK TBL @D03PIPW 00833009
         AIF   (T'&PNET EQ 'O').POW260    IF OMITTED, CONTINUE @D03PIPW 00834009
         AIF   (K'&PNET GT 8).NETERR1     IF GREATER 8, ERROR  @D03PIPW 00835009
&WL      SETA  1                   SET LOOP COUNT              @D03PIPW 00836009
.NET010  ANOP                                                  @D03PIPW 00837009
         AIF   ('&PNET'(1,1) EQ '&CHAR1'(&WL,1)).NET020        @D03PIPW 00838009
&WL      SETA  &WL+1               BUMP TO NEXT CHAR IN TABLE  @D03PIPW 00839009
         AIF   (&WL GT 29).NETERR1  IF NOT FOUND, ERROR        @D03PIPW 00840009
         AGO   .NET010             AND TRY THIS ONE            @D03PIPW 00841009
.NET020  ANOP                                                  @D03PIPW 00842009
&WL      SETA  1                   SET LOOP COUNT FOR OTHER TBL@D03PIPW 00843009
&I       SETA  2                   START CHECKING WITH 2ND CHAR@D03PIPW 00844009
.NET025  ANOP                                                  @D03PIPW 00845009
         AIF   (&I GT K'&PNET).NET050 IT IS DONE, NAME IS OK   @D03PIPW 00846009
.NET030  ANOP                                                  @D03PIPW 00847009
         AIF   ('&PNET'(&I,1) EQ '&CHAR2'(&WL,1)).NET035       @D03PIPW 00848009
&WL      SETA  &WL+1               BUMP TO NEXT CHAR IN TABLE  @D03PIPW 00849009
         AIF   (&WL GT 39).NETERR1   NOT FOUND, ERROR          @D03PIPW 00850009
         AGO   .NET030             TRY THIS CHARACTER          @D03PIPW 00851009
.NET035  ANOP                                                  @D03PIPW 00852009
&WL      SETA  1                   SET LOOP COUNT AGAIN        @D03PIPW 00853009
&I       SETA  &I+1                CHECK NEXT CHAR OF NET NAME @D03PIPW 00854009
         AGO   .NET025             AND START CHECKING          @D03PIPW 00855009
.NET050  ANOP                                                  @D03PIPW 00856009
&NT      SETC  '&PNET'             TAKE USER SPECIFIED NAME    @D03PIPW 00857009
         AGO   .POW260             AND CONTINUE                @D03PIPW 00858009
.*                                                                      00859009
.NETERR1 ANOP                                                  @D03PIPW 00860009
         MNOTE 3,'INVALID PNET SPECIFICATION, PARAMETER IGNORED'        00861009
         SPACE 2                                                        00862009
.*                                                                      00863009
.POW260  ANOP                                                  @D03PIPW 00864009
.*                                                                      00865009
.*   RJEBSC SPECIFICATION                                               00866009
.*                                                                      00867009
&RJEB    SETC  'Y'                 SET DEFAULT TO YES          @D03PIPE 00868009
         AIF   (T'&RJEBSC EQ 'O').POW270  OMITTED              @D03PIPE 00869009
         AIF   ('&RJEBSC' EQ 'YES').POW270 YES SPECIFIED       @D03PIPE 00870009
         AIF   ('&RJEBSC' NE 'NO').POW262                      @D03PIPE 00871009
&RJEB    SETC  'N'                 SET VALUE TO NO             @D03PIPE 00872009
         AGO   .POW270                                         @D03PIPE 00873009
.POW262  ANOP                                                  @D03PIPE 00874009
         MNOTE 3,' INVALID RJEBSC SPECIFICATION, YES ASSUMED'  @D03PIPE 00875009
         SPACE 1                                                        00876009
.POW270  ANOP                                                  @D03PIPE 00877009
.*                                                                      00878009
.*       MEMTYPE SPECIFICATION CHECKING  ************************       00879009
.*                                                                      00880009
.*       THE MEMTYPE PARAMETER IS OPTIONAL AND SPECIFIES, IF PRESENT,   00881009
.*       THE DEFAULT MEMBER TYPE WHEN ACCESSING THE SOURCE              00882009
.*       STATEMENT LIBRARY.                                             00883009
.*       ACCORDING TO THE NAMING CONVENTIONS THE MEMBER TYPE MUST BE    00884009
.*       ALPHAMERIC.                                                    00885009
.*                                                                      00886009
         AIF   (T'&MEMTYPE EQ 'O').POW280 IF OMITTED, CONTINUE @D03PILW 00887009
         AIF   (K'&MEMTYPE GT 8).MTYPER1  IF GREATER 8, ERROR  @D03PILW 00888009
&WL      SETA  1                   SET LOOP COUNT              @DA34561 00889009
&I       SETA  1                   START CHECKING WITH 1ST CHAR@DA34561 00890009
.MTYP25  ANOP                                                  @D03PILW 00891009
         AIF   (&I GT K'&MEMTYPE).MTYP50 IT IS DONE, NAME IS OK@D03PILW 00892009
.MTYP30  ANOP                                                  @D03PILW 00893009
         AIF   ('&MEMTYPE'(&I,1) EQ '&CHAR2'(&WL,1)).MTYP35    @D03PILW 00894009
&WL      SETA  &WL+1               BUMP TO NEXT CHAR IN TABLE  @D03PILW 00895009
         AIF   (&WL GT 39).MTYPER1   NOT FOUND, ERROR          @D03PILW 00896009
         AGO   .MTYP30             TRY THIS CHARACTER          @D03PILW 00897009
.MTYP35  ANOP                                                  @D03PILW 00898009
&WL      SETA  1                   SET LOOP COUNT AGAIN        @D03PILW 00899009
&I       SETA  &I+1                CHECK NEXT CHAR OF MEMT.NAME@DY45161 00900009
         AGO   .MTYP25             AND START CHECKING          @D03PILW 00901009
.MTYP50  ANOP                                                  @D03PILW 00902009
&MTYP    SETC  '&MEMTYPE'          TAKE USER SPECIFIED NAME    @D03PILW 00903009
         AIF   (K'&MEMTYPE GT 1).POW280   IF GREATER 1, BRANCH @D22DDWS 00904009
         AIF   (T'&SUBLIB NE 'O').POW280  IF SUBLIB NOT OMITTED@DY45161 00905009
&SL      SETC  '&MEMTYPE'(1,1)     SET DEFAULT SUBLIBRARY      @D22DDWS 00906009
         AGO   .POW280             AND CONTINUE                @D03PILW 00907009
.*                                                                      00908009
.MTYPER1 ANOP                                                  @D03PILW 00909009
         MNOTE 3,'INVALID MEMTYPE SPECIFICATION, TYPE=SOURCE ASSUMED'  *00910009
                                                               @DY45161 00911009
         SPACE 2                                                        00912009
.*                                                                      00913009
.POW280  ANOP                                                  @D03PILW 00914009
.*                                                                      00915009
.*       OUTEXIT SPECIFICATION CHECKING  ************************       00916009
.*                                                                      00917009
.*       THE OUTEXIT PARAMETER SPECIFIES THE PHASE NAME OF A            00918009
.*       USER WRITTEN OUTPUT EXIT. THE SIZE OF THE WORKAREA             00919009
.*       ASSOCIATED WITH THE OUTPUT EXIT AND ITS TYPE OF       @D61TDAT 00920009
.*       WORK UNIT COULD ALSO BE SPECIFIED.                    @D61TDAT 00921009
.*                                                                      00922009
.*                                                                      00923009
.*                                                                      00924009
&OE      SETC  '        '           DEFAULT OUTPUT EXIT        @DC1EDIR 00925009
&OW      SETA  0                    DEFAULT WORK AREA SIZE     @DC1EDIR 00926009
&OXM     SETC  '0'                  OUTEXIT DEFAULT NP WORKUNIT@D61TDAT 00927009
.*                                                                      00928009
         AIF   (N'&OUTEXIT EQ 0).POW290  SPECIFICATION OMITTED @DC1EDIR 00929009
         AIF   (N'&OUTEXIT GE 4).POW288  TOO MANY PARAMETERS   @D61TDAT 00930009
         AIF   (T'&OUTEXIT(1) EQ 'O').POW288                   @DC1EDIR 00931009
         AIF   (K'&OUTEXIT(1) GE 9).POW288                     @DC1EDIR 00932009
&OE      SETC  '&OUTEXIT(1)'        USER SPECIFIED PHASE NAME  @DC1EDIR 00933009
.*                                                                      00934009
         AIF   (T'&OUTEXIT(2) EQ 'O').POW285 NO SIZE SPECIFIED @D61TDAT 00935009
         AIF   (T'&OUTEXIT(2) NE 'N').POW283 NUMERIC ?         @DC1EDIR 00936009
         AIF   (&OUTEXIT(2) LE 65535).POW284 VALID VALUE       @DC1EDIR 00937009
.POW283  ANOP                                                  @DC1EDIR 00938009
         MNOTE 3,' INVALID OUTEXIT WORKAREA, NO ASSUMED.'      @DC1EDIR 00939009
         SPACE 1                                                        00940009
         AGO   .POW285                                         @D61TDAT 00941009
.POW284  ANOP                                                  @DC1EDIR 00942009
&OW      SETA  &OUTEXIT(2)          USER SPECIFIED SIZE        @DC1EDIR 00943009
.POW285  ANOP                                                  @D61TDAT 00944009
         AIF   (T'&OUTEXIT(3) EQ 'O').POW290  TD-MODE OMITTED  @D61TDAT 00945009
         AIF   (K'&OUTEXIT(3) NE 2).POW286    INVALID # CHARS  @D61TDAT 00946009
         AIF   ('&OUTEXIT(3)' EQ 'NP').POW290 CORRECT NP SPEC. @D61TDAT 00947009
         AIF   ('&OUTEXIT(3)' NE 'PA').POW286 INCORRECT SPECIF.@D61TDAT 00948009
&OXM     SETC  'GOEPU'                SET 'PARALLEL' WORK UNIT @D61TDAT 00949009
         AGO   .POW290                                         @D61TDAT 00950009
.POW286  ANOP                                                  @D61TDAT 00951009
         MNOTE 3,' INVALID OUTEXIT WORK UNIT, NP ASSUMED.'     @D61TDAT 00952009
         AGO   .POW290                                         @DC1EDIR 00953009
.POW288  ANOP                                                  @DC1EDIR 00954009
         MNOTE 3,' INVALID OUTEXIT, NO ASSUMED.'               @DC1EDIR 00955009
.POW290  ANOP                                                  @DC1EDIR 00956009
.*                                                                      00957009
.*       JOBEXIT SPECIFICATION CHECKING  ************************       00958009
.*                                                                      00959009
.*       THE JOBEXIT PARAMETER SPECIFIES THE PHASE NAME OF A            00960009
.*       USER WRITTEN READER EXIT. THE SIZE OF THE WORKAREA             00961009
.*       ASSOCIATED WITH THE READER EXIT AND ITS TYPE OF WORK  @D61TDAT 00962009
.*       UNIT COULD ALSO BE SPECIFIED.                         @D61TDAT 00963009
.*                                                                      00964009
.*                                                                      00965009
&RX      SETA  0                    DEFAULT WORK AREA SIZE     @DC1EDIR 00966009
&RE      SETC  '        '           DEFAULT PHASE NAME         @DC1EDIR 00967009
&JXM     SETC  '0'                  JOBEXIT DEFAULT NP WORKUNIT@D61TDAT 00968009
.*                                                                      00969009
         AIF   (N'&JOBEXIT EQ 0).POW390  SPECIFICATION OMITTED @DC1EDIR 00970009
         AIF   (N'&JOBEXIT GE 4).POW388  TOO MANY PARAMETERS   @D61TDAT 00971009
         AIF   (T'&JOBEXIT(1) EQ 'O').POW388                   @DC1EDIR 00972009
         AIF   (K'&JOBEXIT(1) GE 9).POW388                     @DC1EDIR 00973009
&RE      SETC  '&JOBEXIT(1)'        USER SPECIFIED PHASE NAME  @DC1EDIR 00974009
.*                                                                      00975009
         AIF   (T'&JOBEXIT(2) EQ 'O').POW385 NO SIZE SPECIFIED @D61TDAT 00976009
         AIF   (T'&JOBEXIT(2) NE 'N').POW383 NUMERIC ?         @DC1EDIR 00977009
         AIF   (&JOBEXIT(2) LE 65535).POW384 VALID VALUE       @DC1EDIR 00978009
.POW383  ANOP                                                  @DC1EDIR 00979009
         MNOTE 3,' INVALID JOBEXIT WORKAREA, NO ASSUMED.'      @DC1EDIR 00980009
         SPACE 1                                                        00981009
         AGO   .POW385                                         @D61TDAT 00982009
.POW384  ANOP                                                  @DC1EDIR 00983009
&RX      SETA  &JOBEXIT(2)          USER SPECIFIED SIZE        @DC1EDIR 00984009
.POW385  ANOP                                                  @D61TDAT 00985009
         AIF   (T'&JOBEXIT(3) EQ 'O').POW390  TD-MODE OMITTED  @D61TDAT 00986009
         AIF   (K'&JOBEXIT(3) NE 2).POW386    INVALID # CHARS  @D61TDAT 00987009
         AIF   ('&JOBEXIT(3)' EQ 'NP').POW390 CORRECT NP SPEC. @D61TDAT 00988009
         AIF   ('&JOBEXIT(3)' NE 'PA').POW386 INCORRECT SPECIF.@D61TDAT 00989009
&JXM     SETC  'GJEPU'                SET 'PARALLEL' WORK UNIT @D61TDAT 00990009
         AGO   .POW390                                         @D61TDAT 00991009
.POW386  ANOP                                                  @D61TDAT 00992009
         MNOTE 3,' INVALID JOBEXIT WORK UNIT, NP ASSUMED.'     @D61TDAT 00993009
         AGO   .POW390                                         @DC1EDIR 00994009
.POW388  ANOP                                                  @DC1EDIR 00995009
         MNOTE 3,' INVALID JOBEXIT, NO ASSUMED.'               @DC1EDIR 00996009
.POW390  ANOP                                                  @DC1EDIR 00997009
.*                                                                      00998009
.*       NETEXIT SPECIFICATION CHECKING   ***********************       00999009
.*                                                                      01000009
.*       THE NETEXIT PARAMETER SPECIFIES THE PHASE NAME OF A            01001009
.*       USER WRITTEN PNET EXIT USED AS A RECEIVER EXIT.                01002009
.*       THE SIZE OF THE WORKAREA ASSOCIATED WITH THE PNET EXIT         01003009
.*       AND ITS WORK UNIT TYPE COULD ALSO BE SPECIFIED.       @D61TDAT 01004009
.*                                                                      01005009
.*                                                                      01006009
&PX      SETA  0                    DEFAULT WORK AREA SIZE     @DC1EDIR 01007009
&PRE     SETC  '        '           DEFAULT PHASE NAME         @DC1EDIR 01008009
&NXM     SETC  '0'                  NETEXIT DEFAULT NP WORKUNIT@D61TDAT 01009009
.*                                                                      01010009
         AIF   (N'&NETEXIT EQ 0).POW490 SPECIFICATION OMITTED  @DC1EDIR 01011009
         AIF   (N'&NETEXIT GE 4).POW488 TOO MANY PARAMETERS    @D61TDAT 01012009
         AIF   (T'&NETEXIT(1) EQ 'O').POW488                   @DC1EDIR 01013009
         AIF   (K'&NETEXIT(1) GE 9).POW488                     @DC1EDIR 01014009
&PRE     SETC  '&NETEXIT(1)'        USER SPECIFIED PHASE NAME  @DC1EDIR 01015009
.*                                                                      01016009
         AIF   (T'&NETEXIT(2) EQ 'O').POW485 NO SIZE  SPECIFIED@D61TDAT 01017009
         AIF   (T'&NETEXIT(2) NE 'N').POW483 NUMERIC ?         @DC1EDIR 01018009
         AIF   (&NETEXIT(2) LE 65535).POW484 VALID VALUE       @DC1EDIR 01019009
.POW483  ANOP                                                  @DC1EDIR 01020009
         MNOTE 3,' INVALID NETEXIT WORKAREA, NO ASSUMED.'      @DC1EDIR 01021009
         SPACE 1                                                        01022009
         AGO   .POW485                                         @D61TDAT 01023009
.POW484  ANOP                                                  @DC1EDIR 01024009
&PX      SETA  &NETEXIT(2)          USER SPECIFIED SIZE        @DC1EDIR 01025009
.POW485  ANOP                                                  @D61TDAT 01026009
         AIF   (T'&NETEXIT(3) EQ 'O').POW490  TD-MODE OMITTED  @D61TDAT 01027009
         AIF   (K'&NETEXIT(3) NE 2).POW486    INVALID # CHARS  @D61TDAT 01028009
         AIF   ('&NETEXIT(3)' EQ 'NP').POW490 CORRECT NP SPEC. @D61TDAT 01029009
         AIF   ('&NETEXIT(3)' NE 'PA').POW486 INCORRECT SPECIF.@D61TDAT 01030009
&NXM     SETC  'GNEPU'                SET 'PARALLEL' WORK UNIT @D61TDAT 01031009
         AGO   .POW490                                         @D61TDAT 01032009
.POW486  ANOP                                                  @D61TDAT 01033009
         MNOTE 3,' INVALID NETEXIT WORK UNIT, NP ASSUMED.'     @D61TDAT 01034009
         AGO   .POW490                                         @DC1EDIR 01035009
.POW488  ANOP                                                  @DC1EDIR 01036009
         MNOTE 3,' INVALID NETEXIT, NO ASSUMED.'               @DC1EDIR 01037009
.POW490  ANOP                                                  @DC1EDIR 01038009
.*                                                                      01039009
.*       XMTEXIT SPECIFICATION CHECKING   ***********************       01040009
.*                                                                      01041009
.*       THE XMTEXIT PARAMETER SPECIFIES THE PHASE NAME OF A            01042009
.*       USER WRITTEN TRANSMITTER EXIT. THE SIZE OF THE WORKAREA        01043009
.*       ASSOCIATED WITH THE TRANSMITTER AND ITS TYPE OF       @D61TDAT 01044009
.*       WORK UNIT COULD ALSO BE SPECIFIED.                    @D61TDAT 01045009
.*                                                                      01046009
&TX      SETA  0                    DEFAULT WORK AREA SIZE     @D51TDTR 01047009
&TRE     SETC  '        '           DEFAULT PHASE NAME         @D51TDTR 01048009
&XXM     SETC  '0'                  XMTEXIT DEFAULT NP WORKUNIT@D61TDAT 01049009
.*                                                                      01050009
         AIF   (N'&XMTEXIT EQ 0).POW590 SPECIFICATION OMITTED  @D51TDTR 01051009
         AIF   (N'&XMTEXIT GE 4).POW588 TOO MANY PARAMETERS    @D61TDAT 01052009
         AIF   (T'&XMTEXIT(1) EQ 'O').POW588                   @D51TDTR 01053009
         AIF   (K'&XMTEXIT(1) GE 9).POW588                     @D51TDTR 01054009
&TRE     SETC  '&XMTEXIT(1)'        USER SPECIFIED PHASE NAME  @D51TDTR 01055009
.*                                                                      01056009
         AIF   (T'&XMTEXIT(2) EQ 'O').POW585 NO SIZE  SPECIFIED@D61TDAT 01057009
         AIF   (T'&XMTEXIT(2) NE 'N').POW583 NUMERIC ?         @D51TDTR 01058009
         AIF   (&XMTEXIT(2) LE 65535).POW584 VALID VALUE       @D51TDTR 01059009
.POW583  ANOP                                                  @D51TDTR 01060009
         MNOTE 3,' INVALID XMTEXIT WORKAREA, NO ASSUMED.'      @D51TDTR 01061009
         SPACE 1                                                        01062009
         AGO   .POW585                                         @D61TDAT 01063009
.POW584  ANOP                                                  @D51TDTR 01064009
&TX      SETA  &XMTEXIT(2)          USER SPECIFIED SIZE        @D51TDTR 01065009
.POW585  ANOP                                                  @D61TDAT 01066009
         AIF   (T'&XMTEXIT(3) EQ 'O').POW590  TD-MODE OMITTED  @D61TDAT 01067009
         AIF   (K'&XMTEXIT(3) NE 2).POW586    INVALID # CHARS  @D61TDAT 01068009
         AIF   ('&XMTEXIT(3)' EQ 'NP').POW590 CORRECT NP SPEC. @D61TDAT 01069009
         AIF   ('&XMTEXIT(3)' NE 'PA').POW586 INCORRECT SPECIF.@D61TDAT 01070009
&XXM     SETC  'GXEPU'                SET 'PARALLEL' WORK UNIT @D61TDAT 01071009
         AGO   .POW590                                         @D61TDAT 01072009
.POW586  ANOP                                                  @D61TDAT 01073009
         MNOTE 3,' INVALID XMTEXIT WORK UNIT, NP ASSUMED.'     @D61TDAT 01074009
         AGO   .POW590                                         @D51TDTR 01075009
.POW588  ANOP                                                  @D51TDTR 01076009
         MNOTE 3,' INVALID XMTEXIT, NO ASSUMED.'               @D51TDTR 01077009
.POW590  ANOP                                                  @D51TDTR 01078009
.*                                                                      01079009
.*       MASTER PASSWORD CHECKING         ******************** @D52KDIR 01080009
.*                                                                      01081009
.*       THE MASTER PASSWORD SPECIFIES THE INSTALLATION                 01082009
.*       PASSWORD WHICH ALLOWS THE SAME UNLIMITED ACCESS TO QUEUE       01083009
.*       ENTRIES AS WITH THE HEX ZERO PASSWORD.                         01084009
.*                                                                      01085009
&MP(1)   SETC  ' '                  SET TO BLANK               @D52KDIR 01086009
&MP(2)   SETC  ' '                  SET TO BLANK               @D52KDIR 01087009
&MP(3)   SETC  ' '                  SET TO BLANK               @D52KDIR 01088009
&MP(4)   SETC  ' '                  SET TO BLANK               @D52KDIR 01089009
&MP(5)   SETC  ' '                  SET TO BLANK               @D52KDIR 01090009
&MP(6)   SETC  ' '                  SET TO BLANK               @D52KDIR 01091009
&MP(7)   SETC  ' '                  SET TO BLANK               @D52KDIR 01092009
&MP(8)   SETC  ' '                  SET TO BLANK               @D52KDIR 01093009
.*                                                                      01094009
         AIF   (T'&MPWD EQ 'O').POW600 SPECIFICATION OMITTED   @D52KDHS 01095009
         AIF   (K'&MPWD GE 9).MPWDER INVALID LENGTH            @D52KDIR 01096009
&WL      SETA  1                    LOOP VAR FOR CHAR TABLE    @D52KDIR 01097009
&I       SETA  1                    LOOP VARIABLE FOR MPWD     @D52KDIR 01098009
.*                                                                      01099009
.*       CHECK IF EACH CHARACTER OF MPWD IS IN ALPHAMERIC      @D52KDIR 01100009
.*       TABLE &CHARS2                                         @D52KDIR 01101009
.*                                                                      01102009
.MPWD10  ANOP                       START OF LOOP              @D52KDIR 01103009
         AIF   (&I GT K'&MPWD).MPWD40 IT IS DONE               @D52KDIR 01104009
.MPWD20  ANOP                                                  @D52KDIR 01105009
         AIF   ('&MPWD'(&I,1) EQ '&CHAR3'(&WL,1)).MPWD30       @D52KDIR 01106009
&WL      SETA  &WL+1                BUMP TO NEXT CHAR IN TABLE @D52KDIR 01107009
         AIF   (&WL GT 42).MPWDER   ERROR, INVALID CHARACTER   @D52DKHS 01108009
         AGO   .MPWD20              TRY NEXT CHARACTER         @D52KDIR 01109009
.MPWD30  ANOP                                                           01110009
&WL      SETA  1                    RESET TO BEGIN OF CHAR3    @D52KDIR 01111009
&I       SETA  &I+1                 PREPARE FOR NEXT CHAR MPWD @D52KDIR 01112009
         AGO   .MPWD10              AND CHECK THIS CHARACTER   @D52KDIR 01113009
.*                                                                      01114009
.*       MASTER PASSWORD IS ALPHAMERIC, SAVE IT                @D52KDIR 01115009
.*                                                                      01116009
&WL      SETA  1                    LOOP VAR FOR UPDATE        @D52KDIR 01117009
.MPWD40  ANOP                                                  @D52KDIR 01118009
         AIF   (&WL GT K'&MPWD).POW600  SAVING DONE            @D52KDIR 01119009
&MP(&WL) SETC  '&MPWD'(&WL,1)       TAKE MASTER PASSWORD CHAR  @D52KDIR 01120009
&WL      SETA  &WL+1                INCREMENT LOOP VAR         @D52KDIR 01121009
         AGO   .MPWD40              DO FOR NEXT CHAR OF MPWD   @D52KDIR 01122009
.*                                                                      01123009
.MPWDER  ANOP                                                  @D52KDIR 01124009
         MNOTE 3,' INVALID MPWD SPECIFICATION - PASSWORD IGNORED.'      01125009
.*                                                             @D52KDIR 01126009
         SPACE 1                                                        01127009
.POW600  ANOP                                                  @D52KDIR 01128009
.*                                                                      01129009
.*       SECNODE SPECIFICATION CHECKING  ********************  @D52HDSW 01130009
.*                                                             @D52HDSW 01131009
.*       THE SECNODE PARAMETER IS OPTIONAL.                    @D52HDSW 01132009
.*       IF THE VSE SEC=YES IS SPECIFIED THEN THE SECNODE      @D52HDSW 01133009
.*       PARAMETER IS MANDITORY AND WILL BE SET BY IPW$$I3,    @D52HDSW 01134009
.*       IF NOT PRESENT.                                       @D52HDSW 01135009
.*       IT SPECIFIES THE VSE SECURITY NODEID                  @D52HDSW 01136009
.*       (SECURITY ZONE) FOR THIS VSE SYSTEM.                  @D52HDSW 01137009
.*                                                             @D52HDSW 01138009
         AIF   (N'&SECNODE EQ   0).POW610 IF OMITTED, CONTINUE @D52HDSW 01139009
         AIF   (K'&SECNODE GT 8).SECNER1  IF GREATER 8, ERROR  @D52HDSW 01140009
&WL      SETA  1                   SET LOOP COUNT FOR CHAR STR @D52HDSW 01141009
&I       SETA  1                   SET LOOP COUNT FOR SECNODE  @D52HDSW 01142009
.SECN25  ANOP                                                  @D52HDSW 01143009
         AIF   (&I GT K'&SECNODE).SECN50 IT IS DONE, NAME IS OK@D52HDSW 01144009
.SECN30  ANOP                                                  @D52HDSW 01145009
         AIF   ('&SECNODE'(&I,1) EQ '&CHAR3'(&WL,1)).SECN35    @D52HDSW 01146009
&WL      SETA  &WL+1               BUMP TO NEXT CHAR IN TABLE  @D52HDSW 01147009
         AIF   (&WL GT 42).SECNER1 NOT FOUND, ERROR            @D52HDSW 01148009
         AGO   .SECN30             TRY THIS CHARACTER          @D52HDSW 01149009
.SECN35  ANOP                                                  @D52HDSW 01150009
&WL      SETA  1                   SET LOOP COUNT AGAIN        @D52HDSW 01151009
&I       SETA  &I+1                CHECK NEXT CHAR OF NET NAME @D52HDSW 01152009
         AGO   .SECN25             AND START CHECKING          @D52HDSW 01153009
.SECN50  ANOP                                                  @D52HDSW 01154009
&SECN    SETC  '&SECNODE'          TAKE USER SPECIFIED NAME    @D52HDSW 01155009
         AGO   .SECN60             CONTINUE                    @D52HDSW 01156009
.*       ERROR                                                          01157009
.SECNER1 MNOTE 3,'INVALID SECNODE SPECIFICATION, PARAMETER DEFAULTED'  /01158009
                                                               @D52HDSW 01159009
&SECN    SETC  'AAAA'              TAKE DEFAULT VALUE          @D52HDSW 01160009
.*       EXIT                                                           01161009
.SECN60  ANOP                                                  @D52HDSW 01162009
.*                                                                      01163009
.********************************************************************** 01164009
.*                                                                    * 01165009
.*             START OF TABLE GENERATION                              * 01166009
.*                                                                    * 01167009
.********************************************************************** 01168009
.*                                                                      01169009
         PUNCH ' PHASE &NM,S'                                  @D02PIIS 01170009
         SPACE 2                                                        01171009
IPW$POW  CSECT                                                          01172009
         BALR  R8,0                    ESTABLISH ADDRESSABILITY         01173009
         USING *,R8                                                     01174009
         B     IPW$POW0                BRANCH OVER COPYRIGHT   @D03PIQW 01175009
         SPACE 2                                                        01176009
         DC    CL2' '                  ALIGN IT NICELY         @D03PIQW 01177009
         DC    CL44'5686-CF7 (C) COPYRIGHT IBM CORP. 1979, 2000'        01178017
         DC    CL44' '                                                  01179009
         SPACE 2                                                        01180009
IPW$POW0 DS    0H                                                       01181009
         SPACE 1                                                        01182009
*        PARTITION BOUNDARY INFORMATION ARE OBTAINED TO DETERMINE       01183009
*        WHERE THE INITIALIZATION PROCESSOR WILL BE LOADED.             01184009
*        THE INITIALIZATION PROCESSOR (ROOTPHASE) IS LOADED:            01185009
*        1.  IN THE SECOND PAGE OF THE PAGEABLE AREA WHEN THE           01186009
*            PAGEABLE AREA IS LARGE ENOUGH THAT AT LEAST THE IP -       01187009
*            MODULE FITS INTO IT.                                       01188009
*        2.  BEHIND THE GENERATION TABLE IN ALL OTHER CASES. THE        01189009
*            INITIALIZATION PROCESSOR WILL THEN ABNORMALLY TERMINATE    01190009
*            THE INITIATION OF VSE/POWER.                               01191009
         SPACE 1                                                        01192009
         LA    R6,IPW$POW1             SAVE GENTABLE ADDRESS   @D35BIIF 01193009
         LA    R0,IPW$POWB             ADDR OF WORK AREA       @D35BIIF 01194009
         LA    R1,L'IPW$POWB           LENGTH OF WORK AREA     @D35BIIF 01195009
         SPACE                                                          01196009
         EXTRACT ID=BDY,AREA=(R0),LEN=(R1)                     @D35BIIF 01197009
         SPACE                                                          01198009
         L     R0,IPW$POWE             NR OF K-BYTES PFIX LIMIT@D35BIIF 01199009
         CH    R0,IPW$POWK             PART PFIX SIZE TO HIGH? @D35BIIF 01200009
         BNH   IPW$POWI                NO, CONTINUE            @D35BIIF 01201009
         SPACE 1                                                        01202009
         LH    R0,IPW$POWK             YES, FORCE MAX PFIX SIZE@D35BIIF 01203009
         ST    R0,IPW$POWE             AND SAVE IT             @D35BIIF 01204009
IPW$POWI DS    0H                      CALCULATE PART. SIZE    @D35BIIF 01205009
         SLL   R0,10                   GET NR OF BYTES FIXED   @D35BIIF 01206009
         A     R0,IPW$POWC             ADD PARTITION BEGIN ADDR@D35BIIF 01207009
         LA    R1,4095                 GET CP WORKAREA SIZE    @D52LDHS 01208009
         LA    R1,1(R1)                GET CP WORKAREA SIZE    @D52LDHS 01209009
         AR    R0,R1                   AND ADD IT TO LOAD ADDR @D02PIIS 01210009
         L     R1,IPW$POWS             GET SIZE OF IP PROCESSOR@D35BIIF 01211009
         AR    R1,R0                   AND ADD IT TO END ADDR OF FIXED *01212009
                                       AREA (REAL PART. END)   @D35BIIF 01213009
         C     R1,IPW$POWD             DOES IPW$$IP FIT ?      @D35BIIF 01214009
         BL    IPW$POWH                YES, LOAD IPW$$IP INTO VIRT.    *01215009
                                       STORAGE                 @D35BIIF 01216009
*        LOAD IPW$$IP BEHIND GENERATION TABLE AND LET IPW$$IP TERMINATE 01217009
         SPACE 1                                                        01218009
         LH    R0,IPW$POW8             LENGTH OF TABLE         @D32DUSN 01219009
         AR    R0,R6                   GET LOAD ADDRESS                 01220009
         SR    R1,R1                   CLEAR WORK REGISTER     @D34BDSN 01221009
         ICM   R1,7,IPW$POW6           GET LENGTH OF LU TABLE  @D34BDSN 01222009
         LA    R1,15(R1)               PLUS 15 BTS FOR ALGNMNT @D35BIIF 01223009
         AR    R0,R1                   ADD IT TO LOAD POINT    @D34BDSN 01224009
         SRL   R0,3                    ROUND TO DOUBLE WORD    @D35BIIF 01225009
         SLL   R0,3                    BOUNDARY                @D35BIIF 01226009
         SPACE 2                                                        01227009
*        LOAD INITIALIZATION PROCESSOR ROOTPHASE AND PASS CONTROL TO IT 01228009
         SPACE 1                                                        01229009
IPW$POWH DS    0H                      LOAD ROUTINE            @D35BIIF 01230009
         LA    R1,IPW$POW7             INIT PHASE NAME                  01231009
         LOAD  (R1),(R0)               LOAD INIT. CHECK PHASE           01232009
         SPACE 1                                                        01233009
         LR    R9,R1                   LOAD BASE REG OF IPW$$IP@D35BIIF 01234009
         B     16(R1)                  AND PASS CONTROL TO IT           01235009
         SPACE 2                                                        01236009
IPW$POWK DC    H'2048'                 MAX REAL SIZE OF POWER  @D64VDAT 01237009
IPW$POWS DC    A(10*1024)              SIZE OF INIT PROCESSOR  @D02PIIS 01238009
         EJECT                                                          01239009
         SPACE 1                                                        01240009
*              REGISTER EQUATES                                         01241009
         SPACE 1                                                        01242009
R0       EQU   0                       LOAD ADDRESS IPW$$IP             01243009
R1       EQU   1                       ENTRY POINT IPW$$IP              01244009
R6       EQU   6                       GENTABLE ADDRESS                 01245009
R8       EQU   8                       BASE REGISTER           @D35BIIF 01246009
R9       EQU   9                       BASE REG OF IPW$$IP     @D35BIIF 01247009
         SPACE 2                                                        01248009
*              EXIT WORK-UNIT TYPE EQUATES                              01249009
         SPACE 1                                                        01250009
GJEPU    EQU   X'40'                   JOBEXIT AS PA WORKUNIT  @D61TDAT 01251009
GOEPU    EQU   X'20'                   OUTEXIT AS PA WORKUNIT  @D61TDAT 01252009
GNEPU    EQU   X'10'                   NETEXIT AS PA WORKUNIT  @D61TDAT 01253009
GXEPU    EQU   X'08'                   XMTEXIT AS PA WORKUNIT  @D61TDAT 01254009
.*                                                                      01255009
.*       NOTE:  THE FOLLOWING DEFINITIONS MUST MATCH WITH THE           01256009
.*              CORRESPONDING FIELDS IN THE IPW$DGN MACRO.              01257009
.*                                                                      01258009
         TITLE '&NAME      VSE/POWER        GENERATION TABLE ' @D02PIQE 01259009
*********************************************************************** 01260009
* * *                                                             * * * 01261009
* * *          VSE/POWER GENERATION TABLE                         * * * 01262009
* * *                                                             * * * 01263009
*********************************************************************** 01264009
         SPACE 1                                                        01265009
         DS    0D                      ALIGNMENT               @D34BDSN 01266009
IPW$POW1 DC    C'GNCB    V7R1    '     STORAGE DESCRIPTOR      @D71QDAT 01267017
         DC    C'7010'                 VERSION/RELEASE/MOD     @D71QDAT 01268017
         DC    CL1'&MP(4)'             MASTER PASSWORD         @D52KDIR 01269009
         DC    AL1(&JXM+&OXM+&NXM+&XXM) GENERAL FLAG BYTE      @D61TDAT 01270009
IPW$POWX DC    AL2(&POWX)              ACCOUNTING INFORMATION  @D52NDTR 01271009
         DC    CL8'&SECN '             SECURITY NODEID         @D52HDSW 01272009
         DC    CL1' '                  SEC.ACCESS CONTROL MODE @D64CDSW 01273009
         DC    CL23' '                 UNUSED                  @D64CDSW 01274009
         DC    CL1' '                  UNUSED                  @D52HDSW 01275009
         DC    CL1'&MP(7)'             MASTER PASSWORD         @D52KDIR 01276009
         DC    CL1'&MP(2)'             MASTER PASSWORD         @D52KDIR 01277009
         DC    CL1'&MP(6)'             MASTER PASSWORD         @D52KDIR 01278009
         DC    F'&TX'                  XMTEXIT WORK AREA SIZE  @D51TDTR 01279009
         DC    CL8'&TRE'               NAME OF XMTEXIT         @D51TDTR 01280009
         DC    CL8'&OE'                OUTPUT EXIT PHASE NAME  @DC1EDIR 01281009
         DC    F'&OW'                  OUTEXIT WORKAREA SIZE   @DC1EDIR 01282009
         DC    F'&RX'                  JOBEXIT WORKAREA SIZE   @DC1EDIR 01283009
         DC    F'&PX'                  NETEXIT WORKAREA SIZE   @DC1EDIR 01284009
         DC    XL4'00'                 ALTERNATE JECL PREFIX   @DC1IDWS 01285009
         DC    F'&DB'                  DBLK VALUE                       01286009
         DC    H'&BL'                  DBLK GROUP VALUE        @D23CDWS 01287009
IPW$POW2 DC    AL2(IPW$POW9-IPW$POW1)  LNGTH OF POWER + BSC    @D02PIIS 01288009
         DC    CL1'&SL'                SUBLIB SPECIFICATION             01289009
         DC    CL1'&AC'                ACCOUNT SPECIFICATION            01290009
         DC    CL1'&PP'                PAUSE PUNCH SPECIFICATION        01291009
         DC    CL1'&JL'                JLOG OPTION                      01292009
         DC    CL1'&PY'                DEFAULT PRI                      01293009
IPW$POW3 DC    AL1(&GBL2)              NUMBER OF BSC LINES              01294009
IPW$POW4 DC    AL1(&GBL3)              NUMBER OF BSC REMOTES            01295009
         DC    CL1'&SP'                SPOOL MGMT SPECIFICATION@D33PAJB 01296009
         DC    AL1(&OP)                OPTION BYTE             @D34ZDQZ 01297009
         DC    AL1(&TS)                TRACE SIZE FOR BSC      @D35BIML 01298009
         DC    CL1'&MP(3)'             MASTER PASSWORD         @D52KDIR 01299009
         DC    AL1(&SPL)               SPLIM VALUE             @D23CDWS 01300009
         DC    H'&TI(1)'               TIMER INTERVAL T1       @D02PISS 01301009
         DC    H'&TI(2)'               TIMER INTERVAL T2       @D02PISS 01302009
         DC    H'&TI(3)'               TIMER INTERVAL T3 INT.  @D02PISS 01303009
         DC    H'&TI(4)'               TIMER INTERVAL T4 INT.  @D02PISS 01304009
         DC    AL1(&SO)                SHARED SPOOLING OPTIONS @D02PISS 01305009
         DC    CL1'&SID'               SYSTEM - ID             @D02PISS 01306009
         DC    CL1'&MP(8)'             MASTER PASSWORD         @D52KDIR 01307009
         DC    CL1'&MP(1)'             MASTER PASSWORD         @D52KDIR 01308009
         DC    3X'00'                  RESERVED                @D52KDIR 01309009
         DC    AL1(&JB(1))             JSEP PRINT                       01310009
         DC    F'&NR(1)'               RBS PRINT                        01311009
         DC    F'&ST(1)'               STDLINE FIRST                    01312009
         DC    F'&ST(2)'               STDLINE SECOND                   01313009
         DC    XL3'00'                 RESERVED                @D02PISS 01314009
         DC    AL1(&JB(2))             JSEP PUNCH                       01315009
         DC    F'&NR(2)'               RBS PUNCH                        01316009
         DC    F'&SD(1)'               STDCARD FIRST                    01317009
         DC    F'&SD(2)'               STDCARD SECOND                   01318009
         DC    CL8'&RE'                NAME JOBEXIT                     01319009
         DC    H'&NTFY'                MAX NO NTFY MSG QUEUE   @D03PIPW 01320009
         DC    CL8'&NT'                NAME NETWORK TABLE      @D03PIPW 01321009
         DC    CL8'&PRE'               NAME OF PNET READER EXIT@D03PIPW 01322009
         DC    CL1'&RJEB'              RJEBSC SPECIFICATION    @D03PIPE 01323009
         DC    CL8'&MTYP'              DEFAULT SL MEMBER TYPE  @D03PILW 01324009
         DC    CL1'&MP(5)'             MASTER PASSWORD         @D52KDIR 01325009
         EJECT                                                          01326009
*                                                                       01327009
*        WORK AREA FOR EXTRACT MACRO                                    01328009
*                                                                       01329009
IPW$POWB DS    0CL20                                           @D35BIIF 01330009
IPW$POWC DC    F'0'                PARTITION BEGIN ADDRESS     @D35BIIF 01331009
IPW$POWD DC    F'0'                VIRT. PART. END GETVIS EXCL @D35BIIF 01332009
         DC    F'0'                VIRT PART END GETVIS INCLUD.@D35BIIF 01333009
IPW$POWE DC    F'0'                PFIX LIMIT IN K-BYTES       @D35BIIF 01334009
IPW$POWF DC    F'0'                PFIX COUNT IN NR OF PAGES   @D35BIIF 01335009
         SPACE 2                                                        01336009
         DC    F'0'                GETVIS AREA BEGIN ADDRESS   @D35BIIF 01337009
         DC    F'0'                GETVIS AREA END ADDRESS     @D35BIIF 01338009
IPW$POW7 DC    CL8'IPW$$IP '           INIT PHASE NAME         @D22DDWS 01339009
         DC    AL1(&LT(1))             LTAB                             01340009
         DC    AL1(&LT(2))                -                             01341009
         DC    AL1(&LT(3))                -                             01342009
         DC    AL1(&LT(4))                -                             01343009
         DC    AL1(&LT(5))                -                             01344009
         DC    AL1(&LT(6))                -                             01345009
         DC    AL1(&LT(7))                -                             01346009
         DC    AL1(&LT(8))                -                             01347009
         DC    AL1(&LT(9))                -                             01348009
         DC    AL1(&LT(10))               -                             01349009
         DC    AL1(&LT(11))               -                             01350009
         DC    AL1(&LT(12))               -                             01351009
         DC    AL1(&LT(13))               -                             01352009
         SPACE                                                          01353009
IPW$POW6 DC    AL3(0)                  LENGTH OF LU TABLE      @D34BDSN 01354009
IPW$POW8 DS    0CL32                   SNA INFORMATION         @D34BDSN 01355009
         DC    AL2(IPW$POW9-IPW$POW1)  POWER+BSC+SNA TBL LNGTH @D02PIIS 01356009
         DC    CL1' '                  RESERVED                @D32DUSN 01357009
         DC    AL1(&LP)                LENGTH ACB PASSWORD     @D32DUSN 01358009
         DC    CL8'&PW'                ACB PASSWORD            @D32DUSN 01359009
IPW$POW5 DC    AL1(&NLUS)              MAX WORKSTATIONS-WSCOUNT@D32DUSN 01360009
         DC    AL1(0)                  NUMBER OF SNA REMOTES   @D32DUSN 01361009
         DC    AL1(0)                  FIRST SNA REMOTE ID     @D32DUSN 01362009
         DC    AL1(0)                  LAST SNA REMOTE ID      @D32DUSN 01363009
         DC    AL1(&LAPPLID)           LENGTH OF APPLID        @D34BDSN 01364009
         DC    CL8'&APPLID'            APPLID FOR VTAM         @D34BDSN 01365009
         DC    CL3' '                  RESERVED                @D02PIIS 01366009
         DC    A(IPW$POW9)             ADDR OF FIRST LINE BLOCK@D02PIIS 01367009
         SPACE                                                          01368009
IPW$POW9 EQU   *                       END OF GENERATION TABLE          01369009
         AIF   (N'&SNA EQ 0).POW999    NO SNA SUPPORT          @D02PIQE 01370009
IPW$POW$ CSECT                         LU CSECT                @D34BDSN 01371009
         DC    CL12'LU NAMES'          HEADING FOR STORAGE     @D34BDSN 01372009
IPW$POWA DC    A(16)                   LENGTH OF LU TABLE      @D34BDSN 01373009
IPW$POW  CSECT                         RESTORE CSECT           @D34BDSN 01374009
.POW999  SPACE 6                                                        01375009
         MEND                                                           01376009
