*%/*                                                                    00050052
         MACRO                                                          00100052
&NAME    SDUMPX &HDR=,&HDRAD=,&DCB=,&ASID=,&ASIDLST=,&ECB=,&SDATA=,    X00150052
               &STORAGE=,&LIST=,&SUMLIST=,&BUFFER=,&QUIESCE=,&BRANCH=, X00200052
               &LISTA=,&TYPE=,&SUMLSTA=,&SUSPEND=,&SUBPLST=,&KEYLIST=, X00250052
               &MF=,&SRB=,&SUMLSTL=,&LISTD=,                       @L6CX00300052
               &ID=,&IDAD=,&SYMREC=,&PSWREGS=,&PLISTVER=           @T1P 00350052
.********************************************************************** 00400052
.*   MACRO NAME = SDUMPX                                              * 00450052
.*                                                                    * 00500052
.*   DESCRIPTIVE NAME = SDUMPX EXECUTABLE MACRO                       * 00550052
.*                                                                    * 00600052
.*   STATUS = HBB4420                                                 * 00650052
.*                                                                    * 00700052
.*   COPYRIGHT =                                                      * 00750052
.*               LICENSED MATERIALS - PROPERTY OF IBM                 * 00800052
.*               THIS MACRO IS "RESTRICTED MATERIALS OF IBM"          * 00850052
.*               5695-047 (C) COPYRIGHT IBM CORP 1980, 1990           * 00900052
.*               SEE COPYRIGHT INSTRUCTIONS                           * 00950052
.*                                                                    * 01000052
.*   FUNCTION = PROVIDES THE INTERFACE BETWEEN THE CALLER AND SVC     * 01050052
.*              DUMP.  LIST AND EXECUTE FORMS EXIST TO GENERATE       * 01100052
.*              THE SDUMPX PARAMETER LIST AND PROPER LINKAGE TO THE   * 01150052
.*              SVC DUMP SERVICE.                                     * 01200052
.*                                                                    * 01250052
.*   NOTES = THE PARAMETER LIST GENERATED BY THE STANDARD AND LIST    * 01300052
.*           FORMS OF THIS MACRO IS 112 BYTES IN LENGTH.              * 01350052
.*           IF MDUMP OPTIONS ARE SPECIFIED, THE PARAMETER LIST       * 01400052
.*             IS 128 BYTES.                                          * 01450052
.*                                                                    * 01500052
.*   CHANGE ACTIVITY = FIX PROBLEM WITH ECB OPTION 6/22/79    @ZMB0025* 01550052
.*                     OS/VS2 JBB1226:                        @G383P1U* 01600052
.*                     1. SUPPORT FOR NEW KEYWORDS:                   * 01650052
.*                        LISTA,SUMLSTA,TYPE=XMEM             @G383P1U* 01700052
.*                     2. SUPPORT FOR NEW KEYWORD                     * 01750052
.*                        SUSPEND= YES OR NO                          * 01800052
.*                        SUPPORT FOR SDUMP EXITS             @G386P31* 01850052
.*                     3. SUPPORT FOR NEW KEYWORD: TYPE=XMEME @G38AP31* 01900052
.*                     4. SUPPORT FOR NEW KEYWORD: SUMLSTL        @L5A* 01950052
.*                     APAR OZ51194 - MF=(E,(1)) ON EXECUTE   @ZA51194* 02000052
.*                        FORM WITH NO OTHER PARAMETERS       @ZA51194* 02050052
.*                        GENERATES AN OR IMMEDIATE.          @ZA51194* 02100052
.*                     OS/VS2 JBB1326:                            @L1A* 02150052
.*                     @L1= RAS JBB1326 810130 PD31:PAGE PROTECT  @L1A* 02200052
.*                     OS/VS2 HBB2102:                        @G860P31* 02250052
.*                     1. SUPPORT ALLNUC, SUBPLST, KEYLIST            * 02300052
.*                     2. ADD RESERVED FIELDS FOR SLIP AND SYSMDUMP   * 02350052
.*                     3. ADD BLOCK COMMENTS TO AID DEBUGGING         * 02400052
.*                     4. SUPPORT SPLEVEL                     @G860P1X* 02450052
.*                     5. ADD TYPE=NOLOCAL PARAMETER TO PREVENT       * 02500052
.*                        SDUMP FROM OBTAINING A LOCAL LOCK.  @ZMC2707* 02550052
.*  FLAG  REASON  RELEASE   DATA  ORIGIN                          @L2A* 02600052
.*  $L2=  RASENH  JBB2220  841119  PD2F: SUPPORT TYPE=FAILRC      @L2A* 02650052
.*  $L3=    AR    HBB3310  850901  PDXB: AR SUPPORT                   * 02700052
.*  $L4=  RTMRAS  HBB3310  860728  PDA8: SLIP SYNCHRONOUS SVC DUMP    * 02750052
.*  $P1= PC40145  HBB3310  860829  PD2F: CORRECT SPELLING IN MESG2E   * 02800052
.*  $P2= PC40810  HBB3310  870312  PDA8: SRB KEYWORD PROCESSING       * 02850052
.*  $T1= OY21535  JBB2220  890331  PDXB: MDUMP SUPPORT                * 02900052
.*  $T2= OY21535  HBB3310  890331  PDXB: MDUMP SUPPORT                * 02950052
.*  $T3= OY21535  HBB3310  890331  PDXB: MDUMP SUPPORT FOR SDUMPX     * 03000052
.*  $L5= DATASPAC HBB3310  861029  PDAY: SUMLSTL KEYWORD SUPPORT  @L5A* 03050052
.*  $L6= DATASPAC HBB3310  861029  PDQ6: LISTD   KEYWORD SUPPORT  @L6A* 03100052
.*  $L7= COUPLSDU HBB4410  870116  PDQ6: SDATA COUPLE                 * 03150052
.*  $L8= DATACAPT HBB4420  900226  PDHT: UPGRADED SYNTAX FOR ECB &    * 03200052
.*                                       SRB KEYWORDS             @L8A* 03250052
.*  $D1= DH30150  HBB4420  901024  PDHR: SRB CAPTURE DEFAULT          * 03300052
.*       D52GHTN                       : VSE/ESA DATASPACE SUPPORT    * 03325052
.*                                                                    * 03350052
.********************************************************************** 03400052
.*                                                                      03450052
.*       DEFINE SET SYMBOLS                                             03500052
.*                                                                      03550052
         GBLC  &SYSSPLV           SYSTEM/MACRO LIBRARY LEVEL   @G860P1X 03600052
         GBLC  &SDPLVER     SET ACCORDING TO HIGHEST PLISTVER     @T1P  03650052
         LCLA  &SDFLAG0           SDFLAG0 FIELD OF PARAMETER LIST       03700052
         LCLA  &SDFLAG1           SDFLAG1 FIELD OF PARAMETER LIST       03750052
         LCLA  &SDFLAG2           SDFLAG2 PARAMETER LIST FIELD @G383P1U 03800052
         LCLA  &SDATAF1,&SDATAF2  SDATA FIELD OF PARAMETER LIST         03850052
         LCLA  &SDATAF3           SDATA EXIT FIELDS PARM LIST  @G383P1U 03900052
         LCLA  &SDAT3             SDUSDAT3 FIELD OF PARM LIST      @T1P 03950052
         LCLA  &SDCNTL1           CONTROL FLAGS FOR IDENTIFYING NEW     04000052
.*                                RELEASES AND EXPANDED PARAMETER LIST  04050052
.*                                LENGTHS                      @G860P31 04100052
         LCLA  &SDTYPF1           TYPE FIELD OF PARAMETER LIST @G383P1U 04150052
         LCLA  &CTR1,&CTR2        COUNTERS FOR LOOP CONTROL, INDEX      04200052
         LCLA  &HDRCTR            NUMBER OF PAIRED APOSTROPHES          04250052
         LCLA  &IDCTR             NUMBER OF PAIRED APOSTROPHES     @T1P 04300052
         LCLA  &DISP              DISPLACEMENT FOR STORING ADDRESSES    04350052
         LCLA  &DISP1             DISPLACEMENT FOR STOR LIST@G860P31    04400052
         LCLA  &DISP2             DISPLACEMENT FOR HDR DATA    @G860P31 04450052
         LCLA  &STRCNT            COUNT OF STOR ADDRESSES      @G860P31 04500052
         LCLC  &GNAME             SYMBOLIC NAME-BRANCH AROUND CONSTANTS 04550052
         LCLC  &TEMP              TEMPORARY VARIABLE               @T1P 04600052
         LCLB  &SDDCB             SET IF DCB ADDRESS IS SPECIFIED       04650052
         LCLB  &SDBUFF            SET IF BUFFER IS TO BE DUMPED         04700052
         LCLB  &SDSTOR            SET IF STORAGE OR LIST IS SPECIFIED   04750052
         LCLB  &SDHDR             SET IF HDR OR HDRAD IS SPECIFIED      04800052
         LCLB  &SDECB             SET IF AN ECB ADDRESS IS SUPPLIED     04850052
         LCLB  &SDECBWR           SET IF THE ECB IS TO BE POSTED AFTER  04900052
.*                                THE WRITE PHASE HAS COMPLETED    @D1A 04950052
         LCLB  &SDSRB            SET IF AN SRB ADDRESS IS SUPPLIED @L4A 05000052
         LCLB  &SDSRBWR         SET IF THE SRB IS TO BE SCHEDULED AFTER 05050052
.*                                THE WRITE PHASE HAS COMPLETED    @D1A 05100052
         LCLB  &SDWRITE           SET IF THE ECB IS TO BE POSTED OR     05150052
.*                                THE SRB IS TO BE SCHEDULED AFTER      05200052
.*                                THE WRITE PHASE HAS COMPLETED    @D1A 05250052
         LCLB  &SDASID            SET IF AN ASID IS SPECIFIED           05300052
         LCLB  &SDASIDL           SET IF AN ASIDLIST IS SPECIFIED       05350052
.*                                                             @G33VPHD 05400052
         LCLB  &SDQUIET           SET IF SYSTEM IS TO BE QUIESCED       05450052
         LCLB  &SDBRNCH           SET IF INTERFACE IS BRANCH ENTRY      05500052
         LCLB  &DUMPTYP           ALWAYS SET FOR SVC DUMP               05550052
         LCLB  &SDALPSA           SET IF ALL PSA IN SYSTEM TO BE DUMPED 05600052
         LCLB  &SDPSA             SET IF CURRENT PSA IS TO BE DUMPED    05650052
         LCLB  &SDNUC             SET IF NUCLEUS IS TO BE DUMPED        05700052
         LCLB  &SDSQA             SET IF SQA IS TO BE DUMPED            05750052
         LCLB  &SDLSQA            SET IF LSQA IS TO BE DUMPED           05800052
         LCLB  &SDRGN             SET IF VIRTUAL MEMORY IS TO BE DUMPED 05850052
         LCLB  &SDLPA             SET IF ACTIVE LPA MOD FOR MEMORY REQ  05900052
         LCLB  &SDTRT             SET IF GTF INCORE TRACE BUFFERS  REQ  05950052
         LCLB  &SDCSA             SET IF CSA SUBPOOLS ARE TO BE DUMPED  06000052
         LCLB  &SDSWA             SET IF SWA FOR MEMORY TO BE DUMPED    06050052
.*                                                                      06100052
         LCLB  &SDSUMLT           SET IF SUMLIST SPECIFIED     @G33VPHD 06150052
         LCLB  &SDSMDMP           SET IF SUMDUMP SPECIFIED     @G33VPHD 06200052
         LCLB  &SDNSMDP           SET IF NO SUMDUMP SPECIFIED  @G33VPHD 06250052
         LCLB  &SDNSQA            SET IF NO SQA SPECIFIED      @G33VPHD 06300052
         LCLB  &SDNAPSA           SET IF NOALLPSA IS SPECIFIED @G33VPHD 06350052
         LCLB  &SDNEW             SET IF ENHANCED SVC DUMP     @G33VPHD 06400052
         LCLB  &SDSE3PM         SET IF JBB1226 PARMS SPECIFIED @G383P1U 06450052
         LCLB  &SDGRSQ            SET IF SDATA=GRSQ SPECIFIED  @G383P1U 06500052
         LCLB  &SDCOUPL           SET IF SDATA=COUPLE SPECIFIED    @L7A 06550052
.********************************************************************** 06600052
.* FOR EACH NEW SDUMP EXIT, ADD A NEW VARIABLE DEFINED SIMILAR TO       06650052
.* SDGRSQ.                                                     @G386P31 06700052
.********************************************************************** 06750052
         LCLB  &SDLISTA           SET IF LISTA PARM SPECIFIED  @G383P1U 06800052
         LCLB  &SDLISTD           SET IF LISTD PARM SPECIFIED      @L6A 06850052
         LCLB  &SDSMLTA           SET IF SUMLSTA SPECIFIED     @G383P1U 06900052
         LCLB  &SDSMLTL           SET IF SUMLSTL SPECIFIED         @L5A 06950052
         LCLB  &SDSPEND           SET IF SUSPEND=YES SPECIFIED @G386P31 07000052
         LCLB  &SDTYPXM           SET IF TYPE=XMEM SPECIFIED   @ZMB0025 07050052
         LCLB  &SDTPXME           SET IF TYPE=XMEME SPECIFIED  @G38AP31 07100052
         LCLB  &SDALLNC           SET IF ALLNUC SPECIFIED      @G860P31 07150052
         LCLB  &SDSPLST           SET IF SUBPLST SPECIFIED     @G860P31 07200052
         LCLB  &SDKYLST           SET IF KEYLIST SPECIFIED     @G860P31 07250052
         LCLB  &SDSP21P           SET IF HBB2102 PARM LIST     @G860P31 07300052
         LCLB  &SDVRSNB           SET IF VERSION NUMBER IN LIST    @T1P 07350052
         LCLB  &SDTYPNL          SET IF TYPE=NOLOCAL SPECIFIED @ZMC2707 07400052
         LCLB  &SDTYPRC           SET IF TYPE=FAILRC SPECIFIED     @L2A 07450052
.* FLAGS FOR MDUMP OPTIONS                                              07500052
         LCLC  &PLVER             PLISTVER                         @T1P 07550052
         LCLB  &SDPREG            SET IF PSWREG SPECIFIED          @T1P 07600052
         LCLB  &SDSYMR            SET IF SYMREC SPECIFIED          @T1P 07650052
         LCLB  &SDID              SET IF ID OR IDAD SPECIFIED      @T1P 07700052
         LCLB  &SDIDAD            SET IF IDAD SPECIFIED            @T1P 07750052
         LCLB  &SDDEFS            SET IF DEFAULTS/DEFS SPECIFIED   @T1P 07800052
         LCLB  &SDNODEF           SET IF NODEFAULTS/NODEFS         @T1P 07850052
         LCLB  &SDIO              SET IF IO SPECIFIED              @T1P 07900052
.*                                                                      07950052
.********************************************************************** 08000052
.* IF ANY POSITIONAL PARAMETERS WERE SPECIFIED, THE MACRO IS            08050052
.* SPECIFIED INCORRECTLY AND IS PROBABLY MISSING A SET OF               08100052
.* PARENTHESIS.                                                @G860P1X 08150052
.********************************************************************** 08200052
.*                                                                      08250052
.INVKSP2 ANOP                                                  @G860P1X 08400052
         LCLC  &LA                      "LA" OR "LAE" VIA SYSSTATE @L3A 08425052
         GBLC  &SYSASCE                                            @L3A 08437552
         SYSSTATE TEST                  TEST ASC ENVIRONMENT       @L3A 08450052
&LA      SETC  'LA'                     MUST USE LA INSTRUCTION    @L3A 08500052
         AIF   ('&SYSASCE' EQ 'P').NOLAE                           @L3A 08550052
&LA      SETC  'LAE'                    MUST USE LAE               @L3A 08600052
.NOLAE   ANOP                                                      @L3A 08650052
         AIF  ('&SYSLIST(1)' NE '').MESG1A                     @G860P1X 08700052
.*                                                                      08750052
.********************************************************************** 08800052
.*                                                                      08850052
.*         SYNTAX CHECK FOR MUTUALLY EXCLUSIVE OPTIONS                  08900052
.*                                                             @G860P31 08950052
.********************************************************************** 09000052
.*                                                                      09050052
         AIF   ('&HDR' NE '' AND '&HDRAD' NE '').MESG2A     MUTUALLY    09100052
         AIF   ('&ID' NE '' AND '&IDAD' NE '').MESG2F              @T1P 09150052
         AIF   ('&STORAGE' NE '' AND '&LIST' NE '').MESG2B   EXCLUSIVE  09200052
.*       TEST STORAGE AND LISTA - MUTUALLY EXCLUSIVE           @G383P1U 09250052
         AIF   ('&STORAGE' NE '' AND '&LISTA' NE '').MESG2C    @G383P1U 09300052
.*       TEST LIST AND LISTA - MUTUALLY EXCLUSIVE              @G383P1U 09350052
         AIF   ('&LIST' NE '' AND '&LISTA' NE '').MESG2D       @G383P1U 09400052
.*       TEST SUMLIST AND SUMLSTA - MUTUALLY EXCLUSIVE         @G383P1U 09450052
         AIF   ('&SUMLIST' NE '' AND '&SUMLSTA' NE '').MESG2E  @G383P1U 09500052
.*       TEST ASID AND ASIDLST - MUTUALLY EXCLUSIVE            @G386P31 09550052
         AIF   ('&ASID' NE '' AND '&ASIDLST' NE '').MESG10     @G383P1U 09600052
.*                                                                      09650052
.********************************************************************** 09700052
.*                                                                      09750052
.*    PARSE THE HDR PARAMETER FOR INVALID LENGTH AFTER ACCOUNTING       09800052
.*    FOR STARTING, ENDING, AND PAIRED APOSTROPHES.                     09850052
.*                                                             @G860P31 09900052
.********************************************************************** 09950052
.*                                                                      10000052
         AIF   ('&HDR' EQ '').SD3I          HDR SPECIFIED          @T1P 10050052
         AIF   ('&HDR'(1,1) NE '''').MESG9  IS FIRST CHAR APOSTROPHE    10100052
&CTR1    SETA  K'&HDR-1                     LENGTH OF USER DATA +1      10150052
         AIF   (&CTR1 LT 2).MESG9A          INVALID HDR SPECIFICATION   10200052
.*                                                            @ZMC0399  10250052
&HDRCTR  SETA  0                            NUMBER OF PAIRED APOSTROHES 10300052
&CTR2    SETA  2                            INDEX FIRST CHAR-USER DATA  10350052
.SDLOOP  ANOP                                                           10400052
         AIF   (&CTR2 GE &CTR1).SD2              END OF SCAN            10450052
         AIF   ('&HDR'(&CTR2,2) EQ '''''').SD1   PAIRED APOSTROPHES     10500052
&CTR2    SETA  &CTR2+1                           UPDATE INDEX BY 1      10550052
         AGO   .SDLOOP                           CONTINUE LOOP          10600052
.SD1     ANOP                                                           10650052
&HDRCTR  SETA  &HDRCTR+1                    ONE MORE PAIRED APOSTROPHES 10700052
&CTR2    SETA  &CTR2+2                      UPDATE INDEX BY 2           10750052
         AGO   .SDLOOP                      CONTINUE LOOP               10800052
.SD2     ANOP                                                           10850052
&CTR1    SETA  K'&HDR-2-&HDRCTR             LENGTH OF USER DATA         10900052
         AIF   (&CTR1 GT 100).MESG8         USER DATA TOO LONG          10950052
.********************************************************************** 11000052
.*                                                                      11050052
.*    PARSE THE ID PARAMETER FOR INVALID LENGTH AFTER ACCOUNTING        11100052
.*    FOR STARTING, ENDING, AND PAIRED APOSTROPHES.                     11150052
.*                                                                 @T1P 11200052
.********************************************************************** 11250052
.*                                                                      11300052
.SD3I    AIF   ('&ID' EQ '').SD3            ID SPECIFIED           @T1P 11350052
         AIF   ('&ID'(1,1) NE '''').MESG9I  FIRST CHAR APOSTROPHE  @T1P 11400052
&CTR1    SETA  K'&ID-1                      LENGTH+1               @T1P 11450052
         AIF   (&CTR1 LT 2).MESG9AI         INVALID ID SPECIFICATION   *11500052
                                                                   @T1P 11550052
&IDCTR   SETA  0                            PAIRED APOSTROPHES     @T1P 11600052
&CTR2    SETA  2                            INDEX FIRST CHAR       @T1P 11650052
.SDLOOPI ANOP                                                      @T1P 11700052
         AIF   (&CTR2 GE &CTR1).SD2I             END OF SCAN       @T1P 11750052
         AIF   ('&ID'(&CTR2,2) EQ '''''').SD1I   PAIRED            @T1P 11800052
&CTR2    SETA  &CTR2+1                           UPDATE INDEX BY 1 @T1P 11850052
         AGO   .SDLOOPI                          CONTINUE LOOP     @T1P 11900052
.SD1I    ANOP                                                      @T1P 11950052
&IDCTR   SETA  &IDCTR+1                     ONE MORE               @T1P 12000052
&CTR2    SETA  &CTR2+2                      UPDATE INDEX BY 2      @T1P 12050052
         AGO   .SDLOOPI                     CONTINUE LOOP          @T1P 12100052
.SD2I    ANOP                                                      @T1P 12150052
&CTR1    SETA  K'&ID-2-&IDCTR               LENGTH OF USER DATA    @T1P 12200052
         AIF   (&CTR1 GT 50).MESG8I         USER DATA TOO LONG     @T1P 12250052
.*                                                                      12300052
.********************************************************************** 12350052
.*                                                                      12400052
.*    CHECK FOR INVALID PARAMETERS SPECIFIED WITH MF=L                  12450052
.*                                                             @G860P31 12500052
.********************************************************************** 12550052
.*                                                                      12600052
.SD3     AIF   ('&MF' NE 'L').SD5           IS MF STANDARD OR EXECUTE   12650052
         AIF   ('&ASID' NE '').MESG5A       ASID INVALID W/MF=L         12700052
         AIF   ('&ECB' NE '').MESG5B        ECB INVALID W/MF=L          12750052
         AIF   ('&SRB' NE '').MESG5F        SRB INVALID W/MF=L     @L4A 12800052
         AIF   ('&BRANCH' NE '').MESG5C     BRANCH INVALID W/MF=L       12850052
         AIF   ('&ASIDLST' NE '').MESG5D   ASID INV W/MF=L     @G33VPHD 12900052
.*                                                                      12950052
.********************************************************************** 13000052
.*                                                                      13050052
.*  CHECK FOR VALID OPERANDS (YES OR NO) ON BUFFER, BRANCH, AND QUIESCE 13100052
.*                                                             @G860P31 13150052
.********************************************************************** 13200052
.*                                                                      13250052
.SD5     AIF   ('&BUFFER' EQ '').SD9        IS BUFFER SPECIFIED         13300052
.*                                                             @G33VPHD 13350052
         AIF   ('&BUFFER' NE 'YES' AND '&BUFFER' NE 'NO').MESG4B        13400052
.*                                                             @G33VPHD 13450052
.SD9     AIF   ('&BRANCH' EQ '').SD11       IS BRANCH SPECIFIED         13500052
         AIF   ('&BRANCH' NE 'YES' AND '&BRANCH' NE 'NO').MESG4C        13550052
.SD11    AIF   ('&QUIESCE' EQ '').SD13      IS QUIESCE SPECIFIED        13600052
         AIF   ('&QUIESCE' NE 'YES' AND '&QUIESCE' NE 'NO').MESG4D      13650052
.*                                                                      13700052
.********************************************************************** 13750052
.*                                                                      13800052
.*  CHECK FOR AN EVEN NUMBER OF STORAGE RANGES.                         13850052
.*                                                             @G860P31 13900052
.********************************************************************** 13950052
.*                                                                      14000052
.SD13    AIF   ('&STORAGE' EQ '').SD15      IS STORAGE SPECIFIED        14050052
&CTR1    SETA  N'&STORAGE/2                 NUMBER OF ADDRESS PAIRS     14100052
&CTR2    SETA  (N'&STORAGE-1)/2             NUMBER OF PAIRS MINUS 1     14150052
         AIF   (&CTR1 EQ &CTR2).MESG6       ODD NUMBER OF ADDRESSES     14200052
.SD15    ANOP                                                           14250052
.*                                                                      14300052
.********************************************************************** 14350052
.*                                                                      14400052
.*       SDFLAG0 PROCESSING                                             14450052
.*                                                             @G860P31 14500052
.********************************************************************** 14550052
.*                                                                      14600052
&SDDCB   SETB  ('&DCB' NE '')                IF DCB SPECIFIED           14650052
&SDBUFF  SETB  ('&BUFFER' EQ 'YES')          IF BUFFER TO BE DUMPED     14700052
&SDSTOR  SETB  ('&STORAGE' NE '' OR '&LIST' NE '')    STORAGE ADDR LIST 14750052
&SDHDR   SETB  ('&HDR' NE '' OR '&HDRAD' NE '')       USER DATA         14800052
         AIF   ('&ECB' NE '' AND '&SRB' NE '').MESG13B SRB AND ECB ARE X14850052
               MUTUALLY EXCLUSIVE                                  @L4A 14900052
&SDECB   SETB  ('&ECB' NE '')               IF ECB SPECIFIED            14950052
         AIF   ('&ECB(2)' NE '' AND '&ECB(2)' NE 'WRITE' AND '&ECB(2)' X15000052
               NE 'CAPTURE').MESG3B                                @L8A 15050052
&SDECBWR SETB  ('&ECB(2)' EQ 'WRITE')       IS THE ECB TO BE POSTED    X15100052
               WHEN THE WRITE PHASE HAS COMPLETED                  @D1C 15150052
         AIF   (&SDDCB EQ 0 OR &SDECB EQ 0 OR &SDECBWR EQ 1).SD20      X15200052
               IF NOT (DCB & ECB & CAPTURE REQUEST/DEFAULTED) DON'T    X15250052
               ISSUE INFORMATIONAL AND OVERRIDE REQUEST            @D1C 15300052
         MNOTE 0,'ECB POST TIME FORCED TO WRITE BECAUSE THE DCB KEYWORDX15350052
                SPECIFIED'                                         @L8A 15400052
&SDECBWR SETB  1                            FORCE TO WRITE PHASE   @D1A 15450052
.SD20    ANOP                                                      @L8A 15500052
&SDSRB   SETB  ('&SRB' NE '')                IF SRB SPECIFIED      @L4A 15550052
         AIF   ('&SRB(2)' NE '' AND '&SRB(2)' NE 'WRITE' AND '&SRB(2)' X15600052
               NE 'CAPTURE').MESG3B                                @L8A 15650052
&SDSRBWR SETB  ('&SRB(2)' EQ 'WRITE')       IS THE SRB TO BE SCHEDULED X15700052
               WHEN THE CAPTURE PHASE HAS COMPLETED                @D1C 15750052
         AIF   (&SDDCB EQ 0 OR &SDSRB EQ 0 OR &SDSRBWR EQ 1).SD21      X15800052
               IF NOT (DCB & SRB & CAPTURE REQUEST/DEFAULTED) DON'T    X15850052
               ISSUE INFORMATIONAL AND OVERRIDE REQUEST            @D1C 15900052
         MNOTE 0,'SRB SCHEDULE TIME FORCED TO WRITE BECAUSE THE DCB KEYX15950052
               WORD SPECIFIED'                                     @D1C 16000052
&SDSRBWR SETB  1                            FORCE TO WRITE PHASE   @D1A 16050052
.SD21    ANOP                                                      @D1A 16100052
&SDASID  SETB  ('&ASID' NE '')               IF ASID SPECIFIED          16150052
&SDQUIET SETB  ('&QUIESCE' NE 'NO')          IF SYSTEM TO BE QUIESCED   16200052
.*             SDQUIET IS SET FOR QUIESCE=YES OR DEFAULTED TO YES       16250052
.*             THE DEFAULT ONLY APPLIES TO THE LIST AND STANDARD FORM,  16300052
.*             AND MUST BE COMPENSATED FOR ON THE EXECUTE FORM.         16350052
&SDBRNCH SETB  ('&BRANCH' EQ 'YES')          IF LINKAGE BY BRANCH ENTRY 16400052
&SDFLAG0 SETA  128*&SDDCB+64*&SDBUFF+32*&SDSTOR+16*&SDHDR+8*&SDECB+4*&SX16450052
               DASID+2*&SDQUIET+1*&SDBRNCH                              16500052
.*                                                                      16550052
.********************************************************************** 16600052
.*                                                                      16650052
.*       SDFLAG1 PROCESSING                                             16700052
.*                                                             @G860P31 16750052
.********************************************************************** 16800052
.*                                                                      16850052
&DUMPTYP SETB  1                  ALWAYS ON FOR SVC DUMP                16900052
&SDNEW   SETB  1                  ALWAYS SET TO 1 FOR NEW SDUMP MACRO   16950052
.*                                                             @G33VPHD 17000052
&SDASIDL SETB  ('&ASIDLST' NE '') IF ASIDLIST WAS SPECIFIED             17050052
.*                                                             @G33VPHD 17100052
&SDSUMLT SETB  ('&SUMLIST' NE '') IF SUMLIST WAS SPECIFIED              17150052
.*                                                             @G33VPHD 17200052
&SDFLAG1 SETA  128*&DUMPTYP+32*&SDNEW+16*&SDASIDL+8*&SDSUMLT            17250052
.*                                                                      17300052
.********************************************************************** 17350052
.*                                                                      17400052
.*       SDFLAG2 PROCESSING                                             17450052
.*                                                             @G860P31 17500052
.********************************************************************** 17550052
.*                                                                      17600052
&SDLISTA SETB  ('&LISTA' NE '')   SET IF LISTA IS SPECIFIED    @G383P1U 17650052
&SDLISTD SETB  ('&LISTD' NE '')   SET IF LISTD IS SPECIFIED        @L6A 17700052
&SDSMLTA SETB  ('&SUMLSTA' NE '') SET IF SUMLSTA SPECIFIED     @G383P1U 17750052
&SDSMLTL SETB  ('&SUMLSTL' NE '') SET IF SUMLSTL SPECIFIED         @L5A 17800052
&SDFLAG2 SETA  128*&SDLISTA+64*&SDSMLTA+2*&SDLISTD+&SDSMLTL        @L6C 17850052
.*                                                                      17900052
.********************************************************************** 17950052
.*                                                                      18000052
.*       SDCNTL1 PROCESSING                                             18050052
.*                                                                 @T1P 18100052
.********************************************************************** 18150052
.*                                                                      18200052
&SDPREG  SETB  ('&PSWREGS' NE '')   SET FOR PSWREGS                @T1P 18250052
&SDSRS   SETB  ('&SYMREC' NE '')    SET FOR SYMREC                 @T1P 18300052
&SDID    SETB  ('&ID' NE '' OR '&IDAD' NE '')         ID DATA      @T1P 18350052
&SDIDAD  SETB  ('&IDAD' NE '')      SET FOR IDAD                   @T1P 18400052
&SDCNTL1 SETA  32*&SDPREG+16*&SDSRS+8*&SDID                        @T1P 18450052
.*                                                                      18500052
.********************************************************************** 18550052
.*                                                                      18600052
.*       SDATA PROCESSING FOR ONLY 1 SDATA OPTION SPECIFIED.            18650052
.*                                                             @G860P31 18700052
.********************************************************************** 18750052
.*                                                                      18800052
         AIF   ('&SDATA' EQ '').SD80        IS SDATA SPECIFIED          18850052
         AIF   ('&SDATA'(1,1) EQ '(').SD60  MORE THAN 1 OPTION, IN ()   18900052
&CTR1    SETA  0                                                        18950052
&SDALPSA SETB  ('&SDATA' EQ 'ALLPSA')       SET IF ALLPSA SPECIFIED     19000052
&SDPSA   SETB  ('&SDATA' EQ 'PSA')          SET IF PSA SPECIFIED        19050052
&SDNUC   SETB  ('&SDATA' EQ 'NUC')          SET IF NUC SPECIFIED        19100052
&SDSQA   SETB  ('&SDATA' EQ 'SQA')          SET IF SQA SPECIFIED        19150052
&SDLSQA  SETB  ('&SDATA' EQ 'LSQA')         SET IF LSQA SPECIFIED       19200052
&SDRGN   SETB  ('&SDATA' EQ 'RGN')          SET IF RGN SPECIFIED        19250052
&SDLPA   SETB  ('&SDATA' EQ 'LPA')          SET IF LPA SPECIFIED        19300052
&SDTRT   SETB  ('&SDATA' EQ 'TRT')          SET IF TRT SPECIFIED        19350052
&SDCSA   SETB  ('&SDATA' EQ 'CSA')          SET IF CSA SPECIFIED        19400052
&SDSWA   SETB  ('&SDATA' EQ 'SWA')          SET IF SWA SPECIFIED        19450052
&SDSMDMP SETB  ('&SDATA' EQ 'SUMDUMP' OR '&SDATA' EQ 'SUM')             19500052
.*                         SET IF SUMDUMP OR SUM ARE SPECIFIED @G33VPHD 19550052
&SDNSQA  SETB  ('&SDATA' EQ 'NOSQA')        SET IF NOSQA SPECIFIED      19600052
.*                                                             @G33VPHD 19650052
&SDNAPSA SETB  ('&SDATA' EQ 'NOALLPSA' OR '&SDATA' EQ 'NOALL')          19700052
.*                          SET IF NOALLPSA OR NOALL SPECIFIED @G33VPHD 19750052
&SDNSMDP SETB  ('&SDATA' EQ 'NOSUMDUMP' OR '&SDATA' EQ 'NOSUM')         19800052
&SDALLNC SETB  ('&SDATA' EQ 'ALLNUC')                          @G860P31 19850052
&SDGRSQ  SETB  ('&SDATA' EQ 'GRSQ')  SET IF GRSQ SPECIFIED     @G383P1U 19900052
&SDCOUPL SETB  ('&SDATA' EQ 'COUPLE') SET IF COUPLE SPECIFIED      @L7A 19950052
&SDIO    SETB  ('&SDATA' EQ 'IO')    SET IF IO SPECIFIED           @T1P 20000052
&SDDEFS  SETB  ('&SDATA' EQ 'DEFS' OR '&SDATA' EQ 'DEFAULTS')      @T1P 20050052
&SDNODEF SETB  ('&SDATA' EQ 'NODEFS' OR '&SDATA' EQ 'NODEFAULTS')  @T1P 20100052
.********************************************************************** 20150052
.* FOR EACH NEW SDUMP EXIT, ADD A 'SETB' INSTRUCTION SIMILAR TO THE ONE 20200052
.* ABOVE AND ADD THE EXIT VARIABLE INTO THE FOLLOWING SETA.    @G386P31 20250052
.********************************************************************** 20300052
&CTR1    SETA  &SDALPSA+&SDPSA+&SDNUC+&SDSQA+&SDLSQA+&SDRGN+&SDLPA+&SDTX20350052
               RT+&SDCSA+&SDSWA+&SDSMDMP+&SDNSMDP+&SDNSQA+&SDNAPSA+&SDGX20400052
               RSQ+&SDALLNC+&SDIO+&SDDEFS+&SDNODEF+&SDCOUPL        @T1P 20450052
&CTR2    SETA  1                            IF INVALID, MESG PRINTS IT  20500052
         AIF   ('&CTR1' EQ '0').MESG4A      IS SPECIFIED OPTION VALID   20550052
         AGO   .SD80                        SDATA OPTION PROCESSED      20600052
.*                                                                      20650052
.********************************************************************** 20700052
.*                                                                      20750052
.*       SDATA PROCESSING FOR 1 OR MORE SDATA OPTIONS IN PARENTHESIS.   20800052
.*                                                             @G860P31 20850052
.********************************************************************** 20900052
.*                                                                      20950052
.SD60    ANOP                     SDATA OPTIONS IN PARENTHESIS          21000052
&CTR1    SETA  N'&SDATA           NUMBER OF OPTIONS ON SDATA PARAMETER  21050052
&CTR2    SETA  0                  NUMBER BY POSITION OPERAND WORKING ON 21100052
.LOOPA1  ANOP                                                           21150052
&CTR2    SETA  &CTR2+1            NUMBER OF NEXT OPTION TO WORK ON      21200052
         AIF   ('&SDATA(&CTR2)' EQ 'ALLPSA').SETAPSA                    21250052
         AIF   ('&SDATA(&CTR2)' EQ 'PSA').SETPSA                        21300052
         AIF   ('&SDATA(&CTR2)' EQ 'NUC').SETNUC                        21350052
         AIF   ('&SDATA(&CTR2)' EQ 'SQA').SETSQA                        21400052
         AIF   ('&SDATA(&CTR2)' EQ 'LSQA').SETLSQA                      21450052
         AIF   ('&SDATA(&CTR2)' EQ 'RGN').SETRGN                        21500052
         AIF   ('&SDATA(&CTR2)' EQ 'LPA').SETLPA                        21550052
         AIF   ('&SDATA(&CTR2)' EQ 'TRT').SETTRT                        21600052
         AIF   ('&SDATA(&CTR2)' EQ 'CSA').SETCSA                        21650052
         AIF   ('&SDATA(&CTR2)' EQ 'SWA').SETSWA                        21700052
         AIF   ('&SDATA(&CTR2)' EQ 'SUMDUMP').SETSUM SUMDUMP SPEC       21750052
.*                                                             @G33VPHD 21800052
         AIF   ('&SDATA(&CTR2)' EQ 'SUM').SETSUM  SET IF SUM SPECIFIED  21850052
.*                                                             @G33VPHD 21900052
         AIF   ('&SDATA(&CTR2)' EQ 'NOSUMDUMP').SETNSUM SET IF          21950052
.*                                   NO SUMDUMP IS SPECIFIED   @G33VPHD 22000052
         AIF   ('&SDATA(&CTR2)' EQ 'NOSUM').SETNSUM  SET IF NOSUM IS    22050052
.*                                                   SPECIFIED          22100052
.*                                                             @G33VPHD 22150052
         AIF   ('&SDATA(&CTR2)' EQ 'NOSQA').SETNSQA  SET IF NOSQA SPEC  22200052
.*                                                             @G33VPHD 22250052
         AIF   ('&SDATA(&CTR2)' EQ 'NOALLPSA').SETNAPA                  22300052
.*                                                             @G33VPHD 22350052
         AIF   ('&SDATA(&CTR2)' EQ 'NOALL').SETNAPA                     22400052
.*                                                             @G33VPHD 22450052
         AIF   ('&SDATA(&CTR2)' EQ 'ALLNUC').SETANUC                    22500052
.*                                                             @G860P31 22550052
         AIF   ('&SDATA(&CTR2)' EQ 'GRSQ').SETGRSQ SET IF GRSQ @G383P1U 22600052
         AIF   ('&SDATA(&CTR2)' EQ 'COUPLE').SETCOUPL SET IF COUPLE     22650052
.*                                                                @L7A  22700052
         AIF   ('&SDATA(&CTR2)' EQ 'IO').SETIO                     @T1P 22750052
         AIF   ('&SDATA(&CTR2)' EQ 'DEFS').SETDEFS                 @T1P 22800052
         AIF   ('&SDATA(&CTR2)' EQ 'DEFAULTS').SETDEFS             @T1P 22850052
         AIF   ('&SDATA(&CTR2)' EQ 'NODEFS').SETNODF               @T1P 22900052
         AIF   ('&SDATA(&CTR2)' EQ 'NODEFAULTS').SETNODF           @T1P 22950052
.********************************************************************** 23000052
.* FOR EACH NEW SDUMP EXIT, ADD AN 'AIF' INSTRUCTION SIMILAR TO THE ONE 23050052
.* ABOVE AND ADD THE NEW LABEL FOR THE SET.                    @G386P31 23100052
.********************************************************************** 23150052
         AGO   .MESG4A                 SDATA OPTION IS INVALID          23200052
.LOOPA2  AIF   (&CTR1 NE &CTR2).LOOPA1 MORE OPTIONS, CONTINUE LOOP      23250052
         AGO   .SD80                   ALL OPTIONS PROCESSED            23300052
.SETAPSA ANOP                          ALLPSA SPECIFIED                 23350052
         AIF   (&SDNAPSA EQ 1).MESG13  NOALLPSA AND ALLPSA IS ERROR     23400052
.*                                                             @G33VPHD 23450052
&SDALPSA SETB  1                       SET INDICATOR                    23500052
         AGO   .LOOPA2                 CONTINUE LOOP                    23550052
.SETPSA  ANOP                          PSA SPECIFIED                    23600052
&SDPSA   SETB  1                       SET INDICATOR                    23650052
         AGO   .LOOPA2                 CONTINUE LOOP                    23700052
.SETNUC  ANOP                          NUC SPECIFIED                    23750052
&SDNUC   SETB  1                       SET INDICATOR                    23800052
         AGO   .LOOPA2                 CONTINUE LOOP                    23850052
.SETSQA  ANOP                          SQA SPECIFIED                    23900052
         AIF   (&SDNSQA EQ 1).MESG12   SQA AND NOSQA IS ERROR           23950052
.*                                                             @G33VPHD 24000052
&SDSQA   SETB  1                       SET INDICATOR                    24050052
         AGO   .LOOPA2                 CONTINUE LOOP                    24100052
.SETLSQA ANOP                          LSQA SPECIFIED                   24150052
&SDLSQA  SETB  1                       SET INDICATOR                    24200052
         AGO   .LOOPA2                 CONTINUE LOOP                    24250052
.SETRGN  ANOP                          RGN SPECIFIED                    24300052
&SDRGN   SETB  1                       SET INDICATOR                    24350052
         AGO   .LOOPA2                 CONTINUE LOOP                    24400052
.SETLPA  ANOP                          LPA SPECIFIED                    24450052
&SDLPA   SETB  1                       SET INDICATOR                    24500052
         AGO   .LOOPA2                 CONTINUE LOOP                    24550052
.SETTRT  ANOP                          TRT SPECIFIED                    24600052
&SDTRT   SETB  1                       SET INDICATOR                    24650052
         AGO   .LOOPA2                 CONTINUE LOOP                    24700052
.SETCSA  ANOP                          CSA SPECIFIED                    24750052
&SDCSA   SETB  1                       SET INDICATOR                    24800052
         AGO   .LOOPA2                 CONTINUE LOOP                    24850052
.SETSWA  ANOP                          SWA SPECIFIED                    24900052
&SDSWA   SETB  1                       SET INDICATOR                    24950052
         AGO  .LOOPA2                  CONTINUE LOOP                    25000052
.SETSUM  ANOP                          SUMDUMP OR SUM SPECIFIED         25050052
.*                                                             @G33VPHD 25100052
         AIF   (&SDNSMDP EQ 1).MESG11  NOSUMDUMP AND SUMDUMP IS ERROR   25150052
.*                                                             @G33VPHD 25200052
&SDSMDMP SETB  1                       SET SUMDUMP INDICATOR            25250052
.*                                                             @G33VPHD 25300052
         AGO   .LOOPA2                 CONTINUE LOOP                    25350052
.*                                                             @G33VPHD 25400052
.SETNSUM ANOP                          NOSUMDUMP OR NOSUM SPECIFIED     25450052
.*                                                             @G33VPHD 25500052
         AIF   (&SDSMDMP EQ 1).MESG11  NOSUMDUMP AND SUMDUMP IS ERROR   25550052
.*                                                             @G33VPHD 25600052
&SDNSMDP SETB  1                       SET NOSUMDUMP INDICATOR          25650052
.*                                                             @G33VPHD 25700052
         AGO   .LOOPA2                 CONTINUE LOOP                    25750052
.*                                                             @G33VPHD 25800052
.SETNSQA ANOP                          NOSQA SPECIFIED                  25850052
.*                                                             @G33VPHD 25900052
         AIF   (&SDSQA EQ 1).MESG12    SQA AND NOSQA IS AN ERROR        25950052
.*                                                             @G33VPHD 26000052
&SDNSQA  SETB  1                       SET NOSQA INDICATOR              26050052
.*                                                             @G33VPHD 26100052
         AGO   .LOOPA2                 CONTINUE LOOP                    26150052
.*                                                             @G33VPHD 26200052
.SETNAPA ANOP                          NOALLPSA OR NOALL SPECIFIED      26250052
.*                                                             @G33VPHD 26300052
         AIF   (&SDALPSA EQ 1).MESG13  NOALLPSA AND ALLPSA IS ERROR     26350052
.*                                                             @G33VPHD 26400052
&SDNAPSA SETB  1                       SET NOALLPSA INDICATOR           26450052
.*                                                             @G33VPHD 26500052
         AGO   .LOOPA2                 CONTINUE LOOP                    26550052
.*                                                             @G33VPHD 26600052
.SETANUC ANOP                          ALLNUC OPTION SPECIFIED @G860P31 26650052
&SDALLNC SETB  1                       ALLNUC OPTION SET       @G860P31 26700052
         AGO   .LOOPA2                 CONTINUE LOOP           @G386P31 26750052
.SETGRSQ ANOP                          GRSQ OPTION SPECIFIED   @G383P1U 26800052
&SDGRSQ  SETB  1                       GRSQ OPTION SPECIFIED   @G383P1U 26850052
         AGO   .LOOPA2                 CONTINUE LOOP           @G383P1U 26900052
.SETCOUPL ANOP                         COUPLE OPTION SPECIFIED     @L7A 26950052
&SDCOUPL SETB 1                        SET COUPLE INDICATOR        @L7A 27000052
         AGO   .LOOPA2                 CONTINUE LOOP               @L7A 27050052
.SETIO   ANOP                          IO OPTION SPECIFIED         @T1P 27100052
&SDIO    SETB  1                       IO OPTION SPECIFIED         @T1P 27150052
         AGO   .LOOPA2                 CONTINUE LOOP               @T1P 27200052
.SETDEFS ANOP                          DEFS OPTION SPECIFIED       @T1P 27250052
&SDDEFS  SETB  1                       DEFS OPTION SPECIFIED       @T1P 27300052
         AGO   .LOOPA2                 CONTINUE LOOP               @T1P 27350052
.SETNODF ANOP                          NODEFS OPTION SPECIFIED     @T1P 27400052
&SDNODEF SETB  1                       NODEFS OPTION SPECIFIED     @T1P 27450052
         AGO   .LOOPA2                 CONTINUE LOOP               @T1P 27500052
.********************************************************************** 27550052
.* FOR EACH NEW SDUMP EXIT, ADD A SET OF 3 INSTRUCTIONS SIMILAR TO THE  27600052
.* 3 PREVIOUS INSTRUCTIONS.                                    @G386P31 27650052
.********************************************************************** 27700052
.SD80    ANOP         ALL SDATA OPTIONS PROCESSED,BUILD SDATA  @G33VPHD 27750052
         AIF   (&SDNODEF EQ 0 OR &SDDEFS EQ 0).SDDEFOK             @T1P 27800052
         MNOTE 12,'DEFAULTS AND NODEFAULTS ARE MUTUALLY EXCLUSIVE' @T1P 27850052
         MEXIT                                                     @T1P 27900052
.SDDEFOK ANOP                                                      @T1P 27950052
.*                                                                      28000052
.********************************************************************** 28050052
.*                                                                      28100052
.*       PLISTVER PROCESSING -- DETERMINE SPECIFIED AND/OR              28150052
.*       NECESSARY PLISTVER PROCESSING                                  28200052
.*                                                                 @T1P 28250052
.********************************************************************** 28300052
         AIF   ('&PLISTVER' EQ '').PLV01                           @T1P 28350052
         AIF   ('&PLISTVER' EQ '1' OR '&PLISTVER' EQ '2').PLV00    @T3C 28400052
         MNOTE 12,'PLISTVER MUST BE 1 OR 2'                        @T3C 28450052
         MEXIT                                                     @T1P 28500052
.PLV00   ANOP                                                      @T1P 28550052
&PLVER   SETC  '&PLISTVER'                                         @T1P 28600052
         AGO   .PLV02                                              @T1P 28650052
.PLV01   ANOP                                                      @T1P 28700052
         AIF   ('&ID' NE '' OR '&IDAD' NE '' OR '&PSWREGS' NE '' OR '&S*28750052
               YMREC' NE '').PLVSET2                               @T1P 28800052
         AIF   (&SDIO NE 0 OR &SDDEFS NE 0 OR &SDNODEF NE 0).PLVSET2   *28850052
                                                                   @T1P 28900052
&PLVER   SETC  '1'                                                 @T1P 28950052
         AGO   .PLV02                                              @T1P 29000052
.PLVSET2 ANOP                                                      @T1P 29050052
&PLVER   SETC  '2'                                                 @T1P 29100052
.PLV02   ANOP                                                      @T1P 29150052
         AIF   ('&PLVER' EQ '2').PLVOK                             @T1P 29200052
         AIF   ('&ID' NE '' OR '&IDAD' NE '' OR '&PSWREGS' NE '' OR '&S*29250052
               YMREC' NE '').PLVBAD1                               @T1P 29300052
         AIF   (&SDIO NE 0 OR &SDDEFS NE 0 OR &SDNODEF NE 0).PLVBAD1   *29350052
                                                                   @T1P 29400052
         AGO   .PLVOK                                              @T1P 29450052
.PLVBAD1 ANOP                                                      @T1P 29500052
         MNOTE 12,'SPECIFIED KEYWORD(S) REQUIRE PLISTVER=2'        @T1P 29550052
         MEXIT                                                     @T1P 29600052
.PLVOK   ANOP                                                      @T1P 29650052
.*       PLVER IS SET TO THE HIGHEST PLVER EVER                         29700052
         AIF   ('&MF' EQ '').PLV03                                 @T1P 29750052
         AIF   ('&SDPLVER' NE '2' OR '&PLISTVER' NE '').PLVOK1     @T1P 29800052
&PLVER   SETC  '&SDPLVER'                                          @T1P 29850052
.PLVOK1  ANOP                                                      @T1P 29900052
         AIF   ('&SDPLVER' NE '' AND '&SDPLVER' GE '&PLVER').PLV03 @T1P 29950052
&SDPLVER SETC  '&PLVER'                                            @T1P 30000052
.PLV03   ANOP                                                      @T1P 30050052
.*                                                                      30100052
.********************************************************************** 30150052
.*                                                                      30200052
.*   AFTER PROCESSING ALL SDATA OPTIONS, BUILD THE SDATA FLAG BYTES.    30250052
.*                                                             @G860P31 30300052
.********************************************************************** 30350052
.*                                                                      30400052
&SDATAF1 SETA  128*&SDALPSA+64*&SDPSA+32*&SDNUC+16*&SDSQA+8*&SDLSQA+4*&X30450052
               SDRGN+2*&SDLPA+1*&SDTRT                                  30500052
&SDATAF2 SETA  128*&SDCSA+64*&SDSWA+32*&SDSMDMP+16*&SDNSMDP+8*&SDNAPSA+X30550052
               4*&SDNSQA+2*&SDALLNC+&SDDEFS                        @T1P 30600052
&SDATAF3 SETA  128*&SDGRSQ+16*&SDCOUPL   CALC EXIT FLAG VALUE      @L7C 30650052
&SDAT3   SETA  128*&SDNODEF+64*&SDIO                               @T1P 30700052
.*                                                                      30750052
.********************************************************************** 30800052
.*                                                                      30850052
.*     SUSPEND KEYWORD PROCESSING                                       30900052
.*                                                             @G860P31 30950052
.********************************************************************** 31000052
.*                                                                      31050052
         AIF   ('&SUSPEND' EQ '').SD73  CHECK IF SUSPEND       @G386P31 31100052
.*                      PARAMETER SPECIFIED ?                  @G386P31 31150052
         AIF   ('&SUSPEND' EQ 'NO').SD73  SUSPEND=NO IS SAME   @G386P31 31200052
.*                      AS NOT SPECIFYING THE SUSPEND KEYWORD  @G386P31 31250052
         AIF   ('&SUSPEND' NE 'YES').MESG16A  INVALID SUSPEND  @G386P31 31300052
.* SUSPEND=YES REQUIRES BRANCH=YES AND SUMDUMP                 @G386P31 31350052
         AIF   ('&BRANCH' NE 'YES').MESG16B    NO BRANCH=YES   @G386P31 31400052
         AIF   (&SDNSMDP EQ 1).MESG16C    NOSUMDUMP INVALID    @G386P31 31450052
&SDSPEND SETB  1             TURN ON SUSPEND=YES BIT           @G386P31 31500052
.*                                                                      31550052
.********************************************************************** 31600052
.*                                                                      31650052
.*   CHECK FOR NOSUM INVALID WITH SUMLIST/A/L                           31700052
.*                                                             @G860P31 31750052
.********************************************************************** 31800052
.*                                                                      31850052
.SD73    AIF   (&SDNSMDP  EQ  0).SD74  IF NOSUM NOT SPECIFIED  @G860P31 31900052
         AIF   (&SDSUMLT  EQ  1).MESG15  NOSUM AND SUMLIST     @G860P31 31950052
         AIF   (&SDSMLTA  EQ  1).MESG15A  NOSUM AND SUMLSTA    @G860P31 32000052
         AIF   (&SDSMLTL  EQ  1).MESG15B  NOSUM AND SUMLSTL        @L5A 32050052
.*                                                                      32100052
.********************************************************************** 32150052
.*                                                                      32200052
.*   TYPE PARAMETER PROCESSING FOR SINGLE TYPE OPTION                   32250052
.*                                                             @G860P31 32300052
.********************************************************************** 32350052
.*                                                                      32400052
.SD74    AIF   ('&TYPE' EQ '').SD90    IS TYPE PARAMETER SPEC  @G860P31 32450052
         AIF   ('&TYPE'(1,1) EQ '(').SD75 MORE THAN ONE OPTION @G383P1U 32500052
&CTR1    SETA  0              INITIALIZE LOOP COUNTER          @G383P1U 32550052
&SDTYPXM SETB  ('&TYPE' EQ 'XMEM')  SET IF TYPE=XMEM SPECIFIED @G383P1U 32600052
&SDTPXME SETB  ('&TYPE' EQ 'XMEME') SET IF TYPE=XMEME          @G38AP1U 32650052
&SDTYPNL SETB  ('&TYPE' EQ 'NOLOCAL') SET IF TYPE=NOLOCAL      @ZMC2707 32700052
&SDTYPRC SETB  ('&TYPE' EQ 'FAILRC') SET IF TYPE=FAILRC            @L2A 32750052
&CTR1    SETA  &SDTYPXM+&SDTPXME+&SDTYPNL+&SDTYPRC   CALCULATE     @L2C 32800052
.*                           VALID OPTIONS                         @L2A 32850052
&CTR2    SETA  1             INITIALIZE FOR MNOTE              @G383P1U 32900052
         AIF   ('&CTR1'  EQ  '0').MESG4E  NO VALID OPTIONS     @G383P1U 32950052
         AGO   .SD90         TYPE OPTION PROCESSED             @G383P1U 33000052
.*                                                                      33050052
.********************************************************************** 33100052
.*                                                                      33150052
.*   TYPE PARAMETER PROCESSING FOR TYPE OPTIONS IN PARENTHESIS          33200052
.*                                                             @G860P31 33250052
.********************************************************************** 33300052
.*                                                                      33350052
.SD75    ANOP         TYPE PARAMETERS IN PARENTHESIS           @G383P1U 33400052
&CTR1    SETA  N'&TYPE       NUMBER OF TYPE PARAMETERS         @G383P1U 33450052
&CTR2    SETA  0             INDEX OF OPERAND ADDRESSED        @G383P1U 33500052
.SD76    ANOP                TOP OF OPTION LOOP                @G383P1U 33550052
&CTR2    SETA  &CTR2+1       INDEX NEXT OPTION TO WORK ON      @G383P1U 33600052
         AIF    ('&TYPE(&CTR2)' EQ 'XMEM').SETTPXM   XMEM SPEC @G383P1U 33650052
         AIF    ('&TYPE(&CTR2)' EQ 'XMEME').SETTXME XMEME SPEC @G38AP1U 33700052
         AIF    ('&TYPE(&CTR2)' EQ 'NOLOCAL').SETTPNL NOLOCAL SPEC      33750052
.*                                                             @ZMC2707 33800052
         AIF    ('&TYPE(&CTR2)' EQ 'FAILRC').SETTPRC FAILRC SPEC   @L2A 33850052
         AGO    .MESG4E      EXIT PARAMETER INVALID            @G383P1U 33900052
.SETTPXM ANOP                XMEM SPECIFIED                    @G383P1U 33950052
&SDTYPXM SETB  1             SET INDICATOR                     @G383P1U 34000052
         AGO   .SD77         GOTO CHECK FOR END OF TYPE LOOP   @G38AP31 34050052
.SETTPNL ANOP                NOLOCAL SPECIFIED                 @ZMC2707 34100052
&SDTYPNL SETB  1             SET INDICATOR                     @ZMC2707 34150052
         AGO   .SD77         GOTO CHECK FOR END OF TYPE LOOP   @G38AP31 34200052
.SETTPRC ANOP                FAILRC SPECIFIED                      @L2A 34250052
&SDTYPRC SETB  1             SET INDICATOR                         @L2A 34300052
         AGO   .SD77         GOTO CHECK FOR END OF TYPE LOOP       @L2A 34350052
.SETTXME ANOP                XMEME SPECIFIED                   @G38AP31 34400052
&SDTPXME SETB  1             SET INDICATOR                     @G38AP31 34450052
.SD77    AIF   (&CTR1 NE &CTR2).SD76  MORE OPTIONS CONTINUE    @G38AP31 34500052
         AIF   (&SDTYPXM EQ 1 AND &SDTPXME EQ 1).MESG4F    CHECK FOR    34550052
.*                          MUTUALLY EXCLUSIVE TYPE PARAMETERS @G38AP31 34600052
.SD90    ANOP               BUILD TYPE FLAG BYTES              @G383P1U 34650052
&SDTYPF1 SETA  128*&SDTYPXM+64*&SDTPXME+32*&SDTYPNL+16*&SDTYPRC         34700052
.*                                        CALC TYPE FLAG VALUE     @L2C 34750052
.*                                                                      34800052
.********************************************************************** 34850052
.*                                                                      34900052
.*   PROCESS SUBPLST AND KEYLIST OPERANDS                               34950052
.*                                                             @G860P31 35000052
.********************************************************************** 35050052
.*                                                                      35100052
         AIF   ('&KEYLIST' NE '' AND '&SUBPLST' EQ '').MESG17A @G860P31 35150052
.*             KEYLIST IS INVALID WITHOUT SUBPLST              @G860P31 35200052
&SDKYLST SETB  ('&KEYLIST' NE '')            SET KEYLIST FLAG  @G860P31 35250052
&SDSPLST SETB  ('&SUBPLST' NE '')            SET SUBPLST FLAG  @G860P31 35300052
&SDSP21P SETB  1         SET HBB2102 PARMAMETER LIST INDICATOR @G860P31 35350052
&SDSE3PM SETB  1      DEFAULT JBB1226 WHEN HBB2102 IS PRESENT  @G860P31 35400052
.*                                                                      35450052
.********************************************************************** 35500052
.*                                                                      35550052
.*   MAKE FINAL CORRECTIONS TO THE SDFLAG BYTES.                        35600052
.*                                                             @G860P31 35650052
.********************************************************************** 35700052
.*                                                                      35750052
.*       RESET SDFLAG1 FOR JBB1226 BIT                         @G383P1U 35800052
&SDFLAG1 SETA  &SDFLAG1+1*&SDSE3PM  SET SDFLAG1 FOR JBB1226 PARMS       35850052
.*                                                             @G383P1U 35900052
.*       RESET SDFLAG2 FOR JBB1226 SUSPEND PARAMETER           @G386P31 35950052
&SDFLAG2 SETA  &SDFLAG2+32*&SDSPEND+16*&SDSPLST+8*&SDKYLST     @G860P31 36000052
.*       SET SDFLAG2 FOR JBB1226 AND HBB2102 PARAMETERS        @G860P31 36050052
&SDWRITE SETB  (&SDECBWR EQ 1 OR &SDSRBWR EQ 1)                    @D1C 36100052
&SDCNTL1 SETA  &SDCNTL1+128+64+4*&SDWRITE+&SDSRB                   @D1C 36150052
.*       SET SDCNTL1 FOR HBB2102 PARMS + LATER ADDITIONS       @G860P31 36200052
.*                                                                      36250052
.********************************************************************** 36300052
.*                                                                      36350052
.*  SET UP DISPLACEMENTS AND LENGTHS FOR THE 3 TYPES OF EXPANSIONS.     36400052
.*                                                                      36450052
.*  1. CALCULATE THE NUMBER OF ADDRESSES SPECIFIED WITH STORAGE.        36500052
.*  2. CALCULATE LENGTH OF THE FIXED PART OF THE PARAMETER LIST.        36550052
.*  3. CALCULATE THE DISPLACEMENT OF THE STORAGE LIST.                  36600052
.*  4. CALCULATE THE DISPLACEMENT OF THE USER DATA (HDR).               36650052
.*                                                             @G860P31 36700052
.********************************************************************** 36750052
.*                                                                      36800052
&STRCNT  SETA  0                  DEFAULT COUNT OF 0           @G860P31 36850052
         AIF   ('&STORAGE' EQ '').SD91 CHECK FOR STORAGE       @G860P31 36900052
&STRCNT  SETA  N'&STORAGE         NUMBER OF STORAGE ADDRESSES  @G860P31 36950052
.SD91    ANOP                     NOW CALC DISPLACEMENTS       @G860P31 37000052
&DISP1   SETA  112                SP310 DEFAULT PARM LIST LEN      @L3C 37050052
         AIF   ('&PLVER' NE '2').SD92                              @T3A 37100052
&DISP1   SETA  128                SP310-MDUMP PARM LIST LEN        @T3A 37150052
.SD92    ANOP                                                      @T3A 37200052
&DISP2   SETA  &DISP1+(4*&STRCNT) THE USER DATA STARTS AFTER   @G860P31 37250052
.*                                THE STORAGE LIST             @G860P31 37300052
.*                                                                      37350052
.********************************************************************** 37400052
.*                                                                      37450052
.*   DETERMINE WHICH MACRO FORMAT EXPANSION TO DO.                      37500052
.*   STANDARD FORM, EXECUTE OR LIST.                                    37550052
.*                                                             @G860P31 37600052
.********************************************************************** 37650052
.*                                                                      37700052
         AIF   ('&MF' EQ '').STFORM          IS IT STANDARD FORM        37750052
         AIF   ('&MF' EQ 'L').LSTFORM        IS IT LIST FORM            37800052
         AIF   ('&MF'(1,3) NE '(E,').MESG7   ELSE, IF NOT EXECUTE, ERR  37850052
.*                                                                      37900052
.*                                                                      37950052
.*                                                                      38000052
.********************************************************************** 38050052
.*                                                                      38100052
.*       EXECUTE FORM EXPANSION OF MACRO                                38150052
.*                                                             @G860P31 38200052
.********************************************************************** 38250052
.*                                                                      38300052
.*                                                                      38350052
.*                                                                      38400052
         AIF   ('&NAME' EQ '').SDEX2        IS NAME SPECIFIED           38450052
&NAME    DS    0H                                                       38500052
.SDEX2   AIF   ('&MF(2)' EQ '').MESG5E      ERROR IF MISSING   @G860P31 38550052
         IHBSETR   &MF(2),1                 LOAD REG 1 WITH LIST ADDR   38600052
.************************* EXECUTE FORM  ****************************** 38650052
.*                                                                      38700052
.* MAKE SURE NO STORAGE IS ALTERED ON AN EXECUTE FORM OF THE            38750052
.*  SDUMP MACRO WHEN THE ONLY PARAMETER SPECIFIED IS MF.                38800052
.*                                                            @ZA51194  38850052
.********************************************************************** 38900052
         AIF   ('&HDR' NE '' OR  '&HDRAD' NE '' OR '&DCB' NE '' OR '&AS*38950052
               ID' NE '' OR '&ASIDLST' NE '' OR '&ECB' NE '' OR '&SDATA*39000052
               ' NE '' OR '&STORAGE' NE '' OR '&LIST' NE '').SDEX2A     39050052
.*                                                             @ZA51194 39100052
         AIF   ('&SUMLIST' NE '' OR '&BUFFER' NE '' OR '&QUIESCE' NE ''*39150052
               OR '&LISTA' NE '' OR '&TYPE' NE '' OR '&SUMLSTA' NE '' O*39200052
               R '&SUSPEND' NE '' OR '&BRANCH' NE '' OR                *39250052
               '&SUMLSTL' NE '' OR '&LISTD' NE '').SDEX2A          @T3C 39300052
         AIF   ('&SUSPEND' NE '' OR '&SUBPLST' NE '' OR '&KEYLIST' NE '*39350052
               ' OR '&SRB' NE '').SDEX2A                           @L4C 39400052
         AIF   ('&SYMREC' NE '' OR '&ID' NE '' OR '&IDAD' NE '' OR '&PS*39450052
               WREGS' NE '').SDEX2A                                @T1P 39500052
.*                                                                      39550052
.*       THE PLISTVER TEST MUST BE LAST                                 39600052
.*                                                                      39650052
         AIF   ('&PLISTVER' EQ '').SDEX49                          @T1P 39700052
         MVI   43(1),&PLVER                 SET VERSION NUMBER     @T1P 39750052
         AGO   .SDEX49                                         @ZA51194 39800052
.*                                                             @ZA51194 39850052
.SDEX2A  ANOP                                                           39900052
.*                                                                      39950052
.*                                                                      40000052
.************************* EXECUTE FORM  ****************************** 40050052
.*                                                                      40100052
.*       PROCESS 1ST 4 FLAG BYTES                                       40150052
.*                                                             @G860P31 40200052
.********************************************************************** 40250052
.*                                                                      40300052
         MVI   43(1),&PLVER                 SET VERSION NUMBER     @T1P 40350052
         AIF   ('&QUIESCE' NE '').SDEX3     IS QUIESCE SPECIFIED        40400052
&SDFLAG0 SETA  &SDFLAG0-2                   NO, LEAVE AS SPECIFIED ON L 40450052
.*             SUBTRACT 2 TO REMOVE THE DEFAULTED QUIESCE=YES  @G860P31 40500052
.SDEX3   AIF   ('&SDFLAG0' EQ '0').SDEX3A   ANY OPTIONS TO TURN ON      40550052
         OI    0(1),&SDFLAG0                SET OPTION FLAGS            40600052
.SDEX3A  AIF   ('&BUFFER' EQ 'NO').SDEX4    BUFFER NOT REQUESTED        40650052
         AGO   .SDEX6                       GO CHECK FOR QUIESCE        40700052
.SDEX4   ANOP                                                           40750052
         NI    0(1),X'BF'                   TURN OFF BUFFER FLAG        40800052
.SDEX6   AIF   ('&QUIESCE' EQ 'NO').SDEX8   QUIESCE NOT REQUESTED       40850052
         AGO   .SDEX10                      GO SET SVC DUMP FLAG        40900052
.SDEX8   ANOP                                                           40950052
         NI    0(1),X'FD'                   TURN OFF QUIESCE FLAG       41000052
.SDEX10  ANOP                                                           41050052
         AIF  ('&SDFLAG1' EQ '0').SDEX11 ANY OPTIONS TO TURN ON         41100052
.*                                                             @G383P1U 41150052
         OI    1(1),&SDFLAG1                SET OPTION BITS             41200052
.SDEX11  ANOP                                                  @G33VPHD 41250052
         AIF   ('&SDATA' EQ '').SDEX12      IS SDATA OPTIONS SPECIFIED  41300052
         MVI   2(1),&SDATAF1                SET OPTION FLAGS            41350052
         MVI   3(1),&SDATAF2                SET OPTION FLAGS            41400052
         MVI   46(1),&SDAT3                 SET OPTION FLAGS            41450052
.*                                                                      41500052
.************************* EXECUTE FORM  ****************************** 41550052
.*                                                                      41600052
.*       PROCESS DCB OPTION                                             41650052
.*                                                             @G860P31 41700052
.********************************************************************** 41750052
.*                                                                      41800052
.SDEX12  AIF   ('&DCB' EQ '').SDEX15        IS DCB SPECIFIED            41850052
         IHBSETR   &DCB,0                   LOAD REG 0 WITH DCB ADDR    41900052
         ST    0,4(0,1)               ADDR OF DCB INTO PARAM LIST  @L3C 41950052
         AIF   ('&SYSASCE' EQ 'P').NOAR1                           @L3A 42000052
         STAM  0,0,60(1)              SAVE DCB ALET                @L3A 42050052
.NOAR1   ANOP                                                      @L3A 42100052
.SDEX15  ANOP                                                           42150052
.*                                                                      42200052
.************************* EXECUTE FORM  ****************************** 42250052
.*                                                                      42300052
.*       PROCESS LIST, LISTA, STORAGE OR LISTD OPTIONS                  42350052
.*                                                                 @L6C 42400052
.********************************************************************** 42450052
.*                                                                      42500052
         AIF   ('&LIST' EQ '').SDEX16       IS LIST SPECIFIED  @G383P1U 42550052
         IHBSETR   &LIST,0                  LOAD REG 0 WITH LIST ADDR   42600052
         ST    0,8(0,1)               ADDR OF LIST INTO PARAM LST  @L3C 42650052
         AIF   ('&SYSASCE' EQ 'P').NOAR2                           @L3A 42700052
         STAM  0,0,64(1)              SAVE LIST ALET               @L3A 42750052
.NOAR2   ANOP                                                      @L3A 42800052
         AGO   .SDEX23                      GO CHECK FOR LISTD     @L6C 42850052
.SDEX16  ANOP                LISTA OPTION PROCESSING           @G383P1U 42900052
         AIF   ('&LISTA' EQ '').SDEX20   IS LISTA SPECIFIED    @G383P1U 42950052
         IHBSETR    &LISTA,0      LOAD R0 WITH LISTA ADDRESS   @G383P1U 43000052
         ST    0,8(,1)            PUT LISTA ADDR IN PARM LIST      @L3C 43050052
         AIF   ('&SYSASCE' EQ 'P').NOAR3                           @L3A 43100052
         STAM  0,0,64(1)              SAVE LISTA ALET              @L3A 43150052
.NOAR3   ANOP                                                      @L3A 43200052
         AGO   .SDEX23            GO CHECK FOR LISTD               @L6C 43250052
.SDEX20  AIF   ('&STORAGE' EQ '').SDEX23    IS STORAGE SPECIFIED        43300052
         &LA   15,&DISP1.(,1)     NEW ADDRESS OF THE STORAGE LIST AT   *43350052
                                  THE END OF THE PARAMETER LIST POINTED*43400052
                                  TO BY MF=(E,PARM ADDRESS)        @L3C 43450052
         ST    15,8(,1)           PLACE NEW STORAGE LIST ADDRESS IN THE 43500052
.*                                PARAMETER LIST               @G860P31 43550052
         AIF   ('&SYSASCE' EQ 'P').NOAR4                           @L3A 43600052
         STAM  15,15,64(1)            SAVE STORAGE ALET            @L3A 43650052
.NOAR4   ANOP                                                      @L3A 43700052
&DISP    SETA  -4                 DISPLACEMENT OF ADDR IN STORAGE LIST  43750052
&CTR1    SETA  N'&STORAGE         NUMBER OF ADDRESSES SPECIFIED         43800052
&CTR2    SETA  0                  POSITION NUMBER OF ADDR WORKING ON    43850052
.LOOPC1  ANOP                                                           43900052
&DISP    SETA  &DISP+4                 DISP OF NEXT ADDR IN STORAGE LST 43950052
&CTR2    SETA  &CTR2+1                 POSITION NUMBER OF NEXT ADDRESS  44000052
         IHBSETR   &STORAGE(&CTR2),0   PUT STORAGE ADDRESS IN REG 0     44050052
         ST    0,&DISP.(0,15)          STORAGE ADDR INTO STORAGE LIST   44100052
&CTR1    SETA  &CTR1-1                 NUMBER OF REMAINING ADDRESSES    44150052
         AIF   (&CTR1 NE 0).LOOPC1   ANY MORE ADDRESSES                 44200052
         OI    &DISP.(15),X'80'      SET END OF LIST INDICATOR          44250052
.SDEX23  ANOP                        LISTD OPTION PROCESSING       @L6A 44300052
         AIF   ('&LISTD' EQ '').SDEX25   IS LISTD SPECIFIED        @L6A 44350052
         IHBSETR    &LISTD,0      LOAD R0 WITH LISTD ADDRESS       @L6A 44400052
         ST    0,88(,1)          PUT LISTD ADDR IN PARM LIST       @L6A 44450052
         AIF   ('&SYSASCE' EQ 'P').NOAR4C                          @L6A 44500052
         STAM  0,0,92(1)              SAVE LISTD ALET              @L6A 44550052
.NOAR4C  ANOP                                                      @L6A 44600052
         AGO   .SDEX25            GO CHECK FOR USER PARAMETERS     @L6A 44650052
.*                                                                      44700052
.************************* EXECUTE FORM  ****************************** 44750052
.*                                                                      44800052
.*       PROCESS USER DATA, HDR OR HDRAD                                44850052
.*                                                             @G860P31 44900052
.********************************************************************** 44950052
.*                                                                      45000052
.SDEX25  AIF   ('&HDRAD' EQ '').SDEX30      IS HDRAD SPECIFIED          45050052
         IHBSETR   &HDRAD,0                 LOAD REG0 WITH HDR RCD ADDR 45100052
         ST    0,12(0,1)              ADDR OF HDRAD INTO LIST      @L3C 45150052
         AIF   ('&SYSASCE' EQ 'P').NOAR5                           @L3A 45200052
         STAM  0,0,68(1)              SAVE HDRAD ALET              @L3A 45250052
.NOAR5   ANOP                                                      @L3A 45300052
         AGO   .SDEX35                      GO CHECK FOR ECB            45350052
.SDEX30  AIF   ('&HDR' EQ '').SDEX35        IS HDR SPECIFIED            45400052
&GNAME   SETC  'IHB'.'&SYSNDX'              GET A UNIQUE SYMBOL         45450052
         BAL   15,&GNAME                    BRANCH AROUND USER DATA     45500052
&CTR1    SETA  K'&HDR-2-&HDRCTR             LENGTH OF USER DATA         45550052
         DC    AL1(&CTR1)                   LENGTH OF USER DATA         45600052
         DC    C&HDR                        USER DATA                   45650052
.*       CNOP  2,4                                                      45700052
&GNAME   DS    0H                                                       45750052
         ST    15,12(0,1)             ADDR OF HEADER INTO LIST     @L3C 45800052
         AIF   ('&SYSASCE' EQ 'P').NOAR6                           @L3A 45850052
         SLR   15,15                  STORAGE IS IN PRIMARY        @L3A 45900052
         ST    15,72(0,1)             SAVE HDR ALET                @L3A 45950052
.NOAR6   ANOP                                                      @L3A 46000052
.*                                                                      46050052
.************************* EXECUTE FORM  ****************************** 46100052
.*                                                                      46150052
.*       PROCESS ECB OPTION                                             46200052
.*                                                             @G860P31 46250052
.********************************************************************** 46300052
.*                                                                      46350052
.SDEX35  AIF   ('&ECB' EQ '').SDEX38        IS ECB SPECIFIED       @L4C 46400052
         AIF   (N'&ECB GT 1).SDEX37B IS MORE THAN 1 PARM PRESENT   @L8A 46450052
         AIF   ('&ECB'(1,1) EQ '(').SDEX37A IS ECB ADDR IN A REG   @L8C 46500052
         L     15,&ECB                      ADDRESS OF ECB              46550052
         ST    15,16(0,1)             ADDR OF ECB INTO PARAM LIST  @L3C 46600052
         AGO   .SDEX40                      GO CHECK FOR ASID           46650052
.SDEX37A ST    &ECB(1),16(0,1)        ADDR OF ECB INTO PARAM LIST  @L8C 46700052
         AGO   .SDEX40                      GO CHECK FOR ASID      @L8A 46750052
.SDEX37B AIF   ('&ECB(1)'(1,1) EQ '(').SDEX37C IS THE ADDRESS OF THE   X46800052
               ECB IN A REGISTER                                   @L8A 46850052
         L     15,&ECB(1)                   ADDRESS OF ECB         @L8A 46900052
         ST    15,16(0,1)             ADDR OF ECB INTO PARAM LIST  @L8A 46950052
         AGO   .SDEX40                      GO CHECK FOR ASID      @L8A 47000052
.SDEX37C ST    &ECB(1,1),16(0,1)      ADDR OF ECB INTO PARAM LIST  @L8A 47050052
         AGO   .SDEX40                      GO CHECK FOR ASID      @L8A 47100052
.*                                                                      47150052
.************************* EXECUTE FORM  ****************************** 47200052
.*                                                                      47250052
.*       PROCESS SRB OPTION                                             47300052
.*                                                                 @L4A 47350052
.********************************************************************** 47400052
.*                                                                 @L4A 47450052
.SDEX38  AIF   ('&SRB' EQ '').SDEX40        IS SRB SPECIFIED       @L4A 47500052
         AIF   (N'&SRB GT 1).SDEX39B IS MORE THAN 1 PARM PRESENT   @L8A 47550052
         AIF   ('&SRB'(1,1) EQ '(').SDEX39A   IS SRB ADDR IN A REG @L8C 47600052
         L     15,&SRB                      ADDRESS OF SRB         @L4A 47650052
         ST    15,16(0,1)             ADDR OF SRB INTO PARAM LIST  @L4A 47700052
         AGO   .SDEX40                      GO CHECK FOR ASID      @L4A 47750052
.SDEX39A ST    &SRB(1),16(0,1)        ADDR OF SRB INTO PARAM LIST  @L8C 47800052
         AGO   .SDEX40                      GO CHECK FOR ASID      @L8A 47850052
.SDEX39B AIF   ('&SRB(1)'(1,1) EQ '(').SDEX39C IS THE ADDRESS OF THE   X47900052
               SRB IN A REGISTER                                   @L8A 47950052
         L     15,&SRB(1)                   ADDRESS OF SRB         @L8A 48000052
         ST    15,16(0,1)             ADDR OF SRB INTO PARAM LIST  @L8A 48050052
         AGO   .SDEX40                      GO CHECK FOR ASID      @L8A 48100052
.SDEX39C ST    &SRB(1,1),16(0,1)      ADDR OF SRB INTO PARAM LIST  @L8A 48150052
.*                                                                 @L4A 48200052
.************************* EXECUTE FORM  ****************************** 48250052
.*                                                                      48300052
.*       PROCESS ASID OR ASIDLST OPTION                                 48350052
.*                                                             @G860P31 48400052
.********************************************************************** 48450052
.*                                                                      48500052
.SDEX40  AIF   ('&ASID' EQ '').SDEX45       IS ASID SPECIFIED           48550052
         AIF   ('&ASID'(1,1) EQ '(').SDEX42 IS ASID IN A REGISTER       48600052
         LH    0,&ASID                      ASID OF MEMORY TO BE DUMPED 48650052
         STH   0,22(0,1)              ASID INTO PARAMETER LIST     @L3C 48700052
         AGO   .SDEX47                  GO CHECK FOR SUMLIST   @GXXXPXX 48750052
.*                                                             @G33VPHD 48800052
.SDEX42  ANOP                                                           48850052
         STH   &ASID,22(0,1)          ASID INTO PARAMETER LIST     @L3C 48900052
         AGO   .SDEX47                      GO CHECK FOR SUMLIST        48950052
.*                                                             @G33VPHD 49000052
.SDEX45  AIF   ('&ASIDLST' EQ '').SDEX47 IF ASIDLIST SPECIFIED          49050052
.*                                                             @G33VPHD 49100052
         IHBSETR   &ASIDLST,0           LOAD REG 0 WITH ASIDLIST ADDR   49150052
.*                                                             @G33VPHD 49200052
         ST    0,24(0,1)                ADDR ASIDLIST INTO PARM LIST *  49250052
         AIF   ('&SYSASCE' EQ 'P').NOAR7                           @L3A 49300052
         STAM  0,0,72(1)              SAVE ASIDLST ALET            @L3A 49350052
.NOAR7   ANOP                                                      @L3A 49400052
.*                                                                      49450052
.************************* EXECUTE FORM  ****************************** 49500052
.*                                                                      49550052
.*       PROCESS SUMLIST, SUMLSTA OR SUMLSTL OPTION                     49600052
.*                                                             @G860P31 49650052
.********************************************************************** 49700052
.*                                                                      49750052
.SDEX47  AIF   ('&SUMLIST' EQ '').SDEX48 IF SUMLIST SPECIFIED  @G383P1U 49800052
         IHBSETR   &SUMLIST,0           LOAD REG 0 WITH SUMLIST ADDR    49850052
.*                                                             @G33VPHD 49900052
         ST    0,28(0,1)                ADDR SUMLIST IN PARM LIST  @L3C 49950052
         AIF   ('&SYSASCE' EQ 'P').NOAR8A                          @L3A 50000052
         STAM  0,0,76(1)              SAVE SUMLIST ALET            @L3A 50050052
.NOAR8A  ANOP                                                      @L3A 50100052
.SDEX48  ANOP                                                  @G383P1U 50150052
         AIF   ('&SUMLSTA' EQ '').SDEX48L IS SUMLSTA SPECIFIED @G383P1U 50200052
         IHBSETR    &SUMLSTA,0    LOAD R0 WITH SUMLSTA ADDRESS @G383P1U 50250052
         ST    0,28(0,1)         MOVE SUMLSTA ADDR TO PARMLIST     @L3C 50300052
         AIF   ('&SYSASCE' EQ 'P').NOAR8                           @L3A 50350052
         STAM  0,0,76(1)              SAVE SUMLSTA ALET            @L3A 50400052
.NOAR8   ANOP                                                      @L3A 50450052
.SDEX48L ANOP                                                      @L5A 50500052
         AIF   ('&SUMLSTL' EQ '').SDEX48A IS SUMLSTL SPECIFIED     @L5A 50550052
         IHBSETR    &SUMLSTL,0    LOAD R0 WITH SUMLSTL ADDRESS     @L5A 50600052
         ST    0,96(0,1)         MOVE SUMLSTL ADDR TO PARMLIST     @L5A 50650052
         AIF   ('&SYSASCE' EQ 'P').NOARL                           @L5A 50700052
         STAM 0,0,100(1)             SAVE SUMLSTL ALET             @L5A 50750052
.NOARL   ANOP                                                      @L5A 50800052
.*                                                                      50850052
.************************* EXECUTE FORM  ****************************** 50900052
.*                                                                      50950052
.*       PROCESS FLAG BYTES FOR SDFLAG2, TYPE OPTION, AND EXITS.        51000052
.*                                                             @G860P31 51050052
.********************************************************************** 51100052
.*                                                                      51150052
.SDEX48A AIF   ('&SDFLAG2' EQ '0').SDEX48B  ANY FLAG2 FIELDS   @G383P1U 51200052
         OI    40(1),&SDFLAG2    SET OPTION FLAGS              @G383P1U 51250052
.SDEX48B AIF   ('&SDCNTL1' EQ '0').SDEX48C  ANY CNTL OPTIONS   @G860P31 51300052
         OI    41(1),&SDCNTL1               SET CONTROL FLAGS  @G860P31 51350052
.SDEX48C AIF   ('&SDTYPF1' EQ '0').SDEX48D  ANY TYPE OPTIONS   @G383P1U 51400052
         OI    42(1),&SDTYPF1               SET TYPE FLAGS     @G383P1U 51450052
.SDEX48D AIF   ('&SDATAF3' EQ '0').SDEX48E  ANY EXIT OPTIONS   @G383P1U 51500052
         OI    44(1),&SDATAF3               SET EXIT FLAGS     @G383P1U 51550052
.*                                                                      51600052
.************************* EXECUTE FORM  ****************************** 51650052
.*                                                                      51700052
.*       PROCESS  SUBPLST  AND  KEYLIST  OPTIONS.                       51750052
.*                                                             @G860P31 51800052
.********************************************************************** 51850052
.*                                                                      51900052
.SDEX48E AIF   (&SDSPLST EQ 0).SDEXM00 IS SUBPLST SPECIFIED        @T1P 51950052
         IHBSETR &SUBPLST,0           LOAD SUBPLST ADDRESS     @G860P31 52000052
         ST    0,48(0,1)                    STORE SUBPLST ADDR     @L3C 52050052
         AIF   ('&SYSASCE' EQ 'P').NOAR9                           @L3A 52100052
         STAM  0,0,80(1)              SAVE SUBPLST ALET            @L3A 52150052
.NOAR9   ANOP                                                      @L3A 52200052
         AIF   (&SDKYLST EQ 0).SDEXM00 IS KEYLIST SPECIFIED        @T1P 52250052
         IHBSETR &KEYLIST,0           LOAD KEYLIST ADDRESS     @G860P31 52300052
         ST    0,52(0,1)              STORE KEYLIST ADDRESS        @L3C 52350052
         AIF   ('&SYSASCE' EQ 'P').NOAR10                          @L3A 52400052
         STAM  0,0,84(1)              SAVE KEYLIST ALET            @L3A 52450052
.NOAR10  ANOP                                                      @L3A 52500052
.*                                                                      52550052
.************************* EXECUTE FORM  ****************************** 52600052
.*                                                                      52650052
.*       PROCESS  PSWREGS OPTION                                        52700052
.*                                                                 @T1P 52750052
.********************************************************************** 52800052
.*                                                                      52850052
.SDEXM00 AIF   (&SDPREG EQ 0).SDEXM01 IS PSWREGS SPECIFIED         @T1P 52900052
         IHBSETR &PSWREGS,0           LOAD PSWREGS ADDRESS         @T1P 52950052
         ST    0,104(,1)                    STORE PSWREGS ADDR     @T1P 53000052
         AIF   ('&SYSASCE' EQ 'P').NOAR22                          @T3A 53050052
         STAM  0,0,108(1)                   SAVE PSWREGS ALET      @T3A 53100052
.NOAR22  ANOP                                                      @T3A 53150052
.*                                                                      53200052
.************************* EXECUTE FORM  ****************************** 53250052
.*                                                                      53300052
.*       PROCESS  SYMREC OPTION                                         53350052
.*                                                                 @T1P 53400052
.********************************************************************** 53450052
.*                                                                      53500052
.SDEXM01 AIF   (&SDSRS EQ 0).SDEXM02  IS SYMREC SPECIFIED          @T1P 53550052
         IHBSETR &SYMREC,0            LOAD SYMREC ADDRESS          @T1P 53600052
         ST    0,112(,1)                    STORE SYMREC ADDR      @T1P 53650052
         AIF   ('&SYSASCE' EQ 'P').NOAR23                          @T3A 53700052
         STAM  0,0,116(1)                   SAVE SYMREC ALET       @T3A 53750052
.NOAR23  ANOP                                                      @T3A 53800052
.*                                                                      53850052
.************************* EXECUTE FORM  ****************************** 53900052
.*                                                                      53950052
.*       PROCESS ID/IDAD                                                54000052
.*                                                                 @T1P 54050052
.********************************************************************** 54100052
.*                                                                      54150052
.SDEXM02 AIF   ('&IDAD' EQ '').SDEXM03      IS IDAD SPECIFIED      @T1P 54200052
         IHBSETR   &IDAD,0                  GET ADDRESS OF ID      @T1P 54250052
         ST    0,120(0,1)                   SAVE IDAD INTO LIST    @T1P 54300052
         AIF   ('&SYSASCE' EQ 'P').NOAR24                          @T3A 54350052
         STAM  0,0,124(1)                   SAVE IDAD ALET         @T3A 54400052
.NOAR24  ANOP                                                      @T3A 54450052
         AGO   .SDEXM04                     CHECK FURTHER          @T1P 54500052
.SDEXM03 AIF   ('&ID' EQ '').SDEXM04        IS ID SPECIFIED        @T1P 54550052
&GNAME   SETC  'IHB'.'&SYSNDX.'.'A'         GET A UNIQUE SYMBOL    @T1P 54600052
         BAL   15,&GNAME                    BRANCH AROUND DATA     @T1P 54650052
&CTR1    SETA  K'&ID-2-&IDCTR               LENGTH OF USER DATA    @T1P 54700052
&TEMP    SETC  'IHB'.'&SYSNDX.'.'I'                                @T1P 54750052
&TEMP    DC    AL1(&CTR1)                   LENGTH OF ID           @T1P 54800052
         DC    C&ID                         ID                     @T1P 54850052
&GNAME   DS    0H                                                  @T1P 54900052
         ST    15,120(0,1)                  SAVE IDAD INTO LIST    @T1P 54950052
         AIF   ('&SYSASCE' EQ 'P').NOAR25                          @T3A 55000052
         SLR   15,15                        STORAGE IS IN PRIMARY  @T3A 55050052
         ST    15,124(,1)                   SAVE ID ALET           @T3A 55100052
.NOAR25  ANOP                                                      @T3A 55150052
.SDEXM04 ANOP                                                      @T1P 55200052
.*                                                                      55250052
.*                                                                      55300052
.************************* EXECUTE FORM  ****************************** 55350052
.*                                                                      55400052
.*       CLOSE OUT THE EXECUTE FORM EXPANSION.                          55450052
.*                                                             @G860P31 55500052
.********************************************************************** 55550052
.*                                                                      55600052
.SDEX49  AIF   ('&BRANCH' EQ 'YES').SDEX50  IS A BRANCH ENTRY  @G383P1U 55637052
         AGO   .SDVSEC1                     GO CHECK FOR VSE   @D52GHTN 55674052
         SVC   51                           INVOKE SVC DUMP VIA SVC     55711052
.SDVSEC1 ANOP                               CHECK FOR VSE/ESA  @D52GHTN 55716552
         L     15,16(0,0)                   ADDRESS OF CVT     @D52GHTN 55722052
         TM    X'74'(15),X'A8'              IS VSE/ESA ACTIVE? @G52GHTN 55727552
         BZ    *+10                         IF NO, GO CALL MVS CODE     55733052
         SVC   123                          CALL VSE/ESA SDUMP @G52GHTN 55738552
         B     *+6                          AND BRANCH TO CONTINUE ...  55744052
         SVC   51                           INVOKE MVS SVC DUMP VIA SVC 55772052
         AGO   .SDEND                       GO END MACRO PROCESSING     55800052
.SDEX50  ANOP                                                           55850052
         L     15,16(0,0)                   ADDRESS OF CVT       YM1995 55900052
         L     15,1028(15,0)            ADDRESS OF SVC DUMP ENTRYYM1995 55950052
         BALR  14,15                        INVOKE SVC DUMP VIA BAL     56000052
         AGO   .SDEND                       GO END MACRO PROCESSING     56050052
.*                                                                      56100052
.*                                                                      56150052
.*                                                                      56200052
.************************ LIST FORM *********************************** 56250052
.*                                                                      56300052
.*       LIST FORM EXPANSION BEGINS HERE                                56350052
.*                                                             @G860P31 56400052
.********************************************************************** 56450052
.*                                                                      56500052
.*                                                                      56550052
.*                                                                      56600052
.LSTFORM ANOP                                                           56650052
&NAME    DS    0F                           SDUMP PARAMETER LIST        56700052
.*                                                                      56750052
.************************ LIST FORM *********************************** 56800052
.*                                                                      56850052
.*       PROCESS 1ST 4 FLAG BYTES  AND  DCB                             56900052
.*                                                             @G860P31 56950052
.********************************************************************** 57000052
.*                                                                      57050052
         DC    AL1(&SDFLAG0)                FLAG BYTE                   57100052
         DC    AL1(&SDFLAG1)                FLAG BYTE                   57150052
         DC    AL1(&SDATAF1)                FLAG BYTE                   57200052
         DC    AL1(&SDATAF2)                FLAG BYTE                   57250052
         AIF   ('&DCB' EQ '').SDLST10       IS DCB SPECIFIED            57300052
         AIF   ('&DCB'(1,1) EQ '(').MESG1   IS DCB ADDRESS IN A REG     57350052
         DC    A(&DCB)                      ADDRESS OF DCB              57400052
         AGO   .SDLST15                     GO CHECK FOR STORAGE ADDR   57450052
.SDLST10 ANOP                                                           57500052
         DC    A(0)                         ADDRESS OF DCB              57550052
.*                                                                      57600052
.************************ LIST FORM *********************************** 57650052
.*                                                                      57700052
.*       PROCESS STORAGE, LIST OR LISTA OPTION.                         57750052
.*                                                             @G860P31 57800052
.********************************************************************** 57850052
.*                                                                      57900052
.SDLST15 AIF   ('&SDSTOR' NE '0').SDLST16   STORAGE/LIST SPEC @G383P1U  57950052
         AIF   ('&LISTA' EQ '').SDLST24     IS LISTA SPECIFIED @G383P1U 58000052
         AIF   ('&LISTA'(1,1) EQ '(').MESG1  CHECK FOR R FORM  @G383P1U 58050052
         DC    A(&LISTA)               ADDRESS OF STORAGE LIST @G383P1U 58100052
         AGO   .SDLST25                     LISTA OPTION DONE  @G383P1U 58150052
.SDLST16 AIF   ('&LIST' EQ '').SDLST20      IS LIST SPECIFIED           58200052
         AIF   ('&LIST'(1,1) EQ '(').MESG1  IS LIST ADDRESS IN A REG    58250052
         DC    A(&LIST)                     ADDRESS OF STORAGE LIST     58300052
         AGO   .SDLST25                     GO CHECK FOR USER DATA      58350052
.SDLST20 ANOP                               STORAGE SPECIFIED  @G860P31 58400052
         DC    A(*-8+&DISP1)        ADDRESS OF STORAGE LIST    @G860P31 58450052
.*             (*-8) POINTS TO THE FRONT OF THE PARAMETER LIST @G860P31 58500052
.*             DISP1 IS THE OFFSET TO THE END OF THE PARAMETER @G860P31 58550052
.*             LIST, WHICH IS WHERE THE STORAGE ADDRESSES ARE  @G860P31 58600052
.*             BUILT INTO THE PARAMETER LIST.                  @G860P31 58650052
         AGO   .SDLST25                SKIP NULL DECLARE       @G383P1U 58700052
.SDLST24 ANOP                                                           58750052
         DC    A(0)                         ADDRESS OF STORAGE LIST     58800052
.*                                                                      58850052
.************************ LIST FORM *********************************** 58900052
.*                                                                      58950052
.*       PROCESS USER DATA, HDR OR HDRAD OPTION.                        59000052
.*                                                             @G860P31 59050052
.********************************************************************** 59100052
.*                                                                      59150052
.SDLST25 ANOP                                                           59200052
         AIF   ('&SDHDR' EQ '0').SDLST38    IS USER DATA SPECIFIED      59250052
         AIF   ('&HDRAD' NE '').SDLST35     IS HDRAD SPECIFIED          59300052
         DC    A(*-12+&DISP2)               HDR ADDRESS        @G860P31 59350052
.*             (*-12) IS THE ADDRESS OF THE BEGINNING OF THE   @G860P31 59400052
.*             DISP2 IS THE OFFSET OF THE USER DATA (HDR) FROM @G860P31 59450052
.*             THE BEGINNING OF THE PARAMETER LIST.  DISP2     @G860P31 59500052
.*             IS EQUAL TO THE LENGTH OF THE FIXED PART OF THE @G860P31 59550052
.*             PARAMETER LIST PLUS THE LENGTH OF THE STORAGE   @G860P31 59600052
.*             ADDRESS LIST.                                   @G860P31 59650052
         AGO   .SDLST40                     GO DEFINE REST OF PARAM LST 59700052
.SDLST35 AIF   ('&HDRAD'(1,1) EQ '(').MESG1 IS ADDR OF USER DATA IN REG 59750052
         DC    A(&HDRAD)                    ADDRESS OF USER DATA        59800052
         AGO   .SDLST40                     GO DEFINE REST OF PARAM LST 59850052
.SDLST38 ANOP                                                           59900052
         DC    A(0)                         ADDRESS OF USER DATA        59950052
.*                                                                      60000052
.************************ LIST FORM *********************************** 60050052
.*                                                                      60100052
.*       SAVE SPOTS FOR ECB/SRB, ASID, AND ASIDLST.  THESE OPTIONS ARE  60150052
.*       NOT ALLOWED ON THE LIST FORM.                                  60200052
.*                                                                 @L4C 60250052
.********************************************************************** 60300052
.*                                                                      60350052
.SDLST40 ANOP                                                           60400052
         DC    A(0)                         ADDRESS OF ECB/SRB     @L4C 60450052
         DC    AL2(0)                       CURRENT ASID                60500052
         DC    AL2(0)                       OTHER ASID                  60550052
         DC    A(0)                         ADDRESS OF ASID LIST        60600052
.*                                                                      60650052
.************************ LIST FORM *********************************** 60700052
.*                                                                      60750052
.*       PROCESS SUMLIST OR SUMLSTA OPTION                              60800052
.*                                                             @G860P31 60850052
.********************************************************************** 60900052
.*                                                                      60950052
         AIF   (&SDSUMLT EQ 0).SDLST45 IF SUMLIST NO SPECIFIED @G383P1U 61000052
         AIF   ('&SUMLIST'(1,1) EQ '(').MESG1 REGISTER INVALID @G383P1U 61050052
         DC    A(&SUMLIST)                 ADDRESS OF SUMLIST  @G383P1U 61100052
         AGO   .SDLST50                                        @G383P1U 61150052
.SDLST45 ANOP                                                  @G383P1U 61200052
         AIF   (&SDSMLTA EQ 0).SDLST49 IF SUMLSTA NO SPECIFIED @G383P1U 61250052
         AIF   ('&SUMLSTA'(1,1) EQ '(').MESG1 REGISTER INVALID @G383P1U 61300052
         DC    A(&SUMLSTA)                  ADDRESS OF SUMLSTA @G383P1U 61350052
         AGO   .SDLST50                                        @G383P1U 61400052
.SDLST49 ANOP                                                  @G383P1U 61450052
         DC    A(0)           ADDRESS OF SUMLIST/SUMLSTA LIST  @G383P1U 61500052
.*                                                                      61550052
.************************ LIST FORM *********************************** 61600052
.*                                                                      61650052
.*       2 WORDS RESERVED FOR SLIP AND SYSMDUMP PURPOSES.               61700052
.*                                                             @G860P31 61750052
.********************************************************************** 61800052
.*                                                                      61850052
.SDLST50 ANOP                                                           61900052
         DC    A(0)                      RESERVED              @G33VPHD 61950052
         DC    A(0)                      RESERVED              @G33VPHD 62000052
         DC    AL1(&SDFLAG2)             FLAG BYTE             @G383P1U 62050052
         DC    AL1(&SDCNTL1)             CONTROL FLAG BYTE     @G860P31 62100052
         DC    AL1(&SDTYPF1)             TYPE FLAG BYTE        @G383P1U 62150052
         DC    AL1(&PLVER.)              VERSION                   @T1P 62200052
         DC    AL1(&SDATAF3)             EXIT FLAG BYTE        @G383P1U 62250052
         DC    AL1(0)                    RESERVED SDATA/EXIT       @T1P 62300052
         DC    AL1(&SDAT3)               SDATA OPTIONS             @T1P 62350052
         DC    AL1(0)                    RESERVED SDATA OPTIONS    @T1P 62400052
         AIF   (&SDSPLST  EQ  0).SDLST55 CHECK FOR SUBPLST     @G860P31 62450052
         AIF   ('&SUBPLST'(1,1) EQ '(').MESG1 REG FORM INVALID @G860P31 62500052
         DC    A(&SUBPLST)               ADDRESS OF SUBPLST    @G860P31 62550052
         AIF   (&SDKYLST  EQ  0).SDLST56 CHECK FOR KEYLIST     @G860P31 62600052
         AIF   ('&KEYLIST'(1,1) EQ '(').MESG1 REG FORM INVALID @G860P31 62650052
         DC    A(&KEYLIST)               ADDRESS OF KEYLIST    @G860P31 62700052
         AGO   .SDLST57                  SKIP NEXT 2 DC STMTS  @G860P31 62750052
.SDLST55 ANOP                           FILL IN RESERVED SLOTS @G860P31 62800052
         DC    A(0)                      ADDRESS OF SUBPLST    @G860P31 62850052
.SDLST56 ANOP                           FILL IN RESERVED SLOTS @G860P31 62900052
         DC    A(0)                      ADDRESS OF KEYLIST    @G860P31 62950052
.SDLST57 ANOP                           FILL IN RESERVED SLOTS @G860P31 63000052
         DC    A(0)                      RESERVED                  @T1P 63050052
.*                                       RESERVED FOR SLIP              63100052
         DC    A(0)                      ALET OF DCB PARAMETER     @L3A 63150052
         DC    A(0)                      ALET OF STORAGE PARAM     @L3A 63200052
         DC    A(0)                      ALET OF HDR PARAMETER     @L3A 63250052
         DC    A(0)                      ALET OF ASIDLST PARAM     @L3A 63300052
         DC    A(0)                      ALET OF SUMLIST PARAM     @L3A 63350052
         DC    A(0)                      ALET OF SUBPLST PARAM     @L3A 63400052
         DC    A(0)                      ALET OF KEYLIST PARAM     @L3A 63450052
.*                                                                      63500052
.************************ LIST FORM *********************************** 63550052
.*                                                                      63600052
.*       PROCESS LISTD OPTION                                           63650052
.*                                                                 @L6A 63700052
.********************************************************************** 63750052
.*                                                                      63800052
         AIF   ('&LISTD' EQ '').SDLT57A     IS LISTD SPECIFIED     @L6A 63850052
         AIF   ('&LISTD'(1,1) EQ '(').MESG1  CHECK FOR R FORM      @L6A 63900052
         DC    A(&LISTD)                 ADDRESS OF LISTD          @L6A 63950052
         AGO   .SDLT57B                     LISTD OPTION DONE      @L6A 64000052
.SDLT57A ANOP                                                      @L6A 64050052
         DC    A(0)                      ADDRESS FOR LISTD         @L6C 64100052
.SDLT57B ANOP                                                      @L6A 64150052
         DC    A(0)                      ALET OF LISTD PARAM       @L5A 64200052
.*                                                                      64250052
.************************ LIST FORM *********************************** 64300052
.*                                                                      64350052
.*       PROCESS THE SUMLSTL KEYWORD OPTION                             64400052
.*                                                                 @L5A 64450052
.********************************************************************** 64500052
.*                                                                      64550052
.SDLST58 ANOP                                                      @L5A 64600052
         AIF   (&SDSMLTL EQ 0).SDLT58L IF SUMLSTA NO SPECIFIED     @L5A 64650052
         AIF   ('&SUMLSTL'(1,1) EQ '(').MESG1 REGISTER INVALID     @L5A 64700052
         DC    A(&SUMLSTL)               ADDRESS OF SUMLSTL        @L5A 64750052
         AGO   .SDLT58A                                            @L5A 64800052
.SDLT58L ANOP                                                      @L5A 64850052
         DC    A(0)                      ADDRESS OF SUMLSTL        @L5A 64900052
.SDLT58A ANOP                                                      @L5A 64950052
         DC    A(0)                      ALET FOR SUMLSTL PARAM    @L5A 65000052
         AIF   ('&PLVER' EQ '2').PLVER2A                           @T3M 65050052
         DC    2A(0)                     RESERVED                  @T1P 65100052
         AGO   .PLVER2B                                            @T1P 65150052
.PLVER2A ANOP                                                      @T1P 65200052
         AIF   (&SDPREG  EQ  0).SDLST61 CHECK FOR PSWREGS          @T1P 65250052
         AIF   ('&PSWREGS'(1,1) EQ '(').MESG1 REG FORM INVALID     @T1P 65300052
         DC    A(&PSWREGS)               ADDRESS OF PSWREGS        @T1P 65350052
         DC    A(0)                      ALET OF PSWREGS           @T1P 65400052
         AGO   .SDLST62                  SKIP NEXT DC STMT         @T1P 65450052
.SDLST61 ANOP                            FILL IN RESERVED SLOTS    @T1P 65500052
         DC    A(0)                      ADDRESS OF PSWREGS        @T1P 65550052
         DC    A(0)                      ALET OF PSWREGS           @T1P 65600052
.SDLST62 ANOP                            END OF PSWREGS            @T1P 65650052
         AIF   (&SDSRS EQ  0).SDLST63 CHECK FOR SYMREC             @T1P 65700052
         AIF   ('&SYMREC'(1,1) EQ '(').MESG1 REG FORM INVALID      @T1P 65750052
         DC    A(&SYMREC)                ADDRESS OF SYMREC         @T1P 65800052
         DC    A(0)                      ALET OF SYMREC            @T1P 65850052
         AGO   .SDLST64                  SKIP NEXT DC STMT         @T1P 65900052
.SDLST63 ANOP                            FILL IN RESERVED SLOTS    @T1P 65950052
         DC    A(0)                      ADDRESS OF SYMREC         @T1P 66000052
         DC    A(0)                      ALET OF SYMREC            @T1P 66050052
.SDLST64 ANOP                            END OF SYMREC             @T1P 66100052
         AIF   (&SDIDAD  EQ  0).SDLST65 CHECK FOR IDAD             @T1P 66150052
         AIF   ('&IDAD'(1,1) EQ '(').MESG1 REG FORM INVALID        @T1P 66200052
         DC    A(&IDAD)                  ADDRESS OF IDAD           @T1P 66250052
         DC    A(0)                      ALET OF IDAD              @T1P 66300052
         AGO   .SDLST67                  SKIP NEXT DC STMT         @T1P 66350052
.SDLST65 ANOP                            FILL IN RESERVED SLOTS    @T1P 66400052
         AIF   (&SDID    EQ  0).SDLST66 CHECK FOR ID               @T1P 66450052
         AIF   ('&ID'(1,1) EQ '(').MESG1 REG FORM INVALID          @T1P 66500052
         DC    A(IHB&SYSNDX.I)           ADDRESS OF ID             @T1P 66550052
         DC    A(0)                      ALET OF ID                @T1P 66600052
         AGO   .SDLST67                  SKIP NEXT DC STMT         @T1P 66650052
.SDLST66 ANOP                            END OF ID/IDAD            @T1P 66700052
         DC    A(0)                      ADDRESS OF ID             @T1P 66750052
         DC    A(0)                      ALET OF ID                @T1P 66800052
.SDLST67 ANOP                            END OF ID/IDAD            @T1P 66850052
.PLVER2B ANOP                                                      @T1P 66900052
.*                                                                      66950052
.************************ LIST FORM *********************************** 67000052
.*                                                                      67050052
.*       BUILD USER STORAGE LIST.                                       67100052
.*                                                             @G860P31 67150052
.********************************************************************** 67200052
.*                                                                      67250052
.SDLST59 ANOP                                                  @G383P1U 67300052
         AIF   ('&STORAGE' EQ '').SDLST60   BUILD STORAGE LIST          67350052
.*                                                             @G33VPHD 67400052
&CTR1    SETA  N'&STORAGE                   NUMBER OF STORAGE ADDRESSES 67450052
&CTR2    SETA   0                           POSITION NO. OF ADDRESS     67500052
.LOOPD1  ANOP                                                           67550052
&CTR2    SETA  &CTR2+1                      NUMBER OF NEXT ADDRESS      67600052
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').MESG1  ADDR IN A REG     67650052
         DC    A(&STORAGE(&CTR2))           STORAGE ADDRESS             67700052
&CTR1    SETA  &CTR1-1                      NUMBER OF REMAINING ADDR.S  67750052
         AIF   ('&CTR1' GT '1').LOOPD1      IF NOT LAST ADDRESS, LOOP   67800052
&CTR2    SETA  &CTR2+1                      NUMBER OF LAST ADDRESS      67850052
         AIF   ('&STORAGE(&CTR2)'(1,1) EQ '(').MESG1  ADDR IN A REG     67900052
         DC    AL4(X'80000000'+&STORAGE(&CTR2))  LAST ADDRESS           67950052
.*                                                                      68000052
.************************ LIST FORM *********************************** 68050052
.*                                                                      68100052
.*       BUILD USER DATA FOR HDR OPTION.                                68150052
.*                                                             @G860P31 68200052
.********************************************************************** 68250052
.*                                                                      68300052
.SDLST60 ANOP                                                           68350052
.*                                                             @G33VPHD 68400052
         AIF   ('&HDR' EQ '').SDLST70       IS USER DATA SPECIFIED @T1P 68450052
&CTR1    SETA  K'&HDR-2-&HDRCTR             LENGTH OF USER DATA         68500052
         DC    AL1(&CTR1)                   LENGTH OF USER DATA         68550052
         DC    C&HDR                        USER DATA                   68600052
.************************ LIST FORM *********************************** 68650052
.*                                                                      68700052
.*       BUILD USER DATA FOR ID OPTION.                                 68750052
.*                                                                 @T1P 68800052
.********************************************************************** 68850052
.*                                                                      68900052
.SDLST70 ANOP                                                      @T1P 68950052
         AIF   ('&ID' EQ '').SDEND          IS USER DATA SPECIFIED @T1P 69000052
&CTR1    SETA  K'&ID-2-&IDCTR               LENGTH OF USER DATA    @T1P 69050052
&TEMP    SETC  'IHB'.'&SYSNDX.'.'I'                                @T1P 69100052
&TEMP    DC    AL1(&CTR1)                   LENGTH OF USER DATA    @T1P 69150052
         DC    C&ID                         USER DATA              @T1P 69200052
         AGO   .SDEND                       END MACRO PROCESSING   @T1P 69250052
.*                                                                      69300052
.*                                                                      69350052
.*                                                                      69400052
.********************* STANDARD FORM ********************************** 69450052
.*                                                                      69500052
.*       STANDARD FORM EXPANSION STARTS HERE.                           69550052
.*                                                             @G860P31 69600052
.********************************************************************** 69650052
.*                                                                      69700052
.*                                                                      69750052
.*                                                                      69800052
.STFORM  ANOP                                                           69850052
&GNAME   SETC  'IHB'.'&SYSNDX'              OBTAIN UNIQUE SYMBOL-LABEL  69900052
         CNOP  0,4                                                      69950052
         AIF   ('&NAME' EQ '').SDSTF10      IS NAME SPECIFIED           70000052
&NAME    DS    0F                                                       70050052
.SDSTF10 ANOP                                                           70100052
.*                                                                      70150052
.********************* STANDARD FORM ********************************** 70200052
.*                                                                      70250052
.*       BUILD PARAMETER LIST TEMPLATE AND BRANCH TO CODE.              70300052
.*                                                             @G860P31 70350052
.********************************************************************** 70400052
.*                                                                      70450052
         &LA   1,*+8                                                    70500052
         B     &GNAME                       BRANCH AROUND PARAM LIST    70550052
         DC    AL1(&SDFLAG0)                FLAG BYTE                   70600052
         DC    AL1(&SDFLAG1)                FLAG BYTE                   70650052
         DC    AL1(&SDATAF1)                FLAG BYTE                   70700052
         DC    AL1(&SDATAF2)                FLAG BYTE                   70750052
         DC    A(0)                         ADDRESS OF DCB              70800052
.*                                                                      70850052
.********************* STANDARD FORM ********************************** 70900052
.*                                                                      70950052
.*       CALCULATE ADDRESS OF STORAGE AND/OR HDR PARM AREA              71000052
.*                                                             @G860P31 71050052
.********************************************************************** 71100052
.*                                                                      71150052
         AIF   ('&STORAGE' EQ '').SDST110   STORAGE SPECIFIED? @G860P31 71200052
         DC    A(*-8+&DISP1)                ADDRESS OF STORAGE @G860P31 71250052
         AGO   .SDST111                     GO CHECK HDR       @G860P31 71300052
.SDST110 ANOP                                                  @G860P31 71350052
         DC    A(0)                         ADDRESS OF STORAGE LIST     71400052
.SDST111 AIF   ('&HDR' EQ '').SDST112       HDR SPECIFIED?     @G860P31 71450052
         DC    A(*-12+&DISP2)               ADDRESS OF HDR     @G860P31 71500052
         AGO   .SDST113                     GO CHECK HDR       @G860P31 71550052
.SDST112 ANOP                                                  @G860P31 71600052
         DC    A(0)                         ADDRESS OF HEADER RECORD    71650052
.SDST113 ANOP                               CONTINUE STANDARD  @G860P31 71700052
.*                                                                      71750052
.********************* STANDARD FORM ********************************** 71800052
.*                                                                      71850052
.*       CONTINUE STANDARD FORM EXPANSION AFTER HDR.                    71900052
.*                                                             @G860P31 71950052
.********************************************************************** 72000052
.*                                                                      72050052
         DC    A(0)                         ADDRESS OF ECB/SRB     @L4C 72100052
         DC    AL2(0)                       CURRENT ASID                72150052
         DC    AL2(0)                       OTHER ASID                  72200052
         DC    A(0)                         ADDRESS OF ASID LIST        72250052
.*                                                             @G33VPHD 72300052
         DC    A(0)                         ADDRESS OF SUMLIST          72350052
         DC    A(0)                         RESERVED           @G33VPHD 72400052
         DC    A(0)                         RESERVED           @G33VPHD 72450052
         DC    AL1(&SDFLAG2)                FLAG BYTE          @G383P1U 72500052
         DC    AL1(&SDCNTL1)                CONTROL FLAGS      @G860P31 72550052
         DC    AL1(&SDTYPF1)                TYPE FLAG BYTE     @G383P1U 72600052
         DC    AL1(&PLVER.)                 VERSION                @T1P 72650052
         DC    AL1(&SDATAF3)                EXIT FLAG BYTE     @G383P1U 72700052
         DC    AL1(0)                       RESERVED               @T1P 72750052
         DC    AL1(&SDAT3)                  SDATA OPTIONS          @T1P 72800052
         DC    AL1(0)                       RESERVED               @T1P 72850052
         DC    A(0)                         SUBPLST ADDRESS    @G860P31 72900052
         DC    A(0)                         KEYLIST ADDRESS    @G860P31 72950052
         DC    A(0)                         RESERVED           @G860P31 73000052
.*                                     RESERVED FOR SLIP       @G860P31 73050052
         DC    A(0)                    ALET OF DCB PARAMETER       @L3A 73100052
         DC    A(0)                    ALET OF STORAGE PARAM       @L3A 73150052
         DC    A(0)                    ALET OF HDR PARAMETER       @L3A 73200052
         DC    A(0)                    ALET OF ASIDLST PARAM       @L3A 73250052
         DC    A(0)                    ALET OF SUMLIST PARAM       @L3A 73300052
         DC    A(0)                    ALET OF SUBPLST PARAM       @L3A 73350052
         DC    A(0)                    ALET OF KEYLIST PARAM       @L3A 73400052
         DC    4A(0)                   LISTD/SUMLSTL               @T3C 73450052
         AIF   ('&PLVER' EQ '2').SDSTP2                            @T1M 73500052
         DC    2A(0)                        RESERVED               @T3C 73550052
         AGO   .SDSTP99                SKIP PLISTVER=2             @T1P 73600052
.SDSTP2  ANOP                          PLISTVER=2                  @T1P 73650052
         DC    2A(0)                        PSWREGS                @T1P 73700052
         DC    2A(0)                        SYMREC                 @T1P 73750052
         AIF   ('&ID' EQ '').SDSTP00        ID SPECIFIED?          @T1P 73800052
         DC    A(IHB&SYSNDX.I)              ADDRESS OF ID          @T1P 73850052
         DC    A(0)                         ALET OF ID             @T1P 73900052
         AGO   .SDSTP01                     ONWARD                 @T1P 73950052
.SDSTP00 ANOP                                                      @T1P 74000052
         DC    2A(0)                        ID                     @T1P 74050052
.SDSTP01 ANOP                                                      @T1P 74100052
.SDSTP99 ANOP                                                      @T1P 74150052
.*                                                                      74200052
.********************* STANDARD FORM ********************************** 74250052
.*                                                                      74300052
.*    RESERVE SPACE FOR STORAGE, HDR, ID PARAMETER                      74350052
.*                                                                 @T1P 74400052
.********************************************************************** 74450052
.*                                                                      74500052
         AIF   ('&STORAGE' EQ '').SDSTF20   IS STORAGE SPECIFIED        74550052
&CTR1    SETA  N'&STORAGE                   NUMBER OF STORAGE ADDRESSES 74600052
         DC    &CTR1.F'0'                   STORAGE ADDRESSES           74650052
.SDSTF20 ANOP                                                           74700052
         AIF   ('&HDR' EQ '').SDSTF30       IS HDR SPECIFIED            74750052
&CTR1    SETA  K'&HDR-2-&HDRCTR             LENGTH OF USER DATA         74800052
         DC    AL1(&CTR1)                   LENGTH OF USER DATA         74850052
         DC    C&HDR                        USER DATA                   74900052
.*       CNOP  2,4                                                      74950052
.SDSTF30 ANOP                                                           75000052
         AIF   ('&ID' EQ '').SDSTF41        IS ID SPECIFIED        @T1P 75050052
&CTR1    SETA  K'&ID-2-&IDCTR               LENGTH OF USER DATA    @T1P 75100052
&TEMP    SETC  'IHB&SYSNDX.I'                                      @T1P 75150052
&TEMP    DC    AL1(&CTR1)                   LENGTH OF USER DATA    @T1P 75200052
         DC    C&ID                         USER DATA              @T1P 75250052
.SDSTF41 ANOP                                                      @T1P 75300052
&GNAME   DS    0H                                                       75350052
.*                                                                      75400052
.********************* STANDARD FORM ********************************** 75450052
.*                                                                      75500052
.*       STORE THE DCB ADDRESS INTO PARAMETER LIST .                    75550052
.*                                                             @G860P31 75600052
.********************************************************************** 75650052
.*                                                                      75700052
         AIF   ('&DCB' EQ '').SDSTF35       IS DCB SPECIFIED            75750052
         IHBSETR   &DCB,0                   ADDRESS OF DCB IN REG 0     75800052
         ST    0,4(0,1)                     SAVE DCB ADDRESS       @L3C 75850052
         AIF   ('&SYSASCE' EQ 'P').NOAR12                          @L3A 75900052
         STAM  0,0,60(1)              SAVE DCB ALET                @L3A 75950052
.NOAR12  ANOP                                                      @L3A 76000052
.*                                                                      76050052
.********************* STANDARD FORM ********************************** 76100052
.*                                                                      76150052
.*       PROCESS LIST, LISTA, STORAGE OR LISTD OPTION                   76200052
.*                                                                 @L6A 76250052
.********************************************************************** 76300052
.*                                                                      76350052
.SDSTF35 AIF   ('&LIST' EQ '').SDSTF37      IS LIST SPECIFIED  @G383P1U 76400052
         IHBSETR   &LIST,0                  ADDR OF STORAGE LIST IN R0  76450052
         ST    0,8(0,1)                     SAVE LIST ADDRESS      @L3C 76500052
         AIF   ('&SYSASCE' EQ 'P').NOAR13                          @L3A 76550052
         STAM  0,0,64(1)              SAVE LIST ALET               @L3A 76600052
.NOAR13  ANOP                                                      @L3A 76650052
         AGO   .SDSTF45                     GO CHECK FOR LISTD     @L6C 76700052
.SDSTF37 AIF   ('&LISTA' EQ '').SDSTF40  IS LISTA SPECIFIED    @G383P1U 76750052
         IHBSETR   &LISTA,0                 LIST ADDR TO R0    @G383P1U 76800052
         ST    0,8(,1)                      STORE LISTA ADDR       @L3C 76850052
         AIF   ('&SYSASCE' EQ 'P').NOAR14                          @L3A 76900052
         STAM  0,0,64(1)              SAVE LISTA ALET              @L3A 76950052
.NOAR14  ANOP                                                      @L3A 77000052
         AGO   .SDSTF45              GO CHECK FOR LISTD            @L6C 77050052
.SDSTF40 AIF   ('&STORAGE' EQ '').SDSTF45   STORAGE ADDRESSES SPECIFIED 77100052
&CTR1    SETA  N'&STORAGE          NUMBER OF STORAGE ADDRESSES @G860P31 77150052
&CTR2    SETA  0                   POSITION COUNTER            @G860P31 77200052
&DISP    SETA  &DISP1-4            DISPLACEMENT OF THE STORAGE @G860P31 77250052
.*                                 ADDRESSES INTO THE PARAMETER LIST    77300052
.LOOPE1  ANOP                                                           77350052
&CTR2    SETA  &CTR2+1                 NUMBER OF ADDRESS WORKING ON     77400052
&DISP    SETA  &DISP+4                 DISP OF ADDRESS INTO LIST        77450052
         IHBSETR   &STORAGE(&CTR2),0        ADDRESS INTO R0             77500052
         ST    0,&DISP.(0,1)                SAVE STORAGE ADDR      @L3C 77550052
         AIF   ('&CTR1' NE '&CTR2').LOOPE1  ANY  MORE ADDRESSES         77600052
         OI    &DISP.(1),X'80'              END OF LIST INDICATOR       77650052
.SDSTF45 AIF   ('&LISTD' EQ '').SDSTF50  IS LISTD SPECIFIED        @L6A 77700052
         IHBSETR   &LISTD,0              LISTD ADDRESS TO R0       @L6A 77750052
         ST    0,88(,1)               STORE LISTD IN PARM LIST     @L6A 77800052
         AIF   ('&SYSASCE' EQ 'P').NOAR14A                         @L6A 77850052
         STAM  0,0,92(1)                 SAVE LISTD ALET           @L6A 77900052
.NOAR14A ANOP                                                      @L6A 77950052
         AGO   .SDSTF50                  CHECK FOR USER PARAMETERS @L6A 78000052
.*                                                                      78050052
.********************* STANDARD FORM ********************************** 78100052
.*                                                                      78150052
.*       PROCESS HDRAD TO PLACE ADDRESS IN PARAMETER LIST.              78200052
.*       IF HDR WAS SPECIFIED, THE ADDRESS IS ALREADY IN THE            78250052
.*       PARAMETER LIST BECAUSE THE MACRO GENERATES THE LOCATION.       78300052
.*                                                             @G860P31 78350052
.********************************************************************** 78400052
.*                                                                      78450052
.SDSTF50 AIF   ('&HDRAD' EQ '').SDSTF70     IS HDRAD SPECIFIED @G860P31 78500052
         IHBSETR   &HDRAD,0                 ADDR OF USER DATA IN REG 0  78550052
         ST    0,12(0,1)         ADDR OF USER DATA INTO PARAM LST  @L3C 78600052
         AIF   ('&SYSASCE' EQ 'P').NOAR15                          @L3A 78650052
         STAM  0,0,68(1)              SAVE HDR ALET                @L3A 78700052
.NOAR15  ANOP                                                      @L3A 78750052
.*                                                                      78800052
.********************* STANDARD FORM ********************************** 78850052
.*                                                                      78900052
.*       PROCESS ECB OPTION.                                            78950052
.*                                                             @G860P31 79000052
.********************************************************************** 79050052
.*                                                                      79100052
.SDSTF70 AIF   ('&ECB' EQ '').SDSTF74       IS ECB SPECIFIED       @L4C 79150052
         AIF   (N'&ECB GT 1).SDSTF72 IS MORE THAN 1 PARM PRESENT   @L8A 79200052
         AIF   ('&ECB'(1,1) EQ '(').SDSTF71 IS ECB ADDR IN A REG   @L8C 79250052
         L     0,&ECB                       ADDRESS OF ECB              79300052
         ST    0,16(0,1)              ADDR OF ECB INTO PARAM LIST  @L3C 79350052
         AGO   .SDSTF80                     GO CHECK FOR ASID           79400052
.SDSTF71 ST    &ECB(1),16(0,1)        ADDR OF ECB INTO PARAM LIST  @L8C 79450052
         AGO   .SDSTF80                     GO CHECK FOR ASID      @L8A 79500052
.SDSTF72 AIF   ('&ECB(1)'(1,1) EQ '(').SDSTF73 IS THE ADDRESS OF THE   X79550052
               ECB IN A REGISTER                                   @L8A 79600052
         L     0,&ECB(1)                    ADDRESS OF ECB         @L8A 79650052
         ST    0,16(0,1)              ADDR OF ECB INTO PARAM LIST  @L8A 79700052
         AGO   .SDSTF80                     GO CHECK FOR ASID      @L8A 79750052
.SDSTF73 ST    &ECB(1,1),16(0,1)      ADDR OF ECB INTO PARAM LIST  @L8A 79800052
         AGO   .SDSTF80                     GO CHECK FOR ASID      @L8A 79850052
.********************* STANDARD FORM ********************************** 79900052
.*                                                                      79950052
.*       PROCESS SRB OPTION.                                            80000052
.*                                                                 @L4A 80050052
.********************************************************************** 80100052
.*                                                                 @L4A 80150052
.SDSTF74 AIF   ('&SRB' EQ '').SDSTF80       IS SRB SPECIFIED       @L4A 80200052
         AIF   (N'&SRB GT 1).SDSTF76 IS MORE THAN 1 PARM PRESENT   @L8A 80250052
         AIF   ('&SRB'(1,1) EQ '(').SDSTF75 IS SRB ADDR IN A REG   @L8C 80300052
         L     0,&SRB                       ADDRESS OF SRB         @L4A 80350052
         ST    0,16(0,1)              ADDR OF SRB INTO PARAM LIST  @L4A 80400052
         AGO   .SDSTF80                     GO CHECK FOR ASID      @L4A 80450052
.SDSTF75 ST    &SRB(1),16(0,1)        ADDR OF SRB INTO PARAM LIST  @L8C 80500052
         AGO   .SDSTF80                     GO CHECK FOR ASID      @L8A 80550052
.SDSTF76 AIF   ('&SRB(1)'(1,1) EQ '(').SDSTF77 IS THE ADDRESS OF THE   X80600052
               SRB IN A REGISTER                                   @L8A 80650052
         L     0,&SRB(1)                    ADDRESS OF SRB         @L8A 80700052
         ST    0,16(0,1)              ADDR OF SRB INTO PARAM LIST  @L8A 80750052
         AGO   .SDSTF80                     GO CHECK FOR ASID      @L8A 80800052
.SDSTF77 ST    &SRB(1,1),16(0,1)      ADDR OF SRB INTO PARAM LIST  @L8A 80850052
.*                                                                 @L4A 80900052
.*                                                                      80950052
.********************* STANDARD FORM ********************************** 81000052
.*                                                                      81050052
.*       PROCESS ASID OR ASIDLST OPTION.                                81100052
.*                                                             @G860P31 81150052
.********************************************************************** 81200052
.*                                                                      81250052
.SDSTF80 AIF   ('&ASID' EQ '').SDSTF90      IS ASID SPECIFIED           81300052
         AIF   ('&ASID'(1,1) EQ '(').SDSTF82     IS ASID IN A REGISTER  81350052
         LH    0,&ASID                      ASID OF MEMORY TO BE DUMPED 81400052
         STH   0,22(0,1)              ASID INTO PARAMETER LIST     @L3C 81450052
         AGO   .SDSTF90                     GO CHECK FOR BRANCH ENTRY   81500052
.SDSTF82 ANOP                                                           81550052
         STH   &ASID,22(0,1)          ASID INTO PARAMETER LIST     @L3C 81600052
.SDSTF90 AIF   ('&ASIDLST' EQ '').SDSTF93  IS ASIDLIST SPECIFIED        81650052
.*                                                             @G33VPHD 81700052
         IHBSETR   &ASIDLST,0           ADDR OF ASIDLIST IN R0          81750052
.*                                                             @G33VPHD 81800052
         ST    0,24(,1)                 ADDR ASIDLIST INTO PARM LIST   *81850052
                                                                   @L3C 81900052
         AIF   ('&SYSASCE' EQ 'P').NOAR16                          @L3A 81950052
         STAM  0,0,72(1)              SAVE ASIDLST ALET            @L3A 82000052
.NOAR16  ANOP                                                      @L3A 82050052
.*                                                                      82100052
.********************* STANDARD FORM ********************************** 82150052
.*                                                                      82200052
.*       PROCESS SUMLIST OR SUMLSTA OPTION.                             82250052
.*                                                             @G860P31 82300052
.********************************************************************** 82350052
.*                                                                      82400052
.SDSTF93 AIF   ('&SUMLIST' EQ '').SDSTF94 IS SUMLIST SPECIFIED          82450052
         IHBSETR   &SUMLIST,0                                           82500052
         ST    0,28(,1)                                            @L3C 82550052
         AIF   ('&SYSASCE' EQ 'P').NOAR17                          @L3A 82600052
         STAM  0,0,76(1)              SAVE SUMLIST ALET            @L3A 82650052
.NOAR17  ANOP                                                      @L3A 82700052
         AGO   .SDSTF95                DONE SO DO ENTRY LOGIC  @G383P1U 82750052
.SDSTF94 AIF   ('&SUMLSTA' EQ '').SDSTF95  SUMLSTA SPECIFIED   @G383P1U 82800052
         IHBSETR   &SUMLSTA,0        GET SUMLSTA ADDR IN R0    @G383P1U 82850052
         ST    0,28(,1)              SUMLSTA ADDR TO PARM LIST     @L3C 82900052
         AIF   ('&SYSASCE' EQ 'P').NOAR18                          @L3A 82950052
         STAM  0,0,76(1)              SAVE SUMLSTA ALET            @L3A 83000052
.NOAR18  ANOP                                                      @L3A 83050052
.*                                                                      83100052
.********************* STANDARD FORM ********************************** 83150052
.*                                                                      83200052
.*       PROCESS SUBPLST AND KEYLIST OPTIONS.                           83250052
.*                                                             @G860P31 83300052
.********************************************************************** 83350052
.*                                                                      83400052
.SDSTF95 AIF   ('&SUBPLST' EQ '').SDSTF96 IS SUBPLST SPECIFIED @G860P31 83450052
         IHBSETR   &SUBPLST,0          LOAD SUBPLST ADDRESS    @G860P31 83500052
         ST    0,48(,1)                STORE SUBPLST ADDRESS       @L3C 83550052
         AIF   ('&SYSASCE' EQ 'P').NOAR19                          @L3A 83600052
         STAM  0,0,80(1)              SAVE SUBPLST ALET            @L3A 83650052
.NOAR19  ANOP                                                      @L3A 83700052
         AIF   ('&KEYLIST' EQ '').SDSTF96 IS KEYLIST SPECIFIED @G860P31 83750052
         IHBSETR   &KEYLIST,0          LOAD KEYLIST ADDRESS    @G860P31 83800052
         ST    0,52(0,1)               STORE KEYLIST ADDRESS       @L3C 83850052
         AIF   ('&SYSASCE' EQ 'P').NOAR20                          @L3A 83900052
         STAM  0,0,84(1)              SAVE KEYLIST ALET            @L3A 83950052
.NOAR20  ANOP                                                      @L3A 84000052
.*                                                                      84050052
.********************* STANDARD FORM ********************************** 84100052
.*                                                                      84150052
.*       PROCESS SUMLSTL OPTIONS                                        84200052
.*                                                                 @L5A 84250052
.********************************************************************** 84300052
.*                                                                      84350052
.SDSTF96 ANOP                                                      @L5A 84400052
         AIF   ('&SUMLSTL' EQ '').SDSTM00 IS SUMLSTL SPECIFIED     @T3C 84450052
         IHBSETR   &SUMLSTL,0          LOAD SUMLSTL ADDRESS        @L5A 84500052
         ST    0,96(0,1)              STORE SUMLSTL ADDRESS        @L5A 84550052
         AIF   ('&SYSASCE' EQ 'P').NOAR21                          @L5A 84600052
         STAM  0,0,100(1)             SAVE SUMLSTL ALET            @L5A 84650052
.NOAR21  ANOP                                                      @L5A 84700052
.*                                                                      84750052
.********************* STANDARD FORM ********************************** 84800052
.*                                                                      84850052
.*       PROCESS PSWREGS OPTION.                                        84900052
.*                                                             @G860P31 84950052
.********************************************************************** 85000052
.*                                                                      85050052
.SDSTM00 AIF   ('&PSWREGS' EQ '').SDSTM01 IS PSWREGS SPECIFIED     @T1P 85100052
         IHBSETR   &PSWREGS,0                                      @T1P 85150052
         ST    0,104(0,1)                   SAVE PSWREG ADDR       @T1P 85200052
         AIF   ('&SYSASCE' EQ 'P').NOAR26                          @T3A 85250052
         STAM  0,0,108(1)                   SAVE PSWREG ALET       @T3A 85300052
.NOAR26  ANOP                                                      @T3A 85350052
.*                                                                      85400052
.********************* STANDARD FORM ********************************** 85450052
.*                                                                      85500052
.*       PROCESS SYMREC  OPTION.                                        85550052
.*                                                             @G860P31 85600052
.********************************************************************** 85650052
.*                                                                      85700052
.SDSTM01 AIF   ('&SYMREC' EQ '').SDSTM02 IS SYMREC SPECIFIED       @T1P 85750052
         IHBSETR   &SYMREC,0                                       @T1P 85800052
         ST    0,112(0,1)                   SAVE SYMREC ADDR       @T1P 85850052
         AIF   ('&SYSASCE' EQ 'P').NOAR27                          @T3A 85900052
         STAM  0,0,116(1)                   SAVE SYMREC ALET       @T3A 85950052
.NOAR27  ANOP                                                      @T3A 86000052
.********************* STANDARD FORM ********************************** 86050052
.*                                                                      86100052
.*       PROCESS IDAD TO PLACE ADDRESS IN PARAMETER LIST.               86150052
.*       IF ID WAS SPECIFIED, THE ADDRESS IS ALREADY IN THE             86200052
.*       PARAMETER LIST BECAUSE THE MACRO GENERATES THE LOCATION.       86250052
.*                                                                 @T1P 86300052
.********************************************************************** 86350052
.*                                                                      86400052
.SDSTM02 AIF   ('&IDAD' EQ '').SDST999      IS IDAD SPECIFIED      @T1P 86450052
         IHBSETR   &IDAD,0                  ADDR ID DATA IN R0     @T1P 86500052
         ST    0,120(0,1)                   SAVE IDAD ADDR         @T1P 86550052
         AIF   ('&SYSASCE' EQ 'P').NOAR28                          @T3A 86600052
         STAM  0,0,124(1)                   SAVE IDAD ALET         @T3A 86650052
.NOAR28  ANOP                                                      @T3A 86700052
.*                                                                      86750052
.*                                                                      86800052
.********************* STANDARD FORM ********************************** 86850052
.*                                                                      86900052
.*       STANDARD FORM CLOSEOUT.                                        86950052
.*                                                             @G860P31 87000052
.********************************************************************** 87050052
.*                                                                      87100052
.SDST999 AIF   ('&BRANCH' EQ 'YES').SDSTF99  BRANCH ENTRY          @T1C 87150052
.*                                                             @G33VPHD 87200052
         AGO   .SDVSEC2                     GO CHECK FOR VSE   @D52VXTN 87205552
         SVC   51                           INVOKE SVC DUMP VIA SVC     87211052
.SDVSEC2 ANOP                               CHECK FOR VSE/ESA  @D52VXTN 87216552
         L     15,16(0,0)                   ADDRESS OF CVT     @D52GHTN 87222052
         TM    X'74'(15),X'A8'              IS VSE/ESA ACTIVE? @G52GHTN 87227552
         BZ    *+10                         IF NO, GO CALL MVS CODE     87233052
         SVC   123                          CALL VSE/ESA SDUMP @G52GHTN 87238552
         B     *+6                          AND BRANCH TO CONTINUE ...  87244052
         SVC   51                           INVOKE MVS SVC DUMP VIA SVC 87272052
         AGO   .SDEND                       GO END MACRO PROCESSING     87300052
.SDSTF99 ANOP                                                           87350052
.*                                                             @G33VPHD 87400052
         L     15,16(0,0)                   ADDRESS OF CVT       YM1995 87450052
         L     15,1028(15,0)                SVC DUMP ENTRY ADDR  YM1995 87500052
         BALR  14,15                        INVOKE SVC DUMP VIA BAL     87550052
         AGO   .SDEND                       GO END MACRO PROCESSING     87600052
.*                                                                      87650052
.*                                                                      87700052
.*                                                                      87750052
.********************************************************************** 87800052
.*                                                                      87850052
.*       ERROR MESSAGES                                                 87900052
.*                                                             @G860P31 87950052
.********************************************************************** 88000052
.*                                                                      88050052
.*                                                                      88100052
.MESG1   MNOTE 12,'REGISTER NOTATION INVALID W/MF=L'                    88150052
         MEXIT                                                          88200052
.MESG1A  MNOTE 12,'POSITIONAL PARAMETERS ARE NOT ALLOWED - &SYSLIST(1)' 88250052
.*                                                             @G860P1X 88300052
         MEXIT                                                          88350052
.MESG2A  MNOTE 12,'HDR AND HDRAD ARE MUTUALLY EXCLUSIVE'                88400052
         MEXIT                                                          88450052
.MESG2B  MNOTE 12,'STORAGE AND LIST ARE MUTUALLY EXCLUSIVE'             88500052
         MEXIT                                                          88550052
.MESG2C  MNOTE 12,'STORAGE AND LISTA ARE MUTUALLY EXCLUSIVE'   @G383P1U 88600052
         MEXIT                                                 @G383P1U 88650052
.MESG2D  MNOTE 12,'LIST AND LISTA ARE MUTUALLY EXCLUSIVE'      @G383P1U 88700052
         MEXIT                                                 @G383P1U 88750052
.MESG2E  MNOTE 12,'SUMLIST AND SUMLSTA ARE MUTUALLY EXCLUSIVE'     @P1C 88800052
         MEXIT                                                 @G383P1U 88850052
.MESG2F  MNOTE 12,'ID AND IDAD ARE MUTUALLY EXCLUSIVE'             @T1P 88900052
         MEXIT                                                 @G383P1U 88950052
.MESG3B  ANOP                                                      @L4A 89000052
         AIF (&SDECB NE 0).MESG3BE IF ECB SPECIFED, ISSUE ECB MNOTE@L4A 89050052
.MESG3BS MNOTE 12,'INVALID SRB SCHEDULE TIME SPECIFIED: &SRB(2)'   @L8C 89100052
         AGO   .MESG3BX                                            @L8C 89150052
.MESG3BE MNOTE 12,'INVALID ECB POST TIME SPECIFIED: &ECB(2)'       @L8C 89200052
.MESG3BX MNOTE 12,'VALID TIME SPECIFICATIONS ARE: CAPTURE OR WRITE'     89250052
.*                                                                 @L8A 89300052
         MEXIT                                                          89350052
.MESG4A  MNOTE 12,'INVALID SDATA OPERAND SPECIFIED &SDATA(&CTR2)'       89400052
         MEXIT                                                          89450052
.MESG4B  MNOTE 12,'INVALID BUFFER OPERAND SPECIFIED &BUFFER'            89500052
         MEXIT                                                          89550052
.MESG4C  MNOTE 12,'INVALID BRANCH OPERAND SPECIFIED &BRANCH'            89600052
         MEXIT                                                          89650052
.MESG4D  MNOTE 12,'INVALID QUIESCE OPERAND SPECIFIED &QUIESCE'          89700052
         MEXIT                                                 @G383P1U 89750052
.MESG4E  MNOTE 12,'INVALID TYPE OPERAND SPECIFIED &TYPE(&CTR2)'         89800052
.*                                                             @G383P1U 89850052
         MEXIT                                                 @G383P1U 89900052
.MESG4F  MNOTE 12,'MUTUALLY EXCLUSIVE TYPE OPERANDS: XMEM AND XMEME'    89950052
.*                                                             @G38AP31 90000052
         MEXIT                                                 @G38AP31 90050052
.MESG5A  MNOTE 12,'ASID OPERAND INVALID W/MF=L'                         90100052
         MEXIT                                                          90150052
.MESG5B  MNOTE 12,'ECB OPERAND INVALID W/MF=L'                          90200052
         MEXIT                                                          90250052
.MESG5C  MNOTE 12,'BRANCH OPERAND INVALID W/MF=L'                       90300052
         MEXIT                                                          90350052
.MESG5D  MNOTE 12,'ASIDLST OPERAND INVALID W/MF=L'                      90400052
         MEXIT                                                          90450052
.MESG5E  MNOTE 12,'MISSING PARAMETER LIST ADDRESS WITH MF=(E,ADDR)'     90500052
.*                                                             @G860P31 90550052
         MEXIT                                                          90600052
.MESG5F  MNOTE 12,'SRB OPERAND INVALID W/MF=L'                          90650052
.*                                                                 @L4A 90700052
         MEXIT                                                     @L4A 90750052
.MESG6   MNOTE 12,'ODD NUMBER OF STORAGE ADDRESSES'                     90800052
         MEXIT                                                          90850052
.MESG7   MNOTE 12,'MACRO FORM IS INVALID'                               90900052
         MEXIT                                                          90950052
.MESG8   MNOTE 12,'USER DATA TOO LONG'                                  91000052
         MEXIT                                                          91050052
.MESG8I  MNOTE 12,'LENGTH OF ID OPERAND IS TOO LONG'               @T1P 91100052
         MEXIT                                                     @T1P 91150052
.MESG9   MNOTE 12,'INITIAL CHARACTER OF HDR OPERAND NOT AN APOSTROPHE'  91200052
         MEXIT                                                          91250052
.MESG9I  MNOTE 12,'INITIAL CHARACTER OF ID OPERAND NOT AN APOSTROPHE'  *91300052
                                                                   @T1P 91350052
         MEXIT                                                     @T1P 91400052
.*                                                             @G33VPHD 91450052
.MESG9A  MNOTE 12,'INVALID HDR SPECIFICATION'                           91500052
         MEXIT                                                          91550052
.MESG9AI MNOTE 12,'INVALID ID SPECIFICATION'                       @T1P 91600052
         MEXIT                                                     @T1P 91650052
.*                                                             @G860P31 91700052
.MESG10  MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS: ASID AND ASIDLST'       91750052
.*                                                             @G33VPHD 91800052
         MEXIT                                                          91850052
.*                                                             @G33VPHD 91900052
.MESG11  MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS: SUMDUMP/SUM AND NOSUMDUX91950052
               MP/NOSUM'                                                92000052
.*                                                             @G33VPHD 92050052
         MEXIT                                                          92100052
.*                                                             @G33VPHD 92150052
.MESG12  MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS:SQA AND NOSQA'           92200052
.*                                                             @G33VPHD 92250052
         MEXIT                                                          92300052
.*                                                             @G33VPHD 92350052
.MESG13  MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS: ALLPSA AND NOALLPSA'    92400052
.*                                                             @G33VPHD 92450052
         MEXIT                                                          92500052
.MESG13B MNOTE 12,'MUTUALLY EXCLUSIVE OPERANDS: SRB AND ECB'            92550052
.*                                                                 @L4A 92600052
         MEXIT                                                     @L4A 92650052
.*                                                             @G33VPHD 92700052
.MESG15  MNOTE 12,'NOSUMDUMP SPECIFIED WITH SUMLIST INVALID'   @G383P1U 92750052
         MEXIT                                                 @G383P1U 92800052
.MESG15A MNOTE 12,'NOSUMDUMP SPECIFIED WITH SUMLSTA INVALID'   @G383P1U 92850052
         MEXIT                                                 @G386P31 92900052
.MESG15B MNOTE 12,'NOSUMDUMP SPECIFIED WITH SUMLSTL INVALID'       @L5A 92950052
         MEXIT                                                     @L5A 93000052
.MESG16A MNOTE 12,'INVALID SUSPEND OPERAND SPECIFIED &SUSPEND' @G386P31 93050052
         MEXIT                                                 @G386P31 93100052
.MESG16B MNOTE 12,'BRANCH=YES IS REQUIRED WITH SUSPEND=YES'    @G386P31 93150052
         MEXIT                                                 @G386P31 93200052
.MESG16C MNOTE 12,'SDATA=NOSUM/NOSUMDUMP INVALID WITH SUSPEND=YES'      93250052
.*                                                             @G386P31 93300052
         MEXIT                                                          93350052
.MESG17A MNOTE 12,'SUBPLST REQUIRED WITH KEYLIST'              @G860P31 93400052
.SDEND   MEXIT                                                          93450052
         MEND                                                           93500052
* */                                                                    93550052
* SDUMPX: MACRO KEYS(HDR,HDRAD,DCB,ASID,ASIDLST,ECB,SDATA,STORAGE,      93600052
*           LIST,SUMLIST,BUFFER,QUIESCE,BRANCH,LISTA,TYPE,SUMLSTA,      93650052
*           SUSPEND,SUBPLST,KEYLIST,MF,RETCODE,RELATED,SRB,SUMLSTL,     93700052
*           LISTD,                                           /* L6C */  93750052
*           PLISTVER,ID,IDAD,SYMREC,PSWREGS);                /*  @T2P*/ 93800052
*                                                                       93850052
* ANS('?'||MACLABEL||'SDUMPXP '||MACLIST||MACKEYS||';');                93900052
* %END SDUMPX;                                                          93950052
