*%GOTO EXTRPLS ;   /*                                                   00010004
      MACRO                                                             00020004
&NAME    EXTRACT  &ID=,                                       @D35EDWK *00030004
               &AREA=,                                        @D35EDWK *00040004
               &LEN=,                                         @D35EDWK *00050004
               &DISP=,                                        @D35EDWK *00060004
               &SEL=,                                         @D35EDWK *00070004
               &SEP=,                                         @D35EDWK *00080004
               &PID=,                                         @D35EDWK *00090004
               &SID=,                                         @D14NDWK *00100004
               &PU=,                                          @D14CDWK *00110004
               &MODE=,                                        @D35EDWK *00120004
               &LOC=,                                         @SUPSERV *00130004
               &RESET=,                                       @DY45817 *00140004
               &MFG=                                          @D35EDWK  00150004
.*                                                                      00160004
         LCLA  &TID,&TMFG,&TOFF,&TAR,&TSEL,&TPID,&TSEP,&TFLAG  @D356DWK 00170004
         LCLA  &TLEN,&TDISP,&GO,&TSID,&TPU                     @D14CDWK 00180004
         LCLA  &DISPA                                          @D356DWK 00190004
         LCLB  &DISPSW            DISP ALLOWED                 @D21LDRP 00200004
         LCLB  &MODESW            MODE ALLOWED                 @D61DDEM 00210004
         LCLB  &PIDSW             PID ALLOWED                  @D21LDRP 00220004
         LCLB  &PUSW              PU  ALLOWED                  @D21LDRP 00230004
         LCLB  &SELSW             SEL ALLOWED                  @D21LDRP 00240004
         LCLB  &SELRSW            SEL REQUIRED                 @D21LDRP 00250004
         LCLB  &SEPSW             SEP ALLOWED                  @D21LDRP 00260004
         LCLB  &SEPRSW            SEP REQUIRED                 @D21LDRP 00270004
         LCLB  &LPEXCL            SEP AND SEL ARE MUTUALY EXCL. ONE IS *00280004
                                  REQUIRED                     @D21LDRP 00290004
         LCLB  &LPUEXCL           PU, SEP AND SEL ARE MUTUALY EXCL. ONE*00300004
                                  IS REQUIRED                  @D21LDRP 00310004
         LCLC  &DISPC                                          @D356DWK 00320004
         LCLC  &TOPE,&TADDR,&BADDR                             @D356DWK 00330004
.*                                                                      00340004
.**************************************************************         00350004
*                                                             *@D51MDGL 00360004
.*       IBM VSE / ADVANCED FUNCTIONS                         *@D51MDGL 00370004
*        SUPERVISOR - EXTRACT - 5686-066-06-15G               *@D61DDGL 00380004
.*                                                                      00390004
         AGO   .CPRIGHT                                                 00400004
.*                                                                      00410004
*        LICENSED MATERIALS - PROGRAM PROPERTY OF IBM         *@D51MDGL 00420004
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"          *@D51MDGL 00430004
*        5686-066 (C) COPYRIGHT IBM CORP. 1979, 1995          *@D61DDGL 00440004
*        SEE COPYRIGHT INSTRUCTIONS                           *@D51MDGL 00450004
.*                                                                      00460004
.CPRIGHT ANOP                                                           00470004
*                                                             *@D51MDGL 00480004
.**************************************************************         00490004
.*                                                                      00500004
.**** START OF SPECIFICATIONS ***************************************** 00510004
.*                                                                      00520004
.*01* MODULE-TYPE = MACRO                                               00530004
.*                                                                      00540004
.*01* DESCRIPTIVE NAME = EXTRACT SYSTEM INFORMATION            @D35EDJO 00550004
.*  STATUS           =  NEW MACRO - FIRST RELEASE 34.0                  00560004
.*  FUNCTION         =  MACRO CHECKS USER GIVEN PARAMETERS FOR          00570004
.*                      RETRIEVAL OF SUPERVISOR FIELDS VIA     @D35EDWK 00580004
.*                      SVC98 . A PARAMETER LIST IS BUILT.     @D35EDWK 00590004
.*  NOTES            =                                                  00600004
.*  DEPENDENCIES     =                                                  00610004
.*  RESTRICTIONS     =                                                  00620004
.*  REGISTER CONVENT.=  REGISTER 1 USED BY MACRO AS POINTER TO          00630004
.*                      PARAMETER LIST FOR SVC 98                       00640004
.*                      REGISTER 15 USED AS RETURNCODE REGISTER         00650004
.*                      REGISTER 0 USED BY MACRO FOR S-TYPE    @D35EDWK 00660004
.*                      NOTATION                               @D35EDWK 00670004
.*  PATCH LABEL      =  NONE                                            00680004
.*  MACRO TYPE       =  BILINGUAL                                       00690004
.*  PROCESSOR        =  ASM / PLS2                                      00700004
.*  MACRO SIZE       =                                                  00710004
.*  ATTRIBUTES       =                                                  00720004
.*  ENTRY POINT      =  EXTRACT                                         00730004
.*  PURPOSE          =  SEE FUNCTION                                    00740004
.*  LINKAGE          =                                                  00750004
.*  CALLER           =                                                  00760004
.*  INPUT            =   (CALLING SEQUENCE)                    @D35EDWK 00770004
.*    1. ASM :                                                 @D35EDWK 00780004
.*        LABEL   EXTRACT  ID=PUB2|DVTY|BDY|CR|PUB|CPUID|MAP   @D14NDWK 00790004
.*                         |DEVICE|SENSE|GETVIS|PART|SVA       @D51MDGL 00800004
.*                         |SAINFO|ATLCUU                      @D61MDGL 00810004
.*                         AREA=(NAME1 |(S,NAME1)| (R1) ),     @D35EDWK 00820004
.*                         LEN=(NAME2 | (R2) ),                @D35EDWK 00830004
.*                         DISP=(NAME3 | (R3) ),               @D35EDWK 00840004
.*                         SEL=(NAME4 |(S,NAME4)| (R4) ), OR   @D35EDWK 00850004
.*                         SEP=(NAME4 |(S,NAME4)| (R4) ),      @D35EDWK 00860004
.*                         PID=(NAME5 |(S,NAME5)| (R5) ),      @D35EDWK 00870004
.*                         SID=(NAME6 |(S,NAME6)| (R6) ),      @D14NDWK 00880004
.*                         PU=(NAME7 |(S,NAME7)| (R7) ),       @D149DWK 00890004
.*                         MODE=(S | P | T),                   @D35EDWK 00900004
.*                         LOC=(RES|BELOW|ANY),                @SUPSERV 00910004
.*                         RESET=(NO|YES),                     @DY45817 00920004
.*                         MFG=(NAME7 |(S,NAME8)| (R8) )       @D149DWK 00930004
.*    2. PLS :                                                 @D35EDWK 00940004
.*        ?LABEL: EXTRACT ID(PUB2|DVTY|BDY|CR|PUB|CPUID|MAP    @D14NDWK 00950004
.*                        |DEVICE|SENSE|GETVIS|PART|SVA        @D51MDGL 00960004
.*                        |SAINFO|ATLCUU)                      @D61MDGL 00970004
.*                        AREA((NAME1)|(ADDR(NAME1))|((R1)) )  @D35EDWK 00980004
.*                        LEN((NAME2) | ((R2)) )               @D35EDWK 00990004
.*                        DISP((NAME2) | ((R2)) )              @D35EDWK 01000004
.*                        SEL((NAME4)|(ADDR(NAME4))|((R4)) )OR @D35EDWK 01010004
.*                        SEP((NAME4)|(ADDR(NAME4))|((R4)) )   @D35EDWK 01020004
.*                        PID((NAME5)|(ADDR(NAME5))|((R5)) )   @D35EDWK 01030004
.*                        SID((NAME6)|(ADDR(NAME6))|((R6)) )   @D14NDWK 01040004
.*                        PU((NAME7)|(ADDR(NAME7))|((R7)) )    @D149DWK 01050004
.*                        MODE((S)|(P)|(T))                    @D35EDWK 01060004
.*                        LOC(RES|BELOW|ANY)                   @SUPSERV 01070004
.*                        MFG((NAME8)|(ADDR(NAME8))|((R8)) );  @D149DWK 01080004
.*                                                             @D35EDWK 01090004
.*                      OPERANDS :                                      01100004
.*                      ID = INDICATES REQUESTED INFORMATION            01110004
.*                      AREA = ADDR WHERE INFORMATION IS TO BE STORED   01120004
.*                      LEN  = LENGTH OF AREA                           01130004
.*                      DISP = DISPLACEMENT WITHIN PUB OR               01140004
.*                             PUB2 TABLE (DEFAULT IS ZERO)             01150004
.*                      SEL  = ADDR OF HALFWORD CONTAINING LOGICAL UNIT 01160004
.*                      SEP  = ADDR OF HALFWORD CONTAINING PHYSICAL     01170004
.*                             UNIT ('CUU')                             01180004
.*                      PID  = ADDR OF HALFWORD CONTAINING THE PIK      01190004
.*                             (DEFAULT : PIK OF PART. OF ISSUING PROG) 01200004
.*                      SID  = ADDR OF A 2 BYTE SYMBOLIC SPACE @D149DWK 01210004
.*                             IDENTIFIER. VALID VALUES ARE    @D149DWK 01220004
.*                             /370 MODE : R,S,N (N=1..9)      @D149DWK 01230004
.*                             E MODE AND VM : 1               @D149DWK 01240004
.*                             (DEFAULT : 1 )                  @D149DWK 01250004
.*                      PU   = ADDRESS OF A TWO BYTE FIELD     @D149DWK 01260004
.*                             CONTAINING THE PUB INDEX        @D149DWK 01270004
.*                             (X'0000'-X'00FE') FOR WHICH     @D149DWK 01280004
.*                             THE INFORMATION IS TO BE        @D149DWK 01290004
.*                             RETRIEVED                       @D149DWK 01300004
.*                      MODE = FURTHER MODIFIER OF THE KIND OF @D35EDWK 01310004
.*                             INFORMATION, THAT IS TO BE      @D35EDWK 01320004
.*                             RETURNED.                       @D35EDWK 01330004
.*                      LOC  = IS ONLY VALID FOR ID=GETVIS.    @SUPSERV 01340004
.*                             TELLS, IF THE INFORMATION IS    @SUPSERV 01350004
.*                             TO BE RETURNED FOR 24 BIT       @SUPSERV 01360004
.*                             ADDRESSABLE GETVIS AREA,        @SUPSERV 01370004
.*                             FOR THE AREA THAT CORRESPONDS   @SUPSERV 01380004
.*                             TO THE CALLERS PRESENT RESID.   @SUPSERV 01390004
.*                             MODE, OR FOR 31 BIT ADDRESSABLE @SUPSERV 01400004
.*                             GETVIS (WHICH INCLUDES 24 BIT   @SUPSERV 01410004
.*                             ADDRESSABLE PART).              @SUPSERV 01420004
.*                     RESET = IS ONLY VALID FOR ID=PART. IT   @DY45817 01430004
.*                             INDICATES IF THE USER WANTS THE @DY45817 01440004
.*                             HIGH-WATER-MARK TO BE RESET.    @DY45817 01450004
.*                      MFG  = ADDR OF 20 BYTE WORKAREA WHERE THE       01460004
.*                             PARMLIST FOR SVC IS TO BE STORED.        01470004
.*                                                                      01480004
.*                      THE S-TYPE NOTATION (S,NAMEX) WILL     @D35EDWK 01490004
.*                      GENERATE A LA- AND ST-INSTRUCTION      @D35EDWK 01500004
.*                      USING REGISTER 0.                      @D35EDWK 01510004
.*                                                             @D35EDWK 01520004
.*                                                             @D35EDWK 01530004
.* ----------------------------------------------------------- @D149DWK 01540004
.* | ID   | PUB2 | DVTY | BDY | CR  | PUB | CPUID| MAP |DEVICE @D149DWK 01550004
.* -------|--------------------------------------------------- @D149DWK 01560004
.* | AREA |  R   |  R   |  R  |  R  |  R  |  R   |  R  |   R   @D149DWK 01570004
.* | LEN  |  R   |  R   |  R  |  R  |  R  |  R   |  R  |   R   @D149DWK 01580004
.* | DISP |  O   | N/A  | N/A | N/A |  O  | N/A  | N/A |  N/A  @D149DWK 01590004
.* | SEL  |  R-  |  R-  | N/A | N/A |  R- | N/A  | N/A |   R-  @D149DWK 01600004
.* | SEP  |  R-  |  R-  | N/A | N/A |  R- | N/A  | N/A |   R-  @D149DWK 01610004
.* | PU   |  R-  |  R-  | N/A | N/A |  R- | N/A  | N/A |   R-  @D149DWK 01620004
.* | PID  |  O** |  O** |  O* | N/A |  O**| N/A  | N/A |   O** @D149DWK 01630004
.* | SID  | N/A  | N/A  | N/A | N/A | N/A | N/A  |  O  |  N/A  @D149DWK 01640004
.* | MODE | N/A  | N/A  |  O* | N/A | N/A |  O   | N/A |  N/A  @D51EMGL 01650004
.* | LOC  | N/A  | N/A  | N/A | N/A | N/A | N/A  | N/A |  N/A  @SUPSERV 01660004
.* | MFG  |  O   |  O   |  O  |  O  |  O  |  O   |  O  |   O   @D149DWK 01670004
.* ----------------------------------------------------------- @D149DWK 01680004
.*                                                             @D35EDWK 01690004
.* ----------------------------------------------------------- @D21LDRP 01700004
.* | ID   |SENSE |GETVIS| PART| SVA | SAINFO | ATLCUU  |       @D51MDGL 01710004
.* -------|--------------------------------------------------- @D21LDRP 01720004
.* | AREA |  R   |  R   |  R  |  R  |   R    |   R     |       @D21LDRP 01730004
.* | LEN  |  R   |  R   |  R  |  R  |   R    |   R     |       @D21LDRP 01740004
.* | DISP | N/A  | N/A  | N/A | N/A |  N/A   |  N/A    |       @D21LDRP 01750004
.* | SEL  |  R-  | N/A  | N/A | N/A |  N/A   |  N/A    |       @D21LDRP 01760004
.* | SEP  |  R-  | N/A  | N/A | N/A |  N/A   |  N/A    |       @D21LDRP 01770004
.* | PU   |  R-  | N/A  | N/A | N/A |  N/A   |  N/A    |       @D21LDRP 01780004
.* | PID  |  O** |  O   |  O  | N/A |  N/A   |  N/A    |       @D21LDRP 01790004
.* | SID  | N/A  | N/A  | N/A | N/A |  N/A   |  N/A    |       @D21LDRP 01800004
.* | MODE | N/A  |  O   | N/A | N/A |   R    |  N/A    |       @D61DDEM 01810004
.* | LOC  | N/A  |  O   | N/A | N/A |  N/A   |  N/A    |       @SUPSERV 01820004
.* | RESET| N/A  | N/A  |  O  | N/A |  N/A   |  N/A    |       @DY45817 01830004
.* | MFG  |  O   |  O   |  O  |  O  |   O    |   O     |       @D21LDRP 01840004
.* ----------------------------------------------------------- @D21LDRP 01850004
.*                                                             @D35EDWK 01860004
.*        R = REQUIRED                                         @D35EDWK 01870004
.*        R-= MUTUAL EXCLUSIVE                                 @D149DWK 01880004
.*        O = OPTIONAL                                         @D35EDWK 01890004
.*        N/A = NOT APPLICABLE                                 @D35EDWK 01900004
.*        * = IF PID SPECIFIED MODE=T IS NOT ALLOWED           @D21LDRP 01910004
.*        O** = OPTIONAL IF SEL SPECIFIED, N/A OTHERWISE       @D21LDRP 01920004
.*                                                             @D35EDWK 01930004
.*                                                                      01940004
.*  OUTPUT(ASSEMBLER)=  PARMLIST OF FOLLOWING FORMAT GENERATED @D35EDWK 01950004
.*                                                                      01960004
.*           REG1 --> 0 -------------------------------------           01970004
.*                      |  ID    |  FLAG  |   RESERVED      |           01980004
.*                    4 -------------------------------------           01990004
.*                      |    LENGTH       |   DISPLACEMENT  |           02000004
.*                    8 -------------------------------------           02010004
.*                      |        ADDR (AREA)                |           02020004
.*                   12 -------------------------------------           02030004
.*                      |        ADDR ((SEL) | (SEP) | (PU))|  &D149DWK 02040004
.*                   16 -------------------------------------           02050004
.*                      |        ADDR ((PIK) | (SID))       |  @D149DWK 02060004
.*                      -------------------------------------           02070004
.*                                                                      02080004
.*                                                                      02090004
.*                    ID = X'01' FOR PUB2                      @D35EDWK 02100004
.*                         X'02' FOR DVTY                      @D51IDGL 02110004
.*                         X'03' FOR BDY                       @D35EDWK 02120004
.*                         X'04' FOR CR                        @D35EDWK 02130004
.*                         X'05' FOR PUB                       @D35EDJO 02140004
.*                         X'06' FOR CPUID                     @D356DWK 02150004
.*                         X'07' FOR MAP                       @D149DWK 02160004
.*                         X'08' FOR DEVICE                    @D149DWK 02170004
.*                         X'09' FOR SENSE                     @D21LDRP 02180004
.*                         X'0A' FOR GETVIS                    @D21LDRP 02190004
.*                         X'0B' FOR PART                      @D51IDGL 02200004
.*                         X'0C' FOR SVA                       @D61IDGL 02210004
.*                         X'0D' FOR SAINFO                    @D61DDGL 02220004
.*                         X'0E' FOR ATLCUU                    @D61DDGL 02230004
.*                                                             @D35EDWK 02240004
.*                    FLAG: FOR DEVICE RELATED SERVICES:       @D51IDGL 02250004
.*                          NO MODE OPERAND POSSIBLE,          @D51IDGL 02260004
.*                    FLAG = X'00' SEL WAS PROVIDED            @D51IDGL 02270004
.*                           X'01' SEP WAS PROVIDED            @D51IDGL 02280004
.*                           X'02' PU  WAS PROVIDED            @D51IDGL 02290004
.*                          FOR EXTRACT ID=BDY FLAG REFLECTS   @D51IDGL 02300004
.*                          THE MODE INDICATOR:                @D51IDGL 02310004
.*                    FLAG = X'00' MODE OMMITTED (= MODE T)    @D51IDGL 02320004
.*                           X'01' MODE T (TEMPORARY BOUND.)   @D51IDGL 02330004
.*                           X'02' MODE S (NO MORE SUPPORTED)  @D51IDGL 02340004
.*                           X'03' MODE P (PERMANENT BOUND.)   @D51IDGL 02350004
.*                           X'04' MODE SYSP (SYSTEM)          @D51IDGL 02360004
.*                          FOR EXTRACT ID=GETVIS              @D51IDGL 02370004
.*                    FLAG = X'00' MODE OMMITTED MEANS         @D51IDGL 02380004
.*                                 IF PID = 0 SUPPLIED :       @D51IDGL 02390004
.*                                    SVA GETVIS REQUEST       @D51IDGL 02400004
.*                                 ELSE SAME AS MODE = PT      @D51IDGL 02410004
.*                           X'01' MODE PT (PARTITION GETVIS)  @D51IDGL 02420004
.*                           X'02' MODE SP (DYN.SPACE GETVIS)  @D51IDGL 02430004
.*                           X'04' MODE SV (SVA GETVIS)        @D51IDGL 02440004
.*                                 LOC  RES IS DEFAULT         @SUPSERV 02450004
.*                           X'10' LOC  BELOW                  @SUPSERV 02460004
.*                           X'20' LOC  ANY                    @SUPSERV 02470004
.*                           X'40' RESET=YES                   @DY45817 02480004
.*                          FOR EXTRACT ID=CPUID               @D51EMGL 02490004
.*                    FLAG = X'00' MODE WAS OMITTED            @D51EMGL 02500004
.*                           X'01' MODE=REAL WAS SPECIFIED     @D51EMGL 02510004
.*                          FOR EXTRACT ID=SAINFO              @D61DDGL 02520004
.*                    FLAG = X'03' MODE WAS PUBDEVTY           @D61DDGL 02530004
.*                           X'04' MODE WAS EXTCODE            @D61DDGL 02540004
.*                                                             @D35EDWK 02550004
.*                                                             @D35EDWK 02560004
.*  OUTPUT(EXECUTION)=  ID = PUB2                              @D35EDWK 02570004
.*                      PUB2 TABLE ENTRY OF SPECIFIED DEVICE   @D35EDWK 02580004
.*                      MOVED TO USER AREA                     @D35EDWK 02590004
.*                                                             @D35EDWK 02600004
.*                      ID = PUB                               @D35EDJO 02610004
.*                      PUB TABLE ENTRY OF SPECIFIED DEVICE    @D35EDJO 02620004
.*                      MOVED TO USER AREA                     @D35EDJO 02630004
.*                                                             @D35EDWK 02640004
.*                      ID = DVTY                              @D35EDWK 02650004
.*                       SAME AS IF ID=PUB AND                 @D35EDJO 02660004
.*                       DISP=PUBDEVTY HAD BEEN SPECIFIED.     @D35EDWK 02670004
.*                                                             @D35EDWK 02680004
.*                      ID = BDY                               @D35EDWK 02690004
.*                      DEPENDING ON THE MODE PARAMETER        @D35EDWK 02700004
.*                      POSSIBLE MODES ARE                     @D35EDWK 02710004
.*                                                             @D35EDWK 02720004
.*                      MODE=TEMP   FOR TEMPORARY BOUNDARIES   @D35EDWK 02730004
.*                                  OF A PARTITION             @D35EDWK 02740004
.*                                                             @D35EDWK 02750004
.*        MAPPING BY:   MAPEXTR ID=BDY,MODE=TEMP               @D35EDWK 02760004
.*                                                             @D35EDWK 02770004
.*                      MODE=PERM   FOR PERMANENT BOUNDARIES   @D35EDWK 02780004
.*                                  OF A PARTITION             @D35EDWK 02790004
.*        MAPPING BY:   MAPEXTR ID=BDY,MODE=PERM               @D35EDWK 02800004
.*                                                             @D35EDWK 02810004
.*                      MODE=T      (INTENTION LIKE TEMP, BUT  @D35EDWK 02820004
.*                                  NOT EXTENDED ANY MORE)     @D35EDWK 02830004
.*                      MODE=P      (INTENTION LIKE PERM, BUT  @D35EDWK 02840004
.*                                  NOT EXTENDED ANY MORE)     @D35EDWK 02850004
.*                                                             @D35EDWK 02860004
.*                                                             @D35EDWK 02870004
.*                      ID = CR                                @D35EDWK 02880004
.*                      CONTROL REGISTERS FROM R0 TO RF ARE    @D35EDWK 02890004
.*                      STORED IN THE USER AREA.               @D35EDWK 02900004
.*                                                             @D35EDWK 02910004
.*                      ID = CPUID                             @D356DWK 02920004
.*                      CPUID AND SYSLOG ID STORED IN THE      @D356DWK 02930004
.*                      USER AREA. IN CASE THE USER SPECIFIED  @D51EMGL 02940004
.*                      MODE=REAL WITH THE REQUEST, THE REAL   @D51EMGL 02950004
.*                      CPUID HE IS RUNNING ON IS RETURNED,    @D51EMGL 02960004
.*                      INSTEAD OF THE SIMULATED CPUID OF THE  @D51EMGL 02970004
.*                      VIRTUAL MACHINE.                       @D51EMGL 02980004
.*                                                             @D356DWK 02990004
.*                      ID = MAP                               @D149DWK 03000004
.*                      A LIST OF PARTITIONS BELONGING TO A    @D149DWK 03010004
.*                      GIVEN ADDRESS SPACE IS RETURNED IN     @D149DWK 03020004
.*                      THE SPECIFIED AREA. END OF PIK LIST IS @D149DWK 03030004
.*                      INDICATED BY 0.                        @D149DWK 03040004
.*                                                             @D149DWK 03050004
.*                      ID = DEVICE                            @D149DWK 03060004
.*                      A 10 BYTE FIELD CONSISTING OF 2 BYTE   @D149DWK 03070004
.*                      CUU FIELD, 1 BYTE PUB DEVICE TYPE CODE @D21IDRP 03080004
.*                      AND 7 BYTE DEVICE INFORMATION          @D21IDRP 03090004
.*                      AS RETRIEVED BY SENSE-ID COMMAND IS    @D149DWK 03100004
.*                      RETURNED. THE 7 BYTE FIELD CONTAINS    @D21IDRP 03110004
.*                      BINARY ZEROS IF THE DEVICE DOES NOT    @D149DWK 03120004
.*                      SUPPORT THE SENSE-ID COMMAND.          @D149DWK 03130004
.*                      IF THE LENGTH PROVIDED BY THE USER IS  @D21IDRP 03140004
.*                      LARGE ENOUGH, THE 2-BYTE OBR-RECORD ID @D21IDRP 03150004
.*                      AND THE 1 BYTE MDR-RECORD ID IS        @D21IDRP 03160004
.*                      PROVIDED IN ADDITION.                  @D21IDRP 03170004
.*                      FOR QDIO DEVICES:                      @DSCSI   03171005
.*                      ADDITIONAL INFORMATION WILL BE PROVIDED@DSCSI   03172005
.*                      AS OUTLINED IN DETAIL IN THE MAPEXTR   @DSCSI   03173005
.*                      ID=DEVICE MACRO                        @DSCSI   03174005
.*                                                             @D21LDRP 03180004
.*                      ID = SENSE                             @D21LDRP 03190004
.*                      A FIELD CONSISTING OF THE AVAILABLE    @D21LDRP 03200004
.*                      SENSE INFORMATION IN THE USER SPECIFIED@D21IDRP 03210004
.*                      LENGTH UP TO THE MAXIMUM SENSE LENGTH  @D21IDRP 03220004
.*                                                             @D21..RP 03230004
.*                      ID = GETVIS                            @D21..RP 03240004
.*                      A 20 BYTE FIELD CONSISTING OF ACTUAL   @D21LDRP 03250004
.*                      GETVIS INFORMATION AS FOLLOWS:         @D21LDRP 03260004
.*                      1ST FULLWORD: LENTH OF GETVIS CONTROL  @D21LDRP 03270004
.*                           INFORMATION (IN BYTES)            @D21LDRP 03280004
.*                      2ND FULLWORD: MAX. GETVIS-SPACE (IN    @D21LDRP 03290004
.*                           BYTES) EVER USED UP TO NOW (INCL. @D21LDRP 03300004
.*                           CONTROL INFORMATION).             @D21LDRP 03310004
.*                      3RD FULLWORD: FREE GETVIS-SPACE (IN    @D21LDRP 03320004
.*                           BYTES).                           @D21LDRP 03330004
.*                      4TH FULLWORD: USED GETVIS-SPACE (IN    @D21LDRP 03340004
.*                           BYTES) INCL. CONTROL INFORMATION. @D21LDRP 03350004
.*                      5TH FULLWORD: LARGEST CONTIGOUS FREE   @D21LDRP 03360004
.*                           GETVIS AREA (IN BYTES)            @D21LDRP 03370004
.*                      THE GETVIS REQUEST CAN BE ISSUED FOR   @D51IDGL 03380004
.*                      EITHER A PARTITION GETVIS AREA, A      @D51IDGL 03390004
.*                      SPACE GETVIS AREA OF A DYNAMIC PAR-    @D51IDGL 03400004
.*                      TITION OR THE SVA. THE SVA WAS FORMERLY@D51IDGL 03410004
.*                      INDICATED BY A PIK OF 0. THIS INTERFACE@D51IDGL 03420004
.*                      IS STILL SUPPORTED, BUT SHOULD NO MORE @D51IDGL 03430004
.*                      BE USED. THE KIND OF REQUEST IS NOW    @D51IDGL 03440004
.*                      INDICATED BY THE MODE KEYWORD.         @D51IDGL 03450004
.*                      MODE = PT : PARTITION GETVIS           @D51IDGL 03460004
.*                      MODE = SP : SPACE GETVIS               @D51IDGL 03470004
.*                      MODE = SV : SVA GETVIS                 @D51IDGL 03480004
.*                                                             @D51IDGL 03490004
.*                      ID = PART                              @D51IDGL 03500004
.*                      THIS SERVICE SHOULD ONLY BE USED BY    @D51IDGL 03510004
.*                      IUI. IT PROVIDES ALL RELEVANT          @D51IDGL 03520004
.*                      BOUNDARIES OF A PARTITION PLUS ALL     @D51IDGL 03530004
.*                      AVAILABLE PARTITION AND DYNAMIC SPACE  @D51IDGL 03540004
.*                      GETVIS INFORMATION. THE MAPPING IS     @D51IDGL 03550004
.*                      SUPPLIED BY                            @D51IDGL 03560004
.*                      MAPEXTR  ID=PART(,DSECT=YES|NO)        @D51IDGL 03570004
.*                                                             @D51IDGL 03580004
.*                      ID = SVA                               @D51MDGL 03590004
.*                      THIS SERVICE SHOULD ONLY BE USED BY    @D51MDGL 03600004
.*                      IUI. IT SUPPLIES ALL INFORMATION       @D51MDGL 03610004
.*                      ABOUT SVA BOUNDARIES AND VALUES        @D51MDGL 03620004
.*                      MAPPING BY                             @D51MDGL 03630004
.*                      MAPEXTR ID=SVA(,DSECT=YES|NO)          @D51MDGL 03640004
.*                                                             @D51MDGL 03650004
.*                      ID = SAINFO                            @D61DDGL 03660004
.*                      THIS SERVICE IS INTENDED TO SUPPORT    @D61DDGL 03670004
.*                      THE STAND ALONE SUPERVISOR PROCESSING  @D61DDGL 03680004
.*                      AND RETURNS POSSIBLE EXTERNAL DEVICE   @D61DDGL 03690004
.*                      TYPE CODES FOR AN INPUT PUB DEVICE TYPE@D61DDGL 03700004
.*                      CODE OR THE ONE AND ONLY PUB DEVICE    @D61DDGL 03710004
.*                      TYPE CODE FOR A CALLER SUPPLIED        @D61DDGL 03720004
.*                      EXTERNAL DEVICE TYPE CODE. UNLIKE ALL  @D61DDGL 03730004
.*                      OTHER EXTRACT SERVICES THE AREA IS NOT @D61DDGL 03740004
.*                      JUST AN OUTPUT FIELD BUT ALSO THE AREA @D61DDGL 03750004
.*                      WHERE THE INPUT INFORMATION (PUB DEVICE@D61DDGL 03760004
.*                      TYPE CODE OR EXTERNAL DEVICE TYPE CODE)@D61DDGL 03770004
.*                      IS SUPPLIED.                           @D61DDGL 03780004
.*                                                             @D51MDGL 03790004
.*                      ID = ATLCUU                            @D61DDGL 03800004
.*                      THIS SERVICE SEARCHS FOR A FREE TAPE   @D61DDGL 03810004
.*                      DRIVE, ATTACHED TO EITHER THE DEFAULT  @D61DDGL 03820004
.*                      TAPE LIBRARY OR THE SPECIFIED TAPE     @D61DDGL 03830004
.*                      LIBRARY, OF THE SPECIFIED DEVICE TYPE  @D61DDGL 03840004
.*                      AND SETS THE MOUNT OWNERSHIP FLAG.     @D61DDGL 03850004
.*                      UNLIKE ALL OTHER EXTRACT SERVICES THE  @D61DDGL 03860004
.*                      AREA IS NOT JUST AN OUTPUT FIELD BUT   @D61DDGL 03870004
.*                      ALSO THE AREA WHERE THE INPUT INFORMAT.@D61DDGL 03880004
.*                      (DEVICE TYPE CODE, LOGICAL TAPE LIB    @D61DDGL 03890004
.*                      NAME) IS SUPPLIED.                     @D61DDGL 03900004
.*  MAPPING OF INPUT/OUTPUT BY:   MAPEXTR ID=ATLCUU            @D61DDGL 03910004
.*                                                             @D51MDGL 03920004
.*  EXIT NORMAL      =  COMPILER :                                      03930004
.*                      PARMLIST GENERATED                              03940004
.*                      EXECUTION:                                      03950004
.*                      REGISTER 15  =  0                               03960004
.*  EXIT ERROR       =  COMPILER :                                      03970004
.*                      MNOTES INDICATING THE ERROR                     03980004
.*                      EXECUTION:                                      03990004
.*                      REGISTER 15  =  4    INVALID PIK SPECIFIED      04000004
.*                                      4    SID NOT SUPPORTED @D149DWK 04010004
.*                                           OR INVALID FOR    @D149DWK 04020004
.*                                           CURRENT SYTEM MODE@D149DWK 04030004
.*                                      8    LOGICAL OR PHYSICAL UNIT   04040004
.*                                           NOT SUPPORTED              04050004
.*                                     12    LOGICAL UNIT NOT ASSIGNED  04060004
.*                                     16    INVALID LENGTH OR DISP-    04070004
.*                                           SPECIFICATION              04080004
.*                                                             @D35EDWK 04090004
.*                      ILLEGAL SVC IS FORCED WHEN             @D35EDWK 04100004
.*                      - THE ID IS NOT VALID                  @D35EDWK 04110004
.*                      - PIK OF OTHER PARTITION BUT REQUESTOR @D35EDWK 04120004
.*                        HAS NOT KEY 0                        @D35EDWK 04130004
.*                      - PHYSICAL UNIT SPECIFIED BUT REQUES-  @D35EDWK 04140004
.*                        TOR HAS NOT KEY 0                    @D35EDWK 04150004
.*                                                             @D35EDWK 04160004
.*  EXTERNAL REFEREN.=  NONE                                            04170004
.*  ROUTINES         =  SVC 98                                          04180004
.*  DATA AREAS       =  NONE                                            04190004
.*  CONTROL BLOCKS   =  NONE                                            04200004
.*  TABLES           =  OWN TABLE GENERATED                             04210004
.*  MACROS           =  NONE                                            04220004
.*  CHANGE ACTIVITIES=  NEW MACRO   FIRST RELEASE 34.0         @D34YDWK 04230004
.*                      PUB(DVTY), BDY AND CR ADDED IN REL.35  @D35EDWK 04240004
.*                      CPUID ADDED IN RELEASE 35.0            @D356DWK 04250004
.*                      MAP AND DEVICE ADDED IN RELEASE 2.1    @D149DWK 04260004
.*                      EXTENTION FOR DEVICE ADDED             @D21IDRP 04270004
.*                      SENSE, GETVIS ADDED TO MACRO (DY37265) @D21LDRP 04280004
.*                      BDY,MODE=SYSP INTRODUCED               @D51IDGL 04290004
.*                      SEL,SEP AND PU ALLOWED FOR ALL DEVICE  @D51MDGL 04300004
.*                      SPECIFIC INFO (PUB,PUB2,DVTY,SENSE,    @D51MDGL 04310004
.*                      DEVICE)                                @D51MDGL 04320004
.*                      ADAPTATION TO MORE PARTITION SUPPORT   @D51IDGL 04330004
.*                      MODE INTRODUCED FOR GETVIS.            @D51IDGL 04340004
.*                      MODE INTRODUCE FOR CPUID REAL          @D51EMGL 04350004
.*                      INTRODUCE ID=SAINFO SERVICE            @D61DDGL 04360004
.*                      INTRODUCE ID=ATLCUU SERVICE            @D61DDGL 04370004
.*                                                             @D51MDGL 04380004
.*  LAST UPDATE      =  06/23/2003                             @D61DDGL 04390005
.*  MODIFIED REGISTER=  REGISTER (0), 1 AND 15                 @D35EDWK 04400004
.*                                                                      04410004
.*                                                                      04420004
.*                                                                      04430004
.** END OF SPECICATIONS *********************************************** 04440004
.********************************************************************** 04450004
.*                                                                      04460004
.* CHECK VALIDITY OF ID OPERAND.                               @D35EDWK 04470004
.*                                                                      04480004
.********************************************************************** 04490004
&TOPE    SETC  'ID'                                            @D35EDWK 04500004
         AIF   (T'&ID EQ 'O').NOTE1                            @D35EDWK 04510004
         AIF   ('&ID' NE 'PUB2').NPUB2                         @D21LDRP 04520004
.**************************************************************         04530004
.*  ID = PUB2                                                 *         04540004
.*------------------------------------------------------------*         04550004
&TID     SETA  1                                               @D35EDWK 04560004
&SELSW   SETB  1                  INDICATE SEL ALLOWED         @D21LDRP 04570004
&SEPSW   SETB  1                  INDICATE SEP ALLOWED         @D21LDRP 04580004
&PIDSW   SETB  1                  INDICATE PID ALLOWED         @D21LDRP 04590004
&DISPSW  SETB  1                  INDICATE DISP ALLOWED        @D21LDRP 04600004
&PUSW    SETB  1                  INDICATE PUBINDEX ALLOWED    @D51MDGL 04610004
&LPUEXCL SETB  1                  IND.SEL,SEP,PU MUTUALLY EXCL.@D51MDGL 04620004
         AGO   .CHAREA                                         @D21LDRP 04630004
.NPUB2   ANOP                                                  @D21LDRP 04640004
         AIF   ('&ID' NE 'BDY').NBDY                           @D21LDRP 04650004
.**************************************************************         04660004
.*  ID = BDY    BOUNDARY                                      *         04670004
.*------------------------------------------------------------*         04680004
&TID     SETA  3                  INDICATE BDY                 @D35EDWK 04690004
&PIDSW   SETB  1                  INDICATE PID ALLOWED         @D21LDRP 04700004
&MODESW  SETB  1                  INDICATE MODE ALLOWED        @D61DDEM 04710004
         AGO   .CHAREA                                         @D21LDRP 04720004
.NBDY    ANOP                                                  @D21LDRP 04730004
         AIF   ('&ID' NE 'CR').NCR                             @D14ZDWK 04740004
.**************************************************************         04750004
.*  ID = CR     CONTROL REGISTERS                             *         04760004
.*------------------------------------------------------------*         04770004
&TID     SETA  4                                               @D35EDWK 04780004
         AGO   .CHAREA                                         @D21LDRP 04790004
.NCR     ANOP                                                  @D21LDRP 04800004
         AIF   ('&ID' NE 'DVTY').NDVTY                         @D21LDRP 04810004
.**************************************************************         04820004
.*  ID = DVTY   DEVICE TYPE                                   *         04830004
.*------------------------------------------------------------*         04840004
&TID     SETA  2                                               @D35EDJO 04850004
&PIDSW   SETB  1                  INDICATE PID ALLOWED         @D21LDRP 04860004
&SELSW   SETB  1                  INDICATE SEL ALLOWED         @D21LDRP 04870004
&SEPSW   SETB  1                  INDICATE SEP ALLOWED         @D51MDGL 04880004
&PUSW    SETB  1                  INDICATE PUBINDEX ALLOWED    @D51MDGL 04890004
&LPUEXCL SETB  1                  IND.SEL,SEP,PU MUTUALLY EXCL.@D51MDGL 04900004
         AGO   .CHAREA                                         @D21LDRP 04910004
.NDVTY   ANOP                                                  @D21LDRP 04920004
         AIF   ('&ID' NE 'PUB').NPUB                           @D21LDRP 04930004
.**************************************************************         04940004
.*  ID = PUB    GET COPY OF PHYSICAL UNIT BLOCK               *         04950004
.*------------------------------------------------------------*         04960004
&TID     SETA  5                                               @D35EDJO 04970004
&DISPSW  SETB  1                  INDICATE DISP ALLOWED        @D21LDRP 04980004
&PIDSW   SETB  1                  INDICATE PID ALLOWED         @D21LDRP 04990004
&SELSW   SETB  1                  INDICATE SEL ALLOWED         @D21LDRP 05000004
&SEPSW   SETB  1                  INDICATE SEP ALLOWED         @D51MDGL 05010004
&PUSW    SETB  1                  INDICATE PUBINDEX ALLOWED    @D51MDGL 05020004
&LPUEXCL SETB  1                  IND.SEL,SEP,PU MUTUALLY EXCL.@D51MDGL 05030004
         AGO   .CHAREA                                         @D21LDRP 05040004
.NPUB    ANOP                                                  @D21LDRP 05050004
         AIF   ('&ID' NE 'CPUID').NCPUID                       @D14NDWK 05060004
.**************************************************************         05070004
.*  ID = CPUID  GET CPU IDENTIFICATION                        *         05080004
.*------------------------------------------------------------*         05090004
&TID     SETA  6                                               @D14NDWK 05100004
&MODESW  SETB  1                  INDICATE MODE ALLOWED        @D61DDEM 05110004
         AGO   .CHAREA                                         @D21LDRP 05120004
.NCPUID  ANOP                                                  @D21LDRP 05130004
         AIF   ('&ID' NE 'MAP').NMAP                           @D14NDWK 05140004
.**************************************************************         05150004
.*  ID = MAP    GET LIST OF PIKS RESIDING IN SPECIFIED SPACE  *         05160004
.*------------------------------------------------------------*         05170004
&TID     SETA  7                                               @D14NDWK 05180004
         AGO   .CHAREA                                         @D21LDRP 05190004
.NMAP    ANOP                                                  @D21LDRP 05200004
         AIF   ('&ID' NE 'DEVICE').NDEVICE                     @D21LDRP 05210004
.**************************************************************         05220004
.*  ID = DEVICE                                               *         05230004
.*------------------------------------------------------------*         05240004
&TID     SETA  8                                               @D14CDWK 05250004
&SELSW   SETB  1                  INDICATE SEL ALLOWED         @D21LDRP 05260004
&SEPSW   SETB  1                  INDICATE SEP ALLOWED         @D21LDRP 05270004
&PIDSW   SETB  1                  INDICATE PID ALLOWED         @D21LDRP 05280004
&PUSW    SETB  1                  INDICATE PU  ALLOWED         @D21LDRP 05290004
&LPUEXCL SETB  1                  IND.SEL,SEP,PU MUTUALLY EXCL.@D51MDGL 05300004
         AGO   .CHAREA                                         @D21LDRP 05310004
.NDEVICE ANOP                                                  @D21LDRP 05320004
         AIF   ('&ID' NE 'SENSE').NSENSE                       @D21LDRP 05330004
.**************************************************************         05340004
.*  ID = SENSE                                                *         05350004
.*------------------------------------------------------------*         05360004
&TID     SETA  9                                               @D21LDRP 05370004
&SELSW   SETB  1                  INDICATE SEL ALLOWED         @D21LDRP 05380004
&SEPSW   SETB  1                  INDICATE SEP ALLOWED         @D21LDRP 05390004
&PIDSW   SETB  1                  INDICATE PID ALLOWED         @D21LDRP 05400004
&PUSW    SETB  1                  INDICATE PU  ALLOWED         @D21LDRP 05410004
&LPUEXCL SETB  1                  IND.SEL,SEP,PU MUTUALLY EXCL.@D51MDGL 05420004
         AGO   .CHAREA                                         @D21LDRP 05430004
.NSENSE  ANOP                                                  @D21LDRP 05440004
         AIF   ('&ID' NE 'PART').NPART                         @D51IDGL 05450004
.**************************************************************         05460004
.*  ID = PART                                                 *         05470004
.*------------------------------------------------------------*         05480004
&TID     SETA  11                                              @D51IDGL 05490004
&PIDSW   SETB  1                  INDICATE PID ALLOWED         @D51IDGL 05500004
         AGO   .CHAREA                                         @D51IDGL 05510004
.NPART   ANOP                                                  @D51IDGL 05520004
         AIF   ('&ID' NE 'SVA').NSVA                           @D51MDGL 05530004
.**************************************************************         05540004
.*  ID = SVA    SVA INFORMATION (FOR IUI ONLY)                *         05550004
.*------------------------------------------------------------*         05560004
&TID     SETA  12                                              @D51MDGL 05570004
         AGO   .CHAREA                                         @D51MDGL 05580004
.NSVA    ANOP                                                  @D51MDGL 05590004
         AIF   ('&ID' NE 'SAINFO').NSAINFO                     @D51MDGL 05600004
.**************************************************************         05610004
.*  ID = SAINFO INFORMATION FOR STAND ALONE SUPERVISOR        *         05620004
.*------------------------------------------------------------*         05630004
&TID     SETA  13                                              @D51MDGL 05640004
&MODESW  SETB  1                  INDICATE MODE ALLOWED        @D61DDEM 05650004
         AGO   .CHAREA                                         @D51MDGL 05660004
.NSAINFO ANOP                                                  @D51MDGL 05670004
         AIF   ('&ID' NE 'ATLCUU').NATLCUU                     @D61DDGL 05680004
.**************************************************************         05690004
.*  ID = ATLCUU FIND FREE CUU FOR 3490/3490E ON 3494          *@D61DDGL 05700004
.*------------------------------------------------------------*         05710004
&TID     SETA  14                                              @D61DDGL 05720004
         AGO   .CHAREA                                         @D61DDGL 05730004
.NATLCUU ANOP                                                  @D61DDGL 05740004
         AIF   ('&ID' NE 'GETVIS').NOTE2                       @D51MDGL 05750004
.**************************************************************         05760004
.*  ID = GETVIS                                               *         05770004
.*------------------------------------------------------------*         05780004
&TID     SETA  10                 INDICATE ID=GETVIS           @D21LDRP 05790004
&PIDSW   SETB  1                  INDICATE PID ALLOWED         @D21LDRP 05800004
&MODESW  SETB  1                  INDICATE MODE ALLOWED        @D61DDEM 05810004
.********************************************************************** 05820004
.*                                                                      05830004
.* CHECK AREA AND LENGTH OPERANDS.                             @D149DWK 05840004
.*                                                                      05850004
.********************************************************************** 05860004
.CHAREA  ANOP                                                           05870004
&TOPE    SETC  'AREA'                                          @D21LDRP 05880004
         AIF   (T'&AREA EQ 'O').NOTE1      AREA REQUIRED       @D21LDRP 05890004
&TOPE    SETC  'LEN'                                           @D21LDRP 05900004
         AIF   (T'&LEN EQ 'O').NOTE1       LEN REQUIRED        @D21LDRP 05910004
         AIF   (N'&LEN LT 2).CHDIS         NO SUBLIST IN LEN   @D35EDWK 05920004
         AIF   ('&LEN'(1,3) EQ '(S,').NOTE3 S-TYPE NOT ALLOWED @D21LDRP 05930004
.********************************************************************** 05940004
.*                                                                      05950004
.* CHECK DISP OPERAND.                                                  05960004
.*                                                                      05970004
.********************************************************************** 05980004
.CHDIS   ANOP                              CHECK DISP OPERAND  @D35EDWK 05990004
         AIF   (T'&DISP EQ 'O').CHDISE     DISP OMITTED        @D35EDJO 06000004
&TOPE    SETC  'DISP'                                          @D35EDJO 06010004
&GO      SETA  4                                               @D35EDJO 06020004
         AIF   (NOT &DISPSW).NOTE4 BRANCH IF DISP NOT ALLOWED  @D21LDRP 06030004
         AIF   (N'&DISP GT 1).NOTE3                            @D35EDJO 06040004
&TDISP   SETA  1                  INDICATE REGISTER NOTATION   @D14ZDWK 06050004
         AIF   ('&DISP'(1,1) EQ '(').CHDISE                    @D14ZDWK 06060004
&DISPC   SETC  '&DISP'                                         @D36ZDWK 06070004
&TDISP   SETA  3                  IND. FIELD NAME IN PUBADR    @D36ZDWK 06080004
         AIF   ('&DISP'(1,3) EQ 'PUB').CHDISE                  @D14ZDWK 06090004
&TDISP   SETA  4                  IND. FIELD NAME IN IJBPUB    @D36ZDWK 06100004
         AIF   ('&DISP'(1,4) EQ 'IJBP').CHDISE                 @D14ZDWK 06110004
&TDISP   SETA  5                  INDICATE NUMERIC VALUE       @D36ZDWK 06120004
.CHDISE  ANOP                                                  @D21LDRP 06130004
.********************************************************************** 06140004
.*                                                                      06150004
.* CHECK SEL  OPERAND.                                                  06160004
.*                                                                      06170004
.********************************************************************** 06180004
.CHSEL   ANOP                                                           06190004
&TOPE    SETC  'SEL'                       INITIALIZE          @D21LDRP 06200004
&GO      SETA  1                            FOR MNOTE          @D21LDRP 06210004
         AIF   (T'&SEL EQ 'O').CHSEL1      SEL OMITTED         @D35EDWK 06220004
         AIF   (NOT &SELSW).NOTE4     BRANCH IF SEL NOT ALLOWED@D21LDRP 06230004
&TSEL    SETA  1                           INDICATE SEL        @D35EDWK 06240004
         AGO   .CHSELE                CONTINUE WITH NEXT PARAM.@D21LDRP 06250004
.CHSEL1  ANOP                              SEL NOT SPECIFIED   @D35EDWK 06260004
         AIF   (&SELRSW).NOTE1         BRANCH IF SEL REQUIRED  @D21LDRP 06270004
         AIF   (NOT &LPEXCL).CHSELE   SEL OR SEP REQUIRED      @D21LDRP 06280004
&SEPRSW  SETB  1                  YES, INDICATE SEP REQ. NOW   @D21LDRP 06290004
.CHSELE  ANOP                                                  @D21LDRP 06300004
.********************************************************************** 06310004
.*                                                                      06320004
.* CHECK SEP  OPERAND.                                                  06330004
.*                                                                      06340004
.********************************************************************** 06350004
.CHSEP   ANOP                                                           06360004
&GO      SETA  2                           INITIALIZE FOR      @D21LDRP 06370004
&TOPE    SETC  'SEP'                        MNOTE              @D21LDRP 06380004
         AIF   (T'&SEP EQ 'O').CHSEP1      SEP OMITTED         @D35EDWK 06390004
         AIF   (NOT &SEPSW).NOTE4    MNOTE IF SEP NOT ALLOWED  @D21LDRP 06400004
&TSEP    SETA  1                           INDICATE SEP        @D14CDWK 06410004
         AIF   (&TSEL EQ 0).CHSEPE         SEL NOT SPECIFIED   @D35EDWK 06420004
         AIF   (&LPUEXCL).NOTE8      SEL, SEP, PU MUTUAL EXCL. @D21LDRP 06430004
         AIF   (&LPEXCL).NOTE5       SEL, SEP MUTUAL EXCL.     @D21LDRP 06440004
         AGO   .CHSEPE               CONTINUE WITH NEXT PARAM. @D21LDRP 06450004
.CHSEP1  ANOP                              SEP REQUIRED        @D35EDWK 06460004
&TOPE    SETC  'SEL- OR SEP'                                   @D35EDWK 06470004
         AIF   (&SEPRSW).NOTE1       MNOTE, SEP OR SEL REQUIRED@D21LDRP 06480004
.CHSEPE  ANOP                                                  @D21LDRP 06490004
.**************************************************************@D14CDWK 06500004
.*                                                             @D14CDWK 06510004
.* CHECK PU OPERAND                                            @D14CDWK 06520004
.*                                                             @D14CDWK 06530004
.**************************************************************@D14CDWK 06540004
.CHPU    ANOP                              CHECK PU OPERAND    @D14CDWK 06550004
&TOPE    SETC  'PU'                        INITIALIZE FOR      @D21LDRP 06560004
&GO      SETA  7                            MNOTE              @D21LDRP 06570004
         AIF   (T'&PU EQ 'O').CHPU2                            @D21LDRP 06580004
         AIF   (NOT &PUSW).NOTE4   MNOTE, IF PU NOT ALLOWED    @D21LDRP 06590004
         AIF   ((&TSEL EQ 1 OR &TSEP EQ 1) AND &LPUEXCL).NOTE8 @D21LDRP 06600004
&TPU     SETA  1                  INDICATE PU SPECIFIED        @D21LDRP 06610004
         AGO   .CHPUE               CONTINUE WITH NEXT PARAM.  @D14CDWK 06620004
.CHPU2   ANOP                                                  @D14CDWK 06630004
         AIF   (&TSEL EQ 0 AND &TSEP EQ 0 AND &LPUEXCL).NOTE7  @D21LDRP 06640004
.CHPUE   ANOP                                                  @D21LDRP 06650004
.********************************************************************** 06660004
.*                                                                      06670004
.* CHECK PID  OPERAND.                                                  06680004
.*                                                                      06690004
.********************************************************************** 06700004
.CHPID   ANOP                              CHECK PID OPERAND   @D35EDWK 06710004
&GO      SETA  3                     INITIALIZE FOR            @D21LDRP 06720004
&TOPE    SETC  'PID'                   MNOTE                   @D21LDRP 06730004
         AIF   (T'&PID EQ 'O').CHPIDE      OMITTED CHECK NEXT  @D35EDWK 06740004
         AIF   (NOT &PIDSW).NOTE4    MNOTE, IF PID NOT ALLOWED @D21LDRP 06750004
         AIF   (&TSEL EQ 1).CHPID1         PID AND SEL OK      @D21LDRP 06760004
&TOPE    SETC  'SEP GIVEN : PID'          SET MNOTE TEXT       @D21LDRP 06770004
         AIF   (&TSEP EQ 1 ).NOTE4        ERROR, SEP AND PID   @D21LDRP 06780004
&TOPE    SETC  'PU GIVEN : PID'           SET MNOTE TEXT       @D21LDRP 06790004
         AIF   (&TPU EQ 1).NOTE4          ERROR, PU AND PID    @D21LDRP 06800004
.CHPID1  ANOP                                                  @D21LDRP 06810004
&TPID    SETA  1                           YES INDICATE PID    @D35EDWK 06820004
.CHPIDE  ANOP                                                  @D21LDRP 06830004
.********************************************************************** 06840004
.*                                                                      06850004
.* CHECK MODE OPERAND.                                                  06860004
.*                                                                      06870004
.********************************************************************** 06880004
.CHMOD   ANOP                              CHECK MODE OPERAND  @D35EDWK 06890004
&GO      SETA  5                           INITIALIZE FOR      @D21LDRP 06900004
&TOPE    SETC  'MODE'                       MNOTE              @D21LDRP 06910004
         AIF   (T'&MODE EQ 'O').CHMOD1     MODE OMITTED        @D35EDWK 06920004
         AIF   (NOT &MODESW).NOTE4   MNOTE, IF MODE NOT ALLOWED@D61DDEM 06930004
         AIF   ('&ID' NE 'BDY').CHMOD2     IS IT FOR BOUNDARY? @D51IDGL 06940004
         AIF   ('&MODE' EQ 'T').CHMOD1     MODE = T            @D35EDWK 06950004
         AIF   ('&MODE' EQ 'S').NOTE9      MODE = S, ILLEGAL   @D51IDGL 06960004
&TFLAG   SETA  3                           INDICATE MODE = P   @D51IDGL 06970004
         AIF   ('&MODE' EQ 'P').CHMODE     MODE = P,           @D51IDGL 06980004
&TFLAG   SETA  4                           INDICATE MODE = SYSP@D51IDGL 06990004
         AIF   ('&MODE' EQ 'SYSP').CHMODE  FOUND IT            @D51IDGL 07000004
&TFLAG   SETA  5                           INDICATE MODE = TEMP@SUPSERV 07010004
         AIF   ('&MODE' EQ 'TEMP').CHMOD1  FOUND IT            @SUPSERV 07020004
&TFLAG   SETA  6                           INDICATE MODE = PERM@SUPSERV 07030004
         AIF   ('&MODE' NE 'PERM').NOTE2   FOUND IT            @SUPSERV 07040004
         AGO   .CHMODE                                         @D51IDGL 07050004
.CHMOD1  ANOP                              CHECK IF            @D35EDWK 07060004
         AIF   ('&ID' EQ 'SAINFO').NOTEA   MODE OPERAND REQU.  @D61DDGL 07070004
         AIF   ('&ID' NE 'BDY').CHMODE     BDY AND PID GIVEN,  @D21LDRP 07080004
         AIF   (&TPID EQ 1).NOTE6          MODE=T NOT ALLOWED  @D21LDRP 07090004
         AGO   .CHMODE                                         @D51IDGL 07100004
.*                                                             @D51IDGL 07110004
.CHMOD2  AIF   ('&ID' NE 'GETVIS').CHMOD3  IS IT FOR GETVIS?   @D51IDGL 07120004
&TFLAG   SETA  1                           SET TO PARTITION    @D51IDGL 07130004
         AIF   ('&MODE' EQ 'PT').CHMODE                        @D51IDGL 07140004
&TFLAG   SETA  2                           SET TO SPACE        @D51IDGL 07150004
         AIF   ('&MODE' EQ 'SP').CHMODE                        @D51IDGL 07160004
&TFLAG   SETA  4                           SET TO SVA GETVIS   @D51IDGL 07170004
         AIF   ('&MODE' NE 'SV').NOTE4                         @D51IDGL 07180004
         AGO   .CHMODE                                         @D51EMGL 07190004
.*                                                             @D51EMGL 07200004
.CHMOD3  AIF   ('&ID' NE 'CPUID').CHMOD4   IS IT FOR CPUID?    @D51EMGL 07210004
&TFLAG   SETA  1                           IS IT MODE REAL?    @D51EMGL 07220004
         AIF   ('&MODE' EQ 'REAL').CHMODE                      @D51EMGL 07230004
&TFLAG   SETA  0                           ANYTHING ELSE INV.  @D51EMGL 07240004
         AGO   .NOTE2                                          @D51EMGL 07250004
.*                                                             @D61DDGL 07260004
.CHMOD4  AIF   ('&ID' NE 'SAINFO').NOTE4   IS IT FOR SAINFO?   @D61DDGL 07270004
&TFLAG   SETA  3                           SET TO PUBDEVTY     @D61DDGL 07280004
         AIF   ('&MODE' EQ 'PUBDEVTY').CHMODE                  @D61DDGL 07290004
&TFLAG   SETA  4                           SET TO EXTCODE      @D61DDGL 07300004
         AIF   ('&MODE' EQ 'EXTCODE').CHMODE                   @D61DDGL 07310004
         AGO   .NOTE2                                          @D61DDGL 07320004
.CHMODE  ANOP                                                  @D21LDRP 07330004
.**************************************************************@D14NDWK 07340004
.*                                                             @D14NDWK 07350004
.* CHECK SID  OPERAND.                                         @D14NDWK 07360004
.*                                                             @D14NDWK 07370004
.**************************************************************@D14NDWK 07380004
.CHSID   ANOP                              CHECK SID OPERAND   @D14NDWK 07390004
&GO      SETA  6                           INITIALIZE FOR      @D21LDRP 07400004
&TOPE    SETC  'SID'                        MNOTE              @D21LDRP 07410004
         AIF   (T'&SID EQ 'O').CHSIDE      SID OMITTED         @D14CDWK 07420004
         AIF   ('&ID' NE 'MAP').NOTE4      SID ONLY VALID WITH MAP     *07430004
                                                               @D21LDRP 07440004
&TSID    SETA  1                           INDICATE SID        @D14NDWK 07450004
.CHSIDE  ANOP                                                  @D21LDRP 07460004
.********************************************************************** 07470004
.*                                                                      07480004
.* CHECK VALIDITY OF LOC OPERAND                               @SUPSERV 07490004
.*                                                                      07500004
.********************************************************************** 07510004
.CHLOC   ANOP                                                  @SUPSERV 07520004
&GO      SETA  8                           INITIALIZE FOR      @SUPSERV 07530004
&TOPE    SETC  'LOC'                        MNOTE              @SUPSERV 07540004
         AIF   (T'&LOC EQ 'O').CHLOCE      LOC OMITTED         @SUPSERV 07550004
         AIF   ('&ID' NE 'GETVIS').NOTE4   ERROR IF NOT GETVIS @SUPSERV 07560004
.*                                         LOC=RES IS DEFAULT  @SUPSERV 07570004
         AIF   ('&LOC' EQ 'RES').CHLOCE                        @SUPSERV 07580004
&TFLAG   SETA  &TFLAG+16                   INDICATE LOC=BELOW  @SUPSERV 07590004
         AIF   ('&LOC' EQ 'BELOW').CHLOCE                      @SUPSERV 07600004
&TFLAG   SETA  &TFLAG+16                   INDICATE LOC=ANY    @SUPSERV 07610004
.CHLOCE  ANOP                                                  @SUPSERV 07620004
.********************************************************************** 07630004
.*                                                                      07640004
.* CHECK VALIDITY OF RESET OPERAND                             @DY45817 07650004
.*                                                                      07660004
.********************************************************************** 07670004
.CHRSET  ANOP                                                  @DY45817 07680004
&GO      SETA  9                           INITIALIZE FOR      @DY45817 07690004
&TOPE    SETC  'RESET'                     MNOTE               @DY45817 07700004
         AIF   (T'&RESET EQ 'O').CHRSETE   RESET OMITTED       @DY45817 07710004
         AIF   ('&ID' NE 'PART').NOTE4     ERROR IF NOT PART   @DY45817 07720004
         AIF   ('&RESET' EQ 'NO').CHRSETE                      @DY45817 07730004
         AIF   ('&RESET' EQ 'YES').CHRSET0                     @DY45817 07740004
         MNOTE 1,'INVALID OPTION SPECIFIED FOR RESET --- NO ASSUMED'    07750004
         AGO   .CHRSETE                                                 07760004
.CHRSET0 ANOP                                                  @DY45817 07770004
&TFLAG   SETA  &TFLAG+64                   INDICATE RESET=YES  @DY45817 07780004
.CHRSETE ANOP                                                  @DY45817 07790004
.********************************************************************** 07800004
.*                                                                      07810004
.* CHECK IF USERAREA FOR PARAMETER-LIST GIVEN  (MFG=OPERAND)            07820004
.*                                                                      07830004
.********************************************************************** 07840004
.CHMFG   ANOP                                                           07850004
         AIF   (T'&MFG EQ 'O').NOMFG       NO MFG-PARM,BUILD INLINECODE 07860004
&NAME    DS    0H                          MACRO ALIGNMENT              07870004
         AIF   ('&MFG'(1,3) EQ '(S,').SMFG S-TYPE FORMAT       @D35EDWK 07880004
         AIF   ('&MFG'(1,1) EQ '(').RMFG   REGISTER FORMAT              07890004
&TADDR   SETC  '+'.'&MFG'                  USERAREA ADDRESSED BY VAR.   07900004
         MVC   &MFG.(20),IJBX&SYSNDX       MOVE PARMLIST       @D35EDWK 07910004
&TMFG    SETA  1                                                        07920004
         AGO   .HLEN                                                    07930004
.SMFG    ANOP                              S-TYPE FORMAT       @D35EDWK 07940004
&TADDR   SETC  '+'.'&MFG(2)'               USERAREA ADDRESS    @D35EDWK 07950004
         MVC   &MFG(2).(20),IJBX&SYSNDX    MOVE PARMLIST       @D35EDWK 07960004
&TMFG    SETA  2                                               @D35EDWK 07970004
         AGO   .HLEN                                           @D35EDWK 07980004
.RMFG    ANOP                                                           07990004
         AIF   ('&MFG' EQ '(1)').R1MFG     REGISTER  GIVEN              08000004
&TADDR   SETC  '&MFG'                      USERAREA ADDRESSED BY REG    08010004
         MVC   0(20,&MFG(1)),IJBX&SYSNDX   MOVE PARMLIST       @D35EDWK 08020004
&TMFG    SETA  3                                               @D35EDWK 08030004
         AGO   .HLEN                                                    08040004
.R1MFG   ANOP                                                           08050004
&TADDR   SETC  '&MFG'                      USERAREA ADDRESSED BY REG1   08060004
         MVC   0(20,&MFG(1)),IJBX&SYSNDX   MOVE PARMLIST       @D35EDWK 08070004
&TMFG    SETA  4                                               @D35EDWK 08080004
         AGO   .HLEN                                                    08090004
.********************************************************************** 08100004
.*                                                                      08110004
.*  MACRO DIAGNOSTICS: MNOTES 1 TO 8                           @D149DWK 08120004
.*                                                                      08130004
.********************************************************************** 08140004
.NOTE1   MNOTE 8,'&TOPE-OPERAND NOT GIVEN,GENERATION SUPPRESSED'        08150004
         MEXIT                                                 @D35EDWK 08160004
.NOTE2   MNOTE 8,'UNKNOWN &TOPE-OPERAND GIVEN,GENERATION SUPPRESSED'    08170004
         MEXIT                                                 @D35EDWK 08180004
.NOTE3   MNOTE 8,'&TOPE-OPERAND IS S-TYPE,GENERATION SUPPRESSED'        08190004
         MEXIT                                                 @D35EDWK 08200004
.NOTE4   MNOTE 1,'&TOPE-OPERAND IGNORED FOR ID=&ID'            @D35EDWK 08210004
         AIF   (&GO EQ 1).CHSELE           CONT. AFTER SEL     @D21LDRP 08220004
         AIF   (&GO EQ 2).CHSEPE           CONT. AFTER SEP     @D21LDRP 08230004
         AIF   (&GO EQ 3).CHPIDE           CONT. AFTER PID     @D21LDRP 08240004
         AIF   (&GO EQ 4).CHDISE           CONT. AFTER DISP    @D21LDRP 08250004
         AIF   (&GO EQ 5).CHMODE           CONT. AFTER MODE    @D21LDRP 08260004
         AIF   (&GO EQ 6).CHSIDE           CONTINUE AFTER SID  @D21LDRP 08270004
         AIF   (&GO EQ 7).CHPUE            CONT. AFTER PU      @D21LDRP 08280004
         AIF   (&GO EQ 8).CHLOCE           CONT. AFTER LOC     @SUPSERV 08290004
         AIF   (&GO EQ 9).CHRSETE          CONT. AFTER RESET   @DY45817 08300004
         MEXIT                                                 @D35EDJO 08310004
.NOTE5   MNOTE 8,'SEL- AND SEP-OPERAND GIVEN,GENERATION SUPPRESSED'     08320004
         MEXIT                             YES MNOTE AND EXIT  @D35EDWK 08330004
.NOTE6   MNOTE 8,'PID-OPERAND NOT ALLOWED FOR DEFAULT MODE=T. GENERATIO*08340004
               N SUPPRESSED.'                                  @D61DDEM 08350004
         MEXIT                                                 @D35EDWK 08360004
.NOTE7   MNOTE 8,'SEL-,SEP- OR PU- OPERAND NOT GIVEN,GENERATION SUPPRES*08370004
               SED'                                            @D14CDWK 08380004
         MEXIT                             EXIT                @D14CDWK 08390004
.NOTE8   MNOTE 8,'SEL-,SEP- AND PU-OPERAND ARE MUTUAL EXCLUSIVE, GENERA*08400004
               TION SUPPRESSED'                                @D14CDWK 08410004
         MEXIT                             EXIT                @D14CDWK 08420004
.NOTE9   MNOTE 8,'ID=BDY,MODE=S NO LONGER SUPPORTED. GENERATION SUPPRES*08430004
               SED'                                            @D51IDGL 08440004
         MEXIT                             EXIT                @D51IDGL 08450004
.NOTEA   MNOTE 8,'MODE=PUBDEVTY OR MODE=EXTCODE REQUIRED. GENERATION   *08460004
               SUPPRESSED'                                     @D51IDGL 08470004
         MEXIT                             EXIT                @D51IDGL 08480004
.********************************************************************** 08490004
.*                                                                      08500004
.*  END OF DIAGNOSTIC PATH, START OF CODE GENERATION           @D149DWK 08510004
.*                                                                      08520004
.********************************************************************** 08530004
.NOMFG   ANOP                                                           08540004
         CNOP  0,4                         MACRO ALIGNMENT     @D35EDWK 08550004
         AIF   (T'&NAME EQ 'O').NONAM      NO MACRO LABEL      @D355DWK 08560004
&NAME    EQU   *                                               @D35EDWK 08570004
.NONAM   ANOP                                                  @D35EDWK 08580004
&TADDR   SETC  '+IJBX'.'&SYSNDX'                                        08590004
&TMFG    SETA  0                                                        08600004
.********************************************************************** 08610004
.*                                                                      08620004
.* CHECK AND SET LEN PARAMETER                                          08630004
.*                                                                      08640004
.********************************************************************** 08650004
.HLEN    ANOP                                                           08660004
&TOFF    SETA  4                                                        08670004
         AIF   ('&LEN'(1,1) EQ '(').RLEN   REGISTER FORM                08680004
&TLEN    SETA  1                           INDICATE VARIABLE PARM       08690004
         AGO   .HDISP                                                   08700004
.RLEN    ANOP                                                           08710004
         STH   &LEN(1),&TOFF.&TADDR        STORE LENGTH                 08720004
.********************************************************************** 08730004
.*                                                                      08740004
.* CHECK AND SET DISP PARAMETER                                         08750004
.*                                                                      08760004
.********************************************************************** 08770004
.HDISP   ANOP                                                           08780004
&TOFF    SETA  6                                                        08790004
         AIF   ('&ID' NE 'DVTY').CDISP                         @D35EDJO 08800004
&DISPA   SETA  0                         ELIMINATE CHANGES BY  @D51MDGL 08810004
&TDISP   SETA  2                         JO AGAIN ....         @D35EDJO 08820004
         AGO   .HAREA                                          @D35EDJO 08830004
.CDISP   ANOP                                                           08840004
         AIF   (&TDISP NE 1).HAREA                                      08850004
         STH   &DISP(1),&TOFF.&TADDR       STORE DISPLACEMENT           08860004
.********************************************************************** 08870004
.*                                                                      08880004
.* EVALUATE AND SET AREA PARAMETER                                      08890004
.*                                                                      08900004
.********************************************************************** 08910004
.HAREA   ANOP                                                           08920004
&TOFF    SETA  8                                                        08930004
         AIF   ('&AREA'(1,3) EQ '(S,').SAR S-TYPE FORMAT       @D35EDWK 08940004
         AIF   ('&AREA'(1,1) EQ '(').RAR   REGISTER FORM                08950004
&TAR     SETA  1                           INDICATE VARIABLE PARM       08960004
         AGO   .HSEL                                                    08970004
.RAR     ANOP                                                           08980004
         ST    &AREA(1),&TOFF.&TADDR       STORE AREA ADDRESS           08990004
         AGO   .HSEL                                           @D35EDWK 09000004
.SAR     ANOP                              S-TYPE FORMAT       @D35EDWK 09010004
         LA    0,&AREA(2)                  LOAD AND            @D35EDWK 09020004
         ST    0,&TOFF.&TADDR              STORE AREA ADDRESS  @D35EDWK 09030004
.********************************************************************** 09040004
.*                                                                      09050004
.* EVALUATE AND SET SEL PARAMETER                                       09060004
.*                                                                      09070004
.********************************************************************** 09080004
.HSEL    ANOP                                                           09090004
&TOFF    SETA  12                                                       09100004
         AIF   (&TSEL EQ 0 ).HSELE                             @D21LDRP 09110004
&TFLAG   SETA  0                           SET FLAG FOR LOGICAL UNIT    09120004
         AIF   ('&SEL'(1,3) EQ '(S,').SSEL S-TYPE FORMAT       @D35EDWK 09130004
         AIF   ('&SEL'(1,1) EQ '(').RSEL   REGISTER FORM                09140004
         AGO   .HSELE                      CHECK NEXT OPERAND  @D21LDRP 09150004
.RSEL    ANOP                                                           09160004
         ST    &SEL(1),&TOFF.&TADDR        STORE SEL-ADDRESS            09170004
         AGO   .HSEL1                      GO CHECK NEXT OPER. @D21LDRP 09180004
.SSEL    ANOP                              S-TYPE FORMAT       @D35EDWK 09190004
         LA    0,&SEL(2)                   LOAD AND            @D35EDWK 09200004
         ST    0,&TOFF.&TADDR              STORE SEL ADDRESS   @D35EDWK 09210004
.HSEL1   ANOP                                                  @D21LDRP 09220004
&TSEL    SETA  2                           INDICATE SEL SET    @D21LDRP 09230004
.HSELE   ANOP                                                  @D21LDRP 09240004
.* FROM HERE ON &TSEL=0 INDICATES SEL NOT SPECIFIED OR IGNORED @D21LDRP 09250004
.*              &TSEL=1 INDICATES SEL SPECIFIED AS NAME        @D21LDRP 09260004
.*              &TSEL=2 INDICATES SEL VALUE ALREADY SET        @D21LDRP 09270004
.********************************************************************** 09280004
.*                                                                      09290004
.* EVALUATE AND SET SEP PARAMETER                                       09300004
.*                                                                      09310004
.********************************************************************** 09320004
.HSEP    ANOP                                                           09330004
         AIF   (&TSEP EQ 0).HSEPE          SKIP SEP SETTING    @D21LDRP 09340004
&TFLAG   SETA  1                           INDICATE PHYSICAL UNIT       09350004
         AIF   ('&SEP'(1,3) EQ '(S,').SSEP S-TYPE FORMAT       @D35EDWK 09360004
         AIF   ('&SEP'(1,1) EQ '(').RSEP   REGISTER FORM                09370004
         AGO   .HSEPE                      GOTO NEXT OPERAND   @D21LDRP 09380004
.RSEP    ANOP                                                           09390004
         ST    &SEP(1),&TOFF.&TADDR        STORE SEP-ADDRESS            09400004
         AGO   .HSEP1                      GOTO NEXT OPERAND   @D21LDRP 09410004
.SSEP    ANOP                              S-TYPE FORMAT       @D35EDWK 09420004
         LA    0,&SEP(2)                   LOAD AND            @D35EDWK 09430004
         ST    0,&TOFF.&TADDR              STORE SEP ADDRESS   @D35EDWK 09440004
.HSEP1   ANOP                                                  @D21LDRP 09450004
&TSEP    SETA  2                           IND. SEP HANDLED    @D35EDWK 09460004
.HSEPE   ANOP                                                  @D21LDRP 09470004
.* FROM HERE ON &TSEP=0 INDICATES SEP NOT SPECIFIED OR IGNORED @D21LDRP 09480004
.*              &TSEP=1 INDICATES SEP SPECIFIED AS NAME        @D21LDRP 09490004
.*              &TSEP=2 INDICATES SEP VALUE ALREADY SET        @D21LDRP 09500004
.**************************************************************@D14CDWK 09510004
.*                                                             @D14CDWK 09520004
.* EVALUATE AND SET PU PARAMETER                               @D14CDWK 09530004
.*                                                             @D14CDWK 09540004
.**************************************************************@D14CDWK 09550004
.HPU     ANOP                                                  @D14CDWK 09560004
         AIF   (&TPU EQ 0).HPUE            SKIP PU SETTING     @D21LDRP 09570004
&TFLAG   SETA  2                           INDICATE PUB INDEX  @D14CDWK 09580004
         AIF   ('&PU'(1,3) EQ '(S,').SPU   S-TYPE FORMAT       @D14CDWK 09590004
         AIF   ('&PU'(1,1) EQ '(').RPU     REGISTER FORM       @D14CDWK 09600004
         AGO   .HPUE                                           @D21LDRP 09610004
.RPU     ANOP                                                  @D14CDWK 09620004
         ST    &PU(1),&TOFF.&TADDR         ADDRESS OF PUB-INDEX@D14CDWK 09630004
         AGO   .HPU1                                           @D21LDRP 09640004
.SPU     ANOP                              S-TYPE FORMAT       @D14CDWK 09650004
         LA    0,&PU(2)                    LOAD AND STORE      @D14CDWK 09660004
         ST    0,&TOFF.&TADDR              ADDRESS OF PUB-INDEX@D14CDWK 09670004
.HPU1    ANOP                                                  @D21LDRP 09680004
&TPU     SETA  2                           IND. PU HANDLED     @D21LDRP 09690004
.HPUE    ANOP                                                  @D21LDRP 09700004
.* FROM HERE ON &TPU=0 INDICATES PU NOT SPECIFIED OR IGNORED   @D21LDRP 09710004
.*              &TPU=1 INDICATES PU SPECIFIED AS NAME          @D21LDRP 09720004
.*              &TPU=2 INDICATES PU VALUE ALREADY SET          @D21LDRP 09730004
.********************************************************************** 09740004
.*                                                                      09750004
.* EVALUATE AND SET PID PARAMETER                                       09760004
.*                                                                      09770004
.********************************************************************** 09780004
.HPID    ANOP                                                  @D14CDWK 09790004
&TOFF    SETA  16                                                       09800004
         AIF   (&TPID EQ 0).HPIDE          SKIP IF NO PID      @D21LDRP 09810004
         AIF   ('&PID'(1,3) EQ '(S,').SPID S-TYPE FORMAT       @D35EDWK 09820004
         AIF   ('&PID'(1,1) EQ '(').RPID   REGISTER FORM                09830004
         AGO   .HPIDE                                          @D21LDRP 09840004
.RPID    ANOP                                                           09850004
         ST    &PID(1),&TOFF.&TADDR        STORE ADDRESS OF PIK         09860004
         AGO   .HPID1                                          @D21LDRP 09870004
.SPID    ANOP                              S-TYPE FORMAT       @D35EDWK 09880004
         LA    0,&PID(2)                   LOAD AND            @D35EDWK 09890004
         ST    0,&TOFF.&TADDR              STORE PID ADDRESS   @D35EDWK 09900004
.HPID1   ANOP                                                  @D21LDRP 09910004
&TPID    SETA  2                           IND. PID SET        @D35EDWK 09920004
.HPIDE   ANOP                                                  @D21LDRP 09930004
.* FROM HERE ON &TPID=0 INDICATES PID NOT SPECIFIED OR IGNORED @D21LDRP 09940004
.*              &TPID=1 INDICATES PID SPECIFIED AS NAME        @D21LDRP 09950004
.*              &TPID=2 INDICATES PID VALUE ALREADY SET        @D21LDRP 09960004
.**************************************************************@D14NDWK 09970004
.*                                                             @D14NDWK 09980004
.* EVALUATE AND SET SID PARAMETER                              @D14NDWK 09990004
.*                                                             @D14NDWK 10000004
.**************************************************************@D14NDWK 10010004
.HSID    ANOP                              IF NOT              @D14NDWK 10020004
&TOFF    SETA  16                                              @D14NDWK 10030004
         AIF   (&TSID EQ 0).GENBR          SID OMITTED         @D14NDWK 10040004
         AIF   ('&SID'(1,3) EQ '(S,').SSID S-TYPE FORMAT       @D14NDWK 10050004
         AIF   ('&SID'(1,1) EQ '(').RSID   REGISTER FORM       @D14NDWK 10060004
         AGO   .HSIDE                                          @D21LDRP 10070004
.RSID    ANOP                                                  @D14NDWK 10080004
         ST    &SID(1),&TOFF.&TADDR        ADDRESS OF SPACE ID @D14NDWK 10090004
         AGO   .HSID1                                          @D21LDRP 10100004
.SSID    ANOP                              S-TYPE FORMAT       @D14NDWK 10110004
         LA    0,&SID(2)                   LOAD AND            @D14NDWK 10120004
         ST    0,&TOFF.&TADDR              ADDRESS OF SPACE ID @D14NDWK 10130004
.HSID1   ANOP                                                  @D21LDRP 10140004
&TSID    SETA  2                           INDICATE SID SET    @D14NDWK 10150004
.HSIDE   ANOP                                                  @D21LDRP 10160004
.* FROM HERE ON &TSID=0 INDICATES SID NOT SPECIFIED OR IGNORED @D21LDRP 10170004
.*              &TSID=1 INDICATES SID SPECIFIED AS NAME        @D21LDRP 10180004
.*              &TSID=2 INDICATES SID VALUE ALREADY SET        @D21LDRP 10190004
.********************************************************************** 10200004
.*                                                                      10210004
.* GENERATE BRANCH INSTRUCTION                                          10220004
.*                                                                      10230004
.********************************************************************** 10240004
.GENBR   ANOP                                                           10250004
&BADDR   SETC  'IJBX'.'&SYSNDX'.'+20'                          @D35EDWK 10260004
         AIF   (&TMFG NE 0).BR1                                         10270004
         BAL   1,&BADDR                    LOAD PARMLIST ADDR & BRANCH  10280004
         AGO   .GENCON                                                  10290004
.BR1     ANOP                                                           10300004
         AIF   (&TMFG NE 1).BR2                                         10310004
         LA    1,&MFG                      LOAD PARMLIST ADDR.          10320004
         AGO   .BR4                                            @D35EDWK 10330004
.BR2     ANOP                                                  @D35EDWK 10340004
         AIF   (&TMFG NE 2).BR3                                @D35EDWK 10350004
         LA    1,&MFG(2)                   LOAD PARMLIST ADDR. @D35EDWK 10360004
         AGO   .BR4                                            @D35EDWK 10370004
.BR3     ANOP                                                  @D35EDWK 10380004
         AIF   (&TMFG NE 3).BR4                                @D35EDWK 10390004
         LR    1,&MFG(1)                   LOAD PARMLIST ADDR.          10400004
.BR4     B     &BADDR                      BRANCH AROUND PARMLIST       10410004
.********************************************************************** 10420004
.*                                                                      10430004
.* GENERATE CONSTANTS                                                   10440004
.*                                                                      10450004
.********************************************************************** 10460004
.GENCON  ANOP                                                           10470004
IJBX&SYSNDX DC    AL1(&TID)                ID-FLAG             @D35EDWK 10480004
         DC    AL1(&TFLAG)                 FLAG FIELD          @D35EDWK 10490004
         DC    AL2(0)                      RESERVED                     10500004
         AIF   (&TLEN EQ 1).GC10                                        10510004
         DC    AL2(0)                      LENGTH OF AREA               10520004
         AGO   .GC20                                                    10530004
.GC10    ANOP                                                           10540004
         DC    AL2(&LEN)                   LENGTH OF AREA               10550004
.GC20    ANOP                                                           10560004
         AIF   (&TDISP GT 1).GC21                                       10570004
         DC    AL2(0)                      DISPLACEMENT                 10580004
         AGO   .GC30                                                    10590004
.GC21    ANOP                                                           10600004
         AIF   (&TDISP GT 2).GC22                              @D35EDJO 10610004
         DC    AL2(&DISPA)                 DISPL.IN PUB OR PUB2 TABLE   10620004
         AGO   .GC30                                           @D35EDJO 10630004
.GC22    ANOP                                                  @D35EDJO 10640004
         AIF   (&TDISP GT 3).GC23                              @D35EDWK 10650004
         DC    AL2(&DISPC-PUBADR)          DISPL.IN PUB TABLE  @D35EDJO 10660004
         AGO   .GC30                                           @D35EDJO 10670004
.GC23    ANOP                                                  @D36ZDWK 10680004
         AIF   (&TDISP GT 4).GC24                              @D36ZDWK 10690004
         DC    AL2(&DISPC-IJBPUB)          DISPL.IN PUB TABLE  @D36ZDWK 10700004
         AGO   .GC30                                           @D36ZDWK 10710004
.GC24    DC    AL2(&DISP)                  DISPL.IN PUB / PUB2 @D36ZDWK 10720004
.GC30    ANOP                                                           10730004
         AIF   (&TAR EQ 1).GC31                                         10740004
         DC    AL4(0)                      AREA ADDRESS                 10750004
         AGO   .GC40                                                    10760004
.GC31    ANOP                                                           10770004
         DC    AL4(&AREA)                  AREA ADDRESS                 10780004
.GC40    ANOP                                                           10790004
         AIF   (&TSEL EQ 0).GC43        IF NO LOGICAL UNIT     @D21LDRP 10800004
         AIF   (&TSEL EQ 1).GC42                                        10810004
         DC    AL4(0)                      LOGICAL UNIT ADDRESS         10820004
         AGO   .GC60                                                    10830004
.GC42    ANOP                                                           10840004
         DC    AL4(&SEL)                   LOGICAL UNIT ADDRESS         10850004
         AGO   .GC60                                                    10860004
.GC43    ANOP                                                  @D355DWK 10870004
         AIF   (&TSEP EQ 0 ).GC50          IF NO PHYSICAL UNIT @D21LDRP 10880004
         AIF   (&TSEP EQ 1).GC44                               @D355DWK 10890004
         DC    AL4(0)                      PHYSICAL UNIT ADDRESS        10900004
         AGO   .GC60                                                    10910004
.GC44    ANOP                                                  @D355DWK 10920004
         DC    AL4(&SEP)                   PHYSICAL UNIT ADDRESS        10930004
         AGO   .GC60                                           &D14CDWK 10940004
.GC50    ANOP                              SET PU              &D14CDWK 10950004
         AIF   (&TPU EQ 1).GC51            PU MUST BE SET      &D14CDWK 10960004
         DC    AL4(0)                      PUB INDEX ADDRESS   &D14CDWK 10970004
         AGO   .GC60                                           &D14CDWK 10980004
.GC51    ANOP                                                  &D14CDWK 10990004
         DC    AL4(&PU)                    PUB INDEX ADDRESS   &D14CDWK 11000004
.GC60    ANOP                                                           11010004
         AIF   (&TPID EQ 0).GC70       IF NO PID               @D21LDRP 11020004
         AIF   (&TPID EQ 1).GC61                                        11030004
         DC    AL4(0)                      POINTER TO PIK               11040004
         AGO   .CLREGF                                                  11050004
.GC61    ANOP                                                           11060004
         DC    AL4(&PID)                   POINTER TO PIK               11070004
         AGO   .CLREGF                                         @D14NDWK 11080004
.GC70    ANOP                                                  @D14NDWK 11090004
         AIF   (&TSID NE 1).GC71                               @D21LDRP 11100004
         DC    AL4(&SID)                   ADDRESS OF SPACE ID @D14NDWK 11110004
         AGO   .CLREGF                                         @D14NDWK 11120004
.GC71    ANOP                                                  @D14NDWK 11130004
         DC    AL4(0)                      ADDR. OF SID OR PIK @D14NDWK 11140004
.CLREGF  ANOP                                                           11150004
         SR    15,15                       CLEAR RETURN CODE REGISTER   11160004
         SVC   98                          CALL SVC ROUTINE             11170004
         MEND                                                        */ 11180004
*%EXTRPLS : ;                                                           11190004
*%EXTRACT:  MACRO  KEYS(ID,                               /* @D35EDWK*/ 11200004
*                  AREA,                                  /* @D35EDWK*/ 11210004
*                  LEN,                                   /* @D35EDWK*/ 11220004
*                  DISP,                                  /* @D35EDWK*/ 11230004
*                  SEL,                                   /* @D35EDWK*/ 11240004
*                  SEP,                                   /* @D35EDWK*/ 11250004
*                  PU,                                    /* @D14CDWK*/ 11260004
*                  PID,                                   /* @D35EDWK*/ 11270004
*                  SID,                                   /* @D14NDWK*/ 11280004
*                  MODE,                                  /* @D35EDWK*/ 11290004
*                  LOC,                                   /* @D35EDWK*/ 11300004
*                  MFG);                                  /* @D35EDWK*/ 11310004
* /*******************************************************************/ 11320004
* /*                                                                 */ 11330004
* /*  LIST MACRO INVOCATION IN SOURCE                                */ 11340004
* /*                                                                 */ 11350004
* /*******************************************************************/ 11360004
*    ANS ('/* '||MACLABEL||' '||MACNAME||' '||MACLIST||' '||MACKEYS||   11370004
*         '*/') COL(MACLMAR);                                           11380004
* ANS ('/*                                                  */')        11390004
* COL(MACLMAR);                                                         11400004
* ANS ('/*     SUPERVISOR - EXTRACT - 5686-066-06-15G       */')        11410004
* COL(MACLMAR);                                                         11420004
* ANS ('/*                                                  */')        11430004
* COL(MACLMAR);                                                         11440004
* /*******************************************************************/ 11450004
* /*                                                                 */ 11460004
* /*  PLS PART OF EXTRACT MACRO . DESCRIPTION SEE ASM PART           */ 11470004
* /*                                                                 */ 11480004
* /*******************************************************************/ 11490004
*    DCL (IKEY,ILIST,CMFG,CDIS,IDIS)CHAR;  /*                        */ 11500004
*    DCL (CAR,CPID,CSEL,CLEN)CHAR;         /* DCL FOR VALUES @D14CDWK*/ 11510004
*    DCL (IID,IFLAG,IAR,IPID,ISEL,ILEN)CHAR;/*  DCL FOR INTERNAL     */ 11520004
*    DCL (IRES,IREG)CHAR;                  /*  USE                   */ 11530004
*    DCL (TID,TFLAG)FIXED;                 /*                        */ 11540004
*    DCL (IGO,N)FIXED;                     /*                @D35EDWK*/ 11550004
*    DCL (VID(14))CHAR;                    /* LEGAL IDS      @D21LDRP*/ 11560004
*    DCL (DISPSW,PIDSW,PUSW,SELSW,SEPSW,MODESW)FIXED; /*IN.SW@D21LDRP*/ 11570004
*    DCL (SELRSW,SEPRSW,LPEXCL,LPUEXCL)FIXED; /*INT. SWITCHES@D21LDRP*/ 11580004
*    DCL (TSEL,TSEP,TPU,TPID,TDISP)FIXED;     /*INT. SWITCHES@D21LDRP*/ 11590004
* /*******************************************************************/ 11600004
* /*                                                                 */ 11610004
* /* CHECK GIVEN ID                                          @D35EDWK*/ 11620004
* /*                                                                 */ 11630004
* /*******************************************************************/ 11640004
*    VID(1) = 'PUB2';                      /* PUB2 ID        @D35EDWK*/ 11650004
*    VID(2) = 'DVTY';                      /* DVTY ID        @D35EDWK*/ 11660004
*    VID(3) = 'BDY';                       /* BDY ID         @D35EDWK*/ 11670004
*    VID(4) = 'CR';                        /* CR ID          @D35EDWK*/ 11680004
*    VID(5) = 'PUB';                       /* PUB ID         @D35EDJO*/ 11690004
*    VID(6) = 'CPUID';                     /* CPUID ID       @D356DWK*/ 11700004
*    VID(7) = 'MAP';                       /* MAP ID         @D14NDWK*/ 11710004
*    VID(8) = 'DEVICE';                    /* DEVICE ID      @D14CDWK*/ 11720004
*    VID(9) = 'SENSE';                     /* SENSE ID       @D21LDRP*/ 11730004
*    VID(10) = 'GETVIS';                   /* GETVIS ID      @D21LDRP*/ 11740004
*    VID(11) = 'PART';                     /* PART ID        @D51IDGL*/ 11750004
*    VID(12) = 'SVA';                      /* SVA  ID        @D51MDGL*/ 11760004
*    VID(13) = 'SAINFO';                   /* SAINFO ID      @D61DDGL*/ 11770004
*    VID(14) = 'ATLCUU';                   /* ATLCUU ID      @D61DDGL*/ 11780004
*    IF NUMBER(ID) = 0  THEN               /* ID GIVEN               */ 11790004
*      DO;                                 /* NO                     */ 11800004
*        IKEY = 'ID';                      /* SET PARM FOR MNOTE     */ 11810004
*        GO TO MERR1;                      /* WRITE MNOTE            */ 11820004
*      END;                                /*                        */ 11830004
*                                          /*                        */ 11840004
* CHID:                                    /* CHECK & SET ID @D35EDWK*/ 11850004
*    N = N + 1;                            /* SET INDEX FOR  @D35EDWK*/ 11860004
*    IF N < 14+1 THEN DO;                  /* ID CHECK       @D61DDGL*/ 11870004
*      IF ID(1) = VID(N) THEN DO;          /* ID FOUND       @D35EDWK*/ 11880004
*        TID = N ;                         /* SET ID-FLAG    @D35EDWK*/ 11890004
*      END;                                /*                @D35EDGL*/ 11900004
*      ELSE DO;                            /*                @D35EDWK*/ 11910004
*        GO TO CHID;                       /* SEARCH NEXT    @D35EDWK*/ 11920004
*      END;                                /* END SEARCH     @D35EDWK*/ 11930004
*    END;                                  /*                @D35EDWK*/ 11940004
*    ELSE DO;                              /* NOT FOUND      @D35EDWK*/ 11950004
*      IKEY = 'ID-';                       /* SET IKEY       @D35EDWK*/ 11960004
* MERR4:                                   /* WRITE MNOTE    @D35EDWK*/ 11970004
* ANS MSG('INVALID IKEY OPERAND GIVEN,GENERATION SUPPRESSED;')RESCAN;   11980004
* ANS ('/* INVALID '||IKEY||' OPERAND GIVEN,GENERATION SUPPRESSED */')  11990004
*     RESCAN COL(MACLMAR);                                              12000004
* RETURN CODE(8);                          /* EXIT           @D35EDWK*/ 12010004
*      END;                                /*                @D35EDWK*/ 12020004
* /*******************************************************************/ 12030004
* /*                                                                 */ 12040004
* /*     SET INFORMATION ABOUT REQUIRED AND ALLOWED PARAMETERS       */ 12050004
* /*                                                                 */ 12060004
* /*******************************************************************/ 12070004
* IF TID = 1 THEN               /* IF ID = PUB2              @D21LDRP*/ 12080004
*   DO;                         /*   SET SWITCHES FOR PUB2   @D21LDRP*/ 12090004
*    PIDSW = 1;                 /* PID PARAMETER ALLOWED     @D21LDRP*/ 12100004
*    SELSW = 1;                 /* SEL PARAMETER ALLOWED     @D21LDRP*/ 12110004
*    PUSW = 1;                  /* PU PARAMETER ALLOWED      @D21LDRP*/ 12120004
*    SEPSW = 1;                 /* SEP PARAMETER ALLOWED     @D21LDRP*/ 12130004
*    LPUEXCL = 1;               /* SEL, SEP, PU MUTUAL EXCL. @D21LDRP*/ 12140004
*    DISPSW = 1;                /* DISP PARAMETER ALLOWED    @D21LDRP*/ 12150004
*   END;                                   /*                @D21LDRP*/ 12160004
* IF TID = 2 THEN               /* IF ID = DVTY              @D21LDRP*/ 12170004
*   DO;                         /*   SET SWITCHES FOR DVTY   @D21LDRP*/ 12180004
*    PIDSW = 1;                 /* PID PARAMETER ALLOWED     @D21LDRP*/ 12190004
*    SELSW = 1;                 /* SEL PARAMETER ALLOWED     @D21LDRP*/ 12200004
*    PUSW = 1;                  /* PU PARAMETER ALLOWED      @D21LDRP*/ 12210004
*    SEPSW = 1;                 /* SEP PARAMETER ALLOWED     @D21LDRP*/ 12220004
*    LPUEXCL = 1;               /* SEL, SEP, PU MUTUAL EXCL. @D21LDRP*/ 12230004
*   END;                                   /*                @D21LDRP*/ 12240004
* IF TID = 3 THEN               /* IF ID = BDY               @D21LDRP*/ 12250004
*   DO;                         /*                           @D21LDRP*/ 12260004
*    PIDSW = 1;                 /* (PID  PARM IS  ALLOWED)   @D21LDRP*/ 12270004
*    MODESW = 1;                /* (MODE PARM ALSO ALLOWED)  @D21LDRP*/ 12280004
*   END;                                   /*                @D21LDRP*/ 12290004
* IF TID = 6 THEN               /* IF ID = CPUID             @D51IDGL*/ 12300004
*   DO;                         /*                           @D51IDGL*/ 12310004
*    MODESW = 1;                /* (MODE PARM ALLOWED)       @D61DDEM*/ 12320004
*   END;                                   /*                @D51IDGL*/ 12330004
* IF TID = 10 THEN              /* IF ID = GETVIS            @D51IDGL*/ 12340004
*   DO;                         /*                           @D51IDGL*/ 12350004
*    PIDSW = 1;                 /* (PID PARAMETER  ALLOWED)  @D51IDGL*/ 12360004
*    MODESW = 1;                /* (MODE PARM ALSO ALLOWED)  @D61DDEM*/ 12370004
*   END;                                   /*                @D51IDGL*/ 12380004
* IF TID = 11 THEN              /* IF ID = PART              @D51IDGL*/ 12390004
*   DO;                         /* PID PARAMETER ALLOWED     @D51IDGL*/ 12400004
*    PIDSW = 1;                 /*                           @D51IDGL*/ 12410004
*   END;                                   /*                @D51IDGL*/ 12420004
* IF TID = 13 THEN              /* IF ID = SAINFO            @D51IDGL*/ 12430004
*   DO;                         /* MODE PARAMETER REQUIRED   @D61DDEM*/ 12440004
*    MODESW = 1;                /*                           @D51IDGL*/ 12450004
*   END;                                   /*                @D51IDGL*/ 12460004
* IF TID = 5 THEN               /* IF ID = PUB               @D21LDRP*/ 12470004
*   DO;                         /*                           @D21LDRP*/ 12480004
*    PIDSW = 1;                 /* PID PARAMETER ALLOWED     @D21LDRP*/ 12490004
*    SELSW = 1;                 /* SEL PARAMETER ALLOWED     @D21LDRP*/ 12500004
*    PUSW = 1;                  /* PU PARAMETER ALLOWED      @D21LDRP*/ 12510004
*    SEPSW = 1;                 /* SEP PARAMETER ALLOWED     @D21LDRP*/ 12520004
*    LPUEXCL = 1;               /* SEL, SEP, PU MUTUAL EXCL. @D21LDRP*/ 12530004
*    DISPSW = 1;                /* DISP PARAMETER ALLOWED    @D21LDRP*/ 12540004
*   END;                                   /*                @D21LDRP*/ 12550004
* IF TID = 8 | TID = 9 THEN     /* IF ID= SENSE | ID = DEVICE@D21LDRP*/ 12560004
*   DO;                         /*                           @D21LDRP*/ 12570004
*    PIDSW = 1;                 /* PID PARAMETER ALLOWED     @D21LDRP*/ 12580004
*    PUSW = 1;                  /* PU PARAMETER ALLOWED      @D21LDRP*/ 12590004
*    SELSW = 1;                 /* SEL PARAMETER ALLOWED     @D21LDRP*/ 12600004
*    SEPSW = 1;                 /* SEP PARAMETER ALLOWED     @D21LDRP*/ 12610004
*    LPUEXCL = 1;               /* SEL, SEP, PU MUTUAL EXCL. @D21LDRP*/ 12620004
*   END;                                   /*                @D21LDRP*/ 12630004
* /*******************************************************************/ 12640004
* /*                                                                 */ 12650004
* /*     CHECK AREA AND LENGTH OPERANDS. IF NOT SUPPLIED SUPPRESS    */ 12660004
* /*     MACRO GENERATION.                                           */ 12670004
* /*                                                                 */ 12680004
* /*******************************************************************/ 12690004
*    IF NUMBER(AREA) = 0 THEN              /* AREA GIVEN             */ 12700004
*      DO;                                 /* NO                     */ 12710004
*        IKEY = 'AREA';                    /* SET PARM FOR MNOTE     */ 12720004
*        GO TO MERR1;                      /* WRITE MNOTE            */ 12730004
*      END;                                /*                        */ 12740004
*     ELSE;                                /*                        */ 12750004
*    IF NUMBER(LEN) = 0 THEN               /* LENGTH GIVEN           */ 12760004
*      DO;                                 /* NO                     */ 12770004
*        IKEY = 'LEN';                     /* SET PARM FOR MNOTE     */ 12780004
*        GO TO MERR1;                      /* WRITE MNOTE            */ 12790004
*      END;                                /*                        */ 12800004
*     ELSE                                 /*                        */ 12810004
*        CLEN = LEN(1);                    /* SAVE LENGTH    @D35YDWK*/ 12820004
* /*******************************************************************/ 12830004
* /*                                                                 */ 12840004
* /*     CHECK DISP OPERAND.                                         */ 12850004
* /*                                                                 */ 12860004
* /*******************************************************************/ 12870004
*    IF NUMBER(DISP) = 0 THEN             /* IF DISP SPECIFIED      */ 12880004
*      DO;                                 /* AND            @D35EDWK*/ 12890004
*       IF DISPSW=0 THEN                   /* DISP NOT ALLOWE@D21LDRP*/ 12900004
*        DO;                               /* PUB            @D35EDWK*/ 12910004
*          IKEY = 'DISP-';                 /* IKEY FOR MSG   @D35EDWK*/ 12920004
*          IGO = 1;                        /* SET BRANCHADR  @D35EDWK*/ 12930004
*          GO TO MERR2;                    /* WRITE WARNING  @D35EDWK*/ 12940004
*        END;                              /*                @D35EDWK*/ 12950004
*       ELSE TDISP=1;              /* INDICATE DISP PRESENT  @D21LDRP*/ 12960004
*       IF DISP(1,1:1) = '(' THEN          /* IF PARENS USED @D35YDWK*/ 12970004
*          CDIS = DISP(1,1);               /* SAVE WITHOUT   @D35YDWK*/ 12980004
*         ELSE                             /* OTHERWISE      @D35YDWK*/ 12990004
*             CDIS = DISP(1);              /* SAVE DISP VALUE@D35YDWK*/ 13000004
*      END;                                /*                @D35EDJO*/ 13010004
*     ELSE;                                /* IF OMITTED DO NOTHING  */ 13020004
* /*******************************************************************/ 13030004
* /*                                                                 */ 13040004
* /*     CHECK SEL OPERAND.                                          */ 13050004
* /*                                                                 */ 13060004
* /*******************************************************************/ 13070004
* CHSEL:                                   /* CHECK SEL OP.  @D35EDWK*/ 13080004
*    IKEY = 'SEL-';                        /* IKEY FOR MSG   @D355DWK*/ 13090004
*    IGO = 2;                              /* SET BRANCHADR  @D35EDWK*/ 13100004
*    IF NUMBER(SEL) = 0 THEN               /* SEL NOT GIVEN, BUT     */ 13110004
*      IF SELRSW=1 THEN GOTO MERR1;        /* SEL REQUIRED-> MNOTE   */ 13120004
*      ELSE                                /*                @D14CDWK*/ 13130004
*        IF LPEXCL=1 THEN SEPRSW = 1;      /*SEL OR SEP REQUIRED     */ 13140004
*        ELSE;                             /*                @D21LDRP*/ 13150004
*    ELSE                                  /* SEL GIVEN      @D35EDWK*/ 13160004
*      IF  SELSW=0 THEN GOTO MERR2;        /* BUT NOT ALLOWED        */ 13170004
*      ELSE TSEL = 1;                      /* INDICATE GIVEN @D14CDWK*/ 13180004
* /*******************************************************************/ 13190004
* /*                                                                 */ 13200004
* /*     CHECK SEP OPERAND.                                          */ 13210004
* /*                                                                 */ 13220004
* /*******************************************************************/ 13230004
* CHSEP:                                   /* CHECK SEP OP.  @D35EDWK*/ 13240004
*    IF NUMBER(SEP)=0 THEN                 /* SEP NOT GIVEN  @D355DWK*/ 13250004
*      DO;                                 /*                @D355DWK*/ 13260004
*       IF SEPRSW=1 THEN                   /* BUT SEP REQ.   @D21LDRP*/ 13270004
*            DO;                           /* THEN           @D35EDWK*/ 13280004
*             IKEY = 'SEL- OR SEP-';       /* WRITE MNOTE    @D35EDWK*/ 13290004
*             GO TO MERR1;                 /*                @D35EDWK*/ 13300004
*            END;                          /*                @D35EDWK*/ 13310004
*      END;                                /*                @D355DWK*/ 13320004
*     ELSE                                 /* SEP GIVEN      @D35EDWK*/ 13330004
*      DO;                                 /* THEN           @D35EDWK*/ 13340004
*       IKEY = 'SEL- AND SEP-';            /* SET MNOTE TEXT @D21LDRP*/ 13350004
*       IF TSEL=1 & LPEXCL=1 THEN  /* IF SEL PRESENT AND SEL,@D21LDRP*/ 13360004
*              GOTO MERR8;          /* SEP ARE MUTUAL EXCL.  @D21LDRP*/ 13370004
*       IKEY='SEL-, SEP- AND PU-'; /*     SET MNOTE TEXT     @D21LDRP*/ 13380004
*       IF TSEL=1 & LPUEXCL=1 /* SEL PRESENT, BUT SEL,SEP,PU @D21LDRP*/ 13390004
*              THEN GOTO MERR8;      /* MUTUAL EXCL.         @D21LDRP*/ 13400004
*       IKEY = 'SEP-';                     /* SET IKEY AND   @D21LDRP*/ 13410004
*       IGO = 3;                           /* BRANCH ADDR    @D21LDRP*/ 13420004
*       IF SEPSW=0 THEN GOTO MERR2;  /* IF SEP NOT ALLOWED WRITE        13430004
*                                             WARNING        @D21LDRP*/ 13440004
*         ELSE TSEP=1;          /* ELSE,   IND. SEP GIVEN    @D21LDRP*/ 13450004
*      END;                                /* END SEP        @D35EDWK*/ 13460004
* /**********************************************************@D149DWK*/ 13470004
* /*                                                         @D149DWK*/ 13480004
* /*     CHECK PU OPERAND.                                   @D149DWK*/ 13490004
* /*                                                         @D149DWK*/ 13500004
* /**********************************************************@D149DWK*/ 13510004
* CHPU:                                    /* CHECK PU OPER. @D14CDWK*/ 13520004
*    IF NUMBER(PU)=0 THEN                  /* PU OMITTED     @D14CDWK*/ 13530004
*       IF TSEP=0 & TSEL=0 & LPUEXCL=1     /* BUT REQU. NOW  @D21LDRP*/ 13540004
*             THEN GOTO MERR7;             /*  WRITE MNOTE   @D21LDRP*/ 13550004
*        ELSE;                             /*                @D14CDWK*/ 13560004
*     ELSE                                 /* PU GIVEN       @D14CDWK*/ 13570004
*      DO;                                 /*                @D14CDWK*/ 13580004
*       IF PUSW=0 THEN                     /* BUT NOT ALLOWED@D21LDRP*/ 13590004
*          DO;                             /*                @D14CDWK*/ 13600004
*            IKEY = 'PU-';                 /* SET IKEY AND   @D14CDWK*/ 13610004
*            IGO = 4;                      /* BRANCH ADDR    @D14CDWK*/ 13620004
*            GO TO MERR2;                  /* WRITE WARNING  @D14CDWK*/ 13630004
*          END;                            /*                @D14CDWK*/ 13640004
*        ELSE                              /* PU ALLOWED     @D14CDWK*/ 13650004
*            IF (TSEP=1 | TSEL=1) & LPUEXCL=1 /* BUT SEL|SEP @D21LDRP*/ 13660004
*              THEN                  /*SPECIFIED,            @D21LDRP*/ 13670004
*               DO;                        /*                @D21LDRP*/ 13680004
*                IKEY='SEL-, SEP- AND PU-';/* SET MNOTE TEXT @D21LDRP*/ 13690004
*                GOTO MERR8;               /* WRITE MNOTE    @D21LDRP*/ 13700004
*               END;                       /*                @D21LDRP*/ 13710004
*              ELSE TPU=1;           /* INDICATE PU AVAILABLE@D21LDRP*/ 13720004
*      END;                                /* END SEP        @D14CDWK*/ 13730004
* /*******************************************************************/ 13740004
* /*                                                                 */ 13750004
* /*     CHECK PID OPERAND.                                          */ 13760004
* /*                                                                 */ 13770004
* /*******************************************************************/ 13780004
* CHPID:                                   /* CHECK PID      @D35EDWK*/ 13790004
*    IGO = 5;                   /* SET BRANCHADDR FOR MERR2  @D21LDRP*/ 13800004
*    IF NUMBER(PID) = 0 THEN              /* PID GIVEN      @D35EDWK*/ 13810004
*        IF PIDSW=1 THEN                   /* PID ALLOWED    @D21LDRP*/ 13820004
*         DO;                              /*                @D14CDWK*/ 13830004
*          IF TSEP=1 THEN                  /* AND SEP        @D21LDRP*/ 13840004
*             DO;                          /*  PRESENT       @D35EDWK*/ 13850004
*               IKEY = 'SEP GIVEN : PID';  /* SET IKEY       @D21LDRP*/ 13860004
*               GO TO MERR2;               /* WRITE WARNING  @D35EDWK*/ 13870004
*             END;                         /*                @D35EDWK*/ 13880004
*          ELSE                            /* SEP NOT PRESENT@D21LDRP*/ 13890004
*            IF TPU=1 THEN                 /*BUT PU PRESENT  @D21LDRP*/ 13900004
*               DO;                        /*                @D35EDWK*/ 13910004
*                 IKEY = 'PU GIVEN : PID'; /* SET IKEY       @D21LDRP*/ 13920004
*                 GO TO MERR2;             /* WRITE WARNING  @D35EDWK*/ 13930004
*               END;                       /*                @D35EDWK*/ 13940004
*            ELSE                  /* WHETHER SEP NOR PU PR. @D21LDRP*/ 13950004
*               TPID=1;            /* INDICATE PID AVAILABLE @D21LDRP*/ 13960004
*         END;                             /*                @D14CDWK*/ 13970004
*        ELSE                              /* PID NOT ALLOWED@D21LDRP*/ 13980004
*         DO;                              /*                @D14CDWK*/ 13990004
*          IKEY = 'PID-';                  /* SET IKEY       @D14CDWK*/ 14000004
*          GO TO MERR2;                    /* WRITE WARNING  @D14CDWK*/ 14010004
*         END;                             /*                @D14CDWK*/ 14020004
*     ELSE;                                /* PID NOT GIVEN  @D35EDWK*/ 14030004
* /**********************************************************@D14NDWK*/ 14040004
* /*                                                         @D14NDWK*/ 14050004
* /*     CHECK SID OPERAND.                                  @D14NDWK*/ 14060004
* /*                                                         @D14NDWK*/ 14070004
* /**********************************************************@D14NDWK*/ 14080004
* CHSID:                                   /* CHECK SID      @D14NDWK*/ 14090004
*    IF NUMBER(SID) = 0 THEN DO;          /* PID GIVEN      @D14NDWK*/ 14100004
*      IF TID = 7 THEN DO;        /* ID NOT MAP:NO SID REQU.@D14NDWK*/ 14110004
*        IGO = 6;                          /* SET BRANCHADDR @D14CDWK*/ 14120004
*        IKEY = 'SID-';                    /* SET IKEY       @D14NDWK*/ 14130004
*        GO TO MERR2;                      /* WRITE WARNING  @D14NDWK*/ 14140004
*      END;                                /*                @D14NDWK*/ 14150004
*    END;                                  /* END PID        @D14NDWK*/ 14160004
* /*******************************************************************/ 14170004
* /*                                                                 */ 14180004
* /*     CHECK MODE OPERAND.                                         */ 14190004
* /*                                                                 */ 14200004
* /*******************************************************************/ 14210004
* CHMOD:                                   /* CHECK MODE     @D35EDWK*/ 14220004
*    IF NUMBER(MODE) = 0 THEN DO;          /* MODE OMITTED   @D35EDWK*/ 14230004
*      IF TID = 3 THEN                     /* PID NOT ALLOWED@D35EDWK*/ 14240004
*        IF TPID=1 THEN GOTO MERR6;        /*  FOR BDY WITH MODE=T      14250004
*                                               (DEFAULT)    @D21IDRP*/ 14260004
*    END;                                  /*                @D51IDGL*/ 14270004
*    ELSE DO;                              /* MODE GIVEN     @D51IDGL*/ 14280004
*      IF MODESW = 0  THEN DO;             /* MODE NOT ALLOW.@D61DDEM*/ 14290004
*        IGO = 7;                          /* SET BRANCHADDR @D61DDEM*/ 14300004
*        IKEY = 'MODE-';                   /* SET IKEY       @D61DDEM*/ 14310004
*        GO TO MERR2;                      /* WRITE WARNING  @D61DDEM*/ 14320004
*      END;                                /*                @D61DDEM*/ 14330004
*      IF TID = 3 THEN DO;                 /* BDY            @D51IDGL*/ 14340004
*        IF MODE(1) = 'T' THEN DO;         /* MODE EQUAL T   @D51IDGL*/ 14350004
*          IF TPID=1 THEN GOTO MERR6;      /* PID NOT ALLOWED@D51IDGL*/ 14360004
*          ELSE                            /* PID OMITTED    @D51IDGL*/ 14370004
*            GO TO CHLOC;                  /* OK. GO ON      @D51IDGL*/ 14380004
*        END;                              /*                @D51IDGL*/ 14390004
*        IF MODE(1) = 'S' THEN DO;         /*                @D51IDGL*/ 14400004
*          TFLAG = 2;                      /* INDICATE MODE S@D51IDGL*/ 14410004
*          GO TO CHLOC;                    /* GO ON WORKING  @D51IDGL*/ 14420004
*        END;                              /*                @D51IDGL*/ 14430004
*        IF MODE(1) = 'P' THEN DO;         /*                @D51IDGL*/ 14440004
*          TFLAG = 3;                      /* INDICATE MODE P@D51IDGL*/ 14450004
*          GO TO CHLOC;                    /* GO ON WORKING  @D51IDGL*/ 14460004
*        END;                              /*                @D51IDGL*/ 14470004
*        IF MODE(1) = 'SYSP' THEN DO;      /*                @D51IDGL*/ 14480004
*          TFLAG = 4;                      /* INDICATE SYSP  @D51IDGL*/ 14490004
*          GO TO CHLOC;                    /* GO ON WORKING  @D51IDGL*/ 14500004
*        END;                              /* OF LAST LEGAL  @D51IDGL*/ 14510004
*        IF MODE(1) = 'TEMP' THEN DO;      /*                @D51IDGL*/ 14520004
*          TFLAG = 5;                      /* INDICATE SYSP  @D51IDGL*/ 14530004
*          IF TPID=1 THEN GOTO MERR6;      /* PID NOT ALLOWED@KX40313*/ 14540004
*          ELSE                            /* PID OMITTED    @KX40313*/ 14550004
*            GO TO CHLOC;                  /* OK. GO ON      @KX40313*/ 14560004
*        END;                              /* OF LAST LEGAL  @D51IDGL*/ 14570004
*        IF MODE(1) = 'PERM' THEN DO;      /*                @D51IDGL*/ 14580004
*          TFLAG = 6;                      /* INDICATE SYSP  @D51IDGL*/ 14590004
*          GO TO CHLOC;                    /* GO ON WORKING  @D51IDGL*/ 14600004
*        END;                              /* OF LAST LEGAL  @D51IDGL*/ 14610004
*        IKEY = 'MODE-';                   /* FOR ERRORMSG   @D51IDGL*/ 14620004
*        GO TO MERR4;                      /* TELL ERROR     @D51IDGL*/ 14630004
*      END;                                /*                @D35EDWK*/ 14640004
*      IF TID = 10 THEN DO;                /* ID=GETVIS      @D51IDGL*/ 14650004
*        IF MODE(1) = 'PT' THEN DO;        /* MODE = PT?     @D51IDGL*/ 14660004
*          TFLAG = 1;                      /* SET FLAG       @D51IDGL*/ 14670004
*          GO TO CHLOC;                    /* FOR PARTITION  @D51IDGL*/ 14680004
*        END;                              /* GETVIS         @D51IDGL*/ 14690004
*        IF MODE(1) = 'SP' THEN DO;        /* MODE = SP?     @D51IDGL*/ 14700004
*          TFLAG = 2;                      /* SET FLAG FOR   @D51IDGL*/ 14710004
*          GO TO CHLOC;                    /* DYNAMIC SPACE  @D51IDGL*/ 14720004
*        END;                              /* GETVIS         @D51IDGL*/ 14730004
*        IF MODE(1) = 'SV' THEN DO;        /* MODE = SV?     @D51IDGL*/ 14740004
*          TFLAG = 4;                      /* SET MODE FOR   @D51IDGL*/ 14750004
*          GO TO CHLOC;                    /* SVA GETVIS     @D51IDGL*/ 14760004
*        END;                              /*                @D51IDGL*/ 14770004
*        IKEY = 'MODE-';                   /* ALL OTHER MODES@D51IDGL*/ 14780004
*        GO TO MERR4;                      /* ARE ILLEGAL    @D51IDGL*/ 14790004
*      END;                                /*                @D35EDWK*/ 14800004
*      IF TID = 6 THEN DO;                 /* ID=CPUID       @D51EMGL*/ 14810004
*        IF MODE(1) = 'REAL' THEN DO;      /* MODE = REAL?   @D51EMGL*/ 14820004
*          TFLAG = 1;                      /* SET FLAG       @D51EMGL*/ 14830004
*          GO TO CHLOC;                    /* FOR REAL       @D51EMGL*/ 14840004
*        END;                              /* CPUID          @D51EMGL*/ 14850004
*        IKEY = 'MODE-';                   /* ALL OTHER MODES@D51EMGL*/ 14860004
*        GO TO MERR4;                      /* ARE ILLEGAL    @D51EMGL*/ 14870004
*      END;                                /*                @D51EMGL*/ 14880004
*      IF TID = 13 THEN DO;                /* ID=SAINFO      @D61DDGL*/ 14890004
*        IF MODE(1) = 'PUBDEVTY' THEN DO;  /* MODE = REAL?   @D61DDGL*/ 14900004
*          TFLAG = 3;                      /* SET FLAG       @D61DDGL*/ 14910004
*          GO TO CHLOC;                    /* FOR REAL       @D61DDGL*/ 14920004
*        END;                              /* CPUID          @D61DDGL*/ 14930004
*        IF MODE(1) = 'EXTCODE' THEN DO;   /* MODE = REAL?   @D61DDGL*/ 14940004
*          TFLAG = 4;                      /* SET FLAG       @D61DDGL*/ 14950004
*          GO TO CHLOC;                    /* FOR REAL       @D61DDGL*/ 14960004
*        END;                              /* CPUID          @D61DDGL*/ 14970004
*        IKEY = 'MODE-';                   /* ALL OTHER MODES@D61DDGL*/ 14980004
*        GO TO MERR4;                      /* ARE ILLEGAL    @D61DDGL*/ 14990004
*      END;                                /*                @D61DDGL*/ 15000004
*      ELSE DO;                            /* INVALID MODE   @D35EDWK*/ 15010004
*                                          /* MODE NOT REQU  @D35EDWK*/ 15020004
*        IKEY = 'MODE-';                   /* SET IKEY       @D35EDWK*/ 15030004
*        IGO = 7;                          /* SET BRANCHADR  @D14CDWK*/ 15040004
*        GO TO MERR2;                      /* WRITE WARNING  @D35EDWK*/ 15050004
*      END;                                /*                @D35EDWK*/ 15060004
*    END;                                  /* MODE GIVEN     @D35EDWK*/ 15070004
* /**********************************************************@SUPSERV*/ 15080004
* /*                                                         @SUPSERV*/ 15090004
* /*     CHECK LOC OPERAND.                                  @SUPSERV*/ 15100004
* /*                                                         @SUPSERV*/ 15110004
* /**********************************************************@SUPSERV*/ 15120004
* CHLOC:                                   /* CHECK SID      @SUPSERV*/ 15130004
*    IF NUMBER(LOC) = 0 THEN DO;          /* PID GIVEN      @SUPSERV*/ 15140004
*      IF TID = 10 THEN DO;               /* ID NOT GETVIS? @SUPSERV*/ 15150004
*        IGO = 8;                          /* SET BRANCHADDR @SUPSERV*/ 15160004
*        IKEY = 'LOC-';                    /* SET IKEY       @SUPSERV*/ 15170004
*        GO TO MERR2;                      /* WRITE WARNING  @SUPSERV*/ 15180004
*      END;                                /*                @SUPSERV*/ 15190004
*      ELSE DO;                            /* IT IS GETVIS   @SUPSERV*/ 15200004
*        IF LOC(1) = 'RES' THEN DO;        /* DEFAULT?       @SUPSERV*/ 15210004
*        END;                              /*                @SUPSERV*/ 15220004
*        ELSE IF LOC(1) = 'BELOW' THEN DO; /* OR BELOW?      @SUPSERV*/ 15230004
*          TFLAG = TFLAG+16;               /* INDICATE IT    @SUPSERV*/ 15240004
*        END;                              /*                @SUPSERV*/ 15250004
*        ELSE IF LOC(1) = 'ANY' THEN DO;   /* OR ANY?        @SUPSERV*/ 15260004
*          TFLAG = TFLAG+32;               /* INDICATE IT    @SUPSERV*/ 15270004
*        END;                              /*                @SUPSERV*/ 15280004
*        ELSE DO;                          /*                @SUPSERV*/ 15290004
*          IKEY = 'LOC-';                  /*                @SUPSERV*/ 15300004
*          GO TO MERR4;                    /*                @SUPSERV*/ 15310004
*        END;                              /*                @SUPSERV*/ 15320004
*      END;                                /*                @SUPSERV*/ 15330004
*    END;                                  /* END LOC        @SUPSERV*/ 15340004
*   GO TO SETDCL;                          /*                @SUPSERV*/ 15350004
* /**********************************************************@D149DWK*/ 15360004
* /*                                                         @D149DWK*/ 15370004
* /*     MNOTE DECLARATIONS                                  @D149DWK*/ 15380004
* /*                                                         @D149DWK*/ 15390004
* /**********************************************************@D149DWK*/ 15400004
* MERR1:                                   /* WRITE MNOTE FOR        */ 15410004
* ANS MSG('IKEY OPERAND NOT GIVEN,GENERATION SUPPRESSED;')RESCAN ;      15420004
* ANS ('/* '||IKEY||' OPERAND NOT GIVEN,GENERATION SUPPRESSED */')      15430004
* RESCAN COL(MACLMAR);                                                  15440004
* RETURN CODE(8);                          /* MISSING OPERAND        */ 15450004
* MERR6:                                   /* WRITE MNOTE FOR        */ 15460004
* ANS MSG('PID-OPERAND NOT ALLOWED FOR DEFAULT MODE(T).')NORESCAN ;     15470004
* ANS MSG(' GENERATION SUPPRESSED;')NORESCAN;                           15480004
* ANS ('/* PID-OPERAND NOT ALLOWED FOR DEFAULT MODE(T). */')            15490004
* COL(MACLMAR);                                                         15500004
* ANS ('/* GENERATION SUPPRESSED                                  */')  15510004
* COL(MACLMAR);                                                         15520004
* RETURN CODE(8);                          /* MISSING OPERAND        */ 15530004
* MERR2:                                   /* WRITE MNOTE FOR        */ 15540004
* IID = ID(1);                             /* SET ID         @D35EDWK*/ 15550004
* ANS MSG('IKEY OPERAND IGNORED FOR ID=IID;')RESCAN ;  /*    @D35EDWK*/ 15560004
* ANS ('/* '||IKEY||' OPERAND IGNORED FOR ID='||IID||' */')             15570004
* RESCAN COL(MACLMAR);                                                  15580004
*  IF IGO = 1 THEN                         /*                @D35EDWK*/ 15590004
*      GO TO CHSEL;                        /* CHECK SEL      @D35EDWK*/ 15600004
*  IF IGO = 2 THEN                         /*                @D35EDWK*/ 15610004
*      GO TO CHSEP;                        /* CHECK SEP      @D35EDWK*/ 15620004
*  IF IGO = 3 THEN                         /*                @D35EDWK*/ 15630004
*      GO TO CHPU;                         /* CHECK PU       @D14CDWK*/ 15640004
*  IF IGO = 4 THEN                         /*                @D14CDWK*/ 15650004
*      GO TO CHPID;                        /* CHECK PID      @D35EDWK*/ 15660004
*  IF IGO = 5 THEN                         /*                @D14CDWK*/ 15670004
*      GO TO CHSID;                        /* CHECK SID      @D14NDWK*/ 15680004
*  IF IGO = 6 THEN                         /*                @D14CDWK*/ 15690004
*      GO TO CHMOD;                        /* CHECK MODE     @D35EDWK*/ 15700004
*  IF IGO = 7 THEN                         /*                @D14CDWK*/ 15710004
*      GO TO CHLOC;                        /* CHECK LOC      @D35EDWK*/ 15720004
*  GO TO SETDCL;                           /* SET DCL        @D35EDWK*/ 15730004
* MERR3:                                   /* WRITE MNOTE FOR        */ 15740004
* ANS MSG('IKEY OPERAND GIVEN,GENERATION SUPPRESSED;')RESCAN ;          15750004
* ANS ('/* '||IKEY||' OPERAND GIVEN,GENERATION SUPPRESSED */')          15760004
* RESCAN COL(MACLMAR);                                                  15770004
* RETURN CODE(8);                          /* SEL AND SEP GIVEN      */ 15780004
* MERR7:                                   /*                @D14CDWK*/ 15790004
* ANS MSG('SEL-,SEP- OR PU-OPERAND NOT GIVEN,GENERATION SUPPRESSED;');  15800004
* ANS ('/* SEL-,SEP- OR PU-OPERAND NOT GIVEN, GENERATION SUPPRESSED */' 15810004
* )RESCAN COL(MACLMAR);                                                 15820004
* RETURN CODE(8);                          /*                @D14CDWK*/ 15830004
* MERR8:                                   /*                @D14CDWK*/ 15840004
* ANS MSG('IKEY OPERAND ARE MUTUAL EXCLUSIVE,  GENERATION SUPPRESSED;'  15850004
* );                                                                    15860004
* ANS ('/* '||IKEY||' OPERAND ARE MUTUAL EXCLUSIVE.      */')           15870004
* COL(MACLMAR);                                                         15880004
* ANS ('/* GENERATION SUPPRESSED                                  */')  15890004
* COL(MACLMAR);                                                         15900004
* RETURN CODE(8);                          /*                @D14CDWK*/ 15910004
* /*******************************************************************/ 15920004
* /*                                                                 */ 15930004
* /* SET NAMES OF DCL FIELDS AND REGISTER WITH MACINDEX              */ 15940004
* /*                                                                 */ 15950004
* /*******************************************************************/ 15960004
* SETDCL:                                  /* NAME LIST      @D35EDWK*/ 15970004
*    ILIST ='EXTR'||MACINDEX;              /* SET NAME OF TABLE      */ 15980004
*    IID ='EXTI'||MACINDEX;                /* SET NAME OF ID FLD     */ 15990004
*    IFLAG ='EXTF'||MACINDEX;              /* SET NAME OF FLAG FLD   */ 16000004
*    IRES ='EXTX'||MACINDEX;               /* SET NAME RESERVED FLD  */ 16010004
*    ILEN ='EXTL'||MACINDEX;               /* SET NAME OF LENGTH FLD */ 16020004
*    IDIS ='EXTD'||MACINDEX;               /* SET NAME OF DISPL.FLD  */ 16030004
*    IAR ='EXTA'||MACINDEX;                /* SET NAME OF AREA FLD   */ 16040004
*    ISEL ='EXTU'||MACINDEX;               /* SET NAME OF UNIT FLD   */ 16050004
*    IPID ='EXTP'||MACINDEX;               /* SET NAME OF PIK/SID FLD*/ 16060004
*    IREG ='EXT1'||MACINDEX;               /* SET NAME OF REGISTER1  */ 16070004
* /*******************************************************************/ 16080004
* /*                                                                 */ 16090004
* /*  DECLARE PARAMETER LIST AND REGISTER 1 AND SET ADDRESS          */ 16100004
* /*                                                                 */ 16110004
* /*******************************************************************/ 16120004
*    ANS ('DCL IREG REG(1) PTR(31);')RESCAN SKIP COL(10);               16130004
*    ANS ('/* EXTRACT PTR TO PARMLST    */')COL(41);                    16140004
*    IF NUMBER(MFG) = 0 THEN               /* MFG = 0 INLINE         */ 16150004
*    DO;                                   /*                        */ 16160004
*    ANS ('DCL 1 ILIST BDY(WORD),')RESCAN SKIP COL(10);                 16170004
*    ANS ('/* EXTRACT PARMLIST */') COL(50);                            16180004
*    END;                                  /*                        */ 16190004
*   ELSE                                   /* DECLARE BASED          */ 16200004
*    DO;                                   /*                        */ 16210004
*    ANS ('DCL 1 ILIST BASED(*),')RESCAN SKIP COL(10);                  16220004
*    ANS ('/* EXTRACT PARMLIST */') COL(50);                            16230004
*    END;                                  /*                        */ 16240004
*    ANS ('5 IID PTR(8),')RESCAN SKIP COL(15);                          16250004
*    ANS ('/* ID-FLAG                   */')COL(41);                    16260004
*    ANS ('5 IFLAG PTR(8),')RESCAN SKIP COL(15);                        16270004
*    ANS ('/* FLAG FIELD                */')COL(41);                    16280004
*    ANS ('5 IRES FIXED(16),')RESCAN SKIP COL(15);                      16290004
*    ANS ('/* RESERVED                  */')COL(41);                    16300004
*    ANS ('5 ILEN FIXED(16),')RESCAN SKIP COL(15);                      16310004
*    ANS ('/* LENGTH OF AREA            */')COL(41);                    16320004
*    ANS ('5 IDIS FIXED(16),')RESCAN SKIP COL(15);                      16330004
*    ANS ('/* DISPLACEMENT FOR PUB2     */')COL(41);                    16340004
*    ANS ('5 IAR PTR(31),')RESCAN SKIP COL(15);                         16350004
*    ANS ('/* ADDRESS OF AREA           */')COL(41);                    16360004
*    ANS ('5 ISEL PTR(31),')RESCAN SKIP COL(15);                        16370004
*    ANS ('/* ADDRESS OF SPEC. UNIT     */')COL(41);                    16380004
*    ANS ('5 IPID PTR(31);')RESCAN SKIP COL(15);                        16390004
*    IF TID = 7 THEN                       /* ID = MAP       @D14NDWK*/ 16400004
*    ANS ('/* ADDRESS OF SPACE ID       */')COL(41);                    16410004
*    ELSE                                  /*                @D14NDWK*/ 16420004
*    ANS ('/* ADDRESS OF SPEC. PIK      */')COL(41);                    16430004
*    ANS ('RFY IREG RSTD;')RESCAN SKIP COL(MACCOL);                     16440004
*    ANS ('/* RESTRICTED USE OF REG1    */')COL(41);                    16450004
*    ANS (MACLABEL) COL(MACCOL);                                        16460004
*    IF NUMBER(MFG) = 0 THEN              /* MFG = 0 MFG   @D68DDUL*/ 16470007
*    DO;                                   /* IF REGISTER    @D35YDWK*/ 16530004
*    IF MFG(1,1:1) = '(' THEN              /* NOTATION USED  @D35YDWK*/ 16540004
*        CMFG = MFG(1);                    /* SAVE IT        @D35YDWK*/ 16550004
*       ELSE                               /*                @D35YDWK*/ 16560004
*        DO;                               /*                @D35YDWK*/ 16570004
*        IF INDEX(MFG(1),'ADDR(') = 0 THEN /* IF PRT EXPR.  @D35YDWK*/ 16580004
*            CMFG = MFG(1);                /* SAVE IT        @D35YDWK*/ 16590004
*           ELSE                           /* ELSE CREATE    @D35YDWK*/ 16600004
*            CMFG = 'ADDR('||MFG(1)||')';  /* PTR EXPRESSION @D35YDWK*/ 16610004
*        END;                              /* ELSE CREATE    @D35YDWK*/ 16620004
*    ANS ('IREG = CMFG;')RESCAN SKIP COL(MACCOL);                       16630004
*    ANS ('/* SET PARMLIST ADDR         */') COL(41);                   16640004
*    ANS ('RFY ILIST BASED(IREG);')RESCAN SKIP COL(MACCOL);             16650004
*    ANS ('/* ADRESSABLE PARMLIST       */') COL(41);                   16660004
*    END;                                   /*                       */ 16670004
* /*******************************************************************/ 16680004
* /*                                                                 */ 16690004
* /*  SET ID FOR SVC ROUTINE                                         */ 16700004
* /*                                                                 */ 16710004
* /*******************************************************************/ 16720004
*    ANS ('IID = TID;')RESCAN SKIP COL(MACCOL);                         16730004
*    ANS ('/* SET ID FOR SVC 98         */') COL(41);                   16740004
* /*******************************************************************/ 16750004
* /*                                                                 */ 16760004
* /*  SET LENGTH OPERAND                                             */ 16770004
* /*                                                                 */ 16780004
* /*******************************************************************/ 16790004
*    ANS ('ILEN = CLEN;')RESCAN SKIP COL(MACCOL);                       16800004
*    ANS ('/* SET LENGTH PARM           */') COL(41);                   16810004
* /*******************************************************************/ 16820004
* /*                                                                 */ 16830004
* /*  SET DISP OPERAND                                               */ 16840004
* /*                                                                 */ 16850004
* /*******************************************************************/ 16860004
*    IF TDISP =1 THEN DO;                  /* DISP VAILD     @D21LDRP*/ 16870004
*      ANS ('IDIS = CDIS;')RESCAN SKIP COL(MACCOL);                     16880004
*    END;                                  /*                @D35EDWK*/ 16890004
*    ELSE DO;                              /* DISP ZERO      @D355DWK*/ 16900004
*      ANS ('IDIS = 0 ;')RESCAN SKIP COL(MACCOL);                       16910004
*    END;                                  /*                @D355DWK*/ 16920004
*    ANS ('/* SET DISPL. PARM           */') COL(41);                   16930004
* /*******************************************************************/ 16940004
* /*                                                                 */ 16950004
* /*  CHECK AND SET USER AREA ADDRESS                                */ 16960004
* /*                                                                 */ 16970004
* /*******************************************************************/ 16980004
* SAREA:                                   /*                @D35EDWK*/ 16990004
*    IF AREA(1,1:1) = '(' THEN DO;         /* REGISTER NOTATION USED */ 17000004
*      CAR = AREA(1,1);                    /* SET REGISTER           */ 17010004
*    END;                                                               17020004
*    ELSE DO;                              /* NOT REGISTER           */ 17030004
*      IF INDEX(AREA(1),'(') = 0 THEN DO; /* IF YES                 */ 17040004
*        CAR = AREA(1) ;                   /* SET ADDR CONSTANT      */ 17050004
*      END;                                                             17060004
*      ELSE DO;                            /* NOT ADDR               */ 17070004
*        CAR = 'ADDR('||AREA(1)||')';      /* SET ADDR CONSTANT      */ 17080004
*      END;                                                             17090004
*    END;                                                               17100004
*    ANS ('IAR = CAR ;')RESCAN SKIP COL(MACCOL);                        17110004
*    ANS ('/* SET AREA ADDRESS          */') COL(41);                   17120004
* /*******************************************************************/ 17130004
* /*                                                                 */ 17140004
* /*  SET SEL ADDR                                                   */ 17150004
* /*                                                                 */ 17160004
* /*******************************************************************/ 17170004
*    IF TSEL=1 THEN DO;                       /* SEL VALID   @D21LDRP*/ 17180004
*      TFLAG = 0;                             /* FLAG LOGICAL UNIT   */ 17190004
*      IF SEL(1,1:1) = '(' THEN DO;           /* REG. NOTATION USED  */ 17200004
*        CSEL = SEL(1,1);                     /* SET REGISTER        */ 17210004
*      END;                                                             17220004
*      ELSE DO;                               /* NOT REGISTER        */ 17230004
*        IF INDEX(SEL(1),'(') = 0 THEN       /* IF YES              */ 17240004
*          CSEL = SEL(1) ;                    /* SET ADDR CONST.     */ 17250004
*        ELSE DO;                             /* NOT ADDR            */ 17260004
*          CSEL = 'ADDR('||SEL(1)||')';       /* SET ADDR CONST     .*/ 17270004
*        END;                                                           17280004
*      END;                                                             17290004
*      ANS ('ISEL = CSEL;')RESCAN SKIP COL(MACCOL);                     17300004
*      ANS ('/* SET SEL ADDRESS           */') COL(41);                 17310004
*      GO TO SFLAG;                           /* GO SETFLAG  @D355DWK*/ 17320004
*    END;                                     /*             @D35EDWK*/ 17330004
* /*******************************************************************/ 17340004
* /*                                                                 */ 17350004
* /*  SET SEP ADDR                                                   */ 17360004
* /*                                                                 */ 17370004
* /*******************************************************************/ 17380004
* SSEP:                                    /* SET SEP ADDRESS        */ 17390004
*    IF TSEP=1 THEN DO;                    /* SEP PRESENT    @D21LDRP*/ 17400004
*      TFLAG = 1;                          /* FLAG PHYSICAL UNIT     */ 17410004
*      IF SEP(1,1:1) = '(' THEN DO;        /* REGISTER NOTATION USED */ 17420004
*        CSEL = SEP(1,1);                  /* SET REGISTER   @D14CDWK*/ 17430004
*      END;                                                             17440004
*      ELSE DO;                            /* NOT REGISTER           */ 17450004
*        IF INDEX(SEP(1),'(') = 0 THEN DO;/* IF ADDR USED           */ 17460004
*          CSEL = SEP(1);                  /* SET ADDR CONST.@D14CDWK*/ 17470004
*        END;                                                           17480004
*        ELSE DO;                          /* NOT ADDR               */ 17490004
*          CSEL = 'ADDR('||SEP(1)||')';    /*SET ADDR CONST@D14CDWK*/   17500004
*        END;                              /*                        */ 17510004
*      END;                                /*                        */ 17520004
*      ANS ('ISEL = CSEL;')RESCAN SKIP COL(MACCOL);                     17530004
*      ANS ('/* SET SEP ADDRESS           */') COL(41);                 17540004
*      GO TO SFLAG;                        /* GO SET FLAG    @D14CDWK*/ 17550004
*    END;                                  /*                @D21LDRP*/ 17560004
* /**********************************************************@D149DWK*/ 17570004
* /*                                                         @D149DWK*/ 17580004
* /*  SET PU ADDRESS                                         @D149DWK*/ 17590004
* /*                                                         @D149DWK*/ 17600004
* /**********************************************************@D149DWK*/ 17610004
* SPU:                                     /* SET PU ADDRESS @D14CDWK*/ 17620004
*    IF TPU=1 THEN DO;                     /* PU PRESENT     @D21LDRP*/ 17630004
*      TFLAG = 2;                          /* PUB INDEX IND. @D14CDWK*/ 17640004
*      IF PU(1,1:1) = '(' THEN DO;         /* REGISTER NOTAT.@D14CDWK*/ 17650004
*        CSEL = PU(1,1);                   /* SET REGISTER   @D14CDWK*/ 17660004
*      END;                                                             17670004
*      ELSE DO;                            /* NOT REGISTER   @D14CDWK*/ 17680004
*        IF INDEX(PU(1),'(') = 0 THEN DO; /* IF ADDR NOTAT. @D14CDWK*/ 17690004
*          CSEL = PU(1);                   /* SET ADDR CONST.@D14CDWK*/ 17700004
*        END;                                                           17710004
*        ELSE DO;                          /* NOT ADDR       @D14CDWK*/ 17720004
*          CSEL = 'ADDR('||PU(1)||')';     /* SET ADDR CONST.@D14CDWK*/ 17730004
*        END;                                                           17740004
*      END;                                /*                @D14CDWK*/ 17750004
*      ANS ('ISEL = CSEL;')RESCAN SKIP COL(MACCOL);                     17760004
*      ANS ('/* ADDR OF PUB INDEX @D14CDWK*/') COL(41);                 17770004
*    END;                                  /*                @D21LDRP*/ 17780004
*    ELSE DO;                              /*                @D21LDRP*/ 17790004
*      ANS ('ISEL = 0;')RESCAN SKIP COL(MACCOL);       /*    @D21LDRP*/ 17800004
*      ANS ('/* SEL, SEP OR PU NOT PRESENT*/')COL(41); /*    @D21LDRP*/ 17810004
*    END;                                  /*                @D21LDRP*/ 17820004
* /*******************************************************************/ 17830004
* /*                                                                 */ 17840004
* /*  SET FLAG FOR LOGICAL OR PHYSICAL UNIT                          */ 17850004
* /*                                                                 */ 17860004
* /*******************************************************************/ 17870004
* SFLAG:                                   /*                        */ 17880004
*    ANS ('IFLAG = TFLAG;')RESCAN SKIP COL(MACCOL);                     17890004
*    ANS ('/* SET FLAG                  */') COL(41);                   17900004
* /**********************************************************@D14NDWK*/ 17910004
* /*                                                         @D14NDWK*/ 17920004
* /*  CHECK AND SET SID OPERAND                              @D14NDWK*/ 17930004
* /*                                                         @D14NDWK*/ 17940004
* /**********************************************************@D14NDWK*/ 17950004
*    IF TID = 7 THEN DO;                   /* ID = MAP       @D14NDWK*/ 17960004
*      IF NUMBER(SID) = 0 THEN DO;        /* SID SPECIFIED  @D14NDWK*/ 17970004
*        IF SID(1,1:1) = '(' THEN DO;      /* REG. NOTATION  @D14NDWK*/ 17980004
*          CPID = SID(1,1);                /* SET REGISTER   @D14NDWK*/ 17990004
*        END;                                                           18000004
*        ELSE DO;                          /* NOT REGISTER   @D14NDWK*/ 18010004
*          IF INDEX(SID(1),'(') = 0 THEN DO; /*  ADDR FORM  @D14NDWK*/ 18020004
*            CPID = SID(1) ;               /* SET ADDR CONST.@D14NDWK*/ 18030004
*          END;                                                         18040004
*          ELSE DO;                        /* NOT ADDR       @D14NDWK*/ 18050004
*            CPID = 'ADDR('||SID(1)||')';  /* GEN ADCON.     @D14NDWK*/ 18060004
*          END;                                                         18070004
*        END;                                                           18080004
*        ANS ('IPID = CPID;')RESCAN SKIP COL(MACCOL);                   18090004
*      END;                                /*                @D14NDWK*/ 18100004
*      ELSE DO;                            /*                @D14NDWK*/ 18110004
*        ANS ('IPID = 0;')RESCAN SKIP COL(MACCOL);                      18120004
*      END;                                /*                @D14NDWK*/ 18130004
*      ANS ('/* SET SPACE ID ADDRESS      */') COL(41);                 18140004
*      GO TO SETSVC ;                      /*                @D14NDWK*/ 18150004
*    END;                                  /*                @D14NDWK*/ 18160004
* /*******************************************************************/ 18170004
* /*                                                                 */ 18180004
* /*  CHECK AND SET PID OPERAND                                      */ 18190004
* /*                                                                 */ 18200004
* /*******************************************************************/ 18210004
*    IF TPID=1 THEN DO;                    /* PID PRESENT    @D21LDRP*/ 18220004
*      IF PID(1,1:1) = '(' THEN DO;        /* REGISTER NOTATION USED */ 18230004
*        CPID = PID(1,1);                  /* SET REGISTER           */ 18240004
*      END;                                                             18250004
*      ELSE DO;                             /* NOT REGISTER          */ 18260004
*        IF INDEX(PID(1),'(') = 0 THEN DO; /* ADDR FORM USED        */ 18270004
*          CPID = PID(1);                   /* SET ADDR CONSTANT     */ 18280004
*        END;                                                           18290004
*        ELSE DO;                           /* NOT ADDR              */ 18300004
*          CPID = 'ADDR('||PID(1)||')';     /* GENERATE ADDR.CONST.  */ 18310004
*        END;                                                           18320004
*      END;                                                             18330004
*      ANS ('IPID = CPID;')RESCAN SKIP COL(MACCOL);                     18340004
*    END;                                   /*               @D21LDRP*/ 18350004
*    ELSE DO;                                                           18360004
*      ANS ('IPID = 0;')RESCAN SKIP COL(MACCOL);                        18370004
*    END;                                   /*               @D21LDRP*/ 18380004
*    ANS ('/* SET PID ADDRESS           */') COL(41);                   18390004
* /*******************************************************************/ 18400004
* /*                                                                 */ 18410004
* /*  EXECUTE SVC 98                                                 */ 18420004
* /*                                                                 */ 18430004
* /*******************************************************************/ 18440004
* SETSVC:                                  /*                @D355DWK*/ 18450004
*    IF NUMBER(MFG)  = 0 THEN              /* MFG = 0 INLINE @D68DDUL*/ 18451006
*    DO;                                   /*                @D68DDUL*/ 18452006
*    ANS ('IREG=ADDR(ILIST);')RESCAN SKIP COL(MACCOL);     /*@D68DDUL*/ 18453006
*    ANS ('/* SET PARMLIST ADDR         */') COL(41);      /*@D68DDUL*/ 18454006
*    END;                                  /*                @D68DDUL*/ 18455006
*    ANS ('GEN (SR    15,15);')NORESCAN SKIP COL(MACCOL);               18460004
*    ANS ('/* CLEAR RETCODE REGISTER    */') COL(41);                   18470004
*    ANS ('SVC(98);')NORESCAN SKIP COL(MACCOL);                         18480004
*    ANS ('/* EXECUTE SVC               */') COL(41);                   18490004
*    ANS ('RFY IREG UNRSTD;')RESCAN SKIP COL(MACCOL);                   18500004
*    ANS ('/* UNRESTRICT REG.1          */') COL(41);                   18510004
* MEND:  RETURN CODE(0);                   /*                        */ 18520004
*%END ;                                    /*                        */ 18530004
