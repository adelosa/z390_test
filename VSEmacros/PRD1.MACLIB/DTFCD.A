         MACRO                                                          00050000
&NAME    DTFCD &BLKSIZE=,&CONTROL=,&CRDERR=,&CTLCHR=,&DEVADDR=,&DEVICE=100100000
               2540,&EOFADDR=,&IOAREA1=,&IOAREA2=,&IOREG=,&OUBLKSZ=,&RE200150000
               CFORM=FIXUNB,&RECSIZE=,&SSELECT=,&TYPEFLE=INPUT,&WORKA=,300200000
               &MODNAME=,&SEPASMB=,&RDONLY=,&MODE=,&FUNC=,&ERROPT=,    400250000
               &ASOCFLE=                                            4-0 00300000
         GBLC  &CG2                                            @D33FDVS 00350000
         LCLA  &AL2,&AL3,&AL4,&AL5,&AL6,&AL8,&AL9,&BLKS,&OUBL,&RPA,&CC,100400000
               &FLAG,&ASF,&N,&E                                     4-0 00450000
         LCLA  &COLBIN  COLUMN BINARY BIT IN CCW (X'20')  2560       JJ 00500000
         LCLA  &SWS       LOGIC SWITCHES - X'80' = 2560              JJ 00550000
.*                                         X'40' = 5425        @DL2994J 00600000
         LCLA  &STACKER  STACKER BIT PATTERN IN CCW (2560,5425)@DL2994J 00650000
         LCLA  &HOPPER  HOPPER SPECIFICATION BIT IN CCW (X'80')      JJ 00700000
.*                      FOR 2560 AND 5425                      @DL2994J 00750000
         LCLA  &EOFL  LENGTH OF EOF IDENTIFIER (2 OR 4)              JJ 00800000
         LCLA  &FL  FLAGGS IN CCW                                    JJ 00850000
         LCLA  &PCC   PUNCH COMMAND CODE (2560,5425)           @DL2994J 00900000
         LCLA  &RCC   READ COMMAND CODE (2560,5425)            @DL2994J 00950000
         LCLA  &NCH                                                  JJ 01000000
         LCLB  &BL1,&RPB,&OBLK881,&BL2                         @D33FDVS 01050000
         LCLC  &CG1,&SFX,&CNTL,&WKIO,&IOA2,&RECF,&IOA1,&RECZ,&IOG,&FUN,101100000
               &DMOD,&AL1,&FUNCT,&FMOD                         @D33FDVS 01150000
         LCLC  &RFM      FIRST CHARACTER OF RECFORM            @D14BDBF 01200000
.************************************************************* @D149DBF 01250000
.* IBM DISK OPERATING SYSTEM                                            01300000
.*                                                             @D149DBF 01350000
.*    01 COPYRIGHT =                                           @D149DBF 01400000
* IOCS AND DEVICE INDEPENDANT I/O - DTFCD -5686-007-02-C440    @U31TUJS 01450000
.*                                                             @D149DBF 01500000
*           5686-007 (C) COPYRIGHT IBM CORP. 1981,1989         @U31TUJS 01550000
*           LICENSED MATERIAL - PROGRAM PROPERTY OF IBM        @D149DBF 01600000
.*          REFER TO COPYRIGHT INSTRUCTIONS                    @D149DBF 01650000
.*          FORM NUMBER G120-2083                              @D149DBF 01700000
.*                                                             @D149DBF 01750000
.************************************************************* @D149DBF 01800000
.*                                                             @D14BDBF 01850000
.************************************************************* @D14BDBF 01900000
.*   CHANGE ACTIVITIES :                                       @D14BDBF 01950000
.*   @D14BDBF - 512 BYTES SYSIPT FOR POWER SPOOLED DEVICES     @D14BDBF 02000000
.*                                                             @D14BDBF 02050000
.*  AUTOMATICALLY GENERATED NAME OF LOGIC MODULE IS CHANGED    @DA28247 02100000
.*  FOR A 3881.THE LAST CHARACTER WILL NOW BE 'P'.             @DA28247 02150000
.*  THE PUNCH CARD WAS INCORRECT WAS &NAME.OBJ                 @DA35316 02200000
.*                           MUST BE &NAME..OBJ                @DA35316 02250000
.************************************************************* @D14BDBF 02300000
&RECF    SETC  '&RECFORM'       MOVE RECFORM INTO LCLC VARIABLE@D14BDBF 02350000
&CG1     SETC  '&DEVICE'(1,4)                                           02400000
         AIF   ('&CG1' NE '3504').NO3504                       @DC28914 02450000
&CG1     SETC  '3505'                                          @DC28914 02500000
.NO3504  ANOP                                                  @DC28914 02550000
&SFX     SETC  '&SYSNDX'                                                02600000
&RPA     SETA  33                                                   4-0 02650000
&RPB     SETB  ('&CG1' EQ '3505' OR '&CG1' EQ '3525' OR '&CG1' EQ '2560*02700000
               ' OR '&CG1' EQ '5425')                          @DL2994J 02750000
&DMOD    SETC  'E'                                                  4-0 02800000
&FMOD    SETC  'Z'                                                  4-0 02850000
&FUN     SETC  '7'                                                  4-0 02900000
         AIF   ('&CG1' NE '2560').JJ0                                JJ 02950000
&FUN     SETC  '8'                                                   JJ 03000000
&E       SETA  4  POST AT DEVICE END BIT IN CCB                @DL2994J 03050000
.JJ0     AIF   ('&CG1' NE '5425').JJ11                         @DL2994J 03100000
&E       SETA  4  POST AT DEVICE END BIT IN CCB                @DL2994J 03150000
&FUN     SETC  '9'                                                   JJ 03200000
.JJ11    AIF   (K'&NAME LT 8).ADREM                                  JJ 03250000
         MNOTE 9,'FILE NAME EXCEEDS SEVEN CHAR LIMIT, MACRO GENERATION *03300000
               TERMINATED'                                              03350000
         MEXIT                                                          03400000
.ADREM   AIF   (NOT &RPB).OMR001                               @DL28701 03450000
         AIF   ('&TYPEFLE' EQ 'CMBND').JLG5                         4-0 03500000
         AIF   (T'&MODE EQ 'O').JLGE                                4-0 03550000
         AIF   ('&CG1' EQ '5425').JLG2A                        @DL2994J 03600000
&N       SETA  K'&MODE                                              4-0 03650000
         AIF   ('&MODE' EQ 'E' OR '&MODE' EQ 'C').JLGD              4-0 03700000
         AIF   ('&CG1' EQ '2560').JLG2A                              JJ 03750000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').JLG2                        4-0 03800000
.JLGB    AIF   ('&MODE' EQ 'R' OR '&MODE' EQ 'ER' OR '&MODE' EQ 'CR').J-03850000
               LGC                                                  4-0 03900000
         AIF   ('&CG1' EQ '3525').JLG2                              4-0 03950000
         AIF   ('&MODE' EQ 'O' OR '&MODE' EQ 'EO' OR '&MODE' EQ 'CO').J-04000000
               LGC                                                  4-0 04050000
.JLG2    MNOTE 0,'IMPROPER MODE VALUE. EBCDIC ASSUMED.'             4-0 04100000
         AGO   .JLGE                                                4-0 04150000
.JLG2A   MNOTE 0,'MODE VALUE INVALID FOR &CG1 . EBCDIC ASSUMED'      JJ 04200000
         AGO   .JLGE                                                 JJ 04250000
.JLGC    ANOP                                                       4-0 04300000
&FMOD    SETC  '&MODE'(&N,1)                                        4-0 04350000
         AIF   (&N EQ 1).JLGE                                       4-0 04400000
.JLGD    ANOP                                                       4-0 04450000
&DMOD    SETC  '&MODE'(1,1)                                         4-0 04500000
.JLGE    AIF   (T'&FUNC EQ 'O').JLG5                                4-0 04550000
         AIF   ('&CG1' EQ '3505').JLG5                              4-0 04600000
         AIF   ('&CG1' NE '2560').JJ1                                JJ 04650000
&FUNCT   SETC  'FGHIJ'                                               JJ 04700000
         AGO   .JJ2                                                  JJ 04750000
.JJ1     ANOP                                                        JJ 04800000
         AIF   ('&CG1' NE '5425').JJ1A                         @DL2994J 04850000
&FUNCT   SETC  'KLMNO'                                               JJ 04900000
         AGO   .JJ2                                                  JJ 04950000
.JJ1A    ANOP                                                        JJ 05000000
&FUNCT   SETC  'ABCDE'                                              4-0 05050000
.JJ2     ANOP                                                        JJ 05100000
&ASF     SETA  1                                                    4-0 05150000
         AIF   ('&FUNC' EQ 'RP').JLGP                               4-0 05200000
&ASF     SETA  5                                                    4-0 05250000
         AIF   ('&FUNC' EQ 'RPW').JLGP                              4-0 05300000
&ASF     SETA  0                                                    4-0 05350000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').JLGH                        4-0 05400000
         AIF   ('&FUNC' EQ 'R').JLG5                                4-0 05450000
&ASF     SETA  2                                                    4-0 05500000
         AIF   ('&FUNC' EQ 'RW').JLGP                               4-0 05550000
.JLG3    MNOTE 9,'IMPROPER FUNC VALUE.  MACRO NOT GENERATED.'       4-0 05600000
         MEXIT                                                      4-0 05650000
.JLGH    AIF   ('&FUNC' EQ 'P').JLG5                                4-0 05700000
&ASF     SETA  3                                                    4-0 05750000
         AIF   ('&FUNC' EQ 'PW').JLGP                               4-0 05800000
&ASF     SETA  4                                                    4-0 05850000
&NCH     SETA  1                                               @DA08364 05900000
         AIF   ('&FUNC' EQ 'I').JLGP                                4-0 05950000
         AGO   .JLG3                                                4-0 06000000
.JLGP    ANOP                                                       4-0 06050000
&FUN     SETC  '&FUNCT'(&ASF,1)                                     4-0 06100000
         AIF   (&ASF EQ 4).JLG6A                                    4-0 06150000
         AIF   (T'&ASOCFLE NE 'O').JLG5                             4-0 06200000
         MNOTE 9,'MISSING ASOCFLE PARAMETER. MACRO TERMINATED.'     4-0 06250000
         MEXIT                                                      4-0 06300000
.OMR001  AIF   ('&CG1' NE '3881').JLG5                         @DL28701 06350000
         AIF   (T'&OUBLKSZ EQ 'O').JLG5                        @DL28701 06400000
&OBLK881 SETB  1                                               @DL28701 06450000
         MNOTE 0,'OUBLKSZ PARAMETER INVALID. IGNORED.'         @DL28701 06500000
.JLG5    AIF   ('&TYPEFLE' EQ 'OUTPUT').OMR003                 @DL28701 06550000
         AGO   .OMR004                                         @DL28701 06600000
.OMR003  AIF   ('&CG1' NE '3881').D1                           @DL28701 06650000
.OMR004  AIF   (T'&CTLCHR EQ 'O').D3                           @DL28701 06700000
          MNOTE 0,'CTLCHR INVALID PARAMETER. IGNORED'                   06750000
.D3       AIF   (T'&RECFORM EQ 'O' OR '&RECF' EQ 'FIXUNB').D4  @D14BDBF 06800000
          MNOTE 0,'IMPROPER RECFORM. ''FIXUNB'' ASSUMED'                06850000
&RECF     SETC  'FIXUNB'             ASSUME FIXUNB             @D14BDBF 06900000
.D4       AIF   (T'&RECSIZE EQ 'O').D5                                  06950000
          MNOTE 0,'RECSIZE INVALID PARAMETER. IGNORED'                  07000000
          AGO   .D5                                                     07050000
.JLG6A   AIF   ('&DMOD' EQ 'E').JLG6B                               4-0 07100000
         MNOTE 0,'MODE VALUE INVALID FOR FUNC=I. EBCDIC ASSUMED'     JJ 07150000
&DMOD    SETC  'E'                                                  4-0 07200000
.JLG6B   AIF   ('&RECF' EQ 'FIXUNB').D1                        @D14BDBF 07250000
         MNOTE 0,'RECFORM CONFLICTING WITH FUNC=I. FIXUNB ASSUMED'   JJ 07300000
&RECF     SETC  'FIXUNB'             ASSUME RECFORM=FIXUNB     @D14BDBF 07350000
.D1       AIF   (T'&EOFADDR EQ 'O').D5                                  07400000
          MNOTE 0,'EOFADDR INVALID FOR OUTPUT FILE. IGNORED'         JJ 07450000
.D5       ANOP                                                          07500000
         AIF   (T'&BLKSIZE EQ 'N').E00                                  07550000
         AIF   ('&CG1' EQ '3881').OMR011                       @DL28701 07600000
         AIF   ('&CG1' EQ '2596' OR '&CG1' EQ '5425').D5A      @DL2994J 07650000
         AIF   ('&DMOD' NE 'C').JLG7                                4-0 07700000
&BLKS    SETA  160                                                  4-0 07750000
         AGO   .JLG7AA                                              4-0 07800000
.JLG7    ANOP                                                       4-0 07850000
&BLKS    SETA  80                                                   4-0 07900000
         AGO   .JLG7AA                                              4-0 07950000
.D5A     ANOP                                                       4-0 08000000
&BLKS    SETA  96                                                   4-0 08050000
.JLG7AA  AIF   (T'&BLKSIZE EQ 'O').E2                               4-0 08100000
         AGO   .OMR009                                         @DL28701 08150000
.OMR011  ANOP                                                  @DL28701 08200000
&BLKS    SETA  900                                             @DL28701 08250000
.OMR009  MNOTE 0,'IMPROPER BLKSIZE.  SET TO &BLKS.'            @DL28701 08300000
         AGO   .E2                                                      08350000
.E00     ANOP                                                           08400000
&BLKS    SETA  &BLKSIZE                                                 08450000
         AIF   ('&CG1' EQ '3881').OMR013                       @DL28701 08500000
         AIF   (&ASF EQ 4).JLG7A                                    4-0 08550000
         AIF   ('&RECF' NE 'FIXUNB').E2                        @D14BDBF 08600000
.JLG7A   ANOP                                                       4-0 08650000
         AIF   ('&CTLCHR' NE '' AND '&TYPEFLE' EQ 'OUTPUT').Q1          08700000
         AIF   (&BLKS LE 80).E2                                         08750000
         AIF   ('&DMOD' EQ 'C').JLG8                                4-0 08800000
         AIF   ('&CG1' EQ '2596' OR '&CG1' EQ '5425').E01      @DL2994J 08850000
         AIF   (&BLKS LE 512).E2                               @D14BDBF 08900000
&BLKS    SETA  512                                             @D14BDBF 08950000
         AGO   .Q15                                            @D14BDBF 09000000
.JLG8    AIF   (&BLKS LE 160).E2                                    4-0 09050000
&BLKS    SETA  160                                                  4-0 09100000
         AGO   .Q15                                                 4-0 09150000
.E01     AIF   (&BLKS LE 96).E2                                     4-0 09200000
&BLKS    SETA  96                                                   4-0 09250000
         AGO   .Q15                                                 4-0 09300000
.Q1      AIF   ('&DMOD' NE 'C').JLG10                               4-0 09350000
         AIF   (&BLKS LE 161).E2                                    4-0 09400000
&BLKS    SETA  161                                                  4-0 09450000
         AGO   .Q15                                                 4-0 09500000
.JLG10   AIF   (&BLKS LE 81).E2                                     4-0 09550000
         AIF   ('&CG1' EQ '2596' OR '&CG1' EQ '5425').E02      @DL2994J 09600000
&BLKS    SETA  81                                                   4-0 09650000
         AGO   .Q15                                                 4-0 09700000
.OMR013  AIF   ('&BLKS' LE '900').E2                           @DL28701 09750000
&BLKS    SETA  900                                             @DL28701 09800000
         AGO   .Q15                                            @DL28701 09850000
.E02     AIF   (&BLKS LE 97).E2                                     4-0 09900000
&BLKS    SETA  97                                                   4-0 09950000
.Q15     MNOTE 0,'BLKSIZE GREATER THAN &BLKS . &BLKS ASSUMED'           10000000
.E2      AIF   (T'&IOAREA1 NE 'O').E025                                 10050000
         MNOTE 0,'NO IOAREA1 SPECIFIED, SET TO 0'                   3-8 10100000
&IOA1    SETC  '0'                                                  3-8 10150000
         AGO   .EG1                                                     10200000
.E025    ANOP                                                           10250000
&IOA1    SETC  '&IOAREA1'                                               10300000
.EG1      AIF   ('&CG1' NE '2501').REL                                  10350000
          AIF   ('&CONTROL' EQ '').UVW                                  10400000
          MNOTE 0,'CONTROL INVALID PARAMETER. IGNORED'                  10450000
.UVW      AIF   ('&CTLCHR' EQ '' OR '&TYPEFLE' NE 'OUTPUT').EC92        10500000
          MNOTE 0,'CTLCHR INVALID PARAMETER. IGNORED'                   10550000
          AGO  .EC92                                                    10600000
.REL      ANOP                                                          10650000
&CNTL    SETC  'C'                                                      10700000
         AIF   (T'&CONTROL EQ 'O').EC91                             4-0 10750000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').JLG11                       4-0 10800000
         AIF   ('&CG1' EQ '3881').JLG11                        @DL28701 10850000
         AIF   (&ASF NE 1 AND &ASF NE 5).JLG11                      4-0 10900000
         MNOTE 0,'CNTRL IN READ/PUNCH OR READ/PUNCH/PRINT IS INVALID.  X10950000
               IGNORED.'                                            4-0 11000000
         AGO   .EC92                                                4-0 11050000
.JLG11   AIF   ('&CONTROL' EQ 'YES').EC93                           4-0 11100000
          MNOTE 0,'IMPROPER CONTROL. ''YES'' ASSUMED'                   11150000
.EC93    AIF   (T'&CTLCHR EQ 'O').EC9                                   11200000
         AIF   ('&TYPEFLE' NE 'OUTPUT').EC9                             11250000
          MNOTE 0,'BOTH CTLCHR AND CONTROL SPECIFIED.ONLY CONTROL ASSUM*11300000
               ED'                                                      11350000
         AGO   .EC9                                                     11400000
.EC91    AIF   ('&TYPEFLE' NE 'OUTPUT').EC92                            11450000
         AIF   ('&CG1' EQ '3881').EC92                         @DL28701 11500000
&CNTL    SETC  'A'                                                      11550000
         AIF   ('&CTLCHR' EQ  'ASA').EC9                                11600000
&CNTL    SETC  'Y'                                                      11650000
         AIF   ('&CTLCHR'  EQ 'YES').EC9                                11700000
         AIF   ('&CTLCHR'  EQ '').EC92                                  11750000
          MNOTE 0,'IMPROPER CTLCHR. ''YES'' ASSUMED'                    11800000
         AGO   .EC9                                                     11850000
.EC92    ANOP                                                           11900000
&CNTL    SETC  'Z'                                                      11950000
.EC9     ANOP                                                           12000000
&WKIO    SETC  'Z'                                                      12050000
         AIF   ('&TYPEFLE' EQ 'CMBND').EC95                             12100000
         AIF   (T'&IOAREA2 EQ 'O').OMR018                      @DL28701 12150000
         AIF   ('&CG1' EQ '3881').JLG12                        @DL28701 12200000
         AIF   (&ASF EQ 0).JLG12                                    4-0 12250000
         MNOTE 0,'TWO I/O AREA NOT ALLOWED WITH DEVICE ASSOCIATED FILE.X12300000
                 ONLY ONE I/O AREA ASSUMED.'                        4-0 12350000
         AIF   (T'&IOREG EQ 'O').JLG14                              4-0 12400000
         MNOTE 9,'IOREG ALSO SPECIFIED.MACRO GENERATION TERMINATED' 4-0 12450000
         MEXIT                                                      4-0 12500000
.JLG12   ANOP                                                       4-0 12550000
&IOA2    SETC  '&IOAREA2'                                           4-0 12600000
         AIF   (T'&CONTROL  EQ 'O' OR '&TYPEFLE' EQ 'OUTPUT').EC9A      12650000
.*                                                             @DA00011 12700000
          MNOTE 9,'BOTH CONTROL AND IOAREA2 SPECIFIED ON AN INPUT FILE *12750000
               MACRO GENERATION TERMINATED'                        3-10 12800000
         MEXIT                                                     3-10 12850000
.EC9A    ANOP                                                      3-10 12900000
&AL4      SETA  &AL4+4                                                  12950000
&WKIO    SETC  'I'                                                      13000000
         AGO   .OMR019                                         @DL28701 13050000
.OMR018  AIF   ('&CG1' NE '3881').JLG14                        @DL28701 13100000
&IOA2    SETC  '0'                                             @DL28701 13150000
.OMR019  AIF   (T'&WORKA EQ 'O').EC10                          @DL28701 13200000
         AIF   ('&CG1' NE '3881').OMR015                       @DL28701 13250000
         MNOTE 0,'WORKA PARAMETER INVALID. IGNORED.'           @DL28701 13300000
         AGO   .EC10                                           @DL28701 13350000
.OMR015  AIF   ('&WORKA' EQ 'YES').HARA1                       @DL28701 13400000
          MNOTE 0,'IMPROPER WORKA. ''YES'' ASSUMED'                     13450000
.HARA1    ANOP                                                          13500000
&WKIO    SETC  'B'                                                      13550000
         AGO   .EC10                                                    13600000
.JLG14   ANOP                                                       4-0 13650000
&IOA2    SETC  '0'                                                  4-0 13700000
.EC95    ANOP                                                       3-3 13750000
         AIF   (T'&WORKA EQ 'O').EC10                               3-3 13800000
          AIF   ('&WORKA' EQ 'YES').HARA2                               13850000
          MNOTE 0,'IMPROPER WORKA. ''YES'' ASSUMED'                     13900000
.HARA2    ANOP                                                          13950000
&WKIO    SETC  'W'                                                      14000000
.EC10    ANOP                                                           14050000
         AIF   ('&CG1' EQ '3881').EC105                        @DL28701 14100000
         AIF   ('&TYPEFLE' NE 'OUTPUT').EC105                           14150000
         AIF   ('&RECF' EQ 'FIXUNB').EG125                     @D14BDBF 14200000
         AIF   (&ASF EQ 4).EG125      IS FUNC='I'                   4-0 14250000
         AIF   ('&RECF' EQ 'VARUNB').EG125                     @D14BDBF 14300000
         AIF   ('&RECF' EQ 'UNDEF').EG125                      @D14BDBF 14350000
         MNOTE 0,'IMPROPER RECFORM. ''FIXUNB'' ASSUMED.'       @DL28701 14400000
         AGO   .EG125                                                   14450000
.EC105   AIF   (T'&EOFADDR NE 'O').EG125                       @D14BDBF 14500000
          MNOTE 0,'NO EOFADDR SPECIFIED. SET TO *'                      14550000
.EG125   AIF   ('&TYPEFLE' EQ 'CMBND').EC1                              14600000
&IOG      SETC  '2'                                                     14650000
          AIF   (T'&IOAREA2 NE 'O').A1                              4-0 14700000
          AIF   (T'&IOREG EQ 'O').A10                                   14750000
          MNOTE 0,'IOREG STATED FOR FILE WITH ONLY ONE IOAREA. IGNORED' 14800000
          AGO   .A3                                                     14850000
.A1       AIF   (T'&IOREG NE 'O').A2                                    14900000
          AIF   (T'&WORKA NE 'O').A10                                   14950000
         AIF   (K'&FUNC GT 1 OR '&FUNC' EQ 'I').A10                  JJ 15000000
          AIF   ('&CG1' EQ '3881').OMR014                      @DF00133 15050000
          MNOTE 0,'NEITHER IOREG NOR WORKA STATED FOR A 2 IOAREAS FILE.*15100000
                 WORKA ASSUMED'                                         15150000
         AGO   .OMR016                                         @DF00133 15200000
.OMR014  ANOP                                                  @DF00133 15250000
         MNOTE 9,'IOREG NOT SPECIFIED FOR 3881 FILE WITH 2 IOAREAS. MACX15300000
               RO NOT GENERATED.'                              @DM01566 15350000
         MEXIT                                                 @DF00133 15400000
.OMR016  ANOP                                                  @DF00133 15450000
&WKIO    SETC  'B'                                                      15500000
          AGO   .A10                                                    15550000
.A2      AIF   ('&CG1' EQ '3881').A3                           @DL28701 15600000
         AIF   (T'&WORKA EQ 'O').A3                            @DL28701 15650000
         AIF   ('&CG1' NE '2560').A222                               JJ 15700000
         MNOTE 0,'BOTH IOREG AND WORKA SPECIFIED. IOREG IGNORED'     JJ 15750000
&WKIO    SETC  'B'                                                   JJ 15800000
         AGO   .A10                                                  JJ 15850000
.A222     MNOTE 0,'BOTH IOREG AND WORKA STATED. BOTH CONSIDERED'     JJ 15900000
.A3      AIF   ('&WKIO' NE 'I').A10                                  JJ 15950000
         AIF   (T'&IOREG(1) EQ 'N').A4                               JJ 16000000
          AGO   .A5                                                     16050000
.A4      AIF   ('&IOREG(1)' GE '2' AND '&IOREG(1)' LT '13').A6 @DA14034 16100000
.A5       MNOTE 0,'IMPROPER IOREG. SET TO REG 2'                        16150000
          AGO   .A10                                                    16200000
.A6       ANOP                                                          16250000
&IOG      SETC  '&IOREG(1)'                                             16300000
.A10      ANOP                                                          16350000
         AIF   ('&CG1' EQ '3881').F1                           @DL28701 16400000
          AIF   ('&TYPEFLE' NE 'OUTPUT').F1                             16450000
          AIF   ('&CRDERR' EQ '').F10                          @DA02230 16500000
          AIF   (T'&CRDERR EQ 'O').F10                                  16550000
&AL1     SETC  '5'                                                  4-0 16600000
         AIF   ('&CG1' EQ '2520').F2                                    16650000
&AL1     SETC  '4'                                                  4-0 16700000
          AIF   ('&CG1' EQ '2540').F2                                   16750000
          AGO   .F9                                                     16800000
.F2       AIF   ('&CRDERR' EQ 'RETRY').R30                              16850000
          MNOTE 0,'IMPROPER CRDERR. ''RETRY'' ASSUMED'                  16900000
          AGO   .R30                                                    16950000
          AIF   ('&CRDERR' EQ '').F10                          @DA02230 17000000
.F1       AIF   (T'&CRDERR EQ 'O').F10                                  17050000
.F9       MNOTE 0,'CRDERR INVALID PARAMETER. IGNORED'                   17100000
.F10      ANOP                                                          17150000
&AL1     SETC  '&FUN'                                               4-0 17200000
         AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').JJ7     @DL2994J 17250000
         AIF   ('&CG1' NE '2560').F10A                               JJ 17300000
&SWS     SETA  128+&SWS                                              JJ 17350000
         AGO   .F10B                                                 JJ 17400000
.F10A    AIF   ('&CG1' NE '5425').F10B                         @DL2994J 17450000
&SWS     SETA  64+&SWS                                               JJ 17500000
.F10B    ANOP                                                        JJ 17550000
&STACKER SETA  16                                                    JJ 17600000
&EOFL    SETA  2                                                     JJ 17650000
         AIF   ('&DMOD'  NE 'C').JJ3                                 JJ 17700000
&COLBIN  SETA  32                                                    JJ 17750000
&EOFL    SETA  4                                                     JJ 17800000
.JJ3     AIF   (K'&DEVICE LT 5).JJ4A                                 JJ 17850000
         AIF   ('&DEVICE'(5,1) NE 'S').JJ4                           JJ 17900000
&STACKER SETA  80                                                    JJ 17950000
&HOPPER  SETA  128                                                   JJ 18000000
         AIF   ('&CG1' NE '5425').R30                          @DL2994J 18050000
&STACKER SETA  64                                              @DL2994J 18100000
         AGO   .R30                                                  JJ 18150000
.JJ4     AIF   ('&DEVICE'(5,1) EQ 'P').R30                           JJ 18200000
.JJ4A    MNOTE 0,'INVALID DEVICE PARAMETER. ''&CG1.P'' ASSUMED'      JJ 18250000
         AGO   .R30                                                  JJ 18300000
.JJ7     AIF   ('&CG1' EQ '3525').R30                                JJ 18350000
&AL1     SETC  '6'                                                  4-0 18400000
         AIF   ('&CG1' EQ '3505' AND '&TYPEFLE' EQ 'INPUT').R30     4-0 18450000
&AL1     SETC '3'                                                   4-0 18500000
.R24     AIF   ('&CG1' EQ '2501' AND '&TYPEFLE' EQ 'INPUT').R30         18550000
&AL1     SETC  '2'                                                  4-0 18600000
         AIF   ('&CG1' EQ '2520').R30                                   18650000
&AL1     SETC  '1'                                                  4-0 18700000
         AIF   ('&CG1' EQ '2596').R30                               4-0 18750000
         AIF   ('&CG1' EQ '1442').R30                                   18800000
&AL1     SETC  'P'         DEVICE A 3881 ?                     @DA28247 18850000
         AIF   ('&CG1' EQ '3881' AND '&TYPEFLE' EQ 'INPUT').R30 DL28701 18900000
&AL1     SETC  '0'         DEVICE A 2540                       @DA28247 18950000
         AIF   ('&CG1' EQ '2540').R30                                   19000000
          MNOTE 0,'IMPROPER DEVICE. ''2540'' ASSUMED'                   19050000
&CG1      SETC  '2540'                                                  19100000
&RPB     SETB  0                                                    4-0 19150000
&DMOD    SETC  'E'                                                  4-0 19200000
.R30     AIF   ('&TYPEFLE' EQ 'INPUT').ER1                              19250000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').E10                             19300000
          MNOTE 0,'IMPROPER TYPEFLE. ''INPUT'' ASSUMED'                 19350000
.ER1     ANOP                                                           19400000
&BL1     SETB  1                                                        19450000
         AIF   ('&CONTROL' EQ '').ER30                                  19500000
         AIF   ('&CG1' EQ '1442' OR '&CG1' EQ '2596' OR '&SSELECT' EQ 'X19550000
               ').E0125                                             4-0 19600000
         MNOTE 0,'SSELECT AND CONTROL SPEC. FOR DEVICE OTHER THAN 1442 X19650000
               OR 2596. CONTROL IGNORED'                            4-0 19700000
.ER30    ANOP                                                           19750000
&CNTL    SETC  'Z'                                                      19800000
         AGO   .E0125                                                   19850000
.E10     AIF   ('&RECF' NE 'UNDEF').E03                        @D14BDBF 19900000
&RECZ     SETC  '2'                                                     19950000
          AIF   ('&RECSIZE' NE '').B1                                   20000000
         AGO   .B3                                                      20050000
.B1       AIF   (T'&RECSIZE(1) EQ 'N').B2                               20100000
          AGO   .B3                                                     20150000
.B2       AIF   ('&RECSIZE(1)' GE '2' AND '&RECSIZE(1)' LE '12').B4     20200000
.B3       MNOTE 0,'IMPROPER RECSIZE. SET TO REG 2'                      20250000
         AGO   .E06                                                     20300000
.B4       ANOP                                                          20350000
&RECZ     SETC  '&RECSIZE(1)'                                           20400000
          AGO   .E06                                                    20450000
.E03     AIF   ('&RECSIZE' EQ '').E04                                   20500000
         MNOTE 0,'RECSIZE INVALID PARAMETER. IGNORED'                   20550000
.E04     AIF   ('&RECF' NE 'VARUNB').E05                       @D14BDBF 20600000
&AL4     SETA  &AL4+8                  UPDATE SWITCH FOR VARUNB         20650000
&AL2     SETA  &AL2+4                  ADD FOUR IN IOAR CORRECT.=VARUNB 20700000
         AGO   .E06                                                     20750000
.E05     ANOP                                                           20800000
&AL4     SETA  &AL4+16                 UPDATE SWITCH FOR FIXED          20850000
.E06     AIF   ('&WKIO' EQ 'Z' OR '&WKIO' EQ 'I').E010                  20900000
&AL4     SETA  &AL4+2                  UPDATE SWITCH FOR WORKA          20950000
.E010     AIF   ('&CNTL' EQ 'Z' OR '&CNTL' EQ 'C').E0125                21000000
&AL4     SETA  &AL4+32                 UPDATE SWITCH FOR CTLCHR         21050000
&AL2     SETA  &AL2+1                  ADD 1 IN IOAR CORRECT.=CTLCHR    21100000
         AGO   .E0125                                                   21150000
.EC1     ANOP                                                           21200000
&AL1     SETC  '1'                                                  4-0 21250000
       AIF ('&CG1' EQ '1442').EC5                                       21300000
&AL1     SETC  '2'                                                  4-0 21350000
       AIF ('&CG1' EQ '2520').EC5                                       21400000
&AL1     SETC  '0'                                                  4-0 21450000
       AIF ('&CG1' EQ '2540').EC5                                       21500000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').EC5AA    @DL2994J 21550000
&OBLK881 SETB  ('&CG1' EQ '3881')                              @DM01565 21600000
         AIF   ('&CG1' NE '2596').EC5A                              4-0 21650000
.EC5AA   MNOTE 0,'COMBINED FILES NOT ALLOWED FOR &CG1 . MACRO NOT GENER*21700000
               ATED'                                                 JJ 21750000
         MEXIT                                                      4-0 21800000
.EC5A    MNOTE 0,'IMPROPER DEVICE. ''2540'' ASSUMED'                4-0 21850000
&CG1  SETC '2540'                                                       21900000
&RPB     SETB  0                                                    4-0 21950000
.EC5     AIF   (T'&IOAREA2 EQ 'O').EC11                                 22000000
&IOA2    SETC  '&IOAREA2'                                               22050000
         AIF   (T'&OUBLKSZ EQ 'O').EC12                                 22100000
         AIF   (T'&OUBLKSZ EQ 'N').EC105A                               22150000
          MNOTE 0,'IMPROPER OUBLKSZ. SET TO 80'                         22200000
&OUBL    SETA  80                                                       22250000
         AGO   .E0125                                                   22300000
.EC105A  ANOP                                                           22350000
&OUBL    SETA  &OUBLKSZ                                                 22400000
         AIF   (&OUBL LE 80).E0125                                      22450000
         AIF   (&OBLK881).OMR030                               @DF00433 22500000
         MNOTE 0,'OUBLKSZ GREATER THAN 80 . 80 ASSUMED'                 22550000
&OUBL    SETA  80                                                       22600000
         AGO   .E0125                                                   22650000
.EC11    ANOP                                                           22700000
&IOA2   SETC  '&IOA1'                                                   22750000
.EC12    ANOP                                                           22800000
         AIF   (NOT &OBLK881).OMR031                           @DF00433 22850000
.OMR030  ANOP                                                  @DF00433 22900000
&BLKS    SETA  80     PREVENT MVC GEN WITH TOO BIG DATA LENGTH @DF00433 22950000
.OMR031  ANOP                                                  @DF00433 23000000
&OUBL    SETA  &BLKS                                                    23050000
.E0125   AIF   ('&CG1' EQ '3525').JLG20                             4-0 23100000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').JLG20    @DL2994J 23150000
         AIF   (T'&FUNC EQ 'O').JLG15                               4-0 23200000
         MNOTE 0,'INVALID FUNC PARAMETER FOR &CG1 . IGNORED'         JJ 23250000
.JLG15   AIF   ('&CG1' EQ '3505').JLG20                             4-0 23300000
         AIF   (T'&MODE EQ 'O').JLG17                               4-0 23350000
         MNOTE 0,'INVALID MODE PARAMETER FOR &CG1 . IGNORED'         JJ 23400000
.JLG17   AIF   (T'&ERROPT EQ 'O').JLG18                             4-0 23450000
         MNOTE 0,'INVALID ERROPT PARAMETER FOR &CG1.. IGNORED'       JJ 23500000
.JLG18   AIF   (T'&ASOCFLE EQ 'O').JLG32                            4-0 23550000
         MNOTE 0,'INVALID ASOCFLE PARAMETER FOR &CG1 . IGNORED'      JJ 23600000
         AGO   .JLG32                                               4-0 23650000
.JLG20 ANOP                                                         4-0 23700000
&AL5     SETA  &AL5+&ASF                                            4-0 23750000
         AIF   (T'&ERROPT EQ 'O').JLG22                             4-0 23800000
         AIF   ('&TYPEFLE' NE 'OUTPUT').JLG21                       4-0 23850000
         AIF   ('&ERROPT' EQ 'IGNORE').JG20                         4-0 23900000
         MNOTE 0,'INVALID ERROPT PARAMETER FOR OUTPUT FILE. IGNORED' JJ 23950000
         AGO   .JLG22                                               4-0 24000000
.JG20    AIF   ('&IOA2' EQ '0' AND T'&WORKA EQ 'O').JG21            4-0 24050000
         MNOTE 0,'WORKA/IOAREA2 AND ERROPT SPEC. ERROPT IGNORED.'   4-0 24100000
         AGO   .JLG22                                               4-0 24150000
.JG21    ANOP                                                       4-0 24200000
         AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').JG21A   @DL2994J 24250000
         AIF   (&ASF EQ 0).JG21A                                     JJ 24300000
         MNOTE 0,'ERROPT CONFLICTS WITH FUNC PARAMETER. IGNORED'     JJ 24350000
         AGO   .JLG30                                                JJ 24400000
.JG21A   ANOP                                                        JJ 24450000
&E       SETA  4                                                    4-0 24500000
.JLG21   ANOP                                                       4-0 24550000
&AL5     SETA  &AL5+64                                              4-0 24600000
&E       SETA  &E+2                                                 4-0 24650000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').JLG30    @DL2994J 24700000
         AIF   (&ASF NE 2).JLG22                                    4-0 24750000
&E       SETA  &E+4                                                 4-0 24800000
.JLG22   ANOP                                                       4-0 24850000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').JLG30    @DL2994J 24900000
         AIF   ('&FMOD' EQ 'Z').JLG26                               4-0 24950000
         AIF   ('&FMOD' EQ 'R').JLG24                               4-0 25000000
&AL5     SETA  &AL5+128                                             4-0 25050000
.JLG24   ANOP                                                       4-0 25100000
&FLAG    SETA  8                                                    4-0 25150000
.JLG26   AIF   ('&CG1' EQ '3505').JLG28                             4-0 25200000
&AL6     SETA  &AL6+16                                              4-0 25250000
         AGO   .JLG30                                               4-0 25300000
.JLG28   ANOP                                                       4-0 25350000
&AL6     SETA  &AL6+8                                               4-0 25400000
.JLG30   AIF   (&ASF NE 0 AND &ASF NE 4).JLG32                       JJ 25450000
         AIF   (T'&ASOCFLE EQ 'O').JLG32                             JJ 25500000
         MNOTE 0,'ASOCFLE SPECIFIED FOR SINGLE FILE. IGNORED'        JJ 25550000
.JLG32   AIF   (T'&SEPASMB EQ 'O').NEW2                             4-0 25600000
         AIF   ('&SEPASMB' EQ 'YES').NEW3                               25650000
         MNOTE 0,'IMPROPER SEPASMB.''YES'' ASSUMED'                     25700000
.NEW3    AIF   (T'&NAME NE 'O').NEW1                                    25750000
         MNOTE 9,'NO FILENAME SPECIFIED.GENERATION TERMINATED'          25800000
         MEXIT                                                          25850000
.NEW1    PUNCH ' CATALOG &NAME..OBJ   REPLACE=YES '            @DA35316 25900000
&NAME.C  CSECT                                                          25950000
         ENTRY &NAME                                                    26000000
.NEW2    DC    0D'0'                                                    26050000
         AIF   ('&AL1' GT '3' AND '&AL1' LT '6' AND '&TYPEFLE' EQ 'OUTP-26100000
               UT').E013                                            4-0 26150000
         AIF   ('&CG1' NE '2560').JJ9                          @DA06223 26200000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').JJ9A                   @DA06223 26250000
         AIF   (&ASF NE 0).JJ9                                 @DA06223 26300000
.JJ9A    ANOP                                                  @DA06223 26350000
&NCH     SETA  1                                                     JJ 26400000
.JJ9     ANOP                                                        JJ 26450000
&NAME    DC    X'00008&E.0&NCH.0000'     RES. COUNT, COM. BYTES STATUJJ 26500000
         AGO   .E014                                                    26550000
.E013    ANOP                                                           26600000
&NAME    DC    X'000084000400'         RES. COUNT,COM. BYTES,STATUS BTS 26650000
.E014    AIF   ('&DEVADDR' EQ '').E050                                  26700000
          AIF   (K'&DEVADDR NE 6).E050                                  26750000
          AIF   ('&DEVADDR'(1,3) NE 'SYS').E050                         26800000
&CG2     SETC  '&DEVADDR'(4,3)                                          26850000
          AIF   ('&CG1' NE '3881').OMR020                      @DL28701 26900000
         AIF   ('&CG2' EQ 'RDR').OMR021                        @DL28701 26950000
         AIF   ('&CG2' EQ 'IPT').OMR021                        @DL28701 27000000
         AIF   ('&CG2' EQ 'PCH').OMR021                        @DL28701 27050000
         AGO   .OMR020                                         @DL28701 27100000
.OMR021  MNOTE 9,'DEVADDR INVALID PARAMETER. MACRO NOT GENERATED.      X27150000
               '                                               @DL28701 27200000
         MEXIT                                                 @DL28701 27250000
.OMR020  AIF   ('&CG2' LT '000' OR '&CG2' GT '254').E052       @DL28701 27300000
.*                                                             @DA31417 27350000
          AIF   ('&CG2'(2,1) LT '0' OR '&CG2'(2,1) GT '9' OR '&CG2'(3,1*27400000
               )  LT '0' OR '&CG2'(3,1) GT '9').E050                    27450000
&AL8     SETA  1                                                        27500000
&AL9     SETA  &CG2                                                     27550000
         AGO   .E051                                                    27600000
.E052    AIF   ('&CG1' EQ '2501' AND ('&CG2' EQ 'RDR' OR '&CG2' EQ 'IPT*27650000
               ') AND T'&IOAREA2 NE 'O').E050F                 @D33FDVS 27700000
         AGO   .E050G                                          @D33FDVS 27750000
.E050F   ANOP                                                  @D33FDVS 27800000
&BL2     SETB  1                                               @D33FDVS 27850000
.E050G   ANOP                                                  @D33FDVS 27900000
         AIF   ('&CG2' EQ 'RDR' OR '&CG2' EQ 'IPT' AND &BL1).E050X   JJ 27950000
         AIF   ('&CG2' EQ 'PCH' AND NOT &BL1).E050X                  JJ 28000000
         AIF   ('&CG2' EQ 'RDR' OR '&CG2' EQ 'IPT').E050Y            JJ 28050000
         AIF   ('&CG2' NE 'PCH').E050                                JJ 28100000
.E050Y   MNOTE 0,'DEVADDR CONFLICTS WITH TYPEFLE PARAMETER. ''FFFF'' GE*28150000
               NERATED'                                              JJ 28200000
         AGO   .E050A                                                JJ 28250000
.E050X   AIF   (&ASF EQ 0).E052A                                     JJ 28300000
         MNOTE 0,'DEVADDR CONFLICTS WITH FUNC PARAMETER. ''FFFF'' GENER*28350000
               ATED'                                                 JJ 28400000
         AGO   .E050A                                                JJ 28450000
.E052A   AIF   ('&DMOD' EQ 'E' AND '&FMOD' EQ 'Z').E052B             JJ 28500000
         MNOTE 0,'DEVADDR CONFLICTS WITH MODE PARAMETER. ''FFFF'' GENER*28550000
               ATED'                                                 JJ 28600000
         AGO   .E050A                                                JJ 28650000
.E052B   AIF   ('&CG1' EQ '2596').E050                               JJ 28700000
         AIF   ('&CG2' EQ 'RDR'  AND &BL1).E051                     4-0 28750000
&AL9     SETA  1                                                        28800000
         AIF   ('&CG2' EQ 'IPT' AND &BL1).E051                          28850000
&AL9     SETA  2                                                        28900000
         AIF   ('&CG2' EQ 'PCH' AND NOT &BL1).E051                      28950000
.E050     ANOP                                                          29000000
          MNOTE 0,'IMPROPER OR MISSING DEVADDR. ''FFFF'' GENERATED'  JJ 29050000
.E050A   ANOP                                                        JJ 29100000
&AL8     SETA  255                                                      29150000
&AL9     SETA  255                                                      29200000
.E051    DC    AL1(&AL8)               LOGICAL UNIT CLASS               29250000
         DC    AL1(&AL9)               LOGICAL UNIT                     29300000
         AIF   ('&CG1' EQ '2520' AND '&TYPEFLE' EQ 'OUTPUT').E051A      29350000
         AIF   ('&CG1' NE '5425' OR '&TYPEFLE' EQ 'OUTPUT').JJ6A     JJ 29400000
         AIF   ('&CNTL' NE 'C' AND T'&SSELECT EQ 'O').JJ6A     @DL2994J 29450000
         DC    A(IJCZ&SFX)             CCW ADDRESS             @DL2994J 29500000
          AGO   .E051B                                         @DL2994J 29550000
.JJ6A    AIF   (&BL2).JJ6B                                     @D33FDVS 29600000
         DC    A(IJCX&SFX)             CCW ADDRESS             @D33FDVS 29650000
          AGO   .E051B                                                  29700000
.JJ6B     DC    X'80'                  2501 DOUBLE CCB SUPPORT @D33FDVS 29750000
          DC    AL3(IJCX&SFX)          CCW ADDRESS             @D33FDVS 29800000
          AGO   .E051B                                         @D33FDVS 29850000
.E051A    DC    A(*+40)                CCW2 ADDRESS                     29900000
.E051B    DC    4X'00'                 CCB-ST BYTE,CSW CCW ADDR.        29950000
         AIF   ('&TYPEFLE' EQ 'CMBND').EC15                         4-0 30000000
         DC    AL1(&AL5)        SWITCH 3                            4-0 30050000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').P13                         4-0 30100000
&AL4     SETA  &AL4+&AL6                                            4-0 30150000
         AIF   (T'&MODNAME EQ 'O').E055                             4-0 30200000
         DC    VL3(&MODNAME)    ADDRESS OF LOGIC MODULE             4-0 30250000
         AGO   .E057                                                4-0 30300000
.E055    ANOP                                                       4-0 30350000
          AIF   (T'&RDONLY EQ 'O').E055AA                           3-3 30400000
          AIF   ('&RDONLY' EQ 'YES').E055AB                         3-3 30450000
          MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED.'               3-3 30500000
.E055AB  DC    VL3(IJCF&CNTL.H&WKIO&AL1)  ADDRESS OF LOGIC MODULE   3-3 30550000
         AGO   .E057                                                3-3 30600000
.E055AA  DC    VL3(IJCF&CNTL.I&WKIO&AL1) ADDRESS OF LOGIC MODULE    3-3 30650000
.E057    AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').JJ12    @DL2994J 30700000
         DC    X'05'   DTF TYPE (CARD READER EXTENSION)              JJ 30750000
         DC    AL1(&AL4)                                             JJ 30800000
&RCC     SETA  2+&HOPPER+&COLBIN                                     JJ 30850000
         AIF   ('&CG1' NE '5425').JJ11A                        @DL2994J 30900000
&AL2     SETA  &HOPPER+3                                       @DL2994J 30950000
         AIF   (T'&SSELECT EQ 'O').JJ20AA                      @DL2994J 31000000
         AIF   ('&FUNC' NE 'RP' AND '&FUNC' NE 'RPW').JJ21AA   @DL2994J 31050000
         MNOTE 0,'SSELECT WITH FUNC=''RP'' OR ''RPW''. IGNORED'         31100000
         AGO   .JJ20AA                                         @DL2994J 31150000
.JJ21AA  AIF   (T'&SSELECT NE 'N').JJ22A                       @DL2994J 31200000
         AIF   ('&SSELECT' GE '1' AND '&SSELECT' LE '4').JJ24A @DL2994J 31250000
.JJ22A   MNOTE 0,'INVALID SSELECT PARAMETER. IGNORED'          @DL2994J 31300000
         AGO   .JJ20AA                                         @DL2994J 31350000
.JJ24A   ANOP                                                  @DL2994J 31400000
&STACKER SETA  16*&SSELECT                                     @DL2994J 31450000
.JJ20AA  ANOP                                                  @DL2994J 31500000
&AL2     SETA  &AL2+&STACKER                                   @DL2994J 31550000
         DC    AL1(&AL2)  SS COMMAND CODE                      @DL2994J 31600000
         DC    AL1(&AL2)  SS COMMAND CODE                      @DL2994J 31650000
         AGO   .ER15A                                          @DL2994J 31700000
.JJ11A   DC    AL1(&RCC)  READ COMMAND CODE                    @DL2994J 31750000
         DC    AL1(&RCC)  READ COMMAND CODE                          JJ 31800000
         AGO   .ER15A                                                JJ 31850000
.JJ12    DC    X'02'                   DTF TYPE (READER)             JJ 31900000
         AIF   ('&CG1' NE '2540' AND '&CG1' NE '3881').ER2A    @DA09604 31950000
&AL4     SETA  &AL4+1                                                   32000000
.ER2A    AIF   ('&CG1' NE '2520').ER2B                                  32050000
&AL4     SETA  &AL4+2                                                   32100000
.ER2B    AIF   ('&CG1' NE '1442' AND '&CG1' NE '2596').ER2          4-0 32150000
&AL4     SETA  &AL4+32                                                  32200000
.ER2     DC    AL1(&AL4)               SWITCHES                         32250000
         AIF   ('&CG1' EQ '3525' AND &ASF NE 0).JLG50               4-0 32300000
.JLG40   ANOP                                                       4-0 32350000
         AIF   ('&SSELECT' NE '').ER9                                   32400000
&AL2     SETA  2                                                        32450000
         AGO   .ER10                                                    32500000
.ER9     AIF   ('&CG1' NE '3881').OMR022                       @DL28701 32550000
         MNOTE 0,'SSELECT PARAMETER INVALID. IGNORED.'         @DL28701 32600000
&AL2     SETA  2                                               @DL28701 32650000
         AGO   .ER10                                           @DL28701 32700000
.OMR022  ANOP                                                  @DL28701 32750000
&AL2     SETA  64*&SSELECT-62                                           32800000
         AIF   (&AL2 LE 130).ER10                                       32850000
.ER9A    ANOP                                                  @DA00011 32900000
         MNOTE 0,'IMPROPER SSELECT. SET TO 1'                           32950000
&AL2     SETA  2                                                        33000000
.ER10    AIF   ('&CG1' EQ '2540').ER14                                  33050000
         AIF   ('&CG1' EQ '3881').ER14                         @DL28701 33100000
         AIF   (NOT &RPB).JLG44                                     4-0 33150000
.JLG43   ANOP                                                       4-0 33200000
&AL2     SETA  &AL2+&FLAG                                           4-0 33250000
         AIF   ('&DMOD' NE 'C').ER14                                4-0 33300000
&RPA     SETA  1                                                    4-0 33350000
&AL2     SETA  &AL2+32                                              4-0 33400000
         AGO   .ER14                                                4-0 33450000
.JLG44   ANOP                                                       4-0 33500000
         AIF   (&AL2 LE 66).ER11                                        33550000
         MNOTE 0,'IMPROPER SSELECT. SET TO 1'                           33600000
&AL2     SETA  2                                                        33650000
.ER11    AIF   ('&CG1' EQ '1442' OR '&CG1' EQ '2520' OR '&CG1' EQ '2596X33700000
               ').ER14                                              4-0 33750000
         AIF   (&AL2 LE 2).ER14                                         33800000
         MNOTE 0,'IMPROPER SSELECT. SET TO 1'                           33850000
&AL2     SETA  2                                                        33900000
.ER14    AIF   ('&CNTL' NE 'C' OR '&CG1' EQ '1442' OR '&CG1' EQ '2596')X33950000
               .ER15                                                4-0 34000000
         DC    AL1(&AL2+192)     NORMAL COMM. CODE                  4-0 34050000
         DC    AL1(&AL2+&RPA)     CNTRL COMM. CODE                  4-0 34100000
         AGO   .ER15A                                               3-7 34150000
.ER15    DC    AL1(&AL2)               NORMAL COMM.CODE                 34200000
         DC    AL1(&AL2)               CNTROL COMM.CODE                 34250000
.ER15A   AIF   ('&IOA2' NE '0').ER5                                  JJ 34300000
         DC    A(&IOA1)                ADDR. OF IOAREA1                 34350000
         AGO   .ER6                                                     34400000
.ER5     DC    A(&IOA2)             ADDR. OF IOAREA2                4-0 34450000
.ER6     DC    AL1(&SWS)                                             JJ 34500000
         AIF   (T'&EOFADDR EQ 'O').XX1                               JJ 34550000
         DC    AL3(&EOFADDR)   EOF ADDRESS                           JJ 34600000
         AGO   .XX2                                                 3-8 34650000
.XX1     ANOP                                                       3-8 34700000
         DC    AL3(*)   EOF ADDRESS SET TO '*'                       JJ 34750000
.XX2     ANOP                                                       3-8 34800000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').JJ20     @DL2994J 34850000
         AIF   ('&CG1' NE '1442' AND '&CG1' NE '2596').MAL1         4-0 34900000
         AIF   ('&SSELECT' NE '2').MAL1                             4-0 34950000
IJCX&SFX CCW   02,&IOA1,X'20',&BLKS                                     35000000
         AGO   .MAL2                                                    35050000
.JJ20    ANOP                                                        JJ 35100000
         AIF   ('&CG1' NE '5425').JJ20AX                       @DL2994J 35150000
IJCZ&SFX CCW   &AL2,&IOA1,X'60',1             SS CCW           @DL2994J 35200000
         AIF   (K'&FUNC GT 1).MF20AB                           @DL2994J 35250000
IJCX&SFX CCW   &RCC,&IOA1,X'20',&BLKS         READ CCW         @DL2994J 35300000
         AGO   .MAL2                                           @DL2994J 35350000
.MF20AB  ANOP                                                  @DL2994J 35400000
IJCX&SFX CCW   &RCC,IJCY&SYSNDX,X'20',&BLKS   READ CCW         @DL2994J 35450000
         AGO   .MAL2                                           @DL2994J 35500000
.JJ20AX  AIF   ('&CNTL' NE 'C').JJ21                           @DL2994J 35550000
.JJ20A   ANOP                                                        JJ 35600000
         AIF   (&ASF NE 0).JJ20B                                     JJ 35650000
IJCX&SFX CCW   &RCC,&IOA1,X'20',&BLKS            READ CCW            JJ 35700000
         AGO   .JJ20C                                                JJ 35750000
.JJ20B   ANOP                                                        JJ 35800000
IJCX&SYSNDX CCW &RCC,IJCY&SYSNDX,X'20',&BLKS   READ CCW              JJ 35850000
.JJ20C   DC    D'0'                                                  JJ 35900000
         AGO   .MAL2                                                 JJ 35950000
.JJ21    AIF   (T'&SSELECT EQ 'O').JJ20A                             JJ 36000000
         AIF   ('&SSELECT' EQ '').JJ20A                        @DA00287 36050000
         AIF   ('&FUNC' NE 'RP' AND '&FUNC' NE 'RPW').JJ21A          JJ 36100000
         MNOTE 0,'SSELECT WITH FUNC=''RP'' OR ''RPW''. IGNORED'      JJ 36150000
         AGO   .JJ20A                                                JJ 36200000
.JJ21A   AIF   ('&SSELECT' EQ '1' OR '&SSELECT' EQ '2' OR '&SSELECT'   *36250000
                EQ '3' OR '&SSELECT' EQ '4').JJ24              @DA00287 36300000
         AIF   ('&SSELECT' GE '1' AND '&SSELECT' LE '4').JJ24        JJ 36350000
         AIF   ('&CG1' EQ '2560' AND '&SSELECT' EQ '5').JJ24         JJ 36400000
.JJ22    MNOTE 0,'INVALID SSELECT PARAMETER. IGNORED'                JJ 36450000
         AGO   .JJ20A                                                JJ 36500000
.JJ24    ANOP                                                        JJ 36550000
&AL2     SETA  &HOPPER+3                                             JJ 36600000
&STACKER SETA  16*&SSELECT                                           JJ 36650000
&AL2     SETA  &AL2+&STACKER                                         JJ 36700000
         AIF   (&ASF NE 0).JJ24B                                     JJ 36750000
IJCX&SFX CCW   &RCC,&IOA1,X'60',&BLKS            READ CCW            JJ 36800000
         AGO   .JJ24C                                                JJ 36850000
.JJ24B   ANOP                                                        JJ 36900000
IJCX&SYSNDX CCW &RCC,IJCY&SYSNDX,X'60',&BLKS   READ CCW              JJ 36950000
.JJ24C   ANOP                                                        JJ 37000000
         CCW   &AL2,&IOA1,X'20',1   STACKER SELECT CCW               JJ 37050000
         AIF   ('&WKIO' EQ 'I').ER17                                 JJ 37100000
         NOP   0                                                     JJ 37150000
         AGO   .ER18                                                 JJ 37200000
.MAL1    ANOP                                                           37250000
IJCX&SFX  CCW   &AL2,&IOA1,X'20',&BLKS                                  37300000
.MAL2    AIF  ('&IOREG' NE '').ER17                                     37350000
         NOP   0                       LOAD USER POINTER REG.           37400000
         AGO   .ER18                                                    37450000
.ER17    LA    &IOG,0(14)             LOAD USER POINTER REG.            37500000
.ER18    NOP   0         'MOVE IOAREA TO WORKA' NO MORE IN DTF @D14BDBF 37550000
         DC    X'0000'    NOT USED                             @D14BDBF 37600000
         AGO   .ER20                                                    37650000
.JLG50   AIF   (&ASF EQ 1).JLG52             FUNC=RP                4-0 37700000
         AIF   (&ASF NE 5).JLG40                  FUNC=RPW          4-0 37750000
.JLG52   AIF   ('&SSELECT' EQ '').JLG53                             4-0 37800000
         MNOTE 0,'SSELECT IN READ PART OF READ/PUNCH OR READ/PUNCH/PRINX37850000
               T IS INVALID. IGNORED.'                              4-0 37900000
.JLG53   ANOP                                                       4-0 37950000
&AL2     SETA  194                                                  4-0 38000000
         AGO   .JLG43                                               4-0 38050000
.ER20    AIF   (NOT &RPB).ADRMOD                                    4-0 38100000
         AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').ER20A   @DL2994J 38150000
         CLC   0(&EOFL,14),X'40'(1)   TEST FOR END OF FILE           JJ 38200000
         AIF   (&EOFL EQ 2).JJ30                                     JJ 38250000
         DC    X'0C001022'                                           JJ 38300000
         AGO   .ER20A                                                JJ 38350000
.JJ30    DC    C'/*  '                                               JJ 38400000
.ER20A   AIF   (T'&ERROPT EQ 'O' AND &ASF EQ 0).ADRMOD         @DA06210 38450000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').ER20B    @DL2994J 38500000
         DC    X'0000'                                               JJ 38550000
.ER20B   ANOP                                                        JJ 38600000
         AIF   (T'&ERROPT EQ 'O').JG90                         @DA06210 38650000
         AIF   ('&ERROPT' EQ 'IGNORE').JLG80                        4-0 38700000
         AIF   ('&ERROPT' EQ 'SKIP').JLG85                          4-0 38750000
         DC    A(&ERROPT)         ERROPT ROUTINE                    4-0 38800000
.JG70    AIF   (&ASF EQ 0).ADRMOD                                   4-0 38850000
         DC    A(&ASOCFLE)                                          4-0 38900000
         AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').ADRMOD  @DL2994J 38950000
         MVC   0(&BLKS,14),X'52'(1)  CARD IMAGE INTO IOAREA1         JJ 39000000
IJCY&SYSNDX DC &BLKS.C' '   BUFFER FOR CARD IMAGE                    JJ 39050000
         AGO   .ADRMOD                                              4-0 39100000
.JLG80   B     20(15)             ERROR EXIT  (IGNORE)              4-0 39150000
         AGO   .JG70                                                4-0 39200000
.JLG85   B     16(15)             ERROR EXIT  (SKIP)                4-0 39250000
         AGO   .JG70                                                4-0 39300000
.JG90    DC    X'00000000'   NO ERROPT PARAMETER               @DA06210 39350000
         AGO   .JG70                                                4-0 39400000
.P13     AIF   (T'&MODNAME EQ 'O').P135                                 39450000
         DC    VL3(&MODNAME)          ADDRESS OF LOGIC MODULE       4-0 39500000
         AGO   .P137                                                4-0 39550000
.P135    ANOP                                                  @D14BDBF 39600000
&RFM     SETC  '&RECF'(1,1)           GET FIRST BYTE OF RECFORM@D14BDBF 39650000
         AIF   (T'&RDONLY EQ 'O').P135AA                            4-0 39700000
         AIF   ('&RDONLY' EQ 'YES').P135AB                          3-3 39750000
         MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED.'                3-3 39800000
.P135AB  DC    VL3(IJC&RFM&CNTL.N&WKIO&AL1) ADDR OF LOG.MODULE @D14BDBF 39850000
         AGO   .P137                                                3-3 39900000
.P135AA DC     VL3(IJC&RFM&CNTL.O&WKIO&AL1) ADDR OF LOG,MODULE @D14BDBF 39950000
.P137    DC    X'04'                   DTF TYPE = PUNCH                 40000000
&CC      SETA  32                                                   4-0 40050000
         AIF   ('&CG1' NE '3525').JLG100                            4-0 40100000
         AIF   (&ASF NE 4).P139                                     4-0 40150000
&CC      SETA  96                                                   4-0 40200000
         AGO   .P139                                                4-0 40250000
.JLG100  ANOP                                                       4-0 40300000
         AIF   ('&CG1' NE '2520').P138                                  40350000
&AL4     SETA  &AL4+1                                                   40400000
         AGO   .P139                                                    40450000
.P138    AIF   ('&CRDERR' EQ '' OR '&CG1' NE '2540').P139               40500000
&AL4     SETA  &AL4+1                                                   40550000
.P139    DC    AL1(&AL4)           SWITCHES                             40600000
         AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').P139A   @DL2994J 40650000
         AIF   (T'&SSELECT EQ 'O').JJ44                              JJ 40700000
         AIF   (T'&SSELECT NE 'N').JJ40                              JJ 40750000
         AIF   ('&SSELECT' GE '1' AND '&SSELECT' LE '4').JJ42        JJ 40800000
         AIF   ('&CG1' EQ '2560' AND '&SSELECT' EQ '5').JJ42         JJ 40850000
.JJ40    MNOTE 0,'INVALID SSELECT. IGNORED'                          JJ 40900000
         AGO   .JJ44                                                 JJ 40950000
.JJ42    ANOP                                                        JJ 41000000
&STACKER SETA  16*&SSELECT                                           JJ 41050000
.JJ44    ANOP                                                        JJ 41100000
&AL3     SETA  3+&HOPPER+&STACKER                                    JJ 41150000
         DC    AL1(&AL3)      STACKER SELECT COMMAND                 JJ 41200000
         DC    AL1(&AL3)      STACKER SELECT COMMAND                 JJ 41250000
         AGO   .E032                                                 JJ 41300000
.P139A   AIF   ('&SSELECT' NE '').E036                               JJ 41350000
&AL3     SETA  1                                                        41400000
         AGO   .E038                                                    41450000
.E036    AIF   ('&SSELECT' LT '1').E038A                       @DA00011 41500000
&AL3     SETA  64*&SSELECT-63                                           41550000
         AIF   (&AL3 LE 129).E038                                       41600000
.E038A   ANOP                                                  @DA00011 41650000
         MNOTE 0,'IMPROPER SSELECT. SET TO 1'                           41700000
&AL3     SETA  1                                                        41750000
.E038    AIF   ('&CG1' EQ '2540').E033                                  41800000
         AIF   ('&CG1' NE '3525').JLG108                            4-0 41850000
         AIF   ('&DMOD' NE 'C').E033                                4-0 41900000
&AL3     SETA  &AL3+32                                              4-0 41950000
         AGO   .E033                                                4-0 42000000
.JLG108  ANOP                                                       4-0 42050000
         AIF   (&AL3 LE 65).E039                                        42100000
         MNOTE 0,'IMPROPER SSELECT. SET TO 1'                           42150000
&AL3     SETA  1                                                        42200000
.E039    AIF   ('&CG1' NE '1442' AND '&CG1' NE '2596').E033         4-0 42250000
&AL3     SETA  &AL3+128                                                 42300000
.E033    DC    AL1(&AL3)               NORMAL  COMM. CODE               42350000
         DC    AL1(&AL3)               CONTROL COMM. CODE               42400000
.E032    DC    A(&IOA1+&AL2)           ADDR.OF DATA IN IOAREA1          42450000
.E040    DC    CL4' '                  BUCKET                           42500000
         AIF   ('&RECF' EQ 'UNDEF').E018                       @D14BDBF 42550000
         NOPR  0                       PUT LENGTH IN REG12(ONLY UNDEF)  42600000
         AGO   .E020                                                    42650000
.E018     LR    12,&RECZ                                                42700000
.E020    AIF   ('&CG1' NE '2560' AND '&CG1' NE '5425').E020AA  @DL2994J 42750000
         AIF   ('&WKIO' EQ 'I').E023                                 JJ 42800000
         NOP   0                                                     JJ 42850000
         AGO   .E024                                                 JJ 42900000
.E020AA  AIF   ('&IOREG' NE '').E023                                 JJ 42950000
         NOP   0                       LOAD USER POINTER REG            43000000
         AGO   .E024                                                    43050000
.E023     LA    &IOG,0(14)                                              43100000
.E024    AIF   ('&CG1' EQ '2520').E024A                                 43150000
         AIF   ('&CG1' EQ '2560' OR '&CG1' EQ '5425').JJ50     @DL2994J 43200000
         AIF   ('&CG1' EQ '1442' OR '&CG1' EQ '2596').E024C         4-0 43250000
         AIF   ('&CG1' NE '3525').JLG120                            4-0 43300000
         DC    X'04'                                                4-0 43350000
         AGO   .E024B                                               4-0 43400000
.JLG120  ANOP                                                       4-0 43450000
         DC    X'00'                   SWITCH 2                         43500000
         AGO   .E024B                                                   43550000
.E024C   DC    X'02'                   SWITCH2                          43600000
         AGO   .E024B                                                   43650000
.E024A   DC    X'01'                   SWITCH 2                         43700000
.E024B   DC    C' '                    BLANK FOR EJECT LAST PRG. CARD   43750000
         AIF   ('&IOA2' EQ '0').E026                                4-0 43800000
IJCX&SFX CCW   &AL3,&IOA2+&AL2,&CC,&BLKS-&AL2                       4-0 43850000
          AGO   .Z1                                                     43900000
.E026     ANOP                                                          43950000
IJCX&SFX CCW   &AL3,&IOA1+&AL2,&CC,&BLKS-&AL2                       4-0 44000000
.Z1      AIF   ('&CG1' NE '2520').E057A                                 44050000
         CCW   1,*-9,X'20',1           FOR EJECT LAST PROG. CARD        44100000
.E057A    AIF   ('&CRDERR' EQ '' OR '&CG1' NE '2540').E058              44150000
          CCW   1,*+8,X'20',80         FOR PUNCH ERROR RETRY            44200000
         DC    CL80' '                 AREA FOR SAVE CARD IMAGE         44250000
.E058    AIF   (&ASF NE 4).JG125                                    4-0 44300000
         CCW   13,&IOA1+&AL2,&CC,64                                 4-0 44350000
         CCW   29,IJCZ&SFX,X'20',64                                 4-0 44400000
IJCZ&SFX DC    64C' '   PRINT BUFFER                                4-0 44450000
         AIF   (&BLKS-&AL2 EQ 80).ADRMOD                            4-0 44500000
         MNOTE 0,'IMPROPER BLKSIZE FOR PUNCH INTERP. BAD CHAR. WILL BE X44550000
               PRINTED.'                                            4-0 44600000
         AGO   .ADRMOD                                              4-0 44650000
.JG125   AIF   (&ASF EQ 0).ADRMOD                                   4-0 44700000
         DC    A(&ASOCFLE)                                          4-0 44750000
         AGO   .ADRMOD                                              4-0 44800000
.JJ50    AIF   ('&CG1' NE '2560').JJ50A                              JJ 44850000
         DC    X'08'   SWITCHES                                      JJ 44900000
         AGO   .JJ50B                                                JJ 44950000
.JJ50A   AIF   ('&CG1' NE '5425').JJ50B                        @DL2994J 45000000
         DC    X'10'   SWITCHES                                      JJ 45050000
.JJ50B   ANOP                                                        JJ 45100000
         DC    C' '                                                  JJ 45150000
&PCC     SETA  1+&HOPPER+&COLBIN                                     JJ 45200000
         AIF   (T'&FUNC EQ 'O').JJ51                                 JJ 45250000
         AIF   ('&CG1' EQ '5425' AND &ASF EQ 4).JJ50BB         @DL2994J 45300000
         AIF   ('&FUNC'(1,1) NE 'R').JJ51                            JJ 45350000
.JJ50BB  ANOP                                                        JJ 45400000
&PCC     SETA  &PCC+4   PUNCH WITHOUT FEED IF FUNC=RPW OR RP         JJ 45450000
.JJ51    ANOP                                                        JJ 45500000
         AIF   ('&FUNC' EQ 'RP' OR '&FUNC' EQ 'RPW').JJ51XX          JJ 45550000
&RCC     SETA  &HOPPER+&COLBIN+2                                     JJ 45600000
IJCX&SFX CCW   &RCC,*,X'30',1    EJECT CCW                           JJ 45650000
         CCW   &AL3,*,X'60',1  STACKER SELECT CCW                    JJ 45700000
         AGO   .JJ51YY                                               JJ 45750000
.JJ51XX  DC    D'0'                                                  JJ 45800000
IJCX&SFX CCW   &AL3,*,X'60',1  STACKER SELECT CCW                    JJ 45850000
.JJ51YY  ANOP                                                        JJ 45900000
&FL      SETA  32                                                    JJ 45950000
         AIF   (&ASF NE 4).JJ51A                                     JJ 46000000
&FL      SETA  &FL+64                                                JJ 46050000
         AIF   ('&CG1' EQ '5425').JJ51A                        @DL2994J 46100000
         AIF   (&BLKS-&AL2 EQ 80).JJ51A                              JJ 46150000
         MNOTE 0,'IMPROPER BLKSIZE FOR FUNC=I.  BAD CHARACTERS WILL BE *46200000
               PRINTED'                                              JJ 46250000
.JJ51A   AIF   (&ASF EQ 0 OR &ASF EQ 4).JJ51B                        JJ 46300000
         CCW   &PCC,IJCY&SYSNDX,&FL,&BLKS-&AL2   PUNCH CCW           JJ 46350000
         AGO   .JJ53                                                 JJ 46400000
.JJ51B   AIF   ('&IOA2' EQ '0').JJ52                                 JJ 46450000
         CCW   &PCC,&IOA2+&AL2,&FL,&BLKS-&AL2   PUNCH CCW            JJ 46500000
         AGO   .JJ53                                                 JJ 46550000
.JJ52    CCW   &PCC,&IOA1+&AL2,&FL,&BLKS-&AL2   PUNCH CCW            JJ 46600000
.JJ53    AIF   (&ASF EQ 0).ADRMOD                                    JJ 46650000
         AIF   (&ASF NE 4).JJ54                                      JJ 46700000
         AIF   ('&CG1' NE '2560').JJ53A                              JJ 46750000
         CCW   X'17',&IOA1+&AL2,&FL,64 LOAD PRINT HEAD BUFFER 1 CCW  JJ 46800000
         CCW   X'27',IJCZ&SFX,&FL,64   LOAD PRINT HEAD BUFFER 2      JJ 46850000
         CCW   X'45',*+7,X'20',X'C0'   PRINT CCW                     JJ 46900000
IJCZ&SFX DC    64C' '   PRINT BUFFER FOR SECOND LINE                 JJ 46950000
         AGO   .ADRMOD                                               JJ 47000000
.JJ53A   AIF   ('&CG1' NE '5425').ADRMOD                       @DL2994J 47050000
&PCC     SETA  &HOPPER+65                                            JJ 47100000
         CCW   &PCC,&IOA1+&AL2,X'20',&BLKS-&AL2  PRINT CCW           JJ 47150000
         AGO   .ADRMOD                                               JJ 47200000
.JJ54    DC    A(&ASOCFLE)   ADDR OF ASSOCIATED DTF TABLE            JJ 47250000
         AIF   ('&DMOD' EQ 'C').JJ55                                 JJ 47300000
         DC    C' '                                                  JJ 47350000
         AGO   .JJ56                                                 JJ 47400000
.JJ55    DC    X'00'                                                 JJ 47450000
.JJ56    ANOP                                                        JJ 47500000
&BLKS    SETA  &BLKS-&AL2                                            JJ 47550000
IJCY&SYSNDX DC &BLKS.C' '   BUFFER FOR CARD IMAGE                    JJ 47600000
         AGO   .ADRMOD                                               JJ 47650000
.EC15     AIF   (T'&CRDERR EQ 'O').EC15A                                47700000
          MNOTE 0,'CRDERR INVALID PARAMETER. IGNORED'                   47750000
.EC15A    AIF   (T'&IOREG EQ 'O').EC15B                                 47800000
          MNOTE 0,'IOREG INVALID PARAMETER. IGNORED'                    47850000
.EC15B    AIF   (T'&SSELECT EQ 'O').EC15D                               47900000
          MNOTE 0,'SSELECT INVALID PARAMETER. IGNORED'                  47950000
.EC15D    AIF   (T'&MODNAME EQ 'O').EC155                               48000000
         DC    AL1(0)                                                   48050000
         DC    VL3(&MODNAME)           ADDRESS OF LOGIC MODULE          48100000
         AGO   .EC157                                                   48150000
.EC155 DC AL1(0)                                                    3-3 48200000
         AIF   (T'&RDONLY EQ 'O').EC155AA                           3-3 48250000
         AIF   ('&RDONLY' EQ 'YES').EC155AB                         3-3 48300000
         MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED.'                3-3 48350000
.EC155AB DC    VL3(IJCF&CNTL.B&WKIO&AL1) ADDRESS OF LOGIC MODULE    3-3 48400000
         AGO   .EC157                                               3-3 48450000
.EC155AA DC    VL3(IJCF&CNTL.C&WKIO&AL1) ADDRESS OF LOGIC MODULE    3-3 48500000
.EC157   DC    X'00'                   DTF TYPE                         48550000
       AIF ('&CG1' EQ '1442').EC16                                      48600000
         DC    X'C2'                                                    48650000
         DC    X'09'                                                    48700000
         DC    X'09'                                                    48750000
         AGO   .EC17                                                    48800000
.EC16    DC    X'02'                                                    48850000
         DC    X'01'                                                    48900000
         DC    X'01'                                                    48950000
.EC17    ANOP                                                           49000000
IJCX&SFX CCW   X'02',&IOA1,X'20',&BLKS                                  49050000
         DC    A(&IOA1)                INPUT AREA                       49100000
         DC    A(&IOA2)                OUTPUT AREA                      49150000
         DC    H'&BLKS'                INPUT BLOCKSIZE                  49200000
         DC    H'&OUBL'                OUTPUT BLOCKSIZE                 49250000
         MVC   0(&BLKS,13),0(14)                                        49300000
         MVC   0(&OUBL,14),0(13)                                        49350000
         AIF   (T'&EOFADDR EQ 'O').XX3                         @DA00011 49400000
         DC    A(&EOFADDR)             END OF FILE ADDRESS          3-9 49450000
         AGO   .XX4                                            @DA00011 49500000
.XX3     ANOP                                                  @DA00011 49550000
         DC    A(*)  EOF ADDRESS SET TO '*'                    @DA00011 49600000
.XX4     ANOP                                                  @DA00011 49650000
         DC    2F'0'                   SAVE AREA                        49700000
&OUBL  SETA  &OUBL-1                                                    49750000
       MVC 1(&OUBL,13),0(13)                                            49800000
         MVI  0(13),X'40'                                               49850000
IJCY&SYSNDX   DC  C'  '                                                 49900000
       DC  A(IJCY&SYSNDX)                                               49950000
.ADRMOD  ANOP                                                           50000000
         AIF   (NOT &BL2).ADRMOD1                              @D33FDVS 50050000
         DC    0D'0'                                           @D33FDVS 50100000
         DC    X'00008&E.0&NCH.0000'    RES.COUNT, COM BYTES   @D33FDVS 50150000
         DC    AL1(&AL8)                LOGICAL UNIT CLASS     @D33FDVS 50200000
         DC    AL1(&AL9)                LOGICAL UNIT           @D33FDVS 50250000
         DC    X'80'                    2501 DOUBLE CCB SUPPORT@D33FDVS 50300000
         DC    AL3(IJCU&SFX)            CCW ADDRESS            @D33FDVS 50350000
         DC    4X'00'                   CCW ST BYTE,CSW CCW ADR@D33FDVS 50400000
         DC    AL1(&AL5)                SWITCH 3               @D33FDVS 50450000
         AIF   (T'&MODNAME EQ 'O').E060                        @D33FDVS 50500000
         DC    VL3(&MODNAME)            ADDR OF LOGIC MODULE   @D33FDVS 50550000
         AGO   .E061                                           @D33FDVS 50600000
.E060    AIF   (T'&RDONLY EQ 'O').E066                         @D33FDVS 50650000
         DC    VL3(IJCF&CNTL.H&WKIO&AL1) ADDR OF LOGIC MODULE  @D33FDVS 50700000
         AGO   .E061                                           @D33FDVS 50750000
.E066    DC    VL3(IJCF&CNTL.I&WKIO&AL1) ADDR OF LOGIC MODULE  @D33FDVS 50800000
.E061    DC    X'02'                    DTF TYPE (READER)      @D33FDVS 50850000
         DC    AL1(&AL4)                SWITCHES               @D33FDVS 50900000
         DC    AL1(&AL2)                NORMAL COMMAND CODE    @D33FDVS 50950000
         DC    AL1(&AL2)                CONTROL COMM CODE      @D33FDVS 51000000
         DC    A(&IOA1)                 DDR OF IOAREA1         @D33FDVS 51050000
         DC    AL1(&SWS)                                       @D33FDVS 51100000
         DC    AL3(&EOFADDR)            EOF ADDRESS            @D33FDVS 51150000
IJCU&SFX CCW   &AL2,&IOA2,X'20',&BLKS   CCW                    @D33FDVS 51200000
         AIF   ('&IOREG' NE '').E063                           @D33FDVS 51250000
         NOP   0                        LOAD USER PTR REG      @D33FDVS 51300000
         AGO   .E064                                           @D33FDVS 51350000
.E063    LA    &IOG,0(14)               LOAD USER PTR REG      @D33FDVS 51400000
.E064    NOP   0       'MOVE IOAREA TO WORKA' NO MORE IN DTF   @D14BDBF 51450000
         DC    X'0000'  NOT USED                               @D14BDBF 51500000
.ADRMOD1 ANOP                                                  @D33FDVS 51550000
IJJZ&SYSNDX EQU   *                                            @D33FDVS 51600000
         MEND                                                  @D33FDVS 51650000
