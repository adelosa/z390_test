         MACRO                                                          00001000
         PRMT  &REMOTE=,&REF=,&PUNROUT=,&LSTROUT=,&LIST=,      @D32DUSNX00002000
               &TYPE=,&TRNSP=,&BE=,&HFC=,&SCE=,&ABE=,&MRF=,    @D32DUSNX00003000
               &SESSLIM=,&CMPACT=,&RUSIZE=,&LU=,               @D34BDSNX00004000
               &TRACE=,&CS=,&CONSOLE=,&PSWRD=,                 @D32DUSN+00005000
               &XLATE=,            TRANSLATE SNA LST OUTPUT    @D03PISY+00006000
               &CSALST=,           LIST COMPONENT SELECT       @D35BIML+00007000
               &CSAPUN=,           PUNCH                       @D35BIML+00008000
               &CSAMSG=,           MESSAGE                     @D35BIML+00009000
               &PUN=,              PUNCH RECORDLENGTH          @D35BIML+00010000
               &MSG=,              MESSAGE                     @D35BIML+00011000
               &MSGEJCT=,          EJECT BEFORE MSG-BLOCK      @D35BIML+00012000
               &MSGSPCE=,          SPACES AFTER MSG-BLOCK      @D35BIML+00013000
               &MAXRECL=,          MAX SNA PRINT LINE (132-512)@DY44438+00014000
               &TURNEOJ=                                       @D35BIML 00015000
.*                                 LINETURN AFTER EOJ                   00016000
.*                                                                      00017000
.*                                                                      00018000
         GBLA  &GBL1               POWER + BSC TABLE LENGTH             00019000
         GBLA  &GBL2               NUMBER OF BSC LINES                  00020000
         GBLA  &GBL3               NUMBER OF BSC REMOTES                00021000
         GBLA  &GBL4               MACRO SEQUENCE CHECKING              00022000
         GBLA  &GBL5               POWER+BSC+SNA TABLE LENGTH  @D32DUSN 00023000
         GBLA  &GBL6               NR OF SNA REMOTE ENTRIES    @D32DUSN 00024000
         GBLA  &GBL7               FOR SNA REMOTE ID CHECKING  @D32DUSN 00025000
         GBLA  &GBL8               FIRST SNA REMOTE-ID         @D32DUSN 00026000
         GBLA  &NLUS               NUMBER OF LOGICAL UNITS     @D32DUSN 00027000
.*                                 PASSED BY POWER MACRO       @D32DUSN 00028000
         GBLB  &SNA                IF ON, FIRST SNA TERM DONE  @D32DUSN 00029000
         GBLB  &ERR                IF ON, ERROR DETECTED       @D32DUSN 00030000
.*                                 NOW OR IN PREVIOUS MACRO    @D32DUSN 00031000
         GBLA  &LULOC              LOCATION OF NEXT LU NAME    @D34BDSN 00032000
.*                                                                      00033000
.*       GLOBALS FOR BSC- IMPLICIT PRESIGNON REMOTE-ENTRY               00034000
.*                                                                      00035000
         GBLA  &GA1MLN             MESSAGE PRINT WIDTH         @D35BIML 00036000
         GBLB  &GBISO              IMPLICIT PRESIGNON REMOTE   @D35BIML 00037000
         GBLB  &GBSO               PRESIGNON GENERATED         @D35BIML 00038000
         GBLB  &GBEQU              EQUATES GENERATED           @D35BIML 00039000
         GBLB  &GF2,&GF4,&GF5      FEA2,FEA4,FEA5 ARE ZERO     @D35BIML 00040000
         GBLC  &GCTYP              TYPE                        @D35BIML 00041000
         GBLC  &GCSAM              MSG COMPONENT SELECT        @D35BIML 00042000
         GBLC  &GBCOMSL            COMPONENT SELECT            @D35BIML 00043000
         GBLC  &GBVARLG            VARIABLE RECORD LENGTH      @D35BIML 00044000
         GBLC  &GBT3741            USE 3741 TR-TABLE           @D35BIML 00045000
         GBLC  &GBL2780            2780 - LIKE                 @D35BIML 00046000
.*                                                                      00047000
.*       LOCALS                                                         00048000
.*                                                                      00049000
         LCLA  &BL2                PUNCH ROUTING                        00050000
         LCLA  &BL3                LIST ROUTING                         00051000
         LCLA  &BL5                TERMINAL TYPE                        00052000
         LCLA  &BL6                TERMINAL FEATURES                    00053000
         LCLA  &BL7                BUFFER SIZE OR REFERENCE             00054000
         LCLA  &GAP                NUMBER OF GAPS              @D35BIML 00055000
         LCLA  &LPW                LENGTH REM USER PSWRD OR FF @D32DUSN 00056000
         LCLC  &PWD                REMOTE PASSWORD             @D32DUSN 00057000
         LCLC  &TYPP               REPLACES TYPE               @D32DUSN 00058000
         LCLA  &SL                 SESSION LIMIT               @D34BDSN 00059000
         LCLA  &A,&B,&C,&K         WORK COUNTERS               @D34BDSN 00060000
         LCLC  &CN                 CMPACT NAME                 @D34BDSN 00061000
         LCLC  &LUNM               LU NAME                     @D34BDSN 00062000
         LCLA  &MAXPRT     (SNA)   MAX PRINT LINE              @DY44115 00063000
         LCLA  &MAXTEMP    (SNA)   TEMP WORK VARIABLE          @DY44115 00064000
.*                                                                      00065000
.*       FOLLOWING DEFINITIONS ARE FOR BSC-ONLY                         00066000
.*                                                                      00067000
.*       ARITHMETIC WORK VALUES                                         00068000
.*                                                                      00069000
         LCLA  &ABFSZ              BUFFER SIZE                 @D35BIML 00070000
         LCLA  &ANRPB              NO OF RECORDS/BLOCK         @D35BIML 00071000
         LCLA  &A1LLN              PRINT WIDTH 1LST            @D35BIML 00072000
         LCLA  &A1PLN              PUNCH RECORD LENGTH         @D35BIML 00073000
         LCLA  &A1MLN              PRINT WIDTH 1MSG            @D35BIML 00074000
         LCLA  &LLPW               LOWER LIMIT PRINT WIDTH     @D35BIML 00075000
         LCLA  &ULPW               UPPER LIMIT PRINT WIDTH     @D35BIML 00076000
         LCLA  &BEV                BE=YES VALUE                @D35BIML 00077000
         LCLA  &ABEV               ABE=YES VALUE               @D35BIML 00078000
         LCLA  &MRFV               MRF=YES VALUE               @D35BIML 00079000
         LCLA  &TEMP               TEMPORARY WORK VARIABLE     @D03PISY 00080000
.*                                                                      00081000
.*                                                                      00082000
         LCLC  &BLC                REMOTE ID-CHARACTER         @D35BIML 00083000
         LCLC  &CRPD               NUMBER OF PRINT DEVICES     @D35BIML 00084000
.*                                 OR REFERENCE OR ERROR INDICATION     00085000
         LCLC  &CTYP               DEVICE TYPE OR              @D35BIML 00086000
.*                                 REFERENCED REMOTE                    00087000
         LCLC  &CCSAL,&CCSAP,&CCSAM COMPONENT SELECT CHARACTER @D35BIML 00088000
         LCLC  &P                  PREFIX                      @D35BIML 00089000
         LCLC  &H(16)               EQUIVALENT LETTERS         @D35BIML 00090000
.*        (TO DELIMIT LABEL-LENGTH) 110,120,130,140,150,160...          00091000
.*                                   A , B , C , D , E , F              00092000
.*                                                             @D35BIML 00093000
.*       BIT - SWITCHES (SYMBOLIC)                             @D35BIML 00094000
.*                                                             @D35BIML 00095000
.*                                                                      00096000
.*       SWITCHES TO ALLOW OR SUPRESS PARAMETER OPTIONS                 00097000
.*       ON : PARAMETER IS NOT APPLICABLE FOR THAT TYPE                 00098000
.*       OFF: PARAMETER MAY SERVE VALUES FOR THAT TYPE                  00099000
.*                                                                      00100000
         LCLB  &TRNSPP              TRNSP=                     @D35BIML 00101000
         LCLB  &ABEP                ABE=                       @D35BIML 00102000
         LCLB  &BEP                 BE=                        @D35BIML 00103000
         LCLB  &MRFP                MRF=                       @D35BIML 00104000
         LCLB  &CSP                 CS=                        @D35BIML 00105000
         LCLB  &LTURNP              TURNEOJ=                   @D35BIML 00106000
         LCLB  &HFCP                HFC=                       @D35BIML 00107000
         LCLB  &SCEP                SCE=                       @D35BIML 00108000
         LCLB  &CSALP               CSALST=                    @D35BIML 00109000
         LCLB  &CSAPP               CSAPUN=                    @D35BIML 00110000
         LCLB  &CSAMP               CSAMSG=                    @D35BIML 00111000
         LCLB  &LISTP               LIST=                      @D35BIML 00112000
         LCLB  &MSGP                MSG=                       @D35BIML 00113000
         LCLB  &PUNP                PUN=                       @D35BIML 00114000
         LCLB  &MSGEJP              MSGEJCT=                   @D35BIML 00115000
         LCLB  &MSGSPP              MSGSPCE=                   @D35BIML 00116000
.*                                                                      00117000
.*       WORK SWITCHES                                                  00118000
.*                                                                      00119000
         LCLB  &CS5DS               COMPONENT SELECT CHAR. ')' @D35BIML 00120000
.*                                  IS NOT ALLOWED                      00121000
         LCLB  &SOC                 CONSTANT VALUE             @D35BIML 00122000
.*                                                                      00123000
.*       FEATURE BITS *****                                             00124000
.*                                                                      00125000
         LCLC  &BLTURN                                         @D03PIRG 00126000
         LCLC  &BTRACE,&BTR2H1T                                @D35BIML 00127000
         LCLC  &BTRANS,&BMULRC,&BHORFC,&BBLSCE,&BCOMSL         @D35BIML 00128000
         LCLC  &BVARLG,&BNOFC                                  @D35BIML 00129000
         LCLC  &BTNL,&BEJECT,&BSPACE,&BT3741,&BL2780           @D35BIML 00130000
.*                                                                      00131000
         AGO   .ZZZ                                                     00132000
*        LICENSED MATERIALS - PROPERTY OF IBM                           00133000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                    00134000
*        5686-CF7 (C) COPYRIGHT IBM CORP. 1979, 2004                    00135001
*        SEE COPYRIGHT INSTRUCTIONS                                     00136000
.ZZZ     ANOP                                                           00137000
.*                                                                      00138000
.********************************************************************** 00139000
.*                                                                    * 00140000
.*                     PROLOGUE                                       * 00141000
.*                                                                    * 00142000
.********************************************************************** 00143000
.*                                                                      00144000
.*                                                                      00145000
.*       THE MACRO IS INVOKED BY:                                       00146000
.*                                                                      00147000
.*             THE USER - TO DEFINE THE REMOTE TERMINAL DESCRIPTIONS    00148000
.*                                                                      00149000
.*             THE FOLLOWING MODULES TO CREATE A DSECT OF THE REMOTE    00150000
.*             TABLE ENTRY LAYOUT:                                      00151000
.*                        PRMT   REMOTE=RJR                             00152000
.*                  IPW$$I1 - INITIALIZATION ROUTINE NO. 1              00153000
.*                  IPW$$LR - LOGICAL READER ROUTINE                    00154000
.*                  IPW$$XR - EXECUTION READER ROUTINE                  00155000
.*                                                                      00156000
.*             THE FOLLOWING MACROS:                                    00157000
.*                  PRMT - TO CREATE A 'SIGNON' REMID ENTRY FOR RJE,BSC 00158000
.*                        PRMT  REMOTE=SOR,                             00159000
.*                              TYPE=2780,                              00160000
.*                              TURNEOJ=&TURNEOJ                        00161000
.*                  IPW$IOR - TO ATE A 'SIGNON' REMID ENTRY FOR RJE,BSC 00162000
.*                        PRMT   REMOTE=LCB                             00163000
.*                                                                      00164000
.*                                                                      00165000
.*                                                                      00166000
.********************************************************************** 00167000
.*                                                                      00168000
.*       COMMON BSC- AND SNA-CHECKING                                   00169000
.*                                                                      00170000
.********************************************************************** 00171000
.*                                                                      00172000
         SPACE 1                                                        00173000
         AIF   (&GBL3 NE 0 OR NOT &GBISO).P005                 @D35BIML 00174000
* VSE/POWER - PRMT - 5686-CF7-03                                        00175001
         SPACE 1                                                        00176000
.P005    ANOP                                                  @D35BIML 00177000
.*                                                                      00178000
.********************************************************************** 00179000
.*       VERIFY THE SPECIFICATIONS 'TYPE', AND 'TYPE' WITH 'REF'        00180000
.********************************************************************** 00181000
         AIF   (T'&TYPE EQ 'O').P007                           @D03PIQY 00182000
         AIF  (('&TYPE' NE 'LUT1')   AND ('&TYPE' NE '2770')   AND     X00183000
               ('&TYPE' NE '2780' )  AND ('&TYPE' NE '3741')   AND     X00184000
               ('&TYPE' NE '3780')).BSCMN6                     @D03PIQY 00185000
.P007    ANOP                                                  @D03PIQY 00186000
&TYPP    SETC  T'&TYPE             FOR IGNORE LATER            @D32DUSN 00187000
         AIF   (NOT &SNA).P010                                 @D35BIML 00188000
         AIF   (&ERR).MNOTE11          A PREVIOUS MACRO ERROR  @D32DUSN 00189000
         AIF   (T'&REF EQ 'O' AND '&TYPP' EQ 'O').MNOTE12      @D32DUSN 00190000
.*                                 BOTH  TYPE AND REF OMITTED  @D32DUSN 00191000
.*                                                             @D32DUSN 00192000
.P010    ANOP                                                  @D35BIML 00193000
         AIF   (T'&REF EQ 'O').P020     TYPE SPECIFIED         @D32DUSN 00194000
         AIF   ('&TYPP' EQ 'O').P015                           @D32DUSN 00195000
         MNOTE 3,'TYPE IGNORED IN COMBINATION WITH REF'        @D32DUSN 00196000
&TYPP    SETC  'O'                      SET TYPE OMITTED       @D32DUSN 00197000
.P015    AIF   (&SNA).SNA               REF + PREVIOUS SNA     @D32DUSN 00198000
         AGO   .BSC                     REF + PREVIOUS NON-SNA @D32DUSN 00199000
.*                                                             @D32DUSN 00200000
.P020    AIF   ('&TYPE' EQ 'LUT1').SNA  SNA WORKSTATION        @D32DUSN 00201000
.*                                                                      00202000
.* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  00203000
.*                                                                      00204000
.*                 B S C     C H A P T E R                              00205000
.*                                                                      00206000
.* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  00207000
         AIF   (&SNA).MNOTE13           NON-SNA IN SNA-STREAM  @D32DUSN 00208000
.*                                                             @D32DUSN 00209000
.* EXCEPT FOR THE CODE ABOVE, SNA AND BSC CODE IS SEPARATED.   @D32DUSN 00210000
.* THE FOLLOWING CODE, UNTIL LABEL .SNA, HANDLES BSC           @D32DUSN 00211000
.* TERMINALS ONLY. FROM .SNA ON CODE IS FOR SNA ONLY.          @D32DUSN 00212000
.*                                                             @D32DUSN 00213000
.BSC     ANOP                                                  @D32DUSN 00214000
.*                                                                      00215000
.*       GENERAL DEFAULTS OF PARAMETERS                                 00216000
.*                                                                      00217000
&CRPD    SETC  '1'                  NUMBER OF PRINT DEVICES    @D35BIML 00218000
&ABFSZ   SETA  128                  BUFFER SIZE                @D35BIML 00219000
&ANRPB   SETA  255                  NO OF RECORDS/BLOCK        @D35BIML 00220000
&CCSAL   SETC  'DC1'                COMP.SEL. 1LST             @D35BIML 00221000
&CCSAP   SETC  'DC2'                COMP.SEL. 1PUN             @D35BIML 00222000
&CCSAM   SETC  '&CCSAL'             COMP.SEL. 1MSG             @D35BIML 00223000
&A1LLN   SETA  120                  PRINTER WIDTH 1LST         @D35BIML 00224000
&A1PLN   SETA  80                   PUNCH RECORD LENGTH 1PUN   @D35BIML 00225000
&LLPW    SETA  80                   LOWER LIMIT PRINT WIDTH    @D35BIML 00226000
&ULPW    SETA  150                  UPPER LIMIT PRINT WIDTH    @D35BIML 00227000
&BEV     SETA  257                  BE=YES VALUE               @D35BIML 00228000
&ABEV    SETA  512                  ABE=YES VALUE              @D35BIML 00229000
&MRFV    SETA  7                    MRF=YES VALUE              @D35BIML 00230000
.*                                                                      00231000
.*       INDICATE MAINLY NOT APPLICABLE PARAMETERS                      00232000
.*                                                                      00233000
&ABEP    SETB  1                    ABE=      NOT APPLICABLE   @D35BIML 00234000
&BEP     SETB  1                    BE=                        @D35BIML 00235000
&MRFP    SETB  1                    MRF=                       @D35BIML 00236000
&CSP     SETB  1                    CS=                        @D35BIML 00237000
.*                                                                      00238000
.*                                                                      00239000
.*       DEFAULTS OF FEATURE BITS                                       00240000
.*                                                                      00241000
&BLTURN  SETC  'F2LTURN'            LINE TURNAROUND BY EOJ     @D35BIML 00242000
.*                                                             @D35BIML 00243000
.*       LCBFEA3 DECLARATION  (LINE DISCIPLIN)                 @D35BIML 00244000
.*                                                             @D35BIML 00245000
&BTRACE  SETC  '0'                  TRACE OPTION               @D35BIML 00246000
&BTR2H1T SETC  '0'                  TRANSPARANCY RECORD WITH   @D35BIML 00247000
.*                                  2 HEADING 1 TRAILING BYTE BSC-CHAR. 00248000
.*                                                             @D35BIML 00249000
.*       LCBFEA4    DECLARATIONS  USED FROM WRITER TASK        @D35BIML 00250000
.*                                                             @D35BIML 00251000
&BTRANS  SETC  '0'                 TRANSPARENCY FOR THIS REMOTE@D35BIML 00252000
&BMULRC  SETC  '0'                 MULTIPLE LOG./PHYS. RECORD  @D35BIML 00253000
&BHORFC  SETC  '0'                 HORIZONTAL FORMAT CONTROL   @D35BIML 00254000
&BBLSCE  SETC  '0'                 SPACE COMPRESSION EXPANSION @D35BIML 00255000
&BCOMSL  SETC  'F4COMSL'           COMPONENT SELECT            @D35BIML 00256000
&BVARLG  SETC  'F4VARLG'           VARIABLE LENGTH RECORDC     @D35BIML 00257000
&BNOFC   SETC  '0'                 NO FORMCHANGE SUPPORTED     @D35BIML 00258000
.*                                                             @D35BIML 00259000
.*       LCBFEA5   DECLARATIONS - USED FROM BSC WRITER         @D35BIML 00260000
.*                                                             @D35BIML 00261000
&BTNL    SETC  'F5TNL'             NL CHARACTER ON END OF HT   @D35BIML 00262000
&BEJECT  SETC  'F5EJECT'           EJECT BEFOR MESSAGES        @D35BIML 00263000
&BSPACE  SETC  'F5SPACE'           TERMINAL REQU.SPACE 3 AFTER @D35BIML 00264000
.*                                 RECORD  IE.  2770           @D35BIML 00265000
&BT3741  SETC  '0'                 TRANSL.TABLE WITH 3741 CTRL @D35BIML 00266000
&BL2780  SETC  '0'                 TERM USE 2780 FEATURES      @D35BIML 00267000
.*                                                             @D35BIML 00268000
.********************************************************************** 00269000
.*                                                                      00270000
.*       CHECK FOR DSECT OVER ENTRY-EXPANSION                           00271000
.*                                                                      00272000
.********************************************************************** 00273000
&BLC     SETC  ' '                                             @D35BIML 00274000
         AIF   ('&REMOTE' NE 'LCB').NOLCB PRMT WITHIN LCB ?    @D35BIML 00275000
.*             YES, GEN LCB-EXPANSION WITH PRAEFIX LCB         @D35BIML 00276000
.*                                                             @D35BIML 00277000
&P       SETC  'LCB'                                           @D35BIML 00278000
&CTYP    SETC  '0'                  DUMMY TYPE                 @D35BIML 00279000
         AGO   .BSCEP3                                         @D35BIML 00280000
.NOLCB   ANOP                                                  @D35BIML 00281000
         AIF   ('&REMOTE' NE 'RJR').NORJR  GEN RJR-DSECT ?     @D35BIML 00282000
.*             YES, DO IT                                      @D35BIML 00283000
RJERDS   DSECT                                                 @D35BIML 00284000
&CCSAL   SETC  'X'                                             @D35BIML 00285000
&CCSAP   SETC  'X'                                             @D35BIML 00286000
&CCSAM   SETC  'X'                                             @D35BIML 00287000
FEACSX   EQU   0                    DUMMY COMPONENT SELECT     @D35BIML 00288000
&BLTURN  SETC  '0'                  RESET STANDARD DEFAULTS    @D35BIML 00289000
&BCOMSL  SETC  '0'                                             @D35BIML 00290000
&BVARLG  SETC  '0'                                             @D35BIML 00291000
&BEJECT  SETC  '0'                                             @D35BIML 00292000
&BSPACE  SETC  '0'                                             @D35BIML 00293000
&BTNL    SETC  '0'                                             @D35BIML 00294000
TYPBSCX  EQU   0                    DUMMY TYPE                 @D35BIML 00295000
&CTYP    SETC  'BSCX'                                          @D35BIML 00296000
&P       SETC  'RJR'                                           @D35BIML 00297000
         AGO   .BSCEP3                                         @D35BIML 00298000
.NORJR   ANOP                                                  @D35BIML 00299000
.********************************************************************** 00300000
.*                                                                      00301000
.*       AT THIS POINT IS DETERMINED, THAT NO DSECT HAS TO              00302000
.*       BE EXPANDED.  --->   EXPAND REMOTE TABLE ENTRY                 00303000
.*                                                                      00304000
.********************************************************************** 00305000
.*                                                             @D35BIML 00306000
.********************************************************************** 00307000
.*                                                             @D35BIML 00308000
.*       CHECK FOR SNA-ONLY PARAMETERS                         @D32DUSN 00309000
.*                                                                      00310000
.********************************************************************** 00311000
.BSC02   ANOP                                                  @D32DUSN 00312000
         AIF   (T'&MAXRECL EQ 'O').BSC03                       @DY44115 00313000
         MNOTE 3,' MAXRECL IGNORED FOR BSC TERMINALS'          @DY44115 00314000
.BSC03   ANOP                                                  @DY44115 00315000
         AIF   (T'&CONSOLE EQ 'O').BSC05                       @D32DUSN 00316000
         MNOTE 3,' CONSOLE IGNORED FOR BSC TERMINALS'          @D32DUSN 00317000
.BSC05   AIF   (T'&PSWRD EQ 'O').BSC10                         @D32DUSN 00318000
         MNOTE 3,' PSWRD IGNORED FOR BSC TERMINALS'            @D32DUSN 00319000
.BSC10   ANOP                                                  @D32DUSN 00320000
         AIF   (T'&SESSLIM EQ 'O').BSC11                       @D34BDSN 00321000
         MNOTE 3,' SESSLIM IGNORED FOR BSC TERMINALS'          @D34BDSN 00322000
.BSC11   AIF   (T'&CMPACT EQ 'O').BSC12                        @D34BDSN 00323000
         MNOTE 3,' CMPACT IGNORED FOR BSC TERMINALS'           @D34BDSN 00324000
.BSC12   AIF   (T'&RUSIZE EQ 'O').BSC13                        @D34BDSN 00325000
         MNOTE 3,' RUSIZE IGNORED FOR BSC TERMINALS'           @D34BDSN 00326000
.BSC13   AIF   (T'&LU EQ 'O').BSC14                            @D34BDSN 00327000
         MNOTE 3,' LU IGNORED FOR BSC TERMINALS'               @D34BDSN 00328000
.BSC14   ANOP                                                  @D34BDSN 00329000
         AIF   (T'&XLATE EQ 'O').BSC15                         @D03PISY 00330000
         MNOTE 3,' XLATE IGNORED FOR BSC TERMINALS'            @D03PISY 00331000
.BSC15   ANOP                                                  @D03PISY 00332000
.*                                                                      00333000
.********************************************************************** 00334000
.*                                                                      00335000
.*       CHECK FOR ERROR IN INPUT STREAM                                00336000
.*                                                                      00337000
         AIF   (&GBL2 EQ 0).BSCMN7    NO PLINE MACRO           @D32DUSN 00338000
.*                                                                      00339000
.*       PRESIGNON REMOTE TO BE GENERATED ?                             00340000
.*                                                                      00341000
.********************************************************************** 00342000
.*                                                                      00343000
         AIF   (&GBL3 NE 0 OR '&REMOTE' NE 'SOR').BSCSOI       @D35BIML 00344000
         AIF   (&GBSO).BSCMN7       SOR ALREADY DEFINED ?      @D35BIML 00345000
&P       SETC  'SOR'                LABEL PRAEFIX              @D35BIML 00346000
&BLC     SETC  'SOR'                REMOTE-ID                  @D35BIML 00347000
&BL2     SETA  0                    NO PUNCH ROUTING           @D35BIML 00348000
&BL3     SETA  0                    NO LIST ROUTING            @D35BIML 00349000
&GAP     SETA  0                    NUMBER OF GAPS             @D35BIML 00350000
         AGO   .BSCTRE              EXIT OF REMOTE ID-CHECKING @D35BIML 00351000
.BSCSOI  ANOP                                                  @D35BIML 00352000
.*                                                                      00353000
.********************************************************************** 00354000
.*                                                                      00355000
.*       REMOTE-CHECKING*******                                         00356000
.*                                                                      00357000
.********************************************************************** 00358000
.*                                                                      00359000
         AIF   (T'&REMOTE NE 'N').BSCMN2                                00360000
         AIF   (&REMOTE LT &GBL3+1 OR &REMOTE GT 250).BSCMN2   @D22DDHS 00361000
.*                                                                      00362000
.*       GENERATE LABEL PREFIX (MAX: 2 LETTERS)                         00363000
.*                                                                      00364000
&A       SETA  &REMOTE                                         @D35BIML 00365000
&P       SETC  'R&A'                                           @D35BIML 00366000
&GAP     SETA  &A-&GBL3-1         NUMBER OF GAPS               @D35BIML 00367000
         AIF   (&A LT 100).BSCRM10                             @D35BIML 00368000
.*                                                                      00369000
.*       SET EQUIVALENT LETTER  (I.E. 110 -> A , 120 -> B .....)        00370000
.*                     IN PREFIX OF LABELS (&P)                         00371000
&H(1)    SETC  'A'                                             @D35BIML 00372000
&H(2)    SETC  'B'                                             @D35BIML 00373000
&H(3)    SETC  'C'                                             @D35BIML 00374000
&H(4)    SETC  'D'                                             @D35BIML 00375000
&H(5)    SETC  'E'                                             @D35BIML 00376000
&H(6)    SETC  'F'                                             @D35BIML 00377000
&H(7)    SETC  'G'                                             @D35BIML 00378000
&H(8)    SETC  'H'                                             @D35BIML 00379000
&H(9)    SETC  'I'                                             @D35BIML 00380000
&H(10)   SETC  'J'                                             @D35BIML 00381000
&H(11)   SETC  'K'                                             @D35BIML 00382000
&H(12)   SETC  'L'                                             @D22DDHS 00383000
&H(13)   SETC  'M'                                             @D22DDHS 00384000
&H(14)   SETC  'N'                                             @D22DDHS 00385000
&H(15)   SETC  'O'                                             @D22DDHS 00386000
&H(16)   SETC  'P'                                             @D22DDHS 00387000
&B       SETA  &A-(&A/10)*10                                   @D35BIML 00388000
&P       SETC  'R&H((&A-100)/10+1)'.'&B'                       @D35BIML 00389000
.BSCRM10 ANOP                                                  @D35BIML 00390000
.*                                                                      00391000
         AIF   (K'&REMOTE GT 3).BSCMN2                         @D35BIML 00392000
         AIF   (K'&REMOTE NE 3).BSCRM20                        @D35BIML 00393000
&BLC     SETC  '&REMOTE'                                       @D35BIML 00394000
         AGO   .BSCRMX                                         @D35BIML 00395000
.BSCRM20 ANOP                                                  @D35BIML 00396000
         AIF   (K'&REMOTE NE 2).BSCRM40                        @D35BIML 00397000
&BLC     SETC  '0&REMOTE'                                      @D35BIML 00398000
         AGO   .BSCRMX                                         @D35BIML 00399000
.BSCRM40 ANOP                                                  @D35BIML 00400000
&BLC     SETC  '00&REMOTE'                                     @D35BIML 00401000
.BSCRMX  ANOP                                                  @D35BIML 00402000
.*                                                                      00403000
.********************************************************************** 00404000
.*                                                                      00405000
.*       ANALYZE SYNTAX OF BSC-REMOTE PARAMETERS                        00406000
.*                                                                      00407000
.*                                                                      00408000
.*       PUNROUT-CHECKING*******                                        00409000
.*       ( TARGET OF PUNCH OUTPUT TO BE ROUTED TO)                      00410000
.*                                                                      00411000
.********************************************************************** 00412000
.*                                                                      00413000
&BL2     SETA  &REMOTE              PUNCH-ROUTING              @D35BIML 00414000
         AIF   (T'&PUNROUT EQ 'O').BSCPUX                               00415000
         AIF   (T'&PUNROUT NE 'N').BSCPU30                              00416000
         AIF   (&PUNROUT GT 250).BSCPU30                       @D22DDHS 00417000
&BL2     SETA  &PUNROUT             PUNCH ROUTING REMOTE ID             00418000
         AGO   .BSCPUX                                                  00419000
.BSCPU30 ANOP                                                  @D35BIML 00420000
         MNOTE 3,'INVALID PUNROUT SPECIFICATION - PUNROUT=0 ASSUMED.'   00421000
&BL2     SETA  0                                               @D35BIML 00422000
.BSCPUX  ANOP                                                  @D35BIML 00423000
.********************************************************************** 00424000
.*                                                                      00425000
.*       LSTROUT-CHECKING********                                       00426000
.*       ( LIST OUTPUT TARGET TO BE ROUTED TO)                          00427000
.*                                                                      00428000
.********************************************************************** 00429000
.*                                                                      00430000
&BL3     SETA  &REMOTE              LIST-ROUTING               @D35BIML 00431000
         AIF   (T'&LSTROUT EQ 'O').BSCLSX                               00432000
         AIF   (T'&LSTROUT NE 'N').BSCLS30                              00433000
         AIF   (&LSTROUT GT 250).BSCLS30                       @D22DDHS 00434000
&BL3     SETA  &LSTROUT                                                 00435000
         AGO   .BSCLSX                                                  00436000
.BSCLS30 ANOP                                                  @D35BIML 00437000
         MNOTE 3,'INVALID LSTROUT SPECIFICATION - LSTROUT=0 ASSUMED.'   00438000
&BL3     SETA  0                                               @D35BIML 00439000
.BSCLSX  ANOP                                                  @D35BIML 00440000
.********************************************************************** 00441000
.*                                                                      00442000
.*       TRACE-CHECKING*********                                        00443000
.*                                                                      00444000
.********************************************************************** 00445000
.*                                                                      00446000
.BSCTRE  ANOP                       ENTRY FOR PRESIGNON REMOTE @D35BIML 00447000
         AIF   (T'&TRACE EQ 'O').BSCTRX                        @D32DUSN 00448000
         MNOTE 1,'TRACE SPECIFICATION IGNORED - REFER TO PSTART CMD.'   00449000
.BSCTRX  ANOP                                                           00450000
.********************************************************************** 00451000
.*                                                                      00452000
.*       REF-CHECKING**********                                         00453000
.*       (REFERENCE TO PREVIOUS REMOTE TABLE ENTRY)                     00454000
.*                                                                      00455000
.********************************************************************** 00456000
.*                                                                      00457000
         AIF   (T'&REF EQ 'O').BSCRFX                                   00458000
         AIF   (T'&REF NE 'N').BSCMN5                                   00459000
         AIF   (&REF EQ 0 OR &REF GE &REMOTE).BSCMN5                    00460000
&CRPD    SETC  '&P.REMR'                                                00461000
&CTYP    SETC  '&REF'                                                   00462000
         AGO   .BSCEP2                                                  00463000
.BSCRFX  ANOP                                                           00464000
.********************************************************************** 00465000
.*                                                                      00466000
.*                                                                      00467000
.*       CHECK FOR TYPE                                                 00468000
.*                                                                      00469000
.*                                                                      00470000
.********************************************************************** 00471000
.*                                                                      00472000
.*                                                                      00473000
         AIF   ('&TYPP' EQ 'O').BSCMN1   WETHER TYPE NOR REFERENCE      00474000
&CTYP    SETC  '&TYPE'              TYPE OR REFERENCE MADE     @D35BIML 00475000
         AIF   ('&TYPE' EQ '2770').BSC2770                     @D35BIML 00476000
         AIF   ('&TYPE' EQ '2780').BSC2780                     @D35BIML 00477000
         AIF   ('&TYPE' EQ '3741').BSC3741                     @D35BIML 00478000
         AIF   ('&TYPE' EQ '3780').BSC3780                     @D35BIML 00479000
.*                                                                      00480000
.********************************************************************** 00481000
.*                                                                      00482000
.*       DEVICE DEPENDING PARAMETER SETUP                               00483000
.*                                                                      00484000
.********************************************************************** 00485000
.*                                                                      00486000
.BSC2770 ANOP                       FOR 2770*************      @D35BIML 00487000
&ABEP    SETB  0                    ALLOW ABE= SPECIFICATION   @D35BIML 00488000
&BEP     SETB  0                    ALLOW BE=  SPECIFICATION   @D35BIML 00489000
&CSP     SETB  0                    ALLOW CS=  SPECIFICATION   @D35BIML 00490000
         AGO   .BSCSYN              BSC-SYNTAX ANALYZATION     @D35BIML 00491000
.*                                                                      00492000
.*                                                                      00493000
.BSC2780 ANOP                       FOR 2780***************    @D35BIML 00494000
&BTNL    SETC  '0'                  NO NL-CHARACTER            @D35BIML 00495000
&ABFSZ   SETA  400                  BUFFERSIZE                 @D35BIML 00496000
&ANRPB   SETA  2                    NO OF RECORDS/BLOCK        @D35BIML 00497000
.*                                  FOR MRF¬=YES                        00498000
&SCEP    SETB  1                    SCE=    NOT APPLICABLE     @D35BIML 00499000
&CSALP   SETB  1                    CSALST= NOT APPLICABLE     @D35BIML 00500000
&CCSAL   SETC  '0'                  CSALST=0 STANDARD          @D35BIML 00501000
&CSAPP   SETB  1                    CSAPUN= NOT APPLICABLE     @D35BIML 00502000
&CCSAP   SETC  '0'                  CSAPUN=0 STANDARD          @D35BIML 00503000
&CSAMP   SETB  1                    CSAMSG= NOT APPLICABLE     @D35BIML 00504000
&CCSAM   SETC  '0'                  CSAMSG=0 STANDARD          @D35BIML 00505000
&BTR2H1T SETC  'F3TR2H1T'           IN TRANSPARANCY MODE ARE   @D35BIML 00506000
.*                                  2 HEADING AND 1 TRAILING            00507000
.*                                  BYTE AT EACH RECORD.                00508000
&MRFP    SETB  0                    MRF= APPLICABLE            @D35BIML 00509000
&MRFV    SETA  7                    RECORDS/BLOCK MRF=YES VALUE         00510000
&BL2780  SETC  'F5L2780'            INDICATION FOR SPECIAL     @D35BIML 00511000
.*                                  2780 BEHAVIOUR.                     00512000
         AGO   .BSCSYN              BSC SYNTAX ANALYZATION     @D35BIML 00513000
.*                                                                      00514000
.*                                                                      00515000
.BSC3741 ANOP                       FOR 3741*************      @D35BIML 00516000
&ABEP    SETB  0                    ALLOW ABE= OPTION          @D35BIML 00517000
&ABFSZ   SETA  131                  STANDARD BUFFERSIZE        @D35BIML 00518000
.*                                  (INCLUDING BSC-CHAR. FOR OUTPUT)    00519000
&ULPW    SETA  126                  UPPER LIMIT PRINTWIDTH     @D35BIML 00520000
&SCEP    SETB  1                    SCE= NOT APPLICABLE        @D35BIML 00521000
         AIF   ('&ABE' NE 'YES').BSC374A STANDARD 3741         @D35BIML 00522000
&ABEV    SETA  518                  ABE=YES BUFFERSIZE         @D35BIML 00523000
.*                                  3741 EXPANDED COMMUNICATION FEAT.   00524000
&SCEP    SETB  0                    SCE= IS APPLICABLE         @D35BIML 00525000
&ULPW    SETA  150                  UPPER LIMIT PRINTWIDTH     @D35BIML 00526000
&BMULRC  SETC  'F4MULRC'            SET INDICATION FOR         @D35BIML 00527000
.*                                  MULTIPLE LOGICAL/PHYSICAL RECORD    00528000
.BSC374A ANOP                       COMMON CHARACTERISTICS     @D35BIML 00529000
.*                                                                      00530000
&CSALP   SETB  1                    CSALST= NOT APPLICABLE     @D35BIML 00531000
&CCSAL   SETC  '0'                  CSALST=NO                  @D35BIML 00532000
&CSAPP   SETB  1                    CSAPUN= NOT APPLICABLE     @D35BIML 00533000
&CCSAP   SETC  '0'                  CSAPUN=NO                  @D35BIML 00534000
&CSAMP   SETB  1                    CSAMSG= NOT APPLICABLE     @D35BIML 00535000
&CCSAM   SETC  '0'                  CSAMSG=NO                  @D35BIML 00536000
&BCOMSL  SETC  '0'                  CS= NO IS POSSIBLE ONLY    @D35BIML 00537000
&A1LLN   SETA  126                  PRINT WIDTH 1LST           @D35BIML 00538000
&HFCP    SETB  1                    HFC= NOT APPLICABLE        @D35BIML 00539000
&BVARLG  SETC  '0'                  NO VARIABLE LENGTH         @D35BIML 00540000
&BLTURN  SETC  '0'                  LTURNEOJ=NO IS DEFAULT     @D35BIML 00541000
&BNOFC   SETC  'F4NOFC'             NO FORMCHANGE SUPPORTED    @D35BIML 00542000
&BT3741  SETC  'F5T3741'            3741 TR-TABLE TO USE       @D35BIML 00543000
         AGO   .BSCSYN              BSC SYNTAX ANALYZATION     @D35BIML 00544000
.*                                                                      00545000
.*                                                                      00546000
.BSC3780 ANOP                       FOR 3780***************    @D35BIML 00547000
&CSP     SETB  0                    CS= APPLICABLE             @D35BIML 00548000
&CS5DS   SETB  1                    SUPRESS COMPON SELECT CHAR @D35BIML 00549000
.*                                  ')' FOR 3780                        00550000
&ABFSZ   SETA  512                  STANDARD BUFFER SIZE       @D35BIML 00551000
.BSCSYN  ANOP                                                  @D35BIML 00552000
.********************************************************************** 00553000
.*                                                                      00554000
.*                                                                      00555000
.*       BSC-TYPE DEPENDING OPTIONAL PARAMETER SYNTAX CHECK             00556000
.*                                                                      00557000
.********************************************************************** 00558000
.*                                                                      00559000
.*       CS-CHECKING*******                                             00560000
.*       (COMPONENT SELECT )                                            00561000
.*                                                                      00562000
.********************************************************************** 00563000
.*                                                                      00564000
         AIF   (&CSP AND(T'&CS EQ 'O')).BSCCSX                 @D35BIML 00565000
         AIF   (NOT &CSP).BSCCS20                              @D35BIML 00566000
         MNOTE 3,'CS SPECIFICATION NOT APPLICABLE - IGNORED'   @D35BIML 00567000
         AGO   .BSCCSX                                         @D35BIML 00568000
.BSCCS20 ANOP                                                  @D35BIML 00569000
         AIF   ('&CS' EQ 'YES').BSCCSX                         @D35BIML 00570000
         AIF   ('&CS' EQ 'NO').BSCCS30                                  00571000
         AIF   ('&TYPE' NE '2770').BSCCS30                              00572000
         AIF   (T'&CS EQ 'O').BSCCSX                           @D03PIRG 00573000
         MNOTE 3,'INVALID CS SPECIFICATION - CS=YES ASSUMED'   @D35BIML 00574000
         AGO   .BSCCSX                                         @D35BIML 00575000
.*       CS=NO IS SET                                                   00576000
.BSCCS30 ANOP                                                  @D35BIML 00577000
&CCSAL   SETC  '0'                  NO SELECT CHARACTER        @D35BIML 00578000
&CSALP   SETB  1                    CSALST= NOT APPLICABLE     @D35BIML 00579000
&CCSAP   SETC  '0'                  NO SELECT CHARACTER        @D35BIML 00580000
&CSAPP   SETB  1                    CSAPUN= NOT APPLICABLE     @D35BIML 00581000
&CCSAM   SETC  '0'                  NO SELECT CHARACTER        @D35BIML 00582000
&CSAMP   SETB  1                    CSAMSG= NOT APPLICABLE     @D35BIML 00583000
&BCOMSL  SETC  '0'                  RESET FEATURE BIT          @D35BIML 00584000
         AIF   (T'&CS EQ 'O' OR '&CS' EQ 'NO').BSCCSX          @D35BIML 00585000
         MNOTE 3,'INVALID CS SPECIFICATION - CS=NO ASSUMED'    @D35BIML 00586000
.BSCCSX  ANOP                                                  @D35BIML 00587000
.********************************************************************** 00588000
.*                                                                      00589000
.*       CSALST-CHECKING********                                        00590000
.*       (COMPONENT SELECT CHARACTER FOR LIST-OUTPUT)                   00591000
.*                                                                      00592000
.********************************************************************** 00593000
.*                                                                      00594000
         AIF   (&CSALP AND(T'&CSALST EQ 'O')).BSCCLX           @D35BIML 00595000
         AIF   (NOT &CSALP).BSCCL20                            @D35BIML 00596000
         MNOTE 3,'CSALST SPECIFICATION NOT APPLICABLE - IGNORED'        00597000
         AGO   .BSCCLX                                         @D35BIML 00598000
.BSCCL20 ANOP                                                  @D35BIML 00599000
         AIF   (T'&CSALST EQ 'O').BSCCLX                       @D35BIML 00600000
&CCSAL   SETC  '&CSALST'            ASSUME CORRECT CSALST=     @D35BIML 00601000
         AIF   ('&CSALST' EQ 'DC1' OR '&CSALST' EQ 'DC2' OR '&CSALST'  +00602000
               EQ 'DC3' OR '&CSALST' EQ '0').BSCCLX            @D35BIML 00603000
         AIF   (&CS5DS).BSCCL40      NO ')' ALLOWED ?          @D35BIML 00604000
         AIF   ('&CSALST' EQ '5D').BSCCLX                      @D35BIML 00605000
.BSCCL40 ANOP                                                  @D35BIML 00606000
         MNOTE 3,'INVALID CSALST SPECIFICATION - CSALST=0 ASSUMED'      00607000
&CCSAL   SETC  '0'                                             @D35BIML 00608000
.BSCCLX  ANOP                                                  @D35BIML 00609000
.********************************************************************** 00610000
.*                                                                      00611000
.*                                                                      00612000
.*       CSAPUN-CHECKING********                                        00613000
.*       (COMPONENT SELECT CHARACTER FOR PUNCH-OUTPUT)                  00614000
.*                                                                      00615000
.********************************************************************** 00616000
.*                                                                      00617000
         AIF   (&CSAPP AND(T'&CSAPUN EQ 'O')).BSCCPX           @D35BIML 00618000
         AIF   (NOT &CSAPP).BSCCP20                            @D35BIML 00619000
         MNOTE 3,'CSAPUN SPECIFICATION NOT APPLICABLE - IGNORED'        00620000
         AGO   .BSCCPX                                         @D35BIML 00621000
.BSCCP20 ANOP                                                  @D35BIML 00622000
         AIF   (T'&CSAPUN EQ 'O').BSCCPX                       @D35BIML 00623000
&CCSAP   SETC  '&CSAPUN'            ASSUME CORRECT CSAPUN=     @D35BIML 00624000
         AIF   ('&CSAPUN' EQ 'DC1' OR '&CSAPUN' EQ 'DC2' OR '&CSAPUN'  +00625000
               EQ 'DC3' OR '&CSAPUN' EQ '0').BSCCPX            @D35BIML 00626000
         AIF   (&CS5DS).BSCCP40      NO ')' ALLOWED ?          @D35BIML 00627000
         AIF   ('&CSAPUN' EQ '5D').BSCCPX                      @D35BIML 00628000
.BSCCP40 ANOP                                                  @D35BIML 00629000
         MNOTE 3,'INVALID CSAPUN SPECIFICATION - CSAPUN=0 ASSUMED'      00630000
&CCSAP   SETC  '0'                                             @D35BIML 00631000
.BSCCPX  ANOP                                                  @D35BIML 00632000
.********************************************************************** 00633000
.*                                                                      00634000
.*       CSAMSG-CHECKING********                                        00635000
.*       (COMPONENT SELECT CHARACTER FOR MSG-OUTPUT)                    00636000
.*                                                                      00637000
.********************************************************************** 00638000
.*                                                                      00639000
&CCSAM   SETC  '&CCSAL'             MSG LIKE PRINT IS DEFAULT  @D35BIML 00640000
         AIF   (&CSAMP AND(T'&CSAMSG EQ 'O')).BSCCMX           @D35BIML 00641000
         AIF   (NOT &CSAMP).BSCCM20                            @D35BIML 00642000
         MNOTE 3,'CSAMSG SPECIFICATION NOT APPLICABLE - IGNORED'        00643000
         AGO   .BSCCMX                                         @D35BIML 00644000
.BSCCM20 ANOP                                                  @D35BIML 00645000
         AIF   (T'&CSAMSG EQ 'O').BSCCMX                       @D35BIML 00646000
&CCSAM   SETC  '&CSAMSG'            ASSUME CORRECT CSAMSG=     @D35BIML 00647000
         AIF   ('&CSAMSG' EQ 'DC1' OR '&CSAMSG' EQ 'DC2' OR '&CSAMSG'  +00648000
               EQ 'DC3' OR '&CSAMSG' EQ '0').BSCCMX            @D35BIML 00649000
         AIF   (&CS5DS).BSCCM40      NO ')' ALLOWED ?          @D35BIML 00650000
         AIF   ('&CSAMSG' EQ '5D').BSCCMX                      @D35BIML 00651000
.BSCCM40 ANOP                                                  @D35BIML 00652000
         MNOTE 3,'INVALID CSAMSG SPECIFICATION - CSAMSG=0 ASSUMED'      00653000
&CCSAM   SETC  '0'                                             @D35BIML 00654000
.BSCCMX  ANOP                                                  @D35BIML 00655000
.********************************************************************** 00656000
.*                                                                      00657000
.*                                                                      00658000
.*       MSGEJCT-CHECKING********                                       00659000
.*       (EJECT BEFORE NEW MSG-BLOCK)                                   00660000
.*                                                                      00661000
.********************************************************************** 00662000
.*                                                                      00663000
         AIF   (&MSGEJP AND(T'&MSGEJCT EQ 'O')).BSCMEX         @D35BIML 00664000
         AIF   (NOT &MSGEJP).BSCME20                           @D35BIML 00665000
         MNOTE 3,'MSGEJCT SPECIFICATION NOT APPLICABLE - IGNORED'       00666000
         AGO   .BSCMEX                                         @D35BIML 00667000
.BSCME20 ANOP                                                  @D35BIML 00668000
         AIF   ('&MSGEJCT' EQ 'YES' OR T'&MSGEJCT EQ 'O').BSCMEX        00669000
&BEJECT  SETC  '0'          SUPRESS EJECT BEFORE MSG           @D35BIML 00670000
         AIF   ('&MSGEJCT' EQ 'NO').BSCMEX                     @D35BIML 00671000
         MNOTE 3,'INVALID MSGEJCT SPECIFICATION - MSGEJCT=NO ASSUMED'   00672000
.BSCMEX  ANOP                                                  @D35BIML 00673000
.********************************************************************** 00674000
.*                                                                      00675000
.*                                                                      00676000
.*       MSGSPCE-CHECKING********                                       00677000
.*       (SPACE 5 LINES AFTER LAST MSG)                                 00678000
.*                                                                      00679000
.********************************************************************** 00680000
.*                                                                      00681000
         AIF   (&MSGSPP AND(T'&MSGSPCE EQ 'O')).BSCMSX         @D35BIML 00682000
         AIF   (NOT &MSGSPP).BSCMS20                           @D35BIML 00683000
         MNOTE 3,'MSGSPCE SPECIFICATION NOT APPLICABLE - IGNORED'       00684000
         AGO   .BSCMSX                                         @D35BIML 00685000
.BSCMS20 ANOP                                                  @D35BIML 00686000
         AIF   ('&MSGSPCE' EQ 'YES' OR T'&MSGSPCE EQ 'O').BSCMSX        00687000
&BSPACE  SETC  '0'          SUPRESS EJECT BEFORE MSG           @D35BIML 00688000
         AIF   ('&MSGSPCE' EQ 'NO').BSCMSX                     @D35BIML 00689000
         MNOTE 3,'INVALID MSGSPCE SPECIFICATION - MSGSPCE=NO ASSUMED'   00690000
.BSCMSX  ANOP                                                  @D35BIML 00691000
.********************************************************************** 00692000
.*                                                                      00693000
.*                                                                      00694000
.*       TURNEOJ-CHECKING********                                       00695000
.*       (LINE TURNAROUND AFTER EOJ)                                    00696000
.*                                                                      00697000
.********************************************************************** 00698000
.*                                                                      00699000
         AIF   (&LTURNP AND(T'&TURNEOJ EQ 'O')).BSCLTX         @D35BIML 00700000
         AIF   (NOT &LTURNP).BSCLT20                           @D35BIML 00701000
         MNOTE 3,'TURNEOJ SPECIFICATION NOT APPLICABLE - IGNORED'       00702000
         AGO   .BSCLTX                                         @D35BIML 00703000
.BSCLT20 ANOP                                                  @D35BIML 00704000
         AIF   (T'&TURNEOJ EQ 'O').BSCLTX  DEFAULT VALUE ?     @D35BIML 00705000
         AIF   ('&TURNEOJ' NE 'YES').BSCLT40                   @D35BIML 00706000
&BLTURN  SETC  'F2LTURN'                                       @D35BIML 00707000
         AGO   .BSCLTX                                         @D35BIML 00708000
.BSCLT40 ANOP                                                  @D35BIML 00709000
&BLTURN  SETC  '0'          SUPRESS LINE TURN AFTER EOJ        @D35BIML 00710000
         AIF   ('&TURNEOJ' EQ 'NO').BSCLTX                     @D35BIML 00711000
         MNOTE 3,'INVALID TURNEOJ SPECIFICATION - TURNEOJ=NO ASSUMED'   00712000
.BSCLTX  ANOP                                                  @D35BIML 00713000
.*                                                                      00714000
.********************************************************************** 00715000
.*                                                                      00716000
.*       TRNSP-CHECKING********                                         00717000
.*       (TRANSPARANCY REMOTE FEATURE)                                  00718000
.*                                                                      00719000
.********************************************************************** 00720000
.*                                                                      00721000
         AIF   (&TRNSPP AND(T'&TRNSP EQ 'O')).BSCTSX           @D35BIML 00722000
         AIF   (NOT &TRNSPP).BSCTS20                           @D35BIML 00723000
         MNOTE 3,'TRNSP SPECIFICATION NOT APPLICABLE - IGNORED'         00724000
         AGO   .BSCTSX                                         @D35BIML 00725000
.BSCTS20 ANOP                                                  @D35BIML 00726000
         AIF   (T'&TRNSP EQ 'O').BSCTSX                        @DA22393 00727000
         AIF   ('&TRNSP' EQ 'NO').BSCTSX                       @D35BIML 00728000
&BTRANS  SETC  'F4TRANS'    TRANSPARANCY FEATURE BIT           @D35BIML 00729000
         AIF   ('&TRNSP' EQ 'YES').BSCTSX                      @DA22393 00730000
         MNOTE 3,'INVALID TRNSP SPECIFICATION- TRNSP=YES ASSUMED'       00731000
.BSCTSX  ANOP                                                  @D35BIML 00732000
.*                                                                      00733000
.********************************************************************** 00734000
.*                                                                      00735000
.*       SCE-CHECKING********                                           00736000
.*       (SPACE COMPRESSION EXPANSION FEATURE)                          00737000
.*                                                                      00738000
.********************************************************************** 00739000
.*                                                                      00740000
         AIF   (&SCEP AND(T'&SCE EQ 'O')).BSCSCX               @D35BIML 00741000
         AIF   (NOT &SCEP).BSCSC20                             @D35BIML 00742000
         MNOTE 3,'SCE SPECIFICATION NOT APPLICABLE - IGNORED'  @D35BIML 00743000
         AGO   .BSCSCX                                         @D35BIML 00744000
.BSCSC20 ANOP                                                  @D35BIML 00745000
         AIF   ('&SCE' EQ 'NO' OR T'&SCE EQ 'O').BSCSCX        @D35BIML 00746000
.*       AIF   ('&BTRANS' EQ 'F4TRANS').BSCSC30                @D22DDHS 00747000
&BBLSCE  SETC  'F4BLSCE'    SPACE COMPRESSION EXPANSION BIT    @D35BIML 00748000
         AIF   ('&SCE' EQ 'YES').BSCSCY                        @D35BIML 00749000
         MNOTE 3,'INVALID SCE SPECIFICATION- SCE=YES ASSUMED'  @D35BIML 00750000
.BSCSCY  ANOP                       SCE=YES                    @D35BIML 00751000
&BHORFC  SETC  '0'                                             @D35BIML 00752000
         AGO   .BSCMRE              NO HFC-CHECKING            @D35BIML 00753000
.BSCSC30 ANOP                                                  @D35BIML 00754000
         MNOTE 3,'TRNSP SPECIFIED - SCE SPECIFICATION IGNORED' @D03PIRG 00755000
.BSCSCX  ANOP                                                  @D35BIML 00756000
.*                                                                      00757000
.********************************************************************** 00758000
.*                                                                      00759000
.*       HFC-CHECKING********                                           00760000
.*       (HORIZONTAL FORMAT CONTROL FEATURE)                            00761000
.*                                                                      00762000
.********************************************************************** 00763000
.*                                                                      00764000
         AIF   (&HFCP AND(T'&HFC EQ 'O')).BSCHFX               @D35BIML 00765000
         AIF   (NOT &HFCP).BSCHF20                             @D35BIML 00766000
         MNOTE 3,'HFC SPECIFICATION NOT APPLICABLE - IGNORED'  @D35BIML 00767000
         AGO   .BSCHFX                                         @D35BIML 00768000
.BSCHF20 ANOP                                                  @D35BIML 00769000
         AIF   ('&TYPE' EQ '3780' AND T'&HFC EQ 'O').BSCHF30   @DA32064 00770000
         AIF   ('&HFC' EQ 'NO' OR T'&HFC EQ 'O').BSCHFX        @D35BIML 00771000
.BSCHF30 ANOP                                                  @DA32064 00772000
&BHORFC  SETC  'F4HORFC'    HORIZONTAL FORMAT CONTROL BIT      @D35BIML 00773000
         AIF   ('&HFC' EQ 'YES').BSCHFX                        @D35BIML 00774000
         AIF   ('&TYPE' EQ '3780' AND T'&HFC EQ 'O').BSCHFX    @DA32064 00775000
         MNOTE 3,'INVALID HFC SPECIFICATION- HFC=YES ASSUMED'  @D35BIML 00776000
.BSCHFX  ANOP                                                  @D35BIML 00777000
.*                                                                      00778000
.********************************************************************** 00779000
.*                                                                      00780000
.*       MRF-CHECKING********                                           00781000
.*       (MULTI RECORD/BLOCK FEATURE)                                   00782000
.*                                                                      00783000
.********************************************************************** 00784000
.*                                                                      00785000
.BSCMRE  ANOP                                                  @D35BIML 00786000
         AIF   (&MRFP AND(T'&MRF EQ 'O')).BSCMRX               @D35BIML 00787000
         AIF   (NOT &MRFP).BSCMR20                             @D35BIML 00788000
         MNOTE 3,'MRF SPECIFICATION NOT APPLICABLE - IGNORED'  @D35BIML 00789000
         AGO   .BSCMRX                                         @D35BIML 00790000
.BSCMR20 ANOP                                                  @D35BIML 00791000
         AIF   ('&MRF' EQ 'NO' OR T'&MRF EQ 'O').BSCMRX        @D35BIML 00792000
&ANRPB   SETA  &MRFV                NO OF RECORDS/BLOCK        @D35BIML 00793000
         AIF   ('&MRF' EQ 'YES').BSCMRX                        @D35BIML 00794000
         MNOTE 3,'INVALID MRF SPECIFICATION- MRF=YES ASSUMED'  @D35BIML 00795000
.BSCMRX  ANOP                                                  @D35BIML 00796000
.*                                                                      00797000
.********************************************************************** 00798000
.*                                                                      00799000
.*       ABE-CHECKING********                                           00800000
.*       (ADDITIONAL BUFFER EXPANSION)                                  00801000
.*                                                                      00802000
.********************************************************************** 00803000
.*                                                                      00804000
         AIF   (&ABEP AND(T'&ABE EQ 'O')).BSCABX               @D35BIML 00805000
         AIF   (NOT &ABEP).BSCAB20                             @D35BIML 00806000
         MNOTE 3,'ABE SPECIFICATION NOT APPLICABLE - IGNORED'  @D35BIML 00807000
         AGO   .BSCABX                                         @D35BIML 00808000
.BSCAB20 ANOP                                                  @D35BIML 00809000
         AIF   ('&ABE' EQ 'NO' OR T'&ABE EQ 'O').BSCABX        @D35BIML 00810000
&ABFSZ   SETA  &ABEV                BUFFERSIZE                 @D35BIML 00811000
&BEP     SETB  1                    BE= NOT APPLICABLE         @D35BIML 00812000
         AIF   ('&ABE' EQ 'YES').BSCABX                        @D35BIML 00813000
         MNOTE 3,'INVALID ABE SPECIFICATION- ABE=YES ASSUMED'  @D35BIML 00814000
.BSCABX  ANOP                                                  @D35BIML 00815000
.*                                                                      00816000
.********************************************************************** 00817000
.*                                                                      00818000
.*       BE-CHECKING********                                            00819000
.*       (BUFFER EXPANSION)                                             00820000
.*                                                                      00821000
.********************************************************************** 00822000
.*                                                                      00823000
         AIF   (&BEP AND(T'&BE EQ 'O')).BSCBEX                 @D35BIML 00824000
         AIF   (NOT &BEP).BSCBE20                              @D35BIML 00825000
         MNOTE 3,'BE SPECIFICATION NOT APPLICABLE - IGNORED'   @D35BIML 00826000
         AGO   .BSCBEX                                         @D35BIML 00827000
.BSCBE20 ANOP                                                  @D35BIML 00828000
         AIF   ('&BE' EQ 'NO' OR T'&BE EQ 'O').BSCBEX          @D35BIML 00829000
&ABFSZ   SETA  &BEV                BUFFERSIZE                  @D35BIML 00830000
         AIF   ('&BE' EQ 'YES').BSCBEX                         @D35BIML 00831000
         MNOTE 3,'INVALID BE SPECIFICATION- BE=YES ASSUMED'    @D35BIML 00832000
.BSCBEX  ANOP                                                  @D35BIML 00833000
.*                                                                      00834000
.********************************************************************** 00835000
.*                                                                      00836000
.*       LIST-CHECKING********                                          00837000
.*       (RECORDSIZE FOR LIST OUTPUT)                                   00838000
.*                                                                      00839000
.********************************************************************** 00840000
.*                                                                      00841000
         AIF   (&LISTP AND(T'&LIST EQ 'O')).BSCPRX             @D35BIML 00842000
         AIF   (NOT &LISTP).BSCPR20                            @D35BIML 00843000
         MNOTE 3,'LIST SPECIFICATION NOT APPLICABLE - IGNORED' @D35BIML 00844000
         AGO   .BSCPRX                                         @D35BIML 00845000
.BSCPR20 ANOP                                                  @D35BIML 00846000
         AIF   (T'&LIST EQ 'O').BSCPRX                         @D35BIML 00847000
         AIF   (T'&LIST NE 'N').BSCPR30                        @D35BIML 00848000
         AIF   (&LIST LT &LLPW OR &LIST GT &ULPW).BSCPR30      @D35BIML 00849000
&A1LLN   SETA  &LIST                PRINTWIDTH                 @D35BIML 00850000
         AGO   .BSCPRX                                         @D35BIML 00851000
.BSCPR30 ANOP                                                  @D35BIML 00852000
         MNOTE 3,' INVALID LIST SPECIFICATION - LIST=&A1LLN ASSUMED'    00853000
.BSCPRX  ANOP                                                  @D35BIML 00854000
.*                                                                      00855000
.********************************************************************** 00856000
.*                                                                      00857000
.*       MSG-CHECKING********                                           00858000
.*       (PRINT WIDTH FOR MSG)                                          00859000
.*                                                                      00860000
.********************************************************************** 00861000
.*                                                                      00862000
         AIF   (&MSGP AND(T'&MSG EQ 'O')).BSCMGX               @D35BIML 00863000
         AIF   (NOT &MSGP).BSCMG20                             @D35BIML 00864000
         MNOTE 3,'MSG SPECIFICATION NOT APPLICABLE - IGNORED'  @D35BIML 00865000
         AGO   .BSCMGX                                         @D35BIML 00866000
.BSCMG20 ANOP                                                  @D35BIML 00867000
&A1MLN   SETA  &A1LLN               TAKE LIST  SIZE            @D35BIML 00868000
         AIF   (T'&MSG EQ 'O').BSCMGX                          @D35BIML 00869000
         AIF   (T'&MSG NE 'N').BSCMG30                         @D35BIML 00870000
         AIF   (&MSG LT &LLPW OR &MSG GT &ULPW).BSCMG30        @D35BIML 00871000
&A1MLN   SETA  &MSG                PRINTWIDTH                  @D35BIML 00872000
         AGO   .BSCMGX                                         @D35BIML 00873000
.BSCMG30 ANOP                                                  @D35BIML 00874000
         MNOTE 3,' INVALID MSG SPECIFICATION - MSG=&A1MLN ASSUMED'      00875000
.BSCMGX  ANOP                                                  @D35BIML 00876000
.*                                                                      00877000
.********************************************************************** 00878000
.*                                                                      00879000
.*       PUN-CHECKING********                                           00880000
.*       (RECORDSIZE FOR PUNCH OUTPUT)                                  00881000
.*                                                                      00882000
.********************************************************************** 00883000
.*                                                                      00884000
         AIF   (&PUNP AND(T'&PUN EQ 'O')).BSCPNX               @D35BIML 00885000
         AIF   (NOT &PUNP).BSCPN20                             @D35BIML 00886000
         MNOTE 3,'PUN SPECIFICATION NOT APPLICABLE - IGNORED'  @D35BIML 00887000
         AGO   .BSCPNX                                         @D35BIML 00888000
.BSCPN20 ANOP                                                  @D35BIML 00889000
         AIF   (T'&PUN EQ 'O').BSCPNX                          @D35BIML 00890000
         AIF   (T'&PUN NE 'N').BSCPN30                         @D35BIML 00891000
         AIF   (&PUN LT &LLPW OR &PUN GT &ULPW).BSCPN30        @D35BIML 00892000
&A1PLN   SETA  &PUN                PUNCH RECORD SIZE           @D35BIML 00893000
         AGO   .BSCPNX                                         @D35BIML 00894000
.BSCPN30 ANOP                                                  @D35BIML 00895000
         MNOTE 3,' INVALID PUN SPECIFICATION - PUN=&A1PLN ASSUMED'      00896000
.BSCPNX  ANOP                                                  @D35BIML 00897000
         AGO   .BSCGEN              GENERATE ITS O.K.          @D35BIML 00898000
.*                                                                      00899000
.********************************************************************** 00900000
.*                                                                      00901000
.*       ERROR MNOTE AND ERROR PRMT-ENTRY                               00902000
.*                                                                      00903000
.********************************************************************** 00904000
.*                                                                      00905000
.BSCMN1  ANOP                                                  @D35BIML 00906000
         MNOTE 5,'REF AND TYPE BOTH MISSING - MACRO IGNORED.'           00907000
         AGO   .BSCGEX                                         @D22DDHS 00908000
.BSCMN2  ANOP                                                  @D35BIML 00909000
         MNOTE 5,'INVALID REMOTE SPECIFICATION - MACRO IGNORED.'        00910000
         AGO   .BSCGEX                                                  00911000
.BSCMN5  ANOP                                                  @D35BIML 00912000
         MNOTE 5,'INVALID REF SPECIFICATION - MACRO IGNORED.'           00913000
         AGO   .BSCGEX                                         @D22DDHS 00914000
.BSCMN6  ANOP                                                  @D35BIML 00915000
         MNOTE 5,'INVALID TYPE SPECIFICATION - MACRO IGNORED.'          00916000
         AGO   .BSCGEX                                         @D22DDHS 00917000
.BSCMN7  ANOP                                                  @D35BIML 00918000
         MNOTE 5,'MACRO OUT OF SEQUENCE - MACRO IGNORED.'               00919000
         AGO   .BSCGEX                                         @D35BIML 00920000
.BSCERR   ANOP                                                          00921000
&CRPD    SETC  '&P.REME'            INDICATE ERROR PRMT-ENTRY  @D35BIML 00922000
&BLC     SETC  'ERR'                INDICATE ERROR             @D35BIML 00923000
.*                                                                      00924000
.*                                                                      00925000
.BSCGEN  ANOP                       START GENERATION           @D35BIML 00926000
.*                                                                      00927000
.********************************************************************** 00928000
.*                                                                      00929000
.*       CHECK AND GENERATE FOR PRESIGNON REMOTE                        00930000
.*                                                                      00931000
.********************************************************************** 00932000
.*                                                                      00933000
         AIF   (&GBSO).BSCEP2                                  @D35BIML 00934000
         AIF   (NOT &GBISO).BSCSOX  ONLY FOR FIRST PRMT        @D35BIML 00935000
.*                                                                      00936000
.*       SET STANDARD VALUES,GLOBALS AND SIGNIFICANT PARAMETERS         00937000
.*       FROM FIRST PRMT                                                00938000
.*       FOR IMPLICIT PRESIGNON REMOTE                                  00939000
.*                                                                      00940000
&CRPD    SETC  '1'                  1 PRINTER DEVICE           @D35BIML 00941000
&ABFSZ   SETA  128                  BUFFERSIZE                 @D35BIML 00942000
&ANRPB   SETA  1                    RECORD/BLOCK               @D35BIML 00943000
&GCTYP   SETC  '&CTYP'              TYPE AS FIRST PRMT         @D35BIML 00944000
&A1LLN   SETA  80                   LIST RECORD LENGTH         @D35BIML 00945000
&A1PLN   SETA  80                   PUNCH                      @D35BIML 00946000
&GA1MLN  SETA  &A1MLN               RECORD MSG-LENGTH          @D35BIML 00947000
.*                                                                      00948000
.*       PRESIGNON REMOTE FEATURES                                      00949000
.*       FEA2                                                           00950000
.*       FEA3                                                           00951000
&BTRACE  SETC  '0'                  NO TRACE OPTION            @D35BIML 00952000
.*       FEA4                                                           00953000
&GBVARLG SETC  '&BVARLG'            VARIABLE LENGTH            @D35BIML 00954000
.*       FEA5                                                           00955000
&BTNL    SETC  '0'                  NO NL-BSC-CHARACTER        @D35BIML 00956000
&BEJECT  SETC  'F5EJECT'            EJECT BEFOR MESSAGES       @D35BIML 00957000
&BSPACE  SETC  'F5SPACE'           TERMINAL REQU.SPACE 3 AFTER @D35BIML 00958000
&GBT3741 SETC  '&BT3741'            3741- TR-TABLE             @D35BIML 00959000
&GBL2780 SETC  '&BL2780'            LIKE 2780                  @D35BIML 00960000
         AGO   .BSCEP0              EXPAND IMPLICIT            @D35BIML 00961000
.*                                  PRESIGNON REMOTE                    00962000
.*                                                                      00963000
.BSCSOX  ANOP                       GENERATE PRESIGNON REMOTE  @D35BIML 00964000
         TITLE '      VSE/POWER      RJE,BSC  PRMT  DEFINITIONS  '      00965000
*                                                                       00966000
*        PRESIGNON REMOTE                                               00967000
*                                                                       00968000
         AIF   ('&BLC' EQ 'SOR').BSCEP0  EXTERNAL PRESIGNON REMOTE      00969000
&GBISO   SETB  1                    INDICATE IMPLICIT          @D35BIML 00970000
.*                                                                      00971000
.*       RECURSIVE CALL TO PRMT-MACRO TO GENERATE PRESIGNON REMOTE      00972000
.*                                                                      00973000
*                                                                       00974000
*        SOME OF THESE IMPLICIT PRESIGNON REMOTE CHARACTERISTICS        00975000
*        MAY BE OVERLAID BY ORG INSTRUCTION TO GET                      00976000
*        BASIC PRESIGNON REMOTE CHARACTERISTICS.                        00977000
*                                                                       00978000
         PRMT  REMOTE=SOR,                                     @D35BIML+00979000
               TYPE=2780,                                      @D35BIML+00980000
               TURNEOJ=&TURNEOJ                                @D35BIML 00981000
         TITLE '      VSE/POWER      RJE,BSC  PRMT  DEFINITION  -      *00982000
               REMOTE ID = &REMOTE      '                      @D35BIML 00983000
*                                                                       00984000
*        FIRST USER DEFINED REMOTE TABLE ENTRY                          00985000
*                                                                       00986000
.BSCEP0  ANOP                                                  @D35BIML 00987000
&GBSO    SETB  1                    PRESIGNON GENERATED        @D35BIML 00988000
         AGO   .BSCEP3                                         @D35BIML 00989000
.BSCEP2  ANOP                                                  @D35BIML 00990000
         TITLE '      VSE/POWER      RJE,BSC  PRMT  DEFINITION  -      *00991000
               REMOTE ID = &REMOTE      '                      @D35BIML 00992000
.BSCEP3  ANOP                                                  @D35BIML 00993000
.********************************************************************** 00994000
.*                                                                      00995000
.*       GENERATION OF ERROR GAPS BETWEEN NOT SUBSEQUENT ENTRIES        00996000
.*                                                                      00997000
.********************************************************************** 00998000
.*                                                                      00999000
         AIF   (&GAP EQ 0).BSCNG    NO GAP ? YES,SKIP          @D35BIML 01000000
         DC    (&GAP.*SORDRMLN)AL1(&P.REME)   GAP AS ERROR     @D35BIML 01001000
.*                                                             @DA20709 01002000
.*       UPDATE POINTERS IN POWER MACRO                        @DA20709 01003000
.*                                                             @DA20709 01004000
&GBL1    SETA  &GBL1+(&GAP)*24    UPDATE POWER+BSC TABLE LENGTH@D03PIQW 01005000
         ORG   IPW$POW2           ORG BACK TO POWER MACRO      @DA20709 01006000
         DC    AL2(&GBL1)         UPDATE POWER+BSC TABLE LENGTH@DA20709 01007000
         ORG   IPW$POW8           ORG BACK TO POWER MACRO      @DA20709 01008000
&GBL5    SETA  &GBL1                                           @DA20709 01009000
         DC    AL2(&GBL5)         UPDATE TOTAL TABLE LENGTH    @DA20709 01010000
         ORG   ,                  DON'T LET CODE OVERRUN       @DA20709 01011000
         SPACE 1                                               @DA20709 01012000
.BSCNG   ANOP                                                  @D35BIML 01013000
.********************************************************************** 01014000
.*                                                                      01015000
.*                                                                      01016000
.*       EXPANSION OF REMOTE TABLE ENTRY                                01017000
.*                                                                      01018000
.*                                                                      01019000
.********************************************************************** 01020000
.*                                                                      01021000
*                                                              @D35BIML 01022000
&P.DRM   EQU   *                                               @D35BIML 01023000
&P.REMI  DC    CL3'&BLC'           REMOTE IDENTIFIER CHAR. FORM@D35BIML 01024000
&P.ROUT  DS    0CL2                ROUTING TARGETS             @D35BIML 01025000
&P.PUR   DC    AL1(&BL2)           PUNCH ROUTING               @D35BIML 01026000
&P.LIR   DC    AL1(&BL3)           LIST ROUTING                @D35BIML 01027000
*                                                                       01028000
&P.RCH   EQU   *                   CHARACTERISTICS OF REMOTE   @D35BIML 01029000
&P.RPD   DC    AL1(&CRPD)          NUMBER OF PRINT DEVICES     @D35BIML 01030000
&P.REMX  EQU   &P.RPD              ALSO USED FOR INDICATION    @D35BIML 01031000
&P.REME  EQU   X'FF'               ERROR PRMT ENTRY            @D35BIML 01032000
&P.REMR  EQU   X'FE'               REFERENCE  ENTRY            @D35BIML 01033000
*                                                                       01034000
&P.BFSZ  DC    Y(&ABFSZ)           REMOTE TERMINAL BUFFER SIZE @D35BIML 01035000
&P.NRPB  DC    AL1(&ANRPB)         MAX.NR. OF REC'S PER BLOCK  @D35BIML 01036000
         AIF   (T'&REF EQ 'O').BSCNG1 NO REFERENCE GIVEN       @DA20691 01037000
&P.TYP   DC    AL1(&CTYP)          REFERENCE REMOTE SUPPORTED  @DA20691 01038000
         AGO   .BSCNG2                                         @DA20691 01039000
.BSCNG1  ANOP                                                  @DA20691 01040000
&P.TYP   DC    AL1(TYP&CTYP)       TERMINAL TYPES SUPPORTED    @D35BIML 01041000
.BSCNG2  ANOP                                                  @DA20691 01042000
&P.REF   EQU   &P.TYP              ALSO USED AS REFERNECE      @D35BIML 01043000
*                                                                       01044000
&P.CSAL  DC    AL1(FEACS&CCSAL)    COMPONENT SELECT LIST       @D35BIML 01045000
&P.CSAP  DC    AL1(FEACS&CCSAP)    COMPONENT SELECT PUNCH      @D35BIML 01046000
&P.CSAM  DC    AL1(FEACS&CCSAM)    COMPONENT SELECT MESSAGE    @D35BIML 01047000
         DC    X'00'               RESERVED                    @D03PIRG 01048000
*                                                                       01049000
&P.1LLN  DC    Y(&A1LLN)           1LST PRINT-LENGTH           @D35BIML 01050000
&P.1PLN  DC    Y(&A1PLN)           1PUN                        @D35BIML 01051000
&P.1MLN  DC    Y(&A1MLN)           1MSG                        @D35BIML 01052000
         AIF   ('&P' EQ 'LCB' OR '&P' EQ 'RJR').BSCEP6         @D35BIML 01053000
         EJECT ,                                                        01054000
.BSCEP6  ANOP                                                  @D35BIML 01055000
*                                                                       01056000
*        REMOTE FEATURES                                                01057000
*                                                                       01058000
&P.FEA2  DC    AL1(&BLTURN)                                    @D03PIRG 01059000
&P.FEA3  DC    AL1(&BTRACE+&BTR2H1T)                           @D35BIML 01060000
&P.FEA4  DC    AL1(&BTRANS+&BMULRC+&BHORFC+&BBLSCE+&BCOMSL+&BVARLG+&BNO*01061000
               FC)                                             @D35BIML 01062000
&P.FEA5  DC    AL1(&BTNL+&BEJECT+&BSPACE+&BT3741+&BL2780)      @D35BIML 01063000
.*                                                             @D35BIML 01064000
&P.RCHL  EQU   *-&P.RCH           CHARACTERISTICS LENGTH       @D35BIML 01065000
&P.DRMLN EQU   *-&P.DRM           REMOTE- ENTRY LENGTH         @D35BIML 01066000
&P.NXT   EQU   *                  NEXT REMOTE TABLE ENTRY      @D35BIML 01067000
         SPACE                                                          01068000
         AIF   ('&BLC' EQ 'SOR').BSCSUX  SKIP GLOBAL UPD FOR   @D35BIML 01069000
.*                                  PRESIGNON REMOTE                    01070000
.*                                                                      01071000
         AIF   ('&REMOTE' EQ 'LCB').BSCEX9                     @D35BIML 01072000
         AIF   ('&REMOTE' EQ 'RJR').BSCNEQ                     @D35BIML 01073000
.*                                                                      01074000
.********************************************************************** 01075000
.*                                                                      01076000
.*       UPDATE IMPLICIT PRESIGNON REMOTE                               01077000
.*                                                                      01078000
.********************************************************************** 01079000
.*                                                                      01080000
         AIF   (NOT &GBISO).BSCSUX  NOT IMPLICIT SKIP          @D35BIML 01081000
.*                                                                      01082000
         AIF   ('&GCTYP' EQ '&CTYP' OR '&GCTYP' EQ '0').BSCSU10         01083000
&GCTYP   SETC  '0'                                             @D35BIML 01084000
.BSCSU10 ANOP                                                  @D35BIML 01085000
         AIF   ('&GCSAM' EQ '&CCSAM' OR '&GCSAM' EQ '0').BSCSU20        01086000
&GCSAM   SETC  '0'                                             @D35BIML 01087000
.BSCSU20 ANOP                                                  @D35BIML 01088000
         AIF   (&GA1MLN LE &A1MLN).BSCSU30 LOWER PRINTWIDTH    @D35BIML 01089000
&GA1MLN  SETA  &A1MLN               NEW PRINT WIDTH            @D35BIML 01090000
.BSCSU30 ANOP                                                  @D35BIML 01091000
.*       PRESIGNON REMOTE FEATURE 4                                     01092000
         AIF   (&GF4).BSCSU90       SKIP IF ALREADY ZERO       @D35BIML 01093000
&SOC     SETB  1                    ASSUME NO CHANGES          @D35BIML 01094000
         AIF   ('&GBCOMSL' EQ '&BCOMSL' OR '&GBCOMSL' EQ '0').BSCSU70   01095000
&GBCOMSL SETC  '0'                                             @D35BIML 01096000
&SOC     SETB  0                    CHANGED                    @D35BIML 01097000
.BSCSU70 ANOP                                                  @D35BIML 01098000
         AIF   ('&GBVARLG' EQ '&BVARLG' OR '&GBVARLG' EQ 'F4VARLG').BSC*01099000
               SU80                                            @D35BIML 01100000
&GBVARLG SETC  'F4VARLG'                                       @D35BIML 01101000
&SOC     SETB  0                    CHANGED                    @D35BIML 01102000
.BSCSU80 ANOP                                                  @D35BIML 01103000
         AIF   (&SOC).BSCSU84       NO CHANGES                 @D35BIML 01104000
.BSCSU84 ANOP                                                  @D35BIML 01105000
&GF4     SETB  ('&GBCOMSL' EQ '0' AND '&GBVARLG' EQ 'F4VARLG') @D35BIML 01106000
.BSCSU90 ANOP                                                  @D35BIML 01107000
.*       PRESIGNON REMOTE FEATURE 5                                     01108000
         AIF   (&GF5).BSCSU98       ALL ZEROES                 @D35BIML 01109000
&SOC     SETB  1                    ASSUME NO CHANGES          @D35BIML 01110000
         AIF   ('&GBT3741' EQ '&BT3741' OR '&GBT3741' EQ '0').BSCSU94   01111000
&GBT3741 SETC  '0'                                             @D35BIML 01112000
&SOC     SETB  0                    CHANGED                    @D35BIML 01113000
.BSCSU94 ANOP                                                  @D35BIML 01114000
         AIF   ('GBL2780' EQ '&BL2780' OR '&GBL2780' EQ '0').BSCSU96    01115000
&GBL2780 SETC  '0'                                             @D35BIML 01116000
&SOC     SETB  0                    CHANGED                    @D35BIML 01117000
.BSCSU96 ANOP                                                  @D35BIML 01118000
&GF5     SETB  ('&GBT3741' EQ '0' AND '&GBL2780' EQ '0')       @D35BIML 01119000
.BSCSU98 ANOP                                                  @D35BIML 01120000
.BSCSUX  ANOP                       EXIT OF PRESIGNON UPDATE   @D35BIML 01121000
.*                                                                      01122000
.********************************************************************** 01123000
.*                                                                      01124000
.*       UPDATE POINTERS IN POWER MACRO                                 01125000
.*                                                                      01126000
.********************************************************************** 01127000
.*                                                                      01128000
&GBL1    SETA  &GBL1+24           UPDATE POWER+BSC TABLE LENGTH@D03PIQW 01129000
         ORG   IPW$POW2           ORG BACK TO POWER MACRO               01130000
         DC    AL2(&GBL1)         UPDATE POWER+BSC TABLE LENGTH         01131000
         AIF   ('&BLC' EQ 'SOR').BSCGB3                        @D35BIML 01132000
&GBL3    SETA  &A                 UPDATE NUMBER OF RMTS        @D35BIML 01133000
         ORG   IPW$POW4           ORG BACK TO POWER MACRO               01134000
         DC    AL1(&GBL3)         UPDATE NUMBER OF BSC REMOTES          01135000
.BSCGB3  ANOP                                                  @D35BIML 01136000
         ORG   IPW$POW8           ORG BACK TO POWER MACRO      @D32DUSN 01137000
&GBL5    SETA  &GBL1                                           @D32DUSN 01138000
         DC    AL2(&GBL5)         UPDATE TOTAL TABLE LENGTH    @D32DUSN 01139000
         ORG   ,                  CONTINUE                              01140000
         SPACE                                                          01141000
.BSCEX9  ANOP                                                  @D35BIML 01142000
         AIF   (&GBEQU).BSCGEX                                 @D35BIML 01143000
&GBEQU   SETB  1                    EQUATES ARE GENERATED      @D35BIML 01144000
.*                                                                      01145000
.********************************************************************** 01146000
.*                                                                      01147000
.*       GENERATE EQUATES AFTER FIRST PRMT-ONLY                         01148000
.*                                                                      01149000
.********************************************************************** 01150000
*                                                              @D35BIML 01151000
*              LCBTYP  DECLARATIONS                            @D35BIML 01152000
*                                                              @D35BIML 01153000
TYP0     EQU   0                   DUMMY                       @D35BIML 01154000
TYP2770  EQU   10                  2770                        @D35BIML 01155000
TYP2780  EQU   20                  2780                        @D35BIML 01156000
TYP3741  EQU   30                  3741                        @D35BIML 01157000
TYP3780  EQU   50                  3780                        @D35BIML 01158000
         SPACE 2                                                        01159000
*                                                                       01160000
*        COMPONENT SELECT CHARACTER                                     01161000
*                                                                       01162000
FEACSDC1 EQU   X'11'               DC1                         @D35BIML 01163000
FEACSDC2 EQU   X'12'               DC2                         @D35BIML 01164000
FEACSDC3 EQU   X'13'               DC3                         @D35BIML 01165000
FEACS5D  EQU   X'5D'               )                           @D35BIML 01166000
FEACS0   EQU   X'00'               NO COMPONENT SELECT         @D35BIML 01167000
         EJECT ,                                                        01168000
*                                                              @D35BIML 01169000
*        LCBFEA2 DECLARATIONS - (LINE DISCIPLIN)               @D35BIML 01170000
*                                                              @D35BIML 01171000
F2LTURN  EQU   X'20'                LINE TURNAROUND BY EOJ     @D35BIML 01172000
        SPACE 2                                                @D35BIML 01173000
*                                                              @D35BIML 01174000
*        LCBFEA3  DECLARATIONS - USED FROM BSC READER          @D35BIML 01175000
*                                                              @D35BIML 01176000
F3TR2H1T EQU   X'40'                2-HEADING 1-TRAILING BYTE  @D35BIML 01177000
*                                   IN RECORD ON TRANSPARENCY. @D35BIML 01178000
*                                                              @D35BIML 01179000
*        LCBFEA4  DECLARATIONS - USED FROM BSC WRITER          @D35BIML 01180000
*                                                              @D35BIML 01181000
F4TRANS  EQU   X'80'               TRANSPARENCY FOR THIS REMOTE@D35BIML 01182000
F4MULRC  EQU   X'40'               MULTIPLE-LOG./PHYS.RECORD   @D35BIML 01183000
*                                  (I.E. 3741 EXP.COMMUNICATION)        01184000
F4HORFC  EQU   X'20'               HORIZONTAL FORMAT CONTROL   @D35BIML 01185000
F4BLSCE  EQU   X'10'               SPACE COMPRESSION EXPANSION @D35BIML 01186000
F4COMSL  EQU   X'08'               COMPONENT SELECT            @D35BIML 01187000
F4VARLG  EQU   X'04'               VARIABLE LENGTH RECORDC     @D35BIML 01188000
F4NOFC   EQU   X'02'               NO FORMCHANGE SUPPORTED     @D35BIML 01189000
*                                                              @D35BIML 01190000
*        LCBFEA5  DECLARATIONS - USED FROM BSC WRITER          @D35BIML 01191000
*                                                              @D35BIML 01192000
F5TNL    EQU   X'80'               NL CHARACTER ON END OF HT   @D35BIML 01193000
F5EJECT  EQU   X'20'               EJECT BEFORE MESSAGES       @D35BIML 01194000
F5SPACE  EQU   X'10'               TERMINAL REQU.SPACE 3 AFTER @D35BIML 01195000
*                                  RECORD  I.E.  2770          @D35BIML 01196000
F5T3741  EQU   X'08'               TRANSL.TABLE WITH 3741 CTRL @D35BIML 01197000
F5L2780  EQU   X'04'               TERM LIKE 2780              @D35BIML 01198000
         AGO   .BSCNEQ             SKIP MACRO DELIMITER LINE   @D35BIML 01199000
.BSCGEX  ANOP                      GENERAL BSC-EXIT            @D35BIML 01200000
         AIF   ('&REMOTE' EQ 'LCB').BSCNEQ  SKIP DELIMITER     @D35BIML 01201000
.*                                                                      01202000
.*                                                                      01203000
.*                                                                      01204000
.*                                                                      01205000
         SPACE 4                                                        01206000
*********************************************************************** 01207000
         SPACE 3                                                        01208000
.BSCNEQ  ANOP                                                  @D35BIML 01209000
         MEXIT                                                 @D32DUSN 01210000
.*                                                                      01211000
.*                                                                      01212000
.********************************************************************** 01213000
.*                                                                      01214000
.*                                                                      01215000
.* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  01216000
.*                                                                      01217000
.*                 S N A     C H A P T E R                              01218000
.*                                                                      01219000
.* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  01220000
.*                                                                      01221000
.SNA     ANOP                                                  @D32DUSN 01222000
         TITLE '      POWER/VS       RJE,SNA  PRMT  DEFINITION  -      *01223000
               REMOTE ID = &REMOTE      '                      @D35BIML 01224000
.* CHECK FOR INVALID COMBINATIONS                              @D32DUSN 01225000
.*                                                             @D32DUSN 01226000
         AIF   (&GBL4 EQ 0).MNOTE16    NO POWER MACRO          @D32DUSN 01227000
&PWD     SETC  ' '                                             @D32DUSN 01228000
         AIF   (T'&LIST EQ 'O').P040                           @D32DUSN 01229000
         MNOTE 3,'LIST IGNORED FOR SNA LOGICAL UNIT'           @D32DUSN 01230000
.P040    AIF   (T'&TRNSP EQ 'O' ).P050                         @D32DUSN 01231000
         MNOTE 3,'TRNSP IGNORED FOR SNA LOGICAL UNIT'          @D32DUSN 01232000
.P050    AIF   (T'&BE EQ 'O' ).P060                            @D32DUSN 01233000
         MNOTE 3,'BE IGNORED FOR SNA LOGICAL UNIT'             @D32DUSN 01234000
.P060    AIF   (T'&HFC EQ 'O' ).P070                           @D32DUSN 01235000
         MNOTE 3,'HFC IGNORED FOR SNA LOGICAL UNIT'            @D32DUSN 01236000
.P070    AIF   (T'&SCE EQ 'O' ).P080                           @D32DUSN 01237000
         MNOTE 3,'SCE IGNORED FOR SNA LOGICAL UNIT'            @D32DUSN 01238000
.P080    AIF   (T'&ABE EQ 'O' ).P090                           @D32DUSN 01239000
         MNOTE 3,'ABE IGNORED FOR SNA LOGICAL UNIT'            @D32DUSN 01240000
.P090    AIF   (T'&MRF EQ 'O' ).P100                           @D32DUSN 01241000
         MNOTE 3,'MRF IGNORED FOR SNA LOGICAL UNIT'            @D32DUSN 01242000
.P100    AIF   (T'&TRACE EQ 'O' ).P110                         @D32DUSN 01243000
         MNOTE 3,'TRACE IGNORED FOR SNA LOGICAL UNIT'          @D32DUSN 01244000
.P110    AIF   (T'&CS EQ 'O' ).P111                            @D32DUSN 01245000
         MNOTE 3,'CS IGNORED FOR SNA LOGICAL UNIT'             @D32DUSN 01246000
.P111    AIF   (T'&CSALST EQ 'O' ).P112                        @D35BIML 01247000
         MNOTE 3,'CSALST IGNORED FOR SNA LOGICAL UNIT'         @D35BIML 01248000
.P112    AIF   (T'&CSAPUN EQ 'O' ).P113                        @D35BIML 01249000
         MNOTE 3,'CSAPUN IGNORED FOR SNA LOGICAL UNIT'         @D35BIML 01250000
.P113    AIF   (T'&CSAMSG EQ 'O' ).P114                        @D35BIML 01251000
         MNOTE 3,'CSAMSG IGNORED FOR SNA LOGICAL UNIT'         @D35BIML 01252000
.P114    AIF   (T'&MSGEJCT EQ 'O' ).P115                       @D35BIML 01253000
         MNOTE 3,'MSGEJCT IGNORED FOR SNA LOGICAL UNIT'        @D35BIML 01254000
.P115    AIF   (T'&MSGSPCE EQ 'O' ).P116                       @D35BIML 01255000
         MNOTE 3,'MSGSPCE IGNORED FOR SNA LOGICAL UNIT'        @D35BIML 01256000
.P116    AIF   (T'&TURNEOJ EQ 'O' ).P122                       @D03PIRG 01257000
         MNOTE 3,'TURNEOJ IGNORED FOR SNA LOGICAL UNIT'        @D35BIML 01258000
.P122    AIF   (T'&MSG EQ 'O' ).P123                           @D35BIML 01259000
         MNOTE 3,'MSG IGNORED FOR SNA LOGICAL UNIT'            @D35BIML 01260000
.P123    AIF   (T'&PUN EQ 'O' ).P128                           @D35BIML 01261000
         MNOTE 3,'PUN IGNORED FOR SNA LOGICAL UNIT'            @D35BIML 01262000
.*                                                             @D32DUSN 01263000
.P128    AIF   (T'&REF EQ 'O').P150                            @D32DUSN 01264000
.P130    AIF   (T'&CONSOLE EQ 'O').P135                        @D03PISY 01265000
         MNOTE 3,'CONSOLE IGNORED IN COMBINATION WITH REF'     @D32DUSN 01266000
.P135    AIF   (T'&XLATE EQ 'O').P140                          @D03PISY 01267000
         MNOTE 3,'XLATE IGNORED IN COMBINATION WITH REF'       @D03PISY 01268000
.P140    AIF   (T'&PSWRD EQ 'O').P150                          @D32DUSN 01269000
         MNOTE 3,'PSWRD IGNORED IN COMBINATION WITH REF'       @D32DUSN 01270000
.P150    ANOP                                                  @D32DUSN 01271000
         AIF   (&SNA).P170              NOT FIRST SNA PRMT     @D32DUSN 01272000
&SNA     SETB  1                     INDICATE FIRST SNA PRMT   @D32DUSN 01273000
         AIF   (T'&REMOTE NE 'N').MNOTE14                      @D32DUSN 01274000
         AIF   (&REMOTE LE &GBL3).MNOTE14 REMID SMALLER THEN   @D32DUSN 01275000
         AIF   (&REMOTE GT 250).MNOTE14 BSC OR TOO BIG         @D22DDHS 01276000
.*                                                             @D32DUSN 01277000
.* INITIALIZATION **********                                   @D32DUSN 01278000
.*                                                             @D32DUSN 01279000
&GBL6    SETA  0                        SET NR OF ENTRIES TO 0 @D32DUSN 01280000
&GBL7    SETA  &REMOTE-1                SET FOR SEQ CHECK      @D32DUSN 01281000
&GBL8    SETA  &REMOTE                  SAME, BUT CONSTANT FOR @D32DUSN 01282000
.*                                      REF CHECKING           @D32DUSN 01283000
.P170    ANOP                                                  @D32DUSN 01284000
&GBL6    SETA  &GBL6+1                  UPDATE NR OF ENTRIES   @D32DUSN 01285000
&GBL7    SETA  &GBL7+1                  UPDATE SEQUENCE CHECK  @D32DUSN 01286000
.*                                                             @D32DUSN 01287000
         AIF   (&REMOTE GT 250).MNOTE14  REMID LARGER THAN 250 @D22DDHS 01288000
         AIF   (&REMOTE EQ &GBL7).P175   IS THERE A GAP        @DA23371 01289000
&A       SETA  &REMOTE                   CALCULATE             @DA23371 01290000
&GAP     SETA  &A-&GBL7                  NUMBER OF GAPS        @DA23371 01291000
         AIF   (&GAP LT 0).MNOTE14       NUMBERS NOT ASCENDING @DY44766 01292000
.P176    ANOP                                                  @DA23371 01293000
&BL6     SETA  0                         DEFAULT TERM FEATURES @DA23371 01294000
&LPW     SETA  0                         DEFAULT PASSW LENGHT  @DA25208 01295000
&CN      SETC  '    '                    DEFAULT CMPACT NAME   @DA23371 01296000
&K       SETA  0                         DEFAULT NUMB LU NAMES @DA23371 01297000
         AGO   .P29P                     GO TO MAINLINK        @DA23371 01298000
.*                                                             @D32DUSN 01299000
.* PUNROUT CHECKING                                            @D32DUSN 01300000
.*                                                             @D32DUSN 01301000
.P175    ANOP                                                  @DA23371 01302000
         AIF   (T'&PUNROUT EQ 'O').P180                        @D32DUSN 01303000
         AIF   (T'&PUNROUT NE 'N').P190                        @D32DUSN 01304000
         AIF   (&PUNROUT GT 250).P190                          @D22DDHS 01305000
&BL2     SETA  &PUNROUT                                        @D32DUSN 01306000
         AGO   .P200                                           @D32DUSN 01307000
.P180    ANOP                                                  @D32DUSN 01308000
&BL2     SETA  &REMOTE                                         @D32DUSN 01309000
         AGO   .P200                                           @D32DUSN 01310000
.P190    MNOTE 3,'INVALID PUNROUT SPECIFICATION - 000 ASSUMED' @D32DUSN 01311000
.P200    ANOP                                                  @D32DUSN 01312000
.*                                                             @D32DUSN 01313000
.* LSTROUT CHECKING                                            @D32DUSN 01314000
.*                                                             @D32DUSN 01315000
         AIF   (T'&LSTROUT EQ 'O').P210                        @D32DUSN 01316000
         AIF   (T'&LSTROUT NE 'N').P220                        @D32DUSN 01317000
         AIF   (&LSTROUT GT 250).P220                          @D22DDHS 01318000
&BL3     SETA  &LSTROUT                                        @D32DUSN 01319000
         AGO   .P230                                           @D32DUSN 01320000
.P210    ANOP                                                  @D32DUSN 01321000
&BL3     SETA  &REMOTE                                         @D32DUSN 01322000
         AGO   .P230                                           @D32DUSN 01323000
.P220    MNOTE 3,'INVALID LSTROUT SPECIFICATION - 000 ASSUMED' @D32DUSN 01324000
.P230    ANOP                                                  @D32DUSN 01325000
.*                                                             @D32DUSN 01326000
.* REF CHECKING                                                @D32DUSN 01327000
.*                                                             @D32DUSN 01328000
         AIF   (T'&REF EQ 'O').P240                            @D32DUSN 01329000
         AIF   (T'&REF NE 'N').MNOTE15                         @D32DUSN 01330000
         AIF   (&REF LT &GBL8).MNOTE15                         @D32DUSN 01331000
         AIF   (&REF GE &REMOTE).MNOTE15                       @D32DUSN 01332000
.* &BL7 SET TO BLOCKSIZE WHEN NO REF IS SPECIFIED, ELSE REF ID @D32DUSN 01333000
.* &LPW SET TO LENGTH PASSWORD IF NO REF IS SPECIFIED, ELSE FF @D23DUHO 01334000
&BL7     SETA  &REF                     REF ID                 @D32DUSN 01335000
&LPW     SETA  X'FF'                    INDICATE REF           @D32DUSN 01336000
         AGO   .P245                                           @DM11373 01337000
.P240     ANOP                                                 @D32DUSN 01338000
&BL7     SETA  256                      BLOCKSIZE              @D32DUSN 01339000
.*                                                             @D32DUSN 01340000
.* CONSOLE CHECKING                                            @D32DUSN 01341000
.*                                                             @D32DUSN 01342000
.P245    AIF   (T'&CONSOLE EQ 'O').P260                        @DM11373 01343000
         AIF   (T'&REF EQ 'O').P247     NO REF                 @DM11373 01344000
         MNOTE 3,' CONSOLE IGNORED WHEN SPECIFIED WITH REF'    @DM11373 01345000
         AGO   .P260                    IGNORE CONSOLE         @DM11373 01346000
.P247    AIF    ('&CONSOLE' EQ 'YES').P250                     @DM11373 01347000
         AIF   ('&CONSOLE' EQ 'NO').P260                       @D32DUSN 01348000
         MNOTE 3,'INVALID CONSOLE SPECIFICATION - NO ASSUMED'  @D32DUSN 01349000
         AGO   .P260                                           @D32DUSN 01350000
.P250    ANOP                                                  @D32DUSN 01351000
&BL6     SETA  X'80'            INDICATE CONSOLE IS YES        @D32DUSN 01352000
.P260    ANOP                                                  @D32DUSN 01353000
.*                                                             @DY44115 01354000
.* MAXRECL  CHECKING **********                                @DY44115 01355000
.*                                                             @DY44115 01356000
&MAXPRT  SETA  132              DEFAULT MAXRECL                @DY44115 01357000
         AIF   (T'&MAXRECL EQ 'O').P262X                       @DY44115 01358000
         AIF   (T'&REF EQ 'O').P262A    NO REF                 @DY44115 01359000
         MNOTE 3,' MAXRECL IGNORED WHEN SPECIFIED WITH REF'    @DY44115 01360000
         AGO   .P262X                   IGNORE MAXRECL         @DY44115 01361000
.P262A   ANOP                                                  @DY44115 01362000
&MAXTEMP SETA  &MAXRECL                                        @DY44115 01363000
         AIF   (&MAXTEMP LE 512).P262B                         @DY44438 01364000
         MNOTE 3,' MAXRECL EXCEEDS 512, DEFAULT ASSUMED'       @DY44438 01365000
         AGO   .P262X                   IGNORE MAXRECL         @DY44115 01366000
.P262B   ANOP                                                  @DY44115 01367000
         AIF   (&MAXTEMP GT 131).P262C                         @DY44115 01368000
         MNOTE 3,' MAXRECL LESS THAN 132, DEFAULT ASSUMED'     @DY44115 01369000
         AGO   .P262X                   IGNORE MAXRECL         @DY44115 01370000
.P262C   ANOP                                                  @DY44115 01371000
&MAXPRT  SETA  &MAXTEMP                                        @DY44115 01372000
.P262X   ANOP                                                  @DY44115 01373000
.*                                                             @D32DUSN 01374000
.* PASSWORD CHECKING **********                                @D32DUSN 01375000
.*                                                             @D32DUSN 01376000
         AIF   (T'&PSWRD EQ 'O' OR K'&PSWRD EQ 0).P280         @D03PISY 01377000
         AIF   (T'&REF EQ 'O').P265     NO REF                 @DM11373 01378000
         MNOTE 3,' PSWRD IGNORED WHEN SPECIFIED WITH REF'      @DM11373 01379000
         AGO   .P280                    IGNORE PSWRD           @D03PISY 01380000
.P265    AIF   (K'&PSWRD LE 8).P270                            @DM11373 01381000
         MNOTE 3,'INVALID PSWRD - SPECIFICATION IGNORED'       @D32DUSN 01382000
         AGO   .P280                                           @D03PISY 01383000
.P270    ANOP                                                  @D32DUSN 01384000
&PWD     SETC  '&PSWRD'                                        @D32DUSN 01385000
&LPW     SETA  K'&PSWRD                                        @D32DUSN 01386000
.*                                                             @D32DUSN 01387000
.P280    ANOP                                                  @D03PISY 01388000
.*                                                                      01389000
.* XLATE CHECKING **********                                            01390000
.*                                                                      01391000
         AIF   (T'&XLATE EQ 'O').P290                          @D03PISY 01392000
         AIF   (T'&REF EQ 'O').P282   SKIP IF REF=             @D03PISY 01393000
         MNOTE 3,' XLATE IGNORED WHEN SPECIFIED WITH REF'      @D03PISY 01394000
         AGO   .P290                    IGNORE XLATE           @D03PISY 01395000
.P282    ANOP                                                  @D03PISY 01396000
         AIF   (N'&XLATE GT 1).P285   IF N'SUBPAR > 1, ERROR   @D03PISY 01397000
         AIF   ('&XLATE(1)' EQ 'YES').P287  OK                 @D03PISY 01398000
         AIF   ('&XLATE(1)' EQ 'NO').P290   NO SVF             @D03PISY 01399000
.P285    MNOTE 3,'INVALID XLATE SPECIFICATION - NO ASSUMED'    @D03PISY 01400000
         AGO   .P290                                           @D03PISY 01401000
.P287    ANOP                                                  @D03PISY 01402000
&BL6     SETA  &BL6+64          INDICATE XLATE=YES             @D03PISY 01403000
.P290    ANOP                                                  @D03PISY 01404000
.*                                                                      01405000
.* SESSLIM CHECKING **********                                          01406000
.*                                                                      01407000
&SL      SETA  1                        DEFAULT SESSION LIMIT  @D34BDSN 01408000
         AIF   (T'&SESSLIM EQ 'O').P29C TAKE DEFAULT           @D34BDSN 01409000
         AIF   (T'&REF EQ 'O').P29A1    NO REF                 @DM11373 01410000
         MNOTE 3,' SESSLIM IGNORED WHEN SPECIFIED WITH REF'    @DM11373 01411000
         AGO   .P29C                    IGNORE SESSLIM         @DM11373 01412000
.P29A1   AIF   (T'&SESSLIM EQ 'N').P29B NUMERIC                @D34BDSN 01413000
.P29A    MNOTE 3,' INVALID SESSLIM - SPECIFICATION IGNORED'    @D34BDSN 01414000
         AGO   .P29C                    CONTINUE MAINLINE      @D34BDSN 01415000
.P29B    AIF   (&SESSLIM LT 1 OR &SESSLIM GT 6).P29A           @D34BDSN 01416000
&SL      SETA  &SESSLIM                 GET USER VALUE         @D34BDSN 01417000
.P29C    ANOP                           CONTINUE MAINLINE      @D34BDSN 01418000
.*                                                                      01419000
.* CMPACT CHECKING **********                                           01420000
.*                                                                      01421000
&CN      SETC  '    '                   GET DEFAULT NAME       @D34BDSN 01422000
         AIF   (T'&CMPACT EQ 'O').P29H OMITTED                 @D34BDSN 01423000
         AIF   (T'&REF EQ 'O').P29C1    NO REF                 @DM11373 01424000
         MNOTE 3,' CMPACT IGNORED WHEN SPECIFIED WITH REF'     @DM11373 01425000
         AGO   .P29H                    IGNORE CMPACT          @DM11373 01426000
.P29C1   ANOP                                                  @DM11373 01427000
&CN      SETC  '&CMPACT'                GET NAME               @D34BDSN 01428000
         AIF   (K'&CMPACT LE 4).P29D    LENGTH OK              @D34BDSN 01429000
         MNOTE 3,' CMPACT NAME TRUNCATED TO 4 CHARACTERS'      @D34BDSN 01430000
&CN      SETC  '&CMPACT'(1,4)           GET NAME               @D34BDSN 01431000
.P29D    ANOP                           CONTINUE MAINLINE      @D34BDSN 01432000
&A       SETA  1                        GET INITIAL VALUE      @D34BDSN 01433000
&B       SETA  1                        GET INITIAL VALUE      @D34BDSN 01434000
.P29E    AIF   ('&CMPACT'(&A,1) EQ  'ABCDEFGHIJKLMNOPQRSTUVWXYZ$@#01234X01435000
               56789'(&B,1)).P29G       IS VALID CHAR          @D34BDSN 01436000
&B       SETA  &B+1                     BUMP POINTER           @D34BDSN 01437000
         AIF   (&B LE 39).P29E          CONTINUE LOOP          @D34BDSN 01438000
.P29F    MNOTE 3,' INVALID CMPACT - SPECIFICATION IGNORED'     @D34BDSN 01439000
&CN      SETC  '    '                   GET DEFAULT NAME       @D34BDSN 01440000
         AGO   .P29H                    CONTINUE MAINLINE      @D34BDSN 01441000
.P29G    ANOP                           CONTINUE MAINLINE      @D34BDSN 01442000
         AIF   (&A EQ 1 AND &B GT 29).P29F NUMERIC FIRST CHAR  @D34BDSN 01443000
&A       SETA  &A+1                     BUMP POINTER           @D34BDSN 01444000
&B       SETA  1                        SET INITIAL VALUE      @D34BDSN 01445000
         AIF   (&A LE K'&CMPACT AND &A LE 4).P29E              @D34BDSN 01446000
.P29H    ANOP                           CONTINUE MAINLINE      @D34BDSN 01447000
.*                                                                      01448000
.* RUSIZE CHECKING **********                                           01449000
.*                                                                      01450000
         AIF   (T'&RUSIZE EQ 'O').P29L  OMITTED                @D34BDSN 01451000
         AIF   (T'&REF EQ 'O').P29I     NO REF                 @D34BDSN 01452000
         MNOTE 3,' RUSIZE IGNORED WHEN SPECIFIED WITH REF'     @D34BDSN 01453000
         AGO   .P29L                    IGNORE RUSIZE          @D34BDSN 01454000
.P29I    AIF   (T'&RUSIZE EQ 'N').P29K  NUMERIC                @D34BDSN 01455000
.P29J    MNOTE 3,' INVALID RUSIZE - SPECIFICATION IGNORED'     @D34BDSN 01456000
         AGO   .P29L                    CONTINUE MAINLINE      @D34BDSN 01457000
.P29K    AIF   (&RUSIZE EQ  256).P29KRU  RUSIZE 256?           @DY45464 01458000
         AIF   (&RUSIZE EQ  512).P29KRU  RUSIZE 512?           @DY45464 01458100
         AIF   (&RUSIZE EQ 1024).P29KRU  RUSIZE 1024?          @DY45464 01458200
         AIF   (&RUSIZE EQ 2048).P29KRU  RUSIZE 2048?          @DY45464 01458300
         AIF   (&RUSIZE EQ 4096).P29KRU  RUSIZE 4096?          @DY45464 01458400
         AGO   .P29J                    WRONG RUSIZE           @DY45464 01458500
.P29KRU  ANOP                           CONTINUE               @DY45464 01458600
&BL7     SETA  &RUSIZE                  ACCEPT USER SPECIFIC   @D34BDSN 01459000
.P29L    ANOP                           CONTINUE MAINLINE      @D34BDSN 01460000
.*                                                                      01461000
.* LU CHECKING **********                                               01462000
.*                                                                      01463000
&C       SETA  1                        SET INITIAL VALUE      @D34BDSN 01464000
         AIF   (T'&LU EQ 'O').P29P      NO LU SPECIFIED        @D34BDSN 01465000
         AIF   (T'&REF EQ 'O').P29P1    NO REF                 @DM11373 01466000
         MNOTE 3,' LU IGNORED WHEN SPECIFIED WITH REF'         @DM11373 01467000
         AGO   .P29P                    IGNORE LU              @DM11373 01468000
.P29P1   ANOP                                                  @DM11373 01469000
IPW$POW$ CSECT                          GET LU CSECT           @D34BDSN 01470000
&K       SETA  N'&LU                    GET NUMBER OF NAMES    @D34BDSN 01471000
.P29M    ANOP                           CONTINUE MAINLINE      @D34BDSN 01472000
&LUNM    SETC  '&LU(&C)'                GET NAME               @D34BDSN 01473000
         AIF   (K'&LU(&C) GT 8).MNOTE17 ERROR IN NAME          @D33BDTP 01474000
&B       SETA  1                        SET INITIAL VALUE      @D34BDSN 01475000
&A       SETA  1                        SET INITIAL VALUE      @D34BDSN 01476000
.P29N    AIF   ('&LUNM'(&A,1) EQ 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$X01477000
               @#'(&B,1)).P29O          IS VALID CHARACTER     @D34BDSN 01478000
&B       SETA  &B+1                     BUMP POINTER           @D34BDSN 01479000
         AIF   (&B LE 39).P29N          CONTINUE LOOP          @D34BDSN 01480000
         AGO   .MNOTE17                 INVALID NAME           @D34BDSN 01481000
.P29O    ANOP                           CONTINUE MAINLINE      @D34BDSN 01482000
&A       SETA  &A+1                     BUMP POINTER           @D34BDSN 01483000
&B       SETA  1                        SET INITIAL VALUE      @D34BDSN 01484000
         AIF   (&A LE K'&LU(&C)).P29N   LOOP THRU NAME         @D34BDSN 01485000
         DC    CL8'&LUNM'               LU NAME                @D34BDSN 01486000
&C       SETA  &C+1                     BUMP POINTER           @D34BDSN 01487000
         AIF   (&C LE N'&LU).P29M       LOOP THRU NAMES        @D34BDSN 01488000
         ORG   IPW$POWA                 GET TO TABLE LENGTH    @D34BDSN 01489000
&A       SETA  &LULOC+(&K*8)            LENGTH OF LU TABLE     @D34BDSN 01490000
         DC    A(&A)                    LENGTH OF TABLE        @D34BDSN 01491000
         ORG   ,                        RESET LOCATION COUNTER @D34BDSN 01492000
IPW$POW  CSECT                          RESTORE CSECT          @D34BDSN 01493000
.P29P    ANOP                           CONTINUE MAINLINE      @D34BDSN 01494000
&BL5     SETA  X'04'                    SNA WORKSTATION        @DA27454 01495000
         AIF   (&GAP EQ 0).P29PP        IS THIS A DUMMY        @DA23371 01496000
.* CREATE COMMENT IN LISTING FOR DUMMY SNA ENTRY                        01497000
         SPACE                                                          01498000
***** DUMMY ENTRY BEGIN, TYPE=LUT1                             @DA23371 01499000
.P29PP   ANOP                                                  @DA23371 01500000
         DC    AL1(&BL2)                PUNCH ROUTING          @D32DUSN 01501000
         DC    AL1(&BL3)                LIST  ROUTING          @D32DUSN 01502000
         DC    AL2(&BL7)                BUFFER SIZE OR REF     @D32DUSN 01503000
         DC    AL1(&BL5)                TERMINAL TYPE          @D32DUSN 01504000
         DC    AL1(&BL6)                TERMINAL FEATURES      @D32DUSN 01505000
         DC    AL1(0)                   RESERVED               @D32DUSN 01506000
         DC    AL1(&LPW)                LENGTH PASSWORD OR FF  @D32DUSN 01507000
         DC    CL8'&PWD'                PASSWORD               @D32DUSN 01508000
         DC    CL4'&CN'                 CMPACT NAME            @D34BDSN 01509000
         DC    AL1(&K)                  NUMBER OF LU NAMES     @D34BDSN 01510000
         AIF   (&K NE 0).P29Q           GENERATE ADDRESS       @D34BDSN 01511000
         DC    AL3(0)                   NO LU NAMES            @D34BDSN 01512000
         AGO   .P29R                    CONTINUE MAINLINE      @D34BDSN 01513000
.P29Q    DC    AL3(&LULOC)              DISP OF FIRST LU NAME  @D34BDSN 01514000
.P29R    DC    AL2(&SL)                 SESSION LIMIT          @D34BDSN 01515000
         DC    AL2(&MAXPRT)             MAX SNA PRINT DATA     @DY44115 01516000
         DC    4X'00'                   RESERVED               @DY44115 01517000
&LULOC   SETA  &LULOC+(8*&K)            UPDATE PTR FOR NEXT NM @D34BDSN 01518000
         AIF   (&K EQ 0).P300           SKIP ORG IF ZERO       @D34BDSN 01519000
         SPACE                                                          01520000
         ORG   IPW$POW6                 OVERLAY LENGTH LU TAB  @D34BDSN 01521000
         DC    AL3(&LULOC)              LENGTH OF LU TABLE     @D34BDSN 01522000
.*                                                             @D32DUSN 01523000
.P300    ANOP                                                  @D32DUSN 01524000
         SPACE                                                          01525000
&GBL5    SETA  &GBL5+32                 UPDATE TABLE LENGTH    @D34BDSN 01526000
.P310    ANOP                                                  @D32DUSN 01527000
         ORG   IPW$POW8                                        @D32DUSN 01528000
         DC    AL2(&GBL5)               UPDATE TOTAL LENGTH    @D32DUSN 01529000
         ORG   IPW$POW5                                        @D32DUSN 01530000
* SOME OF THE NEXT FIELDS CAN BE OVERLAID BY ORG INSTRUCTIONS  @D33DUSN 01531000
         DC    AL1(&NLUS)               NR OF SNA LOG UNITS    @D32DUSN 01532000
         DC    AL1(&GBL6)               NUMBER OF SNA REMOTES  @D32DUSN 01533000
         DC    AL1(&GBL8)               FIRST SNA REMOTE ID    @D32DUSN 01534000
         DC    AL1(&REMOTE)             LAST  SNA REMOTE ID    @D32DUSN 01535000
         AIF   (&GAP EQ 0).SNAEX1       LAST DUMMY ?           @DA23371 01536000
.* CREATE COMMENT IN LISTING FOR DUMMY SNA ENTRY                        01537000
***** DUMMY ENTRY END, TYPE=LU1                                @DA23371 01538000
         EJECT                                                          01539000
&GAP     SETA  &GAP-1                   DECREASE NUMB IN GAP   @DA23371 01540000
&GBL6    SETA  &GBL6+1                  UPDATE NBR OF ENTRIES  @DA27454 01541000
&GBL7    SETA  &GBL7+1                  UPDATE REMID NUMBER    @DA23371 01542000
         ORG   ,                                               @DA23371 01543000
         AIF   (&GAP NE 0).P176         BUILD ANOTHER DUMMY    @DA23371 01544000
         AGO   .P175                    THIS IS NOT A DUMMY    @DA23371 01545000
.SNAEX1  ANOP                           CONTINUE               @DA23371 01546000
         ORG   ,                                               @DA23371 01547000
.SNAEX   ANOP                                                  @D35BIQI 01548000
         SPACE 5                                                        01549000
*********************************************************************** 01550000
         SPACE 3                                                        01551000
         MEXIT                     EXIT FOR LUT1 EXPANSION     @D32DUSN 01552000
.MNOTE11 ANOP                                                  @D32DUSN 01553000
         MNOTE 8,'MACRO NOT GENERATED , ERROR IN A PREVIOUS MACRO'      01554000
         AGO   .SNAEX                                          @D35BIQI 01555000
.MNOTE12 ANOP                                                  @D32DUSN 01556000
&ERR     SETB  1                        PREVENT FOLLOWING MACS @D32DUSN 01557000
         MNOTE 8,'REF AND TYPE BOTH MISSING, MACRO GENERATION STOPPED'  01558000
         AGO   .SNAEX                                          @D35BIQI 01559000
.MNOTE13 ANOP                                                  @D32DUSN 01560000
&ERR     SETB  1                                               @D32DUSN 01561000
         MNOTE 8,'INVALID TYPE - MACRO GENERATION STOPPED'     @D32DUSN 01562000
         AGO   .SNAEX                                          @D35BIQI 01563000
.MNOTE14  ANOP                                                 @D32DUSN 01564000
&ERR     SETB  1                                               @D32DUSN 01565000
         MNOTE 8,'INVALID REMOTE - MACRO GENERATION STOPPED'   @D32DUSN 01566000
         AGO   .SNAEX                                          @D35BIQI 01567000
.MNOTE15  ANOP                                                 @D32DUSN 01568000
&ERR     SETB  1                                               @D32DUSN 01569000
         MNOTE 8,'INVALID REF - MACRO GENERATION STOPPED'      @D32DUSN 01570000
         AGO   .SNAEX                                          @D35BIQI 01571000
.MNOTE16  ANOP                                                 @D32DUSN 01572000
&ERR     SETB  1                                               @D32DUSN 01573000
         MNOTE 8,'INVALID TYPE OR MACRO OUT OF SEQUENCE'       @D32DUSN 01574000
         MNOTE 8,'MACRO GENERATION STOPPED'                    @D32DUSN 01575000
         AGO   .SNAEX                                          @D35BIQI 01576000
.MNOTE17 ANOP                                                  @D34BDSN 01577000
&ERR     SETB  1                        ERRORS DETECTED        @D34BDSN 01578000
         MNOTE 8,'INVALID LU NAME - MACRO GENERATION STOPPED'  @D34BDSN 01579000
         AGO   .SNAEX                                          @D35BIQI 01580000
         MEND                                                  @D32DUSN 01581000
