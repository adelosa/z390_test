         MACRO                                                          00050000
&NAME    STXIT &TY,                                            @D14CDWKX00094401
               &EN,                                            @D14CDWKX00138801
               &SV,                                            @D14CDWKX00183201
               &OPTION=,                                       @D14CDWKX00227601
               &MFG=,                                          @D14CDWKX00272001
               &AMODE=,                                        @D51HDOWX00316401
               &TOKEN=,                                        @D67QDOWX00316508
               &MSGDATA=,                                      @D51HDOWX00360801
               &MSGPARM=                                       @D61CDOW 00405401
.*                                                             @D149DWK 00450000
         LCLA  &SVCN                                           @D14CDWK 00500000
         LCLA  &FLAG                                           @D14CDWK 00550000
         LCLB  &B(8)                                           @D51HDOW 00600000
         LCLB  &C(8)                                           @KD40113 00625001
         LCLC  &ENNAME                                         @D35EDFR 00650000
         LCLC  &SVNAME                                         @D35EDFR 00700000
         LCLC  &TMFG                                           @D14CDWK 00750000
         LCLC  &IMFG                                           @D14CDWK 00800000
.*                                                             @D149DWK 00850000
         AGO .ZZZ                                                       00900000
*                                                                       00950000
*        LICENSED MATERIALS - PROPERTY OF IBM                           01000000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                    01050000
*        5686-066 (C) COPYRIGHT IBM CORP. 1980,1996                     01100002
*        SEE COPYRIGHT INSTRUCTIONS                                     01150000
*                                                                       01200000
.ZZZ     ANOP                                                           01250000
.*                                                             @D149DWK 01300000
.**** START OF SPECIFICATIONS *********************************@D149DWK 01350000
.*                                                             @D149DWK 01400000
.*  MODULE-TYPE      =  MACRO                                  @D149DWK 01450000
.*                                                             @D149DWK 01500000
.*  DESCRIPTIVE NAME =  SET USER EXITS                         @D149DWK 01550000
.*  STATUS           =  EXTENDED MACRO                         @D149DWK 01600000
.*  FUNCTION         =  MACRO CHECKS USER GIVEN PARAMETERS FOR @D149DWK 01650000
.*                      VALIDITY AND GENERATES THE CORRES-     @D149DWK 01700000
.*                      PONDING CALLING SEQUENCE TO INVOKE THE @D149DWK 01750000
.*                      REQUESTED SUPERVISOR SERVICE:          @D149DWK 01800000
.*                      STXIT PC ---> SVC 16                   @D149DWK 01850000
.*                               STORE USERS PROGRAM-CHECK EXIT@D149DWK 01900000
.*                               ROUTINE AND SAVEAREA ADDRESS  @D149DWK 01950000
.*                               IN TCB.                       @D149DWK 02000000
.*                      STXIT IT ---> SVC 18                   @D149DWK 02050000
.*                               STORE USERS INTERVAL TIMER    @D149DWK 02100000
.*                               ROUTINE AND SAVEAREA ADDRESS  @D149DWK 02150000
.*                               IN TCB.                       @D149DWK 02200000
.*                      STXIT OC ---> SVC 20                   @D149DWK 02250000
.*                               STORE USERS OPERATOR COMMUNI- @D149DWK 02300000
.*                               CATION ROUTINE AND SAVEAREA   @D149DWK 02350000
.*                               ADDRESS IN PCB.               @D149DWK 02400000
.*                               AN EXTENDED SAVEAREA IS REQ'D @D51HDOW 02450000
.*                               WHEN MSGDATA=YES IS SPECIFIED @D51HDOW 02500000
.*                      STXIT AB ---> SVC 37                   @D149DWK 02550000
.*                               STORE USERS TERMINATION       @D149DWK 02600000
.*                               ROUTINE AND SAVEAREA ADDRESS  @D149DWK 02650000
.*                               IN TCB.                       @D149DWK 02700000
.*                      STXIT TT ---> NOT SUPPORTED ANYMORE    @D64ADOW 02750001
.*                      STXIT DIE---> SVC 79                   @D67QDOW 02760008
.*                               DEFINES AN APPENDAGE TO THE   @D67QDOW 02770008
.*                               CLOCK COMPARATOR FLIH         @D67QDOW 02780008
.*  NOTES            =  NONE                                   @D149DWK 02950000
.*  DEPENDENCIES     =  NONE                                   @D149DWK 03000000
.*  RESTRICTIONS     =  NONE                                   @D149DWK 03050000
.*  REGISTER CONVENT.=                                         @D149DWK 03100000
.*                      REGISTER 0 USED FOR PARAMETERS         @D149DWK 03150000
.*                      REGISTER 1 USED FOR PARAMETERS         @D149DWK 03200000
.*  PATCH LABEL      =  NONE                                   @D149DWK 03250000
.*  MACRO TYPE       =  ASSEMBLER                              @D149DWK 03300000
.*  PROCESSOR        =  HASM                                   @D149DWK 03350000
.*  MACRO SIZE       =                                         @D149DWK 03400000
.*  ATTRIBUTES       =                                         @D149DWK 03450000
.*  ENTRY POINT      =  STXIT                                  @D149DWK 03500000
.*  PURPOSE          =  SEE FUNCTION                           @D149DWK 03550000
.*  LINKAGE          =                                         @D149DWK 03600000
.*  CALLER           =                                         @D149DWK 03650000
.*  INPUT            =   (CALLING SEQUENCE)                    @D149DWK 03700000
.*                                                             @D149DWK 03750000
.*        &NAME   STXIT (PC | IT | OC | AB | DIE),             @D149DWK 03800003
.*                      (RTNADDR | (R0)),                      @D149DWK 03850000
.*                      (SAVEAREA | (R1)),                     @D149DWK 03900000
.*                       OPTION=(NODUMP|DUMP|EARLY),           @D149DWK 03950000
.*                       MFG=(NAME1 |(S,NAME1)| (R2)),         @D149DWK 04000000
.*                       AMODE=24|ANY,                         @D51HDOW 04050000
.*                       MSGDATA=YES                           @D51HDOW 04100000
.*                                                             @D149DWK 04150000
.*                      OPERANDS :                             @D149DWK 04200000
.*                      PC|IT|OC|AB    : INDICATING TYPE OF    @D149DWK 04250001
.*                                       EXIT ROUTINE SPECIFIED@D149DWK 04300000
.*                      RTNADDR        : USER ROUTINE ADDRESS  @D149DWK 04350000
.*                      SAVEAREA       : SAVEAREA ADDRESS      @D149DWK 04400000
.*                      OPTION  DUMP   : ISSUE TERMINATION     @D149DWK 04450000
.*                                       MESSAGES AND PARTITION@D149DWK 04500000
.*                                       DUMP. DEFAULT         @D149DWK 04550000
.*                              MSGONLY: ISSUE TERMINATION MESSAGES     04600000
.*                              NODUMP : NO ACTION TAKEN       @D149DWK 04650000
.*                              EARLY  : THE AB EXIT ROUTINE   @D149DWK 04700000
.*                                       HAS TO BE INVOKED FOR @D149DWK 04750000
.*                                       ANY TERMINATION TYPE  @D149DWK 04800000
.*                      MFG            : ADDR OF 16 BYTE WORK- @D149DWK 04850000
.*                                       AREA WHERE THE PARM-  @D149DWK 04900000
.*                                       LIST FOR SVC IS TO BE @D149DWK 04950000
.*                                       STORED.               @D149DWK 05000000
.*                      AMODE   ANY    : EXTENDED SAVE AREA    @D51HDOW 05050000
.*                                       DEFINED               @D51HDOW 05100000
.*                              24     : DEFAULT, OLD SAVE AREA@D51HDOW 05150000
.*                                       LAYOUT ASSUMED        @D51HDOW 05200000
.*                      MSGDATA YES    : VALID FOR OC-EXIT     @D51HDOW 05250000
.*                                       EXTENDED SAVE AREA    @D51HDOW 05300000
.*                                       DEFINED               @D51HDOW 05350000
.*                      MSGPARM        : VALID FOR OC-EXIT     @D51HDOW 05360005
.*                                       EXTENDED SAVE AREA    @D51HDOW 05370005
.*                                       DEFINED               @D51HDOW 05380005
.*                      TOKEN          : VALID FOR RESET OF    @D51HDOW 05390005
.*                                       DIE APPENDAGE         @D149DWK 05400005
.*                                                             @D149DWK 05410005
.*         -------------------------------------------------   @D149DWK 05450005
.*         | TY   | RTN | SAV | OPTION | MFG |MSGXXXX|TOKEN|   @D149DWK 05500005
.*         -------|-----------------------------------------   @D149DWK 05550005
.*         | AB   |  R  |  R  |    O   |  O  |  N/A  | N/A |   @D149DWK 05600005
.*         | PC   |  R  |  R  |   N/A  | N/A |  N/A  | N/A |   @D149DWK 05650005
.*         | IT   |  R  |  R  |   N/A  | N/A |  N/A  | N/A |   @D149DWK 05700005
.*         | OC   |  R  |  R  |   N/A  | N/A |   O   | N/A |   @D149DWK 05750005
.*         | DIE  |  R  | N/A |   N/A  | N/A |  N/A  |  O  |   @D67QDOW 05760008
.*         -------------------------------------------------   @D149DWK 05850005
.*                                                             @D149DWK 05900000
.*        R = REQUIRED                                         @D149DWK 05950000
.*        O = OPTIONAL                                         @D149DWK 06000000
.*        N/A = NOT APPLICABLE                                 @D149DWK 06050000
.*        IF RTN AND SAV OMITTED, OPTION AND MFG               @D149DWK 06100000
.*        ARE N/A (TO RESET ESTABLISHED EXIT ROUTINE)          @D149DWK 06150000
.*                                                             @D149DWK 06200000
.*  OUTPUT           =  SEE GENERATED CODE                     @D149DWK 06250000
.*                                                             @D149DWK 06300000
.*                                                             @D149DWK 06350000
.*    OLD FORMAT OF PARMLIST, NOT GENERATED ANYMORE :                   06400000
.*                                                             @D149DWK 06450000
.*           REG1 --> 0 -------------------------------------  @D149DWK 06500000
.*                      |  FLAG  |    RTNADDRESS            |  @D149DWK 06550000
.*                    4 -------------------------------------  @D149DWK 06600000
.*                      |        SAVEAREA ADDRESS           |  @D149DWK 06650000
.*                      -------------------------------------  @D149DWK 06700000
.*                                                             @D149DWK 06750000
.*                    FLAG = B'010XXXXX'  OPTION = NODUMP               06800000
.*                           B'001XXXXX'  OPTION = EARLY                06850000
.*   NEW FORMAT OF PARMLIST IN RELEASE 5                                06900000
.*                                                                      06950000
.*           REG1 --> 0 -------------------------------------           07000000
.*                      |  FLAG  |    RESERVED              |           07050000
.*                    4 -------------------------------------           07100000
.*                      |        ROUTINE ADDRESS            |           07150000
.*                    8 -------------------------------------           07200000
.*                      |        SAVEAREA ADDRESS           |           07250000
.*                   12 -------------------------------------           07300000
.*                      |        RESERVED                   |           07350000
.*                      -------------------------------------           07400000
.*                                                                      07450000
.*                   FLAG = B'11000XXX'  OPTION = NODUMP                07480001
.*                          B'10100XXX'  OPTION = EARLY                 07510001
.*                          B'10010XXX'  OPTION = MSGONLY               07540001
.*                          B'1XXX01X1'  MSGPARM=YES,MSGDATA=NO         07570001
.*                          B'1XXX00X1'  MSGPARM=NO,MSGDATA=YES         07600001
.*                          B'1XXX0X00'  AMODE=24,MSGDATA|MSGPARM=NO    07630001
.*                          B'1XXX0X01'  AMODE=ANY,MSGDATA|MSGPARM=YES  07660001
.*                          B'1XXX0X10'  AMODE=ANY,MSGDATA|MSGPARM=NO   07690001
.*                          B'1XXX0X11'  AMODE=24,MSGDATA|MSGPARM=YES   07720001
.*                                                                      07750000
.*  EXIT NORMAL      =  PARMLIST GENERATED                     @D149DWK 07800000
.*  EXIT ERROR       =  MNOTES INDICATING THE ERROR            @D149DWK 07850000
.*  EXTERNAL REFEREN.=  NONE                                   @D149DWK 07900000
.*  ROUTINES         =  NONE                                   @D149DWK 07950000
.*  DATA AREAS       =  NONE                                   @D149DWK 08000000
.*  CONTROL BLOCKS   =  NONE                                   @D149DWK 08050000
.*  TABLES           =  NONE                                   @D149DWK 08100000
.*  MACROS USED      =  NONE                                   @D149DWK 08150000
.*  CHANGE ACTIVITY  =  AS FOLLOWS                             @D149DWK 08200000
.*  RELEASE AF 2.1 ADAPTION                                    @D149DWK 08250000
.*  5.1 EXTENSION FOR CICS                                     @D51HDOW 08300000
.*  MSGDATA OPERAND CHECKING INVALID                           @KX40389 08325001
.*  OC EXTENSION FOR NEW CONSOLE SUPPORT                       @D61CDOW 08337501
.*                                                             @D149DWK 08350000
.** END OF SPECICATIONS ***************************************@D149DWK 08400000
.*-------------------------------------------------------------@D149DWK 08450000
.*       CHECK VALIDITY OF TYPE OPERAND                        @D149DWK 08500000
.*-------------------------------------------------------------@D149DWK 08550000
         AIF   ('&TY' NE 'DIE').CHKPC                          @D67QDOW 08600008
&SVCN    SETA  79                                              @D67QDOW 08650008
         AGO   .PROCDIE                                        @D67QDOW 08700008
.CHKPC   ANOP                                                  @D67QDOW 08750008
         AIF   (T'&TOKEN NE 'O').MACER97                       @D67QDOW 08751008
         AIF   ('&TY' NE 'PC').CHKIT                           @D14CDWK 08760003
&SVCN    SETA  16                                              @D14CDWK 08770003
         AGO   .CHKSVEN                                        @D14CDWK 08780003
.CHKIT   AIF   ('&TY' NE 'IT').CHKOC                           @D14CDWK 08790003
&SVCN    SETA  18                                              @D14CDWK 08800000
         AGO   .CHKSVEN                                        @D14CDWK 08850000
.CHKOC   AIF   ('&TY' NE 'OC').CHKAB                           @D14CDWK 08900000
&SVCN    SETA  20                                              @D14CDWK 08950000
         AGO   .CHKSVEN                                        @D14CDWK 09000000
.CHKAB   AIF   ('&TY' NE 'AB').CHKTT                           @D14CDWK 09050000
&SVCN    SETA  37                                              @D14CDWK 09100000
         AGO   .CHKSVEN                                        @D14CDWK 09150000
.CHKTT   AIF   ('&TY' NE 'TT').MACER11                         @D14CDWK 09200000
         AGO   .MACER88                                        @D64ADOW 09250001
.CHKSVEN ANOP                                                  @D14CDWK 09300000
&B(8)    SETB  1           INDICATE NEW PARAMETER LIST FORMAT  @D51HDOW 09350000
&ENNAME  SETC  '0'         INITIALIZE RTN ADDR                 @D51HDOW 09400000
&SVNAME  SETC  '0'         INITIALIZE SAVEAREA ADDR            @D51HDOW 09450000
.*-------------------------------------------------------------@D149DWK 09500000
.*       CHECK VALIDITY OF SV AND EN OPERAND                   @D149DWK 09550000
.*-------------------------------------------------------------@D149DWK 09600000
         AIF   (T'&EN NE 'O' OR T'&SV NE 'O').CKR100           @D51HDOW 09650000
.*                                                                      09700000
.*       BOTH OF SV AND EN OPERANDS ARE OMMITTED               @D51HDOW 09750000
.*                                                                      09800000
         AIF   (T'&MSGPARM NE 'O').MACER66                     @D61CDOW 09825001
         AIF   (T'&MSGDATA NE 'O').MACER66                     @D51HDOW 09850000
         AIF   (T'&OPTION NE 'O').MACER66                      @D51IDOW 09900000
         AIF   (T'&MFG NE 'O').MACER66                         @D51HDOW 09950000
         AIF   (T'&AMODE NE 'O').MACER66                       @D51HDOW 10000000
.*                                                                      10050000
.*       BUILD CODE IF SV AND EN OPERANDS ARE OMMITTED                  10100000
.*                                                                      10150000
&NAME    SLR   0,0                                             @D14CDWK 10200000
         LR    1,0                                             @D14CDWK 10250000
         SVC   &SVCN                                           @D14CDWK 10300000
         MEXIT                                                 @D51HDOW 10350000
.*                                                                      10400000
.CKR100  ANOP                                                  @D51HDOW 10450000
         AIF   (T'&EN EQ 'O' AND T'&SV NE 'O').MACER22         @D14CDWK 10500000
         AIF   (T'&EN NE 'O' AND T'&SV EQ 'O').MACER22         @D14CDWK 10550000
         AIF   ('&SV'(1,1) NE '(').CKR101                      @D51HDOW 10600000
         AIF   ('&SV(1)' EQ '0').MACER44                       @D51HDOW 10650000
.CKR101  ANOP                                                  @D51HDOW 10700000
         AIF   ('&EN'(1,1) NE '(').CKR102                      @D51HDOW 10750000
         AIF   ('&EN(1)' EQ '1').MACER55                       @D51HDOW 10800000
.CKR102  ANOP                                                  @D51HDOW 10850000
         AIF   ('&SV'(1,1) NE '(' OR '&EN'(1,1) NE '(').CKREND @D51HDOW 10900000
         AIF   (T'&OPTION NE 'O').CKREND                       @D51HDOW 10950000
         AIF   (T'&MFG NE 'O').CKREND                          @D51HDOW 11050000
         AIF   (T'&AMODE NE 'O').CKREND                        @D51HDOW 11100000
         AIF   ('&MSGDATA' EQ 'NO').CKR103                     @D61CDOW 11107101
         AIF   (T'&MSGDATA NE 'O').CKREND                      @D61CDOW 11114201
.CKR103  ANOP                                                  @D61CDOW 11121301
         AIF   ('&MSGPARM' EQ 'NO').CKR104                     @D61CDOW 11128401
         AIF   (T'&MSGPARM NE 'O').CKREND                      @D61CDOW 11135501
.CKR104  ANOP                                                  @D61CDOW 11142601
.*                                                                      11150000
.*       BUILD CODE IF SV AND EN ONLY AND REG NOTATION FOR BOTH         11200000
.*                                                                      11250000
         AIF   (T'&NAME EQ 'O').CKR110                         @D51HDOW 11300000
&NAME    DS    0H                                              @D51HDOW 11350000
.CKR110  ANOP                                                  @D51HDOW 11400000
         AIF   ('&EN(1)' EQ '0').CKR120                        @D51HDOW 11450000
         LR    0,&EN(1)                                        @D51HDOW 11500000
.CKR120  ANOP                                                  @D51HDOW 11550000
         AIF   ('&SV(1)' EQ '1').CKR130                        @D51HDOW 11600000
         LR    1,&SV(1)                                        @D51HDOW 11650000
.CKR130  ANOP                                                  @D51HDOW 11700000
         SVC   &SVCN                                           @D51HDOW 11750000
         MEXIT                                                 @D51HDOW 11800000
.CKREND  ANOP                                                  @D51HDOW 11850000
.*-------------------------------------------------------------@D149DWK 11900000
.*       CHECK OPTION OPERAND                                  @D149DWK 11950000
.*-------------------------------------------------------------@D149DWK 12000000
         AIF   (T'&OPTION EQ 'O').CHKOPE                       @D14CDWK 12050000
         AIF   ('&TY' NE 'AB').FEETN11                         @D14CDWK 12100000
         AIF   ('&OPTION' EQ 'DUMP').CHKOPE                    @D14CDWK 12150000
         AIF   ('&OPTION' NE 'NODUMP').CHKEARL                 @D14CDWK 12200000
&B(7)    SETB  1                                               @D51HDOW 12250000
         AGO   .CHKOPE                                         @D14CDWK 12300000
.CHKEARL AIF   ('&OPTION' NE 'EARLY').CHKMSG                   @D51HDOW 12350000
&B(6)    SETB  1                                               @D51HDOW 12400000
         AGO   .CHKOPE                                         @D14CDWK 12450000
.CHKMSG  AIF   ('&OPTION' NE 'MSGONLY').FEETN22                @D51HDOW 12500000
&B(5)    SETB  1                                               @D51HDOW 12550000
         AGO   .CHKOPE                                         @D51HDOW 12600000
.FEETN11 MNOTE 1,'SUPERFLUOUS OPTION SPECIFICATION. IT IS IGNORED'      12650001
         AGO   .CHKOPE                                         @D14CDWK 12700000
.FEETN22 MNOTE 3,'INVALID OPTION SPECIFICATION, OPTION=DUMP ASSUMED'    12750000
.CHKOPE  ANOP                                                  @D51HDOW 12800000
.*------------------------------------------------------------*         12850000
.*       CHECK AMODE OPERAND                                  *         12900000
.*------------------------------------------------------------*         12950000
         AIF   (T'&AMODE EQ 'O').MODEND                        @D51HDOW 13000000
         AIF   ('&AMODE' EQ '24').MODEND                       @D51HDOW 13050000
         AIF   ('&AMODE' EQ 'ANY').MOD010                      @D51HDOW 13100000
         MNOTE 3,'AMODE PARAMETER INCORRECT, 24 ASSUMED.'               13150000
         AGO   .MODEND                                         @D51HDOW 13200000
.MOD010  ANOP                                                  @D51HDOW 13250000
&C(2)    SETB  1           INDICATE AMODE=ANY                  @KD40113 13300001
.MODEND  ANOP                                                  @D51HDOW 13350000
.*------------------------------------------------------------*         13400000
.*       CHECK MSGDATA AND MSGPARM OPERANDS                   *         13450001
.*------------------------------------------------------------*         13500000
         AIF   ('&MSGDATA' EQ 'YES' AND '&MSGPARM' EQ 'YES').MACER77   X13520001
                                                               @D61CDOW 13540001
         AIF   (T'&MSGDATA EQ 'O' AND T'&MSGPARM EQ 'O').MSGEND        X13560001
                                                               @D61CDOW 13580001
         AIF   ('&TY' NE 'OC').MSGNOTE                         @D51HDOW 13600000
         AIF   (T'&MSGDATA EQ 'O' AND '&MSGPARM' EQ 'NO').MSGEND       X13602501
                                                               @D61CDOW 13605001
         AIF   ('&MSGDATA' EQ 'NO' AND T'&MSGPARM EQ 'O').MSGEND       X13607501
                                                               @D61CDOW 13610001
         AIF   ('&MSGDATA' EQ 'NO' AND '&MSGPARM' EQ 'NO').MSGEND      X13610801
                                                               @D61CDOW 13611601
         AIF   (T'&MSGDATA EQ 'O' AND '&MSGPARM' EQ 'YES').MSG010      X13612501
                                                               @D61CDOW 13615201
         AIF   ('&MSGDATA' EQ 'NO' AND '&MSGPARM' EQ 'YES').MSG010     X13617701
                                                               @D61CDOW 13620201
         AGO   .MSG020                                         @D61CDOW 13622801
.MSG010  ANOP                                                  @D61CDOW 13630401
&C(1)    SETB  1           INDICATE MSGPARM=YES                @D61CDOW 13638001
&B(3)    SETB  1           INDICATE MSGPARM SPECIFIED          @D61CDOW 13645601
         AGO   .MSGEND                                         @D61CDOW 13653201
.MSG020  ANOP                                                  @D61CDOW 13660801
         AIF   ('&MSGDATA' EQ 'YES' AND T'&MSGPARM EQ 'O').MSG030      X13668401
                                                               @D61CDOW 13676301
         AIF   ('&MSGDATA' EQ 'YES' AND '&MSGPARM' EQ 'NO').MSG030     X13678901
                                                               @D61CDOW 13681501
         AGO   .MSGNOTE                                        @D61CDOW 13684201
.MSG030  ANOP                                                  @D61CDOW 13692101
&C(1)    SETB  1           INDICATE MSGDATA=YES                @KD40113 13700001
&B(3)    SETB  0           INDICATE MSGDATA SPECIFIED          @D61CDOW 13750001
         AGO   .MSGEND                                         @D51HDOW 13950000
.MSGNOTE ANOP                                                  @KX40389 14000001
  MNOTE 3,'MSGDATA|MSGPARM NOT ALLOWED OR INCORRECT, PARAMETER IGNORED' 14050001
.MSGEND  ANOP                                                  @D51HDOW 14100000
.*------------------------------------------------------------*         14102501
.*       FINAL BIT SETTING FOR AMODE AND MSGDATA|MSGPARM      *         14105001
.*          00 - AMODE=24  MSGDATA|MSGPARM=NO  FROM 00        *         14107501
.*          01 - AMODE=ANY MSGDATA|MSGPARM=YES FROM 11        *         14110001
.*          10 - AMODE=ANY MSGDATA|MSGPARM=NO  FROM 10        *         14112501
.*          11 - AMODE=24  MSGDATA|MSGPARM=YES FROM 01        *         14115001
.*------------------------------------------------------------*         14117501
&B(2)    SETB  0                                               @KD40113 14120001
&B(1)    SETB  0                                               @KD40113 14122501
         AIF   (&C(2) EQ 0 AND &C(1) EQ 0).SETFLG              @KD40113 14125001
&B(2)    SETB  0                                               @KD40113 14127501
&B(1)    SETB  1                                               @KD40113 14130001
         AIF   (&C(2) EQ 1 AND &C(1) EQ 1).SETFLG              @KD40113 14132501
&B(2)    SETB  1                                               @KD40113 14135001
&B(1)    SETB  0                                               @KD40113 14137501
         AIF   (&C(2) EQ 1 AND &C(1) EQ 0).SETFLG              @KD40113 14140001
&B(2)    SETB  1                                               @KD40113 14142501
&B(1)    SETB  1                                               @KD40113 14145001
.SETFLG  ANOP                                                  @KD40113 14147501
.*                                                                      14150000
&FLAG    SETA  &B(8)*128+&B(7)*64+&B(6)*32+&B(5)*16+&B(4)*8+&B(3)*4+&B(X14200000
               2)*2+&B(1)*1                                    @D51HDOW 14250000
.*-------------------------------------------------------------@D149DWK 14300000
.*       CHECK AND SET MFG OPERAND                             @D149DWK 14350000
.*-------------------------------------------------------------@D149DWK 14400000
         AIF   (T'&MFG EQ 'O').MFGENDE                         @D14CDWK 14450000
         AIF   ('&MFG' EQ '(1)' OR '&MFG' EQ '(0)').MACER33    @D14CDWK 14500000
         AIF   ('&MFG'(1,3) EQ '(S,').SMFG                     @D14CDWK 14550000
         AIF   ('&MFG'(1,1) EQ '(').RMFG                       @D14CDWK 14600000
&TMFG    SETC  '+'.'&MFG'                                      @D14CDWK 14650000
&IMFG    SETC  '&MFG'                                          @D14CDWK 14700000
         AGO   .BLDMFG                                         @D14CDWK 14750000
.SMFG    ANOP                                                  @D14CDWK 14800000
&TMFG    SETC  '+'.'&MFG(2)'                                   @D14CDWK 14850000
&IMFG    SETC  '&MFG(2)'                                       @D14CDWK 14900000
         AGO   .BLDMFG                                         @D14CDWK 14950000
.RMFG    ANOP                                                  @D14CDWK 15000000
&TMFG    SETC  '&MFG'                                          @D14CDWK 15050000
&IMFG    SETC  '0'.'&MFG'                                      @D14CDWK 15100000
.BLDMFG  ANOP                                                  @D51HDOW 15150000
.*-------------------------------------------------------------@D149DWK 15200000
.*       BUILD PARAMETERLIST IN USERAREA (MFG)                 @D149DWK 15250000
.*-------------------------------------------------------------@D149DWK 15300000
         AIF   ('&SV'(1,1) EQ '(').BMFG000                     @D14CDWK 15350000
         MNOTE 3,'USE OF A STATIC SAVEAREA IS CONTRARY TO MFG OPERAND'  15400000
.BMFG000 ANOP                                                  @D14CDWK 15450000
         AIF   (T'&NAME EQ 'O').BMFG010                        @D51HDOW 15500000
&NAME    DS    0H                                              @D51HDOW 15550000
.BMFG010 ANOP                                                  @D51HDOW 15600000
         MVI   &IMFG,&FLAG                                     @D14CDWK 15650000
         AIF   (T'&SV NE 'O').BMFG020                          @D51HDOW 15700000
         SLR   0,0                                             @D51HDOW 15750000
         STCM  0,15,4&TMFG                                     @D51HDOW 15800000
         STCM  0,15,8&TMFG                                     @D51HDOW 15850000
         AGO   .BMFG060                                        @D14CDWK 15900000
.BMFG020 ANOP                                                  @D14CDWK 15950000
         AIF   ('&EN'(1,1) EQ '(').BMFG030                     @D14CDWK 16000000
         L     0,=A(&EN)                                       @D14CDWK 16050000
         STCM  0,15,4&TMFG                                     @D51HDOW 16100000
         AGO   .BMFG040                                        @D14CDWK 16150000
.BMFG030 ANOP                                                  @D14CDWK 16200000
         STCM  &EN(1),15,4&TMFG                                @D51HDOW 16250000
.BMFG040 ANOP                                                  @D14CDWK 16300000
         AIF   ('&SV'(1,1) EQ '(').BMFG050                     @D14CDWK 16350000
         L     1,=A(&SV)                                       @D14CDWK 16400000
         STCM  1,15,8&TMFG                                     @D51HDOW 16450000
         AGO   .BMFG060                                        @D14CDWK 16500000
.BMFG050 ANOP                                                  @D14CDWK 16550000
         STCM  &SV(1),15,8&TMFG                                @D51HDOW 16600000
.BMFG060 ANOP                                                  @D14CDWK 16650000
         AIF   ('&MFG'(1,3) EQ '(S,').BMFG070                  @D14CDWK 16700000
         AIF   ('&MFG'(1,1) EQ '(').BMFG080                    @D14CDWK 16750000
.BMFG070 ANOP                                                  @D14CDWK 16800000
         LA    1,&IMFG                                         @D14CDWK 16850000
         AGO   .BMFG090                                        @D14CDWK 16900000
.BMFG080 ANOP                                                  @D14CDWK 16950000
         LR    1,&MFG(1)                                       @D14CDWK 17000000
.BMFG090 ANOP                                                  @D14CDWK 17050000
         LR    0,1                                             @D14CDWK 17100000
         SVC   &SVCN                                           @D14CDWK 17150000
         MEXIT                                                 @D14CDWK 17200000
.MFGENDE ANOP                                                  @D14CDWK 17250000
.*-------------------------------------------------------------@D149DWK 17300000
.*       BUILD INLINE PARAMETER LIST                           @D149DWK 17350000
.*-------------------------------------------------------------@D149DWK 17400000
         CNOP  0,4                                             @D35EDFR 17450000
         AIF   (T'&NAME EQ 'O').BLST010                        @D51HDOW 17500000
&NAME    DS    0H                                              @D35EDFR 17550000
.BLST010 ANOP                                                  @D51HDOW 17600000
&ENNAME  SETC  '&EN'                                           @D35EDFR 17650000
&SVNAME  SETC  '&SV'                                           @D35EDFR 17700000
         AIF   ('&EN'(1,1) NE '(').BLST070                     @D35EDFR 17750000
&ENNAME  SETC  '0'                                             @D35EDFR 17800000
         AIF   ('&SV'(1,1) NE '(').BLST040                     @D35EDFR 17850000
         ST    &EN(1),*+16                                     @D51HDOW 17900000
         AGO   .BLST080                                        @D51HDOW 17950000
.BLST040 ANOP                                                  @D35EDFR 18000000
         ST    &EN(1),*+12                                     @D51HDOW 18050000
         AGO   .BLST090                                        @D51HDOW 18100000
.BLST070 AIF   ('&SV'(1,1) NE '(').BLST090                     @D35EDFR 18150000
.BLST080 ANOP                                                  @D35EDFR 18200000
&SVNAME  SETC  '0'                                             @D35EDFR 18250000
         ST    &SV(1),*+16                                     @D51HDOW 18300000
.BLST090 BAL   1,*+20                                          @D51HDOW 18350000
         DC    AL1(&FLAG)                                      @D14CDWK 18400000
         DC    AL3(0)                                          @D51HDOW 18450000
         DC    AL4(&ENNAME)                                    @D51HDOW 18500000
         DC    AL4(&SVNAME)                                    @D35EDFR 18550000
         DC    AL4(0)                                          @D51HDOW 18600000
         LR    0,1                                             @D35EDFR 18650000
         SVC   &SVCN                                           @D14CDWK 18700000
         MEXIT                                                 @D35EDFR 18750000
.PROCDIE ANOP                                                  @D67QDOW 18760008
         AIF   (T'&EN EQ 'O').MACER98                          @D67QDOW 18760108
         AIF   (T'&SV NE 'O').MACER99                          @D67QDOW 18761008
         AIF   (T'&MSGPARM NE 'O').MACER99                     @D67QDOW 18761108
         AIF   (T'&MSGDATA NE 'O').MACER99                     @D67QDOW 18762008
         AIF   (T'&OPTION NE 'O').MACER99                      @D67QDOW 18763008
         AIF   (T'&MFG NE 'O').MACER99                         @D67QDOW 18764008
         AIF   (T'&AMODE NE 'O').MACER99                       @D67QDOW 18765008
         AIF   ('&EN'(1,1) EQ '(').PRD010                      @D67QDOW 18766008
         L     1,=A(&EN)                                       @D67QDOW 18767008
         AGO   .PRD020                                         @D67QDOW 18767108
.PRD010  ANOP                                                  @D67QDOW 18768008
         AIF   ('&EN(1)' EQ '1').PRD020                        @D67QDOW 18768108
         LR    1,&EN(1)                                        @D67QDOW 18768208
.PRD020  ANOP                                                  @D67QDOW 18769008
         AIF   (T'&TOKEN EQ 'O').PRD030                        @D67QDOW 18769108
         AIF   ('&TOKEN'(1,1) NE '(').MACER96                  @D67QDOW 18769208
         AIF   ('&TOKEN(1)' EQ '0').PRD040                     @D67QDOW 18769608
         LR    0,&TOKEN(1)                                     @D67QDOW 18769708
         AGO   .PRD040                                         @D67QDOW 18769808
.PRD030  ANOP                                                  @D67QDOW 18769908
         SLR   0,0               PASS INVALID TOKEN            @D67QDOW 18770008
.PRD040  ANOP                                                  @D67QDOW 18770108
         LA    15,3                                            @D67QDOW 18770208
         SVC   &SVCN                                           @D67QDOW 18771008
         MEXIT                                                 @D67QDOW 18780008
.*-------------------------------------------------------------@D149DWK 18800000
.*       MACRO ERROR NOTES                                     @D149DWK 18850000
.*-------------------------------------------------------------@D149DWK 18900000
.MACER11 MNOTE 8,'TYPE INVALID, MACRO IGNORED '                @D14CDWK 18950000
         MEXIT                                                 @D14CDWK 19000000
.MACER22 MNOTE 8,'SAVEAREA OR ENTRYPOINT ADDRESS NOT SPECIFIED, MACRO I*19050000
               GNORED '                                        @D14CDWK 19100000
         MEXIT                                                 @D14CDWK 19150000
.MACER33 MNOTE 8,'REGISTER 0 OR 1 MUST NOT BE USED FOR MFG-OPERAND. MAC*19200000
               RO IGNORED '                                    @D14CDWK 19250000
         MEXIT                                                 @D14CDWK 19300000
.MACER44 MNOTE 8,'REGISTER 0 MUST NOT BE USED FOR SAVEAREA OPERAND, MAC*19350000
               RO IGNORED '                                    @D14CDWK 19400000
         MEXIT                                                 @D14CDWK 19450000
.MACER55 MNOTE 8,'REGISTER 1 MUST NOT BE USED FOR ENTRY POINT OPERAND, *19500000
               MACRO IGNORED '                                 @D51HDOW 19550000
         MEXIT                                                 @D51HDOW 19600000
.MACER66 MNOTE 8,'SAVEAREA AND ENTRYPOINT MUST BE SPECIFIED IF ANY OTHE*19650000
               R OPERAND SPECIFIED'                            @D51HDOW 19700000
         MEXIT                                                 @D51HDOW 19750000
.MACER77 MNOTE 8,'MUTUALLY EXCLUSIVE PARAMETERS MSGDATA AND MSGPARM USE*19766601
               D, MACRO IGNORED'                               @D61CDOW 19783201
         MEXIT                                                 @D64ADOW 19783301
.MACER88 MNOTE 8,'TYPE TT IS NOT SUPORTED ANYMORE'             @D64ADOW 19783401
         MEXIT                                                 @D67QDOW 19783508
.MACER96 MNOTE 8,'TOKEN PARAMETER REQUIRES REGISTER NOTATION'  @D67QDOW 19783608
         MEXIT                                                 @D67QDOW 19783708
.MACER97 MNOTE 8,'TOKEN PARAMETER NOT SUPPORTED'               @D67QDOW 19783808
         MEXIT                                                 @D67QDOW 19783908
.MACER98 MNOTE 8,'ENTRYPOINT IS REQUIRED FOR TYPE = DIE'       @D67QDOW 19784008
         MEXIT                                                 @D67QDOW 19784108
.MACER99 MNOTE 8,'PARAMETER OTHER THAN ENTRY-POINT OR TOKEN SPECIFIED W,19784206
               WITH TYPE=DIE'                                  @D67QDOW 19785008
         MEND                                                  @D14CDWK 19800000
