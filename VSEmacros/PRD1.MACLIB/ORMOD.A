         MACRO                                                          00050000
&NAME     ORMOD                                                        000100000
               &RECFORM=FIXUNB,                                        B00150000
               &CONTROL=,                                              C00200000
               &IOAREA2=,                                              D00250000
               &WORKA=,                                                E00300000
               &DEVICE=,                                               F00350000
               &BLKFAC=,                                               G00400000
               &SEPASMB=                                                00450000
         LCLC  &UF,&ZC,&ZIWB,&ZR,&DT,&CL1,&LAB,&ENT                     00500000
         LCLC  &UB,&UF1,&RECFM                                          00550000
.* IBM DISK OPERATING SYSTEM                                        4-0 00600000
* 5745-SC-OCR  ORMOD    RELEASE 33                                      00650000
*                                                                       00700000
* COPYRIGHT = THIS MACRO IS "RESTRICTED MATERIALS OF IBM"     *@D41TDKY 00750000
*             5686-007 (C) COPYRIGHT IBM CORP. 1974, 1988     *@D41TDKY 00800000
*             ALL RIGHTS RESERVED                             *@D41TDKY 00850000
*             LICENSED MATERIALS-PROPERTY OF IBM              *@D41TDKY 00900000
.*            SEE COPYRIGHT INSTRUCTIONS, G120-2083           *@D41TDKY 00950000
*                                                                       01000000
&CL1     SETC  '&SYSNDX'(2,3)                                           01050000
&UF      SETC  'U'                                                      01100000
&UF1     SETC  'U'                                                      01150000
&ZC      SETC  'Z'                                                      01200000
&ZIWB    SETC  'Z'                                                      01250000
&ZR      SETC  'Z'                                                      01300000
&DT      SETC  'T'                                                      01350000
&UB      SETC  'U'                                                      01400000
&RECFM   SETC  'FIXUNB'                                                 01450000
         AIF   ('&RECFORM' NE 'UNDEF').F00B                             01500000
         AIF   (T'&BLKFAC EQ 'O').F00B                                  01550000
         AIF   ('&BLKFAC' EQ 'YES').F00A1                           3-4 01600000
         AIF   ('&DEVICE' NE '1287D').F00A3                         3-4 01650000
         MNOTE 0,'BLKFAC NOT ALLOWED.IGNORE'                        3-4 01700000
         AGO   .F00A2                                               3-4 01750000
.F00A1   AIF   ('&DEVICE' NE '1287D').F00A                          3-4 01800000
         MNOTE 0,'BLKFAC NOT ALLOWED.IGNORE'                        3-4 01850000
.F00A2   ANOP                                                       3-4 01900000
&RECFM   SETC  '&RECFORM'                                           3-4 01950000
         AGO   .F00C                                                3-4 02000000
.F00A3   MNOTE 0,'IMPROPER BLKFAC.ASSUME YES'                       3-4 02050000
.F00A    ANOP                                                           02100000
&RECFM   SETC  'UNDBLK'                                                 02150000
         AGO   .F00C                                                    02200000
.F00B    AIF   ('&RECFORM' NE 'UNDBLK').F00B1                       3-6 02250000
         MNOTE 0,'IMPROPER RECFORM. ASSUME FIXUNB'                      02300000
         AGO   .F00B2                                                   02350000
.F00B1   ANOP                                                           02400000
&RECFM   SETC  '&RECFORM'                                               02450000
.F00B2   AIF   (T'&BLKFAC EQ 'O').F00C                              3-6 02500000
         MNOTE 0,'IMPROPER BLKFAC. IGNORE'                              02550000
.F00C    AIF   ('&RECFM' EQ 'UNDEF').F1                             3-6 02600000
         AIF   ('&RECFM' EQ 'UNDBLK').F0A                               02650000
&UF      SETC  'F'                                                      02700000
&UF1     SETC  'F'                                                      02750000
         AIF   ('&RECFM' EQ 'FIXUNB').F1                                02800000
         AIF   ('&RECFM' EQ 'FIXBLK').F0                                02850000
         MNOTE 0,'IMPROPER RECFORM. ASSUME FIXUNB'                      02900000
         AGO   .F1                                                      02950000
.F0A     ANOP                                                           03000000
&UF1     SETC  'D'                                                      03050000
         AGO   .F0B                                                     03100000
.F0      ANOP                                                           03150000
&UF1     SETC  'X'                                                      03200000
         AIF   ('&DEVICE' NE '1287D').F0B                          3-8  03250000
         MNOTE 0,'INVALID RECFORM WITH 1287D. ERRORS MAY RESULT'   3-8  03300000
.F0B     ANOP                                                           03350000
&UB      SETC  'B'                                                      03400000
.F1      AIF   ('&CONTROL' EQ 'YES').F1A                                03450000
         AIF   (T'&CONTROL EQ 'O').F2                                   03500000
         MNOTE 0,'IMPROPER CONTROL. ASSUME YES'                         03550000
.F1A     ANOP                                                           03600000
&ZC      SETC  'C'                                                      03650000
.F2      AIF   (T'&IOAREA2 EQ 'O').F3                                   03700000
         AIF   ('&IOAREA2' EQ 'YES').F2A                                03750000
         MNOTE 0,'IMPROPER IOAREA2. ASSUME YES'                         03800000
.F2A     MNOTE 0,'IOAREA2 USED FOR TAPE JOURNAL ONLY'               3-8 03850000
         AIF   ('&WORKA' EQ 'YES').F2B                              3-8 03900000
         AIF   (T'&WORKA EQ 'O').F2C                                    03950000
         MNOTE 0,'IMPROPER WORKA. ASSUME YES'                           04000000
.F2B     MNOTE 0,'WORKA USED FOR TAPE JOURNAL ONLY'                 3-8 04050000
&ZIWB    SETC  'B'                                                      04100000
         AGO   .F3B                                                     04150000
.F2C     ANOP                                                           04200000
&ZIWB    SETC  'I'                                                      04250000
         AGO   .F3B                                                     04300000
.F3      AIF   ('&WORKA' EQ 'YES').F3A                                  04350000
         AIF   (T'&WORKA EQ 'O').F3B                                    04400000
         MNOTE 0,'IMPROPER WORKA. ASSUME YES'                           04450000
.F3A     MNOTE 0,'WORKA USED FOR TAPE JOURNAL ONLY'                 3-8 04500000
&ZIWB    SETC  'W'                                                      04550000
.F3B     AIF   ('&DEVICE' EQ '1285').F5                             3-6 04600000
         AIF   ('&DEVICE' EQ '1287T').F5                                04650000
         AIF   ('&DEVICE' NE '1287D').F4A                               04700000
&DT      SETC  'D'                                                      04750000
         AGO   .F5                                                      04800000
.F4A     AIF   (T'&DEVICE EQ 'O').F5                                3-6 04850000
         MNOTE 0,'IMPROPER DEVICE. ASSUME 1285'                         04900000
.F5      ANOP                                                           04950000
&LAB     SETC  'IJM&UF1&ZC&ZIWB&DT&ZR'                                  05000000
         AIF   (T'&NAME EQ 'O').F6                                      05050000
&LAB     SETC  '&NAME'                                                  05100000
.F6      AIF   (T'&SEPASMB EQ 'O').F8                                   05150000
         AIF   ('&SEPASMB' EQ 'YES').F7                                 05200000
         MNOTE 0,'IMPROPER SEPASMB. ASSUME YES'                         05250000
.F7      PUNCH '           CATALR  &LAB,4.0'                        4-0 05300000
.F8      ANOP                                                           05350000
*                                                                       05400000
* DSECT SECTION FOR 1285/1287                                       3-1 05450000
*                                                                       05500000
IJMT&CL1 DSECT                                                          05550000
         DS    CL2                                                      05600000
IJM5&CL1 DS    CL14          DUMMY CCB                                  05650000
IJM8&CL1 DS    CL1           NOT USED                                   05700000
IJM9&CL1 DS    CL3           ADDR OF LOGIC MODULE                       05750000
IJMA&CL1 DS    CL1           DTF TYPE                                   05800000
IJMB&CL1 DS    CL1           PIOCS SWITCHES                             05850000
         DS    CL1           DEVICE TYPE                            3-1 05900000
IJM20&CL1 DS   CL1           SWITCHES                               3-1 05950000
IJM0&CL1 DS    CL2           RESIDUAL COUNT                             06000000
IJM1&CL1 DS    CL2           TRANSMISSION INFO                          06050000
IJM2&CL1 DS    CL2           CSW STATUS BITS                            06100000
IJM3&CL1 DS    CL2           SYMBOLIC UNIT ADDRESS                      06150000
IJM4&CL1 DS    CL1           NOT USED                                   06200000
         DS    CL3           CCW ADDRESS                                06250000
IJM6&CL1 DS    CL1           NOT USED                                   06300000
IJM7&CL1 DS    CL3           CCW ADDR IN CSW                            06350000
         DS    CL8                     SENSE CCW                        06400000
IJMC&CL1 DS    CL4           EQUIP CHECKS                           3-1 06450000
IJMD&CL1 DS    CL4           AFTER TEN RETRIES                          06500000
IJME&CL1 DS    CL4           WRONG LENGTH RECORDS                       06550000
IJMF&CL1 DS    CL4           AFTER TEN RETRIES                          06600000
IJMG&CL1 DS    CL4           KEYBOARD CORRECTIONS                       06650000
IJMH&CL1 DS    CL4           DATA CHECKS                                06700000
IJMI&CL1 DS    CL4           LINES MARKED                               06750000
IJMJ&CL1 DS    CL4           TOTAL LINES READ                           06800000
IJMK&CL1 DS    CL1           ERROR INDICATORS                           06850000
IJML&CL1 DS    CL1           LIOCS SWITCHES                             06900000
IJMR&CL1 DS    CL1           NORMAL COMMAND CODE                        06950000
IJMS&CL1 DS    CL1           CNTRL COMMAND CODE                         07000000
IJMM&CL1 DS    CL4           IOAREA2 ADDRESS                            07050000
         AIF   ('&UB' NE 'B').F7A8                                      07100000
IJMO&CL1 DS    CL4           IOAREA1 CCW CHAIN                          07150000
         AIF   (T'&IOAREA2 NE 'O').F7A1                                 07200000
IJMP&CL1 DS    CL4           NOT USED                                   07250000
         AGO   .F7A2                                                    07300000
.F7A1    ANOP                                                           07350000
IJMP&CL1 DS    CL4           IOAREA2 CCW CHAIN                          07400000
.F7A2    ANOP                                                           07450000
IJMP1&CL1 DS    CL2          BLOCKING FACTOR                            07500000
IJMP2&CL1 DS    CL2          RECORD SIZE  OR                            07550000
          DS    CL4          NOT USED                                   07600000
IJMZ&CL1 DS    CL8           CNTRL CCW                                  07650000
         AGO   .F7A9                                                    07700000
.F7A8    ANOP                                                           07750000
IJMO&CL1 DS    CL8           READ CCW                                   07800000
IJMP&CL1 DS    CL8           GTNL CCW                                   07850000
IJMZ&CL1 DS    CL8           CNTRL CCW                                  07900000
.F7A9    ANOP                                                           07950000
IJMN&CL1 DS    CL4           EOF ADDR                                   08000000
IJMQ&CL1 DS    CL4           CORRECTION EXIT ADDRESS                    08050000
IJMY&CL1 DS    CL4           IOAREA1 ADDR                               08100000
IJMX&CL1 DS    CL4           DC A(&BLKS-1)                              08150000
IJMU&CL1 DS    CL2           SR 13,&RECS                                08200000
IJMV&CL1 DS    CL2           LR &RECS,13                                08250000
IJMW&CL1 DS    CL2           LR &IOR,13                                 08300000
IJM00&CL1 DS    2CL1              SENSE BYTES                  @DA06510 08350000
&LAB      CSECT                                                         08400000
          AIF   (T'&NAME NE 'O').F7A                                    08450000
          AIF   ('&ZC' NE 'C').F7A                                      08500000
&ENT      SETC  '&LAB'(1,4)'Z'.'&LAB'(6,3)                              08550000
          ENTRY &ENT                                                    08600000
&ENT      EQU   *                                                       08650000
.F7A      USING IJMT&CL1,1                                          3-6 08700000
          USING *,15                                                    08750000
*                                                                       08800000
* BRANCH TABLE FOR 1285/1287                                            08850000
*                                                                       08900000
          AIF   ('&ZC' NE 'C').F8A                                      08950000
          B     IJMCN&CL1              BRANCH TO CONTROL                09000000
          AGO   .F8B                                                    09050000
.F8A      SVC   IJML6&CL1              CONTROL ERROR                3-6 09100000
          DC    1H'0'                                                   09150000
.F8B      AIF   ('&DT' EQ 'D').F8B1                                     09200000
          B     IJMRD&CL1              BRANCH TO RDLINE                 09250000
          B     IJMA1&CL1    ENTRY FOR GET                              09300000
          SVC   IJML6&CL1    NO PUT WITH OPT RDR                        09350000
          DC    1H'0'                                                   09400000
          AGO   .F8B2                                                   09450000
.F8B1     B     IJMWT&CL1              BRANCH TO WAITF                  09500000
          B     IJMA1&CL1              BRANCH TO READ                   09550000
          SVC   IJML6&CL1              NO PUT WITH OPTICAL READER       09600000
          DC    1H'0'                                                   09650000
          B     IJMRS&CL1              BRANCH TO RSCN                   09700000
          B     IJMDY&CL1              BRANCH TO DSPLY                  09750000
.F8B2     ANOP                                                          09800000
*                                                                       09850000
* START OF GET/READ MOD                                                 09900000
*                                                                       09950000
IJMA1&CL1 ST    1,IJMS3&CL1                                             10000000
          AIF   ('&DT' EQ 'D').F8G0                                     10050000
          AIF   ('&ZIWB' EQ 'I').F8G0                                   10100000
          AIF   ('&ZIWB' EQ 'Z').F8G0                                   10150000
          ST    IJML0&CL1,IJMS4&CL1      SAVE WORK AREA ADDR            10200000
.F8G0     STM   IJML3&CL1,IJML4&CL1,IJMSV&CL1  SAVE REG 13 AND 14       10250000
          MVI   IJMC1&CL1,IJMLI&CL1    INSERT X'00' 1ST POSITION        10300000
          MVC   IJMC1&CL1+1(5),IJMC1&CL1    ZERO RETRY COUNT AREAS      10350000
          MVI   IJMK&CL1,IJMLI&CL1      ZERO ERROR INDICATORS           10400000
          AIF   ('&DT' EQ 'T').F9A                                      10450000
         ST    0,IJM4&CL1               PUT CCW ADDR IN CCB         3-1 10500000
          LA    1,24(1)                                                 10550000
          SVC   IJML7&CL1              EXCP-READ LINE                   10600000
          LM    IJML3&CL1,IJML4&CL1,IJMSV&CL1  RESTORE REG 13 & 14      10650000
         L     1,IJMS3&CL1           RESTORE REG ONE                3-9 10700000
          BR    IJML4&CL1              RETURN TO USER                   10750000
.F9A      AIF   ('&DT' EQ 'D').F9A1                                     10800000
          AIF   ('&UB' EQ 'B').F9                                       10850000
          AIF   ('&ZIWB' EQ 'Z').F8G                                    10900000
          B     IJMTL&CL1              TWO IOAREAS AND/OR WORKA         10950000
.F8G      ANOP                                                          11000000
IJMTK&CL1 OI    IJML&CL1,IJML8&CL1     SET FIRST TIME SW FOR RETRIES    11050000
IJMTL&CL1 TM    IJML&CL1,IJML8&CL1     FIRST TIME SW SET                11100000
          BZ    IJMA2&CL1    NO, TEST I/O COMPLETE                      11150000
          NI    IJML&CL1,IJMLP&CL1     TURN OFF FIRST TIME SW           11200000
          MVC   *+11(1),IJMX&CL1+3      SET LENGTH FOR BLANK OF AREA    11250000
          L     IJML3&CL1,IJMY&CL1      GET I/O ADDRESS                 11300000
          XC    0(0,IJML3&CL1),0(IJML3&CL1)   BLANK OUT I/O AREA        11350000
IJMGB&CL1 LA    1,24(1)                                                 11400000
          SVC   IJML7&CL1              EXCP-GET RECORD                  11450000
IJMTJ&CL1 TM    IJM5&CL1,IJML8&CL1     TEST IF I/O COMPLETE             11500000
          BO    *+6                    YES, IF NO WAIT                  11550000
          SVC   7                      WAIT TIL I/O COMPLETE            11600000
          L     1,IJMS3&CL1                                             11650000
          TM    IJM2&CL1,IJMLF&CL1     TEST EOF                         11700000
          BZ    IJMT8&CL1              NO, CHECK FOR ERRORS             11750000
          L     IJML3&CL1,IJMSV&CL1    RESTORE REG 13                   11800000
          L     IJML5&CL1,IJMN&CL1     GET EOF ADDRESS                  11850000
          BR    IJML5&CL1              BRANCH TO EOF ROUT               11900000
IJMA2&CL1 LA    1,24(1)      TO REF NEW CCB                             11950000
          B     IJMTJ&CL1                                               12000000
         AGO   .F20                                                 3-5 12050000
.F9      MVI   IJMBA&CL1+1,IJML0&CL1   TURN OFF BRANCH              3-5 12100000
          TM    IJML&CL1,IJML8&CL1     FIRST TIME SW SET                12150000
          BZ    IJMBA&CL1              NO                               12200000
          AIF   ('&ZIWB' EQ 'B' OR '&ZIWB' EQ 'I').F0C                  12250000
          NI    IJML&CL1,IJMLP&CL1     TURN OFF FIRST TIME SW           12300000
.F0C      MVI   IJMRC&CL1,IJML0&CL1    ZERO OUT ERROR RECORD        3-6 12350000
          MVC   IJMRC&CL1+1(3),IJMRC&CL1       AND RECORD CTR           12400000
IJMBE&CL1 L     IJML4&CL1,IJMY&CL1     GET IOAREA ADDR                  12450000
          MVC   32(4,1),IJMO&CL1       GET CCW CHAIN                    12500000
          L     1,IJMX&CL1             GET BLOCKSIZE - 1                12550000
          L     IJML3&CL1,IJMFF&CL1    GET CONST FOR COMP-              12600000
IJMBF&CL1 CR    1,IJML3&CL1            COUNT GT 255                     12650000
          BH    IJMBI&CL1              YES, GO ZERO OUT 255 BYTES       12700000
          STC   1,IJMBI&CL1+1          NO, PUT COUNT I  INST            12750000
          MVI   IJMBJ&CL1+1,IJMLI&CL1  ZERO OUT BRANCH                  12800000
IJMBI&CL1 XC    0(255,IJML4&CL1),0(IJML4&CL1)                           12850000
          S     1,IJMFF&CL1            REDUCE COUNT BY 255              12900000
          A     IJML4&CL1,IJMFF&CL1    BUMP PTR TO IOAREA               12950000
IJMBJ&CL1 B     IJMBF&CL1              GO ZERO SOME MORE                13000000
          MVI   IJMBJ&CL1+1,IJMLH&CL1  RESTORE BRANCH                   13050000
          MVI   IJMBI&CL1+1,IJMSZ&CL1   RESTORE CNT OF 255              13100000
          L     1,IJMS3&CL1            RESTORE REG 1                    13150000
          LA    1,24(1)                POINT TO REAL CCB                13200000
          SVC   IJML7&CL1              EXCP - READ BLOCK                13250000
          L     1,IJMS3&CL1            RESTORE REG 1                    13300000
          AIF   ('&ZIWB' EQ 'W' OR '&ZIWB' EQ 'Z').F0D                  13350000
          LA    IJML4&CL1,0            GET ZERO FOR COMP                13400000
          CH    IJML4&CL1,IJMER&CL1    WAS AN ERROR JUST CORRECTED      13450000
          BL    IJMTG&CL1              YES, GO BUMP LINE CTR            13500000
IJMBL&CL1 TM    IJML&CL1,IJML8&CL1     FIRST TIME SW SET                13550000
          BZ    IJMBA&CL1              NO, GO PROCESS RECORD            13600000
.F0D      AIF   ('&ZIWB' EQ 'W' OR '&ZIWB' EQ 'Z').F0E              3-6 13650000
          NI    IJML&CL1,IJMLP&CL1     TURN OFF FIRST TIME SW           13700000
.F0E      ANOP                                                          13750000
IJMBM&CL1 LA    1,24(1)                POINT TO REAL CCB                13800000
          TM    IJM5&CL1,IJML8&CL1     TEST I/O COMPLETE                13850000
          BO    *+6                    YES, IF NO WAIT                  13900000
          SVC   7                      WAIT                             13950000
          L     1,IJMS3&CL1            RESTORE REG 1                    14000000
IJMBS&CL1 MVI   IJMRC&CL1,IJML0&CL1    ZERO OUT ERROR RECORD        4-0 14050000
          MVC   IJMRC&CL1+1(3),IJMRC&CL1          AND RECORD CTR        14100000
          L     IJML4&CL1,IJMX&CL1     GET BLKSIZE-1                    14150000
          AH    IJML4&CL1,IJMON&CL1    BUMP IT TO BLKZIZE               14200000
          A     IJML4&CL1,IJMY&CL1     BUMP TO END OF IOAREA            14250000
          ST    IJML4&CL1,IJMPT&CL1    STORE IT IN PTR                  14300000
IJMBD&CL1 EQU  *                                                        14350000
         AIF ('&RECFM' NE 'FIXBLK').F0G                                 14400000
         TM    IJM2&CL1+1,IJMLT&CL1  Q. CHAN ERR AND WLR                14450000
         AGO   .F0G2                                                    14500000
.F0G     TM    IJM2&CL1+1,IJML1&CL1    TEST FOR CHAN ERRORS         3-6 14550000
.F0G2    BM    IJME3&CL1               YES, GO CALCULATE REC NO.        14600000
          TM    IJM2&CL1,IJMUE&CL1     TEST UNIT CHECK + EXCEP          14650000
          BM    IJME3&CL1              YES, GO CALC RECORD NUMBER       14700000
IJMBQ&CL1 EQU  *                                                    3-1 14750000
          AIF   ('&ZIWB' EQ 'W' OR '&ZIWB' EQ 'Z').F0F                  14800000
          L     IJML4&CL1,IJMO&CL1     SWAP CCW ADDRS                   14850000
          L     IJML3&CL1,IJMP&CL1                                      14900000
          ST    IJML3&CL1,IJMO&CL1     PUT ADDR2 IN ADDR1               14950000
          ST    IJML4&CL1,IJMP&CL1     PUT ADDR1 IN ADDR2               15000000
          L     IJML4&CL1,IJMY&CL1     SWAP I/O AREAS                   15050000
          L     IJML3&CL1,IJMM&CL1                                      15100000
          ST    IJML3&CL1,IJMY&CL1     IO2 IN IO1                       15150000
          ST    IJML4&CL1,IJMM&CL1     IO1 IN IO2                       15200000
          B     IJMBE&CL1              GO BLANK I/O AREA                15250000
.F0F      ANOP                                                          15300000
IJMBA&CL1 B     IJMTG&CL1              BRANCH OUT 2ND TIME              15350000
          LH    IJML3&CL1,IJMRC&CL1    GET THE RECORD CTR               15400000
          AH    IJML3&CL1,IJMON&CL1    BUMP IT BY ONE                   15450000
          STH   IJML3&CL1,IJMRC&CL1    PUT BACK IN RECORD CTR           15500000
          CH    IJML3&CL1,IJMP1&CL1    NEED ANOTHER RECORD              15550000
          AIF   ('&ZIWB' EQ 'W' OR '&ZIWB' EQ 'Z').F0E1                 15600000
          BH    IJMBM&CL1              YES                              15650000
.F0E1     AIF   ('&ZIWB' EQ 'B' OR '&ZIWB' EQ 'I').F0E2             3-6 15700000
          BH    IJMBE&CL1              YES                              15750000
.F0E2     MVI   IJMBA&CL1+1,IJMLH&CL1  TURN ON BRANCH FOR 2ND TIME  3-6 15800000
          MVI   IJMBU&CL1+1,IJMLI&CL1  SET TO NO-OP                 4-0 15850000
          CH    IJML3&CL1,IJMER&CL1    IS THIS AN ERROR RECORD          15900000
          BE    IJMBT&CL1              YES                          4-0 15950000
          B     IJMTG&CL1              GO BUMP LINE CTR                 16000000
IJME3&CL1 L     IJML3&CL1,IJM6&CL1     GET THE CCW ADDR                 16050000
          AH    IJML3&CL1,IJMEI&CL1    BUMP CCW ADDR BY 8               16100000
          L     IJML4&CL1,IJMO&CL1     GET FIRST CCW ADDR               16150000
          SR    IJML3&CL1,IJML4&CL1                                     16200000
          SLL   IJML3&CL1,4                                             16250000
          SRL   IJML3&CL1,8            CALC THE RECORD NUMBER           16300000
          LA    IJML4&CL1,0            GET ZERO FOR COMP                16350000
          CH    IJML4&CL1,IJMER&CL1    IS THE ERROR BEING RETRIED       16400000
          BL    IJME4&CL1              YES, GO CHECK FOR SAME ERR       16450000
          STH   IJML3&CL1,IJMER&CL1    SAVE THE RECORD NUMBER           16500000
          B     IJMBA&CL1              GO PROCESS RECORD                16550000
IJME4&CL1 CH    IJML3&CL1,IJMER&CL1    IS IT SAME ERROR                 16600000
          BE    IJMBT&CL1              YES, GO RETRY                4-0 16650000
          STH   IJML3&CL1,IJMER&CL1    NO, SAVE RECORD NUMBER           16700000
          B     IJMTG&CL1              GO BUMP LINE CTR                 16750000
         AGO   .F20                                                 3-5 16800000
.F9A1     ANOP                                                          16850000
*                                                                       16900000
*  START OF DSPLY MOD                                                   16950000
*                                                                       17000000
IJMDY&CL1 ST    1,IJMS3&CL1  SAVE CCB POINTER                           17050000
          STM   IJML3&CL1,IJML4&CL1,IJMS2&CL1  SAVE REG 13 & 14         17100000
          MVC   IJMCC&CL1,IJM4&CL1  SAVC CCW ADDR                       17150000
          NI    IJMZ&CL1,IJMLI&CL1  ZERO COMMD CODE                     17200000
          L     IJML3&CL1,IJMZ&CL1  LOAD IO AREA ADDR REG 13            17250000
          LH    IJML4&CL1,IJMZ&CL1+6  LOAD REG 14 WITH BYTE COUNT       17300000
          SH    IJML4&CL1,IJMON&CL1  DECREMENT REG 14 BY ONE            17350000
          SR    IJML3&CL1,IJML4&CL1  SUB REG 14 FROM 13                 17400000
          ST    IJML3&CL1,IJMZ&CL1                                      17450000
          MVI   IJMZ&CL1,IJMLE&CL1  PUT RD FRD COMMD IN CCW             17500000
          NI    IJMZ&CL1+4,IJMLJ&CL1   TURN OFF CHAINING BIT            17550000
          STC   IJML4&CL1,IJMDL&CL1+1  MOVE LENGTH TO BLANK INST        17600000
          LR    IJML4&CL1,1  PUT DTF ADDR IN REG 14                     17650000
          LA    IJML4&CL1,88(IJML4&CL1)  POINT TO CCW IN DTF            17700000
IJMDL&CL1 XC    0(0,IJML3&CL1),0(IJML3&CL1)  BLNK IO AREA               17750000
         MVI   IJMK&CL1,IJMLI&CL1  ZERO ERROR INDICATOR BYTE        3-1 17800000
          ST    IJML4&CL1,IJM4&CL1  STORE CCW ADDR IN CCB               17850000
          LA    1,24(1)  POINT TO ACTUAL CCB                            17900000
          SVC   IJML7&CL1  EXCP - DSPLY                                 17950000
          TM    IJM5&CL1,IJML8&CL1  TEST IO COMPLETE                    18000000
          BO    *+6  NO,WAIT                                            18050000
          SVC   7  WAIT                                                 18100000
          L     1,IJMS3&CL1  RESTORE REG 1                              18150000
          TM    IJM2&CL1,IJMLF&CL1  TEST UNIT EXCPTION                  18200000
          BO    IJMDR&CL1  YES RE-EXCP UPDATE CCW ADDR FIRST            18250000
          TM    IJM2&CL1,IJMLE&CL1     TEST UNIT CHECK                  18300000
          BZ    IJMD1&CL1              NO, GO CHECK WLR                 18350000
         TM    IJM00&CL1,IJML9&CL1     Q- INTERV REQ ON            3-10 18400000
         BO    IJMTY&CL1               YES, RETRY                  3-10 18450000
         TM    IJM00&CL1,IJML8&CL1     COMMAND REJECT               3-5 18500000
         BC    14,IJMEA&CL1            NO , GO TO NEXT TEST         3-5 18550000
IJMTY&CL1 BAL  IJML4&CL1,IJMSB&CL1     GO TO RETRY                 3-10 18600000
IJMEA&CL1  TM  IJM00&CL1,IJMLB&CL1     TEST EQUIP CHECK             3-5 18650000
         BZ    IJMD0&CL1           NO, TEST NON-RECOVERY            3-2 18700000
          OI    IJM1&CL1+1,IJMLB&CL1   POST EQ CK TO CCB                18750000
         OI    IJMK&CL1,IJML9&CL1  SET ERR IND TO LOST LANDMARK     3-1 18800000
IJMD0&CL1 TM   IJM00&CL1,IJMLE&CL1 NON-RECOVERY                     3-2 18850000
         BZ    IJMD1&CL1           NO, TEST WRONG LENGTH RECORD     3-2 18900000
         OI    IJMK&CL1,IJMLB&CL1  POST NON REC TO ERR IND BYTE     3-2 18950000
         OI    IJM1&CL1+1,IJMLC&CL1     SET NON REC IN CCB HEX 08   3-2 19000000
IJMD1&CL1 TM    IJM2&CL1+1,IJML9&CL1   TEST WRONG LENGTH RECORD         19050000
          BZ    IJMD2&CL1              NO, RETURN                       19100000
         OI    IJMK&CL1,IJMLD&CL1       SET ERR IND. TO WLR         3-1 19150000
IJMD2&CL1 LM    IJML3&CL1,IJML4&CL1,IJMS2&CL1  RESTORE REG 13 & 14      19200000
          MVC   32(4,1),IJMCC&CL1  RESTORE CCW ADDR IN CCB              19250000
          MVI   IJMDR&CL1+1,IJMLI&CL1  RESET BRANCH                     19300000
          BR    IJML4&CL1  RETURN TO USER                               19350000
IJMDR&CL1 BC    0,IJMDL&CL1  FIRST TIME SWITCH                          19400000
          LA    IJML4&CL1,16(IJML4&CL1)  POINT TO RDFRD CCW             19450000
          OI    IJMDR&CL1+1,IJMLH&CL1  SET NOP TO A BRANCH              19500000
          B     IJMDL&CL1              GO EXCP AGAIN                    19550000
*                                                                       19600000
* START OF RESCN MOD                                                    19650000
*                                                                       19700000
IJMRS&CL1 ST    1,IJMS3&CL1            SAVE CCB POINTER                 19750000
          STM   IJML3&CL1,IJML4&CL1,IJMS2&CL1    SAVE REG 13 + 14       19800000
          MVC   IJMCC&CL1,IJM4&CL1     SAVE CCW ADDR                    19850000
          LA    IJML4&CL1,IJMO&CL1     GET NEW CCW ADDR                 19900000
          ST    IJML4&CL1,IJM4&CL1                                      19950000
          MVI   IJMZ&CL1,IJMLR&CL1                                      20000000
          NI    IJMZ&CL1+4,IJMLJ&CL1    SET COMMAND CHAIN OFF           20050000
          LA    IJML3&CL1,IJML5&CL1    GET CONST OF 15                  20100000
          CR    IJML3&CL1,IJML0&CL1    IS COUNT GT 15                   20150000
          BH    IJMR2&CL1              NO, BRANCH                       20200000
          SR    IJML0&CL1,IJML3&CL1    YES, SUBT 15 FROM COUNT          20250000
          MVI   IJMR3&CL1+1,IJMLI&CL1  MASK OUT BRANCH                  20300000
IJMR2&CL1 MVI   IJMK&CL1,IJMLI&CL1     ZERO OUT ERROR IND BYTE          20350000
          L     IJML4&CL1,IJMZ&CL1     GET THE I/O AREA                 20400000
          LH    IJML3&CL1,IJMZ&CL1+6    GET THE COUNT                   20450000
          SH    IJML3&CL1,IJMON&CL1    SUBT 1 FROM COUNT                20500000
          SR    IJML4&CL1,IJML3&CL1    POINT TO START OF I/O AREA       20550000
          STC   IJML3&CL1,*+5          MOVE COUNT TO XC INSTR           20600000
          XC    0(0,IJML4&CL1),0(IJML4&CL1)    BLANK I/O AREA           20650000
          LA    1,24(1)                                                 20700000
          SVC   IJML7&CL1              EXCP-RESCN                       20750000
IJMR8&CL1 TM    IJM5&CL1,IJML8&CL1     TEST I/O COMPLETE                20800000
          BO    *+6                    NO WAIT                          20850000
          SVC   7                      WAIT                             20900000
          L     1,IJMS3&CL1                                             20950000
          TM    IJM2&CL1,IJMLE&CL1     TEST UNIT CHECK                  21000000
          BZ    IJMRL&CL1              NO                               21050000
         TM    IJM00&CL1,IJML8&CL1     COMMAND REJECT               3-5 21100000
         BC    14,IJMDZ&CL1            NO , GO TO NEXT TEST         3-5 21150000
         BAL   IJML4&CL1,IJMSB&CL1     YES,RETRY                    3-5 21200000
IJMDZ&CL1  TM  IJM00&CL1,IJML9&CL1     TEST INT. REQ                3-5 21250000
          BZ    IJMR9&CL1              NO                               21300000
          BAL   IJML4&CL1,IJMSB&CL1    YES, GO RETRY                    21350000
          NI    IJM00&CL1,IJMLJ&CL1    TURN OFF IRV            @DA15407 21400000
          LA    1,24(1)                POINT TO REAL CCB                21450000
          B     IJMR8&CL1              GO WAIT                          21500000
IJMR9&CL1 TM    IJM00&CL1,IJMLC&CL1    TEST DATA CHECK                  21550000
          BZ    *+12                   NO                               21600000
          OI    IJM1&CL1+1,IJML8&CL1   POST DATA CHECK                  21650000
          OI    IJMK&CL1,IJMLF&CL1     SET ERR IND BYTE FOR DATA CK     21700000
          TM    IJM00&CL1,IJMLB&CL1    TEST EQUIP CK                    21750000
         BZ    IJMRK&CL1           NO, TEST NON-RECOVERY            3-2 21800000
          OI    IJM1&CL1+1,IJMLB&CL1   YES, POST EQ CK                  21850000
         L     IJML3&CL1,IJM6&CL1      PICK UP CSW CCW ADDRESS      3-3 21900000
         SH    IJML3&CL1,IJMEI&CL1     DECREMENT BY 8               3-3 21950000
         CLI   0(IJML3&CL1),IJMRM&CL1  QUESTION LOAD FORMAT CCW     3-1 22000000
         BNE   *+12 NO, DO NOT SET ERR IND. FOR LOST LANDMARK       3-1 22050000
         OI    IJMK&CL1,IJML9&CL1       SET ERR IND. TO X'40'       3-1 22100000
         B     *+8                                                  3-1 22150000
          OI    IJMK&CL1,IJMLC&CL1     SETER IND BYTE FOR EQ CK         22200000
IJMRK&CL1 TM   IJM00&CL1,IJMLE&CL1      NON-RECOVERY                3-2 22250000
         BZ    IJMRL&CL1           NO                               3-2 22300000
         OI    IJMK&CL1,IJMLB&CL1  POST NON REC TO ERR IND BYTE     3-2 22350000
         OI    IJM1&CL1+1,IJMLC&CL1    SET NON REC IN CCB  HEX 08   3-8 22400000
          AIF   ('&UF' EQ 'U').F19A                                     22450000
IJMRL&CL1 TM    IJM2&CL1+1,IJML9&CL1   TEST WLR                         22500000
          BZ    IJMR1&CL1              NO                               22550000
          OI    IJMK&CL1,IJMLD&CL1     SET ER IND BYTE FOR WLR          22600000
IJMR1&CL1 TM    IJMK&CL1,IJML3&CL1     ANY ERRORS                       22650000
          AGO   .F19B                                                   22700000
.F19A     ANOP                                                          22750000
IJMRL&CL1 TM    IJMK&CL1,IJML3&CL1     ANY ERRORS                       22800000
.F19B     BZ    IJMR4&CL1              NO, BRANCH                   3-6 22850000
          BCT   0,IJMR2&CL1            YES, ANY MORE RETRIES            22900000
IJMR3&CL1 B     IJMR4&CL1              NO                               22950000
          LA    IJML0&CL1,IJMLF&CL1    RESET REG0 FOR BCT               23000000
          MVI   IJMZ&CL1,IJMLV&CL1     FORCE ON LINE CORRECTION         23050000
          MVI   IJMR3&CL1+1,IJMLH&CL1  RESET BRANCH                     23100000
          B     IJMR2&CL1              GO RETRY                         23150000
IJMR4&CL1 LM    IJML3&CL1,IJML4&CL1,IJMS2&CL1   RESTORE REGS            23200000
          MVC   32(4,1),IJMCC&CL1  RESTORE CCW ADDR IN CCB              23250000
          BR    IJML4&CL1              RETURN TO USER                   23300000
*                                                                       23350000
*   START OF WAITF MOD                                                  23400000
*                                                                       23450000
IJMWT&CL1 ST    1,IJMS3&CL1  SAVE CCB POINTER                           23500000
          STM   IJML3&CL1,IJML4&CL1,IJMSV&CL1  SAVE REG 13 & 14         23550000
          TM    0(IJML4&CL1),IJMSX&CL1 IS THIS MULTIPLE WAIT            23600000
          BM    *+6                    NO                               23650000
          SVC   IJML6&CL1              YES, MULTIPLE WAIT INVALID       23700000
          LA    1,24(1)          LOAD ACTUAL CCB                        23750000
          TM    IJM5&CL1,IJML8&CL1    IO COMPLETE                       23800000
          BO    *+6          NO,WAIT                                    23850000
          SVC   7     WAIT                                              23900000
          L     1,IJMS3&CL1  RESTORE REG 1                              23950000
*                                                                       24000000
*   START OF ERROR ROUTINE                                              24050000
*                                                                       24100000
          AGO   .F21                                                    24150000
.F20      ANOP                                                          24200000
*                                                                       24250000
* START OF GET ERROR ROUTINE                                            24300000
*                                                                       24350000
          AIF   ('&UB' NE 'B').F21                             @DA06513 24400000
IJMBT&CL1 EQU   *                                              @DA11358 24450000
          TM    IJM2&CL1,IJMLF&CL1       TEST EOF              @DA11358 24500000
          BO    IJMT8&CL1                YES                   @DA11358 24550000
           CLI   IJMER&CL1+1,IJMLF&CL1  INITIAL READ ?         @DA11358 24600000
          BNE   IJMT8&CL1              NO - CHECK FOR ERRORS        4-0 24650000
          MVI   IJMBA&CL1+1,IJMLI&CL1  SET TO NO-OP                 4-0 24700000
          MVI   IJMBU&CL1+1,IJMLH&CL1  RESET BRANCH                 4-0 24750000
.F21      ANOP                                                          24800000
IJMT8&CL1 TM    IJM2&CL1+1,IJML1&CL1   TEST CHAN DATA OR CHAN CHAIN CHK 24850000
          BZ    IJMT0&CL1              NONE, TEST UNIT CHECK            24900000
          BAL   IJML4&CL1,IJMSA&CL1    YES, TEST HARD AND SOFT ERRORS   24950000
IJMT0&CL1 TM    IJM2&CL1,IJMLE&CL1     TEST UNIT CHECK BIT,HEX 02 BYTE4 25000000
         AIF   ('&UB' EQ 'B').F11C                                  3-5 25050000
          BZ    IJM10&CL1              NO, TEST FOR ANY ERRORS      3-5 25100000
          NI    IJMSC&CL1+1,IJMLI&CL1  TURN UNIT EX SWITCH OFF      3-5 25150000
         AGO   .F11CC                                               3-5 25200000
.F11C    BZ    IJM10&CL1               NO, TEST FOR ANY ERRORS     3-10 25250000
.F11CC   BAL   IJML4&CL1,IJMSA&CL1     YES,TEST HARD AND SOFT ERRORS3-5 25300000
*                                                                       25350000
* TEST FOR ANY ERRORS                                                   25400000
*                                                                       25450000
IJM10&CL1 TM    IJM1&CL1+1,IJMSW&CL1   TEST FOR DC, EC, NR, & KC ERRORS 25500000
          AIF   ('&UF' EQ 'F').F8C                                      25550000
         AIF   ('&DEVICE' EQ '1287D' AND '&RECFORM' EQ 'UNDEF').F8C 3-1 25600000
          AIF   ('&DT' EQ 'T').F10                                      25650000
          BZ    IJMWF&CL1   NONE,GO TEST HOPPER EMPTY                   25700000
          AGO   .F8C1                                                   25750000
.F10     AIF   (T'&BLKFAC EQ 'O').KLF                               3-6 25800000
         BM    IJMSQ&CL1               YES,TEST NON-RECOVERY       3-8  25850000
          AGO   .F8C1                                                   25900000
.F8C     BM    IJMSQ&CL1               SOME, GO TEST ERRORS         3-6 25950000
          TM    IJM2&CL1+1,IJML9&CL1   TEST FOR WLR                     26000000
          AIF   ('&DT' EQ 'T').F10A                                     26050000
          BZ    IJMWF&CL1    NONE, GO TEST HOPPER EMPTY                 26100000
          AGO   .F8C1                                                   26150000
.F10A    AIF   ('&DEVICE' EQ '1287D' OR '&RECFORM' EQ 'FIXUNB').KLF 3-6 26200000
         BO    IJMSQ&CL1               YES, TEST NON-RECOVERY      3-10 26250000
         AGO   .F8C1                                                3-1 26300000
.KLF     BZ    IJMTG&CL1      NONE, GO TO INCREMENT TOTAL LINE      3-6 26350000
.F8C1     ANOP                                                          26400000
         AIF   ('&UB' NE 'B').F11D1                                 3-8 26450000
IJMEX&CL1 TM   IJM2&CL1,IJMLF&CL1      TEST EOF                     3-8 26500000
         BZ    IJMBV&CL1               NO                           4-0 26550000
IJMBU&CL1 NOP  IJMBS&CL1               SET TO BRANCH                4-0 26600000
         L     IJML3&CL1,IJMSV&CL1     YES, RESTORE REG 13          3-8 26650000
         L     IJML5&CL1,IJMN&CL1      GET EOF ADDR                 3-8 26700000
         BR    IJML5&CL1               GO TO EOF ROUT              3-8  26750000
IJMBV&CL1 MVI   IJMBA&CL1+1,IJMLH&CL1  RESET BRANCH                 4-0 26800000
          MVI   IJMBU&CL1+1,IJMLI&CL1  SET TO NO-OP                 4-0 26850000
         B     IJMBQ&CL1               RETURN TO MAINLINE          3-8  26900000
.F11D1   ANOP                                                           26950000
*                                                                       27000000
* TEST NON RECOVERY                                                     27050000
*                                                                       27100000
IJMSQ&CL1 TM    IJM1&CL1+1,IJMLC&CL1   TEST NON RECOVERY BIT            27150000
          BZ    IJMT9&CL1              BIT OFF, TEST EQUIP CHK BYT      27200000
          MVI   IJMK&CL1,IJMLB&CL1     SET NON-REC BIT ON IN ER IND     27250000
          LM    IJML3&CL1,IJML4&CL1,IJMSV&CL1 RESTORE 13 + 14       4-0 27300000
          L     IJML5&CL1,IJMQ&CL1     GET COREXIT ADDRESS              27350000
          BR    IJML5&CL1  EXIT TO COREXIT                              27400000
*                                                                       27450000
* TEST EQUIPMENT CHECK                                                  27500000
*                                                                       27550000
IJMT9&CL1 TM    IJM1&CL1+1,IJMLB&CL1   TEST EQUIP CHECK                 27600000
         AIF   ('&UF' EQ 'U' AND '&DEVICE' NE '1287D').F8G1         3-1 27650000
         BZ    IJMTA&CL1      NO,TEST WRONG LENGTH RECORD           3-1 27700000
         AGO   .F8G2                                                3-1 27750000
.F8G1    BZ    IJMTB&CL1      NO, TEST DATA CHECK                   3-6 27800000
.F8G2    L     IJML3&CL1,IJMC&CL1  PUT COUNT OF EQUIP CK IN REG 13  3-6 27850000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             27900000
          ST    IJML3&CL1,IJMC&CL1     PUT UPDATED COUNT IN DTF TABLE   27950000
          AIF   ('&UB' EQ 'B').F24A                                     28000000
          AIF   ('&DT' EQ 'T').F24                                      28050000
.F24A     CLC   IJM7&CL1,IJMCC&CL1+1    SAME ERROR                  3-6 28100000
          BE    IJMGO&CL1     YES UPDATE CTR                            28150000
          MVI   IJMC1&CL1,IJMLI&CL1      ZERO RETRY CTR                 28200000
          MVC   IJMC1&CL1+1(1),IJMC1&CL1                                28250000
          MVC   IJMCC&CL1,IJM6&CL1     STORE NEW CCW ADDR               28300000
.F24      ANOP                                                          28350000
IJMGO&CL1 LH    IJML3&CL1,IJMC1&CL1  PUT RETRY CT IN REG                28400000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             28450000
          STH   IJML3&CL1,IJMC1&CL1    PUT UPDATED COUNT IN SAVE AREA   28500000
          CLI   IJMC1&CL1+1,IJMLK&CL1  RETRIED TEN TIMES                28550000
          AIF   ('&UB' EQ 'B').F23A                                     28600000
          AIF   ('&DT' NE 'D').F23                                      28650000
.F23A     AIF   ('&UB' EQ 'B').F9C1                                 3-6 28700000
          BE    IJMM3&CL1  BRANCH IF TRIED 10 TIMES                     28750000
          B     IJMRT&CL1      RETRY                                    28800000
.F23      AIF   ('&DT' EQ 'D').F9C                                      28850000
          BNE   IJMTK&CL1              NO, RETRY AGAIN                  28900000
.F9C1     AIF   ('&UB' NE 'B').F9C                                  3-6 28950000
          BNE   IJMRT&CL1              RETRY                            29000000
.F9C      AIF    ('&DT' EQ 'T').F11                                     29050000
IJMM3&CL1 L     IJML3&CL1,IJM4&CL1  LOAD CCW ADDR IN REG 13             29100000
          CLI   0(IJML3&CL1),IJMRM&CL1  IS LOAD FORMAT CCW              29150000
          BNE   *+12   NO DO NOT SET ERR IND FOR LOST LNDMK             29200000
          OI    IJMK&CL1,IJML9&CL1  SET ERR IND HEX 40    3             29250000
          B     IJMM4&CL1  BRANCH AROUND SETTING OF EQUIP CHECK         29300000
.F11      OI    IJMK&CL1,IJMLC&CL1  SET ERR IND BYTE FOR EQUIP CH   3-6 29350000
IJMM4&CL1 L     IJML3&CL1,IJMD&CL1  PUT 10 RETRIES EQUIP CK COUNT       29400000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             29450000
          ST    IJML3&CL1,IJMD&CL1     RESTORE IN DTF TABLE             29500000
         AIF   ('&UF' EQ 'U' AND '&DEVICE' NE '1287D').F8G3         3-1 29550000
         B     IJMTB&CL1                CHECK DATA CHECK            3-1 29600000
*                                                                       29650000
* TEST WRONG LENGTH RECORD                                              29700000
*                                                                       29750000
IJMTA&CL1 TM    IJM2&CL1+1,IJML9&CL1   TEST WRONG LENGTH RECORD         29800000
          BZ    IJMTB&CL1              NO, TEST DATA CK BIT             29850000
         AIF   ('&UF' EQ 'U' AND '&DEVICE' EQ '1287D').F8G4         3-1 29900000
          L     IJML3&CL1,IJME&CL1     PUT COUNT OF WLR IN R13          29950000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             30000000
          ST    IJML3&CL1,IJME&CL1     PUT UPDATED COUNT IN DTF TABLE   30050000
          AIF   ('&UB' EQ 'B').F27A                                     30100000
          AIF   ('&DT' EQ 'T').F27                                      30150000
.F27A     CLC   IJM7&CL1,IJMCC&CL1+1    SAME ERROR                  3-6 30200000
          BE    IJMAB&CL1  YES UPDATE COUNTER                           30250000
          MVI   IJMC2&CL1,IJMLI&CL1    ZERO RETRY CTR                   30300000
          MVC   IJMC2&CL1+1(1),IJMC2&CL1                                30350000
          MVC   IJMCC&CL1,IJM6&CL1     STORE NEW CCW ADDR               30400000
.F27      ANOP                                                          30450000
IJMAB&CL1 LH    IJML3&CL1,IJMC2&CL1  PUT RETRY CTR IN REG 13            30500000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             30550000
          STH   IJML3&CL1,IJMC2&CL1    PUT UPDATED COUNT IN SAVE AREA   30600000
         CLI   IJMC2&CL1+1,IJMLZ&CL1   END OF REQUEST ?            3-10 30650000
          AIF   ('&UB' EQ 'B').F29A1                                    30700000
          AIF   ('&DT' NE 'D').F29                                      30750000
.F29A1    BE    IJMM2&CL1     BRANCH IF  10 RETRIES                 3-6 30800000
          B     IJMRT&CL1       RETRY                                   30850000
          AIF   ('&UB' EQ 'B').F29A                                     30900000
.F29      AIF   ('&DT' EQ 'D').F29A                                     30950000
          BNE   IJMTK&CL1              NO, RETRY AGAIN                  31000000
.F29A     ANOP                                                          31050000
IJMM2&CL1 OI    IJMK&CL1,IJMLD&CL1     SET ER IND BYTE FOR WLR          31100000
          L     IJML3&CL1,IJMF&CL1     PUT 10 RETRIES WLR COUNT IN 13   31150000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             31200000
          ST    IJML3&CL1,IJMF&CL1     RESTORE IN DTF TABLE             31250000
         AGO   .F8G3                                                3-1 31300000
.F8G4    SVC   IJML6&CL1      WLR OCCURRED WHEN RECFORM=UNDEF       3-6 31350000
.F8G3     ANOP                                                          31400000
*                                                                       31450000
* TEST DATA CHECK                                                       31500000
*                                                                       31550000
IJMTB&CL1 TM    IJM1&CL1+1,IJML8&CL1   TEST DATA CHECK                  31600000
          AIF   ('&DT' EQ 'T').F10F                                     31650000
          BZ    IJMWF&CL1              NO, GO TEST ANY ERRORS           31700000
          AGO   .F10G                                                   31750000
.F10F     BZ    IJMTD&CL1              NO, TEST KEYBOARD CORRECTION 3-6 31800000
.F10G     L     IJML3&CL1,IJMH&CL1  PUT DATA CHECK COUNT IN REG 13  3-6 31850000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             31900000
          ST    IJML3&CL1,IJMH&CL1     RESTORE DATA CK IN DTF TABLE     31950000
          TM    IJM1&CL1+1,IJMLM&CL1   NON-RECOVERY OR EQUIP CK         32000000
          BM    IJMTC&CL1              YES, SET BIT IN ER IND BYTE      32050000
          AIF   ('&UF' EQ 'U').F8GP                                     32100000
          TM    IJM2&CL1+1,IJML9&CL1   WRONG LENGTH RECORD              32150000
          BO    IJMTC&CL1              YES, SET BIT IN ER IND BYTE      32200000
.F8GP     AIF   ('&DT' EQ 'D').F10H                                     32250000
          TM    IJM1&CL1+1,IJML9&CL1    TEST KEYBOARD CORRECTION        32300000
          BO    IJMTC&CL1               YES, SET BIT IN ERROR BYTE      32350000
.F10H     AIF   ('&UB' EQ 'B').F10Z                                 3-6 32400000
          AIF   ('&DT' EQ 'T').F10I                                     32450000
.F10Z     CLC   IJM7&CL1,IJMCC&CL1+1    SAME ERROR                  3-6 32500000
          BE    IJMBR&CL1  YSE UPDATE COUNTER                           32550000
          MVI   IJMC3&CL1,IJMLI&CL1    ZERO RETRY CTR                   32600000
          MVC   IJMC3&CL1+1(1),IJMC3&CL1                                32650000
          MVC   IJMCC&CL1,IJM6&CL1     STORE NEW CCW ADDR               32700000
.F10I     ANOP                                                          32750000
IJMBR&CL1 LH    IJML3&CL1,IJMC3&CL1    PUT RETRY COUNT IN REG 13        32800000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             32850000
          STH   IJML3&CL1,IJMC3&CL1    PUT UPDATE RETRY COUNT IN REG 13 32900000
          CLI   IJMC3&CL1+1,IJMLN&CL1  ANY MORE RETRIES                 32950000
          AIF   ('&UB' EQ 'B').F10X                                     33000000
          AIF   ('&DT' EQ 'T').F10T                                     33050000
.F10X     BNE   IJMRT&CL1  NO RETRY                                 3-6 33100000
          AGO   .F10W                                                   33150000
.F10T     BNE   IJMTK&CL1              NO, RETRY AGAIN              3-6 33200000
.F10W     ANOP                                                          33250000
IJMTC&CL1 OI    IJMK&CL1,IJMLF&CL1     SET DATA CHECK BIT IN ER IND BYT 33300000
          AIF   ('&DT' EQ 'D').F8G5                                 3-6 33350000
*                                                                       33400000
* TEST KEYBOARD CORRECTION                                              33450000
*                                                                       33500000
IJMTD&CL1 TM    IJM1&CL1+1,IJML9&CL1   KEYBOARD CORRECTION BIT ON       33550000
          BZ    IJMTE&CL1              NO, CHECK FOR ANY ERRORS         33600000
          OI    IJMK&CL1,IJMLE&CL1     SET KEYB COR BIT IN ER IND BT    33650000
          L     IJML3&CL1,IJMG&CL1     PUT COUNT OF KEYB COR IN REG 13  33700000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             33750000
          ST    IJML3&CL1,IJMG&CL1     RESTORE COUNT IN DTF TABLE       33800000
         AIF   ('&RECFM' EQ 'FIXBLK' OR T'&BLKFAC NE 'O').LBJ       3-1 33850000
         AGO   .GFH                                                 3-1 33900000
.LBJ     L     IJML3&CL1,IJM6&CL1       GET CCW ADDRESS             3-6 33950000
         SH    IJML3&CL1,IJMEI&CL1      DECREMENT CCW ADDR BY 8     3-1 34000000
         ST    IJML3&CL1,IJM4&CL1       PUT CCW ADDR IN CCB         3-1 34050000
.GFH     ANOP                                                       3-1 34100000
*                                                                       34150000
* TEST FOR ANY ERRORS                                                   34200000
*                                                                       34250000
IJMTE&CL1 TM    IJM1&CL1+1,IJMSW&CL1    TEST FOR DC, EC, NR, &KC ERRORS 34300000
          AIF   ('&UF' EQ 'F').F8GA                                     34350000
          AIF   ('&DT' EQ 'T').F10B                                     34400000
          BZ    IJMWF&CL1  NONE GO TEST HOPPER EMPTY                    34450000
          AGO   .F8G5                                                   34500000
.F10B    AIF   (T'&BLKFAC EQ 'O').XKE                               3-6 34550000
         BZ    IJMBQ&CL1      NONE, RETURN TO MAINLINE              3-1 34600000
          AGO   .F8G5                                                   34650000
.F8GA     BM    IJMTF&CL1              GO TO CORRECTION ROUTINE         34700000
IJMTM&CL1 TM    IJM2&CL1+1,IJML9&CL1   TEST FOR WLR                     34750000
          AIF   ('&DT' EQ 'T').F10C                                     34800000
          BZ    IJMWF&CL1  NONE GO TEST HOPPER EMPTY                    34850000
          AGO   .F8G5                                                   34900000
.F10C    AIF   ('&RECFORM' EQ 'FIXUNB').XKE                         3-6 34950000
         BZ    IJMBQ&CL1      NONE, RETURN TO MAINLINE              3-1 35000000
         AGO   .F8G5                                                3-1 35050000
.XKE     BZ    IJMTG&CL1      NONE, GO TO INCREMENT TOTAL LINES     3-6 35100000
.F8G5     AIF   ('&DT' NE 'D').F10E                                 3-6 35150000
*                                                                       35200000
*  WAITF EXIT ROUTINE                                                   35250000
*                                                                       35300000
IJMWF&CL1 TM    IJM2&CL1,IJMLF&CL1     TEST EOF                         35350000
          BZ    *+14                   NO                               35400000
IJMWW&CL1 L     IJML3&CL1,IJMSV&CL1    RESTORE REG 13                   35450000
          L     IJML5&CL1,IJMN&CL1     GET EOF ADDRESS                  35500000
          BR    IJML5&CL1              BRANCH TO EOF ROUT               35550000
          TM    IJM1&CL1+1,IJMLA&CL1   TEST HOPPER EMPTY                35600000
          AIF   ('&UF' NE 'U').F10R                                     35650000
          BZ    IJMRF&CL1  NO,TEST RECFORM                              35700000
          AGO   .F10S                                                   35750000
.F10R     BZ    IJMRG&CL1   NO,BRANCH TO TEST EQUIP CHECK           3-6 35800000
.F10S    NI    IJMUA&CL1+1,IJMLX&CL1    SET BRANCH TO NO-OP         3-6 35850000
         MVI   IJMUT&CL1+1,IJMLH&CL1   RESET BRANCH                3-10 35900000
         L     IJML3&CL1,IJM6&CL1      GET CCW ADDRESS              3-1 35950000
         SH    IJML3&CL1,IJMEI&CL1     DECREMENT CCW ADDR BY 8      3-1 36000000
         ST    IJML3&CL1,IJM4&CL1      PUT CCW ADDR IN CCB          3-1 36050000
         TM    IJM20&CL1,IJMLF&CL1     SHOULD HOPPER EMPTY BE POSTED3-1 36100000
         BZ    IJMUB&CL1     NO, GO HANDLE HOPPER EMPTY             3-1 36150000
         OI    IJMK&CL1,IJMLE&CL1  SET ERR IND. TO HOPPER EMPTY     3-1 36200000
         B     IJMTF&CL1      BRANCH TO COREXIT ROUTINE             3-1 36250000
         AIF    ('&RECFM' EQ 'FIXUNB').F10J                         3-1 36300000
IJMRF&CL1 L     IJML4&CL1,IJM6&CL1     PUT CCW ADDR IN REG 14           36350000
          SH    IJML4&CL1,IJMEI&CL1  DECREMENT BE EIGHT                 36400000
          LH    IJML3&CL1,6(0,IJML4&CL1)  PUT CCW COUNT IN REG 13       36450000
          SH    IJML3&CL1,IJM0&CL1     SUBT RESIDUAL CNT                36500000
          EX    0,IJMV&CL1  PUT COUNT IN USERS REG                      36550000
.F10J     ANOP                                                          36600000
IJMRG&CL1 TM    IJMK&CL1,IJMLT&CL1     TEST DATA + EQUIP CK             36650000
          BM    IJMTF&CL1              BRANCH TO COREXIT ROUTINE        36700000
          AIF   ('&UF' EQ 'U').F10M                                     36750000
          TM    IJMK&CL1,IJMLD&CL1  TEST WLR                            36800000
          BO    IJMTF&CL1  BRANCH TO COREXIT ROUTINE                    36850000
.F10M     TM    IJM1&CL1+1,IJMLE&CL1   TEST LATE STACKER SELECT     3-6 36900000
          BZ    *+12                   NO                               36950000
          OI    IJMK&CL1,IJMLA&CL1     YES, SET ERRIND BYTE             37000000
          B     IJMTF&CL1              GO TO CORE EXIT                  37050000
IJMRU&CL1 L     IJML3&CL1,IJMJ&CL1  PUT READ COUNT IN REG 13            37100000
          LA    IJML3&CL1,1(IJML3&CL1,0)  INCREMENT BY ONE              37150000
          ST    IJML3&CL1,IJMJ&CL1  RET READ COUNT TO DTF TAB           37200000
          LM    IJML3&CL1,IJML4&CL1,IJMSV&CL1  RESTORE REG 13 & 14      37250000
          BR    IJML4&CL1  RETURN TO USER                               37300000
.F10E     ANOP                                                          37350000
*                                                                       37400000
* EXIT TO USER CORRECTION ROUTINE                                       37450000
*                                                                       37500000
        AIF ('&UB' NE 'B').F10XX                                    3-5 37550000
IJMTF&CL1 EQU  *                                                    3-5 37600000
         AGO   .F10NA                                               3-5 37650000
.F10XX   ANOP                                                       3-5 37700000
IJMTF&CL1 OI    IJMSC&CL1+1,IJMLH&CL1  TURN UNIT EXCEP0ION SWITCH ON    37750000
          AIF   ('&DT' EQ 'T').F10NA                                    37800000
          L     IJML4&CL1,IJM4&CL1     GET CCW ADDR                     37850000
         MVI   IJMUT&CL1+1,IJMLH&CL1   RESET BRANCH                3-10 37900000
          TM    0(IJML4&CL1),IJMLB&CL1 IS THE TEST BIT ON               37950000
          BZ    IJMUS&CL1              NO                               38000000
          MVI   IJMUT&CL1+1,IJML0&CL1  YES, TURN OFF BRANCH             38050000
          MVC   IJMUX&CL1,IJM2&CL1     SAVE THE STATUS BITS             38100000
.F10NA    ANOP                                                          38150000
IJMUS&CL1 L     IJML4&CL1,IJMQ&CL1     GET COREXIT ADDR                 38200000
          L     IJML3&CL1,IJMSV&CL1  RESTORE REG 13                     38250000
         AIF   ('&DT' EQ 'T').F10ND                                 3-6 38300000
         OI    IJMZZ&CL1,IJML8&CL1  SET SWITCH FOR CNTRL IN COREXIT 3-6 38350000
.F10ND   BALR  IJML4&CL1,IJML4&CL1     GO TO COR ROUT               3-6 38400000
          AIF   ('&UB' EQ 'B').F10N1                                    38450000
          AIF   ('&DT' EQ 'T').F10N                                     38500000
.F10N1    ANOP                                                          38550000
IJMUB&CL1 L    IJML3&CL1,IJM4&CL1  LOAD CCW ADDR INTO REG 13        3-1 38600000
         AIF   ('&UB' EQ 'B').F10NC                                 3-6 38650000
         NI    IJMZZ&CL1,IJMLP&CL1     RESET SWITCH                 3-6 38700000
IJMUA&CL1 B    IJMUC&CL1      DO NOT BRANCH IF HOPPER EMPTY         3-1 38750000
         OI    IJMUA&CL1+1,IJMLH&CL1    RESET BRANCH                3-1 38800000
         CLI   0(IJML3&CL1),IJMUE&CL1   Q. - IS CCW A NO-OP         3-1 38850000
         BE    IJMUC&CL1      YES, GO COMPLETE CCW CHAIN            3-1 38900000
         BAL   IJML4&CL1,IJMSB&CL1      NO, GO RETRY                3-1 38950000
         B     IJMT8&CL1      GO ERROR CHECK                        3-1 39000000
.F10NC   ANOP                                                       3-6 39050000
IJMUC&CL1  TM  4(IJML3&CL1),IJML9&CL1   IS CHAINING BIT SET ON      3-1 39100000
          AIF   ('&UB' NE 'B').F10N3                                    39150000
          BZ    IJMBD&CL1              GO PROCESS                       39200000
.F10N3    AIF   ('&UB' EQ 'B').F10N4                                3-6 39250000
          BZ    IJMRU&CL1  NO,RETURN TO USER                            39300000
.F10N4    LA    IJML3&CL1,8(IJML3&CL1)  POINT TO NEW CCB            3-6 39350000
          ST    IJML3&CL1,IJM4&CL1  PUT NEW CCW ADDR IN CCB             39400000
          AIF   ('&DT' EQ 'T').F10NB                                    39450000
IJMUT&CL1 B     IJMUV&CL1                                               39500000
          TM    IJMUX&CL1,IJML9&CL1    STATUS MODIFIER BIT ON           39550000
          BZ    IJMUU&CL1              NO                               39600000
          LA    IJML3&CL1,8(IJML3&CL1)   BUMP CCW ADDR BY 8             39650000
          ST    IJML3&CL1,IJM4&CL1     SAVE NEW CCW ADDR                39700000
IJMUU&CL1 EQU  *                                                   3-10 39750000
IJMUV&CL1 CLI   0(IJML3&CL1),IJMLC&CL1 IS CCW A TIC                     39800000
          BNE   IJMUW&CL1              NO                               39850000
          MVC   IJM4&CL1+1(3),1(IJML3&CL1)   GET NEW CCW ADDR           39900000
          L     IJML3&CL1,IJM4&CL1                                      39950000
          B     IJMUV&CL1                                               40000000
.F10NB    ANOP                                                          40050000
IJMUW&CL1 LA    1,24(1)                POINT TO ACTUAL CCB              40100000
          SVC   IJML7&CL1  EXCP                                         40150000
          TM    IJM5&CL1,IJML8&CL1   TEST TRAFFIC BIT                   40200000
          BO    *+6        NO,WAIT                                      40250000
          SVC   7     WAIT                                              40300000
          L     1,IJMS3&CL1  RESTORE REG 1                              40350000
          AIF   ('&UB' NE 'B').F10N2                                    40400000
          B     IJMBD&CL1              GO ERROR CHECK                   40450000
          AGO   .F10N6                                                  40500000
.F10N2   MVI   IJMK&CL1,IJMLI&CL1  ZERO ERROR INDICATORS            3-6 40550000
          B     IJMT8&CL1  BRANCH TO CORE RES ERR ROUTINE               40600000
          AGO   .F10D                                                   40650000
.F10N     L     IJML3&CL1,IJM4&CL1     PUT CCW ADDR OF CCB IN REG13 3-6 40700000
          LA    IJML3&CL1,8(IJML3&CL1,0)   INCREMENT BY EIGHT           40750000
          ST    IJML3&CL1,IJM4&CL1             PUT GTNL                 40800000
          ST    1,IJMS3&CL1                                             40850000
          LA    1,24(1)                                                 40900000
          SVC   IJML7&CL1              EXCP- GO TO NEXT LINE            40950000
          TM    IJM5&CL1,IJML8&CL1     TEST IF I/O COMPLETE             41000000
          BO    *+6                    YES, PUT CCW READ ADDR IN CCB    41050000
          SVC   7                      WAIT                             41100000
          L     1,IJMS3&CL1                                             41150000
          TM    IJM2&CL1,IJMLE&CL1      TEST UNIT CHECK                 41200000
          BZ    *+8                                                     41250000
          BAL   IJML4&CL1,IJMSA&CL1     BR TO CORRES ERR RECOVERY       41300000
          L     IJML3&CL1,IJM4&CL1  PUT GTNL CCW ADDR IN REG 13         41350000
          SH    IJML3&CL1,IJMEI&CL1    DECREMENT ADDR BY 8              41400000
          ST    IJML3&CL1,IJM4&CL1     PUT READ CCW ADDR BACK IN CCB    41450000
.F10N6    ANOP                                                          41500000
*                                                                       41550000
* INCREMENT TOTAL LINES READ COUNTER                                    41600000
*                                                                       41650000
IJMTG&CL1 L     IJML3&CL1,IJMJ&CL1     PUT TOTAL LINES COUNT IN REG 13  41700000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             41750000
          ST    IJML3&CL1,IJMJ&CL1     PUT BACK TOTAL LINES IN DTF TAB  41800000
          AIF   ('&UB' NE 'B').F0S                                      41850000
          L     IJML3&CL1,IJMPT&CL1    GET I/O PTR                      41900000
          SH    IJML3&CL1,IJMP2&CL1    SUBT THE REC SIZE                41950000
          EX    0,IJMW&CL1             EX INST                          42000000
          ST    IJML3&CL1,IJMPT&CL1    SAVE PTR                         42050000
          AIF   ('&UF' EQ 'U').F10N8                                    42100000
          AIF   ('&ZIWB' EQ 'W' OR '&ZIWB' EQ 'B').F8H4                 42150000
          AGO   .F8H                                                    42200000
.F10N8    AIF   ('&ZIWB' EQ 'Z').F8H1                               3-6 42250000
          AIF   ('&ZIWB' EQ 'I').F8H2Z                                  42300000
          AIF   ('&ZIWB' EQ 'W').F8H1                                   42350000
          AIF   ('&ZIWB' EQ 'B').F8H2Z                                  42400000
          AGO   .F8H                                                    42450000
.F0S      AIF   ('&ZIWB' EQ 'Z').F8H1                               3-6 42500000
          AIF   ('&ZIWB' EQ 'I').F8I                                    42550000
          AIF   ('&ZIWB' EQ 'B').F8I                                    42600000
          AIF   ('&UF' EQ 'U').F8H2                                     42650000
*                                                                       42700000
* ROUTINE FOR ONE I/O AREA AND WORK AREA                                42750000
*                                                                       42800000
         AGO   .JFK                                                 3-1 42850000
.F8H4     ANOP                                                          42900000
*                                                                       42950000
* ROUTINE FOR WORK AREA                                                 43000000
*                                                                       43050000
         LH    IJML4&CL1,IJMP2&CL1      OBTAIN                      3-1 43100000
         BCTR  IJML4&CL1,0              RECSIZE-1                   3-1 43150000
         STC   IJML4&CL1,IJMTN&CL1+1    PUT LENGTH IN MVC           3-1 43200000
.JFK      L     IJML4&CL1,IJMS4&CL1     PUT WORK AREA ADDR IN REG14 3-6 43250000
          AIF   ('&UB' EQ 'B').F8H5A                                    43300000
          L     IJML3&CL1,IJMY&CL1     PUT I/O AREA ADDR IN REG 13      43350000
          MVC   IJMTN&CL1+1(1),IJMX&CL1+3   PUT BLKS-1 IN NSI           43400000
          AGO   .F8H5B                                                  43450000
.F8H5A    L     IJML3&CL1,IJMPT&CL1    PUT I/O AREA ADDR IN REG 13  3-6 43500000
.F8H5B    ANOP                                                          43550000
IJMTN&CL1 MVC   0(0,IJML4&CL1),0(IJML3&CL1) MOVE IOAREA1 TO WORKA       43600000
          AIF   ('&UB' EQ 'B').F8H                                      43650000
          MVC   IJMTP&CL1+1(1),IJMX&CL1+3    SET LENGTH FOR NSI         43700000
IJMTP&CL1 XC    0(0,IJML3&CL1),0(IJML3&CL1)  XOR I/O AREA TO ITSELF     43750000
          ST    1,IJMS3&CL1                                             43800000
          LA    1,24(1)                                                 43850000
          SVC   IJML7&CL1              EXCP- 1 I/O-WORKA                43900000
          L     1,IJMS3&CL1                                             43950000
          AGO   .F8H                                                    44000000
.F8H2    ANOP                                                           44050000
*                                                                       44100000
* ROUTINE FOR ONE I/O AREA AND A WORK AREA - UNDEFINED FORMAT           44150000
*                                                                       44200000
          L     IJML4&CL1,IJMY&CL1      PUT HIGH ORDER ADDR IN REG 14   44250000
          LH    IJML3&CL1,IJMO&CL1+6    PUT CCW BYTE COUNT IN REG 13    44300000
IJMZC&CL1 CLI   0(IJML4&CL1),IJMLI&CL1 COMPARE TO HEX 00                44350000
          BNE   IJMZB&CL1              BRANCH IF NOT HEX 00             44400000
          LA    IJML4&CL1,1(IJML4&CL1,0)   INCREMENT BY ONE             44450000
          BCT   IJML3&CL1,IJMZC&CL1     ADVANCE UNTIL RECORD END FOUND  44500000
          EX    0,IJMV&CL1              SET UP RECSIZE REGISTER         44550000
          BCT   IJML4&CL1,IJMZM&CL1+8   SET UP I/O ADDR AND MOVE        44600000
IJMZB&CL1 TM    IJMS6&CL1,IJMLF&CL1     IS SWITCH ON                    44650000
          BZ    IJMZM&CL1               IF NOT,BR TO EXECUTE INSTR      44700000
          L     IJML3&CL1,IJMS5&CL1     LOAD RECORD LENGTH INTO REG 13  44750000
          NI    IJMS6&CL1,IJMLI&CL1     SET SWITCH OFF                  44800000
IJMZM&CL1 EX    0,IJMV&CL1                                              44850000
          SH    IJML3&CL1,IJMON&CL1     DECREMENT LENGTH BY ONE         44900000
          BM    IJMZG&CL1               BR IF ZERO REC LENGTH           44950000
          STC   IJML3&CL1,IJMZD&CL1+1  PUT LENGTH IN MOVE INST          45000000
          L     IJML3&CL1,IJMS4&CL1     PUT WORK AREA ADDR IN REG 13    45050000
IJMZD&CL1 MVC   0(0,IJML3&CL1),0(IJML4&CL1) MOVE RECORD TO H/O OF WORKA 45100000
IJMZG&CL1 L     IJML3&CL1,IJMY&CL1     GET I/O ADDR                     45150000
          MVC   IJMZA&CL1+1(1),IJMX&CL1+3 SET LENGTH FOR NSI            45200000
IJMZA&CL1 XC    0(0,IJML3&CL1),0(IJML3&CL1) X OR I/O AREA TO ITSELF     45250000
          ST    1,IJMS3&CL1            SAVE BASE                        45300000
          LA    1,24(1)                POINT TO CCB                     45350000
          SVC   IJML7&CL1              EXCP                             45400000
          L     1,IJMS3&CL1            RESTORE BASE                     45450000
          AGO   .F8H                                                    45500000
.F8H2Z    ANOP                                                          45550000
*                                                                       45600000
* SET UP RECSIZE & IOREG REGS FOR UNDEF RECFORM TWO I/O AREAS           45650000
*                                                                       45700000
          AGO   .F8H1A                                                  45750000
.F8H1     AIF   ('&UF' EQ 'F').F8H                                      45800000
*                                                                       45850000
* SET UP RECSIZE & IOREG REGS FOR UNDEF RECFORM ONE I/O AREA            45900000
*                                                                       45950000
          AIF   ('&UB' EQ 'B').F8H1A                                    46000000
          L     IJML4&CL1,IJMY&CL1     PUT HIGH ORDER ADDR IN REG 14    46050000
          LH    IJML3&CL1,IJMO&CL1+6   PUT CCW BYTE COUNT IN REG 13     46100000
          AGO   .F8H1B                                                  46150000
.F8H1A    L     IJML4&CL1,IJMPT&CL1    PUT HIGH ORDER ADDR IN R14   3-6 46200000
          LH    IJML3&CL1,IJMP2&CL1    PUT CCW BYTE COUNT IN R13        46250000
.F8H1B    ANOP                                                          46300000
IJMZE&CL1 CLI  0(IJML4&CL1),IJMLI&CL1  COMPARE TO HEX '00'              46350000
          BNE   IJMZF&CL1              BRANCH IF NOT HEX '00'           46400000
          LA    IJML4&CL1,1(IJML4&CL1,0)   INCREMENT BY ONE             46450000
          BCT   IJML3&CL1,IJMZE&CL1     ADVANCE UNTIL RECORD END FOUND  46500000
          BCTR  IJML4&CL1,IJML0&CL1     SET UP I/O ADDRESS              46550000
IJMZF&CL1 TM    IJMS6&CL1,IJMLF&CL1     IS SWITCH ON                    46600000
          BZ    IJMZN&CL1               IF NOT,BR TO EXECUTE INSTR      46650000
          L     IJML3&CL1,IJMS5&CL1     LOAD RECORD LENGTH INTO REG 13  46700000
          NI    IJMS6&CL1,IJMLI&CL1     SET SWITCH OFF                  46750000
IJMZN&CL1 EX    0,IJMV&CL1                                              46800000
          AIF   ('&ZIWB' EQ 'I' OR '&ZIWB' EQ 'Z').F8H1C                46850000
*                                                                       46900000
* ROUTINE FOR UNDEF RECFORM WITH WORK AREA                              46950000
*                                                                       47000000
          SH    IJML3&CL1,IJMON&CL1    DECREMENT LENGTH BY ONE          47050000
          BM    IJMTI&CL1              BR IF ZERO REC LENGTH            47100000
          STC   IJML3&CL1,IJMZK&CL1+1  PUT LENGTH IN MOVE INST          47150000
          L     IJML3&CL1,IJMS4&CL1    PUT WORK AREA ADDR IN REG 13     47200000
IJMZK&CL1 MVC   0(0,IJML3&CL1),0(IJML4&CL1) MOVE REC TO H/O OF WORKA    47250000
          AGO   .F8H                                                    47300000
.F8H1C    LR    IJML3&CL1,IJML4&CL1 PUT BEG. OF REC ADDR. IN REG13  3-6 47350000
          EX    0,IJMW&CL1             SET UP IOREG                     47400000
          AGO   .F8H                                                    47450000
.F8I      AIF   ('&UF' EQ 'U').F8IA                                     47500000
*                                                                       47550000
* ROUTINE FOR TWO I/O AREAS                                             47600000
*                                                                       47650000
          L     IJML3&CL1,IJMY&CL1     SWITCH I/O AREAS- IO1 IN REG 13  47700000
          L     IJML4&CL1,IJMM&CL1     IO2 IN REG 14                    47750000
          ST    IJML4&CL1,IJMY&CL1     PUT IO2 IN IO1                   47800000
          ST    IJML3&CL1,IJMM&CL1     PUT IO1 IN IO2                   47850000
          L     IJML3&CL1,IJMX&CL1     PUT BLKS-1 IN REG 13             47900000
          A     IJML3&CL1,IJMY&CL1     LOW ORDER ADDR FOR NEXT RECORD   47950000
          ST    IJML3&CL1,IJMO&CL1     CHANGE ADDR IN READ CCW          48000000
          L     IJML3&CL1,IJMY&CL1           GET I/O ADDR               48050000
          MVC   IJMTQ&CL1+1(1),IJMX&CL1+3    SET LENGTH FOR NSI         48100000
IJMTQ&CL1 XC    0(0,IJML3&CL1),0(IJML3&CL1)  XOR I/O AREA TO ITSELF     48150000
          MVI   IJMO&CL1,IJMLQ&CL1     INSERT X'0C' IN READ CCW         48200000
          ST    1,IJMS3&CL1                                             48250000
          LA    1,24(1)                                                 48300000
          SVC   IJML7&CL1              EXCP-2 I/O AREAS                 48350000
          L     1,IJMS3&CL1                                             48400000
          AIF   ('&ZIWB' NE 'I').F8J                                    48450000
          L     IJML3&CL1,IJMM&CL1     PUT START OF RECORD IN REG 13    48500000
          EX    0,IJMW&CL1             PUT START ADDR IN IOREG          48550000
          AGO   .F8H                                                    48600000
.F8J      ANOP                                                          48650000
*                                                                       48700000
* ROUTINE FOR TWO I/O AREAS AND WORK AREA                               48750000
*                                                                       48800000
          L     IJML4&CL1,IJMS4&CL1     PUT WORK AREA ADDR IN REG 14    48850000
          L     IJML3&CL1,IJMM&CL1     PUT I/O AREA ADDR IN REG 13      48900000
          MVC   IJMTO&CL1+1(1),IJMX&CL1+3   PUT BLKS-1 IN NSI           48950000
IJMTO&CL1 MVC   0(0,IJML4&CL1),0(IJML3&CL1) MOVE IOAREA TO WORKA        49000000
          AGO   .F8H                                                    49050000
.F8IA     AIF   ('&ZIWB' EQ 'B').F8IB                                   49100000
*                                                                       49150000
* ROUTINE FOR TWO I/O AREAS AND NO WORK AREA - UNDEFINED RECORDS        49200000
*                                                                       49250000
          AGO   .F8IC                                                   49300000
.F8IB     ANOP                                                          49350000
*                                                                       49400000
* ROUTINE FOR TWO I/O AREAS WITH A WORK AREA - UNDEFINED RECORDS        49450000
*                                                                       49500000
.F8IC     L     IJML3&CL1,IJMY&CL1  SWITCH I/O AREAS- IO1 IN REG 13 3-6 49550000
          L     IJML4&CL1,IJMM&CL1      IO2 IN REG 14                   49600000
          ST    IJML4&CL1,IJMY&CL1      PUT IO2 IN IO1                  49650000
          ST    IJML3&CL1,IJMM&CL1      PUT IO1 IN IO2                  49700000
          MVC   *+7(1),IJMX&CL1+3       SET UP X OR                     49750000
          XC    0(0,IJML4&CL1),0(IJML4&CL1)  BLANK OUT AREA             49800000
          A     IJML4&CL1,IJMX&CL1     BLKSIZE-1 IN REG 14              49850000
          ST    IJML4&CL1,IJMO&CL1     PUT REG 14 IN CCW                49900000
          MVI   IJMO&CL1,IJMLQ&CL1     PUT X'0C' IN CCW                 49950000
          ST    1,IJMS3&CL1                                             50000000
          LA    1,24(1)                                                 50050000
          SVC   IJML7&CL1                                               50100000
          L     1,IJMS3&CL1                                             50150000
          L     IJML4&CL1,IJMM&CL1      PUT IOAREA2 IN REG 14           50200000
          LH    IJML3&CL1,IJMO&CL1+6   PUT BLKSIZE IN REG 13            50250000
IJMZJ&CL1 CLI   0(IJML4&CL1),IJMLI&CL1  COMPARE TO HEX '00'             50300000
          BNE   IJMZK&CL1               BRANCH IF NOT HEX '00'          50350000
          LA    IJML4&CL1,1(IJML4&CL1)  INCREMENT BY ONE                50400000
          AIF   ('&ZIWB' EQ 'B').F8IQ                                   50450000
          BCT   IJML3&CL1,IJMZJ&CL1     ADVANCE UNTIL RECORD END FOUND  50500000
          BCTR  IJML4&CL1,IJML0&CL1     SET UP I/O ADDRESS              50550000
.F8IQ     AIF   ('&ZIWB' NE 'B').F8IR                                   50600000
          BCT   IJML3&CL1,IJMZJ&CL1     ADVANCE UNTIL RECORD END FOUND  50650000
          EX    0,IJMV&CL1              SET UP RECSIZE REGISTER         50700000
          BCT   IJML4&CL1,IJMZP&CL1+8   SET UP I/O ADDR AND MOVE        50750000
.F8IR     ANOP                                                          50800000
IJMZK&CL1 TM    IJMS6&CL1,IJMLF&CL1     IS SWITCH ON                    50850000
          BZ    IJMZP&CL1               IF NOT,BR TO EXECUTE INSTR      50900000
          L     IJML3&CL1,IJMS5&CL1     LOAD RECORD LENGTH INTO REG 13  50950000
          NI    IJMS6&CL1,IJMLI&CL1     SET SWITCH OFF                  51000000
IJMZP&CL1 EX    0,IJMV&CL1                                              51050000
          AIF   ('&ZIWB' EQ 'B').F8IZ                                   51100000
          LR    IJML3&CL1,IJML4&CL1     PUT BEG OF RCD IN REG 13        51150000
          EX    0,IJMW&CL1              SET UP IOREG                    51200000
          AGO   .F8H                                                    51250000
.F8IZ     SH    IJML3&CL1,IJMON&CL1     SUBTRACT ONE FROM REG 13        51300000
          BM    IJMTI&CL1               BR IF ZERO REC LENGTH           51350000
          STC   IJML3&CL1,IJMZL&CL1+1   SET UP MOVE TO WORKAREA         51400000
          L     IJML3&CL1,IJMS4&CL1     PUT WORK AREA ADDR IN REG 13    51450000
IJMZL&CL1 MVC   0(0,IJML3&CL1),0(IJML4&CL1)  MOVE RECORD TO WORKAREA    51500000
.F8H      ANOP                                                          51550000
IJMTI&CL1 LM    IJML3&CL1,IJML4&CL1,IJMSV&CL1  RESTORE REG 13 & 14      51600000
          BR    IJML4&CL1              BRANCH TO USER                   51650000
.F10D     ANOP                                                          51700000
*                                                                       51750000
* CORE RESIDENT ERROR RECOVERY ROUTINE.  HARDWARE ERRORS ARE RETURNED   51800000
* TO THE SUPERVISOR FOR RECOVERY BY SETTING USER ERROR RECOVERY BIT     51850000
* OFF (CCB BYTE 12).  ALL OTHER ERRORS ARE POSTED TO THE CCB AND        51900000
* CONTROL IS RETURNED TO MAINLINE.                                      51950000
*                                                                       52000000
         AIF   ('&DEVICE' NE '1287D').F91                           3-1 52050000
IJMSA&CL1 TM   IJM00&CL1+1,IJMBG&CL1    Q-ILLEGAL SENSE BITS        3-1 52100000
         AGO   .F92                                                 3-1 52150000
.F91     ANOP                                                       3-1 52200000
IJMSA&CL1 TM   IJM00&CL1+1,IJMLP&CL1    Q-ILLEGAL SENSE BITS        3-1 52250000
.F92     BM    IJMSB&CL1      YES, TAKE EXIT FOR RETRY              3-6 52300000
         TM    IJM2&CL1+1,IJMLC&CL1     Q-CHAN DATA CHECK           3-1 52350000
          BO    IJMSB&CL1              YES, TAKE EXIT FOR RETRY         52400000
          TM    IJM00&CL1,IJMLB&CL1    Q - EQUIPMENT CHECK              52450000
          BZ    *+8                    NO, BRANCH TO NEXT TEST          52500000
          OI    IJM1&CL1+1,IJMLB&CL1   YES, POST EQUIP CK TO CCB,HEX10  52550000
          TM    IJM00&CL1,IJMLE&CL1    Q - NON RECOVERY             3-1 52600000
          BZ    *+12                   NO, BRANCH TO NEXT TEST      3-1 52650000
          OI    IJM1&CL1+1,IJMLC&CL1   YES, POST NON RECV TO CCB,HEX3-1 52700000
         B     *+12           DO NOT TEST INTERVENTION REQ'D        3-1 52750000
          TM    IJM00&CL1,IJML9&CL1    Q - INTERVENTION REQUIRED        52800000
          BO    IJMSB&CL1              YES, TAKE EXIT FOR RETRY         52850000
          TM    IJM00&CL1,IJMLA&CL1    Q - BUS OUT CHECK                52900000
          BO    IJMSB&CL1              YES, TAKE EXIT FOR RETRY         52950000
          TM    IJM00&CL1,IJMLC&CL1    Q - DATA CHECK                   53000000
          BZ    *+8                    NO, BRANCH TO NEXT TEST          53050000
          OI    IJM1&CL1+1,IJML8&CL1   YES, POST DATA CK TO CCB,HEX80   53100000
          TM    IJM00&CL1,IJMLD&CL1    Q - OVERRUN                      53150000
          BO    IJMSB&CL1               YES, TAKE EXIT FOR RETRY        53200000
          TM    IJM00&CL1,IJML8&CL1    Q - COMMAND REJECT               53250000
          BO    IJMSB&CL1              YES, TAKE EXIT FOR RETRY         53300000
          TM    IJM2&CL1+1,IJMLF&CL1   Q - CHAINING CHECK               53350000
          BO    IJMSB&CL1              YES, TAKE EXIT FOR RETRY         53400000
          AIF   ('&DT' EQ 'T').F11A                                     53450000
          TM    IJM00&CL1+1,IJMLC&CL1  Q - ILLEGAL FONT                 53500000
          BO    IJMSB&CL1  YES,TAKE EXIT FOR RETRY                      53550000
          TM    IJM00&CL1+1,IJMLA&CL1  Q - HOPPER EMPTY                 53600000
          BZ    *+8                    NO, BRANCH TO NEXT TEST          53650000
          OI    IJM1&CL1+1,IJMLA&CL1   YES, POST HOPPER EMPTY TO CCB    53700000
          TM    IJM00&CL1+1,IJML9&CL1  TEST LATE STACKER SELECT         53750000
          BZ    *+8                    NO                               53800000
          OI    IJM1&CL1+1,IJMLE&CL1   YES, POST LATE SS TO CCB         53850000
.F11A     AIF   ('&DT' EQ 'D').F10V                                 3-6 53900000
          TM    IJM00&CL1,IJMLF&CL1    Q - KEYBOARD CORRECTION          53950000
          BZ    *+8                    NO, BRANCH TO NEXT TEST          54000000
          OI    IJM1&CL1+1,IJML9&CL1   YES, POST KB CORR TO CCB,HEX40   54050000
.F10V     TM    IJM1&CL1+1,IJMLU&CL1   Q - ANY ERROR POSTED TO CCB  3-6 54100000
          BZ    IJMSB&CL1              NO, RETRY                        54150000
          BR    IJML4&CL1              YES, RETURN CONTROL TO MAINLINE  54200000
*                                                                       54250000
* CONTROL COMES HERE WHEN (1) HARDWARE ERROR OCCURS, (2) WHEN THE       54300000
* ERROR ROUTINE WAS ENTERED BUT NO ERRORS WERE POSTED, OR (3) WHEN      54350000
* UNSUPPORTED SENSE BITS WERE ON.  CCB IS RESET FOR SUPVR ERP AND       54400000
* RETRY IS EXECUTED.                                                    54450000
*                                                                       54500000
     AIF  ('&DT' EQ 'T').F10P                                       3-5 54550000
IJMSF&CL1 OI   IJMSG&CL1+1,X'F0'       SET SWITCH TO BRANCHE        3-5 54600000
.F10P    ANOP                                                       3-5 54650000
IJMSB&CL1 EQU  *                                                   3-10 54700000
         TM    IJM00&CL1,IJML9&CL1    INTERVENTION REQUIRED    @DA10978 54750000
         BZ    IJMXX&CL1           NO LEAVE SENSE REQD ON      @DA10978 54800000
         NI    IJM6&CL1,X'FF'-IJMLA&CL1  IND SENSE NOT REQD    @DA10978 54850000
IJMXX&CL1 EQU  *                                               @DA10978 54900000
          ST    1,IJMS3&CL1            SAVE CCB POINTER, REG1           54950000
         MVC   IJMJG&CL1.(4),32(1)      SAVE CCW ADDRESS            3-8 55000000
         L     IJML3&CL1,IJM6&CL1       GET CCW ADDRESS             3-1 55050000
         SH    IJML3&CL1,IJMEI&CL1      DECREMENT CCW ADDR BY 8     3-1 55100000
     AIF  ('&DT' EQ 'T').F10Q                                       3-5 55150000
IJMSG&CL1 BC   0,IJMSH&CL1          SET TO BRANCHE BY IJMSF&CL1     3-5 55200000
         CLI   0(IJML3&CL1),IJMRM&CL1  LOAD FORMAT CCW ?            3-5 55250000
         BE    IJMSH&CL1               BRANCHE IF YES               3-5 55300000
         CLI   0(IJML3&CL1),IJMUE&CL1  NO-OP CCW ?                 3-10 55350000
         BE    IJMSH&CL1               BRANCH IF YES               3-10 55400000
         SH    IJML3&CL1,IJMEI&CL1     DECREMENT CCW ADDR BY 8      3-5 55450000
         CLI   0(IJML3&CL1),IJMRM&CL1  LOAD FORMAT CCW ?            3-5 55500000
         BE    IJMSM&CL1               BRANCHE IF YES               3-5 55550000
         OI    IJM1&CL1+1,IJMLC&CL1    POST NON REC     TO CCB      3-5 55600000
        BR    IJML4&CL1               RETURN                       3-5  55650000
IJMSM&CL1 L   1,0(IJML3&CL1)          LOAD FORMAT WORD ADDRESS @DA06515 55700000
         TM   3(1),X'2C'              IS IT GOTHIC?           @DA00765  55750000
         BO   IJMSN&CL1               BRANCH IF YES           @DA00765  55800000
         TM   3(1),IJMSP&CL1          FORMATTED READ?         @DA00765  55850000
         BO   IJMSN&CL1               BRANCH IF YES           @DA09960  55900000
         TM   3(1),IJMSR&CL1          FORMATTED TEST 2?       @DA00765  55950000
         BO   IJMSN&CL1               BRANCH IF YES           @DA09960  56000000
         TM   8(IJML3&CL1),X'0C'      10 POS MARK READ        @DA09960  56050000
         BO   IJMSN&CL1               YES                     @DA09960  56100000
          LA   IJML3&CL1,8(IJML3&CL1)  POINT TO FAILING CCW   @DA00765  56150000
IJMSN&CL1 L    1,IJMS3&CL1             RESTORE CCB TO POINTER  @DA00765 56200000
IJMSP&CL1 EQU  X'18'                   FORMATTED READ TEST 1            56250000
IJMSR&CL1 EQU  X'24'                   FORMATTED READ TEST 2            56300000
IJMSH&CL1 ST   IJML3&CL1,IJM4&CL1      PUT CCW ADDR. IN CCB         3-5 56350000
         NI    IJMSG&CL1+1,X'0F'       RESET SWITCH                 3-5 56400000
         NI    IJM00&CL1,IJMLJ&CL1     IND IRV OFF IN SENSE    @DA13161 56450000
         AGO   .F10R1                                               3-5 56500000
.F10Q    ST    IJML3&CL1,IJM4&CL1      PUT CCW ADDR. IN CCB         3-5 56550000
.F10R1   ANOP                                                  @DA06510 56600000
         LA    1,24(1)                 POINT TO REAL CCB           3-10 56650000
          SVC   IJML7&CL1              EXCP-GET RECORD                  56700000
          TM    IJM5&CL1,IJML8&CL1     TEST I/O COMPLETE                56750000
          BO    *+6                    YES, IF NO WAIT                  56800000
          SVC   7                      WAIT TIL I/O COMPLETE            56850000
          L     1,IJMS3&CL1            RESTORE OLD CCB POINTER @DA00761 56900000
          TM    27(1),X'02'            TEST FOR END OF PAGE    @DA00761 56950000
          BZ    IJLEE&CL1              NO,CONTINUE             @DA00761 57000000
          NI    135(1),X'DF'           TURN OFF EMPTY HOPPER   @DA00761 57050000
IJLEE&CL1 OI    IJM6&CL1,IJMLA&CL1     SET CCB FOR USER ERP    @DA00761 57100000
         MVC   32(4,1),IJMJG&CL1       RESTORE CCW ADDRESS          3-8 57150000
         AIF ('&UB' EQ 'B').F11DD                                   3-5 57200000
IJMSC&CL1 B     IJMSD&CL1              SKIP UNIT EXCEPTION SWITCH       57250000
          OI    IJMSC&CL1.+1,IJMLH&CL1 TURN UNIT EXCEPTION SWITCH ON    57300000
          TM    IJM2&CL1,IJMLF&CL1     TEST EOF                         57350000
          BZ    IJMSD&CL1              NO, EXIT                         57400000
          L     IJML3&CL1,IJMSV&CL1    RESTORE REG 13                   57450000
          L     IJML5&CL1,IJMN&CL1     GET EOF ADDRESS                  57500000
          BR    IJML5&CL1              BRANCH TO EOF ROUT               57550000
.F11DD   ANOP                                                       3-5 57600000
IJMSD&CL1 EQU  *                                               @DA06510 57650000
          BR   IJML4&CL1          RETURN                       @DA20855 57700000
          AIF   ('&UB' EQ 'B').F9B1                                     57750000
          AIF   ('&DT' EQ 'T').F9B                                      57800000
.F9B1     ANOP                                                          57850000
*                                                                       57900000
* START OF RETRY                                                        57950000
*                                                                       58000000
IJMRT&CL1 ST    1,IJMS3&CL1  SAVE DTF POINTER                           58050000
          L     IJML3&CL1,IJM6&CL1     GET CCW ADDR                     58100000
          SH    IJML3&CL1,IJMEI&CL1  SUB 8 FROM CCW ADDR                58150000
         AIF   ('&DEVICE' NE '1287D' AND '&RECFORM' EQ 'FIXBLK').XXX    58200000
         AIF   ('&DEVICE' NE '1287D').ZZZ                               58250000
         MVC   IJMS9&CL1,0(IJML3&CL1)   RETRIEVE CCW OP CODE            58300000
         NI    IJMS9&CL1,IJMLX&CL1     MASK OUT 4 HIGH ORDER BITS       58350000
         CLI   IJMS9&CL1,IJMLQ&CL1     Q - READ BACKWARD OPCODE         58400000
         BE    IJMCL&CL1               YES, GO CLEAR INPUT AREA         58450000
         NI    IJMS9&CL1,IJMUE&CL1     MASK OUT 6 HIGH ORDER BITS       58500000
         CLI   IJMS9&CL1,IJMLE&CL1     Q - READ FORWARD OPCODE          58550000
         AGO   .YYY                                                     58600000
.ZZZ     CLI   0(IJML3&CL1),IJMLQ&CL1   Q-READ BACKWARD OP CARD     3-6 58650000
.YYY     BE    IJMCL&CL1               YES, GO CLEAR INPUT 1R51     3-6 58700000
.XXX     ANOP                                                           58750000
IJMRX&CL1 ST   IJML3&CL1,IJM4&CL1 PUT CCW ADDR IN CCB                   58800000
          LA    1,24(1)                                                 58850000
          SVC   IJML7&CL1              EXCP-READ LINE                   58900000
          TM    IJM5&CL1,IJML8&CL1     TEST I/O COMPLETE                58950000
          BO    *+6                    YES, IF NO WAIT                  59000000
          SVC   7                      WAIT TILL I/O COMPLETE           59050000
          L     1,IJMS3&CL1             RESTORE CCB PTR                 59100000
          AIF   ('&UB' EQ 'B').F0H1                                     59150000
          B     IJMT8&CL1              GO PERFORM ERROR CHECK           59200000
          AGO   .F0I                                                    59250000
.F0H1     AIF   ('&ZIWB' EQ 'W' OR '&ZIWB' EQ 'Z').F0H              3-6 59300000
          B     IJMBD&CL1              GO ERROR CHECK                   59350000
.F0H      AIF   ('&ZIWB' EQ 'B' OR '&ZIWB' EQ 'I').F0I              3-6 59400000
          B     IJMBD&CL1              GO PERFORM ERROR CHECK           59450000
.F0I     AIF  ('&DEVICE' NE '1287D' AND '&RECFORM' EQ 'FIXBLK').F9B 3-6 59500000
IJMCL&CL1 STM  IJMLY&CL1,IJML2&CL1,IJMS8&CL1  SAVE REGS 11-12           59550000
         L     IJML2&CL1,0(IJML3&CL1)  GET INPUT AREA ADDR              59600000
         LH    IJMLY&CL1,6(IJML3&CL1)  GET COUNT                        59650000
         BCTR  IJMLY&CL1,0             GET COUNT-1                      59700000
         AIF   ('&DEVICE' NE '1287D').QQQ                               59750000
         CLI   IJMS9&CL1,IJMLE&CL1     Q - READ FORWARD OPCODE          59800000
         BE    *+6                     YES                              59850000
.QQQ     SR    IJML2&CL1,IJMLY&CL1     POINTS TO START OF IO-AREA   3-6 59900000
         STC   IJMLY&CL1,*+5           SET COUNT IN XC INST             59950000
         XC    0(0,IJML2&CL1),0(IJML2&CL1)  RESET INPUT AREA FOR RETRY  60000000
          OI    IJM6&CL1,X'20'         SET CCB FOR ERP              4-0 60050000
         LM    IJMLY&CL1,IJML2&CL1,IJMS8&CL1  RESTORE REGS 11 - 12      60100000
         B     IJMRX&CL1               RETURN                           60150000
IJMS8&CL1 DC   2F'0'                                                    60200000
.F9B      AIF   ('&ZC' NE 'C').F8EQ                                 3-6 60250000
*                                                                       60300000
* START OF CONTROL MOD                                                  60350000
*                                                                       60400000
IJMCN&CL1 TM    IJMB&CL1,IJMLA&CL1     IS CONTROL MAC SPECIFIED IN DTF  60450000
          BO    IJMCE&CL1              YES, CONTROL VALID               60500000
          SVC   IJML6&CL1              CONTROL INVALID                  60550000
IJMCE&CL1 STM   IJML3&CL1,IJML4&CL1,IJMS1&CL1  SAVE REG 13 & 14         60600000
          AIF   ('&DT' EQ 'T').F11B                                     60650000
         MVC   IJMCC&CL1.(8),IJM4&CL1  SAVE    CCWADDR IN CCB       3-6 60700000
.F11B     ST    1,IJMS3&CL1            SAVE CCB POINTER             3-6 60750000
          LA    1,24(1)                POINT TO REAL CCB                60800000
          TM    IJM5&CL1,IJML8&CL1     TEST TRAFFIC BIT                 60850000
          BO    *+6                     NO,WAIT                         60900000
          SVC   7                      WAIT                             60950000
          L     1,IJMS3&CL1                                             61000000
          AIF   ('&DT' EQ 'T').F94                                      61050000
          LA    IJML3&CL1,IJMZ&CL1                                      61100000
          AGO   .F95                                                    61150000
.F94      AIF   ('&RECFM' EQ 'UNDEF').F8BG6                         3-6 61200000
          AIF   ('&RECFM' EQ 'FIXUNB').F8BG6                            61250000
         L     IJML3&CL1,IJM4&CL1      GET ORIG EXCP   CCW ADRES        61300000
         ST    IJML3&CL1,IJMFC&CL1     SAVE FOR USE AFTER '02' EXCP     61350000
         MVC   104(8,1),0(IJML3&CL1)   MVC CCW TO CNTRL LOCATION        61400000
         STC   IJML0&CL1,IJMZ&CL1      MVI CCODE FOR CNTRL INTO CCW     61450000
         CLI   IJMZ&CL1,IJMLE&CL1      Q- READKB COMMAND CODE           61500000
         BNE   IJMSK&CL1               NO, SKIP RTN FOR ZEROING REC     61550000
         L     IJML4&CL1,IJMZ&CL1      YES, LD CCW DATA ADRES           61600000
         LH    IJML3&CL1,IJMP2&CL1     LOAD HALFWRD REC SIZE IN R13     61650000
         SH    IJML3&CL1,IJMON&CL1     SUBT 1 FROM RECSIZE              61700000
         SR    IJML4&CL1,IJML3&CL1     SUB RECSIZE-1 FROM DATA ADR      61750000
         ST    IJML4&CL1,IJMZ&CL1      STORE NEW I/O ADRES              61800000
         STC   IJML0&CL1,IJMZ&CL1      RESTORE CCODE INTO CNTRL         61850000
         SH    IJML3&CL1,IJMON&CL1     SUB 1 FROM RECSIZE FOR LNGTH     61900000
         STC   IJML3&CL1,IJMCK&CL1+1   MOVE LENGTH (RECSIZE) TO INS     61950000
IJMT7&CL1 MVI  0(IJML4&CL1),IJMLI&CL1  ZERO HIGH ORDER LOGICAL BYTE     62000000
IJMCK&CL1 MVC  1(0,IJML4&CL1),0(IJML4&CL1)  ZERO OUT LOGCL RECRD        62050000
IJMSK&CL1 MVI   IJMK&CL1,IJMLI&CL1     ZERO ERROR INDICATOR BYTE        62100000
         NI    IJMZ&CL1+4,IJMLJ&CL1    SET COMMAND CHAIN BIT OFF        62150000
         LA    IJML3&CL1,IJMZ&CL1      LD CNTRL (INTERR CCW) ADRES      62200000
         ST    IJML3&CL1,IJM4&CL1      ST CCW 02,0B ADRES FOR EXCP      62250000
         AGO   .F8BG7                                                   62300000
.F8BG6    L     IJML3&CL1,IJM4&CL1     PUT CCW ADDR IN REG 13       3-6 62350000
          LA    IJML3&CL1,16(IJML3&CL1,0)    INCREMENT                  62400000
.F95      ST    IJML3&CL1,IJM4&CL1     PUT CCW ADDR BACK INTO CCB   3-6 62450000
          AIF   ('&DT' EQ 'D').F11F                                     62500000
          L     IJML3&CL1,IJMO&CL1      PUT IOADDRESS IN REG 13         62550000
          S     IJML3&CL1,IJMX&CL1      DECREMENT BY BLOCKSIZE          62600000
          ST    IJML3&CL1,IJMZ&CL1      PUT IOADDRESS IN CNTRL CCW      62650000
.F11F     STC   IJML0&CL1,IJMZ&CL1  PUT CNTRL COMMAND CODE IN CCW   3-6 62700000
         NI    IJMZ&CL1+4,IJMLJ&CL1 SET COMMAND CHAIN BIT OFF       3-4 62750000
          AIF   ('&DT' EQ 'D').F11G                                     62800000
          CLI   IJMZ&CL1,IJMLE&CL1     IS THIS READKB COMMAND CODE      62850000
          BNE   IJMT6&CL1              NO, BRANCH                       62900000
          MVC   IJMT7&CL1+1(1),IJMX&CL1+3   YES, SET LENGTH FOR BLANK   62950000
IJMT7&CL1 XC    0(0,IJML3&CL1),0(IJML3&CL1)  BLANK I/O AREA             63000000
.F8BG7    AIF   ('&RECFM' EQ 'UNDEF').F9BG1                         3-6 63050000
          AIF   ('&RECFM' EQ 'FIXUNB').F9BG1                            63100000
         CLI   IJMZ&CL1,IJMLE&CL1      Q- RDKB COMMAND CODE             63150000
         BE    IJMT6&CL1               YES, BRANCH                      63200000
         MVI   IJMZ&CL1+7,IJMLK&CL1    MVC 10 (MEANINGLESS) TO CNT      63250000
.F9BG1   ANOP                                                           63300000
IJMT6&CL1 ST    1,IJMS3&CL1                                             63350000
.F11G     LA    1,24(1)                                             3-6 63400000
          SVC   IJML7&CL1              EXCP - CONTROL                   63450000
          TM    IJM5&CL1,IJML8&CL1     TEST I/O COMPLETE                63500000
          BO    *+6                    YES                              63550000
          SVC   7                      NO WAIT                          63600000
          L     1,IJMS3&CL1             RESTORE CCB POINTER             63650000
         MVI   IJMK&CL1,IJMLI&CL1      ZERO ERROR INDICATORS        3-6 63700000
          AIF   ('&DT' EQ 'T').MGO                                      63750000
          TM    IJM2&CL1,IJMLE&CL1  TEST UNIT CHECK                     63800000
          BZ    IJMEX&CL1  NO,RETURN TO USER                            63850000
         TM    IJM00&CL1+1,IJMLA&CL1   TEST HOPPER EMPTY           3-10 63900000
         BZ    IJMGT&CL1                                           3-10 63950000
         OI    IJMK&CL1,IJMLE&CL1      POST HOP EMPTY TO COREXIT   3-10 64000000
         B     IJM2M&CL1               GO TO COREXIT ROUTINE       3-10 64050000
IJMGT&CL1 TM   IJM00&CL1,IJML8&CL1+IJML9&CL1 COM REJECT        @DA00767 64100000
         BNZ   IJM9M&CL1                                       @DA06509 64150000
          CLI   IJMZ&CL1,IJMM1&CL1  IS THIS STACKER SELECT              64200000
          BNH   IJM1M&CL1  YES TEST LATE SS                             64250000
IJMOG&CL1 TM   IJM00&CL1,IJMLE&CL1     TEST NON REC BIT            3-10 64300000
         BO    IJMOZ&CL1               YES, BRANCH AROUND OTHERS   3-10 64350000
         TM    IJM00&CL1,IJMOY&CL1     CHECK ODD ERRORS            3-10 64400000
         BZ    IJMEX&CL1               RETURN TO USER              3-10 64450000
IJMOZ&CL1 OI   IJMK&CL1,IJMLB&CL1      SET NON REC INDICATOR       3-10 64500000
          OI    IJM1&CL1+1,IJMLC&CL1  SET NON REC IN CCB HEX 08         64550000
IJM2M&CL1 L     IJML3&CL1,IJMS1&CL1    RESTORE REG 13                   64600000
          L     IJML4&CL1,IJMQ&CL1     GET COREXIT ADDR                 64650000
         TM    IJMZZ&CL1,IJML8&CL1  CNTRL ISSUED IN COREXIT         3-6 64700000
         BO    IJMEX&CL1    YES,RETURN TO USER                      3-6 64750000
         OI    IJMZZ&CL1,IJML8&CL1  SET SWITCH FOR CNTRL IN COREXIT 3-6 64800000
          BALR  IJML4&CL1,IJML4&CL1    GO TO COR ROUT                   64850000
         NI    IJMZZ&CL1,IJMLP&CL1     RESET SWITCH                 3-6 64900000
IJMEX&CL1 LM    IJML3&CL1,IJML4&CL1,IJMS1&CL1  RESTORE REG 13 & 14      64950000
         MVC   IJM4&CL1.(8),IJMCC&CL1  RESTORE CCWADDR IN CCB       3-6 65000000
          BR    IJML4&CL1  RETURN TO USER                               65050000
IJM1M&CL1 TM    IJM00&CL1+1,IJML9&CL1  TEST LATE STACKER SELECT         65100000
         BZ    IJMOG&CL1               CHECK OTHER POSSIBILITIES   3-10 65150000
          OI    IJM1&CL1+1,IJMLE&CL1  SET LATE SS IN CCB HEX 02         65200000
          OI    IJMK&CL1,IJMLA&CL1  SET LATE SS ERR IND HEX 20          65250000
          B     IJM2M&CL1  BRANCH TO COREXIT                            65300000
IJM9M&CL1 BAL  IJML4&CL1,IJMSF&CL1     GO DO ERROR CHECK            3-5 65350000
          B     IJMEX&CL1              RETURN TO USER                   65400000
          AGO   .F8M                                                    65450000
.MGO      CLI   IJMZ&CL1,IJMLE&CL1  IS THIS READKEYB COMM. CODE     3-6 65500000
          BE    IJMT4&CL1               YES,TEST UNIT EXCEPTION         65550000
          L     IJML3&CL1,IJMI&CL1      PUT LINES MARKED IN REG 13      65600000
          LA    IJML3&CL1,1(IJML3&CL1,0) INCREMENT BY ONE               65650000
          ST    IJML3&CL1,IJMI&CL1      PUT CNT OF LINES MARKED IN DTF  65700000
          AIF   ('&RECFM' EQ 'UNDEF').F8BG9                             65750000
          AIF   ('&RECFM' EQ 'FIXUNB').F8BG9                            65800000
IJMT5&CL1 L    IJML3&CL1,IJMFC&CL1     GET SAVED CCW (0C) ADRES         65850000
         ST    IJML3&CL1,IJM4&CL1      RESORE INTERR (0C) CCW ADRES     65900000
         AGO   .F8BG3                                                   65950000
.F8BG9   ANOP                                                           66000000
IJMT5&CL1 L     IJML3&CL1,IJM4&CL1      PUT CCW ADDR IN REG 13          66050000
          SH    IJML3&CL1,IJMSI&CL1     SUBT 16 TO GET NORMAL CCW ADDR  66100000
          ST    IJML3&CL1,IJM4&CL1      PUT NORMAL CCW ADDRESS IN CCB   66150000
.F8BG3    LM    IJML3&CL1,IJML4&CL1,IJMS1&CL1  RESTORE REG 13 & 14  3-6 66200000
          BR    IJML4&CL1               EXIT TO USER                    66250000
IJMT4&CL1 TM    IJM2&CL1,IJMLF&CL1      UNIT EXCEPTION BIT ON           66300000
          BO    IJMT7&CL1              YES, READY AGAIN                 66350000
          MVI   IJMK&CL1,IJMLI&CL1      SET ERR INDICATOR BYTE TO ZERO  66400000
          TM    IJM2&CL1,IJMLE&CL1      TEST UNIT CHECK                 66450000
          BZ    IJMZQ&CL1                                               66500000
          BAL   IJML4&CL1,IJMSA&CL1     BR TO CORRES ERR RECOVERY       66550000
         TM    IJM1&CL1+1,IJMLC&CL1     NON-RECOVERY                3-2 66600000
         BZ    *+8                 NO                               3-2 66650000
         OI    IJMK&CL1,IJMLB&CL1  POST NON REC TO ERR IND BYTE     3-2 66700000
          AIF   ('&UF' EQ 'U').F8N                                      66750000
IJMZQ&CL1 TM    IJM2&CL1+1,IJML9&CL1    TEST FOR WL RECORD              66800000
          BZ    IJMZR&CL1                                               66850000
          OI    IJMK&CL1,IJMLD&CL1      SET WLR BIT ON IN ERR IND BYTE  66900000
.F8N      AIF   ('&UF' EQ 'F').F8P                                      66950000
          AIF   ('&UB' EQ 'B').F8N1                                     67000000
IJMZQ&CL1 LH    IJML4&CL1,IJMO&CL1+6    LOAD REC LENGTH INTO REG 14     67050000
          AGO   .F8N2                                                   67100000
.F8N1     ANOP                                                          67150000
IJMZQ&CL1 LH    IJML4&CL1,IJMZ&CL1+6   GET BYTE CNT                     67200000
.F8N2     SH    IJML4&CL1,IJM0&CL1      SUBTRACT RESIDUAL COUNT     3-6 67250000
          ST    IJML4&CL1,IJMS5&CL1     STORE RESULT                    67300000
          OI    IJMS6&CL1,IJMLF&CL1     SET SWITCH ON                   67350000
.F8P      ANOP                                                          67400000
IJMZR&CL1 B     IJMT5&CL1               SET UP EXIT                     67450000
          DS    0H                                                      67500000
IJMSI&CL1 DC    X'0010'                                                 67550000
.F8M      DS    0F                                                  3-6 67600000
IJMS1&CL1 DC    2F'0'                                                   67650000
.F8EQ     AIF   ('&UF' EQ 'F').F8E                                      67700000
IJMS6&CL1 DC    X'00'                                                   67750000
.F8E      AIF   ('&DT' EQ 'D').F8F                                  3-6 67800000
*                                                                       67850000
* START OF RDLNE MOD                                                    67900000
*                                                                       67950000
IJMRD&CL1 STM   IJML3&CL1,IJML4&CL1,IJMS2&CL1  SAVE REG 13 & 14         68000000
          AIF   ('&RECFM' EQ 'UNDEF').F8BG1                             68050000
          AIF   ('&RECFM' EQ 'FIXUNB').F8BG1                            68100000
         L     IJML3&CL1,IJM4&CL1      GET ORIG EXCP   CCW ADRES        68150000
         ST    IJML3&CL1,IJMFC&CL1     SAVE FOR USE AFTER '4C' EXCP     68200000
         MVC   104(8,1),0(IJML3&CL1)   MVC CCW TO CNTRL LOCATION        68250000
         MVI   IJMZ&CL1,IJMLG&CL1      MVI CCODE FOR RDBKWRD W/CORR     68300000
         L     IJML4&CL1,IJMZ&CL1      LOAD CCW DATA ADRESS IN R14      68350000
         LH    IJML3&CL1,IJMP2&CL1     LOAD HALFWRD REC SIZE IN R13     68400000
         SH    IJML3&CL1,IJMON&CL1     SUBT 1 FROM RECSIZE              68450000
         SR    IJML4&CL1,IJML3&CL1     SUB RECSIZE-1 FROM DATA ADR      68500000
         SH    IJML3&CL1,IJMON&CL1     SUB 1 FROM RECSIZE FOR LNGTH     68550000
         STC   IJML3&CL1,IJMCG&CL1+1   MOVE LENGTH (RECSIZE) TO INS     68600000
         MVI   0(IJML4&CL1),IJMLI&CL1  ZERO HIGH ORDER LOGICAL BYTE     68650000
IJMCG&CL1 MVC  1(0,IJML4&CL1),0(IJML4&CL1)  ZERO OUT LOGCL RECRD        68700000
         MVI   IJMK&CL1,IJMLI&CL1      ZERO ERROR INDICATOR BYTE        68750000
         NI    IJMZ&CL1+4,IJMLJ&CL1    SET COMMAND CHAIN BIT OFF        68800000
         LA    IJML3&CL1,IJMZ&CL1      LD CNTRL (INTERR CCW) ADRES      68850000
         ST    IJML3&CL1,IJM4&CL1      ST NEW CCW (4C) ADRES FOR EX     68900000
         AGO   .F8BG2                                                   68950000
.F8BG1    MVI   IJMO&CL1,IJMLG&CL1  MODIFY CCW TO READ BACK ON LINE 3-6 69000000
          L     IJML4&CL1,IJMO&CL1     PUT CCW DATA ADDR IN REG 14      69050000
          S     IJML4&CL1,IJMX&CL1     OBTAIN HIGH ORDER I/O ADDR       69100000
          L     IJML3&CL1,IJMX&CL1     PUT BLKS-1 IN REG 13             69150000
         BCTR  IJML3&CL1,0            INCREMENT BY ONE              3-5 69200000
          MVI   0(IJML4&CL1),IJMLI&CL1 BLANK HIGH ORDER POSITION        69250000
          EX    IJML3&CL1,IJME1&CL1    BLANK REST OF I/O AREA           69300000
          MVI   IJMK&CL1,IJMLI&CL1     ZERO ERROR INDICATOR BYTE        69350000
          NI    IJMO&CL1+4,IJMLJ&CL1   SET COMMAND CHAIN BIT OFF        69400000
.F8BG2    ST    1,IJMS3&CL1                                         3-6 69450000
          LA    1,24(1)                                                 69500000
          SVC   IJML7&CL1              EXCP-READ BACKWARD ON-LINE       69550000
          TM    IJM5&CL1,IJML8&CL1     I/O COMPLETE TEST                69600000
          BO    *+6                    NO WAIT                          69650000
          SVC   7                      WAIT                             69700000
          L     1,IJMS3&CL1                                             69750000
          TM    IJM2&CL1,IJMLE&CL1     TEST UNIT CHECK                  69800000
          BZ    *+8                                                     69850000
          BAL   IJML4&CL1,IJMSA&CL1                                     69900000
          AIF   ('&RECFM' EQ 'UNDBLK').F8BG4                            69950000
          AIF   ('&RECFM' EQ 'FIXBLK').F8BG4                            70000000
          MVI   IJMO&CL1,IJMLQ&CL1     INSERT X'0C' IN READ CCW         70050000
          OI    IJMO&CL1+4,IJML9&CL1   SET COMMAND CHAIN BIT ON         70100000
.F8BG4    TM    IJM1&CL1+1,IJMLB&CL1   IS EQUIPMENT CHECK BIT ON    3-6 70150000
          AIF   ('&UF' EQ 'F').F8A1                                     70200000
         BZ    IJMT2&CL1           NO, TEST NON-RECOVERY            3-2 70250000
          AGO   .F8A2                                                   70300000
.F8A1     BZ    IJMT1&CL1              NO, TEST WRONG LENGTH RECORD     70350000
.F8A2     OI    IJMK&CL1,IJMLC&CL1     SET EQUIP CHECK BIT ON IN ER IND 70400000
          AIF   ('&UF' EQ 'U').F8A3                                     70450000
         B     IJMT2&CL1           TEST NON-RECOVERY                3-2 70500000
IJMT1&CL1 TM    IJM2&CL1+1,IJML9&CL1   IS WLR BIT ON                    70550000
         BZ    IJMT2&CL1           NO, TEST NON-RECOVERY            3-2 70600000
          OI    IJMK&CL1,IJMLD&CL1     SET WLR BIT ON IN ER IND BYTE    70650000
.F8A3     ANOP                                                          70700000
IJMT2&CL1 TM   IJM1&CL1+1,IJMLC&CL1     NON-RECOVERY                3-2 70750000
         BZ    *+8                 NO, TEST DATA CHECK              3-2 70800000
         OI    IJMK&CL1,IJMLB&CL1  POST NON REC TO ERR IND BYTE     3-2 70850000
         TM    IJM1&CL1+1,IJML8&CL1     IS DATA CHECK BIT ON        3-2 70900000
          BZ    IJMT3&CL1              NO, EXIT                         70950000
          OI    IJMK&CL1,IJMLF&CL1     SET DATA CK BIT ON IN ER IND BYT 71000000
          L     IJML3&CL1,IJMH&CL1      PUT DATA CHECK COUNT IN REG 13  71050000
          LA    IJML3&CL1,1(IJML3&CL1,0)   INCREMENT BY ONE             71100000
          ST    IJML3&CL1,IJMH&CL1      RESTORE DATA CK IN DTF TABLE    71150000
          AIF   ('&RECFM' EQ 'UNDEF').F8BG5                             71200000
          AIF   ('&RECFM' EQ 'FIXUNB').F8BG5                            71250000
IJMT3&CL1 L    IJML3&CL1,IJMFC&CL1     GET SAVED CCW (0C) ADRES         71300000
         ST    IJML3&CL1,IJM4&CL1      RESORE INTERR (0C) CCW ADRES     71350000
         LM    IJML3&CL1,IJML4&CL1,IJMS2&CL1  RESTORE REGS 13 & 14      71400000
         AGO   .F8BG8                                                   71450000
.F8BG5   ANOP                                                           71500000
IJMT3&CL1 LM  IJML3&CL1,IJML4&CL1,IJMS2&CL1  RESTORE REG 13 & 14        71550000
.F8BG8    BR    IJML4&CL1              EXIT TO USER                 3-6 71600000
IJME1&CL1 MVC   1(0,IJML4&CL1),0(IJML4&CL1) INST TO BLANK I/O AREA      71650000
          AIF   ('&ZIWB' EQ 'I').F8F                                    71700000
          AIF   ('&ZIWB' EQ 'Z').F8F                                    71750000
IJMS4&CL1 DS    F'0'                    SAVE AREA FOR WRK AREA ADDR     71800000
.F8F      DS    0F                                                  3-6 71850000
IJMS2&CL1 DS    2F'0'                                                   71900000
IJMS3&CL1 DS    F'0'                                                    71950000
          DS    0F                                                      72000000
IJMCC&CL1 DS    F'0'         SAVE AREA FOR CCW ADDR                     72050000
         DS    F                                                   3-10 72100000
IJMJG&CL1 DS    F'0'                   SAVE AREA FOR CCW            3-8 72150000
IJMS5&CL1 DC    F'0'                                                    72200000
IJMFC&CL1 DS    F'0'         ORMOD FIELD COORD                          72250000
IJMSV&CL1 DS    2F'0'                                                   72300000
IJMON&CL1 DC    X'0001'                CONSTANT ONE                     72350000
IJMEI&CL1 DC    X'0008'                CONSTANT EIGHT                   72400000
IJMC1&CL1 DS    H'0'                   RETRY COUNT AREA FOR EQUIP CK    72450000
IJMC2&CL1 DS    H'0'                   RETRY COUNT AREA FOR WLR         72500000
IJMC3&CL1 DS    H'0'                   RETRY COUNT AREA FOR DATA CK     72550000
IJMUX&CL1 DC    H'0'                                                    72600000
          AIF   ('&UB' NE 'B').F0Z                                      72650000
IJMPT&CL1 DS    1F                                                      72700000
IJMFF&CL1 DC    1F'255'                                                 72750000
IJMRC&CL1 DC    X'0000'      RECORD COUNTER                             72800000
IJMER&CL1 DC    X'0000'      ERROR RECORD                               72850000
.F0Z     AIF   ('&DEVICE' NE '1287D').KKK                           3-6 72900000
IJMZZ&CL1 DC   XL1'00'       SWITCH FOR CNTRL IN COREXIT            3-6 72950000
IJMS9&CL1 DC   XL1'00'                                              3-1 73000000
.KKK     ANOP                                                       3-1 73050000
IJMLX&CL1 EQU X'0F'                                                 3-1 73100000
IJMLY&CL1 EQU 11                       REG 11                       3-1 73150000
IJML0&CL1 EQU   0                      REG 0                            73200000
IJML1&CL1 EQU   X'09'                  TEST CHAN DATA AND CHAIN CHECK   73250000
IJML2&CL1 EQU   12                     REG 12                           73300000
IJML3&CL1 EQU   13                     REG 13                           73350000
IJML4&CL1 EQU   14                     REG 14                           73400000
IJML5&CL1 EQU   15                     REG 15                           73450000
IJML6&CL1 EQU   50                     ABNORMAL EOJ                     73500000
IJML7&CL1 EQU   0                      EXCP                             73550000
IJML8&CL1 EQU   X'80'                  TEST TRAF BIT OR DATA CK BIT     73600000
IJML9&CL1 EQU   X'40'                  TEST WR LEN REC OR SET COM CH ON 73650000
IJMLA&CL1 EQU   X'20'                  TEST FOR CNTRL MOD               73700000
IJMLB&CL1 EQU   X'10'                  TEST EQ CK OR SET NON-REC        73750000
IJMLC&CL1 EQU   X'08'                  SET EQ CK OR TEST NON-REC        73800000
IJMLD&CL1 EQU   X'04'                  SET WR LEN REC                   73850000
IJMLE&CL1 EQU   X'02'                  TEST FOR RDLNE MOD OR READK      73900000
IJMLF&CL1 EQU   X'01'                  TEST DATA CK OR UNIT EXCEPTION   73950000
IJMLG&CL1 EQU   X'4C'                  READ BACK ON-LINE                74000000
IJMLH&CL1 EQU   X'F0'                                                   74050000
IJMLI&CL1 EQU   X'00'                  SET INDICATOR OR FLAG BYTE TO 0  74100000
IJMLJ&CL1 EQU   X'BF'                  SET CMND CH OR INTV REQ OFF      74150000
         AIF   ('&DT' EQ 'D').F0ZY                                 3-10 74200000
IJMLK&CL1 EQU  X'03'                   TEST FOR 3 RETIRES          3-10 74250000
.F0ZY    AIF   ('&DT' EQ 'T').F0ZZ                                 3-10 74300000
IJMLK&CL1 EQU  X'0A'                   TEST FOR 10 RETIRES         3-10 74350000
.F0ZZ    ANOP                                                      3-10 74400000
IJMLM&CL1 EQU   X'18'                  TEST FOR EQ CK OR NON RECOVERY   74450000
          AIF   ('&DT' EQ 'D').F0ZC                                     74500000
IJMLN&CL1 EQU   X'05'                  TEST FOR 5 RETRIES               74550000
.F0ZC     AIF   ('&DT' EQ 'T').F0ZD                                 3-6 74600000
IJMLN&CL1 EQU   X'03'                  TEST FOR 3 RETRIES               74650000
.F0ZD     ANOP                                                          74700000
IJMLO&CL1 EQU   X'D4'                                                   74750000
IJMLP&CL1 EQU   X'7F'                  AND FIRST TIME SWITCH            74800000
IJMLQ&CL1 EQU   X'0C'                                                   74850000
IJMLR&CL1 EQU   X'2C'         READ BACKWARD AND ALLOW DATA CHECK        74900000
IJMLU&CL1 EQU   X'FA'                                                   74950000
IJMLV&CL1 EQU   X'6C'                  RD BK + ALLOW DATA CK + FORCE    75000000
         AIF   ('&DT' EQ 'D').F0ZW                                 3-10 75050000
IJMLZ&CL1 EQU  X'05'                   TEST FOR 5 RETIRES          3-10 75100000
.F0ZW    AIF   ('&DT' EQ 'T').F0ZX                                 3-10 75150000
IJMLZ&CL1 EQU  X'03'                   TEST FOR 3 RETRIES          3-10 75200000
.F0ZX    ANOP                                                      3-10 75250000
IJMSX&CL1 EQU   X'FF'                                                   75300000
IJMSY&CL1 EQU   X'DF'                                                   75350000
IJMSZ&CL1 EQU   X'FE'                                                   75400000
IJMSW&CL1 EQU   X'D8'                                                   75450000
IJMM1&CL1 EQU   X'3B'  TEST STACKER SELECT                              75500000
IJMBG&CL1 EQU   X'07'                                                   75550000
IJMRM&CL1 EQU   X'53'        TEST FOR LOAD FORMAT CCW                   75600000
IJMLT&CL1 EQU   X'49'                                                   75650000
IJMDV&CL1 EQU   X'77'        1287 DEVICE TYPE                           75700000
IJMUE&CL1 EQU   X'03'                  TEST UNIT CHECK + EXCEP          75750000
IJMOY&CL1 EQU  X'34'                                               3-10 75800000
          AIF   (T'&SEPASMB NE 'O').F8K                                 75850000
&SYSECT   CSECT                                                         75900000
.F8K      MEND                                                          75950000
