          MACRO                                                         00050000
&MSGNM    USSMSG  &TEXT=,&MSG=,&ROUTCDE=,&DESC=,                       X00100000
               &SUPP=,&OPT=,&BUFFER=,&MCSFLAG=,                        X00126800
               &MSGLVL=                                       @KFA @T3C 00153700
.********************* START OF SPECIFICATIONS *********************    00180600
.*                                                                      00211200
.* MACRO NAME(S): USSMSG                                                00241800
.*                                                                      00272400
.* DESCRIPTIVE NAME: USS and VTAM operator message macro.               00303000
.*                                                                      00333600
.* STATUS: ACF/VTAM VERSION 4 RELEASE 2                                 00364200
.*                                                                      00394800
.* COPYRIGHT:  LICENSED MATERIALS - PROPERTY OF IBM                     00425400
.*                                                                      00456000
.*             THIS PRODUCT CONTAINS "RESTRICTED MATERIALS OF IBM"      00466200
.*                                                                      00476400
.*             5686-065 (C) COPYRIGHT IBM CORP. 1984, 1994.             00477400
.*             ALL RIGHTS RESERVED.                                     00478400
.*                                                                      00479400
.*             U.S. GOVERNMENT USERS RESTRICTED RIGHTS -                00480400
.*             USE, DUPLICATION OR DISCLOSURE RESTRICTED BY             00481400
.*             GSA ADP SCHEDULE CONTRACT WITH IBM CORP.                 00482400
.*                                                                      00483400
.*             SEE COPYRIGHT INSTRUCTIONS.                              00484400
.*                                                                      00485400
.* MACRO USER'S GUIDE:                                                  00486600
.*                                                                      00517200
.*    FUNCTION: Define a message to be entered into a table of USS      00547800
.*              and VTAM operator messages.                             00578400
.*                                                                      00609000
.*    MACRO FORMAT:                                                     00639600
.*                                                                      00670200
.*       <label> USSMSG MSG=n | (n1,n2,...)                             00700800
.*                     <,BUFFER=(buffer address,LUNAME)|buffer address> 00731400
.*                     <,BUFFER=(buffer address,SCAN)|buffer address>   00746700
.*                     <,DESC=(desc code)>                              00762000
.*                     <,MSGLVL=BASE | START | V4R1 | V4R2>        @U2C 00777300
.*                     <,MCSFLAG=(value)>                               00792600
.*                     <,OPT=BLKSUP | NOBLKSUP>                         00823200
.*                     <,ROUTCDE=(route code)>                          00853800
.*                     <,SUPP=ALWAYS | INFO | NEVER | NORM | SER |      00884400
.*                            WARN>                                     00915000
.*                     <,TEXT='message text'>                           00945600
.*                                                                      00976200
.*    DESCRIPTION OF OPERANDS:                                          01006800
.*                                                                      01037400
.*       label          Optional label associated with the macro        01068000
.*                      invocation statement.  It has no meaning and is 01098600
.*                      ignored by VTAM.                                01129200
.*                                                                      01159800
.*       BUFFER         Specified the address (name) of an area of      01190400
.*                      storage defined to contain the USS message      01221000
.*                      text, device control characters, as well as     01251600
.*                      a header indicating the length of the buffer.   01282200
.*                                                                      01312800
.*                      BUFFER is only valid for USS messages that      01315700
.*                      are sent to a terminal user (logical unit).     01318600
.*                      BUFFER and TEXT are mutually exclusive.         01321500
.*                                                                      01324700
.*                      If any of the following strings appear in the   01325500
.*                      buffer, they will be substituted as follows     01326300
.*                      for an LU with a name of LU1 in network NETA    01326900
.*                      on Febuary 25, 1990 at 12:30 pm.                01327500
.*                                                                      01328100
.*                          @@LUNAME          -->  LU1                  01328600
.*                          @@@@DATE          -->  02/25/90             01328700
.*                          @@@@TIME          -->  12:30:00             01328800
.*                          @@NETIDN          -->  NETA                 01329100
.*                          @@NETWORKIDLUNAME -->  NETA.LU1             01329600
.*                                                                      01330100
.*                  *** NOTE - The DATE is put in a form according      01330300
.*                      to the VTAM DATEFORM start option, and the      01330500
.*                      time is a 24-hour clock.                        01330700
.*                                                                      01330900
.*                  *** NOTE - If there is a scan, the entire string    01331100
.*                      will be searched.  The search keys on the '@'   01331500
.*                      character, so extensive use of this character   01333200
.*                      in an LUNAME string could affect performance.   01334900
.*                      Also, if the substituted name is less than      01336600
.*                      eight characters the extra blanks are NOT       01338300
.*                      suppressed.                                     01340000
.*                                                                      01341700
.*                      If this parameter is specified, the DESC,       01343400
.*                      MCSFLAG, OPT, ROUTCDE, SUPP, and TEXT           01374000
.*                      parameters will be ignored.                     01419900
.*                                                                      01465800
.*                      The format of the buffer is shown below:        01496400
.*                                                                      01527000
.*                      +-------------------------------------+         01557600
.*                      | message length(L) |   message text  |         01588200
.*                      +-------------------------------------+         01618800
.*                      |<-----2 bytes----->|<----L bytes---->|         01649400
.*                                                                      01680000
.*                      The message will be output exactly as it        01710600
.*                      appears in the buffer.                          01741200
.*                                                                      01771800
.*       DESC           A descriptor code is one or more decimal        01802400
.*                      numbers from 1 to 16 separated by commas.       01833000
.*                      Descriptor codes describe the kind of message   01863600
.*                      being issued.  See the "Messages and Codes"     01894200
.*                      manual for a description of these codes.        01924800
.*                      Parentheses are not required if a single value  01955400
.*                      is coded.                                       01986000
.*                                                                      02016600
.*                      If this parameter is omitted or specified with  02047200
.*                      a null value, VTAM uses the DESC value          02077800
.*                      specified for this message ID in the next       02108400
.*                      USS table searched.                             02139000
.*                                                                      02146600
.*       MSGLVL         Specifies the level of the VTAM message to be   02147200
.*                      issued. Allowable values are:                   02147800
.*                         BASE - Issue the oldest version of this      02148400
.*                                message.                              02149000
.*                        START - Obtain the value of MSGLVL from       02149600
.*                                the MSGLVL start option.  This is     02150200
.*                                the default for this USSMSG operand.  02150800
.*                         V4R1 - Issue the V4R1 level of the message.  02151400
.*                         V4R2 - Issue the V4R2 level of the message.  02151600
.*                                                                 @U2A 02151800
.*                                                                      02152200
.*                      Note that the SOURCE for the IBM supplied       02153000
.*                      operation-level USS table has MSGLVL=START      02153800
.*                      coded only for those messages that support      02154600
.*                      MSGLVL.  Change the value of MSGLVL for         02155400
.*                      each message that you wish to be replaced with  02156200
.*                      a previous level of that message.               02157000
.*                                                                      02157800
.*                      If this parameter is omitted or specified with  02158600
.*                      a null value, VTAM uses the MSGLVL value        02159400
.*                      specified for this message ID in the next       02160200
.*                      USS table searched.                        @KFA 02161000
.*                                                                      02161800
.*                                                                      02169600
.*       MCSFLAG        Specifies the Multiple Console Support flags to 02200200
.*                      be used for this message.  This operand has the 02230800
.*                      same meaning as the MCSFLAG parameter of the    02261400
.*                      WTO and WTOR macros.                            02292000
.*                                                                      02322600
.*                      VTAM will ignore the MCSFLAG value for messages 02353200
.*                      destined for a Program Operator Application.    02383800
.*                                                                      02414400
.*                      If this parameter is omitted or specified as a  02445000
.*                      null value, VTAM uses the MCSFLAG value         02475600
.*                      specified for this message ID in the next       02506200
.*                      USS table searched.                             02536800
.*                                                                      02567400
.*       MSG            "n | (n1,n2,...)" is the number(s) of the       02598000
.*                      message(s) and may be specified in either the   02628600
.*                      VTAM operator format (ISTNNNT or ISTNNNNT,      02659200
.*                      where N represents a decimal digit and T        02689800
.*                      represents the type of message) or the USS      02720400
.*                      format (1 to 3 numerical digits).               02751000
.*                                                                      02781600
.*                      Only one number can be specified (code a single 02812200
.*                      value) or more than one number can be specified 02842800
.*                      (enclose the list of numbers in parentheses).   02873400
.*                      Either one or both of the formats may be        02904000
.*                      specified on the same statement, and the        02934600
.*                      generated code will be the same regardless of   02965200
.*                      the system on which it is assembled.            02995800
.*                                                                      03026400
.*                      The MSG operand is required.                    03046800
.*                                                                      03067200
.*                                                                      03087600
.*       OPT            OPT specifies whether extraneous blanks are to  03118200
.*                      be suppressed (OPT=BLKSUP) or not suppressed    03148800
.*                      (OPT=NOBLKSUP).  If OPT=BLKSUP is specified,    03179400
.*                      then anytime 2 or more consecutive blank spaces 03210000
.*                      appear in the message text, it is converted     03240600
.*                      into 1 blank space.  BLKSUP should not be used  03271200
.*                      for a tabular display.                          03301800
.*                                                                      03332400
.*                      If this parameter is omitted or is specified    03363000
.*                      as a null value, VTAM uses the OPT value        03393600
.*                      specified for this message ID in the next USS   03424200
.*                      table searched.                                 03474200
.*                                                                      03546600
.*       ROUTCDE        Routing code is one or more decimal numbers     03577200
.*                      from 1 to 16 separated by commas.  This         03607800
.*                      parameter specifies what device the message is  03638400
.*                      routed to.  Parentheses are not required if a   03669000
.*                      single value is coded.                          03699600
.*                                                                      03730200
.*                      If this parameter is omitted or specified as a  03760800
.*                      null value, VTAM uses the ROUTCDE value         03791400
.*                      specified for this message ID in the next       03822000
.*                      USS table searched.                             03852600
.*                                                                      03883200
.*                      See the "VTAM Resource Definition Reference"    03913800
.*                      for more information about this parameter.      03944400
.*                                                                      03975000
.*       SUPP           Relates the message to a class of messages      04005600
.*                      which the operator may choose to suppress.      04036200
.*                      The message suppression class for a message,    04066800
.*                      along with the SUPP start option and the        04097400
.*                      MODIFY SUPP command, determines whether a       04128000
.*                      specific message will be suppressed by VTAM.    04158600
.*                                                                      04189200
.*                      For VTAM operator messages, the potential       04219800
.*                      values for this parameter and their             04250400
.*                      meanings are:                                   04281000
.*                                                                      04311600
.*                        ALWAYS - Regardless of what level of message  04342200
.*                                 suppression is in effect, this       04372800
.*                                 message is to always to be           04403400
.*                                 suppressed.  In effect, this message 04434000
.*                                 is never output.                     04464600
.*                                                                      04495200
.*                        INFO - Specifies that this message is to be   04525800
.*                               regarded as an "informational"         04556400
.*                               class message.                         04587000
.*                                                                      04617600
.*                        NEVER - Regardless of what level of message   04648200
.*                                suppression is in effect, this        04678800
.*                                message is never to be suppressed.    04709400
.*                                In effect, this message is always     04740000
.*                                output.                               04770600
.*                                                                      04801200
.*                        NORM - Specifies that this message is to be   04831800
.*                               regarded as a "normal" class message.  04862400
.*                                                                      04893000
.*                        SER - Specifies that this message belongs to  04923600
.*                              the "serious" class of messages.        04954200
.*                                                                      04984800
.*                        WARN - Specifies that this message belongs    05015400
.*                               to the "warning" class of messages.    05046000
.*                                                                      05076600
.*                      For USS messages, the potential values for      05107200
.*                      this parameter and their meanings are:          05137800
.*                                                                      05168400
.*                        ALWAYS - Specifies that this message is       05199000
.*                                 always to be suppressed, no matter   05229600
.*                                 what level of message suppression is 05260200
.*                                 in effect.                           05290800
.*                                                                      05321400
.*                        NEVER - Specifies that this message is to     05352000
.*                                never be suppressed.                  05382600
.*                                                                      05413200
.*                      For VTAM operator messages, if this parameter   05432300
.*                      is omitted or specified as a null value, then   05451400
.*                      VTAM uses the SUPP value specified for this     05470500
.*                      message ID in the next USS table searched.      05489600
.*                      For USS messages (USSMSG00-USSMSG14), if this   05508700
.*                      parameter is omitted or specified as a null     05527800
.*                      value, then VTAM will use NEVER as the default. 05546900
.*                                                                      05566200
.*                      NOTE: You cannot suppress individual messages   05596800
.*                            in a Multi Line Write to Operator         05627400
.*                            (MLWTO) message.                          05658000
.*                                                                      05688600
.*       TEXT           Where "message text" consists of one or more    05719200
.*                      parts, each of which is in a valid format for   05749800
.*                      the operand of an assembler DC statement.  A    05780400
.*                      special case is that a character string need    05811000
.*                      not use the "C" type code or parentheses when   05841600
.*                      it is the only value of text.                   05872200
.*                                                                      05902800
.*                      TEXT and BUFFER are mutually exclusive.         05904800
.*                                                                      05906800
.*                                                                      05908800
.*   *** NOTE: A VTAM operator message definition MUST include these    05910800
.*       operands: TEXT, ROUTCDE, DESC, SUPP and OPT.  If any of these  05912800
.*       is omitted (not coded in any USS table searched), VTAM         05914800
.*       will issue IST988E (VTAM MESSAGE %%%%% ISSUED BUT DOES NOT     05916800
.*       EXIST) in its place.                                           05918800
.*       Since the IBM supplied operation-level USS table (ISTINCNO)    05920800
.*       codes all of these operands for each message, and ISTINCNO     05922800
.*       is always searched, you are not required to code all of these  05924800
.*       operands.  Only code those operands which you wish to change   05926800
.*       (define differently than coded in ISTINCNO).                   05928800
.*                                                                      05930800
.*       Additional information on all the above parameters can be      05933400
.*       located in the "VTAM Resource Definition Reference".           05964000
.*                                                                      05994600
.*    CODING EXAMPLES:                                                  06025200
.*                                                                      06055800
.*       (1) Define the VTAM operator message "IST001I VTAM START       06086400
.*           REJECTED - <variable text>" in the USS table.  The message 06117000
.*           ID is IST001I.  The routing code is 2 and the descriptor   06147600
.*           code is 5.  This message is never to be suppressed.  Extra 06178200
.*           blank spaces are to be suppressed.                         06208800
.*                                                                      06239400
.*           LABEL1    USSMSG MSG=IST001I,                              06270000
.*                            TEXT='IST001I VTAM START REJECTED - %',   06300600
.*                            ROUTCDE=2,DESC=5,SUPP=NEVER,OPT=BLKSUP    06331200
.*                                                                      06361800
.*       (2) Enter into the USS table a message contained in a buffer   06392400
.*           whose address is specified in the field name "buffadd" and 06423000
.*           message ID is given by "nn".                               06453600
.*                                                                      06484200
.*           LABEL2    USSMSG MSG=nn,BUFFER=buffadd                     06514800
.*                                                                      06545400
.*       (3) Enter into the USS table a message contained in a buffer   06549200
.*           whose address is specified in the field name "buffadd" and 06553000
.*           message ID is given by "nn".  The buffer string            06556800
.*           has @@LUNAME coded in it for replacement.                  06560600
.*                                                                      06564400
.*           LABEL3    USSMSG MSG=nn,BUFFER=(buffadd,LUNAME)            06568200
.*                                                                      06572000
.*    RESTRICTIONS / DEPENDENCIES: If BUFFER is coded, none of the      06576000
.*                                 other optional keywords may be       06606600
.*                                 coded.                               06637200
.*                                                                      06667800
.*    OUTPUT: An entry is made in the USS table defining a USS or VTAM  06698400
.*            message.                                                  06729000
.*                                                                      06759600
.*    NOTES: For a DOS system or for a message destined to a program    06790200
.*           operator application, the ROUTCDE, DESC, and MCSFLAG       06820800
.*           keywords may be coded, but they have no meaning.           06851400
.*                                                                      06882000
.*                                                                      08317600
.* CHANGE ACTIVITY:                                                     08320200
.*                                                                      08350800
.*    DATE UNKNOWN - Added BUFFER= keyword D4516.00.                    08381400
.*    11/19/80 - VERSION 2             D4772.01.                        08412000
.*    02/02/81 - PTM P008756.                                           08442600
.*    04/21/83 - PTM P012789.                                           08473200
.*    04/26/83 - PTM P012827.                                           08503800
.*    08/08/83 - APAR 0Z72880.                                          08534400
.*    12/12/84 - PTM P020870 for APAR DY32293.                          08565000
.*    08/13/87 - APAR DY36919 GENERATE 2 DCS FOR LONG TEXT.             08580300
.*    01/26/88 - CORRECTED PROBLEM WITH USSMSG                @P053280  08587900
.*    02/10/88 - CORRECTED LAST DIGIT AND BUFFER PROBLEM      @P053496  08591700
.*                                                                      08595600
.*                                                                      08692700
.* $MAC(USSMSG),COMP(USER),PROD(VTAM): USS and VTAM operator            08694000
.*                                    message macro.                    08695300
.*                                                                      08696600
.* FLAG REASON   RELEASE DATE   ORIGIN  FLAG DESCRIPTORS                08697500
.* ---- -------- ------- ------ ------  ---------------------------     08698400
.* $R1= R0@USCLD HVT3202 871211 151508: USS Table Update                08699300
.* $R2= P054604  HVT3202 880418 699466: Correct DOS literal problem     08700200
.* $R3= P055566  HVT3202 880418 699466: Added copyright information     08701100
.* $01= OY17295  VSE3204 881020 042852: Correct ASSEMBLY error caused   08702000
.*                                      by text being inserted as a     08702900
.*                                      label.                          08703800
.* $02= OY19144  HVT3205 881227 391074: Allow BUFFER=/FORMAT=V3R2       08704700
.* $F1= F4M@@CLD HVT3303 890209 042852: Allow 4-digit messages          08705600
.* $R6= P067206  HVT3303 890320 042852: Correct MSGNM label             08706500
.* $Q1= P069993  HVT3303 890606 042852: Do not repeat MSGNM label for   08707400
.*                                      multiple message IDs            08708300
.* $Q2= P070078  HVT3303 890622 087112: FORMAT=DYNAMIC                  08709200
.* $03= DY38477  HVT3303 890727 013298: Correct Assembly error with     08710100
.*                                      BUFFER=                         08711000
.* $04= OY20557  HVT3303 890727 013298: Allow 1 item sublist for TEXT   08711900
.* $05= OY18119  HVT3303 890731 087112: Hot POI - descriptor code 11    08712800
.* $S1= P073229  HVT3300 890906 510701: Fix BUFFER compile in VM        08713700
.* $BB= ACC@@AMS HVT3401 891025 615520: PL/AS CONVERSION                08714600
.* $06= OY24252  HVT3303 891129 042852: Allow LUNAME on buffer          08716400
.* $07= OY27904  VM330   900122 042852: Correct Assembly error with     08717300
.*                                      label and BUFFER=               08718200
.* $P1= P078126  VSE3300 900124 551204: Usability suggestion BADFMT     08719100
.* $B1= A3@@@CLD HVT3401 900517 385097: National Language Support       08720000
.* $V2= P089486  HVT3401 901023 182401: Remove USS 15 message           08720900
.* $08= DY39963  HVT3401 910107 810410: CORRECT LUNAME MNOTE            08721800
.* $09= DY40363  HVT3401 910717 001569: Limit TEXT length to 251        08722100
.* $KF= JN@@@CLD NQNAME1 910521 450526: Enhanced NQN Support            08722300
.* $0A= OY45276  VM340   910731 001569: User label not on fullword      08722500
.*                                      boundary                        08722600
.* $KG= P097748  HVT4100 910820 553624: SCAN added to BUFFER=           08722700
.* $T1= P099357  NQNAME1 911212 591683: Invalid Assemble message        08722800
.* $T2= P099516  NQNAME1 920128 450526: Add MSGLEVEL start option       08723500
.* $T3= P107082  NQNAME1 930129 349129: Change MSGLEVEL to MSGLVL       08723800
.* $U2= P109662  DLS     930722 590147: MSGLVL support for V4R2         08724000
.* $U3= P106973  EMERALD 931005 699466: Remove ISTGL30 reference        08724100
.* $Z1= P111582  VSE/ESA 931109 544872: Change high order bit setting   08724400
.********************** END OF SPECIFICATIONS **********************    08724700
.*000000-999999                                               @R506400  08725000
            GBLA  &FMT             CURRENT USS VERSION           @R1A   08731200
            GBLA  &TMSG            CURRENT MESSAGE               @R1A   08737400
            GBLA  &NMSG            NEXT MESSAGE                  @R1A   08743600
            GBLB  &Z               1=USSTAB SPECIFIED                   08750000
            GBLB  &ONE(2000)       ONE ENTRY/VTAM MESSAGE(0-1999)@F1A   08800000
            GBLC  &USSMG(15)       ONE ENTRY/USS MESSAGE (0-14)         08833300
.*                                                     @03A @B1A @V2C   08866600
            GBLB  &YESUSS          1=USS MESSAGES FOUND                 08900000
            GBLB  &YESVTAM         1=VTAM MESSAGES FOUND                08950000
            LCLA  &DIG123A         3 CHARACTERS OF MESSAGE ID           09000000
            LCLA  &G               TEMPORARY VARIABLE                   09025000
            LCLA  &I               TEMPORARY VARIABLE                   09050000
            LCLA  &K               TEMPORARY VARIABLE                   09100000
            LCLA  &MSGNUM          MESSAGE # POSITION IN MSG KEYWORD    09150000
            LCLA  &TXTNUM          FIELD # POSITION IN TEXT KEYWORD     09200000
            LCLA  &INDEX           INDEX VARIABLE                       09250000
            LCLA  &NUM             TEMPORARY VARIABLE                   09300000
            LCLB  &RTG(16)         1=CORRESPONDING ROUTING CODE FOUND   09350000
            LCLB  &DSCDSP(11)      1=CORRESPONDING DESCR CODE FOUND     09400000
            LCLB  &MCS(8)          MCSFLAG BITS                         09450000
            LCLB  &MFLAG           1=MCS FLAGS PRESENT                  09500000
            LCLB  &SUP(4)          ONE BIT/SUPPRESSION LEVEL            09550000
            LCLB  &BLKSUP          1= OPT=NOBLKSUP SPECIFIED            09600000
            LCLB  &MSGTYPE         0=PROCESSING USS MESSAGE (0-14)      09650000
            LCLB  &YESDESC         1=DESC KEYWORD CODED                 09700000
            LCLB  &YESOPT          1=OPT KEYWORD CODED                  09750000
            LCLB  &YESROUT         1=ROUTCDE KEYWORD CODED              09800000
            LCLB  &YESSUPP         1=SUPP KEYWORD CODED                 09850000
            LCLB  &YESTXT          1=TEXT KEYWORD CODED                 09900000
            LCLB  &YESBUFF         1=BUFFER KEYWORD CODED               09950000
            LCLB  &YESSCAN         1=SCAN KEYWORD CODED     @06A  @KGC  09962500
            LCLB  &YESISS          1=ISSUOLD KEYWORD CODED        @KFA  09968700
            LCLB  &DIG4            1=MESSAGE HAS 4-DIGIT ID       @F1A  09975000
            LCLC  &DIG123C         3 CHARACTERS OF MESSAGE ID           10000000
            LCLC  &LASTDIG         LAST CHARACTER IN MESSAGE ID         10050000
            LCLC  &MSG1            ABBREVIATED FOR OF MSG VALUE         10100000
            LCLC  &MSGOLD          MSG VALUE IN FORMAT=OLD SEARCH @R1A  10108300
            LCLC  &MLEVEL          MSGLVL VALUE              @T2A @T3C  10112400
            LCLC  &GEN1            TEMPORARY VARIABLE                   10116600
            LCLC  &GEN2            TEMPORARY VARIABLE                   10133200
            LCLC  &TXT1            VARIABLE TEXT PART 1           @01A  10138800
            LCLC  &TXT2            VARIABLE TEXT PART 2           @01A  10144400
.********************************************************************** 10150000
.*          VERIFY THAT USSTAB MACRO WAS CODED                        * 10200000
.********************************************************************** 10250000
            AIF   (&Z NE 1).BADTAB                                      10300000
.********************************************************************** 10350000
.*          VALIDATE THE REQUIRED MSG KEYWORD BY PERFORMING THE       * 10400000
.*          FOLLOWING CHECKS:                                         * 10450000
.********************************************************************** 10750000
            AIF   ('&MSG' EQ '').NOMSG        ERROR-MSG IS REQUIRED     10850000
&DIG4       SETB  0                           SET DIGIT FLAG      @F1A  10875000
&MSGNUM     SETA  1                                               @R1C  10900000
&I          SETA  K'&MSG(&MSGNUM)             # DIGITS IN MSGID   @R1C  10941600
            AIF   (&I EQ 7).DIG3MSG           3-DIGIT VTAM MSG    @F1C  10983200
            AIF   (&I EQ 8).DIG4MSG           4-DIGIT VTAM MSG    @F1A  11024800
&MSGTYPE    SETB  0                           MUST BE USS MESSAGE @R1A  11066400
&GEN1       SETC  '&MSG(&MSGNUM)'                                       11108000
            AGO   .CHKMSG                                         @R1A  11150000
.DIG3MSG    ANOP                                                  @F1A  11157100
&GEN1       SETC  '&MSG(&MSGNUM)'(4,3)                                  11164200
            AGO   .VTAMMSG                                              11171300
.DIG4MSG    ANOP                                                  @F1A  11178400
            AIF   (&FMT EQ 0).BADFMT          INVALID LENGTH      @P1A  11181900
&DIG4       SETB  1                           4-DIGIT MESSAGE     @F1A  11185500
&GEN1       SETC  '&MSG(&MSGNUM)'(4,4)                            @F1A  11192600
.VTAMMSG    ANOP                                                  @R1A  11200000
&MSGTYPE    SETB  1                           ASSUME VTAM MESSAGE @R1A  11250000
.CHKMSG     ANOP                                                  @R1A  11350000
.********************************************************************** 12600000
.*          VALIDATE THE TEXT KEYWORD.                                * 12650000
.*                                                                    * 12700000
.*          BUFFER IS VALID ONLY FOR USS MESSAGES.                    * 12750000
.********************************************************************** 12800000
.CHKTXT     ANOP                                                        12850000
            AIF     ('&TEXT' EQ '').NOTXT       TEXT IS MISSING         12900000
            AIF     ('&BUFFER(1)' NE '').BADBUFF BUFFER CANNOT BE @06C  12933300
.*                                              SPECIFIED W/TEXT        12966600
&YESTXT     SETB    1                           TEXT WAS CODED          13000000
            AGO     .CHKROUT                    CHECK ROUTCDE VALUE     13050000
.NOTXT      ANOP                                                        13100000
            AIF     ('&BUFFER(1)' EQ '').CHKROUT BUFFER NOT CODED @06C  13150000
            AIF     ('&MSGTYPE' EQ '1').BADBUF2 BUF ON VTAMSG     @02A  13175000
&YESBUFF    SETB    1                           BUFFER WAS CODED        13200000
            AIF     ('&BUFFER(2)' EQ '').CHKROUT NO LUNAME ON BUF @06A  13212500
            AIF     ('&BUFFER(2)' EQ 'LUNAME').YESLUNM                  13220000
            AIF     ('&BUFFER(2)' NE 'SCAN').BADLUNM                    13227500
.YESLUNM    ANOP                                                        13235000
&YESSCAN    SETB    1                    SCAN SPECIFIED      @06A @KGC  13242500
.********************************************************************** 13250000
.*       VALIDATE THE ROUTCDE KEYWORD AS FOLLOWS:                     * 13300000
.*          1. IGNORED IF BUFFER ALSO SPECIFIED                       * 13350000
.*          2. IGNORED FOR USS MESSAGES                               * 13400000
.*          3. INVALID IF NOT 1-16                                    * 13450000
.********************************************************************** 13500000
.CHKROUT    ANOP                                                        13550000
            AIF     ('&ROUTCDE' EQ '').CHKDESC  ROUTCDE OMITTED         13600000
            AIF     ('&BUFFER(1)' NE '').CHKDESC BUFFER NOT CODED @06C  13650000
.SKPROUT    ANOP                                                        13750000
            AIF     (&MSGTYPE EQ 0).CHKDESC     IGNORE ROUTCDE FOR USS  13800000
&YESROUT    SETB    1                           1=ROUTCDE SPECIFIED     13950000
&NUM        SETA    N'&ROUTCDE                  # VALUES IN ROUTCDE     14000000
.ROUTLOP    ANOP                                                        14050000
&INDEX      SETA    &ROUTCDE(&NUM)              SINGLE VALUE IN ROUTCDE 14100000
            AIF     ('&INDEX' LT '1').BADROUT   ROUTCDE < 1             14150000
            AIF     ('&INDEX' GT '16').BADROUT  ROUTCDE > 16            14200000
&RTG(&INDEX) SETB 1                                                     14250000
            AIF     ('&NUM' EQ '1').CHKDESC     ALL DONE WITH ROUTCDE   14300000
&NUM        SETA    &NUM-1                      ONE LESS VALUE TO DO    14350000
            AGO     .ROUTLOP                    PROCESS REST OF VALUES  14400000
.********************************************************************** 14450000
.*          VALIDATE THE DESC KEYWORD                                 * 14500000
.*          1. IGNORED IF BUFFER ALSO SPECIFIED                       * 14550000
.*          2. IGNORED FOR USS MESSAGES                               * 14600000
.*          3. INVALID IF NOT 1-11                                    * 14650000
.********************************************************************** 14700000
.CHKDESC    ANOP                                                        14750000
            AIF     ('&DESC' EQ '').CHKSUPP     DESC OMITTED            14800000
            AIF     ('&BUFFER(1)' EQ '').SKPDESC BUFFER NOT CODED @06C  14850000
            AGO     .CHKSUPP                    CHECK SUPP VALUE        14900000
.SKPDESC    ANOP                                                        14950000
            AIF     (&MSGTYPE EQ 0).CHKSUPP     IGNORE            @R1C  15000000
&YESDESC    SETB    1                           1=DESC SPECIFIED        15150000
&NUM        SETA    N'&DESC                     # VALUES IN DESC        15200000
.DESCLOP    ANOP                                                        15250000
&INDEX      SETA    &DESC(&NUM)                 SINGLE VALUE IN DESC    15300000
            AIF     ('&INDEX' LT '1').BADDESC   DESC < 1                15350000
            AIF     ('&INDEX' GT '11').BADDESC  DESC > 11         @05C  15400000
&DSCDSP(&INDEX) SETB 1                                                  15450000
            AIF     ('&NUM' EQ '1').CHKSUPP     ALL DONE WITH DESC      15500000
&NUM        SETA    &NUM-1                      ONE LESS VALUE TO DO    15550000
            AGO     .DESCLOP                    PROCESS REST OF VALUES  15600000
.********************************************************************** 15650000
.*       VALIDATE THE SUPP KEYWORD.  POTENTIAL VALUES FOR VTAM        * 15700000
.*       MESSAGES ARE:                                                * 15750000
.*           NEVER  - NEVER SUPPRESS MESSAGE                          * 15800000
.*           SER    - TREAT AS SERIOUS MESSAGE                        * 15850000
.*           NORM   - TREAT AS NORMAL MESSAGE                         * 15900000
.*           WARN   - TREAT AS WARNING MESSAGE                        * 15950000
.*           INFO   - TREAT AS INFORMATIONAL MESSAGE                  * 16000000
.*           ALWAYS - ALWAYS SUPPRESS MESSAGE                         * 16050000
.*                                                                    * 16100000
.*       POTENTIAL VALUES FOR USS MESSAGES ARE:                       * 16150000
.*           NEVER  - NEVER SUPPRESS MESSAGE                          * 16200000
.*           ALWAYS - ALWAYS SUPPRESS MESSAGE                         * 16250000
.********************************************************************** 16300000
.CHKSUPP ANOP                                                           16350000
            AIF     ('&SUPP' EQ '').CHKOPT      SUPP NOT CODED          16400000
            AIF     ('&BUFFER(1)' EQ '').DOSUPP  SUPP IGNORED IF BUFFER 16433300
.*                                              CODED              @06C 16466600
            AGO     .CHKOPT                     CHECK OPT VALUE         16500000
.DOSUPP     ANOP                                                        16550000
&YESSUPP    SETB    1                           1=SUPP WAS SPECIFIED    16600000
            AIF     ('&SUPP' NE 'NEVER').NOTNEVR                        16650000
&SUP(1)     SETB    0                                                   16700000
&SUP(2)     SETB    0                                                   16750000
&SUP(3)     SETB    0                                                   16800000
&SUP(4)     SETB    0                                                   16850000
            AGO     .CHKOPT                                             16900000
.NOTNEVR    ANOP                                                        16950000
            AIF     ('&SUPP' NE 'ALWAYS').NOTALWY  SUPP=ALWAYS          17000000
&SUP(1)     SETB    1                                                   17050000
&SUP(2)     SETB    1                                                   17100000
&SUP(3)     SETB    1                                                   17150000
&SUP(4)     SETB    1                                                   17200000
            AGO     .CHKOPT                                             17250000
.NOTALWY    ANOP                                                        17300000
            AIF     (&MSGTYPE EQ 0).CHKOPT      MSG-NEVER, ALWAYS @R1C  17350000
            AIF     ('&SUPP' NE 'SER').NOTSER                           17500000
&SUP(1)     SETB    1                           SUPP=SER                17550000
            AGO     .CHKOPT                                             17600000
.NOTSER     ANOP                                                        17650000
            AIF     ('&SUPP' NE 'NORM').NOTNORM                         17700000
&SUP(2)     SETB    1                           SUPP=NORM               17750000
            AGO     .CHKOPT                                             17800000
.NOTNORM    ANOP                                                        17850000
            AIF     ('&SUPP' NE 'WARN').NOTWARN                         17900000
&SUP(3)     SETB    1                           SUPP=WARN               17950000
            AGO     .CHKOPT                                             18000000
.NOTWARN    ANOP                                                        18050000
            AIF     ('&SUPP' NE 'INFO').BADSUPP                         18100000
&SUP(4)     SETB    1                           SUPP=INFO               18150000
.********************************************************************** 18200000
.*       VALIDATE THE OPT KEYWORD.  POTENTIAL VALUES ARE:             * 18250000
.*          BLKSUP                                                    * 18300000
.*          NOBLKSUP                                                  * 18350000
.*                                                                    * 18400000
.*       IF OMITTED, OPT=BLKSUP IS ASSUMED.                           * 18450000
.********************************************************************** 18500000
.CHKOPT     ANOP                                                        18550000
&BLKSUP     SETB    0                           ASSUME OPT=BLKSUP       18600000
            AIF     ('&OPT' EQ '').CHKMCS       OPT NOT CODED           18650000
&YESOPT     SETB    1                           OPT WAS SPECIFIED       18700000
            AIF     ('&BUFFER(1)' EQ '').DOOPT  OPT IGNORED IF BUFFER   18733300
.*                                              CODED              @06C 18766600
            AGO     .CHKMCS                     CHECK MCSFLAG VALUE     18800000
.DOOPT      ANOP                                                        18850000
            AIF     ('&OPT' NE 'NOBLKSUP').CHKBLK                       18900000
&BLKSUP     SETB    1                           OPT=NOBLKSUP            18950000
            AGO     .CHKMCS                     CHECK MCSFLAG VALUE     19000000
.CHKBLK     ANOP                                                        19050000
            AIF     ('&OPT' NE 'BLKSUP').BADOPT                         19100000
&BLKSUP     SETB    0                           OPT=BLKSUP              19150000
.********************************************************************** 19200000
.*       VALIDATE THE MCSFLAG KEYWORD.  IT IS VALUE FOR VTAM MESSAGES * 19250000
.*       ONLY.                                                        * 19300000
.********************************************************************** 19350000
.CHKMCS     ANOP                                                        19400000
&MFLAG      SETB    0                           ASSUME MCSFLAG ABSENT   19450000
            AIF     ('&MCSFLAG' EQ '').CHKISS   MCSFLAG OMITTED   @KFC  19500000
            AIF     ('&BUFFER(1)' EQ '').SKPMCS  BUFFER NOT CODED @06C  19550000
            AGO     .CHKISS                     GENERATE RECORD   @KFC  19600000
.SKPMCS     ANOP                                                        19650000
            AIF     (&MSGTYPE EQ 0).CHKISS      IGNORE            @R1C  19700000
&MFLAG      SETB    1                           MCS FLAG PRESENT        19850000
            AIF     ('&MCSFLAG' NE 'REG0').MSGRES     MCSFLAG=REG0      19900000
&MCS(1)     SETB    1                                                   19950000
            AGO     .CHKISS                                       @KFC  20000000
.MSGRES     ANOP                                                        20050000
            AIF     ('&MCSFLAG' NE 'RESP').MSGBRD     MCSFLAG=RESP      20100000
&MCS(2)     SETB    1                                                   20150000
            AGO     .CHKISS                                       @KFC  20200000
.MSGBRD     ANOP                                                        20250000
            AIF     ('&MCSFLAG' NE 'BRDCST').MSGHRD   MCSFLAG=BRDCST    20300000
&MCS(4)     SETB    1                                                   20350000
            AGO     .CHKISS                                       @KFC  20400000
.MSGHRD     ANOP                                                        20450000
            AIF     ('&MCSFLAG' NE 'HRDCPY').MSGQREG  MCSFLAG=HRDCPY    20500000
&MCS(5)     SETB    1                                                   20550000
            AGO     .CHKISS                                       @KFC  20600000
.MSGQREG    ANOP                                                        20650000
            AIF     ('&MCSFLAG' NE 'QREG0').MSGNOT    MCSFLAG=QREG0     20700000
&MCS(6)     SETB    1                                                   20750000
            AGO     .CHKISS                                       @KFC  20800000
.MSGNOT     ANOP                                                        20850000
            AIF     ('&MCSFLAG' NE 'NOTIME').MSGNOC   MCSFLAG=NOTIME    20900000
&MCS(7)     SETB    1                                                   20950000
            AGO     .CHKISS                                       @KFC  21000000
.MSGNOC     ANOP                                                        21050000
            AIF     ('&MCSFLAG' NE 'NOCPY').BADMCS    MCSFLAG=NOCPY     21100000
&MCS(8)     SETB    1                                                   21150000
.********************************************************************** 21152300
.*                                                                    * 21154600
.*       VALIDATE THE MSGLVL KEYWORD. POTENTIAL VALUES ARE:           * 21156600
.*          BASE                                                      * 21158600
.*          START                                                     * 21160600
.*          V4R1                                                      * 21162600
.*          V4R2                                                  @U2A* 21163600
.*       THE MSGLVL KEYWORD IS OPTIONAL.  IF MSGLVL IS NOT CODED      * 21164600
.*       FOR A MESSAGE, NO DEFAULT VALUE IS TAKEN (MSGLVL OMMITTED    * 21166600
.*       IS NOT THE SAME AS MSGLVL=anything).                         * 21168600
.*                                                                @KFA* 21170700
.********************************************************************** 21173000
.CHKISS     ANOP                                                  @KFA  21175300
&MLEVEL     SETC    '00'                        INITIALIZE MLEVEL @KFA  21177200
            AIF     ('&MSGLVL' EQ '').UPDTBL  MSGLVL OMITTED @KFA @T3C  21179100
&YESISS     SETB    1                           MSGLVL GIVEN @KFA @T3C  21181000
.LEVEL1     AIF     ('&MSGLVL' NE 'BASE').LEVEL2  BASE CODED @T2A @T3C  21182900
&MLEVEL     SETC    '81'                        BASE CODED        @T2A  21184800
            AGO     .UPDTBL                     BASE - DONE       @T2A  21186700
.LEVEL2     AIF     ('&MSGLVL' NE 'V4R1').LEVEL3  V4R1 CODED @T2A @T3C  21188600
&MLEVEL     SETC    '82'                        V4R1 CODED        @T2A  21190500
            AGO     .UPDTBL                     V4R1 - DONE       @T2A  21192400
.LEVEL3     AIF     ('&MSGLVL' NE 'V4R2').LEVEL4  V4R2 CODED      @U2A  21193100
&MLEVEL     SETC    '83'                        V4R2 CODED        @U2A  21193800
            AGO     .UPDTBL                     V4R2 - DONE       @U2A  21194500
.LEVEL4     ANOP                                             @T2C @U2C  21195200
            AIF     ('&MSGLVL' NE 'START').BADISS NOT  START @KFA @T3C  21196200
&MLEVEL     SETC    '80'                        START CODED       @KFA  21198100
.********************************************************************** 21200000
.*       VALIDATE THE MESSAGE ID                                        21250000
.********************************************************************** 21300000
.UPDTBL     ANOP                                                        21350000
&I          SETA  K'&MSG(&MSGNUM)               NEXT MESSAGE      @R1M  21350600
            AIF   (&I NE 7).MSGDIG4             NOT FORM ISTXXXt  @F1C  21351200
&MSGOLD     SETC  '&MSG(&MSGNUM)'(4,4)          XXXI IN ISTXXXt   @R1A  21351800
&MSG1       SETC  '&MSG(&MSGNUM)'(4,3)          XXX IN ISTXXXt    @R1A  21352400
&MSGTYPE    SETB  1                             1=VTAM MESSAGE    @R1M  21353000
&I          SETA  3                             3-CHARACTER ID    @R1M  21353600
            AGO   .VALMSG                                         @R1M  21354200
.MSGDIG4    ANOP                                                  @R1M  21354300
            AIF   (&I NE 8).SHORTFM             NOT FORM ISTXXXXt @F1A  21354400
&MSG1       SETC  '&MSG(&MSGNUM)'(4,4)          XXXX IN ISTXXXXt  @F1A  21354500
&MSGTYPE    SETB  1                             1=VTAM MESSAGE    @F1A  21354600
&I          SETA  4                             4-CHARACTER ID    @F1A  21354700
            AGO   .VALMSG                                         @F1A  21354800
.SHORTFM    ANOP                                                  @R1M  21354900
&MSGTYPE    SETB  0                             0=USS MESSAGE     @R1M  21355400
            AIF   (&I EQ 1).ONECH               1-DIGIT USS MESSAGE     21356000
            AIF   (&I NE 2).BADMSG2             NOT 2-DIGIT USS MESSAGE 21356600
&MSG1       SETC  '0&MSG(&MSGNUM)'                                @R1A  21357200
            AGO   .COMCH                                          @R1A  21357800
.ONECH      ANOP                                                  @R1A  21358400
&MSG1       SETC  '00&MSG(&MSGNUM)'                               @R1A  21359000
.COMCH      ANOP                                                  @R1A  21359600
&MSGOLD     SETC  '&MSG1'                                         @R1A  21360200
.VALMSG     ANOP                                                  @R1A  21360800
&INDEX      SETA  0                                               @R1M  21361400
.MSGLOOP    ANOP                                                  @R1M  21362000
&INDEX      SETA  &INDEX+1                                        @R1M  21362600
            AIF   (&INDEX GT &I).CHKMLEN       CHECKED ALL DIGITS @R1M  21363200
            AIF   ('&MSG1'(&INDEX,1) EQ '0').MSGLOOP              @R1M  21363800
            AIF   ('&MSG1'(&INDEX,1) EQ '1').MSGLOOP              @R1M  21364400
            AIF   ('&MSG1'(&INDEX,1) EQ '2').MSGLOOP              @R1M  21365000
            AIF   ('&MSG1'(&INDEX,1) EQ '3').MSGLOOP              @R1M  21365600
            AIF   ('&MSG1'(&INDEX,1) EQ '4').MSGLOOP              @R1M  21366200
            AIF   ('&MSG1'(&INDEX,1) EQ '5').MSGLOOP              @R1M  21366800
            AIF   ('&MSG1'(&INDEX,1) EQ '6').MSGLOOP              @R1M  21367400
            AIF   ('&MSG1'(&INDEX,1) EQ '7').MSGLOOP              @R1M  21368000
            AIF   ('&MSG1'(&INDEX,1) EQ '8').MSGLOOP              @R1M  21368600
            AIF   ('&MSG1'(&INDEX,1) EQ '9').MSGLOOP              @R1M  21369200
            AGO   .BADMSG                                         @R1M  21369800
.CHKMLEN    ANOP                                                  @R1M  21370400
            AIF   (&MSGTYPE EQ 1).VALIDID       VTAM MESSAGE      @R1M  21371000
            AIF   (&MSG(&MSGNUM) LT 0).BADMSG3  MESSAGE ID >= 0   @R1M  21371600
            AIF   (&MSG(&MSGNUM) GT 14).BADMSG3 MESSAGE ID <= 14  @V2C  21372200
.VALIDID    ANOP                                                  @R1A  21372800
            AIF   (&MSGNUM GT 1).NONAMA        FIRST MESSAGE?     @Q1A  21372900
            AIF   ('&MSGNM' EQ '').NONAMA      LABEL NAME?        @Q1A  21373000
&MSGNM      DS    0F              LABEL ON WORD BOUNDARY     @Q1A @0AC  21373100
.NONAMA     ANOP                                                  @Q1A  21373200
            AIF   (&FMT NE 0).DODYNA        USSTAB FORMAT=DYNAMIC @Q2C  21373400
.********************************************************************** 21374000
.*       INITIAL  PROCESSING FOR FORMAT=OLD MESSAGES                  * 21374600
.********************************************************************** 21375200
.NXTMSG     ANOP                                                  @R1A  21375800
&TMSG      SETA &TMSG+1           THIS USSMSG COUNTER             @R1A  21376400
&NMSG      SETA &NMSG+1           NEXT USSMSG COUNTER             @R1A  21377000
ISTM&TMSG  DC   0F'0'             ALIGN MSG ON FULLWORD BOUNDARY  @R1A  21377600
           DC   A(ISTM&NMSG)           NEXT MESSAGE DEFINITION    @R1A  21378200
           AIF   ('&BUFFER(1)' NE '').CHKBUF   BUFFER SPECIFIED?  @06C  21378800
           DC    AL4(ISTN&TMSG)   ADDRESS OF MESSAGE ID     @R1A  @Z1A  21379000
           ORG   *-4              TOP OF MSG ID                   @Z1A  21379200
           DC    AL.1(1)          SET HIGH ORDER BIT              @Z1A  21379400
           ORG   ,                CONTINUE                        @Z1A  21379600
           AIF   ('&TEXT' EQ '').NXTLST                           @R1A  21380000
&YESTXT    SETB    1              TEXT WAS CODED                  @R1A  21380600
.NXTLST    ANOP                   BYPASS FLAG SETTING             @R1A  21381200
           DC    AL4(ISTB&GEN1)             MESSAGE TEXT          @R1A  21381800
           AGO   .GENTFLD                                         @R1A  21382400
.********************************************************************** 21383600
.*       GENERATE POINTER TO USER BUFFER                              * 21384200
.********************************************************************** 21384800
.CHKBUF  ANOP                                                     @R1A  21385400
           AIF   (&YESSCAN EQ 1).BADLUN2    SCAN   NOT VALID FOR  @KGA  21385600
.*                                          PRE-V3R2 MESSAGES     @06A  21385800
           DC    AL4(ISTN&TMSG)             ADDRESS OF MESSAGE ID @R1A  21386000
           DC    AL4(&BUFFER(1))            ADDRESS OF PROTOTYPE  @Z1C  21386200
           ORG   *-4                        TOP OF MSG ID         @Z1A  21386400
           DC    AL.1(1)                    SET HIGH ORDER BIT    @Z1A  21386600
           ORG   ,                          CONTINUE              @Z1A  21386800
.********************************************************************** 21387200
.*       GENERATE MPB THIRD WORD - POINTER TO MESSAGE TEXT STRING     * 21387800
.********************************************************************** 21388400
.GENTFLD    ANOP                                                  @R1A  21389000
ISTN&TMSG   DC    AL1(ISTT&TMSG-*-1)      LENGTH OF MESSAGE ID    @R1A  21389600
            DC    C'&MSGOLD'                        MESSAGE ID    @R1A  21390200
ISTT&TMSG   EQU   *                                               @R1A  21390800
            AGO   .NEXTONE                                        @R1A  21391400
.********************************************************************** 21392000
.*       INITIAL  PROCESSING FOR FORMAT=DYNAMIC MESSAGES              * 21392600
.********************************************************************** 21393200
.DODYNA     ANOP                                                  @Q2C  21393800
            AIF   (&MSGTYPE EQ 0).DOUSSM           PROCESS USS MESSAGE  21400000
            AIF   (&DIG4 EQ 1).GETDIG4             4-DIGIT CHANGE @F1A  21414200
&DIG123C    SETC  '&MSG1'(1,3)                     GET 3 DIGITS   @F1A  21428400
            AGO   .TODECML                                        @F1A  21442600
.GETDIG4    ANOP                                   4 DIGIT ID     @F1A  21456800
&DIG123C    SETC  '&MSG1'(1,4)                     GET 4 DIGITS   @F1A  21471000
.TODECML    ANOP                                   CONVERT MSG ID @F1A  21485200
&DIG123A    SETA  &DIG123C                         CONVERT TO ARITH.    21500000
&I          SETA  &DIG123A+1                                            21550000
&ONE(&I)    SETB  1                                1 BIT/VTAM MSG FOUND 21600000
            DS    0F                                                    21650000
MSG&MSG1    EQU   *                                                     21700000
&YESVTAM    SETB  1                                1=VTAM MSGS EXIST    21750000
            AGO   .NEXTONE                                        @R1A  21800000
.DOUSSM     ANOP                                                        21850000
&I          SETA  &MSG1+1                                               21900000
            AIF   (&YESSCAN EQ 1).NOBUF            SCAN      @06A @KGC  21907100
            AIF   (&YESBUFF EQ 0).NOBUF            NO BUFFER      @Q1A  21914200
&USSMG(&I)  SETC  '&BUFFER'                      BUFFER  @03A @P053496  21928400
            AGO   .AROUND                                     @P053496  21942600
.NOBUF      ANOP                                              @P053496  21956800
&USSMG(&I)  SETC  ' '                            NO BUFFER        @03A  21971000
.AROUND     ANOP                                              @P053496  21985200
&YESUSS     SETB  1                                1=USS MESSAGES EXIST 22000000
            DS    0F                                                    22050000
            AIF   (&YESBUFF EQ 0).NOBUFMA          LUNAME         @07A  22058300
            AIF   (&YESSCAN EQ 1).NOBUFMA          NO BUFFER @07A @KGC  22066600
            AGO   .NEXTONE                                        @07A  22074900
.NOBUFMA    ANOP                                                  @07A  22083200
USS&MSG1    EQU   *                                               @02A  22091600
.NEXTONE    ANOP                                                  @R6C  22094200
&MSGNUM     SETA  &MSGNUM+1               NEXT MESSAGE            @R1A  22125000
            AIF   (&MSGNUM LE N'&MSG).UPDTBL        MORE MESSAGES @R1A  22137500
.************* START OF MESSAGE PROTOTYPE ***************************** 22150000
.WRITERD    ANOP                                                        22200000
ISTB&GEN1   EQU   *                                          @R1A @02A  22433200
            AIF  (&YESBUFF EQ 0).BLDTXT            NAME ON MACRO  @06C  22441500
            AIF  (&YESSCAN EQ 1).BLDTXT            NO LUNAME @06A @KGC  22449800
            AGO  .MMEND                                           @06A  22458100
.BLDTXT     ANOP                                                  @06C  22466400
.*                                                                @S1A  22474700
            DC    B'0&YESTXT.&YESSUPP.&YESROUT.&YESDESC.&YESBUFF.&YESSCX22483000
               AN.0'                                         @06C @KGC  22491300
            DC    B'&YESOPT.&MFLAG&BLKSUP.0&SUP(1)&SUP(2)&SUP(3)&SUP(4)X22500000
               '                                                        22550000
            DC    X'&MLEVEL.'                    MSGLVL BITS @T2C @T3C  22600000
            AIF  (&YESSCAN NE 1).CONTXT            NO LUNAME @06A @KGC  23061100
            DC    AL1(0)                           COMPATABILITY BYTE   23072200
.********************************************************************** 23083300
ISTX&GEN1  EQU   *                                                @06A  23094400
           DC    AL4(&BUFFER(1))             ADDRESS OF PROTOTYPE @06A  23105500
           AGO   .MMEND                                                 23116600
.********************************************************************** 23127700
.CONTXT     ANOP                                                  @06A  23138800
&G          SETA  K'&TEXT                                         @T1M  23141000
            AIF   (&G GT 253).BADTEXT              TEXT SIZE > 251      23143200
.*                                                 LIMIT (PLUS 2 FOR    23145400
.*                                                 QUOTES)    @09A @T1M 23147600
ISTX&GEN1   EQU   *                                                @R1C 23150000
            DC    AL2(ISTY&GEN1)                   MESSAGE LENGTH  @R1C 23200000
            DC    B'&MCS(1)&MCS(2)&MCS(3)&MCS(4)&MCS(5)&MCS(6)&MCS(7)&MX23250000
               CS(8)'                              MCS FLAGS            23300000
            DC    AL1(0)                           MCS FLAGS            23350000
            AIF   (&YESTXT EQ 0).SKPTXT2           NO TEXT              23400000
            AIF   (N'&TEXT EQ 1).ONETXT            TEXT IS NOT LIST     23450000
.LOOPTXT    ANOP                                                        23500000
&TXTNUM     SETA  &TXTNUM+1                        NEXT TEXT VALUE      23550000
            AIF   (&TXTNUM GT N'&TEXT).DONETXT     TEXT DONE            23600000
            DC    &TEXT(&TXTNUM)                   MESSAGE TEXT         23650000
            AGO   .LOOPTXT                                              23700000
.ONETXT     ANOP                                   TEXT IS NOT LIST     23750000
            AIF   ('&TEXT'(1,1) EQ '''').QUOTTXT   QUOTED TEXT          23803400
            AIF   ('&TEXT'(1,1) NE '(').NOPAREN    NOT SUBLIST    @04A  23804200
.********************************************************************** 23805100
.*       TEXT IS A LIST WITH ONLY ONE ITEM                        @04A  23805700
.********************************************************************** 23806300
            DC    &TEXT(1)                        1 IN LIST       @04A  23806900
            AGO   .DONETXT                                        @04A  23807500
.********************************************************************** 23808100
.*       TEXT IS NOT A QUOTED STRING.                                 * 23809000
.********************************************************************** 23812900
.NOPAREN    DC    C&TEXT                          MESSAGE TEXT    @04A  23816800
            AGO   .DONETXT                                              23820700
.********************************************************************** 23824600
.*       TEXT IS A QUOTED STRING.  IF LONGER THAN 128 CHARACTERS,     * 23828900
.*       THE TEXT WILL BE GENERATED IN TWO PARTS.                     * 23830600
.********************************************************************** 23832300
.QUOTTXT    ANOP                                   QUOTED TEXT          23834000
            AIF   (&G LE 129).SHRTXT2              TEXT SIZE <= 129     23835700
&G          SETA  &G-129                                          @09A  23837400
&TXT1       SETC  '&TEXT'(2,127)                   START OF TEXT  @01C  23839100
&TXT2       SETC  '&TEXT'(129,&G)                  END OF TEXT    @01C  23840800
            DC    C'&TXT1'                         MESSAGE TEXT   @01C  23842500
            DC    C'&TXT2'                                        @01C  23844200
            AGO   .DONETXT                                              23845900
.SHRTXT2    DC    C&TEXT                           MESSAGE TEXT         23847600
.DONETXT    ANOP                                                        23850000
.SKPTXT2    ANOP                                                        23900000
ISTY&GEN1   EQU   *-ISTX&GEN1                                     @R1C  23950000
            DC    B'&DSCDSP(1)&DSCDSP(2)&DSCDSP(3)&DSCDSP(4)&DSCDSP(5)&X24000000
               DSCDSP(6)&DSCDSP(7)&DSCDSP(8)'      DESCR CODES 1-8      24050000
            DC    B'&DSCDSP(9)&DSCDSP(10)&DSCDSP(11)00000'             X24075000
                                                   DESCR CODES 1-11     24100000
.* ADDED DESCRIPTOR CODE 11                                       @05C  24125000
            DC    B'&RTG(1)&RTG(2)&RTG(3)&RTG(4)&RTG(5)&RTG(6)&RTG(7)&RX24150000
               TG(8)'                              ROUTING CODES 1-8    24200000
            DC    B'&RTG(9)&RTG(10)&RTG(11)&RTG(12)&RTG(13)&RTG(14)&RTGX24250000
               (15)&RTG(16)'                       ROUTING CODES 9-16   24300000
.************* END OF MESSAGE PROTOTYPE ******************************* 24350000
            AGO   .MMEND                                          @R1C  24400000
.********************************************************************** 24450000
.*       ERROR PATHS                                                  * 24500000
.********************************************************************** 24550000
.BADTAB     ANOP                                                        24600000
            MNOTE 8,'USSTAB MACRO NOT SPECIFIED'                        24650000
            AGO   .MMEND                                                24700000
.BADROUT    ANOP                                                        24750000
            MNOTE 8,'&ROUTCDE NOT 1-16 IN &MSG'                         24800000
            AGO   .MMEND                                                24850000
.BADDESC    ANOP                                                        24900000
            MNOTE 8,'&DESC NOT 1-10 IN &MSG'                            24950000
            AGO   .MMEND                                                25000000
.BADMCS     ANOP                                                        25050000
            MNOTE 8,'&MCSFLAG IS INVALID VALUE FOR MCSFLAG IN &MSG'     25100000
            AGO   .MMEND                                                25150000
.BADOPT     ANOP                                                        25200000
            MNOTE 8,'&OPT IS INVALID VALUE FOR OPT IN &MSG'             25250000
            AGO   .MMEND                                                25300000
.BADSUPP    ANOP                                                        25350000
            MNOTE 8,'&SUPP IS INVALID VALUE FOR SUPP IN &MSG'           25400000
            AGO   .MMEND                                                25450000
.NOMSG      ANOP                                                        25500000
            MNOTE 8,'MSG KEYWORD OMITTED'                               25550000
            AGO   .MMEND                                                25600000
.BADMSG     ANOP                                                        25650000
            MNOTE 8,'ONLY 0-9 ALLOWED AS CHARACTERS IN &MSG'      @R1C  25700000
            AGO   .MMEND                                                25750000
.BADMSG2    ANOP                                                        25800000
            MNOTE 8,'LENGTH ERROR IN MSG KEYWORD OF &MSG'               25850000
            AGO   .MMEND                                                25900000
.BADLUNM    ANOP                                                  @06A  25907100
            MNOTE 8,'&BUFFER(2) IS INVALID FOR BUFFER KEYWORD IN &MSG'  25914200
            AGO   .MMEND                                          @06A  25921300
.BADLUN2    ANOP                                                  @06A  25928400
            MNOTE 8,'LUNAME IS ONLY VALID FOR FORMAT=DYNAMIC TABLES'    25933100
.*                                                           @06A @08C  25937800
            AGO   .MMEND                                          @06A  25942600
.BADMSG3    ANOP                                                        25950000
            MNOTE 8,'USS MESSAGE &MSG1 NOT IN RANGE 0-14'         @V2C  26000000
            AGO   .MMEND                                                26050000
.BADTEXT    ANOP                                                  @09A  26053100
            MNOTE 8,'TEXT LENGTH GREATER THAN 251 LIMIT'          @09A  26056200
            AGO   .MMEND                                          @09A  26059300
.BADFMT     ANOP                                                  @P1A  26062500
            MNOTE 8,'FORMAT=OLD INVALID WITH FOUR DIGIT MESSAGES' @P1A  26075000
            AGO   .MMEND                                          @P1A  26087500
.BADBUFF    ANOP                                                        26100000
            MNOTE 8,'BUFFER, TEXT MUTUALLY EXCLUSIVE FOR &MSG'          26150000
            AGO   .MMEND                                          @02A  26162500
.BADBUF2    ANOP                                                  @02A  26175000
            MNOTE 8,'BUFFER IS INVALID FOR VTAM MESSAGE'          @02A  26187500
            AGO   .MMEND                                          @KFA  26190600
.BADISS     ANOP                                                  @KFA  26193700
            MNOTE 8,'&MSGLVL IS INVALID VALUE FOR MSGLVL IN &MSG' @T3C  26196800
.MMEND      ANOP                                                        26200000
            MEND                                                        26250000
