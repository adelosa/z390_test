*%GOTO PLSIALC;                       /* BEGIN OF PLS COMMENT           00001003
         MACRO                                                          00002003
&LABEL   LIBRM &FUNC,                                                  X00003003
               &CB=,                                                   X00004003
               &CBLEN=,                                                X00005003
               &LDCB=,                                                 X00006003
               &ENTITY=,                                               X00007003
               &ENV=,                                                  X00007103
               &CATALOG=,                                              X00007203
               &CHAIN=,                                                X00007303
               &CHAINID=,                                              X00007403
               &SCOPE=,                                                X00007503
               &TYPEFLE=,                                              X00007603
               &LIB=,                                                  X00007703
               &SUBLIB=,                                               X00007803
               &MEMBER=,                                               X00007903
               &TYPE=,                                                 X00008003
               &NMEMBER=,                                              X00009003
               &NTYPE=,                                                X00010003
               &LOCKID=,                                               X00011003
               &RECFM=,                                                X00012003
               &BUFFER=,                                               X00013003
               &BUFSIZE=,                                              X00014003
               &RECNO=,                                                X00015003
               &UNITS=,                                                X00016003
               &MOVELEN=,                                              X00017003
               &DIRINF=,                                               X00018003
               &DIRNO=,                                                X00019003
               &DIRINFL=,                                              X00020003
               &NOTEINF=,                                              X00021003
               &NOTECTL=,                                              X00022003
               &NOTFND=,                                               X00023003
               &CONT=,                                                 X00024003
               &EODAD=,                                                X00025003
               &EROPT=,                                                X00026003
               &ERRAD=,                                                X00027003
               &SRVEXIT=,                                              X00028003
               &DATA=,                                                 X00029003
               &DATAID=,                                               X00030003
               &DATALEN=,                                              X00031003
               &SYSIPT=,                                               X00032003
               &FRAME=,                                                X00033003
               &SENDBF=,                                               X00034003
               &SENDBFL=,                                              X00035003
               &REQUEST=,                                              X00036003
               &MODE=,                                                 X00037003
               &WSTOR=,                                                X00038003
               &COMMIT=                                        @D52RDUT 00039003
         GBLC  &IALFC                 FUNC TO BE PASSED TO IALCDEF      00040003
         GBLB  &IALSYER               ERROR DURING SYNTAX CHECK         00041003
         GBLB  &IALINN                CALL IALCDEF AS IALINN MACRO      00042003
         GBLC  &IALOP1                OPEN OPTION 1                     00043003
         GBLC  &IALOP2                OPEN OPTION 2                     00044003
         GBLB  &IALENV                ENVIRONMENT SPEC.        @D52TDJS 00044103
         GBLB  &IALENVD               ENV OPERAND AL. GIVEN    @D52TDJS 00044203
         GBLB  &IALFRHD               FRHD ALREADY ISSUED      @D52TDJS 00044303
         LCLC  &REG                   PREPARE STRING FOR ST INSTR.      00044403
         LCLC  &CHN                   CHAIN                             00044503
         LCLC  &TSYSI                 SYSIPT OPTION                     00044603
         LCLC  &TCATLOG               CATALOG PARAMETER                 00044703
         LCLC  &SCP                   SCOPE                             00044803
         LCLC  &NOTE                  NOTECTL                           00044903
         LCLC  &NOTEIN                NOTEINFORMATION                   00045003
         LCLC  &COMM                  COMMIT OPTION                     00046003
.*                                                                      00047003
         SPACE                                                          00048003
*  LIBRARIAN - LIBRM - 5686-032-06-DB6  - VERSION 91-06-21              00049003
         SPACE                                                          00050003
.*                                                                      00051003
         AGO   .ENDPCP                                                  00052003
.*                                                                      00053003
*        LICENSED MATERIALS - PROPERTY OF IBM                           00054003
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                    00055003
*        5686-032 (C) COPYRIGHT IBM CORP. 1990, 1993                    00056003
*        SEE COPYRIGHT INSTRUCTIONS                                     00057003
.*                                                                      00058003
.* A000000-999999                                              @D51VDJS 00059003
.*   SUPPORT FOR THE TRANSACTION SERVER LTS                    @D52TDJS 00060003
.*   MEMBER LOCKING                                            @D52RDUT 00061003
.*                                                                      00062003
*/****  START OF SPECIFICATIONS  *************************************/ 00063003
*/**                                                                    00064003
*/**  MACRO NAME:  LIBRM                                                00065003
*/**                                                                    00066003
*/**  MACRO TYPE:  EXTERNAL LIBRARIAN MACRO, BILINGUAL                  00067003
*/**                                                                    00068003
*/**  DESCRIPTIVE NAME:  MACRO FOR INTERACTIVE LIBRARIAN CALL           00069003
*/**                                                                    00070003
*/**  SYNTAX OF MACRO:                                                  00071003
*/**                                                                    00072003
*/**    ASSEMBLER:                                                      00073003
*/**                                                                    00074003
*/** <LABEL> LIBRM LIBDEF|LIBDROP|SHOWCB|STATE|DELETE|RENAME            00075003
*/**               |OPEN|GET|PUT|NOTE|NOTEF|POINT|CLOSE        @D61YDMF 00076003
*/**               |CONTROL|SERVER                             @D52TDJS 00077003
*/**               |LOCK|UNLOCK                                @D52RDUT 00078003
*/**                  <,CB = LDCB|MBST|SBST|LBST|NOTEINF>               00079003
*/**                                                                    00080003
*/**                  <,CBLEN = NAME | (R)>                             00081003
*/**                  <,ENTITY = MEMBER|SUBLIB|LIB|CHAIN>               00082003
*/**                  <,TYPEFLE = INPUT|INOUT                           00083003
*/**                              |(OUTPUT,REPLACE)|(OUTPUT,NOREPLACE)  00084003
*/**                  <,LDCB = NAME | (R)>                              00085003
*/**                  <,ENV  = BATCH | SERVER>                 @D52TDJS 00086003
*/**                  <,CATALOG = NAME|(R)>                             00087003
*/**                  <,CHAIN = NAME|(R)>                               00088003
*/**                  <,CHAINID = NAME | (R)>                           00089003
*/**                  <,LIB = NAME | (R)>                               00090003
*/**                  <,SUBLIB = NAME | (R)>                            00091003
*/**                  <,MEMBER = NAME | (R)>                            00092003
*/**                  <,NMEMBER = NAME | (R)>                           00093003
*/**                  <,TYPE = NAME | (R)>                              00094003
*/**                  <,NTYPE = NAME | (R)>                             00095003
*/**                  <,LOCKID= NAME | (R)>                    @D52RDUT 00096003
*/**                  <,RECFM = S | F >                                 00097003
*/**                  <,MOVELEN = NAME | (R)>                           00098003
*/**                  <,BUFFER = NAME | (R)>                            00099003
*/**                  <,BUFSIZE = VALUE| (RV)>                          00100003
*/**                  <,RECNO = VALUE| (RV)>                            00101003
*/**                  <,UNITS = VALUE| (RV)>                            00102003
*/**                  <,DIRINF  = NAME | (R)>                           00103003
*/**                  <,DIRINFL = VALUE| (RV)>                          00104003
*/**                  <,DIRNO   = NAME | (R)>                           00105003
*/**                  <,DATA = NAME | (R)>                              00106003
*/**                  <,DATAID = NAME| (R)>                             00107003
*/**                  <,DATALEN = NAME | (R)>                           00108003
*/**                  <,CONT = YES | NO>                                00109003
*/**                  <,NOTFND = NAME | (R)>                            00110003
*/**                  <,EODAD = NAME | (R)>                             00111003
*/**                  <,EROPT = RET | CANCEL >                          00112003
*/**                  <,ERRAD = NAME | (R)>                             00113003
*/**                  <,SRVEXIT = NAME | (R)>                  @D52TDJS 00113103
*/**                  <,NOTEINF = NAME | (R)>                           00113203
*/**                  <,NOTECTL = YES | NO>                             00113303
*/**                  <,COMMIT = YES | NO>                              00113403
*/**                  <,SYSIPT = YES | NO>                              00113503
*/**                  <,SCOPE = TASK | JOB | PART>                      00113603
*/**                  <,FRAME = MAP | READY >                  @D52TDJS 00113703
*/**                  <,SENDBF  = NAME | (R)>                  @D52TDJS 00113803
*/**                  <,SENDBFL = NAME | (R)>                  @D52TDJS 00113903
*/**                  <,REQUEST = API | COMMAND | RESET>       @D52TDJS 00114003
*/**                  <,MODE = STOP | CONTINUE >               @D52TDJS 00115003
*/**                  <,WSTOR = NAME | (R)>                    @D52TDJS 00116003
*/**                  <,LDCB = NAME | (R)>                     @D52TDJS 00117003
*/**                                                                    00118003
*/**    PLS:                                                            00119003
*/**                                                                    00120003
*/** ?<LABEL:>  LIBRM  SHOWCB(LDCB|MBST|SBST|LBST|NOTEINF)              00121003
*/**                | LIBDEF | LIBDROP                                  00122003
*/**                | STATE<(MEMBER|SUBLIB|LIB|CHAIN)>                  00123003
*/**                | DELETE<(MEMBER)> | RENAME<(MEMBER)>               00124003
*/**                | OPEN(INPUT|(OUTPUT,<REPLACE|NOREPLACE>)           00125003
*/**                       |INOUT)                                      00126003
*/**                | GET | PUT | NOTEF | POINT                @D61YDMF 00127003
*/**                | CLOSE                                             00128003
*/**                | CONTROL                                  @D52TDJS 00129003
*/**                | LOCK | UNLOCK                            @D52RDUT 00129103
*/**                    <LDCB(NAME) | (AN))>                            00129203
*/**                    <ENV(BATCH | SERVER)>                  @D52TDJS 00129303
*/**                    <CATALOG(NAME | (AN))>                          00129403
*/**                    <CHAIN(NAME | (AN))>                            00129503
*/**                    <CHAINID(NAME | (AN))>                          00129603
*/**                    <SCOPE(TASK | JOB | PART)>                      00129703
*/**                    <LIB(NAME | (AN))>                              00129803
*/**                    <SUBLIB(NAME | (AN))>                           00129903
*/**                    <MEMBER(NAME | (AN))>                           00130003
*/**                    <TYPE(NAME | (AN))>                             00131003
*/**                    <NMEMBER(NAME | (AN))>                          00132003
*/**                    <NTYPE(NAME | (AN))>                            00133003
*/**                    <LOCKID(NAME | (AN))>                  @D52RDUT 00134003
*/**                    <RECFM(F | S)>                                  00135003
*/**                    <BUFFER(NAME | (AN))>                           00136003
*/**                    <BUFSIZE(VALUE | (AN))>                         00137003
*/**                    <RECNO(VALUE | (AN))>                           00138003
*/**                    <UNITS(VALUE | (AN))>                           00139003
*/**                    <MOVELEN(NAME | (AN))>                          00140003
*/**                    <DIRINF(NAME | (AN))>                           00141003
*/**                    <DIRNO(NAME | (AN))>                            00142003
*/**                    <DIRINFL(VALUE | (AN))>                         00143003
*/**                    <DATA(NAME | (AN))>                             00144003
*/**                    <DATAID(NAME | (AN))>                           00145003
*/**                    <DATALEN(NAME | (AN))>                          00146003
*/**                    <NOTFND(NAME | (AN))>                           00147003
*/**                    <CONT(YES | NO)>                                00148003
*/**                    <EODAD(NAME | (AN))>                            00149003
*/**                    <EROPT(RET | CANCEL)>                           00150003
*/**                    <ERRAD(NAME | (AN))>                            00151003
*/**                    <SRVEXIT(NAME | (AN))>                 @D52TDJS 00152003
*/**                    <NOTEINF(NAME | (AN))>                          00153003
*/**                    <NOTECTL(YES | NO)>                             00154003
*/**                    <SYSIPT(YES | NO)>                              00155003
*/**                    <COMMIT(YES | NO)>                              00156003
*/**                    <FRAME(MAP | READY)>                   @D52TDJS 00157003
*/**                    <SENDBF(NAME | (AN))>                  @D52TDJS 00158003
*/**                    <SENDBFL(NAME | (AN))>                 @D52TDJS 00159003
*/**                    <REQUEST(API|COMMAND|RESET)>           @D52TDJS 00160003
*/**                    <MODE(STOP|CONTINUE)>                  @D52TDJS 00161003
*/**                    <WSTOR(NAME | (AN))>                   @D52TDJS 00161103
*/**                    <LDCB(NAME | (AN))>                    @D52TDJS 00161203
*/**                    ;                                               00161303
*/**            (AN) --> ADDRESS NOTATION POSSIBLE                      00161403
*/*   EJECT                                                             00161503
*/**  INPUT:    SPECIFICATION OF MACRO AND CONTROL BLOCK.               00161603
*/**            USER MUST SUPPLY A STORAGE AREA OF 72 BYTES, USED AS A  00161703
*/**            REGISTER SAVE AREA, AND SUPPLY ITS ADDRESS IN REGISTER  00161803
*/**            13.                                                     00161903
*/**                                                                    00162003
*/**  OUTPUT:   RETURN CODE IN REGISTER 15                              00163003
*/**            FOR LIBDEF: A CHAIN OF UP TO 15 SUBLIBRARIES IS         00164003
*/**            ESTABLISHED WITH THE NAME GIVEN IN CHAINID.             00165003
*/**            FOR STATE: FOR A GIVEN OBJECT IT IS DETERMINED          00166003
*/**            WHETHER IT EXISTS OR NOT.                               00167003
*/**            IF IT EXITS OBJECT ATTRIBUTES ARE RETURNED.             00168003
*/**            FOR OPEN: A GIVEN MEMBER IS OPENED FOR READ,            00169003
*/**            OR WRITE.                                               00170003
*/**            FOR CLOSE: A MEMBER IS CLOSED, THE DIRECTORY IS         00171003
*/**            UPDATED (COMMIT=YES) OR THE UPDATES TO THE MEMBER       00172003
*/**            ARE UNDONE (COMMIT=NO).                                 00173003
*/**            FOR GET: ONE OR A COUPLE OF RECORDS OR A BYTE-STRING    00174003
*/**            OF A MEMBER IS RETURNED IN THE BUFFER.                  00175003
*/**            FOR NOTE/NOTEF: THE POSITION WITHIN A MEMBER   @D61YDMF 00176003
*/**            IS NOTED FOR                                            00177003
*/**            FUTURE REPOSITIONING.                                   00178003
*/**            FOR POINT: REPOSITION WITHIN A MEMBER TO A CERTAIN      00179003
*/**            NOTE ADDRESS.                                           00180003
*/**            WITH THE FIRST CALL OF A LIBRM   OR A                   00181003
*/**            LIBRDCB MACRO IN A MODULE THE FOLLOWING                 00182003
*/**            MAPS ARE PROVIDED WITH THE INDICATED NAMES:             00183003
*/**                                                                    00184003
*/**              INLCIALC   INTERACTIVE LIBRARY ACCESS CONTROL BLOCK   00185003
*/**                                                                    00186003
*/**  FUNCTION:                                                         00187003
*/**                                                                    00188003
*/**  THIS MACRO ESTABLISH THE LIBRARIAN GET/PUT INTERFACE.             00189003
*/**                                                                    00190003
*/**  REGISTER USAGE FOR LIBRM MACRO:                                   00191003
*/**                                                                    00192003
*/**    REG  0   FUNCTION INDICATOR                                     00193003
*/**    REG  1   POINTER TO CONTROL BLOCK                               00194003
*/**    REG 13   ADDRESS OF SAVEAREA                                    00195003
*/**    REG 14   RETURN ADDRESS                                         00196003
*/**    REG 15   USED AS BRANCH REGISTER AND FOR RETURN CODES           00197003
*/**                                                                    00198003
*/**    ALL OTHER REGISTERS REMAIN UNCHANGED                            00199003
*/**                                                                    00200003
*/**  RETURN CODES FROM LANGUAGE PROCESSOR:                             00201003
*/**     0       MACRO EXPANSION SUCCESSFUL                             00202003
*/**     4       PARAMETERS HAVE BEEN IGNORED DUE TO CONFLICTS          00203003
*/**     8       INVALID PARAMETERS SPECIFIED                           00204003
*/**                                                                    00205003
*/**  RETURN CODES FROM SERVICE FUNCTION:                               00206003
*/**     0       REQUEST HAS BEEN HONORED                               00207003
*/**     4       REQUEST HAS BEEN HONORED, BUT SOME WARNING ISSUED      00208003
*/**     8       FUNCTION NOT PERFORMED, ERROR HAS OCCURED              00209003
*/**    12       FUNCTION NOT PERFORMED, SEVERE ERROR HAS OCCURED       00210003
*/**    16       EXTERNAL ERROR WITH FEEDBACK CODE                      00211003
*/**    20       INTERNAL ERROR WITH FEEDBACK CODE                      00212003
*/**    32       SECURITY VIOLATION                                     00213003
*/**    (RETURN CODE >= 16: TERMINATING ERROR, MESSAGE PROVIDED)        00214003
*/**                                                                    00215003
*/**  NOTES:                                                            00216003
*/**                                                                    00217003
*/**     CHANGE ACTIVITIES:                                             00218003
*/**                                                                    00219003
*/**        SUPPORT OF INTERACTIVE LIBRARIAN                            00220003
*/**        NOTE -> NOTEF (NOTE WILL BE KEYWORD IN PLX)      @D61YDMF*/ 00221003
*/**                                                                    00222003
*/**     <...> DENOTES, THAT THIS PARAMETER IS OPTIONAL.                00223003
*/**                                                                    00224003
*/****  END OF SPECIFICATIONS  ***************************************/ 00225003
*/*   EJECT                                                             00226003
*/**  PARAMETER DESCRIPTION:                                            00227003
*/**                                                                    00228003
*/**    LIBDEF   ESTABLISHES A CHAIN OF UP TO 15 SUBLIBRARIES           00229003
*/**              (LIB.SUBLIB) GIVEN IN AN ARRAY SPECIFIED BY           00230003
*/**              CHAIN. THE CHAIN IS ADDRESSABLE BY USING THE NAME     00231003
*/**              GIVEN IN CHAINID.                                     00232003
*/**                                                                    00233003
*/**    LIBDROP  DROPS AN ESTABLISHED CHAIN OF UP TO 15 SUBLIBRARIES    00234003
*/**              IDENTIFIED BY CHAINID.                                00235003
*/**                                                                    00236003
*/**    STATE    DETERMINES WHETHER A SPECIFIED LIBRARIAN ENTITY        00237003
*/**              EXISTS AND RETURNS STATUS INFORMATION TO THE          00238003
*/**              REQUESTOR. LIBRARIAN ENTITIES ARE MEMBER, SUBLIBRARY  00239003
*/**              LIBRARY, AND CHAIN.                                   00240003
*/**                                                                    00241003
*/**    OPEN     INITIALIZES A MEMBER FOR WRITING, OR READING.          00242003
*/**                                                                    00243003
*/**                                                                    00244003
*/**    CLOSE    CLOSES A MEMBER. IF THE MEMBER WAS BEING WRITTEN       00245003
*/**              THE DIRECTORY INFORMATION IS COMPLETED. IF            00246003
*/**              COMMIT=YES WAS SPECIFIED THE MEMBER IS CATALOGED,     00247003
*/**              OTHERWISE THE WRITTEN MEMBER SPACE IS PURGED.         00248003
*/**                                                                    00249003
*/**                                                                    00250003
*/**    GET      GIVES BACK ONE OR MORE RECORDS OR A BYTE-STRING OF     00251003
*/**              AN OPENED MEMBER INTO THE SPECIFIED BUFFER.           00252003
*/**                                                                    00253003
*/**                                                                    00254003
*/**    PUT      WRITES ONE OR MORE RECORDS OR A BYTE-STRING OUT OF     00255003
*/**              A SPECIFIED BUFFER INTO AN OPENED MEMBER.             00256003
*/**                                                                    00257003
*/**                                                                    00258003
*/**    NOTE/    RETURNS THE CURRENT POSITION OF A MEMBER BACK @D61YDMF 00259003
*/**    NOTEF    IN THE AREA DENOTED BY NOTEINF.               @D61YDMF 00260003
*/**                                                                    00261003
*/**    POINT    IS USED TO REPOSITION WITHIN A MEMBER BY MEANS OF      00262003
*/**             NOTEINF.                                               00263003
*/**                                                                    00264003
*/**    DELETE   IS USED TO DELETE A SPECIFIED MEMBER.                  00265003
*/**                                                                    00266003
*/**    RENAME   IS USED TO RENAME A SPECIFIED MEMBER.                  00267003
*/**                                                                    00268003
*/**    CONTROL  IS USED TO DEFINE THE PROGRAM ENVIRONMENT     @D52TDJS 00269003
*/**                                                                    00270003
*/**    SERVER   IS USED TO BUILD A SERVER REQUEST BLOCK       @D52TDJS 00271003
*/**                                                                    00272003
*/**    LOCK     LOCKES A MEMBER WITH SPECIFIED LOCKID         @D52TDJS 00273003
*/**                                                                    00274003
*/**    UNLOCK   UNLOCKES A MEMBER WITH SPECIFIED LOCKID       @D52TDJS 00274103
*/**                                                                    00274203
*/**    VALID PARAMETERS FOR 'LIBDEF':                                  00274303
*/**      LDCB                                                          00274403
*/**      CHAIN                                                         00274503
*/**      CHAINID                                                       00274603
*/**      EROPT                                                         00274703
*/**      SRVEXIT                                              @D52TDJS 00274803
*/**      ERRAD                                                         00274903
*/**                                                                    00275003
*/**    VALID PARAMETERS FOR 'LIBDROP':                                 00276003
*/**      LDCB                                                          00277003
*/**      CHAINID                                                       00278003
*/**      ERRAD                                                         00279003
*/**      SRVEXIT                                              @D52TDJS 00280003
*/**      EROPT                                                         00281003
*/**                                                                    00282003
*/**    VALID PARAMETERS FOR 'STATE MEMBER':                            00283003
*/**      LDCB                                                          00284003
*/**      LIB                                                           00285003
*/**      SUBLIB                                                        00286003
*/**      MEMBER                                                        00287003
*/**      TYPE                                                          00288003
*/**      CHAINID                                                       00289003
*/**      DIRINF                                                        00290003
*/**      DIRNO                                                         00291003
*/**      DIRINFL                                                       00292003
*/**      DATA                                                          00293003
*/**      DATAID                                                        00294003
*/**      DATALEN                                                       00295003
*/**      CONT                                                          00296003
*/**      NOTFND                                                        00297003
*/**      ERRAD                                                         00298003
*/**      SRVEXIT                                              @D52TDJS 00299003
*/**      EROPT                                                         00300003
*/**                                                                    00301003
*/**    VALID PARAMETERS FOR 'STATE SUBLIB':                            00302003
*/**      LDCB                                                          00303003
*/**      LIB                                                           00304003
*/**      SUBLIB                                                        00305003
*/**      DIRINF                                                        00306003
*/**      DIRNO                                                         00307003
*/**      DIRINFL                                                       00308003
*/**      CONT                                                          00309003
*/**      NOTFND                                                        00310003
*/**      ERRAD                                                         00311003
*/**      EROPT                                                         00312003
*/**      SRVEXIT                                              @D52TDJS 00313003
*/**                                                                    00314003
*/**    VALID PARAMETERS FOR 'STATE LIB':                               00315003
*/**      LDCB                                                          00316003
*/**      LIB                                                           00317003
*/**      DIRINF                                                        00318003
*/**      DIRINFL                                                       00319003
*/**      NOTFND                                                        00320003
*/**      ERRAD                                                         00321003
*/**      EROPT                                                         00322003
*/**      SRVEXIT                                              @D52TDJS 00323003
*/**                                                                    00324003
*/**    VALID PARAMETERS FOR 'STATE CHAIN':                             00325003
*/**      LDCB                                                          00326003
*/**      SCOPE                                                         00327003
*/**      CHAIN                                                         00328003
*/**      CHAINID                                                       00329003
*/**      CATALOG                                                       00330003
*/**      NOTFND                                                        00331003
*/**      ERRAD                                                         00332003
*/**      EROPT                                                         00333003
*/**      SRVEXIT                                              @D52TDJS 00334003
*/**                                                                    00335003
*/**    VALID PARAMETERS FOR 'DELETE MEMBER':                           00336003
*/**      LDCB                                                          00337003
*/**      LIB                                                           00338003
*/**      SUBLIB                                                        00339003
*/**      CHAINID                                                       00340003
*/**      MEMBER                                                        00341003
*/**      TYPE                                                          00342003
*/**      NOTFND                                                        00343003
*/**      ERRAD                                                         00344003
*/**      EROPT                                                         00345003
*/**      SRVEXIT                                              @D52TDJS 00346003
*/**                                                                    00347003
*/**    VALID PARAMETERS FOR 'RENAME MEMBER':                           00348003
*/**      LDCB                                                          00349003
*/**      LIB                                                           00350003
*/**      SUBLIB                                                        00351003
*/**      CHAINID                                                       00352003
*/**      MEMBER                                                        00353003
*/**      TYPE                                                          00354003
*/**      NMEMBER                                                       00355003
*/**      NTYPE                                                         00356003
*/**      NOTFND                                                        00357003
*/**      ERRAD                                                         00358003
*/**      EROPT                                                         00359003
*/**      SRVEXIT                                              @D52TDJS 00359103
*/**                                                                    00359203
*/**    VALID PARAMETERS FOR 'OPEN':                                    00359303
*/**      LDCB                                                          00359403
*/**      TYPEFLE                                                       00359503
*/**      LIB                                                           00359603
*/**      SUBLIB                                                        00359703
*/**      MEMBER                                                        00359803
*/**      TYPE                                                          00359903
*/**      CHAINID                                                       00360003
*/**      BUFFER                                                        00361003
*/**      BUFSIZE                                                       00362003
*/**      RECFM                                                         00363003
*/**      SYSIPT                                                        00364003
*/**      DIRINF                                                        00365003
*/**      DIRINFL                                                       00366003
*/**      DATA                                                          00367003
*/**      DATAID                                                        00368003
*/**      DATALEN                                                       00369003
*/**      ERRAD                                                         00370003
*/**      EROPT                                                         00371003
*/**      SRVEXIT                                              @D52TDJS 00372003
*/**                                                                    00373003
*/**    VALID PARAMETERS FOR 'GET':                                     00374003
*/**      LDCB                                                          00375003
*/**      BUFFER                                                        00376003
*/**      BUFSIZE                                                       00377003
*/**      RECNO                                                         00378003
*/**      UNITS                                                         00379003
*/**      MOVELEN                                                       00380003
*/**      ERRAD                                                         00381003
*/**      EROPT                                                         00382003
*/**      EODAD                                                         00383003
*/**      SRVEXIT                                              @D52TDJS 00384003
*/**                                                                    00385003
*/**    VALID PARAMETERS FOR 'PUT':                                     00386003
*/**      LDCB                                                          00387003
*/**      BUFFER                                                        00388003
*/**      BUFSIZE                                                       00389003
*/**      RECNO                                                         00390003
*/**      UNITS                                                         00391003
*/**      EROPT                                                         00392003
*/**      ERRAD                                                         00393003
*/**      SRVEXIT                                              @D52TDJS 00394003
*/**                                                                    00395003
*/**    VALID PARAMETERS FOR 'NOTE'/'NOTEF':                   @D61YDMF 00396003
*/**      LDCB                                                          00397003
*/**      NOTECTL                                                       00398003
*/**      NOTEINF                                                       00399003
*/**      EROPT                                                         00400003
*/**      ERRAD                                                         00401003
*/**      SRVEXIT                                              @D52TDJS 00402003
*/**                                                                    00403003
*/**    VALID PARAMETERS FOR 'POINT':                                   00404003
*/**      LDCB                                                          00405003
*/**      NOTECTL                                                       00406003
*/**      NOTEINF                                                       00407003
*/**      ERRAD                                                         00408003
*/**      EROPT                                                         00409003
*/**      SRVEXIT                                              @D52TDJS 00410003
*/**                                                                    00411003
*/**    VALID PARAMETERS FOR 'CLOSE':                                   00412003
*/**      LDCB                                                          00413003
*/**      COMMIT                                                        00414003
*/**      EROPT                                                         00415003
*/**      ERRAD                                                         00416003
*/**      SRVEXIT                                              @D52TDJS 00417003
*/**                                                                    00418003
*/**    VALID PARAMETERS FOR 'CONTROL':                        @D52TDJS 00419003
*/**      ENV                                                  @D52TDJS 00420003
*/**                                                                    00420103
*/**    VALID PARAMETERS FOR 'SHOWCB':                                  00420203
*/**      LDCB | MBST | SBST | LBST | NOTEINF                           00420303
*/**      CBLEN                                                         00420403
*/**                                                                    00420503
*/**    VALID PARAMETERS FOR 'SERVER':                         @D52TDJS 00420603
*/**      FRAME            ( REQUIRED )                        @D52TDJS 00420703
*/**      SENDBF           ( REQUIRED )                        @D52TDJS 00420803
*/**      SENDBFL          ( REQUIRED )                        @D52TDJS 00420903
*/**      REQUEST          ( REQUIRED )                        @D52TDJS 00421003
*/**      MODE             ( OPTIONAL )                        @D52TDJS 00422003
*/**      WSTOR            ( REQUIRED )                        @D52TDJS 00423003
*/**      LDCB             ( OPTIONAL )                        @D52TDJS 00423103
*/**                                                                    00423203
*/**    VALID PARAMETERS FOR 'LOCK' OR 'UNLOCK':               @D52RDUT 00423303
*/**      LIB              ( REQUIRED )                        @D52RDUT 00423403
*/**      SLIB             ( REQUIRED )                        @D52RDUT 00423503
*/**      MEMBER           ( REQUIRED )                        @D52RDUT 00423603
*/**      TYPE             ( REQUIRED )                        @D52RDUT 00423703
*/**      LOCKID           ( REQUIRED )                        @D52RDUT 00423803
*/**      NOTFND           ( OPTIONAL )                        @D52RDUT 00423903
*/**      EROPT            ( OPTIONAL )                        @D52RDUT 00424003
*/**      ERRAD            ( OPTIONAL )                        @D52RDUT 00424103
*/**      SRVEXIT                                              @D52TDJS 00424203
*/**                                                                    00424303
*/*   SPACE 5                                                           00424403
*/**    PARAMETERS SPECIFIED ON THE MACRO WHICH ARE NOT NECESSARY       00424503
*/**    FOR THE REQUESTED MAIN FUNCTION ARE FILLED INTO THE             00424603
*/**    CONTROL BLOCK AND IGNORED BY THE SPECIFIC SERVICE               00424703
*/**    ROUTINE.                                                        00424803
*/**                                                                    00424903
*/*   EJECT                                                             00425003
.ENDPCP  ANOP                                                           00426003
.*                                                                      00427003
.*       DEFINITION OF MACRO VARIABLES                                  00428003
.*                                                                      00429003
&IALFC   SETC  ''                                                       00430003
&IALOP1 SETC   ''                                                       00431003
&IALOP2 SETC   ''                                                       00432003
&IALSYER SETB  0                                                        00433003
&REG     SETC  ''                                                       00434003
&CHN     SETC  ''                                                       00435003
&TSYSI   SETC  ''                                                       00436003
&TCATLOG SETC  ''                                                       00437003
&SCP     SETC  ''                                                       00438003
&NOTE    SETC  ''                                                       00439003
&NOTEIN  SETC  ''                                                       00440003
&COMM    SETC  ''                                                       00441003
.*                                                                      00442003
.*       CHECK MAIN FUNCTION                                            00443003
.*                                                                      00444003
         AIF   (T'&FUNC NE 'O').CHKLBL                                  00445003
         MNOTE 8,' MACRO FUNCTION MISSING, GENERATION SUPPRESSED'       00446003
         AGO   .MEND                                                    00447003
.*                                                                      00448003
.*       GENERATE  A LABEL                                              00449003
.*                                                                      00450003
.CHKLBL   ANOP                                                          00451003
         AIF   ('&LABEL' EQ '').NOLABEL                                 00452003
&LABEL   DS    0H                                                       00453003
.NOLABEL ANOP                                                           00454003
.*                                                            @D52TDJS  00455003
.*  FIRST HANDLE ENV REQUEST                                  @D52TDJS  00456003
.*                                                            @D52TDJS  00457003
         AIF   ('&FUNC' NE 'CONTROL').SERVER1                 @D52TDJS  00458003
         AIF   (T'&ENV NE 'O').ENVST0   ENV NOT SPECIFIED               00459003
         MNOTE 8,'ENV OPERAND MISSING, REQUEST IGNORED'       @D52TDJS  00460003
&IALSYER SETB  1                                              @D52TDJS  00460103
         AGO   .MEND                                          @D52TDJS  00460203
.ENVST0  ANOP                                                 @D52TDJS  00460303
         AIF   (&IALENVD EQ 0).ENVST1   FIRST ENV REQUEST     @D52TDJS  00460403
         MNOTE 4,'CONTROL SPECIFIED MORE THAN ONCE, REQUEST IGNORED'    00460503
         AGO   .MEND                                          @D52TDJS  00460603
.ENVST1  ANOP                                                 @D52TDJS  00460703
&IALENVD SETB 1                                               @D52TDJS  00460803
         AIF   ('&ENV' EQ 'BATCH').MEND    NOOP FOR BATCH     @D52TDJS  00460903
         AIF   ('&ENV' NE 'SERVER').ENVST2 ERROR ENV WRONG    @D52TDJS  00461003
&IALENV  SETB 1                                               @D52TDJS  00461103
         AGO   .ENVST3                                        @D52TDJS  00461203
.ENVST2  ANOP                                                 @D52TDJS  00461303
         MNOTE 8,'ENV OPERAND IS INVALID, REQUEST IGNORED'    @D52TDJS  00461403
&IALSYER SETB  1                                              @D52TDJS  00461503
.ENVST3  ANOP                                                 @D52TDJS  00461603
         AIF   (T'&CB NE 'O').ERRENV                          @D52TDJS  00461703
         AIF   (T'&CBLEN NE 'O').ERRENV                       @D52TDJS  00461803
         AIF   (T'&LDCB NE 'O').ERRENV                        @D52TDJS  00461903
         AIF   (T'&LIB NE 'O').ERRENV                         @D52TDJS  00462003
         AIF   (T'&SUBLIB NE 'O').ERRENV                      @D52TDJS  00462103
         AIF   (T'&MEMBER NE 'O').ERRENV                      @D52TDJS  00462203
         AIF   (T'&TYPE NE 'O').ERRENV                        @D52TDJS  00462303
         AIF   (T'&NMEMBER NE 'O').ERRENV                     @D52TDJS  00462403
         AIF   (T'&NTYPE NE 'O').ERRENV                       @D52TDJS  00462503
         AIF   (T'&CATALOG NE 'O').ERRENV                     @D52TDJS  00462603
         AIF   (T'&SCOPE NE 'O').ERRENV                       @D52TDJS  00462703
         AIF   (T'&BUFFER NE 'O').ERRENV                      @D52TDJS  00462803
         AIF   (T'&BUFSIZE NE 'O').ERRENV                     @D52TDJS  00462903
         AIF   (T'&COMMIT NE 'O').ERRENV                      @D52TDJS  00463003
         AIF   (T'&NOTEINF NE 'O').ERRENV                     @D52TDJS  00463103
         AIF   (T'&NOTECTL NE 'O').ERRENV                     @D52TDJS  00463203
         AIF   (T'&RECFM NE 'O').ERRENV                       @D52TDJS  00463303
         AIF   (T'&RECNO NE 'O').ERRENV                       @D52TDJS  00463403
         AIF   (T'&UNITS NE 'O').ERRENV                       @D52TDJS  00463503
         AIF   (T'&MOVELEN NE 'O').ERRENV                     @D52TDJS  00463603
         AIF   (T'&SYSIPT NE 'O').ERRENV                      @D52TDJS  00463703
         AIF   (T'&CHAIN  NE 'O').ERRENV                      @D52TDJS  00463803
         AIF   (T'&CHAINID NE 'O').ERRENV                     @D52TDJS  00463903
         AIF   (T'&DIRINF NE 'O').ERRENV                      @D52TDJS  00464003
         AIF   (T'&DIRNO  NE 'O').ERRENV                      @D52TDJS  00464103
         AIF   (T'&CONT  NE 'O').ERRENV                       @D52TDJS  00464203
         AIF   (T'&DIRINFL NE 'O').ERRENV                     @D52TDJS  00464303
         AIF   (T'&DATA NE 'O').ERRENV                        @D52TDJS  00464403
         AIF   (T'&DATAID NE 'O').ERRENV                      @D52TDJS  00464503
         AIF   (T'&DATALEN NE 'O').ERRENV                     @D52TDJS  00464603
         AIF   (T'&NOTFND NE 'O').ERRENV                      @D52TDJS  00464703
         AIF   (T'&EODAD NE 'O').ERRENV                       @D52TDJS  00464803
         AIF   (T'&EROPT NE 'O').ERRENV                       @D52TDJS  00464903
         AIF   (T'&ERRAD NE 'O').ERRENV                       @D52TDJS  00465003
         AIF   (T'&SRVEXIT NE 'O').ERRENV                     @D52TDJS  00465103
         AIF   (T'&ENTITY NE 'O').ERRENV                      @D52TDJS  00465203
         AIF   (T'&TYPEFLE NE 'O').ERRENV                     @D52TDJS  00465303
         AIF   (T'&LOCKID  NE 'O').ERRENV                     @D52RDUT  00465403
         AGO   .MEND                                          @D52TDJS  00465503
.*                                                            @D52TDJS  00465603
.*       ERREXIT FOR ENV                                      @D52TDJS  00465703
.*                                                            @D52TDJS  00465803
.ERRENV  ANOP                                                 @D52TDJS  00465903
         MNOTE 4,'FUNCTION CONTAINS INVALID PARAMETERS, PARAMETERS IGNOX00466003
               RED'                                           @D52TDJS  00466103
&IALSYER SETB 1                                               @D52TDJS  00466203
         AGO .MEND                                            @D52TDJS  00466303
.SERVER1 ANOP                                                 @D52TDJS  00466403
.*                                                            @D52TDJS  00466503
.*  HANDLE SERVER REQUEST                                     @D52TDJS  00466603
.*                                                            @D52TDJS  00466703
         AIF   ('&FUNC' NE 'SERVER').SHWCBL1                  @D52TDJS  00466803
.*                                                            @D52TDJS  00466903
.*  FRAME MUST BE SPECIFIED                                   @D52TDJS  00467003
.*                                                            @D52TDJS  00467103
         AIF   (T'&FRAME NE 'O').SERVER2                      @D52TDJS  00467203
         MNOTE 8,'PARAMETER FRAME MISSING, GENERATION SUPPRESSED'       00467303
&IALSYER SETB 1                                               @D52TDJS  00467403
         AGO .MEND                                            @D52TDJS  00467503
.SERVER2 ANOP                                                 @D52TDJS  00467603
.*                                                            @D52TDJS  00467703
.*  ONLY FRAME = READY OR MAP ALLOWED                         @D52TDJS  00467803
.*                                                            @D52TDJS  00467903
         AIF   ('&FRAME' EQ 'MAP').SERVER3                    @D52TDJS  00468003
         AIF   ('&FRAME' EQ 'READY').SERVER3                  @D52TDJS  00468103
         MNOTE 8,'INVALID FRAME OPTION, GENERATION SUPPRESSED'          00468203
&IALSYER SETB 1                                               @D52TDJS  00468303
         AGO .MEND                                            @D52TDJS  00468403
.SERVER3 ANOP                                                 @D52TDJS  00468503
         AIF   (&IALFRHD).SRV4001                             @D52TDJS  00468603
         INLCFRHD                                                       00468703
         EJECT                                                          00468803
&IALFRHD SETB 1                                               @D52TDJS  00468903
&SYSECT  CSECT          RESUME CSECT                                    00469003
.SRV4001 ANOP                                                 @D52TDJS  00469103
         AIF   ('&FRAME' NE 'MAP').SERVER4                    @D52TDJS  00469203
.*                                                            @D52TDJS  00469303
.*  FRAME = MAP                                               @D52TDJS  00469403
.*                                                            @D52TDJS  00469503
.*                                                            @D52TDJS  00469603
.*  NO OTHER PARAMETER ALLOWED                                @D52TDJS  00469703
.*                                                            @D52TDJS  00469803
         AIF   (T'&CB NE 'O').SRVERR1                         @D52TDJS  00469903
         AIF   (T'&CBLEN NE 'O').SRVERR1                      @D52TDJS  00470003
         AIF   (T'&LDCB NE 'O').SRVERR1                       @D52TDJS  00470103
         AIF   (T'&LIB NE 'O').SRVERR1                        @D52TDJS  00470203
         AIF   (T'&SUBLIB NE 'O').SRVERR1                     @D52TDJS  00470303
         AIF   (T'&MEMBER NE 'O').SRVERR1                     @D52TDJS  00470403
         AIF   (T'&TYPE NE 'O').SRVERR1                       @D52TDJS  00470503
         AIF   (T'&NMEMBER NE 'O').SRVERR1                    @D52TDJS  00470603
         AIF   (T'&NTYPE NE 'O').SRVERR1                      @D52TDJS  00470703
         AIF   (T'&CATALOG NE 'O').SRVERR1                    @D52TDJS  00470803
         AIF   (T'&SCOPE NE 'O').SRVERR1                      @D52TDJS  00470903
         AIF   (T'&BUFFER NE 'O').SRVERR1                     @D52TDJS  00471003
         AIF   (T'&BUFSIZE NE 'O').SRVERR1                    @D52TDJS  00471103
         AIF   (T'&COMMIT NE 'O').SRVERR1                     @D52TDJS  00471203
         AIF   (T'&NOTEINF NE 'O').SRVERR1                    @D52TDJS  00471303
         AIF   (T'&NOTECTL NE 'O').SRVERR1                    @D52TDJS  00471403
         AIF   (T'&RECFM NE 'O').SRVERR1                      @D52TDJS  00471503
         AIF   (T'&RECNO NE 'O').SRVERR1                      @D52TDJS  00471603
         AIF   (T'&UNITS NE 'O').SRVERR1                      @D52TDJS  00471703
         AIF   (T'&MOVELEN NE 'O').SRVERR1                    @D52TDJS  00471803
         AIF   (T'&SYSIPT NE 'O').SRVERR1                     @D52TDJS  00471903
         AIF   (T'&CHAIN  NE 'O').SRVERR1                     @D52TDJS  00472003
         AIF   (T'&CHAINID NE 'O').SRVERR1                    @D52TDJS  00472103
         AIF   (T'&DIRINF NE 'O').SRVERR1                     @D52TDJS  00472203
         AIF   (T'&DIRNO  NE 'O').SRVERR1                     @D52TDJS  00472303
         AIF   (T'&CONT  NE 'O').SRVERR1                      @D52TDJS  00472403
         AIF   (T'&DIRINFL NE 'O').SRVERR1                    @D52TDJS  00472503
         AIF   (T'&DATA NE 'O').SRVERR1                       @D52TDJS  00472603
         AIF   (T'&DATAID NE 'O').SRVERR1                     @D52TDJS  00472703
         AIF   (T'&DATALEN NE 'O').SRVERR1                    @D52TDJS  00472803
         AIF   (T'&NOTFND NE 'O').SRVERR1                     @D52TDJS  00472903
         AIF   (T'&EODAD NE 'O').SRVERR1                      @D52TDJS  00473003
         AIF   (T'&EROPT NE 'O').SRVERR1                      @D52TDJS  00473103
         AIF   (T'&ERRAD NE 'O').SRVERR1                      @D52TDJS  00473203
         AIF   (T'&SRVEXIT NE 'O').SRVERR1                    @D52TDJS  00473303
         AIF   (T'&ENTITY NE 'O').SRVERR1                     @D52TDJS  00473403
         AIF   (T'&TYPEFLE NE 'O').SRVERR1                    @D52TDJS  00473503
         AIF   (T'&ENV NE 'O').SRVERR1                        @D52TDJS  00473603
         AIF   (T'&SENDBF NE 'O').SRVERR1                     @D52TDJS  00473703
         AIF   (T'&SENDBFL NE 'O').SRVERR1                    @D52TDJS  00473803
         AIF   (T'&REQUEST NE 'O').SRVERR1                    @D52TDJS  00473903
         AIF   (T'&MODE NE 'O').SRVERR1                       @D52TDJS  00474003
         AIF   (T'&WSTOR NE 'O').SRVERR1                      @D52TDJS  00474103
         AIF   (T'&LOCKID NE 'O').SRVERR1                     @D52RDUT  00474203
         AGO    .MEND                                         @D52TDJS  00474303
.SRVERR1 ANOP                                                 @D52TDJS  00474403
         MNOTE 4,'ALL OTHER PARAMETERS ARE IGNORED FOR FRAME=MAP'       00474503
         AGO .MEND                                            @D52TDJS  00474603
.SERVER4 ANOP                                                 @D52TDJS  00474703
.*                                                            @D52TDJS  00474803
.*  FRAME = READY                                             @D52TDJS  00474903
.*                                                            @D52TDJS  00475003
.*                                                            @D52TDJS  00475103
.*  SENDBF,SENDBFL, REQUEST AND WSTOR IS MANDATORY            @D52TDJS  00475203
.*                                                            @D52TDJS  00475303
         AIF   (T'&SENDBF EQ 'O').SRV4011                     @D52TDJS  00475403
         AIF   (T'&SENDBFL EQ 'O').SRV4011                    @D52TDJS  00475503
         AIF   (T'&REQUEST EQ 'O').SRV4011                    @D52TDJS  00475603
         AIF   (T'&WSTOR EQ 'O').SRV4011                      @D52TDJS  00475703
         AGO .SRV4002                                         @D52TDJS  00475803
.SRV4011 ANOP                                                 @D52TDJS  00475903
         MNOTE 8,'MANDATORY OPERAND MISSING,GENERATION SUPPRESSED'      00476003
&IALSYER SETB 1                                               @D52TDJS  00476103
         AGO .MEND                                            @D52TDJS  00476203
.SRV4002 ANOP                                                 @D52TDJS  00476303
.*                                                            @D52TDJS  00476403
.*  LDCB MUST BE SPECIFIED FOR API                            @D52TDJS  00476503
.*                                                            @D52TDJS  00476603
         AIF   ('&REQUEST' NE 'API').SRV4003                  @D52TDJS  00476703
         AIF   (T'&LDCB NE 'O').SRV4003                       @D52TDJS  00476803
      MNOTE 8,'LDCB REQUIRED FOR REQUEST=API, GENERATION SUPPRESSED'    00476903
&IALSYER SETB 1                                               @D52TDJS  00477003
         AGO .MEND                                            @D52TDJS  00477103
.SRV4003 ANOP                                                 @D52TDJS  00477203
.*                                                            @D52TDJS  00477303
.*  CHECK REQUEST OPERAND                                     @D52TDJS  00477403
.*                                                            @D52TDJS  00477503
         AIF   ('&REQUEST' EQ 'API').SRV4004                  @D52TDJS  00477603
         AIF   ('&REQUEST' EQ 'COMMAND').SRV4004              @D52TDJS  00477703
         AIF   ('&REQUEST' EQ 'RESET').SRV4004                @D52TDJS  00477803
      MNOTE 8,'REQUEST OPTION INVALID, GENERATION SUPPRESSED'           00477903
&IALSYER SETB 1                                               @D52TDJS  00478003
         AGO .MEND                                            @D52TDJS  00478103
.SRV4004 ANOP                                                 @D52TDJS  00478203
.*                                                            @D52TDJS  00478303
.*  CHECK MODE OPERAND                                        @D52TDJS  00478403
.*                                                            @D52TDJS  00478503
         AIF   (T'&MODE EQ 'O').SRV4005                       @D52TDJS  00478603
         AIF   ('&MODE' EQ 'CONTINUE').SRV4005                @D52TDJS  00478703
         AIF   ('&MODE' EQ 'STOP').SRV4005                    @D52TDJS  00478803
      MNOTE 8,'MODE OPTION INVALID, GENERATION SUPPRESSED'              00478903
&IALSYER SETB 1                                               @D52TDJS  00479003
         AGO .MEND                                            @D52TDJS  00479103
.SRV4005 ANOP                                                 @D52TDJS  00479203
.*                                                            @D52TDJS  00479303
.*  NO OTHER PARAMETER ALLOWED                                @D52TDJS  00479403
.*                                                            @D52TDJS  00479503
         AIF   (T'&CB NE 'O').SRVERR2                         @D52TDJS  00479603
         AIF   (T'&CBLEN NE 'O').SRVERR2                      @D52TDJS  00479703
         AIF   (T'&LIB NE 'O').SRVERR2                        @D52TDJS  00479803
         AIF   (T'&SUBLIB NE 'O').SRVERR2                     @D52TDJS  00479903
         AIF   (T'&MEMBER NE 'O').SRVERR2                     @D52TDJS  00480003
         AIF   (T'&TYPE NE 'O').SRVERR2                       @D52TDJS  00480103
         AIF   (T'&NMEMBER NE 'O').SRVERR2                    @D52TDJS  00480203
         AIF   (T'&NTYPE NE 'O').SRVERR2                      @D52TDJS  00480303
         AIF   (T'&CATALOG NE 'O').SRVERR2                    @D52TDJS  00480403
         AIF   (T'&SCOPE NE 'O').SRVERR2                      @D52TDJS  00480503
         AIF   (T'&BUFFER NE 'O').SRVERR2                     @D52TDJS  00480603
         AIF   (T'&BUFSIZE NE 'O').SRVERR2                    @D52TDJS  00480703
         AIF   (T'&COMMIT NE 'O').SRVERR2                     @D52TDJS  00480803
         AIF   (T'&NOTEINF NE 'O').SRVERR2                    @D52TDJS  00480903
         AIF   (T'&NOTECTL NE 'O').SRVERR2                    @D52TDJS  00481003
         AIF   (T'&RECFM NE 'O').SRVERR2                      @D52TDJS  00481103
         AIF   (T'&RECNO NE 'O').SRVERR2                      @D52TDJS  00481203
         AIF   (T'&UNITS NE 'O').SRVERR2                      @D52TDJS  00481303
         AIF   (T'&MOVELEN NE 'O').SRVERR2                    @D52TDJS  00481403
         AIF   (T'&SYSIPT NE 'O').SRVERR2                     @D52TDJS  00481503
         AIF   (T'&CHAIN  NE 'O').SRVERR2                     @D52TDJS  00481603
         AIF   (T'&CHAINID NE 'O').SRVERR2                    @D52TDJS  00481703
         AIF   (T'&DIRINF NE 'O').SRVERR2                     @D52TDJS  00481803
         AIF   (T'&DIRNO  NE 'O').SRVERR2                     @D52TDJS  00481903
         AIF   (T'&CONT  NE 'O').SRVERR2                      @D52TDJS  00482003
         AIF   (T'&DIRINFL NE 'O').SRVERR2                    @D52TDJS  00482103
         AIF   (T'&DATA NE 'O').SRVERR2                       @D52TDJS  00482203
         AIF   (T'&DATAID NE 'O').SRVERR2                     @D52TDJS  00482303
         AIF   (T'&DATALEN NE 'O').SRVERR2                    @D52TDJS  00482403
         AIF   (T'&NOTFND NE 'O').SRVERR2                     @D52TDJS  00482503
         AIF   (T'&EODAD NE 'O').SRVERR2                      @D52TDJS  00482603
         AIF   (T'&EROPT NE 'O').SRVERR2                      @D52TDJS  00482703
         AIF   (T'&ERRAD NE 'O').SRVERR2                      @D52TDJS  00482803
         AIF   (T'&SRVEXIT NE 'O').SRVERR2                    @D52TDJS  00482903
         AIF   (T'&ENTITY NE 'O').SRVERR2                     @D52TDJS  00483003
         AIF   (T'&TYPEFLE NE 'O').SRVERR2                    @D52TDJS  00483103
         AIF   (T'&ENV NE 'O').SRVERR2                        @D52TDJS  00483203
         AIF   (T'&LOCKID NE 'O').SRVERR2                     @D52RDUT  00483303
         AGO   .SRV4006                                       @D52TDJS  00483403
.SRVERR2 ANOP                                                 @D52TDJS  00483503
         MNOTE 4,'FUNCTION CONTAINS INVALID PARAMETERS, PARAMETERS IGNOX00483603
               RED'                                           @D52TDJS  00483703
&IALSYER SETB 1                                               @D52TDJS  00483803
         AGO .MEND                                            @D52TDJS  00483903
.SRV4006 ANOP                                                 @D52TDJS  00484003
.*                                                            @D52TDJS  00484103
.*  BUILD I/F AREA ADDRESSED BY WSTOR                         @D52TDJS  00484203
.*                                                            @D52TDJS  00484303
         AIF   ('&WSTOR'(1,1) NE'(').SRV5001                  @D52TDJS  00484403
&REG     SETC '&WSTOR'(2,K'&WSTOR-2)                          @D52TDJS  00484503
         LR   &REG,FRHDRG1       ADDRESS I/F AREA                       00484603
         AGO  .SRV5002                                        @D52TDJS  00484703
.SRV5001 ANOP                                                 @D52TDJS  00484803
         LA   FRHDRG1,&WSTOR     ADDRESS I/F AREA                       00484903
.SRV5002 ANOP                                                 @D52TDJS  00485003
         USING FRHDIFMA,FRHDRG1                                         00485103
         XC    FRHDIFMA(FRHDLIFA),FRHDIFMA                              00485203
.*                                                            @D52TDJS  00485303
.*  STORE SENDBF                                              @D52TDJS  00485403
.*                                                            @D52TDJS  00485503
         AIF   ('&SENDBF'(1,1) NE'(').SRV5003                 @D52TDJS  00485603
&REG     SETC '&SENDBF'(2,K'&SENDBF-2)                        @D52TDJS  00485703
         ST   &REG,FRHDIFBA      SENDBF ADDRESS               @D52TDJS  00485803
         AGO  .SRV5004                                        @D52TDJS  00485903
.SRV5003 ANOP                                                 @D52TDJS  00486003
         LA   FRHDRG0,&SENDBF    SENDBF ADDRESS                         00486103
         ST   FRHDRG0,FRHDIFBA                                          00486203
.SRV5004 ANOP                                                 @D52TDJS  00486303
.*                                                            @D52TDJS  00486403
.*  STORE SENDBFL                                             @D52TDJS  00486503
.*                                                            @D52TDJS  00486603
         AIF   ('&SENDBFL'(1,1) NE'(').SRV5005                @D52TDJS  00486703
&REG     SETC '&SENDBFL'(2,K'&SENDBFL-2)                      @D52TDJS  00486803
         ST   &REG,FRHDIFBL      SENDBF LENGTH                @D52TDJS  00486903
         AGO  .SRV5006                                        @D52TDJS  00487003
.SRV5005 ANOP                                                 @D52TDJS  00487103
         LA   FRHDRG0,&SENDBFL   SENDBF LENGTH                          00487203
         ST   FRHDRG0,FRHDIFBL                                          00487303
.SRV5006 ANOP                                                 @D52TDJS  00487403
.*                                                            @D52TDJS  00487503
.*  STORE LDCB                                                @D52TDJS  00487603
.*                                                            @D52TDJS  00487703
         AIF   (T'&LDCB EQ 'O').SRV5008                       @D52TDJS  00487803
         AIF   ('&LDCB'(1,1) NE'(').SRV5007                   @D52TDJS  00487903
&REG     SETC '&LDCB'(2,K'&LDCB-2)                            @D52TDJS  00488003
         ST   &REG,FRHDIFLA      LDCB ADDRESS                 @D52TDJS  00488103
         AGO  .SRV5008                                        @D52TDJS  00488203
.SRV5007 ANOP                                                 @D52TDJS  00488303
         LA   FRHDRG0,&LDCB      LDCB ADDRESS                           00488403
         ST   FRHDRG0,FRHDIFLA                                          00488503
.SRV5008 ANOP                                                 @D52TDJS  00488603
.*                                                            @D52TDJS  00488703
.*  STORE THE REQUEST                                         @D52TDJS  00488803
.*                                                            @D52TDJS  00488903
         AIF   ('&REQUEST' NE 'API').SRV5009                  @D52TDJS  00489003
         MVI FRHDIFRQ,FRHDAPI   API FRAME REQUEST                       00489103
         AGO   .SRV6001                                       @D52TDJS  00489203
.SRV5009 ANOP                                                 @D52TDJS  00489303
         AIF   ('&REQUEST' NE 'COMMAND').SRV5010              @D52TDJS  00489403
         MVI FRHDIFRQ,FRHDCMD   COMMAND FRAME REQUEST                   00489503
         AGO   .SRV6001                                       @D52TDJS  00489603
.SRV5010 ANOP                                                 @D52TDJS  00489703
         AIF   ('&REQUEST' NE 'RESET').SRV5011                @D52TDJS  00489803
         MVI FRHDIFRQ,FRHDRSET  RESET FRAME REQUEST                     00489903
         AGO   .SRV6001                                       @D52TDJS  00490003
.SRV5011 ANOP                                                 @D52TDJS  00490103
.*                                                            @D52TDJS  00490203
.SRV6001 ANOP                                                 @D52TDJS  00490303
.*                                                            @D52TDJS  00490403
.*  STORE THE MODE                                            @D52TDJS  00490503
.*                                                            @D52TDJS  00490603
         AIF   ('&MODE' NE 'CONTINUE').SRV6002                @D52TDJS  00490703
         MVI FRHDIFMD,FRHDCONT   CONTINUATION MODE                      00490803
         AGO   .SRV7001                                       @D52TDJS  00490903
.SRV6002 ANOP                                                 @D52TDJS  00491003
         AIF   ('&MODE' NE 'STOP').SRV6003                    @D52TDJS  00491103
         MVI FRHDIFMD,FRHDSTOP   COMMAND FRAME REQUEST                  00491203
         AGO   .SRV7001                                       @D52TDJS  00491303
.SRV6003 ANOP                                                 @D52TDJS  00491403
.*                                                                      00491503
.SRV7001 ANOP                                                 @D52TDJS  00491603
         DROP FRHDRG1                                                   00491703
         LA    FRHDRG0,120              SET CODE TO CALL INLPFRSP       00491803
         ASYSCOM FRHDRG15                                               00491903
         L     FRHDRG15,300(0,FRHDRG15) ADDRESS OF LPT                  00492003
         L     FRHDRG15,0(0,FRHDRG15)   ADDRESS OF SVA PHASE $IJBLBR    00492103
         BALR  FRHDRG14,FRHDRG15        BRANCH TO $IJBLBR-INLPFRSP      00492203
         AGO .MEND                                            @D52TDJS  00492303
.SHWCBL1 ANOP                                                 @D52TDJS  00492403
.*                                                                      00492503
.*  HANDLE SHOWCB REQUEST                                               00492603
.*                                                                      00492703
         AIF   ('&FUNC' NE 'SHOWCB').CHKFRST                            00492803
&IALFC   SETC  'SHOWCB'           SET FUNCTION CODE FOR CONTROL BLOCK   00492903
.*                                                                      00493003
.*       CBLEN MUST BE SPECIFIED                                        00493103
.*                                                                      00493203
         AIF   (K'&CBLEN GT 0).CKSHCB0                                  00493303
         MNOTE  8,'CBLEN MUST BE SPECIFIED, GENERATION SUPPRESSED'      00493403
&IALSYER SETB 1                                                         00493503
.CKSHCB0 ANOP                                                           00493603
         AIF   (T'&LDCB NE 'O').ERRSHB                                  00493703
         AIF   (T'&LIB NE 'O').ERRSHB                                   00493803
         AIF   (T'&SUBLIB NE 'O').ERRSHB                                00493903
         AIF   (T'&MEMBER NE 'O').ERRSHB                                00494003
         AIF   (T'&TYPE NE 'O').ERRSHB                                  00494103
         AIF   (T'&NMEMBER NE 'O').ERRSHB                               00494203
         AIF   (T'&NTYPE NE 'O').ERRSHB                                 00494303
         AIF   (T'&CATALOG NE 'O').ERRSHB                               00494403
         AIF   (T'&SCOPE NE 'O').ERRSHB                                 00494503
         AIF   (T'&BUFFER NE 'O').ERRSHB                                00494603
         AIF   (T'&BUFSIZE NE 'O').ERRSHB                               00494703
         AIF   (T'&COMMIT NE 'O').ERRSHB                                00494803
         AIF   (T'&NOTEINF NE 'O').ERRSHB                               00494903
         AIF   (T'&NOTECTL NE 'O').ERRSHB                               00495003
         AIF   (T'&RECFM NE 'O').ERRSHB                                 00495103
         AIF   (T'&RECNO NE 'O').ERRSHB                                 00495203
         AIF   (T'&UNITS NE 'O').ERRSHB                                 00495303
         AIF   (T'&MOVELEN NE 'O').ERRSHB                               00495403
         AIF   (T'&SYSIPT NE 'O').ERRSHB                                00495503
         AIF   (T'&CHAIN  NE 'O').ERRSHB                                00495603
         AIF   (T'&CHAINID NE 'O').ERRSHB                               00495703
         AIF   (T'&DIRINF NE 'O').ERRSHB                                00495803
         AIF   (T'&DIRNO  NE 'O').ERRSHB                                00495903
         AIF   (T'&CONT  NE 'O').ERRSHB                                 00496003
         AIF   (T'&DIRINFL NE 'O').ERRSHB                               00497003
         AIF   (T'&DATA NE 'O').ERRSHB                                  00498003
         AIF   (T'&DATAID NE 'O').ERRSHB                                00499003
         AIF   (T'&DATALEN NE 'O').ERRSHB                               00500003
         AIF   (T'&NOTFND NE 'O').ERRSHB                                00501003
         AIF   (T'&EODAD NE 'O').ERRSHB                                 00502003
         AIF   (T'&EROPT NE 'O').ERRSHB                                 00503003
         AIF   (T'&ERRAD NE 'O').ERRSHB                                 00504003
         AIF   (T'&SRVEXIT NE 'O').ERRSHB                      @D52TDJS 00504103
         AIF   (T'&ENTITY NE 'O').ERRSHB                                00504203
         AIF   (T'&TYPEFLE NE 'O').ERRSHB                               00504303
         AIF   (T'&ENV NE 'O').ERRSHB                          @D52TDJS 00504403
         AIF   (T'&LOCKID NE 'O').ERRSHB                       @D52RDUT 00504503
         AIF   (NOT(&IALSYER)).CKSHCB1     CBLEN MISSING                00504603
         AGO   .MEND                                                    00504703
.CKSHCB1 ANOP                                                           00504803
.*                                                                      00504903
.*       SPECIAL INTERFACE CONVENTION AT SHOWCB                         00505003
.*                                                                      00506003
         AIF ('&CB' NE 'LDCB').CKSHCB2                                  00507003
&IALINN  SETB 1                                                         00508003
         LIBRDCB FUNC=MAP                                               00509003
         L     IALCBR1,=X'80000001'   INDICATE SHOWCB(LDCB)             00510003
         AGO .INVSH                                                     00511003
.CKSHCB2 ANOP                                                           00512003
         AIF ('&CB' NE 'MBST').CKSHCB3                                  00513003
&IALINN  SETB 1                                                         00514003
         LIBRDCB FUNC=MAP                                               00515003
         L     IALCBR1,=X'80000002'   INDICATE SHOWCB(MBST)             00516003
         AGO .INVSH                                                     00517003
.CKSHCB3 ANOP                                                           00518003
         AIF ('&CB' NE 'SBST').CKSHCB4                                  00519003
&IALINN  SETB 1                                                         00520003
         LIBRDCB FUNC=MAP                                               00521003
         L     IALCBR1,=X'80000003'   INDICATE SHOWCB(SBST)             00522003
         AGO .INVSH                                                     00523003
.CKSHCB4 ANOP                                                           00524003
         AIF ('&CB' NE 'LBST').CKSHCB5                                  00525003
&IALINN  SETB 1                                                         00526003
         LIBRDCB FUNC=MAP                                               00527003
         L     IALCBR1,=X'80000004'   INDICATE SHOWCB(LBST)             00528003
         AGO .INVSH                                                     00529003
.CKSHCB5 ANOP                                                           00530003
         AIF ('&CB' NE 'NOTEINF').CKSHCB6                               00531003
&IALINN  SETB 1                                                         00532003
         LIBRDCB FUNC=MAP                                               00533003
         L     IALCBR1,=X'80000005'   INDICATE SHOWCB(NOTEINF)          00534003
         AGO .INVSH                                                     00535003
.*                                                                      00536003
.*  INVOCATION OF SHOWCB SERVICE IN $IJBLBR                             00537003
.*                                                                      00538003
.INVSH   ANOP                                                           00539003
         LA    IALCBR0,120              CALL INLPFRSP          @D52TDJS 00540003
         ASYSCOM IALCBR15                                               00541003
         L     IALCBR15,300(0,IALCBR15) ADDRESS OF LPT                  00542003
         L     IALCBR15,0(0,IALCBR15)   ADDRESS OF SVA PHASE $IJBLBR    00543003
         BALR  IALCBR14,IALCBR15        BRANCH TO $IJBLBR-INLPIALC      00544003
         AIF   ('&CBLEN'(1,1) NE '(').SHCBNRG                           00545003
&REG     SETC '&CBLEN'(2,K'&CBLEN-2)                                    00546003
         ST  IALCBR0,0(,&REG)                                           00547003
         AGO  .MEND                                                     00548003
.SHCBNRG ANOP                                                           00549003
         ST IALCBR0,&CBLEN              STORE R0 IN CBLEN               00550003
         AGO  .MEND                                                     00551003
.CKSHCB6 ANOP                                                           00552003
         MNOTE 8,'INVALID CONTROL BLOCK FOR SHOWCB, GENERATION SUPPRESSX00553003
               ED'                                                      00554003
         AGO   .MEND                                                    00555003
.*                                                                      00556003
.*       ERREXIT FOR SHOWCB                                             00557003
.*                                                                      00558003
.ERRSHB  ANOP                                                           00559003
         MNOTE 8,'FUNCTION CONTAINS INVALID PARAMETERS, GENERATION SUPPX00560003
               RESSED'                                                  00561003
         AGO .MEND                                                      00562003
.*                                                                      00563003
.*        CHECK VALIDATION OF PARAMETERS FOR SPECIFIED FUNCTION         00564003
.*                                                                      00565003
.*        LDCB MUST BE SPECIFIED IN ALL REQUESTS                        00566003
.*                                                                      00567003
.CHKFRST ANOP                                                           00568003
         AIF   (T'&LDCB NE 'O').CHKOVAL                                 00569003
         MNOTE 8,'LDCB MISSING, GENERATION SUPPRESSED'                  00570003
&IALSYER SETB  1                                                        00571003
.CHKOVAL ANOP                                                           00572003
.*                                                                      00573003
.*                                                                      00574003
.*        LIBDEF/LIBDROP                                                00575003
.*                                                                      00576003
.CHKLIB  ANOP                                                           00577003
         AIF   ('&FUNC' NE 'LIBDEF').CHKDROP                            00578003
&IALFC   SETC  'LIBDEF'            SET FUNCTION CODE FOR CONTROL BLOCK  00579003
&CHN     SETC  '&CHAIN'             SET CHAIN,IF SPECIFIED AS CHAIN     00580003
         AGO  .CHKLBDD                                                  00581003
.CHKDROP ANOP                                                           00582003
         AIF  ('&FUNC' NE 'LIBDROP').CHKSTAT                            00583003
&IALFC   SETC  'LIBDROP'            SET FUNCTION CODE FOR CONTROL BLOCK 00584003
         AIF   (T'&CHAIN  NE 'O').ERREXT                                00585003
.CHKLBDD ANOP                                                           00586003
         AIF   (T'&LIB NE 'O').ERREXT                                   00587003
         AIF   (T'&SUBLIB NE 'O').ERREXT                                00588003
         AIF   (T'&MEMBER NE 'O').ERREXT                                00589003
         AIF   (T'&TYPE NE 'O').ERREXT                                  00590003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               00591003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 00592003
         AIF   (T'&CATALOG NE 'O').ERREXT                               00593003
         AIF   (T'&SCOPE NE 'O').ERREXT                                 00594003
         AIF   (T'&BUFFER NE 'O').ERREXT                                00595003
         AIF   (T'&BUFSIZE NE 'O').ERREXT                               00596003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00597003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               00598003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               00599003
         AIF   (T'&RECFM NE 'O').ERREXT                                 00600003
         AIF   (T'&RECNO NE 'O').ERREXT                                 00601003
         AIF   (T'&UNITS NE 'O').ERREXT                                 00602003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               00603003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                00604003
         AIF   (T'&DIRINF NE 'O').ERREXT                                00605003
         AIF   (T'&DIRNO  NE 'O').ERREXT                                00606003
         AIF   (T'&CONT  NE 'O').ERREXT                                 00607003
         AIF   (T'&DIRINFL NE 'O').ERREXT                               00608003
         AIF   (T'&DATA NE 'O').ERREXT                                  00609003
         AIF   (T'&DATAID NE 'O').ERREXT                                00610003
         AIF   (T'&DATALEN NE 'O').ERREXT                               00611003
         AIF   (T'&NOTFND NE 'O').ERREXT                                00612003
         AIF   (T'&EODAD NE 'O').ERREXT                                 00613003
         AIF   (T'&CB NE 'O').ERREXT                                    00614003
         AIF   (T'&CBLEN NE 'O').ERREXT                                 00615003
         AIF   (T'&ENTITY NE 'O').ERREXT                                00616003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 00617003
         AIF   (T'&LOCKID NE 'O').ERREXT                       @D52RDUT 00618003
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               00619003
         AGO   .CHKFUN                                                  00620003
.*                                                                      00621003
.*       STATE MEMBER,SUBLIB,LIB,CHAINID,CHAIN                          00622003
.*                                                                      00623003
.CHKSTAT ANOP                                                           00624003
         AIF   ('&FUNC' NE 'STATE').CHKDELM                             00625003
.*       STATE MEMBER                                                   00626003
         AIF   (T'&ENTITY EQ 'O').CHKSTME                               00627003
         AIF   ('&ENTITY' EQ 'MEMBER').CHKSTME                          00628003
         AGO   .CHKSTSL                                                 00629003
.CHKSTME ANOP                                                           00630003
&IALFC   SETC  'STATMBR'         SET FUNCTION CODE FOR CONTROL BLOCK    00631003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               00632003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 00633003
         AIF   (T'&CATALOG NE 'O').ERREXT                               00634003
         AIF   (T'&SCOPE NE 'O').ERREXT                                 00635003
         AIF   (T'&BUFFER NE 'O').ERREXT                                00636003
         AIF   (T'&BUFSIZE NE 'O').ERREXT                               00637003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00638003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               00639003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               00640003
         AIF   (T'&RECFM NE 'O').ERREXT                                 00641003
         AIF   (T'&RECNO NE 'O').ERREXT                                 00642003
         AIF   (T'&UNITS NE 'O').ERREXT                                 00643003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               00644003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                00645003
         AIF   (T'&CHAIN  NE 'O').ERREXT                                00646003
         AIF   (T'&EODAD NE 'O').ERREXT                                 00647003
         AIF   (T'&CB NE 'O').ERREXT                                    00648003
         AIF   (T'&CBLEN NE 'O').ERREXT                                 00649003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 00650003
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               00651003
         AGO   .CHKFUN                                                  00652003
.*       STATE SUBLIB                                                   00653003
.CHKSTSL ANOP                                                           00654003
         AIF   ('&ENTITY' NE 'SUBLIB').CHKSTLI                          00655003
&IALFC   SETC  'STATSLIB'        SET FUNCTION CODE FOR CONTROL BLOCK    00656003
.CHKSTS1 ANOP                                                           00657003
         AIF   (T'&MEMBER NE 'O').ERREXT                                00658003
         AIF   (T'&TYPE NE 'O').ERREXT                                  00659003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               00660003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 00661003
         AIF   (T'&CATALOG NE 'O').ERREXT                               00662003
         AIF   (T'&SCOPE NE 'O').ERREXT                                 00663003
         AIF   (T'&BUFFER NE 'O').ERREXT                                00664003
         AIF   (T'&BUFSIZE NE 'O').ERREXT                               00665003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00666003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               00667003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               00668003
         AIF   (T'&RECFM NE 'O').ERREXT                                 00669003
         AIF   (T'&RECNO NE 'O').ERREXT                                 00670003
         AIF   (T'&UNITS NE 'O').ERREXT                                 00671003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               00672003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                00673003
         AIF   (T'&CHAIN  NE 'O').ERREXT                                00674003
         AIF   (T'&CHAINID NE 'O').ERREXT                               00675003
         AIF   (T'&DATA NE 'O').ERREXT                                  00676003
         AIF   (T'&DATAID NE 'O').ERREXT                                00677003
         AIF   (T'&DATALEN NE 'O').ERREXT                               00678003
         AIF   (T'&EODAD NE 'O').ERREXT                                 00679003
         AIF   (T'&CB NE 'O').ERREXT                                    00680003
         AIF   (T'&CBLEN NE 'O').ERREXT                                 00681003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 00682003
         AIF   (T'&LOCKID NE 'O').ERREXT                       @D52RDUT 00683003
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               00684003
         AGO   .CHKFUN                                                  00685003
.*       STATE LIB                                                      00686003
.CHKSTLI ANOP                                                           00687003
         AIF   ('&ENTITY' NE 'LIB').CHKSTCI                             00688003
&IALFC   SETC  'STATLIB'        SET FUNCTION CODE FOR CONTROL BLOCK     00689003
         AIF   (T'&SUBLIB NE 'O').ERREXT                                00690003
         AIF   (T'&MEMBER NE 'O').ERREXT                                00691003
         AIF   (T'&TYPE NE 'O').ERREXT                                  00692003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               00693003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 00694003
         AIF   (T'&CATALOG NE 'O').ERREXT                               00695003
         AIF   (T'&SCOPE NE 'O').ERREXT                                 00696003
         AIF   (T'&BUFFER NE 'O').ERREXT                                00697003
         AIF   (T'&BUFSIZE NE 'O').ERREXT                               00698003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00699003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               00700003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               00701003
         AIF   (T'&RECFM NE 'O').ERREXT                                 00702003
         AIF   (T'&RECNO NE 'O').ERREXT                                 00703003
         AIF   (T'&UNITS NE 'O').ERREXT                                 00704003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               00705003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                00706003
         AIF   (T'&CHAIN  NE 'O').ERREXT                                00707003
         AIF   (T'&CHAINID NE 'O').ERREXT                               00708003
         AIF   (T'&DIRNO  NE 'O').ERREXT                                00709003
         AIF   (T'&CONT  NE 'O').ERREXT                                 00710003
         AIF   (T'&DATA NE 'O').ERREXT                                  00711003
         AIF   (T'&DATAID NE 'O').ERREXT                                00712003
         AIF   (T'&DATALEN NE 'O').ERREXT                               00713003
         AIF   (T'&EODAD NE 'O').ERREXT                                 00714003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 00715003
         AIF   (T'&LOCKID NE 'O').ERREXT                       @D52RDUT 00715103
         AIF   (T'&CB NE 'O').ERREXT                                    00715203
         AIF   (T'&CBLEN NE 'O').ERREXT                                 00715303
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               00715403
         AGO   .CHKFUN                                                  00715503
.CHKSTCI ANOP                                                           00715603
.*       STATE CHAIN                                                    00715703
.CHKSTCH ANOP                                                           00715803
         AIF   ('&ENTITY' EQ 'CHAIN').CKSTCH                            00715903
.*       ENTITY WRONG                                                   00716003
         MNOTE 8,'WRONG ENTITY FOR FUNCTION STATE, GENERATION SUPPRESSEX00717003
               D'                                                       00718003
&IALSYER SETB 1                                                         00719003
         AGO  .CHKFUN                                                   00720003
.CKSTCH  ANOP                                                           00721003
&IALFC   SETC  'STATCHN'         SET FUNCTION CODE FOR CONTROL BLOCK    00722003
         AIF   (K'&SCOPE NE 0).CKSTCH1                                  00723003
&SCP     SETC  'TASK'             SET SCOPE TO DEFAULT                  00724003
         AGO   .CKSTCH2                                                 00725003
.CKSTCH1 ANOP                                                           00726003
&SCP     SETC  '&SCOPE'                                                 00727003
.CKSTCH2 ANOP                                                           00728003
         AIF  (K'&CHAIN EQ 0).CKSTCH3                                   00729003
&CHN     SETC  '&CHAIN'             SET CHAIN,IF SPECIFIED              00730003
.CKSTCH3 ANOP                                                           00731003
&TCATLOG SETC  '&CATALOG'           SET CATALOG AS HERE DEFINED         00732003
         AIF   (T'&LIB NE 'O').ERREXT                                   00733003
         AIF   (T'&SUBLIB NE 'O').ERREXT                                00734003
         AIF   (T'&MEMBER NE 'O').ERREXT                                00735003
         AIF   (T'&TYPE NE 'O').ERREXT                                  00736003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               00737003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 00738003
         AIF   (T'&BUFFER NE 'O').ERREXT                                00739003
         AIF   (T'&BUFSIZE NE 'O').ERREXT                               00740003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00741003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               00742003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               00743003
         AIF   (T'&RECFM NE 'O').ERREXT                                 00744003
         AIF   (T'&RECNO NE 'O').ERREXT                                 00745003
         AIF   (T'&UNITS NE 'O').ERREXT                                 00746003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               00747003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                00748003
         AIF   (T'&DIRINF  NE 'O').ERREXT                               00749003
         AIF   (T'&CONT  NE 'O').ERREXT                                 00750003
         AIF   (T'&DIRNO  NE 'O').ERREXT                                00751003
         AIF   (T'&DIRINFL  NE 'O').ERREXT                              00752003
         AIF   (T'&DATA NE 'O').ERREXT                                  00753003
         AIF   (T'&DATAID NE 'O').ERREXT                                00754003
         AIF   (T'&DATALEN NE 'O').ERREXT                               00755003
         AIF   (T'&EODAD NE 'O').ERREXT                                 00756003
         AIF   (T'&CB NE 'O').ERREXT                                    00757003
         AIF   (T'&CBLEN NE 'O').ERREXT                                 00758003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 00759003
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               00760003
         AIF   (T'&LOCKID NE 'O').ERREXT                       @D52RDUT 00761003
         AGO   .CHKFUN                                                  00762003
.*                                                                      00763003
.*       DELETE MEMBER                                                  00764003
.*                                                                      00765003
.CHKDELM ANOP                                                           00766003
         AIF   ('&FUNC' NE 'DELETE').CHKLOCK                            00767003
&IALFC   SETC  'DELETE'           SET FUNCTION CODE FOR CONTROL BLOCK   00768003
         AIF   (T'&ENTITY EQ 'O').CKDELM1                               00769003
         AIF   ('&ENTITY' EQ 'MEMBER').CKDELM1                          00770003
         MNOTE 8,'WRONG ENTITY FOR FUNCTION DELETE, GENERATION SUPPRESSX00771003
               ED'                                                      00772003
&IALSYER SETB  1                                                        00773003
.CKDELM1 ANOP                                                           00774003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               00775003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 00776003
         AIF   (T'&CATALOG NE 'O').ERREXT                               00777003
         AIF   (T'&SCOPE NE 'O').ERREXT                                 00778003
         AIF   (T'&BUFFER NE 'O').ERREXT                                00779003
         AIF   (T'&BUFSIZE NE 'O').ERREXT                               00780003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00781003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               00782003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               00783003
         AIF   (T'&RECFM NE 'O').ERREXT                                 00784003
         AIF   (T'&RECNO NE 'O').ERREXT                                 00785003
         AIF   (T'&UNITS NE 'O').ERREXT                                 00786003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               00787003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                00788003
         AIF   (T'&CHAIN  NE 'O').ERREXT                                00789003
         AIF   (T'&DIRINF NE 'O').ERREXT                                00790003
         AIF   (T'&DIRNO  NE 'O').ERREXT                                00791003
         AIF   (T'&CONT  NE 'O').ERREXT                                 00792003
         AIF   (T'&DIRINFL NE 'O').ERREXT                               00793003
         AIF   (T'&DATA NE 'O').ERREXT                                  00794003
         AIF   (T'&DATAID NE 'O').ERREXT                                00795003
         AIF   (T'&DATALEN NE 'O').ERREXT                               00796003
         AIF   (T'&EODAD NE 'O').ERREXT                                 00797003
         AIF   (T'&NOTFND NE 'O').ERREXT                                00798003
         AIF   (T'&CB NE 'O').ERREXT                                    00799003
         AIF   (T'&CBLEN NE 'O').ERREXT                                 00800003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 00801003
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               00802003
         AIF   (T'&LOCKID NE 'O').ERREXT                       @D52RDUT 00803003
         AGO   .CHKFUN                                                  00804003
.*                                                                      00805003
.*       LOCK/UNLOCK MEMBER                                             00806003
.*                                                                      00807003
.CHKLOCK ANOP                                                           00807103
.*                                                            @D52RDUT  00807203
         AIF   ('&FUNC' NE 'LOCK').CHKUNL                     @D52RDUT  00807303
&IALFC   SETC  'LOCK'    SET FUNCTION CODE FOR CONTROL BLOCK  @D52RDUT  00807403
         AGO   .CKDLOC1                                       @D52RDUT  00807503
.CHKUNL  ANOP                                                 @D52RDUT  00807603
         AIF   ('&FUNC' NE 'UNLOCK').CHKRENM                  @D52RDUT  00807703
&IALFC   SETC  'UNLOCK'   SET FUNCTION CODE FOR CONTROL BLOCK @D52RDUT  00807803
.CKDLOC1 ANOP                                                 @D52RDUT  00807903
         AIF   (T'&NMEMBER NE 'O').ERREXT                     @D52RDUT  00808003
         AIF   (T'&NTYPE NE 'O').ERREXT                       @D52RDUT  00808103
         AIF   (T'&CATALOG NE 'O').ERREXT                     @D52RDUT  00808203
         AIF   (T'&SCOPE NE 'O').ERREXT                       @D52RDUT  00808303
         AIF   (T'&BUFFER NE 'O').ERREXT                      @D52RDUT  00808403
         AIF   (T'&BUFSIZE NE 'O').ERREXT                     @D52RDUT  00808503
         AIF   (T'&COMMIT NE 'O').ERREXT                      @D52RDUT  00808603
         AIF   (T'&NOTEINF NE 'O').ERREXT                     @D52RDUT  00808703
         AIF   (T'&NOTECTL NE 'O').ERREXT                     @D52RDUT  00808803
         AIF   (T'&RECFM NE 'O').ERREXT                       @D52RDUT  00808903
         AIF   (T'&RECNO NE 'O').ERREXT                       @D52RDUT  00809003
         AIF   (T'&UNITS NE 'O').ERREXT                       @D52RDUT  00809103
         AIF   (T'&MOVELEN NE 'O').ERREXT                     @D52RDUT  00809203
         AIF   (T'&SYSIPT NE 'O').ERREXT                      @D52RDUT  00809303
         AIF   (T'&CHAIN  NE 'O').ERREXT                      @D52RDUT  00809403
         AIF   (T'&CHAINID  NE 'O').ERREXT                    @D52RDUT  00809503
         AIF   (T'&DIRINF NE 'O').ERREXT                      @D52RDUT  00809603
         AIF   (T'&DIRNO  NE 'O').ERREXT                      @D52RDUT  00809703
         AIF   (T'&CONT  NE 'O').ERREXT                       @D52RDUT  00809803
         AIF   (T'&DIRINFL NE 'O').ERREXT                     @D52RDUT  00809903
         AIF   (T'&DATA NE 'O').ERREXT                        @D52RDUT  00810003
         AIF   (T'&DATAID NE 'O').ERREXT                      @D52RDUT  00810103
         AIF   (T'&DATALEN NE 'O').ERREXT                     @D52RDUT  00810203
         AIF   (T'&EODAD NE 'O').ERREXT                       @D52RDUT  00810303
         AIF   (T'&NOTFND NE 'O').ERREXT                      @D52RDUT  00810403
         AIF   (T'&CB NE 'O').ERREXT                          @D52RDUT  00810503
         AIF   (T'&CBLEN NE 'O').ERREXT                       @D52RDUT  00810603
         AIF   (T'&ENV NE 'O').ERREXT                         @D52RDUT  00810703
         AIF   (T'&TYPEFLE NE 'O').ERREXT                     @D52RDUT  00810803
         AGO   .CHKFUN                                                  00810903
.*                                                                      00811003
.*       RENAME MEMBER                                                  00811103
.*                                                                      00811203
.CHKRENM ANOP                                                           00811303
         AIF   ('&FUNC' NE 'RENAME').CHKOPEN                            00811403
&IALFC   SETC  'RENAME'           SET FUNCTION CODE FOR CONTROL BLOCK   00811503
         AIF   (T'&ENTITY EQ 'O').CKRENM1                               00811603
         AIF   ('&ENTITY' EQ 'MEMBER').CKRENM1                          00811703
         MNOTE 8,'WRONG ENTITY FOR FUNCTION RENAME, GENERATION SUPPRESSX00811803
               ED'                                                      00811903
&IALSYER SETB 1                                                         00812003
.CKRENM1 ANOP                                                           00813003
         AIF   (K'&NMEMBER NE 0).CKRENM2                                00814003
         MNOTE 8,'NMEMBER MISSING, GENERATION SUPPRESSED'               00815003
&IALSYER SETB 1                                                         00816003
.CKRENM2 ANOP                                                           00817003
         AIF   (K'&NTYPE NE 0).CKRENM3                                  00818003
         MNOTE 8,'NTYPE MISSING, GENERATION SUPPRESSED'                 00819003
&IALSYER SETB 1                                                         00820003
.CKRENM3 ANOP                                                           00821003
         AIF   (T'&CATALOG NE 'O').ERREXT                               00822003
         AIF   (T'&SCOPE NE 'O').ERREXT                                 00823003
         AIF   (T'&BUFFER NE 'O').ERREXT                                00824003
         AIF   (T'&BUFSIZE NE 'O').ERREXT                               00825003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00826003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               00827003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               00828003
         AIF   (T'&RECFM NE 'O').ERREXT                                 00829003
         AIF   (T'&RECNO NE 'O').ERREXT                                 00830003
         AIF   (T'&UNITS NE 'O').ERREXT                                 00831003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               00832003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                00833003
         AIF   (T'&CHAIN  NE 'O').ERREXT                                00834003
         AIF   (T'&DIRINF NE 'O').ERREXT                                00835003
         AIF   (T'&CONT  NE 'O').ERREXT                                 00836003
         AIF   (T'&DIRNO  NE 'O').ERREXT                                00837003
         AIF   (T'&DIRINFL NE 'O').ERREXT                               00838003
         AIF   (T'&DATA NE 'O').ERREXT                                  00839003
         AIF   (T'&DATAID NE 'O').ERREXT                                00840003
         AIF   (T'&DATALEN NE 'O').ERREXT                               00841003
         AIF   (T'&EODAD NE 'O').ERREXT                                 00842003
         AIF   (T'&CB NE 'O').ERREXT                                    00843003
         AIF   (T'&CBLEN NE 'O').ERREXT                                 00844003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 00845003
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               00846003
         AGO   .CHKFUN                                                  00847003
.*                                                                      00848003
.*       OPEN                                                           00849003
.*                                                                      00850003
.CHKOPEN ANOP                                                           00851003
         AIF   ('&FUNC' NE 'OPEN').CHKGET                               00852003
&IALFC   SETC  'OPEN'              SET FUNCTION CODE FOR CONTROL BLOCK  00853003
         AIF   ('&SYSIPT' EQ '' OR '&TYPEFLE(1)' EQ 'OUTPUT').CKOPEN0   00854003
         MNOTE 4,'SYSIPT ONLY POSSIBLE FOR TYPEFLE=OUTPUT, PARAMETER IGX00855003
               NORED'                                                   00856003
         AGO   .CKOPEN2                                                 00857003
.CKOPEN0 ANOP                                                           00858003
         AIF   ('&TYPEFLE(1)' NE 'OUTPUT').CKOPEN2                      00859003
         AIF   ('&SYSIPT' NE '').CKOPEN1                                00860003
&TSYSI   SETC  'NO'                SET SYSIPT TO DEFAULT                00861003
         AGO   .CKOPEN2                                                 00862003
.CKOPEN1 ANOP                                                           00863003
&TSYSI   SETC '&SYSIPT'            SET SYSIPT AS SPECIFIED              00864003
.CKOPEN2 ANOP                                                           00865003
.*                                                                      00866003
.*       LDCB MUST BE SPECIFIED                                         00867003
.*                                                                      00868003
         AIF   (T'&LDCB NE 'O').CHKOPN0                                 00869003
         MNOTE 8,'LDCB MISSING, GENERATION SUPPRESSED'                  00870003
&IALSYER SETB  1                                                        00871003
.CHKOPN0 ANOP                                                           00872003
&IALOP1  SETC   '&TYPEFLE(1)'       SET OPEN OPTION 1 FOR LIBRDCB       00873003
         AIF   ('&IALOP1' NE '').CHKOPNS                                00874003
&IALOP1  SETC   'INPUT'             SET TO DEFAULT                      00875003
.CHKOPNS ANOP                                                           00876003
         AIF   ('&IALOP1' EQ 'OUTPUT').CHKREPL                          00877003
         AIF   ('&IALOP1' EQ 'INPUT').CHKOPN1                           00878003
         AIF   ('&IALOP1' EQ 'INOUT').CHKOPN1                           00879003
         MNOTE 8,'INVALID TYPEFLE SPECIFIED, GENERATION SUPPRESSED'     00880003
&IALSYER SETB 1                                                         00881003
         AGO  .CHKOPN1                                                  00882003
.CHKREPL ANOP                                                           00883003
&IALOP2 SETC   '&TYPEFLE(2)'       SET OPEN OPTION 2 FOR LIBRDCB        00884003
         AIF   ('&IALOP2' EQ 'REPLACE').CHKOPN2                         00885003
         AIF   ('&IALOP2' EQ 'NOREPLACE').CHKOPN2                       00886003
         MNOTE 8,'INVALID TYPEFLE SPECIFIED, GENERATION SUPPRESSED'     00887003
&IALSYER SETB 1                                                         00888003
         AGO  .CHKOPN2                                                  00889003
.CHKOPN1 ANOP                                                           00890003
         AIF   ('&TYPEFLE(2)' EQ '').CHKOPN2                            00891003
         MNOTE 8,'INVALID TYPEFLE SPECIFIED, GENERATION SUPPRESSED'     00892003
&IALSYER SETB 1                                                         00893003
.CHKOPN2 ANOP                                                           00894003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               00895003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 00896003
         AIF   (T'&CATALOG NE 'O').ERREXT                               00897003
         AIF   (T'&SCOPE NE'O').ERREXT                                  00898003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00899003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               00900003
         AIF   (T'&DIRNO  NE 'O').ERREXT                                00901003
         AIF   (T'&CONT  NE 'O').ERREXT                                 00902003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               00903003
         AIF   (T'&RECNO NE 'O').ERREXT                                 00904003
         AIF   (T'&UNITS NE 'O').ERREXT                                 00905003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               00906003
         AIF   (T'&CHAIN NE 'O').ERREXT                                 00907003
         AIF   (T'&EODAD NE 'O').ERREXT                                 00908003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 00909003
         AIF   (T'&CB NE 'O').ERREXT                                    00910003
         AIF   (T'&CBLEN NE 'O').ERREXT                                 00911003
         AIF   (T'&ENTITY NE 'O').ERREXT                                00912003
         AGO   .CHKFUN                                                  00913003
.*                                                                      00914003
.*       GET/PUT                                                        00915003
.*                                                                      00916003
.CHKGET  ANOP                                                           00917003
         AIF   ('&FUNC' NE 'GET').CHKPUT                                00918003
&IALFC   SETC  'GET'               SET FUNCTION CODE FOR CONTROL BLOCK  00919003
         AGO   .CHKGTPT                                                 00920003
.CHKPUT  ANOP                                                           00921003
         AIF   ('&FUNC' NE 'PUT').CHKNTPT                               00922003
&IALFC   SETC  'PUT'               SET FUNCTION CODE FOR CONTROL BLOCK  00923003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               00924003
         AIF   (T'&EODAD NE 'O').ERREXT                                 00925003
.CHKGTPT ANOP                                                           00926003
.CKGTPT1 ANOP                                                           00927003
         AIF   (T'&LIB NE 'O').ERREXT                                   00928003
         AIF   (T'&SUBLIB NE 'O').ERREXT                                00929003
         AIF   (T'&MEMBER NE 'O').ERREXT                                00930003
         AIF   (T'&TYPE NE 'O').ERREXT                                  00931003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               00932003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 00933003
         AIF   (T'&CATALOG NE 'O').ERREXT                               00934003
         AIF   (T'&SCOPE NE 'O').ERREXT                                 00935003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00936003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               00937003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               00938003
         AIF   (T'&RECFM NE 'O').ERREXT                                 00939003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                00940003
         AIF   (T'&CHAIN NE 'O').ERREXT                                 00941003
         AIF   (T'&CHAINID NE 'O').ERREXT                               00942003
         AIF   (T'&DIRINF NE 'O').ERREXT                                00943003
         AIF   (T'&DIRNO  NE 'O').ERREXT                                00944003
         AIF   (T'&CONT  NE 'O').ERREXT                                 00945003
         AIF   (T'&DIRINFL NE 'O').ERREXT                               00946003
         AIF   (T'&DATA NE 'O').ERREXT                                  00947003
         AIF   (T'&DATAID NE 'O').ERREXT                                00948003
         AIF   (T'&DATALEN NE 'O').ERREXT                               00949003
         AIF   (T'&NOTFND NE 'O').ERREXT                                00950003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 00951003
         AIF   (T'&LOCKID NE 'O').ERREXT                       @D52RDUT 00952003
         AIF   (T'&CB NE 'O').ERREXT                                    00953003
         AIF   (T'&CBLEN NE 'O').ERREXT                                 00954003
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               00955003
         AGO   .CHKFUN                                                  00956003
.*                                                                      00957003
.*       NOTE/NOTEF/POINT                                      @D61YDMF 00958003
.*                                                                      00959003
.CHKNTPT ANOP                                                           00960003
         AIF   ('&FUNC' EQ 'NOTEF').CHKNTF                     @D61YDMF 00961003
         AIF   ('&FUNC' NE 'NOTE').CHKPNT                               00962003
.CHKNTF  ANOP                                                  @D61YDMF 00963003
&IALFC   SETC  'NOTE'              SET FUNCTION CODE FOR CONTROL BLOCK  00964003
         AGO   .CKNTPT                                                  00965003
.CHKPNT  ANOP                                                           00966003
         AIF   ('&FUNC' NE 'POINT').CHKCLS                              00967003
&IALFC   SETC  'POINT'                                                  00968003
.CKNTPT  ANOP                                                           00969003
.CKNTPT0 ANOP                                                           00970003
         AIF   (K'&NOTECTL NE 0).CKNTPT1                                00971003
&NOTE    SETC  'NO'                                                     00972003
         AGO   .CKNTPT2                                                 00973003
.CKNTPT1 ANOP                                                           00974003
&NOTE    SETC  '&NOTECTL'                                               00975003
.CKNTPT2 ANOP                                                           00976003
         AIF   ('&NOTE' NE 'YES').CKNTPT3                               00977003
&NOTEIN  SETC  '&NOTEINF'                                               00978003
         AIF   ('&NOTEINF' NE '').CKNTPT4                               00979003
         MNOTE 8,'NOTEINF MUST BE SPECIFIED FOR NOTECTL=YES,  GENERATIOX00980003
               N SUPPRESSED'                                            00981003
&IALSYER SETB  1                                                        00982003
         AGO   .CKNTPT4                                                 00983003
.CKNTPT3 ANOP                                                           00984003
&NOTEIN  SETC ''                                                        00985003
         AIF   ('&NOTEINF' EQ '').CKNTPT4                               00986003
         MNOTE 4,'NOTEINF ONLY VALID FOR NOTECTL=YES,PARAMETER IGNORED' 00987003
.CKNTPT4 ANOP                                                           00988003
         AIF   (T'&LIB NE 'O').ERREXT                                   00989003
         AIF   (T'&SUBLIB NE 'O').ERREXT                                00990003
         AIF   (T'&MEMBER NE 'O').ERREXT                                00991003
         AIF   (T'&TYPE NE 'O').ERREXT                                  00992003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               00993003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 00994003
         AIF   (T'&CATALOG NE 'O').ERREXT                               00995003
         AIF   (T'&SCOPE NE 'O').ERREXT                                 00996003
         AIF   (T'&BUFFER NE 'O').ERREXT                                00997003
         AIF   (T'&BUFSIZE NE 'O').ERREXT                               00998003
         AIF   (T'&COMMIT NE 'O').ERREXT                                00999003
         AIF   (T'&RECFM NE 'O').ERREXT                                 01000003
         AIF   (T'&RECNO NE 'O').ERREXT                                 01001003
         AIF   (T'&UNITS NE 'O').ERREXT                                 01002003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               01003003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                01004003
         AIF   (T'&CHAIN  NE 'O').ERREXT                                01005003
         AIF   (T'&CHAINID NE 'O').ERREXT                               01006003
         AIF   (T'&DIRINF NE 'O').ERREXT                                01007003
         AIF   (T'&DIRNO  NE 'O').ERREXT                                01008003
         AIF   (T'&CONT  NE 'O').ERREXT                                 01009003
         AIF   (T'&DIRINFL NE 'O').ERREXT                               01010003
         AIF   (T'&DATA NE 'O').ERREXT                                  01011003
         AIF   (T'&DATAID NE 'O').ERREXT                                01012003
         AIF   (T'&DATALEN NE 'O').ERREXT                               01013003
         AIF   (T'&NOTFND NE 'O').ERREXT                                01014003
         AIF   (T'&EODAD NE 'O').ERREXT                                 01015003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 01016003
         AIF   (T'&LOCKID NE 'O').ERREXT                       @D52RDUT 01016103
         AIF   (T'&CB NE 'O').ERREXT                                    01016203
         AIF   (T'&CBLEN NE 'O').ERREXT                                 01016303
         AIF   (T'&ENTITY NE 'O').ERREXT                                01016403
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               01016503
         AGO   .CHKFUN                                                  01016603
.*                                                                      01016703
.*       CLOSE                                                          01016803
.*                                                                      01016903
.CHKCLS  ANOP                                                           01017003
         AIF   ('&FUNC' EQ 'CLOSE').CKCLS                               01018003
         MNOTE 8,'INVALID MACRO FUNCTION, GENERATION SUPPRESSED'        01019003
         AGO   .MEND                                                    01020003
.CKCLS   ANOP                                                           01021003
&IALFC   SETC  'CLOSE'                                                  01022003
         AIF   (K'&COMMIT NE 0).CKCLSF2                                 01023003
&COMM    SETC  'YES'              SET COMMIT TO DEFAULT                 01024003
         AGO   .CHKCLSF                                                 01025003
.CKCLSF2 ANOP                                                           01026003
&COMM    SETC  '&COMMIT'                                                01027003
.*                                                                      01028003
.CHKCLSF ANOP                                                           01029003
         AIF   (T'&DATA NE 'O').ERREXT                                  01030003
         AIF   (T'&DATAID NE 'O').ERREXT                                01031003
         AIF   (T'&DATALEN NE 'O').ERREXT                               01032003
         AIF   (T'&LIB NE 'O').ERREXT                                   01033003
         AIF   (T'&SUBLIB NE 'O').ERREXT                                01034003
         AIF   (T'&MEMBER NE 'O').ERREXT                                01035003
         AIF   (T'&TYPE NE 'O').ERREXT                                  01036003
         AIF   (T'&NMEMBER NE 'O').ERREXT                               01037003
         AIF   (T'&NTYPE NE 'O').ERREXT                                 01038003
         AIF   (T'&CATALOG NE 'O').ERREXT                               01039003
         AIF   (T'&SCOPE NE 'O').ERREXT                                 01040003
         AIF   (T'&BUFFER NE 'O').ERREXT                                01041003
         AIF   (T'&BUFSIZE NE 'O').ERREXT                               01042003
         AIF   (T'&NOTEINF NE 'O').ERREXT                               01043003
         AIF   (T'&NOTECTL NE 'O').ERREXT                               01044003
         AIF   (T'&RECFM NE 'O').ERREXT                                 01045003
         AIF   (T'&RECNO NE 'O').ERREXT                                 01046003
         AIF   (T'&UNITS NE 'O').ERREXT                                 01047003
         AIF   (T'&MOVELEN NE 'O').ERREXT                               01048003
         AIF   (T'&SYSIPT NE 'O').ERREXT                                01049003
         AIF   (T'&CHAIN  NE 'O').ERREXT                                01050003
         AIF   (T'&CHAINID NE 'O').ERREXT                               01051003
         AIF   (T'&DIRINF NE 'O').ERREXT                                01052003
         AIF   (T'&DIRNO  NE 'O').ERREXT                                01053003
         AIF   (T'&CONT  NE 'O').ERREXT                                 01054003
         AIF   (T'&DIRINFL NE 'O').ERREXT                               01055003
         AIF   (T'&NOTFND NE 'O').ERREXT                                01056003
         AIF   (T'&EODAD NE 'O').ERREXT                                 01057003
         AIF   (T'&LOCKID NE 'O').ERREXT                       @D52RDUT 01058003
         AIF   (T'&ENV NE 'O').ERREXT                          @D52TDJS 01059003
         AIF   (T'&CB NE 'O').ERREXT                                    01060003
         AIF   (T'&CBLEN NE 'O').ERREXT                                 01061003
         AIF   (T'&ENTITY NE 'O').ERREXT                                01062003
         AIF   (T'&TYPEFLE NE 'O').ERREXT                               01063003
         AGO   .CHKFUN                                                  01064003
.*                                                                      01065003
.*       ERREXT                                                         01066003
.*                                                                      01067003
.ERREXT  ANOP                                                           01068003
         MNOTE 8,'FUNCTION CONTAINS INVALID PARAMETERS, GENERATION SUPPX01069003
               RESSED'                                                  01070003
&IALSYER SETB  1                                                        01071003
.CHKFUN  ANOP                                                           01072003
         AIF   (&IALSYER).MEND     ERROR DURING LIBRM                   01073003
&IALINN  SETB  1                   CALL LIBRDCB AS INNER MACRO          01074003
.AREA    ANOP                                                           01075003
.AREA1   ANOP                                                           01076003
.*                                                                      01077003
.*       PERFORM SYNTAX CHECK OF OTHER PARAMETERS VIA LIBRDCB MACRO     01078003
.*                                                                      01079003
         LIBRDCB FUNC=MOD,                                             X01080003
               AREA=&LDCB,                                             X01081003
               LIB=&LIB,                                               X01082003
               SUBLIB=&SUBLIB,                                         X01083003
               MEMBER=&MEMBER,                                         X01084003
               TYPE=&TYPE,                                             X01085003
               NMEMBER=&NMEMBER,                                       X01086003
               NTYPE=&NTYPE,                                           X01087003
               LOCKID=&LOCKID,                                         X01088003
               CATALOG=&TCATLOG,                                       X01089003
               SCOPE=&SCP,                                             X01090003
               BUFFER=&BUFFER,                                         X01091003
               BUFSIZE=&BUFSIZE,                                       X01092003
               COMMIT=&COMM,                                           X01093003
               NOTEINF=&NOTEIN,                                        X01094003
               NOTECTL=&NOTE,                                          X01095003
               RECFM=&RECFM,                                           X01096003
               RECNO=&RECNO,                                           X01097003
               UNITS=&UNITS,                                           X01098003
               SYSIPT=&TSYSI,                                          X01099003
               CHAIN=&CHN,                                             X01100003
               CHAINID=&CHAINID,                                       X01101003
               DIRINF=&DIRINF,                                         X01102003
               DIRINFL=&DIRINFL,                                       X01103003
               DATA=&DATA,                                             X01104003
               DATAID=&DATAID,                                         X01105003
               DATALEN=&DATALEN,                                       X01106003
               CONT=&CONT,                                             X01107003
               NOTFND=&NOTFND,                                         X01108003
               EODAD=&EODAD,                                           X01109003
               SRVEXIT=&SRVEXIT,                                       X01110003
               EROPT=&EROPT,                                           X01111003
               ERRAD=&ERRAD                                @D52RDUT     01112003
.CHKRET1 ANOP                                                           01113003
         AIF (NOT(&IALSYER)).GENINF     ERROR DURING LIBRDCB            01114003
         AGO  .MEND                                                     01115003
.GENINF  ANOP                                                           01116003
.*                                                                      01117003
.*        ADDRESSING OF CONTROL BLOCK VIA REGISTER 1                    01118003
.*                                                                      01119003
         AIF ('&LDCB'(1,1) NE '(').NOREGN                               01120003
&REG     SETC '&LDCB'(2,K'&LDCB-2)                                      01121003
         LR    IALCBR1,&REG            REG 1 POINTS TO LDCB             01122003
         AGO  .USING1                                                   01123003
.NOREGN  ANOP                                                           01124003
         LA    IALCBR1,&LDCB           REG 1 POINTS TO LDCB             01125003
.USING1  ANOP                                                           01126003
         USING INLCIALC,IALCBR1                                         01127003
         AIF   (&IALENV EQ 1).INVOCS                           @D52TDJS 01128003
.*                                                                      01129003
.*       INVOCATION OF INLPIALC IN SVA PHASE $IJBLBR                    01130003
.*                                                                      01131003
.INVOC   ANOP                                                           01132003
         LA    IALCBR0,108              SET CODE TO CALL INLPIALC       01133003
         ASYSCOM IALCBR15                                               01134003
         L     IALCBR15,300(0,IALCBR15) ADDRESS OF LPT                  01135003
         L     IALCBR15,0(0,IALCBR15)   ADDRESS OF SVA PHASE $IJBLBR    01136003
         BALR  IALCBR14,IALCBR15        BRANCH TO $IJBLBR-INLPIALC      01137003
         AIF (T'&DIRNO EQ 'O').MOVEL                                    01138003
         AIF ('&DIRNO'(1,1) NE '(').DIRNO1                              01139003
&REG     SETC '&DIRNO'(2,K'&DIRNO-2)                                    01140003
         MVC   0(4,&REG),IALCDIRN       STORE # OF ENTRIES              01141003
         AGO .MOVEL                                                     01142003
.DIRNO1  ANOP                                                           01143003
&REG     SETC '&DIRNO'.'(4)'                                            01144003
         MVC   &REG,IALCDIRN            STORE # OF ENTRIES              01145003
         AGO .MOVEL                                                     01146003
.MOVEL   ANOP                                                           01147003
         AIF (T'&MOVELEN EQ 'O').DROPR1                                 01148003
         AIF ('&MOVELEN'(1,1) NE '(').MOVEL01                           01149003
&REG     SETC '&MOVELEN'(2,K'&MOVELEN-2)                                01150003
         MVC   0(4,&REG),IALCMVLN       STORE MOVED LENGTH              01151003
         AGO .DROPR1                                                    01152003
.MOVEL01 ANOP                                                           01153003
&REG     SETC '&MOVELEN'.'(4)'                                          01154003
         MVC   &REG,IALCMVLN            STORE MOVED LENGTH              01155003
         AGO .DROPR1                                                    01156003
.DROPR1  ANOP                                                           01157003
         DROP  IALCBR1                                                  01158003
         AGO   .MEND                                           @D52TDJS 01159003
.INVOCS  ANOP                                                  @D52TDJS 01160003
         L     IALCBR15,IALCSRVX        LOAD EXIT ADDRESS      @D52TDJS 01161003
         LTR   IALCBR15,IALCBR15        EXIT ADDRESS AVAILABLE @D52TDJS 01161103
         BZ    *+6                      DO NOT BRANCH ON ZERO  @D52TDJS 01161203
         BALR  IALCBR14,IALCBR15        BRANCH TO USER EXIT    @D52TDJS 01161303
         DROP  IALCBR1                                         @D52TDJS 01161403
         AGO   .MEND                                           @D52TDJS 01161503
.MEND    ANOP                                                           01161603
&IALINN  SETB  0                                                        01161703
&IALSYER SETB  0                                                        01161803
         MEND                                END OF PLS COMMENT      */ 01161903
*%PLSIALC:;                                                             01162003
*%LIBRM: MACRO KEYS(LIBDEF,                                             01163003
*                      LIBDROP,                                         01164003
*                      CONTROL,                          /*  @D52TDJS*/ 01165003
*                      SERVER,                           /*  @D52TDJS*/ 01166003
*                      STATE,                                           01167003
*                      DELETE,                                          01168003
*                      RENAME,                                          01169003
*                      OPEN,                                            01170003
*                      GET,                                             01171003
*                      PUT,                                             01172003
*                      NOTEF,                            /*  @D61YDMF*/ 01173003
*                      POINT,                                           01174003
*                      CLOSE,                                           01175003
*                      LOCK,                             /*  @D52RDUT*/ 01176003
*                      UNLOCK,                           /*  @D52RDUT*/ 01177003
*                      LDCB,                                            01178003
*                      LIB,                                             01179003
*                      SUBLIB,                                          01180003
*                      MEMBER,                                          01181003
*                      TYPE,                                            01182003
*                      NMEMBER,                                         01183003
*                      NTYPE,                                           01184003
*                      LOCKID,                           /*  @D52RDUT*/ 01184103
*                      CATALOG,                                         01184203
*                      SCOPE,                                           01184303
*                      BUFFER,                                          01184403
*                      BUFSIZE,                                         01184503
*                      NOTEINF,                                         01184603
*                      NOTECTL,                                         01184703
*                      RECFM,                                           01184803
*                      RECNO,                                           01184903
*                      UNITS,                                           01185003
*                      MOVELEN,                                         01186003
*                      SYSIPT,                                          01187003
*                      CHAIN,                                           01188003
*                      CHAINID,                                         01189003
*                      DIRINF,                                          01190003
*                      DIRNO,                                           01191003
*                      DIRINFL,                                         01192003
*                      DATA,                                            01193003
*                      DATALEN,                                         01194003
*                      DATAID,                                          01195003
*                      NOTFND,                                          01196003
*                      EODAD,                                           01197003
*                      CONT,                                            01198003
*                      EROPT,                                           01199003
*                      ERRAD,                                           01200003
*                      SRVEXIT,                                         01201003
*                      SHOWCB,                                          01202003
*                      CBLEN,                                           01203003
*                      ENV,                             /*   @D52TDJS*/ 01204003
*                      FRAME,                           /*   @D52TDJS*/ 01205003
*                      SENDBF,                          /*   @D52TDJS*/ 01206003
*                      SENDBFL,                         /*   @D52TDJS*/ 01207003
*                      REQUEST,                         /*   @D52TDJS*/ 01208003
*                      MODE,                            /*   @D52TDJS*/ 01209003
*                      WSTOR,                           /*   @D52TDJS*/ 01210003
*                      COMMIT);                                         01211003
* /*******************************************************************/ 01212003
* /*  PLS PART OF LIBRM   MACRO, DESCRIPTION SEE ASM PART            */ 01213003
* /*******************************************************************/ 01214003
* DCL (IALSYER,                      /* SYNTAX ERROR IN MACRO PROC.  */ 01215003
*      IALINN,                       /* CALL IALCDEF  AS INNER MACRO */ 01216003
*      IALENV,                       /* ENV SPECIFICATION    @D52TDJS*/ 01216103
*      IALENVD,                      /* ENV ALR. GIVEN       @D52TDJS*/ 01216203
*      IALFRHD,                      /* FRAME ALR. GIVEN     @D52TDJS*/ 01216303
*      IALRC)                        /* RETURN CODE OF MACRO         */ 01216403
*      FIXED EXTERNAL;                                                  01216503
* DCL (IALFC,                        /* PASS FUNC TO IALCDEF MACRO   */ 01216603
*      IALOP1,                       /* PASS OPEN OPTION TO IALCDEF  */ 01216703
*      IALOP2,                       /* PASS OPEN OPTION TO IALCDEF  */ 01216803
*      IALNTOP)                      /* PASS NOTE OPTION TO IALCDEF  */ 01216903
*      CHARACTER EXTERNAL;                                              01217003
* DCL (IN) CHARACTER;                /* FOR LISTING OF INVOKING MACRO*/ 01218003
* DCL (COL1,COLA,COLD,               /* OUTPUT COLUMNS               */ 01219003
*      FT,RCTEMP,                    /* WORK VARIABLES               */ 01220003
*      RCWARN,RCERR) FIXED;          /* RETURN CODE 4,8              */ 01221003
* DCL  (TLIB,TSUBLIB,TMEMBER,        /* PARAMTERS                    */ 01222003
*       TTYPE,TNMEMBER,TNTYPE,                                          01223003
*       TCATALOG,TSCOPE,TBUFFER,                                        01224003
*       TBUFFSIZ,TCOMMIT,TNOTEINF,                                      01225003
*       TNOTECTL,TRECFM,                                                01226003
*       TRECNO,TUNITS,                                                  01227003
*       TSYSIPT,TCHAIN,                                                 01228003
*       TCHAINID,TDIRINF,TCONT,                                         01229003
*       TDIRINFL,TDATA,TDATAID,                                         01230003
*       TDATALEN,TNOTFND,TEODAD,                                        01231003
*       TEROPT,TERRAD,TSRVEXIT,TWORK)                                   01232003
*       CHARACTER;                                                      01233003
* COLA = MACLMAR;                                                       01234003
* COLD = COLA + 35;                                                     01235003
* COL1 = MACGLMAR;                                                      01236003
* RCERR = 8;                                                            01237003
* RCWARN = 4;                                                           01238003
* IN = MACLABEL || ' ' || MACNAME || ' ' || MACLIST || ' ' || MACKEYS;  01239003
* ANS (COMMENT(IN)) COL(COLA) SKIP;                                     01240003
* IN =' LIBRARIAN - LIBRM - 5686-032-06-C55  - VERSION 90-09-26';       01241003
* ANS (COMMENT(IN)) COL(COLA) SKIP;                                     01242003
* IALSYER = 0;                                                          01243003
* IALRC = 0;                                                            01244003
* IALOP1 = '';                                                          01245003
* IALOP2 = '';                                                          01246003
* IALNTOP  = '';                                                        01247003
* IALFC = '';                                                           01248003
* /*                                                                 */ 01249003
* /*  CHECK MAIN FUNCTION                                            */ 01250003
* /*                                                                 */ 01251003
* /*  CHECK IF MORE THAN ONE FUNCTIONS WAS SPECIFIED                 */ 01252003
* /*                                                                 */ 01253003
* FT = 0;                                                               01254003
* IF LIBDEF = ''   THEN FT=FT+1;                                       01255003
* IF LIBDROP = ''  THEN FT=FT+1;                                       01256003
* IF SHOWCB = ''   THEN FT=FT+1;                                       01257003
* IF STATE = ''    THEN FT=FT+1;                                       01258003
* IF RENAME = ''   THEN FT=FT+1;                                       01259003
* IF DELETE = ''   THEN FT=FT+1;                                       01260003
* IF OPEN = ''     THEN FT=FT+1;                                       01261003
* IF GET = ''      THEN FT=FT+1;                                       01262003
* IF PUT = ''      THEN FT=FT+1;                                       01263003
* IF NOTEF = ''     THEN FT=FT+1;                       /*  @D61YDMF*/ 01264003
* IF POINT = ''    THEN FT=FT+1;                                       01265003
* IF CLOSE = ''    THEN FT=FT+1;                                       01266003
* IF CONTROL= ''    THEN FT=FT+1;                       /*  @D52TDJS*/ 01267003
* IF SERVER= ''     THEN FT=FT+1;                       /*  @D52TDJS*/ 01268003
* IF LOCK= ''     THEN FT=FT+1;                         /*  @D52RDUT*/ 01269003
* IF UNLOCK= ''     THEN FT=FT+1;                       /*  @D52RDUT*/ 01270003
* IF FT = 0  THEN                                                       01271003
* DO;                                                                   01272003
*  ANS MSG ('MACRO FUNCTION MISSING, GENERATION SUPPRESSED')            01273003
*      COL(COLA) SKIP NORESCAN;                                         01274003
*  IALRC = RCERR;                                                       01275003
*  GOTO MEND;                                                           01276003
* END;                                                                  01277003
* IF FT > 1  THEN                                                       01278003
* DO;                                                                   01279003
*  ANS MSG (                                                            01280003
*  'MORE THAN ONE MAIN FUNCTION SPECIFIED, GENERATION SUPPRESSED')      01281003
*      COL(COLA) SKIP NORESCAN;                                         01282003
*  IALRC = RCERR;                                                       01283003
*  GOTO MEND;                                                           01284003
* END;                                                                  01285003
* IF MACLABEL = '' THEN                                                01286003
*      ANS (MACLABEL || ';') COL(COLA) SKIP RESCAN;                     01287003
* /*                                                         @D52TDJS*/ 01288003
* /*   HANDLE ENVIRONMENT                                    @D52TDJS*/ 01289003
* /*                                                         @D52TDJS*/ 01289103
* IF CONTROL = '' THEN           /* CONTROL SPECIFIED       @D52TDJS*/ 01289203
* DO;                             /*                         @D52TDJS*/ 01289303
* IF ENV(1) = '' THEN            /* ENV SPECIFIED           @D52TDJS*/ 01289403
* DO;                             /*                         @D52TDJS*/ 01289503
*   IF IALENVD = 1 THEN           /* BUT ALREADY GIVEN       @D52TDJS*/ 01289603
*   DO;                           /* ISSUE WARNING           @D52TDJS*/ 01289703
*      ANS MSG ('CONTROL SPECIFIED MORE THAN ONCE,REQUEST IGNORED')     01289803
*               COL(COLA) SKIP NORESCAN;   /*                @D52TDJS*/ 01289903
*      IALRC = RCWARN;                     /*                @D52TDJS*/ 01290003
*      GOTO MEND;                          /*                @D52TDJS*/ 01290103
*   END;                                   /*                @D52TDJS*/ 01290203
*   ELSE DO;                               /*                @D52TDJS*/ 01290303
*     IALENVD = 1;                         /* FLAG ENV       @D52TDJS*/ 01290403
*     IF ENV(1) = 'BATCH' THEN GOTO MEND;  /* NOOP FOR BATCH @D52TDJS*/ 01290503
*     ELSE DO;                             /*                @D52TDJS*/ 01290603
*       IF ENV(1) = 'SERVER' THEN          /* SERVER ACTIVE  @D52TDJS*/ 01290703
*       DO;                                /*                @D52TDJS*/ 01290803
*         IALENV = 1;                      /* FLAG SERVER    @D52TDJS*/ 01290903
*         GOTO MEND;                       /*                @D52TDJS*/ 01291003
*       END;                               /*                @D52TDJS*/ 01291103
*       ELSE DO;                           /* INVALID ENV    @D52TDJS*/ 01291203
*  ANS MSG ('ENV OPERAND INVALID, REQUEST IGNORED')                     01291303
*      COL(COLA) SKIP NORESCAN;                                         01291403
*  IALRC = RCERR;                          /*                @D52TDJS*/ 01291503
*  IALSYER = 1;                            /*                @D52TDJS*/ 01291603
*      GOTO MEND;                          /*                @D52TDJS*/ 01291703
*       END;                               /*                @D52TDJS*/ 01291803
*     END;                                 /*                @D52TDJS*/ 01291903
*   END;                                   /*                @D52TDJS*/ 01292003
* END;                                     /*                @D52TDJS*/ 01292103
* ELSE DO;                                 /* ENV MISSING    @D52TDJS*/ 01292203
*  ANS MSG ('ENV OPERAND MISSING, REQUEST IGNORED')                     01292303
*      COL(COLA) SKIP NORESCAN;            /*                @D52TDJS*/ 01292403
*  IALRC = RCERR;                          /*                @D52TDJS*/ 01292503
*  IALSYER = 1;                            /*                @D52TDJS*/ 01292603
*      GOTO MEND;                          /*                @D52TDJS*/ 01292703
* END;                                     /*                @D52TDJS*/ 01292803
* /*                                                         @D52TDJS*/ 01292903
* /*    NO OTHER PARAMTERS ARE ALLOWED                       @D52TDJS*/ 01293003
* /*                                                         @D52TDJS*/ 01293103
* IF LDCB(1) = '' THEN GOTO ERRENV;                   /*    @D52TDJS*/ 01293203
* IF LIB(1) = '' THEN GOTO ERRENV;                    /*    @D52TDJS*/ 01293303
* IF SUBLIB(1) = '' THEN GOTO ERRENV;                 /*    @D52TDJS*/ 01293403
* IF MEMBER(1) = '' THEN GOTO ERRENV;                 /*    @D52TDJS*/ 01293503
* IF TYPE(1) = '' THEN GOTO ERRENV;                   /*    @D52TDJS*/ 01293603
* IF NMEMBER(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01293703
* IF NTYPE(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01293803
* IF CATALOG(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01293903
* IF SCOPE(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01294003
* IF BUFFER(1) = '' THEN GOTO ERRENV;                 /*    @D52TDJS*/ 01294103
* IF BUFSIZE(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01294203
* IF COMMIT(1) = '' THEN GOTO ERRENV;                 /*    @D52TDJS*/ 01294303
* IF NOTEINF(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01294403
* IF NOTECTL(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01294503
* IF RECFM(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01294603
* IF RECNO(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01294703
* IF UNITS(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01294803
* IF MOVELEN(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01294903
* IF SYSIPT(1) = '' THEN GOTO ERRENV;                 /*    @D52TDJS*/ 01295003
* IF CHAIN(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01295103
* IF CHAINID(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01295203
* IF DIRINF(1) = '' THEN GOTO ERRENV;                 /*    @D52TDJS*/ 01295303
* IF DIRNO(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01295403
* IF DIRINFL(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01295503
* IF DATA(1) = '' THEN GOTO ERRENV;                   /*    @D52TDJS*/ 01295603
* IF DATAID(1) = '' THEN GOTO ERRENV;                 /*    @D52TDJS*/ 01295703
* IF DATALEN(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01295803
* IF NOTFND(1) = '' THEN GOTO ERRENV;                 /*    @D52TDJS*/ 01295903
* IF EODAD(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01296003
* IF CONT(1) = '' THEN GOTO ERRENV;                   /*    @D52TDJS*/ 01296103
* IF EROPT(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01296203
* IF ERRAD(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01296303
* IF SRVEXIT(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01296403
* IF CBLEN(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01296503
* IF FRAME(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01296603
* IF SENDBF(1) = '' THEN GOTO ERRENV;                 /*    @D52TDJS*/ 01296703
* IF SENDBFL(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01296803
* IF REQUEST(1) = '' THEN GOTO ERRENV;                /*    @D52TDJS*/ 01296903
* IF MODE(1) = '' THEN GOTO ERRENV;                   /*    @D52TDJS*/ 01297003
* IF WSTOR(1) = '' THEN GOTO ERRENV;                  /*    @D52TDJS*/ 01297103
* IF LOCKID(1) = '' THEN GOTO ERRENV;                 /*    @D52RDUT*/ 01297203
* GOTO MEND;                                           /*    @D52TDJS*/ 01297303
* ERRENV:;                                             /*    @D52TDJS*/ 01297403
*  ANS MSG                                                              01297503
*  ('FUNCTION CONTAINS INVALID PARAMETERS, PARAMETERS IGNORED')         01297603
*      COL(COLA) SKIP NORESCAN;                                         01297703
*  IALRC = RCWARN;                                                      01297803
*  GOTO MEND;                                                           01297903
* END;                                     /*                @D52TDJS*/ 01298003
* /*                                                         @D52TDJS*/ 01298103
* /*   HANDLE SERVER REQUEST                                 @D52TDJS*/ 01298203
* /*                                                         @D52TDJS*/ 01298303
* IF SERVER = '' THEN GOTO SHWCB1;         /*                @D52TDJS*/ 01298403
* /*                                                         @D52TDJS*/ 01298503
* /* FRAME MUST BE SPECIFIED                                 @D52TDJS*/ 01298603
* /*                                                         @D52TDJS*/ 01298703
* IF FRAME(1) = '' THEN                    /*                @D52TDJS*/ 01298803
* DO;                                      /* FRAME REQUIRED @D52TDJS*/ 01298903
*  ANS MSG ('PARAMETER FRAME MISSING, GENERATION SUPPRESSED')           01299003
*      COL(COLA) SKIP NORESCAN;            /*                @D52TDJS*/ 01299103
*  IALRC = RCERR;                          /*                @D52TDJS*/ 01299203
*  IALSYER = 1;                            /*                @D52TDJS*/ 01299303
*  GOTO MEND;                              /*                @D52TDJS*/ 01299403
* END;                                                                  01299503
* /*                                                         @D52TDJS*/ 01299603
* /* ONLY FRAME = READY OR MAP ALLOWED                       @D52TDJS*/ 01299703
* /*                                       /*                @D52TDJS*/ 01299803
* IF FRAME(1) ='MAP' &                    /*                @D52TDJS*/ 01299903
*    FRAME(1) ='READY' THEN               /*                @D52TDJS*/ 01300003
* DO;                                      /* FRAME REQUIRED @D52TDJS*/ 01300103
*  ANS MSG ('INVALID FRAME OPTION, GENERATION SUPPRESSED')              01300203
*      COL(COLA) SKIP NORESCAN;            /*                @D52TDJS*/ 01300303
*  IALRC = RCERR;                          /*                @D52TDJS*/ 01300403
*  IALSYER = 1;                            /*                @D52TDJS*/ 01300503
*  GOTO MEND;                              /*                @D52TDJS*/ 01300603
* END;                                                                  01300703
* IF IALFRHD = 0 THEN                      /* FIRST MAP      @D52TDJS*/ 01300803
* DO;                                      /*                @D52TDJS*/ 01300903
*   ANS (' ? INLCFRHD;') COL(COLA) SKIP RESCAN;  /*          @D52TDJS*/ 01301003
*   IALFRHD = 1;                           /*                @D52TDJS*/ 01301103
* END;                                     /*                @D52TDJS*/ 01301203
* /*                                                         @D52TDJS*/ 01301303
* /* FRAME = MAP                                             @D52TDJS*/ 01301403
* /*                                       /*                @D52TDJS*/ 01301503
* IF FRAME(1) = 'MAP'THEN                  /*                @D52TDJS*/ 01301603
* DO;                                      /*                @D52TDJS*/ 01301703
* /*                                                         @D52TDJS*/ 01301803
* /*    NO OTHER PARAMTERS ARE ALLOWED                       @D52TDJS*/ 01301903
* /*                                                         @D52TDJS*/ 01302003
* IF LDCB(1) = '' THEN GOTO WRNSRV;                   /*    @D52TDJS*/ 01302103
* IF LIB(1) = '' THEN GOTO WRNSRV;                    /*    @D52TDJS*/ 01302203
* IF SUBLIB(1) = '' THEN GOTO WRNSRV;                 /*    @D52TDJS*/ 01302303
* IF MEMBER(1) = '' THEN GOTO WRNSRV;                 /*    @D52TDJS*/ 01302403
* IF TYPE(1) = '' THEN GOTO WRNSRV;                   /*    @D52TDJS*/ 01302503
* IF NMEMBER(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01302603
* IF NTYPE(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01302703
* IF CATALOG(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01302803
* IF SCOPE(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01302903
* IF BUFFER(1) = '' THEN GOTO WRNSRV;                 /*    @D52TDJS*/ 01303003
* IF BUFSIZE(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01303103
* IF COMMIT(1) = '' THEN GOTO WRNSRV;                 /*    @D52TDJS*/ 01303203
* IF NOTEINF(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01303303
* IF NOTECTL(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01303403
* IF RECFM(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01303503
* IF RECNO(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01303603
* IF UNITS(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01303703
* IF MOVELEN(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01303803
* IF SYSIPT(1) = '' THEN GOTO WRNSRV;                 /*    @D52TDJS*/ 01303903
* IF CHAIN(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01304003
* IF CHAINID(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01304103
* IF DIRINF(1) = '' THEN GOTO WRNSRV;                 /*    @D52TDJS*/ 01304203
* IF DIRNO(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01304303
* IF DIRINFL(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01304403
* IF DATA(1) = '' THEN GOTO WRNSRV;                   /*    @D52TDJS*/ 01304503
* IF DATAID(1) = '' THEN GOTO WRNSRV;                 /*    @D52TDJS*/ 01304603
* IF DATALEN(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01304703
* IF NOTFND(1) = '' THEN GOTO WRNSRV;                 /*    @D52TDJS*/ 01304803
* IF EODAD(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01304903
* IF CONT(1) = '' THEN GOTO WRNSRV;                   /*    @D52TDJS*/ 01305003
* IF EROPT(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01305103
* IF ERRAD(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01305203
* IF SRVEXIT(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01305303
* IF CBLEN(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01305403
* IF ENV(1) = '' THEN GOTO WRNSRV;                    /*    @D52TDJS*/ 01305503
* IF SENDBF(1) = '' THEN GOTO WRNSRV;                 /*    @D52TDJS*/ 01305603
* IF SENDBFL(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01305703
* IF REQUEST(1) = '' THEN GOTO WRNSRV;                /*    @D52TDJS*/ 01305803
* IF MODE(1) = '' THEN GOTO WRNSRV;                   /*    @D52TDJS*/ 01305903
* IF WSTOR(1) = '' THEN GOTO WRNSRV;                  /*    @D52TDJS*/ 01306003
* IF LOCKID(1) = '' THEN GOTO WRNSRV;                 /*    @D52RDUT*/ 01306103
* GOTO SRVMPOK;                                        /*    @D52TDJS*/ 01306203
* WRNSRV:;                                             /*    @D52TDJS*/ 01306303
*  ANS MSG ('ALL OTHER PARAMETERS IGNORED FOR FRAME(MAP)')              01306403
*      COL(COLA) SKIP NORESCAN;                        /*    @D52TDJS*/ 01306503
*      IALRC = RCWARN;                                 /*    @D52TDJS*/ 01306603
* SRVMPOK:;                                            /*    @D52TDJS*/ 01306703
* GOTO MEND;                                           /*    @D52TDJS*/ 01306803
* END;                                                 /*    @D52TDJS*/ 01306903
* /*                                                         @D52TDJS*/ 01307003
* /* FRAME = READY                                           @D52TDJS*/ 01307103
* /*                                                         @D52TDJS*/ 01307203
* ELSE DO;                                             /*    @D52TDJS*/ 01307303
* /*                                                         @D52TDJS*/ 01307403
* /* SENDBF, SENDBFL, REQUEST, WSTOR MUST BE SPECIFIED       @D52TDJS*/ 01307503
* /*                                                         @D52TDJS*/ 01307603
* IF SENDBF(1) = '' |                      /*                @D52TDJS*/ 01307703
*    SENDBFL(1) = '' |                     /*                @D52TDJS*/ 01307803
*    REQUEST(1) = '' |                     /*                @D52TDJS*/ 01307903
*    WSTOR(1) = '' THEN                    /*                @D52TDJS*/ 01308003
* DO;                                      /*                @D52TDJS*/ 01308103
*  ANS MSG ('MANDATORY OPERAND MISSING, GENERATION SUPPRESSED')         01308203
*      COL(COLA) SKIP NORESCAN;            /*                @D52TDJS*/ 01308303
*  IALRC = RCERR;                          /*                @D52TDJS*/ 01308403
*  IALSYER = 1;                            /*                @D52TDJS*/ 01308503
*  GOTO MEND;                              /*                @D52TDJS*/ 01308603
* END;                                                                  01308703
* /*                                                         @D52TDJS*/ 01308803
* /* LDCB MUST BE SPECIFIED FOR REQUEST API                  @D52TDJS*/ 01308903
* /*                                                         @D52TDJS*/ 01309003
* IF REQUEST(1) = 'API' &                  /*                @D52TDJS*/ 01309103
*    LDCB(1)    = '' THEN                  /*                @D52TDJS*/ 01309203
* DO;                                      /*                @D52TDJS*/ 01309303
*  ANS MSG ('LDCB REQUIRED FOR REQUEST(API), GENERATION SUPPRESSED')    01309403
*      COL(COLA) SKIP NORESCAN;            /*                @D52TDJS*/ 01309503
*  IALRC = RCERR;                          /*                @D52TDJS*/ 01309603
*  IALSYER = 1;                            /*                @D52TDJS*/ 01309703
*  GOTO MEND;                              /*                @D52TDJS*/ 01309803
* END;                                                                  01309903
* /*                                                         @D52TDJS*/ 01310003
* /* CHECK REQUEST OPERAND                                   @D52TDJS*/ 01310103
* /*                                                         @D52TDJS*/ 01310203
* IF REQUEST(1) = 'API' &                 /*                @D52TDJS*/ 01310303
*    REQUEST(1) = 'COMMAND' &             /*                @D52TDJS*/ 01310403
*    REQUEST(1) = 'RESET' THEN            /*                @D52TDJS*/ 01310503
* DO;                                      /*                @D52TDJS*/ 01310603
*  ANS MSG ('REQUEST OPTION INVALID, GENERATION SUPPRESSED')            01310703
*      COL(COLA) SKIP NORESCAN;            /*                @D52TDJS*/ 01310803
*  IALRC = RCERR;                          /*                @D52TDJS*/ 01310903
*  IALSYER = 1;                            /*                @D52TDJS*/ 01311003
*  GOTO MEND;                              /*                @D52TDJS*/ 01311103
* END;                                                                  01311203
* /*                                                         @D52TDJS*/ 01311303
* /* CHECK MODE OPERAND                                      @D52TDJS*/ 01311403
* /*                                                         @D52TDJS*/ 01311503
* IF MODE(1) = 'STOP' &                   /*                @D52TDJS*/ 01311603
*    MODE(1) = 'CONTINUE' &               /*                @D52TDJS*/ 01311703
*    MODE(1) = ''         THEN            /*                @D52TDJS*/ 01311803
* DO;                                      /*                @D52TDJS*/ 01311903
*  ANS MSG ('MODE OPTION INVALID, GENERATION SUPPRESSED')               01312003
*      COL(COLA) SKIP NORESCAN;            /*                @D52TDJS*/ 01312103
*  IALRC = RCERR;                          /*                @D52TDJS*/ 01312203
*  IALSYER = 1;                            /*                @D52TDJS*/ 01312303
*  GOTO MEND;                              /*                @D52TDJS*/ 01312403
* END;                                                                  01312503
* /*                                                         @D52TDJS*/ 01312603
* /*    NO OTHER PARAMTERS ARE ALLOWED                       @D52TDJS*/ 01312703
* /*                                                         @D52TDJS*/ 01312803
* IF LIB(1) = '' THEN GOTO ERRSRV;                    /*    @D52TDJS*/ 01312903
* IF SUBLIB(1) = '' THEN GOTO ERRSRV;                 /*    @D52TDJS*/ 01313003
* IF MEMBER(1) = '' THEN GOTO ERRSRV;                 /*    @D52TDJS*/ 01313103
* IF TYPE(1) = '' THEN GOTO ERRSRV;                   /*    @D52TDJS*/ 01313203
* IF NMEMBER(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01313303
* IF NTYPE(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01313403
* IF CATALOG(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01313503
* IF SCOPE(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01313603
* IF BUFFER(1) = '' THEN GOTO ERRSRV;                 /*    @D52TDJS*/ 01313703
* IF BUFSIZE(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01313803
* IF COMMIT(1) = '' THEN GOTO ERRSRV;                 /*    @D52TDJS*/ 01313903
* IF NOTEINF(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01314003
* IF NOTECTL(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01314103
* IF RECFM(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01314203
* IF RECNO(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01314303
* IF UNITS(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01314403
* IF MOVELEN(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01314503
* IF SYSIPT(1) = '' THEN GOTO ERRSRV;                 /*    @D52TDJS*/ 01314603
* IF CHAIN(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01314703
* IF CHAINID(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01314803
* IF DIRINF(1) = '' THEN GOTO ERRSRV;                 /*    @D52TDJS*/ 01314903
* IF DIRNO(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01315003
* IF DIRINFL(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01315103
* IF DATA(1) = '' THEN GOTO ERRSRV;                   /*    @D52TDJS*/ 01315203
* IF DATAID(1) = '' THEN GOTO ERRSRV;                 /*    @D52TDJS*/ 01315303
* IF DATALEN(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01315403
* IF NOTFND(1) = '' THEN GOTO ERRSRV;                 /*    @D52TDJS*/ 01315503
* IF EODAD(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01315603
* IF CONT(1) = '' THEN GOTO ERRSRV;                   /*    @D52TDJS*/ 01315703
* IF EROPT(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01315803
* IF ERRAD(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01315903
* IF SRVEXIT(1) = '' THEN GOTO ERRSRV;                /*    @D52TDJS*/ 01316003
* IF CBLEN(1) = '' THEN GOTO ERRSRV;                  /*    @D52TDJS*/ 01316103
* IF ENV(1) = '' THEN GOTO ERRSRV;                    /*    @D52TDJS*/ 01316203
* IF LOCKID(1) = '' THEN GOTO ERRSRV;                 /*    @D52RDUT*/ 01316303
* GOTO SRVRDOK;                                        /*    @D52TDJS*/ 01316403
* ERRSRV:;                                             /*    @D52TDJS*/ 01316503
*  ANS MSG                                                              01316603
*  ('FUNCTION CONTAINS INVALID PARAMETER, GENERATION SUPPRESSED')       01316703
*      COL(COLA) SKIP NORESCAN;                        /*    @D52TDJS*/ 01316803
*      IALRC = RCERR;                                  /*    @D52TDJS*/ 01316903
*      GOTO MEND;                                      /*    @D52TDJS*/ 01317003
* SRVRDOK:;                                            /*    @D52TDJS*/ 01317103
* /*                                                         @D52TDJS*/ 01317203
* /* BUILD I/F IN AREA ADDRESSED BY WSTOR                    @D52TDJS*/ 01317303
* /*                                                         @D52TDJS*/ 01317403
* /*                                                         @D52TDJS*/ 01317503
* IF WSTOR(1,1:1) ='('                  /* ADDRESS NOTATION  @D52TDJS*/ 01317603
* THEN                                  /*                   @D52TDJS*/ 01317703
*   TWORK = WSTOR(1,1);                 /*                   @D52TDJS*/ 01317803
* ELSE                                  /* NAME NOTATION     @D52TDJS*/ 01317903
*   TWORK = 'ADDR('|| WSTOR(1) || ')';  /*                   @D52TDJS*/ 01318003
* ANS ('RFY (FRHDRG0,FRHDRG1,FRHDRG14,FRHDRG15) RSTD;')   /* @D52TDJS*/ 01318103
*      SKIP RESCAN;                                       /* @D52TDJS*/ 01318203
* ANS ('FRHDRG1 = '|| TWORK || ';') COL(COLA) SKIP RESCAN;/* @D52TDJS*/ 01318303
* ANS ('/* ADDRESS I/F AREA      */') COL(COLD) NORESCAN; /* @D52TDJS*/ 01318403
* ANS ('FRHDIFMA = ''''B;       ') COL(COLA) SKIP RESCAN; /* @D52TDJS*/ 01318503
* ANS ('/* CLEAR I/F AREA        */') COL(COLD) NORESCAN; /* @D52TDJS*/ 01318603
* /*                                                         @D52TDJS*/ 01318703
* /* STORE SENDBF                                            @D52TDJS*/ 01318803
* /*                                                         @D52TDJS*/ 01318903
* IF SENDBF(1,1:1) ='('                 /* ADDRESS NOTATION  @D52TDJS*/ 01319003
* THEN                                  /*                   @D52TDJS*/ 01319103
*   TWORK = SENDBF(1,1);                /*                   @D52TDJS*/ 01319203
* ELSE                                  /* NAME NOTATION     @D52TDJS*/ 01319303
*   TWORK = 'ADDR('|| SENDBF(1) || ')'; /*                   @D52TDJS*/ 01319403
* ANS ('FRHDIFBA = '|| TWORK || ';') COL(COLA) SKIP RESCAN;/*@D52TDJS*/ 01319503
* ANS ('/* SENDBF ADDRESS        */') COL(COLD) NORESCAN; /* @D52TDJS*/ 01319603
* /*                                                         @D52TDJS*/ 01319703
* /* STORE SENDBFL                                           @D52TDJS*/ 01319803
* /*                                                         @D52TDJS*/ 01319903
* IF SENDBFL(1,1:1) ='('                /* ADDRESS NOTATION  @D52TDJS*/ 01320003
* THEN                                  /*                   @D52TDJS*/ 01320103
*   TWORK = SENDBFL(1,1);               /*                   @D52TDJS*/ 01320203
* ELSE                                  /* NAME NOTATION     @D52TDJS*/ 01320303
*   TWORK = SENDBFL(1);                 /*                   @D52TDJS*/ 01320403
* ANS ('FRHDIFBL = '|| TWORK || ';') COL(COLA) SKIP RESCAN;/*@D52TDJS*/ 01320503
* ANS ('/* SENDBFL VALUE         */') COL(COLD) NORESCAN; /* @D52TDJS*/ 01320603
* /*                                                         @D52TDJS*/ 01320703
* /* STORE LDCB IF APPLICABLE                                @D52TDJS*/ 01320803
* /*                                                         @D52TDJS*/ 01320903
* IF LDCB(1) = '' THEN DO;             /*                   @D52TDJS*/ 01321003
* IF LDCB(1,1:1) ='('                   /* ADDRESS NOTATION  @D52TDJS*/ 01321103
* THEN                                  /*                   @D52TDJS*/ 01321203
*   TWORK = LDCB(1,1);                  /*                   @D52TDJS*/ 01321303
* ELSE                                  /* NAME NOTATION     @D52TDJS*/ 01321403
*   TWORK = 'ADDR('|| LDCB(1) || ')';   /*                   @D52TDJS*/ 01321503
* ANS ('FRHDIFLA = '|| TWORK || ';') COL(COLA) SKIP RESCAN;/*@D52TDJS*/ 01321603
* ANS ('/* LDCB ADDRESS          */') COL(COLD) NORESCAN; /* @D52TDJS*/ 01321703
* END;                                  /*                   @D52TDJS*/ 01321803
* /*                                                         @D52TDJS*/ 01321903
* /* STORE THE REQUEST                                       @D52TDJS*/ 01322003
* /*                                                         @D52TDJS*/ 01322103
* IF REQUEST(1) = 'API' THEN               /* API REQUEST    @D52TDJS*/ 01322203
* DO;                                      /*                @D52TDJS*/ 01322303
* ANS ('FRHDIFRQ = FRHDCAPI;') COL(COLA) SKIP RESCAN;      /*@D52TDJS*/ 01322403
* ANS ('/* API FRAME REQUEST     */') COL(COLD) NORESCAN; /* @D52TDJS*/ 01322503
* END;                                     /*                @D52TDJS*/ 01322603
* IF REQUEST(1) = 'COMMAND' THEN           /*COMMAND REQUEST @D52TDJS*/ 01322703
* DO;                                      /*                @D52TDJS*/ 01322803
* ANS ('FRHDIFRQ = FRHDCCMD;') COL(COLA) SKIP RESCAN;      /*@D52TDJS*/ 01322903
* ANS ('/* COMMAND FRAME REQUEST */') COL(COLD) NORESCAN; /* @D52TDJS*/ 01323003
* END;                                     /*                @D52TDJS*/ 01323103
* IF REQUEST(1) = 'RESET' THEN             /* RESET REQUEST  @D52TDJS*/ 01323203
* DO;                                      /*                @D52TDJS*/ 01323303
* ANS ('FRHDIFRQ = FRHDCRST;') COL(COLA) SKIP RESCAN;      /*@D52TDJS*/ 01323403
* ANS ('/* RESET FRAME REQUEST */') COL(COLD) NORESCAN;   /* @D52TDJS*/ 01323503
* END;                                     /*                @D52TDJS*/ 01323603
* /*                                                         @D52TDJS*/ 01323703
* /* STORE THE MODE, IF APPLICABLE                           @D52TDJS*/ 01323803
* /*                                                         @D52TDJS*/ 01323903
* IF MODE(1) = '' THEN                    /*                @D52TDJS*/ 01324003
* DO;                                      /*                @D52TDJS*/ 01324103
* IF MODE(1) = 'STOP' THEN                 /* STOP MODE      @D52TDJS*/ 01324203
* DO;                                      /*                @D52TDJS*/ 01324303
* ANS ('FRHDIFMD = FRHDCSTP;') COL(COLA) SKIP RESCAN;      /*@D52TDJS*/ 01324403
* ANS ('/* STOP MODE             */') COL(COLD) NORESCAN; /* @D52TDJS*/ 01324503
* END;                                     /*                @D52TDJS*/ 01324603
* IF MODE(1) = 'CONTINUE' THEN             /* CONTINUE MODE  @D52TDJS*/ 01324703
* DO;                                      /*                @D52TDJS*/ 01324803
* ANS ('FRHDIFMD = FRHDCCNT;') COL(COLA) SKIP RESCAN;      /*@D52TDJS*/ 01324903
* ANS ('/* CONTINUE MODE         */') COL(COLD) NORESCAN; /* @D52TDJS*/ 01325003
* END;                                     /*                @D52TDJS*/ 01325103
* END;                                     /*                @D52TDJS*/ 01325203
* ANS ('FRHDRG0 = 120;') COL(COLA) SKIP NORESCAN;   /*       @D52TDJS*/ 01325303
* ANS ('/* SET CODE TO CALL INLPFRSP */') COL(COLD) NORESCAN;           01325403
* ANS ('GENERATE REFS(FRHDRG14,FRHDRG15);')                             01325503
*      COL(COLA) SKIP RESCAN;                       /*       @D52TDJS*/ 01325603
* ANS ('ASYSCOM FRHDRG15') COL(COL1+9) SKIP NORESCAN;  /*    @D52TDJS*/ 01325703
* ANS ('L FRHDRG15,300(0,FRHDRG15)') COL(COL1+9) SKIP NORESCAN;         01325803
* ANS ('L FRHDRG15,0(0,FRHDRG15)') COL(COL1+9) SKIP NORESCAN;           01325903
* ANS ('ADDR OF PHASE $IJBLBR') COL(COLD) NORESCAN;       /* @D52TDJS*/ 01326003
* ANS ('BALR  FRHDRG14,FRHDRG15') COL(COL1+9) SKIP NORESCAN;            01326103
* ANS ('BRANCH TO $IJBLBR-INLPFRSP') COL(COLD) NORESCAN;  /* @D52TDJS*/ 01326203
* ANS (MACCONC||'ENDGEN;') COL(COLA) SKIP NORESCAN;       /* @D52TDJS*/ 01326303
* ANS ('RFY (FRHDRG0,FRHDRG1,FRHDRG14,FRHDRG15);')        /* @D52TDJS*/ 01326403
*      SKIP RESCAN;                                       /* @D52TDJS*/ 01326503
* GOTO MEND;                               /*                @D52TDJS*/ 01326603
* END;                                     /*                @D52TDJS*/ 01326703
* SHWCB1:;                                 /*                @D52TDJS*/ 01326803
* /*                                                                 */ 01326903
* /*   HANDLE SHOWCB                                                 */ 01327003
* /*                                                                 */ 01327103
* IF SHOWCB = '' THEN GOTO CHKFRST;                                     01327203
* IALFC = 'SHOWCB';                                                     01327303
* /*                                                                 */ 01327403
* /*  CBLEN  MUST BE SPECIFIED                                       */ 01327503
* /*                                                                 */ 01327603
* IF CBLEN(1) = '' THEN                                                 01327703
* DO;                                                                   01327803
*  ANS MSG ('PARAMETER CBLEN MISSING, GENERATION SUPPRESSED')           01327903
*      COL(COLA) SKIP NORESCAN;                                         01328003
*  IALRC = RCERR;                                                       01328103
*  IALSYER = 1;                                                         01328203
* END;                                                                  01328303
* /*                                                                 */ 01328403
* /*    NO OTHER PARAMTERS ARE ALLOWED                               */ 01328503
* /*                                                                 */ 01328603
* IF LDCB(1) = '' THEN GOTO ERRSHB;                                    01328703
* IF LIB(1) = '' THEN GOTO ERRSHB;                                     01328803
* IF SUBLIB(1) = '' THEN GOTO ERRSHB;                                  01328903
* IF MEMBER(1) = '' THEN GOTO ERRSHB;                                  01329003
* IF TYPE(1) = '' THEN GOTO ERRSHB;                                    01329103
* IF NMEMBER(1) = '' THEN GOTO ERRSHB;                                 01329203
* IF NTYPE(1) = '' THEN GOTO ERRSHB;                                   01329303
* IF CATALOG(1) = '' THEN GOTO ERRSHB;                                 01329403
* IF SCOPE(1) = '' THEN GOTO ERRSHB;                                   01329503
* IF BUFFER(1) = '' THEN GOTO ERRSHB;                                  01329603
* IF BUFSIZE(1) = '' THEN GOTO ERRSHB;                                 01329703
* IF COMMIT(1) = '' THEN GOTO ERRSHB;                                  01329803
* IF NOTEINF(1) = '' THEN GOTO ERRSHB;                                 01329903
* IF NOTECTL(1) = '' THEN GOTO ERRSHB;                                 01330003
* IF RECFM(1) = '' THEN GOTO ERRSHB;                                   01330103
* IF RECNO(1) = '' THEN GOTO ERRSHB;                                   01330203
* IF UNITS(1) = '' THEN GOTO ERRSHB;                                   01330303
* IF MOVELEN(1) = '' THEN GOTO ERRSHB;                                 01330403
* IF SYSIPT(1) = '' THEN GOTO ERRSHB;                                  01330503
* IF CHAIN(1) = '' THEN GOTO ERRSHB;                                   01330603
* IF CHAINID(1) = '' THEN GOTO ERRSHB;                                 01330703
* IF DIRINF(1) = '' THEN GOTO ERRSHB;                                  01330803
* IF DIRNO(1) = '' THEN GOTO ERRSHB;                                   01330903
* IF DIRINFL(1) = '' THEN GOTO ERRSHB;                                 01331003
* IF DATA(1) = '' THEN GOTO ERRSHB;                                    01332003
* IF DATAID(1) = '' THEN GOTO ERRSHB;                                  01333003
* IF DATALEN(1) = '' THEN GOTO ERRSHB;                                 01334003
* IF NOTFND(1) = '' THEN GOTO ERRSHB;                                  01335003
* IF EODAD(1) = '' THEN GOTO ERRSHB;                                   01336003
* IF CONT(1) = '' THEN GOTO ERRSHB;                                    01337003
* IF EROPT(1) = '' THEN GOTO ERRSHB;                                   01338003
* IF ERRAD(1) = '' THEN GOTO ERRSHB;                                   01339003
* IF SRVEXIT(1) = '' THEN GOTO ERRSHB;                /*    @D52TDJS*/ 01339103
* IF ENV(1) = '' THEN GOTO ERRSHB;                    /*    @D52TDJS*/ 01339203
* IF FRAME(1) = '' THEN GOTO ERRSHB;                  /*    @D52TDJS*/ 01339303
* IF SENDBF(1) = '' THEN GOTO ERRSHB;                 /*    @D52TDJS*/ 01339403
* IF SENDBFL(1) = '' THEN GOTO ERRSHB;                /*    @D52TDJS*/ 01339503
* IF REQUEST(1) = '' THEN GOTO ERRSHB;                /*    @D52TDJS*/ 01339603
* IF MODE(1) = '' THEN GOTO ERRSHB;                   /*    @D52TDJS*/ 01339703
* IF WSTOR(1) = '' THEN GOTO ERRSHB;                  /*    @D52TDJS*/ 01339803
* IF LOCKID(1) = '' THEN GOTO ERRSHB;                 /*    @D52RDUT*/ 01339903
* IF IALSYER = 1 THEN GOTO MEND;       /* INVALID CBLEN              */ 01340003
* IF SHOWCB(1) = 'LDCB' |                                               01341003
*    SHOWCB(1) = 'MBST'  |                                              01342003
*    SHOWCB(1) = 'SBST'  |                                              01343003
*    SHOWCB(1) = 'LBST'  |                                              01344003
*    SHOWCB(1) = 'NOTEINF'  THEN                                        01345003
* DO;                                                                   01346003
*   IALINN = 1;                  /* CALL LIBRDCB FOR DSECTS          */ 01347003
*   ANS (' ? LIBRDCB FUNC(MAP);') COL(COLA) SKIP RESCAN;                01348003
*   ANS ('RFY (IALCBR0,IALCBR1,IALCBR14,IALCBR15) RSTD;')               01349003
*        COL(COLA) SKIP NORESCAN;                                       01350003
*   ANS ('IALCBR1 = '||'IALC'||SHOWCB(1,1:3)||';')                      01351003
*        COL(COLA) SKIP NORESCAN;                                       01352003
*   GOTO INVOC;                      /* CALL INLPIALC                */ 01353003
* END;                                                                  01354003
* ELSE DO;                                                              01355003
*  ANS MSG ('INVALID CONTROL BLOCK FOR SHOWCB, GENERATION SUPPRESSED')  01356003
*      COL(COLA) SKIP NORESCAN;                                         01357003
*  IALRC = RCERR;                                                       01358003
*  GOTO MEND;                                                           01359003
* END;                                                                  01360003
* /*                                                                 */ 01361003
* /*   SPECIAL ERROR EXIT FOR SHOWCB                                 */ 01362003
* /*                                                                 */ 01363003
* ERRSHB:;                                                              01364003
*  ANS MSG                                                              01365003
*  ('FUNCTION CONTAINS INVALID PARAMETER, GENERATION SUPPRESSED')       01366003
*      COL(COLA) SKIP NORESCAN;                                         01367003
*  IALRC = RCERR;                                                       01368003
*  GOTO MEND;                                                           01369003
* /*                                                                 */ 01370003
* /* CHECK VALIDATION OF PARAMETERS FOR SPECIFIED FUNCTION           */ 01371003
* /*                                                                 */ 01372003
* /* FIRST CHECK EXISTENCE OF LDCB OPERAND                           */ 01373003
* /*                                                                 */ 01374003
*                                                                       01375003
* CHKFRST:;                                                             01376003
* IF LDCB(1) = '' THEN                                                  01377003
* DO;                                                                   01378003
*   ANS MSG ('PARAMETER LDCB MISSING, GENERATION SUPPRESSED')           01379003
*         COL(COLA) SKIP NORESCAN;                                      01380003
*   IALRC = RCERR;                                                      01381003
*   IALSYER = 1;                                                        01382003
* END;                                                                  01383003
* /*                                                                 */ 01384003
* /*   L I B D E F                                                   */ 01385003
* /*                                                                 */ 01386003
* CHKLIB:;                                                              01387003
* IF LIBDEF = '' THEN GOTO CHKDROP;                                     01388003
* IALFC = 'LIBDEF';                                                     01389003
* /*                                                                 */ 01390003
* /* NO ARGUMENTS ALLOWED                                            */ 01391003
* /*                                                                 */ 01392003
* IF LIBDEF(1) = '' THEN                                               01393003
* DO;                                                                   01394003
*  ANS MSG ('MAIN FUNCTION LIBDEF INVALID, GENERATION SUPPRESSED')      01395003
*      COL(COLA) SKIP NORESCAN;                                         01396003
*  IALRC = RCERR;                                                       01397003
*  IALSYER = 1;                                                         01398003
* END;                                                                  01399003
* TCHAIN = '';                       /* CLEAR CHAIN IF NOT SPECIFIED */ 01400003
* IF CHAIN(1) = '' THEN                                                01401003
* TCHAIN = CHAIN(1);                 /* SET CHAIN AS SPEC. IN CHAIN  */ 01402003
* GOTO CHKLBDD;                      /* CHECK INVALID PARAMTER       */ 01403003
* CHKDROP:;                                                             01404003
* /*                                                                 */ 01405003
* /*  L I B D R O P                                                  */ 01406003
* /*                                                                 */ 01407003
* IF LIBDROP = '' THEN GOTO CHKSTAT;                                    01408003
* /*                                                                 */ 01409003
* /* NO ARGUMENTS ALLOWED                                            */ 01410003
* /*                                                                 */ 01411003
* IF LIBDROP(1) = '' THEN                                              01412003
* DO;                                                                   01413003
*  ANS MSG ('MAIN FUNCTION LIBDROP INVALID, GENERATION SUPPRESSED')     01414003
*      COL(COLA) SKIP NORESCAN;                                         01415003
*  IALRC = RCERR;                                                       01416003
*  IALSYER = 1;                                                         01417003
* END;                                                                  01418003
* IALFC = 'LIBDROP';                                                    01419003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01420003
* CHKLBDD:                                                              01421003
* IF LIB(1) = '' THEN GOTO ERREXT;                                     01422003
* IF SUBLIB(1) = '' THEN GOTO ERREXT;                                  01423003
* IF MEMBER(1) = '' THEN GOTO ERREXT;                                  01424003
* IF TYPE(1) = '' THEN GOTO ERREXT;                                    01425003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01426003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01427003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01428003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01429003
* IF BUFFER(1) = '' THEN GOTO ERREXT;                                  01430003
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                                 01431003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01432003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01433003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01434003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01435003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01436003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01437003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01438003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01439003
* IF DIRINF(1) = '' THEN GOTO ERREXT;                                  01440003
* IF DIRNO(1) = '' THEN GOTO ERREXT;                                   01441003
* IF CONT(1) = '' THEN GOTO ERREXT;                                    01442003
* IF DIRINFL(1) = '' THEN GOTO ERREXT;                                 01443003
* IF DATA(1) = '' THEN GOTO ERREXT;                                    01444003
* IF DATAID(1) = '' THEN GOTO ERREXT;                                  01445003
* IF DATALEN(1) = '' THEN GOTO ERREXT;                                 01446003
* IF NOTFND(1) = '' THEN GOTO ERREXT;                                  01447003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01448003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01448103
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01448203
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01448303
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01448403
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01448503
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01448603
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01448703
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01448803
* IF LOCKID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01448903
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01449003
* CHKSTAT:;                                                             01450003
* /*                                                                 */ 01451003
* /*      S T A T E                                                  */ 01452003
* /*                                                                 */ 01453003
* IF STATE = '' THEN GOTO CHKDELM;                                      01454003
* IF STATE(1) = '' | STATE(1) = 'MEMBER'                                01455003
*    THEN IALFC = 'STATMBR';                                            01456003
*    ELSE GOTO CHKSTSL;              /* CHECK STATE SUBLIB           */ 01457003
* /*                                                                 */ 01458003
* /*     CHECK VALIDATION OF PARAMETERS FOR STATE(MEMBER)            */ 01459003
* /*                                                                 */ 01460003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01461003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01462003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01463003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01464003
* IF BUFFER(1) = '' THEN GOTO ERREXT;                                  01465003
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                                 01466003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01467003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01468003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01469003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01470003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01471003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01472003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01473003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01474003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01475003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01476003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01477003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01478003
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01478103
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01478203
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01478303
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01478403
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01478503
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01478603
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01478703
* CHKSTSL:;                                                             01478803
* /*     STATE SUBLIB                                                */ 01478903
* IF STATE(1) = 'SUBLIB'                                               01479003
*    THEN GOTO CHKSTLI;              /* CHECK STATE(LIB)             */ 01480003
*    ELSE IALFC= 'STATSLIB';                                            01481003
* /*                                                                 */ 01482003
* /*     CHECK VALIDATION OF PARAMETERS FOR STATE(SUBLIB)            */ 01483003
* /*                                                                 */ 01484003
* IF MEMBER(1) = '' THEN GOTO ERREXT;                                  01485003
* IF TYPE(1) = '' THEN GOTO ERREXT;                                    01486003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01487003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01488003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01489003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01490003
* IF BUFFER(1) = '' THEN GOTO ERREXT;                                  01491003
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                                 01492003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01493003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01494003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01495003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01496003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01497003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01498003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01499003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01500003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01501003
* IF CHAINID(1) = '' THEN GOTO ERREXT;                                 01502003
* IF DATA(1) = '' THEN GOTO ERREXT;                                    01503003
* IF DATAID(1) = '' THEN GOTO ERREXT;                                  01504003
* IF DATALEN(1) = '' THEN GOTO ERREXT;                                 01505003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01506003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01507003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01508003
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01509003
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01510003
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01510103
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01510203
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01510303
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01510403
* IF LOCKID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01510503
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01510603
* CHKSTLI:;                                                             01510703
* /*     STATE LIB                                                   */ 01510803
* IF STATE(1) = 'LIB'                                                  01510903
*    THEN GOTO CHKSTCI;              /* CHECK STATE(LIB)             */ 01511003
*    ELSE IALFC= 'STATLIB';                                             01512003
* /*                                                                 */ 01513003
* /*     CHECK VALIDATION OF PARAMETERS FOR STATE(LIB)               */ 01514003
* /*                                                                 */ 01515003
* IF SUBLIB(1) = '' THEN GOTO ERREXT;                                  01516003
* IF MEMBER(1) = '' THEN GOTO ERREXT;                                  01517003
* IF TYPE(1) = '' THEN GOTO ERREXT;                                    01518003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01519003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01520003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01521003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01522003
* IF BUFFER(1) = '' THEN GOTO ERREXT;                                  01523003
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                                 01524003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01525003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01526003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01527003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01528003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01529003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01530003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01531003
* IF CONT(1) = '' THEN GOTO ERREXT;                                    01532003
* IF DIRNO(1) = '' THEN GOTO ERREXT;                                   01533003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01534003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01535003
* IF CHAINID(1) = '' THEN GOTO ERREXT;                                 01536003
* IF DATA(1) = '' THEN GOTO ERREXT;                                    01537003
* IF DATAID(1) = '' THEN GOTO ERREXT;                                  01538003
* IF DATALEN(1) = '' THEN GOTO ERREXT;                                 01539003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01540003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01541003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01542003
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01543003
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01544003
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01545003
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01545103
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01545203
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01545303
* IF LOCKID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01545403
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01545503
* CHKSTCI:;                                                             01545603
* /*    STATE CHAIN                                                  */ 01545703
* IF STATE(1) = 'CHAIN'                                                 01545803
*    THEN IALFC='STATCHN';                                              01545903
* ELSE DO;                                                              01546003
*   ANS MSG ('INVALID STATE OPERAND, GENERATION SUPPRESSED')            01547003
*            COL(COLA) SKIP NORESCAN;                                   01548003
*   IALRC = RCERR;                                                      01549003
*   IALSYER = 1;                                                        01550003
*   GOTO CHKFUN;                                                        01551003
* END;                                                                  01552003
* IF SCOPE(1) = ''                                                      01553003
*    THEN  TSCOPE = 'TASK';          /* SET SCOPE TO DEFAULT         */ 01554003
*    ELSE  TSCOPE = SCOPE(1);        /* SET SCOPE AS SPECIFIED       */ 01555003
* IF CHAIN(1) = '' THEN TCHAIN = CHAIN(1);                             01556003
*                                    /* SET CHAIN IF SPECIFIED       */ 01557003
* IF CATALOG(1) = '' THEN TCATALOG = CATALOG(1);                       01558003
*                                    /* SET CATALOG IF SPECIFIED     */ 01559003
* /*                                                                 */ 01560003
* /*     CHECK VALIDATION OF PARAMETERS FOR STATE(CHAIN)             */ 01561003
* /*                                                                 */ 01562003
* IF LIB(1) = '' THEN GOTO ERREXT;                                     01563003
* IF SUBLIB(1) = '' THEN GOTO ERREXT;                                  01564003
* IF MEMBER(1) = '' THEN GOTO ERREXT;                                  01565003
* IF TYPE(1) = '' THEN GOTO ERREXT;                                    01566003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01567003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01568003
* IF BUFFER(1) = '' THEN GOTO ERREXT;                                  01569003
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                                 01570003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01571003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01572003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01573003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01574003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01575003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01576003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01577003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01578003
* IF DIRINF(1) = '' THEN GOTO ERREXT;                                  01579003
* IF CONT(1) = '' THEN GOTO ERREXT;                                    01580003
* IF DIRNO(1) = '' THEN GOTO ERREXT;                                   01581003
* IF DIRINFL(1) = '' THEN GOTO ERREXT;                                 01582003
* IF DATA(1) = '' THEN GOTO ERREXT;                                    01583003
* IF DATAID(1) = '' THEN GOTO ERREXT;                                  01584003
* IF DATALEN(1) = '' THEN GOTO ERREXT;                                 01585003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01586003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01587003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01588003
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01589003
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01590003
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01591003
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01592003
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01592103
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01592203
* IF LOCKID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01592303
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01592403
* CHKDELM:;                                                             01592503
* /*                                                                 */ 01592603
* /*     D E L E T E                                                 */ 01592703
* /*                                                                 */ 01592803
* IF DELETE = '' THEN GOTO CHKLOCK;                                     01592903
* IALFC = 'DELETE';                                                     01593003
* IF DELETE(1) = '' | DELETE(1) ='MEMBER' THEN;                         01594003
* ELSE DO;                           /* WRONG DELETE OPERAND         */ 01595003
*   ANS MSG ('INVALID DELETE OPERAND, GENERATION SUPPRESSED')           01596003
*            COL(COLA) SKIP NORESCAN;                                   01597003
*   IALRC = RCERR;                                                      01598003
*   IALSYER = 1;                                                        01599003
* END;                                                                  01600003
* /*                                                                 */ 01601003
* /*     CHECK VALIDATION OF PARAMETERS FOR DELETE(MEMBER)           */ 01602003
* /*                                                                 */ 01603003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01604003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01605003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01606003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01607003
* IF BUFFER(1) = '' THEN GOTO ERREXT;                                  01608003
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                                 01609003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01610003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01611003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01612003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01613003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01614003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01615003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01616003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01617003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01618003
* IF DIRINF(1) = '' THEN GOTO ERREXT;                                  01619003
* IF DIRNO(1) = '' THEN GOTO ERREXT;                                   01620003
* IF DIRINFL(1) = '' THEN GOTO ERREXT;                                 01621003
* IF CONT(1) = '' THEN GOTO ERREXT;                                    01622003
* IF DATA(1) = '' THEN GOTO ERREXT;                                    01623003
* IF DATAID(1) = '' THEN GOTO ERREXT;                                  01624003
* IF DATALEN(1) = '' THEN GOTO ERREXT;                                 01625003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01626003
* IF NOTFND(1) = '' THEN GOTO ERREXT;                                  01627003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01628003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01629003
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01630003
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01631003
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01632003
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01633003
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01634003
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01634103
* IF LOCKID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01634203
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01634303
*                                                      /*    @D52RDUT*/ 01634403
* CHKLOCK:;                                                             01634503
* /*                                                                 */ 01634603
* /*     L O  C K  / U N L O C K                                     */ 01634703
* /*                                                                 */ 01634803
* IF LOCK = '' THEN DO;                               /*    @D52RDUT*/ 01634903
* IALFC = 'LOCK';                                      /*    @D52RDUT*/ 01635003
* END;                                                 /*    @D52RDUT*/ 01635103
* ELSE DO;                                             /*    @D52RDUT*/ 01635203
*    IF UNLOCK = '' THEN GOTO CHKRENM;                 /*    @D52RDUT*/ 01635303
*    IALFC = 'UNLOCK';                                 /*    @D52RDUT*/ 01635403
*    END;                                              /*    @D52RDUT*/ 01635503
* /*                                                                 */ 01635603
* /*     CHECK VALIDATION OF PARAMETERS FOR DELETE(MEMBER)           */ 01635703
* /*                                                                 */ 01635803
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01635903
* IF NTYPE(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01636003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01636103
* IF SCOPE(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01636203
* IF BUFFER(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01636303
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01636403
* IF COMMIT(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01636503
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01636603
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01636703
* IF RECFM(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01636803
* IF RECNO(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01636903
* IF UNITS(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01637003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01637103
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01637203
* IF CHAIN(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01637303
* IF DIRINF(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01637403
* IF DIRNO(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01637503
* IF DIRINFL(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01637603
* IF CONT(1) = '' THEN GOTO ERREXT;                   /*    @D52RDUT*/ 01637703
* IF DATA(1) = '' THEN GOTO ERREXT;                   /*    @D52RDUT*/ 01637803
* IF DATAID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01637903
* IF DATALEN(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01638003
* IF EODAD(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01638103
* IF NOTFND(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01638203
* IF CBLEN(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01638303
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52RDUT*/ 01638403
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01638503
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01638603
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01638703
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52RDUT*/ 01638803
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52RDUT*/ 01638903
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52RDUT*/ 01639003
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01639103
* CHKRENM:;                                                             01639203
* /*                                                                 */ 01639303
* /*     R E N A M E                                                 */ 01639403
* /*                                                                 */ 01639503
* IF RENAME = '' THEN GOTO CHKOPEN;                                     01639603
* IALFC = 'RENAME';                                                     01639703
* IF RENAME(1) = ''|  RENAME(1)= 'MEMBER' THEN;                         01639803
* ELSE DO;                           /* WRONG RENAME OPERAND         */ 01639903
*   ANS MSG ('INVALID RENAME OPERAND, GENERATION SUPPRESSED')           01640003
*            COL(COLA) SKIP NORESCAN;                                   01641003
*   IALRC = RCERR;                                                      01642003
*   IALSYER = 1;                                                        01643003
* END;                                                                  01644003
* /*                                                                 */ 01645003
* /*     NMEMBER, NTYPE MUST BE SPECIFIED                            */ 01646003
* /*                                                                 */ 01647003
* IF NMEMBER(1) = '' THEN                                               01648003
* DO;                                                                   01649003
*   ANS MSG ('NMEMBER MISSING, GENERATION SUPPRESSED')                  01650003
*            COL(COLA) SKIP NORESCAN;                                   01651003
*   IALRC = RCERR;                                                      01652003
*   IALSYER = 1;                                                        01653003
* END;                                                                  01654003
* IF NTYPE(1) = '' THEN                                                 01655003
* DO;                                                                   01656003
*   ANS MSG ('NTYPE MISSING, GENERATION SUPPRESSED')                    01657003
*            COL(COLA) SKIP NORESCAN;                                   01658003
*   IALRC = RCERR;                                                      01659003
*   IALSYER = 1;                                                        01660003
* END;                                                                  01661003
* /*                                                                 */ 01662003
* /*     CHECK VALIDATION OF PARAMETERS FOR RENAME(MEMBER)           */ 01663003
* /*                                                                 */ 01664003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01665003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01666003
* IF BUFFER(1) = '' THEN GOTO ERREXT;                                  01667003
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                                 01668003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01669003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01670003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01671003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01672003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01673003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01674003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01675003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01676003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01677003
* IF DIRINF(1) = '' THEN GOTO ERREXT;                                  01678003
* IF DIRNO(1) = '' THEN GOTO ERREXT;                                   01679003
* IF DIRINFL(1) = '' THEN GOTO ERREXT;                                 01680003
* IF CONT(1) = '' THEN GOTO ERREXT;                                    01681003
* IF DATA(1) = '' THEN GOTO ERREXT;                                    01682003
* IF DATAID(1) = '' THEN GOTO ERREXT;                                  01683003
* IF DATALEN(1) = '' THEN GOTO ERREXT;                                 01684003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01685003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01686003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01687003
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01688003
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01689003
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01690003
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01690103
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01690203
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01690303
* IF LOCKID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01690403
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01690503
* CHKOPEN:;                                                             01690603
* /*                                                                 */ 01690703
* /*     O P E N                                                     */ 01690803
* /*                                                                 */ 01690903
*  IF OPEN = '' THEN GOTO CHKGET;                                       01691003
*  IALFC = 'OPEN';                                                      01692003
*  IF OPEN(1) = 'OUTPUT' THEN    /* SYSIPT ONLY POSSIBLE AT OUTPUT   */ 01693003
*  DO;                                                                  01694003
*    IF SYSIPT(1) = '' THEN TSYSIPT='NO'; /* SET SYSIPT TO DEFAULT   */ 01695003
*    ELSE TSYSIPT=SYSIPT(1);                                            01696003
*  END;                                                                 01697003
*  ELSE DO;                                                             01698003
*    IF SYSIPT(1) = '' THEN                                            01699003
*    DO;                                                                01700003
*      ANS MSG ('SYSIPT ONLY POSSIBLE FOR OPEN(OUTPUT),' ||             01701003
*               'PARAMETER IGNORED' ) COL(COLA) SKIP NORESCAN;          01702003
*      IALRC = RCWARN;                                                  01703003
*    END;                                                               01704003
*  END;                                                                 01705003
*  IF OPEN(1) = 'OUTPUT' THEN                                           01706003
*  DO;                                                                  01707003
*    IALOP1 ='OUTPUT';                                                  01708003
*    IF OPEN(2) = 'REPLACE' THEN IALOP2 = 'REPLACE';                    01709003
*    ELSE DO;                                                           01710003
*      IF OPEN(2) = 'NOREPLACE' THEN IALOP2 = 'NOREPLACE';              01711003
*      ELSE DO;                                                         01712003
*        ANS MSG ('INVALID OPEN OPERAND, GENERATION SUPPRESSED')        01713003
*            COL(COLA) SKIP NORESCAN;                                   01714003
*        IALRC = RCERR;                                                 01715003
*        IALSYER= 1;                                                    01716003
*      END;                                                             01717003
*    END;                                                               01718003
*  END;                                                                 01719003
*  ELSE DO;                                                             01720003
*    IF OPEN(2) = '' THEN                                              01721003
*    DO;                                                                01722003
*      ANS MSG ('INVALID OPEN OPERAND, GENERATION SUPPRESSED')          01723003
*            COL(COLA) SKIP NORESCAN;                                   01724003
*      IALRC = RCERR;                                                   01725003
*      IALSYER= 1;                                                      01726003
*    END;                                                               01727003
*    IF OPEN(1) = 'INPUT'| OPEN(1) = '' THEN IALOP1 = 'INPUT';          01728003
*    ELSE DO;                                                           01729003
*      IF OPEN(1) = 'INOUT' THEN IALOP1 = 'INOUT';                      01730003
*      ELSE DO;                                                         01731003
*          ANS MSG ('INVALID OPEN OPERAND, GENERATION SUPPRESSED')      01732003
*              COL(COLA) SKIP NORESCAN;                                 01733003
*          IALRC = RCERR;                                               01734003
*          IALSYER= 1;                                                  01735003
*       END;                                                            01736003
*    END;                                                               01737003
*  END;                                                                 01738003
* /*                                                                 */ 01739003
* /*     CHECK VALIDATION OF PARAMETERS FOR OPEN                     */ 01740003
* /*                                                                 */ 01741003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01742003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01743003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01744003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01745003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01746003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01747003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01748003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01749003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01750003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01751003
* IF CONT(1) = '' THEN GOTO ERREXT;                                    01752003
* IF DIRNO(1) = '' THEN GOTO ERREXT;                                   01753003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01754003
* IF NOTFND(1) = '' THEN GOTO ERREXT;                                  01755003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01756003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01757003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01758003
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01759003
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01760003
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01761003
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01762003
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01762103
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01762203
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01762303
* CHKGET:;                                                              01762403
* /*                                                                 */ 01762503
* /*     G E T / P U T                                               */ 01762603
* /*                                                                 */ 01762703
* IF GET = '' & PUT = '' THEN GOTO CHKNTPT;                             01762803
* IF GET = '' THEN                  /* GET SPECIFIED                */ 01762903
* DO;                                                                   01763003
*   IALFC = 'GET';                                                      01764003
*   IF GET(1) = '' THEN                                                01765003
*   DO;                                                                 01766003
*    ANS MSG ('MAIN FUNCTION GET INVALID, GENERATION SUPPRESSED')       01767003
*            COL(COLA) SKIP NORESCAN;                                   01768003
*    IALRC = RCERR;                                                     01769003
*    IALSYER = 1;                                                       01770003
*   END;                                                                01771003
* END;                                                                  01772003
* ELSE DO;                           /* PUT SPECIFIED                */ 01773003
*   IALFC = 'PUT';                                                      01774003
*   IF PUT(1) = '' THEN                                                01775003
*   DO;                                                                 01776003
*     ANS MSG ('MAIN FUNCTION PUT INVALID, GENERATION SUPPRESSED')      01777003
*             COL(COLA) SKIP NORESCAN;                                  01778003
*     IALRC = RCERR;                                                    01779003
*     IALSYER = 1;                                                      01780003
*   END;                                                                01781003
*   IF MOVELEN(1) = '' THEN GOTO ERREXT;                               01782003
*   IF EODAD(1) = '' THEN GOTO ERREXT;                                 01783003
* END;                                                                  01784003
* /*                                                                 */ 01785003
* /*     CHECK VALIDATION OF PARAMETERS FOR GET/PUT                  */ 01786003
* /*                                                                 */ 01787003
* IF LIB(1) = '' THEN GOTO ERREXT;                                     01788003
* IF SUBLIB(1) = '' THEN GOTO ERREXT;                                  01789003
* IF MEMBER(1) = '' THEN GOTO ERREXT;                                  01790003
* IF TYPE(1) = '' THEN GOTO ERREXT;                                    01791003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01792003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01793003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01794003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01795003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01796003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01797003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01798003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01799003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01800003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01801003
* IF CHAINID(1) = '' THEN GOTO ERREXT;                                 01802003
* IF DIRINF(1) = '' THEN GOTO ERREXT;                                  01803003
* IF DIRNO(1) = '' THEN GOTO ERREXT;                                   01804003
* IF CONT(1) = '' THEN GOTO ERREXT;                                    01805003
* IF DIRINFL(1) = '' THEN GOTO ERREXT;                                 01806003
* IF DATA(1) = '' THEN GOTO ERREXT;                                    01807003
* IF DATAID(1) = '' THEN GOTO ERREXT;                                  01808003
* IF DATALEN(1) = '' THEN GOTO ERREXT;                                 01809003
* IF NOTFND(1) = '' THEN GOTO ERREXT;                                  01810003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01811003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01812003
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01813003
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01814003
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01815003
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01816003
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01817003
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01818003
* IF LOCKID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01818103
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01818203
* CHKNTPT:;                                                             01818303
* /*                                                                 */ 01818403
* /*     N O T E F/P O I N T                                 @D61YDMF*/ 01818503
* /*                                                                 */ 01818603
* IF NOTEF = '' & POINT = '' THEN GOTO CHKCLS;            /* @D61YDMF*/ 01818703
* IF NOTEF = '' THEN                /* NOTEF GIVEN          @D61YDMF*/ 01818803
* DO;                                                                   01818903
*   IALFC = 'NOTE';                                                     01819003
*   IF NOTEF(1) = '' | NOTEF(1) = 'CURRENT'               /* @D61YDMF*/ 01820003
*   THEN IALNTOP = 'CURRENT';        /* SET NOTE TO DEFAULT          */ 01821003
*   ELSE DO;                                                            01822003
*     IF NOTEF(1) = 'PREVIOUS'                            /* @D61YDMF*/ 01823003
*     THEN IALNTOP = 'PREVIOUS';                                        01824003
*     ELSE DO;                                                          01825003
*       ANS MSG ('INVALID NOTEF OPERAND, GENERATION SUPPRESSED')        01826003
*           COL(COLA) SKIP NORESCAN;                      /* @D61YDMF*/ 01827003
*       IALRC = RCERR;                                                  01828003
*       IALSYER= 1;                                                     01829003
*     END;                                                              01830003
*   END;                                                                01831003
* END;                                                                  01832003
* ELSE DO;                           /* POINT GIVEN                  */ 01833003
*   IALFC = 'POINT';                                                    01834003
*   IF POINT (1) = '' THEN                                             01835003
*   DO;                                                                 01836003
*     ANS MSG ('MAIN FUNCTION POINT INVALID, GENERATION SUPPRESSED')    01837003
*             COL(COLA) SKIP NORESCAN;                                  01838003
*     IALRC = RCERR;                                                    01839003
*     IALSYER = 1;                                                      01840003
*   END;                                                                01841003
* END;                                                                  01842003
* IF NOTECTL(1) = ''                                                    01843003
*    THEN TNOTECTL = 'NO';           /* SET NOTECTL TO DEFAULT       */ 01844003
*    ELSE TNOTECTL = NOTECTL(1);     /* SET NOTECTL AS SPECIFIED     */ 01845003
* IF TNOTECTL = 'YES' THEN           /* NOTEINF MUST BE SPECIFIED    */ 01846003
* DO;                                                                   01847003
*   IF NOTEINF(1) = '' THEN                                             01848003
*   DO;                                                                 01849003
*     ANS MSG ('NOTEINF MUST BE SPECIFIED FOR NOTECTL = YES, ' ||       01850003
*              'GENERATION SUPPRESSED')                                 01851003
*              COL(COLA) SKIP NORESCAN;                                 01852003
*     IALRC = RCERR;                                                    01853003
*     IALSYER = 1;                                                      01854003
*   END;                                                                01855003
*   TNOTEINF = NOTEINF(1);                                              01856003
* END;                                                                  01857003
* ELSE DO;                          /* NOTECONTROL = NO              */ 01858003
*   TNOTEINF = '';                  /* IGNORE NOTEINF                */ 01859003
*   IF NOTEINF(1) = '' THEN                                            01860003
*   DO;                                                                 01861003
*     ANS MSG ('NOTEINF ONLY VALID FOR NOTECTL = YES, ' ||              01862003
*              'PARAMETER IGNORED')                                     01863003
*              COL(COLA) SKIP NORESCAN;                                 01864003
*     IALRC = RCWARN;                                                   01865003
*   END;                                                                01866003
* END;                                                                  01867003
* /*                                                                 */ 01868003
* /*     CHECK VALIDATION OF PARAMETERS FOR NOTEF/POINT      @D61YDMF*/ 01869003
* /*                                                                 */ 01870003
* IF LIB(1) = '' THEN GOTO ERREXT;                                     01871003
* IF SUBLIB(1) = '' THEN GOTO ERREXT;                                  01872003
* IF MEMBER(1) = '' THEN GOTO ERREXT;                                  01873003
* IF TYPE(1) = '' THEN GOTO ERREXT;                                    01874003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01875003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01876003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01877003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01878003
* IF BUFFER(1) = '' THEN GOTO ERREXT;                                  01879003
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                                 01880003
* IF COMMIT(1) = '' THEN GOTO ERREXT;                                  01881003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01882003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01883003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01884003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01885003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01886003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01887003
* IF CHAINID(1) = '' THEN GOTO ERREXT;                                 01888003
* IF DIRINF(1) = '' THEN GOTO ERREXT;                                  01889003
* IF DIRNO(1) = '' THEN GOTO ERREXT;                                   01890003
* IF CONT(1) = '' THEN GOTO ERREXT;                                    01891003
* IF DIRINFL(1) = '' THEN GOTO ERREXT;                                 01892003
* IF DATA(1) = '' THEN GOTO ERREXT;                                    01893003
* IF DATAID(1) = '' THEN GOTO ERREXT;                                  01894003
* IF DATALEN(1) = '' THEN GOTO ERREXT;                                 01895003
* IF NOTFND(1) = '' THEN GOTO ERREXT;                                  01896003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01897003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01898003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01899003
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01900003
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01901003
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01902003
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01903003
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01904003
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01905003
* IF LOCKID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01906003
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01907003
* CHKCLS:;                                                              01908003
* /*                                                                 */ 01909003
* /*     C L O S E                                                   */ 01910003
* /*                                                                 */ 01911003
* /* AT LEAST CLOSE IS SPECIFIED                                     */ 01912003
* IF CLOSE(1) = '' THEN              /* NO SUBOPERNAD ALLOWED       */ 01913003
* DO;                                                                   01914003
*   ANS MSG ('MAIN FUNCTION CLOSE INVALID, GENERATION SUPPRESSED')      01915003
*            COL(COLA) SKIP NORESCAN;                                   01916003
*    IALRC = RCERR;                                                     01917003
*    IALSYER = 1;                                                       01918003
* END;                                                                  01919003
* IALFC = 'CLOSE';                                                      01920003
*   IF COMMIT(1) = ''                                                   01921003
*   THEN TCOMMIT = 'YES';            /* SET COMMIT TO DEFAULT        */ 01922003
*   ELSE TCOMMIT = COMMIT(1);        /* SET COMMIT AS SPECIFIED      */ 01923003
* /*                                                                 */ 01924003
* /*     CHECK VALIDATION OF PARAMETERS FOR CLOSE                    */ 01925003
* /*                                                                 */ 01926003
* IF LIB(1) = '' THEN GOTO ERREXT;                                     01927003
* IF SUBLIB(1) = '' THEN GOTO ERREXT;                                  01928003
* IF MEMBER(1) = '' THEN GOTO ERREXT;                                  01929003
* IF TYPE(1) = '' THEN GOTO ERREXT;                                    01930003
* IF NMEMBER(1) = '' THEN GOTO ERREXT;                                 01931003
* IF DATA(1) = '' THEN GOTO ERREXT;                                    01932003
* IF DATAID(1) = '' THEN GOTO ERREXT;                                  01933003
* IF DATALEN(1) = '' THEN GOTO ERREXT;                                 01934003
* IF NTYPE(1) = '' THEN GOTO ERREXT;                                   01935003
* IF CATALOG(1) = '' THEN GOTO ERREXT;                                 01936003
* IF SCOPE(1) = '' THEN GOTO ERREXT;                                   01937003
* IF BUFFER(1) = '' THEN GOTO ERREXT;                                  01938003
* IF BUFSIZE(1) = '' THEN GOTO ERREXT;                                 01939003
* IF NOTEINF(1) = '' THEN GOTO ERREXT;                                 01940003
* IF NOTECTL(1) = '' THEN GOTO ERREXT;                                 01941003
* IF RECFM(1) = '' THEN GOTO ERREXT;                                   01942003
* IF RECNO(1) = '' THEN GOTO ERREXT;                                   01943003
* IF UNITS(1) = '' THEN GOTO ERREXT;                                   01944003
* IF MOVELEN(1) = '' THEN GOTO ERREXT;                                 01945003
* IF SYSIPT(1) = '' THEN GOTO ERREXT;                                  01946003
* IF CHAIN(1) = '' THEN GOTO ERREXT;                                   01947003
* IF CHAINID(1) = '' THEN GOTO ERREXT;                                 01948003
* IF DIRINF(1) = '' THEN GOTO ERREXT;                                  01949003
* IF DIRNO(1) = '' THEN GOTO ERREXT;                                   01950003
* IF CONT(1) = '' THEN GOTO ERREXT;                                    01951003
* IF DIRINFL(1) = '' THEN GOTO ERREXT;                                 01952003
* IF NOTFND(1) = '' THEN GOTO ERREXT;                                  01953003
* IF EODAD(1) = '' THEN GOTO ERREXT;                                   01954003
* IF CBLEN(1) = '' THEN GOTO ERREXT;                                   01955003
* IF ENV(1) = '' THEN GOTO ERREXT;                      /*  @D52TDJS*/ 01955103
* IF FRAME(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01955203
* IF SENDBF(1) = '' THEN GOTO ERREXT;                 /*    @D52TDJS*/ 01955303
* IF SENDBFL(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01955403
* IF REQUEST(1) = '' THEN GOTO ERREXT;                /*    @D52TDJS*/ 01955503
* IF MODE(1) = '' THEN GOTO ERREXT;                   /*    @D52TDJS*/ 01955603
* IF WSTOR(1) = '' THEN GOTO ERREXT;                  /*    @D52TDJS*/ 01955703
* IF LOCKID(1) = '' THEN GOTO ERREXT;                 /*    @D52RDUT*/ 01955803
* GOTO CHKFUN;                       /* CHECK PARAMETER VIA LIBRDCB  */ 01955903
* ERREXT:;                                                              01956003
* /*                                                                 */ 01957003
* /*      ERROR EXIT                                                 */ 01958003
* /*                                                                 */ 01959003
* ANS MSG                                                               01960003
* ('FUNCTION CONTAINS INVALID PARAMETERS, GENERATION SUPPRESSED')       01961003
*             COL(COLA) SKIP NORESCAN;                                  01962003
* IALRC = RCERR;                                                        01963003
* IALSYER = 1;                                                          01964003
* CHKFUN:;                                                              01965003
* IF IALSYER = 1 THEN GOTO MEND;  /* TERMINATE AT ERROR              */ 01966003
* IALINN = 1;                     /* LIBRDCB IS CALLED AS IN. MACRO  */ 01967003
* RCTEMP = IALRC;                /* SAVE RETURN CODE                 */ 01968003
* TLDCB = LDCB(1);                                                      01969003
* /*******************************************************************/ 01970003
* /*  PREPARE TEMPORARY STRINGS FOR INVOCATIION OF LIBRDCB MACRO     */ 01971003
* /*******************************************************************/ 01972003
* VALMF1:;                                                              01973003
* IF LIB(1) =  '' THEN TLIB = ' LIB('||LIB(1)||')';                    01974003
* IF SUBLIB(1) =  '' THEN TSUBLIB = ' SUBLIB('||SUBLIB(1)||')';        01975003
* IF MEMBER(1) =  '' THEN TMEMBER = ' MEMBER('||MEMBER(1)||')';        01976003
* IF TYPE(1) =  '' THEN TTYPE = ' TYPE('||TYPE(1)||')';                01977003
* IF NMEMBER(1) =  '' THEN TNMEMBER = ' NMEMBER('||NMEMBER(1)||')';    01978003
* IF NTYPE(1) =  '' THEN TNTYPE = ' NTYPE('||NTYPE(1)||')';            01979003
* IF TCATALOG   =  '' THEN TCATALOG = ' CATALOG('||TCATALOG||')';      01980003
* IF TSCOPE =  '' THEN TSCOPE = ' SCOPE('||TSCOPE||')';                01981003
* IF BUFFER(1) =  '' THEN TBUFFER = ' BUFFER('||BUFFER(1)||')';        01982003
* IF BUFSIZE(1) =   '' THEN TBUFFSIZ =' BUFSIZE('||BUFSIZE(1)||')';    01983003
* IF TCOMMIT =  '' THEN TCOMMIT = ' COMMIT('||TCOMMIT||')';            01984003
* IF TNOTEINF =  '' THEN TNOTEINF = ' NOTEINF('||TNOTEINF||')';        01985003
* IF TNOTECTL =  '' THEN TNOTECTL = ' NOTECTL('||TNOTECTL||')';        01986003
* IF RECFM(1) =  '' THEN TRECFM = ' RECFM('||RECFM(1)||')';            01987003
* IF RECNO(1) =  '' THEN TRECNO = ' RECNO('||RECNO(1)||')';            01988003
* IF UNITS(1) =  '' THEN TUNITS = ' UNITS('||UNITS(1)||')';            01989003
* IF TSYSIPT =  '' THEN TSYSIPT = ' SYSIPT('||TSYSIPT||')';            01990003
* IF TCHAIN =  '' THEN TCHAIN = ' CHAIN('||TCHAIN||')';                01991003
* IF CONT  =  '' THEN TCONT = ' CONT('||CONT(1)||')';                  01992003
* IF CHAINID(1) =  '' THEN TCHAINID = ' CHAINID('||CHAINID(1)||')';    01993003
* IF DIRINF(1) =  '' THEN TDIRINF = ' DIRINF('||DIRINF(1)||')';        01994003
* IF DIRINFL(1) =  '' THEN TDIRINFL = ' DIRINFL('||DIRINFL(1)||')';    01995003
* IF DATA(1) =  '' THEN TDATA = ' DATA('||DATA(1)||')';                01996003
* IF DATAID(1) =  '' THEN TDATAID = ' DATAID('||DATAID(1)||')';        01997003
* IF DATALEN(1) =  '' THEN TDATALEN = ' DATALEN('||DATALEN(1)||')';    01998003
* IF NOTFND(1) =  '' THEN TNOTFND = ' NOTFND('||NOTFND(1)||')';        01999003
* IF EODAD(1) = '' THEN TEODAD = ' EODAD('||EODAD(1)||')';             02000003
* IF EROPT(1) = '' THEN TEROPT = ' EROPT('||EROPT(1)||')';             02001003
* IF ERRAD(1) =  '' THEN TERRAD = ' ERRAD('||ERRAD(1)||')';            02002003
* IF SRVEXIT(1) =  '' THEN TSRVEXIT= ' SRVEXIT('||SRVEXIT(1)||')';     02003003
* IF LOCKID(1) =  '' THEN TLOCKID= ' LOCKID('||LOCKID(1)||')';         02003103
* /*******************************************************************/ 02003203
* /*  CALL    LIBRDCB MACRO AND CONTINUE SYNTAX CHECK                */ 02003303
* /*******************************************************************/ 02003403
* VALAREA:;                                                             02003503
* ANS ('? LIBRDCB FUNC(MOD) AREA('||TLDCB||') '||                       02003603
*     TLIB||TSUBLIB||TMEMBER||TTYPE||TNMEMBER||TNTYPE||TCATALOG||       02003703
*     TSCOPE||TBUFFER||TBUFFSIZ||TCOMMIT||TNOTEINF||TNOTECTL||          02003803
*     TRECFM||TRECNO||TUNITS||TSYSIPT||TCONT||                          02003903
*     TCHAIN||TCHAINID||TDIRINF||TDIRINFL||TDATA||TDATAID||             02004003
*     TDATALEN||TNOTFND||TEODAD||TEROPT||TERRAD||TSRVEXIT||             02005003
*     TLOCKID||';')                                                     02006003
*     COL(COLA) SKIP RESCAN;                         /*      @D52RDUT*/ 02007003
* IF IALSYER = 1 THEN                                                   02008003
* DO;                                                                   02009003
*   IF IALRC < RCTEMP THEN IALRC= RCTEMP; /* RETURN HIGHEST CODE     */ 02010003
*   GOTO MEND;                                                          02011003
* END;                                                                  02012003
* /*******************************************************************/ 02013003
* /*  PREPARE CALL TO PHASE $IJBLBR AND EXECUTE MODULE INLPIALC      */ 02014003
* /*******************************************************************/ 02015003
* ANS ('RFY (IALCBR0,IALCBR1,IALCBR14,IALCBR15) RSTD;')                 02016003
*      COL(COLA) SKIP RESCAN;                                           02017003
* IF TLDCB(1:1)= '(' THEN           /* REGISTER NOTATION            */  02018003
* DO;                                                                   02019003
*  ANS ('IALCBR1 = '||TLDCB(2:LENGTH(TLDCB)-1)||';')                    02020003
*      COL(COLA) SKIP RESCAN;                                           02021003
*  ANS ('/* REGISTER 1 POINTS TO LDCB */') COL(COLD) NORESCAN;          02022003
* END;                                                                  02023003
* ELSE DO;                                                              02024003
*   ANS ('IALCBR1 = ADDR(TLDCB);') COL(COLA) SKIP RESCAN;               02025003
*   ANS ('/* REGISTER 1 POINTS TO LDCB  */') COL(COLD) NORESCAN;        02026003
* END;                                                                  02027003
* INVOC:;                                                               02028003
* IF IALENV = 0 | SHOWCB = '' THEN DO;   /* NO SERVER ACTIVE       */  02029003
* IF SHOWCB = '' THEN DO;    /* USE INLFRSP FOR SHOWCB     @D52TDJS*/  02030003
* ANS ('IALCBR0 = 120;') COL(COLA) SKIP NORESCAN;                       02031003
* ANS ('/* SET CODE TO CALL INLPFRSP @D52TDJS*/') COL(COLD) NORESCAN;   02032003
* END;                                            /*        @D52TDJS*/  02033003
* ELSE DO;                                        /*        @D52TDJS*/  02034003
* ANS ('IALCBR0 = 108;') COL(COLA) SKIP NORESCAN;                       02035003
* ANS ('/* SET CODE TO CALL INLPIALC */') COL(COLD) NORESCAN;           02036003
* END;                                            /*        @D52TDJS*/  02037003
* ANS ('GENERATE SETS(IALCBR14,IALCBR15);')                             02038003
*      COL(COLA) SKIP RESCAN;                                           02039003
* ANS ('ASYSCOM IALCBR15') COL(COL1+9) SKIP NORESCAN;                   02040003
* ANS ('L IALCBR15,300(0,IALCBR15)') COL(COL1+9) SKIP NORESCAN;         02041003
* ANS ('L IALCBR15,0(0,IALCBR15)') COL(COL1+9) SKIP NORESCAN;           02042003
* ANS ('ADDR OF PHASE $IJBLBR') COL(COLD) NORESCAN;                     02043003
* ANS ('BALR  IALCBR14,IALCBR15') COL(COL1+9) SKIP NORESCAN;            02044003
* ANS ('BRANCH TO $IJBLBR-INLPIALC') COL(COLD) NORESCAN;                02045003
* ANS (MACCONC||'ENDGEN;') COL(COLA) SKIP NORESCAN;                     02046003
* IF SHOWCB = ''                    /* SHOWCB WAS ACTIVE            */ 02047003
* THEN DO;                        /* REGISTER 15 CONTAINS THE LENGTH */ 02048003
*   IF CBLEN(1,1:1) = '('         /* ADDRESS NOTATION FOR CBLEN      */ 02049003
*   THEN DO;                                                            02050003
*    ANS ('DCL L$CB'|| MACINDEX ||' FIXED(31) BASED('                   02051003
*          ||CBLEN(1,1)||');')                                          02052003
*          COL(COLA) SKIP RESCAN;                                       02053003
*    ANS ('L$CB'||MACINDEX||' = IALCBR0;') COL(COLA) SKIP RESCAN;       02054003
*    ANS ('/* REG 0  RETURNS THE LENGTH */') COL(COLD) NORESCAN;        02055003
*   END;                                                                02056003
*   ELSE DO;                                                            02057003
*     ANS (CBLEN(1) || ' = IALCBR0;') COL(COLA) SKIP RESCAN;            02058003
*     ANS ('/* REG 0  RETURNS THE LENGTH */') COL(COLD) NORESCAN;       02059003
*   END;                                                                02060003
* END;                                                                  02061003
* IF MOVELEN = ''               /* MOVELEN WAS SPECIFIED            */ 02062003
* THEN DO;                       /* STORE IALCMVLN IN MOVLEN         */ 02063003
*      ANS ('RFY INLCIALC BASED(IALCBR1);')                             02064003
*      COL(COLA) SKIP RESCAN;                                           02065003
*   IF MOVELEN(1,1:1) = '('      /* ADDRESS NOTATION FOR MOVELEN     */ 02066003
*   THEN DO;                                                            02067003
*    ANS ('DCL L$MV'|| MACINDEX ||' FIXED(31) BASED('                   02068003
*          ||MOVELEN(1,1)||');')                                        02069003
*          COL(COLA) SKIP RESCAN;                                       02070003
*    ANS ('L$MV'||MACINDEX||' = IALCMVLN;') COL(COLA) SKIP RESCAN;      02071003
*    ANS ('/* STORE MOVED DATA LENGTH   */') COL(COLD) NORESCAN;        02072003
*   END;                                                                02073003
*   ELSE DO;                                                            02074003
*     ANS (MOVELEN(1) || ' = IALCMVLN;') COL(COLA) SKIP RESCAN;         02075003
*     ANS ('/* STORE MOVED DATA LENGHT   */') COL(COLD) NORESCAN;       02076003
*   END;                                                                02077003
*    ANS ('RFY INLCIALC;')                                              02078003
*    COL(COLA) SKIP RESCAN;                                             02079003
* END;                                                                  02080003
* IF DIRNO = ''               /* DIRNO WAS SPECIFIED                */ 02081003
* THEN DO;                     /* STORE IALCDIRN IN DIRNO            */ 02082003
*      ANS ('RFY INLCIALC BASED(IALCBR1);')                             02083003
*      COL(COLA) SKIP RESCAN;                                           02084003
*   IF DIRNO(1,1:1) = '('      /* ADDRESS NOTATION FOR DIRNO         */ 02085003
*   THEN DO;                                                            02086003
*    ANS ('DCL L$DN'|| MACINDEX ||' FIXED(31) BASED('                   02087003
*          ||DIRNO(1,1)||');')                                          02088003
*          COL(COLA) SKIP RESCAN;                                       02089003
*    ANS ('L$DN'||MACINDEX||' = IALCDIRN;') COL(COLA) SKIP RESCAN;      02090003
*    ANS ('/* STORE NO. OF DIRECTORY ENTRIES */') COL(COLD) NORESCAN;   02091003
*   END;                                                                02092003
*   ELSE DO;                                                            02093003
*     ANS (DIRNO(1) || ' = IALCDIRN;') COL(COLA) SKIP RESCAN;           02094003
*    ANS ('/* STORE NO. OF DIRECTORY ENTRIES */') COL(COLD) NORESCAN;   02095003
*   END;                                                                02096003
*    ANS ('RFY INLCIALC;')                                              02097003
*    COL(COLA) SKIP RESCAN;                                             02098003
* END;                                                                  02099003
* END;                                      /*               @D52TDJS*/ 02100003
* ELSE DO;                                  /* SERVER ACTIVE @D52TDJS*/ 02100103
*   ANS ('RFY INLCIALC BASED(IALCBR1);') COL(COLA) SKIP RESCAN;         02100203
*   ANS ('IF IALCSRVX = 0 THEN;') COL(COLA) SKIP RESCAN;                02100303
*   ANS ('/* BRANCH TO USER EXIT IF SPECIFIED */') COL(COLD) NORESCAN;  02100403
*   ANS ('ELSE DO;             ') COL(COLA) SKIP RESCAN;                02100503
*   ANS ('IALCBR15 = IALCSRVX;') COL(COLA) SKIP RESCAN;                 02100603
*   ANS ('/* GET EXIT ADDRESS */') COL(COLD) NORESCAN;                  02100703
*   ANS ('GEN CODE(BALR IALCBR14,IALCBR15);') COL(COLA) SKIP RESCAN;    02100803
*   ANS ('/* BRANCH TO EXIT   */') COL(COLD) NORESCAN;                  02100903
*   ANS ('END;                ') COL(COLA) SKIP RESCAN;                 02101003
*   ANS ('RFY INLCIALC;               ') COL(COLA) SKIP RESCAN;         02101103
* END;                                                                  02101203
* ANS ('RFY (IALCBR0,IALCBR1,IALCBR14,IALCBR15);')                      02101303
*        COL(COLA) SKIP RESCAN;                                         02101403
* MEND:;                                                                02101503
* IALINN = 0;                                                           02101603
* RETURN CODE(IALRC);                                                   02101703
* %END;                                                                 02101803
*/*   ENDMODULE LBRIALC                                            */   02101903
