         MACRO                                                          00050000
&NAME    GETVCE  &AREA=,                                               *00100000
               &BALANCE=,                                              *00150000
               &CHNUNIT=,                                              *00200000
               &CLASS=,                                        @D21LDRP*00250000
               &DATALEN=,                                              *00300000
               &DEVICE=,                                               *00350000
               &DEVTYPE=,                                              *00400000
               &KEYLEN=,                                               *00450000
               &LENGTH=,                                               *00500000
               &LOGUNIT=,                                              *00550000
               &OPTION=,                                               *00600000
               &RECNO=,                                                *00650000
               &REQUEST=,                                              *00700000
               &VOLID=,                                                *00750000
               &MFG=                                                    00800000
.*                                                                      00850000
         LCLA  &TTY        DEVTYPE        ADDRESSING TYPE               00900000
         LCLA  &TAR        AREA           ADDRESSING TYPE               00950000
         LCLA  &TUN        VOLID          ADDRESSING TYPE               01000000
         LCLA  &TMF        MFG            ADDRESSING TYPE               01050000
         LCLA  &TDE        DEVICE         ADDRESSING TYPE               01100000
         LCLA  &TDD        DATALEN        ADDRESSING TYPE               01150000
         LCLA  &TKL        KEYLEN         ADDRESSING TYPE               01200000
         LCLA  &TRNO       RECNO          ADDRESSING TYPE               01250000
         LCLA  &TBAL       BALANCE        ADDRESSING TYPE               01300000
         LCLA  &IDE        LOG. UNIT      IDENTIFICATION                01350000
         LCLA  &STARIN1    INPUT PARAMETER  FOR STAR                    01400000
         LCLA  &INDEX      USED FOR INTERNAL PROCESSING                 01450000
         LCLA  &FLAGS      UNIT ADDRESSING FLAGS                        01500000
         LCLA  &CLIND      INDICATION OF CLASS                 @D21LDRP 01550000
         LCLA  &L          ARGUMENT LIST LENGTH                         01600000
         LCLA  &M          PARAMETER MOVE LENGTH                        01650000
         LCLA  &N          INTERNAL COUNTER                             01700000
         LCLA  &LDEF       DEFAULT USER AREA LENGTH                     01750000
         LCLA  &VER        VERSION ID                          @D37BDAP 01800000
         LCLA  &DEVZON     DEVICE ZONE                         @D14SSX1 01850000
         LCLA  &TAPECL     TAPE CLASS                          @D21LDRP 01900000
         LCLA  &DASDCL     DASD CLASS                          @D21LDRP 01950000
         LCLA  &ANYCL      ALL CLASS                           @D21LDRP 02000000
.*                                                                      02050000
         LCLB  &DEVFD      INPUT ERROR INDICATOR                        02100000
         LCLB  &RSTR0      R1 CONTENTS WAS SAVED                        02150000
         LCLB  &DYNPARM    DYNAMIC PARAMETER LIST                       02200000
.*                                                                      02250000
         LCLC  &ITY        DEVTYPE        INPUT                         02300000
         LCLC  &IAR        AREA           INPUT                         02350000
         LCLC  &IUN        DEVICE         INPUT                         02400000
         LCLC  &IMF        MFG            INPUT                         02450000
         LCLC  &XDE        CHANUNIT       INPUT                         02500000
         LCLC  &IDD        DATALEN        INPUT                         02550000
         LCLC  &IKL        KEYLEN         INPUT                         02600000
         LCLC  &IRNO       RECNO          INPUT                         02650000
         LCLC  &IBAL       BALANCE        INPUT                         02700000
         LCLC  &MSGPAR     INTERNAL VARIABLE                            02750000
         LCLC  &TARGET                                                  02800000
         LCLC  &CWORK                                                   02850000
         LCLC  &NDX                                                     02900000
         LCLC  &LNG                                                     02950000
.*                                                                      03000000
.*       IBM DISK OPERATING SYSTEM                                      03050000
*        SUPERVISOR - GETVCE - 5686-007-06-C44                 @D3CADAP 03100000
         AGO   .NOCOPY                                                  03150000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"           @D31UDMZ 03200000
*        5686-007 (C) COPYRIGHT IBM CORP. 1979, 1989           @D31UDMZ 03250000
*        ALL RIGHTS RESERVED                                   @D31UDMZ 03300000
*        LICENSED MATERIALS-PROPERTY OF IBM                             03350000
*        SEE COPYRIGHT INSTRUCTIONS, G120-2083                 @D31UDMZ 03400000
.NOCOPY  ANOP                                                           03450000
.* /* START OF SPECIFICATIONS ***************************************** 03500000
.*                                                                    * 03550000
.*01* MODULE-TYPE = SUPERVISOR SVC INTERFACE MACRO                    * 03600000
.*                                                                    * 03650000
.*01* DESCRIPTIVE NAME = GET VOLUME CHARACTERISTICS ENTRY             * 03700000
.*                                                                    * 03750000
.*01* NOTES = CHANGE ACTIVITY                                         * 03800000
.*    NEW MODULE FIRST RELEASE IS 35 FOR AVR SUPPORT           @D35VDEP 03850000
.*    NEW SUPPORT FOR DASD TRACK ALGORITHM ROUTINES            @D37BDAP 03900000
.*    EXTENTIONS      FOR  TRACK ALGORITHM ROUTINES            @D131DAP 03950000
.*    SUPPORT FOR EXTERNAL DEVICE CODE                         @D14BDAP 04000000
.*    SUPPORT FOR DEVICE=DASD TO RETRIEVE ALL CUU'S+VOLID'S    @D14SSX1 04050000
.*    GETVCE/MODVCE FOR TAPE                  (SPE DY37265)    @D21LDRP 04100000
.**** END OF SPECIFICATIONS ******************************************* 04150000
.*                                                                      04200000
.*       PURPOSE :                                                      04250000
.*                                                                      04300000
.*       THIS MACRO IS USED TO RETRIEVE INFORMATION ABOUT A CERTAIN     04350000
.*       DASD OR TAPE DEVICE FROM THE SUPERVISOR AND TO PUT IT          04400000
.*       INTO A USER SPECIFIED STORAGE AREA,                            04450000
.*       OR IN THE USERS REGISTERS (0-2)                                04500000
.*                                                                      04550000
.*       INPUT :                                                        04600000
.*                                                                      04650000
.*       AREA OPERAND SPECIFIES WHERE TO PUT THE INFORMATION ABOUT      04700000
.*       THE DEVICE. THE ADDRESS MAY BE GIVEN IN A REGISTER,IN A-TYPE   04750000
.*       FORMAT,OR IN S-TYPE FORMAT.                                    04800000
.*       THE AREA OPERAND MAY ONLY BE OMITTED IF               @D37BDAP 04850000
.*                            1. REQUEST=TRKCAP                @D37BDAP 04900000
.*                            2. REQUEST=TRKBAL                @D37BDAP 04950000
.*                                                                      05000000
.*       CLASS OPERAND SPECIFIES THE DEVICE CLASS FOR WHICH    @D21LDRP 05050000
.*       THE INFORMATION IS REQUESTED. ONLY VALID WITHOUT      @D21LDRP 05100000
.*       REQUEST PARAMETER. IGNORED WITH DEVICE=DASD           @D21LDRP 05150000
.*                                                                      05200000
.*       LENGTH OPERAND SPECIFIES THE LENGTH OF THE AREA, WHICH IS      05250000
.*       TO BE USED FOR DATA INSERTION. THE VALUE IS TO BE GIVEN        05300000
.*       AS A DECIMAL NUMBER OR AS A TERM EQUATED TO A NUMBER           05350000
.*       OR, (FOR DEVICE=DASD ONLY) IN REGISTER NOTATION.      @D21LDRP 05400000
.*       IF THE OPERAND IS OMITTED AND THE AREA OPERAND WAS    @D37BDAP 05450000
.*       SPECIFIED, A DEFAULT VALUE OF 56 WILL BE ASSUMED      @D14DCAP 05500000
.*       AND AN MNOTE IS GENERATED.                                     05550000
.*                                                                      05600000
.*       MFG OPERAND SPECIFIES A WORKAREA WHERE TO BUILD THE ARGUMENT   05650000
.*       LIST IN ORDER NOT TO MODIFY THE CODE. THE OPERAND IS           05700000
.*       OPTIONAL AND THE ADDRESS MAY BE GIVEN IN A REGISTER OR         05750000
.*       IN AN S-TYPE FORMAT. A FIELD OF 12 BYTES WHICH MUST BE         05800000
.*       ALIGNED ON WORD BOUNDARY WILL BE USED.                         05850000
.*                                                                      05900000
.*       THE OPERANDS DEVICE, VOLID, LOGUNIT,AND CHNUNIT ARE MUTUALLY   05950000
.*       EXCLUSIVE AND OFFER DIFFERENT WAYS OF DEVICE SPECIFICATION.    06000000
.*                                                                      06050000
.*       DEVICE OPERAND IS TO BE USED FOR IMMEDIATE SPECIFICATION OF    06100000
.*       THE LOGICAL OR PHYSICAL DEVICE'S. THE FORMATS ARE:             06150000
.*                 DEVICE=SYSXXX  FOR THE LOGICAL SPECIFICATION OR,     06200000
.*                 DEVICE=X'CUU'  FOR THE PHYSICAL SPECIFICATION OR     06250000
.*                 DEVICE=DASD    TO RETRIVE ALL CUU'S FOLLOWED BY      06300000
.*                                THE VOLID (8 BYTES PER DEVICE)        06350000
.*                                                                      06400000
.*       VOLID OPERAND ALLOWS SPECIFYING THE ADDRESS OF A FIELD WHICH   06450000
.*       CONTAINS A VOLUME IDENTIFIER. THE ADDRESS MAY BE GIVEN IN A    06500000
.*       REGISTER,IN A-TYPE FORMAT,OR IN S-TYPE FORMAT.                 06550000
.*                                                                      06600000
.*       DEVTYPE OPERAND MAY BE SPECIFIED IN CONJUNCTION WITH VOLID     06650000
.*       BECAUSE VOLID ALONE MAY BE AMBIGUOUS. THIS OPERAND SPECIFIES   06700000
.*       THE ADDRESS OF A ONE-BYTE FIELD CONTAINING THE DEVICE TYPE     06750000
.*       CODE. THE CODE IS THE PUB DEVICE TYPE CODE. THE ADDRESS MAY    06800000
.*       BE GIVEN IN A REGISTER,IN A-TYPE FORMAT,OR IN S-TYPE FORMAT.   06850000
.*                                                                      06900000
.*       LOGUNIT OPERAND ALLOWS SPECIFYING THE ADDRESS OF A HALFWORD    06950000
.*       WHICH CONTAINS THE LOGICAL UNIT IDENTIFICATION NOTATED AS IN   07000000
.*       THE CCB. THE ADDRESS MAY BE GIVEN IN A REGISTER,IN A-TYPE      07050000
.*       FORMAT,OR IN S-TYPE FORMAT.                                    07100000
.*                                                                      07150000
.*       CHNUNIT OPERAND IS SIMILAR TO LOGUNIT BUT THE HALFWORD         07200000
.*       CONTAINS THE PHYSICAL ADDRESS IN CHANNEL-UNIT NOTATION (CUU).  07250000
.*                                                                      07300000
.*       ADDRESSING FORMATS:                                            07350000
.*                                                                      07400000
.*       THE REGISTER NOTATION IS REGISTER NUMBER OR AN APPROPRIATELY   07450000
.*       EQUATED SYMBOL ENCLOSED IN PARENTHESES.                        07500000
.*       THE TERM A-TYPE FORMAT MEANS A NAME OR AN ADDRESS EXPRESSION   07550000
.*       EXPANDING IN AN A-TYPE ADDRESS CONSTANT.                       07600000
.*       THE TERM S-TYPE MEANS A NAME OR AN ADDRESS EXPRESSION WHICH    07650000
.*       COULD BE EXPANDED IN AN S-TYPE ADDRESS CONSTANT. IT WILL BE    07700000
.*       USED AS OPERAND OF AN INSTRUCTION.                             07750000
.*       IT IS TO BE WRITTEN AS (S,ADDRESS-EXPRESSION).                 07800000
.*                                                                      07850000
.*       OUTPUT :                                                       07900000
.*                                                                      07950000
.*       ARGUMENT LIST TO BE PASSED WITH SVC AND INSTRUCTIONS TO PUT    08000000
.*       DYNAMICALLY SPECIFIED INFORMATION INTO THAT LIST. THE STATIC   08050000
.*       LIST MAY BE COPIED INTO DYNAMIC STORAGE AND THIS COPY MAY BE   08100000
.*       UPDATED IN ORDER NOT TO MODIFY THE INLINE CODE (MFG OPERAND).  08150000
.*       THE ARGUMENT LIST HAS THE FOLLOWING FORMAT                     08200000
.*                                                                      08250000
.*             INLINE CODE WHICH MAY BE COPIED :                        08300000
.*                                                                      08350000
.*       DC A(AREA ADDRESS)                                             08400000
.*       DC A(DEVICE INFORMATION)                              @D14SSX1 08450000
.*       DC AL1(AREA LENGTH - 1)                                        08500000
.*       DC AL1(FLAGS)       X'N0'= VOLID                               08550000
.*                           X'N1'= LOGUNIT                             08600000
.*                           X'N2'= CHNUNIT                             08650000
.*                           X'N3'= DEVTYP ONLY                         08700000
.*                           X'N4'= ALL DASD'S                          08750000
.*                                                                      08800000
.*                                 N     DEVICE CLASS INDICATOR         08850000
.*                                 N=0   CLASS=DASD (DEFAULT)           08900000
.*                                 N=1-7 RESERVED                       08950000
.*                                 N=8   CLASS=TAPE                     09000000
.*                                 N=9-E RESERVED                       09050000
.*                                 N=F   CLASS=ANY                      09100000
.*       DC AL1(DEVICE TYPE CODE)       CONTENT ONLY VALID              09150000
.*                                      IF VOLID SPECIFIED              09200000
.*       DC X'00'                       VERSION IDENTIFIER              09250000
.*                                                                      09300000
.*       OPTIONAL FIELDS                                                09350000
.*                                                                      09400000
.*       DC AL2(DEVICE INFORMATION)     FOR DEVICE=SYSXXX OR X'CUU'     09450000
.*                                      ONLY,OTHERWISE OMITTED.         09500000
.*       DC AL2(DATALEN)                RECORD LENGTH                   09550000
.*       DC AL1(KEYLEN)                 KEYLEN                          09600000
.*       DC AL1(RECNO)                  RECORD NUMBER                   09650000
.*       DC AL1(0)                      RESERVED (MUST BE ZERO)         09700000
.*       DC AL1(FLAGS)                                                  09750000
.*       DC AL2(BALANCE)                BALANCE                         09800000
.*                                                                      09850000
.*--------------------------------------------------------------------- 09900000
&NDX     SETC  '&SYSNDX'      INITIALIZE SYSTEM INDEX                   09950000
&LDEF    SETA  56             DEFAULT AREA LENGTH              @D14BDAP 10000000
&L       SETA  14             INIT INLINE ARGUMENT LIST LENGTH          10050000
&M       SETA  &L-2           INIT ARGUMENT LIST MOVE LENGTH            10100000
&TAPECL  SETA  128            VALUE FOR CLASS = TAPE           @D21LDRP 10150000
&DASDCL  SETA  0              VALUE FOR CLASS = DASD           @D21LDRP 10200000
&ANYCL   SETA  240            VALUE FOR CLASS = ANY            @D21LDRP 10250000
.*                                                                      10300000
.*       AREA OPERAND EVALUATION ---------------------------            10350000
.*                                                                      10400000
         AIF   (T'&AREA NE 'O').ARAV                                    10450000
         AIF   (T'&REQUEST NE 'O').STAR010                     @D37BDAP 10500000
         MNOTE 8,'AREA OPERAND MISSING,GENERATION SUPPRESSED'           10550000
         AGO   .N4                                                      10600000
.STAR010 ANOP                                                           10650000
&IAR     SETC  '0'                                             @D37BDAP 10700000
         AGO   .AR1                                            @D37BDAP 10750000
.ARAV    AIF   ('&AREA'(1,1) EQ '(').ARDYN                              10800000
&IAR     SETC  '&AREA'                                                  10850000
&TAR     SETA  1              1= A-TYPE                                 10900000
         AGO   .AR1                                                     10950000
.ARDYN   AIF   ('&AREA'(1,3) EQ '(S,').ARSTYP                           11000000
&IAR     SETC  '&AREA'(2,K'&AREA-2)                                     11050000
&TAR     SETA  2              2= REGISTER                               11100000
         AGO   .AR1                                                     11150000
.ARSTYP  ANOP                                                           11200000
&IAR     SETC  '&AREA'(4,K'&AREA-4)                                     11250000
&TAR     SETA  4              4= S-TYPE                                 11300000
.AR1     ANOP                                                           11350000
.*                                                                      11400000
.*       CLASS OPERAND EVALUATION --------------------------            11450000
.*                                                                      11500000
         AIF   ('&CLASS' NE 'DASD').CL1                        @D21LDRP 11550000
.CL0     ANOP                                                  @D21LDRP 11600000
&CLIND   SETA  &DASDCL            INDICATE CLASS = DASD        @D21LDRP 11650000
         AGO   .CL4                                            @D21LDRP 11700000
.CL1     AIF   (T'&CLASS EQ 'O').CL0                           @D21LDRP 11750000
         AIF   ('&CLASS' NE 'ANY').CL2                         @D21LDRP 11800000
&CLIND   SETA  &ANYCL             INDICATE CLASS = ANY         @D21LDRP 11850000
         AGO   .CL4                                            @D21LDRP 11900000
.CL2     AIF   ('&CLASS' EQ 'TAPE').CL3                        @D21LDRP 11950000
         MNOTE 8,'CLASS=&CLASS INVALID, GENERATION SUPPRESSED' @D21LDRP 12000000
         AGO   .N4                TERMINATE MACRO GENERATION   @D21LDRP 12050000
.CL3     ANOP                                                  @D21LDRP 12100000
&CLIND   SETA  &TAPECL            INDICATE CLASS = TAPE        @D21LDRP 12150000
.CL4     ANOP                                                  @D21LDRP 12200000
.*                                                                      12250000
.*       LENGTH OPERAND EVALUATION --------------------------           12300000
.*                                                                      12350000
         AIF   (T'&LENGTH NE 'O').LNG1                                  12400000
         AIF   (&TAR EQ 0).LNG2                                @D37BDAP 12450000
         AIF   ('&DEVICE' NE 'DASD').NOTALL                    @D14SSX1 12500000
         MNOTE 8,'DEVICE=DASD REQUIRES LENGTH OPERAND.'        @D14SSX1 12550000
         AGO   .N4                                                      12600000
.NOTALL  ANOP                                                           12650000
         MNOTE 0,'LENGTH OPERAND OMITTED, LENGTH=&LDEF ASSUMED.'        12700000
&LNG     SETC  '&LDEF'                                                  12750000
         AGO   .LNG2                                                    12800000
.LNG1    ANOP                                                           12850000
         AIF   ('&LENGTH'(1,1) NE '(').LNG12                   @D21LDRP 12900000
         AIF   ('&DEVICE' EQ 'DASD').LNG11                     @D21LDRP 12950000
         MNOTE 8,'REGISTER NOTATION INVALID FOR LENGTH OPERAND'        *13000000
                                                               @D21LDRP 13050000
         AGO   .N4                TERMINATE                    @D21LDRP 13100000
.LNG11   ANOP                                                  @D21LDRP 13150000
&LNG     SETC  '&LENGTH'(2,K'&LENGTH-2)                        @D14SSX1 13200000
         AGO   .LNG2                                           @D14SSX1 13250000
.LNG12   AIF   ('&DEVICE' NE 'DASD').LENNUM                    @D21LDRP 13300000
         MNOTE 8,'REGISTER NOTATION REQUIRED FOR LENGTH OPERAND WITH DE*13350000
               VICE=&DEVICE'                                   @D21LDRP 13400000
         AGO   .N4                TERMINATE                    @D21LDRP 13450000
.LENNUM  AIF   (T'&LENGTH NE 'N').LENOK                                 13500000
         AIF   (&LENGTH LT 256).LENOK                                   13550000
         MNOTE 4,'LENGTH OPERAND INVALID, LENGTH=&LDEF ASSUMED.'        13600000
&LNG     SETC  '&LDEF'                                                  13650000
         AGO   .LNG2                                                    13700000
.LENOK   ANOP                                                           13750000
&LNG     SETC  '&LENGTH'                                                13800000
.LNG2    ANOP                                                           13850000
.*                                                                      13900000
.*       DEVICE-TYPE OPERAND EVALUATION ---------------------           13950000
.*                                                                      14000000
.TY      AIF   (T'&DEVTYPE EQ 'O').TY2                                  14050000
.TYAV    AIF   ('&DEVTYPE'(1,1) EQ '(').TYDYN                           14100000
&ITY     SETC  '&DEVTYPE'                                               14150000
&TTY     SETA  1              1= A-TYPE                                 14200000
         AGO   .TY2                                                     14250000
.TYDYN   AIF   ('&DEVTYPE'(1,3) EQ '(S,').TYSTYP                        14300000
&ITY     SETC  '&DEVTYPE'(2,K'&DEVTYPE-2)                               14350000
&TTY     SETA  2              2= REGISTER                               14400000
         AGO   .TY2                                                     14450000
.TYSTYP  ANOP                                                           14500000
&ITY     SETC  '&DEVTYPE'(4,K'&DEVTYPE-4)                               14550000
&TTY     SETA  4              4= S-TYPE                                 14600000
.TY2     ANOP                                                           14650000
.*                                                                      14700000
.*       DEVICE OPERAND EVALUATION -------------------------            14750000
.*                                                                      14800000
         AIF   (T'&DEVICE EQ 'O').VO                                    14850000
         AIF   ('&DEVICE' EQ 'DASD').DEALL                     @D14SSX1 14900000
         AIF   (K'&DEVICE NE 6).DEERR                                   14950000
         AIF   ('&DEVICE'(1,3) EQ 'SYS').DELOG                          15000000
         AIF   ('&DEVICE'(1,2) EQ 'X''').DEPHYS                         15050000
.DEERR   ANOP                                                  @D14SSX1 15100000
         MNOTE 8,'DEVICE OPERAND INVALID, GENERATION SUPPRESSED.'       15150000
         AGO   .N4                                                      15200000
.DELOG   ANOP                                                           15250000
&CWORK   SETC  '&DEVICE'(4,3)                                           15300000
         AIF   ('&CWORK' LT '000').DESYS                                15350000
&IDE     SETA  &CWORK+256                                               15400000
         AGO   .DESYSP                                         @D14SSX1 15450000
.DESYS   ANOP                                                           15500000
&INDEX   SETA  1                                                        15550000
.ILOOP   AIF   ('RDRIPTPCHLSTLOGLNKRESSLBRLBUSERECCLBVISCAT'(&INDEX,3) *15600000
               EQ '&CWORK').DESYS1                                      15650000
&INDEX   SETA  &INDEX+3                                                 15700000
         AIF   (&INDEX LT 41).ILOOP                                     15750000
         MNOTE 8,'DEVICE=&DEVICE IS INVALID, GENERATION SUPPRESSED'     15800000
         AGO   .N4                                                      15850000
.DESYS1  ANOP                                                           15900000
&IDE     SETA  (&INDEX-1)/3                                             15950000
.DESYSP  ANOP                                                           16000000
.*                            &TDE=0 INDICATES STATIC LOGICAL UNIT      16050000
         AGO   .DEEND                                                   16100000
.DEPHYS  ANOP                                                           16150000
&XDE     SETC  '&DEVICE'                                                16200000
&TDE     SETA  1              &TDE=1 INDICATES STATIC PHYSICAL UNIT     16250000
         AGO   .DEEND                                          @D14SSX1 16300000
.DEALL   ANOP                                                  @D14SSX1 16350000
         AIF   (T'&CLASS EQ 'O').DEALL1                        @D21LDRP 16400000
         MNOTE 2,'CLASS IGNORED FOR DEVICE=&DEVICE'            @D21LDRP 16450000
&CLIND   SETA  &DASDCL                                         @D21LDRP 16500000
.DEALL1  ANOP                                                  @D21LDRP 16550000
&TDE     SETA  6              &TDE=6 INDICATES DEVICE=DASD     @D14SSX1 16600000
&DEVZON  SETA  1              X'01'  INDICATION FOR ALL DASD'S @D14SSX1 16650000
.DEEND   ANOP                                                  @D14SSX1 16700000
&DEVFD   SETB  1                                                        16750000
.*                                                                      16800000
.*       VOLID OPERAND EVALUATION --------------------------            16850000
.*                                                                      16900000
.VO      AIF   (T'&VOLID NE 'O').VO0                                    16950000
         AIF   (&TTY EQ 0).LU                                           17000000
         AIF   (&TDE EQ 6).LU                                  @D14SSX1 17050000
         AIF   (T'&AREA EQ 'O').VO2                            @D131DAP 17100000
         MNOTE 2,'DEVTYPE SPECIFIED WITHOUT VOLID, SPECIFICATION IGNORE*17150000
               D'                                              @D21LDRP 17200000
.VO00    ANOP                                                  @D21LDRP 17250000
&TTY     SETA  0              IF VOLID OMITTED RESET DEVTYPE INDICATOR  17300000
         AGO   .LU                                                      17350000
.VO0     ANOP                                                           17400000
         AIF   (&DEVFD EQ 0).VO1                                        17450000
.DEVERR  ANOP                                                           17500000
         MNOTE 8,'MULTIPLE DEVICE SPECIFICATIONS,GENERATION SUPPRESSED' 17550000
         AGO   .N4                                                      17600000
.VO1     ANOP                                                           17650000
         AIF   ('&CLASS' EQ 'DASD').VO11                       @D21LDRP 17700000
         AIF   (T'&CLASS EQ 'O').VO11                          @D21LDRP 17750000
         MNOTE 2,'VOLID OBSOLETE FOR CLASS=&CLASS, SPECIFICATION IGNORE*17800000
               D'                                              @D21LDRP 17850000
         AIF   (&TTY EQ 0).LU                                  @D21LDRP 17900000
         MNOTE 2,'DEVTYPE OBSOLETE FOR CLASS=&CLASS, SPECIFICATION IGNO*17950000
               RED'                                            @D21LDRP 18000000
         AGO   .VO00              RESET DEVTYPE                @D21LDRP 18050000
.VO11    ANOP                                                  @D21LDRP 18100000
&TDE     SETA  2              &TDE=2 INDICATES VOLID ADDRESS            18150000
.VOAV    AIF   ('&VOLID'(1,1) EQ '(').VODYN                             18200000
&IUN     SETC  '&VOLID'                                                 18250000
&TUN     SETA  1              1= A-TYPE                                 18300000
         AGO   .VO3                                                     18350000
.VODYN   AIF   ('&VOLID'(1,3) EQ '(S,').VOSTYP                          18400000
&IUN     SETC  '&VOLID'(2,K'&VOLID-2)                                   18450000
&TUN     SETA  2              2= REGISTER                               18500000
         AGO   .VO3                                                     18550000
.VOSTYP  ANOP                                                           18600000
&IUN     SETC  '&VOLID'(4,K'&VOLID-4)                                   18650000
&TUN     SETA  4              4= S-TYPE                                 18700000
         AGO   .VO3                                                     18750000
.VO2     ANOP                                                  @D131DAP 18800000
&TDE     SETA  5              &TDE=5 INDICATES DEVTYP ONLY     @D131DAP 18850000
.VO3     ANOP                                                           18900000
&DEVFD   SETB  1                                                        18950000
.*                                                                      19000000
.*       LOGUNIT OPERAND EVALUATION ------------------------            19050000
.*                                                                      19100000
.LU      ANOP                                                           19150000
         AIF   (T'&LOGUNIT EQ 'O').CU                                   19200000
         AIF   (&DEVFD EQ 1).DEVERR                                     19250000
&TDE     SETA  3              &TDE=3 INDICATES LOGICAL UNIT ADDRESS     19300000
.LUAV    AIF   ('&LOGUNIT'(1,1) EQ '(').LUDYN                           19350000
&IUN     SETC  '&LOGUNIT'                                               19400000
&TUN     SETA  1              1= A-TYPE                                 19450000
         AGO   .LU1                                                     19500000
.LUDYN   AIF   ('&LOGUNIT'(1,3) EQ '(S,').LUSTYP                        19550000
&IUN     SETC  '&LOGUNIT'(2,K'&LOGUNIT-2)                               19600000
&TUN     SETA  2              2= REGISTER                               19650000
         AGO   .LU1                                                     19700000
.LUSTYP  ANOP                                                           19750000
&IUN     SETC  '&LOGUNIT'(4,K'&LOGUNIT-4)                               19800000
&TUN     SETA  4              4= S-TYPE                                 19850000
.LU1     ANOP                                                           19900000
&DEVFD   SETB  1                                                        19950000
.*                                                                      20000000
.*       CHNUNIT OPERAND EVALUATION ------------------------            20050000
.*                                                                      20100000
.CU      ANOP                                                           20150000
         AIF   (T'&CHNUNIT EQ 'O').EDEV                                 20200000
         AIF   (&DEVFD EQ 1).DEVERR                                     20250000
&TDE     SETA  4              &TDE=4 INDICATES PHYSICAL UNIT ADDRESS    20300000
.CUAV    AIF   ('&CHNUNIT'(1,1) EQ '(').CUDYN                           20350000
&IUN     SETC  '&CHNUNIT'                                               20400000
&TUN     SETA  1              1= A-TYPE                                 20450000
         AGO   .CU1                                                     20500000
.CUDYN   AIF   ('&CHNUNIT'(1,3) EQ '(S,').CUSTYP                        20550000
&IUN     SETC  '&CHNUNIT'(2,K'&CHNUNIT-2)                               20600000
&TUN     SETA  2              2= REGISTER                               20650000
         AGO   .CU1                                                     20700000
.CUSTYP  ANOP                                                           20750000
&IUN     SETC  '&CHNUNIT'(4,K'&CHNUNIT-4)                               20800000
&TUN     SETA  4              4= S-TYPE                                 20850000
.CU1     ANOP                                                           20900000
&DEVFD   SETB  1                                                        20950000
.EDEV    AIF   (&DEVFD EQ 1).MFG                                        21000000
         MNOTE 8,'DEVICE SPECIFICATION MISSING,GENERATION SUPPRESSED'   21050000
         AGO   .N4                                                      21100000
.*                                                                      21150000
.*       MFG OPERAND EVALUATION ----------------------------            21200000
.*                                                                      21250000
.MFG     AIF   (T'&MFG EQ 'O').MF1                                      21300000
&DYNPARM SETB  1                                                        21350000
.MFAV    AIF   ('&MFG'(1,1) EQ '(').MFDYN                               21400000
&IMF     SETC  '&MFG'                                                   21450000
&TMF     SETA  1              1= A-TYPE                                 21500000
         AGO   .MF1                                                     21550000
.MFDYN   AIF   ('&MFG'(1,3) EQ '(S,').MFSTYP                            21600000
&IMF     SETC  '&MFG'(2,K'&MFG-2)                                       21650000
&TMF     SETA  2              2= REGISTER                               21700000
         AGO   .MF1                                                     21750000
.MFSTYP  ANOP                                                           21800000
&IMF     SETC  '&MFG'(4,K'&MFG-4)                                       21850000
&TMF     SETA  4              4= S-TYPE                                 21900000
.MF1     ANOP                                                           21950000
.*                                                                      22000000
.*       REQUEST OPERAND EVALUATION ------------------------            22050000
.*                                                                      22100000
         AIF   (T'&REQUEST EQ 'O').EOIN                                 22150000
         AIF   (&TDE EQ 6).STARER2                             @D14SSX1 22200000
         AIF   ('&CLASS' EQ 'DASD').STAR020                    @D21LDRP 22250000
         AIF   (T'&CLASS NE 'O').STARER3                       @D21LDRP 22300000
.STAR020 ANOP                                                  @D21LDRP 22350000
&VER     SETA  22                                              @D37BDAP 22400000
&L       SETA  &L+8                                            @D37BDAP 22450000
&M       SETA  &M+8+2                                          @D37BDAP 22500000
&STARIN1 SETA  64                                                       22550000
         AIF   ('&REQUEST' EQ 'TRKCAP').STAR025                         22600000
&STARIN1 SETA  32                                                       22650000
         AIF   ('&REQUEST' EQ 'TRKBAL').STAR025                         22700000
         MNOTE 4,'REQUEST=&REQUEST IS INVALID, TRKBAL ASSUMED'          22750000
.STAR025 ANOP                                                           22800000
.*                                                                      22850000
.*       DATALEN OPERAND EVALUATION ------------------------            22900000
.*                                                                      22950000
.STAR040 ANOP                                                           23000000
&MSGPAR  SETC  'DATALEN'                                                23050000
         AIF   (T'&DATALEN EQ 'O').STARER1                              23100000
         AIF   ('&DATALEN'(1,1) EQ '(').DDDYN                           23150000
         AIF   ('&DATALEN'(1,2) EQ 'X''').DDNUM                         23200000
         AIF   (T'&DATALEN EQ 'N').DDNUM                                23250000
&IDD     SETC  '&DATALEN'                                               23300000
&TDD     SETA  1              1= A-TYPE                                 23350000
         AGO   .STAR050                                                 23400000
.DDDYN   AIF   ('&DATALEN'(1,3) EQ '(S,').DDSTYP                        23450000
&IDD     SETC  '&DATALEN'(2,K'&DATALEN-2)                               23500000
&TDD     SETA  2              2= REGISTER                               23550000
         AGO   .STAR050                                                 23600000
.DDSTYP  ANOP                                                           23650000
&IDD     SETC  '&DATALEN'(4,K'&DATALEN-4)                               23700000
&TDD     SETA  4              4= S-TYPE                                 23750000
         AGO   .STAR050                                                 23800000
.DDNUM   ANOP                                                           23850000
&IDD     SETC  '&DATALEN'                                               23900000
&TDD     SETA  8              8= NUMERIC VALUE                          23950000
.STAR050 ANOP                                                           24000000
.*                                                                      24050000
.*       KEYLEN  OPERAND EVALUATION ------------------------            24100000
.*                                                                      24150000
         AIF   (T'&KEYLEN EQ 'O').STAR060                               24200000
         AIF   ('&KEYLEN'(1,1) EQ '(').KLDYN                            24250000
         AIF   ('&KEYLEN'(1,2) EQ 'X''').KLNUM                          24300000
         AIF   (T'&KEYLEN EQ 'N').KLNUM                                 24350000
&IKL     SETC  '&KEYLEN'                                                24400000
&TKL     SETA  1              1= A-TYPE                                 24450000
         AGO   .STAR060                                                 24500000
.KLDYN   AIF   ('&KEYLEN'(1,3) EQ '(S,').KLSTYP                         24550000
&IKL     SETC  '&KEYLEN'(2,K'&KEYLEN-2)                                 24600000
&TKL     SETA  2              2= REGISTER                               24650000
         AGO   .STAR060                                                 24700000
.KLSTYP  ANOP                                                           24750000
&IKL     SETC  '&KEYLEN'(4,K'&KEYLEN-4)                                 24800000
&TKL     SETA  4              4= S-TYPE                                 24850000
         AGO   .STAR060                                                 24900000
.KLNUM   ANOP                                                           24950000
&IKL     SETC  '&KEYLEN'                                                25000000
&TKL     SETA  8              8= NUMERIC VALUE                          25050000
.STAR060 ANOP                                                           25100000
.*                                                                      25150000
.*       RECNO   OPERAND EVALUATION ------------------------            25200000
.*                                                                      25250000
         AIF   (T'&RECNO EQ 'O').STAR070                                25300000
         AIF   ('&RECNO'(1,1) EQ '(').RNODYN                            25350000
         AIF   ('&RECNO'(1,2) EQ 'X''').RNONUM                          25400000
         AIF   (T'&RECNO EQ 'N').RNONUM                                 25450000
&IRNO    SETC  '&RECNO'                                                 25500000
&TRNO    SETA  1              1= A-TYPE                                 25550000
         AGO   .STAR070                                                 25600000
.RNODYN  AIF   ('&RECNO'(1,3) EQ '(S,').RNOSTYP                         25650000
&IRNO    SETC  '&RECNO'(2,K'&RECNO-2)                                   25700000
&TRNO    SETA  2              2= REGISTER                               25750000
         AGO   .STAR070                                                 25800000
.RNOSTYP ANOP                                                           25850000
&IRNO    SETC  '&RECNO'(4,K'&RECNO-4)                                   25900000
&TRNO    SETA  4              4= S-TYPE                                 25950000
         AGO   .STAR070                                                 26000000
.RNONUM  ANOP                                                           26050000
&IRNO    SETC  '&RECNO'                                                 26100000
&TRNO    SETA  8              8= NUMERIC VALUE                          26150000
.STAR070 ANOP                                                           26200000
.*                                                                      26250000
.*       BALANCE OPERAND EVALUATION ------------------------            26300000
.*                                                                      26350000
         AIF   (T'&BALANCE EQ 'O').STAR080                              26400000
         AIF   ('&BALANCE'(1,1) EQ '(').BALDYN                          26450000
         AIF   ('&BALANCE'(1,2) EQ 'X''').BALNUM                        26500000
         AIF   (T'&BALANCE EQ 'N').BALNUM                               26550000
&IBAL    SETC  '&BALANCE'                                               26600000
&TBAL    SETA  1              1= A-TYPE                                 26650000
         AGO   .STAR075                                                 26700000
.BALDYN  AIF   ('&BALANCE'(1,3) EQ '(S,').BALSTYP                       26750000
&IBAL    SETC  '&BALANCE'(2,K'&BALANCE-2)                               26800000
&TBAL    SETA  2              2= REGISTER                               26850000
         AGO   .STAR075                                                 26900000
.BALSTYP ANOP                                                           26950000
&IBAL    SETC  '&BALANCE'(4,K'&BALANCE-4)                               27000000
&TBAL    SETA  4              4= S-TYPE                                 27050000
         AGO   .STAR075                                                 27100000
.BALNUM  ANOP                                                           27150000
&IBAL    SETC  '&BALANCE'                                               27200000
&TBAL    SETA  8              8= NUMERIC VALUE                          27250000
.STAR075 ANOP                                                           27300000
&STARIN1 SETA  &STARIN1+8                                               27350000
.STAR080 ANOP                                                           27400000
.*                                                                      27450000
.*       OPTION  OPERAND EVALUATION ------------------------            27500000
.*                                                                      27550000
         AIF   (T'&OPTION EQ 'O').EOIN                                  27600000
.STAR081 ANOP                                                           27650000
&N       SETA  &N+1                                                     27700000
         AIF   ('&OPTION(&N)' EQ 'REMOVE').STAR082                      27750000
         AIF   ('&OPTION(&N)' EQ 'MAXSIZE').STAR084                     27800000
         AIF   ('&OPTION(&N)' EQ 'LAST').STAR086                        27850000
       MNOTE 8,'OPTION='&OPTION(&N)' IS INVALID, GENERATION SUPPRESSED' 27900000
         AGO   .N4                                                      27950000
.STAR082 ANOP                                                           28000000
&STARIN1 SETA  &STARIN1+4                                               28050000
         AGO   .STAR088                                                 28100000
.STAR084 ANOP                                                           28150000
&STARIN1 SETA  &STARIN1+2                                               28200000
         AGO   .STAR088                                                 28250000
.STAR086 ANOP                                                           28300000
&STARIN1 SETA  &STARIN1+1                                               28350000
.STAR088 ANOP                                                           28400000
         AIF   (&N LT N'&OPTION).STAR081                                28450000
         AGO   .EOIN                                                    28500000
.STARER1 ANOP                                                           28550000
         MNOTE 8,'KEYWORD &MSGPAR IS MISSING.'                          28600000
         AGO   .N4                                                      28650000
.STARER2 ANOP                                                  @D14SSX1 28700000
         MNOTE 8,'REQUEST=&REQUEST CONFLICTING WITH DEVICE=DASD.'       28750000
         AGO   .N4                                             @D14SSX1 28800000
.STARER3 ANOP                                                  @D21LDRP 28850000
         MNOTE 8,'REQUEST=&REQUEST CONFLICTING WITH CLASS=&CLASS'       28900000
         AGO   .N4                                             @D21LDRP 28950000
.*     -----------------------------------------------------            29000000
.EOIN    ANOP                         END OF INPUT EVALUATION           29050000
.*                                                                      29100000
.*       FLAGS INDICATE THE TYPE OF DEVICE SPECIFICATION AND            29150000
.*         THE CLASS SPECIFICATION                                      29200000
&FLAGS   SETA  &TDE-2              FLAGS = 0  -> VOLID                  29250000
         AIF   (&FLAGS GE 0).EOIN1 FLAGS = 1  -> LOGICAL UNIT  @D21LDRP 29300000
&FLAGS   SETA  &FLAGS+3            FLAGS = 2  -> PHYSICAL UNIT          29350000
.*                                 FLAGS = 3  -> DEVTYPE ONLY           29400000
.*                                 FLAGS = 4  -> DEVICE=ALL    @D14SSX1 29450000
.EOIN1   ANOP                                                  @D21LDRP 29500000
&FLAGS   SETA  &FLAGS+&CLIND       ADD CLASS SPECIFICATION     @D21LDRP 29550000
.*                                                                      29600000
.*       GENERATE MACRO EXPANSION --------------------------            29650000
.*                                                                      29700000
         AIF   ('&NAME' EQ '').PARMLST                                  29750000
&NAME    DC    0H'0'                                                    29800000
.*                                                                      29850000
.*       GENERATE INSTRUCTIONS -----                                    29900000
.*                                                                      29950000
.PARMLST AIF   (&TDE LT 2).N00                                          30000000
         AIF   (T'&REQUEST NE 'O').N00                                  30050000
&L       SETA  &L-2           DEVICE INFORMATION NOT GENERATED          30100000
.N00     AIF   (&DYNPARM).N01 MFG WAS SPECIFIED                         30150000
&TARGET  SETC  'IJBY'.'&NDX'                                            30200000
         AGO   .N03                                                     30250000
.N01     AIF   (&TMF NE 2).N02 NOT REGISTER NOTATION                    30300000
&TARGET  SETC  '0(,'.'&IMF'.')'                                @D37BDAP 30350000
         MVC   0(&M,&IMF),IJBY&NDX MOVE STATIC INFO TO DYN AREA         30400000
         AGO   .N03                                                     30450000
.N02     ANOP                                                           30500000
&TARGET  SETC  '&IMF'                                                   30550000
&CWORK   SETC  '&IMF'.'(&M)'                                            30600000
         MVC   &CWORK,IJBY&NDX     MOVE STATIC INFO TO DYN AREA         30650000
.N03     AIF   (&TAR LT 2).N10                                 @D37BDAP 30700000
         AIF   (&TAR EQ 4).N04                                          30750000
         ST    &IAR,&TARGET        STORE AREA POINTER                   30800000
         AGO   .N10                                                     30850000
.N04     ANOP                                                           30900000
         LA    0,&IAR              ADDRESS OF USER AREA                 30950000
         ST    0,&TARGET           STORE ADDRESS IN PARAMETER           31000000
.N10     AIF   (&TDE EQ 6).N10A                                @D14SSX1 31050000
         AIF   (&TDE EQ 5).N12                                 @D131DAP 31100000
         AIF   (&TDE LT 2 OR &TUN EQ 1).N12                             31150000
         AIF   (&TUN EQ 4).N11                                          31200000
         ST    &IUN,4+&TARGET      STORE UNIT POINTER                   31250000
         AGO   .N12                                                     31300000
.N10A    STH   &LNG,6+&TARGET      STORE AREA LENGTH           @D14SSX1 31350000
         AGO   .N12                                                     31400000
.N11     ANOP                                                           31450000
         LA    0,&IUN                                                   31500000
         ST    0,4+&TARGET         INSERT UNIT ADDRESS                  31550000
.N12     AIF   (&TTY LT 4).N13                                          31600000
         IC    0,&ITY                                                   31650000
         AGO   .N14                                                     31700000
.N13     AIF   (&TTY LT 2).N15                                          31750000
         IC    0,0(&ITY)                                                31800000
.N14     ANOP                                                           31850000
         STC   0,10+&TARGET        INSERT DEVTYPE CODE                  31900000
         AGO   .N20                                                     31950000
.N15     AIF   (&TTY LT 1).N20                                          32000000
         LR    0,1                 SAVE REG1 CONTENTS                   32050000
&RSTR0   SETB  1                                               @D37BDAP 32100000
         L     1,=A(&ITY)          LOAD USERS ADDRESS                   32150000
         IC    1,0(1)              GET DEVICE TYPE CODE                 32200000
         STC   1,10+&TARGET        SAVE IT IN PARAMETER LIST            32250000
.N20     ANOP                                                           32300000
         AIF   (T'&REQUEST EQ 'O').NREQ010                     @D37BDAP 32350000
&CWORK   SETC  '&TARGET'.'+14(2)'                              @D37BDAP 32400000
         AIF   (&TMF NE 2).YDD005  REGISTER NOTATION           @D37BDAP 32450000
&CWORK   SETC  '14(2,'.'&IMF'.')'                              @D37BDAP 32500000
.YDD005  ANOP                                                           32550000
         AIF   (&TDD NE 2).YDD010                              @D37BDAP 32600000
         MVC   &CWORK,0(&IDD)     MOVE DATALEN TO PARM LIST             32650000
         AGO   .TSTKL                                          @D37BDAP 32700000
.YDD010  AIF   (&TDD NE 4).YDD020                              @D37BDAP 32750000
         MVC   &CWORK,&IDD        MOVE DATALEN TO PARM LIST             32800000
         AGO   .TSTKL                                          @D37BDAP 32850000
.YDD020  AIF   (&TDD NE 1).YDD030                              @D37BDAP 32900000
         AIF   (&RSTR0).YDD025                                 @D37BDAP 32950000
         LR    0,1                SAVE CONTENTS OF REG 1                33000000
&RSTR0   SETB  1                                               @D37BDAP 33050000
.YDD025  ANOP                                                  @D37BDAP 33100000
         L     1,=A(&IDD)         ADDRESS OF DATALEN FIELD              33150000
         MVC   &CWORK,0(1)        MOVE DATALEN TO PARM LIST             33200000
         AGO   .TSTKL                                          @D37BDAP 33250000
.YDD030  AIF   (&TDD EQ 8).TSTKL                               @D37BDAP 33300000
         MNOTE 12,'ERROR IN MACRO GETVCE (DATALEN PROCESSING)' @D37BDAP 33350000
.TSTKL   ANOP                                                  @D37BDAP 33400000
&CWORK   SETC  '&TARGET'.'+16(1)'                              @D37BDAP 33450000
         AIF   (&TMF NE 2).YKL005  REGISTER NOTATION           @D37BDAP 33500000
&CWORK   SETC  '16(1,'.'&IMF'.')'                              @D37BDAP 33550000
.YKL005  AIF   (&TKL NE 2).YKL010                              @D37BDAP 33600000
         MVC   &CWORK,0(&IKL)     MOVE KEYLEN  TO PARM LIST             33650000
         AGO   .TSTRNO                                         @D37BDAP 33700000
.YKL010  AIF   (&TKL NE 4).YKL020                              @D37BDAP 33750000
         MVC   &CWORK,&IKL        MOVE KEYLEN  TO PARM LIST             33800000
         AGO   .TSTRNO                                         @D37BDAP 33850000
.YKL020  AIF   (&TKL NE 1).YKL030                              @D37BDAP 33900000
         AIF   (&RSTR0).YKL025                                 @D37BDAP 33950000
         LR    0,1                SAVE CONTENTS OF REG 1                34000000
&RSTR0   SETB  1                                               @D37BDAP 34050000
.YKL025  ANOP                                                  @D37BDAP 34100000
         L     1,=A(&IKL)         ADDRESS OF KEYLEN  FIELD              34150000
         MVC   &CWORK,0(1)        MOVE KEYLEN  TO PARM LIST             34200000
         AGO   .TSTRNO                                         @D37BDAP 34250000
.YKL030  AIF   (&TKL EQ 8).TSTRNO                              @D37BDAP 34300000
         AIF   (&TKL EQ 0).TSTRNO                              @D37BDAP 34350000
         MNOTE 12,'ERROR IN MACRO GETVCE (KEYLEN  PROCESSING)' @D37BDAP 34400000
.TSTRNO  ANOP                                                  @D37BDAP 34450000
&CWORK   SETC  '&TARGET'.'+17(1)'                              @D37BDAP 34500000
         AIF   (&TMF NE 2).YRNO005 REGISTER NOTATION           @D37BDAP 34550000
&CWORK   SETC  '17(1,'.'&IMF'.')'                              @D37BDAP 34600000
.YRNO005 AIF   (&TRNO NE 2).YRNO010                            @D37BDAP 34650000
         MVC   &CWORK,0(&IRNO)    MOVE RECNO   TO PARM LIST             34700000
         AGO   .TSTBAL                                         @D37BDAP 34750000
.YRNO010 AIF   (&TRNO NE 4).YRNO020                            @D37BDAP 34800000
         MVC   &CWORK,&IRNO       MOVE RECNO   TO PARM LIST             34850000
         AGO   .TSTBAL                                         @D37BDAP 34900000
.YRNO020 AIF   (&TRNO NE 1).YRNO030                            @D37BDAP 34950000
         AIF   (&RSTR0).YRNO025                                @D37BDAP 35000000
         LR    0,1                SAVE CONTENTS OF REG 1                35050000
&RSTR0   SETB  1                                               @D37BDAP 35100000
.YRNO025 ANOP                                                  @D37BDAP 35150000
         L     1,=A(&IRNO)        ADDRESS OF RECNO   FIELD              35200000
         MVC   &CWORK,0(1)        MOVE RECNO   TO PARM LIST             35250000
         AGO   .TSTBAL                                         @D37BDAP 35300000
.YRNO030 AIF   (&TRNO EQ 8).TSTBAL                             @D37BDAP 35350000
         AIF   (&TRNO EQ 0).TSTBAL                             @D37BDAP 35400000
         MNOTE 12,'ERROR IN MACRO GETVCE (RECNO   PROCESSING)' @D37BDAP 35450000
.TSTBAL  ANOP                                                  @D37BDAP 35500000
&CWORK   SETC  '&TARGET'.'+20(2)'                              @D37BDAP 35550000
         AIF   (&TMF NE 2).YBAL005 REGISTER NOTATION           @D37BDAP 35600000
&CWORK   SETC  '20(2,'.'&IMF'.')'                              @D37BDAP 35650000
.YBAL005 AIF   (&TBAL NE 2).YBAL010                            @D37BDAP 35700000
         MVC   &CWORK,0(&IBAL)    MOVE BALANCE TO PARM LIST             35750000
         AGO   .NREQ010                                        @D37BDAP 35800000
.YBAL010 AIF   (&TBAL NE 4).YBAL020                            @D37BDAP 35850000
         MVC   &CWORK,&IBAL       MOVE BALANCE TO PARM LIST             35900000
         AGO   .NREQ010                                        @D37BDAP 35950000
.YBAL020 AIF   (&TBAL NE 1).YBAL030                            @D37BDAP 36000000
         AIF   (&RSTR0).YBAL025                                @D37BDAP 36050000
         LR    0,1                SAVE CONTENTS OF REG 1                36100000
&RSTR0   SETB  1                                               @D37BDAP 36150000
.YBAL025 ANOP                                                  @D37BDAP 36200000
         L     1,=A(&IBAL)        ADDRESS OF BALANCE FIELD              36250000
         MVC   &CWORK,0(1)        MOVE BALANCE TO PARM LIST             36300000
         AGO   .NREQ010                                        @D37BDAP 36350000
.YBAL030 AIF   (&TBAL EQ 8).NREQ010                            @D37BDAP 36400000
         AIF   (&TBAL EQ 0).NREQ010                            @D37BDAP 36450000
         MNOTE 12,'ERROR IN MACRO GETVCE (BALANCE PROCESSING)' @D37BDAP 36500000
.NREQ010 AIF   (&DYNPARM).N201  DO NOT SEPARATE CNOP AND BAL            36550000
         CNOP  0,4                 FULLWORD ALIGNMENT                   36600000
         BAL   1,IJBY&NDX+&L       LOAD ARGUMENT LIST POINTER           36650000
         AGO   .N205                                           @D37BDAP 36700000
.N201    AIF   (&TMF NE 2).N202                                         36750000
         AIF   ('&IMF' EQ '1').N203                                     36800000
         LR    1,&IMF              LOAD ARGUMENT LIST POINTER           36850000
         AGO   .N204                                           @D37BDAP 36900000
.N202    ANOP                                                           36950000
         LA    1,&IMF              LOAD ARGUMENT LIST POINTER           37000000
         AGO   .N204                                           @D37BDAP 37050000
.N203    AIF   (NOT &RSTR0).N204   IS R1 TO BE RESTORED        @D37BDAP 37100000
         LR    1,0                 RESTORE R1 CONTENTS                  37150000
.N204    ANOP                                                  @D37BDAP 37200000
         B     IJBY&NDX+&L                                              37250000
.*                                                                      37300000
.*       GENERATE CONSTANTS --------                                    37350000
.*                                                                      37400000
.N205    AIF   (&TAR GT 1).N21                                 @D37BDAP 37450000
IJBY&NDX DC    A(&IAR)             AREA ADDRESS                         37500000
         AGO   .N22                                                     37550000
.N21     ANOP                                                           37600000
IJBY&NDX DC    A(0)                AREA ADDRESS                         37650000
.N22     AIF   (&TDE GT 4).N24                                 @D14SSX1 37700000
         AIF   (&TDE GT 1).N23                                          37750000
         DC    A(IJBY&NDX+12)      UNIT INFO ADDRESS           @D37BDAP 37800000
         AGO   .N30                                                     37850000
.N23     AIF   (&TUN GT 1).N24                                          37900000
         DC    A(&IUN)             UNIT INFO ADDRESS                    37950000
         AGO   .N30                                                     38000000
.N24     ANOP                                                           38050000
         AIF   (&TDE GT 5).N26                                 @D14SSX1 38100000
         DC    A(0)                UNIT INFORMATION                     38150000
         AGO   .N30                                            @D14SSX1 38200000
.N26     ANOP                                                  @D14SSX1 38250000
         DC    AL1(&DEVZON),AL3(0) DEVICE-ID + AREA LENGTH     @D14SSX1 38300000
         DC    AL1(0)              UNUSED                      @D14SSX1 38350000
         AGO   .N31                                            @D14SSX1 38400000
.N30     ANOP                                                           38450000
         DC    AL1(&LNG-1)         AREA LENGTH - 1                      38500000
.N31     ANOP                                                  @D14SSX1 38550000
         DC    AL1(&FLAGS)         INPUT TYPE AND CLASS        @D21LDRP 38600000
         DC    AL1(0)              DEVICE TYPE CODE                     38650000
         DC    X'&VER'             VERSION IDENTIFIER          @D37BDAP 38700000
         AIF   (&TDE NE 0).N32                                          38750000
         DC    AL2(&IDE)           LOGICAL UNIT                         38800000
         AGO   .NREQ020                                        @D37BDAP 38850000
.N32     AIF   (&TDE GT 1).NREQ020                             @D37BDAP 38900000
         DC    AL2(&XDE)           PHYSICAL UNIT (CUU)                  38950000
.NREQ020 ANOP                                                  @D37BDAP 39000000
         AIF   (T'&REQUEST EQ 'O').SVC                         @D37BDAP 39050000
         AIF   (&TDE LT 2).YREQ020                             @D37BDAP 39100000
         DC    AL2(0)              UNUSED                      @D37BDAP 39150000
.YREQ020 AIF   (&TDD NE 8).YREQ030                             @D37BDAP 39200000
         DC    AL2(&IDD)           DATA LENGTH                 @D37BDAP 39250000
         AGO   .YREQ040                                        @D37BDAP 39300000
.YREQ030 DC    AL2(0)              DATA LENGTH                 @D37BDAP 39350000
.YREQ040 AIF   (&TKL NE 8).YREQ050                             @D37BDAP 39400000
         DC    AL1(&IKL)           KEY  LENGTH                 @D37BDAP 39450000
         AGO   .YREQ060                                        @D37BDAP 39500000
.YREQ050 DC    AL1(0)              KEY  LENGTH                 @D37BDAP 39550000
.YREQ060 AIF   (&TRNO NE 8).YREQ070                            @D37BDAP 39600000
         DC    AL1(&IRNO)          RECORD NUMBER               @D37BDAP 39650000
         AGO   .YREQ080                                        @D37BDAP 39700000
.YREQ070 DC    AL1(0)              RECORD NUMBER               @D37BDAP 39750000
.YREQ080 DC    AL1(0)              RESERVED, MUST BE ZERO      @D37BDAP 39800000
         DC    AL1(&STARIN1)       SGSTAR PROCESSING FLAGS     @D37BDAP 39850000
         AIF   (&TBAL NE 8).YREQ090                            @D37BDAP 39900000
         DC    AL2(&IBAL)          BALANCE                     @D37BDAP 39950000
         AGO   .SVC                                            @D37BDAP 40000000
.YREQ090 DC    AL2(0)              BALANCE                     @D37BDAP 40050000
.*                                                                      40100000
.*       GENERATE SUPERVISOR CALL --                                    40150000
.*                                                                      40200000
.SVC     ANOP                                                           40250000
         SVC   99                  GETVCE SVC                           40300000
         AGO   .END                                                     40350000
.N4      AIF   ('&NAME' EQ '').END                                      40400000
&NAME    DC    0H'0'          LABEL OF SUPPRESSED GETVCE MACRO          40450000
.END     ANOP                                                           40500000
         SPACE 3                                                        40550000
         MEND                                                           40600000
