*********START OF SPECIFICATIONS*************************************** 00050000
*                                                                       00100000
* $MAC(FRACHECK) COMP(SC1BN) PROD(RACF):                                00150000
*                                                                       00200000
* DESCRIPTIVE NAME:                                                     00250000
*   FAST AUTHORIZATION CHECKING INTERFACE                               00300000
*                                                                       00350000
*  **PROPRIETARY_STATEMENT********************************************  00387500
*                                                                    *  00425000
*                                                                    *  00462500
*   LICENSED MATERIALS - PROPERTY OF IBM                             *  00500000
*   THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      *  00537500
*   5655-068 (C) COPYRIGHT IBM CORP. 1980, 1993                      *  00575000
*   SEE COPYRIGHT INSTRUCTIONS                                       *  00612500
*                                                                    *  00650000
*   STATUS= HBB5510                                                  *  00687500
*                                                               @L6C *  00725000
*  **END_OF_PROPRIETARY_STATEMENT*************************************  00762500
*                                                                       00800000
* FUNCTION:                                                             00850000
*   THIS MACRO ALLOWS THE CALLER TO CHECK THE USER'S AUTHORIZATION TO A 00900000
*   GENERAL CLASS RESOURCE WHICH HAS HAD ITS PROFILE LOADED INTO        00950000
*   STORAGE BY A RACLIST.                                               01000000
*                                                                       01050000
* CHANGE ACTIVITY:                                                      01100000
*   $L0=RACF VERSION 1 RELEASE 3                               @PC003PY 01150000
*   $T1=UZ90211,SAF/RF15,810702,CNTDSD:                            @T1A 01200000
*   UZ90283                                                    @ZA90283 01250000
*   UZ90284                                                    @ZA90284 01300000
*   UZ90285                                                    @ZA90285 01350000
*   $L1=HRF1702,RACF/170,841205,CNTDSD:                            @L1A 01400000
*   $L2=HRF1802,RACF/180,870325,CNTDSD:                            @L2A 01450000
*   $L3=JRF1812,RACF/181,871123,CNTDSD: RELEASE=1.8.1 ALLOWED      @L3A 01500000
*   $L4=VMSFS   RACF/190 890517 PDB_S1: RELEASE=1.9 ALLOWED        @L4A 01550000
*   $01=OY46708 RACF/190 910822 PDJ_K3: SUPPORT FOR OY46708        @01A 01600000
*   $L5=RELID   RACF/192 900904 PDAHW1: SUPPORT FOR RACF 1.9.2     @L5A 01650000
*   $P1=PJA0029 RACF/192 910524 PDPSB1: PTM PJA0029                @P1A 01670000
*   $L6=OW04015 RACF/210 930426 PDKAF1: SUPPORT FOR RACF 2.1       @L6A 01690000
*   $D1=OW03465 RACF/210 940304 KDRB:   OW03465 (DCR 40)           @D1A 01710000
*   $L7=OW10709 RACF/220 940509 PDJMV1: SUPPORT FOR RACF 2.2       @L7A 01730000
*                                                                       01750000
* CHANGE DESCRIPTIONS:                                                  01800000
*   A000000-999999                                             @PC003PY 01850000
*   A - ALLOW RELEASE=1.9 BUT MUST BE FROM RACROUTE.               @L4A 01900000
*       NOTE THAT ENTITYX IS NOT SUPPORTED FOR FRACHECK. (PDSHL1)  @L4A 01950000
*   C - CORRECT ERROR INTRODUCED BY @L4 (FOR 1.8.1 FRACHECKS)      @01A 02000000
*   A - ALLOW RELEASE=1.9.2 TO BE SPECIFIED                        @L5A 02050000
*   C - STATUS TO CORRECTLY CORRESPOND TO MVS LEVEL                @P1A 02065000
*   A - ALLOW RELEASE=2.1 TO BE SPECIFIED                          @L6A 02080000
*   A - ALLOW LOG TO BE SPECIFIED                                  @D1A 02095000
*   A - ALLOW RELEASE=2.2 TO BE SPECIFIED                          @L7A 02110000
* @D62CDHH: VSE/ESA COMPATIBILITY WITH MVS/ESA                 @D62CDHH 02125000
*                                                                       02150000
*********END OF SPECIFICATIONS***************************************** 02200000
         MACRO                                                          02250000
&SYMBOL  FRACHECK &ENTITY=,&CLASS=,&WKAREA=,                           *02300000
               &ATTR=,&MF=S,&INSTLN=,                                  *02350000
               &ACEE=,&APPL=,&RELEASE=,&LOG=                       @D1C 02400000
.******* DEFINE LOCAL SET SYMBOLS                                       02450000
         LCLA  &BIT0,&BIT1,&BIT2,&BIT3,&BIT4,&BIT5,&BIT6,&BIT7,&CLNGTH  02500000
         LCLA  &BIT8,&BIT9                                         @D1A 02516600
         LCLB  &LGERRFG           ERROR WITH LOG ENCOUNTERED       @D1A 02533200
         LCLA  &OFFSET                                                  02550000
         LCLB  &MFFLAG                                                  02600000
.******* DEFINE GLOBAL SET VARIABLES                               @T1A 02650000
         GBLB  &ICHRAC            ICHRAC - A FLAG WHICH, WHEN      @T1A 02700000
.*                                ON, INDICATES THAT THIS MACRO    @T1A 02750000
.*                                IS BEING INVOKED INTERNALLY      @T1A 02800000
.*                                BY THE RACROUTE MACRO.           @T1A 02850000
         GBLC  &ICHL              SETS ADDRESSABILITY TO THE       @T1A 02900000
.*                                PARAMETER LIST FOR THE           @T1A 02950000
.*                                RACROUTE MACRO.                  @T1A 03000000
         GBLC  &ICHRLVL           SYMBOL TO BRANCH TO              @L1A 03050000
.*                                WHEN INCOMPATIBLE MACRO LEVEL.   @L1A 03100000
&OFFSET  SETA  32                                                       03150000
.******* PERFORM PARAMETER DIAGNOSIS                                    03200000
.*                                                                      03250000
.* VALIDATE RELEASE PARAMETER                                      @L1A 03300000
         AIF   (&ICHRAC).RLVL01                                    @L1A 03350000
         AGO   .ERRVSE             NOT INVOKED BY RACROUTE     @D62CDHH 03375000
&ICHRLVL SETC  'ICH&SYSNDX.X'      CREATE LABEL FOR SVC BYPASS     @L1A 03400000
.RLVL01  ANOP                                                      @L1A 03450000
         AIF   ('&RELEASE' EQ '').SKIPTST                          @01C 03500000
         AIF   (N'&RELEASE GT 2).ERLVL1  INVALID RELEASE PARAMETER @L1A 03550000
         AIF   ('&RELEASE(1)' EQ '1.6').RLVL02                     @L5A 03600000
         AIF   ('&RELEASE(1)' EQ '1.7').RLVL02                     @L5A 03650000
         AIF   ('&RELEASE(1)' EQ '1.8').RLVL02                     @L5A 03700000
         AIF   ('&RELEASE(1)' EQ '1.8.1').RLVL02                   @L5A 03750000
         AIF   ('&RELEASE(1)' EQ '1.9').RLVL02                     @L5A 03800000
         AIF   ('&RELEASE(1)' EQ '1.9.2').RLVL02                   @L5A 03850000
         AIF   ('&RELEASE(1)' EQ '2.1').RLVL02                     @L6A 03866600
         AIF   ('&RELEASE(1)' EQ '2.2').RLVL02                     @L7A 03883200
         AGO   .ERLVL1                                             @L5A 03900000
.*   RELEASE CHECKING WAS RESTRUCTURED                             @L5D 03950000
.RLVL02  ANOP                                                      @L5A 04000000
         AIF   (N'&RELEASE EQ 1).NORLVLC CHECK NOT SPECIFIED       @L1A 04050000
         AIF   ('&RELEASE(2)' NE 'CHECK').ERLVL1 INVALID VALUE     @L1A 04100000
         AIF   ('&MF(1)' NE 'E').ERLVL2 CHECK ONLY WITH MF=E       @L1A 04150000
.ERLVL2R ANOP                                                      @L1A 04200000
.NORLVLC ANOP                                                      @L1A 04250000
.ERLVL1R ANOP                                                      @L1A 04300000
         AIF   ('&RELEASE(1)'(1,3) LT '1.9').SKIPTST               @01C 04350000
         AIF   (NOT &ICHRAC).ERR11                                 @L4A 04400000
.ERTN11  ANOP                                                      @L4A 04450000
.SKIPTST ANOP                                                      @L4A 04500000
.************************                                          @D1A 04503300
.* TEST THAT THE FRACHECK KEYWORDS FOR RELEASE 2.1 ARE NOT         @D1A 04506600
.* SPECIFIED WITH PREVIOUS RELEASES.                               @D1A 04509900
.************************                                          @D1A 04513200
         AIF   ('&RELEASE' NE '').DOR21TS                          @D1A 04516500
         AIF   ('&LOG' NE '').ERR15                                @D1A 04519800
         AGO   .NO21TS                                             @D1A 04523100
.DOR21TS ANOP                                                      @D1A 04526400
         AIF   ('&RELEASE(1)'(1,3) GE '2.1').NO21TS                @D1A 04529700
.DO21TS  ANOP                                                      @D1A 04533000
         AIF   ('&LOG' NE '').ERR14                                @D1A 04536300
.NO21TS  ANOP                                                      @D1A 04539600
.ERTN15  ANOP                                                      @D1A 04542900
.ERTN14  ANOP                                                      @D1A 04546200
.ERTN00  ANOP                                                           04550000
.******* VALIDATE ATTR PARAMETER                                        04600000
         AIF   ('&ATTR' EQ 'READ' OR '&ATTR' EQ 'ALTER'                -04650000
                OR '&ATTR' EQ '').RCHK000                               04700000
         AIF   ( '&ATTR' EQ 'UPDATE' OR '&ATTR' EQ                     -04750000
               'CONTROL' OR '&ATTR'(1,1) EQ '(').RCHK000                04800000
         AGO   .ERR04                                                   04850000
.ERTN04  ANOP                                                           04950000
.RCHK000 ANOP                                                           04954100
.******* CHECK FOR VALID VALUES OF LOG                             @D1A 04958200
         AIF   ('&LOG' EQ '').RCHK002                              @D1A 04962300
         AIF   (NOT &ICHRAC).ERR13                                 @D1A 04966400
.ERTN13  ANOP                                                      @D1A 04970500
         AIF   ('&LOG' EQ ' ').RCHK002                             @D1A 04974600
         AIF   ('&LOG' EQ 'NONE').RCHK002                          @D1A 04978700
         AIF   ('&LOG' EQ 'ASIS').RCHK002                          @D1A 04982800
         AIF   ('&LOG' NE 'NOFAIL').ERR12                          @D1A 04986900
.ERTN12  ANOP                                                      @D1A 04991000
.RCHK002 ANOP                                                      @D1A 04995100
.******* VALIDATE MF PARAMETER                                          05000000
         AIF   ('&MF' NE 'S' AND '&MF' NE 'L' AND '&MF'(1,2) NE        -05050000
               '(E').ERR06                                              05100000
.ERTN06  ANOP                                                           05150000
.******* REGISTER SPECIFICATION OF ADDR TYPE PARAMETERS NOT             05200000
.******* ALLOWED WITH LIST FORM                                         05250000
         AIF   ('&MF' NE 'L').RCHK020                                   05300000
         AIF   ('&ATTR' EQ '').RCHK010                                  05350000
         AIF   ('&ATTR'(1,1) EQ '(').ERR07                              05400000
.RCHK010 ANOP                                                           05450000
         AIF   ('&ENTITY' EQ '').RCHK011                                05500000
         AIF   ('&ENTITY'(1,1) EQ '(').ERR07                            05550000
.RCHK011 ANOP                                                           05600000
         AIF   ('&CLASS' EQ '').RCHK012                                 05650000
         AIF   ('&CLASS'(1,1) EQ '(').ERR07                             05700000
.RCHK012 ANOP                                                           05750000
         AIF   ('&ACEE' EQ '').RCHK013                                  05800000
         AIF   ('&ACEE'(1,1) EQ '(').ERR07                              05850000
.RCHK013 ANOP                                                           05900000
         AIF   ('&APPL' EQ '').RCHK014                                  05950000
         AIF   ('&APPL'(1,1) EQ '(').ERR07                              06000000
.RCHK014 ANOP                                                           06050000
         AIF   ('&WKAREA' EQ '').RCHK015                                06100000
         AIF   ('&WKAREA'(1,1) EQ '(').ERR07                            06150000
.RCHK015 ANOP                                                           06200000
         AIF   ('&INSTLN(1)' NE '&INSTLN').ERR07                        06250000
.RCHK020 ANOP                                                           06300000
.ERTN07  ANOP                                                           06350000
.*                                                                      06400000
.******* PRODUCE LIST FORM IF REQUESTED                                 06450000
.*                                                                      06500000
         AIF   ('&MF' NE 'L').RCHK400                                   06550000
&SYMBOL  DS    0F                                                       06600000
.RCHK100 ANOP                                                           06650000
ICH0&SYSNDX EQU *                                                       06700000
.RCHK105 ANOP                                                           06750000
.******* PRODUCE FLAG BYTE WITH ATTR PARAMETER                          06800000
&BIT0    SETA  0                                                        06850000
&BIT1    SETA  0                                                        06900000
&BIT4    SETA  0                                                        06950000
&BIT5    SETA  0                                                        07000000
&BIT6    SETA  0                                                        07050000
         AIF   ('&ATTR' EQ '').RCHK125                                  07100000
         AIF   ('&ATTR'(1,1) EQ '(').RCHK130                            07150000
         AIF   ('&ATTR' NE 'ALTER').RCHK110                             07200000
&BIT0    SETA  1                                                        07250000
         AGO   .RCHK130                                                 07300000
.RCHK110 ANOP                                                           07350000
         AIF   ('&ATTR' NE 'CONTROL').RCHK115                           07400000
&BIT4    SETA  1                                                        07450000
         AGO   .RCHK130                                                 07500000
.RCHK115 ANOP                                                           07550000
         AIF   ('&ATTR' NE 'UPDATE').RCHK120                            07600000
&BIT5    SETA  1                                                        07650000
         AGO   .RCHK130                                                 07700000
.RCHK120 ANOP                                                           07750000
         AIF   ('&ATTR' NE 'READ').RCHK130                              07800000
.RCHK125 ANOP                                                           07850000
&BIT6    SETA  1                                                        07900000
.RCHK130 ANOP                                                           07950000
.******* PRODUCE FLAG BYTE WITH LOG PARAMETER                      @D1A 07953500
&BIT8    SETA  0                                                   @D1A 07957000
&BIT9    SETA  0                                                   @D1A 07960500
         AIF   (&LGERRFG).RCHK140                                  @D1A 07964000
         AIF   ('&LOG' EQ '').RCHK140                              @D1A 07967500
         AIF   ('&LOG' EQ 'NONE').RCHK140                          @D1A 07971000
         AIF   ('&LOG' NE 'ASIS').RCHK135                          @D1A 07974500
&BIT8    SETA  1                        SET FOR LOG=ASIS           @D1A 07978000
         AGO   .RCHK140                                            @D1A 07981500
.RCHK135 ANOP                                                      @D1A 07985000
         AIF   ('&LOG' NE 'NOFAIL').RCHK140                        @D1A 07988500
&BIT9    SETA  1                        SET FOR LOG=NOFAIL         @D1A 07992000
.RCHK140 ANOP                                                      @D1A 07995500
&ICHL    DC    B'&BIT0.000&BIT4&BIT5&BIT6.0' - ATTR VALUE               08000000
         DC    B'&BIT8&BIT9.000000'          - LOG  VALUE          @D1A 08037500
.******* RESERVED FIELD - 2 BYTES                                  @D1C 08075000
         DC    2X'00' - RESERVED                                   @D1C 08112500
.******* PRODUCE ENTITY NAME *****                                      08150000
         AIF   ('&ENTITY' EQ '').RCHK150                                08200000
         AIF   ('&ENTITY'(1,1) EQ '(').RCHK150                          08250000
         DC    A(&ENTITY) - ENTITY NAME ADDRESS                         08300000
         AGO   .RCHK155                                                 08350000
.RCHK150 ANOP                                                           08400000
         DC    A(0)            - ENTITY NAME ADDRESS                    08450000
.RCHK155 ANOP                                                           08500000
.******* PRODUCE CLASS NAME ADDRESS IF REQUIRED                         08550000
         AIF   ('&CLASS' EQ '').RCHK165                                 08600000
         AIF   ('&CLASS'(1,1) EQ '(').RCHK165                           08650000
         AIF   ('&CLASS'(1,1) EQ '''').RCHK160                          08700000
         DC    A(&CLASS) -  CLASS NAME ADDRESS                          08750000
         AGO   .RCHK170                                                 08800000
.RCHK160 ANOP                                                           08850000
         DC    A(ICH1&SYSNDX) CLASS NAME ADDRESS WITHIN LIST            08900000
         AGO   .RCHK170                                                 08950000
.RCHK165 ANOP                                                           09000000
         DC    A(0) -       CLASS NAME ADDRESS FIELD                    09050000
.RCHK170 ANOP                                                           09100000
.******* PROCESS ACEE PARAMETER                                         09150000
         AIF   ('&ACEE' EQ '' ).RCHK175                                 09200000
         AIF   ('&ACEE'(1,1) EQ '(').RCHK175                            09250000
         DC    A(&ACEE) - ACEE ADDRESS                                  09300000
         AGO   .RCHK180                                                 09350000
.RCHK175 ANOP                                                           09400000
         DC    A(0)    - ACEE ADDRESS                                   09450000
.RCHK180 ANOP                                                           09500000
.******* PROCESS APPL PARAMETER                                         09550000
         AIF   ('&APPL' EQ '').RCHK190                                  09600000
         AIF   ('&APPL'(1,1) EQ '(').RCHK190                            09650000
         AIF   ('&APPL'(1,1) EQ '''').RCHK185                           09700000
         DC    A(&APPL) -   APPL NAME ADDRESS                           09750000
         AGO   .RCHK195                                                 09800000
.RCHK185 ANOP                                                           09850000
         DC    A(ICH2&SYSNDX) APPL NAME ADDRESS WITHIN LIST             09900000
         AGO   .RCHK195                                                 09950000
.RCHK190 ANOP                                                           10000000
         DC    A(0) -       APPL NAME ADDRESS FIELD                     10050000
.RCHK195 ANOP                                                           10100000
.******* PROCESS WKAREA PARAMETER                                       10150000
         AIF   ('&WKAREA' EQ '').RCHK200                                10200000
         AIF   ('&WKAREA'(1,1) EQ '(').RCHK200                          10250000
         DC    A(&WKAREA) - WORK AREA ADDRESS                           10300000
         AGO   .RCHK205                                                 10350000
.RCHK200 ANOP                                                           10400000
         DC    A(0) - WORK AREA ADDRESS                                 10450000
.RCHK205 ANOP                                                           10500000
.******* PROCESS INSTLN PARAMETER                                       10550000
         AIF   ('&INSTLN' EQ '' OR                                     *10600000
               '&INSTLN(1)' NE '&INSTLN').RCHK210                       10650000
         DC    A(&INSTLN) - ADDRESS OF INSTALLATION DATA                10700000
         AGO   .RCHK215                                                 10750000
.RCHK210 ANOP                                                           10800000
         DC    A(0) - ADDRESS OF INSTALLATION DATA                      10850000
.RCHK215 ANOP                                                           10900000
.******* IF CLASSNAME SPECIFIED EXPLICITLY, PRODUCE IT BELOW LIST FORM  10950000
         AIF   ('&CLASS' EQ '').RCHK230                                 11000000
         AIF   ('&CLASS'(1,1) NE '''').RCHK230                          11050000
ICH1&SYSNDX DC    CL8&CLASS    - CLASS NAME                             11100000
.RCHK230 ANOP                                                           11150000
.******* IF APPL NAME SPECIFIED EXPLICITLY, PRODUCE IT BELOW LIST FORM  11200000
         AIF   ('&APPL' EQ '').RCHK240                                  11250000
         AIF   ('&APPL'(1,1) NE '''').RCHK240                           11300000
ICH2&SYSNDX DC    CL8&APPL - APPL NAME                                  11350000
.RCHK240 ANOP                                                           11400000
.******* LIST FORM COMPLETE - TEST FOR STANDARD FORM PASS               11450000
.******* THROUGH LIST FORM                                              11500000
         AIF   (&MFFLAG).RCHK510                                        11550000
         MEXIT                                                          11600000
.******* TEST FOR STANDARD FORM OR EXECUTE FORM OF MACRO                11650000
.RCHK400 ANOP                                                           11700000
         AIF   ('&MF(1)' EQ 'E').RCHK600                                11750000
.******* STANDARD FORM REQUESTED                                        11800000
&SYMBOL  DS    0H                                                       11850000
&MFFLAG  SETB  1              SET TRUE FOR PASS THROUGH LIST FORM       11900000
.******* PRODUCE INSTRUCTIONS TO MODIFY IN-LINE LIST FORM               11950000
.******* WITH REGISTER ADDRS                                            12000000
         AIF   ('&ATTR' EQ '').RCHK410                                  12050000
         AIF   ('&ATTR'(1,1) NE '(').RCHK410                            12100000
         STC   &ATTR(1),ICH0&SYSNDX - STORE ATTR VALUE                  12150000
.RCHK410 ANOP                                                           12200000
         AIF   ('&ENTITY' EQ '').RCHK420                                12250000
         AIF   ('&ENTITY'(1,1) NE '(').RCHK420                          12300000
         ST    &ENTITY,ICH0&SYSNDX+4          -STORE ENTITY ADDRESS     12350000
.RCHK420 ANOP                                                           12400000
         AIF   ('&CLASS' EQ '').RCHK430                                 12450000
         AIF   ('&CLASS'(1,1) NE '(').RCHK430                           12500000
         ST    &CLASS(1),ICH0&SYSNDX+8 - STORE CLASS NAME ADDRESS       12550000
.RCHK430 ANOP                                                           12600000
         AIF   ('&ACEE' EQ '').RCHK440                                  12650000
         AIF   ('&ACEE'(1,1) NE '(').RCHK440                            12700000
         ST    &ACEE(1),ICH0&SYSNDX+12 - STORE ACEE ADDRESS             12750000
.RCHK440 ANOP                                                           12800000
         AIF   ('&APPL' EQ '').RCHK450                                  12850000
         AIF   ('&APPL'(1,1) NE '(').RCHK450                            12900000
         ST    &APPL(1),ICH0&SYSNDX+16 - STORE APPL ADDRESS             12950000
.RCHK450 ANOP                                                           13000000
         AIF   ('&WKAREA' EQ '').RCHK460                                13050000
         AIF   ('&WKAREA'(1,1) NE '(').RCHK460                          13100000
         ST    &WKAREA(1),ICH0&SYSNDX+20 - STORE WKAREA ADDRESS         13150000
.RCHK460 ANOP                                                           13200000
         AIF   ('&INSTLN' EQ '' OR '&INSTLN(1)' EQ '&INSTLN').RCHK470   13250000
         ST    &INSTLN(1),ICH0&SYSNDX+24 - STORE INSTALLATION DATA ADDR 13300000
.RCHK470 ANOP                                                           13350000
.******* LIST FORM MODIFICATION COMPLETE - PRODUCE                      13400000
.******* LIST FORM WITH BAL AROUND                                      13450000
         AIF   ('&CLASS' EQ '').RCHK480                                 13500000
         AIF   ('&CLASS'(1,1) NE '''').RCHK480                          13550000
&OFFSET  SETA  &OFFSET+8                                                13600000
.RCHK480 ANOP                                                           13650000
         AIF   ('&APPL' EQ '').RCHK485                                  13700000
         AIF   ('&APPL'(1,1) NE '''').RCHK485                           13750000
&OFFSET  SETA  &OFFSET+8                                                13800000
.RCHK485 ANOP                                                           13850000
         CNOP  0,4                                                      13900000
         BAL   1,*+&OFFSET    POINT REG 1 AT PARM LIST                  13950000
         AGO   .RCHK100       GO TO PRODUCE LIST                        14000000
.RCHK510 ANOP                                                           14050000
.***********************************************************       @T1A 14100000
.* IF THIS MACRO WAS INVOKED INTERNALLY BY THE RACROUTE            @T1A 14150000
.* MACRO, SIMPLY EXIT RATHER THAN GOING TO THE RACF ROUTINE.       @T1A 14200000
.***********************************************************       @T1A 14250000
         AIF   (&ICHRAC).RCHK520                                   @T1A 14300000
.******* RETURN FROM LIST FORM TO PRODUCE INTERFACE CODE                14350000
         L     15,16(0,0)            GET CVT ADDRESS                    14400000
         L     15,X'3E0'(0,15)       GET RACF CVT ADDRESS               14450000
         LTR   15,15                 RACF CVT EXIST                     14500000
         BZ    *+12                  NO, BRANCH TO SET NOT ACTIVE       14550000
         CLI   X'AC'(15),X'02'       RACF FUNCTION SUPPORTED (RCVTVERS) 14600000
         BNL   *+12                  YES, BRANCH                        14650000
         LA    15,20(0,0)            RACF FUNCTION NOT SUPPORTED        14700000
         B     *+10                  SKIP CALL                          14750000
         L     15,X'C4'(0,15)        GET ADDRESS OF FRACHECK ROUTINE    14800000
         BALR  14,15                 CALL FRACHECK ROUTINE              14850000
.ERRVSER ANOP                        VSE EXIT ON ERROR         @D62CDHH 14875000
.RCHK520 ANOP                                                      @T1A 14900000
         MEXIT                                                          14950000
.******* PRODUCE EXECUTE FORM OF MACRO                                  15000000
.******* PRODUCE INSTRUCTIONS TO MODIFY LIST                            15050000
.******* PRODUCE ANOTHER FLAGS BYTE WITH ATTR SPECS                @D1C 15100000
.RCHK600 ANOP                                                           15150000
         AIF   (&ICHRAC).RCHK603                                   @T1A 15200000
&SYMBOL  IHBINNRA &MF(2) -    POINT REG1 AT LIST FORM                   15250000
         AGO   .RCHK605                                            @T1A 15300000
.**************************************************************    @T1A 15350000
.*  IF THIS MACRO WERE INVOKED INTERNALLY BY THE RACROUTE MACRO,   @T1A 15400000
.*  PICK UP THE ADDRESS OF THE FRACHECK PARAMETER LIST FROM THE    @T1A 15450000
.*  RACROUTE PARAMETER LIST.                                       @T1A 15500000
.**************************************************************    @T1A 15550000
.RCHK603 ANOP                                                      @T1A 15600000
         A     1,36(1)         POINT REG 1 AT FRACHECK LIST        @T1A 15650000
.RCHK605 ANOP                                                      @T1A 15700000
         AIF   ('&ATTR' EQ '').RCHK650                                  15750000
         AIF   ('&ATTR'(1,1) EQ '(').RCHK640                            15800000
         AIF   ('&ATTR' NE 'ALTER').RCHK610                             15850000
         MVI   0(1),X'80' -   SET FOR ALTER ACCESS                      15900000
         AGO   .RCHK650                                                 15950000
.RCHK610 ANOP                                                           16000000
         AIF   ('&ATTR' NE 'UPDATE').RCHK620                            16050000
         MVI   0(1),X'04'               SET FOR UPDATE ACCESS           16100000
         AGO   .RCHK650                                                 16150000
.RCHK620 ANOP                                                           16200000
         AIF   ('&ATTR' NE 'READ').RCHK630                              16250000
         MVI   0(1),X'02'               SET FOR READ ACCESS             16300000
         AGO   .RCHK650                                                 16350000
.RCHK630 ANOP                                                           16400000
         AIF   ('&ATTR' NE 'CONTROL').RCHK650                           16450000
         MVI   0(1),X'08'               SET FOR CONTROL ACCESS          16500000
         AGO   .RCHK650                                                 16550000
.RCHK640 ANOP                                                           16600000
         STC   &ATTR(1),0(1) - STORE ATTR VALUE IN LIST FORM            16650000
.RCHK650 ANOP                                                           16700000
.******* HANDLE LOG PARAMETER                                      @D1A 16702900
         AIF   (&LGERRFG).RCHK655                                  @D1A 16705800
         AIF   ('&LOG' EQ '').RCHK655                              @D1A 16708700
         AIF   ('&LOG' NE 'NONE').RCHK651                          @D1A 16711600
         NI    1(1),X'3F'               AND OFF ASIS & NOFAIL BITS @D1A 16714500
         AGO   .RCHK655                                            @D1A 16717400
.RCHK651 ANOP                                                      @D1A 16720300
         AIF   ('&LOG' NE 'ASIS').RCHK652                          @D1A 16723200
         NI    1(1),X'BF'               AND OFF NOFAIL BIT         @D1A 16726100
         OI    1(1),X'80'               OR ON   ASIS   BIT         @D1A 16729000
         AGO   .RCHK655                                            @D1A 16731900
.RCHK652 ANOP                                                      @D1A 16734800
         AIF   ('&LOG' NE 'NOFAIL').RCHK655                        @D1A 16737700
         NI    1(1),X'7F'               AND OFF ASIS   BIT         @D1A 16740600
         OI    1(1),X'40'               OR ON   NOFAIL BIT         @D1A 16743500
.RCHK655 ANOP                                                      @D1A 16746400
.******* HANDLE ENTITY PARAMETER                                        16750000
         AIF   ('&ENTITY' EQ '').RCHK665                                16800000
         AIF   ('&ENTITY'(1,1) NE '(').RCHK660                          16850000
         ST    &ENTITY,4(1) - STORE ENTITY NAME ADDRESS                 16900000
         AGO   .RCHK665                                                 16950000
.RCHK660 ANOP                                                           17000000
         LA    0,&ENTITY - MOVE ENTITY NAME ADDRESS                     17050000
         ST    0,4(1) -      INTO PARM LIST                             17100000
.RCHK665 ANOP                                                           17150000
.******* HANDLE CLASS PARAMETER                                         17200000
         AIF   ('&CLASS' EQ '').RCHK675                                 17250000
         AIF   ('&CLASS'(1,1) EQ '''').ERR09                            17300000
         AIF   ('&CLASS'(1,1) NE '(').RCHK670                           17350000
         ST    &CLASS(1),8(1) - STORE CLASS NAME ADDRESS                17400000
         AGO   .RCHK675                                                 17450000
.RCHK670 ANOP                                                           17500000
         LA    0,&CLASS -     MOVE CLASS NAME ADDRESS                   17550000
         ST    0,8(1) -      INTO PARM LIST                             17600000
.ERTN09  ANOP                                                           17650000
.RCHK675 ANOP                                                           17700000
.******* HANDLE ACEE PARAMTER                                           17750000
         AIF   ('&ACEE' EQ '').RCHK685                                  17800000
         AIF   ('&ACEE'(1,1) NE '(').RCHK680                            17850000
         ST    &ACEE(1),12(1) - STORE ACEE ADDRESS                      17900000
         AGO   .RCHK685                                                 17950000
.RCHK680 ANOP                                                           18000000
         LA    0,&ACEE - ADDRESS ACEE                                   18050000
         ST    0,12(1) - STORE INTO PARAMTER LIST                       18100000
.RCHK685 ANOP                                                           18150000
.******* HANDLE APPL PARAMETER                                          18200000
         AIF   ('&APPL' EQ '').RCHK695                                  18250000
         AIF   ('&APPL'(1,1) EQ '''').ERR10                             18300000
         AIF   ('&APPL'(1,1) NE '(').RCHK690                            18350000
         ST    &APPL(1),16(1) - STORE APPL NAME ADDRESS                 18400000
         AGO   .RCHK695                                                 18450000
.RCHK690 ANOP                                                           18500000
         LA    0,&APPL -      MOVE APPL NAME ADDRESS                    18550000
         ST    0,16(1) -      INTO PARM LIST                            18600000
.ERTN10  ANOP                                                           18650000
.RCHK695 ANOP                                                           18700000
.******* HANDLE WKAREA PARAMTER                                         18750000
         AIF   ('&WKAREA' EQ '').RCHK705                                18800000
         AIF   ('&WKAREA'(1,1) NE '(').RCHK700                          18850000
         ST    &WKAREA(1),20(1) - STORE WKAREA ADDRESS                  18900000
         AGO   .RCHK705                                                 18950000
.RCHK700 ANOP                                                           19000000
         LA    0,&WKAREA - ADDRESS WKAREA                               19050000
         ST    0,20(1) - STORE INTO PARAMTER LIST                       19100000
.RCHK705 ANOP                                                           19150000
.******* PRODUCE INSTALLATION DATA ADDRESS                              19200000
         AIF   ('&INSTLN' EQ '').RCHK715                                19250000
         AIF   ('&INSTLN'(1,1) NE '(').RCHK710                          19300000
         ST    &INSTLN(1),24(1) - STORE INSTALLATION ADDR               19350000
         AGO   .RCHK715                                                 19400000
.RCHK710 ANOP                                                           19450000
         LA    0,&INSTLN - ADDRESS INSTALLATION DATA ADDRESS            19500000
         ST    0,24(1) - STORE INSTALLATION DATA ADDRESS                19550000
.RCHK715 ANOP                                                           19600000
.******* MODIFICATION COMPLETE - AGO ABOVE TO PRODUCE ENTRY LOGIC       19650000
         AGO   .RCHK510                                                 19700000
.******* DIAGNOSTICS                                                    19750000
.ERR00   ANOP                                                           19800000
         MNOTE 8,'*** ENTITY PARAMETER REQUIRED ***'                    19850000
         AGO   .ERTN00                                                  19900000
.ERR04   ANOP                                                           19950000
         MNOTE 8,'*** INVALID ATTR PARAMETER SPECIFIED ***'             20000000
         AGO   .ERTN04                                                  20050000
.ERR06   ANOP                                                           20100000
         MNOTE 8,'*** INVALID MF PARAMETER SPECIFIED ***'               20150000
         AGO   .ERTN06                                                  20200000
.ERR07   ANOP                                                           20250000
         MNOTE 8,'*** REGISTER ADDRESS SPECIFICATION NOT ALLOWED WITH L-20300000
               IST FORM ***'                                            20350000
         AGO   .ERTN07                                                  20400000
.ERR09   ANOP                                                           20450000
         MNOTE 8,'*** ''CLASSNAME'' FORM NOT ALLOWED WITH MF=E ***'     20500000
         AGO   .ERTN09                                                  20550000
.ERR10   ANOP                                                           20600000
         MNOTE 8,'*** ''APPLNAME'' FORM NOT ALLOWED WITH MF=E ***'      20650000
         AGO   .ERTN10                                                  20700000
.ERR11   ANOP                                                      @L4A 20750000
         MNOTE 8,'*** FRACHECK CAN BE INVOKED ONLY VIA RACROUTE FOR REL-20800000
               EASE 1.9 AND LATER  ***'                            @L4A 20850000
         AGO   .ERTN11                                             @L4A 20900000
.ERR12   ANOP                                                      @D1A 20900500
         MNOTE 8,'*** INCORRECT SPECIFICATION OF ''LOG'' ***'      @D1A 20901000
&LGERRFG SETB  1                                                        20901500
         AGO   .ERTN12                                             @D1A 20902000
.ERR13   ANOP                                                      @D1A 20902500
         MNOTE 8,'*** FRACHECK WITH LOG CAN BE INVOKED ONLY VIA RACROUT+20903000
               E ***'                                              @D1A 20903500
&LGERRFG SETB  1                                                        20904000
         AGO   .ERTN13                                             @D1A 20904500
.ERR14   MNOTE 8,'*** ''LOG'' KEYWORD IS NOT SUPPORTED WITH SPECIFIED R+20905000
               ELEASE ***'                                         @D1A 20905500
&LGERRFG SETB  1                                                   @D1A 20906000
         AGO   .ERTN14                                             @D1A 20906500
.ERR15   MNOTE 8,'*** LOG MAY NOT BE SPECIFIED UNLESS RELEASE IS SPECIF+20907000
               IED ***'                                            @D1A 20907500
&LGERRFG SETB  1                                                   @D1A 20908000
         AGO   .ERTN15                                             @D1A 20908500
.ERRVSE  ANOP                                                  @D62CDHH 20910000
         MNOTE 8,'*** FRACHECK CAN BE INVOKED ONLY VIA RACROUTE FOR VSE-20920000
               /ESA  ***'                                      @D62CDHH 20930000
         AGO   .ERRVSER                                        @D62CDHH 20940000
.ERLVL1  MNOTE 8,'*** INCORRECT SPECIFICATION OF ''RELEASE'' ***'  @L1A 20950000
         AGO   .ERLVL1R                                            @L1A 21000000
.ERLVL2  MNOTE 4,'*** ''RELEASE-CHECK'' ONLY VALID WITH ''MF=E'' ***'  X21050000
                                                                   @L1A 21100000
         AGO   .ERLVL2R                                            @L1A 21150000
         MEND                                                           21200000
