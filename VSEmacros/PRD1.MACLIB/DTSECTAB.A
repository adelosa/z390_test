         MACRO                                                          00050000
&LABEL   DTSECTAB &ACC=,       ACCESS CLASSES                          X00100000
               &READDIR=NO,    READ DIRECTORY W/O READ AUTH    @D52SDPPX00116653
               &MCONS=NO,      OPEN MASTER CONSOLE             @D53CDKHX00133353
               &AUTH=NO,       SPECIAL USER AUTHORITY                  X00150000
               &LOG=,          CLASSES TO AUDIT/LOG                    X00200000
               &NAME=,         USER/GROUP/PHASE/FILE NAME              X00250000
               &PASSWRD=,      USER PASSWORD                           X00300000
               &RIGHT=,        SPECIAL ACC RIGHT               @D14CDOWX00350000
               &SUBTYPE=,      REQUEST SUBTYPE                         X00400000
               &TYPE=,         REQUEST TYPE                            X00450000
               &UACC=          UNIVERSAL ACCESS RIGHT          @D14CDOW 00500000
         GBLA  &MAX            **NUMBER OF ARRAY ENTRIES                00550000
         GBLC  &A(1001)        **AUTH=YES OR NO                         00583352
         GBLC  &B(1001)        **READDIR=YES OR NO             @D52SDPP 00616652
         GBLC  &D(1001)        **MCONS=YES OR NO               @D53CDKH 00633353
         GBLC  &C(1001)        **TYPE= TRANSLATED CODE(B,C,..)          00650000
         GBLC  &I(1001)        **SUBTYPE=                               00700000
         GBLC  &L(1001)        **LOGGING OPTIONS                        00750000
         GBLC  &M(1001)        **LENGTH GENERIC NAME           @D14CDOW 00800000
         GBLC  &N(1001)        **NAME=                                  00850000
         GBLC  &P(1001)        **PASSWRD=                               00900000
         GBLC  &R(1001)        **SPECIAL RIGHTS                @D14CDOW 00950000
         GBLC  &S(1001)        **ACCESS CLASSES                         01000000
         GBLC  &T(1001)        **TYPE=                                  01050000
         GBLC  &U1(1001)       **ALTER AUTHORITY               @D14CDOW 01100000
         GBLC  &U2(1001)       **UPDATE AUTHORITY              @D14CDOW 01150000
         GBLC  &U3(1001)       **READ AUTHORITY                @D14CDOW 01200000
         GBLC  &U4(1001)       **CONNECT AUTHORITY             @D14CDOW 01250000
         GBLC  &Z(1001)        **UNIVERSAL ACC RIGHT           @D14CDOW 01300000
         GBLC  &CHARC          WORK ARRAY                               01350000
         GBLC  &CHART          WORK ARRAY                               01400000
         GBLA  &COUNT          COUNTERS                                 01450000
         GBLA  &IX             INDEX                                    01500000
         GBLB  &ABSW           SWITCHES                                 01550000
         GBLB  &AUTSW          *                                        01600000
         GBLB  &FINSW          *                                        01650000
         GBLB  &INITSW         *                                        01700000
         GBLB  &LOGSW          *                                        01750000
         GBLB  &WARNSW         *                                        01800000
         GBLC  &BLANKS         BLANK FIELD                              01850000
         GBLC  &XACC           ACCESS CLASSES TO DTSECTIN               01900000
         GBLC  &XLOG           LOGGING OPTIONS TO DTSECTIN              01950000
         GBLC  &XRIGHT         CATAL B-TRANS TO DTSECTIN       @D14CDOW 02000000
         GBLC  &XALT           R/W LEVELS TO DTSECTIN          @D14CDOW 02050000
         GBLC  &XUPD           *                               @D14CDOW 02100000
         GBLC  &XREAD          *                               @D14CDOW 02150000
         GBLC  &XCON           *                               @D14CDOW 02200000
         GBLC  &XGLEN          PASS VALID LENGTH TO DTSECTIN   @D14CDOW 02250000
         LCLA  &LCA1           LOCAL COUNTER                            02300000
         LCLA  &LCA2           *                                        02350000
         LCLA  &LCA3           *                                        02400000
         LCLA  &LCA4           *                                        02450000
         LCLA  &LCA5           *                                        02500000
         LCLA  &LCA6           *                                        02550000
         LCLA  &LCA7           *                                        02600000
         LCLA  &LCA8           *                                        02650000
         LCLA  &LCA9           *                                        02700000
         LCLA  &LCAPSTR        *                               @DA36582 02750000
         LCLA  &SPAN                                                    02800000
         LCLA  &NAMEML         MAX LENGTH OF NAME                       02850000
         LCLA  &NAMEAL         ACTUAL LENGTH OF NAME                    02900000
         LCLA  &LIX            LOCAL WORK INDEX                         02950000
         LCLA  &PIX            *                                        03000000
         LCLA  &IXCUR          *                                        03050000
         LCLA  &IXNXT          *                                        03100000
         LCLA  &KPASS                                                   03150000
         LCLA  &START                                                   03200000
         LCLA  &SUBEND                                                  03250000
         LCLB  &SORTSW         SORT RTN SWITCHES                        03300000
         LCLB  &ENDSW          *                                        03350000
         LCLB  &GROUPSW        *                                        03400000
         LCLB  &LCB1                                                    03450000
         LCLB  &ACCTBL(32)     ACCESS LEVELS LOCAL ARRAY                03500000
         LCLB  &LOGTBL(32)     LOGGING LEVELS LOCAL ARRAY               03550000
         LCLC  &AUTTBL(32)     AUTHORIZATION LEVEL             @D14CDOW 03600000
         LCLC  &AA             SORT EXCHANGE AREAS                      03650000
         LCLC  &BB             *                               @D52SDPP 03675052
         LCLC  &DD             *                               @D53CDKH 03687553
         LCLC  &CC             *                                        03700000
         LCLC  &LL             *                                        03750000
         LCLC  &MM             *                               @D14CDOW 03800000
         LCLC  &NN             *                                        03850000
         LCLC  &PP             *                                        03900000
         LCLC  &RR             *                               @D14CDOW 03950000
         LCLC  &SS             *                                        04000000
         LCLC  &TT             *                                        04050000
         LCLC  &UU1            *                               @D14CDOW 04100000
         LCLC  &UU2            *                               @D14CDOW 04150000
         LCLC  &UU3            *                               @D14CDOW 04200000
         LCLC  &UU4            *                               @D14CDOW 04250000
         LCLC  &ZZ             *                               @D14CDOW 04300000
         LCLC  &LY(32)         ACCESS LOCAL WORK ARRAY                  04350000
         LCLC  &LZ1(32)        R/W LEVEL LOCAL WORK ARRAY               04400000
         LCLC  &LZ2(32)        R/W LEVEL LOCAL WORK ARRAY               04450000
         LCLC  &LZ3(32)        R/W LEVEL LOCAL WORK ARRAY               04500000
         LCLC  &LZ4(32)        R/W LEVEL LOCAL WORK ARRAY               04550000
         LCLC  &AO             PASS PARMS TO INNER                      04600000
         LCLC  &BO             *                               @D52SDPP 04625052
         LCLC  &DO             *                               @D53CDKH 04637553
         LCLC  &CO             *                                        04650000
         LCLC  &IO             *                                        04700000
         LCLC  &MO             *                               @D14CDOW 04750000
         LCLC  &NO             *                                        04800000
         LCLC  &PO             *                                        04850000
         LCLC  &TO             *                                        04900000
         LCLC  &ZO             *                               @D14CDOW 04950000
         LCLC  &LCC1                                                    05000000
         LCLC  &LCC2                                                    05050000
         LCLC  &LCC3                                                    05100000
         LCLC  &LCC4                                           @D14CDOW 05150000
         LCLC  &FIRST                                          @D14CDOW 05200000
         LCLC  &SECOND                                         @D14CDOW 05250000
         LCLC  &USERID          USER-ID FROM NAME PARAMETER             05300000
         LCLC  &VOLID           VOLID FROM NAME PARAMETER      @D14CDOW 05350000
         LCLC  &FILEID          FILE-ID FROM NAME PARAMETER    @D14CDOW 05400000
         LCLC  &LIBNAME         LIB-NAME FROM NAME PARAMETER   @D14CDOW 05450000
         LCLC  &SLIBNAM         SUB-LIBNAME FROM NAME PARAMETER@D14CDOW 05500000
         LCLC  &MEMBER          MEMBERNAME OF NAME PARAMETER   @D14CDOW 05550000
         LCLC  &DSNT                                                    05600000
         LCLC  &GDSNT                                          @D14CDOW 05650000
         LCLC  &MEMT                                           @D14CDOW 05700000
         LCLC  &GMEMT                                          @D14CDOW 05750000
         LCLC  &SLBT                                           @D14CDOW 05800000
         LCLC  &GSLBT                                          @D14CDOW 05850000
         LCLC  &LIBT                                                    05900000
         LCLC  &GLIBT                                          @D14CDOW 05950000
         LCLC  &OPTT                                                    06000000
         LCLC  &USET                                                    06050000
         LCLC  &PASS(8)         CONSTRUCT PASSWORD                      06100000
         AGO    .CIBM53                                                 06150000
*************************************************************           06200000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"        *           06250000
*        5686-066 (C) COPYRIGHT IBM CORP 1979, 1995         *           06300053
*        ALL RIGHTS RESERVED                                *           06350000
*        LICENSED MATERIALS - PROPERTY OF IBM               *           06400000
.*       SEE COPYRIGHT INSTRUCTIONS, G120-2083              *           06450000
*************************************************************           06500000
.CIBM53  ANOP                                                           06550000
.*                                                                      06600000
.*                                                                      06650000
.*       GLOBAL ARRAYS                                                  06700000
.*                                                                      06750000
.*       THE ARRAYS 'A,C,I,L,...,Z' ARE USED TO TEMPORARILY HOLD        06800000
.*       EXTERNAL MACRO CALLS.  EACH ENTRY EQUALS ONE DTSECTAB MACRO    06850000
.*       CALL.  THE GLOBAL 'MAX' MUST ESTABLISH THE NUMBER OF ARRAY     06900000
.*       ENTRIES AND EACH ARITHMETIC AND CHARACTER ARRAY MUST HAVE      06950000
.*       THE SAME NUMBER OF ENTRIES SPECIFIED AS 'MAX'.                 07000000
.*                                                                      07050000
.*       THE NUMBER OF TABLE ENTRIES IS DEPENDENT UPON THE INSTALLATION 07100000
.*       BUT THE NUMBER USED HERE SHOULD APPROXIMATE THE ACTUAL ENTRIES 07150000
.*       USED SINCE THE BUFSIZE OR WORK AREAS OF THE ASSEMBLER MUST BE  07200000
.*       LARGE ENOUGH TO HOLD THE ARRAYS.(THE CURRENT MAXIMUM IS 32767  07250000
.*       ENTRIES, SEE USAGE OF GROUP= ABOVE TO MINIMIZE TABLE ENTRIES)  07300000
.*                                                                      07350000
.********************************************************************** 07400000
          AGO  .START                                                   07450000
         TITLE 'DOS/VSE ACCESS CONTROL RESOURCE TABLE -DTSECTAB- OUTER X07500000
               MACRO DEFINITION'                                        07550000
*/*  EJECT                                                              07600000
*/**                                                                    07650000
*/**     MODULE DTSECTAB  REL 1.0 VERSION 00   MARCH  2,1988            07700000
*/**                                                                    07750000
*/**     DOS/VSE SYSTEM ACCESS CONTROL RESOURCE TABLE                   07800000
*/**                                                                    07850000
*/**  FUNCTION                                                          07900000
*/**     THIS MACRO IS PROVIDED TO ESTABLISH THE DOS/VSE ACCESS         07950000
*/**     CONTROL RESOURCE TABLE.  AFTER THE DEFINITIONS ARE MADE AND    08000000
*/**     THE TABLE ASSEMBLED ERROR-FREE, IT MUST BE LINK-EDITED IN BG   08050000
*/**     AS SVA-ELIGIBLE AND AVAILABLE TO THE DOS/VSE ACCESS CONTROL    08100000
*/**     FACILILTY WHICH PERFORMS THE REQUIRED ACCESS VALIDATION        08150000
*/**     PER THE TABLE ENTRIES.                                         08200000
*/**                                                                    08250000
*/**     FOR ICCF USERS TO USE THIS FACILITY, THE ICCF USERS MUST       08300000
*/**     BE DEFINED IN THIS TABLE WITH THE SAME INFORMATION AS          08350000
*/**     GIVEN IN THE ICCF LIBRARY PROFILE ENTIRES, THAT IS, THE        08400000
*/**     SAME USER ID, PASSWORD, ACCESS AND UPDATE LEVELS ALONG         08450000
*/**     WITH IDENTIFYING THE SAME SINGLE SYSTEM ADMINISTRATOR.         08500000
*/**                                                                    08550000
*/**     DOS/VSE ACCESS CONTROL ROUTINES THAT USE THIS TABLE AND ARE    08600000
*/**     DEPENDENT UPON ITS FORMAT ARE THE ACCESS CONTROL SVC           08650000
*/**     APPENDAGE ROUTINE(DTSECSVC) AND THE ACCESS CONTROL BATCH       08700000
*/**     LOGON(DTSLOGON).  THEREFORE, ANY CHANGES THAT AFFECT THE       08750000
*/**     GENERATED TABLE FORMAT MUST ALSO BE MADE TO THE ABOVE          08800000
*/**     MENTIONED MODULES.                                             08850000
*/**                                                                    08900000
*/**     DTSECTAB TYPE=USER|LIB|SUBLIB|MEMBER|FILE                   X  08950000
*/**              NAME=USERNAME|LIBNAME|SUBLIBNAME|MEMBERNAME|       X  09000000
*/**                   FILENAME                                      X  09050000
*/**              <,PASSWRD=PASSWORD>                                X  09100000
*/**              <,ACC=(CLASS, CLASS, ... X ...)>                   X  09150000
*/**              <,AUTH=YES|NO>                                     X  09200000
*/**              <,READDIR=YES|NO>                          @D52SDPPX  09225052
*/**              <,MCONS=YES|NO>                            @D53CDKHX  09237553
*/**              <,UACC=U>                                          X  09250000
*/**              <,RIGHT=BTRANS>                                    X  09300000
*/**              <,LOG=(CLASS,CLASS,...>                            X  09350000
*/**              <,SUBTYPE=INITIAL|FINAL>                              09400000
*/**                                                                    09450000
*/**                                                                    09500000
*/**                                                                    09550000
*/**    TYPE=   INDICATES TYPE OF OBJECT TO BE PROTECTED, EITHER A      09600000
*/**            USER/LIB/SUBLIB/MEMBER/FILE.                            09650000
*/**                                                                    09700000
*/**                                                                    09750000
*/**    NAME= IF TYPE=USER, THEN THE USER NAME IS A 4 TO 8-CHARACTER    09800052
*/**            IDENTIFIER USED TO DO THE 'LOGON' PROCESSING AND        09850000
*/**            CORRESPONDS TO THE USER= GIVEN ON THE JCL // ID         09900000
*/**            STATEMENT.  FOR ICCF, THE USERID AND PASSWORD           09950000
*/**            FOR USERS WHO SUBMIT JOBS TO BATCH MUST ALSO            10000000
*/**            BE DEFINED IN THIS TABLE AND BE THE SAME AS THOSE       10050000
*/**            IN THE USER PROFILE RECORDS IN THE ICCF LIBRARY.        10100000
*/**            DELIMITERS SUCH AS ( ) & AND COMMAS ARE NOT ALLOWED     10150000
*/**            AND WILL RESULT IN ASSEMBLER ERRORS.                    10200000
*/**                                                                    10250000
*/**            IF TYPE=LIB, THEN THE LIBRARY NAME IS THE ***           10300000
*/**                                                                    10350000
*/**            IF TYPE=SUBLIB, THEN THE SUBLIBRARY NAME IS THE ***     10400000
*/**                                                                    10450000
*/**            IF TYPE=MEMBER, THEN THE MEMBER NAME IS THE ***         10500000
*/**                                                                    10550000
*/**            IF TYPE=FILE, THEN THE FILE NAME IS THE ***             10600000
*/**                                                                    10650000
*/**                                                                    10700000
*/**                                                                    10750000
*/**  PASSWRD=  THIS PASSWORD PARAMETER ONLY APPLIES FOR TYPE=USER,     10800000
*/**            AND SPECIFIES A 3-6 CHARACTER PASSWORD WHICH IS         10850000
*/**            ASSOCIATED WITH THE DEFINED USER.  SINCE THIS TABLE     10900000
*/**            EXPANDS INTO ASSEMBLER 'DEFINE CONSTANTS', THE          10950000
*/**            PASSWORDS ARE INITIALLY SCRAMBLED.  THEN THE USER ID    11000000
*/**            AND PASSWORDS ARE ENCODED WHEN THE TABLE IS FIRST       11050000
*/**            ACCESSED VIA A // ID STATEMENT. (SEE NAME=ABOVE FOR     11100000
*/**            USE WITH ICCF.)                                         11150000
*/**            DELIMITERS SUCH AS ( ) & AND COMMAS ARE NOT ALLOWED     11200000
*/**            AND WILL RESULT IN ASSEMBLER ERRORS.                    11250000
*/**                                                                    11300000
*/**                                                                    11350000
*/**     ACC=   DEFINES 1 TO 32 ACCESS CLASSES TO CONTROL               11400000
*/**            ACCESS TO THE FILE, LIBRARY OR PHASE. FOR EXAMPLE,      11450000
*/**            IF ACC=(5,7, 8-10, UPD) IS SPECIFIED, ONLY USERS        11500000
*/**            WHOSE PROFILES ARE DEFINED WITH ACCESS                  11550000
*/**            CLASS 5, 7, OR 8-10 CAN ACCESS THE FILE, LIBRARY        11600000
*/**            OR PHASE AND FOR A FILE, CLASSES 5 AND 7 HAS            11650000
*/**            READ ONLY AUTHORIZATION AND CLASSES 8-10 HAVE           11700000
*/**            READ/WRITE AUTHORIZATION LEVEL.                         11750000
*/**            X MAY BE CON (FOR CONNECT), READ, UPD (FOR UPDATE) OR   11800000
*/**            ALT (FOR ALTER).                                        11850000
*/**            (UPD = UPDATE AUTH LEVEL ONLY APPLIES FOR TYPE=USER)    11900000
*/**                                                                    11950000
*/**                                                                    12000000
*/**    AUTH=   THE AUTHORIZATION PARAMETER IS ONLY ASSOCIATED WITH     12050000
*/**            THE TYPE=USER AND IDENTIFIES THAT USER AS THE SYSTEM    12100000
*/**            ADMINISTRATOR.  THE DEFAULT IS NO AND YES MUST BE       12150000
*/**            SPECIFIED FOR THE SYSTEM ADMINISTRATOR, ONLY ONE SUCH   12200000
*/**            ENTRY ALLOWED PER TABLE GENERATION.  THIS MUST BE THE   12250000
*/**            SAME USER DEFINED AS THE SYSTEM ADMINISTRATOR IN THE    12300000
*/**            ICCF LIBRARY.                                           12350000
*/**                                                                    12400000
*/** READDIR=   REFLECTS THE RIGHT OF A PWS USER TO READ THE            12412552
*/**            DIRECTORY OF LIBRARIES AND ITS SUBLIBRARIES             12425052
*/**            (VIA 'CLICK')                                           12437552
*/**                                                                    12450000
*/** MCONS=     REFLECTS THE RIGHT OF A USER TO OPEN A MASTER CONSOLE   12466653
*/**                                                                    12483253
*/**     LOG=   THE LOGGING OPTIONS ARE SET PER CLASS(SAME AS           12500000
*/**            ACC= ABOVE).  THE ACCESS CLASSES OF THE USER, AND THE   12550000
*/**            THE ACCESS CLASSES IN THE TABLE FOR THE OBJECT AND THE  12600000
*/**            CORRESPONDING LOGGING CLASSES MAKE THIS DETERMINATION,  12650000
*/**                                                                    12700000
*/**                                                                    12750000
*/**     OTHER PARAMETER                                                12800000
*/**                                                                    12850000
*/** SUBTYPE=   THE FIRST MACRO CALL IN THE SOURCE ASSEMBLY JOB         12900000
*/**            STREAM MUST INDICATE INITIAL AS A SUBTYPE AND THE       12950000
*/**            LAST MUST INDICATE FINAL.                               13000000
*/**                                                                    13050000
*/**     THE GENERATION OF THE TABLE IS DONE IN TWO STEPS.  FIRST,      13100000
*/**     ALL THE MACRO CALLS ARE PROCESSED AND THE PARAMETERS PLACED    13150000
*/**     IN ARRAYS.  THE FIRST MACRO CALL MUST CONTAIN THE SUBTYPE=     13200000
*/**     INITIAL AND THE LAST CALL SUBTYPE=FINAL.                       13250000
*/**                                                                    13300000
*/**     THEN THE CALLS ARE SORTED WITHIN THE ARRAYS IN ORDER TO        13350000
*/**     CONSTRUCT THE DOS/VSE ACCESS CONTROL RESURCE TABLE IN BINARY   13400000
*/**     SEQUENCE TO BE ACCESSED BY THE DOS/VSE ACCESS CONTROL SVC      13450000
*/**     APPENDAGE ROUTINE, DTSECSVC.  AFTER THE MACRO CALLS HAVE       13500000
*/**     BEEN ORDERED, THAT IS SORTED WITHIN EACH TYPE, THE INNER       13550000
*/**     MACRO DTSECTIN IS CALLED FOR EACH OUTER DTSECTAB INVOCATION    13600000
*/**     AND THE RESULTANT ACCESS CONTROL RESOURCE TABLE IS ORGANIZED   13650000
*/**     IN THE FOLLOWING WAY FOR ENTRIES PRESENT:                      13700000
*/**                                                                    13750000
*/**       ACCESS CONTROL RESOURCE TABLE                                13800000
*/**          SUB-TABLE FOR USER ENTRIES                                13850000
*/**              SUB-TABLE DESCRIPTOR FOR THE USER ENTRIES             13900000
*/**          SUB-TABLE FOR LIBRARY ENTRIES                             13950000
*/**              SUB-TABLE DESCRIPTOR FOR THE LIBRARY ENTRIES          14000000
*/**          SUB-TABLE FOR SUBLIBRARY ENTRIES                          14050000
*/**              SUB-TABLE DESCRIPTOR FOR THE SUBLIBRARY ENTRIES       14100000
*/**          SUB-TABLE FOR MEMBER ENTRIES                              14150000
*/**              SUB-TABLE DESCRIPTOR FOR THE MEMBER ENTRIES           14200000
*/**          SUB-TABLE FOR FILE ENTRIES                                14250000
*/**              SUB-TABLE DESCRIPTOR FOR THE FILE ENTRIES             14300000
*/**                                                                    14350000
.*/** ENDMODULE DTSECTAB                                                14400000
.*/* EJECT                                                              14450000
.START   ANOP                                                           14500000
.*********************************************************************  14550000
         AIF   ('&SUBTYPE' NE 'INITIAL').SEC00                          14600000
         AIF   (&FINSW EQ 1).SEC07                             @D14CDOW 14650000
         AIF   (&INITSW EQ 1).ERR00                                     14700000
.*********************************************************************  14750000
.*                                                                      14800000
.*       INITIALIZATION                                                 14850000
.*                                                                      14900000
.*********************************************************************  14950000
&MAX     SETA  1001                     **NUMBER OF ARRAY ENTRIES**     15000000
&BLANKS  SETC  '                                             '          15050000
&IX      SETA  1                                                        15100000
&INITSW  SETB  1                                                        15150000
&LOGSW   SETB  0                                               @D14CDOW 15200000
&CHARC   SETC  '-(+$*)/.%#@=ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789<;>?:'  15250000
&CHART   SETC  'IRZ$@6HQY+.5GPX=*4FOW)/3ENV#02DMU-91CLT8SBK(7AJ%:?<;>'  15300000
.*       'CHARC' AND 'CHART' CHANGES MUST BE CO-ORDINATED WITH THE      15350000
.*       'TRTAB' IN THE 'DTSLOGON' ACCESS CONTROL MODULE.               15400000
  MNOTE *,'NO TABLE GENERATION WILL OCCUR IF SUBTYPE=FINAL NOT GIVEN ONX15450000
                LAST MACRO CALL'                                        15500000
.*********************************************************************  15550000
.*                                                                      15600000
.*       DETERMINE THE TYPE OF ENTRY, ASSIGN THE TYPE-CODE WHICH        15650000
.*       DETERMINES THE SORT SEQUENCE, E.G., TYPE=USER IS TYPE-CODE     15700000
.*       'B', AND PLACE IN A BLANKED FIELD FOR SORTING.                 15750000
.*                                                                      15800000
.*********************************************************************  15850000
.SEC00   ANOP                                                           15900000
&COUNT   SETA  &COUNT+1                                                 15950000
         AIF   (&COUNT EQ &MAX).ERR40                                   16000000
         AIF   (&INITSW EQ 1).SEC05                                     16050000
         AIF   (&LOGSW EQ 1).MEXIT                                      16100000
         AGO   .ERR10                                                   16150000
.SEC05   ANOP                                                           16200000
     AIF ('&SUBTYPE' EQ 'FINAL' AND &FINSW EQ 1 AND &LOGSW EQ 0).ERR30 X16250000
                                                               @D14CDOW 16300000
         AIF   (&FINSW NE 1).SEC06                             @D14CDOW 16350000
.SEC07   ANOP                                                  @D14CDOW 16400000
         AIF   (&LOGSW EQ 1).MEXIT                             @D14CDOW 16450000
         AGO   .ERR15                                          @D14CDOW 16500000
.SEC06   ANOP                                                  @D14CDOW 16550000
&T(&IX)  SETC  '&TYPE'                                                  16600000
&NAMEAL  SETA  K'&NAME                                                  16650000
         AIF   ('&TYPE' EQ 'USER').SEC10                       @D14CDOW 16700000
         AIF   ('&TYPE' EQ 'LIB').SEC20                        @D14CDOW 16750000
         AIF   ('&TYPE' EQ 'SUBLIB').SEC30                     @D14CDOW 16800000
         AIF   ('&TYPE' EQ 'MEMBER').SEC40                     @D14CDOW 16850000
         AIF   ('&TYPE' EQ 'FILE').SEC50                       @D14CDOW 16900000
&COUNT   SETA  &COUNT-1                                        @D14CDOW 16950000
  MNOTE 8,'TYPE ''&TYPE'' IS NOT VALID. STATEMENT IGNORED'     @D14CDOW 17000000
&WARNSW  SETB  1                                               @D14CDOW 17050000
         MEXIT                                                 @D14CDOW 17100000
.*********************************************************************  17150000
.*                                                                      17200000
.SEC10   ANOP  TYPE=USER AND PASSWORD CHECKING                 @D14CDOW 17250000
.*                                                                      17300000
.*********************************************************************  17350000
&C(&IX)  SETC  'B'                                             @D14CDOW 17400000
&USERID SETC   '&NAME'                                                  17450000
&NAMEML  SETA  8                                               @D52SDPP 17500052
         AIF   (K'&NAME LT 4).USER00                           @D52SDPP 17550052
         AIF   (K'&NAME LE 8).USER20                           @D52SDPP 17600052
&USERID SETC   '&NAME'(1,8)                                    @D52SDPP 17650052
  MNOTE 4,'USER NAME ''&NAME'' IS TOO LONG, TRUNCATED TO ''&USERID'''   17700000
&WARNSW  SETB  1                                               @D14CDOW 17750000
         AGO   .USER20                                         @D14CDOW 17800000
.USER00  ANOP                                                           17850000
  MNOTE 8,'USER NAME ''&NAME'' IS TOO SHORT. STATEMENT IGNORED'         17900000
&COUNT   SETA  &COUNT-1                                        @D14CDOW 17950000
&WARNSW  SETB  1                                                        18000000
         MEXIT                                                 @D14CDOW 18050000
.USER20  ANOP                                                           18100000
&KPASS   SETA  K'&PASSWRD                                               18150000
         AIF   (K'&PASSWRD EQ 3).USER50                                 18200000
         AIF   (K'&PASSWRD LT 3).USER40                                 18250000
         AIF   (K'&PASSWRD GT 6).USER30                                 18300000
         AGO   .USER50                                                  18350000
.USER30  ANOP                                                           18400000
&KPASS   SETA  6                                               @D14CDOW 18450000
&LCC3    SETC  '&PASSWRD'(1,&KPASS)                                     18500000
  MNOTE 4,'PASSWORD ''&PASSWRD'' IS TOO LONG, TRUNCATED TO ''&LCC3'''   18550000
         AGO   .USER45                                                  18600000
.USER40  ANOP                                                           18650000
  MNOTE 4,'PASSWORD ''&PASSWRD'' IS TOO SHORT, MUST CORRECT FOR // ID SX18700000
               TATEMENT USAGE'                                          18750000
.USER45  ANOP                                                           18800000
&WARNSW  SETB  1                                                        18850000
.USER50  ANOP                                                           18900000
&PASS(1) SETC  ' '                                                      18950000
&PASS(2) SETC  ' '                                                      19000000
&PASS(3) SETC  ' '                                                      19050000
&PASS(4) SETC  ' '                                                      19100000
&PASS(5) SETC  ' '                                                      19150000
&PASS(6) SETC  ' '                                                      19200000
&PASS(7) SETC  ' '                                                      19250000
&PASS(8) SETC  ' '                                                      19300000
&LIX     SETA  1                                                        19350000
&PIX     SETA  1                                                        19400000
&IXNXT   SETA  1                                                        19450000
.USER60  AIF   ('&PASSWRD'(&PIX,1) NE '&CHARC'(&IXNXT,1)).USER75        19500000
         AIF   (&LIX EQ 2).USER65                                       19550000
         AIF   (&LIX EQ 5).USER65                                       19600000
         AGO   .USER70                                                  19650000
.USER65  ANOP                                                           19700000
&LIX     SETA  &LIX+1                                                   19750000
.USER70  ANOP                                                           19800000
&PASS(&LIX) SETC '&CHART'(&IXNXT,1)                                     19850000
&LIX     SETA  &LIX+1                                                   19900000
&PIX     SETA  &PIX+1                                                   19950000
         AGO   .USER90                                                  20000000
.USER75  ANOP                                                           20050000
&IXNXT   SETA  &IXNXT+1                                                 20100000
         AIF   (&IXNXT LT 49).USER100                                   20150000
&LIX     SETA  1                                                        20200000
&PIX     SETA  1                                                        20250000
&PASS(2) SETC  ','                                                      20300000
.USER80  ANOP                                                           20350000
&PASS(&LIX) SETC '&PASSWRD'(&PIX,1)                                     20400000
.USER85  ANOP                                                           20450000
&LIX     SETA  &LIX+1                                                   20500000
         AIF   (&LIX EQ 2).USER85                                       20550000
&PIX     SETA  &PIX+1                                                   20600000
         AIF   (&PIX LT &KPASS+1).USER80                                20650000
         AGO   .USER110                                                 20700000
.USER90  ANOP                                                           20750000
&IXNXT   SETA  1                                                        20800000
.USER100 AIF   (&PIX LT &KPASS+1).USER60                                20850000
&PASS(2) SETC  '&USERID'(2,1)                                           20900000
         AIF   (&KPASS LT 3).USER110                                    20950000
&PASS(5) SETC  '&USERID'(4,1)                                           21000000
.USER110 ANOP                                                           21050000
&N(&IX)  SETC  '&USERID'                                       @D14CDOW 21100000
         AGO   .SEC60                                                   21150000
.*********************************************************************  21200000
.*                                                                      21250000
.SEC20   ANOP  TYPE=LIB                                        @D14CDOW 21300000
.*                                                                      21350000
.*********************************************************************  21400000
&C(&IX)  SETC  'C'            INDICATE LIBRARY                 @D14CDOW 21450000
&LCA1    SETA  0                                               @D14CDOW 21500000
&LCA2    SETA  0                                               @D14CDOW 21550000
&NAMEML  SETA  59                                              @D14CDOW 21600000
         AIF   ('&NAME'(1,1) EQ '''' AND K'&NAME LT 62).LIB10  @D14CDOW 21650000
         AIF   ('&NAME'(1,1) NE '''' AND K'&NAME LT 60).LIB10  @D14CDOW 21700000
.LIB100  ANOP                                                  @D14CDOW 21750000
&COUNT   SETA  &COUNT-1                                        @D14CDOW 21800000
&WARNSW  SETB  1                                               @D14CDOW 21850000
  MNOTE 8,'LIBRARY NAME IS INCORRECT. STATEMENT IGNORED'       @D14CDOW 21900000
         MEXIT                                                 @D14CDOW 21950000
.*       VALIDATE VOLID                                        @D149DOW 22000000
.LIB10   ANOP                                                  @D14CDOW 22050000
         AIF   ('&NAME'(1,1) NE '''').LIB200                   @D14CDOW 22100000
         AIF   ('&NAME'(1,4) NE '''*''.').LIB202               @D14CDOW 22150000
&LCA1    SETA  &LCA1+4                                         @D14CDOW 22200000
         AGO   .LIB08                                          @D14CDOW 22250000
.LIB202  ANOP                                                  @D14CDOW 22300000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 22350000
.LIB201  ANOP                                                  @D14CDOW 22400000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 22450000
         AIF   (&LCA1 GT 8).LIB100                             @D14CDOW 22500000
         AIF   ('&NAME'(&LCA1,1) EQ '.').LIB100                @D14CDOW 22550000
         AIF   ('&NAME'(&LCA1,1) NE '''').LIB201               @D14CDOW 22600000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 22650000
         AIF   ('&NAME'(&LCA1,1) NE '.').LIB100                @D14CDOW 22700000
         AIF   (&LCA1 LT 4).LIB100                             @D14CDOW 22750000
&LCC1    SETC  '&NAME'(2,&LCA1-3)                              @D14CDOW 22800000
&VOLID   SETC  '&LCC1&BLANKS'(1,6)                             @D14CDOW 22850000
         AGO   .LIB21                                          @D14CDOW 22900000
.LIB200  ANOP                                                  @D14CDOW 22950000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 23000000
         AIF   (&LCA1 GT 7).LIB100                             @D14CDOW 23050000
         AIF   ('&NAME'(&LCA1,1) EQ '''').LIB100               @D14CDOW 23100000
         AIF   ('&NAME'(&LCA1,1) NE '.').LIB200                @D14CDOW 23150000
         AIF   (&LCA1 LT 2).LIB100                             @D14CDOW 23200000
&LCC1    SETC  '&NAME'(1,&LCA1-1)                              @D14CDOW 23250000
         AIF   (&LCA1 GT 2).LIB09                              @D14CDOW 23300000
         AIF   ('&NAME'(1,1) NE '*').LIB09A                    @D14CDOW 23350000
.LIB08   ANOP                                                  @D14CDOW 23400000
&VOLID   SETC  '      '                                        @D14CDOW 23450000
         AGO   .LIB21                                          @D14CDOW 23500000
.LIB09   ANOP                                                  @D14CDOW 23550000
         AIF   (&LCA1 EQ 3).LIB11                              @D14CDOW 23600000
         AIF   (&LCA1 EQ 4).LIB12                              @D14CDOW 23650000
         AIF   (&LCA1 EQ 5).LIB13                              @D14CDOW 23700000
         AIF   (&LCA1 EQ 6).LIB14                              @D14CDOW 23750000
         AIF   (&LCA1 EQ 7).LIB15                              @D14CDOW 23800000
.LIB09A  ANOP                                                  @D14CDOW 23850000
&VOLID   SETC  '00000&LCC1'                                    @D14CDOW 23900000
         AGO   .LIB21                                          @D14CDOW 23950000
.LIB11   ANOP                                                  @D14CDOW 24000000
&VOLID   SETC  '0000&LCC1'                                     @D14CDOW 24050000
         AGO   .LIB21                                          @D14CDOW 24100000
.LIB12   ANOP                                                  @D14CDOW 24150000
&VOLID   SETC  '000&LCC1'                                      @D14CDOW 24200000
         AGO   .LIB21                                          @D14CDOW 24250000
.LIB13   ANOP                                                  @D14CDOW 24300000
&VOLID   SETC  '00&LCC1'                                       @D14CDOW 24350000
         AGO   .LIB21                                          @D14CDOW 24400000
.LIB14   ANOP                                                  @D14CDOW 24450000
&VOLID   SETC  '0&LCC1'                                        @D14CDOW 24500000
         AGO   .LIB21                                          @D14CDOW 24550000
.LIB15   ANOP                                                  @D14CDOW 24600000
&VOLID   SETC  '&LCC1'                                         @D14CDOW 24650000
.*       VALIDATE LIBRARY NAME                                 @D149DOW 24700000
         AGO   .LIB21                                          @D14CDOW 24750000
.LIB20   ANOP                                                  @D14CDOW 24800000
&LCA2    SETA  &LCA2+1                                         @D14CDOW 24850000
.LIB21   ANOP                                                  @D14CDOW 24900000
         AIF   (&LCA2 GT 8).LIB100                             @D14CDOW 24950000
         AIF   ('&NAME'(&NAMEAL-&LCA2,1) NE '.').LIB20         @D14CDOW 25000000
         AIF   (&LCA2 EQ 0).LIB100                             @D14CDOW 25050000
         AIF   ('&NAME'(&NAMEAL,1) EQ '*').LIB30               @D14CDOW 25100000
&LCC1    SETC  '&NAME'(&NAMEAL-&LCA2+1,&LCA2)                  @D14CDOW 25150000
&LIBNAME SETC  '&LCC1&BLANKS'(1,7)                             @D14CDOW 25200000
         AGO   .LIB40                                          @D14CDOW 25250000
.LIB30   ANOP                                                  @D14CDOW 25300000
&COUNT   SETA  &COUNT-1                                        @D14CDOW 25350000
&WARNSW  SETB  1                                               @D14CDOW 25400000
 MNOTE 8,'GENERIC LIBRARY NAME NOT ALLOWED. STATEMENT IGNORED' @D14CDOW 25450000
         MEXIT                                                 @D14CDOW 25500000
*&C(&IX)  SETC  'D'            INDICATE GENERIC LIBRARY        @D14CDOW 25550000
*&LCA3    SETA  &LCA2-1                                        @D14CDOW 25600000
*         AIF   (&LCA3 NE 0).LIB35                             @D14CDOW 25650000
*&LIBNAME SETC  '9999999'                                      @D14CDOW 25700000
*         AGO   .LIB36                                         @D14CDOW 25750000
*.LIB35   ANOP                                                 @D14CDOW 25800000
*&LCC1    SETC  '&NAME'(&NAMEAL-&LCA2+1,&LCA2-1)               @D14CDOW 25850000
*&LCC2    SETC  '99999999'                                     @D14CDOW 25900000
*&LIBNAME SETC  '&LCC1&LCC2'(1,7)                              @D14CDOW 25950000
*.LIB36   ANOP                                                 @D14CDOW 26000000
*&M(&IX)  SETC  '&LCA2'        LENGTH OF VALID PART OF GEN NAME@D14CDOW 26050000
.LIB40   ANOP                                                  @D14CDOW 26100000
.*       VALIDATE FILE NAME                                    @D149DOW 26150000
         AIF   (&NAMEAL-&LCA1-&LCA2-1 GT 44).LIB100            @D14CDOW 26200000
         AIF   (&NAMEAL-&LCA1-&LCA2-1 LE 0).LIB100             @D14CDOW 26250000
&LCC1    SETC  '&NAME'(&LCA1+1,&NAMEAL-&LCA1-&LCA2-1)          @D14CDOW 26300000
&FILEID  SETC  '&LCC1&BLANKS'(1,44)                            @D14CDOW 26350000
&N(&IX)  SETC  '&VOLID&FILEID&LIBNAME'                         @D14CDOW 26400000
         AGO   .SEC60                                          @D14CDOW 26450000
.*********************************************************************  26500000
.*                                                                      26550000
.SEC30   ANOP  TYPE=SUBLIB                                     @D14CDOW 26600000
.*                                                                      26650000
.*********************************************************************  26700000
&C(&IX)  SETC  'E'            INDICATE SUBLIBRARY              @D14CDOW 26750000
&LCA1    SETA  0                                               @D14CDOW 26800000
&LCA2    SETA  0                                               @D14CDOW 26850000
&NAMEML  SETA  16                                              @D14CDOW 26900000
         AIF   (K'&NAME LT 17).SLIB10                          @D14CDOW 26950000
.SLIB100 ANOP                                                  @D14CDOW 27000000
&COUNT   SETA  &COUNT-1                                        @D14CDOW 27050000
&WARNSW  SETB  1                                               @D14CDOW 27100000
  MNOTE 8,'SUBLIB NAME IS INCORRECT. STATEMENT IGNORED'        @D14CDOW 27150000
         MEXIT                                                 @D14CDOW 27200000
.*       VALIDATE LIBRARY NAME                                 @D149DOW 27250000
.SLIB10  ANOP                                                  @D14CDOW 27300000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 27350000
         AIF   (&LCA1 GT 8).SLIB100                            @D14CDOW 27400000
         AIF   ('&NAME'(&LCA1,1) NE '.').SLIB10                @D14CDOW 27450000
         AIF   (&LCA1 EQ 1).SLIB100                            @D14CDOW 27500000
&LCC1    SETC  '&NAME'(1,&LCA1-1)                              @D14CDOW 27550000
&LIBNAME SETC  '&LCC1&BLANKS'(1,7)                             @D14CDOW 27600000
.*       VALIDATE SUB-LIBRARY NAME                             @D149DOW 27650000
.SLIB20  ANOP                                                  @D14CDOW 27700000
&LCA2    SETA  &NAMEAL-&LCA1                                   @D14CDOW 27750000
         AIF   (&LCA2 GT 8).SLIB100                            @D14CDOW 27800000
         AIF   (&LCA2 LE 0).SLIB100                            @D14CDOW 27850000
         AIF   ('&NAME'(&NAMEAL,1) EQ '*').SLIB30              @D14CDOW 27900000
&LCC1    SETC  '&NAME'(&NAMEAL-&LCA2+1,&LCA2)                  @D14CDOW 27950000
&SLIBNAM SETC  '&LCC1&BLANKS'(1,8)                             @D14CDOW 28000000
         AGO   .SLIB40                                         @D14CDOW 28050000
.SLIB30  ANOP                                                  @D14CDOW 28100000
&C(&IX)  SETC  'F'            INDICATE GENERIC SUB-LIBRARY     @D14CDOW 28150000
         AIF   (&LCA2 NE 1).SLIB50                             @D14CDOW 28200000
&SLIBNAM SETC  '99999999'                                      @D14CDOW 28250000
         AGO   .SLIB60                                         @D14CDOW 28300000
.SLIB50  ANOP                                                  @D14CDOW 28350000
&LCC1    SETC  '&NAME'(&NAMEAL-&LCA2+1,&LCA2-1)                @D14CDOW 28400000
&LCC2    SETC  '999999999'                                     @D14CDOW 28450000
&SLIBNAM SETC  '&LCC1&LCC2'(1,8)                               @D14CDOW 28500000
.SLIB60  ANOP                                                  @D14CDOW 28550000
&M(&IX)  SETC  '&LCA2'        LENGTH OF VALID PART OF GEN NAME @D14CDOW 28600000
.SLIB40  ANOP                                                  @D14CDOW 28650000
&N(&IX)  SETC  '&LIBNAME&SLIBNAM'                              @D14CDOW 28700000
         AGO   .SEC60                                          @D14CDOW 28750000
.*********************************************************************  28800000
.*                                                                      28850000
.SEC40   ANOP  TYPE=MEMBER                                     @D14CDOW 28900000
.*                                                                      28950000
.*********************************************************************  29000000
&C(&IX)  SETC  'G'            INDICATE MEMBER                  @D14CDOW 29050000
&LCA1    SETA  0                                               @D14CDOW 29100000
&LCA2    SETA  0                                               @D14CDOW 29150000
&NAMEML  SETA  25                                              @D14CDOW 29200000
         AIF   (K'&NAME LT 26).MBER10                          @D14CDOW 29250000
.MBER100 ANOP                                                  @D14CDOW 29300000
&COUNT   SETA  &COUNT-1                                        @D14CDOW 29350000
&WARNSW  SETB  1                                               @D14CDOW 29400000
  MNOTE 8,'MEMBER NAME IS INCORRECT. STATEMENT IGNORED'        @D14CDOW 29450000
         MEXIT                                                 @D14CDOW 29500000
.*       VALIDATE LIBRARY NAME                                 @D149DOW 29550000
.MBER10  ANOP                                                  @D14CDOW 29600000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 29650000
         AIF   (&LCA1 GT 8).MBER100                            @D14CDOW 29700000
         AIF   ('&NAME'(&LCA1,1) NE '.').MBER10                @D14CDOW 29750000
         AIF   (&LCA1 EQ 1).MBER100                            @D14CDOW 29800000
&LCC1    SETC  '&NAME'(1,&LCA1-1)                              @D14CDOW 29850000
&LIBNAME SETC  '&LCC1&BLANKS'(1,7)                             @D14CDOW 29900000
.*       VALIDATE SUB-LIBRARY NAME                             @D149DOW 29950000
.MBER20  ANOP                                                  @D14CDOW 30000000
&LCA2    SETA  &LCA2+1                                         @D14CDOW 30050000
         AIF   (&LCA2 GT 9).MBER100                            @D14CDOW 30100000
         AIF   ('&NAME'(&LCA1+&LCA2,1) NE '.').MBER20          @D14CDOW 30150000
         AIF   (&LCA2 EQ 1).MBER100                            @D14CDOW 30200000
&LCC1    SETC  '&NAME'(&LCA1+1,&LCA2-1)                        @D14CDOW 30250000
&SLIBNAM SETC  '&LCC1&BLANKS'(1,8)                             @D14CDOW 30300000
.*       VALIDATE MEMBER NAME                                  @D149DOW 30350000
         AIF   (&NAMEAL-&LCA1-&LCA2 LE 0).MBER100              @D14CDOW 30400000
         AIF   (&NAMEAL-&LCA1-&LCA2 GT 8).MBER100              @D14CDOW 30450000
         AIF   ('&NAME'(&NAMEAL,1) EQ '*').MBER30              @D14CDOW 30500000
&LCC1    SETC  '&NAME'(&LCA1+&LCA2+1,&NAMEAL-&LCA1-&LCA2)      @D14CDOW 30550000
&MEMBER  SETC  '&LCC1&BLANKS'(1,8)                             @D14CDOW 30600000
         AGO   .MBER40                                         @D14CDOW 30650000
.MBER30  ANOP                                                  @D14CDOW 30700000
&C(&IX)  SETC  'H'            INDICATE GENERIC MEMBER          @D14CDOW 30750000
         AIF   (&NAMEAL-&LCA1-&LCA2 NE 1).MBER50               @D14CDOW 30800000
&MEMBER  SETC  '99999999'                                      @D14CDOW 30850000
         AGO   .MBER60                                         @D14CDOW 30900000
.MBER50  ANOP                                                  @D14CDOW 30950000
&LCC1    SETC  '&NAME'(&LCA1+&LCA2+1,&NAMEAL-&LCA1-&LCA2-1)    @D14CDOW 31000000
&LCC2    SETC  '999999999'                                     @D14CDOW 31050000
&MEMBER  SETC  '&LCC1&LCC2'(1,8)                               @D14CDOW 31100000
.MBER60  ANOP                                                  @D14CDOW 31150000
&M(&IX)  SETC  '&NAMEAL-&LCA1-&LCA2'    VALID PART OF GEN NAME @D14CDOW 31200000
.MBER40  ANOP                                                  @D14CDOW 31250000
&N(&IX)  SETC  '&LIBNAME&SLIBNAM&MEMBER'                       @D14CDOW 31300000
         AGO   .SEC60                                          @D14CDOW 31350000
.*********************************************************************  31400000
.*                                                                      31450000
.SEC50   ANOP  TYPE=FILE                                       @D14CDOW 31500000
.*                                                                      31550000
.*********************************************************************  31600000
&C(&IX)  SETC  'I'            INDICATE FILE                    @D14CDOW 31650000
&LCA1    SETA  0                                               @D14CDOW 31700000
&LCA2    SETA  0                                               @D14CDOW 31750000
&NAMEML  SETA  51                                              @D14CDOW 31800000
         AIF   ('&NAME'(1,1) EQ '''' AND K'&NAME LT 54).FILE10 @D14CDOW 31850000
         AIF   ('&NAME'(1,1) NE '''' AND K'&NAME LT 52).FILE10 @D14CDOW 31900000
.FILE100 ANOP                                                  @D14CDOW 31950000
&COUNT   SETA  &COUNT-1                                        @D14CDOW 32000000
&WARNSW  SETB  1                                               @D14CDOW 32050000
  MNOTE 8,'FILE NAME IS INCORRECT. STATEMENT IGNORED'          @D14CDOW 32100000
         MEXIT                                                 @D14CDOW 32150000
.*       VALIDATE VOLID                                        @D149DOW 32200000
.FILE10  ANOP                                                  @D14CDOW 32250000
         AIF   ('&NAME'(1,1) NE '''').FILE200                  @D14CDOW 32300000
         AIF   ('&NAME'(1,4) NE '''*''.').FILE202              @D14CDOW 32350000
&LCA1    SETA  &LCA1+4                                         @D14CDOW 32400000
         AGO   .FILE08                                         @D14CDOW 32450000
.FILE202 ANOP                                                  @D14CDOW 32500000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 32550000
.FILE201 ANOP                                                  @D14CDOW 32600000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 32650000
         AIF   (&LCA1 GT 8).FILE100                            @D14CDOW 32700000
         AIF   ('&NAME'(&LCA1,1) EQ '.').FILE100               @D14CDOW 32750000
         AIF   ('&NAME'(&LCA1,1) NE '''').FILE201              @D14CDOW 32800000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 32850000
         AIF   ('&NAME'(&LCA1,1) NE '.').FILE100               @D14CDOW 32900000
         AIF   (&LCA1 LT 4).FILE100                            @D14CDOW 32950000
&LCC1    SETC  '&NAME'(2,&LCA1-3)                              @D14CDOW 33000000
&VOLID   SETC  '&LCC1&BLANKS'(1,6)                             @D14CDOW 33050000
         AGO   .FILE16                                         @D14CDOW 33100000
.FILE200 ANOP                                                  @D14CDOW 33150000
&LCA1    SETA  &LCA1+1                                         @D14CDOW 33200000
         AIF   (&LCA1 GT 7).FILE100                            @D14CDOW 33250000
         AIF   ('&NAME'(&LCA1,1) EQ '''').FILE100              @D14CDOW 33300000
         AIF   ('&NAME'(&LCA1,1) NE '.').FILE200               @D14CDOW 33350000
         AIF   (&LCA1 EQ 1).FILE100                            @D14CDOW 33400000
&LCC1    SETC  '&NAME'(1,&LCA1-1)                              @D14CDOW 33450000
         AIF   (&LCA1 GT 2).FILE09                             @D14CDOW 33500000
         AIF   ('&NAME'(1,1) NE '*').FILE09A                   @D14CDOW 33550000
.FILE08  ANOP                                                  @D14CDOW 33600000
&VOLID   SETC  '      '                                        @D14CDOW 33650000
         AGO   .FILE16                                         @D14CDOW 33700000
.FILE09  ANOP                                                  @D14CDOW 33750000
         AIF   (&LCA1 EQ 3).FILE11                             @D14CDOW 33800000
         AIF   (&LCA1 EQ 4).FILE12                             @D14CDOW 33850000
         AIF   (&LCA1 EQ 5).FILE13                             @D14CDOW 33900000
         AIF   (&LCA1 EQ 6).FILE14                             @D14CDOW 33950000
         AIF   (&LCA1 EQ 7).FILE15                             @D14CDOW 34000000
.FILE09A ANOP                                                  @D14CDOW 34050000
&VOLID   SETC  '00000&LCC1'                                    @D14CDOW 34100000
         AGO   .FILE16                                         @D14CDOW 34150000
.FILE11  ANOP                                                  @D14CDOW 34200000
&VOLID   SETC  '0000&LCC1'                                     @D14CDOW 34250000
         AGO   .FILE16                                         @D14CDOW 34300000
.FILE12  ANOP                                                  @D14CDOW 34350000
&VOLID   SETC  '000&LCC1'                                      @D14CDOW 34400000
         AGO   .FILE16                                         @D14CDOW 34450000
.FILE13  ANOP                                                  @D14CDOW 34500000
&VOLID   SETC  '00&LCC1'                                       @D14CDOW 34550000
         AGO   .FILE16                                         @D14CDOW 34600000
.FILE14  ANOP                                                  @D14CDOW 34650000
&VOLID   SETC  '0&LCC1'                                        @D14CDOW 34700000
         AGO   .FILE16                                         @D14CDOW 34750000
.FILE15  ANOP                                                  @D14CDOW 34800000
&VOLID   SETC  '&LCC1'                                         @D14CDOW 34850000
.FILE16  ANOP                                                  @D14CDOW 34900000
.*       VALIDATE FILE-ID                                      @D149DOW 34950000
&LCA2    SETA  &NAMEAL-&LCA1                                   @D14CDOW 35000000
&LCAPSTR SETA  0                                               @DA36582 35050000
         AIF   ('&NAME'(&NAMEAL+1-&LCA2,1) NE '''').FILE17     @DA36582 35100000
         AIF   ('&NAME'(&NAMEAL,1) NE '''').FILE100            @DA36582 35150000
&LCA2    SETA  &LCA2-2                                         @DA36582 35200000
&LCAPSTR SETA  1                                               @DA36582 35250000
.FILE17  ANOP                                                  @DA36582 35300000
         AIF   (&LCA2 GT 44).FILE100                           @D14CDOW 35350000
         AIF   (&LCA2 LE 0).FILE100                            @D14CDOW 35400000
         AIF   ('&NAME'(&NAMEAL-&LCAPSTR,1) EQ '*').FILE20     @DA36582 35450000
&LCC1    SETC  '&NAME'(&NAMEAL-&LCAPSTR+1-&LCA2,&LCA2)         @DA36582 35500000
&FILEID  SETC  '&LCC1&BLANKS'(1,44)                            @D14CDOW 35550000
         AGO   .FILE30                                         @D14CDOW 35600000
.FILE20  ANOP                                                  @D14CDOW 35650000
&C(&IX)  SETC  'J'            INDICATE GENERIC FILE            @D14CDOW 35700000
         AIF   (&LCA2 NE 1).FILE40                             @D14CDOW 35750000
&FILEID  SETC  '99999999999999999999999999999999999999999999'  @D14CDOW 35800000
         AGO   .FILE50                                         @D14CDOW 35850000
.FILE40  ANOP                                                  @D14CDOW 35900000
&LCC1    SETC  '&NAME'(&NAMEAL-&LCAPSTR+1-&LCA2,&LCA2-1)       @DA36582 35950000
&LCC2    SETC  '99999999999999999999999999999999999999999999'  @D14CDOW 36000000
&FILEID  SETC  '&LCC1&LCC2'(1,44)                              @D14CDOW 36050000
.FILE50  ANOP                                                  @D14CDOW 36100000
&M(&IX)  SETC  '&NAMEAL-&LCA1'    VALID PART OF GENERIC NAME   @D14CDOW 36150000
.FILE30  ANOP                                                  @D14CDOW 36200000
&N(&IX)  SETC  '&VOLID&FILEID'                                 @D14CDOW 36250000
         AGO   .SEC60                                          @D14CDOW 36300000
.*********************************************************************  36350000
.*                                                                      36400000
.SEC60   ANOP  SET SOME GLOBALS WITHOUT CHECK                           36450000
.*                                                                      36500000
.*********************************************************************  36550000
&P(&IX)  SETC  '&PASS(1)&PASS(2)&PASS(3)&PASS(4)&PASS(5)&PASS(6)&PASS(7X36600000
               )&PASS(8)'                                               36650000
&A(&IX)  SETC  '&AUTH'                                                  36700000
&B(&IX)  SETC  '&READDIR'                                      @D52SDPP 36725052
&D(&IX)  SETC  '&MCONS'                                        @D53CDKH 36737553
&R(&IX)  SETC  '&RIGHT'                                        @D14CDOW 36750000
&Z(&IX)  SETC  'O'                                             @D14CDOW 36800000
         AIF   (T'&UACC EQ 'O').SEC63                          @D14CDOW 36850000
         AIF   ('&TYPE' NE 'FILE').SEC64                       @DA33619 36900000
  MNOTE 4,'UACC PARAMETER IGNORED FOR TYPE EQ FILE'            @DA33619 36950000
         AGO   .SEC63                                          @D14CDOW 37000000
.SEC64   ANOP                                                  @D14CDOW 37050000
&Z(&IX)  SETC  'A'                                             @D14CDOW 37100000
         AIF   ('&UACC' EQ 'ALTER' OR '&UACC' EQ 'ALT').SEC63  @D14CDOW 37150000
&Z(&IX)  SETC  'U'                                             @D14CDOW 37200000
         AIF   ('&UACC' EQ 'UPDATE' OR '&UACC' EQ 'UPD').SEC63 @D14CDOW 37250000
&Z(&IX)  SETC  'R'                                             @D14CDOW 37300000
         AIF   ('&UACC' EQ 'READ').SEC63                       @D14CDOW 37350000
&Z(&IX)  SETC  'C'                                             @D14CDOW 37400000
         AIF  ('&UACC' EQ 'CONNECT' OR '&UACC' EQ 'CON').SEC63 @D14CDOW 37450000
&Z(&IX)  SETC  'E'                                             @D14CDOW 37500000
.SEC63   ANOP                                                  @D14CDOW 37550000
.*********************************************************************  37600000
.*                                                                      37650000
.*       VALIDATE THE ACCESS CLASS PARAMETER(1-32 CLASSES)              37700000
.*       AND ASSIGN ANY AUTHORIZATION LEVELS                            37750000
.*                                                                      37800000
.*********************************************************************  37850000
&LCA1    SETA  1                                                        37900000
&LCA2    SETA  &LCA1+1                                                  37950000
         AIF   (T'&ACC NE 'O').SS05                            @D14CDOW 38000000
         AIF   ('&AUTH' EQ 'YES').SS90                         @D14CDOW 38050000
         MNOTE *,'NO ACCESS CLASSES SPECIFIED'                 @D14CDOW 38100000
         AGO   .SS90                                           @D14CDOW 38150000
.SS05    ANOP                                                  @D14CDOW 38200000
         AIF   ('&ACC'(1,1) EQ '(').SS30                                38250000
  MNOTE 4,'INVALID ACC=&ACC, ACCESS CLASSES SET TO ZERO'                38300000
&WARNSW  SETB  1                                                        38350000
         AGO   .SS90                                                    38400000
.SS10    ANOP                                                           38450000
  MNOTE 4,'INVALID ACC=&ACC(&LCA2) PARAMETER, IGNORED'                  38500000
&WARNSW  SETB  1                                                        38550000
.SS20    ANOP                                                           38600000
&LCA1    SETA  &LCA1+1                                                  38650000
         AIF   (&LCB1 EQ 0).SS25                                        38700000
&LCA1    SETA  &LCA2+1                                                  38750000
&LCA2    SETA  &LCA1+1                                                  38800000
         AGO   .SS30                                                    38850000
.SS25    ANOP                                                           38900000
&LCA2    SETA  &LCA1+1                                                  38950000
.SS30    AIF   ('&ACC(&LCA1)' EQ '').SS90                               39000000
&LCB1    SETB  0                                               @D14CDOW 39050000
         AIF   ('&TYPE' NE 'USER').SS35                        @D14CDOW 39100000
         AIF   ('&ACC(&LCA2)' NE 'ALT' AND '&ACC(&LCA2)' NE 'UPD' AND 'X39150000
               &ACC(&LCA2)' NE 'READ' AND '&ACC(&LCA2)' NE 'CON').SS60 X39200000
                                                               @D14CDOW 39250000
&LCB1    SETB  1                                               @D14CDOW 39300000
&LCC4    SETC  'ALT'                                           @D14CDOW 39350000
         AIF   ('&ACC(&LCA2)' EQ 'ALT').SS35                   @D14CDOW 39400000
&LCC4    SETC  'UPD'                                           @D14CDOW 39450000
         AIF   ('&ACC(&LCA2)' EQ 'UPD').SS35                   @D14CDOW 39500000
&LCC4    SETC  'CON'                                           @D14CDOW 39550000
         AIF   ('&ACC(&LCA2)' EQ 'CON').SS35                   @D14CDOW 39600000
.SS60    ANOP                                                  @D14CDOW 39650000
&LCC4    SETC  'READ'                                          @D14CDOW 39700000
.SS35    ANOP                                                           39750000
         AIF   (K'&ACC(&LCA1) LT 3).SS80                                39800000
&LCA9    SETA  1                                                        39850000
&LCA3    SETA  K'&ACC(&LCA1)                                            39900000
&LCC1    SETC  '&ACC(&LCA1)'                                            39950000
.SS40    AIF   ('&LCC1'(&LCA9,1) EQ '-').SS50                           40000000
         AIF   (&LCA9 EQ &LCA3).SS80                                    40050000
&LCA9    SETA  &LCA9+1                                                  40100000
         AIF   (&LCA9 GT 3).SS10                               @D14CDOW 40150000
         AGO   .SS40                                                    40200000
.SS50    ANOP                                                           40250000
&LCA6    SETA  &LCA9-1                                                  40300000
&LCA8    SETA  &LCA9+1                                                  40350000
&LCA7    SETA  &LCA3-&LCA9                                              40400000
&LCC2    SETC  '&LCC1'(1,&LCA6)                                         40450000
&LCC3    SETC  '&LCC1'(&LCA8,&LCA7)                                     40500000
         AIF   (&LCC3 LT &LCC2 OR &LCC2 LT 1 OR &LCC3 GT 32).SS10      X40550000
                                                               @D14CDOW 40600000
&LCA4    SETA  &LCC2                                                    40650000
&LCA5    SETA  &LCC3                                                    40700000
.SS70    ANOP                                                           40750000
&ACCTBL(&LCA4) SETB 1                                                   40800000
&AUTTBL(&LCA4) SETC '&LCC4'                                    @D14CDOW 40850000
&LCA4    SETA  &LCA4+1                                                  40900000
         AIF   (&LCA4 LT &LCA5 OR &LCA4 EQ &LCA5).SS70                  40950000
         AGO   .SS20                                                    41000000
.SS80    AIF   (T'&ACC(&LCA1) NE 'N').SS10                              41050000
         AIF   (&ACC(&LCA1) LT 1 OR &ACC(&LCA1) GT 32).SS10             41100000
&LCA3    SETA  &ACC(&LCA1)                                              41150000
&ACCTBL(&LCA3) SETB 1                                                   41200000
&AUTTBL(&LCA3) SETC '&LCC4'                                    @D14CDOW 41250000
         AGO   .SS20                                                    41300000
.SS90    ANOP                                                           41350000
&LIX     SETA  1                                                        41400000
.SS110   ANOP                                                           41450000
&LY(&LIX) SETC '0'                                                      41500000
&LZ1(&LIX) SETC '0'                                            @D14CDOW 41550000
&LZ2(&LIX) SETC '0'                                            @D14CDOW 41600000
&LZ3(&LIX) SETC '0'                                            @D14CDOW 41650000
&LZ4(&LIX) SETC '0'                                            @D14CDOW 41700000
         AIF   (&ACCTBL(&LIX) NE 1).SS250                      @D14CDOW 41750000
&LY(&LIX) SETC '1'                                                      41800000
         AIF   ('&AUTTBL(&LIX)' EQ 'CON').SS240                @D14CDOW 41850000
         AIF   ('&AUTTBL(&LIX)' EQ 'READ').SS230               @D14CDOW 41900000
         AIF   ('&AUTTBL(&LIX)' EQ 'UPD').SS220                @D14CDOW 41950000
&LZ1(&LIX) SETC '1'         ALTER AUTHORITY                    @D14CDOW 42000000
.SS220   ANOP                                                  @D14CDOW 42050000
&LZ2(&LIX) SETC '1'         UPDATE                             @D14CDOW 42100000
.SS230   ANOP                                                  @D14CDOW 42150000
&LZ3(&LIX) SETC '1'         READ                               @D14CDOW 42200000
.SS240   ANOP                                                  @D14CDOW 42250000
&LZ4(&LIX) SETC '1'         CONNECT                            @D14CDOW 42300000
.SS250   ANOP                                                  @D14CDOW 42350000
&LIX     SETA  &LIX+1                                                   42400000
         AIF   (&LIX LT 33).SS110                                       42450000
&LCC2    SETC  '&LY(32)&LY(31)&LY(30)&LY(29)&LY(28)&LY(27)&LY(26)&LY(25X42500000
               )&LY(24)&LY(23)&LY(22)&LY(21)&LY(20)&LY(19)&LY(18)&LY(17X42550000
               )'                                                       42600000
&LCC3    SETC  '&LY(16)&LY(15)&LY(14)&LY(13)&LY(12)&LY(11)&LY(10)&LY(9)X42650000
               &LY(8)&LY(7)&LY(6)&LY(5)&LY(4)&LY(3)&LY(2)&LY(1)'        42700000
&S(&IX)  SETC  '&LCC2&LCC3'                                             42750000
&LCC2    SETC  '&LZ1(32)&LZ1(31)&LZ1(30)&LZ1(29)&LZ1(28)&LZ1(27)&LZ1(26X42800000
               )&LZ1(25)&LZ1(24)&LZ1(23)&LZ1(22)&LZ1(21)&LZ1(20)&LZ1(19X42850000
               )&LZ1(18)&LZ1(17)'                              @D14CDOW 42900000
&LCC3    SETC  '&LZ1(16)&LZ1(15)&LZ1(14)&LZ1(13)&LZ1(12)&LZ1(11)&LZ1(10X42950000
               )&LZ1(9)&LZ1(8)&LZ1(7)&LZ1(6)&LZ1(5)&LZ1(4)&LZ1(3)&LZ1(2X43000000
               )&LZ1(1)'                                       @D14CDOW 43050000
&U1(&IX) SETC  '&LCC2&LCC3'                                    @D14CDOW 43100000
&LCC2    SETC  '&LZ2(32)&LZ2(31)&LZ2(30)&LZ2(29)&LZ2(28)&LZ2(27)&LZ2(26X43150000
               )&LZ2(25)&LZ2(24)&LZ2(23)&LZ2(22)&LZ2(21)&LZ2(20)&LZ2(19X43200000
               )&LZ2(18)&LZ2(17)'                              @D14CDOW 43250000
&LCC3    SETC  '&LZ2(16)&LZ2(15)&LZ2(14)&LZ2(13)&LZ2(12)&LZ2(11)&LZ2(10X43300000
               )&LZ2(9)&LZ2(8)&LZ2(7)&LZ2(6)&LZ2(5)&LZ2(4)&LZ2(3)&LZ2(2X43350000
               )&LZ2(1)'                                       @D14CDOW 43400000
&U2(&IX) SETC  '&LCC2&LCC3'                                    @D14CDOW 43450000
&LCC2    SETC  '&LZ3(32)&LZ3(31)&LZ3(30)&LZ3(29)&LZ3(28)&LZ3(27)&LZ3(26X43500000
               )&LZ3(25)&LZ3(24)&LZ3(23)&LZ3(22)&LZ3(21)&LZ3(20)&LZ3(19X43550000
               )&LZ3(18)&LZ3(17)'                              @D14CDOW 43600000
&LCC3    SETC  '&LZ3(16)&LZ3(15)&LZ3(14)&LZ3(13)&LZ3(12)&LZ3(11)&LZ3(10X43650000
               )&LZ3(9)&LZ3(8)&LZ3(7)&LZ3(6)&LZ3(5)&LZ3(4)&LZ3(3)&LZ3(2X43700000
               )&LZ3(1)'                                       @D14CDOW 43750000
&U3(&IX) SETC  '&LCC2&LCC3'                                    @D14CDOW 43800000
&LCC2    SETC  '&LZ4(32)&LZ4(31)&LZ4(30)&LZ4(29)&LZ4(28)&LZ4(27)&LZ4(26X43850000
               )&LZ4(25)&LZ4(24)&LZ4(23)&LZ4(22)&LZ4(21)&LZ4(20)&LZ4(19X43900000
               )&LZ4(18)&LZ4(17)'                              @D14CDOW 43950000
&LCC3    SETC  '&LZ4(16)&LZ4(15)&LZ4(14)&LZ4(13)&LZ4(12)&LZ4(11)&LZ4(10X44000000
               )&LZ4(9)&LZ4(8)&LZ4(7)&LZ4(6)&LZ4(5)&LZ4(4)&LZ4(3)&LZ4(2X44050000
               )&LZ4(1)'                                       @D14CDOW 44100000
&U4(&IX) SETC  '&LCC2&LCC3'                                    @D14CDOW 44150000
.*********************************************************************  44200000
.*                                                                      44250000
.*       ASSIGN LOGGING CLASSES                                         44300000
.*                                                                      44350000
.*********************************************************************  44400000
&LCA1    SETA  1                                                        44450000
&LCA2    SETA  &LCA1+1                                                  44500000
         AIF   (T'&LOG EQ 'O').AA90                                     44550000
         AIF   ('&TYPE' NE 'USER').AA05                                 44600000
  MNOTE *,'LOG=&LOG INVALID FOR TYPE=USER, IGNORED'                     44650000
         AGO   .AA90                                                    44700000
.AA05    ANOP                                                           44750000
         AIF   ('&LOG'(1,1) EQ '(').AA30                                44800000
  MNOTE 4,'INVALID LOG=&LOG, LOGGING CLASSES SET TO ZERO'               44850000
&WARNSW  SETB  1                                                        44900000
         AGO   .AA90                                                    44950000
.AA10    ANOP                                                           45000000
  MNOTE 4,'INVALID LOG=&LOG(&LCA1) PARAMETER, IGNORED'                  45050000
&WARNSW  SETB  1                                                        45100000
.AA20    ANOP                                                           45150000
&LCA1    SETA  &LCA1+1                                                  45200000
         AIF   (&LCB1 EQ 0).AA25                                        45250000
&LCA1    SETA  &LCA2+1                                                  45300000
&LCA2    SETA  &LCA1+1                                                  45350000
&LCB1    SETB  0                                                        45400000
         AGO   .AA30                                                    45450000
.AA25    ANOP                                                           45500000
&LCA2    SETA  &LCA1+1                                                  45550000
.AA30    AIF   ('&LOG(&LCA1)' EQ '').AA90                               45600000
.AA35    ANOP                                                           45650000
         AIF   (K'&LOG(&LCA1) LT 3).AA80                                45700000
&LCA9    SETA  1                                                        45750000
&LCA3    SETA  K'&LOG(&LCA1)                                            45800000
&LCC1    SETC  '&LOG(&LCA1)'                                            45850000
.AA40    AIF   ('&LCC1'(&LCA9,1) EQ '-').AA50                           45900000
         AIF   (&LCA9 EQ &LCA3).AA80                                    45950000
&LCA9    SETA  &LCA9+1                                                  46000000
         AGO   .AA40                                                    46050000
.AA50    ANOP                                                           46100000
&LCA6    SETA  &LCA9-1                                                  46150000
&LCA8    SETA  &LCA9+1                                                  46200000
&LCA7    SETA  &LCA3-&LCA9                                              46250000
&LCC2    SETC  '&LCC1'(1,&LCA6)                                         46300000
&LCC3    SETC  '&LCC1'(&LCA8,&LCA7)                                     46350000
.AA60    ANOP                                                           46400000
         AIF   (&LCC3 LT &LCC2 OR &LCC2 LT 1 OR &LCC3 GT 32).AA10      X46450000
                                                               @D14CDOW 46500000
&LCA4    SETA  &LCC2                                                    46550000
&LCA5    SETA  &LCC3                                                    46600000
.AA70    ANOP                                                           46650000
&LOGTBL(&LCA4) SETB 1                                                   46700000
&LCA4    SETA  &LCA4+1                                                  46750000
         AIF   (&LCA4 LT &LCA5 OR &LCA4 EQ &LCA5).AA70                  46800000
         AGO   .AA20                                                    46850000
.AA80    AIF   (T'&LOG(&LCA1) NE 'N').AA10                              46900000
         AIF   (&LOG(&LCA1) LT 1 OR &LOG(&LCA1) GT 32).AA10             46950000
&LCA3    SETA  &LOG(&LCA1)                                              47000000
&LOGTBL(&LCA3) SETB 1                                                   47050000
         AGO   .AA20                                                    47100000
.AA90    ANOP                                                           47150000
&LIX     SETA  1                                                        47200000
.AA110   ANOP                                                           47250000
&LY(&LIX) SETC '0'                                                      47300000
         AIF   (&LOGTBL(&LIX) NE 1).AA120                               47350000
&LY(&LIX) SETC '1'                                                      47400000
.AA120   ANOP                                                           47450000
&LIX     SETA  &LIX+1                                                   47500000
         AIF   (&LIX LT 33).AA110                                       47550000
&LCC2    SETC  '&LY(32)&LY(31)&LY(30)&LY(29)&LY(28)&LY(27)&LY(26)&LY(25X47600000
               )&LY(24)&LY(23)&LY(22)&LY(21)&LY(20)&LY(19)&LY(18)&LY(17X47650000
               )'                                                       47700000
&LCC3    SETC  '&LY(16)&LY(15)&LY(14)&LY(13)&LY(12)&LY(11)&LY(10)&LY(9)X47750000
               &LY(8)&LY(7)&LY(6)&LY(5)&LY(4)&LY(3)&LY(2)&LY(1)'        47800000
&L(&IX)  SETC  '&LCC2&LCC3'                                             47850000
&IX      SETA  &IX+1                                                    47900000
         AIF   ('&SUBTYPE' NE 'FINAL').MEXIT                            47950000
         AIF   (&ABSW EQ 1).MEXIT00                                     48000000
&N(&IX)  SETC  'ELBAT FO DNE'                                           48050000
&FINSW   SETB  1                                               @D14CDOW 48100000
.*********************************************************************  48150000
.*                                                                      48200000
.*       END OF PROCESSING UNTIL SUBTYPE=FINAL DETECTED                 48250000
.*                                                                      48300000
.*       THERE IS NO WAY OF DETECTING WHEN THE LAST MACRO CALL          48350000
.*       IS PROCESSED SO IF SUBTYPE=FINAL IS NOT GIVEN, NO TABLE        48400000
.*       GENERATION WILL OCCUR FOR THIS USER ERROR CONDITION.           48450000
.*                                                                      48500000
.*                                                                      48550000
.*       AFTER SUBTYPE=FINAL HAS BEEN DETECTED, THE PROCESSED           48600000
.*       CALLS AND THE ASSOCIATED ARRAYS ARE SORTED BEFORE INVOKING     48650000
.*       THE INNER MACRO TO GENERATE THE ACCESS CONTROL RESOURCE        48700000
.*       TABLE.                                                         48750000
.*                                                                      48800000
.*********************************************************************  48850000
&SUBEND  SETA  &COUNT+1                                                 48900000
&LCC1 SETC '                                                      '    X48950000
                                                               @D14CDOW 49000000
.*                                                                      49050000
.*       SORT ON TYPE CONCATINATED TO NAME FIELD               @D149DOW 49100000
.*                                                                      49150000
.SORT00  ANOP                                                           49200000
&IXCUR   SETA  1                                               @D14CDOW 49250000
&SORTSW  SETB  0                                               @D14CDOW 49300000
.SORT05  ANOP                                                  @D14CDOW 49350000
&IXNXT   SETA  &IXCUR+1                                                 49400000
&FIRST   SETC  '&C(&IXCUR)&N(&IXCUR)&LCC1'(1,57)               @D14CDOW 49450000
&SECOND  SETC  '&C(&IXNXT)&N(&IXNXT)&LCC1'(1,57)               @D14CDOW 49500000
.SORT10  AIF   ('&N(&IXNXT)' EQ 'ELBAT FO DNE').SORT50                  49550000
         ACTR  4096                                                     49600000
         AIF   (&IXNXT EQ &SUBEND).SORT50                               49650000
         AIF   ('&FIRST' LE '&SECOND').SORT40                  @D14CDOW 49700000
&AA      SETC  '&A(&IXCUR)'                                             49750000
&BB      SETC  '&B(&IXCUR)'                                    @D52SDPP 49775052
&DD      SETC  '&D(&IXCUR)'                                    @D53CDKH 49787553
&CC      SETC  '&C(&IXCUR)'                                             49800000
&LL      SETC  '&L(&IXCUR)'                                             49850000
&MM      SETC  '&M(&IXCUR)'                                    @D14CDOW 49900000
&NN      SETC  '&N(&IXCUR)'                                             49950000
&PP      SETC  '&P(&IXCUR)'                                             50000000
&RR      SETC  '&R(&IXCUR)'                                    @D14CDOW 50050000
&SS      SETC  '&S(&IXCUR)'                                             50100000
&TT      SETC  '&T(&IXCUR)'                                             50150000
&UU1     SETC  '&U1(&IXCUR)'                                            50200000
&UU2     SETC  '&U2(&IXCUR)'                                   @D14CDOW 50250000
&UU3     SETC  '&U3(&IXCUR)'                                   @D14CDOW 50300000
&UU4     SETC  '&U4(&IXCUR)'                                   @D14CDOW 50350000
&ZZ      SETC  '&Z(&IXCUR)'                                    @D14CDOW 50400000
&A(&IXCUR) SETC  '&A(&IXNXT)'                                           50450000
&B(&IXCUR) SETC  '&B(&IXNXT)'                                  @D52SDPP 50475052
&D(&IXCUR) SETC  '&D(&IXNXT)'                                  @D53CDKH 50487553
&C(&IXCUR) SETC  '&C(&IXNXT)'                                           50500000
&L(&IXCUR) SETC  '&L(&IXNXT)'                                           50550000
&M(&IXCUR) SETC  '&M(&IXNXT)'                                  @D14CDOW 50600000
&N(&IXCUR) SETC  '&N(&IXNXT)'                                           50650000
&P(&IXCUR) SETC  '&P(&IXNXT)'                                           50700000
&R(&IXCUR) SETC  '&R(&IXNXT)'                                  @D14CDOW 50750000
&S(&IXCUR) SETC  '&S(&IXNXT)'                                           50800000
&T(&IXCUR) SETC  '&T(&IXNXT)'                                           50850000
&U1(&IXCUR) SETC '&U1(&IXNXT)'                                          50900000
&U2(&IXCUR) SETC '&U2(&IXNXT)'                                 @D14CDOW 50950000
&U3(&IXCUR) SETC '&U3(&IXNXT)'                                 @D14CDOW 51000000
&U4(&IXCUR) SETC '&U4(&IXNXT)'                                 @D14CDOW 51050000
&Z(&IXCUR) SETC  '&Z(&IXNXT)'                                  @D14CDOW 51100000
&A(&IXNXT) SETC  '&AA'                                                  51150000
&B(&IXNXT) SETC  '&BB'                                         @D52SDPP 51175052
&D(&IXNXT) SETC  '&DD'                                         @D53CDKH 51187553
&C(&IXNXT) SETC  '&CC'                                                  51200000
&L(&IXNXT) SETC  '&LL'                                                  51250000
&M(&IXNXT) SETC  '&MM'                                         @D14CDOW 51300000
&N(&IXNXT) SETC  '&NN'                                                  51350000
&P(&IXNXT) SETC  '&PP'                                                  51400000
&R(&IXNXT) SETC  '&RR'                                         @D14CDOW 51450000
&S(&IXNXT) SETC  '&SS'                                                  51500000
&T(&IXNXT) SETC  '&TT'                                                  51550000
&U1(&IXNXT) SETC '&UU1'                                                 51600000
&U2(&IXNXT) SETC '&UU2'                                        @D14CDOW 51650000
&U3(&IXNXT) SETC '&UU3'                                        @D14CDOW 51700000
&U4(&IXNXT) SETC '&UU4'                                        @D14CDOW 51750000
&Z(&IXNXT) SETC  '&ZZ'                                         @D14CDOW 51800000
&SORTSW  SETB  1                                                        51850000
.SORT40  ANOP                                                           51900000
&IXCUR   SETA  &IXCUR+1                                                 51950000
         AGO   .SORT05                                         @D14CDOW 52000000
.SORT50  ANOP                                                           52050000
&SUBEND  SETA  &SUBEND-1                                                52100000
         AIF   (&SORTSW NE 0).SORT00                                    52150000
         ACTR  4096                                                     52200000
.*                                                                      52250000
.*       THE OUTER MACRO CALLS AND THEIR CORRESPONDING PARAMETERS       52300000
.*       HAVE BEEN SORTED INTO ORDER SO THAT THE ACTUAL TABLE CAN       52350000
.*       BE GENERATED IN BINARY SEQUENCE BY CALLING THE INNER MACRO     52400000
.*       'DTSECTIN'.                                                    52450000
.*                                                                      52500000
&IX      SETA  1                                                        52550000
&IXCUR   SETA  1                                                        52600000
&IXNXT   SETA  &IXCUR+1                                                 52650000
&GROUPSW SETB  0                                                        52700000
&ENDSW   SETB  0                                                        52750000
.*                                                                      52800000
.*       A VECTOR TABLE IS GENERATED AT THE BEGINNING OF THE RESOURCE   52850000
.*       TABLE THAT POINTS TO ANOTHER SUB-GROUP VECTOR TABLE WHICH      52900000
.*       DESCRIBES THE INDIVIDUALLY GENERATED GROUP ENTRIES.            52950000
.*                                                                      53000000
TAB      TITLE 'DOS/VSE ACCESS CONTROL RESOURCE TABLE '                 53050000
         SPACE 5                                                        53100000
         PUNCH '     PHASE DTSECTAB,*,SVA '                             53150000
         SPACE 5                                                        53200000
*                                                                       53250000
*        ACCESS CONTROL RESOURCE VECTOR TABLE                           53300000
*                                                                       53350000
         SPACE 2                                                        53400000
DTSECTAB CSECT                          RESOURCE TABLE VECTORS          53450000
&OPTT    SETC  '*-*'                                                    53500000
&USET    SETC  '*-*'                                                    53550000
&LIBT    SETC  '*-*'                                                    53600000
&GLIBT   SETC  '*-*'                                           @D14CDOW 53650000
&SLBT    SETC  '*-*'                                           @D14CDOW 53700000
&GSLBT   SETC  '*-*'                                           @D14CDOW 53750000
&MEMT    SETC  '*-*'                                           @D14CDOW 53800000
&GMEMT   SETC  '*-*'                                           @D14CDOW 53850000
&DSNT    SETC  '*-*'                                                    53900000
&GDSNT   SETC  '*-*'                                           @D14CDOW 53950000
.SEC70   AIF   ('&C(&IXCUR)' NE '&C(&IXNXT)').SEC80                     54000000
         AIF   (&GROUPSW EQ 1).SEC440                                   54050000
&I(&IXCUR) SETC  'INITIAL'                                              54100000
&GROUPSW  SETB  1                                                       54150000
         AGO   .SEC440                                                  54200000
.SEC80   ANOP                                                           54250000
         AIF   ('&C(&IXCUR)' EQ 'B').SEC81                     @D14CDOW 54300000
         AIF   ('&C(&IXCUR)' EQ 'C').SEC82                     @D14CDOW 54350000
         AIF   ('&C(&IXCUR)' EQ 'D').SEC83                     @D14CDOW 54400000
         AIF   ('&C(&IXCUR)' EQ 'E').SEC84                     @D14CDOW 54450000
         AIF   ('&C(&IXCUR)' EQ 'F').SEC85                     @D14CDOW 54500000
         AIF   ('&C(&IXCUR)' EQ 'G').SEC86                     @D14CDOW 54550000
         AIF   ('&C(&IXCUR)' EQ 'H').SEC87                     @D14CDOW 54600000
         AIF   ('&C(&IXCUR)' EQ 'I').SEC88                     @D14CDOW 54650000
         AIF   ('&C(&IXCUR)' EQ 'J').SEC89                     @D14CDOW 54700000
&OPTT    SETC  'OPTTAB'                 RESERVED                        54750000
         AGO   .SEC90                                                   54800000
.SEC81   ANOP                                                           54850000
&USET    SETC  'USETAB'       USER SUBTYPE VECTOR                       54900000
         AGO   .SEC90                                                   54950000
.SEC82   ANOP                                                           55000000
&LIBT    SETC  'LIBTAB'       LIBRARY SUBTYPE VECTOR                    55050000
         AGO   .SEC90                                                   55100000
.SEC83   ANOP                                                           55150000
&GLIBT   SETC  'GLIBTAB'      GENERIC LIBRARY SUBTYPE VECTOR   @D14CDOW 55200000
         AGO   .SEC90                                                   55250000
.SEC84   ANOP                                                           55300000
&SLBT    SETC  'SLBTAB'       SUBLIBRARY SUBTYPE VECTOR        @D14CDOW 55350000
         AGO   .SEC90                                                   55400000
.SEC85   ANOP                                                           55450000
&GSLBT   SETC  'GSLBTAB'      GENERIC SUBLIBRARY SUBTYPE VECTOR@D14CDOW 55500000
         AGO   .SEC90                                                   55550000
.SEC86   ANOP                                                           55600000
&MEMT    SETC  'MEMTAB'       MEMBER SUBTYPE VECTOR            @D14CDOW 55650000
         AGO   .SEC90                                                   55700000
.SEC87   ANOP                                                           55750000
&GMEMT   SETC  'GMEMTAB'      GENERIC MEMBER SUBTYPE VECTOR    @D14CDOW 55800000
         AGO   .SEC90                                                   55850000
.SEC88   ANOP                                                           55900000
&DSNT    SETC  'DSNTAB'       FILE SUBTYPE VECTOR                       55950000
         AGO   .SEC90                                                   56000000
.SEC89   ANOP                                                           56050000
&GDSNT   SETC  'GDSNTAB'      GENERIC FILE SUBTYPE VECTOR      @D14CDOW 56100000
.SEC90   ANOP                                                           56150000
&I(&IXCUR) SETC  'FINAL'                                                56200000
&GROUPSW  SETB  0                                                       56250000
.SEC440  AIF   (&ENDSW EQ 1).SEC105                                     56300000
&IXCUR   SETA  &IXCUR+1                                                 56350000
&IXNXT   SETA  &IXCUR+1                                                 56400000
         AIF   ('&N(&IXNXT)' NE 'ELBAT FO DNE').SEC70                   56450000
&ENDSW   SETB  1                                                        56500000
         AGO   .SEC70                                                   56550000
.SEC105  ANOP                                                           56600000
.*       NOTE:  THE DOS/VSE ACCESS CONTROL MODULES DTSLOGON AND         56650000
.*              DTSECSVC, AND THE APTYP OF THE MACRO DTSAPL ARE         56700000
.*              DEPENDENT UPON THE FORMAT OF THE FOLLOWING TABLE        56750000
.*              HEADER.                                                 56800000
         DC    CL8'DTSECTAB'            TABLE IDENTIFIER                56850000
         DC    CL4'0104'                TABLE VERSION          @D14CDOW 56900000
         DC    A(&OPTT)     ***RESERVED***                              56950000
         DC    A(&USET)     USER SUBTYPE VECTOR                         57000000
         DC    A(&LIBT)     LIBRARY SUBTYPE VECTOR                      57050000
         DC    A(&GLIBT)    GENERIC LIBRARY SUBTYPE VECTOR     @D14CDOW 57100000
         DC    A(&SLBT)     SUBLIBRARY SUBTYPE VECTOR          @D14CDOW 57150000
         DC    A(&GSLBT)    GENERIC SUBLIBRARY SUBTYPE VECTOR  @D14CDOW 57200000
         DC    A(&MEMT)     MEMBER SUBTYPE VECTOR              @D14CDOW 57250000
         DC    A(&GMEMT)    GENERIC MEMBER SUBTYPE VECTOR      @D14CDOW 57300000
         DC    A(&DSNT)     FILE SUBTYPE VECTOR                         57350000
         DC    A(&GDSNT)    GENERIC FILE SUBTYPE VECTOR        @D14CDOW 57400000
         DC    A(-1)        END OF VECTOR TABLE                         57450000
.SEC110  ANOP                                                           57500000
         ACTR  4096                                                     57550000
         AIF   ('&NO' NE '&N(&IX)').SEC113                              57600000
         AIF   ('&CO' NE '&C(&IX)').SEC113                              57650000
&LCA1    SETA 1                                                         57700000
&LCC2    SETC ' '                                                       57750000
&NO      SETC '&NO&LCC2'                                                57800000
.SEC111  AIF   ('&NO'(&LCA1,1) EQ ' ').SEC112                           57850000
         AIF   ('&NO'(&LCA1,1) EQ '').SEC112                            57900000
&LCA1    SETA   &LCA1+1                                                 57950000
         AGO   .SEC111                                                  58000000
.SEC112  ANOP                                                           58050000
&LCA1    SETA  &LCA1-1                                                  58100000
&LCC1    SETC  '&NO'(1,&LCA1)                                           58150000
  MNOTE 4,'''&LCC1'' IS A DUPLICATE NAMED RESOURCE TABLE ENTRY'         58200000
  MNOTE 4,'***ONLY THE FIRST ENTRY OF THE DUPLICATE NAMED RESOURCE IS UX58250000
               SED'                                                     58300000
  MNOTE 4,'FOR ACCESS VALIDATION***'                                    58350000
.*                                                                      58400000
.*       LOOP THRU ARRAYS GENERATING TABLE ENTRIES                      58450000
.*                                                                      58500000
.SEC113  ANOP                                                           58550000
&AO      SETC '&A(&IX)'                 SPECIAL AUTHORIZATION           58600000
&BO      SETC '&B(&IX)'                 READDIR RIGHT          @D52SDPP 58625052
&DO      SETC '&D(&IX)'                 MCONS   RIGHT          @D53CDKH 58637553
&CO      SETC '&C(&IX)'                 GROUP SUB-TYPE                  58650000
&IO      SETC '&I(&IX)'                 GROUP SUB-CODE                  58700000
&XLOG    SETC '&L(&IX)'                 LOGGING OPTIONS                 58750000
&NO      SETC '&N(&IX)'                 NAME                            58800000
&PO      SETC '&P(&IX)'                 PASSWORD                        58850000
&XRIGHT  SETC '&R(&IX)'                 RIGHT                  @D14CDOW 58900000
&XGLEN   SETC '&M(&IX)'                 LENGTH OF GENERIC NAME @D14CDOW 58950000
&ZO      SETC '&Z(&IX)'                 UNIVERSAL ACCESS RIGHT @D14CDOW 59000000
&XACC    SETC '&S(&IX)'                 ACCESS CLASSES                  59050000
&TO      SETC '&T(&IX)'                 TYPE                            59100000
&XALT    SETC '&U1(&IX)'                ALTER AUTHORIZATION    @D14CDOW 59150000
&XUPD    SETC '&U2(&IX)'                UPDATE AUTHORIZATION            59200000
&XREAD   SETC '&U3(&IX)'                READ AUTHORIZATION     @D14CDOW 59250000
&XCON    SETC '&U4(&IX)'                CONNECT AUTHORIZATION  @D14CDOW 59300000
         DTSECTIN XAUTH=&AO,XIND=&CO,XNAME=&NO,XPASS=&PO,XSUB=&IO,     X59350000
               XTYPE=&TO,XUACC=&ZO,XREADD=&BO,XCONS=&DO        @D53CDKH 59400053
.SEC117  ANOP                                                           59450000
&IX      SETA  &IX+1                                                    59500000
         AIF    ('&N(&IX)' NE 'ELBAT FO DNE').SEC110                    59550000
         AGO   .MEXIT00                                                 59600000
.*                                                                      59650000
.*       DTSECTAB ERROR EXITS                                           59700000
.*                                                                      59750000
.ERR00   ANOP                                                           59800000
  MNOTE 4,'MORE THAN ONE SUBTYPE=INITIAL SPECIFIED'                     59850000
         AGO   .ERR99                                                   59900000
.ERR10   ANOP                                                           59950000
  MNOTE 12,'NO TABLE EXPANSION, SUBTYPE=INITIAL NOT SPECIFIED'          60000000
&LOGSW   SETB  1                                                        60050000
         AGO   .ERR99                                                   60100000
.ERR15   ANOP                                                 @D14CDOW  60150000
  MNOTE 4,'DTSECTAB MAC DEFINITION AFTER TYPE=FINAL DETECTED' @D14CDOW  60200000
&LOGSW   SETB  1                                              @D14CDOW  60250000
         AGO   .MEXIT10                                       @D14CDOW  60300000
.ERR20   ANOP                                                           60350000
  MNOTE 4,'SUBTYPE=FINAL WITHOUT SUBTYPE=INITIAL'                       60400000
         AGO  .ERR99                                                    60450000
.ERR30   ANOP                                                           60500000
  MNOTE 4,'MORE THAN ONE SUBTYPE=FINAL SPECIFIED'                       60550000
&LOGSW   SETB  1                                              @D14CDOW  60600000
         AGO  .MEXIT10                                        @D14CDOW  60650000
.ERR40   ANOP                                                           60700000
  MNOTE 4,'ARRAY OVERFLOW, MAXIMUM TABLE SOURCE STATEMENTS ALLOWED IS &X60750000
               MAX'                                                     60800000
  MNOTE 4,'CONTACT SYSTEM ADMINISTRATOR TO UPDATE DTSECTAB MAC SOURCE'  60850000
.ERR99   ANOP                                                           60900000
&ABSW    SETB  1                                                        60950000
         MEXIT                                                          61000000
.*                                                                      61050000
.*       DTSECTAB GENERAL EXIT                                          61100000
.*                                                                      61150000
.MEXIT00 ANOP                                                           61200000
         SPACE 5                                                        61250000
         AIF   (&ABSW EQ 0 AND &WARNSW EQ 0).MEXIT                      61300000
         AIF   (&ABSW EQ 0).MEXIT10                                     61350000
.MEXIT05 ANOP                                                           61400000
  MNOTE 12,'***ERROR*** TABLE EXPANSION UNUSABLE, SEE MNOTES ABOVE'     61450000
         MEXIT                                                          61500000
.MEXIT10 ANOP                                                           61550000
  MNOTE 8,'*WARNING* TABLE EXPANSION MAY BE UNUSABLE, SEE MNOTES ABOVE' 61600000
.MEXIT   MEXIT                                                          61650000
         MEND                                                           61700000
