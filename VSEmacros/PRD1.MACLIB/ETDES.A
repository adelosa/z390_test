*  /* START OF SPECIFICATIONS ***************************************** 00050000
*                                                                     * 00100000
*01*  MODULE-NAME = ETDES                                             * 00150000
*                                                                     * 00200000
*01*  MACDATE = 93.170                                                * 00250000
*                                                                     * 00300000
*01*  DESCRIPTIVE-NAME = ENTRY TABLE DESTROY MACRO                    * 00350000
*                                                                     * 00400000
*01*  COPYRIGHT =                                                     * 00450000
*            5655-068                                                 * 00500000
*            THIS MODULE IS "RESTRICTED MATERIALS OF IBM"             * 00550000
*            (C)COPYRIGHT IBM CORP. 1980, 1993                        * 00600000
*            LICENSED MATERIALS - PROPERTY OF IBM                     * 00650000
*                                                                     * 00700000
*01*  STATUS = HBB5510                                            @P1C* 00750000
*                                                                     * 00800000
*                                                                     * 00850000
*01*  FUNCTION = INTERFACE TO THE ETDES SERVICE                       * 00900000
*                                                                     * 00950000
*01*  NOTES = THE 'PURGE' PARAMETER DEFAULTS TO 'NO' ONLY FOR         * 01000000
*             STANDARD OR LIST FORMS OF THE MACRO OR,IN PL/S,         * 01050000
*             FOR MODIFY OR EXECUTE FORMS SPECIFYING 'COMPLETE'.      * 01100000
*                                                                     * 01150000
*01*  MODULE-TYPE = MACRO                                             * 01200000
*                                                                     * 01250000
*01*  PROCESSOR = ASSEMBLER,PL/S-III (BILINGUAL)              @ZM50111* 01300000
*                                                                     * 01350000
*01*  MACROS = IHBERMAC,AHAETDES                                      * 01400000
*                                                                     * 01450000
*01*  CHANGE ACTIVITY =       NEW FOR OS/VS2 JBB1226.                 * 01500000
*                             UPDATE BOTH BAL AND PL/S MACDATE        * 01550000
*                             WHENEVER THIS MACRO IS CHANGED.         * 01600000
*                             THE S/D CODE IS @G387PXX.               * 01650000
*             VS50111 - (PL/S) FORCE RC=12 ON NULL TOKEN(1).  @ZM50111* 01700000
*             PBB0031 - (PL/S) PTR NOTATION CHECKS INVALID.   @ZMB0031* 01750000
*             PBB0086 - (BAL) INCORRECT PC INSTRUCTIONS.      @ZMB0086* 01800000
*            @ZA76312 - INCORRECT EXPANSION OF MACRO WHEN             * 01850000
*                       TOKEN AND MF=(E,___) REQUESTED        @ZA76312* 01900000
*           $P1=PIG1968,HBB5510,930616,PDXB: Savearea                 * 01950000
*                                                                     * 02000000
*01*  MNOTES = IHB001 TOKEN OPERAND REQUIRED, NOT SPECIFIED           * 02050000
*              IHB002 INVALID PURGE OPERAND - ___                     * 02100000
*              IHB002 INVALID TOKEN OPERAND - ___                     * 02150000
*              IHB002 INVALID MF OPERAND - ___                        * 02200000
*              IHB027 EXCESSIVE POSITIONAL PARAMETERS SPECIFIED       * 02250000
*              IHB280 REG FORM LIST ADDRESS INVALID WITH MF=L         * 02300000
*                                                                     * 02350000
*01*  PL/S MSGS = AS FOLLOWS:                                         * 02400000
*     AHA0013 MF(2) (LISTNAME) IS REQUIRED BUT IS NOT SUPPLIED.       * 02450000
*             NO TEXT IS GENERATED.                                   * 02500000
*     AHA0013 TOKEN(1) (LIST ADDR) IS REQUIRED BUT IS NOT SPECIFIED. *  02550000
*             NO TEXT IS GENERATED.                                   * 02600000
*     AHA0013 TOKEN IS REQUIRED FOR STANDARD FORM BUT IS NOT          * 02650000
*             SPECIFIED. NO TEXT IS GENERATED.                        * 02700000
*     AHA0023 BASED FORM TOKEN ADDRESS '_' INVALID WITH MF(L).        * 02750000
*             NO TEXT IS GENERATED.                                   * 02800000
*     AHA0023 POINTER FORM TOKEN ADDRESS '_' INVALID WITH MF(L).      * 02850000
*             NO TEXT IS GENERATED.                                   * 02900000
*     AHA0023 'COMPLETE' IS INVALID WITH MF(L). NO TEXT IS GENERATED. * 02950000
*     AHA0033 MF - '_' - HAS TOO MANY ARGUMENTS. NO TEXT IS GENERATED.* 03000000
*     AHA0033 TOKEN - '_' - HAS TOO MANY ARGUMENTS.                   * 03050000
*             NO TEXT IS GENERATED.                                   * 03100000
*     AHA0033 PURGE - '_' - HAS TOO MANY ARGUMENTS.                   * 03150000
*             NO TEXT IS GENERATED.                                   * 03200000
*     AHA0043 MF(1) MUST BE 'L,E OR M'. NO TEXT IS GENERATED.         * 03250000
*     AHA0043 MF(3) MUST BE 'COMPLETE' WITH MF(E) OR MF(M).           * 03300000
*             NO TEXT IS GENERATED.                                   * 03350000
*     AHA0043 PURGE MUST BE 'YES' OR 'NO'. NO TEXT IS GENERATED.      * 03400000
*     AHA0053 THE MACLIST '_' IS NOT ALLOWED. NO TEXT IS GENERATED.   * 03450000
*                                                                     * 03500000
*A000000-999999                                                @G387PXX 03550000
***** END OF SPECIFICATIONS ******************************************* 03600000
         MACRO                                                          03650000
&LABL    ETDES &TOKEN=,    REQUIRED RX OR REG FORM LIST ADDR   (INPUT) X03700000
               &PURGE=,    OPTIONAL, MUST BE 'YES' OR 'NO'     (INPUT) X03750000
               &MF=,       OPTIONAL MACRO FORM (DEFAULTS TO STANDARD)  X03800000
               &RELATED=   OPTIONAL VALUE FOR DOCUMENTATION             03850000
.*                                                                      03900000
.********************************************************************** 03950000
.*       DECLARE ARITHMETIC VARIABLES                                 * 04000000
.********************************************************************** 04050000
         LCLA  &A          GENERAL USAGE LOCAL ARITH. VAR.              04100000
         LCLA  &OPTNI      MASK FOR NI OF OPTIONS BYTE                  04150000
         LCLA  &OPTOI      MASK FOR OI OF OPTIONS BYTE                  04200000
.********************************************************************** 04250000
.*       DECLARE BIT VARIABLES                                        * 04300000
.********************************************************************** 04350000
         LCLB  &B(8)       OPTIONS BITS                                 04400000
         LCLB  &N(8)       NI MASK BITS                                 04450000
         LCLB  &O(8)       OI MASK BITS                                 04500000
         LCLB  &S(9)       OPTIONS SPECIFIED BITS                       04550000
.********************************************************************** 04600000
.*       DECLARE CHARACTER VARIABLES                                  * 04650000
.********************************************************************** 04700000
         LCLC  &BOPTS      OPTIONS BYTE INIT STRING FOR STD. FORM       04750000
         LCLC  &EPLV       HOLDS E-FORM PARMADDR FOR USE IN LA/R INST.  04800000
         LCLC  &GNAME1     LABEL FOR STANDARD FORM                      04850000
         LCLC  &GNAMEL     LABEL FOR STANDARD FORM                      04900000
         LCLC  &LT1        LOAD TYPE 1 - THIS VARIABLE WILL BE:         04950000
.*                              'R' IF TOKEN IS A REG TYPE ADDR         05000000
.*                           OR 'A' IF TOKEN IS AN RX TYPE ADDR         05050000
         LCLC  &LT2        LOAD TYPE 2 - THIS VARIABLE WILL BE:         05100000
.*                              'R' IF E-FORM PARM IS A REG TYPE ADDR   05150000
.*                           OR 'A' IF E-FORM PARM IS AN RX TYPE ADDR   05200000
         LCLC  &TOKV       HOLDS VALUE OF TOKEN FOR USE IN LA/R INST.   05250000
         LCLC  &OPERAND    HOLDS OPERAND STRINGS FOR MNOTES             05300000
         LCLC  &OPVAL      HOLDS OPERAND VALUES FOR MNOTES              05350000
         LCLC  &P1         CHAR VARIABLE FOR 'SYSTEM' PARM              05400000
.********************************************************************** 05450000
.*       INITIALIZE ARITHMETIC VARIABLES                              * 05500000
.********************************************************************** 05550000
&OPTNI   SETA  255      INIT TO TURN OFF NO OPTIONS                     05600000
&OPTOI   SETA  0        INIT TO TURN ON NO OPTIONS                      05650000
.********************************************************************** 05700000
.*       INITIALIZE BIT VARIABLES                                     * 05750000
.********************************************************************** 05800000
&B(1)    SETB  0   SHOW PURGE=NO                                        05850000
&B(2)    SETB  0        RESERVED BIT- MUST BE ZERO                      05900000
&B(3)    SETB  0        RESERVED BIT- MUST BE ZERO                      05950000
&B(4)    SETB  0        RESERVED BIT- MUST BE ZERO                      06000000
&B(5)    SETB  0        RESERVED BIT- MUST BE ZERO                      06050000
&B(6)    SETB  0        RESERVED BIT- MUST BE ZERO                      06100000
&B(7)    SETB  0        RESERVED BIT- MUST BE ZERO                      06150000
&B(8)    SETB  0        RESERVED BIT- MUST BE ZERO                      06200000
.* IF AN NI-MASK BIT IS SET TO ZERO, THE NI WILL TURN OFF THE OPTION    06250000
&N(1)    SETB  1   NI-MASK BIT TO TURN OFF 'PURGE' OPTION               06300000
&N(2)    SETB  1        RESERVED BIT- MUST BE ONE                       06350000
&N(3)    SETB  1        RESERVED BIT- MUST BE ONE                       06400000
&N(4)    SETB  1        RESERVED BIT- MUST BE ONE                       06450000
&N(5)    SETB  1        RESERVED BIT- MUST BE ONE                       06500000
&N(6)    SETB  1        RESERVED BIT- MUST BE ONE                       06550000
&N(7)    SETB  1        RESERVED BIT- MUST BE ONE                       06600000
&N(8)    SETB  1        RESERVED BIT- MUST BE ONE                       06650000
.* IF AN OI-MASK BIT IS SET TO ONE, THE OI WILL TURN ON THE OPTION      06700000
&O(1)    SETB  0   OI-MASK BIT TO TURN ON 'PURGE' OPTION                06750000
&O(2)    SETB  0        RESERVED BIT- MUST BE ZERO                      06800000
&O(3)    SETB  0        RESERVED BIT- MUST BE ZERO                      06850000
&O(4)    SETB  0        RESERVED BIT- MUST BE ZERO                      06900000
&O(5)    SETB  0        RESERVED BIT- MUST BE ZERO                      06950000
&O(6)    SETB  0        RESERVED BIT- MUST BE ZERO                      07000000
&O(7)    SETB  0        RESERVED BIT- MUST BE ZERO                      07050000
&O(8)    SETB  0        RESERVED BIT- MUST BE ZERO                      07100000
.*       AN 'S' BIT ON MEANS THE PARM WAS SPECIFIED                     07150000
&S(1)    SETB  0   SHOW PURGE NOT SPECIFIED                             07200000
&S(2)    SETB  0        RESERVED BIT- MUST BE ZERO                      07250000
&S(3)    SETB  0        RESERVED BIT- MUST BE ZERO                      07300000
&S(4)    SETB  0        RESERVED BIT- MUST BE ZERO                      07350000
&S(5)    SETB  0        RESERVED BIT- MUST BE ZERO                      07400000
&S(6)    SETB  0        RESERVED BIT- MUST BE ZERO                      07450000
&S(7)    SETB  0        RESERVED BIT- MUST BE ZERO                      07500000
&S(8)    SETB  0        RESERVED BIT- MUST BE ZERO                      07550000
&S(9)    SETB  0   SHOW TOKEN NOT SPECIFIED                             07600000
.*                                                                      07650000
.********************************************************************** 07700000
.*       PUT OUT BAL MACDATE COMMENT LINE REGARDLESS OF ERRORS.       * 07750000
.********************************************************************** 07800000
*              MACDATE = 80.122                                         07850000
.********************************************************************** 07900000
.*       CHECK FOR EXTRANEOUS POSITIONAL PARMS                        * 07950000
.********************************************************************** 08000000
         AIF   (N'&SYSLIST NE 0).ERR027                                 08050000
.********************************************************************** 08100000
.*       VALIDATE TOKEN PARAMETER IF PRESENT                          * 08150000
.********************************************************************** 08200000
&S(9)    SETB  (T'&TOKEN NE 'O')        IF OPTION SPECIFIED SET BIT     08250000
         AIF   (T'&TOKEN EQ 'O').OK20   IF NOT, GO CHECK PURGE PARM     08300000
&OPERAND SETC  'TOKEN'                  SET FOR POSSIBLE ERROR MSGS     08350000
&OPVAL   SETC  '&TOKEN'                 SET FOR POSSIBLE ERROR MSGS     08400000
.*   DETERMINE WHETHER TOKEN ADDRESS IS RX OR REG TYPE                  08450000
         AIF   ('&TOKEN'(1,1) EQ '(').OK11    BRANCH IF REG TYPE        08500000
&TOKV    SETC  '&TOKEN'                 SET VALUE FOR USE IN LOAD INST. 08550000
&LT1     SETC  'A'                      SET TO 'LA' FOR RX TYPE ADDR    08600000
         AGO   .OK20                    GO CHECK PURGE PARAMETER        08650000
.OK11    ANOP                                                           08700000
&LT1     SETC  'R'                      SET TO 'LR' FOR REG TYPE ADDR   08750000
&TOKV    SETC  '&TOKEN(1)'              EXTRACT REGISTER NAME           08800000
         AIF   (N'&TOKEN NE 1).ERR002   BR IF INVALID REG FORM          08850000
.********************************************************************** 08900000
.*       VALIDATE PURGE PARAMETER IF PRESENT                          * 08950000
.********************************************************************** 09000000
.OK20    ANOP                                                           09050000
&S(1)    SETB  (T'&PURGE NE 'O')        SET OPTION SPECIFIED BIT        09100000
         AIF   (T'&PURGE EQ 'O').OK21                                   09150000
&OPERAND SETC  'PURGE'                                                  09200000
&OPVAL   SETC  '&PURGE'                                                 09250000
         AIF   ('&PURGE' NE 'YES' AND '&PURGE' NE 'NO').ERR002          09300000
&P1      SETC  '&PURGE'                                                 09350000
         AGO   .OK99                                                    09400000
.OK21    ANOP  DEFAULT TO PURGE=NO IF PURGE NOT SPECIFIED               09450000
.*             UNLESS IT IS THE EXECUTE FORM                            09500000
&P1      SETC  'NO'                                                     09550000
.OK99    ANOP                                                           09600000
.********************************************************************** 09650000
.* MAP OPTIONS BITS INTO OPTIONS BYTE                                   09700000
.********************************************************************** 09750000
&B(1)    SETB  ('&P1' EQ 'YES')                                         09800000
&BOPTS   SETC  '&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)'               09850000
.MAP1    AIF   (&S(1) NE 1).MAP2        IF S(1)-PURGE WAS NOT SET       09900000
         AIF   (&B(1) EQ 1).MAP1S       IF PURGE=YES WAS SPECIFIED      09950000
.*                                      PURGE=NO   WAS SPECIFIED        10000000
&N(1)    SETB  0                        ENABLE EXECUTE FORM TO CLR BIT  10050000
         AGO   .MAP2                                                    10100000
.MAP1S   ANOP                                                           10150000
&O(1)    SETB  1                        ENABLE EXECUTE FORM TO SET BIT  10200000
.MAP2    ANOP                                                           10250000
&OPTNI   SETA  128*&N(1)+64*&N(2)+32*&N(3)+16*&N(4)+8*&N(5)+4*&N(6)+2*&X10300000
               N(7)+&N(8)               OPTIONS NI MASK VALUE           10350000
&OPTOI   SETA  128*&O(1)+64*&O(2)+32*&O(3)+16*&O(4)+8*&O(5)+4*&O(6)+2*&X10400000
               O(7)+&O(8)               OPTIONS OI MASK VALUE           10450000
.********************************************************************** 10500000
.*       DETERMINE TYPE OF REQUEST                                    * 10550000
.********************************************************************** 10600000
         AIF   (T'&MF NE 'O').CKMF2     MF OMITTED = STANDARD FORM      10650000
.********************************************************************** 10700000
.*       STANDARD FORM SPECIFIED                                      * 10750000
.********************************************************************** 10800000
&OPERAND SETC  'TOKEN'                                                  10850000
         AIF   ('&TOKV' EQ '').ERR001   REQUIRED OPERAND NOT SPECIFIED  10900000
.* GENERATE STANDARD FORM                                               10950000
&GNAME1  SETC  'IHB'.'&SYSNDX'.'1'                                      11000000
&GNAMEL  SETC  'IHB'.'&SYSNDX'.'L'                                      11050000
&LABL    DC    0H'0'                .ETDES XM SERVICE PC                11100000
         STM   14,12,12(13)         .SAVE CALLER'S REGS                 11150000
         AIF   ('&LT1' EQ 'R').SF10     BR IF TOKEN WAS REG FORM        11200000
         LA    2,&TOKV              .GET ADDR OF TOKEN                  11250000
         ST    2,&GNAME1            .STORE TOKEN ADDR IN PARM LIST      11300000
         AGO   .SF12                                                    11350000
.SF10    ST    &TOKV,&GNAME1        .STORE TOKEN ADDR IN PARM LIST      11400000
.SF12    ANOP                                                           11450000
         CNOP  0,4                  .PURGE PARM LIST TO WORD BOUNDARY   11500000
         LA    1,*+8                .POINT REG1 TO PARM LIST            11550000
         B     &GNAMEL              .BRANCH AROUND PARM LIST            11600000
         DC    XL1'00'              .FORMAT BYTE                        11650000
         DC    BL1'&BOPTS'          .OPTIONS BYTE                       11700000
         DC    AL2(0)               .RESERVED                           11750000
&GNAME1  DC    A(0)                 .TOKEN ADDRESS                      11800000
&GNAMEL  ESAR  2                    .EXTRACT SASID                      11850000
         ST    2,16(,13)            .SAVE SASID IN REG 15 SLOT          11900000
         L     2,16(0,0)            .GET ADDR OF CVT                    11950000
         L     2,772(,2)            .GET ADDR OF SYSTEM FUNCTION TABLE  12000000
         L     2,12(,2)             .GET LX/EX FOR ETDES                12050000
         PC    0(2)                 .PC TO ETDES SERVICE                12100000
         L     2,16(,13)            .EXTRACT SAVED SASID                12150000
         SSAR  2                    .RESTORE SASID                      12200000
         LM    2,12,28(13)          .RESTORE REGS 2-12                  12250000
         L     14,12(,13)           .RESTORE REG 14                     12300000
         MEXIT                                                          12350000
.********************************************************************** 12400000
.CKMF2   ANOP                                                           12450000
&OPERAND SETC  'MF'                     SET FOR POSSIBLE ERROR MSGS     12500000
&OPVAL   SETC  '&MF'                                                    12550000
         AIF   ('&MF' NE 'L').CKMF3     IF NOT LIST FORM CK FOR EXECUTE 12600000
.********************************************************************** 12650000
.*                                                                      12700000
.********************************************************************** 12750000
.*       LIST FORM SPECIFIED                                          * 12800000
.********************************************************************** 12850000
&OPERAND SETC  'REG FORM TOKEN ADDRESS'                                 12900000
&OPVAL   SETC  'MF=L'                                                   12950000
         AIF   ('&LT1' EQ 'R').ERR280   &OPERAND INVALID WITH &OPVAL    13000000
&LABL    DC    0F'0'                .ETDES PC PARAMETER LIST            13050000
         DC    XL1'00'              .FORMAT BYTE                        13100000
         DC    BL1'&BOPTS'          .OPTIONS FLAG BYTE                  13150000
         DC    AL2(0)               .RESERVED                           13200000
         AIF   ('&TOKV' NE '').LF10     BR IF TOKEN WAS SPECIFIED       13250000
&TOKV    SETC  '0'                      DEFAULT TO ZERO                 13300000
.LF10    ANOP                                                           13350000
         DC    A(&TOKV)             .TOKEN ADDRESS                      13400000
         MEXIT                                                          13450000
.********************************************************************** 13500000
.*       EXECUTE FORM SPECIFIED                                       * 13550000
.********************************************************************** 13600000
.CKMF3   AIF   ('&MF(1)' NE 'E').ERR002 INVALID MF PARAMETER            13650000
         AIF   ('&MF(2)' EQ '').ERR002  MUST BE (E,PLIST ADDR)          13700000
.* DETERMINE WHETHER PARMLIST ADDRESS IS RX OR REG TYPE                 13750000
         AIF   ('&MF(2)'(1,1) EQ '(').EXREG      BRANCH IF REG TYPE     13800000
&EPLV    SETC  '&MF(2)'                 SET VALUE FOR USE IN LOAD INST. 13850000
&LT2     SETC  'A'                      SET TO 'LA' FOR RX TYPE ADDR    13900000
         AGO   .ETXT1                   GO GENERATE EXECUTE FORM TEXT   13950000
.EXREG   ANOP                                                           14000000
&LT2     SETC  'R'                      SET TO 'LR' FOR REG TYPE ADDR   14050000
&EPLV    SETC  '&MF(2)'(2,K'&MF(2)-2)   EXTRACT REGISTER NAME           14100000
.ETXT1   ANOP                           GENERATE EXECUTE FORM TEXT      14150000
&LABL    DC    0H'0'                .ETDES XM SERVICE PC                14200000
         STM   14,12,12(13)         .SAVE CALLER'S REGS                 14250000
         AIF   ('&EPLV' EQ '1').ETXT3   BRANCH IF SPECIAL REG 1         14300000
.ETXT2   ANOP                                                           14350000
         L&LT2 1,&EPLV              .ETDES PARAMETER LIST ADDRESS       14400000
.ETXT3   ANOP                                                           14450000
         AIF   (&OPTOI EQ 0).SKIPOI     IF NO OPTIONS TURNED ON         14500000
         OI    1(1),&OPTOI          .SET OPTIONS IN OPTIONS BYTE        14550000
.SKIPOI  AIF   (&OPTNI EQ 255).SKIPNI   IF NO OPTIONS TURNED OFF        14600000
         NI    1(1),&OPTNI          .CLEAR OPTIONS IN OPTIONS BYTE      14650000
.SKIPNI  AIF   (&S(9) NE 1).SKIPLX      IF TOKEN NOT SPECIFIED          14700000
         AIF   ('&LT1' EQ 'R').ETXT5    BR IF TOKEN IS REG FORM         14750000
.*                                                             @ZA76312 14800000
         LA    2,&TOKV              .GET ADDR OF TOKEN                  14850000
         ST    2,4(,1)              .STORE TOKEN ADDR INTO PARM LIST    14900000
         AGO   .SKIPLX                                                  14950000
.ETXT5   ANOP                           REG FORM TOKEN                  15000000
         ST    &TOKV,4(1)           .STORE TOKEN ADDR INTO PARM LIST    15050000
.SKIPLX  ANOP                                                           15100000
         ESAR  2                    .EXTRACT SASID                      15150000
         ST    2,16(,13)            .SAVE SASID IN REG 15 SLOT          15200000
         L     2,16(0,0)            .GET ADDR OF CVT                    15250000
         L     2,772(,2)            .GET ADDR OF SYSTEM FUNCTION TABLE  15300000
         L     2,12(,2)             .GET LX/EX FOR ETDES                15350000
         PC    0(2)                 .PC TO ETDES SERVICE                15400000
         L     2,16(,13)            .EXTRACT SAVED SASID                15450000
         SSAR  2                    .RESTORE SASID                      15500000
         LM    2,12,28(13)          .RESTORE REGS 2-12                  15550000
         L     14,12(,13)           .RESTORE REG 14                     15600000
         MEXIT                                                          15650000
.********************************************************************** 15700000
.*       PROCESS ERROR CONDITIONS                                     * 15750000
.********************************************************************** 15800000
.ERR001  ANOP SEV 12 MNOTE -- IHB001 &OPERAND REQ''D - NOT SPECIFIED    15850000
         IHBERMAC 1017,&OPERAND                                         15900000
         MEXIT                                                          15950000
.ERR002  ANOP SEV 12 MNOTE -- IHB002 - INVALID &OPERAND OPERAND &OPVAL  16000000
         IHBERMAC 1001,&OPERAND,&OPVAL                                  16050000
         MEXIT                                                          16100000
.ERR027  ANOP SEV 12 MNOTE -- IHB027 - EXCESSIVE POSITIONAL PARAMETERS  16150000
         IHBERMAC 238                                                   16200000
         MEXIT                                                          16250000
.ERR280  ANOP SEV 12 MNOTE -- IHB280 &OPERAND INVALID WITH &OPVAL       16300000
         IHBERMAC 1020,&OPERAND,&OPVAL                                  16350000
         MEND                                                           16400000
* */                                                                    16450000
*@EJECT;                                                                16500000
*%ETDES:                                                                16550000
*        MACRO KEYS(TOKEN,PURGE,MF,RELATED);                            16600000
*/********************************************************************/ 16650000
*/*                DEFINE EXTERNAL MACRO VARIABLES                   */ 16700000
*/********************************************************************/ 16750000
* DECLARE                                                               16800000
*   EHAMAXDIM FIXED     EXT, /* NUMBER OF OPTION PARAMETERS.         */ 16850000
*   EHAMAXLEN FIXED     EXT, /* LENGTH OF STANDARD LIST.             */ 16900000
*   EHAREGS   CHARACTER EXT, /* CONTAINS DECLARED REGISTER NUMBERS.  */ 16950000
*   EHAMAPS   CHARACTER EXT, /* CONTAINS REQUESTS FOR MAPPINGS       */ 17000000
*   EHAPCLIST CHARACTER EXT; /* CONTAINS STANDARD PC LIST NAMES.     */ 17050000
*/********************************************************************/ 17100000
*/*                DEFINE INTERNAL MACRO VARIABLES                   */ 17150000
*/********************************************************************/ 17200000
* DECLARE CC       FIXED;    /* STARTING COLUMN FOR PL/S COMMENTS    */ 17250000
* DECLARE IVCLROPT FIXED;    /* IF SET TO 1 IMPLIES CODE TO CLEAR    */ 17300000
*                            /* OPTIONS MUST BE GENERATED. THIS WILL */ 17350000
*                            /* BE TRUE FOR THE MF(M) AND MF(E) CASES*/ 17400000
*                            /* WHERE 'COMPLETE' IS NOT SPECIFIED.   */ 17450000
*                            /* FOR THE STD. FORM OR WHEN 'COMPLETE' */ 17500000
*                            /* IS SPECIFIED THE ZEROING OF THE PARM */ 17550000
*                            /* LIST WOULD MAKE SUCH CODE REDUNDANT. */ 17600000
* DECLARE IVDOCMT  CHAR;     /* COMMENT FOR DO AND END LINES.        */ 17650000
* DECLARE IVINDNT2 FIXED;    /* STARTING COLUMN FOR ALL ANSWER TEXT  */ 17700000
*                            /*   EXCEPT DO AND END STATEMENTS.      */ 17750000
* DECLARE IVLFORM  CHAR;     /* HOLDS LIST-FORM INVOCATION STRING.   */ 17800000
* DECLARE IVLIST   CHAR;     /* NAME OF STANDARD OR SUPPLIED LIST.   */ 17850000
* DECLARE IVLP1    FIXED;    /* LEFT  PAREN COL FOR PTR FORM TOKEN   */ 17900000
* DECLARE IVLSTLEN FIXED;    /* LENGTH OF ETDES PARAMETER LIST.      */ 17950000
* DECLARE IVOPTS   CHAR;     /* OPTIONS BYTE INITIALIZATION STRING   */ 18000000
* DECLARE IVOPT11  CHAR;     /* XM@00411 BIT INITIALIZATION STRING   */ 18050000
* DECLARE IVRC     FIXED;    /* RETURN CODE TO DETERMINE IF TEXT WILL*/ 18100000
*                            /* BE GENERATED.                        */ 18150000
* DECLARE IVRP1    FIXED;    /* RIGHT PAREN COL FOR PTR FORM TOKEN   */ 18200000
*/********************************************************************/ 18250000
*/*                INITIALIZE INTERNAL MACRO VARIABLES                  18300000
*/********************************************************************/ 18350000
* CC         = MACRMAR-35;   /* COMMENTS COLUMN (DEFAULT= 72-35 = 37)*/ 18400000
* IVDOCMT    = ' ETDES';                                                18450000
*                            /* START OF DO-END COMMENT--NO KEYS YET */ 18500000
* IVCLROPT   = 0;            /* DON'T GENERATE CODE TO CLEAR OPTIONS */ 18550000
* IVINDNT2   = MACCOL + 2;   /* SET INDENTATION MARGIN.              */ 18600000
* IVLFORM    = '?AHAETDES('; /* BEGINNING OF AHAETDES INV-STRING.    */ 18650000
* IVLIST     = 'XM@004';     /* STANDARD LIST NAME FOR ETDES SERVICE */ 18700000
* IVLP1      = INDEX(TOKEN(1),'('); /* GET POSITION OF LEFT PAREN    */ 18750000
*                            /* NOTE: A NON-ZERO VALUE FOR IVLP1     */ 18800000
*                            /* INDICATES A POINTER FORM ADDRESS.    */ 18850000
* IVLSTLEN   = 8;            /* SET LENGTH OF ETDES PARAMETER LIST.  */ 18900000
* IVRC       = 0;            /* SET CODE TO GENERATE TEXT            */ 18950000
* IF IVLP1=1 THEN            /* IF POINTER NOTATION          @ZMB0031*/ 19000000
*   DO;                      /* POINTER NOTATION.            @ZMB0031*/ 19050000
*     IVRP1=LENGTH(TOKEN(1));  /* GET LAST CHAR OF SUBLIST   @ZMB0031*/ 19100000
*     IF TOKEN(1,IVRP1:IVRP1)¬=')' THEN /* IF NOT A RIGHT               19150000
*                                          PAREN             @ZMB0031*/ 19200000
*       IVRP1=IVLP1;         /* FORCE 'NOT-SPECIFIED' ERROR  @ZMB0031*/ 19250000
*   END;                     /* POINTER NOTATION.            @ZMB0031*/ 19300000
* ELSE                       /* NOT POINTER NOTATION.        @ZMB0031*/ 19350000
*   DO;                      /* NOT POINTER NOTATION.        @ZMB0031*/ 19400000
*     IVLP1=0;               /* NOT POINTER NOTATION.        @ZMB0031*/ 19450000
*     IVRP1=0;               /* NOT POINTER NOTATION.        @ZMB0031*/ 19500000
*   END;                     /* NOT POINTER NOTATION.        @ZMB0031*/ 19550000
*/********************************************************************/ 19600000
*/*                CHECK FOR MACLIST                                 */ 19650000
*/********************************************************************/ 19700000
* IF MACLIST ¬= ''           /* MACLIST SUPPLIED?                    */ 19750000
*   THEN DO;                 /* YES -                                */ 19800000
*     IVRC = 12;             /*       PREVENT TEXT GENERATION        */ 19850000
*     ANS MSG('AHA0053 THE MACLIST '||QUOTE(MACLIST)||                  19900000
*             ' IS NOT ALLOWED. NO TEXT IS GENERATED.');                19950000
*                            /*       INDICATE MACLIST IN DO-COMMENT.*/ 20000000
*     IVDOCMT = IVDOCMT||' '||MACLIST;                                  20050000
*   END;                     /* END - MACLIST SPECIFIED.             */ 20100000
*/********************************************************************/ 20150000
*/*                PROCESS MF KEYWORD                                */ 20200000
*/********************************************************************/ 20250000
* IF MF = ''                 /* STANDARD FORM?                       */ 20300000
*   THEN                     /* YES -                                */ 20350000
*     GOTO LHA00200;         /*       SKIP MF PROCESSING.            */ 20400000
*                            /* NO  - INDICATE MF KEY IN DO-COMMENT. */ 20450000
* IVDOCMT = IVDOCMT||' MF'||MF;                                         20500000
* IF MF(2) = ''              /* WAS A LIST NAME SUPPLIED?            */ 20550000
*   THEN DO;                 /* NO  - PUT OUT ERROR MSG AHA0013.     */ 20600000
*     ANS MSG('AHA0013 MF(2) (LISTNAME) IS REQUIRED '||                 20650000
*             'BUT IS NOT SUPPLIED. NO TEXT IS GENERATED.');            20700000
*     IVRC = 12;             /* KILL TEXT GENERATION.                */ 20750000
*   END;                                                                20800000
* IF NUMBER(MF) > 3          /* TOO MANY MF ARGUMENTS.               */ 20850000
*   THEN DO;                 /* YES - PUT OUT ERROR MSG AHA0033.     */ 20900000
*     ANS MSG('AHA0033 MF - '||MF||' - HAS TOO MANY ARGUMENTS. '||      20950000
*             'NO TEXT IS GENERATED.');                                 21000000
*     IVRC = 12;             /* KILL TEXT GENERATION.                */ 21050000
*   END;                                                                21100000
* IF MF(1) = 'L'             /* LIST FORM?                           */ 21150000
*   THEN DO;                 /* YES - CK FOR ERRORS UNIQUE TO MF(L)  */ 21200000
*     IF INDEX(TOKEN(1),'->') ¬= 0   /* IF BASED FORM OF ADDRESS USED*/ 21250000
*       THEN DO;             /* INVALID VALUE FOR TOKEN              */ 21300000
*         ANS MSG('AHA0023 BASED FORM TOKEN ADDRESS '''||TOKEN(1)||     21350000
*                 ''' INVALID WITH MF(L). NO TEXT IS GENERATED.');      21400000
*         IVRC = 12;         /* KILL TEXT GENERATION.                */ 21450000
*       END;                 /* INVALID VALUE FOR TOKEN              */ 21500000
*     IF IVLP1 =1            /* IF POINTER FORM OF ADDRESS   @ZMB0031*/ 21550000
*       THEN DO;             /* INVALID VALUE FOR TOKEN              */ 21600000
*         ANS MSG('AHA0023 POINTER FORM TOKEN ADDRESS '''||             21650000
*                 TOKEN(1)||''' INVALID WITH MF(L). '||                 21700000
*                 'NO TEXT IS GENERATED.');                             21750000
*         IVRC = 12;         /* KILL TEXT GENERATION.                */ 21800000
*       END;                 /* INVALID VALUE FOR TOKEN              */ 21850000
*     IF MF(3) = 'COMPLETE'  /* ONLY VALID FOR MF(E) AND MF(M)       */ 21900000
*       THEN DO;             /*                                      */ 21950000
*         ANS MSG('AHA0023 ''COMPLETE'' IS INVALID WITH MF(L). '||      22000000
*                 'NO TEXT IS GENERATED.');                             22050000
*         IVRC = 12;         /* KILL TEXT GENERATION.                */ 22100000
*       END;                 /* INVALID VALUE FOR MF(3)              */ 22150000
*     GOTO LHA00200;         /* END MF PROCESSING                    */ 22200000
*   END;                     /* LIST FORM                            */ 22250000
* IF MF(1) = 'M'             /* NO  - MODIFY FORM?                   */ 22300000
*   THEN                     /* YES -                                */ 22350000
*     GOTO LHA00100;         /*       CHECK FOR THIRD ARGUMENT.      */ 22400000
* IF MF(1) ¬= 'E'            /* NO  - EXECUTE FORM?                  */ 22450000
*   THEN DO;                 /* NO  - PUT OUT ERROR MSG AHA0043.     */ 22500000
*     ANS MSG('AHA0043 MF(1) MUST BE ''L,E OR M''. '||                  22550000
*             'NO TEXT IS GENERATED.');                                 22600000
*     IVRC = 12;             /* KILL TEXT GENERATION.                */ 22650000
*   END;                                                                22700000
*LHA00100:                                                              22750000
* IVCLROPT = 1;              /* GENERATE CLEAR OPTIONS CODE FOR      */ 22800000
*                            /* THE MF(M) AND MF(E) CASES.           */ 22850000
* IF MF(3) = ''              /* WAS A THIRD ARGUMENT SPECIFIED?      */ 22900000
*   THEN                     /* NO  -                                */ 22950000
*     GOTO LHA00200;         /*       CHECK FOR TOKEN KEYWORD        */ 23000000
* IF MF(3) ¬= 'COMPLETE'     /* YES - IS THIRD ARGUMENT VALID?       */ 23050000
*   THEN DO;                 /* NO  - PUT OUT ERROR MSG AHA0043.     */ 23100000
*     ANS MSG('AHA0043 MF(3) MUST BE ''COMPLETE'' '||                   23150000
*             'WITH MF(E) OR MF(M).'||                                  23200000
*             'NO TEXT IS GENERATED.');                                 23250000
*     IVRC = 12;             /* KILL TEXT GENERATION.                */ 23300000
*   END;                                                                23350000
* IVCLROPT = 0;              /* DON'T GENERATE CLEAR OPTIONS CODE FOR*/ 23400000
*                            /* THE MF(M) AND MF(E) 'COMPLETE' CASES.*/ 23450000
*/********************************************************************/ 23500000
*/*                PROCESS TOKEN KEYWORD                             */ 23550000
*/********************************************************************/ 23600000
*LHA00200:                                                              23650000
* IF TOKEN ¬= ''             /* TOKEN SPECIFIED?                     */ 23700000
*   THEN DO;                 /* YES - ADD KEYWD TO COMMENT           */ 23750000
*     IVDOCMT = IVDOCMT||' TOKEN'||TOKEN;                               23800000
*     IF TOKEN(1) ¬= '' &    /* WAS ARGUMENT SPECIFIED?      @ZM50111*/ 23850000
*       ((IVLP1=0 & IVRP1=0)|/* AND NOT POINTER FORM         @ZM50111*/ 23900000
*       (IVLP1+1 <= IVRP1-1))/* AND NOT = '()' ?             @ZM50111*/ 23950000
*       THEN DO;             /* YES - TOKEN(1) SPECIFIED             */ 24000000
*         IF NUMBER(TOKEN) > 1 /* TOO MANY TOKEN ARGS?               */ 24050000
*           THEN DO;         /* YES - ISSUE AHA0033                  */ 24100000
*             ANS MSG('AHA0033 TOKEN - '||TOKEN||                       24150000
*                      ' - HAS TOO MANY ARGUMENTS. '||                  24200000
*                      'NO TEXT IS GENERATED.');                        24250000
*             IVRC = 12;     /* KILL TEXT GENERATION                 */ 24300000
*           END;             /* NUMBER(TOKEN) > 1                    */ 24350000
*       END;                 /* TOKEN(1) SPECIFIED                   */ 24400000
*       ELSE DO;             /* NO ARGUMENT-ISSUE AHA0013            */ 24450000
*         ANS MSG('AHA0013 TOKEN(1) (LIST ADDR) IS REQUIRED '||         24500000
*                 'BUT IS NOT SPECIFIED. NO TEXT IS GENERATED.');       24550000
*         IVRC = 12;         /* KILL TEXT GENERATION                 */ 24600000
*       END;                 /* NO TOKEN ARGUMENT                    */ 24650000
*   END;                     /* TOKEN KEYWORD SPECIFIED              */ 24700000
*   ELSE DO;                 /* TOKEN NOT SPECIFIED                  */ 24750000
*     IF MF = ''             /* IF STANDARD FORM                     */ 24800000
*       THEN DO;             /* ERROR - TOKEN IS REQUIRED            */ 24850000
*         ANS MSG('AHA0013 TOKEN IS REQUIRED FOR STANDARD FORM '||      24900000
*                 'BUT IS NOT SPECIFIED. NO TEXT IS GENERATED.');       24950000
*         IVRC = 12;         /* KILL TEXT GENERATION                 */ 25000000
*       END;                 /* ERROR - TOKEN IS REQUIRED            */ 25050000
*   END;                     /* TOKEN NOT SPECIFIED                  */ 25100000
*/********************************************************************/ 25150000
*/*                PROCESS PURGE KEYWORD                             */ 25200000
*/********************************************************************/ 25250000
* IVOPT11 = '0';             /* SET DEFAULT INIT. STRING             */ 25300000
* IF PURGE ¬= ''             /* PURGE SPECIFIED?                     */ 25350000
*   THEN DO;                 /* YES - ADD PURGE KYWD TO COMMENT      */ 25400000
*     IVDOCMT=IVDOCMT||' PURGE'||PURGE;                                 25450000
*     IF PURGE(1) ¬= ''      /* ARGUMENT SPECIFIED?                  */ 25500000
*       THEN DO;             /* YES                                  */ 25550000
*         IF PURGE(1)='YES' /* IS ARGUMENT 'YES'                     */ 25600000
*           THEN             /* YES                                  */ 25650000
*             IVOPT11= '1';  /* SET OPTION INIT. STRING              */ 25700000
*           ELSE DO;         /* ARGUMENT IS NOT 'YES'                */ 25750000
*             IF PURGE(1)¬='NO' /* ARGUMENT OTHER THAN 'NO'          */ 25800000
*               THEN DO;     /* YES - INVALID ARGUMENT               */ 25850000
*                 ANS MSG('AHA0043 PURGE MUST BE '||                    25900000
*                         '''YES'' OR ''NO''. '||                       25950000
*                         'NO TEXT IS GENERATED.');                     26000000
*                 IVRC=12;   /* PREVENT TEXT GENERATION              */ 26050000
*               END;         /* INVALID PURGE ARGUMENT               */ 26100000
*           END;             /* ARGUMENT IS NOT 'YES'                */ 26150000
*           IF NUMBER(PURGE) > 1 /* TOO MANY PURGE ARGS?             */ 26200000
*             THEN DO;                  /* YES -                     */ 26250000
*               ANS MSG('AHA0033 PURGE - '||PURGE||                     26300000
*                      ' - HAS TOO MANY ARGUMENTS. '||                  26350000
*                      'NO TEXT IS GENERATED.');                        26400000
*               IVRC = 12;   /* KILL TEXT GENERATION                 */ 26450000
*             END;           /* TOO MANY PURGE ARGS                  */ 26500000
*       END;                 /* ARGUMENT SPECIFIED                   */ 26550000
*       ELSE DO;             /* NO ARGUMENT                          */ 26600000
*         ANS MSG('AHA0043 PURGE MUST BE ''YES'' OR ''NO''. '||         26650000
*                         'NO TEXT IS GENERATED.');                     26700000
*         IVRC=12;           /* PREVENT TEXT GENERATION              */ 26750000
*       END;                 /* NO ARGUMENT                          */ 26800000
*   END;                     /* PURGE SPECIFIED                      */ 26850000
*/********************************************************************/ 26900000
*/*                PROCESS 'RELATED' KEYWORD                         */ 26950000
*/********************************************************************/ 27000000
* IF RELATED ¬= ''           /* IF RELATED WAS SPECIFIED             */ 27050000
*   THEN                     /* ADD KEYWORD TO DO COMMENT            */ 27100000
*     IVDOCMT=IVDOCMT||' RELATED'||RELATED;                             27150000
*/********************************************************************/ 27200000
*/*                PUT OUT LABELS (IF ANY)                           */ 27250000
*/********************************************************************/ 27300000
* IF MACLABEL ¬= ''          /* ANY LABELS SPECIFIED?                */ 27350000
*   THEN                     /* YES - PUT THEM OUT.                  */ 27400000
*     ANS(MACLABEL) COL(MACLMAR);                                       27450000
*/********************************************************************/ 27500000
*/*     PUT OUT DO STATEMENT (OR COMMENT FOR LIST FORM)              */ 27550000
*/********************************************************************/ 27600000
* IVDOCMT=IVDOCMT||' MACDATE(80.122) '; /* ADD MACDATE TO COMMENT    */ 27650000
* IF MF(1) = 'L'             /* LIST FORM OF THE MACRO?              */ 27700000
*   THEN DO;                 /* YES -                                */ 27750000
*     ANS(COMMENT(IVDOCMT))  /*       PUT OUT THE INVOCATION STRING  */ 27800000
*       COL(MACCOL);         /*         AS A COMMENT.                */ 27850000
*     IF IVRC > 4            /* ANY SEVERE ERRORS?                   */ 27900000
*       THEN                 /* YES -                                */ 27950000
*         GOTO LHA99999;     /*       EXIT - NO TEXT PRODUCED.       */ 28000000
*       GOTO LHA01000;       /* NO  - PROCESS LIST FORM.             */ 28050000
*   END;                     /* END - LIST FORM SPECIFIED.           */ 28100000
*   ELSE DO;                 /* NO  - NOT THE LIST FORM.             */ 28150000
*                            /*       GENERATE THE DO STATEMENT.     */ 28200000
*     ANS('DO; '||COMMENT(IVDOCMT)) COL(MACCOL);                        28250000
*     IF IVRC > 4            /* ANY SEVERE ERRORS?                   */ 28300000
*       THEN                 /* YES -                                */ 28350000
*         GOTO LHA09000;     /*       PUT OUT END STMT AND EXIT      */ 28400000
*   END;                     /* END - NOT THE LIST FORM.             */ 28450000
*/********************************************************************/ 28500000
*/*   INDICATE EPILOG IS TO PRODUCE STANDARD SAVEAREA MAPPING.       */ 28550000
*/********************************************************************/ 28600000
* IF INDEX(EHAMAPS,'SA@')=0   /* IF SA@ MAPPING NOT PREVIOUSLY       */ 28650000
*   THEN                      /* REQUESTED THEN INDICATE REQUEST     */ 28700000
*     EHAMAPS = EHAMAPS||'SA@,'; /* NOTE: COMMAS SEPERATE REQUESTS   */ 28750000
*/********************************************************************/ 28800000
*/*   INDICATE EPILOG IS TO PROVIDE ACCESS TO XM SERVICES.           */ 28850000
*/********************************************************************/ 28900000
* IF INDEX(EHAMAPS,'XM@')=0   /* IF XM SERVICES NOT PREVIOUSLY       */ 28950000
*   THEN                      /* REQUESTED THEN INDICATE REQUEST     */ 29000000
*     EHAMAPS = EHAMAPS||'XM@,'; /* NOTE: COMMAS SEPERATE REQUESTS   */ 29050000
* IF MF(1) = 'M' THEN        /* IF MODIFY FORM OF MACRO              */ 29100000
*   GOTO LHA00800;           /* SKIP GEN OF PC LINKAGE FRONT END     */ 29150000
*/********************************************************************/ 29200000
*/*                DEFINE REGISTER NAMES                             */ 29250000
*/********************************************************************/ 29300000
* IF INDEX(EHAREGS,'00F')=0  /* REGISTER 0 PREVIOUSLY DEFINED?       */ 29350000
*   THEN                     /* NO  -                                */ 29400000
*     EHAREGS=EHAREGS||'00F';/*       DEFINE IT.                     */ 29450000
* IF INDEX(EHAREGS,'01P')=0  /* REGISTER 1 PREVIOUSLY DEFINED?       */ 29500000
*   THEN                     /* NO  -                                */ 29550000
*     EHAREGS=EHAREGS||'01P';/*       DEFINE IT.                     */ 29600000
* IF INDEX(EHAREGS,'02P')=0  /* REGISTER 2 PREVIOUSLY DEFINED?       */ 29650000
*   THEN                     /* NO  -                                */ 29700000
*     EHAREGS=EHAREGS||'02P';/*       DEFINE IT.                     */ 29750000
* IF INDEX(EHAREGS,'12P')=0  /* REGISTER 12 PREVIOUSLY DEFINED?      */ 29800000
*   THEN                     /* NO  -                                */ 29850000
*     EHAREGS=EHAREGS||'12P';/*       DEFINE IT.                     */ 29900000
* IF INDEX(EHAREGS,'13P')=0  /* REGISTER 13 PREVIOUSLY DEFINED?      */ 29950000
*   THEN                     /* NO  -                                */ 30000000
*     EHAREGS=EHAREGS||'13P';/*       DEFINE IT.                     */ 30050000
* IF INDEX(EHAREGS,'14P')=0  /* REGISTER 14 PREVIOUSLY DEFINED?      */ 30100000
*   THEN                     /* NO  -                                */ 30150000
*     EHAREGS=EHAREGS||'14P';/*       DEFINE IT.                     */ 30200000
* IF INDEX(EHAREGS,'15F')=0  /* FIXED REG 15 PREVIOUSLY DEFINED?     */ 30250000
*   THEN                     /* NO  -                                */ 30300000
*     EHAREGS=EHAREGS||'15F';/*       DEFINE IT.                     */ 30350000
*/********************************************************************/ 30400000
*/*                GENERATE LINKAGE TO ETDES SERVICE (FRONT END)     */ 30450000
*/********************************************************************/ 30500000
* ANS('RESPECIFY')                                COL(IVINDNT2);        30550000
* ANS('(GPR00F,')                                 COL(IVINDNT2+1);      30600000
* ANS('GPR01P,')                                  COL(IVINDNT2+2);      30650000
* ANS('GPR02P,')                                  COL(IVINDNT2+2);      30700000
* ANS('GPR13P,')                                  COL(IVINDNT2+2);      30750000
* ANS('GPR14P,')                                  COL(IVINDNT2+2);      30800000
* ANS('GPR15F) RESTRICTED;')                      COL(IVINDNT2+2);      30850000
* ANS('STM(GPR14P,GPR12P,SA@G1412);')             COL(IVINDNT2);        30900000
* ANS(COMMENT(' SAVE CALLER''S REGS            ')) COL(CC);             30950000
*/********************************************************************/ 31000000
*/*                SET UP APPROPRIATE LIST NAME                      */ 31050000
*/********************************************************************/ 31100000
*LHA00800:                                                              31150000
* IF MF ¬= ''                /* MODIFY OR EXECUTE FORM OF THE MACRO? */ 31200000
*   THEN DO;                 /* YES -                                */ 31250000
*     IVLIST = MF(2);        /*       USE LIST NAME PROVIDED.        */ 31300000
*     GOTO LHA00900;         /*       EXECUTE COMMON PROCESSING.     */ 31350000
*   END;                     /* END- EXECUTE OR MODIFY FORMSPECIFIED */ 31400000
*   ELSE DO;                 /* NO - MUST BE STANDARD FORM.          */ 31450000
*                            /*      USE STANDARD LIST NAME.         */ 31500000
*    IF INDEX(EHAPCLIST,IVLIST)=0 /* STD. LIST PREVIOUSLY DEFINED?   */ 31550000
*      THEN                  /* NO  - DEFINE IT.                     */ 31600000
*        EHAPCLIST = EHAPCLIST || IVLIST;                               31650000
*   END;                     /* END- STANDARD LIST NAME TO BE USED   */ 31700000
* IF EHAMAXLEN < IVLSTLEN    /* IS THIS THE LONGEST LIST YET DEFINED?*/ 31750000
*   THEN                     /* YES -                                */ 31800000
*     EHAMAXLEN = IVLSTLEN;  /*       SET ITS LENGTH AS THE MAXIMUM. */ 31850000
* GOTO LHA00910;             /* ZERO OUT THE STANDARD LIST.          */ 31900000
*/********************************************************************/ 31950000
*/*                ZERO OUT THE LIST AND SET DEFAULTS                */ 32000000
*/*                     IF STANDARD FORM                             */ 32050000
*/*                  OR IF MODIFY OR EXECUTE FORM WITH 'COMPLETE'    */ 32100000
*/********************************************************************/ 32150000
*LHA00900:                                                              32200000
* IF MF(3) = ''              /* WAS 'COMPLETE' SPECIFIED?            */ 32250000
*   THEN                     /* NO  -                                */ 32300000
*     GOTO LHA00920;         /*       DO NOT ZERO THE LIST.          */ 32350000
*LHA00910:                   /* YES - ZERO THE LIST.                 */ 32400000
*/*  MAINTENANCE NOTE: THE '00' AND '20' FIELDS ARE AUTOMATICALLY    */ 32450000
*/*                    INITIALIZED TO THEIR DEFAULT VALUES OF ZERO   */ 32500000
*/*                    VIA THE ZEROING OF THE LIST. IF THE DEFAULTS  */ 32550000
*/*                    BECOME NON-ZERO ADDITIONAL STMTS SHOULD BE    */ 32600000
*/*                    INSERTED HERE.                                */ 32650000
* ANS(IVLIST||'='||IVLIST||'&&'||IVLIST||'; ')      COL(IVINDNT2);      32700000
* ANS(COMMENT(' ZERO THE LIST                 '))   COL(CC);            32750000
*/********************************************************************/ 32800000
*/*                ASSIGN VALUES TO LIST ITEMS                       */ 32850000
*/********************************************************************/ 32900000
*LHA00920:                                                              32950000
* IF PURGE ¬= ''             /* IF PURGE KEYWORD SPECIFIED           */ 33000000
*   THEN DO;                                                            33050000
*     IF IVOPT11 = '0'       /* IF PURGE=NO SPECIFIED                */ 33100000
*       THEN DO;                                                        33150000
*         IF IVCLROPT = 1    /* IF CLEAR OPTIONS REQUIRED            */ 33200000
*           THEN DO;                                                    33250000
*             ANS(IVLIST||'11='''||IVOPT11||'''B; ') COL(IVINDNT2);     33300000
*             ANS(COMMENT(' SET PURGE=NO OPTION          ')) COL(CC);   33350000
*           END;                                                        33400000
*       END;                 /* PURGE=NO SPECIFIED                   */ 33450000
*       ELSE DO;             /* PURGE=YES OPTION SPECIFIED           */ 33500000
*         ANS(IVLIST||'11='''||IVOPT11||'''B; ') COL(IVINDNT2);         33550000
*         ANS(COMMENT(' SET PURGE=YES OPTION         ')) COL(CC);       33600000
*       END;                                                            33650000
*   END;                                                                33700000
* IF TOKEN = ''              /* IF TOKEN KEYWORD NOT SPECIFIED       */ 33750000
*   THEN GOTO LHA00930;                                                 33800000
* IF IVLP1 ¬= 1              /* IF NOT POINTER FORM ADDRESS  @ZMB0031*/ 33850000
*   THEN DO;                                                            33900000
*     ANS(IVLIST||'22=ADDR('||TOKEN(1)||'); ')         COL(IVINDNT2);   33950000
*     ANS(COMMENT(' SET TOKEN ADDRESS            '))   COL(CC);         34000000
*   END;                                                                34050000
*   ELSE DO;                                                            34100000
*     ANS(IVLIST||'22='||TOKEN(1,IVLP1+1:IVRP1-1)||';')                 34150000
*                                                      COL(IVINDNT2);   34200000
*     ANS(COMMENT(' SET TOKEN ADDRESS            '))   COL(CC);         34250000
*   END;                                                                34300000
*LHA00930:                                                              34350000
* IF MF(1) = 'M'             /* IF MODIFY FORM OF MACRO              */ 34400000
*   THEN                     /* YES -                                */ 34450000
*     GOTO LHA09000;         /*       DO NOT GENERATE PC LINKAGE     */ 34500000
*/********************************************************************/ 34550000
*/*                BALANCE OF PC LINKAGE                             */ 34600000
*/********************************************************************/ 34650000
* ANS('GPR01P=ADDR('||IVLIST||'); ')              COL(IVINDNT2);        34700000
* ANS(COMMENT(' ETDES PARAMETER LIST ADDRESS  ')) COL(CC);              34750000
* ANS('ESAR(SA@GPR15);')                          COL(IVINDNT2);        34800000
* ANS(COMMENT('SAVE SASID                     ')) COL(CC);              34850000
* ANS('GPR02P=XM@(4);')                           COL(IVINDNT2);        34900000
* ANS(COMMENT(' GET LX/EX FOR ETDES FROM SFT  ')) COL(CC);              34950000
* ANS('GEN (DS 0H);') COL(IVINDNT2);  /* MAKE PL/AS USE SAVEAREA @P1A*/ 35000000
* ANS('PC(GPR02P);')                              COL(IVINDNT2);        35050000
* ANS(COMMENT(' PC TO ETDES SERVICE           ')) COL(CC);              35100000
* ANS('SSAR(SA@GPR15);')                          COL(IVINDNT2);        35150000
* ANS(COMMENT('RESTORE SASID                  ')) COL(CC);              35200000
* ANS('LM(GPR02P,GPR12P,SA@G0212);')              COL(IVINDNT2);        35250000
* ANS(COMMENT(' RESTORE REGS 2-12             ')) COL(CC);              35300000
* ANS('GPR14P=SA@GPR14;')                         COL(IVINDNT2);        35350000
* ANS(COMMENT(' RESTORE REG 14                ')) COL(CC);              35400000
* ANS('RESPECIFY')                                COL(IVINDNT2);        35450000
* ANS('(GPR00F,')                                 COL(IVINDNT2+1);      35500000
* ANS('GPR01P,')                                  COL(IVINDNT2+2);      35550000
* ANS('GPR02P,')                                  COL(IVINDNT2+2);      35600000
* ANS('GPR13P,')                                  COL(IVINDNT2+2);      35650000
* ANS('GPR14P,')                                  COL(IVINDNT2+2);      35700000
* ANS('GPR15F) UNRESTRICTED;')                    COL(IVINDNT2+2);      35750000
*                                                                       35800000
*LHA09000:                   /* CLOSE OUT DO GROUP.                  */ 35850000
* ANS('END; ') COL(MACCOL);                                             35900000
* GOTO LHA99999;             /* RETURN TO INVOKER                    */ 35950000
*/********************************************************************/ 36000000
*/*                PROCESS LIST-FORM                                 */ 36050000
*/********************************************************************/ 36100000
*LHA01000:                                                              36150000
*                            /* PUT LIST-NAME IN AHAETDES MACLIST(1) */ 36200000
* IVLFORM = IVLFORM||MF(2)||',';                                        36250000
* IF MF(3) ¬= ''             /* WERE LIST ATTRIBUTES SPECIFIED?      */ 36300000
*   THEN                     /* YES - PUT THEM IN AHAETDES MACLIST(2)*/ 36350000
*     IVLFORM = IVLFORM||MF(3)||',';                                    36400000
*   ELSE                     /* NO  -                                */ 36450000
*     IVLFORM = IVLFORM||',';/* INDICATE NO MF(3) LIST ATTRIBUTES    */ 36500000
* IF PURGE ¬= ''             /* IF PURGE WAS SPECIFIED               */ 36550000
*   THEN DO;                 /* AT LEAST ONE OPTION SET              */ 36600000
*     IVOPTS  = IVOPT11||'0000000'; /* SET OPTIONS BYTE INIT. STRING */ 36650000
*     IVLFORM = IVLFORM||IVOPTS||',';/*SET OPTIONS BYTE IN MACLIST(3)*/ 36700000
*   END;                     /* AT LEAST ONE OPTION SET              */ 36750000
*   ELSE                     /* NO OPTIONS SET                       */ 36800000
*     IVLFORM = IVLFORM||',';/* INDICATE NO OPTIONS INITIALIZATION   */ 36850000
*                                                                       36900000
* IF TOKEN ¬= ''             /* IF TOKEN WAS SPECIFIED               */ 36950000
*   THEN                     /* SET VALUE IN MACLIST(4)              */ 37000000
*     IVLFORM = IVLFORM||TOKEN(1);                                      37050000
* ANS(IVLFORM||');');        /* INVOKE LIST MACRO (AHAETDES).        */ 37100000
*/********************************************************************/ 37150000
*/*                RETURN                                            */ 37200000
*/********************************************************************/ 37250000
*LHA99999:                                                              37300000
* RETURN CODE(IVRC);                                                    37350000
*/********************************************************************/ 37400000
*/*                END OF ETDES MACRO                                */ 37450000
*/********************************************************************/ 37500000
* % END ETDES;                                                          37550000
