* %/*  THIS MAKES THE BAL VERSION LOOK LIKE A PL/S MACRO COMMENT        00050000
         MACRO                                                          00100000
.********************************************************************** 00150000
.*                                                                    * 00200000
.*01* MACRO NAME = DOM                                            @L1A* 00250000
.*                                                                    * 00300000
.*01* DESCRIPTIVE NAME = DELETE OPERATOR MESSAGES (DOM)           @L1A* 00350000
.*                                                                    * 00400000
.*01* PROPRIETARY STATEMENT =                                     @L1A* 00450000
.*                                                                @L2C* 00500000
.*         LICENSED MATERIALS - PROPERTY OF IBM                   @L2C* 00550000
.*         THIS MODULE IS "RESTRICTED MATERIALS OF IBM"           @L2C* 00600000
.*         5695-047 (C) COPYRIGHT IBM CORP. (1986, 1990)          @L2C* 00650000
.*         SEE COPYRIGHT INSTRUCTIONS.                                * 00700000
.*                                                                    * 00750000
.*01* STATUS =   HBB4410                                          @L2C* 00800000
.*                                                                    * 00850000
.*01* FUNCTION = THE DOM MACRO IS USED TO DELETE AN OPERATOR      @L1A* 00900000
.*               MESSAGE OR GROUP OF MESSAGES ON A DISPLAY        @L1A* 00950000
.*               CONSOLE. WHEN A PROGRAM NO LONGER REQUIRES       @L1A* 01000000
.*               THAT A MESSAGE BE DISPLAYED, THE DOM MACRO       @L1A* 01050000
.*               INSTRUCTION SHOULD BE ISSUED TO DELETE THE       @L1A* 01100000
.*               MESSAGE.                                         @L1A* 01150000
.*                                                                    * 01200000
.*02*   OPERATION =                                               @L1A* 01250000
.*                                                                    * 01300000
.*               THIS MACRO CHECKS THE SYNTAX OF OPERANDS THAT    @L1A* 01350000
.*               WERE SPECIFIED AND, IF INVALID, AN MNOTE WILL BE @L1A* 01400000
.*               ISSUED. IF THE OPERANDS ARE VALID REGISTER 0 AND @L1A* 01450000
.*               REGISTER 1 WILL BE SET UP AND SVC 87 WILL BE     @L1A* 01500000
.*               ISSUED.                                          @L1A* 01550000
.*                                                                @01A* 01600000
.*               THE FORMAT OF REGISTER 0 AND REGISTER 1          @01A* 01650000
.*               DEPENDS ON THE OPERANDS THAT WERE SPECIFIED:     @01A* 01700000
.*                                                                @01A* 01750000
.*               1."OLD FORMAT" (PRE-JBB2220) IS GENERATED IF     @01A* 01800000
.*                  THE ONLY OPERANDS SPECIFIED ARE THESE:        @01A* 01850000
.*                  MSG                                           @01A* 01900000
.*                  MSGLIST                                       @01A* 01950000
.*                  REPLY=YES                                     @01A* 02000000
.*                                                                @01A* 02050000
.*               IN "OLD FORMAT",                                 @01A* 02100000
.*               REGISTER 0 WILL CONTAIN:                         @01A* 02150000
.*                -ZERO IF MSG WAS SPECIFIED, REPLY WAS NOT       @01A* 02200000
.*                -FOUR IF MSG AND REPLY WERE SPECIFIED           @01A* 02250000
.*                -A NEGATIVE NUMBER IF MSGLIST WAS SPECIFIED,    @01A* 02300000
.*                   REPLY WAS NOT                                @01A* 02350000
.*                -TWELVE IF MSGLIST AND REPLY WERE SPECIFIED     @01A* 02400000
.*               REGISTER 1 WILL CONTAIN ONE OF THE FOLLOWING:    @01A* 02450000
.*                -DOM ID.                                        @01A* 02500000
.*                -ADDRESS OF A LIST OF UP TO 60 DOM IDS.         @01A* 02550000
.*                                                                @01A* 02600000
.*               2."NEW FORMAT" WILL BE GENERATED IF ANY OF THE   @01A* 02650000
.*                  FOLLOWING OPERANDS ARE SPECIFIED:             @01A* 02700000
.*                  SYSID                                         @01A* 02750000
.*                  COUNT                                         @01A* 02800000
.*                  TOKEN                                         @01A* 02850000
.*                  DOMCBLK                                       @01A* 02900000
.*                  SCOPE                                         @01A* 02950000
.*                  LINKAGE                                       @01A* 03000000
.*                                                                @01A* 03050000
.*               IN "NEW FORMAT",                                 @01A* 03100000
.*               REGISTER 0 WILL CONTAIN:                         @L1A* 03150000
.*                -COUNT OF 4-BYTE DOM IDS.                       @L1A* 03200000
.*                -SYSTEM ID FROM WHICH THE MESSAGES ARE TO BE    @L1A* 03250000
.*                  DELETED.                                      @L1A* 03300000
.*                -REQUEST TYPE - DESCRIBES THE DOM REQUEST.      @L1A* 03350000
.*               REGISTER 1 WILL CONTAIN ONE OF THE FOLLOWING:    @L1A* 03400000
.*                -DOM ID.                                        @L1A* 03450000
.*                -ADDRESS OF A LIST OF UP TO 60 DOM IDS.         @L1A* 03500000
.*                -TOKEN.                                         @L1A* 03550000
.*                -0 - (SYSID SPECIFIED ALONE).                   @L1A* 03600000
.*                                                                    * 03650000
.*01* INVOCATION =                                                @L1A* 03700000
.*                                                                    * 03750000
.*    THE FOLLOWING KEYWORDS CAN BE SPECIFIED ON THE DOM MACRO:   @L1A* 03800000
.*                                                                    * 03850000
.*      MSG      =  SINGLE MESSAGE ID IS PASSED                   @L1A* 03900000
.*      MSGLIST  =  A LIST OF UP TO 60 MESSAGE IDS ARE PASSED     @L1A* 03950000
.*      DOMCBLK  =  A POINTER TO A DOM CONTROL BLOCK TO BE USED   @L1A* 04000000
.*                  AS INPUT FOR THE DOM IS PASSED.               @L1A* 04050000
.*      TOKEN    =  A 4 BYTE TOKEN FOR THE MESSAGES THAT ARE      @L1A* 04100000
.*                  TO BE DELETED IS PASSED. THE MESSAGES         @L1A* 04150000
.*                  THAT ARE DELETED BY TOKEN ARE                 @L1A* 04200000
.*                  THE MESSAGES THAT WERE ISSUED WITH            @L1A* 04250000
.*                  THIS TOKEN VIA WTO.                           @L1A* 04300000
.*      SYSID    =  THE ID OF THE SYSTEM FOR THE MESSAGES THAT    @L1A* 04350000
.*                  ARE TO BE DELETED IS PASSED. MESSAGES         @L1A* 04400000
.*                  ORIGINALLY ISSUED WITH THIS SYSTEM ID         @L1A* 04450000
.*                  WILL BE DELETED.                              @L1A* 04500000
.*      COUNT    =  THE COUNT OF 4-BYTE DOM IDS                   @L1A* 04550000
.*                  ASSOCIATED WITH THE DOM REQUEST IS PASSED.    @L1A* 04600000
.*      SCOPE    =  SYSTEMS/SYSTEM - INDICATES IF THE MESSAGE     @D1A* 04650000
.*                  DELETION REQUEST IS TO BE COMMUNICATED TO     @D1A* 04700000
.*                  OTHER SYSTEMS                                 @D1A* 04750000
.*      LINKAGE  =  SPECIFIES HOW CONTROL IS TO PASS TO THE DOM   @L2A* 04800000
.*                  FUNCTION - EITHER SVC OR BRANCH AND LINK      @L2A* 04850000
.*                                                                    * 04900000
.*               NOTE- DOMCBLK, SYSID AND SCOPE ARE KEYWORDS      @D1C* 04950000
.*                     RESERVED FOR CONTROL PROGRAM USE ONLY.     @D1C* 05000000
.*                                                                    * 05050000
.*01* CREATED-BY      = N/A                                       @L1A* 05100000
.*                                                                    * 05150000
.*01* POINTED-TO-BY   = N/A                                       @L1A* 05200000
.*                                                                    * 05250000
.*01* LOCATION        = N/A                                       @L1A* 05300000
.*                                                                    * 05350000
.*01* SERIALIZATION   = N/A                                       @L1A* 05400000
.*                                                                    * 05450000
.*01* CHANGE ACTIVITY =                                               * 05500000
.* $L1=COEXDOM,  JBB2220, 840801, PDFB: JES3/MCS COEXISTENCE          * 05550000
.* $D1=DCR028,   JBB2220, 841128, PDFB: DOWNWARD COMMUNICATION OF     * 05600000
.*                                      MESSAGE DELETION REQUESTS     * 05650000
.* $P1=PA20142,  JBB2220, 850220, PDFB: ISSUE A WARNING MESSAGE       * 05700000
.*                                      INSTEAD OF A SEVERITY 4       * 05750000
.*                                      MNOTE FOR A DOM BY MSG        * 05800000
.*                                      OR MSGLIST WITH THE REPLY     * 05850000
.*                                      KEYWORD                       * 05900000
.* $P2=PA20291,  JBB2220, 850612, PDFB: FOR SYSID AND COUNT KEYWORDS  * 05950000
.*                                      GENERATE AN IC INSTRUCTION    * 06000000
.*                                      INSTEAD OF A LOAD INSTRUCTION * 06050000
.* $P3=PA21031,  JBB2220, 860606, PDFB: CHANGE LOAD TO LOAD ADDRESS   * 06100000
.*                                      FOR MESSAGE LIST              * 06150000
.*             YA02975                                        @YA02975* 06200000
.*             YA06541                                        @YA06541* 06250000
.*             YA24471                                        @YA24471* 06300000
.*             YA23559  (NO CODE CHANGE, N/A TO 4.1.0)        @YA23559* 06350000
.* $L2=CNITGDHE, HBB4410, 890313, PDHE: CONSOLE INTEGRATION           * 06400000
.* $P4=PH25008 , HBB4410, 890320, PDHE: SYNTAX ERRORS                 * 06450000
.* $P5=PEO2712 , HBB4410, 891129, PDHD: CONSOLE INTEGRATION           * 06500000
.* $01=OY47869 , HBB4410, 911021, PDHD: ROLL UP OY23559               * 06550000
.*     D53CDFG                        : ADAPTION FOR VSE/ESA          * 06575061
.*                                                                    * 06600000
.*01* MESSAGES=                                                   @L1A* 06650000
.*    IF THE REPLY KEYWORD IS SPECIFIED, THE FOLLOWING            @01A* 06700000
.*    WARNING MESSAGES MAY BE ISSUED:                             @01A* 06750000
.*                                                                @01A* 06800000
.*    FOR "NEW FORMAT" EXPANSIONS:                                @01A* 06850000
.*    'REPLY IGNORED. IT IS NOT VALID WITH MSG'                   @L1A* 06900000
.*    'REPLY IGNORED. IT IS NOT VALID WITH MSGLIST'               @L1A* 06950000
.*                                                                    * 07000000
.*    FOR "OLD FORMAT" EXPANSIONS:                                @01A* 07050000
.*    'REPLY OPERAND NOT YES. REPLY KEYWORD IGNORED.'             @01A* 07100000
.*                                                                    * 07150000
.*        THE DOM MACRO WILL ISSUE THE FOLLOWING                  @L1A* 07200000
.*        MNOTES UPON THE DETECTION OF SYNTAX ERRORS:             @L1A* 07250000
.*                                                                    * 07300000
.*02*   WARNINGS = (SEVERITY 4)                                   @L1A* 07350000
.*                                                                    * 07400000
.*    'MSG IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX'     @L1A* 07450000
.*    'MSGLIST IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX' @L1A* 07500000
.*    'SYSID IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX'   @L1A* 07550000
.*    'TOKEN IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX'   @L1A* 07600000
.*    'COUNT IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX'   @L1A* 07650000
.*    'LINKAGE IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX' @L2A* 07700000
.*    'DOMCBLK IS TOO LONG. ARGUMENTS ARE IGNORED AFTER XXXXXXXX' @L1A* 07750000
.*    'SCOPE=SYSTEMS ASSUMED. SPECIFIED SCOPE VALUE WAS NOT       @D1A* 07800000
.*     SYSTEMS OR SYSTEM'                                         @D1A* 07850000
.*                                                                    * 07900000
.*                                                                    * 07950000
.*                                                                    * 08000000
.*02*   ERRORS = (SEVERITY 12)                                    @L1A* 08050000
.*                                                                    * 08100000
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH SYSID'          @L1A* 08150000
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH TOKEN'          @L1A* 08200000
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH COUNT'          @L1A* 08250000
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH DOMCBLK'        @D1A* 08300000
.*    'NO TEXT GENERATED. REPLY IS NOT VALID WITH SCOPE'          @D1A* 08350000
.*    'NO TEXT GENERATED.                                         @L1A* 08400000
.*      MSG OR MSGLIST OR DOMCBLK OR SYSID OR TOKEN IS REQUIRED   @L1A* 08450000
.*      BUT NOT SPECIFIED'                                        @L1A* 08500000
.*    'NO TEXT GENERATED.                                         @L1A* 08550000
.*      MSG IS MUTUALLY EXCLUSIVE WITH TOKEN'                     @L1A* 08600000
.*    'NO TEXT GENERATED.                                         @L1A* 08650000
.*      MSG IS MUTUALLY EXCLUSIVE WITH MSGLIST'                   @L1A* 08700000
.*    'NO TEXT GENERATED.                                         @L1A* 08750000
.*      MSGLIST IS MUTUALLY EXCLUSIVE WITH TOKEN'                 @L1A* 08800000
.*    'NO TEXT GENERATED.                                         @L1A* 08850000
.*      TOKEN IS MUTUALLY EXCLUSIVE WITH COUNT'                   @L1A* 08900000
.*    'NO TEXT GENERATED.                                         @L1A* 08950000
.*      SYSID IS MUTUALLY EXCLUSIVE WITH COUNT'                   @L1A* 09000000
.*    'NO TEXT GENERATED.                                         @D1A* 09050000
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH MSG'                   @D1A* 09100000
.*    'NO TEXT GENERATED.                                         @D1A* 09150000
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH MSGLIST'               @D1A* 09200000
.*    'NO TEXT GENERATED.                                         @D1A* 09250000
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH SYSID'                 @D1A* 09300000
.*    'NO TEXT GENERATED.                                         @D1A* 09350000
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH TOKEN'                 @D1A* 09400000
.*    'NO TEXT GENERATED.                                         @D1A* 09450000
.*      DOMCBLK IS MUTUALLY EXCLUSIVE WITH COUNT'                 @D1A* 09500000
.*    'NO TEXT GENERATED. A FIRST OPERAND IN THE                  @L1A* 09550000
.*      XXXXXXX KEYWORD LIST IS REQUIRED BUT NOT SUPPLIED'        @L1A* 09600000
.*       WHERE XXXXXXX CAN BE MSG, MSGLIST, TOKEN, DOMCBLK,       @L1A* 09650000
.*         COUNT OR SYSID                                         @L1A* 09700000
.*    'NO TEXT GENERATED. SPECIFIED LINKAGE VALUE WAS NOT         @L2A* 09750000
.*      SVC OR BRANCH.'                                           @L2A* 09800000
.*    'DOM NOT SUPPORTED ON VSE FOR SPLEVEL LESS THAN 4'       @D61CDFG 09810061
.*    'PARAMETER XXXXXXXX NOT SUPPORTED ON VSE'                @D61CDFG 09820061
.*      XXXXXXXX CAN BE COUNT, DOMCBLK, LINKAGE, MSGLIST       @D61CDFG 09830061
.*                      REPLY, SCOPE, SYSID, TOKEN             @D61CDFG 09840061
.*                                                                    * 09850000
.*                                                                    * 09900000
.********************************************************************** 09950000
.*                                                                    * 10000000
.*                                                                    * 10050000
.*   A '¬' IS USED AS THE DEFAULT VALUE FOR EACH KEYWORD.         @L1A* 10100000
.*   THIS IS DONE INORDER TO CHECK FOR A KEYWORD THAT WAS         @L1A* 10150000
.*   SPECIFIED WITH NO OPERANDS. FOR EXAMPLE:                     @L1A* 10200000
.*                DOM MSG=                                        @L1A* 10250000
.*                DOM MSG=,SYSID=A                                @L1A* 10300000
.********************************************************************** 10350000
.*                                                                      10400000
&NAME    DOM   &MSG=¬,&MSGLIST=¬,&REPLY=¬,&COUNT=¬,&DOMCBLK=¬,         X10450000
               &SYSID=¬,&TOKEN=¬,&SCOPE=¬,&LINKAGE=¬               @P5C 10500000
.*                                                                      10550000
.*   DEFINE GLOBAL VARIABLES                                            10575061
.*                                                                      10600000
         GBLC  &SYSSPLV                                        @D61CDFG 10616661
.*                                                                      10633261
.*   DEFINE INTERNAL VARIABLES                                          10650000
.*                                                                      10700000
         LCLC  &MUTUAL1    USED FOR MUTUALLY EXCLUSIVE KEYWORDS    @L1A 10750000
         LCLC  &MUTUAL2    USED FOR MUTUALLY EXCLUSIVE KEYWORDS    @L1A 10800000
         LCLC  &RPYIND1    USED FOR REPLY INVALID MESSAGE          @L1A 10850000
         LCLC  &MSGWORD    USED FOR NO OPERANDS SPECIFIED MESSAGE  @L1A 10900000
         LCLC  &MSGVAL1    USED FOR MORE THAN ONE OPERAND SPECIFIED    X10950000
                           MESSAGE                                 @L1A 11000000
         LCLC  &MSGVAL2    USED FOR MORE THAN ONE OPERAND SPECIFIED    X11050000
                           MESSAGE                                 @L1A 11100000
         LCLB  &OLDFMT     ON IF OLD FORMAT INPUT TO BE GENERATED      X11150000
                           (NO KYWDS NEW IN JBB2220 OR LATER)      @01A 11200000
         LCLA  &RPYINDC    REPLY OPERAND INDICATOR                 @01A 11250000
         LCLC  &NSUPOP     UNSOPPORTED OPERAND FOR VSE         @D61CDFG 11251661
.*                                                                      11253261
.*  CHECK FOR RIGHT VSE SPLEVEL AND FOR UNSUPPORTED PARAMETERS @D61CDFG 11254861
.*                                                                      11256461
         SPLEVEL TEST                                          @D61CDFG 11258061
         AIF   ('&SYSSPLV' GE '4').VSEPARM                     @D61CDFG 11259661
         MNOTE 12,'DOM NOT SUPPORTED ON VSE FOR SPLEVEL LESS THAN 4'   X11261261
                                                               @D61CDFG 11262861
         MEXIT                                                 @D61CDFG 11264461
.VSEPARM ANOP                                                  @D61CDFG 11266061
&NSUPOP  SETC  'COUNT'                                         @D61CDFG 11267661
         AIF   ('&COUNT' NE '¬').NSUPOP                        @D61CDFG 11269261
&NSUPOP  SETC  'DOMCBLK'                                       @D61CDFG 11270861
         AIF   ('&DOMCBLK' NE '¬').NSUPOP                      @D61CDFG 11272461
&NSUPOP  SETC  'LINKAGE'                                       @D61CDFG 11274061
         AIF   ('&LINKAGE' NE '¬').NSUPOP                      @D61CDFG 11275661
&NSUPOP  SETC  'MSGLIST'                                       @D61CDFG 11277261
         AIF   ('&MSGLIST' NE '¬').NSUPOP                      @D61CDFG 11278861
&NSUPOP  SETC  'REPLY'                                         @D61CDFG 11280461
         AIF   ('&REPLY' NE '¬').NSUPOP                        @D61CDFG 11282061
&NSUPOP  SETC  'SCOPE'                                         @D61CDFG 11283661
         AIF   ('&SCOPE' NE '¬').NSUPOP                        @D61CDFG 11285261
&NSUPOP  SETC  'SYSID'                                         @D61CDFG 11286861
         AIF   ('&SYSID' NE '¬').NSUPOP                        @D61CDFG 11288461
&NSUPOP  SETC  'TOKEN'                                         @D61CDFG 11290061
         AIF   ('&TOKEN' EQ '¬').GENVSE                        @D61CDFG 11291661
.NSUPOP  MNOTE 12,'PARAMETER ''&NSUPOP'' NOT SUPPORTED ON VSE' @D61CDFG 11293261
         MEXIT                                                 @D61CDFG 11294861
.GENVSE  ANOP                                                  @D61CDFG 11296461
.*                                                                      11300000
.*  CHECK IF ONE OF THE REQUIRED OPERANDS IS SPECIFIED (MSG,       @L1A 11350000
.*   MSGLIST, SYSID, TOKEN, DOMCBLK)                               @L1A 11400000
.*                                                                      11450000
         AIF   ('&MSG(1)' NE '¬' OR '&MSGLIST(1)' NE '¬' OR            X11500000
               '&SYSID(1)' NE '¬' OR '&TOKEN(1)' NE '¬' OR             X11550000
               '&DOMCBLK(1)' NE '¬').DOML00                        @01C 11600000
         MNOTE 12,'***   NO TEXT GENERATED. ''MSG'' OR ''MSGLIST'' OR  X11650000
               ''DOMCBLK'''                                        @L1A 11700000
         MNOTE    '               OR ''SYSID'' OR ''TOKEN'' IS REQUIREDX11750000
                BUT NOT SPECIFIED.'                                @L1A 11800000
         MEXIT                                                     @L1A 11850000
.*                                                                      11900000
.*  CHECK IF ANY KEYWORDS NEW IN JBB2220 OR LATER ARE SPECIFIED.   @01A 11950000
.*   IF NOT, WILL GENERATE OLD-FORMAT INPUT.                       @01A 12000000
.*                                                                      12050000
.DOML00  AIF   ('&SYSID(1)' NE '¬' OR '&COUNT(1)' NE '¬' OR            X12100000
               '&DOMCBLK(1)' NE '¬' OR '&TOKEN(1)' NE '¬' OR           X12150000
               '&SCOPE(1)' NE '¬' OR '&LINKAGE(1)' NE '¬').DOML01  @01A 12200000
&OLDFMT  SETB  1          USE OLD FORMAT INPUT                     @01A 12250000
.*                                                                      12300000
.*  CHECK FOR MUTUALLY EXCLUSIVE KEYWORDS:                         @L1A 12350000
.*           MSG AND MSGLIST                                       @L1A 12400000
.*           MSG AND TOKEN                                         @L1A 12450000
.*           MSGLIST AND TOKEN                                     @L1A 12500000
.*           SYSID AND COUNT                                       @L1A 12550000
.*           TOKEN AND COUNT                                       @L1A 12600000
.*           DOMCBLK AND MSG                                       @D1A 12650000
.*           DOMCBLK AND MSGLIST                                   @D1A 12700000
.*           DOMCBLK AND SYSID                                     @D1A 12750000
.*           DOMCBLK AND TOKEN                                     @D1A 12800000
.*           DOMCBLK AND COUNT                                     @D1A 12850000
.*                                                                      12900000
.*                                                                      12950000
.*  CHECK IF MSG AND MSGLIST KEYWORDS ARE SPECIFIED                @L1A 13000000
.*                                                                      13050000
.DOML01  AIF   ('&MSG(1)' EQ '¬').DOML03                           @L1A 13100000
         AIF   ('&MSGLIST(1)' EQ '¬').DOML02                       @L1A 13150000
&MUTUAL1 SETC  'MSG'        SET MSG AS THE FIRST KEYWORD FOR MUTUALLY  X13200000
                            EXCLUSIVE MESSAGE                      @L1A 13250000
&MUTUAL2 SETC  'MSGLIST'    SET MSGLIST AS THE SECOND KEYWORD FOR      X13300000
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 13350000
         AGO   .DOML069                                            @D1C 13400000
.*                                                                      13450000
.*  CHECK IF MSG AND TOKEN KEYWORDS ARE SPECIFIED                  @L1A 13500000
.*                                                                      13550000
.DOML02  AIF   ('&TOKEN(1)' EQ '¬').DOML03                              13600000
&MUTUAL1 SETC  'MSG'        SET MSG AS THE FIRST KEYWORD FOR MUTUALLY  X13650000
                            EXCLUSIVE MESSAGE                      @L1A 13700000
&MUTUAL2 SETC  'TOKEN'      SET TOKEN AS THE SECOND KEYWORD FOR        X13750000
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 13800000
         AGO   .DOML069                                            @D1C 13850000
.*                                                                      13900000
.*  CHECK IF MSGLIST AND TOKEN KEYWORDS ARE SPECIFIED              @L1A 13950000
.*                                                                      14000000
.DOML03  AIF   ('&MSGLIST(1)' EQ '¬').DOML05                       @L1A 14050000
         AIF   ('&TOKEN(1)' EQ '¬').DOML05                         @L1A 14100000
&MUTUAL1 SETC  'MSGLIST'    SET MSGLIST AS THE FIRST KEYWORD FOR       X14150000
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 14200000
&MUTUAL2 SETC  'TOKEN'      SET TOKEN AS THE SECOND KEYWORD FOR        X14250000
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 14300000
         AGO   .DOML069                                            @D1C 14350000
.*                                                                      14400000
.*  CHECK IF SYSID AND COUNT KEYWORDS ARE SPECIFIED                @L1A 14450000
.*                                                                      14500000
.DOML05  AIF   ('&SYSID(1)' EQ '¬').DOML06                         @L1A 14550000
         AIF   ('&COUNT(1)' EQ '¬').DOML06                         @L1A 14600000
&MUTUAL1 SETC  'SYSID'      SET SYSID AS THE FIRST KEYWORD FOR         X14650000
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 14700000
&MUTUAL2 SETC  'COUNT'      SET COUNT AS THE SECOND KEYWORD FOR        X14750000
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 14800000
         AGO   .DOML069                                            @D1C 14850000
.*                                                                      14900000
.*  CHECK IF TOKEN AND COUNT KEYWORDS ARE SPECIFIED                @L1A 14950000
.*                                                                      15000000
.DOML06  AIF   ('&TOKEN(1)' EQ '¬').DOML061                        @L1A 15050000
         AIF   ('&COUNT(1)' EQ '¬').DOML061                        @L1A 15100000
&MUTUAL1 SETC  'TOKEN'      SET TOKEN AS THE FIRST KEYWORD FOR         X15150000
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 15200000
&MUTUAL2 SETC  'COUNT'      SET COUNT AS THE SECOND KEYWORD FOR        X15250000
                            MUTUALLY EXCLUSIVE MESSAGE             @L1A 15300000
         AGO   .DOML069                                            @D1A 15350000
.*                                                                      15400000
.*                                                                      15450000
.*  CHECK IF DOMCBLK AND MSG KEYWORDS ARE SPECIFIED                @D1A 15500000
.*                                                                      15550000
.*                                                                      15600000
.DOML061 AIF   ('&DOMCBLK(1)' EQ '¬').DOML07                       @D1A 15650000
&MUTUAL1 SETC  'DOMCBLK'    SET DOMCBLK AS THE FIRST KEYWORD FOR       X15700000
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 15750000
         AIF   ('&MSG(1)' EQ '¬').DOML062                          @D1A 15800000
&MUTUAL2 SETC  'MSG'        SET MSG AS THE SECOND KEYWORD FOR          X15850000
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 15900000
         AGO   .DOML069                                            @D1A 15950000
.*                                                                      16000000
.*  CHECK IF DOMCBLK AND MSGLIST KEYWORDS ARE SPECIFIED            @D1A 16050000
.*                                                                      16100000
.DOML062 AIF   ('&MSGLIST(1)' EQ '¬').DOML063                      @D1A 16150000
&MUTUAL2 SETC  'MSGLIST'    SET MSGLIST AS THE SECOND KEYWORD FOR      X16200000
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 16250000
         AGO   .DOML069                                            @D1A 16300000
.*                                                                      16350000
.*  CHECK IF DOMCBLK AND SYSID KEYWORDS ARE SPECIFIED              @D1A 16400000
.*                                                                      16450000
.DOML063 AIF   ('&SYSID(1)' EQ '¬').DOML064                        @D1A 16500000
&MUTUAL2 SETC  'SYSID'      SET SYSID AS THE SECOND KEYWORD FOR        X16550000
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 16600000
         AGO   .DOML069                                            @D1A 16650000
.*                                                                      16700000
.*  CHECK IF DOMCBLK AND TOKEN KEYWORDS ARE SPECIFIED              @D1A 16750000
.*                                                                      16800000
.DOML064 AIF   ('&TOKEN(1)' EQ '¬').DOML065                        @D1A 16850000
&MUTUAL2 SETC  'TOKEN'      SET TOKEN AS THE SECOND KEYWORD FOR        X16900000
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 16950000
         AGO   .DOML069                                            @D1A 17000000
.*                                                                      17050000
.*  CHECK IF DOMCBLK AND COUNT KEYWORDS ARE SPECIFIED              @D1A 17100000
.*                                                                      17150000
.DOML065 AIF   ('&COUNT(1)' EQ '¬').DOML07                         @D1A 17200000
&MUTUAL2 SETC  'COUNT'      SET COUNT AS THE SECOND KEYWORD FOR        X17250000
                            MUTUALLY EXCLUSIVE MESSAGE             @D1A 17300000
.*                                                                      17350000
.*                                                                      17400000
.*  ISSUE MNOTE FOR MUTUALLY EXCLUSIVE KEYWORDS                    @L1A 17450000
.*                                                                      17500000
.*                                                                      17550000
.DOML069 MNOTE 12,'*** NO TEXT GENERATED. ''&MUTUAL1'' IS MUTUALLY EXCLX17600000
               USIVE WITH'                                         @D1C 17650000
         MNOTE  '            ''&MUTUAL2''.'                        @L1A 17700000
         MEXIT                                                     @L1A 17750000
.*                                                                      17800000
.*                                                                      17850000
.*  CHECK IF REPLY KEYWORD SPECIFIED                               @L1A 17900000
.*                                                                      17950000
.DOML07  AIF   ('&REPLY(1)' EQ '¬').DOML1                               18000000
.*                                                                      18050000
.*                                                                      18100000
.* IF OLD FORMAT INPUT IS BEING USED, CHECK REPLY=YES              @01A 18150000
         AIF   (NOT(&OLDFMT)).DOML08                               @01A 18200000
         AIF   ('&REPLY' EQ 'YES').DOML71                          @01A 18250000
.* REPLY OPERAND IS IN ERROR                                       @01A 18300000
         MNOTE 4,'*** REPLY OPERAND NOT YES. REPLY KEYWORD IGNORED.'    18350000
         AGO   .DOML1                                              @01A 18400000
.DOML71  ANOP             REPLY OPERAND WAS 'YES' BRANCH PT        @01A 18450000
&RPYINDC SETA  4          SHOW THAT REPLY = YES USED               @01A 18500000
.*                                                                      18550000
.*  CHECK IF REPLY AND SYSID KEYWORDS ARE SPECIFIED                @L1A 18600000
.*                                                                      18650000
.DOML08  AIF   ('&SYSID(1)' EQ '¬').DOML081                        @L1A 18700000
&RPYIND1 SETC  'SYSID'                     INDICATE SYSID          @L1A 18750000
         AGO   .DOML085                                            @L1A 18800000
.*                                                                      18850000
.*  CHECK IF REPLY AND TOKEN KEYWORDS ARE SPECIFIED                @L1A 18900000
.*                                                                      18950000
.DOML081 AIF   ('&TOKEN(1)' EQ '¬').DOML082                        @L1A 19000000
&RPYIND1 SETC  'TOKEN'                     INDICATE TOKEN          @L1A 19050000
         AGO   .DOML085                                            @L1A 19100000
.*                                                                      19150000
.*  CHECK IF REPLY AND COUNT KEYWORDS ARE SPECIFIED                @L1A 19200000
.*                                                                      19250000
.DOML082 AIF   ('&COUNT(1)' EQ '¬').DOML083                        @D1C 19300000
&RPYIND1 SETC  'COUNT'                     INDICATE COUNT          @L1A 19350000
         AGO   .DOML085                                            @D1A 19400000
.*                                                                      19450000
.*  CHECK IF REPLY AND DOMCBLK KEYWORDS ARE SPECIFIED              @D1A 19500000
.*                                                                      19550000
.DOML083 AIF   ('&DOMCBLK(1)' EQ '¬').DOML084                      @D1A 19600000
&RPYIND1 SETC  'DOMCBLK'                   INDICATE DOMCBLK        @D1A 19650000
         AGO   .DOML085                                            @D1A 19700000
.*                                                                      19750000
.*  CHECK IF REPLY AND SCOPE KEYWORDS ARE SPECIFIED                @D1A 19800000
.*                                                                      19850000
.DOML084 AIF   ('&SCOPE(1)' EQ '¬').DOML086                        @D1A 19900000
&RPYIND1 SETC  'SCOPE'                     INDICATE SCOPE          @D1A 19950000
.*                                                                      20000000
.*                                                                      20050000
.*  ISSUE MNOTE IF REPLY KEYWORD IS SPECIFIED WITH TOKEN OR SYSID  @L1A 20100000
.*  OR COUNT OR DOMCBLK OR SCOPE KEYWORD                           @D1C 20150000
.*                                                                      20200000
.*                                                                      20250000
.DOML085 MNOTE 12,'*** NO TEXT GENERATED. ''REPLY'' IS NOT VALID WITH 'X20300000
               '&RPYIND1''.'                                       @D1C 20350000
         MEXIT                                                     @L1A 20400000
.*                                                                      20450000
.*  CHECK IF REPLY AND MSG KEYWORDS ARE SPECIFIED                  @L1A 20500000
.*                                                                      20550000
.DOML086 AIF   ('&MSG(1)' EQ '¬').DOML09                                20600000
&RPYIND1 SETC  'MSG'                       INDICATE MSG            @L1A 20650000
         AGO   .DOML095                                            @L1A 20700000
.*                                                                      20750000
.*  CHECK IF REPLY AND MSGLIST KEYWORDS ARE SPECIFIED              @L1A 20800000
.*                                                                      20850000
.DOML09  AIF   ('&MSGLIST(1)' EQ '¬').DOML1                             20900000
&RPYIND1 SETC  'MSGLIST'                   INDICATE MSGLIST        @L1A 20950000
.*                                                                      21000000
.*                                                                      21050000
.*  ISSUE WARNING MESSAGE FOR REPLY AND MSG OR MSGLIST KEYWORDS    @P1C 21100000
.*  SPECIFIED                                                      @P1C 21150000
.*                                                                      21200000
.*                                                                      21250000
.DOML095 AIF    (&OLDFMT).DOML1                                    @01C 21300000
         MNOTE  '** WARNING ** ''REPLY'' IGNORED. IT IS NOT VALID WITH X21350000
               ''&RPYIND1''.'                                      @01C 21400000
.*                                                                      21450000
.*  CHECK TO SEE IF THE KEYWORDS THAT WERE SPECIFIED CONTAIN       @L1A 21500000
.*  VALID OPERANDS                                                 @L1A 21550000
.*                                                                      21600000
.DOML1   ANOP                                                           21650000
.*   MSG KEYWORD SPECIFIED                                         @L1A 21700000
         AIF   ('&MSG(1)' EQ '¬').DOMLM                            @L1A 21750000
.*  CHECK TO SEE IF VALID OPERANDS SPECIFIED WITH MSG              @L1A 21800000
         AIF   ('&MSG(1)' EQ '').DOML2     NO OPERANDS SPECIFIED   @L1A 21850000
         AIF   (N'&MSG GT 1 OR N'&MSG(1) GT 1 ).DOML21 MORE THAN ONE   X21900000
                                                OPERAND SPECIFIED  @L1A 21950000
         AGO   .DOMLM                                              @L1A 22000000
.*                                                                 @L1A 22050000
.DOML2   ANOP                                                           22100000
&MSGWORD SETC  'MSG'          SAVE MSG KEYWORD FOR ERROR MESSAGE   @L1A 22150000
         AGO   .DOML175                                            @L1A 22200000
.*                                                                 @L1A 22250000
.DOML21  ANOP                                                      @L1A 22300000
         MNOTE  4,'*** ''MSG=&MSG'' IS TOO LONG. ARGUMENTS ARE IGNORED' 22350000
         MNOTE  '             AFTER ''&MSG(1,1)''.'                @L1A 22400000
.*                                                                      22450000
.*     MSGLIST KEYWORD SPECIFIED                                   @L1A 22500000
.*                                                                      22550000
.DOMLM   AIF   ('&MSGLIST(1)' EQ '¬').DOMLT                        @L1A 22600000
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH MSGLIST     @L1A 22650000
         AIF   ('&MSGLIST(1)' EQ '').DOML8   NO OPERANDS SPECIFIED @L1A 22700000
         AIF   (N'&MSGLIST GT 1 OR N'&MSGLIST(1) GT 1).DOML81 MORE THANX22750000
                                             ONE OPERAND SPECIFIED @L1A 22800000
         AGO   .DOMLT                                              @L1A 22850000
.*                                                                      22900000
.DOML8   ANOP                                                           22950000
&MSGWORD SETC  'MSGLIST'        SAVE MSGLIST KEYWORD FOR ERROR MESSAGE X23000000
                                                                   @L1A 23050000
         AGO   .DOML175                                            @L1A 23100000
.*                                                                      23150000
.DOML81  ANOP                                                      @L1A 23200000
         MNOTE  4,'*** ''MSGLIST=&MSGLIST'' IS TOO LONG. ARGUMENTS ARE' 23250000
         MNOTE  '             IGNORED AFTER ''&MSGLIST(1,1)''.'    @L1A 23300000
.*                                                                      23350000
.*     TOKEN KEYWORD SPECIFIED                                     @L1A 23400000
.*                                                                      23450000
.DOMLT   AIF   ('&TOKEN(1)' EQ '¬').DOMLS                          @L1A 23500000
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH TOKEN       @L1A 23550000
         AIF   ('&TOKEN(1)' EQ '').DOML10    NO OPERANDS SPECIFIED @L1A 23600000
         AIF   (N'&TOKEN GT 1 OR N'&TOKEN(1) GT 1).DOML101 MORE THAN   X23650000
                                             ONE OPERAND SPECIFIED @L1A 23700000
         AGO   .DOMLS                                              @L1A 23750000
.*                                                                      23800000
.DOML10  ANOP                                                           23850000
&MSGWORD SETC  'TOKEN'        SAVE TOKEN KEYWORD FOR ERROR MESSAGE @L1A 23900000
         AGO   .DOML175                                            @L1A 23950000
.*                                                                      24000000
.DOML101 ANOP                                                      @L1A 24050000
         MNOTE  4,'*** ''TOKEN=&TOKEN'' IS TOO LONG. ARGUMENTS ARE'     24100000
         MNOTE  '             IGNORED AFTER ''&TOKEN(1,1)''.'      @L1A 24150000
.*                                                                      24200000
.*     SYSID KEYWORD SPECIFIED                                     @L1A 24250000
.*                                                                      24300000
.DOMLS   AIF   ('&SYSID(1)' EQ '¬').DOMLD                          @L1A 24350000
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH SYSID       @L1A 24400000
         AIF   ('&SYSID(1)' EQ '').DOML12    NO OPERANDS SPECIFIED @L1A 24450000
         AIF   (N'&SYSID GT 1 OR N'&SYSID(1) GT 1).DOML121 MORE THAN   X24500000
                                             ONE OPERAND SPECIFIED @L1A 24550000
         AGO   .DOMLD                                              @L1A 24600000
.*                                                                      24650000
.DOML12  ANOP                                                           24700000
&MSGWORD SETC  'SYSID'       SAVE SYSID KEYWORD FOR ERROR MESSAGE  @L1A 24750000
         AGO   .DOML175                                            @L1A 24800000
.*                                                                      24850000
.DOML121 ANOP                                                      @L1A 24900000
         MNOTE  4,'*** ''SYSID=&SYSID'' IS TOO LONG. ARGUMENTS ARE'     24950000
         MNOTE  '             IGNORED AFTER ''&SYSID(1,1)''.'      @L1A 25000000
.*                                                                      25050000
.*     DOMCBLK KEYWORD SPECIFIED                                   @L1A 25100000
.*                                                                      25150000
.DOMLD   AIF   ('&DOMCBLK(1)' EQ '¬').DOMLL                        @L2C 25200000
.*  CHECK TO SEE IF IF VALID OPERANDS WERE SPECIFIED WITH DOMCBLK  @L1A 25250000
         AIF   ('&DOMCBLK(1)' EQ '').DOML14   NO OPERAND SPECIFIED @L1A 25300000
         AIF   (N'&DOMCBLK GT 1 OR N'&DOMCBLK(1) GT 1).DOML141 MORE    X25350000
                                        THAN ONE OPERAND SPECIFIED @L1A 25400000
         AGO   .DOMLL                                              @L2C 25450000
.*                                                                      25500000
.DOML14  ANOP                                                           25550000
&MSGWORD SETC  'DOMCBLK'        SAVE DOMCBLK KEYWORD FOR ERROR MESSAGE X25600000
                                                                   @L1A 25650000
         AGO   .DOML175                                            @L1A 25700000
.*                                                                      25750000
.DOML141 ANOP                                                      @L1A 25800000
         MNOTE  4,'*** ''DOMCBLK=&DOMCBLK'' IS TOO LONG. ARGUMENTS ARE' 25850000
         MNOTE  '             IGNORED AFTER ''&DOMCBLK(1,1)''.'    @L1A 25900000
.*                                                                      25950000
.*                                                                      26000000
.*     LINKAGE KEYWORD SPECIFIED                                   @L2A 26050000
.*                                                                      26100000
.DOMLL   AIF   ('&LINKAGE(1)' EQ '¬').DOMLY                        @L2A 26150000
.*  CHECK TO SEE IF IF VALID OPERANDS WERE SPECIFIED WITH LINKAGE  @L2A 26200000
         AIF   ('&LINKAGE(1)' NE 'SVC' AND                             X26250000
                '&LINKAGE(1)' NE 'BRANCH').DOMLL1  ISSUE ERROR MSG @L2A 26300000
         AIF   (N'&LINKAGE GT 1 OR N'&LINKAGE(1) GT 1).DOMLL2  MORE    X26350000
                                        THAN ONE OPERAND SPECIFIED @L2A 26400000
         AGO   .DOMLY                                              @L2A 26450000
.*                                                                      26500000
.DOMLL1  ANOP                                                      @L2A 26550000
         MNOTE  12,'NO TEXT GENERATED. SPECIFIED LINKAGE '         @L2A 26600000
         MNOTE  '       VALUE WAS NOT SVC OR BRANCH.'              @L2A 26650000
         MEXIT                                                     @L2A 26700000
.*                                                                      26750000
.DOMLL2  ANOP                                                      @L2A 26800000
         MNOTE  4,'*** ''LINKAGE=&LINKAGE'' IS TOO LONG. ARGUMENTS ARE' 26850000
         MNOTE  '             IGNORED AFTER ''&LINKAGE(1,1)''.'    @L2A 26900000
.*                                                                      26950000
.*     COUNT   KEYWORD SPECIFIED                                   @L1A 27000000
.*                                                                      27050000
.DOMLY   AIF   ('&COUNT(1)' EQ '¬').DOML178                        @P5C 27100000
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH COUNT       @L1A 27150000
         AIF   ('&COUNT(1)' EQ '').DOML16    NO OPERANDS SPECIFIED @L1A 27200000
         AIF   (N'&COUNT GT 1 OR N'&COUNT(1) GT 1).DOML161 MORE THAN   X27250000
                                            ONE OPERAND SPECIFIED  @L1A 27300000
         AGO   .DOML178                                            @D1C 27350000
.*                                                                      27400000
.DOML16  ANOP                                                           27450000
&MSGWORD SETC  'COUNT'       SAVE COUNT KEYWORD FOR ERROR MESSAGE  @L1A 27500000
         AGO   .DOML175                                            @L1A 27550000
.*                                                                      27600000
.DOML161 ANOP                                                      @L1A 27650000
         MNOTE  4,'*** ''COUNT=&COUNT'' IS TOO LONG. ARGUMENTS ARE'     27700000
         MNOTE  '             IGNORED AFTER ''&COUNT(1,1)''.'      @L1A 27750000
         AGO   .DOML178                                            @D1C 27800000
.*                                                                 @L1A 27850000
.*                                                                      27900000
.*    ISSUE THE FOLLOWING MNOTE IF NO OPERANDS WERE SPECIFIED FOR A     27950000
.*    PARTICULAR KEYWORD                                           @L1A 28000000
.*                                                                      28050000
.DOML175 MNOTE 12,'*** NO TEXT GENERATED. A FIRST OPERAND IN THE '      28100000
         MNOTE  '            ''&MSGWORD'' KEYWORD LIST IS REQUIRED BUT X28150000
               NOT SUPPLIED.'                                      @L1A 28200000
         MEXIT                                                     @L1A 28250000
.*                                                                      28300000
.*                                                                      28350000
.*     SCOPE KEYWORD SPECIFIED                                     @D1A 28400000
.*                                                                      28450000
.DOML178 AIF   ('&SCOPE(1)' EQ '¬').DOML179                        @D1A 28500000
.*  CHECK TO SEE IF VALID OPERANDS WERE SPECIFIED WITH SCOPE       @D1A 28550000
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS' OR                            X28600000
                '&SCOPE(1)' EQ 'SYSTEM').DOML179 SCOPE OPERAND IS      X28650000
                                                 SYSTEMS OR SYSTEM @D1A 28700000
         MNOTE  4,'*** ''SCOPE=SYSTEMS'' ASSUMED. SPECIFIED SCOPE'      28750000
         MNOTE  '             VALUE WAS NOT ''SYSTEMS'' OR ''SYSTEM''.'X28800000
                                                                   @D1A 28850000
.*                                                                      28900000
.*  THE FOLLOWING SECTION GENERATES 'NEW-FORMAT' CODE              @01A 28950000
.*  (KEYWORDS NEW IN JBB2220 OR LATER WERE SPECIFIED)              @01A 29000000
.*                                                                      29050000
.*  GENERATE CODE FOR COUNT AND SYSID KEYWORDS                          29100000
.*                                                                      29150000
.DOML179 ANOP                                                      @L1A 29200000
         AIF (&OLDFMT).DOMLO                                       @01A 29250000
         AIF   (T'&NAME EQ 'O').DOML180  NAME SPECIFIED                 29300000
.* &NAME WAS SPECIFIED, PUT OUT A LABEL                                 29350000
&NAME    DS    0H                                                       29400000
.DOML180 AIF   ('&SYSID(1)' EQ '¬').DOML183 SYSID KEYWORD SPECIFIED@L1A 29450000
         AIF   ('&SYSID'(1,1) EQ '(').DOML181 REGISTER SPECIFIED WITH  X29500000
                                              SYSID                @L1A 29550000
         SR    0,0                       SET REGISTER TO ZERO  @YA24471 29600000
         IC    0,&SYSID(1,1)             MOVE SYSID INTO REGISTER      X29650000
                                                               @YA24471 29700000
         AGO   .DOML182                                            @L1A 29750000
.DOML181 LR    0,&SYSID(1,1)             MOVE SYSID INTO REGISTER      X29800000
                                                               @YA24471 29850000
.DOML182 SLL   0,16                      MOVE SYSID TO SYSID FIELD     X29900000
                                         OF REGISTER           @YA24471 29950000
         AGO   .DOML20                                             @L1A 30000000
.DOML183 AIF   ('&COUNT(1)' EQ '¬').DOML19  COUNT KEYWORD SPECIFIED@L1A 30050000
         AIF   ('&COUNT'(1,1) EQ '(').DOML185 REGISTER SPECIFIED WITH  X30100000
                                              COUNT                @L1A 30150000
         SR    0,0                       SET REGISTER TO ZERO  @YA24471 30200000
         IC    0,&COUNT(1,1)             MOVE COUNT INTO REGISTER      X30250000
                                                               @YA24471 30300000
         AGO   .DOML186                                            @L1A 30350000
.DOML185 LR    0,&COUNT(1,1)             MOVE COUNT TO REGISTER        X30400000
                                                               @YA24471 30450000
.DOML186 SLL   0,24                      MOVE COUNT TO COUNT FIELD OF  X30500000
                                         REGISTER              @YA24471 30550000
         AGO   .DOML20                                             @L1A 30600000
.DOML19  SR    0,0                       SET REGISTER TO ZERO  @YA24471 30650000
.*                                                                      30700000
.*    GENERATE CODE FOR MSG KEYWORD                                @L1A 30750000
.*                                                                      30800000
.DOML20  AIF   ('&MSG(1)' EQ '¬').DOML200    MSG SPECIFIED         @L1A 30850000
         AIF   ('&SYSID(1)' EQ '¬').DOML201  SYSID SPECIFIED       @L1A 30900000
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML20A  SCOPE=SYSTEMS       X30950000
                                                   SPECIFIED       @D1A 31000000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML20B  SCOPE=SYSTEM         X31050000
                                                   SPECIFIED       @D1A 31100000
         LA    15,17                     SET MSG, SYSID REQUEST TYPE INX31150000
                                         REGISTER              @YA24471 31200000
         AGO   .DOML202                                            @L1A 31250000
.DOML20A LA    15,81                     SET MSG,SYSID, SCOPE=SYSTEMS  X31300000
                                         REQUEST TYPE IN               X31350000
                                         REGISTER              @YA24471 31400000
         AGO   .DOML202                                            @L1A 31450000
.DOML20B LA    15,145                    SET MSG,SYSID, SCOPE=SYSTEM   X31500000
                                         REQUEST TYPE IN               X31550000
                                         REGISTER              @YA24471 31600000
         AGO   .DOML202                                            @D1A 31650000
.DOML201 AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML20C  SCOPE=SYSTEMS       X31700000
                                                   SPECIFIED       @D1A 31750000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML20D   SCOPE=SYSTEM        X31800000
                                                   SPECIFIED       @D1A 31850000
         LA    15,1                      SET MSG REQUEST TYPE IN       X31900000
                                         REGISTER              @YA24471 31950000
         AGO   .DOML202                                            @D1A 32000000
.DOML20C LA    15,65                     SET MSG, SCOPE=SYSTEMS REQUESTX32050000
                                         TYPE IN REGISTER      @YA24471 32100000
         AGO   .DOML202                                            @D1A 32150000
.DOML20D LA    15,129                    SET MSG, SCOPE=SYSTEM REQUEST X32200000
                                         TYPE IN REGISTER      @YA24471 32250000
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @L1A 32300000
.DOML202 AIF   ('&MSG'(1,1) EQ '(').DOML203                        @L1A 32350000
.*   OPERAND IS A NON PARENTHESIZED NAME. THEREFORE IT IS               32400000
.*   AN ADDR NAME.                                                 @L1A 32450000
         L     1,&MSG(1,1)               SET MESSAGE ID IN REGISTER 1  X32500000
                                                                   @L1A 32550000
         AGO   .DOMLE                                              @L1A 32600000
.DOML203 AIF   ('&MSG(1)' EQ '1').DOMLE  IF THE MESSAGE ID WAS         X32650000
                                         SPECIFIED IN REGISTER 1, DO   X32700000
                                         NOT RELOAD REGISTER 1     @L1A 32750000
         LR    1,&MSG(1,1)               SET MESSAGE ID IN             X32800000
                                         REGISTER 1                @L1A 32850000
         AGO   .DOMLE                                              @L1A 32900000
.*                                                                      32950000
.*                                                                      33000000
.*    GENERATE CODE FOR MSGLIST KEYWORD                            @L1A 33050000
.*                                                                      33100000
.DOML200 AIF   ('&MSGLIST(1)' EQ '¬').DOML23                       @L1A 33150000
         AIF   ('&SYSID(1)' EQ '¬').DOML22  SYSID SPECIFIED        @L1A 33200000
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML22A  SCOPE=SYSTEMS       X33250000
                                                   SPECIFIED       @D1A 33300000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML22B   SCOPE=SYSTEM        X33350000
                                                   SPECIFIED       @D1A 33400000
         LA    15,24                     SET MSGLIST, SYSID REQUEST    X33450000
                                         TYPE IN REGISTER      @YA24471 33500000
         AGO   .DOML209                                            @L1A 33550000
.DOML22A LA    15,88                     SET MSGLIST, SYSID,           X33600000
                                         SCOPE=SYSTEMS REQUEST TYPE IN X33650000
                                         REGISTER              @YA24471 33700000
         AGO   .DOML209                                            @D1A 33750000
.DOML22B LA    15,152                    SET MSGLIST, SYSID,           X33800000
                                         SCOPE=SYSTEM REQUEST TYPE IN  X33850000
                                         REGISTER              @YA24471 33900000
         AGO   .DOML209                                            @D1A 33950000
.DOML22  AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML22C  SCOPE=SYSTEMS       X34000000
                                                   SPECIFIED       @D1A 34050000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML22D   SCOPE=SYSTEM        X34100000
                                                   SPECIFIED       @D1A 34150000
         LA    15,8                      SET MSGLIST REQUEST TYPE IN   X34200000
                                         REGISTER              @YA24471 34250000
         AGO   .DOML209                                            @D1A 34300000
.DOML22C LA    15,72                     SET MSGLIST, SCOPE=SYSTEMS    X34350000
                                         REQUEST TYPE IN           @D1AX34400000
                                         REGISTER              @YA24471 34450000
         AGO   .DOML209                                            @D1A 34500000
.DOML22D LA    15,136                    SET MSGLIST, SCOPE=SYSTEM     X34550000
                                         REQUEST TYPE IN               X34600000
                                         REGISTER              @YA24471 34650000
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @L1A 34700000
.DOML209 AIF   ('&MSGLIST'(1,1) EQ '(').DOML210                    @L1A 34750000
.*   OPERAND IS A NON PARENTHESIZED NAME. THEREFORE IT IS               34800000
.*   AN ADDR NAME.                                                 @L1A 34850000
         LA    1,&MSGLIST(1,1)           SET ADDRESS OF MESSAGE IDS IN X34900000
                                         REGISTER 1                @P3C 34950000
         AGO   .DOMLE                                              @L1A 35000000
.DOML210 AIF   ('&MSGLIST(1)' EQ '1').DOMLE IF THE ADDRESS OF THE      X35050000
                                         MESSAGE IDS WAS SPECIFIED     X35100000
                                         IN REGISTER 1, DO NOT RELOAD  X35150000
                                         REGISTER 1                @L1A 35200000
         LR    1,&MSGLIST(1,1)           SET ADDRESS OF MESSAGE IDS IN X35250000
                                         REGISTER 1                @L1A 35300000
         AGO   .DOMLE                                              @L1A 35350000
.*                                                                      35400000
.*                                                                      35450000
.*   GENERATE CODE FOR DOMCBLK KEYWORD                             @L1A 35500000
.*                                                                      35550000
.DOML23  AIF   ('&DOMCBLK(1)' EQ '¬').DOML24                       @L1A 35600000
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML23A  SCOPE=SYSTEMS       X35650000
                                                   SPECIFIED       @D1A 35700000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML23B   SCOPE=SYSTEM        X35750000
                                                   SPECIFIED       @D1A 35800000
         LA    15,2                      SET DOMCBLK REQUEST TYPE IN   X35850000
                                         REGISTER              @YA24471 35900000
         AGO   .DOML23C                                            @D1A 35950000
.DOML23A LA    15,66                     SET DOMCBLK, SCOPE=SYSTEMS    X36000000
                                         REQUEST TYPE IN               X36050000
                                         REGISTER              @YA24471 36100000
         AGO   .DOML23C                                            @D1A 36150000
.DOML23B LA    15,130                    SET DOMCBLK, SCOPE=SYSTEM     X36200000
                                         REQUEST TYPE IN               X36250000
                                         REGISTER              @YA24471 36300000
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @L1A 36350000
.DOML23C AIF   ('&DOMCBLK'(1,1) EQ '(').DOML230                    @D1C 36400000
.*  OPERAND IS A NON PARENTHESIZED NAME. THEREFORE IT                   36450000
.*  IS AN ADDR NAME.                                               @L1A 36500000
         LA    1,&DOMCBLK(1,1)           SET ADDRESS OF THE DOMCB IN   X36550000
                                         REGISTER 1                @L1A 36600000
         AGO   .DOMLE                                              @L1A 36650000
.DOML230 ANOP                                                      @L1A 36700000
         AIF   ('&DOMCBLK(1)' EQ '1').DOMLE IF THE ADDRESS OF THE DOMCBX36750000
                                         WAS SPECIFIED IN REGISTER 1   X36800000
                                         DO NOT RELOAD REGISTER 1  @L1A 36850000
         LR    1,&DOMCBLK(1,1)           SET ADDRESS OF THE DOMCB IN   X36900000
                                         REGISTER 1                @L1A 36950000
         AGO   .DOMLE                                              @L1A 37000000
.*                                                                      37050000
.*                                                                      37100000
.*   GENERATE CODE FOR TOKEN AND SYSID KEYWORD                     @L1A 37150000
.*                                                                      37200000
.DOML24  AIF   ('&TOKEN(1)' NE '¬' AND '&SYSID(1)' NE '¬').DOML26  @L1A 37250000
.*   CHECK TO SEE IF TOKEN SPECIFIED                               @L1A 37300000
         AIF   ('&TOKEN(1)' NE '¬' AND '&SYSID(1)' EQ '¬').DOML27  @L1A 37350000
         AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML26A  SCOPE=SYSTEMS       X37400000
                                                   SPECIFIED       @D1A 37450000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML26B   SCOPE=SYSTEM        X37500000
                                                   SPECIFIED       @D1A 37550000
         LA    15,16                     SET SYSID REQUEST TYPE IN     X37600000
                                         REGISTER              @YA24471 37650000
         AGO   .DOML26C                                            @D1A 37700000
.DOML26A LA    15,80                     SET SYSID, SCOPE=SYSTEMS      X37750000
                                         REQUEST TYPE IN               X37800000
                                         REGISTER              @YA24471 37850000
         AGO   .DOML26C                                            @D1A 37900000
.DOML26B LA    15,144                    SET SYSID, SCOPE=SYSTEM       X37950000
                                         REQUEST TYPE IN               X38000000
                                         REGISTER              @YA24471 38050000
.DOML26C SR    1,1                       SET REGISTER 1 TO ZERO (SYSID X38100000
                                         SPECIFIED ALONE)          @D1C 38150000
         AGO   .DOMLE                                              @L1A 38200000
.DOML26  AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML26D  SCOPE=SYSTEMS       X38250000
                                                   SPECIFIED       @D1A 38300000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML26E  SCOPE=SYSTEM         X38350000
                                                   SPECIFIED       @D1A 38400000
         LA    15,48                     SET TOKEN, SYSID REQUEST      X38450000
                                         TYPE IN REGISTER      @YA24471 38500000
         AGO   .DOML27T                                            @L1A 38550000
.DOML26D LA    15,112                    SET TOKEN,SYSID, SCOPE=SYSTEMSX38600000
                                         REQUEST TYPE IN               X38650000
                                         REGISTER              @YA24471 38700000
         AGO   .DOML27T                                            @L1A 38750000
.DOML26E LA    15,176                    SET TOKEN,SYSID, SCOPE=SYSTEM X38800000
                                         REQUEST TYPE IN               X38850000
                                         REGISTER              @YA24471 38900000
         AGO   .DOML27T                                            @D1A 38950000
.DOML27  AIF   ('&SCOPE(1)' EQ 'SYSTEMS').DOML27A  SCOPE=SYSTEMS       X39000000
                                                   SPECIFIED       @D1A 39050000
         AIF   ('&SCOPE(1)' EQ 'SYSTEM').DOML27B   SCOPE=SYSTEM        X39100000
                                                   SPECIFIED       @D1A 39150000
         LA    15,32                     SET TOKEN REQUEST TYPE IN     X39200000
                                         REGISTER              @YA24471 39250000
         AGO   .DOML27T                                            @D1A 39300000
.DOML27A LA    15,96                     SET TOKEN, SCOPE=SYSTEMS      X39350000
                                         REQUEST TYPE IN               X39400000
                                         REGISTER              @YA24471 39450000
         AGO   .DOML27T                                            @D1A 39500000
.DOML27B LA    15,160                    SET TOKEN, SCOPE=SYSTEM       X39550000
                                         REQUEST TYPE IN               X39600000
                                         REGISTER              @YA24471 39650000
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @L1A 39700000
.DOML27T AIF   ('&TOKEN'(1,1) EQ '(').DOML270                      @L1A 39750000
.*   OPERAND IS A NON PARENTHESIZED NAME. THEREFORE IT IS               39800000
.*   AN ADDR NAME.                                                 @L1A 39850000
         L     1,&TOKEN(1,1)             SET TOKEN IN REGISTER 1   @L1A 39900000
         AGO   .DOMLE                                              @L1A 39950000
.DOML270 ANOP                                                      @L1A 40000000
         AIF   ('&TOKEN(1)' EQ '1').DOMLE IF THE TOKEN WAS SPECIFIED   X40050000
                                         IN REGISTER 1, DO NOT RELOAD  X40100000
                                         REGISTER 1                @L1A 40150000
         LR    1,&TOKEN(1,1)             SET TOKEN IN REGISTER 1   @L1A 40200000
.DOMLE   ANOP                                                      @P5C 40250000
         AIF   ('&LINKAGE(1)' EQ 'BRANCH').DOMBALR                 @L2A 40300000
         OR    0,15                      SET REG0 INPUT VALUES @YA24471 40350000
         SIMSVC .                                              @D61CDFG 40375061
         SVC   87                        ISSUE DOM SVC                  40400000
         MEXIT                                                     @01C 40450000
.DOMBALR ANOP                                                      @L2A 40500000
         LA    15,256(15)                SET LINKAGE=BRANCH BIT    @L2A 40550000
         OR    0,15                      SET REG0 INPUT VALUES @YA24471 40600000
         L     15,16(0,0)                ADDRESS OF CVT            @L2A 40650000
         L     15,200(0,15)              ADDRESS OF SCVT           @L2A 40700000
         L     15,24(0,15)               DOM BRANCH ENTRY POINT    @L2A 40750000
         BALR  14,15                     BRANCH TO B.E. DOM ENTRY POINT+40800000
                                                                   @L2A 40850000
         MEXIT                                                     @01C 40900000
.*                                                                 @01A 40950000
.*  THE FOLLOWING SECTION GENERATES 'OLD-FORMAT' CODE              @01A 41000000
.*  (THE ONLY KEYWORDS USED EXISTED BEFORE JBB2220)                @01A 41050000
.DOMLO   ANOP                                                      @01A 41100000
.*  EITHER MSG OR MSGLIST WAS SPECIFIED. CHECK IF IT WAS MSG.      @01A 41150000
         AIF   ('&MSG(1)' EQ '¬').DOMO7                            @01A 41200000
.* CHECK IF REGISTER OR LABEL WAS SPECIFIED.                       @01A 41250000
         AIF   ('&MSG'(1,1) NE '(').DOMO01                         @01A 41300000
.* YES, REGISTER - CHECK IF REGISTER 1                             @01A 41350000
.DOMO0   AIF   ('&MSG(1)' NE '1').DOMO1                            @01A 41400000
.* YES, REGISTER IS 1. CHECK IF &NAME WAS SPECIFIED.               @01A 41450000
         AIF   (T'&NAME EQ 'O').DOMO2                              @01A 41500000
.* &NAME WAS SPECIFIED, PUT OUT A LABEL                            @01A 41550000
&NAME    DS    0H                                                       41600000
         AGO   .DOMO2                                              @01A 41650000
.* NO, REGISTER 1 NOT SPECIFIED. MOVE ADDRESS TO REGISTER 1.       @01A 41700000
.DOMO1   ANOP          REGISTER IS 2 - 12. MOVE IN TO REG 1        @01A 41750000
&NAME    LR    1,&MSG(1)      .MOVE MSG ID TO REGISTER 1                41800000
         AGO   .DOMO2                                              @01A 41850000
.* MSG WAS SPECIFIED AS A LABEL. LOAD ADDRESS IN REGISTER 1.       @01A 41900000
.DOMO01  ANOP                                                      @01A 41950000
.*  CHECK IF &NAME WAS SPECIFIED.                                  @01A 42000000
         AIF   (T'&NAME EQ 'O').DOMO02                             @01A 42050000
.* &NAME WAS SPECIFIED, PUT OUT A LABEL                            @01A 42100000
&NAME    L     1,&MSG(1)        .LOAD MSG ID INTO REGISTER 1            42150000
         AGO   .DOMO2                                              @01A 42200000
.DOMO02  ANOP   NO LABEL WAS SPECIFIED                             @01A 42250000
         L     1,&MSG(1)        .LOAD MSG ID INTO REGISTER 1            42300000
.DOMO2   ANOP                                                      @01A 42350000
         LA    0,&RPYINDC.(0,0) .LOAD MSG/REPLY INDICATOR               42400000
         SIMSVC .                                              @D61CDFG 42425061
         SVC   87               .ISSUE DOM SVC                          42450000
         MEXIT                                                     @01A 42500000
.*  VALID KEYWORD WAS MSGLIST.                                     @01A 42550000
.DOMO7   ANOP                                                      @01A 42600000
&RPYINDC SETA  &RPYINDC+8   INCR. INDICATOR BY 8 FOR MSGLIST.      @01A 42650000
.*  CHECK IF OPERAND IS AN ADDRESS NAME                            @01A 42700000
         AIF   ('&MSGLIST'(1,1) EQ '(').DOMO8                      @01A 42750000
.*  OPERAND IS AN ADDR NAME.                                       @01A 42800000
&NAME    LA    1,&MSGLIST   .ADDRESS OF ID LIST IN REGISTER 1           42850000
         AGO   .DOMO11     LOOP AROUND FALSE PART OF LAST TEST     @01A 42900000
.*  OPERAND IS A REGISTER. CHECK IF IN RANGE 1 TO 12.              @01A 42950000
.DOMO8   AIF   ('&MSGLIST(1)' GE '1' AND '&MSGLIST(1)' LE '12').DOMO9   43000000
.*  NO, INVALID REGISTER SPECIFIED. ISSUE ERROR MESSAGE            @01A 43050000
         MNOTE 12,'*** REGISTER OPERAND REQUIRED-NOT SPECIFIED.'        43100000
         MEXIT                                                     @01A 43150000
.*   A VALID REGISTER WAS SPECIFIED. SEE IF IT IS REGISTER 1       @01A 43200000
.DOMO9   AIF   ('&MSGLIST(1)' NE '1').DOMO10                       @01A 43250000
.*   YES IT IS REGISTER 1. PUT OUT LABEL IF PRESENT                @01A 43300000
         AIF   (T'&NAME EQ 'O').DOMO11                             @01A 43350000
.*   LABEL IS PRESENT                                              @01A 43400000
&NAME    DS    0H                                                       43450000
         AGO   .DOMO11                                             @01A 43500000
.*   NO, NOT REGISTER 1. PUT OUT LR INSTRUCTION.                   @01A 43550000
.DOMO10  ANOP                                                      @01A 43600000
&NAME    LR    1,&MSGLIST(1)  .MOVE LIST ADDRESS TO REGISTER 1          43650000
.DOMO11  ANOP                 PUT OUT REST OF MSGLIST              @01A 43700000
.*  CHECK IF REPLY KEYWORD SPECIFIED                               @01A 43750000
         AIF   (&RPYINDC EQ 8).DOMO12                              @01A 43800000
.*  REPLY WAS SPECIFIED                                            @01A 43850000
         LA    0,&RPYINDC.(0,0) .LOAD MSGLIST/REPLY INDICATOR           43900000
         AGO   .DOMO13                                             @01A 43950000
.DOMO12  ANOP                                                      @01A 44000000
         LNR   0,1            .INDICATE MSGLIST ONLY                    44050000
.DOMO13  ANOP                                                      @01A 44100000
         SIMSVC .                                              @D61CDFG 44125061
         SVC   87             .ISSUE DOM SVC                            44150000
         MEND                                                           44200000
**/                                                                     44250000
*DOM:  MACRO KEYS( MSG,      /* SINGLE MESSAGE ID                @L1C*/ 44300000
*                  MSGLIST,  /* A LIST OF UP TO 60 MESSAGE IDS   @L1C*/ 44350000
*                  TOKEN,    /* 4-BYTE TOKEN FOR MESSAGES TO BE         44400000
*                               DELETED                          @L1A*/ 44450000
*                  SYSID,    /* A SYSTEM ID FOR MESSAGES TO BE          44500000
*                               DELETED                          @L1A*/ 44550000
*                  COUNT,    /* THE COUNT OF 4 BYTE IDS          @L1A*/ 44600000
*                  DOMCBLK,  /* A DOM CONTROL BLOCK              @L1A*/ 44650000
*                  SCOPE,    /* COMMUNICATE THE DOM REQUEST TO OTHER    44700000
*                               SYSTEMS                          @D1A*/ 44750000
*                  LINKAGE,  /* HOW CONTROL IS PASSED TO DOM     @L2A*/ 44800000
*                  REPLY);   /* DELETE WTORS AS WELL AS WTOS         */ 44850000
*        ANS('?'||MACLABEL||'DOMP '||MACLIST||MACKEYS||';');            44900000
*%END;                                                                  44950000
