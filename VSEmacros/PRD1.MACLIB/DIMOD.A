         MACRO                                                      3-3 00050000
&NAME    DIMOD &TYPEFLE=,&IOAREA2=,&SEPASMB=,&RDONLY=,&RPS=,   @DL30SMT*00100000
               &TRC=                                           @D34YSRJ 00150000
.********************************************************************** 00200000
.*                                                                    * 00250000
.* MODULE NAME = DIMOD (IBM DISK OPERATING SYSTEM)             @DL30SMT 00300000
.*               IOX - 5686-007-02-C440                        @U31TUJS 00350000
.*                                                                    * 00400000
.* DESCRIPTIVE NAME = DEVICE INDEPENDENT FILES LOGIC MODULE    @DL30SMT 00450000
.*                                                                    * 00500000
.* COPYRIGHT = THIS MACRO IS "RESTRICTED MATERIALS OF IBM"     @D41TDKY 00550000
.*             5686-007 (C) COPYRIGHT IBM CORP. 1980,1989      @U31TUJS 00600000
.*             ALL RIGHTS RESERVED                             @D41TDKY 00650000
.*             LICENSED MATERIALS-PROPERTY OF IBM              @D41TDKY 00700000
.*             SEE COPYRIGHT INSTRUCTIONS, G120-2083           @D41TDKY 00750000
.*                                                                  3-3 00800000
.* FUNCTION    THE DEVICE INDEPENDENT LOGIC MODULE PROVIDES THE     3-3 00850000
.*             CAPABILITY OF UTILIZING GET/PUT LOGIC TO READ OR WRIT3-3 00900000
.*             RECORDS SEQUENTIALLY USING INFORMATION AS SPECIFIED  3-3 00950000
.*             IN THE DTFDI TABLE.                                  3-3 01000000
.*                                                                  3-3 01050000
.* CHANGE ACTIVITY = AS FOLLOWS:                               @DL30SMT 01100000
.*    @DL30SMT  RPS SUPPORT ADDED                              @DL30SMT 01150000
.*    @D34YS--  TRC SUPPORT ADDED                              @D34YSRJ 01200000
.*    @DA11414  SKIPPED RECORDS WHEN USING DTFDI WITH ONE      @DA11414 01250000
.*              IOAREA AND A DIMOD WITH TWO IOAREA'S           @DA11414 01300000
.*    @DA14497  MSG OP76 READING MULTI VOLUME DISKETTE FILE    @DA14497 01350000
.*              WITH TWO I/O AREA'S                            @DA14497 01400000
.*    @DA20170  REGISTER 13 NOT RESTORED IN IJJFVBIC           @DA20170 01450000
.*    @D37ZDHK  READ 81 BYTES SUPPORT                          @D37ZDHK 01500000
.*    @D62ADWS  ADAPT TO FAMILY API                            @D62ADWS 01525000
.*                                                                    * 01550000
.********************************************************************** 01600000
         LCLC  &NAM,&IO,&AR,&DIM,&A,&R                         @DL30SMT 01650000
* IOCS AND DEV INDEPENDENT I/O  DIMOD  5686-007-02-C440        @U31TUJS 01700000
*                                                              @U31TUJS 01750000
*    THIS MACRO IS "RESTRICTED MATERIALS OF IBM"               @D41TDKY 01800000
*    5686-007 (C) COPYRIGHT IBM CORP. 1977,1989                @U31TUJS 01850000
*    ALL RIGHTS RESERVED                                       @U31TUJS 01900000
*    LICENSED MATERIALS - PROPERTY OF IBM                      @U31TUJS 01950000
*    SEE COPYRIGHT INSTRUCTIONS, G120-2083                     @U31TUJS 02000000
         SPACE 2                                                    3-3 02050000
&R       SETC  'C'                                             @DL30SMT 02100000
         AIF   ('&RPS' NE 'SVA').NRPS1                         @DL30SMT 02150000
&R       SETC  'V'                                             @DL30SMT 02200000
&AR      SETC  'I'                                             @DL30SMT 02250000
&A       SETC  'C'                                             @DL30SMT 02300000
         AIF   ('&TYPEFLE' EQ 'INPUT').F1                      @DL30SMT 02350000
&IO      SETC  'B'                                             @DL30SMT 02400000
* RPS=SVA IMPLIES THE FOLLOWING OPTIONS - DISK, OUTPUT,        @DL30SMT 02450000
*         TWO I/O AREAS, SEPARATE ASSEMBLY AND READ ONLY       @DL30SMT 02500000
         AGO   .OK1A                                           @DL30SMT 02550000
.F1      ANOP                                                  @DL30SMT 02600000
&IO      SETC  'I'                                             @DL30SMT 02650000
* RPS=SVA, TYPEFLE=INPUT IMPLIES THE FOLLOWING OPTIONS - DISK, @DL30SMT 02700000
*                        TWO I/O AREAS, SEPARATE ASSEMBLY      @DL30SMT 02750000
*                        AND READ ONLY                         @DL30SMT 02800000
         AGO   .OK1A                                           @DL30SMT 02850000
.NRPS1    AIF  (T'&RDONLY EQ 'O' OR '&RDONLY' EQ 'YES').BK01        3-3 02900000
         MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED'                 3-3 02950000
.BK01     ANOP                                                      3-3 03000000
         AIF   (T'&TRC EQ 'O').NTRC2                           @D34YSRJ 03050000
         AIF   ('&TYPEFLE' NE 'INPUT').NTRC1                   @D34YSRJ 03100000
         MNOTE 0,'''TRC'' NOT VALID FOR INPUT, IGNORED.'       @D34YSRJ 03150000
         AGO   .NTRC2                                          @D34YSRJ 03200000
.NTRC1   ANOP                                                  @D34YSRJ 03250000
         AIF   ('&TRC' EQ 'YES' OR '&TRC' EQ 'NO').NTRC2       @D34YSRJ 03300000
         MNOTE 0,'IMPROPER TRC.  ''NO'' ASSUMED.'              @D34YSRJ 03350000
.NTRC2   ANOP                                                  @D34YSRJ 03400000
&A       SETC  'D'                                                  3-3 03450000
         AIF   ('&TYPEFLE' EQ 'INPUT' OR '&TYPEFLE' EQ 'OUTPUT').OK1B   03500000
         MNOTE 1,'INVALID OR MISSING TYPEFLE OUTPUT ASSUMED.'           03550000
.OK1B    AIF ('&IOAREA2' EQ 'YES' OR '&IOAREA2' EQ '').OK1A             03600000
         MNOTE 1,'INVALID IOAREA2 PARAMETER. 1 I/O AREA ASSUMED.'       03650000
.OK1A    AIF   (T'&NAME EQ 'O').GENAM                                   03700000
&NAM     SETC  '&NAME'                                                  03750000
         AGO   .SEP                                                     03800000
.GENAM   AIF   ('&RPS' EQ 'SVA').RD1                           @DL30SMT 03850000
         AIF   ('&TYPEFLE' NE 'INPUT').GENAM1                           03900000
&IO      SETC  'I'                                                      03950000
         AGO   .GENAM2                                                  04000000
.GENAM1  ANOP                                                           04050000
&IO      SETC  'B'                                                      04100000
.GENAM2  AIF   ('&IOAREA2' EQ 'YES').GENAM4                             04150000
&AR      SETC  'Z'                                                      04200000
         AGO   .GENAM5                                                  04250000
.GENAM4  ANOP                                                           04300000
&AR      SETC  'I'                                                      04350000
.GENAM5  AIF (T'&RDONLY EQ 'O').RD1                                 3-3 04400000
&A       SETC 'C'                                                   3-3 04450000
.RD1     ANOP                                                       3-3 04500000
&NAM     SETC  'IJJF&R&IO&AR&A'                                @DL30SMT 04550000
.SEP     AIF   ('&RPS' NE 'SVA').PREPCH                        @DL30SMT 04600000
         PUNCH ' CATALOG &NAM..OBJ   REPLACE=YES '             @D37ZDHK 04650000
         PUNCH ' PHASE  &NAM,*,NOAUTO,SVA '                    @DM08008 04700000
         AGO   .GENDCT                                         @DL30SMT 04750000
.PREPCH  AIF   ('&SEPASMB' NE 'YES').GENDCT                    @DL30SMT 04800000
.PCHCAT  PUNCH ' CATALOG &NAM..OBJ   REPLACE=YES'              @D37ZDHK 04850000
.GENDCT  ANOP                                                           04900000
&DIM     SETC  '&SYSNDX'(2,3)                                           04950000
IJJA0&DIM DSECT                                                         05000000
IJJA1&DIM DS   CL30 CCB, ADDR OF LOGIC, DTF TYPE, OPEN SW, FILE NAME    05050000
IJJA2&DIM EQU  IJJA1&DIM+2    1ST COMMUNICATION BYTE                    05100000
IJJA3&DIM EQU  IJJA1&DIM+3    2ND COMMUNICATION BYTE                    05150000
IJJA4&DIM EQU  IJJA1&DIM+4    CSW STATUS                                05200000
IJJA5&DIM EQU  IJJA1&DIM+8    CCW ADDRESS                               05250000
IJJA6&DIM EQU  IJJA1&DIM+22   FILE NAME                                 05300000
IJJA7&DIM DS   CL10 FMT1 ADDR, VOL SEQ NO,OPEN SW, XTENT SEQ NO, LD INS 05350000
IJJA8&DIM EQU  IJJA7&DIM+2    LOAD INSTRUCTION FOR SYSTEM UNIT          05400000
IJJA9&DIM DS   CL2  XTENT SEQ NO OF LAST XTENT AND OPEN INDICATOR       05450000
IJJB0&DIM EQU  IJJA9&DIM      CONSTANT FOR PUNCH                        05500000
IJJB1&DIM DS   CL1            DEVICE TYPE AND RPS INDICATOR    @DL30SMT 05550000
IJJB2&DIM DS   CL1            INDICATOR FOR OPEN AND LOGIC              05600000
IJJB3&DIM DS   CL1            LOGIC MODULE OPTION SWITCHES              05650000
IJJD9&DIM DS   CL3            I/O AREA                                  05700000
IJJB4&DIM DS   CL4            OPEN/CLOSE INDICATORS OR CCW              05750000
IJJB5&DIM DS   CL2            HH LOWER HEAD LIMIT                       05800000
IJJB6&DIM DS   CL6            CCHH UPPER XTENT LIMIT AND BB OF SEEK ADR 05850000
IJJB7&DIM EQU  IJJB6&DIM+2    PUNCH ERROR CCW IF DEVICE IS 2540 PUNCH   05900000
IJJB8&DIM DS   CL4            CCHHR OF SEEK ADDRESS                     05950000
IJJB9&DIM DS   CL4            EOF ADD                                   06000000
IJJC0&DIM EQU  IJJB9&DIM      PUNCH ERROR CCW2 IF DEVICE IS 2540 PUNCH  06050000
IJJSV&DIM EQU  IJJC0&DIM      MFCM/U PUNCH STACKER SELECT V          CI 06100000
IJJSW&DIM EQU  IJJC0&DIM+1    MFCM/U PUNCH STACKER SELECT W          CI 06150000
IJJC1&DIM DS   CL4            CONTROL BUCKET                            06200000
IJJC2&DIM DS   CL1            NO. OF RECORDS/TRACK                      06250000
IJJC3&DIM EQU  IJJC2&DIM      80 BYTE CARD IMAGE SAVE AREA              06300000
IJJC4&DIM DS   CL1            FIRST RECORD FOR INPUT OR OUTPUT          06350000
IJJC5&DIM DS   CL2            ADJUSTMENT FOR CCW ADDRESS                06400000
IJJC6&DIM DS   CL4            CCHH COUNT FIELD                          06450000
IJJC7&DIM DS   CL2            RECORD AND KEY LENGTH                     06500000
IJJC8&DIM DS   CL2            DATA LENGTH                               06550000
IJJC9&DIM DS   CL4            INSTR. TO LOAD IOREG WITH I/O AREA ADDR.  06600000
IJJD0&DIM DS   CL24           SEEK, SEARCH, TIC CCWS                    06650000
IJJD1&DIM DS   CL16           INPUT AND OUTPUT CCWS                     06700000
IJJD2&DIM DS   CL24           VERIFY CCWS                               06750000
IJJD3&DIM DS   CL8            2540 PUNCH ERROR CCW1                     06800000
IJJD4&DIM EQU  IJJD3&DIM      80 BYTE CARD IMAGE SAVE AREA              06850000
IJJD5&DIM DS   CL8            2540 PUNCH ERROR CCW2                     06900000
IJJD6&DIM DS   CL64           RESERVED FOR SAVE AREA                    06950000
IJJD7&DIM DS   CL4            WLR OPTION                                07000000
IJJD8&DIM DS   CL4            ERROPT OPTION                             07050000
IJJL9&DIM EQU  *-IJJA0&DIM    LENGTH OF DTF                    @DL30SMT 07100000
         SPACE                                                          07150000
         AIF   ('&RPS' EQ 'SVA').RPSDSCT                       @DL30SMT 07200000
         AIF   (T'&RDONLY EQ 'O').NRPS2                        @DL30SMT 07250000
IJJR1&DIM DSECT                                                @DL30SMT 07300000
*        USER REGISTER SAVE AREA FOR READ ONLY                 @DL30SMT 07350000
IJJSR&DIM EQU  13             BASE FOR SAVE AREA               @DL30SMT 07400000
IJJE3&DIM DS   CL72           REGS 2, 3, 4, 5, 6               @DL30SMT 07450000
IJJK7&DIM EQU  IJJE3&DIM+20   REG 14                           @DL30SMT 07500000
IJJL2&DIM EQU  IJJE3&DIM+24   REGS 15, 0, 1                    @DL30SMT 07550000
IJJR4&DIM EQU  IJJE3&DIM+24   REG 0'                           @DL30SMT 07600000
IJJR5&DIM EQU  IJJE3&DIM+28   REG 1'                           @DL30SMT 07650000
IJJR6&DIM EQU  IJJE3&DIM+32   REGS 2',3',4',5',6'              @DL30SMT 07700000
IJJL8&DIM EQU  IJJE3&DIM+71   360 CNTRL CHARS SWITCH           @DL30SMT 07750000
IJJR2&DIM EQU  *-IJJR1&DIM    LENGTH OF WORK SAVE AREA         @DL30SMT 07800000
         AGO   .NRPS2                                          @DL30SMT 07850000
.RPSDSCT ANOP                                                  @DL30SMT 07900000
IJJR1&DIM DSECT                                                @DL30SMT 07950000
*        RPS DTF EXTENSION WORK AREA                           @DL30SMT 08000000
IJJSR&DIM EQU  13             BASE FOR WORK AREA               @DL30SMT 08050000
          DS   14D            CCW CHAIN IN SVA                 @DL30SMT 08100000
          DS   7F             RESERVED                         @DL30SMT 08150000
IJJR4&DIM DS   F              REG 0'                           @DL30SMT 08200000
IJJR5&DIM DS   F              REG 1'                           @DL30SMT 08250000
IJJR6&DIM DS   CL1            END OF FILE INDICATOR            @DL30SMT 08300000
          DS   CL19           REGS 2',3',4',5',6'              @DL30SMT 08350000
IJJR3&DIM DS   A              DTF POINTER                      @DL30SMT 08400000
          DS   CL1            SECTOR VALUE                     @DL30SMT 08450000
          DS   CL2                                             @DL30SMT 08500000
IJJL8&DIM DS   CL1            360 CNTRL CHARS SWITCH           @DL30SMT 08550000
          DS   A              ORIGINAL CCW CHAIN PTR           @DL30SMT 08600000
          DS   A              ORIGINAL LOGIC MOD PTR           @DL30SMT 08650000
          DS   0CL72          REGISTER SAVE AREA               @DL30SMT 08700000
          DS   2F                                              @DL30SMT 08750000
          DS   0CL64          REGISTERS 13 THRU 12             @DL30SMT 08800000
IJJK4&DIM DS   F              REG 13                           @DL30SMT 08850000
IJJK7&DIM DS   F              REG 14                           @DL30SMT 08900000
IJJL2&DIM DS   3F             REGS 15, 0, 1                    @DL30SMT 08950000
IJJE3&DIM DS   5F             REGS 2, 3, 4, 5, 6               @DL30SMT 09000000
          DS   6F             REGS 7, 8, 9, 10, 11, 12         @DL30SMT 09050000
IJJR2&DIM EQU  *-IJJR1&DIM    LENGTH OF RPS EXTENSION          @DL30SMT 09100000
.NRPS2   ANOP                                                  @DL30SMT 09150000
         EJECT                                                          09200000
&NAM     CSECT                                                          09250000
         AIF   (T'&NAME NE 'O' OR '&RPS' EQ 'SVA').STRT        @DL30SMT 09300000
         AIF   ('&TYPEFLE' NE 'INPUT').NEXT1                            09350000
         AIF   ('&IOAREA2' NE 'YES').STRT                               09400000
.NEXT2   ANOP                                                           09450000
IJJFCIZ&A EQU  *                                                    3-3 09500000
         ENTRY IJJFCIZ&A                                            3-3 09550000
         AGO   .STRT                                                3-3 09600000
.NEXT1   AIF   ('&IOAREA2' NE 'YES').NEXT2                          3-3 09650000
IJJFCBZ&A EQU *                                                     3-3 09700000
IJJFCII&A EQU *                                                     3-3 09750000
IJJFCIZ&A EQU *                                                     3-3 09800000
         ENTRY IJJFCBZ&A,IJJFCIZ&A,IJJFCII&A                        3-3 09850000
         AGO   .STRT                                                3-3 09900000
.STRT    USING *,IJJBR&DIM    BASE FOR LOGIC                            09950000
         USING IJJA1&DIM,IJJTR&DIM ESTABLISH BASE FOR TABLE             10000000
         AIF   ('&RPS' EQ 'SVA' OR T'&RDONLY NE 'O').RPS1      @DL30SMT 10050000
         AGO   .NRPS3                                          @DL30SMT 10100000
.RPS1    USING IJJR1&DIM,IJJSR&DIM REG 13, WORK & SAVE BASE    @DL30SMT 10150000
.NRPS3   DS    0F                                              @DL30SMT 10200000
IJJE0&DIM SVC  50             ILLEGAL ENTRY                             10250000
         DC    H'0'                                                     10300000
         B     IJJE0&DIM      ILLEGAL ENTRY                             10350000
         B     IJJE1&DIM      ENTRY FOR GET                             10400000
         AIF   ('&TYPEFLE' EQ 'INPUT').ILL                              10450000
         B     IJJE1&DIM      ENTRY FOR PUT                             10500000
         AGO   .ILL1                                                    10550000
.ILL     B     IJJE0&DIM      ILLEGAL ENTRY FOR INPUT                   10600000
.ILL1    B     IJJE0&DIM      ILLEGAL ENTRY                             10650000
         B     IJJE0&DIM      ILLEGAL ENTRY                             10700000
         B     IJJE2&DIM      ENTRY FOR ERROPT EQUAL SKIP      @DL30SMT 10750000
         B     IJJ8J&DIM      ENTRY FOR ERROPT EQUAL IGNORE    @D37ZDHK 10800000
         DC    CL8'&NAM'                                                10850000
         DC    X'3440'  /*@@LVLID*/ VERSION AND MOD LEVEL      @D41TDKY 10900000
         AIF   ('&RPS' NE 'SVA').NRPS4                         @DL30SMT 10950000
         DS    0H                                              @D34DE97 11000000
         DC    X'FFFFD9E5FFFF'         LOGIC MOD LEVEL ID      @D34DE97 11050000
         DC    X'3440'  /*@@LVLID*/    LOGIC MOD RELEASE LVL   @D41TDKY 11100000
IJJE1&DIM L    IJJTR&DIM,IJJA5&DIM LOAD RPS EXT ADDR           @DL30SMT 11150000
         ST    IJJSR&DIM,192(IJJTR&DIM) SAVE REG 13            @DL30SMT 11200000
         LR    IJJSR&DIM,IJJTR&DIM LOAD EXTENSION BASE         @DL30SMT 11250000
         L     IJJTR&DIM,IJJR3&DIM RESTORE DTF ADDRESS         @DL30SMT 11300000
         STM   IJJUR&DIM,IJJER&DIM,IJJK7&DIM SAVE REGISTERS    @DL30SMT 11350000
         AGO   .RPS2                                           @DL30SMT 11400000
.NRPS4   ANOP                                                  @DL30SMT 11450000
         DS    0H                                              @D34DE97 11500000
         DC    X'FFFFD9E5FFFF'         LOGIC MOD LEVEL ID      @D34DE97 11550000
         DC    X'3440'  /*@@LVLID*/    LOGIC MOD RELEASE LVL   @D41TDKY 11600000
IJJE1&DIM STM  IJJWR&DIM,IJJRR&DIM,IJJE3&DIM SAVE USERS REGISTERS   3-3 11650000
.RPS2    ANOP                                                  @DL30SMT 11700000
IJJE2&DIM L    IJJRR&DIM,IJJA5&DIM LOAD CCW ADDRESS            @DL30SMT 11750000
         AIF   ('&TYPEFLE' EQ 'INPUT').A1                               11800000
         CLI   IJJA7&DIM,IJJE4&DIM 2540 PUNCH                           11850000
         AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').A2    @DL30SMT 11900000
         BE    IJJE5&DIM           NO                                   11950000
         AGO   .A1                                                      12000000
.A2      BE    IJJE6&DIM           NO                                   12050000
.A1      AH    IJJRR&DIM,IJJC5&DIM ADJUST ADDRESS FOR TABLE TYPE        12100000
         AIF   ('&RPS' NE 'SVA').NRPS5                         @DL30SMT 12150000
         LA    IJJRR&DIM,8(IJJRR&DIM) ADD MORE FOR RPS         @DL30SMT 12200000
.NRPS5   AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').A3    @DL30SMT 12250000
IJJE5&DIM TM   IJJB3&DIM,IJJE7&DIM OVERLAP AND/OR FIRST PASS            12300000
         BO    IJJE8&DIM           NOT FIRST PASS BUT OVERLAP           12350000
         OI    IJJB3&DIM,IJJJ9&DIM SET NOT FIRST PASS SW.           4-0 12400000
         BAL   IJJLR&DIM,IJJE6&DIM GET I/O                              12450000
.A3      AIF   ('&TYPEFLE' EQ 'INPUT').A4                               12500000
         AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').A5    @DL30SMT 12550000
IJJE8&DIM BAL  IJJMR&DIM,IJJH8&DIM TEST FOR CHANNEL END                 12600000
.B3      ANOP                                                           12650000
IJJI0&DIM EQU  *                                               @D34YSRJ 12700000
         AIF   ('&TYPEFLE' EQ 'INPUT').B3B                     @D34YSRJ 12750000
         AIF   ('&TRC' NE 'YES').B3B                           @D34YSRJ 12800000
         TM    IJJB1&DIM,IJJF2&DIM     IS THIS A PRINTER       @D34YSRJ 12850000
         BNO   IJJI3&DIM               BR NO                   @D34YSRJ 12900000
IJJI1&DIM EQU  *                                               @D34YSRJ 12950000
         TM    IJJB4&DIM,IJJMC&DIM     IS TRC INDICATED        @D34YSRC 13000000
         BZ    IJJI3&DIM               BR NO                   @D34YSRJ 13050000
         AIF   ('&IOAREA2' NE 'YES').B3A                       @D34YSRJ 13100000
         TM    IJJB3&DIM,IJJH3&DIM     ARE THERE 2 I/O AREAS   @D34YSRJ 13150000
         BNO   IJJI2&DIM               BR NO                   @D34YSRJ 13200000
         TM    5(IJJRR&DIM),IJJMP&DIM  PRIOR TRC INDICATED     @D34YSRC 13250000
         BNO   IJJI3&DIM               BR NO                   @D34YSRJ 13300000
         L     IJJGR&DIM,0(IJJRR&DIM)  LOAD DATA ADDR FROM CCW @D34YSRJ 13350000
IJJI2&DIM EQU  *                                               @D34YSRJ 13400000
.B3A     ANOP                                                  @D34YSRJ 13450000
         LH    IJJMR&DIM,6(,IJJRR&DIM) LOAD COUNT IN REG       @D34YSRJ 13500000
         LA    IJJMR&DIM,1(,IJJMR&DIM) INCR COUNT IN REG       @D34YSRJ 13550000
         STH   IJJMR&DIM,6(,IJJRR&DIM) PUT COUNT IN CCW        @D34YSRJ 13600000
         BCTR  IJJGR&DIM,0             DECR DATA ADDR          @D34YSRJ 13650000
         STCM  IJJGR&DIM,7,1(IJJRR&DIM) PUT DATA ADDR INTO CCW @D34YSRJ 13700000
IJJI3&DIM EQU  *                                               @D34YSRJ 13750000
.B3B     ANOP                                                  @D34YSRJ 13800000
         TM    IJJA4&DIM,IJJF0&DIM HAS UNIT EXCEPTION OCCURRED @D34YSRJ 13850000
         BO    IJJJ1&DIM           YES                                  13900000
         TM    IJJA4&DIM+1,IJJG0&DIM TEST FOR WLR ERROR                 13950000
         BO    IJJK5&DIM           YES                                  14000000
         TM    IJJA3&DIM,IJJH3&DIM TEST FOR READ ERROR                  14050000
         BO    IJJK6&DIM               YES                              14100000
         B     IJJJ8&DIM               GO TO USER                       14150000
         AIF   ('&TYPEFLE' EQ 'INPUT').B4                               14200000
IJJJ1&DIM TM   IJJB1&DIM,IJJF2&DIM IS DEVICE A PRINTER                  14250000
         BO    IJJJ8&DIM           YES, HANDLED BY LINE COUNT           14300000
         TM    IJJB3&DIM,IJJF4&DIM SYSLST OR SYSPCH ON OUTPUT TAPE      14350000
         BO    IJJF3&DIM           TO EOV ROUTINE                       14400000
         AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').BB    @DL30SMT 14450000
         L     IJJPR&DIM,IJJB9&DIM EOF ADDRESS INTO REGISTER            14500000
         NI    IJJB3&DIM,X'FF'-IJJJ9&DIM RESET NOT F.P. SW.         4-0 14550000
         L     IJJUR&DIM,0(IJJRR&DIM)  CCW I/O AREA ADDRESS         3-7 14600000
         B     IJJF5&DIM                                                14650000
.A5      ANOP                                                           14700000
IJJE6&DIM TM   IJJB2&DIM,IJJF7&DIM      IS DEVICE A READER, TAPE OR DSK 14750000
         BO    IJJF8&DIM                A DISK                          14800000
         BM    IJJF9&DIM                DEVICE IS A READER OR TAPE      14850000
         TM    IJJB3&DIM,IJJG0&DIM      IS EJECT NEEDED FOR ADR-PUNCH   14900000
         BZ    IJJG1&DIM                NO EJECT NEEDED                 14950000
         NI    IJJB3&DIM,IJJG2&DIM      INDICATE NO EJECT NEEDED        15000000
         BAL   IJJMR&DIM,IJJG3&DIM      EJECT FIRST CARD                15050000
IJJG1&DIM L    IJJGR&DIM,0(IJJRR&DIM)   LOAD CCW ADDRESS                15100000
         BCTR  IJJGR&DIM,0              POINT TO CONTROL CHARACTER      15150000
         TM    IJJB1&DIM,IJJMF&DIM      TEST MFCM/U                  CI 15200000
         BZ    IJJAS&DIM                NO, TEST ASA CONTROL CHAR    CI 15250000
         SH    IJJRR&DIM,IJJC5&DIM      ADJUST POINTER TO 1ST CCW    CI 15300000
         OI    4(IJJRR&DIM),X'60'       SET CHAIN BIT IN 1ST CCW     CI 15350000
         MVC   0(1,IJJRR&DIM),IJJSW&DIM STACKER SELECT W TO 1ST CC   CI 15400000
         CLI   0(IJJGR&DIM),IJJCW&DIM   TEST W CONTROL CHAR          CI 15450000
         BE    IJJAD&DIM                RETURN                       CI 15500000
         MVC   0(1,IJJRR&DIM),IJJSV&DIM STACKER SELECT V TO 1ST CC   CI 15550000
         CLI   0(IJJGR&DIM),IJJCV&DIM   TEST V CONTROL CHAR          CI 15600000
         BE    IJJAD&DIM                RETURN                       CI 15650000
         MVC   0(1,IJJRR&DIM),0(IJJGR&DIM) CTL CHAR TO 1ST CC        CI 15700000
IJJAD&DIM AH   IJJRR&DIM,IJJC5&DIM      ADJUST POINTER TO 2ND CCW    CI 15750000
         B     IJJF9&DIM                RETURN                       CI 15800000
IJJAS&DIM EQU  *                                                     CI 15850000
         MVI   IJJL8&DIM,X'00'     RESET CONTROL CHARACTER INDICATOR3-3 15900000
         TM    0(IJJGR&DIM),X'F0'      TEST FOR ASA CONTROL CHARACTERS  15950000
         BO    IJJL4&DIM               YES                              16000000
         CLI   0(IJJGR&DIM),X'C1'      *************************   3-3  16050000
         BE    IJJL4&DIM               * TEST FOR VALID ASA    *    3-3 16100000
         CLI   0(IJJGR&DIM),X'C2'      * A/C. OTHER IS SPACE   *    3-3 16150000
         BE    IJJL4&DIM               * ASA OR 360 CONT. CHAR *    3-3 16200000
         CLI   0(IJJGR&DIM),X'C3'      * OR INVALID, WHICH     *    3-3 16250000
         BE    IJJL4&DIM               * TST IS BELOW.         *    3-3 16300000
         LH    IJJPR&DIM,IJJM0&DIM     *************************    3-3 16350000
         LA    IJJMR&DIM,IJJL3&DIM     SET REGISTER TO POINT TO ASA     16400000
         LA    IJJMR&DIM,18(IJJMR&DIM) CHARACTERS FOR COMPARSION        16450000
IJJL7&DIM CLC 0(1,IJJGR&DIM),0(IJJMR&DIM) TEST FOR ASA CONTROL CHAR     16500000
         BE    IJJL4&DIM               YES                              16550000
         BCTR  IJJMR&DIM,0                                              16600000
         BCT   IJJPR&DIM,IJJL7&DIM                                      16650000
         MVI   IJJL8&DIM,X'01'         SET SW INDICATING 360 CHAR       16700000
         AIF   ('&TYPEFLE' EQ 'INPUT').A6A                     @D34YSRJ 16750000
         AIF   ('&TRC' NE 'YES').A6A                           @D34YSRJ 16800000
         TM    IJJB1&DIM,IJJF2&DIM      IS THIS A PRINTER      @D34YSRJ 16850000
         BNO   IJJXW&DIM                BR NO                  @D34YSRJ 16900000
         TM    IJJB4&DIM,IJJMC&DIM      TRC INDICATED          @D34YSRC 16950000
         BZ    IJJXX&DIM                BR NO                  @D34YSRJ 17000000
         TM    IJJB4&DIM,IJJMB&DIM      3800 INDICATED         @D34YSRC 17050000
         BO    IJJLA&DIM                BR IF 3800             @D34YSRC 17100000
         MVI   5(IJJRR&DIM),IJJMP&DIM   SHOW ADDR/CNT ADJUSTED @D34YSRC 17150000
         B     IJJLB&DIM                GO ADJUST ADDR & CNT   @D34YSRC 17200000
IJJLA&DIM EQU  *                        DEVICE IS A 3800       @D34YSRC 17250000
         MVI   0(IJJRR&DIM),0           CLEAR CCW CMD CODE     @D34YSRC 17300000
         MVN   0(1,IJJRR&DIM),1(IJJGR&DIM) GET LO-ORDER OF TRC @D34YSRC 17350000
         TR    0(1,IJJRR&DIM),IJJMT&DIM TRANSLATE INTO OP CODE @D34YSRJ 17400000
         CLC   0(1,IJJRR&DIM),5(IJJRR&DIM) GIVEN TRC=CURR TRC  @D34YSRJ 17450000
         BE    IJJLB&DIM                BR YES, NO TRC CCW     @D34YSRJ 17500000
         EXCP  (1)                      ISSUE EXCP FOR TRC     @D34YSRJ 17550000
         MVC   5(1,IJJRR&DIM),0(IJJRR&DIM) SAVE TRC CODE       @D34YSRJ 17600000
         IWAIT (1)                      WAIT FOR COMPLETION    @D62ADWS 17650000
IJJLB&DIM EQU  *                                               @D34YSRJ 17700000
         LA    IJJMR&DIM,2(IJJGR&DIM)   INCR FR CTLCHR TO DATA @D14ZDBF 17750000
         STCM  IJJMR&DIM,7,1(IJJRR&DIM) PUT DATA ADDR INTO CCW @D14ZDBF 17800000
         LH    IJJMR&DIM,6(,IJJRR&DIM)  LOAD COUNT IN REG      @D34YSRJ 17850000
         BCTR  IJJMR&DIM,0              DECR CNT BY 1 FOR TRC  @D34YSRJ 17900000
         STH   IJJMR&DIM,6(,IJJRR&DIM)  PUT COUNT IN CCW       @D34YSRJ 17950000
         B     IJJXX&DIM                BYPASS CONVERSION      @D34YSRJ 18000000
         AGO   .A6B                                            @D34YSRJ 18050000
.A6A     ANOP                                                  @D34YSRJ 18100000
         B     IJJL6&DIM     360 CHARACTERS, BYPASS CONVERSION          18150000
.A6B     ANOP                                                  @D34YSRJ 18200000
IJJL4&DIM LR   IJJMR&DIM,IJJPR&DIM   EQUATE REGISTERS                   18250000
         IC    IJJPR&DIM,0(IJJGR&DIM)  CONTROL CHAR TO REGISTER         18300000
         LA    IJJGR&DIM,IJJG4&DIM     NO. OF CHAR TO COMPARE           18350000
IJJG5&DIM IC   IJJMR&DIM,IJJL3&DIM.(IJJGR&DIM) ASA CHAR FROM TABLE      18400000
         CR    IJJMR&DIM,IJJPR&DIM     SAME CHAR                        18450000
         BE    IJJG6&DIM               YES, THIS IS THE ONE             18500000
         BCT   IJJGR&DIM,IJJG5&DIM     NOT THE ONE, CHECK NEXT          18550000
IJJG6&DIM CH   IJJGR&DIM,IJJG7&DIM     IS COMMAND A SKIP                18600000
         BNL   IJJG8&DIM               NO, NOT A SKIP                   18650000
         MVI   0(IJJRR&DIM),IJJG9&DIM  SPACE COMMAND TO CCW             18700000
         BAL   IJJMR&DIM,IJJG3&DIM     SPACE FROM CHANNEL               18750000
IJJG8&DIM LA   IJJGR&DIM,IJJH0&DIM.(IJJGR&DIM)  CONTROL CHAR ADDRESS    18800000
IJJL6&DIM TM    IJJB1&DIM,IJJF2&DIM         Q-- PRINTER             3-9 18850000
          BO   IJJXX&DIM                   YES                      4-0 18900000
         AIF   ('&TYPEFLE' EQ 'INPUT').A6C                     @D34YSRJ 18950000
         AIF   ('&TRC' NE 'YES').A6C                           @D34YSRJ 19000000
IJJXW&DIM EQU  *                                               @D34YSRJ 19050000
.A6C     ANOP                                                  @D34YSRJ 19100000
          CLI  0(IJJGR&DIM),X'41'       EJECT IN POCKET TWO         4-0 19150000
          BE    IJJXX&DIM                YES                        4-0 19200000
          CLI   0(IJJGR&DIM),X'81'       EJECT IN POCKET THREE      4-0 19250000
          BE    IJJXX&DIM                YES                        4-0 19300000
          MVI   0(IJJRR&DIM),X'01'      DEF. EJCT IN POCK ONE  @DA01061 19350000
          B     *+10                    SKIP MOVE              @DA01061 19400000
IJJXX&DIM MVC  0(1,IJJRR&DIM),0(IJJGR&DIM)   CONTROL CHAR TO CCW    4-0 19450000
          OC    0(1,IJJRR&DIM),IJJB0&DIM    PRODUCE CORR PCH CODE   4-0 19500000
          TM   IJJB3&DIM,IJJF2&DIM      IS DEVICE A 2540 PUNCH          19550000
          BZ   IJJF9&DIM                NO, GET I/O                     19600000
          TM   IJJA2&DIM,IJJH2&DIM      WAIT FOR DEVICE END             19650000
          BO   *+6                                                      19700000
          SVC  7                        WAIT                            19750000
          TM   IJJA3&DIM,IJJH3&DIM      TEST IF PUNCH ERROR             19800000
          BZ   IJJH4&DIM                NO, SAVE IMAGES AND COMND CODES 19850000
IJJH5&DIM LR   IJJMR&DIM,IJJTR&DIM      ADDRESS OF DTF TABLE TO REG.    19900000
          LA   IJJTR&DIM,IJJH6&DIM      ADDR OF ERROR RECOVERY ROUTINE  19950000
          SVC  2                        CALL IN TRANSIENT ROUTINE       20000000
          LR   IJJTR&DIM,IJJMR&DIM      RESTORE DTF TABLE ADDRESS       20050000
IJJH4&DIM MVC  IJJC0&DIM.(1),IJJB7&DIM  OPCODE 1ST ERR CCW INTO 2ND ERR 20100000
          MVC  IJJB7&DIM.(1),IJJB4&DIM  OPCODE CURRENT CCW INTO 1ST ERR 20150000
          MVC  IJJD4&DIM.(80),IJJC3&DIM CARD IMAGE FROM SVAR1 TO SVAR2  20200000
          L    IJJMR&DIM,IJJB4&DIM CALCULATE CURRENT I/O AREA ADDRESS   20250000
         MVC   IJJC3&DIM.(80),0(IJJMR&DIM)  SAVE CURRENT CARD IMAGE     20300000
          AIF  ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').A7    @DL30SMT 20350000
IJJF9&DIM SVC  0                        GET I/O                         20400000
          TM   IJJB1&DIM,IJJF2&DIM      IS THIS A PRINTER               20450000
          BCR  8,IJJLR&DIM              NO, GO TO CORRECT INSTRUCTION   20500000
         CLI   IJJL8&DIM,X'01'     360 CONTROL CHARACTERS           3-3 20550000
         BCR   8,IJJLR&DIM         YES                                  20600000
          BAL  IJJMR&DIM,IJJH8&DIM      WAIT FOR CHANNEL END            20650000
         AIF   ('&TYPEFLE' EQ 'INPUT').A6D                     @D34YSRJ 20700000
         AIF   ('&TRC' NE 'YES').A6D                           @D34YSRJ 20750000
         TM    IJJB4&DIM,IJJMC&DIM      TRC INDICATED          @D34YSRC 20800000
         BZ    IJJF6&DIM                BR NO                  @D34YSRJ 20850000
         L     IJJGR&DIM,0(IJJRR&DIM)   GET DATA ADDR FROM CCW @D34YSRJ 20900000
         TM    IJJB4&DIM,IJJMB&DIM      3800 INDICATED         @D34YSRC 20950000
         BO    IJJLC&DIM                BR IF 3800             @D34YSRC 21000000
         MVI   5(IJJRR&DIM),IJJMP&DIM   SHOW ADDR/CNT ADJUSTED @D34YSRC 21050000
         B     IJJLD&DIM                GO ADJUST ADDR & CNT   @D34YSRC 21100000
IJJLC&DIM EQU  *                        DEVICE IS A 3800       @D34YSRC 21150000
         MVI   0(IJJRR&DIM),0           CLEAR CCW CMD CODE     @D34YSRC 21200000
         MVN   0(1,IJJRR&DIM),0(IJJGR&DIM) GET LO-ORDER OF TRC @D34YSRC 21250000
         TR    0(1,IJJRR&DIM),IJJMT&DIM TRANSLATE INTO OP CODE @D34YSRJ 21300000
         CLC   0(1,IJJRR&DIM),5(IJJRR&DIM) GIVEN TRC=CURR TRC  @D34YSRJ 21350000
         BE    IJJLD&DIM                BR YES, NO TRC CCW     @D34YSRJ 21400000
         EXCP  (1)                      ISSUE EXCP FOR TRC     @D34YSRJ 21450000
         MVC   5(1,IJJRR&DIM),0(IJJRR&DIM) SAVE TRC CODE       @D34YSRJ 21500000
         IWAIT (1)                      WAIT FOR COMPLETION    @D62ADWS 21550000
IJJLD&DIM EQU  *                                               @D34YSRJ 21600000
         LH    IJJMR&DIM,6(,IJJRR&DIM)  LOAD COUNT IN REG      @D34YSRJ 21650000
         BCTR  IJJMR&DIM,0              DECR CNT BY 1 FOR TRC  @D34YSRJ 21700000
         STH   IJJMR&DIM,6(,IJJRR&DIM)  PUT COUNT IN CCW       @D34YSRJ 21750000
         LA    IJJGR&DIM,1(IJJGR&DIM)   INCR DATA ADDRESS      @D34YSRJ 21800000
         STCM  IJJGR&DIM,7,1(IJJRR&DIM) PUT DATA ADDR INTO CCW @D34YSRJ 21850000
IJJF6&DIM EQU  *                                               @D34YSRJ 21900000
.A6D     ANOP                                                  @D34YSRJ 21950000
          MVI  0(IJJRR&DIM),IJJF0&DIM   MOVE PRINT COMMAND TO CCW       22000000
          SVC  0                        START I/O FOR ACTUAL PRINT      22050000
          BR   IJJLR&DIM                                                22100000
          AGO  .A8                                                      22150000
.A7       B    IJJF9&DIM                                                22200000
          AGO  .A8                                                      22250000
.A4       AIF  ('&IOAREA2' EQ 'YES' OR '&RPS' EQ 'SVA').A9     @DL30SMT 22300000
          TM   IJJB2&DIM,IJJF7&DIM      IS DEVICE A DISK                22350000
          BO   IJJF8&DIM                YES, A DISK                     22400000
.A8      ANOP                                                           22450000
IJJG3&DIM SVC  0                        START I/O                       22500000
.A9       ANOP                                                          22550000
IJJH8&DIM TM   IJJA2&DIM,IJJH2&DIM      TEST FOR CHANNEL END            22600000
          BO   *+6                                                      22650000
          SVC  7                        WAIT                            22700000
          AIF  ('&TYPEFLE' EQ 'INPUT').B1                               22750000
          BR   IJJMR&DIM                                                22800000
         AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').B2    @DL30SMT 22850000
          AGO  .B4                                                      22900000
.B1       TM   IJJB2&DIM,IJJF7&DIM      IS DEVICE A DISK                22950000
         BC    14,IJJI0&DIM             NO                              23000000
          IC   IJJGR&DIM,IJJB9&DIM      PICK UP RECORD NO.              23050000
          LA   IJJGR&DIM,1(IJJGR&DIM)   ADD ONE                         23100000
          STC  IJJGR&DIM,IJJB9&DIM      STORE NEW RECORD IN SEARCH ADDR 23150000
         AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').B14   @DL30SMT 23200000
         CLI   IJJA7&DIM-1,IJJM9&DIM   3540 ?                  @DL29R05 23250000
         BNE   IJJN8&DIM               NO, CONTINUE            @DL29R05 23300000
         TM    IJJA3&DIM,IJJH2&DIM     'SPEC REC' ?            @DL29R05 23350000
         BZ    IJJN8&DIM               NO, CONTINUE            @DL29R05 23400000
         OI    IJJA8&DIM+6,IJJG0&DIM   SET DELETE SW           @DL29R05 23450000
         XI    IJJA3&DIM,IJJH2&DIM     SET OFF SPEC REC SW     @DL29R05 23500000
IJJN8&DIM EQU  *                       CONTINUE                @DL29R05 23550000
.B14     ANOP                                                  @DL29R05 23600000
          AGO  .B3                                                      23650000
.B2       ANOP                                                          23700000
IJJF9&DIM BAL  IJJMR&DIM,IJJG3&DIM      GET I/O                         23750000
          TM   IJJB1&DIM,IJJF2&DIM      IS THIS A PRINTER               23800000
         AIF   ('&TRC' EQ 'YES').B2A                           @D34YSRJ 23850000
          BZ   IJJI0&DIM                NOT A PRINTER                   23900000
         AGO  .B2B                                             @D34YSRJ 23950000
.B2A      ANOP                                                 @D34YSRJ 24000000
          BZ   IJJI3&DIM                NOT A PRINTER          @D34YSRJ 24050000
.B2B      ANOP                                                 @D34YSRJ 24100000
         CLI   IJJL8&DIM,X'01'     360 CONTROL CHARACTERS           3-3 24150000
         AIF   ('&TRC' EQ 'YES').B2C                           @D34YSRJ 24200000
         BE    IJJI0&DIM           YES                                  24250000
         AGO  .B2D                                             @D34YSRJ 24300000
.B2C      ANOP                                                 @D34YSRJ 24350000
          BE   IJJI1&DIM                BR IF MACH CTL CHARS   @D34YSRC 24400000
         TM    IJJB4&DIM,IJJMC&DIM      TRC INDICATED          @D34YSRC 24450000
         BZ    IJJF6&DIM                BR NO                  @D34YSRJ 24500000
         L     IJJGR&DIM,0(IJJRR&DIM)   GET DATA ADDR FROM CCW @D34YSRJ 24550000
         TM    IJJB4&DIM,IJJMB&DIM      3800 INDICATED         @D34YSRC 24600000
         BO    IJJLE&DIM                BR IF 3800             @D34YSRC 24650000
         MVI   5(IJJRR&DIM),IJJMP&DIM   SHOW ADDR/CNT ADJUSTED @D34YSRC 24700000
         B     IJJLF&DIM                GO ADJUST ADDR & CNT   @D34YSRC 24750000
IJJLE&DIM EQU  *                        DEVICE IS A 3800       @D34YSRC 24800000
         MVI   0(IJJRR&DIM),0           CLEAR CCW CMD CODE     @D34YSRC 24850000
         MVN   0(1,IJJRR&DIM),0(IJJGR&DIM) GET LO-ORDER OF TRC @D34YSRC 24900000
         TR    0(1,IJJRR&DIM),IJJMT&DIM TRANSLATE INTO OP CODE @D34YSRJ 24950000
         CLC   0(1,IJJRR&DIM),5(IJJRR&DIM) GIVEN TRC=CURR TRC  @D34YSRJ 25000000
         BE    IJJLF&DIM                BR YES, NO TRC CCW     @D34YSRJ 25050000
         EXCP  (1)                      ISSUE EXCP FOR TRC     @D34YSRJ 25100000
         MVC   5(1,IJJRR&DIM),0(IJJRR&DIM) SAVE TRC CODE       @D34YSRJ 25150000
         IWAIT (1)                      WAIT FOR COMPLETION    @D62ADWS 25200000
IJJLF&DIM EQU  *                                               @D34YSRJ 25250000
         LH    IJJMR&DIM,6(,IJJRR&DIM)  LOAD COUNT IN REG      @D34YSRJ 25300000
         BCTR  IJJMR&DIM,0              DECR CNT BY 1 FOR TRC  @D34YSRJ 25350000
         STH   IJJMR&DIM,6(,IJJRR&DIM)  PUT COUNT IN CCW       @D34YSRJ 25400000
         LA    IJJGR&DIM,1(IJJGR&DIM)   INCR DATA ADDRESS      @D34YSRJ 25450000
         STCM  IJJGR&DIM,7,1(IJJRR&DIM) PUT DATA ADDR INTO CCW @D34YSRJ 25500000
IJJF6&DIM EQU  *                                               @D34YSRJ 25550000
.B2D     ANOP                                                  @D34YSRJ 25600000
          MVI  0(IJJRR&DIM),IJJF0&DIM   MOVE PRINT COMMAND TO CCW       25650000
          BAL  IJJMR&DIM,IJJG3&DIM      GET I/O                         25700000
          AGO  .B3                                                      25750000
.B4      AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').B5    @DL30SMT 25800000
          AIF  ('&TYPEFLE' NE 'INPUT').B6                               25850000
IJJJ1&DIM L    IJJPR&DIM,IJJB9&DIM      EOF ADDR TO TEMPORARY REGISTER  25900000
          NI   IJJB3&DIM,X'FF'-IJJJ9&DIM RESET NOT F.P. SW.         4-0 25950000
         L     IJJUR&DIM,0(IJJRR&DIM)  CCW I/O AREA ADDRESS         3-7 26000000
          B    IJJF5&DIM                                                26050000
.B6      ANOP                                                           26100000
IJJJ8&DIM TM   IJJB3&DIM,IJJH2&DIM       IS IT AN INPUT FILE   @D37ZDHK 26150000
          BZ   IJJ8J&DIM                 NO, NO SHIFTING       @D37ZDHK 26200000
          CLI  7(IJJRR&DIM),IJJDL&DIM    IS RECLEN 81 BYTES    @D37ZDHK 26250000
          BNE  IJJ8J&DIM                 NO, CONTINUE          @D37ZDHK 26300000
          L    IJJMR&DIM,0(IJJRR&DIM)    GET CCW IOAREA ADDR   @D37ZDHK 26350000
          MVC  0(80,IJJMR&DIM),1(IJJMR&DIM) SHIFT DATA 1 LEFT  @D37ZDHK 26400000
IJJ8J&DIM OI   IJJB3&DIM,IJJJ9&DIM       SET 1ST PASS SW OFF   @D37ZDHK 26450000
          TM   IJJB3&DIM,IJJH3&DIM       ARE THERE 2 I/O AREAS @D37ZDHK 26500000
          BZ   IJJJ7&DIM                NO                              26550000
          XC   IJJD9&DIM.(3),1(IJJRR&DIM) SWAP I/O AREAS                26600000
          XC   1(3,IJJRR&DIM),IJJD9&DIM  NEW I/O AREA ADDRESS TO CCW    26650000
          EX   0,*-12                    COMPLETE THE EXCHANGE          26700000
          BAL  IJJLR&DIM,IJJE6&DIM       GET I/O                        26750000
IJJJ7&DIM LR   IJJPR&DIM,IJJUR&DIM       SAVE RETURN REGISTER           26800000
          L    IJJUR&DIM,IJJD9&DIM-1     NEXT I/O AREA                  26850000
          AIF  ('&TYPEFLE' EQ 'INPUT').B7                               26900000
          TM   IJJB1&DIM,IJJJ4&DIM       IS DEVICE A PRINTER OR PUNCH   26950000
          BZ   IJJF5&DIM                 NO                             27000000
          BCTR IJJUR&DIM,0               POINT TO CONTROL CHARACTER     27050000
          AIF  ('&RPS' EQ 'SVA').BK12                          @DL30SMT 27100000
IJJF5&DIM LM   IJJWR&DIM,IJJRR&DIM,IJJE3&DIM RESTORE USER REGISTERS 3-3 27150000
          AGO  .BK13                                                3-3 27200000
.BK12     ANOP                                                      3-3 27250000
IJJF5&DIM LM   IJJWR&DIM,IJJER&DIM,IJJE3&DIM RESTORE USER REGS @DL30SMT 27300000
          L    IJJSR&DIM,IJJK4&DIM RESTORE EXTN ADDR           @DL30SMT 27350000
.BK13     ANOP                                                      3-3 27400000
          TM   IJJA7&DIM,IJJE4&DIM       2540 PUNCH                     27450000
          BO   IJJJ6&DIM                 YES                            27500000
          EX   0,IJJC9&DIM               LOAD I/O REG                   27550000
          B    IJJL5&DIM                                                27600000
IJJJ6&DIM EX   0,IJJA8&DIM               LOAD I/O REG                   27650000
         AGO   .B8                                                      27700000
.B7      ANOP                                                           27750000
          AIF  ('&RPS' EQ 'SVA').BK14                          @DL30SMT 27800000
IJJF5&DIM LM   IJJWR&DIM,IJJRR&DIM,IJJE3&DIM   RESTORE USER REGISTER3-3 27850000
          AGO  .BK15                                                3-3 27900000
.BK14     ANOP                                                      3-3 27950000
IJJF5&DIM LM   IJJWR&DIM,IJJER&DIM,IJJE3&DIM RESTORE USER REGS @DL30SMT 28000000
          L    IJJSR&DIM,IJJK4&DIM RESTORE EXTN ADDR           @DL30SMT 28050000
.BK15     ANOP                                                      3-3 28100000
         EX    0,IJJC9&DIM             LOAD I/O REGISTER                28150000
.B8       ANOP                                                          28200000
IJJL5&DIM LR   IJJUR&DIM,IJJPR&DIM       LOAD RETURN ADDRESS            28250000
         AGO   .B10                                                     28300000
.BB      L     IJJUR&DIM,IJJB9&DIM      EOF ADDRESS TO RETURN REGISTER  28350000
         AGO   .B9                                                      28400000
.B5      ANOP                                                           28450000
IJJJ1&DIM L    IJJUR&DIM,IJJB9&DIM      EOF ADDRESS TO RETURN REGISTER  28500000
.B9      ANOP                                                           28550000
IJJJ8&DIM TM   IJJB3&DIM,IJJH2&DIM       IS IT AN INPUT FILE   @D37ZDHK 28600000
          BZ   IJJ8J&DIM                 NO, NO SHIFTING       @D37ZDHK 28650000
          CLI  7(IJJRR&DIM),IJJDL&DIM    IS RECLEN 81 BYTES    @D37ZDHK 28700000
          BNE  IJJ8J&DIM                 NO, CONTINUE          @D37ZDHK 28750000
          L    IJJMR&DIM,0(IJJRR&DIM)    GET CCW IOAREA ADDR   @D37ZDHK 28800000
          MVC  0(80,IJJMR&DIM),1(IJJMR&DIM) SHIFT DATA 1 LEFT  @D37ZDHK 28850000
IJJ8J&DIM LM   IJJWR&DIM,IJJRR&DIM,IJJE3&DIM  RESTORE USER REGISTERS3-3 28900000
.B10     ANOP                                                  @DL29R05 28950000
         CLI   IJJA7&DIM-1,IJJM9&DIM   3540 ?                  @DL29R05 29000000
         BNE   IJJN5&DIM               NO, CONTINUE            @DL29R05 29050000
         AIF   ('&IOAREA2' NE 'YES').B11                       @DL29R05 29100000
         TM    IJJB3&DIM,IJJH3&DIM     ARE THERE TWO IOAREA'S  @DA11414 29150000
         BO    IJJJ2&DIM               IF SO BRANCH            @DA11414 29200000
         TM    IJJA3&DIM,IJJH2&DIM     'SPECIAL' REC ?         @DA11414 29250000
         BZ    IJJN5&DIM               IF NOT CONTINUE         @DA11414 29300000
         OI    IJJA8&DIM+6,IJJG0&DIM   SET 'DELETE' REC SW     @DA11414 29350000
         XI    IJJA3&DIM,IJJH2&DIM     SET OF 'SPEC REC' SW    @DA11414 29400000
         B     IJJE1&DIM               IGNORE RECORD           @DA11414 29450000
IJJJ2&DIM TM    IJJA8&DIM+6,IJJG0&DIM  'DELETE' REC SW ON ?    @DA11414 29500000
         BZ    IJJN5&DIM               NO, CONTINUE            @DL29R05 29550000
         XI    IJJA8&DIM+6,IJJG0&DIM    SET OFF 'DELETE ' SW   @DL29R05 29600000
         AGO   .B12                                            @DL29R05 29650000
.B11     ANOP                                                  @DL29R05 29700000
         TM    IJJA3&DIM,IJJH2&DIM     'SPECIAL' REC ?         @DL29R05 29750000
         BZ    IJJN5&DIM               NO, CONTINUE            @DL29R05 29800000
         OI    IJJA8&DIM+6,IJJG0&DIM   SET 'DELETE' REC SW     @DL29R05 29850000
         XI    IJJA3&DIM,IJJH2&DIM     SET OF 'SPEC REC' SW    @DL29R05 29900000
.B12     ANOP                                                  @DL29R05 29950000
         B     IJJE1&DIM               IGNORE RECORD           @DL29R05 30000000
IJJN5&DIM EQU   *                      CONTINUE                @DL29R05 30050000
          BR   IJJUR&DIM      RETURN TO USER                   @DL29R05 30100000
          AIF  ('&TYPEFLE' NE 'INPUT').C1                               30150000
          AIF  ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').C2    @DL30SMT 30200000
IJJE6&DIM TM   IJJB2&DIM,IJJF7&DIM      IS DEVICE A DISK                30250000
          BO   IJJF8&DIM                YES                             30300000
IJJG3&DIM SVC  0                        START I/O                       30350000
          BR   IJJLR&DIM                RETURN TO CORRECT INSTRUCTION   30400000
.C2       ANOP                                                          30450000
IJJF8&DIM CLC  IJJB9&DIM.(1),IJJC2&DIM  HAS RECORD LIMIT BEEN REACHED   30500000
          AGO  .C3                                                      30550000
.C1       ANOP                                                          30600000
IJJF8&DIM MVC  IJJB9&DIM.(1),IJJC7&DIM  UPDATE SEEK RECORD NUMBER       30650000
          CLC  IJJB9&DIM.(1),IJJC2&DIM  HAS RECORD LIMIT BEEN REACHED   30700000
.C3       ANOP                                                          30750000
          BNE  IJJK1&DIM                NO                              30800000
         L     IJJWR&DIM,IJJB8&DIM      PICK UP CCHH                4-0 30850000
         AH    IJJWR&DIM,IJJON&DIM      ADD 1 TO HEAD               4-0 30900000
         LR    IJJGR&DIM,IJJWR&DIM      EQUATE REGISTERS            4-0 30950000
         IC    IJJGR&DIM,IJJC1&DIM+3    TAKE UPPER HEAD LIMIT       4-0 31000000
         CR    IJJWR&DIM,IJJGR&DIM      COMPARE HEADS               4-0 31050000
         BNH   IJJK3&DIM                BRANCH IF LIMIT NOT EXCEEDED4-0 31100000
         A     IJJWR&DIM,IJJON&DIM      ADD 1 TO CYLINDER           4-0 31150000
         IC    IJJWR&DIM,IJJB5&DIM+1    SET LOWER HEAD LIMIT        4-0 31200000
IJJK3&DIM ST   IJJWR&DIM,IJJB8&DIM      UPDATE SEEK FIELD           4-0 31250000
          AIF  ('&TYPEFLE' NE 'INPUT').C4                               31300000
          CLI   IJJA7&DIM-1,IJJM9&DIM  IS THIS 3540 DEVICE     @DL29R05 31350000
          BNE   IJJM1&DIM              NO, CONTINUE            @DL29R05 31400000
          CLC   IJJB8&DIM.(4),IJJB6&DIM END OF EXTENT ON 3540  @DL29R05 31450000
          AIF   ('&IOAREA2' EQ 'YES' OR '&RPS' EQ 'SVA').C33   @DL30SMT 31500000
          BNL   IJJM3&DIM              YES, HANDLE IT          @DL29R05 31550000
          AGO   .C36                                           @DL29R05 31600000
.C33      BH    IJJM3&DIM              YES, HANDLE IT          @DL29R05 31650000
          BL    IJJM1&DIM              NO, CONTINUE            @DL29R05 31700000
          TM    IJJB3&DIM,IJJH3&DIM    DUAL I/O AREAS USED     @DL29R05 31750000
          BZ    IJJM3&DIM              NO, AT EOE, HANDLE IT   @DL29R05 31800000
          MVC   IJJB9&DIM.(1),IJJC4&DIM MOVE 1ST REC # TO POS  @DL29R05 31850000
          NI    IJJB3&DIM,IJJK9&DIM     TURN ON FIRST PASS IND.@DA08441 31900000
          B     IJJJ7&DIM              GIVE USER LAST RECORD   @DL29R05 31950000
.C36      ANOP                                                 @DL29R05 32000000
IJJM1&DIM MVC   IJJB9&DIM.(1),IJJC4&DIM MOVE 1ST REC NO TO POS @DL29R05 32050000
IJJK1&DIM B    IJJG3&DIM                                                32100000
          AGO   .C42                                           @DL29R05 32150000
.C4       CLC   IJJB8&DIM.(4),IJJB6&DIM UPPER EXTENT EXCEEDED  @DL29R05 32200000
          BL    IJJM5&DIM              NO, CONTINUE            @DL29R05 32250000
          BE    IJJM2&DIM              EQUAL, TEST IF 3540     @DL29R05 32300000
          CLI   IJJA7&DIM-1,IJJM9&DIM  IS THIS 3540 DEVICE     @DL29R05 32350000
          BNE   IJJH5&DIM              NO, CANCEL JOB          @DL29R05 32400000
          BE    IJJM3&DIM              YES, ISSUE FEED         @DL29R05 32450000
IJJM2&DIM CLI   IJJA7&DIM-1,IJJM9&DIM  IS THIS 3540 DEVICE     @DL29R05 32500000
          BNE   IJJM5&DIM              NO, CONTINUE            @DL29R05 32550000
          AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').C42  @DL30SMT 32600000
          TM    IJJB3&DIM,IJJH2&DIM    INPUT FILE              @DL29R05 32650000
          BZ    IJJM3&DIM              NO, OUTPUT, CONTINUE    @DL29R05 32700000
          TM    IJJB3&DIM,IJJH3&DIM    DUAL I/O AREAS          @DL29R05 32750000
          BZ    IJJM3&DIM              NO, AT EOE, HANDLE IT   @DL29R05 32800000
          MVC   IJJB9&DIM.(1),IJJC4&DIM MOVE 1ST REC # TO POS  @DA14497 32850000
          B     IJJJ7&DIM              GIVE USER LAST RECORD   @DL29R05 32900000
.C42      ANOP                                                 @DL29R05 32950000
IJJM3&DIM TM    IJJA8&DIM+6,IJJH2&DIM  MORE EXTENTS            @DL29R05 33000000
          BZ    IJJM7&DIM              YES, FEED               @DL29R05 33050000
          AIF   ('&TYPEFLE' EQ 'INPUT').C45                    @DL29R05 33100000
          TM    IJJB3&DIM,IJJH2&DIM    INPUT FILE              @DL29R05 33150000
          BZ    IJJM4&DIM              NO, OUTPUT, GET EXTENT  @DL29R05 33200000
.C45      ANOP                                                 @DL29R05 33250000
          B     IJJJ1&DIM              EXIT TO USERS EOF RTN   @DL29R05 33300000
IJJM7&DIM LA    IJJWR&DIM,IJJFD&DIM    POINT TO FEED CCW       @DL29R05 33350000
          ST    IJJWR&DIM,IJJA5&DIM    SET CCB CCW ADRS        @DL29R05 33400000
          SVC   0                      ISSUE FEED TO 3540      @DL29R05 33450000
          AIF   ('&TYPEFLE' EQ 'INPUT').C45A                   @DA03608 33500000
          BAL   IJJMR&DIM,IJJH8&DIM    WAIT ON FEED            @DL29R05 33550000
          AGO   .C45B                                          @DA03608 33600000
.C45A     TM    IJJA2&DIM,IJJH2&DIM    TEST FOR CHANNEL END    @DA03608 33650000
          BO    *+6                                            @DA03608 33700000
          SVC   7                      WAIT                    @DA03608 33750000
.C45B     ANOP                                                 @DA03608 33800000
          LA    IJJWR&DIM,IJJD0&DIM    PT TO PROPER CCW        @DL29R05 33850000
          ST    IJJWR&DIM,IJJA5&DIM    SET CCB CCW ADRS        @DL29R05 33900000
IJJM4&DIM STM   IJJPR&DIM,IJJRR&DIM,IJJR4&DIM SAVE REGS 0-6    @DL30SMT 33950000
          MVI   IJJL2&DIM+8,IJJM8&DIM  SET PARM LIST END IND   @DL29R05 34000000
          LA    IJJPR&DIM,IJJL2&DIM+4  SET UP DTF ADRS ADRSS   @DL29R05 34050000
          LA    IJJTR&DIM,IJJOP&DIM    PT TO OPEN TRANS. NAME  @DL29R05 34100000
          SVC   2                      CALL OPEN FOR NEW EXTNT @DL29R05 34150000
          MVI   IJJL2&DIM+8,IJJPR&DIM  RESET PARM LIST END IND @DL29R05 34200000
          LM    IJJPR&DIM,IJJRR&DIM,IJJR4&DIM RSTR REGS 0-6    @DL30SMT 34250000
          AIF   ('&TYPEFLE' NE 'INPUT').C48                    @DL29R05 34300000
          AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').C48A @DA14497 34350000
          TM    IJJB3&DIM,IJJH3&DIM    DUAL I/O AREA'S USED ?  @DA14497 34400000
          BZ    IJJM1&DIM              NO, BRANCH              @DA14497 34450000
          NI    IJJB3&DIM,IJJK9&DIM    RESET FIRST TIME SWITCH @DA14497 34500000
          MVC   IJJB9&DIM.(1),IJJC4&DIM MOVE 1ST REC # TO POS  @DA14497 34550000
          B     IJJE2&DIM              AND GET NEXT RECORDS    @DA14497 34600000
          AGO   .C5                                            @DA14497 34650000
.C48A     B     IJJM1&DIM              CONT WITH NEXT VOL      @DA14497 34700000
          AGO  .C5                                                      34750000
.C48      ANOP                                                 @DL29R05 34800000
          AIF  ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').C48D  @DA14497 34850000
          TM   IJJB3&DIM,IJJH2&DIM     OUTPUT FILE ?           @DA14497 34900000
          BZ   IJJF9&DIM               YES, BRANCH             @DA14497 34950000
          TM   IJJB3&DIM,IJJH3&DIM     DUAL I/O AREA'2 USED ?  @DA14497 35000000
          BZ   IJJF9&DIM               NO, BRANCH              @DA14497 35050000
          NI   IJJB3&DIM,IJJK9&DIM     RESET FIRST TIME SWITCH @DA14497 35100000
          MVC  IJJB9&DIM.(1),IJJC4&DIM MOVE 1ST REC # TO POS.  @DA14497 35150000
          MVC  IJJC7&DIM.(1),IJJC4&DIM RESET RECORD NUMBER.    @DA14497 35200000
          B    IJJE2&DIM               READ NEXT RECORDS       @DA14497 35250000
          AGO  .C48C                                           @DA14497 35300000
.C48D     ANOP                                                 @DA14497 35350000
          B    IJJF9&DIM               READ RECORD             @DA14497 35400000
.C48C     ANOP                                                 @DA14497 35450000
IJJM5&DIM MVC  IJJB9&DIM.(1),IJJC4&DIM MOVE 1ST REC NO TO POS  @DL29R05 35500000
          MVC  IJJC6&DIM.(4),IJJB8&DIM  MOVE IN ID                      35550000
IJJK1&DIM IC   IJJGR&DIM,IJJB9&DIM      PICK UP RECORD NUMBER           35600000
          LA   IJJGR&DIM,1(IJJGR&DIM)   ADD ONE                         35650000
          STC  IJJGR&DIM,IJJC7&DIM      STORE IN COUNT FIELD            35700000
         AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').B17   @DL30SMT 35750000
         CLI   IJJA7&DIM-1,IJJM9&DIM   3540 ?                  @DL29R05 35800000
         BNE   IJJN8&DIM               NO, CONTINUE            @DL29R05 35850000
         TM    IJJB3&DIM,IJJH3&DIM     ARE THERE TWO IOAREA'S  @DA11414 35900000
         BZ    IJJN8&DIM               IF NOT BRANCH           @DA11414 35950000
         TM    IJJA3&DIM,IJJH2&DIM     'SPEC REC' ?            @DL29R05 36000000
         BZ    IJJN8&DIM               NO, CONTINUE            @DL29R05 36050000
         OI    IJJA8&DIM+6,IJJG0&DIM   SET DELETE SW           @DL29R05 36100000
         XI    IJJA3&DIM,IJJH2&DIM     SET OFF 'SPEC REC' SW   @DL29R05 36150000
IJJN8&DIM EQU   *                      CONTINUE                @DL29R05 36200000
.B17     ANOP                                                  @DL29R05 36250000
          B    IJJF9&DIM                                                36300000
IJJF3&DIM LR   IJJWR&DIM,IJJTR&DIM      SAVE DTF FILE BASE REGISTER     36350000
          LH   IJJPR&DIM,6(IJJWR&DIM)   PASS LOGICAL UNIT AND CLASS     36400000
          LA   IJJTR&DIM,IJJA6&DIM  ADDR OF MULTI-VOLUME ROUTINE NAME   36450000
          SVC  2 CALL IN TRANSIENT TO HANDLE EOV CONDITION              36500000
          LR   IJJTR&DIM,IJJWR&DIM  RESTORE DTF TABLE ADDRESS TO REG1   36550000
          B    IJJJ8&DIM                                                36600000
.C5      ANOP                                                           36650000
IJJK5&DIM NI   IJJB3&DIM,IJJK9&DIM      TURN ON FIRST PASS INDICATOR    36700000
          TM   IJJD7&DIM,IJJL1&DIM      TEST FOR BRANCH INSTRUCTION     36750000
          BC   1,IJJD7&DIM              YES, EXECUTE BRANCH INSTRUCTION 36800000
          ST   IJJUR&DIM,IJJK7&DIM   NO,SAVE RETURN REGISTER        3-3 36850000
          L    IJJUR&DIM,IJJD7&DIM          LOAD USER ERROR ADDRESS     36900000
          B    IJJK8&DIM                                                36950000
IJJK6&DIM NI   IJJB3&DIM,IJJK9&DIM      TURN ON FIRST PASS INDICATOR    37000000
          TM   IJJD8&DIM,IJJL1&DIM      TEST FOR BRANCH INSTRUCTION     37050000
          BC   1,IJJD8&DIM              YES, EXECUTE BRANCH INSTRUCTION 37100000
          ST   IJJUR&DIM,IJJK7&DIM   NO,SAVE RETURN REGISTER        3-3 37150000
          L    IJJUR&DIM,IJJD8&DIM          LOAD USER ERROR ADDRESS 3-3 37200000
IJJK8&DIM STM  IJJBR&DIM,IJJTR&DIM,IJJL2&DIM SAVE REGISTERS 0,1,15  3-3 37250000
          L    IJJTR&DIM,0(IJJRR&DIM)   POINTER TO I/O AREA INTO REG3-3 37300000
          LM   IJJWR&DIM,IJJRR&DIM,IJJE3&DIM RESTORE USER REGISTERS 3-3 37350000
          AIF  ('&RPS' NE 'SVA').BK18                          @DA20170 37400000
          L    IJJSR&DIM,IJJK4&DIM      RESTORE R13            @DA20170 37450000
.BK18     ANOP                                                 @DA20170 37500000
          AIF  (T'&RDONLY NE 'O' OR '&RPS' EQ 'SVA').BK19      @DL30SMT 37550000
          CNOP 6,8                                             @DM08752 37600000
.BK19     ANOP                                                 @DL30SMT 37650000
          BALR IJJUR&DIM,IJJUR&DIM      SET RETURN ADDR, EXIT TO USE3-3 37700000
          AIF  (T'&RDONLY NE 'O' OR '&RPS' EQ 'SVA').BK20      @DL30SMT 37750000
IJJH7&DIM LM   IJJBR&DIM,IJJTR&DIM,36(IJJUR&DIM) RST RG 15,0,1 @DM08115 37800000
         AGO   .BK21                                           @DL30SMT 37850000
.BK20    LM    IJJBR&DIM,IJJTR&DIM,IJJL2&DIM REST REGS 15,0,1  @DL30SMT 37900000
.BK21    L     IJJUR&DIM,IJJK7&DIM RESTORE RETURN REGISTER     @DL30SMT 37950000
         B     IJJE1&DIM                                            3-3 38000000
         AIF   (T'&RDONLY NE 'O' OR '&RPS' EQ 'SVA').BK22      @DL30SMT 38050000
IJJE3&DIM DC   13F'0'         REGS 2,3,4,5,6                   @DL30SMT 38100000
IJJK7&DIM EQU  IJJE3&DIM+20   REG 14                           @DL30SMT 38150000
IJJL2&DIM EQU  IJJE3&DIM+24   REGS 15,0,1                      @DL30SMT 38200000
IJJR4&DIM EQU  IJJE3&DIM+24   REG 0'                           @DL30SMT 38250000
IJJR5&DIM EQU  IJJE3&DIM+28   REG 1'                           @DL30MST 38300000
IJJR6&DIM EQU  IJJE3&DIM+32   REGS 2',3',4',5',6'              @DL30SMT 38350000
IJJL8&DIM DC   X'00'          SWTCH FOR 360 CNTRL CHR          @DL30SMT 38400000
.BK22    ANOP                                                  @DL30SMT 38450000
IJJFD&DIM CCW   23,*,0,1               3540 FEED CCW           @DL29R05 38500000
IJJOP&DIM DC    CL8'$$BOPEN'           OPEN TRANS. FOR 3540    @DL29R05 38550000
IJJON&DIM DC    F'65536'                X'00010000' ADD 1 AT CYL.   4-0 38600000
IJJBR&DIM EQU  15   BASEREG FOR MODULE                                  38650000
IJJUR&DIM EQU  14   RETURN REGISTER                                     38700000
IJJTR&DIM EQU  1    DTF FILE BASE                                       38750000
IJJPR&DIM EQU  0    WORK REGISTER                                       38800000
IJJWR&DIM EQU  2    WORK REGISTER                                       38850000
IJJMR&DIM EQU  3    WORK REGISTER                                       38900000
IJJGR&DIM EQU  4    WORK REGISTER                                       38950000
IJJLR&DIM EQU  5    LINKAGE REGISTER                                    39000000
IJJRR&DIM EQU  6    POINTER TO CCW CONTAINING I/O AREA                  39050000
         AIF   ('&RPS' NE 'SVA').RPS5                          @DL30SMT 39100000
IJJER&DIM EQU   12            REGISTER 12                      @DL30SMT 39150000
IJJM6&DIM EQU  X'80'          TEST FOR INPUT FILE              @DL30SMT 39200000
.RPS5    ANOP                                                  @DL30SMT 39250000
IJJM8&DIM EQU   X'FF'                  PARM LIST END IND       @DL29R05 39300000
IJJF0&DIM EQU  X'01'   TEST FOR UNIT EXEPTION, PRINT COMMAND            39350000
IJJF7&DIM EQU  X'03'   TEST FOR A READER, TAPE OR DISK                  39400000
IJJG0&DIM EQU  X'40'   TEST FOR EJECT NEEDED, WLR ERROR                 39450000
IJJH2&DIM EQU  X'80'   TEST FOR DEVICE END, CHANNEL END                 39500000
IJJM9&DIM EQU  X'06'                   TEST FOR 3540 DEVICE    @DL29R05 39550000
IJJH3&DIM EQU  X'10'   TEST FOR PUNCH ERR, 2 I/O AREAS, READ ERROR      39600000
IJJJ9&DIM EQU  X'20'   INDICATE NOT FIRST PASS                          39650000
IJJK2&DIM EQU  3       COUNTER FOR DISK UPDATE                          39700000
IJJMF&DIM EQU  X'80'                    TEST FOR MFCM/U        @DM08032 39750000
IJJCV&DIM EQU  X'E5'                    TEST FOR V CONTROL CHAR      CI 39800000
IJJCW&DIM EQU  X'E6'                    TEST FOR W CONTROL CHAR      CI 39850000
IJJK9&DIM EQU  X'DF'   SET FIRST PASS INDICATOR ON                      39900000
IJJL1&DIM EQU  X'47'   OP CODE OF BRANCH INSTRUCTION                    39950000
IJJG7&DIM DC   H'13'    CONSTANT FOR DETERMING ASA SKIP CHARACTER       40000000
IJJF2&DIM EQU  X'08'     TEST FOR PRINTER, 2540 PUNCH                   40050000
IJJDL&DIM EQU  81      TEST FOR 81 BYTES INPUT LENGTH          @D37ZDHK 40100000
         AIF   ('&IOAREA2' NE 'YES' AND '&RPS' NE 'SVA').D1    @DL30SMT 40150000
IJJE7&DIM EQU  X'30'   TEST FOR OVERLAP AND FIRST PASS                  40200000
         AIF   ('&TYPEFLE' NE 'INPUT').D2                               40250000
IJJE8&DIM EQU  IJJH8&DIM CONNECT FOR BRANCH                             40300000
          AGO  .D3                                                      40350000
.D2      ANOP                                                           40400000
IJJJ4&DIM EQU  X'0C'  TEST FOR PUNCH OR PRINTER                         40450000
.D1      AIF   ('&TYPEFLE' EQ 'INPUT').D3                               40500000
IJJE4&DIM EQU  X'FF'  TEST TABLE FORMAT                                 40550000
IJJF4&DIM EQU  X'02'  TEST FOR SYSLST OR SYSPCH ON OUTPUT TAPE          40600000
IJJG2&DIM EQU  X'BF'  TEST FOR EJECT NEEDED                             40650000
IJJG4&DIM EQU  18     NO. OF CONTROL CHARACTERS                         40700000
IJJG9&DIM EQU  X'0B'  SPACE COMMAND FOR PRINTER                         40750000
IJJM0&DIM DC   H'6'                                                     40800000
          AIF   ('&TYPEFLE' EQ 'INPUT').D5                     @D34YSRJ 40850000
          AIF   ('&TRC' NE 'YES').D5                           @D34YSRJ 40900000
IJJMB&DIM EQU  X'01'                    3800 INDICATOR         @D34YSRC 40950000
IJJMC&DIM EQU  X'06'                    TRC INDICATOR MASK     @D34YSRC 41000000
IJJMP&DIM EQU  X'40'                    MASK TO IDENTIFY TRC   @D34YSRC 41050000
*                                       COMMAND CODES          @D34YSRC 41100000
IJJMT&DIM DC   XL16'47576777474747474747474747474747' TRC TBL  @D34YSRC 41150000
.D5      ANOP                                                  @D34YSRJ 41200000
IJJH6&DIM DC   C'$$BERRTN'                                              41250000
IJJL3&DIM EQU  *-1                                                      41300000
          DC   C'123456789ABC+VW-0 '                                    41350000
IJJH0&DIM DC   X'0B8B939BA3ABB3BBC3CBD3DBE30301411B130B'                41400000
.D3      ANOP                                                  @DL30SMT 41450000
IJJZZ&DIM EQU  *-IJJE0&DIM    LENGTH OF THIS DIMOD EXPANSION   @DL30SMT 41500000
         AIF   (T'&SEPASMB NE 'O' OR '&RPS' EQ 'SVA').D4       @DL30SMT 41550000
&SYSECT  CSECT                                                      3-3 41600000
.D4      MEND                                                       3-3 41650000
