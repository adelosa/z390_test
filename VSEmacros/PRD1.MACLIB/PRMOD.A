         MACRO                                                          00050000
&LABEL   PRMOD &DEVICE=1403,&IOAREA2=,&WORKA=,&RECFORM=FIXUNB,         X00100000
               &CTLCHR=,&PRINTOV=,&CONTROL=,&SEPASMB=,&STLIST=,        X00150000
               &RDONLY=,&ERROPT=,&FUNC=,&TRC=                  @D34YSRJ 00200000
         LCLC  &CASE                                           @DA29705 00250000
         LCLA  &AL4,&AL5,&AL6,&AL7,&AL8                        @DA22933 00300000
         LCLA  &OFFS  OFFSET OF DATA IN RECORD                       JJ 00350000
         LCLA  &REG  REG 13 IF WORKA=YES, ELSE REG 14                JJ 00400000
         LCLB  &BL1,&BL2                                                00450000
         LCLC  &CG9,&RECF,&CNTL,&PROV,&IOA2,&WKAR,&NAM,&ENT,&AL1    4-0 00500000
         LCLC  &PRV1,&CG1                                           4-0 00550000
         LCLC  &X,&DEV,&FC,&DV                                       JJ 00600000
         LCLC  &TARC                                           @D34YSRJ 00650000
.*                                                                      00700000
.* IBM DISK OPERATING SYSTEM                                            00750000
* IOCS AND DEVICE INDEPENDANT I/O-PRMOD-5686-007-02-C440       @U31TUJS 00800000
         AGO   .ZZZ                                            @U31TUJS 00850000
* COPYRIGHT = THIS MACRO IS "RESTRICTED MATERIALS OF IBM"      @U31TDKY 00900000
*             5686-007 (C) COPYRIGHT IBM CORP. 1981,1989       @U31TUJS 00950000
*             ALL RIGHT RESERVED                               @U31TUJS 01000000
*             LICENSED MATERIALS-PROPERTY OF IBM               @U31TUJS 01050000
*             SEE COPYRIGHT INFORMATION, G120-2083             @U31TUJS 01100000
.ZZZ     ANOP                                                  @U31TUJS 01150000
.* 12/1984  IGNORE ORDER AND CLRPRT CONTROL COMMANDS           @D21DUJS 01200000
.* 10/1987  MSG2101I DUE TO CATALOG STMT STARTING IN COL. 1.   @DA36950 01250000
.*                                                                      01300000
         AIF   (K'&DEVICE LT 4).JJ000                                JJ 01350000
&DV      SETC  '&DEVICE'(1,4)                                        JJ 01400000
         AIF   ('&DV' EQ '2560' OR '&DV' EQ '5425').MFCX       @DL2994J 01450000
.JJ000   ANOP                                                        JJ 01500000
&CG9     SETC  '&SYSNDX'(2,3)                                           01550000
&CG1     SETC  '&DEVICE'(1,4)                                       3-9 01600000
         AIF   ('&CG1' EQ 'PRT1' OR '&CG1' EQ '3800'                   *01650000
               OR '&CG1' EQ '3211').E001                       @D14BDBF 01700000
         AIF   ('&CG1' EQ '1403' OR '&CG1' EQ '1404' OR '&CG1' EQ '1443*01750000
               ' OR '&CG1' EQ '1445').E001                     @D14BDBF 01800000
         AIF   ('&CG1' EQ '2245' OR '&CG1' EQ '3525').E001          4-0 01850000
         AIF   ('&CG1' EQ '5203' OR '&CG1' EQ '3203').E001     @D14BDBF 01900000
&CG1     SETC  '1403'                                               3-9 01950000
         MNOTE 0,'DEVICE SPECIFIED WRONGLY. 1403 ASSUMED'      @D34YSRC 02000000
.E001    ANOP                                                       3-9 02050000
&RECF    SETC  'U'                                                      02100000
         AIF   ('&RECFORM' EQ 'UNDEF').P1                               02150000
&RECF    SETC  'V'                                                      02200000
         AIF   ('&RECFORM' EQ 'VARUNB').P1                              02250000
&RECF    SETC  'F'                                                      02300000
         AIF   ('&RECFORM' EQ 'FIXUNB').P1                              02350000
         MNOTE 0,'IMPROPER RECFORM. ''FIXUNB'' ASSUMED'                 02400000
.P1      ANOP                                                           02450000
&CNTL    SETC  'C'                                                      02500000
         AIF   ('&CONTROL' EQ 'YES').P2                                 02550000
         AIF   (T'&CONTROL EQ 'O').P25A                                 02600000
         MNOTE 0,'IMPROPER CONTROL . ''YES'' ASSUMED'                   02650000
.P2      AIF   (T'&CTLCHR EQ 'O').P35A                                  02700000
         MNOTE 0,'CTLCHR AND CONTROL BOTH SPECIFIED,CONTROL CONSIDERED' 02750000
         AGO   .P35A                                                    02800000
.P25A    ANOP                                                           02850000
&CNTL    SETC  'A'                                                      02900000
         AIF   ('&CTLCHR' NE 'ASA').P3A                             4-0 02950000
         AIF   ('&CG1' NE '2245').P35A                              4-0 03000000
&CNTL    SETC  'M'                                                  4-0 03050000
         AGO   .P35A                                                4-0 03100000
.P3A     ANOP                                                           03150000
&CNTL    SETC  'Y'                                                      03200000
         AIF   ('&CTLCHR' EQ 'YES').P35A                                03250000
         AIF   (T'&CTLCHR EQ 'O').P3                                    03300000
         MNOTE 0,'IMPROPER CTLCHR. ''YES'' ASSUMED'                     03350000
         AGO   .P35A                                                    03400000
.P3      ANOP                                                           03450000
&CNTL    SETC  'Z'                                                      03500000
.P35A    ANOP                                                           03550000
         AIF   (T'&TRC EQ 'O').P35D                            @D34YSRJ 03600000
         AIF   ('&CG1' EQ '3800').P35B                         @D34YSRJ 03650000
         MNOTE 0,'''TRC'' NOT VALID FOR &CG1, IGNORED.'        @D34YSRJ 03700000
         AGO   .P35D                                           @D34YSRJ 03750000
.P35B    ANOP                                                  @D34YSRJ 03800000
         AIF   ('&TRC' EQ 'NO').P35D                           @D34YSRJ 03850000
         AIF   ('&TRC' EQ 'YES').P35C                          @D34YSRJ 03900000
         MNOTE 0,'IMPROPER ''TRC''.  ''NO'' ASSUMED.'          @D34YSRJ 03950000
         AGO   .P35D                                           @D34YSRJ 04000000
.P35C    ANOP                                                  @D34YSRJ 04050000
&TARC    SETC  'Y'                                             @D34YSRJ 04100000
.P35D    ANOP                                                  @D34YSRJ 04150000
&PRV1    SETC  'ZORST'                                              4-0 04200000
         AIF   (T'&PRINTOV EQ 'O').P4                                   04250000
         AIF   ('&PRINTOV' EQ 'YES').PQP1                               04300000
         MNOTE 0,'IMPROPER PRINTOV. ''YES'' ASSUMED'                    04350000
.PQP1    ANOP                                                           04400000
&PRV1    SETC  'PIFCD'                                              4-0 04450000
.P4       ANOP                                                      4-0 04500000
&PROV    SETC  '&PRV1'(1,1)                                         4-0 04550000
         AIF   ('&CG1' NE '3525').FUN3                              4-0 04600000
&PROV    SETC  '&PRV1'(2,1)                                         4-0 04650000
         AIF   (T'&FUNC EQ 'O').FUN4                                4-0 04700000
         AIF   ('&FUNC' EQ 'W').FUN4                                4-0 04750000
         AIF   ('&FUNC' EQ 'WT').FUN1                               4-0 04800000
&PROV    SETC  '&PRV1'(3,1)                                         4-0 04850000
         AIF   ('&FUNC' EQ 'RW').FUN2B                              4-0 04900000
         AIF   ('&FUNC' EQ 'RWT').FUN1                              4-0 04950000
&PROV    SETC  '&PRV1'(4,1)                                         4-0 05000000
         AIF   ('&FUNC' EQ 'PW').FUN2B                              4-0 05050000
         AIF   ('&FUNC' EQ 'PWT').FUN1                              4-0 05100000
&PROV    SETC  '&PRV1'(5,1)                                         4-0 05150000
         AIF   ('&FUNC' EQ 'RPWT').FUN1                             4-0 05200000
         AIF   ('&FUNC' EQ 'RPW').FUN2B                             4-0 05250000
         MNOTE 9,'FUNC INVALID PARAMETER. MACRO NOT GENERATED'      4-0 05300000
         MEXIT                                                      4-0 05350000
.FUN1    AIF   ('&CNTL' NE 'Z').FUN1A                               4-0 05400000
&CNTL    SETC  'T'                                                  4-0 05450000
         AGO   .FUN2                                                4-0 05500000
.FUN1A   MNOTE 0,'FUNC=NNNT SPECIFIED WITH CONTROL OR CTLCHR. PARAMETERX05550000
                T IGNORED'                                     @DA00138 05600000
.FUN2    AIF   ('&FUNC' EQ 'WT').FUN4                               4-0 05650000
.FUN2B   ANOP                                                       4-0 05700000
&AL7     SETA  1                                                    4-0 05750000
         AGO   .FUN4                                                4-0 05800000
.FUN3    AIF   (T'&FUNC EQ 'O').FUN4                                4-0 05850000
         MNOTE 0,'FUNC INVALID WITH DEVICE. IGNORED'                4-0 05900000
.FUN4     AIF   (T'&ERROPT EQ 'O').ERRX                             4-0 05950000
         AIF   ('&CG1' EQ '3211').ERROK                             3-9 06000000
         AIF   ('&CG1' EQ 'PRT1').ERROK                        @D34CDMO 06050000
         AIF   ('&CG1' EQ '2245').ERROK                        @DA01036 06100000
         MNOTE 3,'ERROPT NOT VALID FOR &CG1, IGNORED'               3-9 06150000
         AGO   .ERRX                                                3-9 06200000
.ERROK   AIF   ('&ERROPT' EQ 'YES').ERRYES                          3-9 06250000
         MNOTE 0,'IMPROPER ERROPT. ''YES'' ASSUMED'                 3-9 06300000
.ERRYES  AIF   ('&PROV' EQ 'P').ERRP                                3-9 06350000
&PROV    SETC  'E'                                                  3-9 06400000
         AGO   .ERRX                                                3-9 06450000
.ERRP    ANOP                                                       3-9 06500000
&PROV    SETC  'B'                                                  3-9 06550000
.ERRX    ANOP                                                       3-9 06600000
&IOA2    SETC  'Z'                                                      06650000
         AIF   ('&IOAREA2' EQ '').P45A                              3-3 06700000
         AIF   ('&IOAREA2' EQ 'YES').P4A                                06750000
         MNOTE 0,'IMPROPER IOAREA2. ASSUME YES'                         06800000
.P4A     ANOP                                                           06850000
&IOA2    SETC  'I'                                                      06900000
.P45A    ANOP                                                           06950000
&WKAR    SETC  'Z'                                                      07000000
         AIF   (T'&WORKA EQ 'O').P13                                    07050000
          AIF   ('&WORKA' EQ 'YES').HARA1                               07100000
          MNOTE 0,'IMPROPER WORKA. ''YES'' ASSUMED'                     07150000
.HARA1    ANOP                                                          07200000
&WKAR    SETC  'W'                                                      07250000
         AIF   ('&DEVICE' NE '2245').P13                       @DA01036 07300000
&WKAR    SETC  'T'                                             @DA01036 07350000
.P13     AIF   (T'&RDONLY EQ 'O').P13A                              3-3 07400000
         AIF   ('&WKAR' EQ 'Z').P13B                                3-3 07450000
&WKAR    SETC  'V'                                                  3-3 07500000
         AIF   ('&DEVICE' NE '2245').P13A                      @DA01036 07550000
&WKAR    SETC  'R'                                             @DA01036 07600000
         AGO   .P13A                                                3-3 07650000
.P13B    ANOP                                                       3-3 07700000
&WKAR    SETC  'Y'                                                  3-3 07750000
.P13A    ANOP                                                       3-3 07800000
         AIF   ('&STLIST' EQ '').CC                                     07850000
         AIF   ('&CG1' EQ '1403').STOK                              3-9 07900000
         MNOTE 0,'''STLIST'' NOT VALID FOR &CG1, IGNORED'           3-9 07950000
         AGO   .CC                                                  3-9 08000000
.STOK    AIF   ('&STLIST' EQ 'YES').DD                              3-9 08050000
         MNOTE 'IMPROPER STLIST. YES ASSUMED'                           08100000
.DD      ANOP                                                           08150000
&RECF    SETC  'F'                                                      08200000
&CNTL    SETC  'S'                                                      08250000
&PROV    SETC  'Z'                                                      08300000
.CC      ANOP                                                           08350000
&NAM      SETC  'IJD&RECF&CNTL&PROV&IOA2&WKAR'                          08400000
         AIF   (T'&LABEL EQ 'O').BK1                                3-3 08450000
&NAM      SETC  '&LABEL'                                            3-3 08500000
.BK1     AIF   (T'&RDONLY EQ 'O' OR '&RDONLY' EQ 'YES').AAA         3-3 08550000
         MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED'                 3-3 08600000
.AAA      AIF   (T'&SEPASMB EQ 'O').BBB                                 08650000
          AIF   ('&SEPASMB' EQ 'YES').MM1                               08700000
          MNOTE 0,'IMPROPER SEPASMB. ''YES'' ASSUMED'                   08750000
.MM1 PUNCH ' CATALOG &NAM..OBJ                     REPLACE=YES'         08800000
*                                                              @DA36950 08850000
.BBB      ANOP                                                          08900000
IJDPD&CG9 DSECT                                                         08950000
IJDP0&CG9 DS    CL2                    RESIDUAL COUNT                   09000000
IJDP1&CG9 DS    CL1                    COMMUNICATION BYTE 1             09050000
IJDP2&CG9 DS    CL1                    COMMUNICATION BYTE 2             09100000
IJDPO&CG9 DS    CL2                    CSW STATUS BYTES                 09150000
IJDP3&CG9 DS    CL2                    LOGICAL UNIT ADDRESS             09200000
          DS    CL1                    NOT USED                         09250000
IJDP4&CG9 DS    CL3                    ADDRESS OF CCW                   09300000
          DS    CL1                    STATUS BYTE                      09350000
          DS    CL3                    CSW CCW ADDR.                    09400000
IJDM1&CG9 DS    CL4                         ADDRESS OF LOGIC MODULE 4-0 09450000
IJDP5&CG9 DS    CL1                    DTF TYPE                         09500000
IJDP6&CG9 DS    CL1                    SWITCHES                         09550000
IJDP9&CG9 DS    CL1                    NORMAL COMMAND CODE              09600000
IJDPA&CG9 DS    CL1                    CONTROL COMMAND CODE             09650000
IJDP7&CG9 DS    CL4                    ADDRESS OF  IOAREA 1             09700000
IJDP8&CG9 DS    CL4                    BUCKET                           09750000
IJDPB&CG9 DS    CL2                    L 12,&RECSIZE                    09800000
IJDPC&CG9 DS    CL4                    LA &IOREG,0(14)                  09850000
IJDPE&CG9 DS    CL1                    BUCKET FOR PRTOV IF ASA CH 9     09900000
IJDPF&CG9 DS    CL1                    BUCKET FOR PRTOV IF ASA CH 12    09950000
         AIF   ('&CNTL' NE 'S').EE                                      10000000
IJDPQ&CG9 DS   CL8                      CCW USED WITH STLIST        3-5 10050000
.EE      ANOP                                                           10100000
IJDPG&CG9 DS    CL1                    COMMAND CODE                     10150000
IJDPH&CG9 DS    CL3                    ADDRESS IOAREA 2                 10200000
IJDPI&CG9 DS    CL1                    FLAGS =X'20'                     10250000
          AIF   ('&TARC' EQ 'Y').EE0                           @D34YSRJ 10300000
          DS    CL1                    NOT USED                         10350000
          AGO   .EE01                                          @D34YSRJ 10400000
.EE0      ANOP                                                 @D34YSRJ 10450000
IJDTC&CG9 DS    CL1                    SAVED TRC OP CODE       @D34YSRC 10500000
.EE01     ANOP                                                 @D34YSRJ 10550000
IJDPJ&CG9 DS    CL2                    COUNT                            10600000
          AIF   (&AL7 NE 1).EE1                                     4-0 10650000
IJDM2&CG9 DS    CL4                         A(ASOCFLE)              4-0 10700000
.EE1      AIF   ('&CG1' EQ '3525').SKIPER                           4-0 10750000
         AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').SKIPER            3-9 10800000
IJDPL&CG9 DS    CL4                    ADDRESS OF USER ERROR ROUTINE3-9 10850000
.SKIPER  ANOP                                                       3-9 10900000
&NAM      CSECT                                                         10950000
          AIF   (T'&LABEL NE 'O').BETA                                  11000000
          AIF   ('&CNTL' NE 'C').ALPHA                                  11050000
&ENT      SETC  '&NAM'(1,4)'Z'.'&NAM'(6,3)                              11100000
          ENTRY &ENT                                                    11150000
&ENT      EQU   *                                                       11200000
         AIF   ('&PROV' EQ 'Z').BETA                                3-9 11250000
          AIF   ('&PROV' EQ 'O' OR '&PROV' EQ 'R').BETA             4-0 11300000
          AIF   ('&PROV' EQ 'S' OR '&PROV' EQ 'T').BETA             4-0 11350000
         AIF   ('&PROV' NE 'B').G3525E1                        @DA02705 11400000
&ENT     SETC  '&NAM'(1,4)'ZE'.'&NAM'(7,2)                          3-9 11450000
         ENTRY &ENT                                                 3-9 11500000
&ENT     EQU   *                                                    3-9 11550000
&ENT     SETC  '&NAM'(1,4)'ZP'.'&NAM'(7,2)                          3-9 11600000
         ENTRY &ENT                                                 3-9 11650000
&ENT     EQU   *                                                    3-9 11700000
.G3525E1 AIF   ('&CG1' NE '3525').GENZ1                        @DA02705 11750000
.ISI1    AIF   ('&PROV' NE 'I').NOI1                           @DA02705 11800000
&ENT     SETC  '&NAM'(1,4)'ZO'.'&NAM'(7,2)                     @DA02705 11850000
         ENTRY &ENT                                            @DA02705 11900000
&ENT     EQU   *                                               @DA02705 11950000
         AGO   .ISI2                                           @DA02705 12000000
.NOI1    AIF   ('&PROV' NE 'F').NOF1                           @DA02705 12050000
&ENT     SETC  '&NAM'(1,4)'ZR'.'&NAM'(7,2)                     @DA02705 12100000
         ENTRY &ENT                                            @DA02705 12150000
&ENT     EQU   *                                               @DA02705 12200000
         AGO   .ISF2                                           @DA02705 12250000
.NOF1    AIF   ('&PROV' NE 'C').NOC1                           @DA02705 12300000
&ENT     SETC  '&NAM'(1,4)'ZS'.'&NAM'(7,2)                     @DA02705 12350000
         ENTRY &ENT                                            @DA02705 12400000
&ENT     EQU   *                                               @DA02705 12450000
         AGO   .ISC2                                           @DA02705 12500000
.NOC1    AIF   ('&PROV' NE 'D').ALPHA                          @DA02705 12550000
&ENT     SETC  '&NAM'(1,4)'ZT'.'&NAM'(7,2)                     @DA02705 12600000
         ENTRY &ENT                                            @DA02705 12650000
&ENT     EQU   *                                               @DA02705 12700000
         AGO   .ISD2                                           @DA02705 12750000
.GENZ1   ANOP                                                       3-9 12800000
&ENT      SETC  '&NAM'(1,4)'ZZ'.'&NAM'(7,2)                             12850000
          ENTRY &ENT                                                    12900000
&ENT      EQU   *                                                       12950000
.ALPHA   AIF   ('&PROV' EQ 'Z').BETA                                3-9 13000000
          AIF   ('&PROV' EQ 'O' OR '&PROV' EQ 'R').BETA             4-0 13050000
          AIF   ('&PROV' EQ 'S' OR '&PROV' EQ 'T').BETA             4-0 13100000
         AIF   ('&PROV' NE 'B').G3525E2                        @DA02705 13150000
&ENT     SETC  '&NAM'(1,5)'E'.'&NAM'(7,2)                           3-9 13200000
         ENTRY &ENT                                                 3-9 13250000
&ENT     EQU   *                                                    3-9 13300000
&ENT     SETC  '&NAM'(1,5)'P'.'&NAM'(7,2)                           3-9 13350000
         ENTRY &ENT                                                 3-9 13400000
&ENT     EQU   *                                                    3-9 13450000
.G3525E2 AIF   ('&CG1' NE '3525').GENZ2                        @DA02705 13500000
.ISI2    AIF   ('&PROV' NE 'I').ISF2                           @DA02705 13550000
&ENT     SETC  '&NAM'(1,5)'O'.'&NAM'(7,2)                      @DA02705 13600000
         ENTRY &ENT                                            @DA02705 13650000
&ENT     EQU   *                                               @DA02705 13700000
         AGO   .BETA                                           @DA02705 13750000
.ISF2    AIF   ('&PROV' NE 'F').ISC2                           @DA02705 13800000
&ENT     SETC  '&NAM'(1,5)'R'.'&NAM'(7,2)                      @DA02705 13850000
         ENTRY &ENT                                            @DA02705 13900000
&ENT     EQU   *                                               @DA02705 13950000
         AGO   .BETA                                           @DA02705 14000000
.ISC2    AIF   ('&PROV' NE 'C').ISD2                           @DA02705 14050000
&ENT     SETC  '&NAM'(1,5)'S'.'&NAM'(7,2)                      @DA02705 14100000
         ENTRY &ENT                                            @DA02705 14150000
&ENT     EQU   *                                               @DA02705 14200000
         AGO   .BETA                                           @DA02705 14250000
.ISD2    AIF   ('&PROV' NE 'D').BETA                           @DA02705 14300000
&ENT     SETC  '&NAM'(1,5)'T'.'&NAM'(7,2)                      @DA02705 14350000
         ENTRY &ENT                                            @DA02705 14400000
&ENT     EQU   *                                               @DA02705 14450000
         AGO   .BETA                                           @DA02705 14500000
.GENZ2   ANOP                                                       3-9 14550000
&ENT      SETC  '&NAM'(1,5)'Z'.'&NAM'(7,2)                              14600000
          ENTRY &ENT                                                    14650000
&ENT      EQU   *                                                       14700000
.BETA     USING IJDP0&CG9,1                                             14750000
          USING *,15                                                    14800000
          AIF   ('&CNTL' NE 'C').P14                                    14850000
          B     IJDPK&CG9              BRANCH TO CONTROL                14900000
          AGO   .P15                                                    14950000
.P14      ANOP                                                          15000000
          SVC   IJDL6&CG9              CONTROL  ERROR                   15050000
          DC    1H'0'                                                   15100000
.P15     AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'E').P16               3-9 15150000
          AIF   ('&PROV' EQ 'O' OR '&PROV' EQ 'R').P16              4-0 15200000
          AIF   ('&PROV' EQ 'S' OR '&PROV' EQ 'T').P16              4-0 15250000
          B     IJDPM&CG9                                               15300000
          AGO   .P17                                                    15350000
.P16      SVC   IJDL6&CG9              PRTOV  ERROR                     15400000
          DC    1H'0'                                                   15450000
.P17      SVC   IJDL6&CG9              GET ERROR                        15500000
          DC    1H'0'                                                   15550000
          B     IJDPR&CG9              BRANCH TO PUT                    15600000
          AIF   (&AL7 NE 1).P17A                                    4-0 15650000
IJDME&CG9 SVC   IJDL6&CG9                   MACRO SEQUENCE          4-0 15700000
          DC    H'0'                         ERROR                  4-0 15750000
.P17A     DC    CL8'&NAM'              MODULE NAME                  4-0 15800000
          DC    X'3440'   /*@@LDLID*/ CHANGE LEVEL             @D41TDKY 15850000
IJDPR&CG9 EQU   *                                                       15900000
          AIF   (T'&RDONLY NE 'O').ST1                         @DA29705 15950000
          STM   IJDL1&CG9,IJDL4&CG9,IJDM7&CG9  SAVE USER REGS  @DA29705 16000000
          AGO   .ST2                                           @DA29705 16050000
.ST1      STM   IJDL0&CG9,IJDL4&CG9,0(IJDL3&CG9)  SAVE REGS    @DA29705 16100000
.ST2      AIF   ('&IOAREA2' NE '').P53                         @DA01035 16150000
         AIF   ('&WORKA' NE '').P53                            @DA01035 16200000
          AIF  ('&CNTL' NE 'C').P51C                           @DA01035 16250000
          AIF   ('&CNTL' EQ 'C' AND '&CG1' EQ '3525').P51C     @DA01035 16300000
.P53      AIF   ('&CG1' EQ '3525').P54V                        @DA01035 16350000
          AIF   ('&PROV' NE 'Z' AND '&PROV' NE 'P').P53A       @DA01035 16400000
.P54V     TM    IJDP1&CG9,IJDL8&CG9    WAIT CHANNEL END        @DA01035 16450000
          BO    *+6                                            @DA01035 16500000
          SVC   7                                              @DA01035 16550000
.P51C     AIF   ('&CG1' NE '3525').P52A                        @DA01035 16600000
          AIF   ('&PROV' EQ 'O' OR '&PROV' EQ 'I').P52A             4-0 16650000
          L     IJDL4&CG9,IJDM2&CG9         LOAD ADDR. ASOCFLE      4-0 16700000
          TM    IJDM1&CG9,IJDLA&CG9         FILE OPENED IGNORE @DA13914 16750000
          BO    IJDV5&CG9                   YES, CONTINUE      @DA13914 16800000
          TM    IJDP6&CG9,IJDL8&CG9         PRINT FILE OPEN         4-0 16850000
          BZ    IJDME&CG9                   NO, MACRO SEQ ERROR     4-0 16900000
IJDV5&CG9 EQU   *                                              @DA13914 16950000
          AIF   ('&FUNC' EQ 'RW' OR '&FUNC' EQ 'RWT').P52B          4-0 17000000
          AIF   ('&FUNC' EQ 'PW' OR '&FUNC' EQ 'PWT').P52C          4-0 17050000
          TM    IJDMA&CG9.(IJDL4&CG9),IJDLA&CG9  RD FILE IGN ? @DA13914 17100000
          BO    IJDV6&CG9                   YES, CONTINUE      @DA13914 17150000
          TM    IJDM6&CG9.(IJDL4&CG9),IJDL8&CG9    READ FILE OPEN   4-0 17200000
          BZ    IJDME&CG9                   NO, MACRO SEQ ERROR     4-0 17250000
IJDV6&CG9 TM    IJDLC&CG9.(IJDL4&CG9),IJDLC&CG9   GET ISSUED   @DA13914 17300000
          BO    IJDME&CG9                   YES, MACRO SEQ ERROR    4-0 17350000
          L     IJDL4&CG9,IJDM8&CG9.(IJDL4&CG9)    PT. PUNCH FILE   4-0 17400000
.P52C     TM    IJDLC&CG9.(IJDL4&CG9),IJDLC&CG9    PUT ISSUED       4-0 17450000
          BZ    IJDME&CG9                   NO, MACRO SEQ ERROR     4-0 17500000
          TM    IJDV2&CG9.(IJDL4&CG9),IJDLA&CG9   HAS CARD BEEN FED 4-0 17550000
          BZ    IJDV1&CG9                         NO CONTINUE       4-0 17600000
          MVI   IJDV2&CG9.(IJDL4&CG9),IJDL7&CG9   RESET FOR PRINT   4-0 17650000
          AGO   .P52D                                               4-0 17700000
.P52B     TM    IJDLC&CG9.(IJDL4&CG9),IJDLC&CG9   GET ISSUED        4-0 17750000
          BZ    IJDME&CG9                   NO, MACRO SEQ ERROR     4-0 17800000
          TM    IJDM8&CG9.(IJDL4&CG9),IJDLA&CG9   CARD BEEN FED     4-0 17850000
          BZ    IJDV1&CG9                         NO, CONTINUE      4-0 17900000
          MVI   IJDM8&CG9.(IJDL4&CG9),IJDL7&CG9   YES RESET FOR PRN 4-0 17950000
.P52D     AIF   ('&CNTL' NE 'C').PR51                               4-0 18000000
          NI    IJDPE&CG9,IJDL7&CG9         RESET CNTRL SWITCH @DA14003 18050000
.PR51     MVI   IJDP9&CG9,IJD05&CG9               RESET TO LINE 1   4-0 18100000
IJDV3&CG9 MVI   IJDPG&CG9,IJD05&CG9               RESET OPCODE      4-0 18150000
          AIF   (T'&RDONLY NE 'O').RP52AA                      @DM16844 18200000
IJDV1&CG9 L     IJDL4&CG9,12+IJDM7&CG9         RESTORE REG 14  @DA29705 18250000
          AGO   .RP52AB                                        @DM16844 18300000
.RP52AA   ANOP                                                 @DM16844 18350000
IJDV1&CG9 L    IJDL4&CG9,16(IJDL3&CG9)         RESTORE REG 14  @DA29705 18400000
.RP52AB   ANOP                                                 @DM16844 18450000
.P52A     AIF   ('&IOAREA2' NE '').P53A                        @DA01035 18500000
         AIF   ('&WORKA' NE '').P53A                           @DA01035 18550000
          AIF  ('&CNTL' NE 'C').P54                                     18600000
          AIF   ('&CNTL' EQ 'C' AND '&CG1' EQ '3525').P54           4-0 18650000
.P53A    AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').P54               3-9 18700000
          AIF   ('&CG1' EQ '3525').P54A                             4-0 18750000
         AIF  (T'&RDONLY NE 'O').SR1                           @DA29705 18800000
         BAL   IJDL4&CG9,IJDSR&CG9                             @DA29705 18850000
         L     IJDL4&CG9,12+IJDM7&CG9  RESTORE LINK REGISTER   @DA29705 18900000
         AGO   .P54                                            @DA29705 18950000
.SR1     BAL   IJDL0&CG9,IJDSR&CG9                             @DA29705 19000000
         L    IJDL0&CG9,0(IJDL3&CG9)   RESTORE LINK REGISTER   @DA29705 19050000
.P54     AIF   ('&CNTL' NE 'S').P54A                           @DA29705 19100000
         NI    IJDPG&CG9,X'7F'                                      3-9 19150000
         CLI   IJDPF&CG9,X'00'          TEST FOR SPACE OR SKIP      3-5 19200000
         BE    IJDQB&CG9                NO                          3-5 19250000
         MVC   IJDPE&CG9.(1),IJDP8&CG9+3 USE NEW STLIST BYTE NOW    3-5 19300000
         CLI   IJDPF&CG9,X'01'          TEST FOR SKIP               3-5 19350000
         BE    IJDQA&CG9                NO                          3-5 19400000
         OI    IJDPG&CG9,X'80'                                      3-5 19450000
IJDQA&CG9 NI   IJDPF&CG9,X'00'          RESET SPSKSWITCH            3-5 19500000
IJDQB&CG9 EQU *                                                     3-5 19550000
.P54A    AIF   ('&RECF' NE 'F').P61                                 3-5 19600000
          AIF   ('&IOAREA2' NE '').P61                                  19650000
          AIF   ('&WORKA' NE '').P61                                    19700000
         AIF   ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A' OR '&CNTL' EQ 'M').P61 19750000
         AIF   ('&TARC' EQ 'Y').P61                            @D34YSRJ 19800000
&BL2      SETB  1                                                       19850000
          AGO   .P62                                                    19900000
.P61     AIF   ('&RECF' NE 'U').P611                           @DA10939 19950000
         EX    0,IJDPB&CG9             LOAD REG 12 WITH LENGTH @DA10939 20000000
.P611    AIF   (T'&RDONLY EQ 'O').P51                          @DA10939 20050000
         LR    IJDL1&CG9,IJDL3&CG9   SAVE POINTER TO SAVE AREA @DA10939 20100000
.P51      AIF   ('&WORKA' NE '').P50                                    20150000
         AIF   ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A' OR '&CNTL' EQ 'M').P50 20200000
         AIF   ('&TARC' EQ 'Y').P50                            @D34YSRJ 20250000
          AIF   ('&RECF' EQ 'V').P50                                    20300000
          AGO   .P18                                                    20350000
.P50      L     IJDL4&CG9,IJDP7&CG9    LOAD REG14 ADDR IOAREA1          20400000
         AIF   ('&TARC' EQ 'Y').P50A                           @D34YSRJ 20450000
          AIF   ('&CNTL' EQ 'Z' OR '&CNTL' EQ 'C').P18                  20500000
          AIF   ('&CNTL' EQ 'T').P18                                4-0 20550000
         AIF   ('&CNTL' EQ 'S').P18                                     20600000
         AGO   .P40I                                           @D34YSRJ 20650000
.P50A    ANOP                                                  @D34YSRJ 20700000
         AIF   ('&IOAREA2' EQ '' AND '&WORKA' EQ '').P50AC     @D34YSRJ 20750000
         TM    IJDM1&CG9,IJDMT&CG9     TRC INDICATED           @D34YSRC 20800000
         AIF   ('&CNTL' EQ 'A').P50AA                          @D34YSRJ 20850000
         BZ    IJDTS&CG9               BR NO                   @D34YSRJ 20900000
         AGO   .P50AB                                          @D34YSRJ 20950000
.P50AA   ANOP                                                  @D34YSRJ 21000000
         BZ    IJDTP&CG9               BR NO                   @D34YSRJ 21050000
.P50AB   ANOP                                                  @D34YSRJ 21100000
         TM    IJDTC&CG9,IJDL9&CG9     PRIOR TRC INDICATED     @D34YSRC 21150000
         BZ    IJDTP&CG9               BR NO                   @D34YSRJ 21200000
         SR    IJDL3&CG9,IJDL3&CG9     ZERO REGISTER           @D34YSRJ 21250000
         ICM   IJDL3&CG9,7,IJDPH&CG9   GET DATA ADDR FROM CCW  @D34YSRJ 21300000
         BCTR  IJDL3&CG9,0             DECR DATA ADDR BY 1     @D34YSRJ 21350000
         STCM  IJDL3&CG9,7,IJDPH&CG9   PUT DATA ADDR INTO CCW  @D34YSRJ 21400000
         LH    IJDL3&CG9,IJDPJ&CG9     LOAD COUNT IN REG12     @D34YSRJ 21450000
         LA    IJDL3&CG9,1(,IJDL3&CG9) INCR COUNT BY ONE       @D34YSRJ 21500000
         STH   IJDL3&CG9,IJDPJ&CG9     PUT COUNT IN CCW        @D34YSRJ 21550000
IJDTP&CG9 EQU  *                                               @D34YSRJ 21600000
         AIF   ('&CNTL' EQ 'A').P40I                           @D34YSRJ 21650000
         AGO   .P50AD                                          @D34YSRJ 21700000
.P50AC   ANOP                                                  @D34YSRJ 21750000
         AIF   ('&CNTL' EQ 'A').P40I                           @D34YSRJ 21800000
         TM    IJDM1&CG9,IJDMT&CG9     TRC INDICATED           @D34YSRC 21850000
         BZ    IJDTS&CG9               BR NO                   @D34YSRJ 21900000
.P50AD   ANOP                                                  @D34YSRJ 21950000
         AIF   ('&WORKA' NE '').P40A                           @D34YSRJ 22000000
         IC    IJDL3&CG9,0(IJDL4&CG9)  GET TRC CODE            @D34YSRJ 22050000
         AGO   .P40D                                           @D34YSRJ 22100000
.P40A    ANOP                                                  @D34YSRJ 22150000
         LR    IJDL3&CG9,0             GET WORKA ADDR          @D34YSRJ 22200000
         AIF   ('&RECF' NE 'V').P40B                           @D34YSRJ 22250000
&AL5     SETA  4                                               @D34YSRJ 22300000
.P40B    ANOP                                                  @D34YSRJ 22350000
&AL8     SETA  &AL5                                            @DA22933 22400000
         AIF   ('&CNTL' NE 'Y').P40C                           @D34YSRJ 22450000
&AL8     SETA  &AL5+1                                          @DA22933 22500000
.P40C    ANOP                                                  @D34YSRJ 22550000
         IC    IJDL3&CG9,&AL8.(IJDL3&CG9) GET TRC CODE         @DA22933 22600000
.P40D    ANOP                                                  @D34YSRJ 22650000
         SLL   IJDL3&CG9,28            ISOLATE LOW-ORDER       @D34YSRJ 22700000
         SRL   IJDL3&CG9,28            HALF-BYTE OF TRC CODE   @D34YSRJ 22750000
         CH    IJDL3&CG9,IJDQT&CG9     VALID TRC CODE LE 3     @D34YSRJ 22800000
         BNH   IJDTR&CG9               BR YES, BYPASS DEFAULT  @D34YSRJ 22850000
         SR    IJDL3&CG9,IJDL3&CG9     SET DEFAULT TRC CODE 0  @D34YSRJ 22900000
IJDTR&CG9 EQU  *                                               @D34YSRJ 22950000
         AIF   ('&CNTL' NE 'Z').P40E                           @D34YSRJ 23000000
         ICM   IJDL3&CG9,8,IJDPG&CG9   SAVE CCW OP CODE        @D34YSRJ 23050000
.P40E    ANOP                                                  @D34YSRJ 23100000
         STC   IJDL3&CG9,IJDPG&CG9     SET TRC CODE INTO CCW   @D34YSRJ 23150000
         TR    IJDPG&CG9.(1),IJDTT&CG9 TRANSLATE INTO OP CODE  @D34YSRJ 23200000
         CLC   IJDPG&CG9.(1),IJDTC&CG9 GIVEN TRC = CURR TRC    @D34YSRC 23250000
         AIF   ('&CNTL' NE 'Z').P40F                           @D34YSRJ 23300000
         BE    IJDTX&CG9               BR YES, NO TRC CCW      @D34YSRJ 23350000
         AGO   .P40G                                           @D34YSRJ 23400000
.P40F    ANOP                                                  @D34YSRJ 23450000
         BE    IJDTS&CG9               BR YES, NO TRC CCW      @D34YSRJ 23500000
.P40G    ANOP                                                  @D34YSRJ 23550000
         EXCP  (1)                     ISSUE EXCP FOR TRC      @D34YSRJ 23600000
         MVC   IJDTC&CG9.(1),IJDPG&CG9 SAVE TRC CODE IN CCW    @D34YSRC 23650000
         IWAIT (1)                     WAIT FOR COMPLETION     @D62ADWS 23700000
         AIF   ('&CNTL' NE 'Z').P40H                           @D34YSRJ 23750000
IJDTX&CG9 EQU  *                                               @D34YSRJ 23800000
         STCM  IJDL3&CG9,8,IJDPG&CG9   RESTORE CCW OP CODE     @D34YSRJ 23850000
.P40H    ANOP                                                  @D34YSRJ 23900000
IJDTS&CG9 EQU  *                                               @D34YSRJ 23950000
         AIF   ('&CNTL' EQ 'C' OR '&CNTL' EQ 'Z').P18          @D34YSRJ 24000000
.P40I    ANOP                                                  @D34YSRJ 24050000
          BCTR  IJDL4&CG9,0            SUBTRACT ONE FROM REG 14         24100000
&AL4      SETA  1                                                       24150000
          AIF   ('&WORKA' NE '').P19                                    24200000
          AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'M').P66             4-0 24250000
          MVC   IJDPA&CG9.(1),0(IJDL4&CG9)  MOVE CTLCHR TO CONCMD       24300000
          AGO   .P18                                                    24350000
.P66      MVC   IJDPG&CG9.(1),0(IJDL4&CG9)  MOVE CTLCHR TO CCW          24400000
          AGO   .P18                                                    24450000
.P19      LR    IJDL3&CG9,0            LOAD REG13 WITH WORKA ADDR.      24500000
&BL1      SETB  1                                                       24550000
          AIF   ('&RECF' NE 'V').P20                                    24600000
&AL5      SETA  4                                                       24650000
.P20      AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'M').P67             4-0 24700000
          MVC   IJDPA&CG9.(1),&AL5.(IJDL3&CG9)  MOVE CTLCHR TO CONCMD   24750000
          AGO   .P18                                                    24800000
.P67      MVC   IJDPG&CG9.(1),&AL5.(IJDL3&CG9)  MOVE CTLCHR TO CCW      24850000
.P18      AIF   ('&RECF' NE 'F').P21                                    24900000
          AIF   ('&WORKA' EQ '').P28A                          @D34YSRJ 24950000
          LH    IJDL2&CG9,IJDPJ&CG9    LOAD COUNT IN REG12              25000000
         AIF   ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A' OR '&CNTL' EQ 'M').P24 25050000
          BCTR  IJDL2&CG9,0            SUBTRACT ONE FROM REG12          25100000
          AGO   .P23                                                    25150000
.P21      AIF   ('&RECF' NE 'V').P25                                    25200000
&AL4      SETA  &AL4+4                                                  25250000
          SH    IJDL4&CG9,IJDQ7&CG9    ADJUST IOAREA ADDR.              25300000
          AIF   ('&WORKA' EQ '').P26                                    25350000
          AIF   (&BL1).P55                                              25400000
          LR    IJDL3&CG9,0            PUT WORKA ADDR.IN REG13          25450000
&BL1      SETB  1                                                       25500000
.P55      MVC   IJDP8&CG9.(2),0(IJDL3&CG9)  MOVE LENGTH TO INT.BOUND.   25550000
          AGO   .P27                                                    25600000
.P26      MVC   IJDP8&CG9.(2),0(IJDL4&CG9) MOVE LENGTH TO INT.BOUND.    25650000
.P27      LH    IJDL2&CG9,IJDP8&CG9    LOAD LENGTH IN REG12             25700000
.P25      ANOP                                                          25750000
&AL6      SETA  &AL4+1                                                  25800000
          AIF   ('&WORKA' EQ '').P22                                    25850000
          BCTR  IJDL2&CG9,0            ADJUST REG12 FOR MOVE INSTR.     25900000
&AL6      SETA  &AL4                                                    25950000
          AIF   (&BL1).P24                                              26000000
.P23      LR    IJDL3&CG9,0            PUT ADDR.OF WORKA IN REG 13      26050000
.P24      AIF   ('&CG1' EQ '2245').P240                        @DA28526 26100000
          AIF   ('&CG1' EQ '3800').P240                        @DA28526 26150000
          AGO   .P24A                                          @DA28526 26200000
.P240     ANOP                                                 @DA28526 26250000
          AIF   (T'&RDONLY NE 'O').P241                        @DA34200 26300000
          ST    IJDL2&CG9,IJDM7&CG9+16 SAVE REG 12             @DA34200 26350000
          AGO   .P242                                          @DA34200 26400000
.P241     ST    IJDL2&CG9,20(IJDL1&CG9) SAVE REG 12            @DA34200 26450000
.P242     ANOP                                                 @DA34200 26500000
IJDNL&CG9 CH    IJDL2&CG9,IJDQ8&CG9    IS BLKSIZE GT 255            4-0 26550000
         BL    IJDNM&CG9               NO,GO TO MOVE WORKA     @DA34200 26600000
         SH    IJDL2&CG9,IJDQ8&CG9     DECREMENT LENGHT BY 256 @DA01036 26650000
         MVC   0(256,IJDL4&CG9),0(IJDL3&CG9) MOVE 256 CHARS         4-0 26700000
         LA    IJDL4&CG9,256(IJDL4&CG9)   INCREMENT IOAREA ADDR     4-0 26750000
         LA    IJDL3&CG9,256(IJDL3&CG9)   INCREMENT WORKA ADDR R13  4-0 26800000
         B     IJDNL&CG9               BRANCH TO CHECK NEXT CHARS   4-0 26850000
IJDNM&CG9 EX    IJDL2&CG9,IJDPT&CG9    MOVE WORKA TO IOAREA    @DA34200 26900000
          AIF   (T'&RDONLY NE 'O').P243                        @DA34200 26950000
          L     IJDL2&CG9,IJDM7&CG9+16 RESTORE REG 12          @DA34200 27000000
          AGO   .P244                                          @DA34200 27050000
.P243     L     IJDL2&CG9,20(IJDL1&CG9)  RESTORE REG 12        @DA34200 27100000
.P244     AGO   .P24B                                          @DA34200 27150000
.P24A    ANOP                                                       4-0 27200000
IJDTM&CG9 EX    IJDL2&CG9,IJDPT&CG9    MOVE WORKA TO IOAREA         4-0 27250000
.P24B     AIF   ('&RECF' EQ 'F').P28A                          @DA34200 27300000
.P22      AIF   (&AL6 EQ 1).P56A                               @D34YSRJ 27350000
          AIF   (&AL6 NE 0).P57                                         27400000
          LA    IJDL2&CG9,1(IJDL2&CG9) ADJUST DATA  LENGTH              27450000
          AGO   .P56A                                          @D34YSRJ 27500000
.P57      AIF   (&AL6 NE 2).P58                                         27550000
          BCTR  IJDL2&CG9,0            ADJUST DATA LENGTH               27600000
          AGO   .P56A                                          @D34YSRJ 27650000
.P58      ANOP                                                          27700000
&AL6      SETA  &AL6-1                                                  27750000
          SH    IJDL2&CG9,IJDQ6&CG9    ADJUST DATA LENGTH               27800000
.P56A     ANOP                                                 @D34YSRJ 27850000
         AIF   ('&TARC' NE 'Y').P56                            @D34YSRJ 27900000
         TM    IJDM1&CG9,IJDMT&CG9     TRC INDICATED           @D34YSRC 27950000
         BZ    IJDTN&CG9               BR NO                   @D34YSRJ 28000000
          BCTR  IJDL2&CG9,0            DECR COUNT BY 1 FOR TRC @D34YSRJ 28050000
IJDTN&CG9 EQU   *                                              @D34YSRJ 28100000
.P56      STH   IJDL2&CG9,IJDPJ&CG9    PUT COUNT IN CCW                 28150000
          AGO   .P28                                           @D34YSRJ 28200000
.P28A     ANOP                                                 @D34YSRJ 28250000
         AIF   ('&TARC' NE 'Y').P28                            @D34YSRJ 28300000
         TM    IJDM1&CG9,IJDMT&CG9     TRC INDICATED           @D34YSRC 28350000
         BZ    IJDTN&CG9               BR NO                   @D34YSRJ 28400000
          AIF   ('&WORKA' NE '').P28C                          @D34YSRJ 28450000
          LH    IJDL2&CG9,IJDPJ&CG9    LOAD COUNT IN REG12     @D34YSRJ 28500000
          AGO   .P28D                                          @D34YSRJ 28550000
.P28C    ANOP                                                  @D34YSRJ 28600000
         AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'Y').P28E        @D34YSRJ 28650000
.P28D    ANOP                                                  @D34YSRJ 28700000
          BCTR  IJDL2&CG9,0            DECR COUNT BY 1 FOR TRC @D34YSRJ 28750000
.P28E    ANOP                                                  @D34YSRJ 28800000
          STH   IJDL2&CG9,IJDPJ&CG9    PUT COUNT IN CCW        @D34YSRJ 28850000
IJDTN&CG9 EQU *                                                @D34YSRJ 28900000
.P28      AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'M').P30             4-0 28950000
          SR    IJDL2&CG9,IJDL2&CG9    CLEAR REG 12                     29000000
          LR    IJDL3&CG9,IJDL2&CG9    CLEAR REG 13                     29050000
          IC    IJDL2&CG9,IJDPA&CG9    PUT CONCMD IN REG12              29100000
          LA    IJDL4&CG9,16           PUT 16 IN REG 14                 29150000
         AIF   (&AL7 NE 1).P58A                                     4-0 29200000
          LA   IJDL3&CG9,IJDLN&CG9   LOAD 1 INTO REG 13             4-0 29250000
          CR   IJDL2&CG9,IJDL3&CG9   ASA CHAR SK TO CH 1            4-0 29300000
          BE   IJDQZ&CG9                                            4-0 29350000
.P58A    ANOP                                                       4-0 29400000
IJDPU&CG9 IC    IJDL3&CG9,IJDPV&CG9-1(IJDL4&CG9) INSERT ASA TABLE CHR   29450000
          CR    IJDL3&CG9,IJDL2&CG9    COMPARE REGS 12 AND 13           29500000
          BE    IJDPW&CG9                                               29550000
          BCT   IJDL4&CG9,IJDPU&CG9                                     29600000
IJDQZ&CG9 SVC   IJDL6&CG9              ABNORMAL EOJ                 4-0 29650000
          AIF   ('&CNTL' NE 'M').JJ0                                4-0 29700000
IJDPW&CG9 IC    IJDL3&CG9,IJDPP&CG9-1(IJDL4&CG9) INSERT 360 CHR     4-0 29750000
          IC    IJDL2&CG9,IJDP9&CG9    INSERT PREV. OP CODE IN R12  4-0 29800000
          AGO   .P61ER                                              4-0 29850000
.JJ0      ANOP                                                      4-0 29900000
IJDPW&CG9 IC    IJDL3&CG9,IJDPX&CG9-1(IJDL4&CG9) INSERT 360 CHR     4-0 29950000
          AIF   ('&CG1' NE '3525').M30                              4-0 30000000
          LA    IJDL2&CG9,IJDL3&CG9         PUT 13 IN REG 12        4-0 30050000
          CR    IJDL4&CG9,IJDL2&CG9         COMP. COUNT TO 13       4-0 30100000
          BL    IJDPY&CG9                   SKIP COMMAND            4-0 30150000
.M30      IC    IJDL2&CG9,IJDP9&CG9    INSERT PREVIOUS OPCODE IN R1 4-0 30200000
          AIF   ('&CG1' NE '3525').M31                              4-0 30250000
          AR    IJDL3&CG9,IJDL2&CG9         ADD NUM TO PREV COMM.   4-0 30300000
          AGO   .M32                                                4-0 30350000
.M31      CR    IJDL2&CG9,IJDL3&CG9         COMPARE REGS 12, 13     4-0 30400000
          BNE   IJDPY&CG9                                               30450000
          TM    IJDP9&CG9,IJDL8&CG9    TEST IF IT WAS A SKIP COMM.      30500000
          BZ    IJDPY&CG9                                               30550000
          MVI   IJDPG&CG9,IJDLJ&CG9    PUT SPACE ONE LINE CODE IN CCW   30600000
          SVC   IJDL7&CG9              EXCP                             30650000
         AIF ('&PROV' NE 'Z' AND '&PROV' NE 'P').P41                3-9 30700000
          TM    IJDP1&CG9,IJDL8&CG9    WAIT CHANNEL END                 30750000
          BO    *+6                                                     30800000
          SVC   7                                                       30850000
.P41     ANOP                                                       3-9 30900000
         AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').P61ER             3-9 30950000
         AIF   (T'&RDONLY NE 'O').SR4                          @DA29705 31000000
         BAL   IJDL4&CG9,IJDSR&CG9                                  3-9 31050000
         L     IJDL4&CG9,12+IJDM7&CG9  RESTORE LINK REG        @DA29705 31100000
         AGO   .P61ER                                          @DA29705 31150000
.SR4     ST    IJDL3&CG9,20(IJDL1&CG9)                         @DA29705 31200000
         LR    IJDL3&CG9,IJDL1&CG9                             @DA29705 31250000
         BAL   IJDL0&CG9,IJDSR&CG9                             @DA29705 31300000
         L     IJDL3&CG9,20(IJDL3&CG9)                         @DA29705 31350000
.P61ER   ANOP                                                       3-9 31400000
.M32      ANOP                                                      4-0 31450000
IJDPY&CG9 STC   IJDL3&CG9,IJDP9&CG9    SAVE OP CODE IN NORCMD       4-0 31500000
&CASE     SETC  '4'                                            @DA29705 31550000
          AIF   ('&CG1' EQ '3525').P36B                             4-0 31600000
         STC   IJDL3&CG9,IJDPG&CG9     PUT CONCMD IN CCW            4-0 31650000
          SVC   IJDL7&CG9              EXCP                             31700000
         AIF ('&PROV' NE 'Z' AND '&PROV' NE 'P').P42                3-9 31750000
         TM    IJDP1&CG9,IJDL8&CG9     WAIT FOR CHAN. END           3-9 31800000
         BO    *+6                                                  3-9 31850000
         SVC   7                                                    3-9 31900000
.P42     ANOP                                                       3-9 31950000
         AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').P76               3-9 32000000
         AIF   (T'&RDONLY NE 'O').SR6                          @DA29705 32050000
         BAL   IJDL4&CG9,IJDSR&CG9                                  3-9 32100000
         L     IJDL4&CG9,12+IJDM7&CG9  RESTORE LINK REG        @DA29705 32150000
         AGO   .SR8                                            @DA29705 32200000
.SR6     ST    IJDL3&CG9,20(IJDL1&CG9)                         @DA29705 32250000
         LR    IJDL3&CG9,IJDL1&CG9                             @DA29705 32300000
         BAL   IJDL0&CG9,IJDSR&CG9                             @DA29705 32350000
         L     IJDL3&CG9,20(IJDL3&CG9)                         @DA29705 32400000
.SR8     ANOP                                                  @DA29705 32450000
IJDPN&CG9 NOPR  15                     PLACE TO BRANCH TO           3-9 32500000
.P76     AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'E').P77               3-9 32550000
         MVC   IJDPE&CG9.(2),IJDP2&CG9 SAVE C. BYTE2 AND CSW STATUS 3-9 32600000
.P77     ANOP                                                  @D34YSRJ 32650000
         AIF   ('&TARC' NE 'Y').P77X                           @D34YSRJ 32700000
         TM    IJDM1&CG9,IJDMT&CG9     TRC INDICATED           @D34YSRC 32750000
         BZ    IJDTS&CG9               BR NO                   @D34YSRJ 32800000
         L     IJDL4&CG9,IJDP7&CG9     LOAD REG14 ADDR IOAREA1 @D34YSRJ 32850000
         IC    IJDL3&CG9,0(,IJDL4&CG9) GET TRC CODE            @D34YSRJ 32900000
         SLL   IJDL3&CG9,28            ISOLATE LOW-ORDER       @D34YSRJ 32950000
         SRL   IJDL3&CG9,28            HALF-BYTE OF TRC CODE   @D34YSRJ 33000000
         CH    IJDL3&CG9,IJDQT&CG9     VALID TRC CODE LE 3     @D34YSRJ 33050000
         BNH   IJDTR&CG9               BR YES, BYPASS DEFAULT  @D34YSRJ 33100000
         SR    IJDL3&CG9,IJDL3&CG9     SET DEFAULT TRC CODE 0  @D34YSRJ 33150000
IJDTR&CG9 STC  IJDL3&CG9,IJDPG&CG9     SET TRC CODE INTO CCW   @D34YSRJ 33200000
         TR    IJDPG&CG9.(1),IJDTT&CG9 TRANSLATE INTO OP CODE  @D34YSRJ 33250000
         CLC   IJDPG&CG9.(1),IJDTC&CG9 GIVEN TRC = CURR TRC    @D34YSRC 33300000
         BE    IJDTS&CG9               BR YES, NO TRC CCW      @D34YSRJ 33350000
         EXCP  (1)                     ISSUE EXCP FOR TRC      @D34YSRJ 33400000
         MVC   IJDTC&CG9.(1),IJDPG&CG9 SAVE TRC CODE IN CCW    @D34YSRC 33450000
         IWAIT (1)                    WAIT FOR COMPLETION      @D62ADWS 33500000
IJDTS&CG9 EQU  *                                               @D34YSRJ 33550000
.P77X    ANOP                                                  @D34YSRJ 33600000
          MVI   IJDPG&CG9,IJDLF&CG9    PRINT-ONLY CODE TO CCW  @D34YSRJ 33650000
.P30      AIF   ('&IOAREA2' EQ '').P33                                  33700000
          L     IJDL4&CG9,IJDPG&CG9    LOAD ADDR IOAREA2 IN REG14       33750000
          MVC   IJDPG&CG9+1(3),IJDP7&CG9+1 SWAP IOAREAS                 33800000
          ST    IJDL4&CG9,IJDP7&CG9                                     33850000
          AIF   (T'&WORKA NE 'O').P33                                   33900000
          AIF   (&AL4 EQ 0).P34                                         33950000
          AIF   (&AL4 GT 1).P65                                         34000000
          BCTR  IJDL4&CG9,0            CALCULATE IOAREA ADDRESS         34050000
          AGO   .P34                                                    34100000
.P65      SH    IJDL4&CG9,IJDQ4&CG9    CALCULATE IOAREA ADDRESS         34150000
.P34     AIF   (T'&RDONLY NE 'O').BK4                               3-3 34200000
         LM    IJDL1&CG9,IJDL3&CG9,IJDM7&CG9   REST REGS 11-13 @DA29705 34250000
          EX    0,IJDPC&CG9            LOAD USER POINTER REG        3-3 34300000
          L     IJDL4&CG9,IJDM7&CG9+12  RESTORE REG 14         @DA29705 34350000
          AGO   .P35                                                3-3 34400000
.BK4     ANOP                                                  @DA29705 34450000
         LM    IJDL0&CG9,IJDL3&CG9,0(IJDL1&CG9)     REST 10-13 @DA29705 34500000
         EX    0,IJDPC&CG9             LOAD USER POINTER REG        3-3 34550000
         L     IJDL4&CG9,16(IJDL3&CG9)     RESTORE REG 14      @DA29705 34600000
         AGO   .P35                                                 3-3 34650000
.P33     AIF   (T'&RDONLY NE 'O').BK5                               3-3 34700000
         LM    IJDL1&CG9,IJDL4&CG9,IJDM7&CG9   REST REGS 11-14 @DA29705 34750000
         AGO   .P35                                                 3-3 34800000
.BK5      ANOP                                                      3-3 34850000
         LM  IJDL0&CG9,IJDL4&CG9,0(IJDL1&CG9)      REST 10-14  @DA29705 34900000
.P35     ANOP                                                  @D34YSRJ 34950000
         AIF   ('&CNTL' EQ 'Y' AND '&TARC' EQ 'Y').P36AA       @D34YSRJ 35000000
         AIF   ('&CNTL' EQ 'A' AND '&TARC' EQ 'Y').P36AA       @D34YSRJ 35050000
         AIF   ('&CNTL' EQ 'Z' AND '&TARC' EQ 'Y').P36AA       @D34YSRJ 35100000
         AIF   ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A' OR '&CNTL' EQ 'M').P36 35150000
.P62      AIF   ('&CG1' EQ '3525').P36A                             4-0 35200000
          AIF   ('&CNTL' EQ 'C').P45                                4-0 35250000
         AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'E').P36               3-9 35300000
.P45      MVC   IJDPG&CG9.(1),IJDPA&CG9 MOVE CONTROL CODE TO CCW        35350000
          MVC   IJDPA&CG9.(1),IJDP9&CG9 RESTORE CONCMD TO NORMAL        35400000
.P36AA    ANOP                                                 @D34YSRJ 35450000
         AIF   ('&TARC' NE 'Y').P36                            @D34YSRJ 35500000
         TM    IJDM1&CG9,IJDMT&CG9     TRC INDICATED           @D34YSRC 35550000
         BZ    IJDTV&CG9               BR NO                   @D34YSRJ 35600000
         ICM   IJDL2&CG9,7,IJDPH&CG9   GET DATA ADDR FROM CCW  @D34YSRJ 35650000
         LA    IJDL2&CG9,1(,IJDL2&CG9) INCR DATA ADDR PAST TRC @D34YSRJ 35700000
         STCM  IJDL2&CG9,7,IJDPH&CG9   PUT DATA ADDR INTO CCW  @D34YSRJ 35750000
         AIF   ('&IOAREA2' EQ '' AND '&WORKA' EQ '').P36AC     @D34YSRJ 35800000
         AIF   (T'&RDONLY NE 'O').P36AB                        @D34YSRJ 35850000
         L     IJDL2&CG9,4+IJDM7&CG9   RESTORE REG 12          @D34YSRJ 35900000
         AGO   .P36AC                                          @D34YSRJ 35950000
.P36AB   ANOP                                                  @D34YSRJ 36000000
         L     IJDL2&CG9,8(IJDL3&CG9)       RESTORE REG 12     @DA29705 36050000
.P36AC   ANOP                                                  @D34YSRJ 36100000
IJDTV&CG9 EQU   *                                              @D34YSRJ 36150000
.P36      SVC   IJDL7&CG9              EXCP                             36200000
          AGO   .P36V                                               4-0 36250000
.P36A     ANOP                                                      4-0 36300000
&CASE     SETC  '2'                                            @DA29705 36350000
          SR    IJDL1&CG9,IJDL1&CG9         CLEAR REG 11            4-0 36400000
          AIF   ('&CNTL' NE 'C').P3AA                               4-0 36450000
          CLC   IJDP9&CG9.(1),IJDPG&CG9     CHK PREVIOUS COMMAND    4-0 36500000
          BH    IJDJ4&CG9                   HI EXEC NEW COMMAND     4-0 36550000
          BL    IJDC2&CG9                   LO, FEED CARD           4-0 36600000
          TM    IJDPE&CG9,IJDL8&CG9         CNTRL IMMED LAST        4-0 36650000
          BO    IJDC2&CG9                   YES, FEED CARD          4-0 36700000
.P3AA     IC    IJDL1&CG9,IJDP9&CG9         GET LAST COMMAND        4-0 36750000
          AH    IJDL1&CG9,IJDM5&CG9+IJDLG&CG9    ADD 1 TO COUNT     4-0 36800000
          STC   IJDL1&CG9,IJDP9&CG9         SAVE COMMAND            4-0 36850000
.P36B     CLC   IJDP9&CG9.(1),IJDPG&CG9     CHK PREVIOUS COMMAND    4-0 36900000
          BH    IJDJ4&CG9                   EXEC NEW COMMAND        4-0 36950000
          AIF   (&AL7 EQ 1).P36F                                    4-0 37000000
IJDC2&CG9 MVI   IJDPG&CG9,IJDJM&CG9         FD SS COMMAND           4-0 37050000
          SVC   IJDL7&CG9                   EXCP                    4-0 37100000
          TM    IJDP1&CG9,IJDL8&CG9         WAIT                    4-0 37150000
          BO    *+6                          CHANNEL                4-0 37200000
          SVC   7                             END                   4-0 37250000
          AGO   .P36G                                               4-0 37300000
.P36F     ANOP                                                      4-0 37350000
IJDC2&CG9 SVC   IJDL6&CG9                   MACRO SEQ ERROR         4-0 37400000
.P36G     ANOP                                                      4-0 37450000
IJDJ4&CG9 MVC   IJDPG&CG9.(1),IJDP9&CG9     COMMAND TO BE EXECUTED  4-0 37500000
          AIF   ('&CNTL' EQ 'A').P3AM                               4-0 37550000
IJDH8&CG9 SVC   IJDL7&CG9                   PRINT                   4-0 37600000
.P3AM     AIF   ('&CNTL' NE 'T').P36H                               4-0 37650000
          CLI   IJDPG&CG9,IJD1D&CG9         PRINT ON LINE GT 3      4-0 37700000
          AGO   .P36I                                               4-0 37750000
.P36H     CLI   IJDPG&CG9,IJDCD&CG9         PRINT ON LINE GT 25     4-0 37800000
.P36I    AIF   ('&CNTL' EQ 'A').P36IA                          @DA00138 37850000
         BNL   IJDJ5&CG9                   YES, GO TO NEXT CARD@DA00138 37900000
         AGO   .P36IB                                          @DA00138 37950000
.P36IA   BH    IJDJ5&CG9                   YES, GO TO NEXT CARD@DA00138 38000000
.P36IB   AIF   ('&CNTL' NE 'T').P36J                           @DA00138 38050000
          AH    IJDL1&CG9,IJDM5&CG9+IJDLG&CG9   ADD 1 FOR FUNC=T    4-0 38100000
          STC   IJDL1&CG9,IJDP9&CG9         SAVE COMMAND            4-0 38150000
.P36J     B     IJDJ6&CG9                   CONTINUE                4-0 38200000
          AIF   (&AL7 EQ 1).P36L                                    4-0 38250000
IJDJ5&CG9 TM    IJDP1&CG9,IJDL8&CG9         WAIT                    4-0 38300000
          BO    *+6                          CHANNEL                4-0 38350000
          SVC   7                            END                    4-0 38400000
          TM    IJDM1&CG9,IJDL9&CG9         ERROPT SPECIFIED        4-0 38450000
          BZ    IJDE9&CG9                   NO, CONTINUE            4-0 38500000
          TM    IJDP2&CG9,IJDLC&CG9         ERROR DETECTED          4-0 38550000
          BZ    IJDE9&CG9                   NO, CONTINUE            4-0 38600000
          L     IJDLN&CG9,IJDPG&CG9         GET IOAREA ADDR.        4-0 38650000
          LA    IJDLN&CG9,0(IJDLN&CG9)      CLEAR HIGH ORDER BYTE   4-0 38700000
          AIF   ('&CASE' NE '4').CASE2                         @DA29705 38750000
          AIF   (T'&RDONLY NE 'O').SR40                        @DA29705 38800000
          LM    IJDL1&CG9,IJDL4&CG9,IJDM7&CG9  REST REG11-14   @DA29705 38850000
          AGO   .CASED0                                        @DA29705 38900000
.SR40     LM    IJDL0&CG9,IJDL4&CG9,0(IJDL1&CG9)  REST R10-14  @DA29705 38950000
          AGO   .CASED0                                        @DA29705 39000000
.CASE2    AIF   (T'&RDONLY NE 'O').SR41                        @DA29705 39050000
          L     IJDL1&CG9,IJDM7&CG9     RESTORE REG 11         @DA29705 39100000
          AGO   .CASED0                                        @DA29705 39150000
.SR41     L     IJDL1&CG9,4(IJDL3&CG9)   RESTORE REG 11        @DA29705 39200000
.CASED0   BR    IJDL4&CG9             RETURN TO USER           @DA29705 39250000
IJDE9&CG9 EQU   *                                                   4-0 39300000
          MVI   IJDPG&CG9,IJDJM&CG9         FD, SS COMMAND          4-0 39350000
          SVC   IJDL7&CG9                   EXCP                    4-0 39400000
          TM    IJDP1&CG9,IJDL8&CG9         WAIT                    4-0 39450000
          BO    *+6                         CHANNEL                 4-0 39500000
          SVC   7                             END                   4-0 39550000
         AGO   .P36QA                                          @DA00138 39600000
.P36L     ANOP                                                      4-0 39650000
IJDJ5&CG9 TM    IJDP1&CG9,IJDL8&CG9         WAIT                    4-0 39700000
          BO    *+6                          CHANNEL                4-0 39750000
          SVC   7                            END                    4-0 39800000
          TM    IJDM1&CG9,IJDL9&CG9         ERROPT SPECIFIED        4-0 39850000
          BZ    IJDE9&CG9                   NO, CONTINUE            4-0 39900000
          TM    IJDP2&CG9,IJDLC&CG9         ERROR DETECTED          4-0 39950000
          BZ    IJDE9&CG9                   NO, CONTINUE            4-0 40000000
          L     IJDLN&CG9,IJDPG&CG9         GET IOAREA ADDR.        4-0 40050000
          LA    IJDLN&CG9,0(IJDLN&CG9)      CLEAR HIGH ORDER BYTE   4-0 40100000
          AIF   ('&CASE' NE '4').CASE4                         @DA29705 40150000
          AIF   (T'&RDONLY NE 'O').SR42                        @DA29705 40200000
          LM    IJDL1&CG9,IJDL4&CG9,IJDM7&CG9   REST REG 11-14 @DA29705 40250000
          AGO   .CASED1                                        @DA29705 40300000
.SR42     LM    IJDL0&CG9,IJDL4&CG9,0(IJDL1&CG9) REST R10-14   @DA29705 40350000
          AGO   .CASED1                                        @DA29705 40400000
.CASE4    AIF   (T'&RDONLY NE 'O').SR43                        @DA29705 40450000
          L     IJDL1&CG9,IJDM7&CG9           REST R11         @DA29705 40500000
          AGO   .CASED1                                        @DA29705 40550000
.SR43     L     IJDL1&CG9,4(IJDL3&CG9)           REST R11      @DA29705 40600000
.CASED1   BR    IJDL4&CG9                   RETURN TO USER     @DA29705 40650000
IJDE9&CG9 EQU   *                                                   4-0 40700000
.P36QA   AIF   ('&CNTL' EQ 'A').P36QB                          @DA00138 40750000
          MVI   IJDP9&CG9,IJD05&CG9         RESET OPCODE TO         4-0 40800000
          MVI   IJDPG&CG9,IJD05&CG9          BEGINNING OF CARD      4-0 40850000
         AGO   .P36Q                                           @DA00138 40900000
.P36QB   MVI   IJDP9&CG9,IJD0D&CG9         RESET OPCODE TO     @DA00138 40950000
         MVI   IJDPG&CG9,IJD0D&CG9          LINE 1 OF CARD     @DA00138 41000000
.P36Q     AIF   ('&CNTL' NE 'C').PQ36                               4-0 41050000
IJDJ6&CG9 NI    IJDPE&CG9,IJDL7&CG9         TURN OFF CNTRL SW       4-0 41100000
          NI    IJDPF&CG9,IJDL7&CG9         SET OFF SW              4-0 41150000
          AGO   .PQ37                                               4-0 41200000
.PQ36     ANOP                                                      4-0 41250000
IJDJ6&CG9 EQU   *                                                   4-0 41300000
.PQ37     AIF   ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A').P3AB             4-0 41350000
          AIF   (T'&RDONLY NE 'O').P36E                             4-0 41400000
          L     IJDL1&CG9,IJDM7&CG9         RESTORE REG 11          4-0 41450000
          AGO   .P3AB                                               4-0 41500000
.P36E     ANOP                                                 @DA29705 41550000
          L     IJDL1&CG9,4(IJDL3&CG9)          RESTORE REG 11 @DA29705 41600000
.P3AB     AIF   ('&CNTL' EQ 'A').P30                                4-0 41650000
          AIF   ('&CNTL' NE 'C').P36V                               4-0 41700000
          CLI   IJDPA&CG9,IJD05&CG9         CONTROL AFTER           4-0 41750000
          BE    IJDH5&CG9                   YES, SKIP CONTROL       4-0 41800000
          SR    IJDL1&CG9,IJDL1&CG9              CLEAR OUT          4-0 41850000
          SR    IJDL2&CG9,IJDL2&CG9               REGS 11 & 12      4-0 41900000
          LA    IJDL4&CG9,IJDLC&CG9              PUT 16 IN R14 @DM16844 41950000
          IC    IJDL1&CG9,IJDPA&CG9              GET CNTRL CHAR.    4-0 42000000
IJDH1&CG9 IC    IJDL2&CG9,IJDH4&CG9-1(IJDL4&CG9) INS. CNTRL CH @DM16844 42050000
          CR    IJDL2&CG9,IJDL1&CG9              CORRECT CNTRL CHAR 4-0 42100000
          BE    IJDH2&CG9                        YES, CONVERT       4-0 42150000
          BCT   IJDL4&CG9,IJDH1&CG9              NO, CONTINUE  @DM16844 42200000
          SVC   IJDL6&CG9                        ABNORMAL EOJ       4-0 42250000
IJDH2&CG9 IC    IJDL1&CG9,IJDJ9&CG9-1(IJDL4&CG9) INSERT CORR CH@DM16844 42300000
          LA    IJDL2&CG9,IJDL4&CG9              L R12 WITH 14 @DM16844 42350000
          CR    IJDL4&CG9,IJDL2&CG9              COMP. CNT     @DM16844 42400000
          BL    IJDH3&CG9                        NOT A SPACE COMMAN 4-0 42450000
          IC    IJDL2&CG9,IJDP9&CG9              GET LAST COMMAND   4-0 42500000
          AR    IJDL1&CG9,IJDL2&CG9              UPDATE SPACE COMMA 4-0 42550000
IJDH3&CG9 STC   IJDL1&CG9,IJDP9&CG9              SAVE CNTRL CHAR    4-0 42600000
          AIF   (T'&RDONLY NE 'O').RP36VA                      @DM16844 42650000
          LM    IJDL1&CG9,IJDL4&CG9,IJDM7&CG9    REST. R11-R14 @DM16844 42700000
          AGO   .RP36VB                                        @DM16844 42750000
.RP36VA   ANOP                                                 @DA29705 42800000
          LM    IJDL0&CG9,IJDL4&CG9,0(IJDL3&CG9)    REST 10-14 @DA29705 42850000
.RP36VB   ANOP                                                 @DM16844 42900000
IJDH5&CG9 MVI   IJDPA&CG9,IJD05&CG9         RESET CONTROL COMMAND   4-0 42950000
.P36V     AIF   ('&IOAREA2' NE '').P37                              4-0 43000000
          AIF   ('&WORKA' NE '').P37                                    43050000
          AIF   ('&CG1' EQ '3525').P43A                             4-0 43100000
         AIF ('&PROV' NE 'Z' AND '&PROV' NE 'P').P43                3-9 43150000
.P43A     TM    IJDP1&CG9,IJDL8&CG9    WAIT CHANNEL END             4-0 43200000
          BO    *+6                                                     43250000
          SVC   7                                                       43300000
         AIF   ('&TARC' NE 'Y').P43AC                          @D34YSRJ 43350000
         TM    IJDM1&CG9,IJDMT&CG9     TRC INDICATED           @D34YSRC 43400000
         BZ    IJDTW&CG9               BR NO                   @D34YSRJ 43450000
         ICM   IJDL2&CG9,7,IJDPH&CG9   GET DATA ADDR FROM CCW  @D34YSRJ 43500000
         BCTR  IJDL2&CG9,0             DECR DATA ADDR BY 1     @D34YSRJ 43550000
         STCM  IJDL2&CG9,7,IJDPH&CG9   PUT DATA ADDR INTO CCW  @D34YSRJ 43600000
         LH    IJDL2&CG9,IJDPJ&CG9     LOAD COUNT IN REG12     @D34YSRJ 43650000
         LA    IJDL2&CG9,1(,IJDL2&CG9) INCR COUNT BY ONE       @D34YSRJ 43700000
         STH   IJDL2&CG9,IJDPJ&CG9     PUT COUNT IN CCW        @D34YSRJ 43750000
          AIF   (T'&RDONLY NE 'O').P43AA                       @D34YSRJ 43800000
          L     IJDL2&CG9,4+IJDM7&CG9       RESTORE REG 12     @DA29705 43850000
          AGO   .P43AB                                         @D34YSRJ 43900000
.P43AA    ANOP                                                 @D34YSRJ 43950000
          L     IJDL2&CG9,8(IJDL3&CG9)          RESTORE REG 12 @DA29705 44000000
.P43AB   ANOP                                                  @D34YSRJ 44050000
IJDTW&CG9 EQU   *                                              @D34YSRJ 44100000
.P43AC   ANOP                                                  @D34YSRJ 44150000
          AIF   ('&CG1' NE '3525').P37                              4-0 44200000
          TM    IJDM1&CG9,IJDL9&CG9         ERROPT SPECIFIED        4-0 44250000
          BZ    IJDE8&CG9                   NO, CONTINUE            4-0 44300000
          TM    IJDP2&CG9,IJDLC&CG9         ERROR DETECTED          4-0 44350000
          BZ    IJDE8&CG9                   NO, CONTINUE            4-0 44400000
          L     IJDLN&CG9,IJDPG&CG9         GET IOAREA ADDR.        4-0 44450000
          LA    IJDLN&CG9,0(IJDLN&CG9)      CLEAR HIGH ORDER BYTE   4-0 44500000
          BR    IJDL4&CG9                   RETURN TO USER          4-0 44550000
IJDE8&CG9 EQU   *                                                   4-0 44600000
          AGO   .P37                                                4-0 44650000
.P43     ANOP                                                       3-9 44700000
         AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').P37               3-9 44750000
         AIF   (T'&RDONLY NE 'O').SR9                          @DA29705 44800000
         BAL   IJDL4&CG9,IJDSR&CG9                                  3-9 44850000
         L     IJDL4&CG9,12+IJDM7&CG9     RESTORE LINK REG     @DA29705 44900000
         AGO   .P37                                            @DA29705 44950000
.SR9     BAL   IJDL0&CG9,IJDSR&CG9                             @DA29705 45000000
         L     IJDL0&CG9,0(IJDL3&CG9)         RESTORE R10      @DA29705 45050000
.P37     BR    IJDL4&CG9           BACK TO USER                     3-9 45100000
          AIF  ('&CNTL' NE 'C').P38                                     45150000
          AIF   ('&CG1' NE '3525').P38A                             4-0 45200000
          AIF  (T'&RDONLY NE 'O').ST10                         @DA29705 45250000
IJDPK&CG9 STM   IJDL1&CG9,IJDL4&CG9,IJDM7&CG9  SAVE REG 11-14  @DA29705 45300000
          AGO   .ST11                                          @DA29705 45350000
.ST10     ANOP                                                 @DA29705 45400000
IJDPK&CG9 STM   IJDL0&CG9,IJDL4&CG9,0(IJDL3&CG9) SAVE R10-R14  @DA29705 45450000
.ST11     AIF   (T'&FUNC EQ 'O').P37AA                         @DM16843 45500000
          AIF   ('&FUNC' EQ 'W' OR '&FUNC' EQ 'WT').P37AA      @DA14003 45550000
          L    IJDL4&CG9,IJDM2&CG9   LOAD ADDRESS ASOC. FILE   @DA14003 45600000
          AIF  ('&FUNC' EQ 'RW' OR '&FUNC' EQ 'RWT').P37AC     @DA14003 45650000
          AIF  ('&FUNC' EQ 'PW' OR '&FUNC' EQ 'PWT').P37AB     @DA14003 45700000
          L    IJDL4&CG9,IJDM8&CG9.(IJDL4&CG9) LOAD ADDR PUN F @DA14003 45750000
.P37AB    TM   IJDV2&CG9.(IJDL4&CG9),IJDLA&CG9 CARD FED ?      @DA14003 45800000
          BZ   IJDV4&CG9             NO, BRANCH                @DA14003 45850000
          MVI  IJDV2&CG9.(IJDL4&CG9),IJDL7&CG9 RESET SWITCH    @DA14003 45900000
          AGO  .P37AD                                          @DA14003 45950000
.P37AC    TM   IJDM8&CG9.(IJDL4&CG9),IJDLA&CG9 CARD FED ?      @DA14003 46000000
          BZ   IJDV4&CG9                                       @DA14003 46050000
          MVI  IJDM8&CG9.(IJDL4&CG9),IJDL7&CG9 RESET SWITCH    @DA14003 46100000
.P37AD    MVI  IJDPG&CG9,IJD05&CG9   RESET CCW OPCODE          @DA14003 46150000
          MVI  IJDP9&CG9,IJD05&CG9   RESET OPCODE              @DA14003 46200000
IJDV4&CG9 EQU  *                                               @DA29705 46250000
          AGO  .P37AE                                          @DA14003 46300000
.P37AA    ANOP                                                 @DA14003 46350000
.P37AE   AIF   (&AL7 NE 1).P37A                                @DA29705 46400000
          LA   IJDL2&CG9,IJDLH&CG9   LOAD REG 12 WITH 139           4-0 46450000
          CR   IJDL2&CG9,IJDL7&CG9   CNTRL CHAR SK TO CH 1          4-0 46500000
          BE   IJDJ0&CG9                    CONTINUE                4-0 46550000
.P37A    SR    IJDL2&CG9,IJDL2&CG9   CLEAR REG 12                   4-0 46600000
          LA    IJDL4&CG9,IJDLC&CG9              PUT 16 IN R14 @DM16844 46650000
IJDJ1&CG9 IC    IJDL2&CG9,IJDJ8&CG9-1(IJDL4&CG9) INS. CNTRL CH @DM16844 46700000
          CR    IJDL2&CG9,IJDL7&CG9              CORRECT CNTL CHAR  4-0 46750000
          BE    IJDJ2&CG9                        YES, CONVERT       4-0 46800000
          BCT   IJDL4&CG9,IJDJ1&CG9              NO, CONTINUE  @DM16844 46850000
IJDJ0&CG9 SVC  IJDL6&CG9             ABNORMAL EOJ                   4-0 46900000
IJDJ2&CG9 IC    IJDL7&CG9,IJDJ9&CG9-1(IJDL4&CG9)  INS CORR CHAR@DM16844 46950000
          LA    IJDL2&CG9,IJDL4&CG9              LOAD REG 12 WI@DM16844 47000000
          CR    IJDL4&CG9,IJDL2&CG9              COMPARE COUNT @DM16844 47050000
          BL    IJDJ3&CG9                        NOT A SPACE COMMAN 4-0 47100000
          IC    IJDL2&CG9,IJDP9&CG9              GET LASE COMMAND   4-0 47150000
          AR    IJDL7&CG9,IJDL2&CG9              UPDATE SPACE COMMN 4-0 47200000
IJDJ3&CG9 STC   IJDL7&CG9,IJDP9&CG9              SAVE CNTRL CHAR.   4-0 47250000
          OI    IJDPE&CG9,IJDL8&CG9         CNTRL IMMEDIATE SW      4-0 47300000
          AIF   (T'&RDONLY NE 'O').RP38AA                      @DM16844 47350000
          LM    IJDL1&CG9,IJDL4&CG9,IJDM7&CG9    REST R11-R14  @DA29705 47400000
          AGO   .P38B                                          @DM16844 47450000
.RP38AA   ANOP                                                 @DA29705 47500000
          LM    IJDL0&CG9,IJDL4&CG9,0(IJDL3&CG9)     REST 10-14@DA29705 47550000
          AGO   .P38B                                               4-0 47600000
.P38A     ANOP                                                      4-0 47650000
         AIF   ('&PROV' NE 'Z' AND '&PROV' NE 'P').P44              3-9 47700000
IJDPK&CG9 TM    IJDP1&CG9,IJDL8&CG9    WAIT CHANNEL END                 47750000
          BO    *+6                                                     47800000
          SVC   7                                                       47850000
.P44     ANOP                                                       3-9 47900000
         AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').P380              3-9 47950000
          AIF  (T'&RDONLY NE 'O').ST14                         @DA29705 48000000
IJDPK&CG9 STM   IJDL1&CG9,IJDL4&CG9,IJDM7&CG9  SAVE REG 11-14  @DA29705 48050000
          AGO   .ST15                                          @DA29705 48100000
.ST14     ANOP                                                 @DA29705 48150000
IJDPK&CG9 STM   IJDL0&CG9,IJDL4&CG9,0(IJDL3&CG9) SAVE R10-R14  @DA29705 48200000
.ST15    AIF   (T'&RDONLY NE 'O').SR11                         @DA29705 48250000
         BAL   IJDL4&CG9,IJDSR&CG9                                  3-9 48300000
         L     IJDL4&CG9,12+IJDM7&CG9  RESTORE LINK REG        @DA29705 48350000
         AGO   .P380                                           @DA29705 48400000
.SR11    ANOP                                                  @DA29705 48450000
         BAL   IJDL0&CG9,IJDSR&CG9                             @DA29705 48500000
         L     IJDL0&CG9,0(IJDL3&CG9)         RESTORE R10      @DA29705 48550000
.P380    AIF   ('&CG1' NE '3800').P381                         @D34YSRJ 48600000
         CH    0,IJDQF&CG9             FOLD OPERATION          @D34YSRJ 48650000
         BE    IJDTU&CG9               BR YES, NOT FOR 3800    @D34YSRJ 48700000
         CH    0,IJDQU&CG9             UNFOLD OPERATION        @D34YSRJ 48750000
         BE    IJDTU&CG9               BR YES, NOT FOR 3800    @D34YSRJ 48800000
.P381    ANOP                                                  @D34YSRJ 48850000
         CH    0,IJDQO&CG9             IS IT ORDER?            @D21DUJS 48900000
         BE    IJDTU&CG9               YES, IGNORE IT          @D21DUJS 48950000
         CH    0,IJDQC&CG9             IS IT CLRPRT?           @D21DUJS 49000000
         BE    IJDTU&CG9               YES, IGNORE IT          @D21DUJS 49050000
          STC   0,IJDPG&CG9            PUT CONTROL CHR IN CCW           49100000
          SVC   IJDL7&CG9              EXCP                             49150000
IJDTU&CG9 EQU  *                                               @D34YSRJ 49200000
.P382    ANOP                                                  @D34YSRJ 49250000
.P38B     BR    IJDL4&CG9              BACK TO USER                 4-0 49300000
.P38     AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'E').P39               3-9 49350000
         AIF   ('&PROV' EQ 'O' OR '&PROV' EQ 'R').P39          @DA00138 49400000
         AIF   ('&PROV' EQ 'S' OR '&PROV' EQ 'T').P39          @DA00138 49450000
          AIF   ('&CG1' EQ '3525').P38M                             4-0 49500000
         AIF ('&PROV' NE 'Z' AND '&PROV' NE 'P').P46                3-9 49550000
.P38M     ANOP                                                      4-0 49600000
IJDPM&CG9 TM    IJDP1&CG9,IJDL8&CG9    WAIT CHANNEL END                 49650000
          BO    *+6                                                     49700000
          SVC   7                                                       49750000
.P46     ANOP                                                       3-9 49800000
          AIF   ('&CG1' EQ '3525').P790                             4-0 49850000
         AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').P790              3-9 49900000
&CASE    SETC  'R'                                             @DA29705 49950000
         AIF   (T'&RDONLY NE 'O').SR13                         @DA29705 50000000
IJDPM&CG9 STM   IJDL1&CG9,IJDL4&CG9,IJDM7&CG9  SAVE R11-14     @DA29705 50050000
         BAL   IJDL4&CG9,IJDSR&CG9                                  3-9 50100000
         AGO   .P790                                           @DA29705 50150000
.SR13    ANOP                                                  @DA29705 50200000
IJDPM&CG9 STM  IJDL0&CG9,IJDL4&CG9,0(IJDL3&CG9) SAVE REG 10-14 @DA29705 50250000
          BAL   IJDL0&CG9,IJDSR&CG9                            @DA29705 50300000
.P790     TM    IJDP6&CG9,IJDLF&CG9    TEST WHICH CH.TO CONSIDER        50350000
          BZ    IJDPZ&CG9                                               50400000
          NI    IJDP6&CG9,IJDLI&CG9    PUT CH9 BIT OFF                  50450000
          AIF   ('&CG1' NE '3525').P79A                             4-0 50500000
          CLI   IJDPG&CG9,IJD8D&CG9    TEST IF CH9 REACHED          4-0 50550000
          AIF  ('&CASE' EQ 'R').BTU1                           @DA29705 50600000
          BL    IJDL7&CG9.(IJDL4&CG9)   NO, RETURN TO USER     @DA29705 50650000
          AGO   .P79B                                          @DA29705 50700000
.BTU1     BL    IJDRT&CG9                                      @DA29705 50750000
          AGO   .P79B                                               4-0 50800000
.P79A     AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'M').P79             4-0 50850000
          TM    IJDPE&CG9,IJDLG&CG9    TEST IF CH9 REACHED              50900000
          BO    IJDQ0&CG9            YES,BRANCH                     4-0 50950000
.P79      TM    IJDP2&CG9,IJDLG&CG9    TEST IF CH9 REACHED              51000000
          AIF  ('&CASE' EQ 'R').BTU2                           @DA29705 51050000
          BCR   8,IJDL4&CG9            IF NOT, GO BACK TO USER @DA29705 51100000
          AGO   .P79B                                          @DA29705 51150000
.BTU2     BC    8,IJDRT&CG9                                    @DA29705 51200000
.P79B     B     IJDQ0&CG9              PROCESS OVERFLOW             4-0 51250000
IJDPZ&CG9 EQU   *                                                       51300000
          AIF   ('&CG1' NE '3525').P81A                             4-0 51350000
          CLI   IJDPG&CG9,IJDBD&CG9    TEST IF CH12 REACHED         4-0 51400000
          AIF  ('&CASE' EQ 'R').BTU3                           @DA29705 51450000
          BL    IJDL7&CG9.(IJDL4&CG9)     NO, BACK TO USER     @DA29705 51500000
          AGO   .P81B                                          @DA29705 51550000
.BTU3     BL    IJDRT&CG9                                      @DA29705 51600000
          AGO   .P81B                                               4-0 51650000
.P81A     AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'M').P81             4-0 51700000
          TM    IJDPF&CG9,IJDLF&CG9    TEST IF CH12 REACHED             51750000
          BO    IJDQ0&CG9                                           4-0 51800000
.P81      TM    IJDPO&CG9,IJDLF&CG9    TEST IF CH12 REACHED             51850000
          AIF  ('&CASE' EQ 'R').BTU4                           @DA29705 51900000
          BCR   8,IJDL4&CG9            IF NOT, BACK TO USER    @DA29705 51950000
          AGO   .P81B                                          @DA29705 52000000
.BTU4     BC    8,IJDRT&CG9                                    @DA29705 52050000
.P81B     ANOP                                                      4-0 52100000
IJDQ0&CG9 LTR   0,0                    TEST IF USER HAS HIS OWN ROUTINE 52150000
          BZ    IJDQ1&CG9                                               52200000
          LR    IJDL5&CG9,0            LOAD REG15 WITH USER ROUT ADDR.  52250000
          AIF   ('&CASE' NE 'R').BTU5                          @DA29705 52300000
          AIF   (T'&RDONLY NE 'O').BTU6                        @DA29705 52350000
          LM    IJDL1&CG9,IJDL4&CG9,IJDM7&CG9  REST USER'S REGS@DA29705 52400000
          AGO   .BTU5                                          @DA29705 52450000
.BTU6     LM    IJDL0&CG9,IJDL4&CG9,0(IJDL3&CG9) REST USER REGS@DA29705 52500000
.BTU5     BR    IJDL5&CG9              GO TO USER ROUT.        @DA29705 52550000
          AIF   ('&CG1' NE '3525').P82A                             4-0 52600000
IJDQ1&CG9 EQU   *                                                   4-0 52650000
          AIF   (&AL7 EQ 1).P82B                                    4-0 52700000
          MVI   IJDPG&CG9,IJDJM&CG9         FD,SS COMMAND           4-0 52750000
          SVC   IJDL7&CG9                   EXCP                    4-0 52800000
          TM    IJDP1&CG9,IJDL8&CG9         WAIT                    4-0 52850000
          BO    *+6                          CHANNEL                4-0 52900000
          SVC   7                             END                   4-0 52950000
.P82B     MVI   IJDPG&CG9,IJD05&CG9         POSITION AT LINE ZERO   4-0 53000000
          AGO   .P60                                                4-0 53050000
.P82A     ANOP                                                      4-0 53100000
IJDQ1&CG9 MVI   IJDPG&CG9,IJDLH&CG9    PUT SKIP TO CH1 OP CODE IN CCW   53150000
          SVC   IJDL7&CG9              EXCP                             53200000
          AIF   ('&IOAREA2' NE '').P601                                 53250000
          AIF   ('&WORKA' NE '').P601                                   53300000
          AIF  ('&CNTL' EQ 'C').P601                                    53350000
         AIF ('&PROV' NE 'Z' AND '&PROV' NE 'P').P47                3-9 53400000
          TM    IJDP1&CG9,IJDL8&CG9    WAIT CHANNEL END                 53450000
          BO    *+6                                                     53500000
          SVC   7                                                       53550000
.P47     ANOP                                                       3-9 53600000
         AIF   ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').P60               3-9 53650000
         AIF   (T'&RDONLY NE 'O').SR15                         @DA29705 53700000
         BAL   IJDL4&CG9,IJDSR&CG9                                  3-9 53750000
         AGO   .P601                                           @DA29705 53800000
.SR15    BAL   IJDL0&CG9,IJDSR&CG9                             @DA29705 53850000
.P601    AIF   ('&CASE' NE 'R').P60                            @DA29705 53900000
         AIF    (T'&RDONLY NE 'O').SR60                        @DA29705 53950000
IJDRT&CG9 LM   IJDL1&CG9,IJDL4&CG9,IJDM7&CG9  REST R11-14      @DA29705 54000000
          AGO   .P602                                          @DA29705 54050000
.SR60     ANOP                                                 @DA29705 54100000
IJDRT&CG9 LM    IJDL0&CG9,IJDL4&CG9,0(IJDL3&CG9) REST R10-14   @DA29705 54150000
.P602     BR    IJDL4&CG9              BACK TO USER            @DA29705 54200000
          AGO   .P39                                           @DA29705 54250000
.P60      BR    IJDL4&CG9              BACK TO USER                     54300000
.P39      AIF   (&AL4 LE 1).P70                                         54350000
IJDQ4&CG9 DC    H'&AL4'                                                 54400000
.P70      AIF   (&AL6 LE 1).P71                                         54450000
IJDQ6&CG9 DC    H'&AL6'                                                 54500000
.P71      AIF   ('&RECF' NE 'V').P72                                    54550000
IJDQ7&CG9 DC    H'4'                                                    54600000
.P72      ANOP                                                          54650000
          AIF   ('&CG1' NE '3800').P74                         @D34YSRJ 54700000
          AIF   ('&CNTL' NE 'C').P74                           @D34YSRJ 54750000
IJDQF&CG9 DC   H'67'                   FOLD OPERATION CODE     @D34YSRJ 54800000
IJDQU&CG9 DC   H'35'                   UNFOLD OPERATION CODE   @D34YSRJ 54850000
.P74      ANOP                                                 @D34YSRJ 54900000
          AIF   ('&CNTL' NE 'C').P7401                         @D21DUJS 54950000
IJDQC&CG9 DC   H'135'                  CLR PRT OPERATION CODE  @D21DUJS 55000000
IJDQO&CG9 DC   H'51'                   ORDER   OPERATION CODE  @D21DUJS 55050000
.P7401    ANOP                                                 @D21DUJS 55100000
          AIF   ('&CG1' EQ '2245').P74A                        @DA28526 55150000
          AIF   ('&CG1' EQ '3800').P74A                        @DA28526 55200000
          AGO   .P741                                          @DA28526 55250000
.P74A     ANOP                                                 @DA28526 55300000
IJDQ8&CG9 DC   H'256'                                               4-0 55350000
.P741     ANOP                                                      4-0 55400000
IJDL0&CG9 EQU  10                      REG 10                  @DA29705 55450000
IJDL1&CG9 EQU  11                      REG 11                       3-3 55500000
IJDL2&CG9 EQU   12                     REG 12                           55550000
IJDL3&CG9 EQU   13                     REG 13                           55600000
IJDL4&CG9 EQU   14                     REG 14                           55650000
IJDL5&CG9 EQU   15                     REG 15                           55700000
IJDL6&CG9 EQU   50                     ABEOJ                            55750000
IJDL7&CG9 EQU   0                      EXCP                             55800000
IJDL8&CG9 EQU   X'80'                                                   55850000
IJDL9&CG9 EQU   X'40'                                                   55900000
IJDLA&CG9 EQU   X'20'                                                   55950000
IJDLB&CG9 EQU   X'08'                                                   56000000
IJDLC&CG9 EQU   X'10'                                                   56050000
IJDLD&CG9 EQU   X'04'                                                   56100000
IJDLE&CG9 EQU   X'06'                                                   56150000
IJDLF&CG9 EQU   X'01'                                                   56200000
IJDLG&CG9 EQU   X'02'                                                   56250000
IJDLH&CG9 EQU   X'8B'                                                   56300000
IJDLI&CG9 EQU   X'FE'                                                   56350000
IJDLJ&CG9 EQU   X'0B'                                                   56400000
IJDLK&CG9 EQU   X'BF'                                                   56450000
IJDLL&CG9 EQU   X'F8'        CCB+3  ERROR PASSBACK BITS             3-9 56500000
IJDLM&CG9 EQU   X'40'        CCB+2  ERROR PASSBACK BITS             3-9 56550000
IJDLN&CG9 EQU  1             REG 1                                  3-9 56600000
IJDMA&CG9 EQU   X'10'                  DISP FOR SWITCH         @DA13914 56650000
          AIF   ('&TARC' NE 'Y').P75   SKIP IF NOT TRC         @D34YSRC 56700000
IJDMT&CG9 EQU   X'02'                  FLAG - TRC IN EFFECT    @D34YSRC 56750000
.P75      ANOP                                                 @DM16826 56800000
IJDM6&CG9 EQU   X'15'                  DISP FOR SWITCHES            4-0 56850000
IJDM8&CG9 EQU   56                     ASOCFLE DISP IN DTF          4-0 56900000
IJDJM&CG9 EQU   X'23'                  FD,SS COMMAND                4-0 56950000
IJD05&CG9 EQU   X'05'                  LINE POSITION ZERO FOR 3525  4-0 57000000
IJD8D&CG9 EQU   X'8D'                  TEST FOR CHANNEL 9           4-0 57050000
IJDBD&CG9 EQU   X'BD'                  TEST FOR CHANNEL 12          4-0 57100000
IJD1D&CG9 EQU   X'1D'                  LINE 3                       4-0 57150000
IJD0D&CG9 EQU   X'0D'                  LINE 1                       4-0 57200000
IJDCD&CG9 EQU   X'CD'                  LINE 25                      4-0 57250000
IJDV2&CG9 EQU   48                     DISP IN PUNCH DTF            4-0 57300000
          AIF   ('&CG1' EQ '2245').P2245                            4-0 57350000
          AGO   .P2245A                                             4-0 57400000
.P2245    TM   IJDP2&CG9,IJDLA&CG9     DID PASSBACK ERROR OCCUR     4-0 57450000
.P2245A   ANOP                                                      4-0 57500000
          AIF   (T'&RDONLY NE 'O').RP63AA                      @DM16844 57550000
          DS    0F                                             @DA29705 57600000
IJDM7&CG9 DC    5F'0'                  ASOCFLE SAVE AREA       @DA34200 57650000
.RP63AA   AIF   ('&CG1' NE '3525').P63A                        @DA29705 57700000
IJDM5&CG9 DC    XL4'00000008'          USED FOR CONTROL             4-0 57750000
.P63A     AIF   ('&CG1' EQ '3525').P48                              4-0 57800000
         AIF ('&PROV' EQ 'Z' OR '&PROV' EQ 'P').P48                 3-9 57850000
         DS    0F                      ALIGN ROUTINE ON FULL WORD   3-9 57900000
IJDSR&CG9 TM    IJDP1&CG9,IJDL8&CG9    WAIT CHANNEL END             3-9 57950000
         BO    *+6                                                  3-9 58000000
         SVC   7                                                    3-9 58050000
         TM    IJDP2&CG9,IJDLL&CG9     DID ERROR PASSBACK ERROR OCUR3-9 58100000
         BNZ   IJDST&CG9               YES                          3-9 58150000
         TM    IJDP1&CG9,IJDLM&CG9   BUFFER PARITY CHECK            3-9 58200000
         AIF   (T'&RDONLY NE 'O').SR50                         @DA29705 58250000
IJDST&CG9 BCR  8,IJDL4&CG9             NO, RETURN              @DA29705 58300000
         AGO  .SR51                                            @DA29705 58350000
.SR50    ANOP                                                  @DA29705 58400000
IJDST&CG9 BCR  8,IJDL0&CG9       NO,RETURN TO USER             @DA29705 58450000
         AGO  .RP48A                                           @DA29705 58500000
.SR51    STM   IJDL1&CG9,IJDLN&CG9,IJDSW&CG9 SAVE RE11-1       @DA29705 58550000
         LM    IJDL1&CG9,IJDL3&CG9,IJDM7&CG9  USER REGS 11-13  @DA29705 58600000
         AGO   .RP48B                                          @DM16844 58650000
.RP48A   STM   IJDL0&CG9,IJDLN&CG9,24(IJDL3&CG9)    SAVE 10-1  @DA29705 58700000
         LM    IJDL0&CG9,IJDL2&CG9,0(IJDL3&CG9) USER REGS 10-12@DA29705 58750000
.RP48B   L     IJDL4&CG9,IJDPL&CG9     ADDR OF USERS ERROR ROUTINE  3-9 58800000
         BALR  IJDL4&CG9,IJDL4&CG9     GO TO USER                   3-9 58850000
         AIF   (T'&RDONLY NE 'O').RP48C                        @DM16844 58900000
         USING  *,IJDL4&CG9                                    @DA29705 58950000
         LM    IJDL1&CG9,IJDLN&CG9,IJDSW&CG9     REST 11-1     @DA29705 59000000
         AGO   .RP48D                                          @DM16844 59050000
.RP48C   LM    IJDL0&CG9,IJDLN&CG9,24(IJDL3&CG9)    REST 10-1  @DA29705 59100000
.RP48D   AIF   (T'&RDONLY NE 'O').SR17                         @DA29705 59150000
         BR    IJDL4&CG9               RETURN TO CALLER             3-9 59200000
         AGO  .SR18                                            @DA29705 59250000
.SR17    BR    IJDL0&CG9         RETURN TO CALLER              @DA29705 59300000
.SR18    AIF   (T'&RDONLY NE 'O').P48                          @DA29705 59350000
          DS    0F                                                  3-9 59400000
IJDSW&CG9 DC   7F'0'                                                3-9 59450000
          DROP  IJDL4&CG9                                      @DA29705 59500000
.P48     ANOP                                                       3-9 59550000
          AIF   ('&WORKA' EQ '').P29                           @D34YSRJ 59600000
IJDPT&CG9 MVC   0(0,IJDL4&CG9),0(IJDL3&CG9) MOVE WORKA TO IOAREA        59650000
.P29      AIF   ('&TARC' NE 'Y').P31                           @D34YSRJ 59700000
IJDQT&CG9 DC    H'3'                   MAXIMUM TRC VALUE       @D34YSRJ 59750000
IJDTT&CG9 DC    XL4'47576777'          TRC TRANSLATE TABLE     @D34YSRJ 59800000
.P31      AIF   ('&CTLCHR' NE 'ASA').P32                                59850000
IJDPV&CG9 DC    C'2BA9876543C1+-0 '                                     59900000
          AIF   ('&CNTL' NE 'M').JJ2                                4-0 59950000
IJDPP&CG9 DC    X'93DBD3CBC3BBB3ABA39BE38B03130B03'                 4-0 60000000
          AGO   .P32                                                4-0 60050000
.JJ2      ANOP                                                      4-0 60100000
          AIF   ('&CG1' NE '3525').P31A                             4-0 60150000
IJDPX&CG9 DC    X'1DAD9D8D7D6D5D4D3D2DBD0D00181008'                 4-0 60200000
          AGO   .P32                                                4-0 60250000
.P31A     ANOP                                                      4-0 60300000
IJDPX&CG9 DC    X'93DBD3CBC3BBB3ABA39BE38B031B130B'                     60350000
.P32      AIF   ('&CG1' NE '3525' OR '&CNTL' NE 'C').P32B           4-0 60400000
IJDJ8&CG9 DC    X'93DBD3CBC3BBB3ABA39BE38B031B130B'                 4-0 60450000
IJDJ9&CG9 DC    X'1DAD9D8D7D6D5D4D3D2DBD0D00181008'                 4-0 60500000
IJDH4&CG9 DC    X'91D9D1C9C1B9B1A9A199E18901191109'                 4-0 60550000
.P32B     ANOP                                                      4-0 60600000
          AIF   (T'&SEPASMB NE 'O').P32A                                60650000
&SYSECT  CSECT                                                          60700000
.P32A    MEXIT                                                       JJ 60750000
.*                                                                   JJ 60800000
.MFCX    ANOP                           MFCM/MFCU DEVICES            JJ 60850000
&X       SETC  '&SYSNDX'(2,3)                                        JJ 60900000
.*                                                                   JJ 60950000
.* SYNTAX CHECK AND GENERATION OF MODULE NAME. THE MODULE NAME STARTSJJ 61000000
.* WITH THE 3 LETTERS IJD. THE REST CONSISTS OF FOLLOWING VARIABLES: JJ 61050000
.*                                                                   JJ 61100000
.* 1) &RECF = F     RECFORM=FIXUNB                                   JJ 61150000
.*          = U            =UNDEF                                    JJ 61200000
.*          = V            =VARUNB                                   JJ 61250000
.* 2) &DEV  = U     DEVICE =2560                                     JJ 61300000
.*          = V            =5425                               @DL2994J 61350000
.* 3) &FC   = U     FUNC=W OR OMITTED                                JJ 61400000
.*          = V         =RW                                          JJ 61450000
.*          = W         =PW                                          JJ 61500000
.*          = X         =RPW                                         JJ 61550000
.* 4) &IOA2 = I     IOAREA2=YES                                      JJ 61600000
.*          = Z     IOAREA2 OMITTED                                  JJ 61650000
.* 5) &WKAR = V     WORKA=YES,RDONLY=YES                             JJ 61700000
.*          = W     WORKA=YES                                        JJ 61750000
.*          = Y     RDONLY=YES                                       JJ 61800000
.*          = Z     WORKA AND RDONLY OMITTED                         JJ 61850000
.*                                                                   JJ 61900000
         AIF   (K'&DEVICE EQ 4).MFCX2                                JJ 61950000
         AIF   (K'&DEVICE NE 5).MFCX1                                JJ 62000000
         AIF   ('&DEVICE'(5,1) EQ 'P').MFCX2                         JJ 62050000
         AIF   ('&DEVICE'(5,1) EQ 'S').MFCX2                         JJ 62100000
.MFCX1   MNOTE 0,'INVALID DEVICE. ''&DV'' ASSUMED'                   JJ 62150000
.MFCX2   ANOP                                                        JJ 62200000
&RECF    SETC  'F'                                                   JJ 62250000
         AIF   ('&RECFORM' EQ 'FIXUNB').MF1                          JJ 62300000
&RECF    SETC  'U'                                                   JJ 62350000
         AIF   ('&RECFORM' EQ 'UNDEF').MF1                           JJ 62400000
&RECF    SETC  'V'                                                   JJ 62450000
         AIF   ('&RECFORM' EQ 'VARUNB').MF1                          JJ 62500000
         MNOTE 0,'IMPROPER RECFORM. MACRO NOT GENERATED'             JJ 62550000
         MEXIT                                                       JJ 62600000
.MF1     ANOP                                                        JJ 62650000
&DEV     SETC  'U'                                                   JJ 62700000
         AIF   ('&DV' EQ '2560').MF2                                 JJ 62750000
&DEV     SETC  'V'                                                   JJ 62800000
.MF2     ANOP                                                        JJ 62850000
&FC      SETC  'U'                                                   JJ 62900000
         AIF   ('&FUNC' EQ 'W' OR T'&FUNC EQ 'O').MF3                JJ 62950000
&FC      SETC  'V'                                                   JJ 63000000
         AIF   ('&FUNC' EQ 'RW').MF3                                 JJ 63050000
&FC      SETC  'W'                                                   JJ 63100000
         AIF   ('&FUNC' EQ 'PW').MF3                                 JJ 63150000
&FC      SETC  'X'                                                   JJ 63200000
         AIF   ('&FUNC' EQ 'RPW').MF3                                JJ 63250000
         MNOTE 0,'IMPROPER FUNC. MACRO NOT GENERATED'                JJ 63300000
         MEXIT                                                       JJ 63350000
.MF3     ANOP                                                        JJ 63400000
&IOA2    SETC  'I'                                                   JJ 63450000
         AIF   ('&IOAREA2' EQ 'YES').MF5                             JJ 63500000
         AIF   (T'&IOAREA2 EQ 'O').MF4                               JJ 63550000
         MNOTE 0,'IMPROPER IOAREA2. ''YES'' ASSUMED'                 JJ 63600000
         AGO   .MF5                                                  JJ 63650000
.MF4     ANOP                                                        JJ 63700000
&IOA2    SETC  'Z'                                                   JJ 63750000
.MF5     ANOP                                                        JJ 63800000
         AIF   ('&WORKA' EQ 'YES' OR T'&WORKA EQ 'O').MF6            JJ 63850000
         MNOTE 0,'IMPROPER WORKA. ''YES'' ASSUMED'                   JJ 63900000
.MF6     AIF   ('&RDONLY' EQ 'YES' OR T'&RDONLY EQ 'O').MF7          JJ 63950000
         MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED'                  JJ 64000000
.MF7     ANOP                                                        JJ 64050000
&WKAR    SETC  'V'                                                   JJ 64100000
         AIF   (T'&WORKA NE 'O' AND T'&RDONLY NE 'O').MF8            JJ 64150000
&WKAR    SETC  'W'                                                   JJ 64200000
         AIF   (T'&WORKA NE 'O').MF8                                 JJ 64250000
&WKAR    SETC  'Y'                                                   JJ 64300000
         AIF   (T'&RDONLY NE 'O').MF8                                JJ 64350000
&WKAR    SETC  'Z'                                                   JJ 64400000
.MF8     AIF   (T'&CONTROL EQ 'O').MF9                               JJ 64450000
         MNOTE 0,'IMPROPER CONTROL. IGNORED'                         JJ 64500000
.MF9     AIF   (T'&CTLCHR EQ 'O').MF10                               JJ 64550000
         MNOTE 0,'IMPROPER CTLCHR. IGNORED'                          JJ 64600000
.MF10    AIF   (T'&PRINTOV EQ 'O').MF10A                             JJ 64650000
         MNOTE 0,'IMPROPER PRINTOV. IGNORED'                         JJ 64700000
.MF10A   AIF   (T'&ERROPT EQ 'O').MF11                               JJ 64750000
         MNOTE 0,'INVALID ERROPT. IGNORED'                           JJ 64800000
.MF11    AIF   (T'&STLIST EQ 'O').MF12                               JJ 64850000
         MNOTE 0,'IMPROPER STLIST. IGNORED'                          JJ 64900000
.MF12    AIF   ('&SEPASMB' EQ 'YES' OR T'&SEPASMB EQ 'O').MF13       JJ 64950000
         MNOTE 0,'IMPROPER SEPASMB. ''YES'' ASSUMED'                 JJ 65000000
.MF13    ANOP                                                        JJ 65050000
&NAM     SETC  'IJD&RECF&DEV&FC&IOA2&WKAR'                           JJ 65100000
         AIF   (T'&LABEL EQ 'O').MF14                                JJ 65150000
&NAM     SETC  '&LABEL'                                              JJ 65200000
.MF14    AIF   (T'&SEPASMB EQ 'O').MF15                              JJ 65250000
         PUNCH '   CATALOG &NAM..OBJ   REPLACE=YES'            @DA29705 65300000
.MF15    ANOP                                                        JJ 65350000
IJD30&X  DSECT                                                       JJ 65400000
IJD31&X  DS    CL2  RESIDUAL COUNT                                   JJ 65450000
IJD32&X  DS    CL2 COMMUNICATION BYTES                               JJ 65500000
         DS    CL2  CSW STATUS BYTES                                 JJ 65550000
         DS    CL2  LOGICAL UNIT ADDRESS                             JJ 65600000
IJD33&X  DS    CL1  NOT USED                                         JJ 65650000
         DS    CL3  CCW ADDRESS                                      JJ 65700000
         DS    CL1  STATUS BYTE                                      JJ 65750000
         DS    CL3  CCW ADDR IN CSW                                  JJ 65800000
IJD73&X  DS    CL4  ADDRESS OF LOGICAL MODULE                  @DA13914 65850000
         DS    CL1  DTF TYPE                                         JJ 65900000
IJD34&X  DS    CL1  SWITCHES                                         JJ 65950000
IJD39&X  DS    CL1  BLANK CHECK BYTE (2560 MFCM)                     JJ 66000000
         DS    CL1  PRINT HEAD SELECTION BYTE (2560)                 JJ 66050000
IJD35&X  DS    CL4  ADDRESS OF IOAREA1                               JJ 66100000
IJD36&X  DS    CL4  BUCKET                                           JJ 66150000
IJD37&X  DS    CL2  LR 12,&RECSIZE                                   JJ 66200000
IJD38&X  DS    CL4  LA &IOREG,0(14)                                  JJ 66250000
         DS    CL2  NOT USED                                         JJ 66300000
IJD45&X  DS    CL4  A(ASOCFILE)                                      JJ 66350000
IJD47&X  DS    CL4  SWITCHES                                         JJ 66400000
         AIF   ('&DV' NE '2560').MF17                                JJ 66450000
         AIF   (K'&FUNC GT 1).MF16                                   JJ 66500000
IJD41&X  DS    CL8  EJECT CCW                                  @DF01188 66550000
.MF16    ANOP                                                        JJ 66600000
IJD42&X  DS    CL1  LOAD PRINT HEAD BUFFER CCW                       JJ 66650000
         DS    CL3       ADDRESS OF IOAREA2                          JJ 66700000
         DS    CL1       FLAGS                                       JJ 66750000
         DS    CL1       NOT USED                                    JJ 66800000
IJD46&X  DS    CL2       BYTE COUNT                                  JJ 66850000
IJD43&X  DS    CL6  PRINT CCW                                        JJ 66900000
IJD44&X  DS    CL2       COLUMN COUNT                                JJ 66950000
         AGO   .MF18                                                 JJ 67000000
.MF17    ANOP                                                        JJ 67050000
IJD42&X  DS    CL1  PRINT CCW                                        JJ 67100000
         DS    CL3       ADDRESS OF IOAREA2                          JJ 67150000
         DS    CL1       FLAGS                                       JJ 67200000
         DS    CL1       NOT USED                                    JJ 67250000
IJD46&X  DS    CL2       BYTE COUNT                                  JJ 67300000
.MF18    ANOP                                                        JJ 67350000
&REG     SETA  14                                                    JJ 67400000
         AIF   (T'&WORKA EQ 'O').MF20                                JJ 67450000
&REG     SETA  13                                                    JJ 67500000
.MF20    ANOP                                                        JJ 67550000
&NAM     CSECT                                                       JJ 67600000
         USING IJD31&X,1                                             JJ 67650000
         USING *,15                                                  JJ 67700000
         SVC   50                       CONTROL ERROR                JJ 67750000
         DC    H'0'                                                  JJ 67800000
         SVC   50                       PRINTOV ERROR                JJ 67850000
         DC    H'0'                                                  JJ 67900000
IJD50&X  SVC   50                       READ ERROR OR MACRO SEQU.-   JJ 67950000
         DC    H'0'                     ERROR (IF ASSOCIATED FILE)   JJ 68000000
         B     IJD51&X                  BRANCH TO PUT ROUTINE        JJ 68050000
         DC    CL8'&NAM'                MODULE NAME                  JJ 68100000
         DC    X'3440'   /*@@LVLID*/    MODULE CHANGE LEVEL    @D41TDKY 68150000
IJD51&X  EQU   *                        SAVE REGISTERS               JJ 68200000
         AIF   (T'&RDONLY EQ 'O').MF22                               JJ 68250000
         STM   IJD11&X,IJD14&X,0(IJD13&X)                            JJ 68300000
         AGO   .MF22A                                                JJ 68350000
.MF22    STM   IJD12&X,IJD14&X,IJD61&X                               JJ 68400000
.MF22A   AIF   ('&RECFORM' EQ 'VARUNB').MF24                         JJ 68450000
         AIF   ('&RECFORM' NE 'UNDEF').MF23                          JJ 68500000
         EX    0,IJD37&X                RECORD LENGTH INTO REG 12    JJ 68550000
         AGO   .MF24                                                 JJ 68600000
.MF23    AIF   (T'&WORKA NE 'O').MF23A                               JJ 68650000
         AIF   ('DV' NE '5425' OR K'&FUNC LE 1).MF24           @DL2994J 68700000
.MF23A   LH    IJD12&X,IJD46&X          RECORD LENGTH INTO REG 12    JJ 68750000
.MF24    AIF   (T'&RDONLY EQ 'O').MF25                               JJ 68800000
         LR    IJD11&X,IJD13&X          SAVE POINTER TO SAVE AREA    JJ 68850000
.MF25    AIF   (K'&FUNC LE 1).MF26      SIMPLE FILE                  JJ 68900000
         TM    IJD73&X,IJD8A&X          FILE OPEN IGN          @DA13914 68950000
         BO    IJD52&X                  YES, CONTINUE          @DA13914 69000000
         TM    IJD34&X,IJD80&X          FILE OPEN                    JJ 69050000
         BZ    IJD50&X                  NO                           JJ 69100000
IJD52&X  TM    IJD47&X,IJD83&X          SEQUENCE ERROR               JJ 69150000
         BZ    IJD50&X                  YES                          JJ 69200000
         XI    IJD47&X,IJD83&X          SET PRINT SWITCH             JJ 69250000
.MF26    AIF   (K'&FUNC LE 1 OR '&DV' NE '2560').MF28                JJ 69300000
         LR    IJD14&X,IJD01&X          SAVE POINTER TO DTF TABLE    JJ 69350000
         L     IJD01&X,IJD45&X          ADDR OF ASOCFILE INTO REG 1  JJ 69400000
         AIF   ('&FUNC' NE 'RPW').MF27                               JJ 69450000
         L     IJD01&X,IJD84&X.(IJD01&X) ADDR OF PUNCH DTF TO REG 1  JJ 69500000
         SVC   0                        PUNCH LAST CARD              JJ 69550000
         LR    IJD01&X,IJD14&X          RESTORE POINTER TO DTF TABLE JJ 69600000
         L     IJD01&X,IJD45&X          ADDR OF READ DTF INTO REG 1  JJ 69650000
.MF27    SVC   0                                                     JJ 69700000
         LR    IJD01&X,IJD14&X          RESTORE PTR TO DTF TABLE     JJ 69750000
.MF28    AIF   (K'&FUNC GT 1).MF28A     ASSOCIATED FILE              JJ 69800000
.MF28A   AIF   (T'&IOAREA2 EQ 'O' AND T'&WORKA EQ 'O').MF29          JJ 69850000
         TM    IJD32&X,IJD80&X          TEST DEVICE END              JJ 69900000
         BO    *+6                                                   JJ 69950000
         SVC   7                        WAIT DEVICE END              JJ 70000000
.MF29    AIF   (T'&WORKA EQ 'O').MF30                                JJ 70050000
         LR    IJD13&X,IJD00&X          ADDR OF WORKA INTO REG 13    JJ 70100000
.MF30    L     IJD14&X,IJD35&X          ADDR OF IOAREA1 INTO REG 14  JJ 70150000
         AIF   ('&RECFORM' NE 'VARUNB').MF33                         JJ 70200000
&OFFS    SETA  4                                                     JJ 70250000
         SH    IJD14&X,IJD64&X          DECREASE REG 14 BY 4         JJ 70300000
         MVC   IJD36&X.(2),0(&REG)      RECORD LENGTH INTO BUCKET    JJ 70350000
         LH    IJD12&X,IJD36&X          RECORD LENGTH INTO REG 12    JJ 70400000
.MF33    AIF   ('&RECFORM' EQ 'FIXUNB').MF35                         JJ 70450000
         AIF   ('&RECFORM' NE 'VARUNB').MF34                         JJ 70500000
         SH    IJD12&X,IJD64&X          GET DATA LENGTH              JJ 70550000
.MF34    STH   IJD12&X,IJD46&X          DATA LENGTH INTO BYTE COUNT  JJ 70600000
.MF35    AIF   (T'&WORKA EQ 'O').MF37                                JJ 70650000
         AIF   ('&RECFORM' NE 'VARUNB').MF36                         JJ 70700000
         LA    IJD12&X,3(IJD12&X)       GET RECORD LENGTH            JJ 70750000
         AGO   .MF36A                                                JJ 70800000
.MF36    BCTR  IJD12&X,0                PREPARE MOVE TO IOAREA       JJ 70850000
.MF36A   AIF   ('&DV' NE '5425').MF36B                         @DL2994J 70900000
         EX    IJD12&X,IJD65&X                                       JJ 70950000
         AGO   .MF37                                                 JJ 71000000
.MF36B   CH    IJD12&X,IJD66&X          IS FIELD GREATER THAN 256    JJ 71050000
         BNH   IJD70&X                  NO                           JJ 71100000
.* IF THE WORKAREA IS LONGER THAN 256 BYTES, TWO MOVES MUST BE       JJ 71150000
.* EXECUTED TO GET THE WORKAREA INTO THE IOAREA1                     JJ 71200000
.* IN THIS CASE FIRST THE FIRST BYTES ARE MOVED, WHILE THE           JJ 71250000
.* LAST 256 BYTES ARE MOVED VIA A SECOND MVC                         JJ 71300000
         SH    IJD12&X,IJD66&X          PREPARE FIRST MOVE           JJ 71350000
         EX    IJD12&X,IJD65&X          FIRST BYTES OF WORKA         JJ*71400000
                                        INTO IOAREA1                 JJ 71450000
         AR    IJD14&X,IJD12&X          PREPARE SECOND MOVE          JJ 71500000
         AR    IJD13&X,IJD12&X          DITO                         JJ 71550000
         LH    IJD12&X,IJD66&X          LENGTH FOR SECOND MOVE =255  JJ 71600000
IJD70&X  EX    IJD12&X,IJD65&X          WORKA INTO IOAREA1           JJ 71650000
         L    IJD14&X,IJD35&X           GET ADDR OF FIRST DATA BYTE  JJ 71700000
         AIF   ('&RECFORM' NE 'VARUNB').MF37                         JJ 71750000
         SH    IJD14&X,IJD64&X          GET ADDR OF RECORD           JJ 71800000
.MF37    AIF   (T'&IOAREA2 EQ 'O').MF38                              JJ 71850000
         L     IJD13&X,IJD42&X          EXCHANGE IOAREA ADDRESSES    JJ 71900000
         MVC   IJD42&X+1(3),IJD35&X+1   DITO                         JJ 71950000
         ST    IJD13&X,IJD35&X          DITO                         JJ 72000000
.MF38    AIF   (K'&FUNC LE 1).MF39                                   JJ 72050000
.* FOR ASSOCIATED PRIMT FILES A CHECK IS MADE FOR BLANK BUFFER       JJ 72100000
.* IF IOAREA1 IS BLANK, NO SVC 0 IS ISSUED                           JJ 72150000
.* SINCE THE BUFFER LENGTH MAY BE UP TO 384 BYTES , THERE MAY        JJ 72200000
.* TWO TESTS BE NECESSARY (FIRST THE FIRST BYTES ARE TESTED,         JJ 72250000
.* THEN THE LAST 256 BYTES ARE TEST FOR BEING BLANK)                 JJ 72300000
         LH    IJD12&X,IJD46&X          GET NUMBER OF DATA BYTES     JJ 72350000
         CLI   &OFFS.(IJD14&X),C' '     IS FIRST CHARACTER BLANK     JJ 72400000
         BNE   IJD53&X                  NO                           JJ 72450000
         BCTR  IJD12&X,0                ADJUST LENGTH FOR BLANK      JJ*72500000
                                        TEST                         JJ 72550000
         BCTR  IJD12&X,0                DITO                         JJ 72600000
         BM    IJD59&X                  BRANCH IF RECORD CONSISTS    JJ*72650000
                                        OF ONE BLANK BYTE ONLY       JJ 72700000
         AIF   ('&DV' EQ '5425').MF38A                         @DL2994J 72750000
         CH    IJD12&X,IJD66&X          IS ONE CLC SUFFICIENT        JJ*72800000
                                        TO TEST FOR BLANK BUFFER     JJ 72850000
         BNH   IJD71&X                  YES                          JJ 72900000
         SH    IJD12&X,IJD66&X          PREPARE BLANK TEST FOR       JJ*72950000
                                        FIRST BYTES                  JJ 73000000
         EX    IJD12&X,IJD62&X          TEST FIRST CHARACTERS        JJ 73050000
         BNE   IJD53&X                  BR IF NOT BLANK              JJ 73100000
         AR    IJD14&X,IJD12&X          PREPAREA SECOND TEST         JJ 73150000
         LH    IJD12&X,IJD66&X          DITO                         JJ 73200000
.MF38A   ANOP                                                        JJ 73250000
IJD71&X  EX    IJD12&X,IJD62&X          TEST FOR BLANK BUFFER        JJ 73300000
         BE    IJD59&X                  BR IF BLANK BUFFER           JJ 73350000
IJD53&X  EQU   *                                                     JJ 73400000
.MF39    AIF   ('&DV' NE '2560').MF40                                JJ 73450000
.* THE FOLLOWING ROUTINE CHECS HOW MANY COLUMNS ARE TO BE PRINTED    JJ 73500000
.* WITH THE 2560 MFCM                                                JJ 73550000
.* IF THE LAST COLUMNS ARE BLANK, THEY ARE NOT PRINTED               JJ 73600000
         L     IJD14&X,IJD42&X          GET ADDR OF FIRST DATA BYTE  JJ 73650000
         LA    IJD14&X,0(IJD14&X)       CLEAR HIGH ORDER BYTE        JJ 73700000
         LH    IJD12&X,IJD63&X          INITIALIZE COLUMN COUNT      JJ 73750000
         CH    IJD12&X,IJD46&X          IS RECORD LONGER THAN 64     JJ 73800000
         BNH   IJD54&X                  LONGER OR EQUAL 64           JJ 73850000
         LH    IJD12&X,IJD46&X          INITIALIZE COLUMN COUNT      JJ 73900000
IJD54&X  LR    IJD13&X,IJD14&X          GET ADDR OF FIRST DATA BYTE  JJ 73950000
         AH    IJD13&X,IJD46&X          GET END ADDR OF RECORD       JJ 74000000
         ST    IJD13&X,IJD36&X          END ADDR INTO BUCKET         JJ 74050000
         MVI   IJD39&X,C' '             INITIALIZE BLANK INDIKATOR   JJ 74100000
IJD55&X  LR    IJD13&X,IJD14&X          GET ADDR OF FIRST DATA BYTE  JJ 74150000
         BCTR  IJD12&X,0                DECREASE COLUMN COUNT BY 1   JJ 74200000
         AR    IJD13&X,IJD12&X          SET PTR TO BYTE TO BE        JJ*74250000
                                        CHECKED FOR BLANK            JJ 74300000
IJD56&X  OC    IJD39&X.(1),0(IJD13&X)   BLANK INFO INTO CHECK BYTE   JJ 74350000
         LA    IJD13&X,64(IJD13&X)      SET PTR TO NEXT BYTE IN      JJ*74400000
                                        THE ACTUAL COLUMN            JJ 74450000
         C     IJD13&X,IJD36&X          IS THIS BYTE PART OF THE     JJ*74500000
                                        RECORD                       JJ 74550000
         BL    IJD56&X                  YES                          JJ 74600000
         CLI   IJD39&X,C' '             IS ACTUAL COLUMN BLANK       JJ 74650000
         BE    IJD55&X                  YES                          JJ 74700000
         LA    IJD12&X,1(IJD12&X)       GET COLUMN COUNT             JJ 74750000
         STC   IJD12&X,IJD44&X+1        COLUMN COUNT INTO PRINT CCW  JJ 74800000
         CLI   IJD44&X+1,X'00'          IS COL COUNT ZERO            JJ 74850000
         BNE   IJD57&X                  NO                           JJ 74900000
         MVI   IJD44&X+1,X'01'          SET COL COUNT TO 1           JJ 74950000
IJD57&X  EQU   *                                                     JJ 75000000
.MF40    ANOP                                                        JJ 75050000
         AIF   (K'&FUNC GT 1 OR '&DV' NE '2560').MF40AA        @DL2994J 75100000
         LA    IJD14&X,IJD41&X          GET ADDR OF READ CCW   @DF01188 75150000
         AGO   .MF40AAA                                        @DA06223 75200000
.MF40AA  AIF   ('&DV' NE '2560').MF40A                         @DA06223 75250000
         LA    IJD14&X,IJD42&X          GET ADDR OF FIRST CCW  @DA06223 75300000
.MF40AAA ANOP                                                  @DA06223 75350000
         ST    IJD14&X,8(IJD01&X)       ADDR OF CCW INTO CCB         JJ 75400000
.MF40A   ANOP                                                  @DA06223 75450000
         SVC   0                        PRINT                        JJ 75500000
IJD59&X  EQU   *                                                     JJ 75550000
.MF43    AIF   (K'&FUNC LE 1).MF45                                   JJ 75600000
         AIF   ('&DV' NE '5425').MF45                          @DL2994J 75650000
         LR    IJD13&X,IJD01&X          SAVE PTR TO DTF TABLE        JJ 75700000
         L     IJD01&X,IJD45&X          ADDR OF ASOCFLE INTO REG 1   JJ 75750000
         AIF   ('&FUNC' NE 'RW').MF43A                                  75800000
         MVC   32(1,IJD01&X),23(IJD01&X)  * UPDATE READ        @DL2994J 75850000
         MVC   23(1,IJD01&X),22(IJD01&X)  * CONTROL CODE       @DL2994J 75900000
.MF43A   AIF   ('&FUNC' NE 'RPW').MF44                         @DL2994J 75950000
         L     IJD01&X,IJD84&X.(IJD01&X) ADDR OF PUNCH DTF INTO REG 1JJ 76000000
         SVC   0                        PUNCH CARD                   JJ 76050000
         LR    IJD01&X,IJD13&X          RESTORE PTR TO DTF TABLE     JJ 76100000
         L     IJD01&X,IJD45&X          ADDR OF READ DTF INTO REG 1  JJ 76150000
.MF44    SVC   0                                                     JJ 76200000
         LR    IJD01&X,IJD13&X          RESTORE PTR TO DTF TABLE     JJ 76250000
.MF45    AIF   (T'&IOAREA2 NE 'O' OR T'&WORKA NE 'O').MF46           JJ 76300000
         TM    IJD32&X,IJD80&X          TEST DEVICE END              JJ 76350000
         BO    *+6                                                   JJ 76400000
         SVC   7                        WAIT FOR DEVICE END          JJ 76450000
.MF46    AIF   (T'&RDONLY EQ 'O').MF48                               JJ 76500000
         AIF   (T'&IOAREA2 EQ 'O' OR T'&WORKA NE 'O').MF47           JJ 76550000
         LM    IJD11&X,IJD13&X,0(IJD11&X) RESTORE REG'S 11- 13       JJ 76600000
         L     IJD14&X,IJD35&X   SET PTR TO IOAREA2                  JJ 76650000
         AIF   ('&RECF' NE 'V').MF46AA                               JJ 76700000
         SH    IJD14&X,IJD64&X   ADJUST IOAREA ADDR                  JJ 76750000
.MF46AA  ANOP                                                        JJ 76800000
         EX    0,IJD38&X                LOAD USER'S IOREG            JJ 76850000
         L     IJD14&X,12(IJD13&X)      RESTORE RETURN ADDRESS       JJ 76900000
         AGO   .MF50                                                 JJ 76950000
.MF47    LM    IJD11&X,IJD14&X,0(IJD11&X) RESTORE REG'S 12-14        JJ 77000000
         AGO   .MF50                                                 JJ 77050000
.MF48    AIF   (T'&IOAREA2 EQ 'O' OR T'&WORKA NE 'O').MF49           JJ 77100000
         LM    IJD12&X,IJD13&X,IJD61&X  RESTORE REG'S 12-13          JJ 77150000
         L     IJD14&X,IJD35&X   SET PTR TO IOAREA2                  JJ 77200000
         AIF   ('&RECF' NE 'V').MF48AA                               JJ 77250000
         SH    IJD14&X,IJD64&X   ADJUST IOAREA ADDR                  JJ 77300000
.MF48AA  ANOP                                                        JJ 77350000
         EX    0,IJD38&X                LOAD USER'S IOREG            JJ 77400000
         L     IJD14&X,IJD61&X+8        RESTORE RETURN ADDRESS       JJ 77450000
         AGO   .MF50                                                 JJ 77500000
.MF49    LM    IJD12&X,IJD14&X,IJD61&X  RESTORE REG'S 12-14          JJ 77550000
.MF50    ANOP                                                        JJ 77600000
IJD60&X  EQU   *                                                     JJ 77650000
         BR    IJD14&X                  RETURN TO USER               JJ 77700000
         AIF   (T'&RDONLY NE 'O').MF51                               JJ 77750000
IJD61&X  DC    3F'0'                    REGISTER SAVE AREA           JJ 77800000
.MF51    AIF   (K'&FUNC LE 1).MF52                                   JJ 77850000
IJD62&X  CLC   &OFFS.(0,IJD14&X),&OFFS+1(IJD14&X)                    JJ 77900000
.MF52    AIF   ('&DV' NE '2560').MF53                                JJ 77950000
IJD63&X  DC    H'64'                    LENGTH OF LINE               JJ 78000000
.MF53    AIF   ('&RECFORM' NE 'VARUNB').MF54                         JJ 78050000
IJD64&X  DC    H'4'                     OFFSET OF DATA IN RECORD     JJ 78100000
.MF54    AIF   (T'&WORKA EQ 'O').MF55                                JJ 78150000
IJD65&X  MVC   0(0,IJD14&X),0(IJD13&X)  WORKA INTO IOAREA1           JJ 78200000
.MF55    ANOP                                                        JJ 78250000
         AIF   ('&DV' NE '2560').MF56                                JJ 78300000
IJD66&X  DC    H'255'                                                JJ 78350000
.MF56    ANOP                                                        JJ 78400000
IJD00&X  EQU   0                                                     JJ 78450000
IJD01&X  EQU   1                                                     JJ 78500000
IJD11&X  EQU   11                                                    JJ 78550000
IJD12&X  EQU   12                                                    JJ 78600000
IJD13&X  EQU   13                                                    JJ 78650000
IJD14&X  EQU   14                                                    JJ 78700000
IJD80&X  EQU   X'80'     TRAFFIC BIT, OPEN INDICATOR                 JJ 78750000
IJD81&X  EQU   X'40'     FIRST TIME SWITCH, BLANK CHARACTER          JJ 78800000
IJD8A&X  EQU   X'20'     IGNORE BIT                            @DA13914 78850000
         AIF   ('&DV' NE '2560').MF82                                JJ 78900000
         AIF   (K'&FUNC GT 1).MF81                                   JJ 78950000
IJD82&X  EQU   X'01'                                                 JJ 79000000
         AGO   .MF82                                                 JJ 79050000
.MF81    ANOP                                                        JJ 79100000
IJD82&X  EQU   X'00'                                                 JJ 79150000
.MF82    AIF   (K'&FUNC LE 1).MF83                                   JJ 79200000
IJD83&X  EQU   X'20'     PRINT SEQUENCE CONTROL SWITCH               JJ 79250000
*                        ON: BY IO COMMAND WHICH IS ALLOWED TO BE    JJ 79300000
*                        FOLLOWED IMMEDIATELY BY PRINT COMMAND       JJ 79350000
*                        OFF: BY PRINT COMMAND                       JJ 79400000
IJD84&X  EQU   X'48' OFFSET OF ADDR OF ASOCFILE IN READ DTF TABLE    JJ 79450000
.MF83    AIF   (T'&SEPASMB NE 'O').MF84                              JJ 79500000
&SYSECT  CSECT                                                       JJ 79550000
.MF84    MEND                                                        JJ 79600000
