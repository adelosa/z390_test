*%GOTO  MLBSERV; /*PLX COMMENT TO AVOID UNMATCHED QUOTE PROBLEMS        00010006
         MACRO                                                          00020006
&NAME    LBSERV &FUNC=,&CUU=,&VOLSER=,&ECB=,&SERVL=,&LIBNAME=,&WRITE=, X00030006
               &SRCCAT=,&TGTCAT=,&MEMNAME=,&LIST=                       00040033
         LCLA  &BASEREG       BASE OF SERVICE LIST                      00050006
         LCLA  &WREG1         WORK REGISTER                             00060006
         LCLA  &BRREG         BRANCH REGISTER                           00070006
         LCLA  &RETREG        RETRUN REGISTER                           00080006
         LCLA  &SAVREG        USER'S SAVE AREA REGISTER                 00090006
         LCLA  &ERROR         ERRORS DETECTED                           00100006
         LCLA  &WRT           MOUNT FOR READ WRITE                      00110006
         LCLA  &FCOD1         FUNCTION CODE PART 1                      00120006
         LCLA  &FCOD2         FUNCTION CODE PART 1                      00130006
         LCLC  &FCODE         FUNCTION CODE                             00140006
         LCLC  &TEMP1         WORK FOR REGISTER SPECIFICATION           00150006
         LCLC  &TEMP2         WORK FOR REGISTER SPECIFICATION           00160006
         LCLC  &TEMP3         WORK FOR REGISTER SPECIFICATION           00170006
         LCLC  &TEMP4         WORK FOR REGISTER SPECIFICATION           00180006
         LCLC  &TEMP5         WORK FOR REGISTER SPECIFICATION           00190006
         LCLC  &TEMP6         WORK FOR REGISTER SPECIFICATION           00200006
         LCLC  &TEMP7         WORK FOR REGISTER SPECIFICATION           00210006
         LCLC  &TEMP8         WORK FOR REGISTER SPECIFICATION           00220006
         LCLC  &TEMP9         WORK FOR REGISTER SPECIFICATION           00230006
         LCLC  &TEMPA         WORK FOR REGISTER SPECIFICATION           00231022
         LCLC  &L1            WORK FOR LABEL                            00240006
         LCLC  &L2            WORK FOR LABEL                            00250006
.*                                                                      00260006
         AGO   .ZZZ                                                     00270006
*********************************************************************** 00280006
*                                                                     * 00290006
*        LICENSED MATERIALS - PROGRAM PROPERTY OF IBM                 * 00300006
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                  * 00310006
*        5686-CF7 (C) COPYRIGHT IBM CORP. 1995,2004                   * 00320034
.*       SEE COPYRIGHT INSTRUCTIONS                                   * 00330006
*                                                                     * 00340006
*********************************************************************** 00350006
.ZZZ     ANOP                                                           00360006
.*-------------------------------------------------------------         00370006
.* /* START OF SPECIFICATIONS *********************************         00380006
.*01* MODULE TYPE = USER INTERFACE MACRO                                00390006
.*                                                                      00400006
.*01* DESCRIPTIVE NAME = ESTABLISH EXIT ROUTINE FOR I/O REQUEST         00410006
.*                                                                      00420006
.*01* NOTES = CHANGE ACTIVITY                                           00430006
.*    NEW MODULE - FIRST RELEASE  ESA 2.1.0                    @D61ADMK 00440006
.*    API EXTENSION                                            @D61ADMK 00450006
.* A000000-999999                                              @D61ADMK 00460006
.*    MAKE CUU OPTIONAL PARAMETER FOR SQUERY                   @D61ADMK 00470006
.*    SERVICE LIST IN REG1 ALSO FOR NON-REGISTER NOTATION      @DY44241 00480006
.*    ENHANCEMENTS FOR VSE NATIVE SUPPORT                      @D68CDAK 00481015
.*    EXPORT / IMPORT REQUESTS                                 @D68KDAK 00482016
.*                                                                      00490006
.**************************************************************         00500006
.*                                                                      00510006
.*  MACRO DESCRIPTION                                                   00520006
.*                                                                      00530006
.* ARGUMENT LIST DESCRIPTION:                                           00540006
.*                                                                      00550006
.*  EIGHT POSITIONAL OPERANDS HAVE TO BE SPECIFIED.                     00560006
.*                                                                      00570006
.*  THE FUNC OPERAND SPECIFIES                                          00580006
.*    MOUNT OF A VOLUME ON A DEVICE IN THE LIBRARY                      00590006
.*    SQUERY A VOLUME'S LOCATION (SINGLE QUERY)                         00600006
.*    AQUERY A VOLUME'S LOCATION (ALL LIBRARIES)                        00610006
.*    RELEASE A VOLUME ON A DEVICE IN A LIBRARY                         00620006
.*    CANCEL THE PRIOR MOUNT REQUEST                                    00630006
.*    RECEIVE THE INFO IN SERVL (OUTPUT)                                00640006
.*    EJECT A VOLUME FROM A LIBRARY                                     00650006
.*    CMOUNT A VOLUME OF A CATEGORY ON A DEVICE IN THE LIBRARY          00660006
.*    CQUERY THE NUMBER OF VOLUMES IN A LIBRARY                         00670006
.*    DQUERY THE STATUS OF A TAPE DRIVE IN A LIBRARY                    00680006
.*    IQUERY AN INVENTORY LIST OF A LIBRARY                             00690006
.*    LQUERY THE OPERATIONAL STATE OF A LIBRARY                         00700006
.*    SETVCAT A NEW CATEGORY TO A VOLUME                                00710006
.*    MINVENT MANAGES AN INVENTORY LIST OF A LIBRARY                    00720006
.*    EXPORT FILES ON VTS                                               00721016
.*    IMPORT FILES ON VTS                                               00722016
.*                                                                      00730006
.*  THE CUU OPERAND PROVIDES THE ADDRESS OF THE CUU OF THE DEVICE       00740006
.*                                                                      00750006
.*  THE VOLSER OPERAND SPECIFIES THE 6 BYTES VOLUME SERIAL NUMBER       00760006
.*                                                                      00770006
.*  THE WRITE OPERAND SPECIFIES WHETHER THE MOUNT IS FOR                00780006
.*  READ WRITE (=YES) OR READ ONLY (=NO) 5.IF NOT SPECIFIED THEN        00790006
.*  WRITE=NO IS ASSUMED.                                                00800006
.*                                                                      00810006
.*  THE ECB OPERAND SPECIFIES THE ADDRESS OF THE ECB TO BE POSTED AFTER 00820006
.*  MOUNT, QUERY, RELEASE OR CANCEL.                                    00830006
.*                                                                      00840006
.*  THE SERVL OPERAND SPECIFIES THE ADDRESS OF AN AREA, WHERE RETRUN    00850006
.*  INFORMATION FOR RECEIVE REQUESTS IS STORED                          00860006
.*                                                                      00870006
.*  THE LIBNAME OPERAND SPECIFIES THE 8 BYTE LIBRARY NAME               00880006
.*                                                                      00890006
.*  THE SRCCAT OPERAND SPECIFIES THE 10 BYTE SOURCE CATEGORY NAME       00900006
.*                                                                      00910006
.*  THE TGTCAT OPERAND SPECIFIES THE 10 BYTE TARGET CATEGORY NAME       00920006
.*                                                                      00930006
.*  THE MEMNAME OPERAND SPECIFIES THE 8 BYTE LIBR MEMBER NAME           00940006
.*                                                                      00950006
.*  THE LIST OPERAND SPECIFIES THE MAX 6 X 10 BYTES SERIAL NUMBERS OF   00951033
.*  THE VOLUMES TO BE EXPORTED/IMPORTED                                 00951133
.*                                                         @D68KDAK     00952016
.********************************************************************** 00960006
.*                                                                      00970006
&WREG1   SETA  0              WORK REGISTER = R0                        00980006
&RETREG  SETA  14             RETURN REGISTER = R14                     00990006
&BRREG   SETA  15             BRANCH REGISTER = R15                     01000006
&BASEREG SETA  1              SERVL BASE = R1                           01010006
&SAVREG  SETA  13             USER'S SAVE AREA = R13                    01020006
&TEMP1   SETC  '0'            TEMP REGISTER                             01030006
&TEMP2   SETC  '0'            TEMP REGISTER                             01040006
&TEMP3   SETC  '0'            TEMP REGISTER                             01050006
&TEMP4   SETC  '0'            TEMP REGISTER                             01060006
&TEMP5   SETC  '0'            TEMP REGISTER                             01070006
&TEMP6   SETC  '0'            TEMP REGISTER                             01080006
&TEMP7   SETC  '0'            TEMP REGISTER                             01090006
&TEMP8   SETC  '0'            TEMP REGISTER                             01100006
&TEMP9   SETC  '0'            TEMP REGISTER                             01110006
&TEMPA   SETC  '0'            TEMP REGISTER                             01111022
&ERROR   SETA  0              NO ERRORS                                 01120006
&L1      SETC  'LBSP&SYSNDX'  BRANCH TO IJJTLIB                         01130006
&L2      SETC  'LBSR&SYSNDX'  BRANCH OVER IJJTLIB                       01140006
.*                                                                      01150006
.* -------------------------------------------------------------------- 01160006
.*       M A C R O  L A B E L                                           01170006
.* -------------------------------------------------------------------- 01180006
.*                                                                      01190006
         AIF   ('&NAME' EQ '').NEXT                                     01200006
&NAME    DC    0H'0'                                                    01210006
.NEXT    ANOP                                                           01220006
.CHECK   AIF   ('&FUNC' EQ 'MOUNT').MOUNT                               01230006
         AIF   ('&FUNC' EQ 'AQUERY').AQUERY                             01240006
         AIF   ('&FUNC' EQ 'SQUERY').SQUERY                             01250006
         AIF   ('&FUNC' EQ 'RELEASE').RELEASE                           01260006
         AIF   ('&FUNC' EQ 'CANCEL').CANCEL                             01270006
         AIF   ('&FUNC' EQ 'RECEIVE').RECEIVE                           01280006
         AIF   ('&FUNC' EQ 'EJECT').EJECT                               01290006
         AIF   ('&FUNC' EQ 'CMOUNT').CMOUNT                             01300006
         AIF   ('&FUNC' EQ 'CQUERY').CQUERY                             01310006
         AIF   ('&FUNC' EQ 'DQUERY').DQUERY                             01320006
         AIF   ('&FUNC' EQ 'IQUERY').IQUERY                             01330006
         AIF   ('&FUNC' EQ 'LQUERY').LQUERY                             01340006
         AIF   ('&FUNC' EQ 'SETVCAT').SETVCAT                           01350006
         AIF   ('&FUNC' EQ 'MINVENT').MINVENT                           01360006
         AIF   ('&FUNC' EQ 'EXPORT').EXPORT                             01361016
         AIF   ('&FUNC' EQ 'IMPORT').IMPORT                             01362016
         MNOTE 8,'FUNC=&FUNC IS INVALID'                                01370006
&ERROR   SETA  &ERROR+8                                                 01380006
         AGO   .WRI0                                                    01390006
.*                                                                      01400006
.* -------------------------------------------------------------------- 01410006
.*       "EJECT"    P R O C E S S I N G                                 01420006
.* -------------------------------------------------------------------- 01430006
.*                                                                      01440006
.EJECT   ANOP                                                           01450006
&FCODE   SETC  'EV'                                                     01460006
&FCOD1   SETA  197                                                      01470006
&FCOD2   SETA  229                                                      01480006
         AGO   .WRI0                                                    01490006
.*                                                                      01500006
.* -------------------------------------------------------------------- 01510006
.*       "RECEIVE"  P R O C E S S I N G                                 01520006
.* -------------------------------------------------------------------- 01530006
.*                                                                      01540006
.RECEIVE ANOP                                                           01550006
&FCODE   SETC  'RE'                                                     01560006
&FCOD1   SETA  217                                                      01570006
&FCOD2   SETA  197                                                      01580006
         AGO   .WRI0                                                    01590006
.*                                                                      01600006
.* -------------------------------------------------------------------- 01610006
.*       "RELEASE"  P R O C E S S I N G                                 01620006
.* -------------------------------------------------------------------- 01630006
.*                                                                      01640006
.RELEASE ANOP                                                           01650006
&FCODE   SETC  'RD'                                                     01660006
&FCOD1   SETA  217                                                      01670006
&FCOD2   SETA  196                                                      01680006
         AGO   .WRI0                                                    01690006
.*                                                                      01700006
.* -------------------------------------------------------------------- 01710006
.*       "CANCEL"   P R O C E S S I N G                                 01720006
.* -------------------------------------------------------------------- 01730006
.*                                                                      01740006
.CANCEL  ANOP                                                           01750006
&FCODE   SETC  'CR'                                                     01760006
&FCOD1   SETA  195                                                      01770006
&FCOD2   SETA  217                                                      01780006
         AGO   .WRI0                                                    01790006
.*                                                                      01800006
.* -------------------------------------------------------------------- 01810006
.*       "SQUERY"    P R O C E S S I N G                                01820006
.* -------------------------------------------------------------------- 01830006
.*                                                                      01840006
.SQUERY  ANOP                                                           01850006
&FCODE   SETC  'QS'                                                     01860006
&FCOD1   SETA  216                                                      01870006
&FCOD2   SETA  226                                                      01880006
         AGO   .WRI0                                                    01890006
.*                                                                      01900006
.* -------------------------------------------------------------------- 01910006
.*       "AQUERY"    P R O C E S S I N G                                01920006
.* -------------------------------------------------------------------- 01930006
.*                                                                      01940006
.AQUERY  ANOP                                                           01950006
&FCODE   SETC  'QA'                                                     01960006
&FCOD1   SETA  216                                                      01970006
&FCOD2   SETA  193                                                      01980006
         AGO   .WRI0                                                    01990006
.*                                                                      02000006
.* -------------------------------------------------------------------- 02010006
.*       "MOUNT"    P R O C E S S I N G                                 02020006
.* -------------------------------------------------------------------- 02030006
.*                                                                      02040006
.MOUNT   ANOP                                                           02050006
&FCODE   SETC  'MV'                                                     02060006
&FCOD1   SETA  212                                                      02070006
&FCOD2   SETA  229                                                      02080006
         AGO   .WRI0                                                    02090006
.*                                                                      02100006
.* -------------------------------------------------------------------- 02110006
.*       "CMOUNT"    P R O C E S S I N G                                02120006
.* -------------------------------------------------------------------- 02130006
.*                                                                      02140006
.CMOUNT  ANOP                                                           02150006
&FCODE   SETC  'MC'                                                     02160006
&FCOD1   SETA  212                                                      02170006
&FCOD2   SETA  195                                                      02180006
         AGO   .WRI0                                                    02190006
.*                                                                      02200006
.* -------------------------------------------------------------------- 02210006
.*       "CQUERY"    P R O C E S S I N G                                02220006
.* -------------------------------------------------------------------- 02230006
.*                                                                      02240006
.CQUERY  ANOP                                                           02250006
&FCODE   SETC  'QC'                                                     02260006
&FCOD1   SETA  216                                                      02270006
&FCOD2   SETA  195                                                      02280006
         AGO   .WRI0                                                    02290006
.*                                                                      02300006
.* -------------------------------------------------------------------- 02310006
.*       "DQUERY"    P R O C E S S I N G                                02320006
.* -------------------------------------------------------------------- 02330006
.*                                                                      02340006
.DQUERY  ANOP                                                           02350006
&FCODE   SETC  'QD'                                                     02360006
&FCOD1   SETA  216                                                      02370006
&FCOD2   SETA  196                                                      02380006
         AGO   .WRI0                                                    02390006
.*                                                                      02400006
.* -------------------------------------------------------------------- 02410006
.*       "IQUERY"    P R O C E S S I N G                                02420006
.* -------------------------------------------------------------------- 02430006
.*                                                                      02440006
.LQUERY  ANOP                                                           02450006
&FCODE   SETC  'QL'                                                     02460006
&FCOD1   SETA  216                                                      02470006
&FCOD2   SETA  211                                                      02480006
         AGO   .WRI0                                                    02490006
.*                                                                      02500006
.* -------------------------------------------------------------------- 02510006
.*       "LQUERY"    P R O C E S S I N G                                02520006
.* -------------------------------------------------------------------- 02530006
.*                                                                      02540006
.IQUERY  ANOP                                                           02550006
&FCODE   SETC  'QI'                                                     02560006
&FCOD1   SETA  216                                                      02570006
&FCOD2   SETA  201                                                      02580006
         AGO   .WRI0                                                    02590006
.*                                                                      02600006
.* -------------------------------------------------------------------- 02610006
.*       "SETVCAT"    P R O C E S S I N G                               02620006
.* -------------------------------------------------------------------- 02630006
.*                                                                      02640006
.SETVCAT ANOP                                                           02650006
&FCODE   SETC  'SV'                                                     02660006
&FCOD1   SETA  226                                                      02670006
&FCOD2   SETA  229                                                      02680006
         AGO   .WRI0                                                    02690006
.*                                                                      02700006
.* -------------------------------------------------------------------- 02710006
.*       "MINVENT"    P R O C E S S I N G                               02720006
.* -------------------------------------------------------------------- 02730006
.*                                                                      02740006
.MINVENT ANOP                                                           02750006
&FCODE   SETC  'MI'                                                     02760006
&FCOD1   SETA  212                                                      02770006
&FCOD2   SETA  201                                                      02780006
         AGO   .WRI0                                                    02790006
.*                                                                      02791017
.* -------------------------------------------------------------------- 02792017
.*       "EXPORT "    P R O C E S S I N G                     @D68KDAK  02793017
.* -------------------------------------------------------------------- 02794017
.*                                                                      02795017
.EXPORT  ANOP                                                           02796017
&FCODE   SETC  'EX'                                                     02797017
&FCOD1   SETA  197                                                      02798017
&FCOD2   SETA  231                                                      02799017
         AGO   .WRI0                                                    02799117
.*                                                                      02799217
.* -------------------------------------------------------------------- 02799317
.*       "IMPORT "    P R O C E S S I N G                     @D68KDAK  02799417
.* -------------------------------------------------------------------- 02799517
.*                                                                      02799617
.IMPORT  ANOP                                                           02799717
&FCODE   SETC  'IM'                                                     02799817
&FCOD1   SETA  201                                                      02799917
&FCOD2   SETA  212                                                      02800017
         AGO   .WRI0                                                    02800117
.*                                                                      02801006
.* -------------------------------------------------------------------- 02810006
.*       C H E C K   P A R A M E T E R S                                02820006
.* -------------------------------------------------------------------- 02830006
.*                                                                      02840006
.* WRITE PARAMETER ---------------------------------------------------- 02850006
.WRI0    AIF   ('&FCODE' EQ 'MV').WRI2                                  02860006
         AIF   ('&FCODE' EQ 'MC').WRI2                                  02870006
         AIF   ('&WRITE' EQ '').CUU0                                    02880006
         MNOTE 4,'WRITE PARAMETER IGNORED'                              02890006
         AGO   .CUU0                                                    02900006
.WRI2    AIF   ('&WRITE' NE '').WRI4                                    02910006
         MNOTE 8,'WRITE PARAMETER IS MISSING'                           02920006
&ERROR   SETA  &ERROR+8                                                 02930006
         AGO   .CUU0                                                    02940006
.WRI4    AIF   ('&WRITE'(1,1) NE '(').CUU0                              02950006
         AIF   ('&WRITE'(K'&WRITE,1) EQ ')').WRI5                       02960006
         MNOTE 8,'&WRITE WRONG REGISTER NOTATION'                       02970006
&ERROR   SETA  &ERROR+8                                                 02980006
         AGO   .CUU0                                                    02990006
.WRI5    ANOP                                                           03000006
&TEMP6   SETC  '&WRITE'(2,K'&WRITE-2)                                   03010006
.* CUU PARAMETER ------------------------------------------------------ 03020006
.CUU0    AIF   ('&FCODE' EQ 'MV').CUU2                                  03030006
         AIF   ('&FCODE' EQ 'RD').CUU2                                  03040006
         AIF   ('&FCODE' EQ 'MC').CUU2                                  03050006
         AIF   ('&FCODE' EQ 'QD').CUU2                                  03060006
         AIF   ('&FCODE' EQ 'QS').CUU3                                  03070006
         AIF   ('&FCODE' EQ 'EX').CUU2                        @D68DDAK  03071030
         AIF   ('&FCODE' EQ 'IM').CUU2                        @D68DDAK  03072030
         AIF   ('&CUU' EQ '').LIB0                                      03080006
         MNOTE 4,'CUU PARAMETER IGNORED'                                03090006
         AGO   .LIB0                                                    03100006
.CUU2    AIF   ('&CUU' NE '').CUU4                                      03110006
         MNOTE 8,'CUU PARAMETER IS MISSING'                             03120006
&ERROR   SETA  &ERROR+8                                                 03130006
         AGO   .LIB0                                                    03140006
.CUU3    AIF   ('&CUU' EQ '').LIB0                                      03150006
.CUU4    AIF   ('&CUU'(1,1) NE '(').LIB0                                03160006
         AIF   ('&CUU'(K'&CUU,1) EQ ')').CUU5                           03170006
         MNOTE 8,'&CUU WRONG REGISTER NOTATION'                         03180006
&ERROR   SETA  &ERROR+8                                                 03190006
         AGO   .LIB0                                                    03200006
.CUU5    ANOP                                                           03210006
&TEMP2   SETC  '&CUU'(2,K'&CUU-2)                                       03220006
.* LIBNAME PARAMETER -------------------------------------------------- 03230006
.LIB0    AIF   ('&FCODE' EQ 'QS').LIB2                                  03240006
         AIF   ('&FCODE' EQ 'QA').LIB2                                  03250006
         AIF   ('&FCODE' EQ 'MV').LIB2                                  03260006
         AIF   ('&FCODE' EQ 'EV').LIB2                                  03270006
         AIF   ('&FCODE' EQ 'MC').LIB2                                  03280006
         AIF   ('&FCODE' EQ 'QC').LIB2                                  03290006
         AIF   ('&FCODE' EQ 'QI').LIB2                                  03300006
         AIF   ('&FCODE' EQ 'QL').LIB2                                  03310006
         AIF   ('&FCODE' EQ 'SV').LIB2                                  03320006
         AIF   ('&FCODE' EQ 'MI').LIB2                                  03330006
         AIF   ('&LIBNAME' EQ '').VOL0                                  03340006
         MNOTE 4,'LIBNAME PARAMETER IGNORED'                            03350006
         AGO   .VOL0                                                    03360006
.LIB2    AIF   ('&LIBNAME' NE '').LIB4                                  03370006
         MNOTE 8,'LIBNAME PARAMETER IS MISSING'                         03380006
&ERROR   SETA  &ERROR+8                                                 03390006
         AGO   .VOL0                                                    03400006
.LIB4    AIF   ('&LIBNAME'(1,1) NE '(').VOL0                            03410006
         AIF   ('&LIBNAME'(K'&LIBNAME,1) EQ ')').LIB5                   03420006
         MNOTE 8,'&LIBNAME WRONG REGISTER NOTATION'                     03430006
&ERROR   SETA  &ERROR+8                                                 03440006
         AGO   .VOL0                                                    03450006
.LIB5    ANOP                                                           03460006
&TEMP5   SETC  '&LIBNAME'(2,K'&LIBNAME-2)                               03470006
.* VOLSER PARAMETER --------------------------------------------------- 03480006
.VOL0    AIF   ('&FCODE' EQ 'MV').VOL2                                  03490006
         AIF   ('&FCODE' EQ 'QS').VOL2                                  03500006
         AIF   ('&FCODE' EQ 'QA').VOL2                                  03510006
         AIF   ('&FCODE' EQ 'EV').VOL2                                  03520006
         AIF   ('&FCODE' EQ 'MC').VOL2                                  03530006
         AIF   ('&FCODE' EQ 'QD').VOL2                                  03540006
         AIF   ('&FCODE' EQ 'SV').VOL2                                  03550006
         AIF   ('&FCODE' EQ 'EX').VOL2                         @D68KDAK 03551019
         AIF   ('&FCODE' EQ 'IM').VOL2                         @D68KDAK 03552019
         AIF   ('&VOLSER' EQ '').SCT0                                   03560006
         MNOTE 4,'VOLSER PARAMETER IGNORED'                             03570006
         AGO   .SCT0                                                    03580006
.VOL2    AIF   ('&VOLSER' NE '').VOL4                                   03590006
         MNOTE 8,'VOLSER PARAMETER IS MISSING'                          03600006
&ERROR   SETA  &ERROR+8                                                 03610006
         AGO   .SCT0                                                    03620006
.VOL4    AIF   ('&VOLSER'(1,1) NE '(').SCT0                             03630006
         AIF   ('&VOLSER'(K'&VOLSER,1) EQ ')').VOL5                     03640006
         MNOTE 8,'&VOLSER WRONG REGISTER NOTATION'                      03650006
&ERROR   SETA  &ERROR+8                                                 03660006
         AGO   .SCT0                                                    03670006
.VOL5    ANOP                                                           03680006
&TEMP1   SETC  '&VOLSER'(2,K'&VOLSER-2)                                 03690006
.* SRCCAT PARAMETER --------------------------------------------------- 03700006
.SCT0    AIF   ('&FCODE' EQ 'MC').SCT2                                  03710006
         AIF   ('&FCODE' EQ 'QA').SCT2                                  03720006
         AIF   ('&FCODE' EQ 'QS').SCT2                                  03730006
         AIF   ('&FCODE' EQ 'QI').SCT2                                  03740006
         AIF   ('&FCODE' EQ 'QD').SCT2                                  03750006
         AIF   ('&FCODE' EQ 'QC').SCT2                                  03760006
         AIF   ('&FCODE' EQ 'SV').SCT2                                  03770006
         AIF   ('&FCODE' EQ 'MI').SCT2                                  03780006
         AIF   ('&SRCCAT' EQ '').TCT0                                   03790006
         MNOTE 4,'SRCCAT PARAMETER IGNORED'                             03800006
         AGO   .TCT0                                                    03810006
.SCT2    AIF   ('&SRCCAT' NE '').SCT4                                   03820006
         MNOTE 8,'SRCCAT PARAMETER IS MISSING'                          03830006
&ERROR   SETA  &ERROR+8                                                 03840006
         AGO   .TCT0                                                    03850006
.SCT4    AIF   ('&SRCCAT'(1,1) NE '(').TCT0                             03860006
         AIF   ('&SRCCAT'(K'&SRCCAT,1) EQ ')').SCT5                     03870006
         MNOTE 8,'&SRCCAT WRONG REGISTER NOTATION'                      03880006
&ERROR   SETA  &ERROR+8                                                 03890006
         AGO   .TCT0                                                    03900006
.SCT5    ANOP                                                           03910006
&TEMP7   SETC  '&SRCCAT'(2,K'&SRCCAT-2)                                 03920006
.* TGTCAT PARAMETER --------------------------------------------------- 03930006
.TCT0    AIF   ('&FCODE' EQ 'SV').TCT2                                  03940006
         AIF   ('&FCODE' EQ 'MV').TCT2                                  03950006
         AIF   ('&FCODE' EQ 'MC').TCT2                                  03960006
         AIF   ('&FCODE' EQ 'MI').TCT2                                  03970006
         AIF   ('&FCODE' EQ 'RD').TCT2                      @D68CDAK    03971015
         AIF   ('&TGTCAT' EQ '').MEM0                                   03980006
         MNOTE 4,'TGTCAT PARAMETER IGNORED'                             03990006
         AGO   .MEM0                                                    04000006
.TCT2    AIF   ('&TGTCAT' NE '').TCT4                                   04010006
         AIF   ('&FCODE' EQ 'RD').MEM0                      @D68CDAK    04011015
         MNOTE 8,'TGTCAT PARAMETER IS MISSING'                          04020006
&ERROR   SETA  &ERROR+8                                                 04030006
         AGO   .MEM0                                                    04040006
.TCT4    AIF   ('&TGTCAT'(1,1) NE '(').MEM0                             04050006
         AIF   ('&TGTCAT'(K'&TGTCAT,1) EQ ')').TCT5                     04060006
         MNOTE 8,'&TGTCAT WRONG REGISTER NOTATION'                      04070006
&ERROR   SETA  &ERROR+8                                                 04080006
         AGO   .MEM0                                                    04090006
.TCT5    ANOP                                                           04100006
&TEMP8   SETC  '&TGTCAT'(2,K'&TGTCAT-2)                                 04110006
.* MEMNAME PARAMETER -------------------------------------------------- 04120006
.MEM0    AIF   ('&FCODE' EQ 'MI').MEM2                                  04130006
         AIF   ('&FCODE' EQ 'SV').MEM2                         @D68CDAK 04140015
         AIF   ('&MEMNAME' EQ '').EVL0                                  04150029
         MNOTE 4,'MEMNAME PARAMETER IGNORED'                            04160006
         AGO   .EVL0                                                    04170029
.MEM2    AIF   ('&MEMNAME' NE '').MEM4                                  04180006
         AIF   ('&FCODE' EQ 'SV').EVL0                         @D68CDAK 04190029
         MNOTE 8,'MEMNAME PARAMETER IS MISSING'                         04200006
&ERROR   SETA  &ERROR+8                                                 04210006
         AGO   .EVL0                                                    04220029
.MEM4    AIF   ('&MEMNAME'(1,1) NE '(').EVL0                            04230029
         AIF   ('&MEMNAME'(K'&MEMNAME,1) EQ ')').MEM5                   04240006
         MNOTE 8,'&MEMNAME WRONG REGISTER NOTATION'                     04250006
&ERROR   SETA  &ERROR+8                                                 04260006
         AGO   .EVL0                                                    04270017
.MEM5    ANOP                                                           04280006
&TEMP9   SETC  '&MEMNAME'(2,K'&MEMNAME-2)                               04290006
.* LIST PARAMETER --------------------------------------------------    04291033
.EVL0    AIF   ('&FCODE' EQ 'EX').EVL2                         @D68KDAK 04292017
         AIF   ('&FCODE' EQ 'IM').EVL2                         @D68KDAK 04293017
         AGO   .ECB0                                                    04296017
.EVL2    AIF   ('&LIST' NE '').EVL4                                     04297033
         MNOTE 8,'LIST PARAMETER IS MISSING'                            04299033
&ERROR   SETA  &ERROR+8                                                 04299117
         AGO   .ECB0                                                    04299217
.EVL4    AIF   ('&LIST'(1,1) NE '(').ECB0                               04299333
         AIF   ('&LIST'(K'&LIST,1) EQ ')').EVL5                         04299433
         MNOTE 8,'&LIST WRONG REGISTER NOTATION'                        04299533
&ERROR   SETA  &ERROR+8                                                 04299617
         AGO   .ECB0                                                    04299717
.EVL5    ANOP                                                           04299817
&TEMPA   SETC  '&LIST'(2,K'&LIST-2)                                     04299933
.* ECB PARAMETER ------------------------------------------------------ 04300006
.ECB0    AIF   ('&FCODE' EQ 'CR').ECB1                                  04310006
         AIF   ('&FCODE' NE 'RE').ECB2                                  04320006
.ECB1    AIF   ('&ECB' EQ '').SER0                                      04330006
         MNOTE 4,'ECB PARAMETER IGNORED'                                04340006
         AGO   .SER0                                                    04350006
.ECB2    AIF   ('&ECB' NE '').ECB4                                      04360006
         MNOTE 8,'ECB PARAMETER IS MISSING'                             04370006
&ERROR   SETA  &ERROR+8                                                 04380006
         AGO   .SER0                                                    04390006
.ECB4    AIF   ('&ECB'(1,1) NE '(').SER0                                04400006
         AIF   ('&ECB'(K'&ECB,1) EQ ')').ECB5                           04410006
         MNOTE 8,'&ECB WRONG REGISTER NOTATION'                         04420006
&ERROR   SETA  &ERROR+8                                                 04430006
         AGO   .SER0                                                    04440006
.ECB5    ANOP                                                           04450006
&TEMP3   SETC  '&ECB'(2,K'&ECB-2)                                       04460006
.* SERVL PARAMETER ---------------------------------------------------- 04470006
.SER0    AIF   ('&SERVL' NE '').SER4                                    04480006
         MNOTE 8,'SERVL PARAMETER IS MISSING'                           04490006
&ERROR   SETA  &ERROR+8                                                 04500006
         AGO   .GEN0                                                    04510006
.SER4    AIF   ('&SERVL'(1,1) NE '(').GEN0                              04520006
         AIF   ('&SERVL'(K'&SERVL,1) EQ ')').SER5                       04530006
         MNOTE 8,'&SERVL WRONG REGISTER NOTATION'                       04540006
&ERROR   SETA  &ERROR+8                                                 04550006
         AGO   .GEN0                                                    04560006
.SER5    ANOP                                                           04570006
&TEMP4   SETC  '&SERVL'(2,K'&SERVL-2)                                   04580006
.*                                                                      04590006
.* -------------------------------------------------------------------- 04600006
.*       G E N E R A T E   A S S E M B L E R   C O D E .                04610006
.* -------------------------------------------------------------------- 04620006
.*                                                                      04630006
.GEN0    ANOP                                                           04640006
         AIF ('&ERROR' GT '0').MEND                                     04650006
         AIF   ('&SERVL'(1,1) EQ '(').GEN2                              04660006
         LA    &BASEREG,&SERVL               GET SERVL ADDRESS @D61ADMK 04670006
         AGO   .GEN4                                                    04680006
.GEN2    AIF   ('&BASEREG' EQ '&TEMP4').GEN4                            04690006
         LR    &BASEREG,&TEMP4               GET SERVL ADDRESS @D61ADMK 04700006
.*                                                                      04710006
.* -------------------------------------------------------------------- 04720006
.*       M O V E   I N P U T   P A R A M E T E R S                      04730006
.* -------------------------------------------------------------------- 04740006
.*                                                                      04750006
.GEN4    ANOP                                                           04760006
         ST    &BASEREG,24(,&SAVREG)        SAVE SERVL ADDRESS @D61ADMK 04770006
         MVI   IJJLTIDN-IJJLBSER(&BASEREG),0     VERS NUMBER 0 @D61ADMK 04780006
         MVI   IJJLTIDN+1-IJJLBSER(&BASEREG),2   VERS NUMBER 2 @D61ADMK 04790006
         MVI   IJJLFREQ-IJJLBSER(&BASEREG),&FCOD1     SET FUNC @D61ADMK 04800006
         MVI   IJJLFREQ+1-IJJLBSER(&BASEREG),&FCOD2   SET FUNC @D61ADMK 04810006
         AIF   ('&FCODE' EQ 'RE').GEN40                                 04820006
         AIF   ('&FCODE' NE 'CR').GEN6                                  04830006
         XC    IJJLFRWF-IJJLBSER(4,&BASEREG),IJJLFRWF-IJJLBSER(&BASEREG*04840006
               )                                         CLEAR @D61ADMK 04850006
         XC    IJJLFVOL-IJJLBSER(4,&BASEREG),IJJLFVOL-IJJLBSER(&BASEREG*04860006
               )                                         CLEAR @D61ADMK 04870006
         XC    IJJLFLBN-IJJLBSER(IJJLTRST-IJJLFLBN,&BASEREG),IJJLFLBN-I*04880006
               JJLBSER(&BASEREG)                         CLEAR @D61ADMK 04890006
         AGO   .GEN61                                                   04900006
.GEN6    XC    IJJLFRWF-IJJLBSER(IJJLTRST-IJJLFRWF,&BASEREG),IJJLFRWF-I*04910006
               JJLBSER(&BASEREG)                         CLEAR @D61ADMK 04920006
.GEN61   LA    &WREG1,IJJLTRST-IJJLBSER(,&BASEREG) INT PART AD @D61ADMK 04930006
         ST    &WREG1,IJJLFPIP-IJJLBSER(,&BASEREG) INT PART AD @D61ADMK 04940006
         AIF   ('&FCODE' EQ 'CR').GEN40                                 04950006
.* WRITE PARAMETER ---------------------------------------------------- 04960006
         AIF   ('&FCODE' EQ 'MV').GEN7                                  04970006
         AIF   ('&FCODE' EQ 'MC').GEN7                                  04980006
         AGO   .GEN10                                                   04990006
.GEN7    AIF   ('&WRITE'(1,1) EQ '(').GEN8                              05000006
&TEMP6   SETC  '&WREG1'                                                 05010006
         LA    &TEMP6,&WRITE            GET READ/WRITE ADDRESS @D61ADMK 05020006
.GEN8    ST    &TEMP6,IJJLFRWF-IJJLBSER(,&BASEREG)  READ/WRITE @D61ADMK 05030006
.* VOLSER PARAMETER --------------------------------------------------- 05040006
.GEN10   AIF   ('&FCODE' EQ 'RD').GEN14                                 05050006
         AIF   ('&FCODE' EQ 'QC').GEN14                                 05060006
         AIF   ('&FCODE' EQ 'QI').GEN14                                 05070006
         AIF   ('&FCODE' EQ 'QL').GEN14                                 05080006
         AIF   ('&FCODE' EQ 'MI').GEN14                                 05090006
         AIF   ('&VOLSER'(1,1) EQ '(').GEN12                            05100006
&TEMP1   SETC  '&WREG1'                                                 05110006
         LA    &TEMP1,&VOLSER               GET VOLSER ADDRESS @D61ADMK 05120006
.GEN12   ST    &TEMP1,IJJLFVOL-IJJLBSER(,&BASEREG)      VOLSER @D61ADMK 05130006
.* CUU PARAMETER ------------------------------------------------------ 05140006
.GEN14   AIF   ('&FCODE' NE 'QS').GEN15                                 05150006
         AIF   ('&CUU' EQ '').GEN18                                     05160006
.GEN15   AIF   ('&FCODE' EQ 'QA').GEN18                                 05170006
         AIF   ('&FCODE' EQ 'EV').GEN18                                 05180006
         AIF   ('&FCODE' EQ 'QC').GEN18                                 05190006
         AIF   ('&FCODE' EQ 'QI').GEN18                                 05200006
         AIF   ('&FCODE' EQ 'QL').GEN18                                 05210006
         AIF   ('&FCODE' EQ 'SV').GEN18                                 05220006
         AIF   ('&FCODE' EQ 'MI').GEN18                                 05230006
         AIF   ('&CUU'(1,1) EQ '(').GEN16                               05240006
&TEMP2   SETC  '&WREG1'                                                 05250006
         LA    &TEMP2,&CUU                     GET CUU ADDRESS @D61ADMK 05260006
.GEN16   ST    &TEMP2,IJJLFCUU-IJJLBSER(,&BASEREG)         CUU @D61ADMK 05270006
.* ECB PARAMETER ------------------------------------------------------ 05280006
.GEN18   AIF   ('&ECB'(1,1) EQ '(').GEN20                               05290006
&TEMP3   SETC  '&WREG1'                                                 05300006
         LA    &TEMP3,&ECB                     GET ECB ADDRESS @D61ADMK 05310006
.GEN20   ST    &TEMP3,IJJLFECB-IJJLBSER(,&BASEREG)         ECB @D61ADMK 05320006
.* LIBNAME PARAMETER -------------------------------------------------- 05330006
.GEN22   AIF   ('&FCODE' EQ 'RD').GEN30                        @D68CDAK 05340015
         AIF   ('&FCODE' EQ 'QD').GEN26                                 05350006
         AIF   ('&LIBNAME' EQ '').GEN26                                 05360006
         AIF   ('&LIBNAME'(1,1) EQ '(').GEN24                           05370006
&TEMP5   SETC  '&WREG1'                                                 05380006
         LA    &TEMP5,&LIBNAME             GET LIBNAME ADDRESS @D61ADMK 05390006
.GEN24   ST    &TEMP5,IJJLFLBN-IJJLBSER(,&BASEREG)     LIBNAME @D61ADMK 05400006
.* SRCCAT PARAMETER --------------------------------------------------- 05410006
.GEN26   AIF   ('&FCODE' EQ 'MV').GEN30                                 05420006
         AIF   ('&FCODE' EQ 'EV').GEN40                                 05430006
         AIF   ('&FCODE' EQ 'QL').GEN40                                 05440006
         AIF   ('&SRCCAT' EQ '').GEN30                                  05450006
         AIF   ('&SRCCAT'(1,1) EQ '(').GEN28                            05460006
&TEMP7   SETC  '&WREG1'                                                 05470006
         LA    &TEMP7,&SRCCAT               GET SRCCAT ADDRESS @D61ADMK 05480006
.GEN28   ST    &TEMP7,IJJLFSCT-IJJLBSER(,&BASEREG)      SRCCAT @D61ADMK 05490006
.* TGTCAT PARAMETER --------------------------------------------------- 05500006
.GEN30   AIF   ('&FCODE' EQ 'QA').GEN40                                 05510006
         AIF   ('&FCODE' EQ 'QS').GEN40                                 05520006
         AIF   ('&FCODE' EQ 'QC').GEN40                                 05530006
         AIF   ('&FCODE' EQ 'QD').GEN40                                 05540006
         AIF   ('&FCODE' EQ 'QI').GEN40                                 05550006
         AIF   ('&FCODE' EQ 'EX').GEN40                        @D68CDAK 05551021
         AIF   ('&FCODE' EQ 'IM').GEN40                        @D68CDAK 05552021
         AIF   ('&TGTCAT' EQ '').GEN34                                  05560006
         AIF   ('&TGTCAT'(1,1) EQ '(').GEN32                            05570006
&TEMP8   SETC  '&WREG1'                                                 05580006
         LA    &TEMP8,&TGTCAT               GET TGTCAT ADDRESS @D61ADMK 05590006
.GEN32   ST    &TEMP8,IJJLFTCT-IJJLBSER(,&BASEREG)      TGTCAT @D61ADMK 05600006
.* MEMNAME PARAMETER -------------------------------------------------- 05610006
.GEN34   AIF   ('&FCODE' NE 'SV').GEN35                       @D68CDAK  05620015
         AIF   ('&MEMNAME' NE '').GEN37                       @D68CDAK  05630015
.GEN35   AIF   ('&FCODE' NE 'MI').GEN40                       @D68CDAK  05640015
.GEN37   AIF   ('&MEMNAME'(1,1) EQ '(').GEN36                 @D68CDAK  05650015
&TEMP9   SETC  '&WREG1'                                                 05660006
         LA    &TEMP9,&MEMNAME             GET MEMNAME ADDRESS @D61ADMK 05670006
.GEN36   ST    &TEMP9,IJJLFMEM-IJJLBSER(,&BASEREG)     MEMNAME @D61ADMK 05680006
.GEN40   ANOP                                                           05690006
.*                                                                      05700006
.* LIST    PARAMETER -------------------------------------------------- 05701033
.GEN41   AIF   ('&FCODE' EQ 'EX').GEN42                       @D68KDAK  05702017
         AIF   ('&FCODE' NE 'IM').GEN44                       @D68KDAK  05704024
.GEN42   AIF   ('&LIST'(1,1) EQ '(').GEN43                    @D68KDAK  05705033
&TEMPA   SETC  '&WREG1'                                                 05706028
         LA    &TEMPA,&LIST                GET LIST    ADDRESS @D68KDAK 05707033
.GEN43   ST    &TEMPA,IJJLFEVL-IJJLBSER(,&BASEREG)     LIST    @D68KDAK 05708033
.GEN44   ANOP                                                           05709024
.* -------------------------------------------------------------------- 05710006
.*       E X E C U T E   R E Q U E S T                                  05720006
.* -------------------------------------------------------------------- 05730006
.*                                                                      05740006
         CDLOAD IJJTLIB,RETPNF=YES,SVA=YES                     @D61ADMK 05750006
         LTR   15,15                               SUCCESSFUL? @D61ADMK 05760006
         BZ    &L1                        YES, SETUP REGISTERS @D61ADMK 05770006
         L     &BASEREG,24(,&SAVREG)            GET SERVL BASE @D61ADMK 05780006
         MVI   IJJLTRET-IJJLBSER(&BASEREG),240   RETURN CODE 0 @D61ADMK 05790006
         MVI   IJJLTRET+1-IJJLBSER(&BASEREG),240 RETURN CODE 0 @D61ADMK 05800006
         MVI   IJJLTRET+2-IJJLBSER(&BASEREG),240 RETURN CODE 0 @D61ADMK 05810006
         MVI   IJJLTRET+3-IJJLBSER(&BASEREG),248 RETURN CODE 8 @D61ADMK 05820006
         MVI   IJJLTREA-IJJLBSER(&BASEREG),246   REASON CODE 6 @D61ADMK 05830006
         MVI   IJJLTREA+1-IJJLBSER(&BASEREG),243 REASON CODE 3 @D61ADMK 05840006
         MVI   IJJLTREA+2-IJJLBSER(&BASEREG),240 REASON CODE 0 @D61ADMK 05850006
         MVI   IJJLTREA+3-IJJLBSER(&BASEREG),243 REASON CODE 3 @D61ADMK 05860006
         B     &L2                                DON'T BRANCH @D61ADMK 05870006
&L1      LR    &BRREG,1                  BASE ADDRESS OF PHASE @D61ADMK 05880006
         L     &BASEREG,24(,&SAVREG)     SERVL INTO REGISTER 1 @D61ADMK 05890006
         BALR  &RETREG,&BRREG                BRANCH TO ROUTINE @D61ADMK 05900006
&L2      DS    0H                             NEXT INSTRUCTION @D61ADMK 05910006
.MEND    MEND                                                           05920006
* END OF PLS COMMENT */ %MLBSERV : ;                                    05930006
*%LBSERV: MACRO KEYS(1:1(FUNC),0:1(CUU),0:1(VOLSER),0:1(ECB),           05940006
*                    1:1(SERVL),0:1(LIBNAME),0:1(WRITE),0:1(SRCCAT),    05950006
*                    0:1(TGTCAT),0:1(MEMNAME),0:1(LIST));               05960033
*DCL (          BASEREG,   /* BASE OF SERVICE LIST                  */  05970006
*               WREG1,     /* WORK REGISTER                         */  05980006
*               ERROR,     /* ERRORS DETECTED                       */  05990006
*               COLC,      /* COLUMN FOR COMMENTS                   */  06000006
*               WRT)       /* MOUNT FOR READ WRITE                  */  06010006
*FIXED;                                                                 06020006
*DCL (          FCODE,     /* FUNCTION CODE                         */  06030006
*               SAVREG,    /* USER'S SAVE AREA REGISTER             */  06040006
*               BRREG,     /* BRANCH REGISTER                       */  06050006
*               RETREG,    /* RETRUN REGISTER                       */  06060006
*               FCOD1,     /* FUNCTION CODE PART 1                  */  06070006
*               FCOD2,     /* FUNCTION CODE PART 1                  */  06080006
*               TEMP1,     /* WORK FOR REGISTER SPECIFICATION       */  06090006
*               TEMP2,     /* WORK FOR REGISTER SPECIFICATION       */  06100006
*               TEMP3,     /* WORK FOR REGISTER SPECIFICATION       */  06110006
*               TEMP4,     /* WORK FOR REGISTER SPECIFICATION       */  06120006
*               TEMP5,     /* WORK FOR REGISTER SPECIFICATION       */  06130006
*               TEMP6,     /* WORK FOR REGISTER SPECIFICATION       */  06140006
*               TEMP7,     /* WORK FOR REGISTER SPECIFICATION       */  06150006
*               TEMP8,     /* WORK FOR REGISTER SPECIFICATION       */  06160006
*               TEMP9,     /* WORK FOR REGISTER SPECIFICATION       */  06170006
*               TEMPA,     /* WORK FOR REGISTER SPECIFICATION       */  06171021
*               IN,        /* HEADER TEXT                           */  06180006
*               L1,        /* WORK FOR LABEL                        */  06190006
*               L2)        /* WORK FOR LABEL                        */  06200006
*CHAR;                                                                  06210006
*                                                                       06220006
*/*******************************************************************/  06230006
*/*                                                                 */  06240006
*/*        LICENSED MATERIALS - PROGRAM PROPERTY OF IBM             */  06250006
*/*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"              */  06260006
*/*        5686-066 (C) COPYRIGHT IBM CORP. 1995                    */  06270006
*/*       SEE COPYRIGHT INSTRUCTIONS                                */  06280006
*/*                                                                 */  06290006
*/*******************************************************************/  06300006
*/*-------------------------------------------------------------    */  06310006
*/* /* START OF SPECIFICATIONS *********************************    */  06320006
*/*01* MODULE TYPE = USER INTERFACE MACRO                           */  06330006
*/*                                                                 */  06340006
*/*01* DESCRIPTIVE NAME = ESTABLISH EXIT ROUTINE FOR I/O REQUEST    */  06350006
*/*                                                                 */  06360006
*/*01* NOTES = CHANGE ACTIVITY                                      */  06370006
*/*    NEW MODULE - FIRST RELEASE  ESA 2.1.0                        */  06380006
*/*    API EXTENSION                                                */  06390006
*/* A000000-999999                                                  */  06400006
*/*                                                                 */  06410006
*/**************************************************************    */  06420006
*/*                                                                 */  06430006
*/*  MACRO DESCRIPTION                                              */  06440006
*/*                                                                 */  06450006
*/* ARGUMENT LIST DESCRIPTION:                                      */  06460006
*/*                                                                 */  06470006
*/*  EIGHT POSITIONAL OPERANDS HAVE TO BE SPECIFIED.                */  06480006
*/*                                                                 */  06490006
*/*  THE FUNC OPERAND SPECIFIES                                     */  06500006
*/*    MOUNT OF A VOLUME ON A DEVICE IN THE LIBRARY                 */  06510006
*/*    SQUERY A VOLUME'S LOCATION (SINGLE QUERY)                    */  06520006
*/*    AQUERY A VOLUME'S LOCATION (ALL LIBRARIES)                   */  06530006
*/*    RELEASE A VOLUME ON A DEVICE IN A LIBRARY                    */  06540006
*/*    CANCEL THE PRIOR MOUNT REQUEST                               */  06550006
*/*    RECEIVE THE INFO IN SERVL (OUTPUT)                           */  06560006
*/*    EJECT A VOLUME FROM A LIBRARY                                */  06570006
*/*    CMOUNT A VOLUME OF A CATEGORY ON A DEVICE IN THE LIBRARY     */  06580006
*/*    CQUERY THE NUMBER OF VOLUMES IN A LIBRARY                    */  06590006
*/*    DQUERY THE STATUS OF A TAPE DRIVE IN A LIBRARY               */  06600006
*/*    IQUERY AN INVENTORY LIST OF A LIBRARY                        */  06610006
*/*    LQUERY THE OPERATIONAL STATE OF A LIBRARY                    */  06620006
*/*    SETVCAT A NEW CATEGORY TO A VOLUME                           */  06630006
*/*    MINVENT MANAGES AN INVENTORY LIST OF A LIBRARY               */  06640006
*/*    EXPORT FILES ON VTS                                          */  06641021
*/*    IMPORT FILES ON VTS                                          */  06642021
*/*                                                                 */  06650006
*/*  THE CUU OPERAND PROVIDES THE ADDRESS OF THE CUU OF THE DEVICE  */  06660006
*/*                                                                 */  06670006
*/*  THE VOLSER OPERAND SPECIFIES THE 6 BYTES VOLUME SERIAL NUMBER  */  06680006
*/*                                                                 */  06690006
*/*  THE WRITE OPERAND SPECIFIES WHETHER THE MOUNT IS FOR           */  06700006
*/*  READ WRITE (=YES) OR READ ONLY (=NO) 5.IF NOT SPECIFIED THEN   */  06710006
*/*  WRITE=NO IS ASSUMED.                                           */  06720006
*/*                                                                 */  06730006
*/*  THE ECB OPERAND SPECIFIES THE ADDRESS                          */  06740006
*/*  OF THE ECB TO BE POSTED AFTER                                  */  06750006
*/*  MOUNT, QUERY, RELEASE OR CANCEL.                               */  06760006
*/*                                                                 */  06770006
*/*  THE SERVL OPERAND SPECIFIES THE ADDRESS OF AN AREA, WHERE      */  06780006
*/*  RETURN INFORMATION FOR RECEIVE REQUESTS IS STORED              */  06790006
*/*                                                                 */  06800006
*/*  THE LIBNAME OPERAND SPECIFIES THE 8 BYTE LIBRARY NAME          */  06810006
*/*                                                                 */  06820006
*/*  THE SRCCAT OPERAND SPECIFIES THE 10 BYTE SOURCE CATEGORY NAME  */  06830006
*/*                                                                 */  06840006
*/*  THE TGTCAT OPERAND SPECIFIES THE 10 BYTE TARGET CATEGORY NAME  */  06850006
*/*                                                                 */  06860006
*/*  THE MEMNAME OPERAND SPECIFIES THE 8 BYTE LIBR MEMBER NAME      */  06870006
*/*                                                                 */  06880006
*/* THE LIST OPERAND SPECIFIES THE MAX 6 X 10 BYTES SERIAL NUMBER   */  06881033
*/* OF THE VOLUMES TO BE EXPORTED/IMPORTED                          */  06882033
*/*                                                                 */  06884021
*/*******************************************************************/  06890006
*/*                                                                 */  06900006
*WREG1   =      0;      /*    WORK REGISTER = R0                    */  06910006
*RETREG  =     'R14';   /*    RETURN REGISTER = R14                 */  06920006
*BRREG   =     'R15';   /*    BRANCH REGISTER = R15                 */  06930006
*BASEREG =     1;       /*    SERVL BASE = R1                       */  06940006
*SAVREG  =     'R13';   /*    USER'S SAVE AREA = R13                */  06950006
*TEMP1   =     '0';     /*    TEMP REGISTER                         */  06960006
*TEMP2   =     '0';     /*    TEMP REGISTER                         */  06970006
*TEMP3   =     '0';     /*    TEMP REGISTER                         */  06980006
*TEMP4   =     '0';     /*    TEMP REGISTER                         */  06990006
*TEMP5   =     '0';     /*    TEMP REGISTER                         */  07000006
*TEMP6   =     '0';     /*    TEMP REGISTER                         */  07010006
*TEMP7   =     '0';     /*    TEMP REGISTER                         */  07020006
*TEMP8   =     '0';     /*    TEMP REGISTER                         */  07030006
*TEMP9   =     '0';     /*    TEMP REGISTER                         */  07040006
*TEMPA   =     '0';     /*    TEMP REGISTER               @D68CDAK  */  07041021
*ERROR   =     0;       /*    NO ERRORS                             */  07050006
*COLC = MACLMAR + 35;   /*    COLUMN FOR COMMENTS                   */  07060006
*/*                                                                 */  07070006
*IN = MACLABEL || ' ' || MACNAME || ' ' || MACLIST || ' ' || MACKEYS;   07080006
*ANS (COMMENT(IN)) COL(MACLMAR) SKIP;                                   07090006
*IN =' LBSERV - 5686-066-06 - VERSION 96-10-10';                        07100006
*ANS (COMMENT(IN)) COL(MACLMAR) SKIP;                                   07110006
*/*-----------------------------------------------------------------*/  07120006
*/*      M A C R O  L A B E L                                       */  07130006
*/*-----------------------------------------------------------------*/  07140006
*/*                                                                 */  07150006
*IF   (NAME = '') THEN                                                 07160006
*   DO;                                                                 07170006
*   ANS(MACLABEL || ':') COL(MACLMAR);                                  07180006
*   END;                                                                07190006
*IF   (FUNC(1) = 'MOUNT') THEN                                          07200006
*   DO;                                                                 07210006
*/*                                                                 */  07220006
*/*-----------------------------------------------------------------*/  07230006
*/*      "MOUNT"    P R O C E S S I N G                             */  07240006
*/*-----------------------------------------------------------------*/  07250006
*/*                                                                 */  07260006
*   FCODE   =     'MV';                                                 07270006
*   FCOD1   =     '212';                                                07280006
*   FCOD2   =     '229';                                                07290006
*   GOTO WRI0;                                                          07300006
*   END;                                                                07310006
*IF   (FUNC(1) = 'AQUERY') THEN                                         07320006
*   DO;                                                                 07330006
*/*                                                                 */  07340006
*/*-----------------------------------------------------------------*/  07350006
*/*      "AQUERY"    P R O C E S S I N G                            */  07360006
*/*-----------------------------------------------------------------*/  07370006
*/*                                                                 */  07380006
*   FCODE   =     'QA';                                                 07390006
*   FCOD1   =     '216';                                                07400006
*   FCOD2   =     '193';                                                07410006
*   GOTO WRI0;                                                          07420006
*   END;                                                                07430006
*IF   (FUNC(1) =  'SQUERY') THEN                                        07440006
*   DO;                                                                 07450006
*/*                                                                 */  07460006
*/*-----------------------------------------------------------------*/  07470006
*/*      "SQUERY"    P R O C E S S I N G                            */  07480006
*/*-----------------------------------------------------------------*/  07490006
*/*                                                                 */  07500006
*   FCODE   =     'QS';                                                 07510006
*   FCOD1   =     '216';                                                07520006
*   FCOD2   =     '226';                                                07530006
*   GOTO WRI0;                                                          07540006
*   END;                                                                07550006
*IF   (FUNC(1) =  'RELEASE') THEN                                       07560006
*   DO;                                                                 07570006
*/*                                                                 */  07580006
*/*-----------------------------------------------------------------*/  07590006
*/*      "RELEASE"  P R O C E S S I N G                             */  07600006
*/*-----------------------------------------------------------------*/  07610006
*/*                                                                 */  07620006
*   FCODE   =     'RD';                                                 07630006
*   FCOD1   =     '217';                                                07640006
*   FCOD2   =     '196';                                                07650006
*   GOTO WRI0;                                                          07660006
*   END;                                                                07670006
*IF   (FUNC(1) =  'CANCEL') THEN                                        07680006
*   DO;                                                                 07690006
*/*                                                                 */  07700006
*/*-----------------------------------------------------------------*/  07710006
*/*      "CANCEL"   P R O C E S S I N G                             */  07720006
*/*-----------------------------------------------------------------*/  07730006
*/*                                                                 */  07740006
*   FCODE   =     'CR';                                                 07750006
*   FCOD1   =     '195';                                                07760006
*   FCOD2   =     '217';                                                07770006
*   GOTO WRI0;                                                          07780006
*   END;                                                                07790006
*IF   (FUNC(1) =  'RECEIVE') THEN                                       07800006
*   DO;                                                                 07810006
*/*                                                                 */  07820006
*/*-----------------------------------------------------------------*/  07830006
*/*      "RECEIVE"  P R O C E S S I N G                             */  07840006
*/*-----------------------------------------------------------------*/  07850006
*/*                                                                 */  07860006
*   FCODE   =     'RE';                                                 07870006
*   FCOD1   =     '217';                                                07880006
*   FCOD2   =     '197';                                                07890006
*   GOTO WRI0;                                                          07900006
*   END;                                                                07910006
*IF   (FUNC(1) =  'EJECT') THEN                                         07920006
*   DO;                                                                 07930006
*/*                                                                 */  07940006
*/*-----------------------------------------------------------------*/  07950006
*/*      "EJECT"    P R O C E S S I N G                             */  07960006
*/*-----------------------------------------------------------------*/  07970006
*/*                                                                 */  07980006
*   FCODE   =     'EV';                                                 07990006
*   FCOD1   =     '197';                                                08000006
*   FCOD2   =     '229';                                                08010006
*   GOTO WRI0;                                                          08020006
*   END;                                                                08030006
*IF   (FUNC(1) =  'CMOUNT') THEN                                        08040006
*   DO;                                                                 08050006
*/*                                                                 */  08060006
*/*-----------------------------------------------------------------*/  08070006
*/*      "CMOUNT"    P R O C E S S I N G                            */  08080006
*/*-----------------------------------------------------------------*/  08090006
*/*                                                                 */  08100006
*   FCODE   =     'MC';                                                 08110006
*   FCOD1   =     '212';                                                08120006
*   FCOD2   =     '195';                                                08130006
*   GOTO WRI0;                                                          08140006
*   END;                                                                08150006
*IF   (FUNC(1) =  'CQUERY') THEN                                        08160006
*   DO;                                                                 08170006
*/*                                                                 */  08180006
*/*-----------------------------------------------------------------*/  08190006
*/*      "CQUERY"    P R O C E S S I N G                            */  08200006
*/*-----------------------------------------------------------------*/  08210006
*/*                                                                 */  08220006
*   FCODE   =     'QC';                                                 08230006
*   FCOD1   =     '216';                                                08240006
*   FCOD2   =     '195';                                                08250006
*   GOTO WRI0;                                                          08260006
*   END;                                                                08270006
*IF   (FUNC(1) =  'DQUERY') THEN                                        08280006
*   DO;                                                                 08290006
*/*                                                                 */  08300006
*/*-----------------------------------------------------------------*/  08310006
*/*      "DQUERY"    P R O C E S S I N G                            */  08320006
*/*-----------------------------------------------------------------*/  08330006
*/*                                                                 */  08340006
*   FCODE   =     'QD';                                                 08350006
*   FCOD1   =     '216';                                                08360006
*   FCOD2   =     '196';                                                08370006
*   GOTO WRI0;                                                          08380006
*   END;                                                                08390006
*IF   (FUNC(1) =  'LQUERY') THEN                                        08400006
*   DO;                                                                 08410006
*/*                                                                 */  08420006
*/*-----------------------------------------------------------------*/  08430006
*/*      "LQUERY"    P R O C E S S I N G                            */  08440006
*/*-----------------------------------------------------------------*/  08450006
*/*                                                                 */  08460006
*   FCODE   =     'QL';                                                 08470006
*   FCOD1   =     '216';                                                08480006
*   FCOD2   =     '211';                                                08490006
*   GOTO WRI0;                                                          08500006
*   END;                                                                08510006
*IF   (FUNC(1) =  'IQUERY') THEN                                        08520006
*   DO;                                                                 08530006
*/*                                                                 */  08540006
*/*-----------------------------------------------------------------*/  08550006
*/*      "IQUERY"    P R O C E S S I N G                            */  08560006
*/*-----------------------------------------------------------------*/  08570006
*/*                                                                 */  08580006
*   FCODE   =     'QI';                                                 08590006
*   FCOD1   =     '216';                                                08600006
*   FCOD2   =     '201';                                                08610006
*   GOTO WRI0;                                                          08620006
*   END;                                                                08630006
*IF   (FUNC(1) =  'SETVCAT') THEN                                       08640006
*   DO;                                                                 08650006
*/*                                                                 */  08660006
*/*-----------------------------------------------------------------*/  08670006
*/*      "SETVCAT"    P R O C E S S I N G                           */  08680006
*/*-----------------------------------------------------------------*/  08690006
*/*                                                                 */  08700006
*   FCODE   =     'SV';                                                 08710006
*   FCOD1   =     '226';                                                08720006
*   FCOD2   =     '229';                                                08730006
*   GOTO WRI0;                                                          08740006
*   END;                                                                08750006
*IF   (FUNC(1) =  'MINVENT') THEN                                       08760006
*   DO;                                                                 08770006
*/*                                                                 */  08780006
*/*-----------------------------------------------------------------*/  08790006
*/*      "MINVENT"    P R O C E S S I N G                           */  08800006
*/*-----------------------------------------------------------------*/  08810006
*/*                                                                 */  08820006
*   FCODE   =     'MI';                                                 08830006
*   FCOD1   =     '212';                                                08840006
*   FCOD2   =     '201';                                                08850006
*   GOTO WRI0;                                                          08860006
*   END;                                                                08870006
*IF   (FUNC(1) =  'EXPORT') THEN                                        08871021
*   DO;                                                                 08872021
*/*                                                                 */  08873021
*/*-----------------------------------------------------------------*/  08874021
*/*      "EXPORT "    P R O C E S S I N G                           */  08875021
*/*-----------------------------------------------------------------*/  08876021
*/*                                                                 */  08877021
*   FCODE   =     'EX';                                                 08878021
*   FCOD1   =     '197';                                                08879021
*   FCOD2   =     '231';                                                08879121
*   GOTO WRI0;                                                          08879221
*   END;                                                                08879321
*IF   (FUNC(1) =  'IMPORT') THEN                                        08879421
*   DO;                                                                 08879521
*/*                                                                 */  08879621
*/*-----------------------------------------------------------------*/  08879721
*/*      "IMPORT "    P R O C E S S I N G                           */  08879821
*/*-----------------------------------------------------------------*/  08879921
*/*                                                                 */  08880021
*   FCODE   =     'IM';                                                 08880121
*   FCOD1   =     '201';                                                08880221
*   FCOD2   =     '212';                                                08880321
*   GOTO WRI0;                                                          08880421
*   END;                                                                08880521
*ANS MSG('FUNC' || FUNC  || ' IS INVALID') MSGLEVEL(8);                 08881006
*ERROR    =     ERROR+8;                                                08890006
*GOTO WRI0;                                                             08900006
*/*                                                                 */  08910006
*/*-----------------------------------------------------------------*/  08920006
*/*      C H E C K   P A R A M E T E R S                            */  08930006
*/*-----------------------------------------------------------------*/  08940006
*/*                                                                 */  08950006
*/* WRITE PARAMETER ------------------------------------------------*/  08960006
*WRI0:                                                                  08970006
*IF ((FCODE = 'MV') | (FCODE = 'MC')) THEN                              08980006
*   DO;                                                                 08990006
*   IF (WRITE = '') THEN                                                09000006
*      DO;                                                              09010006
*      ANS MSG('WRITE PARAMETER IS MISSING') MSGLEVEL(8);               09020006
*      ERROR = ERROR+8;                                                 09030006
*      END;                                                             09040006
*   ELSE                                                                09050006
*      DO;                                                              09060006
*      IF (WRITE(1,1:1) = '(') THEN                                     09070006
*         DO;                                                           09080006
*         IF (WRITE(1,LENGTH(WRITE(1))::1) = ')') THEN                 09090006
*            DO;                                                        09100006
*            ANS MSG(WRITE || ' WRONG REGISTER NOTATION') MSGLEVEL(8);  09110006
*            ERROR   =      ERROR+8;                                    09120006
*            END;                                                       09130006
*         ELSE                                                          09140006
*            DO;                                                        09150006
*            TEMP6 = WRITE(1,2::LENGTH(WRITE(1))-2);                    09160006
*            ANS('RESPECIFY '|| TEMP6 || ' RESTRICTED;')                09170006
*            COL(MACLMAR);                                              09180006
*            ANS('/* @D61ADMF*/') COL(COLC) SKIP;                       09190006
*            END;                                                       09200006
*         END;                                                          09210006
*      END;                                                             09220006
*   END;                                                                09230006
*ELSE                                                                   09240006
*   DO;                                                                 09250006
*   IF (WRITE = '') THEN                                               09260006
*      DO;                                                              09270006
*      ANS MSG('WRITE PARAMETER IGNORED') MSGLEVEL(4);                  09280006
*      END;                                                             09290006
*   END;                                                                09300006
*/* CUU PARAMETER --------------------------------------------------*/  09310006
*IF ((FCODE = 'MV') | (FCODE = 'MC') | (FCODE = 'QS') |                 09320006
*    (FCODE = 'RD') | (FCODE = 'QD') |                                  09330030
*    (FCODE = 'EX') | (FCODE = 'IM')) THEN           /* @D68DDAK*/      09331030
*   DO;                                                                 09340006
*   IF (CUU = '') THEN                                                  09350006
*      DO;                                                              09360006
*      IF (FCODE = 'QS') THEN                                          09370006
*         DO;                                                           09380006
*         ANS MSG('CUU PARAMETER IS MISSING') MSGLEVEL(8);              09390006
*         ERROR = ERROR+8;                                              09400006
*         END;                                                          09410006
*      END;                                                             09420006
*   ELSE                                                                09430006
*      DO;                                                              09440006
*      IF (CUU(1,1:1) = '(') THEN                                       09450006
*         DO;                                                           09460006
*         IF (CUU(1,LENGTH(CUU(1))::1) = ')') THEN                     09470006
*            DO;                                                        09480006
*            ANS MSG(CUU || ' WRONG REGISTER NOTATION') MSGLEVEL(8);    09490006
*            ERROR   =      ERROR+8;                                    09500006
*            END;                                                       09510006
*         ELSE                                                          09520006
*            DO;                                                        09530006
*            TEMP2 = CUU(1,2::LENGTH(CUU(1))-2);                        09540006
*            ANS('RESPECIFY '|| TEMP2 || ' RESTRICTED;')                09550006
*            COL(MACLMAR);                                              09560006
*            ANS('/* @D61ADMF*/') COL(COLC) SKIP;                       09570006
*            END;                                                       09580006
*         END;                                                          09590006
*      END;                                                             09600006
*   END;                                                                09610006
*ELSE                                                                   09620006
*   DO;                                                                 09630006
*   IF (CUU = '') THEN                                                 09640006
*      DO;                                                              09650006
*      ANS MSG('CUU PARAMETER IGNORED') MSGLEVEL(4);                    09660006
*      END;                                                             09670006
*   END;                                                                09680006
*/* LIBNAME PARAMETER -----------------------------------------------*/ 09690006
*IF ((FCODE = 'QS') | (FCODE = 'QA') |                                  09700006
*    (FCODE = 'MV') | (FCODE = 'EV') |                                  09710006
*    (FCODE = 'MC') | (FCODE = 'QC') |                                  09720006
*    (FCODE = 'QI') | (FCODE = 'QL') |                                  09730006
*    (FCODE = 'SV') | (FCODE = 'MI')) THEN                              09740006
*   DO;                                                                 09750006
*   IF (LIBNAME = '') THEN                                              09760006
*      DO;                                                              09770006
*      ANS MSG('LIBNAME PARAMETER IS MISSING') MSGLEVEL(8);             09780006
*      ERROR = ERROR+8;                                                 09790006
*      END;                                                             09800006
*   ELSE                                                                09810006
*      DO;                                                              09820006
*      IF (LIBNAME(1,1:1) = '(') THEN                                   09830006
*         DO;                                                           09840006
*         IF (LIBNAME(1,LENGTH(LIBNAME(1))::1) = ')') THEN             09850006
*            DO;                                                        09860006
*            ANS MSG(LIBNAME || ' WRONG REGISTER NOTATION')             09870006
*            MSGLEVEL(8);                                               09880006
*            ERROR   =      ERROR+8;                                    09890006
*            END;                                                       09900006
*         ELSE                                                          09910006
*            DO;                                                        09920006
*            TEMP5 = LIBNAME(1,2::LENGTH(LIBNAME(1))-2);                09930006
*            ANS('RESPECIFY '|| TEMP5 || ' RESTRICTED;')                09940006
*            COL(MACLMAR);                                              09950006
*            ANS('/* @D61ADMF*/') COL(COLC) SKIP;                       09960006
*            END;                                                       09970006
*         END;                                                          09980006
*      END;                                                             09990006
*   END;                                                                10000006
*ELSE                                                                   10010006
*   DO;                                                                 10020006
*   IF (LIBNAME = '') THEN                                             10030006
*      DO;                                                              10040006
*      ANS MSG('LIBNAME PARAMETER IGNORED') MSGLEVEL(4);                10050006
*      END;                                                             10060006
*   END;                                                                10070006
*/* VOLSER PARAMETER -----------------------------------------------*/  10080006
*IF ((FCODE = 'MV') | (FCODE = 'QS') |                                  10090006
*    (FCODE = 'QA') | (FCODE = 'EV') |                                  10100006
*    (FCODE = 'MC') | (FCODE = 'QD') |                                  10110006
*    (FCODE = 'EX') | (FCODE = 'IM') |                      /*@D68CDAK*/10111021
*    (FCODE = 'SV')) THEN                                               10120006
*   DO;                                                                 10130006
*   IF (VOLSER = '') THEN                                               10140006
*      DO;                                                              10150006
*      ANS MSG('VOLSER PARAMETER IS MISSING') MSGLEVEL(8);              10160006
*      ERROR = ERROR+8;                                                 10170006
*      END;                                                             10180006
*   ELSE                                                                10190006
*      DO;                                                              10200006
*      IF (VOLSER(1,1:1) = '(') THEN                                    10210006
*         DO;                                                           10220006
*         IF (VOLSER(1,LENGTH(VOLSER(1))::1) = ')') THEN               10230006
*            DO;                                                        10240006
*            ANS MSG(VOLSER || ' WRONG REGISTER NOTATION') MSGLEVEL(8); 10250006
*            ERROR   =      ERROR+8;                                    10260006
*            END;                                                       10270006
*         ELSE                                                          10280006
*            DO;                                                        10290006
*            TEMP1 = VOLSER(1,2::LENGTH(VOLSER(1))-2);                  10300006
*            ANS('RESPECIFY '|| TEMP1 || ' RESTRICTED;')                10310006
*            COL(MACLMAR);                                              10320006
*            ANS('/* @D61ADMF*/') COL(COLC) SKIP;                       10330006
*            END;                                                       10340006
*         END;                                                          10350006
*      END;                                                             10360006
*   END;                                                                10370006
*ELSE                                                                   10380006
*   DO;                                                                 10390006
*   IF (VOLSER = '') THEN                                              10400006
*      DO;                                                              10410006
*      ANS MSG('VOLSER PARAMETER IGNORED') MSGLEVEL(4);                 10420006
*      END;                                                             10430006
*   END;                                                                10440006
*/* SRCCAT PARAMETER -----------------------------------------------*/  10450006
*IF ((FCODE = 'MC') | (FCODE = 'QA') |                                  10460006
*    (FCODE = 'QS') | (FCODE = 'QD') |                                  10470006
*    (FCODE = 'QC') | (FCODE = 'SV') |                                  10480006
*    (FCODE = 'QI') |                                                   10490006
*    (FCODE = 'MI')) THEN                                               10500006
*   DO;                                                                 10510006
*   IF (SRCCAT = '') THEN                                               10520006
*      DO;                                                              10530006
*      ANS MSG('SRCCAT PARAMETER IS MISSING') MSGLEVEL(8);              10540006
*      ERROR = ERROR+8;                                                 10550006
*      END;                                                             10560006
*   ELSE                                                                10570006
*      DO;                                                              10580006
*      IF (SRCCAT(1,1:1) = '(') THEN                                    10590006
*         DO;                                                           10600006
*         IF (SRCCAT(1,LENGTH(SRCCAT(1))::1) = ')') THEN               10610006
*            DO;                                                        10620006
*            ANS MSG(SRCCAT || ' WRONG REGISTER NOTATION') MSGLEVEL(8); 10630006
*            ERROR   =      ERROR+8;                                    10640006
*            END;                                                       10650006
*         ELSE                                                          10660006
*            DO;                                                        10670006
*            TEMP7 = SRCCAT(1,2::LENGTH(SRCCAT(1))-2);                  10680006
*            ANS('RESPECIFY '|| TEMP7 || ' RESTRICTED;')                10690006
*            COL(MACLMAR);                                              10700006
*            ANS('/* @D61ADMF*/') COL(COLC) SKIP;                       10710006
*            END;                                                       10720006
*         END;                                                          10730006
*      END;                                                             10740006
*   END;                                                                10750006
*ELSE                                                                   10760006
*   DO;                                                                 10770006
*   IF (SRCCAT = '') THEN                                              10780006
*      DO;                                                              10790006
*      ANS MSG('SRCCAT PARAMETER IGNORED') MSGLEVEL(4);                 10800006
*      END;                                                             10810006
*   END;                                                                10820006
*/* TGTCAT PARAMETER -----------------------------------------------*/  10830006
*IF ((FCODE = 'SV') | (FCODE = 'MV') | (FCODE = 'RD') |   /* @D68CDAK*/ 10840015
*    (FCODE = 'MC') | (FCODE = 'MI')) THEN                              10850006
*   DO;                                                                 10860006
*   IF (TGTCAT = '') THEN                                               10870008
*      DO;                                                              10880006
*      IF (FCODE = 'RD') THEN;                            /* @D68CDAK*/ 10881015
*      ELSE DO;                                           /* @D68CDAK*/ 10882015
*      ANS MSG('TGTCAT PARAMETER IS MISSING') MSGLEVEL(8);              10890006
*      ERROR = ERROR+8;                                                 10900006
*      END;                                               /* @D68CDAK*/ 10910015
*      END;                                                             10911008
*   ELSE                                                                10920006
*      DO;                                                              10930006
*      IF (TGTCAT(1,1:1) = '(') THEN                                    10940006
*         DO;                                                           10950006
*         IF (TGTCAT(1,LENGTH(TGTCAT(1))::1) = ')') THEN               10960006
*            DO;                                                        10970006
*            ANS MSG(TGTCAT || ' WRONG REGISTER NOTATION') MSGLEVEL(8); 10980006
*            ERROR   =      ERROR+8;                                    10990006
*            END;                                                       11000006
*         ELSE                                                          11010006
*            DO;                                                        11020006
*            TEMP8 = TGTCAT(1,2::LENGTH(TGTCAT(1))-2);                  11030006
*            ANS('RESPECIFY '|| TEMP8 || ' RESTRICTED;')                11040006
*            COL(MACLMAR);                                              11050006
*            ANS('/* @D61ADMF*/') COL(COLC) SKIP;                       11060006
*            END;                                                       11070006
*         END;                                                          11080006
*      END;                                                             11090006
*   END;                                                                11100006
*ELSE                                                                   11110006
*   DO;                                                                 11120006
*   IF (TGTCAT = '') THEN                                              11130006
*      DO;                                                              11140006
*      ANS MSG('TGTCAT PARAMETER IGNORED') MSGLEVEL(4);                 11150006
*      END;                                                             11160006
*   END;                                                                11170006
*/* MEMNAME PARAMETER ----------------------------------------------*/  11180006
*IF (FCODE = 'MI') |                                                    11190007
*   ((FCODE = 'SV') & (MEMNAME = '')) THEN               /*@D68CDAK*/  11191015
*   DO;                                                                 11200006
*   IF (MEMNAME = '') THEN                                              11210007
*      DO;                                                              11220006
*      ANS MSG('MEMNAME PARAMETER IS MISSING') MSGLEVEL(8);             11230006
*      ERROR = ERROR+8;                                                 11240006
*      END;                                                             11250006
*   ELSE                                                                11260006
*      DO;                                                              11270006
*      IF (MEMNAME(1,1:1) = '(') THEN                                   11280006
*         DO;                                                           11290006
*         IF (MEMNAME(1,LENGTH(MEMNAME(1))::1) = ')') THEN             11300006
*            DO;                                                        11310006
*            ANS MSG(MEMNAME || ' WRONG REGISTER NOTATION')             11320006
*            MSGLEVEL(8);                                               11330006
*            ERROR   =      ERROR+8;                                    11340006
*            END;                                                       11350006
*         ELSE                                                          11360006
*            DO;                                                        11370006
*            TEMP9 = MEMNAME(1,2::LENGTH(MEMNAME(1))-2);                11380006
*            ANS('RESPECIFY '|| TEMP9 || ' RESTRICTED;')                11390006
*            COL(MACLMAR);                                              11400006
*            ANS('/* @D61ADMF*/') COL(COLC) SKIP;                       11410006
*            END;                                                       11420006
*         END;                                                          11430006
*      END;                                                             11440006
*   END;                                                                11450006
*ELSE                                                                   11460006
*   DO;                                                                 11470006
*   IF (MEMNAME = '') THEN                                             11480006
*      DO;                                                              11490006
*      ANS MSG('MEMNAME PARAMETER IGNORED') MSGLEVEL(4);                11500006
*      END;                                                             11510006
*   END;                                                                11520006
*/* ECB PARAMETER --------------------------------------------------*/  11530006
*IF ((FCODE = 'MV') | (FCODE = 'QA') |                                  11540006
*    (FCODE = 'EV') | (FCODE = 'MC') |                                  11550006
*    (FCODE = 'QC') | (FCODE = 'QD') |                                  11560006
*    (FCODE = 'QL') | (FCODE = 'QI') |                                  11570006
*    (FCODE = 'SV') | (FCODE = 'MI') |                                  11580006
*    (FCODE = 'EX') | (FCODE = 'IM') |                    /*@D68CDAK*/  11581021
*    (FCODE = 'QS') | (FCODE = 'RD')) THEN                              11590006
*   DO;                                                                 11600006
*   IF (ECB = '') THEN                                                  11610006
*      DO;                                                              11620006
*      ANS MSG('ECB PARAMETER IS MISSING') MSGLEVEL(8);                 11630006
*      ERROR = ERROR+8;                                                 11640006
*      END;                                                             11650006
*   ELSE                                                                11660006
*      DO;                                                              11670006
*      IF (ECB(1,1:1) = '(') THEN                                       11680006
*         DO;                                                           11690006
*         IF (ECB(1,LENGTH(ECB(1))::1) = ')') THEN                     11700006
*            DO;                                                        11710006
*            ANS MSG(ECB || ' WRONG REGISTER NOTATION') MSGLEVEL(8);    11720006
*            ERROR   =      ERROR+8;                                    11730006
*            END;                                                       11740006
*         ELSE                                                          11750006
*            DO;                                                        11760006
*            TEMP3 = ECB(1,2::LENGTH(ECB(1))-2);                        11770006
*            ANS('RESPECIFY '|| TEMP3 || ' RESTRICTED;')                11780006
*            COL(MACLMAR);                                              11790006
*            ANS('/* @D61ADMF*/') COL(COLC) SKIP;                       11800006
*            END;                                                       11810006
*         END;                                                          11820006
*      END;                                                             11830006
*   END;                                                                11840006
*ELSE                                                                   11850006
*   DO;                                                                 11860006
*   IF (ECB = '') THEN                                                 11870006
*      DO;                                                              11880006
*      ANS MSG('ECB PARAMETER IGNORED') MSGLEVEL(4);                    11890006
*      END;                                                             11900006
*   END;                                                                11910006
*/* LIST PARAMETER ---------------------------------------@D68CDAK*/    11911033
*IF (FCODE = 'EX') | (FCODE = 'IM') THEN                                11912032
*   DO;                                                                 11919021
*   IF (LIST = '') THEN                                                 11919133
*      DO;                                                              11919221
*      ANS MSG('LIST PARAMETER IS MISSING') MSGLEVEL(8);                11919333
*      ERROR = ERROR+8;                                                 11919421
*      END;                                                             11919521
*   ELSE                                                                11919621
*      DO;                                                              11919721
*      IF (LIST(1,1:1) = '(') THEN                                      11919833
*         DO;                                                           11919921
*         IF (LIST(1,LENGTH(LIST(1))::1) = ')') THEN                   11920033
*            DO;                                                        11920121
*            ANS MSG(LIST || ' WRONG REGISTER NOTATION') MSGLEVEL(8);   11920233
*            ERROR   =      ERROR+8;                                    11920321
*            END;                                                       11920421
*         ELSE                                                          11920521
*            DO;                                                        11920621
*            TEMP3 = LIST(1,2::LENGTH(LIST(1))-2);                      11920733
*            ANS('RESPECIFY '|| TEMP3 || ' RESTRICTED;')                11920821
*            COL(MACLMAR);                                              11920921
*            ANS('/* @D68CDAK*/') COL(COLC) SKIP;                       11921021
*            END;                                                       11921121
*         END;                                                          11921221
*      END;                                                             11921321
*   END;                                                                11921421
*ELSE                                                                   11921521
*   DO;                                                                 11921621
*   IF (LIST = '') THEN                                                11921733
*      DO;                                                              11921821
*      ANS MSG('LIST PARAMETER IGNORED') MSGLEVEL(4);                   11921933
*      END;                                                             11922021
*   END;                                                                11922121
*/* SERVL PARAMETER ------------------------------------------------*/  11923006
*IF (SERVL = '') THEN                                                   11930006
*   DO;                                                                 11940006
*   ANS MSG('SERVL PARAMETER IS MISSING') MSGLEVEL(8);                  11950006
*   ERROR = ERROR+8;                                                    11960006
*   END;                                                                11970006
*ELSE                                                                   11980006
*   DO;                                                                 11990006
*   IF (SERVL(1,1:1) = '(') THEN                                        12000006
*      DO;                                                              12010006
*      IF (SERVL(1,LENGTH(SERVL(1))::1) = ')') THEN                    12020006
*         DO;                                                           12030006
*         ANS MSG(SERVL || ' WRONG REGISTER NOTATION') MSGLEVEL(8);     12040006
*         ERROR   =      ERROR+8;                                       12050006
*         END;                                                          12060006
*      ELSE                                                             12070006
*         DO;                                                           12080006
*         TEMP4 = SERVL(1,2::LENGTH(SERVL(1))-2);                       12090006
*         ANS('RESPECIFY '|| TEMP4 || ' RESTRICTED;')                   12100006
*         COL(MACLMAR);                                                 12110006
*         ANS('/* @D61ADMF*/') COL(COLC) SKIP;                          12120006
*         END;                                                          12130006
*      END;                                                             12140006
*   END;                                                                12150006
*/*                                                                 */  12160006
*/*-----------------------------------------------------------------*/  12170006
*/*      G E N E R A T E   A S S E M B L E R   C O D E .            */  12180006
*/*-----------------------------------------------------------------*/  12190006
*/*                                                                 */  12200006
*IF (ERROR > 0) THEN RETURN;                                            12210006
*                                                                       12220006
*/*IF (SERVL(1,1:1) = '(') THEN */                                      12230006
*/*   DO;                       */                                      12240006
*/*   ANS('RESPECIFY IJJLBSER BASED (' || TEMP4 || ');') */             12250006
*/*   COL(MACLMAR);                                      */             12260006
*/*   END;                      */                                      12270006
*/*ELSE                         */                                      12280006
*/*   DO;                       */                                      12290006
*/*   ANS('RESPECIFY IJJLBSER BASED (ADDR(' || SERVL(1) || '));') */    12300006
*/*   COL(MACLMAR);                                               */    12310006
*/*   END;                      */                                      12320006
*/*ANS('/  GET SERVL ADDRESS @D61ADMF /') COL(COLC) SKIP;         */    12330006
*/*                                                                 */  12340006
*/*-----------------------------------------------------------------*/  12350006
*/*      M O V E   I N P U T   P A R A M E T E R S                  */  12360006
*/*-----------------------------------------------------------------*/  12370006
*/*                                                                 */  12380006
*ANS('RESPECIFY '|| SAVREG || ' RESTRICTED;') COL(MACLMAR);             12390006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   12400006
*IF (SERVL(1,1:1) = '(') THEN                                           12410006
*   DO;                                                                 12420006
*   ANS('GENERATE;') COL(MACLMAR) SKIP;                                 12430006
*   ANS('ST    TEMP4,24(,SAVREG) SERVL INTO REGISTER 1 @D61ADMF')       12440006
*   COL(MACGLMAR+8) SKIP;                                               12450006
*   ANS('@ENDGEN;') COL(MACLMAR) SKIP;                                  12460006
*   END;                                                                12470006
*  ELSE                                                    /*DY44241*/  12480006
*   DO;                                                    /*DY44241*/  12490006
*   ANS('GENERATE;') COL(MACLMAR) SKIP;                    /*DY44241*/  12500006
*   ANS('LA    BASEREG,') COL(MACGLMAR+8);                 /*DY44241*/  12510006
*   ANS(SERVL(1));                                         /*DY44241*/  12520006
*   ANS('     SERVL ADDR INTO TEMP   @DY44241');           /*DY44241*/  12530006
*   ANS('ST    BASEREG,24(,SAVREG)    SAVE SERVL ADDR        @DY44241') 12540006
*   COL(MACGLMAR+8) SKIP;                                  /*DY44241*/  12550006
*   ANS('@ENDGEN;') COL(MACLMAR) SKIP;                     /*DY44241*/  12560006
*   END;                                                   /*DY44241*/  12570006
*ANS('IJJLTIDN = 2;') COL(MACLMAR);                                     12580006
*ANS('/* VERS NUMBER 2 @D61ADMF*/') COL(COLC) SKIP;                     12590006
*ANS("IJJLFREQ(1::1) = " || FCOD1 || ";") COL(MACLMAR);                 12600006
*ANS('/* SET FUNC @D61ADMF*/') COL(COLC) SKIP;                          12610006
*ANS("IJJLFREQ(2::1) = " || FCOD2 || ";") COL(MACLMAR);                 12620006
*ANS('/* SET FUNC @D61ADMF*/') COL(COLC) SKIP;                          12630006
*IF (FCODE = 'RE') THEN                                                12640006
*   DO;                                                                 12650006
*   IF (FCODE = 'CR') THEN                                              12660006
*      DO;                                                              12670006
*      ANS("IJJLTLPL(5::4) = ''B;") COL(MACLMAR);                       12680006
*      ANS('/* CLEAR @D61ADMF*/') COL(COLC) SKIP;                       12690006
*      ANS("IJJLTLPL(13::4) = ''B;") COL(MACLMAR);                      12700006
*      ANS('/* CLEAR @D61ADMF*/') COL(COLC) SKIP;                       12710006
*      ANS("IJJLTLPL(21::LENGTH(IJJLTLPL) - 20) = ''B;")                12720006
*      COL(MACLMAR);                                                    12730006
*      END;                                                             12740006
*   ELSE                                                                12750006
*      DO;                                                              12760006
*      ANS("IJJLTLPL(5::LENGTH(IJJLTLPL) - 4) = ''B;")                  12770006
*      COL(MACLMAR);                                                    12780006
*      END;                                                             12790006
*   ANS('/* CLEAR @D61ADMF*/') COL(COLC) SKIP;                          12800006
*   ANS('IJJLFPIP = ADDR(IJJLTRST);') COL(MACLMAR);                     12810006
*   ANS('/* INT PART ADDRESS @D61ADMF*/') COL(COLC) SKIP;               12820006
*   IF (FCODE = 'CR') THEN                                             12830006
*      DO;                                                              12840006
*/* WRITE PARAMETER ------------------------------------------------*/  12850006
*      IF ((FCODE = 'MV') | (FCODE = 'MC')) THEN                        12860006
*         DO;                                                           12870006
*         IF (WRITE(1,1:1) = '(') THEN                                  12880006
*            DO;                                                        12890006
*            ANS('IJJLFRWF = ' || TEMP6 || ';') COL(MACLMAR);           12900006
*            END;                                                       12910006
*         ELSE                                                          12920006
*            DO;                                                        12930006
*            ANS('IJJLFRWF = ADDR(' || WRITE(1) || ');') COL(MACLMAR);  12940006
*            END;                                                       12950006
*         ANS('/* READ/WRITE @D61ADMF*/') COL(COLC) SKIP;               12960006
*         END;                                                          12970006
*/* VOLSER PARAMETER -----------------------------------------------*/  12980006
*      IF ((FCODE = 'MV') | (FCODE = 'QS') |                            12990006
*          (FCODE = 'QA') | (FCODE = 'EV') |                            13000006
*          (FCODE = 'MC') | (FCODE = 'QD') |                            13010006
*          (FCODE = 'EX') | (FCODE = 'IM') |                /*@D68CDAK*/13011021
*          (FCODE = 'SV')) THEN                                         13020006
*         DO;                                                           13030006
*         IF (VOLSER(1,1:1) = '(') THEN                                 13040006
*            DO;                                                        13050006
*            ANS('IJJLFVOL = ' || TEMP1 || ';') COL(MACLMAR);           13060006
*            END;                                                       13070006
*         ELSE                                                          13080006
*            DO;                                                        13090006
*            ANS('IJJLFVOL = ADDR(' || VOLSER(1) || ');') COL(MACLMAR); 13100006
*            END;                                                       13110006
*         ANS('/* VOLSER @D61ADMF*/') COL(COLC) SKIP;                   13120006
*         END;                                                          13130006
*/* CUU PARAMETER --------------------------------------------------*/  13140006
*      IF ((FCODE = 'QS') & (CUU = '')) THEN                            13150006
*         DO;                                                           13160006
*         END;                                                          13170006
*      ELSE                                                             13180006
*         DO;                                                           13190006
*         IF ((FCODE = 'MV') | (FCODE = 'MC') | (FCODE = 'QS') |        13200006
*             (FCODE = 'RD') | (FCODE = 'QD') |                         13210030
*             (FCODE = 'EX') | (FCODE = 'IM')) THEN      /* @D68DDAK*/  13211030
*            DO;                                                        13220006
*            IF (CUU(1,1:1) = '(') THEN                                 13230006
*               DO;                                                     13240006
*               ANS('IJJLFCUU = ' || TEMP2 || ';') COL(MACLMAR);        13250006
*               END;                                                    13260006
*            ELSE                                                       13270006
*               DO;                                                     13280006
*               ANS('IJJLFCUU = ADDR(' || CUU(1) || ');') COL(MACLMAR); 13290006
*               END;                                                    13300006
*            ANS('/* CUU @D61ADMF*/') COL(COLC) SKIP;                   13310006
*            END;                                                       13320006
*         END;                                                          13330006
*/* ECB PARAMETER --------------------------------------------------*/  13340006
*      IF (ECB(1,1:1) = '(') THEN                                       13350006
*         DO;                                                           13360006
*         ANS('IJJLFECB = ' || TEMP3 || ';') COL(MACLMAR);              13370006
*         END;                                                          13380006
*      ELSE                                                             13390006
*         DO;                                                           13400006
*         ANS('IJJLFECB = ADDR(' || ECB(1) || ');') COL(MACLMAR);       13410006
*         END;                                                          13420006
*      ANS('/* ECB @D61ADMF*/') COL(COLC) SKIP;                         13430006
*/* LIBNAME PARAMETER ----------------------------------------------*/  13440006
*      IF   (FCODE = 'RD') THEN        /* HANDLE ONLY TGTCAT        */  13450014
*     DO;                              /*                   @D68CDAK*/  13450115
*                              IF (TGTCAT = '') THEN                   13450214
*                                 DO;                                   13450314
*                                 IF (TGTCAT(1,1:1) = '(') THEN         13450414
*                                    DO;                                13450514
*                                    ANS('IJJLFTCT = ' || TEMP8 || ';') 13450614
*                                    COL(MACLMAR);                      13450714
*                                    END;                               13450814
*                                 ELSE                                  13450914
*                                    DO;                                13451014
*                                    ANS('IJJLFTCT = ADDR(' ||          13451114
*                                    TGTCAT(1) || ');')                 13451214
*                                    COL(MACLMAR);                      13451314
*                                    END;                               13451414
*                                 ANS('/* TGTCAT @D61ADMF*/')           13451514
*                                 COL(COLC) SKIP;                       13451614
*                                 END;                                  13451714
*                                                                       13451814
*     END;                            /* END FCODE = RD     @D68CDAK*/  13452015
*     ELSE DO;                                            /*@D68CDAK*/  13460015
*         IF ((FCODE = 'QS') | (FCODE = 'QA') |                         13470006
*             (FCODE = 'MV') | (FCODE = 'EV') |                         13480006
*             (FCODE = 'MC') | (FCODE = 'QC') |                         13490006
*             (FCODE = 'QI') | (FCODE = 'QL') |                         13500006
*             (FCODE = 'SV') | (FCODE = 'MI')) THEN                     13510006
*            DO;                                                        13520006
*            IF (LIBNAME(1,1:1) = '(') THEN                             13530006
*               DO;                                                     13540006
*               ANS('IJJLFLBN = ' || TEMP5 || ';') COL(MACLMAR);        13550006
*               END;                                                    13560006
*            ELSE                                                       13570006
*               DO;                                                     13580006
*               ANS('IJJLFLBN = ADDR(' || LIBNAME(1) || ');')           13590006
*               COL(MACLMAR);                                           13600006
*               END;                                                    13610006
*            ANS('/* LIBNAME @D61ADMF*/') COL(COLC) SKIP;               13620006
*            END;                                                       13630006
*/* LIST    PARAMETER ------------------------------------@D68CDAK*/    13631033
*      IF   (FCODE = 'EX') |           /* EXPORT OR IMPORT          */  13632021
*           (FCODE = 'IM') THEN        /*                           */  13632121
*            DO;                                                        13632221
*            IF (LIST(1,1:1) = '(') THEN                                13641033
*               DO;                                                     13641121
*               ANS('IJJLFEVL = ' || TEMPA || ';') COL(MACLMAR);        13641221
*               END;                                                    13641321
*            ELSE                                                       13641421
*               DO;                                                     13641521
*               ANS('IJJLFEVL = ADDR(' || LIST(1) || ');')              13641633
*               COL(MACLMAR);                                           13641721
*               END;                                                    13641821
*            ANS('/* LIST    @D68CDAK*/') COL(COLC) SKIP;               13641933
*            END;                                                       13642021
*/* SRCCAT PARAMETER ------------------------------------------------*/ 13643006
*         IF (FCODE = 'EV') &                                          13650021
*            (FCODE = 'EX') &                                          13651021
*            (FCODE = 'IM') THEN                          /*@D68CDAK*/ 13652021
*            DO;                                                        13660006
*            IF (FCODE = 'QL') THEN                                    13670006
*               DO;                                                     13680006
*               IF ((FCODE = 'MC') | (FCODE = 'QA') |                   13690006
*                   (FCODE = 'QS') | (FCODE = 'QD') |                   13700006
*                   (FCODE = 'QC') | (FCODE = 'SV') |                   13710006
*                   (FCODE = 'QI') |                                    13720006
*                   (FCODE = 'MI')) THEN                                13730006
*                  DO;                                                  13740006
*                  IF (SRCCAT(1,1:1) = '(') THEN                        13750006
*                     DO;                                               13760006
*                     ANS('IJJLFSCT = ' || TEMP7 || ';')                13770006
*                     COL(MACLMAR);                                     13780006
*                     END;                                              13790006
*                  ELSE                                                 13800006
*                     DO;                                               13810006
*                     ANS('IJJLFSCT = ADDR(' || SRCCAT(1) || ');')      13820006
*                     COL(MACLMAR);                                     13830006
*                     END;                                              13840006
*                  ANS('/* SRCCAT @D61ADMF*/') COL(COLC) SKIP;          13850006
*                  END;                                                 13860006
*/* TGTCAT PARAMETER -----------------------------------------------*/  13870006
*            IF (FCODE = 'QI') THEN                                    13880006
*               DO;                                                     13890006
*                  IF (FCODE = 'QA') THEN                              13900006
*                     DO;                                               13910006
*                     IF (FCODE = 'QS') THEN                           13920006
*                        DO;                                            13930006
*                        IF (FCODE = 'QC') THEN                        13940006
*                           DO;                                         13950006
*                           IF (FCODE = 'QD') THEN                     13960006
*                              DO;                                      13970006
*                              IF (TGTCAT = '') THEN                   13980006
*                                 DO;                                   13990006
*                                 IF (TGTCAT(1,1:1) = '(') THEN         14000006
*                                    DO;                                14010006
*                                    ANS('IJJLFTCT = ' || TEMP8 || ';') 14020006
*                                    COL(MACLMAR);                      14030006
*                                    END;                               14040006
*                                 ELSE                                  14050006
*                                    DO;                                14060006
*                                    ANS('IJJLFTCT = ADDR(' ||          14070006
*                                    TGTCAT(1) || ');')                 14080006
*                                    COL(MACLMAR);                      14090006
*                                    END;                               14100006
*                                 ANS('/* TGTCAT @D61ADMF*/')           14110006
*                                 COL(COLC) SKIP;                       14120006
*                                 END;                                  14130006
*/* MEMNAME PARAMETER ----------------------------------------------*/  14140006
*                              IF (FCODE = 'MI') |                      14150007
*                                 ((FCODE = 'SV') &                     14151007
*                                  (MEMNAME ='')) THEN   /*@D68CDAK*/  14152015
*                                 DO;                                   14160006
*                                 IF (TGTCAT = '') THEN                14170006
*                                    DO;                                14180006
*                                    IF (MEMNAME(1,1:1) = '(') THEN     14190006
*                                       DO;                             14200006
*                                       ANS('IJJLFMEM = ' ||            14210006
*                                       TEMP9 || ';')                   14220006
*                                       COL(MACLMAR);                   14230006
*                                       END;                            14240006
*                                    ELSE                               14250006
*                                       DO;                             14260006
*                                       ANS('IJJLFMEM = ADDR(' ||       14270006
*                                       MEMNAME(1) || ');')             14280006
*                                       COL(MACLMAR);                   14290006
*                                       END;                            14300006
*                                    ANS('/* MEMNAME @D61ADMF*/')       14310006
*                                    COL(COLC) SKIP;                    14320006
*                                    END;                               14330006
*                                 END;                                  14340006
*                              END;                                     14350006
*                           END;                                        14360006
*                        END;                                           14370006
*                     END;                                              14380006
*                  END;                                                 14390006
*               END;                                                    14400006
*            END;                                                       14410006
*         END;                                                          14420006
*      END;                                                             14430006
*   END;                                                                14440006
*/*                                                                 */  14450006
*/*-----------------------------------------------------------------*/  14460006
*/*      E X E C U T E   R E Q U E S T                              */  14470006
*/*-----------------------------------------------------------------*/  14480006
*/*                                                                 */  14490006
*ANS('RESPECIFY R15 RESTRICTED;') COL(MACLMAR);                         14500006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   14510006
*ANS('RESPECIFY R1 RESTRICTED;') COL(MACLMAR);                          14520006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   14530006
*ANS('GENERATE;') COL(MACLMAR) SKIP;                                    14540006
*ANS('CDLOAD IJJTLIB,RETPNF=YES,SVA=YES @D61ADMF')                      14550006
*COL(MACGLMAR+8) SKIP;                                                  14560006
*ANS('@ENDGEN;') COL(MACLMAR) SKIP;                                     14570006
*ANS('IF (R15 > 0) THEN') COL(MACLMAR);                                 14580006
*ANS('/* SUCCESSFUL? @D61ADMF*/') COL(COLC) SKIP;                       14590006
*ANS('DO;') COL(MACLMAR);                                               14600006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   14610006
*IF (SERVL(1,1:1) = '(') THEN                                           14620006
*   DO;                                                                 14630006
*   ANS('GENERATE;') COL(MACLMAR) SKIP;                                 14640006
*   ANS('L     TEMP4,24(,SAVREG) SERVL FROM REGISTER 1 @D61ADMF')       14650006
*   COL(MACGLMAR+8) SKIP;                                               14660006
*   ANS('@ENDGEN;') COL(MACLMAR) SKIP;                                  14670006
*   END;                                                                14680006
*ANS("IJJLTRET(1:1) = 240;") COL(MACLMAR);                              14690006
*ANS('/* RETURN CODE 0 @D61ADMF*/') COL(COLC) SKIP;                     14700006
*ANS("IJJLTRET(2:2) = 240;") COL(MACLMAR);                              14710006
*ANS('/* RETURN CODE 0 @D61ADMF*/') COL(COLC) SKIP;                     14720006
*ANS("IJJLTRET(3:3) = 240;") COL(MACLMAR);                              14730006
*ANS('/* RETURN CODE 0 @D61ADMF*/') COL(COLC) SKIP;                     14740006
*ANS("IJJLTRET(4:4) = 248;") COL(MACLMAR);                              14750006
*ANS('/* RETURN CODE 8 @D61ADMF*/') COL(COLC) SKIP;                     14760006
*ANS("IJJLTREA(1:1) = 246;") COL(MACLMAR);                              14770006
*ANS('/* REASON CODE 6 @D61ADMF*/') COL(COLC) SKIP;                     14780006
*ANS("IJJLTREA(2:2) = 243;") COL(MACLMAR);                              14790006
*ANS('/* REASON CODE 3 @D61ADMF*/') COL(COLC) SKIP;                     14800006
*ANS("IJJLTREA(3:3) = 240;") COL(MACLMAR);                              14810006
*ANS('/* REASON CODE 0 @D61ADMF*/') COL(COLC) SKIP;                     14820006
*ANS("IJJLTREA(4:4) = 243;") COL(MACLMAR);                              14830006
*ANS('/* REASON CODE 3 @D61ADMF*/') COL(COLC) SKIP;                     14840006
*ANS('END;') COL(MACLMAR) SKIP;                                         14850006
*ANS('ELSE') COL(MACLMAR) SKIP;                                         14860006
*ANS('DO;') COL(MACLMAR) SKIP;                                          14870006
*ANS('RESPECIFY '|| BRREG || ' RESTRICTED;') COL(MACLMAR);              14880006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   14890006
*ANS('RESPECIFY '|| RETREG || ' RESTRICTED;') COL(MACLMAR);             14900006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   14910006
*ANS('GENERATE;') COL(MACLMAR) SKIP;                                    14920006
*ANS('LR    BRREG,1             BASE ADDRESS OF PHASE  @D61NDMF')       14930006
*COL(MACGLMAR+8) SKIP;                                                  14940006
*ANS('L     BASEREG,24(,SAVREG)        SERVL INTO REGISTER 1  @D61ADMF')14950006
*COL(MACGLMAR+8) SKIP;                                                  14960006
*ANS('BALR  RETREG,BRREG           BRANCH TO ROUTINE      @D61ADMF')    14970006
*COL(MACGLMAR+8) SKIP;                                                  14980006
*ANS('@ENDGEN;') COL(MACLMAR) SKIP;                                     14990006
*ANS('END;') COL(MACLMAR) SKIP;                                         15000006
*ANS('RESPECIFY '|| BRREG || ' UNRESTRICTED;') COL(MACLMAR);            15010006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   15020006
*ANS('RESPECIFY '|| RETREG || ' UNRESTRICTED;') COL(MACLMAR);           15030006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   15040006
*ANS('RESPECIFY R15 UNRESTRICTED;') COL(MACLMAR);                       15050006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   15060006
*ANS('RESPECIFY R1 UNRESTRICTED;') COL(MACLMAR);                        15070006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   15080006
*ANS('RESPECIFY '|| SAVREG || ' UNRESTRICTED;') COL(MACLMAR);           15090006
*ANS('/* @D61ADMF*/') COL(COLC) SKIP;                                   15100006
*RETURN;                                                                15110006
*%END LBSERV;                                                           15120006
