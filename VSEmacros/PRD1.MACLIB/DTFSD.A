         MACRO                                                          00050000
&FILEN   DTFSD &BLKSIZE=,&CONTROL=,&DEVICE=2311,&EOFADDR=,&ERROPT=,&IOA100100000
               REA1=,&IOAREA2=,&IOREG=,&LABADDR=,&NOTEPNT=,&RECFORM=FIX200150000
               UNB,&RECSIZE=,&TRUNCS=,&TYPEFLE=INPUT,&UPDATE=,&VARBLD=,300200000
               &VERIFY=,&WLRERR=,&WORKA=,&MODNAME=,&DELETFL=,&SEPASMB=,400250000
               &DEVADDR=,&HOLD=,&RDONLY=,&ERREXT=,&FEOVD=,&CISIZE=0,&PW500300000
               RITE=,&EOXPTR=                                  @D14CDHK 00350000
         GBLB  &SYSGB                                                   00400000
         GBLC  &SYSG1(26)                                           3-8 00450000
         LCLA  &BLKS,&INDIC,&IORE,&RECS,&VBLD,&LNDIC,&NUMB,&RECNUM(3)   00500000
         LCLA  &VRFY,&CLASS,&NUM,&TRKHLD                            3-3 00550000
         LCLA  &CISZ,&VER3FLG                                  @D35DE98 00600000
         LCLB  &B(19),&LABNG,&T(1),&TERM                       @D51ZDRP 00650000
         LCLB  &IOANOP,&FBA,&DEFW,&DEFR                        @D14CDHK 00700000
         LCLC  &EOF,&IOA1,&ERRTN,&LABDR,&C(5),&CCODE,&DVADR         3-8 00750000
         LCLC  &EXT                                            @D14CDHK 00800000
.*          LOCAL DECLARATIONS                                 @D35DE98 00850000
.*     &VER3FLG - FLAG BYTE IN VERSION 3 PORTION OF THIS DTF   @D35DE98 00900000
.*     &CISZ - AN A-TYPE VARIABLE FOR CISIZE                   @D35DE98 00950000
.*     &FBA - MEANS DEVICE=FBA WAS SPECIFIED                   @D35DE98 01000000
.*     &IOANOP - MEANS IOAREAS ARE NOT OPTIONAL FOR DATAFILES  @D35DE98 01050000
.*     &DEFW - MEANS WORKA=YES WILL BE DEFAULTED TO            @D35DE98 01100000
.*     &DEFR - MEANS IOREG WILL BE DEFAULTED TO                @D35DE98 01150000
.*     &EXT  - MEANS EOX EXIT POINTER SPECIFIED                @D14CDHK 01200000
.********************************************************************** 01250000
         AGO   .ZZZ                                                     01300000
*        LICENSED MATERIALS - PROPERTY OF IBM                         * 01350000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                  * 01400000
*        5686-032 (C) COPYRIGHT IBM CORP. 1979,1990                   * 01450000
*        SEE COPYRIGHT INSTRUCTIONS                                   * 01500000
.ZZZ     ANOP                                                  @D51ZDRP 01550000
.********************************************************************** 01600000
.* MODULE NAME = DTFSD (IBM DISK OPERATING SYSTEM)             @D14CDIS 01650000
.*                                                                    * 01700000
.* COMPONENT =          5686-032-02-C550                              * 01750000
.*                                                                    * 01800000
.* DESCRIPTIVE NAME = SEQUENTIAL DASD I/O                      @D14CDIS 01850000
.*                                                                    * 01900000
.*                                                                    * 01950000
.* FUNCTION    DTFSD DEFINES SEQUENTIAL (CONSECUTIVE)          @D14CDIS 02000000
.*             PROCESSING FOR A FILE CONTAINED ON DASD.        @D14CDIS 02050000
.*             ONLY IBM STANDARD LABEL FORMATS ARE PROCESSED.  @D14CDIS 02100000
.*                                                                    * 02150000
.* CHANGE ACTIVITY = AS FOLLOWS                                @D14CDIS 02200000
.*    @D14CDIS  TO FORCE ALIGNMENT OF VERSION 3 DTF AREA       @D14CDIS 02250000
.*                                                                    * 02300000
.*    @D14CDKH  END-OF-EXTENT EXIT IS NOT ACTIVATED IF TRACK   @D14CDKH 02350000
.*              HOLD IS ALSO SPECIFIED.                        @D14CDKH 02400000
.*    @D51ZDRP  TYPEFLE=WORKIN|WORKINUP|WORKMOD (WORKMOD ONLY  @D51ZDRP 02450000
.*              SUPP. BY MANAGED SAM, IDENT. TO WORKINUP FOR   @D51ZDRP 02500000
.*              BAM).                                          @D51ZDRP 02550000
.*    @D66IDAK  MNOTE WHEN RECSIZE IN REG FORMAT AND FIXBLK    @D66IDAK 02560008
.********************************************************************** 02600000
* SEQUENTIAL DISK IOCS - DTFSD - 5686-066-06-C660              @D66IDAK 02650008
&EOF     SETC  '*'                                                      02700000
&ERRTN   SETC  '0'                                                      02750000
&EXT     SETC  '0'                                                      02800000
&LABDR   SETC  '*'                                                      02850000
&CCODE   SETC  '6'                                                      02900000
         AIF   (T'&IOAREA1 NE 'O').INM05                            4-0 02950000
&IOA1    SETC  '*'                                                  4-0 03000000
.INM05   ANOP                                                       4-0 03050000
&B(2)    SETB  ('&TYPEFLE' EQ 'INPUT')                                  03100000
&B(3)    SETB  ('&TYPEFLE' EQ 'OUTPUT')                                 03150000
&B(4)    SETB  ('&TYPEFLE' EQ 'WORK')                                   03200000
&B(17)   SETB  ('&TYPEFLE' EQ 'WORKIN')                        @D51ZDRP 03250000
&B(18)   SETB  ('&TYPEFLE' EQ 'WORKINUP')                      @D51ZDRP 03300000
&B(19)   SETB  ('&TYPEFLE' EQ 'WORKMOD')                       @D51ZDRP 03350000
&B(4)    SETB  (&B(4) OR &B(17) OR &B(18) OR &B(19))           @D51ZDRP 03400000
&B(6)    SETB  ('&RECFORM' EQ 'FIXUNB')                                 03450000
&B(7)    SETB  ('&RECFORM' EQ 'FIXBLK')                                 03500000
&B(8)    SETB  ('&RECFORM' EQ 'VARUNB')                                 03550000
&B(9)    SETB  ('&RECFORM' EQ 'VARBLK')                                 03600000
&B(10)   SETB  ('&RECFORM' EQ 'UNDEF')                                  03650000
&B(11)   SETB  (&B(8) OR &B(9) OR &B(10))                               03700000
&B(14)   SETB  ('&RECFORM' EQ 'SPNUNB')                             3-5 03750000
&B(13)   SETB  ('&RECFORM' EQ 'SPNBLK')                             3-5 03800000
         AIF   (T'&CISIZE EQ 'N').CISDT                        @D36KE6D 03850000
         MNOTE 0,'CISIZE NOT SELF DEFINING TERM. IGNORED.'     @D14CDHK 03900000
         AGO   .CINSDT                                         @D35DE98 03950000
.CISDT   ANOP                                                  @D35DE98 04000000
&CISZ    SETA  &CISIZE                                         @D35DE98 04050000
.CINSDT  ANOP                                                  @D35DE98 04100000
         AIF   (&CISZ LE 32768).FBA2                           @D35DE98 04150000
         MNOTE 0,'CISIZE GREATER THAN 32K. SET TO 32K'         @D35DE98 04200000
&CISZ    SETA  32768                                           @D35DE98 04250000
.FBA2    ANOP                                                  @D35DE98 04300000
&VER3FLG SETA  &VER3FLG+128+8+4+2 INDICATE EXISTENCE OF        @D14CDHK 04350000
.*      CISIZE, CI-EXTENDED, DATA SECURITY AND EOX-RTN FIELDS  @D14CDHK 04400000
         AIF   ('&DEVICE' NE 'FBA').FBA3                       @DA22962 04450000
&FBA     SETB  1                                               @DA22962 04500000
.FBA3    ANOP                                                  @DA22962 04550000
         AIF   ('&PWRITE' EQ 'YES').FBA4                       @D35DE98 04600000
         AGO   .FBA5                                           @D35DE98 04650000
.FBA4    AIF   (NOT &B(2)).FBA6A                               @D35KE97 04700000
         MNOTE 0,'PWRITE INVALID FOR INPUT. IGNORED.'          @D35DE98 04750000
         AGO   .FBA5                                           @D35DE98 04800000
.FBA6A   ANOP                                                  @D35DE98 04850000
&VER3FLG SETA  &VER3FLG+64  INDICATE PWRITE                    @D35DE98 04900000
.* THE FOLLOWING CODE DETERMINES THE VALIDITY OF OMITTING      @D35DE98 04950000
.* THE IOAREA PARAMETER ON THE DTF SPECIFICATION. OMISSION     @D35DE98 05000000
.* OF IOAREA1 IS VALID WHENEVER WORKA=YES IS SPECIFIED         @D35DE98 05050000
.* OR DEFAULTED TO, IF IOREG IS SPECIFIED OR DEFAULTED TO      @D35DE98 05100000
.* FOR ANY FILE.                                               @D14CDHK 05150000
.FBA5    ANOP                                                  @D35DE98 05200000
         AIF   (NOT &B(13) AND NOT &B(14)).NODEFW              @D35DE98 05250000
&DEFW    SETB  1                                               @D35DE98 05300000
.NODEFW  ANOP                                                  @D35DE98 05350000
         AIF   (NOT &B(7) AND NOT &B(9)).NODEFR                @D35DE98 05400000
&DEFR    SETB  1                                               @D35DE98 05450000
.NODEFR  ANOP                                                  @D35DE98 05500000
         AIF   (T'&IOREG EQ 'O' AND T'&WORKA EQ 'O').FBA10     @D35DE98 05550000
         AGO   .FBA11                                          @D35DE98 05600000
.FBA10   ANOP                                                  @D35DE98 05650000
         AIF   (&DEFW OR &DEFR).FBA11                          @D35DE98 05700000
&IOANOP  SETB  1                                               @D35DE98 05750000
.FBA11   ANOP                                                  @D35DE98 05800000
         AIF   (T'&IOREG NE 'O' AND &B(3) AND &B(11)).FBA12    @D35DE98 05850000
         AGO   .FBA13                                          @D35DE98 05900000
.FBA12   ANOP                                                  @D35DE98 05950000
&IOANOP  SETB  1                                               @D35DE98 06000000
.FBA13   ANOP                                                  @D35DE98 06050000
         AIF   (&DEFR AND &B(3) AND &B(11)).FBA12A             @D35DE98 06100000
         AGO   .FBA13A                                         @D35DE98 06150000
.FBA12A  ANOP                                                  @D35DE98 06200000
&IOANOP  SETB  1                                               @D35DE98 06250000
.FBA13A  ANOP                                                  @D35DE98 06300000
         AIF (T'&IOREG  NE 'O' AND '&TRUNCS' EQ 'YES' AND &B(3)).FBA14  06350000
         AGO   .FBA15                                          @D35DE98 06400000
.FBA14   ANOP                                                  @D35DE98 06450000
&IOANOP  SETB  1                                               @D35DE98 06500000
.FBA15   ANOP                                                  @D35DE98 06550000
         AIF   (&DEFR AND '&TRUNCS' EQ 'YES' AND &B(3)).FBA14A @D35DE98 06600000
         AGO   .FBA15A                                         @D35DE98 06650000
.FBA14A  ANOP                                                  @D35DE98 06700000
&IOANOP  SETB  1                                               @D35DE98 06750000
.FBA15A  ANOP                                                  @D35DE98 06800000
         AIF   (T'&WORKA EQ 'O' AND T'&IOREG EQ 'O').FBA15B    @D14CDHK 06850000
&IOANOP  SETB  0                                               @D36KE97 06900000
.FBA15B  ANOP                                                  @D36KE97 06950000
         AIF   (T'&ERROPT NE 'O').INM10                             3-4 07000000
         AIF   (T'&ERREXT EQ 'O').INM20                             3-4 07050000
         MNOTE 0,'ERROPT OMITTED. ERREXT IGNORED.'                  3-4 07100000
         AGO   .INM20                                               3-4 07150000
.INM10   AIF   (T'&ERREXT EQ 'O').INM20                             3-4 07200000
         AIF   ('&ERREXT' EQ 'YES').INM20                           3-4 07250000
         MNOTE 0,'IMPROPER ERREXT PARAMETER. ''YES'' ASSUMED.'      3-4 07300000
.INM20   ANOP                                                       3-4 07350000
         AIF   (T'&RDONLY EQ 'O' OR '&RDONLY' EQ 'YES').RD1A        3-3 07400000
         MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED.'                3-3 07450000
.RD1A    AIF   (T'&FILEN NE 'O').D001                               3-3 07500000
         MNOTE 0,'NO FILENAME SPECIFIED'                                07550000
.D001    AIF   (T'&BLKSIZE NE 'O').D002                                 07600000
         MNOTE 0,'NO BLKSIZE SPEC.SET TO 10'                            07650000
&BLKS    SETA  10                                                       07700000
&B(1)    SETB  1                        SET SWITCH TO IGNORE BLKS/RECS  07750000
         AGO   .D004                                                    07800000
.D002    AIF   (T'&BLKSIZE EQ 'N').D003                                 07850000
&B(1)    SETB  1                        IGN BLK/REC CALCULATION@D14CDHK 07900000
         AIF   ('&BLKSIZE' EQ 'MAX').D0021                     @D14CDHK 07950000
         MNOTE 0,'BLKSIZE NOT A NUMBER.SET TO 10'                       08000000
&BLKS    SETA  10                                                       08050000
         AGO   .D004                                                    08100000
.D0021   ANOP                                                  @D14CDHK 08150000
&BLKS    SETA  65535                    FFFF INDICATES MAX BLK @D14CDHK 08200000
         AIF   (&CISZ EQ 0).MAX1                               @D14CDRP 08250000
         MNOTE 0,'CISIZE IGNORED, DUE TO BLKSIZE=MAX'          @D14CDRP 08300000
&CISZ    SETA  0                                               @D14CDRP 08350000
.MAX1    ANOP                                                  @D14CDRP 08400000
         AGO   .D004                                           @D14CDHK 08450000
.D003    AIF   ('&TYPEFLE' NE 'OUTPUT').D0033                           08500000
&BLKS    SETA  &BLKSIZE                                                 08550000
         AIF   (&BLKS GT 8).D0033                                       08600000
         MNOTE 0,'BLKSIZE LESS THAN 9 OUTPUT FILE.SET TO 10'            08650000
&BLKS    SETA  10                                                       08700000
&B(1)    SETB  1                                                        08750000
         AGO   .D004                                                    08800000
.D0033   ANOP                                                           08850000
&BLKS    SETA  &BLKSIZE-8                                               08900000
&RECS    SETA  (32768-7+8)                                     @D36KE6D 08950000
         AIF   (&FBA).D0031L                                   @D36KE6D 09000000
&BLKS    SETA  &BLKSIZE-8                                      @D36KE6D 09050000
&RECS    SETA  19077                                           @D36KE6D 09100000
         AIF   ('&DEVICE' EQ '3350').D0031J                    @D36KE6D 09150000
&RECS    SETA  8376                                            @D36KE6D 09200000
         AIF   ('&DEVICE' EQ '3340').D0031G                    @D36KE6D 09250000
&RECS    SETA  13038                                           @D36KE6D 09300000
         AIF   ('&DEVICE' EQ '3330').D0031C                    @D36KE6D 09350000
&RECS    SETA  7302                                            @D36KE6D 09400000
         AIF   ('&DEVICE' EQ '2314').D0031A                    @D36KE6D 09450000
&RECS    SETA  3633                                                     09500000
         AIF   (&B(3)).D0031                                            09550000
&BLKS    SETA  &BLKSIZE                                                 09600000
&RECS    SETA  3625                                                     09650000
.D0031   ANOP                                                  @D36KE97 09700000
         AGO   .D004                                                    09750000
.D0031A  AIF   (&B(3)).D004                                    @D36KE6D 09800000
&BLKS    SETA  &BLKSIZE                                                 09850000
&RECS    SETA  7294                                                     09900000
         AGO   .D004                                                4-0 09950000
.D0031C  AIF   (&B(3)).D004                                    @D36KE6D 10000000
&BLKS    SETA  &BLKSIZE                                             4-0 10050000
&RECS    SETA  13030                                                4-0 10100000
         AGO   .D004                                           @DL2W720 10150000
.D0031G  AIF   (&B(3)).D004                                    @D36KE6D 10200000
&BLKS    SETA  &BLKSIZE                                        @DL2W720 10250000
&RECS    SETA  8368                                            @DL2W720 10300000
         AGO   .D004                                           @D34DEF4 10350000
.D0031J  ANOP                                                  @D34DEF4 10400000
         AIF   (&B(3)).D004                                    @D36KE6D 10450000
&BLKS    SETA  &BLKSIZE                                        @D34DEF4 10500000
&RECS    SETA  19069                                           @D34DEF4 10550000
         AGO   .D004                                           @D34DEF4 10600000
.D0031L  ANOP                                                  @D35DE98 10650000
         AIF   (&B(3)).D004                                    @D36KE6D 10700000
&BLKS    SETA  &BLKSIZE                                        @D35DE98 10750000
&RECS    SETA  (32768-7)                                       @D35DE98 10800000
.D004    AIF   (T'&CONTROL EQ 'O' OR '&CONTROL' EQ 'YES').D0041         10850000
         MNOTE 0,'IMPROPER CONTROL.''YES'' ASSUMED'                     10900000
.D0041   AIF   (T'&EOXPTR EQ 'O').D0041B EOXPTR SPEC. AND NOT  @D14CDHK 10950000
         AIF   (NOT &B(4) AND NOT &B(3)).D0041A WORKF OR OUTPUT@D14CDHK 11000000
         AIF   (&B(17)).D0041A         BRANCH IF WORKIN        @D51ZDRP 11050000
&EXT     SETC  '&EOXPTR'               GET EXIT PTR ADDRESS    @D14CDHK 11100000
         AGO   .D0041B                 CONTINUE                @D14CDHK 11150000
.D0041A  MNOTE 0,'EOXPTR INVALID PARAMETER.IGNORED'                     11200000
.D0041B  AIF   (T'&DELETFL EQ 'O').D0043                                11250000
         AIF   (&B(4)).D0042                                            11300000
         MNOTE 0,'DELETFL INVALID PARAMETER.IGNORED'                    11350000
         AGO   .D0043                                                   11400000
.D0042   AIF   ('&DELETFL' EQ 'NO').D0043                               11450000
         MNOTE 0,'IMPROPER DELETFL.''NO'' ASSUMED'                      11500000
.D0043   ANOP                                                  @D36KE97 11550000
         AIF   (&B(3)).D006                                             11600000
         AIF   (T'&EOFADDR NE 'O').D005                                 11650000
         MNOTE 0,'NO EOFADDR SPEC.SET TO *'                             11700000
         AGO   .D006                                                    11750000
.D005    ANOP                                                           11800000
&EOF     SETC  '&EOFADDR'                                               11850000
         AGO   .D0063                                                   11900000
.D006    AIF   (T'&EOFADDR EQ 'O').D0063                                11950000
         MNOTE 0,'EOFADDR SPECIFIED FOR OUTPUT FILE.IGNORED'            12000000
.D0063   AIF   (T'&ERROPT EQ 'O').D007                                  12050000
         AIF   ('&ERROPT' EQ 'IGNORE').D0061                            12100000
         AIF   ('&ERROPT' EQ 'SKIP').D0062                              12150000
         AIF   (T'&ERROPT EQ 'I' OR T'&ERROPT EQ 'M' OR T'&ERROPT EQ 'T-12200000
               ' OR T'&ERROPT EQ 'U').D0065                             12250000
         MNOTE *,'***** ERROPT POSSIBLE ERROR *****'                    12300000
.D0065   ANOP                                                       3-9 12350000
&ERRTN   SETC  '&ERROPT'                                                12400000
&LNDIC   SETA  &LNDIC+128     LOGICAL INDIC-SET BIT 0 ON-ERROPT=NAME    12450000
         AGO   .D007                                                    12500000
.D0061   ANOP                                                           12550000
&LNDIC   SETA  &LNDIC+64      LOGICAL INDIC-SET BIT 1 ON-ERROPT=IGNORE  12600000
         AGO   .D007                                                    12650000
.D0062   AIF   (&B(4)).D00625          IF WORKFILE                  3-3 12700000
&LNDIC   SETA  &LNDIC+32      LOGICAL INDIC-SET BIT 2 ON-ERROPT=SKIP    12750000
         AGO   .D007                                                3-3 12800000
.D00625  ANOP                                                       3-3 12850000
&LNDIC   SETA  &LNDIC+8   LOGICAL INDIC-SET BIT 4 ON-ERROPT=SKIP    3-3 12900000
.D007    AIF   ('&FEOVD' EQ '').D007A                               3-9 12950000
         AIF   (&B(4)).D007B                                        3-9 13000000
         AIF   ('&FEOVD' EQ 'YES').D007A                            3-9 13050000
         MNOTE 0,'IMPROPER FEOVD SPEC., ''YES'' ASSUMED'            3-9 13100000
         AGO   .D007A                                               3-9 13150000
.D007B   MNOTE 0,'FEOVD AND WORKFILE SPEC., FEOVD IGNORED'          3-9 13200000
.D007A   AIF   (NOT &B(4)).D0075                                    3-9 13250000
         AIF   (T'&IOAREA1 EQ 'O').D0071                                13300000
         MNOTE 0,'IOAREA1 INVALID PARAMETER.IGNORED'                    13350000
.D0071   AIF   (T'&IOAREA2 EQ 'O').D011                                 13400000
         MNOTE 0,'IOAREA2 INVALID PARAMETER.IGNORED'                    13450000
         AGO   .D011                                                    13500000
.D0075   AIF   (T'&IOAREA1 NE  'O').D009                                13550000
         AIF   (&IOANOP).FBA24                                 @D35DE98 13600000
&VER3FLG SETA  &VER3FLG+32  INDICATE NO IOAREA SPECIFIED       @D35DE98 13650000
         AGO   .D009                                           @D35DE98 13700000
.FBA24   ANOP                                                  @D35DE98 13750000
         MNOTE 0,'IOAREA1 NOT SPEC.SET TO *'                            13800000
         AGO   .D010                                                    13850000
.D009    ANOP                                                           13900000
.D010    AIF   (T'&IOAREA2 EQ 'O' OR &B(4)).D011                        13950000
&LNDIC   SETA  &LNDIC+8       LOGICAL INDIC-SET BIT 4 ON-TWO IOAREAS    14000000
.D011    AIF   (T'&IOREG EQ 'O').D014                                   14050000
         AIF   (T'&WORKA NE 'O').D0113                                  14100000
         AIF   (NOT &B(4)).D0115                                        14150000
.D0113   ANOP                                                           14200000
         MNOTE 0,'IOREG INVALID PARAMETER.IGNORED'                      14250000
         AGO   .D014                                                    14300000
.D0115   ANOP                                                           14350000
&IORE    SETA  2                                                        14400000
         AIF   ('&IOREG'(1,1) EQ '(' AND '&IOREG'(K'&IOREG,1) EQ ')').D-14450000
               012                                                      14500000
         MNOTE 0,'IOREG NOT WITHIN PARENTHESES'                         14550000
.D012    AIF   ('&IOREG(1)' GT '1' AND '&IOREG(1)' LT '13' AND T'&IOREG-14600000
               (1) EQ 'N').D013                                         14650000
         MNOTE 0,'IOREG NOT A REG. 2-12.SET TO REG 2'               3-3 14700000
         AGO   .D014                                                    14750000
.D013    ANOP                                                           14800000
&IORE    SETA  &IOREG(1)                                                14850000
.D014    AIF   (T'&LABADDR EQ 'O').D015                                 14900000
&LABDR   SETC  '&LABADDR'                                               14950000
         AIF   (NOT &B(4)).D0145                                        15000000
         MNOTE 0,'LABADDR INVALID PARAMETER.IGNORED'                    15050000
         AGO   .D015                                                    15100000
.D0145   AIF   (T'&LABADDR EQ 'I' OR T'&LABADDR EQ 'M' OR T'&LABADDR EQ-15150000
                'T' OR T'&LABADDR EQ 'U').D015                          15200000
         MNOTE *,'***** LABADDR POSSIBLE ERROR *****'                   15250000
.D015    AIF   (T'&NOTEPNT EQ 'O').D017                                 15300000
         AIF   (&B(4)).D016                                             15350000
         MNOTE 0,'NOTEPNT INVALID PARAMETER.IGNORED'                    15400000
         AGO   .D017                                                    15450000
.D016    AIF   ('&NOTEPNT' EQ 'POINTRW').D017                       3-8 15500000
&B(16)   SETB  1                                                    3-8 15550000
         AIF   ('&NOTEPNT' EQ 'YES').D017                           3-8 15600000
         MNOTE 0,'IMPROPER NOTEPNT.''YES'' ASSUMED'                     15650000
.D017    AIF   (NOT &B(4)).D017A                                        15700000
         AIF   (&B(6) OR &B(10)).D017A                                  15750000
&B(6)    SETB  1                                                        15800000
         MNOTE 0,'IMPROPER RECFORM.''FIXUNB'' ASSUMED' FOR WORKFILES    15850000
         AGO   .D018                                                    15900000
.D017A   AIF   (&B(6) OR &B(8) OR &B(9)).D018                           15950000
         AIF   (&B(14) OR &B(13)).D022                              3-5 16000000
&RECS    SETA  1                                                        16050000
         AIF   (&B(7)).D019                                             16100004
         AIF   (&B(10)).D022                                            16150000
&B(6)    SETB  1                                                        16200000
         MNOTE 0,'IMPROPER RECFORM.''FIXUNB'' ASSUMED'                  16250000
.D018    AIF   (T'&RECSIZE EQ 'O').D018A                                16300000
         MNOTE 0,'RECSIZE INVALID PARAMETER.IGNORED'                    16350000
.D018A   ANOP                                                           16400000
&RECS    SETA  &BLKS                                                    16450000
         AIF   (&B(6)).D0255  IF FIXUNB                                 16500000
         AGO   .D026A                                                   16550002
.D019    AIF   (T'&RECSIZE NE 'O').D020                                 16600004
         MNOTE 0,'NO RECSIZE SPECIFIED.SET TO 1'                        16650004
         AGO   .D026A                                                   16700000
.D020    AIF   (T'&RECSIZE EQ 'N').D020A                       @D66IDAK 16750006
         MNOTE 0,'RECSIZE NOT A NUMBER.SET TO 1'                        16800000
         AGO   .D026A                                                   16850000
.D020A   AIF   ('&RECSIZE'(1,1) NE '(' ).D021                  @D66IDAK 16860006
         MNOTE 0,'RECSIZE MUST BE A NUMBER.SET TO 1'           @D66IDAK 16880007
         AGO   .D026A                                          @D66IDAK 16890007
.D021    ANOP                                                           16900000
&RECS    SETA  &RECSIZE(1)                                              16950000
         AIF   (&B(1)).D026A      IGNORE BLKS/RECS?            @D14ZDBF 17000000
         AIF   (&BLKS/&RECS*&RECS EQ &BLKS).D0255                       17050000
         AIF   (&B(3)).D021A      TYPEFILE=OUTPUT?             @D14ZDBF 17100000
         MNOTE 0,'BLOCKSIZE NOT A MULTIPLE OF RECSIZE'                  17150000
         AGO   .D021B                                          @D14ZDBF 17200000
.D021A   MNOTE 0,'BLOCKSIZE-8 NOT A MULTIPLE OF RECSIZE'       @D14ZDBF 17250000
.D021B   ANOP                                                  @D14ZDBF 17300000
&TERM    SETB  1                                                        17350000
         AGO   .D026A                                                   17400000
.D022    AIF   (&B(4)).D018  GO TO CHECK IF RECSIZE SPEC FOR WK FILE    17450000
&RECS    SETA  0                                                    3-5 17500000
         AIF   (&B(2) AND &B(10) AND T'&RECSIZE EQ 'O').D026A       3-5 17550000
&RECS    SETA  2                                                        17600000
         AIF   (T'&RECSIZE NE 'O').D023                                 17650000
         MNOTE 0,'NO RECSIZE SPECIFIED.SET TO REG 2'                    17700000
         AGO   .D026A                                                   17750000
.D023    AIF   ('&RECSIZE'(1,1) EQ '(' AND '&RECSIZE'(K'&RECSIZE,1) EQ -17800000
               ')').D024                                                17850000
         MNOTE 0,'RECSIZE NOT WITHIN PARENTHESES'                       17900000
.D024    AIF   ('&RECSIZE(1)' GT '1' AND '&RECSIZE(1)' LT '13' AND T'&R-17950000
               ECSIZE(1) EQ 'N').D025                                   18000000
         MNOTE 0,'RECSIZE NOT A REG. 2-12.SET TO REG 2'             3-3 18050000
         AGO   .D026A                                                   18100000
.D025    ANOP                                                           18150000
&RECS    SETA  &RECSIZE(1)                                              18200000
         AGO   .D026A                                                   18250000
.D0255   ANOP                                                  @D34DEF4 18300000
         AIF   (&FBA).D026A                                    @D35DE98 18350000
         AIF   ('&DEVICE' EQ '2314').D025A                     @D34DEF4 18400000
         AIF   ('&DEVICE' EQ '3330').D0255B                         4-0 18450000
         AIF   ('&DEVICE' EQ '3340').D0255C                    @DL2W720 18500000
         AIF   ('&DEVICE' EQ '3350').D0255D                    @D34DEF4 18550000
&RECNUM(1) SETA &BLKS*537/512+61        SIZE OF NORMAL RECORD           18600000
&RECNUM(2) SETA 3625/&RECNUM(1)         NORMAL RECORDS PER TRACK        18650000
&RECNUM(3) SETA &RECNUM(1)*&RECNUM(2)   SIZE OF RCD X RCDS/TRACK        18700000
&RECNUM(1) SETA 3625-&RECNUM(3)         REMAINDER FOR LAST RECORD       18750000
         AGO   .D0257                                                   18800000
.D025A   ANOP                                                           18850000
&RECNUM(1) SETA &BLKS*534/512+101                                       18900000
&RECNUM(2) SETA 7294/&RECNUM(1)                                         18950000
&RECNUM(3) SETA &RECNUM(1)*&RECNUM(2)                                   19000000
&RECNUM(1) SETA 7294-&RECNUM(3)                                         19050000
         AGO   .D0257                                                   19100000
.D0255B  ANOP                                                       4-0 19150000
&RECNUM(1) SETA &BLKS+135               SIZE OF NORMAL RECORD       4-0 19200000
&RECNUM(2) SETA 13165/&RECNUM(1)        RECORDS PER TRACK           4-0 19250000
         AGO   .D026                                                4-0 19300000
.D0255C  ANOP                                                  @DL2W720 19350000
&RECNUM(1) SETA  &BLKS+167             SIZE OF NORMAL RECORD   @DL2W720 19400000
&RECNUM(2) SETA  8535/&RECNUM(1)       RECORDS PER TRACK       @DL2W720 19450000
         AGO   .D026                                           @DL2W720 19500000
.D0255D  ANOP                                                  @D34DEF4 19550000
&RECNUM(1) SETA  &BLKS+185                                     @DA11631 19600000
&RECNUM(2) SETA  19254/&RECNUM(1)                              @D34DEF4 19650000
         AGO   .D026                                           @D34DEF4 19700000
.D0257   AIF   (&BLKS GT &RECNUM(1)).D026                               19750000
&RECNUM(2) SETA &RECNUM(2)+1                                            19800000
.D026    AIF   (NOT &B(3)).D026A                                        19850000
&RECNUM(2) SETA &RECNUM(2)-1                                            19900000
.D026A   ANOP                                                       3-3 19950000
         AIF   (T'&HOLD EQ 'O').BK20A                              S3-5 20000000
         AIF   (T'&UPDATE NE 'O' AND NOT &B(3)).D026A1              3-3 20050000
         MNOTE 0,'HOLD INVALID WITHOUT UPDATE AND FOR OUTPUT-IGNORED' 3 20100000
         AGO   .BK20                                                3-3 20150000
.D026A1  AIF   ('&HOLD' EQ 'YES').BK10                              3-3 20200000
         MNOTE 0,'IMPROPER HOLD PARAMETER. YES ASSUMED'             3-3 20250000
.BK10    ANOP                                                       3-3 20300000
&B(12)   SETB  1                                                    3-4 20350000
&TRKHLD  SETA  &TRKHLD+16    SET BIT 3 FOR HOLD = YES          @D14CDKH 20400000
.BK20A   AIF   (NOT &B(14) AND NOT &B(13)).BK20                     3-5 20450000
&TRKHLD  SETA  &TRKHLD+2     SET BIT 6 TO INDICATE SPN             S3-5 20500000
.BK20    AIF   (T'&SEPASMB EQ 'O' OR '&SEPASMB' EQ 'YES').D026B     3-3 20550000
         MNOTE 0,'IMPROPER SEPASMB.''YES'' ASSUMED'                     20600000
.D026B   ANOP                                                       3-3 20650000
&T(1)    SETB  1                                                    3-3 20700000
         AIF   (T'&TRUNCS EQ 'O').D0265                             3-3 20750000
         AIF   (&B(4)).D0261                                            20800000
         AIF   (&B(7)).D0262                                            20850000
.D0261   MNOTE 0,'TRUNCS INVALID PARAMETER.IGNORED'                     20900000
         AGO   .D0265                                                   20950000
.D0262   AIF   ('&TRUNCS' EQ 'YES').D0263                           3-2 21000000
         MNOTE 0,'IMPROPER TRUNCS.''YES'' ASSUMED'                      21050000
.D0263   ANOP                                                       3-2 21100000
&T(1)    SETB  0                                                    3-3 21150000
.D0265   AIF   (&B(2) OR &B(4)).D028                                    21200000
         AIF   (&B(3)).D027                                             21250000
         MNOTE 0,'IMPROPER TYPEFLE.''INPUT'' ASSUMED'                   21300000
&B(2)    SETB  1                                                    3-8 21350000
         AGO   .D028                                                    21400000
.D027    AIF   (T'&UPDATE EQ 'O').D029                              3-4 21450000
         MNOTE 0,'UPDATE SPECIFIED ON TYPEFLE OTHER THAN INPUT.IGNORED' 21500000
         AGO   .D029                                                3-4 21550000
.D028    AIF   (T'&UPDATE EQ 'O').D029                                  21600000
         AIF   (NOT &B(17)).D028A    TYPEFLE=WORKIN            @D51ZDRP 21650000
         MNOTE 0,'UPDATE SPECIFIED ON TYPEFLE=WORKIN. IGNORED' @D51ZDRP 21700000
         AGO   .D029                                           @D51ZDRP 21750000
.D028A   ANOP                                                  @D51ZDRP 21800000
&B(15)   SETB  1                                                    3-8 21850000
         AIF   ('&UPDATE' EQ 'YES').D029                                21900000
         MNOTE 0,'IMPROPER UPDATE.''YES'' ASSUMED'                      21950000
.D029    AIF   (T'&WORKA EQ 'O' AND &B(3) AND &B(9)).D030               22000000
         AIF   (T'&VARBLD EQ 'O').D034                                  22050000
         MNOTE 0,'VARBLD REGISTER NOT NEEDED.IGNORED'                   22100000
         AGO   .D034                                                    22150000
.D030    ANOP                                                           22200000
&VBLD    SETA  2                                                        22250000
         AIF   (T'&VARBLD NE 'O').D031                                  22300000
         MNOTE 0,'NO VARBLD SPECIFIED.SET TO REG 2'                     22350000
         AGO   .D034                                                    22400000
.D031    AIF   ('&VARBLD'(1,1) EQ '(' AND '&VARBLD'(K'&VARBLD,1) EQ ')'-22450000
               ).D032                                                   22500000
         MNOTE 0,'VARBLD NOT WITHIN PARENTHESES'                        22550000
.D032    AIF   ('&VARBLD(1)' GT '1' AND '&VARBLD(1)' LT '13' AND T'&VAR-22600000
               BLD(1) EQ 'N').D033                                  3-5 22650000
         MNOTE 0,'VARBLD NOT A REG. 2-12. SET TO REG. 2'            3-5 22700000
         AGO   .D034                                                    22750000
.D033    ANOP                                                           22800000
&VBLD    SETA  &VARBLD(1)                                               22850000
.D034    AIF   (T'&VERIFY EQ 'O').D0345                        @D36KE97 22900000
         AIF   ('&VERIFY' EQ 'YES').D0341                               22950000
         MNOTE 0,'IMPROPER VERIFY.''YES'' ASSUMED'                      23000000
         AGO   .D0341                                                   23050000
.D0340   MNOTE 0,'VERIFY SPEC. ON INPUT FILE WITHOUT UPDATE...IGNORED'  23100000
         AGO   .D0345                                                   23150000
.D0341   AIF   (&B(3)).D0342                                            23200000
         AIF   (&B(4)).D0342                                            23250000
         AIF   (T'&UPDATE EQ 'O').D0340                                 23300000
.D0342   ANOP                                                           23350000
&LNDIC   SETA  &LNDIC+16      LOGICAL INDIC-SET BIT 3 ON-VERIFY=YES     23400000
&VRFY    SETA  64                                                       23450000
.D0345   AIF   (T'&WLRERR EQ 'O').D035                                  23500000
         AIF   (NOT &B(4)).D03451                                       23550000
.D03450  MNOTE 0,'WLRERR INVALID PARAMETER.IGNORED'                     23600000
         AGO   .D035                                                    23650000
.D03451  AIF   (&B(3)).D03450                                           23700000
         AIF   (&B(10)).D03450                                          23750000
         AIF   (T'&WLRERR EQ 'I' OR T'&WLRERR EQ 'M' OR T'&WLRERR EQ 'T-23800000
               ' OR T'&WLRERR EQ 'U').D0347                             23850000
         MNOTE *,'***** WLRERR POSSIBLE ERROR *****'                    23900000
.D0347   ANOP                                                           23950000
&LNDIC   SETA  &LNDIC+4       LOGICAL INDIC-SET BIT 5 ON-WLRERR         24000000
.D035    AIF   (NOT &B(14) AND NOT &B(13)).D035A                    3-5 24050000
         AIF   (T'&WORKA NE 'O').D0355                              3-5 24100000
         MNOTE 0,'MISSING WORKA WITH RECFORM=SPNUNB OR RECFORM=SPNBLK..X24150000
               . WORKA=YES ASSUMED.'                                3-5 24200000
         AGO   .D037                                                3-5 24250000
.D035A   AIF   (T'&WORKA EQ 'O').D036                               3-5 24300000
         AIF   (NOT &B(4)).D0355                                        24350000
         MNOTE 0,'WORKA INVALID PARAMETER.IGNORED'                      24400000
         AGO   .D037                                                    24450000
.D0355   AIF   ('&WORKA' EQ 'YES').D036                                 24500000
         MNOTE 0,'IMPROPER WORKA.''YES'' ASSUMED'                       24550000
.D036    AIF   (NOT &B(7) AND NOT &B(9) AND T'&IOAREA2 EQ 'O').D037     24600000
         AIF   (&B(4)).D037                                             24650000
         AIF   (T'&WORKA NE 'O' OR T'&IOREG NE 'O').D037                24700000
         MNOTE 0,'NO WORKAREA OR IOREG SPEC..IOREG SET TO REG 2'        24750000
&IORE    SETA  2                                                        24800000
.* DTF TABLE GENERATION                                                 24850000
.D037    AIF   (K'&FILEN GT 7).NOTE                                     24900000
         AIF   (T'&FILEN NE 'O').DV001                                  24950000
.NOTE    MNOTE 9,'IMPROPER OR MISSING FILENAME.GENERATION TERMINATED'   25000000
         MEXIT                                                          25050000
.DV001   AIF   (T'&DEVADDR EQ 'O').DVSET                                25100000
         AIF   (K'&DEVADDR NE 6 OR '&DEVADDR'(1,3) NE 'SYS').DVMSG      25150000
&DVADR   SETC  '&DEVADDR'(4,3)                                          25200000
         AIF   ('&DVADR' LT '000' OR '&DVADR' GT '254').DV002  @DA31417 25250000
         AIF   ('&DVADR'(2,1) LT '0' OR '&DVADR'(2,1) GT '9').DVMSG     25300000
         AIF   ('&DVADR'(3,1) LT '0' OR '&DVADR'(3,1) GT '9').DVMSG     25350000
&CLASS   SETA  1                                                        25400000
&NUM     SETA  &DVADR                                                   25450000
         AGO   .DV005                                          @D36KE97 25500000
.DV002   AIF   ('&DVADR' EQ 'RDRIPTPCHLSTLSTLNKRESSLBRLBRESRECCLB'(3*&N-25550000
               UM+1,3)).DVOK                                        3-9 25600000
&NUM     SETA  &NUM+1                                                   25650000
         AIF   (&NUM LE 11).DV002                                   3-9 25700000
         MNOTE *,'&DEVADDR IMPROPER DEVADDR, ''FFFF'' GENERATED'        25750000
         AGO   .DVSET                                                   25800000
.DVOK    AIF   (T'&LABADDR EQ 'O').DV004                       @D36KE97 25850000
         MNOTE 0,'&LABADDR INVALID FOR SYSTEM UNITS, IGNORED'           25900000
&LABNG   SETB  1                                                        25950000
.DV004   AIF   ('&TYPEFLE' NE 'WORK').DV005                             26000000
         MNOTE 9,'&DEVADDR INVALID FOR WORK FILES, MACRO TERMINATED'    26050000
         MEXIT                                                          26100000
.DVMSG   MNOTE 0,'&DEVADDR IMPROPER DEVADDR, ''FFFF'' GENERATED'        26150000
.DVSET   ANOP                                                           26200000
&CLASS   SETA  255                                                      26250000
&NUM     SETA  255                                                      26300000
.DV005   AIF   (NOT &TERM).CONTIN                                   4-0 26350000
         MNOTE 9,'MACRO GENERATION TERMINATED.'                     4-0 26400000
         MEXIT                                                      4-0 26450000
.CONTIN  AIF   (T'&SEPASMB EQ 'O').T005                             4-0 26500000
         PUNCH ' CATALOG &FILEN..OBJ   REPLACE=YES'            @D14CDKY 26550000
&FILEN.C CSECT                                                          26600000
         ENTRY &FILEN                                                   26650000
.T005    ANOP                                                  @D35DE98 26700000
         DC    0D'0'                                           @D35DE98 26750000
         DC    AL2(IJJZ&SYSNDX-IJGZ&SYSNDX) VERSION 3 LENGTH   @D14CDHK 26800000
         DC    H'0'              RESERVED FOR IBM USE          @D14CDHK 26850000
         DC    A(IJGZ&SYSNDX)    VERSION 3 DTF AREA POINTER    @D35DE98 26900000
.FBA17   ANOP                                                  @D35DE98 26950000
         AIF   (T'&ERROPT EQ 'O').T010                                  27000000
&FILEN   DC    X'000092040000'         CCB                          3-4 27050000
         AGO   .T020                                                3-4 27100000
.T010    ANOP                                                  @D14CDHK 27150000
&FILEN   DC    X'000080040000'          CCB                             27200000
.T020    ANOP                                                           27250000
         DC    AL1(&CLASS)              LOGICAL UNIT CLASS              27300000
         DC    AL1(&NUM)                LOGICAL UNIT NUMBER             27350000
         DC    A(IJGC&SYSNDX)           CCB-CCW ADDRESS                 27400000
         DC    4X'00'                   CCB-ST BYTE,CSW CCW ADDRESS     27450000
         DC    AL1(&TRKHLD)                                         3-3 27500000
         DC    X'000000'                LOGIC MODULE ADDRESS   @D35DE98 27550000
         DC    X'20'                    DTF TYPE               @D36KE97 27600000
&NUMB    SETA  3625                                                     27650000
         AIF   (NOT &FBA).T200C                                @D35DE98 27700000
&NUMB    SETA  (32768-7)                                       @D35DE98 27750000
         AGO   .T210                                           @D35DE98 27800000
.T200C   ANOP                                                  @D35DE98 27850000
         AIF   ('&DEVICE' NE '3350').T200B                     @D34DEF4 27900000
&NUMB    SETA  19069                                           @D34DEF4 27950000
.T200B   ANOP                                                  @D34DEF4 28000000
         AIF   ('&DEVICE' NE '3340').T200A                     @DL2W720 28050000
&NUMB    SETA  8368                                            @DL2W720 28100000
.T200A   ANOP                                                  @DL2W720 28150000
         AIF   ('&DEVICE' NE '3330').T201A                          4-0 28200000
&NUMB    SETA  13030                                                4-0 28250000
.T201A   ANOP                                                       4-0 28300000
         AIF   ('&DEVICE' NE '2314').T210                      @D36KE6D 28350000
&NUMB    SETA  7294                                                     28400000
.T210    AIF   (&B(4)).T215                                             28450000
&INDIC   SETA  &INDIC+8            INDICATOR-SET BIT 4 ON  VERS 2 TABLE 28500000
         AIF   (NOT &B(7) AND NOT &B(9) AND NOT &B(13)).T230        3-5 28550000
&INDIC   SETA  &INDIC+64                INDICATOR-SET BIT 1 ON-BLOCKING 28600000
         AGO   .T230                                                    28650000
.T215    AIF   (T'&DELETFL EQ 'O').T220                                 28700000
&INDIC   SETA  &INDIC+64      INDICATOR-SET BIT 1 ON-DON'T DELET FILABL 28750000
.T220    ANOP                                                           28800000
&INDIC   SETA  &INDIC+32                INDICATOR-SET BIT 2 ON-WORKFILE 28850000
         AGO   .T260                                                    28900000
.T230    AIF   (T'&WORKA EQ 'O').T240                                   28950000
&INDIC   SETA  &INDIC+16                INDICATOR-SET BIT 3 ON-WORKAREA 29000000
.T240    AIF   (&B(3) OR &B(4)).T250                                    29050000
&INDIC   SETA  &INDIC+2                 INDICATOR-SET BIT 6 ON-INPUT    29100000
.T250    AIF   (T'&LABADDR EQ 'O').T260                                 29150000
         AIF   (&LABNG).T260                                            29200000
&INDIC   SETA  &INDIC+1                 INDICATOR-SET BIT 7 ON-LABADDR  29250000
.T260    DC    AL1(&INDIC)              OPEN/CLOSE INDICATORS           29300000
         AIF   (T'&FILEN NE 'O').T270                                   29350000
         DC    CL7' '              ****ERROR - PATCH FILENAME           29400000
         AGO   .T270A                                               3-3 29450000
.T270    DC    CL7'&FILEN'             FILENAME                         29500000
.T270A   AIF   (NOT &FBA).T271                                 @D36KE6D 29550000
         DC    X'90'                   INDICATE FBA            @D35DE98 29600000
         AGO   .T280                                           @D35DE98 29650000
.T271    AIF   ('&DEVICE' NE '2314').T272                               29700000
         DC    X'01'                   INDICATE 2314                    29750000
         AGO   .T280                                                    29800000
.T272    AIF   ('&DEVICE' NE '3330').T274                      @DL2W720 29850000
         DC    X'04'                   INDICATE 3330                4-0 29900000
         AGO   .T280                                                4-0 29950000
.T274    AIF   ('&DEVICE' NE '3340').T275                      @DL2W720 30000000
         DC    X'08'                   INDICATE 3340           @DL2W720 30050000
         AGO   .T280                                           @DL2W720 30100000
.T275    ANOP                                                  @D34DEF4 30150000
         AIF   ('&DEVICE' NE '3350').T276                      @D34DEF4 30200000
         DC    X'07'                    INDICATE 3350          @D34DEF4 30250000
         AGO   .T280                                           @D34DEF4 30300000
.T276    ANOP                                                  @D34DEF4 30350000
         DC    X'00'                    INDICATE 2311          @DL2W720 30400000
.T280    AIF   (&B(4)).T500    BRANCH IF WORKFILE                       30450000
         DC    6X'00'                   BCCHHR ADDR OF F1 LABEL IN VTOC 30500000
         DC    2X'00'                   VOL SEQ NUMBER                  30550000
         DC    X'08'                    OPEN COMMUNICATIONS BYTE        30600000
         DC    X'00'                    XTENT SEQ NO OF CURRENT EXTENT  30650000
         DC    X'00'                    XTENT SEQ NO LAST XTENT OPENED  30700000
         AIF   (&LABNG).T281                                            30750000
         DC    AL3(&LABDR)              USER'S LABEL ADDRESS            30800000
         AGO   .T282                                                    30850000
.T281    DC    AL3(0)                                                   30900000
.T282    AIF   (T'&IOAREA2 EQ 'O' OR &B(3)).T290                        30950000
         AIF   (&B(4)).FBA20                                   @D35DE98 31000000
         DC    X'20'                    DATAFILE VERSION 3 BIT @D35DE98 31050000
         AGO   .FBA19                                          @D35DE98 31100000
.FBA20   ANOP                                                  @D35DE98 31150000
         DC    X'00'                    RPS BYTE                        31200000
.FBA19   ANOP                                                  @D35DE98 31250000
         DC    AL3(&IOAREA2)            ADDRESS OF 2ND. IOAREA @DL30SMD 31300000
         AGO   .T300                                                    31350000
.T290    ANOP                                                  @DL30SMD 31400000
.FBA21   AIF   (&B(4)).FBA23                                   @D35DE98 31450000
         DC    X'20'                    DATAFILE VERSION 3 BIT @D35DE98 31500000
         AGO   .FBA22                                          @D35DE98 31550000
.FBA23   ANOP                                                  @D35DE98 31600000
         DC    X'00'                    RPS BYTE                        31650000
.FBA22   ANOP                                                  @D35DE98 31700000
         DC    AL3(&IOAREA1.&IOA1)      ADDRESS OF IOAREA      @DL30SMD 31750000
.T300    DC    X'80000000'              CCHH ADDR OF USER LABEL TRACK   31800000
         DC    2X'00'                   LOWER HEAD LIMIT                31850000
         DC    4X'00'                   XTENT UPPER LIMIT               31900000
&FILEN.S DC    2X'00'                   SEEK ADDRESS-BB                 31950000
         DC    X'0000FF00'              SEARCH ADDRESS-CCHH             32000000
         DC    X'00'                    RECORD NUMBER                   32050000
         AIF   (&B(3)).T310                                             32100000
         DC    AL3(&EOF)                EOF ADDRESS                     32150000
         AGO   .T320                                                    32200000
.T310    DC    X'00'                    KEY LENGTH                      32250000
         DC    AL2(&BLKS)               DATA LENGTH            @D14CDHK 32300000
.T320    DC    4X'00'                   CCHH CONTROL FIELD              32350000
         AIF   (&B(8) OR &B(9) OR &B(10) OR &B(14) OR &B(13)).T323  3-5 32400000
         DC    AL1(&RECNUM(2))          R    CONTROL FIELD              32450000
         AGO   .T327                                                    32500000
.T323    DC    X'FF'                    R    CONTROL FIELD              32550000
.T327    DC    B'00000&T(1)00'                                      3-2 32600000
&RECNUM(1) SETA &BLKS-1                                                 32650000
         AIF   ('&BLKSIZE' NE 'MAX').NOMAX  IF BLKSIZE = MAX   @D14CDHK 32700000
.* THEN FILENME.B WILL ALLOW USER TO GET ASSIGNED BLKSIZE      @D14CDHK 32750000
.* VALUE AFTER OPEN                                            @D14CDHK 32800000
&FILEN.B DC    AL2(&RECNUM(1))         SIZE OF BLOCK-1         @D14CDHK 32850000
         AGO   .T328                                           @D14CDHK 32900000
.NOMAX   DC    AL2(&RECNUM(1))         SIZE OF BLOCK-1         @D14CDHK 32950000
.T328    DC    5X'FF'                  CCHHR BUCKET            @D14CDHK 33000000
         AIF   (&B(3)).T329        IF OUTPUT                            33050000
         AIF   (T'&WLRERR EQ 'O').T330                                  33100000
         DC    AL3(&WLRERR)             WLRERR ADDRESS                  33150000
         AGO   .T340                                                    33200000
.T329    DC    X'00'                                                    33250000
         DC    H'&NUMB'                 TRACK CAPACITY CONSTANT         33300000
         AGO   .T340                                                    33350000
.T330    DC    3X'00'                                                   33400000
.T340    AIF   (&IORE NE 0).T341                                        33450000
         NOP   0                                                        33500000
         AGO   .T342                                                    33550000
.T341    L     &IORE,88(1)              LOAD USER'S IOREG               33600000
.T342    AIF   (&B(3)).T345   IF OUTPUT                                 33650000
         AIF   (&B(8) OR &B(9) OR &B(14) OR &B(13)).T343 VAR OR SPN 3-5 33700000
         DC    A(&IOAREA1.&IOA1)       DEBLOCKER-INITIAL POINTER    4-0 33750000
         AGO   .T355                                                    33800000
.T343    DC    A(&IOAREA1.&IOA1+4)     DEBLOCKER-INITIAL POINTER    4-0 33850000
         AGO   .T355                                                    33900000
.T345    AIF   (&B(8) OR &B(9) OR &B(14) OR &B(13)).T350            3-5 33950000
         DC    A(&IOAREA1.&IOA1+8)     DEBLOCKER-INITIAL POINTER    4-0 34000000
         AGO   .T355                                                    34050000
.T350    DC    A(&IOAREA1.&IOA1+12)    DEBLOCKER-INITIAL POINTER    4-0 34100000
.T355    AIF   (&B(10)).T360                                            34150000
         DC    F'&RECS'                 DEBLOCKER-RECORD SIZE           34200000
         AGO   .T365                                                    34250000
.T360    AIF   (&RECS EQ 0).T361                                        34300000
         AIF   (&B(3)).T362                                             34350000
         L     &RECS,96(1)        RETURN RECORD SIZE           @D14CDHK 34400000
         AGO   .T365                                                    34450000
.T361    NOP   0                        NO RECSIZE                      34500000
         AGO   .T365                                                    34550000
.T362    STH   &RECS,66(1)              GET RECORD SIZE                 34600000
.T365    AIF   (&B(3)).T370                                             34650000
         DC    A(&IOAREA1.&IOA1+&BLKS-1)     DEBLOCKER LIMIT        4-0 34700000
         AGO   .T375                                                    34750000
.T370    DC    A(&IOAREA1.&IOA1+8+&BLKS-1)   DEBLOCKER LIMIT        4-0 34800000
.T375    AIF   (NOT &B(10) OR  NOT &B(3)).T374                      3-3 34850000
&LNDIC   SETA  &LNDIC+4                UNDEF OUTPUT FILE            3-3 34900000
.T374    AIF   (NOT &B(6) AND NOT &B(7)).T376                       3-3 34950000
&LNDIC   SETA  &LNDIC+2                                                 35000000
.T376    AIF   (T'&CONTROL EQ 'O').T377                                 35050000
&LNDIC   SETA  &LNDIC+1                                                 35100000
.T377    DC    AL1(&LNDIC)         LOGICAL INDICATORS                   35150000
         DC    AL3(&ERRTN)              USER'S ERROR ROUTINE            35200000
IJGC&SYSNDX CCW   7,*-46,64,6           SEEK                            35250000
         CCW   X'31',*-52,64,5          SEARCH ID EQUAL                 35300000
         CCW   8,*-8,0,0                TIC                             35350000
         AIF   (&B(3)).T400        IF OUTPUT                            35400000
         AIF   (T'&TRUNCS NE 'O' AND &B(7) OR &B(11) OR &B(14) OR &B(13)35450000
               )).T380                                              3-5 35500000
         CCW   6,&IOAREA1.&IOA1,0,&BLKS      READ DATA              4-0 35550000
         AIF   (T'&UPDATE EQ 'O').T409   GO TO TEST FOR CONTROL         35600000
         AGO   .T407       UPDATE NO TRUNCS                             35650000
.T380    AIF   (&B(10)).T3801           IF UNDEF                        35700000
         CCW   6,&IOAREA1.&IOA1,64,&BLKS     READ DATA              4-0 35750000
         AGO   .T3802                                                   35800000
.T3801   CCW   6,&IOAREA1.&IOA1,96,&BLKS     READ DATA              4-0 35850000
.T3802   AIF   (T'&UPDATE EQ 'O').T390  TRUNCS NO UPDATE                35900000
         CCW   X'92',*+32,0,8           READ COUNT                      35950000
         CCW   X'31',&FILEN.S+2,64,5    SEARCH ID EQUAL                 36000000
         CCW   8,*-8,0,0                TIC                             36050000
         AIF   (&B(11) OR &B(14) OR &B(13)).T381                    3-5 36100000
         CCW   6,*,48,1                VERIFY                           36150000
         AGO   .T395                                                    36200000
.T381    CCW   X'06',*,48,146           VERIFY                          36250000
         AGO   .T395                                                    36300000
.T390    CCW   X'92',*+8,0,8            READ COUNT                      36350000
.T395    DC    2F'0'                    COUNT AREA                      36400000
         AGO   .T409          GO TO TEST FOR CONTROL                    36450000
.T400    AIF   (&BLKS EQ 65635).T401    BLKSIZE=MAX SPECIFIED  @D14CDHK 36500000
&BLKS    SETA  &BLKS-8                  REDUCE MAX VALUE BY 8  @D14CDHK 36550000
.T401    AIF   (T'&IOAREA2 EQ 'O').T405                        @D14CDHK 36600000
         CCW   X'1D',&IOAREA2,&VRFY,&BLKS+8  WRITE COUNT KEY AND DATA   36650000
&CCODE   SETC  '30'                                                     36700000
         AGO   .T407                                                    36750000
.T405    CCW   X'1D',&IOAREA1.&IOA1,&VRFY,&BLKS+8 WRITE CNT KEY D   4-0 36800000
&CCODE   SETC  '30'                                                     36850000
.T407    CCW   X'31',&FILEN.S+2,64,5    SEARCH ID EQUAL                 36900000
         CCW   8,*-8,0,0                     TIC                        36950000
           CCW &CCODE,*,48,1           VERIFY                           37000000
.T409    AIF   (&B(11) OR &B(14) OR &B(13)).T415                    3-5 37050000
.T4091   AIF   (T'&CONTROL NE 'O' OR &B(14) OR &B(13)).T410         3-5 37100000
         AGO   .ADDRCK                                                  37150000
.T410    DC    X'000080000000FFFF'      CCB-FOR CONTROL MACRO           37200000
         DC    A(*+8)                   CCB-CCW ADDRESS                 37250000
         DC    4X'00'                   CCB-ST BYTE,CSW CCW ADDRESS     37300000
         CCW   7,&FILEN.S,0,6           CONTROL SEEK                    37350000
         AIF   (NOT &B(14) AND NOT &B(13)).ADDRCK                   3-5 37400000
         DC    F'0'          LOGICAL RECORD LENGTH                  3-5 37450000
         AIF   (&B(3)).T410R                                        3-5 37500000
         AIF   (T'&UPDATE EQ 'O').T410T                             3-5 37550000
         L     &RECS,216(1)                                         3-5 37600000
         AGO   .T410S                                               3-5 37650000
.T410T   L     &RECS,176(1)                                         3-5 37700000
         AGO   .T410S                                               3-5 37750000
.T410R   ST    &RECS,200(1)                                         3-5 37800000
.T410S   DC    X'00'         FLAGS FOR SPANNED PROCESSING           3-5 37850000
         DC    X'000000'     POINTER WITHIN LOGICAL RECORD          3-5 37900000
         AIF   (T'&UPDATE EQ 'O' AND &B(2)).ADDRCK                  3-5 37950000
         DC    2F'0'         COUNT SAVE AREA                        3-5 38000000
         DC    F'0'          STATUS SAVE AREA FOR REOPEN            3-5 38050000
         AGO   .ADDRCK                                                  38100000
.T415    AIF   (NOT &B(3)).T417    IF INPUT                             38150000
         AIF   (&B(10)).T416  IF UNDEF                                  38200000
         DC    F'0'                     SPACE REMAINING IN OUTPUT AREA  38250000
.T416    DC    H'&NUMB'                 TRACK CAPACITY BUCKET           38300000
         AIF   (&B(10)).T4160           IF UNDEF                        38350000
         AIF   (&VBLD EQ 0 OR &B(14) OR &B(13)).T430                3-5 38400000
         L     &VBLD,160(1)             LOAD USER,S VARBLD REGISTER     38450000
.T4160 AIF (T'&CONTROL EQ 'O' AND NOT &B(14) AND NOT &B(13)).T4161  3-5 38500000
         DC    6X'00'                   UNUSED                          38550000
         AGO   .T410                                                    38600000
.T4161   AGO   .ADDRCK                                                  38650000
.T417    AIF   (NOT &B(3) AND T'&UPDATE NE 'O').T440   IF UPDATE        38700000
         AGO   .T4091                                                   38750000
.T430    NOP   0                                                        38800000
         AGO   .T4160                                                   38850000
.T440    DC    2F'0'                    COUNT SAVE AREA                 38900000
         DC    2F'0'                    COUNT SAVE AREA FOR 2 I/O       38950000
         AGO   .T4091                                                   39000000
.T500    AIF   ('&DEVICE' NE '2314').T501                               39050000
         DC    H'7294'                 TRACK CAPACITY COUNTER           39100000
         AGO   .T502                                                    39150000
.T501    AIF   ('&DEVICE' NE '3330').T501A                          4-0 39200000
         DC    H'13030'                TRACK CAPACITY COUNTER       4-0 39250000
         AGO   .T502                                                4-0 39300000
.T501A   AIF   ('&DEVICE' NE '3340').T501B                     @DL2W720 39350000
         DC    H'8368'                 3340 TRK CAP COUNT      @DL2W720 39400000
         AGO   .T502                                           @DL2W720 39450000
.T501B   ANOP                                                  @D34DEF4 39500000
         AIF   ('&DEVICE' NE '3350').T501C                     @D34DEF4 39550000
         DC    H'19069'                3350 TRK CAP CNT        @D34DEF4 39600000
         AGO   .T502                                           @D34DEF4 39650000
.T501C   ANOP                                                  @D34DEF4 39700000
         AIF   (NOT &FBA).T501D                                @D35DE98 39750000
         DC    H'32761'                LARGEST FBA BLKSIZE     @D35DE98 39800000
         AGO   .T502                                           @D35DE98 39850000
.T501D   ANOP                                                  @D35DE98 39900000
         DC    H'3625'                 2311 TRK CAP COUNT      @DL2W720 39950000
.T502    DC    4X'00'                  CCHR ADDR OF F1 LABEL IN VTOC4-0 40000000
         DC    X'00'                    EXTENT SEQUENCE NUMBER          40050000
         DC    X'20'                    WORKFILE VERSION 3 BIT @D35DE98 40100000
         DC    X'00'                    LOWER HEAD LIMIT                40150000
         DC    X'09'                    UPPER HEAD LIMIT                40200000
&FILEN.L DC    AL2(&BLKS)               RECORD LENGTH          @D14CDHK 40250000
         DC    4X'00'                   INITIAL EXTENT LOWER LIMIT      40300000
         DC    4X'00'                   CURRENT EXTENT LOWER LIMIT      40350000
         DC    4X'00'                   EXTENT UPPER LIMIT              40400000
&FILEN.S DC    2X'00'                   SEEK ADDRESS-BB                 40450000
         DC    X'0000FF00'              SEARCH ADDRESS-CCHH             40500000
         DC    X'00'                    RECORD NUMBER                   40550000
         DC    X'00'                    SWITCHES                        40600000
         AIF   ('&BLKSIZE' NE 'MAX').NOMAXW IF BLKSIZE = MAX   @D14CDHK 40650000
.* THEN FILENME.B WILL ALLOW USER TO GET ASSIGNED BLKSIZE      @D14CDHK 40700000
.* VALUE AFTER OPEN                                            @D14CDHK 40750000
&FILEN.B DC    AL2(&BLKS)               MAXIMUM RECORD LENGTH  @D14CDHK 40800000
         AGO   .T503                                           @D14CDHK 40850000
.NOMAXW  DC    AL2(&BLKS)               MAXIMUM RECORD LENGTH  @D14CDHK 40900000
.T503    ANOP                                                  @D14CDHK 40950000
&VRFY    SETA  &VRFY+32                                                 41000000
         DC    AL1(&VRFY)               VERIFY CHAIN BIT                41050000
         DC    AL3(&EOF)                EOF ADDRESS                     41100000
         AIF   (&B(10)).T510                                            41150000
&LNDIC   SETA  &LNDIC+32      LOGICAL INDIC-SET BIT 2 ON-FIXUNB         41200000
.T510    DC    AL1(&LNDIC)              LOGICAL INDICATORS              41250000
         DC    AL3(&ERRTN)              USER'S RD/WR ERROR ROUTINE      41300000
IJGC&SYSNDX CCW   7,*-18,64,6           SEEK                            41350000
         CCW   X'31',*-24,64,5          SEARCH ID EQUAL                 41400000
         CCW   8,*-8,0,0                TIC                             41450000
         CCW   3,*,32,1                 WRITE CKD OR READ DATA          41500000
         CCW   5,*,32,1                 WRITE DATA/READ COUNT           41550000
         CCW   X'31',*-56,64,5          SEARCH ID EQUAL                 41600000
         CCW   8,*-8,0,0                TIC                             41650000
         CCW   X'1E',*+16,48,8          VERIFY                          41700000
         CCW   X'12',*+8,0,8            READ COUNT                      41750000
         DC    X'0000000001000000'      COUNT AREA                      41800000
.ADDRCK  ANOP                                                           41850000
IJGZ&SYSNDX DS    0F                 TO FORCE ALIGNMENT        @D14CDIS 41900000
         DC    AL1(&VER3FLG)         1ST VERSION 3 FLAG        @D35DE98 41950000
         DC    B'&B(17).&B(18).&B(19).00000' 2ND VER 3 FLAG    @D51ZDRP 42000000
         DC    AL2(0)                VERSION 3 FLAGS           @D51ZDRP 42050000
         DC    AL4(&CISZ)            CISIZE IF PRESENT         @D35DE98 42100000
         DC    AL4(0)                PHYSICAL BLOCK SIZE       @D356EE3 42150000
         DC    AL2(0)                NUMBER OF PHYSICAL        @D356EE3 42200000
*                                    BLOCKS/CI                 @D356EE3 42250000
         DC    AL1(0)                NUMBER OF PHYSICAL        @D356EE3 42300000
*                                    BLOCKS/TRACK              @D356EE3 42350000
         DC    AL1(0)                UPPER LIMIT RECD NUMBER   @D356EE3 42400000
         DC    AL4(0)                DATA SECURITY PLIST PTR   @D14CDIS 42450000
         DC    AL4(&EXT)             EOX EXIT POINTER ADDRESS  @D14CDHK 42500000
IJJZ&SYSNDX EQU   *                                            @D35DE98 42550000
         MEND                                                           42600000
