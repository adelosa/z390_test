         MACRO                                                          00040000
&LABEL   CDMOD &TYPEFLE=INPUT,&DEVICE=2540,&IOAREA2=,&WORKA=,&RECFORM=F*00080000
               IXUNB,&CTLCHR=,&CRDERR=,&CONTROL=,&SEPASMB=,         4-0X00120000
               &RDONLY=,&FUNC=                                      4-0 00160000
         GBLA  &IJCMFCX  USED ANALOGUOUS TO SYSNDX FOR MFCM/MFCU     JJ 00200000
         GBLB  &IJCGB1                                                  00240000
         LCLA  &AL4,&AL5,&AL6                                       4-0 00280000
         LCLA  &ASF   USED TO EVALUATE BYTE 8 OF MODNAME (MFCM/U)    JJ 00320000
         LCLB  &BL1,&BL2,&BL4                                           00360000
         LCLC  &AL1,&CG9,&NAM,&CNTL,&WKIO,&RECF,&ENT,&CG1           4-0 00400000
         LCLA  &REG   REG 13 IF WORKA IS SPECIFIED, ELSE REG 14      JJ 00440000
         LCLA  &OFFS  OFFSET OF DATA IN RECORD (MFCM/MFCU)           JJ 00480000
         LCLC  &FUNCT USED TO EVALUATE BYTE 8 OF MODNAME (MFCM/U)    JJ 00520000
         LCLC  &X   MFCM/MFCU LOGIC MODULE COUNTER                   JJ 00560000
         LCLC  &FTYP,&DEV                                            JJ 00600000
         LCLC  &CD  DEVICE (2560 OR 5425)                      @DL2994J 00640000
         LCLC  &RECFM2     RECFORM AS A LCLC CONSTANT          @D14BDBF 00680000
         LCLC  &C          SAME AS &CG9, BUT SHORTER           @D14BDBF 00720000
.************************************************************* @D149DBF 00760000
.* IBM DISK OPERATING SYSTEM                                            00800000
.*                                                             @D149DBF 00840000
.*    01 COPYRIGHT =                                           @D149DBF 00880000
* IOCS AND DEVICE INDEPENDANT I/O - CDMOD -5686-007-02-C440    @U31TUJS 00920000
.*                                                             @D149DBF 00960000
.*    01 COPYRIGHT =                                           @D149DBF 01000000
*           THIS MACRO IS "RESTRICTED MATERIALS OF IBM"        @U31TDKY 01040000
*           5686-007 (C) COPYRIGHT IBM CORP. 1981,1988         @U31TUJS 01080000
*           ALL RIGHTS RESERVED                                @U31TDKY 01120000
*           LICENSED MATERIALS-PROPERTY OF IBM                 @D41TDKY 01160000
.*          SEE COPYRIGHT INSTRUCTIONS, G120-2083              @D41TDKY 01200000
.*                                                             @D149DBF 01240000
.************************************************************* @D149DBF 01280000
.*                                                             @D14BDBF 01320000
.************************************************************* @D14BDBF 01360000
.* CHANGE ACTIVITIES                                           @D14BDBF 01400000
.*                                                             @D14BDBF 01440000
.* 512 BYTES INPUT FOR SPOOLED READER FILES                    @D14BDBF 01480000
.* CORRECT A MISALIGNMENT IN ASSEMBLY                          @DA23853 01520000
.*                                                             @D14BDBF 01560000
.* FOR A 3881 THE LAST CHARACTER IN THE MODNAME IS CHANGED     @DA28247 01600000
.* FROM '0' TO 'P' .                                           @DA28247 01640000
.* MSG0S03I PROGCK IN LOW CORE BECAUSE REG14 INCORRECT.        @DA33810 01680000
.* UNPREDICTABLE RESULTS DUE TO NOT SWAPPING IOAREA'S          @DA34640 01720000
.* CATALOG STATEMENTS CHANGED TO PSB DESCRIBED FORMAT          @DA34640 01760000
.* SAVE AND LOAD OF REG0 ADDED TO HAVE WORKAREA ADDRESSED.     @DA35715 01800000
.* MSG2101I DUE TO CATALOG STATEMENT STARTING IN COLLUMN 1.    @DA36950 01840000
.* IOAREA MOVE INSTRUCTION ADDED FOR D/T2560 INPUT             @DY38452 01880000
.* WHEN NO WORKA AND RDONLY IS SPECIFIED, THE CODE FOR MOVING  @DY38452 01920000
.* THE DATA INTO WORKA IS GENERATED INCORRECT                  @DY38452 01960000
.************************************************************* @D14BDBF 02000000
.*                                                             @D14BDBF 02040000
*                                                              @D14ZDHK 02080000
&RECFM2  SETC  '&RECFORM'                                      @D14BDBF 02120000
         AIF   (K'&DEVICE GE 4).ANFXXX                               JJ 02160000
&CG1     SETC  '2540'                                                JJ 02200000
         MNOTE 0,'ILLEGAL DEVICE PARAMETER. ''2540'' ASSUMED'        JJ 02240000
         AGO   .ANFYYY                                               JJ 02280000
.ANFXXX  ANOP                                                        JJ 02320000
&CG1     SETC  '&DEVICE'(1,4)                                           02360000
.ANFYYY  ANOP                                                        JJ 02400000
         AIF   ('&CG1' NE '3504').NO3504                       @DC28914 02440000
&CG1     SETC  '3505'                                          @DC28914 02480000
.NO3504  ANOP                                                  @DC28914 02520000
&CD      SETC  '&CG1'                                                JJ 02560000
         AIF   ('&CD' EQ '2560' OR '&CD' EQ '5425').MFCX       @DL2994J 02600000
&CG9     SETC  '&SYSNDX'(2,3)                                           02640000
&C       SETC  '&SYSNDX'(2,3)      SAME,BUT SHORTER            @D14BDBF 02680000
         AIF   ('&SEPASMB' EQ '' OR '&SEPASMB' EQ 'YES').BK1        3-3 02720000
          MNOTE 0,'IMPROPER SEPASMB. ''YES'' ASSUMED'               3-3 02760000
.BK1     AIF   (T'&RDONLY EQ 'O' OR '&RDONLY' EQ 'YES').MM1         3-3 02800000
         MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED'                 3-3 02840000
.MM1      AIF   ('&CG1' NE '2501').REL                                  02880000
          AIF   ('&CONTROL' EQ '').UVW                                  02920000
          MNOTE 0,'CONTROL INVALID PARAMETER. IGNORED'                  02960000
.UVW      AIF   ('&CTLCHR' EQ '' OR '&TYPEFLE' NE 'OUTPUT').EC92        03000000
          MNOTE 0,'CTLCHR INVALID PARAMETER. IGNORED'                   03040000
          AGO  .EC92                                                    03080000
.REL      ANOP                                                          03120000
         AIF   ('&CG1' NE '3525').FUN3                              4-0 03160000
         AIF   ('&TYPEFLE' NE 'OUTPUT').FUN1                        4-0 03200000
&AL1     SETC  'D'                                                  4-0 03240000
         AIF   ('&FUNC' EQ 'I').FUN3                                4-0 03280000
&AL1     SETC  'C'                                                  4-0 03320000
         AIF   ('&FUNC' EQ 'PW').FUN3                               4-0 03360000
&AL1     SETC  '7'                                                  4-0 03400000
         AIF   ('&FUNC' EQ 'P').FUN3                                4-0 03440000
         AGO   .FUN2                                                4-0 03480000
.FUN1    AIF   ('&TYPEFLE' EQ 'CMBND').FUN3                         4-0 03520000
&AL1     SETC  'B'                                                  4-0 03560000
         AIF   ('&FUNC' EQ 'RW').FUN3                               4-0 03600000
&AL1     SETC  '7'                                                  4-0 03640000
         AIF   ('&FUNC' EQ 'R').FUN3                                4-0 03680000
.FUN2    AIF   (T'&FUNC EQ 'O').FUN3                                4-0 03720000
&AL1     SETC  'A'                                                  4-0 03760000
         AIF   ('&FUNC' EQ 'RP').FUN3                               4-0 03800000
&AL1     SETC  'E'                                                  4-0 03840000
         AIF   ('&FUNC' EQ 'RPW').FUN3                              4-0 03880000
         MNOTE 9,'INVALID FUNC. MACRO NOT GENERATED'                4-0 03920000
         MEXIT                                                      4-0 03960000
.FUN3    ANOP                                                       4-0 04000000
&CNTL    SETC  'C'                                                      04040000
         AIF   ('&CONTROL' NE 'YES').CONT1                          4-0 04080000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').EC93                        4-0 04120000
         AIF   ('&AL1' NE 'A' AND '&AL1' NE 'E').EC93               4-0 04160000
         MNOTE 0,'CONTROL INVALID FOR READ FILE IN RP OR RPW ASSOC. FILX04200000
               ES.  IGNORED'                                        4-0 04240000
         AGO   .EC92                                                4-0 04280000
.CONT1   AIF   (T'&CONTROL EQ 'O').EC91                             4-0 04320000
          MNOTE 0,'IMPROPER CONTROL. ''YES'' ASSUMED'                   04360000
.EC93     AIF   ('&TYPEFLE' NE 'OUTPUT').EC9                            04400000
          AIF   (T'&CTLCHR EQ 'O').EC9                                  04440000
         MNOTE 0,'BOTH CTLCHR AND CONTROL SPECIFIED. ONLY CONTROL ASSUM*04480000
               ED'                                                      04520000
         AGO   .EC9                                                     04560000
.EC91    AIF   ('&TYPEFLE' NE 'OUTPUT').EC92                            04600000
&CNTL    SETC  'A'                                                      04640000
         AIF   ('&CTLCHR' EQ  'ASA').EC9                                04680000
&CNTL    SETC  'Y'                                                      04720000
         AIF   ('&CTLCHR'  EQ 'YES').EC9                                04760000
         AIF   ('&CTLCHR'  EQ '').EC92                                  04800000
          MNOTE 0,'IMPROPER CTLCHR . ''YES'' ASSUMED'                   04840000
         AGO   .EC9                                                     04880000
.EC92    ANOP                                                           04920000
&CNTL    SETC  'Z'                                                      04960000
.EC9     ANOP                                                           05000000
&WKIO    SETC  'Z'                                                      05040000
         AIF   ('&CG1' NE '3525').FUN4                              4-0 05080000
         AIF   ('&AL1' LE 'E' AND '&AL1' NE 'D').EC9A               4-0 05120000
.FUN4    AIF   ('&IOAREA2' EQ '' OR '&IOAREA2' EQ 'YES').EC9A       4-0 05160000
         MNOTE 0,'IMPROPER IOAREA2. ASSUME YES'                         05200000
.EC9A    AIF   ('&TYPEFLE' EQ 'CMBND').EC95                             05240000
         AIF   (T'&IOAREA2 EQ 'O').EC95                                 05280000
     AIF ('&IOAREA2' EQ '').EC95                                    3-3 05320000
         AIF   ('&CG1' NE '3525').FUN5                              4-0 05360000
         AIF   ('&AL1' LE 'E' AND '&AL1' NE 'D').FUN6               4-0 05400000
.FUN5    ANOP                                                       4-0 05440000
&WKIO    SETC  'I'                                                      05480000
         AIF   (T'&WORKA EQ 'O').EC10                                   05520000
          AIF   ('&WORKA' EQ 'YES').HARA1                               05560000
          MNOTE 0,'IMPROPER WORKA. ''YES'' ASSUMED'                     05600000
.HARA1    ANOP                                                          05640000
&WKIO    SETC  'B'                                                      05680000
         AGO   .EC10                                                    05720000
.FUN6    MNOTE 0,'IOAREA2 INVALID WITH ASSOC. FILES'                4-0 05760000
.EC95    AIF   (T'&WORKA EQ 'O').EC10                                   05800000
          AIF   ('&CG1' EQ '3881').FUN6A                       @DL28701 05840000
          AIF   ('&CG1' NE '3881').FUN6B                       @DL28701 05880000
.FUN6A    MNOTE 0,'WORKA INVALID WITH 3881. IGNORED'           @DL28701 05920000
          AGO   .EC10                                          @DL28701 05960000
.FUN6B    AIF   ('&WORKA' EQ 'YES').HARA2                      @DL28701 06000000
          MNOTE 0,'IMPROPER WORKA. ''YES'' ASSUMED'                     06040000
.HARA2    ANOP                                                          06080000
&WKIO    SETC  'W'                                                      06120000
.EC10    AIF   ('&TYPEFLE' EQ 'CMBND').CBMOD                            06160000
          AIF   ('&TYPEFLE' NE 'OUTPUT').F1                             06200000
         AIF   ('&CG1' EQ '3525').F1                                4-0 06240000
          AIF   (T'&CRDERR EQ 'O').F10                                  06280000
          AIF   ('&CRDERR' EQ '').F10                          @DA01109 06320000
&AL1     SETC  '5'                                                  4-0 06360000
         AIF   ('&CG1' EQ '2520').F2                                    06400000
&AL1     SETC  '4'                                                  4-0 06440000
          AIF   ('&CG1' EQ '2540').F2                                   06480000
          AGO   .F9                                                     06520000
.F2       AIF   ('&CRDERR' EQ 'RETRY').R30                              06560000
          MNOTE 0,'IMPROPER CRDERR. ''RETRY'' ASSUMED'                  06600000
          AGO   .R30                                                    06640000
.F1       AIF   (T'&CRDERR EQ 'O').F10                                  06680000
.F9       MNOTE 0,'CRDERR INVALID PARAMETER. IGNORED'                   06720000
.F10      ANOP                                                          06760000
         AIF   ('&CG1' EQ '3525').R30                               4-0 06800000
         AIF   (T'&FUNC EQ 'O').FUN8                                4-0 06840000
         MNOTE 0,'FUNC INVALID WITH DEVICE. IGNORED'                4-0 06880000
.FUN8    ANOP                                                       4-0 06920000
&AL1     SETC  '6'                                                  4-0 06960000
         AIF   ('&CG1' EQ '3505' AND '&TYPEFLE' EQ 'INPUT').R30     4-0 07000000
&AL1     SETC  '3'                                                  4-0 07040000
.R24     AIF   ('&CG1' EQ '2501' AND '&TYPEFLE' EQ 'INPUT').R30         07080000
&AL1     SETC  '2'                                                  4-0 07120000
         AIF   ('&CG1' EQ '2520').R30                                   07160000
&AL1     SETC  '1'                                                  4-0 07200000
         AIF   ('&CG1' EQ '2596').R30                               4-0 07240000
         AIF   ('&CG1' EQ '1442').R30                                   07280000
&AL1     SETC  'P'         DEVICE IS A 3881 ?                  @DA28247 07320000
       AIF   ('&CG1' EQ '3881' AND '&TYPEFLE' EQ 'INPUT').R30  @DL28701 07360000
&AL1     SETC  '0'         DEVICE IS A 2540                    @DA28247 07400000
         AIF   ('&CG1' EQ '2540').R30                                   07440000
          MNOTE 0,'IMPROPER DEVICE. ''2540'' ASSUMED'                   07480000
&CG1      SETC  '2540'                                                  07520000
.R30     AIF   ('&TYPEFLE' EQ 'INPUT').REMOD                            07560000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').PUMOD                           07600000
          MNOTE 0,'IMPROPER TYPEFLE. MACRO NOT GENERATED'               07640000
         MEXIT                                                          07680000
.PUMOD   ANOP                                                           07720000
&RECF    SETC  'V'                                                      07760000
         AIF   ('&RECFM2' EQ 'VARUNB').P13                     @D14BDBF 07800000
&RECF    SETC  'U'                                                      07840000
         AIF   ('&RECFM2' EQ 'UNDEF').P13                      @D14BDBF 07880000
&RECF    SETC  'F'                                                      07920000
         AIF   ('&RECFM2' EQ 'FIXUNB').P13                     @D14BDBF 07960000
          MNOTE 0,'IMPROPER RECFORM. MACRO NOT GENERATED'               08000000
         MEXIT                                                          08040000
.P13     AIF   (T'&RDONLY  EQ 'O').P13AA                            3-3 08080000
&NAM     SETC  'IJC&RECF&CNTL.N&WKIO&AL1'                           3-3 08120000
         AGO   .P13AB                                               3-3 08160000
.P13AA   ANOP                                                       3-3 08200000
&NAM      SETC  'IJC&RECF&CNTL.O&WKIO&AL1'                          3-3 08240000
.P13AB   AIF   (T'&LABEL EQ 'O').AAA                                3-3 08280000
&NAM      SETC  '&LABEL'                                                08320000
.AAA      AIF   (T'&SEPASMB EQ 'O').BBB                                 08360000
          PUNCH ' CATALOG &NAM..OBJ                     REPLACE=YES'    08400000
.BBB      ANOP                                                          08440000
IJCPD&CG9 DSECT                                                         08480000
IJCP0&CG9 DS    CL2                    RESIDUAL COUNT                   08520000
IJCP1&CG9 DS    CL1                    COMMUNICATION BYTE 1             08560000
IJCP2&CG9 DS    CL1                    COMMUNICATION BYTE 2             08600000
IJCPO&CG9 DS    CL2                    CSW STATUS BYTES                 08640000
IJCP3&CG9 DS    CL2                    LOGICAL UNIT ADDRESS             08680000
          DS    CL1                    NOT USED                         08720000
IJCP4&CG9 DS    CL3                    ADDRESS OF CCW                   08760000
          DS    CL1                    STATUS BYTE                      08800000
          DS    CL3                    CSW CCW ADDR.                    08840000
IJCF6&CG9 DS    CL4                    ADDRESS OF LOGIC MODULE      4-0 08880000
IJCP5&CG9 DS    CL1                    DTF TYPE                         08920000
IJCP6&CG9 DS    CL1                    SWITCHES                         08960000
IJCP9&CG9 DS    CL1                    NORMAL COMMAND CODE              09000000
IJCPA&CG9 DS    CL1                    CONTROL COMMAND CODE             09040000
IJCP7&CG9 DS    CL4                    ADDRESS OF IOAREA 1              09080000
IJCP8&CG9 DS    CL4                    BUCKET                           09120000
IJCPB&CG9 DS    CL2                    L 12,&RECSIZE                    09160000
IJCPC&CG9 DS    CL4                    LA &IOREG,0(14)                  09200000
          DS    CL1                    SWITCH 2                         09240000
          DS    CL1                    BLANK                            09280000
IJCPG&CG9 DS    CL1                    COMMAND CODE                     09320000
IJCPH&CG9 DS    CL3                    ADDRESS OF IOAREA 2              09360000
IJCPI&CG9 DS    CL1                    FLAGS                            09400000
          DS    CL1                    NOT USED                         09440000
IJCPJ&CG9 DS    CL2                    COUNT                            09480000
          AIF   ('&CG1' NE '2520').P70                                  09520000
          DS    CL8                    CCW FOR EJECT LAST PROGR. CARD   09560000
.P70      AIF   ('&CRDERR' EQ '' OR '&CG1' NE '2540').P77               09600000
IJCPP&CG9 DS    CL1                    CCW FOR PUNCH ERROR RETRY        09640000
          DS    CL5                                                     09680000
IJCPQ&CG9 DS    CL2                    CCW COUNT                        09720000
IJCPL&CG9 DS    CL80                   AREA FOR SAVE CARD IMAGE         09760000
.P77      AIF   ('&AL1' GT 'E' OR '&AL1' EQ 'D').P77A               4-0 09800000
IJCF1&CG9 DS    CL4                    ASOCFLE ADDRESS              4-0 09840000
.P77A     AIF   ('&AL1' NE 'D').P77M                                4-0 09880000
IJCW1&CG9 DS    CL8                    INTERPRET CCW LINE 1         4-0 09920000
IJCW2&CG9 DS    CL8                    INTERPRET CCW LINE 2         4-0 09960000
IJCW3&CG9 DS    CL64                   PRINT ON LINE 3              4-0 10000000
.P77M     ANOP                                                      4-0 10040000
&NAM      CSECT                                                         10080000
          AIF   (T'&LABEL NE 'O').XAXA                                  10120000
          AIF   ('&CNTL' NE 'C').XAXA                                   10160000
&ENT      SETC  '&NAM'(1,4)'Z'.'&NAM'(6,3)                              10200000
          ENTRY &ENT                                                    10240000
&ENT      EQU   *                                                       10280000
.XAXA     USING IJCP0&CG9,1                                             10320000
          USING *,15                                                    10360000
          AIF   ('&CONTROL' EQ '').P14                                  10400000
          B     IJCPK&CG9              BRANCH TO CONTROL                10440000
          AGO   .P15                                                    10480000
.P14      SVC   IJCL6&CG9              CONTROL ERROR                    10520000
          DC    H'0'                                                    10560000
.P15      SVC   IJCL6&CG9              PRINTOV ERROR                    10600000
          DC    H'0'                                                    10640000
          SVC   IJCL6&CG9              GET ERROR                        10680000
          DC    H'0'                                                    10720000
          B     IJCPU&CG9              BRANCH TO PUT                    10760000
          AIF   ('&AL1' NE 'A' AND '&AL1' NE 'E').P16               4-0 10800000
IJCPE&CG9 SVC   IJCL6&CG9              MACRO SEQ ERROR              4-0 10840000
          DC    H'0'                                                4-0 10880000
.P16      DC    CL8'&NAM'          MODULE NAME                      4-0 10920000
        DC   C'C440'  /*@@LVLID*/  CHANGE LEVEL                @D14BDBF 10960000
        DC   CL43'5686-007 (C) COPYRIGHT IBM CORP. 1981,1988'  @D14BDBF 11000000
        DC   CL37'LICENSED MATERIALS-PROPERTY OF IBM  '        @D14BDBF 11040000
IJCPU&CG9 EQU   *                                                       11080000
         AIF   ('&CG1' NE '1442' AND '&CG1' NE '2520' AND '&CG1' NE '25X11120000
               96').P68                                             4-0 11160000
          TM    IJCP6&CG9,IJCL9&CG9    TEST FIRST TIME SWITCH           11200000
          BO    IJCPZ&CG9                                               11240000
          OI    IJCP6&CG9,IJCL9&CG9    SET FIRST TIME SW. ON            11280000
         AIF   ('&CG1' NE '1442' AND '&CG1' NE '2596').P78A         4-0 11320000
          MVI   IJCPG&CG9,IJCLL&CG9    MOVE EJECT CODE TO CCW           11360000
.P78A     SVC   IJCL7&CG9              EXCP                             11400000
          TM    IJCP1&CG9,IJCL8&CG9    WAIT CHANNEL END                 11440000
          BO    *+6                                                     11480000
          SVC   7                                                       11520000
         AIF   ('&CG1' NE '1442' AND '&CG1' NE '2596').P78B         4-0 11560000
          MVC   IJCPG&CG9.(1),IJCP9&CG9  RESTORE OP CODE IN CCW         11600000
          AGO   .P76                                                    11640000
.P78B     ST    14,IJCP8&CG9           SAVE REG 14                      11680000
          LA    14,40(1)               COMPUTE ADDRESS OF CCW           11720000
          ST    14,IJCP3&CG9+2         PUT CCW ADDRESS IN CCB           11760000
          L     14,IJCP8&CG9           RESTORE REG 14                   11800000
.P76      ANOP                                                          11840000
IJCPZ&CG9 EQU   *                                                       11880000
.P68      AIF   ('&AL1' NE 'A' AND '&AL1' NE 'E').P68B              4-0 11920000
          ST    IJCL4&CG9,IJCP8&CG9    SAVE REG 14             @DA09627 11960000
          L     IJCL4&CG9,IJCF1&CG9    LOAD A(ASOCFLE)              4-0 12000000
          AIF   ('&AL1' EQ 'A').P68A                                4-0 12040000
          L     IJCL4&CG9,IJC48&CG9.(IJCL4&CG9)  POINT TO ASOCFLE   4-0 12080000
.P68A     TM    IJCF6&CG9,IJCLA&CG9         FILE OPENED IGNORE @DA08769 12120000
          BO    IJCF4&CG9                   YES, BRANCH        @DA08769 12160000
          TM    IJCP6&CG9,IJCL8&CG9         IS THE PUNCH OPEN  @DA08769 12200000
          BZ    IJCPE&CG9                   MACOR SEQ ERROR         4-0 12240000
IJCF4&CG9 TM    IJCP6&CG9,IJCL9&CG9         FIRST TIME SW      @DA09627 12280000
          BZ    IJCF5&CG9                   NO, BRANCH         @DA09627 12320000
          TM    IJCF6&CG9,IJCLC&CG9         PUT ISSUED LAST         4-0 12360000
          BO    IJCPE&CG9                   YES, MACRO SEQ ERROR    4-0 12400000
IJCF5&CG9 OI    IJCP6&CG9,IJCL9&CG9         RESET FIRST TIME SW@DA09627 12440000
          TM    IJCLC&CG9.(IJCL4&CG9),IJCLC&CG9    READ ISSUED LAST 4-0 12480000
          BZ    IJCPE&CG9                   NO, MACRO SEQ ERROR     4-0 12520000
          XI    IJCLC&CG9.(IJCL4&CG9),IJCLC&CG9    SET OFF GET SW   4-0 12560000
          OI    IJCF6&CG9,IJCLC&CG9               SET ON PUT SW     4-0 12600000
          MVI   IJCF1&CG9,IJCLA&CG9    SET FOR FUNC=RPW             4-0 12640000
          L     IJCL4&CG9,IJCP8&CG9         RESTORE REG 14     @DA09627 12680000
.P68B     AIF   (T'&IOAREA2 NE 'O' OR T'&WORKA NE 'O').P90          4-0 12720000
          AGO   .P54                                                    12760000
.P90      AIF   ('&AL1' LE '3' OR '&AL1' GE '6').P74                4-0 12800000
           AIF (T'&RDONLY NE 'O').BK2                               3-3 12840000
          STM   IJCL2&CG9,IJCL4&CG9,IJCPS&CG9  SAVE REGS 12,13,14   3-3 12880000
         AGO   .BK3                                                 3-3 12920000
.BK2     ANOP                                                       3-3 12960000
         STM   IJCL1&CG9,IJCL4&CG9,0(IJCL3&CG9) SAVE USER REGS 11-143-3 13000000
         LR    IJCL1&CG9,IJCL3&CG9     POINTER TO SAVE AREA         3-3 13040000
.BK3     ANOP                                                       3-3 13080000
&BL4      SETB  1                                                       13120000
IJCRT&CG9 TM    IJCP1&CG9,IJCL8&CG9    WAIT CHANNEL END                 13160000
          BO    *+6                                                     13200000
          SVC   7                                                       13240000
          TM    IJCP2&CG9,IJCLC&CG9    TEST IF PUNCH ERROR              13280000
          BO    IJCPN&CG9              IF YES, GO TO RETRY ROUTINE      13320000
          AIF   ('&CG1' NE '2540').P83                                  13360000
          MVC   IJCPP&CG9.(1),IJCPG&CG9   SAVE CCW OP CODE              13400000
          MVC   IJCPQ&CG9.(2),IJCPJ&CG9  SAVE CCW COUNT                 13440000
          L     IJCL4&CG9,IJCPG&CG9    LOAD REG 14 WITH IOAREA ADDR.    13480000
          MVC   IJCPL&CG9.(80),0(IJCL4&CG9)  SAVE CARD IMAGE            13520000
          AGO   .P83                                                    13560000
.P74      AIF   ('&AL1' LE 'E' AND '&AL1' NE 'D').P53A              4-0 13600000
          AIF   ('&IOAREA2' NE '').P53                              4-0 13640000
.P53A     AIF   ('&WORKA' EQ '').P54                                4-0 13680000
.P53      TM    IJCP1&CG9,IJCL8&CG9    WAIT CHANNEL END                 13720000
          BO    *+6                                                     13760000
          SVC   7                                                       13800000
.P54      AIF   ('&RECFM2' NE 'FIXUNB').P61                    @D14BDBF 13840000
         AIF   ('&AL1' LE 'E' AND '&AL1' NE 'D').P54A               4-0 13880000
         AIF   ('&IOAREA2' NE '').P61                               4-0 13920000
.P54A    AIF   ('&WORKA' NE '').P61                                 4-0 13960000
          AIF  ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A').P61                   14000000
         AIF   ('&AL1' EQ '4' OR '&AL1' EQ '5').P99                 4-0 14040000
&BL2      SETB  1                                                       14080000
          AGO   .P62                                                    14120000
.P99     AIF   (T'&RDONLY NE 'O').BK4                               3-3 14160000
         ST    IJCL4&CG9,IJCPS&CG9+8   SAVE REG 14                  3-3 14200000
         AGO   .P62                                                 3-3 14240000
.BK4     ST    IJCL4&CG9,12(IJCL3&CG9) SAVE REG 14                  3-3 14280000
          AGO   .P62                                                3-3 14320000
.P61     AIF   (T'&RDONLY EQ 'O').BK5                               3-3 14360000
         STM   IJCL1&CG9,IJCL4&CG9,0(IJCL3&CG9) SAVE USER REGS 11-143-3 14400000
         LR    IJCL1&CG9,IJCL3&CG9     POINTER TO SAVE AREA         3-3 14440000
         AGO   .P83                                                 3-3 14480000
.BK5     STM   IJCL2&CG9,IJCL4&CG9,IJCPS&CG9 SAVE REGS 12-14        3-3 14520000
.P83     AIF    ('&RECFM2' NE 'UNDEF').P51                     @D14BDBF 14560000
          EX    0,IJCPB&CG9            LOAD REG12 WITH LENGTH           14600000
.P51      AIF   ('&WORKA' NE '').P50                                    14640000
          AIF  ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A').P50                   14680000
          AIF   ('&RECFM2' EQ 'VARUNB').P50                    @D14BDBF 14720000
          AGO   .P18                                                    14760000
.P50      L     IJCL4&CG9,IJCP7&CG9    LOAD REG14 WITH ADDR.OF IOAREA1  14800000
          AIF  ('&CNTL' EQ 'Z' OR '&CNTL' EQ 'C').P18                   14840000
          BCTR  IJCL4&CG9,0            ADJUST IOAREA ADDR.              14880000
&AL4      SETA  1                                                       14920000
          AIF   ('&WORKA' NE '').P19                                    14960000
          AIF   ('&CTLCHR' NE 'ASA').P66                                15000000
          MVC   IJCPA&CG9.(1),0(IJCL4&CG9) MOVE CTLCHR TO CONCMD        15040000
          AGO   .P18                                                    15080000
.P66      MVC   IJCPG&CG9.(1),0(IJCL4&CG9)  MOVE CTLCHR TO CCW          15120000
          AGO   .P18                                                    15160000
.P19      LR    IJCL3&CG9,IJCG0&CG9  LOAD REG13 WITH WORKA ADDR@D14BDBF 15200000
&BL1      SETB  1                                                       15240000
          AIF   ('&RECFM2' NE 'VARUNB').P20                    @D14BDBF 15280000
&AL5      SETA  4                                                       15320000
.P20      AIF   ('&CTLCHR' NE 'ASA').P67                                15360000
          MVC   IJCPA&CG9.(1),&AL5.(IJCL3&CG9)  MOVE CTLCHR TO CONCMD   15400000
          AGO   .P18                                                    15440000
.P67      MVC   IJCPG&CG9.(1),&AL5.(IJCL3&CG9)  MOVE CTLCHR TO CCW      15480000
.P18      AIF   ('&RECFM2' NE 'FIXUNB').P21                    @D14BDBF 15520000
          AIF   ('&WORKA' EQ '').P28                                    15560000
          LH    IJCL2&CG9,IJCPJ&CG9    LOAD COUNT IN REG12              15600000
          AIF  ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A').P24                   15640000
          BCTR  IJCL2&CG9,0            SUBTRACT ONE FROM REG12          15680000
          AGO   .P23                                                    15720000
.P21      AIF   ('&RECFM2' NE 'VARUNB').P25                    @D14BDBF 15760000
&AL4      SETA  &AL4+4                                                  15800000
          SH    IJCL4&CG9,IJCQ7&CG9    ADJUST IOAREA ADDR.              15840000
          AIF   ('&WORKA' EQ '').P26                                    15880000
          AIF   (&BL1).P55                                              15920000
          LR    IJCL3&CG9,IJCG0&CG9    PUT WORKA ADDR.IN REG13 @D14BDBF 15960000
&BL1      SETB  1                                                       16000000
.P55      MVC   IJCP8&CG9.(2),0(IJCL3&CG9) MOVE LENGTH TO INT.BOUND.    16040000
          AGO   .P27                                                    16080000
.P26      MVC   IJCP8&CG9.(2),0(IJCL4&CG9) MOVE LENGTH TO INT.BOUND.    16120000
.P27      LH    IJCL2&CG9,IJCP8&CG9    LOAD LENGTH IN REG12             16160000
.P25      ANOP                                                          16200000
&AL6      SETA  &AL4+1                                                  16240000
          AIF   ('&WORKA' EQ '').P22                                    16280000
          BCTR  IJCL2&CG9,0            ADJUST REG12 FOR MOVE INSTR.     16320000
&AL6      SETA  &AL4                                                    16360000
          AIF   (&BL1).P24                                              16400000
.P23      LR    IJCL3&CG9,0            PUT ADDR.OF WORKA IN REG13       16440000
.P24      EX    IJCL2&CG9,IJCPT&CG9    MOVE WORKA TO IOAREA             16480000
          AIF   ('&RECFM2' EQ 'FIXUNB').P28                    @D14BDBF 16520000
.P22      AIF   (&AL6 EQ 1).P56                                         16560000
          AIF   (&AL6 NE 0).P57                                         16600000
          LA    IJCL2&CG9,1(IJCL2&CG9) ADJUST DATA  LENGTH              16640000
          AGO   .P56                                                    16680000
.P57      AIF   (&AL6 NE 2).P58                                         16720000
          BCTR  IJCL2&CG9,0            ADJUST DATA LENGTH               16760000
          AGO   .P56                                                    16800000
.P58      ANOP                                                          16840000
&AL6      SETA  &AL6-1                                                  16880000
          SH    IJCL2&CG9,IJCQ6&CG9    ADJUST DATA LENGTH               16920000
.P56      STH   IJCL2&CG9,IJCPJ&CG9    PUT COUNT IN CCW                 16960000
.P28      AIF   ('&CTLCHR' NE 'ASA').P30                                17000000
          CLI   IJCPA&CG9,IJCLH&CG9    COMPARE CTLCHR WITH W            17040000
          BE    IJCPW&CG9                                               17080000
          NI    IJCPG&CG9,IJCLK&CG9    SET SS BIT OFF                   17120000
          B     IJCPY&CG9                                               17160000
IJCPW&CG9 OI    IJCPG&CG9,IJCL9&CG9    SET SS BIT ON                    17200000
IJCPY&CG9 EQU   *                                                       17240000
.P30      AIF   ('&IOAREA2' EQ '').P33                                  17280000
         AIF   ('&AL1' LE 'E' AND '&AL1' NE 'D').P33                4-0 17320000
          L     IJCL4&CG9,IJCPG&CG9    LOAD ADDR IOAREA2 IN REG14       17360000
          MVC   IJCPG&CG9+1(3),IJCP7&CG9+1  SWAP IOAREAS                17400000
          ST    IJCL4&CG9,IJCP7&CG9                                     17440000
          AIF   (T'&WORKA NE 'O').P33                                   17480000
          AIF   (&AL4 EQ 0).P34                                         17520000
          AIF   (&AL4 GT 1).P65                                         17560000
          BCTR  IJCL4&CG9,0            CALCULATE IOAREA ADDRESS         17600000
          AGO   .P34                                                    17640000
.P65      SH    IJCL4&CG9,IJCQ4&CG9    CALCULATE IOAREA ADDRESS         17680000
.P34     AIF   (T'&RDONLY NE 'O').BK7                               3-3 17720000
         LM    IJCL2&CG9,IJCL3&CG9,IJCPS&CG9   RESTORE REGS 12,13   3-3 17760000
          EX    0,IJCPC&CG9            LOAD USER POINTER REG.       3-3 17800000
          L     IJCL4&CG9,IJCPS&CG9+8  RESTORE  REG14               3-3 17840000
          AGO   .P35                                                3-3 17880000
.BK7     LM    IJCL1&CG9,IJCL3&CG9,0(IJCL1&CG9)   RESTORE REGS 11,123-3 17920000
         EX    0,IJCPC&CG9             LOAD USER POINTER REG        3-3 17960000
         L     IJCL4&CG9,12(IJCL3&CG9) RESTORE REG14                3-3 18000000
         AGO   .P35                                                 3-3 18040000
.P33     AIF   (T'&RDONLY NE 'O').BK6                               3-3 18080000
         LM    IJCL2&CG9,IJCL4&CG9,IJCPS&CG9   RESTORE REGS 12,13,143-3 18120000
         AGO   .P35                                                 3-3 18160000
.BK6     LM    IJCL1&CG9,IJCL4&CG9,0(IJCL1&CG9) RESTORE REGS 11-14  3-3 18200000
.P35      AIF  ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A').P36                   18240000
.P62      AIF   ('&CONTROL' EQ '').P36                                  18280000
          MVC   IJCPG&CG9.(1),IJCPA&CG9  MOVE CONCMD TO CCW             18320000
          MVC   IJCPA&CG9.(1),IJCP9&CG9  RESTORE CONCMD                 18360000
.P36      ANOP                                                          18400000
          AIF   ('&AL1' NE 'D').P36M                                4-0 18440000
          ST    IJCL4&CG9,IJCP8&CG9          SAVE REG 14       @DA09627 18480000
          L     IJCL4&CG9,IJCPG&CG9          LOAD ADDRESS OF I/O 1  4-0 18520000
         MVC  IJCW3&CG9+IJC48&CG9.(IJCLC&CG9),IJCL9&CG9.(IJCL4&CG9) 4-0 18560000
         LA    IJCL4&CG9,IJCPG&CG9     PLACE ADDRESS OF CCW    @DA08364 18600000
         STCM  IJCL4&CG9,7,IJCP4&CG9   IN CCB                  @DA08364 18640000
          L     IJCL4&CG9,IJCP8&CG9          RESTORE REG 14    @DA09627 18680000
.P36M     ANOP                                                      4-0 18720000
IJCEX&CG9 SVC   IJCL7&CG9              EXCP                             18760000
          AIF   ('&AL1' NE 'C').P36J                                4-0 18800000
          OI    IJCF6&CG9,IJCLC&CG9         SET ON PUT SW           4-0 18840000
          MVI   IJCF1&CG9,IJCLA&CG9    SET FOR FUNC=PW              4-0 18880000
.P36J     AIF   ('&AL1' LE 'E' AND '&AL1' NE 'D').P36A              4-0 18920000
          AIF   ('&IOAREA2' NE '').P37                                  18960000
.P36A    AIF   ('&WORKA' NE '').P37                                 4-0 19000000
          TM    IJCP1&CG9,IJCL8&CG9    WAIT CHANNEL END                 19040000
          BO    *+6                                                     19080000
          SVC   7                                                       19120000
          AIF   ('&CG1' NE '3525').P37V                             4-0 19160000
          TM    IJCF6&CG9,IJCL9&CG9         ERROPT SPECIFIED        4-0 19200000
          BZ    IJCM9&CG9                   NO, RETURN TO USER      4-0 19240000
          TM    IJCP2&CG9,IJCLC&CG9         ERROR DETECTED          4-0 19280000
          BZ    IJCM9&CG9                   NO, RETURN TO USER      4-0 19320000
          L     IJCM8&CG9,IJCPG&CG9         LOAD ADDR OF I/O AREA   4-0 19360000
          LA    IJCM8&CG9,0(IJCM8&CG9)      CLEAR HIGH ORDER BYTE   4-0 19400000
.P37V     AIF   ('&AL1' LE '3' OR '&AL1' GE '6').P37                4-0 19440000
          TM    IJCP2&CG9,IJCLC&CG9    TEST IF PUNCH ERROR              19480000
          BO    IJCPN&CG9              IF YES, GO TO RETRY ROUTINE      19520000
          AIF   ('&CG1' NE '2540').P371                                 19560000
          MVC   IJCPP&CG9.(1),IJCPG&CG9   SAVE CCW OP CODE              19600000
          MVC   IJCPQ&CG9.(2),IJCPJ&CG9  SAVE CCW COUNT                 19640000
          L     IJCL4&CG9,IJCPG&CG9    LOAD REG 14 WITH IOAREA ADDR.    19680000
          MVC   IJCPL&CG9.(80),0(IJCL4&CG9)  SAVE CARD IMAGE            19720000
.P371    AIF   (T'&RDONLY NE 'O').BK8                               3-3 19760000
         L     IJCL4&CG9,IJCPS&CG9+8   RESTORE REG 14               3-3 19800000
         AGO   .P37                                                 3-3 19840000
.BK8     L     IJCL4&CG9,12(IJCL3&CG9) RESTORE REG 14               3-3 19880000
.P37      ANOP                                                      4-0 19920000
IJCM9&CG9 BR    IJCL4&CG9                   BACK TO USER            4-0 19960000
          AIF   ('&CONTROL' EQ '').P38                                  20000000
          AIF   ('&CG1' EQ '3505' OR '&CG1' EQ '3525').P37A         4-0 20040000
IJCPK&CG9 STC   0,IJCPA&CG9            PUT CONTROL CODE IN CONCMD       20080000
          AGO   .P37B                                               4-0 20120000
.P37A     ANOP                                                      4-0 20160000
IJCPK&CG9 STC   IJCG0&CG9,IJCP8&CG9         PUT CONTROL CODE   @D14BDBF 20200000
          NI    IJCPA&CG9,IJCLB&CG9         AND ALTER IT            4-0 20240000
          OC    IJCPA&CG9.(IJCLF&CG9),IJCP8&CG9    IN CONCMD   @DA09627 20280000
.P37B    AIF   ('&CG1' NE '1442' AND '&CG1' NE '2596').HA           4-0 20320000
          OI    IJCPA&CG9,X'80'                                         20360000
.HA       BR    IJCL4&CG9                                               20400000
.P38      AIF   (&AL4 LE 1).P70A                                        20440000
IJCQ4&CG9 DC    H'&AL4'                                                 20480000
.P70A     AIF   (&AL6 LE 1).P71                                         20520000
IJCQ6&CG9 DC    H'&AL6'                                                 20560000
.P71      AIF   ('&RECFM2' NE 'VARUNB').P72                    @D14BDBF 20600000
IJCQ7&CG9 DC    H'4'                                                    20640000
.P72     AIF   ('&AL1' LE '3' OR '&AL1' GE '6').P84                 4-0 20680000
IJCPN&CG9 EQU   *                                                       20720000
          AIF   ('&CG1' NE '2540').WWW                                  20760000
          LA    IJCL4&CG9,48(1)        CALCULATE CCW2 ADDR.             20800000
          ST    IJCL4&CG9,IJCP3&CG9+2  STORE CCW2 ADDR. IN CCB          20840000
IJCPR&CG9 SVC  IJCL7&CG9          EXCP                                  20880000
.WWW      LR    IJCL4&CG9,1            SAVE REG 1                       20920000
         LA     1,IJCCW&CG9            ADDR OF CCW                      20960000
         ST     1,IJCCC&CG9+8               IN CCB                      21000000
         LA     1,IJCCW&CG9+8          ADDR OF AREA                     21040000
         ST     1,IJCCW&CG9                 INTO CCW                    21080000
         MVI   IJCCW&CG9,X'09'         RESTORE COMMAND CODE             21120000
          LA    1,IJCCC&CG9            LOAD REG1  WITH CONSOLE CCB      21160000
          SVC   IJCL7&CG9              EXCP                             21200000
          TM    IJCCC&CG9+2,IJCL8&CG9  WAIT CHANNEL END                 21240000
          BO    *+6                                                     21280000
          SVC   7                                                       21320000
          LR    1,IJCL4&CG9            RESTORE REG 1                    21360000
          AIF   ('&CG1' NE '2540').WWW1                                 21400000
         TM    IJCP1&CG9,IJCL8&CG9                                      21440000
         BO    *+6                                                      21480000
         SVC   7                                                        21520000
         TM    IJCP2&CG9,IJCLC&CG9 TEST FOR PUNCH ERROR.                21560000
         BO    IJCPR&CG9          BR YES FOR RETRY.                     21600000
          LA    IJCL4&CG9,40(1)        CALCULATE CCW ADDR.              21640000
          ST    IJCL4&CG9,IJCP3&CG9+2  RESTORE CCW ADDR. IN CCB         21680000
.WWW1     AIF   (NOT &BL4).P97                                          21720000
          SVC   IJCL7&CG9              EXCP                             21760000
          B     IJCRT&CG9                                               21800000
          AGO   .P84A                                                   21840000
.P97      B     IJCEX&CG9                                               21880000
.P84A     DC    0D'0'                                                   21920000
IJCCC&CG9 DC    6X'00'                 RES CNT,COM BTS,CSW ST BT        21960000
          DC    X'0004'                LOGICAL UNIT ADDR.               22000000
          DC    A(*+8)                 ADDR. OF CCW                     22040000
          DC    4X'00'                 STATUS BYTE,CSW CCW ADDR.        22080000
IJCCW&CG9 CCW  9,*+8,X'00',11                                           22120000
          DC    C'4000I RETRY'                                          22160000
.P84      ANOP                                                          22200000
IJCL1&CG9 EQU  11                      REG 11                       3-3 22240000
IJCL2&CG9 EQU   12                     REG12                            22280000
IJCL3&CG9 EQU   13                     REG13                            22320000
IJCL4&CG9 EQU   14                     REG14                            22360000
IJCL5&CG9 EQU   15                     REG15                            22400000
IJCL6&CG9 EQU   50                     ABEOJ                            22440000
IJCL7&CG9 EQU   0                      EXCP                             22480000
IJCG0&CG9 EQU   0                      REG0                    @D14BDBF 22520000
IJCF3&CG9 EQU   56                                                  4-0 22560000
IJCM8&CG9 EQU   1                      REG 1                        4-0 22600000
IJC48&CG9 EQU  48                      DISP IN BUFFER FOR INTERPRET 4-0 22640000
IJCL8&CG9 EQU   X'80'                                                   22680000
IJCL9&CG9 EQU   X'40'                                                   22720000
IJCLA&CG9 EQU   X'20'                                                   22760000
IJCLB&CG9 EQU   X'08'                                                   22800000
IJCLC&CG9 EQU   X'10'                                                   22840000
IJCLD&CG9 EQU   X'04'                                                   22880000
IJCLE&CG9 EQU   X'06'                                                   22920000
IJCLF&CG9 EQU   X'01'                                                   22960000
IJCLG&CG9 EQU   X'02'                                                   23000000
IJCLH&CG9 EQU   C'W'                                                    23040000
IJCLI&CG9 EQU   X'FE'                                                   23080000
IJCLJ&CG9 EQU   X'0B'                                                   23120000
IJCLK&CG9 EQU   X'BF'                                                   23160000
IJCLL&CG9 EQU   X'83'                                                   23200000
         AIF   (T'&RDONLY NE 'O').P63                               3-3 23240000
IJCPS&CG9 DC    3F'0'                                                   23280000
.P63      AIF   ('&WORKA' EQ '').P32                                    23320000
IJCPT&CG9 MVC   0(0,IJCL4&CG9),0(IJCL3&CG9) MOVE WORKA TO IOAREA        23360000
.P32     ANOP                                                           23400000
          AIF   (T'&SEPASMB NE 'O').P32A                                23440000
&SYSECT  CSECT                                                          23480000
.P32A    MEXIT                                                          23520000
.REMOD    AIF   (T'&CTLCHR EQ 'O').LALA                                 23560000
          MNOTE 0,'CTLCHR INVALID PARAMETER. IGNORED'                   23600000
.LALA     ANOP                                                          23640000
          AIF   (T'&IOAREA2 EQ 'O' OR T'&CONTROL EQ 'O').R0             23680000
     AIF ('&IOAREA2' EQ '').R0                                      3-3 23720000
          AIF   ('&AL1' LE 'E' AND '&AL1' NE 'D').R0                4-0 23760000
          MNOTE 0,'IOAREA2 AND CONTROL BOTH SPECIFIED. ONLY IOAREA2 CON*23800000
               SIDERED'                                                 23840000
&CNTL     SETC  'Z'                                                     23880000
.R0     AIF   ('&RECFM2' EQ 'FIXUNB' OR '&RECFM2' EQ '').AUAU  @D14BDBF 23920000
          MNOTE 0,'IMPROPER RECFORM. ''FIXUNB'' ASSUMED'                23960000
&RECFM2   SETC  'FIXUNB'                                       @D14BDBF 24000000
.AUAU    AIF   (T'&RDONLY EQ 'O').P63AA                             3-3 24040000
&NAM     SETC  'IJCF&CNTL.H&WKIO&AL1'                               3-3 24080000
         AGO   .P36AB                                               3-3 24120000
.P63AA   ANOP                                                       3-3 24160000
&NAM SETC 'IJCF&CNTL.I&WKIO&AL1'                                    3-3 24200000
.P36AB   AIF   (T'&LABEL EQ 'O').CCC                                3-3 24240000
&NAM      SETC  '&LABEL'                                                24280000
.CCC      AIF   (T'&SEPASMB EQ 'O').DDD                                 24320000
          PUNCH ' CATALOG &NAM..OBJ                     REPLACE=YES'    24360000
.DDD     AIF   (&IJCGB1).R00                                            24400000
&IJCGB1  SETB  1                                                        24440000
IJCR     DSECT                                                          24480000
IJCRRC   DS    CL2                     RESIDUAL  COUNT                  24520000
IJCRC1   DS    CL1                     COMMUNICATION BYTE 1             24560000
IJCRC2   DS    CL1                     COMMUNICATION BYTE 2             24600000
IJCRST    DS    CL2                    CSW STATUS BYTES                 24640000
IJCRLU   DS    CL2                     LOGICAL UNIT  ADDRESS            24680000
IJCR2C    DS    CL1                    DOUBLE CCB INDICATOR    @D33FDVS 24720000
IJCRCA   DS    CL3                     CCW ADDRESS                      24760000
          DS    CL1                    STATUS BYTE                      24800000
          DS    CL3                    CSW CCW ADDR.                    24840000
IJCRM1   DS    CL4                      ADDRESS OF LOGIC MODULE     4-0 24880000
IJCRDT   DS    CL1                     DTF  TYPE                        24920000
IJCRSW   DS    CL1                     SWITCHES                         24960000
IJCRNO   DS    CL1                     NORMAL COMMAND  CODE             25000000
IJCRCO   DS    CL1                     CONTROL COMMAND  CODE            25040000
IJCRI2   DS    CL4                     ADDRESS OF  IOAREA 2             25080000
IJCREF   DS    CL4                     ADDRESS OF  EOF  ROUTINE         25120000
IJCRCC   DS    CL1                     COMMAND CODE                     25160000
IJCRI1   DS    CL3                     ADDRESS  IOAREA1                 25200000
IJCRFL   DS    CL1                     FLAGS =X'20'                     25240000
         DS    CL1                     NOT USED                         25280000
IJCRCT   DS    CL2                     COUNT                            25320000
IJCRLP   DS    CL4                     LA &IOREG,0(14)                  25360000
         DS    CL6                     NOT USED                @D14BDBF 25400000
          DS    CL2                                                 4-0 25440000
IJCRM2   DS    CL4                      ERROPT                      4-0 25480000
IJCRM3   DS    CL4                      A(ASOCFLE)                  4-0 25520000
.R00      ANOP                                                          25560000
&NAM      CSECT                                                         25600000
          AIF   (T'&LABEL NE 'O').XEXE                                  25640000
          AIF   ('&CNTL' NE 'C').XEXE                                   25680000
&ENT      SETC  '&NAM'(1,4)'Z'.'&NAM'(6,3)                              25720000
          ENTRY &ENT                                                    25760000
&ENT      EQU   *                                                       25800000
.XEXE     USING IJCRRC,1                                                25840000
          USING *,15                                                    25880000
          AIF      ('&CNTL' NE 'C' OR '&CG1' EQ '2501').R4              25920000
           B   IJCRC&CG9               BRANCH TO CONTROL            3-3 25960000
          AGO   .R5                                                     26000000
.R4       SVC   IJCR0&CG9              CONTROL ERROR                    26040000
          DC    H'0'                                                    26080000
.R5       SVC   IJCR0&CG9              PRTOV ERROR                      26120000
          DC    H'0'                                                    26160000
          B     IJCRA&CG9              BRANCH TO GET                    26200000
          SVC   IJCR0&CG9              PUT ERROR                        26240000
          DC    H'0'                                                    26280000
          AIF   ('&CG1' NE '3505' AND '&CG1' NE '3525').R5A         4-0 26320000
          B     IJCM4&CG9          ERROPT EQUAL SKIP                4-0 26360000
          B     IJCM5&CG9          ERROPT EQUAL IGNORE              4-0 26400000
          AIF   ('&AL1' NE 'A' AND '&AL1' NE 'E').R5A               4-0 26440000
IJCRE&CG9 SVC   IJCR0&CG9          MACRO SEQ. ERROR                 4-0 26480000
          DC    H'0'                                                4-0 26520000
.R5A      DC    CL8'&NAM'          MODULE NAME                      4-0 26560000
        DC   C'C440'  /*@@LVLID*/  CHANGE LEVEL               @D41TDKY  26600000
        DC   CL43'5686-007 (C) COPYRIGHT IBM CORP. 1981,1988' @D41TDKY  26640000
        DC   CL37'LICENSED MATERIALS-PROPERTY OF IBM  '       @D41TDKY  26680000
          AIF   ('&IOAREA2' EQ '').R6                                   26720000
          AIF   ('&AL1' LE 'E').R6                                  4-0 26760000
IJCRA&CG9 EQU   *                                              @D33FDVS 26800000
          AIF   ('&CG1' NE '2501').R5C                         @D33FDVS 26840000
          TM    IJCR2C,X'80'           TEST IF DOUBLE CCB SUP  @D33FDVS 26880000
          BO    IJCA9&CG9              BRANCH IF YES           @D33FDVS 26920000
.R5C      ANOP                                                 @D33FDVS 26960000
          TM    IJCRSW,IJCR5&CG9       TEST IF FIRST TIME      @D33FDVS 27000000
          BO    IJCRB&CG9                                      @D33FDVS 27040000
          AGO   .R7                                                     27080000
.R6       AIF  ('&CNTL' NE 'C').R2                                      27120000
          AIF   ('&AL1' EQ 'A' OR '&AL1' EQ 'E').R2                 4-0 27160000
         AIF   ('&CG1' NE '1442' AND '&CG1' NE '2596').R254         4-0 27200000
IJCRA&CG9 MVC   IJCRCC(1),IJCRCO       PUT CONTROL OP CODE IN CCW       27240000
          MVC   IJCRCO(1),IJCRNO       RESTORE CONCMD TO NORMAL         27280000
         AGO   .R8                                                  3-7 27320000
.R254    ANOP                                                       3-7 27360000
IJCRA&CG9 TM   IJCRCC,IJCLQ&CG9   TEST FOR C2 IN COMM. C0DE    @DA20147 27400000
          BNO  IJCRQ&CG9          NO,READ A CARD               @DA20147 27440000
          MVC  IJCRCC(1),IJCRCO   PUT CONTR COMM. CODE IN CCW      3-10 27480000
          SVC  IJCR1&CG9          FEED AND SSEL                    3-10 27520000
          TM   IJCRC1,IJCR4&CG9   WAIT FOR CHANNEL END             3-10 27560000
          BO   *+6                                                 3-10 27600000
          SVC  7                                                   3-10 27640000
IJCRQ&CG9 MVC  IJCRCC(1),IJCRNO        PUT READ CMD IN CCW         3-10 27680000
          AGO   .R8                                                     27720000
.R2       ANOP                                                          27760000
IJCRA&CG9 EQU   *                                                   4-0 27800000
          AIF   ('&AL1' NE 'A' AND '&AL1' NE 'E').R2A               4-0 27840000
          AIF   (T'&RDONLY EQ 'O').R2B                         @DA09627 27880000
          ST    IJCGE&CG9,12(IJCGD&CG9)     SAVE REG 14        @DY38452 27920000
          AGO   .R2C                                           @DA09627 27960000
.R2B      ST    IJCGE&CG9,IJCRJ&CG9     SAVE REG 14            @D14BDBF 28000000
.R2C      L     IJCGE&CG9,IJCRM3        LOAD A(ASOCFLE)        @D14BDBF 28040000
          TM    IJCRM1,IJCR6&CG9            FILE OPENED IGN    @DA08769 28080000
          BO    IJCM8&CG9                   YES, BRANCH        @DA08769 28120000
          TM    IJCRSW,IJCR4&CG9        IS READ FILE OPEN           4-0 28160000
          BZ    IJCRE&CG9               MACRO SEQ ERROR             4-0 28200000
IJCM8&CG9 TM    IJCRK&CG9.(IJCGE&CG9),IJCRK&CG9 PUNCH ISS. LAST@D14BDBF 28240000
          BZ    IJCRE&CG9                    NO, MACRO SEQ ERROR    4-0 28280000
          OI    IJCRM1,IJCRK&CG9             SET ON GET SW          4-0 28320000
          XI    IJCRK&CG9.(IJCGE&CG9),IJCRK&CG9  ET OFF PUT SW @D14BDBF 28360000
          AIF   (T'&RDONLY EQ 'O').R2D                         @DA09627 28400000
          L     IJCGE&CG9,12(IJCGD&CG9)      RESTORE REG 14    @DY38452 28440000
          AGO   .R2A                                           @D14BDBF 28480000
.R2D      L     IJCGE&CG9,IJCRJ&CG9          RESTORE REG 14    @D14BDBF 28520000
.R2A      ANOP                                                      4-0 28560000
IJCRV&CG9 SVC   IJCR1&CG9                   EXCP                    4-0 28600000
          AGO   .R3                                                     28640000
.R7       OI    IJCRSW,IJCR5&CG9       SET FIRST TIME SWITCH ON         28680000
.R8      ANOP                                                           28720000
IJCRV&CG9 SVC   IJCR1&CG9              EXCP                             28760000
.R3       ANOP                                                          28800000
IJCRB&CG9 TM    IJCRC1,IJCR4&CG9       WAIT CHANNEL END                 28840000
          BO    *+6                                                     28880000
          SVC   7                                                       28920000
          AIF   ('&AL1' NE 'B').W3JH                                4-0 28960000
          OI    IJCRM1,IJCRK&CG9            SET ON GET SW           4-0 29000000
          MVI   IJCRM3,IJCR6&CG9       SET FOR FUNC=RW              4-0 29040000
.W3JH    AIF   ('&CG1' NE '1442' AND '&CG1' NE '2596').MAL5         4-0 29080000
         MVC   IJCRCC(1),IJCRCO                                         29120000
.MAL5    ANOP                                                           29160000
.W3      AIF   (T'&RDONLY NE 'O').BK9                               3-3 29200000
          AIF   ('&CG1' EQ '3881').W3PK                        @DL28701 29240000
         AIF   ('&WORKA' NE '').W4                                  3-3 29280000
.W3PK     ST    IJCGE&CG9,IJCRD&CG9    STORE REG 14            @D14BDBF 29320000
          AGO   .W5                                                 3-3 29360000
.BK9     ANOP                                                       3-3 29400000
         ST    IJCGE&CG9,12(IJCGD&CG9)  SAVE REG 14            @DY38452 29440000
         AGO   .W5                                                  3-3 29480000
.W4       ANOP                                                      3-3 29520000
         ST    IJCGE&CG9,IJCRD&CG9+4   STORE REG 14            @D14BDBF 29560000
.W5       L     IJCGE&CG9,IJCRCC       GET IOAREA1 ADDR        @D14BDBF 29600000
          AIF   ('&CG1' NE '3505' AND '&CG1' NE '3525').W5JV        4-0 29640000
          TM    IJCRM1,IJCR5&CG9            ERROPT SPECIFIED        4-0 29680000
          BZ    IJCM6&CG9                   NO, CONTINUE            4-0 29720000
          TM    IJCRC2,IJCRK&CG9            ERROR DETECTED          4-0 29760000
          BO    IJCM7&CG9                   YES, PROCESS ERROR      4-0 29800000
          B     IJCM6&CG9                   NO, CONTINUE            4-0 29840000
IJCM4&CG9 EQU   *                                                   4-0 29880000
          AIF   ('&CNTL' EQ 'C').W5JC                               4-0 29920000
          NI    IJCRCC,IJCX4&CG9            PRESERVE CODE           4-0 29960000
          OI    IJCRCC,IJCR7&CG9              FOR FD, SS            4-0 30000000
          AGO   .W5JD                                               4-0 30040000
.W5JC     MVC   IJCRCC(IJCRX&CG9),IJCRCO     CONTROL COMM. CODE     4-0 30080000
.W5JD     SVC   IJCR1&CG9                   EXCP                    4-0 30120000
          TM    IJCRC1,IJCR4&CG9            WAIT                    4-0 30160000
          BO    *+6                          CHANNEL                4-0 30200000
          SVC   IJCRM&CG9                    END                    4-0 30240000
          MVC   IJCRCC(1),IJCRNO            NORMAL COMM CODE        4-0 30280000
.W5JA     AIF   (T'&RDONLY NE 'O').ER6                              4-0 30320000
          AIF   ('&WORKA' NE '').ER7                                4-0 30360000
          L     IJCGE&CG9,IJCRD&CG9         RESTORE REG 14     @D14BDBF 30400000
          AGO   .ER8                                                4-0 30440000
.ER6      L     IJCGE&CG9,12(IJCGD&CG9)      RESTORE REG 14    @DY38452 30480000
          AGO   .ER8                                                4-0 30520000
.ER7      L     IJCGE&CG9,IJCRD&CG9+4       RESTORE REG 14     @D14BDBF 30560000
.ER8      B     IJCRV&CG9                   CONTINUE                4-0 30600000
IJCM6&CG9 EQU   *                                                   4-0 30640000
.W5JV     AIF   ('&IOAREA2' EQ '').W6                               4-0 30680000
          AIF   ('&AL1' LE 'E').W6                                  4-0 30720000
          MVC   IJCRCC+1(3),IJCRI2+1   SWAP IOAREAS                     30760000
          ST    IJCGE&CG9,IJCRI2                               @D14BDBF 30800000
.W6E      AIF   ('&CG1' EQ '3881').W6PK                        @DL28701 30840000
         AIF ('&WORKA' NE '').W6                                    3-2 30880000
.W6PK     EX    0,IJCRLP               LOAD USER POINTER REG.  @DL28701 30920000
.W6      TM    IJCRST,IJCRX&CG9  TEST FOR U.E. IN CCB CSW STATUS        30960000
         BZ    IJC00&CG9                                                31000000
          AIF   ('&AL1' EQ 'A' OR '&AL1' EQ 'E').W5A                4-0 31040000
         TM    IJCRC1,IJCR5&CG9  TEST IF /* OR /& IN SYSIPT, SYSRDR 3-5 31080000
         BO    IJCRF&CG9                                            3-5 31120000
.W5A      AIF   ('&CG1' NE '3525').W5B                              4-0 31160000
          AIF   ('&AL1' LE 'E' AND '&AL1' NE 'B').W5B               4-0 31200000
          MVI   IJCRCC,IJCR7&CG9   MOVE '23' INTO COMM. CODE        4-0 31240000
          SVC   IJCR1&CG9          EXCP                             4-0 31280000
          TM    IJCRC1,IJCR4&CG9       CHANNEL END                  4-0 31320000
          BO    *+6                    YES, CONTINUE                4-0 31360000
          SVC   IJCRM&CG9              WAIT CHANNEL END             4-0 31400000
         MVC   IJCRCC(1),IJCRNO        NORMAL COMM. CODE       @DA02178 31440000
.W5B      AIF   (T'&RDONLY NE 'O').W5C                         @DY38452 31480000
          AIF   ('&CG1' EQ '3881').W5BPK                       @DL28701 31520000
         AIF   (T'&WORKA NE 'O').W6B                                3-5 31560000
.W5BPK    L     IJCGE&CG9,IJCRD&CG9    RESTORE REGISTER 14     @D14BDBF 31600000
         AGO   .W6C                                                 3-5 31640000
.W5C     ANOP                                                  @DY38452 31680000
         AIF   ('&WORKA' NE '').W6A                            @DY38452 31720000
         B     IJCRW&CG9               GOTO EXIT               @DY38452 31760000
         AGO   .W6D                                            @DY38452 31800000
.W6A     ANOP                                                       3-5 31840000
         L     IJCGE&CG9,12(IJCGD&CG9)  RESTORE REGISTER 14    @DY38452 31880000
         AGO   .W6C                                                 3-5 31920000
.W6B     ANOP                                                       3-5 31960000
         L     IJCGE&CG9,IJCRD&CG9+4   RESTORE REGISTER 14     @D14BDBF 32000000
.W6C     ANOP                                                       3-5 32040000
         B     IJCRV&CG9               RE-ISSUE SVC 0               3-5 32080000
.W6D     ANOP                                                  @DY38452 32120000
IJCRF&CG9 EQU  *                                                        32160000
          AIF   ('&IOAREA2' EQ '').OUI                                  32200000
          AIF   ('&AL1' LE 'E').OUI                                 4-0 32240000
          NI    IJCRSW,X'BF'           PUT FIRST TIME SWITCH OFF        32280000
.OUI      L     IJCGE&CG9,IJCREF       LOAD R14 EOF ROUT.ADDR. @D14BDBF 32320000
          AIF   ('&CG1' EQ '3505' OR '&CG1' EQ '3525').W61B         4-0 32360000
         AIF   ('&CG1' NE '2540').W61A                              3-7 32400000
         AGO   .W61B                                                3-7 32440000
.W61A    AIF   ('&CG1' NE '2520').W61                               3-7 32480000
.W61B    AIF   ('&CNTL' NE 'C').W61                                 3-7 32520000
          TM    IJCRCC,IJCLQ&CG9         'C2' OR DMII IN COMM. CODE 4-0 32560000
          BNO   IJCRZ&CG9                   BRANCH NO               4-0 32600000
         MVI   IJCRCC,IJCR7&CG9   MOVE '23' INTO COMM. CODE         3-6 32640000
         B     IJCRY&CG9                                                32680000
.W61     ANOP                                                           32720000
IJCRZ&CG9 BR   IJCGE&CG9          GO TO EOF ROUTINE.           @D14BDBF 32760000
         AIF   ('&CG1' NE '3881').W61A1                        @DA20292 32800000
IJC00&CG9 CLC  IJCEF&CG9.(2),0(IJCGE&CG9) HARDW GENERATED '/*' @D14BDBF 32840000
         AGO   .W61A2                                          @DA20292 32880000
.W61A1   ANOP                                                  @DA20292 32920000
IJC00&CG9 CLC  IJCEF&CG9,0(IJCGE&CG9) CHECK FOR /* IN I/O AREA @D14BDBF 32960000
.W61A2    AIF   ('&CG1' EQ '3505' OR '&CG1' EQ '3525').W7A     @DA20292 33000000
         BNE   IJCRW&CG9                                                33040000
          AGO   .W7B                                                4-0 33080000
.W7A      BE    IJCRF&CG9           YES, GO TO EOF                  4-0 33120000
.*              &C IS THE SAME AS &CG9                         @D14BDBF 33160000
          CLC   IJCRL&C.(IJCR8&C),IJCMJ&C.(IJCGE&C) COL. BINARY@D14BDBF 33200000
          BNE   IJCRW&CG9           NO, CONTINUE                    4-0 33240000
.W7B      ANOP                                                      4-0 33280000
IJCRN&CG9 B    IJCRF&CG9          GO TO EOF ROUTINE                 4-0 33320000
          AIF   ('&CG1' NE '3505' AND '&CG1' NE '3525').W7C         4-0 33360000
IJCM5&CG9 EQU   *                                                   4-0 33400000
          AIF   ('&IOAREA2' EQ '').W7C1                             4-0 33440000
          AIF   ('&AL1' LE 'E').W7C1                                4-0 33480000
          NI    IJCRSW,X'BF'                RESET FIRST TIME SW     4-0 33520000
.W7C1     L     IJCG1&CG9,IJCRCC            I/O ADDR TO REG 1  @D14BDBF 33560000
          LA    IJCG1&CG9,0(IJCG1&CG9)      CLEAR HIGH ORDER BY@D14BDBF 33600000
          AIF   (T'&RDONLY NE 'O').W7C2                             4-0 33640000
          AIF   ('&WORKA' NE '').W7C3                               4-0 33680000
          L     IJCGE&CG9,IJCRD&CG9         RESTORE REG 14     @D14BDBF 33720000
          AGO   .W7C5                                               4-0 33760000
.W7C2     L     IJCGE&CG9,12(IJCGD&CG9)      RESTORE REG 14    @DY38452 33800000
          AGO   .W7C5                                               4-0 33840000
.W7C3     L     IJCGE&CG9,IJCRD&CG9+4       RESTORE REG 14     @D14BDBF 33880000
.W7C5     BR    IJCGE&CG9                   RETURN TO USER     @D14BDBF 33920000
.W7C      ANOP                                                      4-0 33960000
          SPACE 1                                              @D14BDBF 34000000
IJCRW&CG9 EQU   *                                                       34040000
          AIF   ('&CG1' EQ '3881').W7                          @DL28701 34080000
         AIF   (T'&RDONLY NE 'O').BK10                              3-3 34120000
          AIF   ('&WORKA' EQ '').W7                                 3-3 34160000
         SPACE 1                                               @D14BDBF 34200000
*        MOVE IOAREA TO WORKA          REG.0 = ADDR OF WORKA   @D14BDBF 34240000
         STM   IJCG0&CG9,IJCG3&CG9,IJCRD&CG9+16  SAVE REG 0-3  @DA35715 34280000
         L     IJCG2&CG9,IJCRI2        GET ADDR OF IOAREA      @DA34640 34320000
         LH    IJCG1&CG9,IJCRCT        GET BLOCKSIZE           @D14BDBF 34360000
         LR    IJCG3&CG9,IJCG1&CG9     GET BLOCKSIZE           @D14BDBF 34400000
         MVCL  IJCG0&CG9,IJCG2&CG9     MOVE IOAREA TO WORKA    @D14BDBF 34440000
         LM    IJCG0&CG9,IJCG3&CG9,IJCRD&CG9+16  RESET REG 0-3 @DA35715 34480000
         SPACE 1                                               @D14BDBF 34520000
         L     IJCGE&CG9,IJCRD&CG9+4   RESTORE REG 14          @D14BDBF 34560000
          AGO   .W11                                                3-3 34600000
.BK10    ANOP                                                  @D14BDBF 34640000
         AIF   ('&WORKA' EQ '').W7                             @DY38452 34680000
         SPACE 1                                               @D14BDBF 34720000
*        MOVE IOAREA TO WORKA         REG.0 = ADDR OF WORKA    @D14BDBF 34760000
         STM   IJCG0&CG9,IJCG3&CG9,20(IJCGD&CG9) SAVE REG 0-3  @DA35715 34800000
         L     IJCG2&CG9,IJCRI2        GET ADDR OF IOAREA      @DY38452 34840000
         LH    IJCG1&CG9,IJCRCT        GET BLOCKSIZE           @D14BDBF 34880000
         LR    IJCG3&CG9,IJCG1&CG9     GET BLOCKSIZE           @D14BDBF 34920000
         MVCL  IJCG0&CG9,IJCG2&CG9     MOVE IOAREA TO WORKA    @D14BDBF 34960000
         LM    IJCG0&CG9,IJCG3&CG9,20(IJCGD&CG9) RESET REG 0-3 @DA35715 35000000
         SPACE 1                                               @D14BDBF 35040000
         L     IJCGE&CG9,12(IJCGD&CG9)  RESET REG14            @DY38452 35080000
         AGO   .W11                                                 3-3 35120000
.W7      AIF   (T'&RDONLY NE 'O').BK11                              3-3 35160000
          AIF   ('&CG1' EQ '3881').W7APK                       @DL28701 35200000
         AIF   ('&WORKA' NE '').W62                                 3-3 35240000
.W7APK    L     IJCGE&CG9,IJCRD&CG9    RESTORE REG 14          @D14BDBF 35280000
         AGO   .W11                                                 3-3 35320000
.W62     L     IJCGE&CG9,IJCRD&CG9+4   RESTORE REG 14          @D14BDBF 35360000
         AGO   .W11                                                 3-3 35400000
.BK11    L     IJCGE&CG9,12(IJCGD&CG9)  RESTORE REG 14         @DY38452 35440000
.W11      AIF   ('&IOAREA2' EQ '').W8                               3-3 35480000
          AIF   ('&AL1' LE 'E').W8                                  4-0 35520000
          SVC   IJCR1&CG9              EXCP                             35560000
.W8       BR    IJCGE&CG9              BACK TO USER            @D14BDBF 35600000
          SPACE 1                                              @D14BDBF 35640000
IJCEF&CG9 DC    C'/* '                                         @DA12248 35680000
IJCRL&CG9 DC   XL4'0C001022'      COLUMN BINARY                     4-0 35720000
         AIF   (T'&RDONLY NE 'O').R19                               3-3 35760000
          AIF   ('&CG1' EQ '3881').R16PK                       @DL28701 35800000
          AIF   ('&WORKA' NE '').R16                                    35840000
.R16PK    ANOP                                                 @DL28701 35880000
IJCRD&CG9 DC    1F'0'                  SAVE AREA                        35920000
          AGO   .R19A                                          @DA23853 35960000
.R16      ANOP                                                          36000000
IJCRD&CG9 DC    8F'0'                  SAVE AREA FOR REG12-03  @D14BDBF 36040000
          AGO   .R19A                                          @DA23853 36080000
.R19      DS   0H                 ALIGNMENT                    @DA23853 36120000
.R19A     AIF   ('&CNTL' NE 'C').R17                           @DA23853 36160000
         AIF   ('&CG1' EQ '2596').R18                               4-0 36200000
          AIF   ('&CG1' EQ '1442').R18                                  36240000
          AIF   ('&CG1' EQ '2501').R17                                  36280000
IJCRU&CG9 DC    H'34'                                                   36320000
         SPACE 1                                               @D14BDBF 36360000
IJCRC&CG9 AH   0,IJCRU&CG9                                          3-3 36400000
          AGO   .R41                                                    36440000
.R18      ANOP                                                          36480000
IJCRU&CG9 DC    H'1'                                                    36520000
         SPACE 1                                               @D14BDBF 36560000
IJCRC&CG9 AH   0,IJCRU&CG9                                          3-3 36600000
          STC   0,IJCRCO               STORE CON. CHR. IN CONCMD        36640000
          BR    IJCGE&CG9              BACK TO USER            @D14BDBF 36680000
          AGO   .R17                                                    36720000
.R41      TM    IJCRC1,IJCR4&CG9       WAIT CHANNEL END                 36760000
          BO    *+6                                                     36800000
          SVC   7                                                       36840000
          AIF   ('&AL1' LE 'E' OR '&AL1' GE '6').P41A               4-0 36880000
          STC   0,IJCRCC               PUT CONTROL COMM. IN  CCW        36920000
          AGO   .P41B                                               4-0 36960000
.P41A     ANOP                                                 @DA09627 37000000
          AIF   (T'&RDONLY EQ 'O').P41C                        @DA09627 37040000
          STC   IJCMJ&CG9,0(IJCGD&CG9)      STORE CONTR CHAR   @D14BDBF 37080000
          NI    IJCRCO,IJC08&CG9            AND ALTER IT       @DA09627 37120000
          OC    IJCRCO(IJCRX&CG9),0(IJCGD&CG9)  IN CONTR CMD   @D14BDBF 37160000
          AGO   .P41D                                          @DA09627 37200000
.P41C     STC   IJCMJ&CG9,IJCRJ&CG9         STORE CONTR CHAR   @DA09627 37240000
          NI    IJCRCO,IJC08&CG9            AND ALTER IT       @DA09627 37280000
          OC    IJCRCO(IJCRX&CG9),IJCRJ&CG9  IN CONTR CMD      @DA09627 37320000
.P41D     MVC   IJCRCC(IJCRX&CG9),IJCRCO    THEN IN CCW        @DA09627 37360000
.P41B     ANOP                                                      4-0 37400000
IJCRY&CG9 SVC  IJCR1&CG9                                                37440000
          TM    IJCRC1,IJCR4&CG9       WAIT CHANNEL END                 37480000
          BO    *+6                                                     37520000
          SVC   7                                                       37560000
          BR    IJCGE&CG9              BACK TO USER            @D14BDBF 37600000
.R17      ANOP                                                          37640000
          AIF   ('&CG1' NE '3505' AND '&CG1' NE '3525').R27V        4-0 37680000
IJCM7&CG9 DS    0H                     HALFWORD ALIGNMENT      @DA23853 37720000
          TM    IJCRM2,IJCBR&CG9       TEST FOR BR INSTRUCTION      4-0 37760000
          BO    IJCRM2                 YES, EXEC BR INST.           4-0 37800000
          AIF   (T'&RDONLY NE 'O').R27B                             4-0 37840000
          STM   IJCGF&CG9,IJCG1&CG9,IJCRJ&CG9    SAVE REGS 15-1@D14BDBF 37880000
          AGO   .R27C                                               4-0 37920000
.R27B     STM   IJCGF&CG9,IJCG1&CG9,16(IJCGD&CG9) SAVE REG15-1 @DY38452 37960000
.R27C     L     IJCGE&CG9,IJCRM2       LOAD USER ERROR ADDRESS @D14BDBF 38000000
          L     IJCG1&CG9,IJCRCC       I/O ADDR TO REG 1       @D14BDBF 38040000
          LA    IJCG1&CG9,0(IJCG1&CG9) CLEAR HIGH ORDER BYTE   @D14BDBF 38080000
          CNOP  0,4                    FULL WORD                    4-0 38120000
          NOPR  1                        ALIGNMENT                  4-0 38160000
          BALR  IJCGE&CG9,IJCGE&CG9         EXIT TO USER       @D14BDBF 38200000
          AIF   (T'&RDONLY NE 'O').R27E                             4-0 38240000
          LM    IJCGF&CG9,IJCG1&CG9,12(IJCGE&CG9)  RESTORE REGS@D14BDBF 38280000
          AIF   ('&WORKA' NE '').R27F                               4-0 38320000
          L     IJCGE&CG9,IJCRD&CG9         RESTORE REG 14     @D14BDBF 38360000
          AGO   .R27G                                               4-0 38400000
.R27F     L     IJCGE&CG9,IJCRD&CG9+4       RESTORE REG 14     @D14BDBF 38440000
          AGO   .R27G                                               4-0 38480000
.R27E     LM    IJCGE&CG9,IJCG1&CG9,12(IJCGD&CG9) REST.USERREGS@DY38452 38520000
.R27G     B     IJCRV&CG9              CONTINUE                     4-0 38560000
.R27V     ANOP                                                      4-0 38600000
          AIF   ('&IOAREA2' EQ 'O' OR '&CG1' NE '2501').ELE    @D33FDVS 38640000
IJCA9&CG9 TM    IJCRSW,IJCR5&CG9       TEST IF FIRST TIME      @D33FDVS 38680000
          BO    IJCA2&CG9              BR IF NOT 1ST TIME      @D33FDVS 38720000
          NI    IJCR2C,X'7F'           FIRST REQUEST NOT FAST  @DA12186 38760000
          SVC   IJCR1&CG9              EXCP                    @D33FDVS 38800000
.FRDA     AIF   (T'&RDONLY NE 'O').FRDF                        @D33FDVS 38840000
          OI    IJCA1&CG9,X'80'        SET CCB SWITCH ON       @D33FDVS 38880000
          AGO   .FRDG                                          @D33FDVS 38920000
.FRDF     OI    72(IJCGD&CG9),X'80'    SET CCB SWITCH ON       @D14BDBF 38960000
.FRDG     AH    1,IJCA4&CG9            POINT TO 2ND CCB        @D33FDVS 39000000
          SVC   IJCR1&CG9              EXCP                    @D33FDVS 39040000
          AIF   (T'&RDONLY NE 'O').FRDH                        @D33FDVS 39080000
IJCA2&CG9 TM    IJCA1&CG9,X'80'        TEST CCB SWITCH         @D33FDVS 39120000
          AGO   .FRDI                                          @D33FDVS 39160000
.FRDH     ANOP                                                 @D33FDVS 39200000
IJCA2&CG9 TM    72(IJCGD&CG9),X'80'    TEST CCB SWITCH         @D14BDBF 39240000
.FRDI     BO    IJCA3&CG9              BR IF SWITCH ON         @D33FDVS 39280000
          SVC   IJCR1&CG9              EXCP                    @D33FDVS 39320000
          AIF   (T'&RDONLY NE 'O').FRDJ                        @D33FDVS 39360000
          OI    IJCA1&CG9,X'80'        SET CCB SWITCH ON       @D33FDVS 39400000
          AGO   .FRDK                                          @D33FDVS 39440000
.FRDJ     OI    72(IJCGD&CG9),X'80'    SET CCB SWITCH ON       @D14BDBF 39480000
.FRDK     AH    1,IJCA4&CG9            POINT TO 2ND CCB        @D33FDVS 39520000
          B     IJCAB&CG9              GO TO WAIT              @D33FDVS 39560000
IJCA3&CG9 TM    IJCRSW,IJCR5&CG9       TEST IF FIRST TIME      @D33FDVS 39600000
          BO    IJCA5&CG9              BR IF NOT 1ST  TIME     @D33FDVS 39640000
          OI    IJCRSW,IJCR5&CG9       SET 1ST TIME SWITCH     @D33FDVS 39680000
          SH    1,IJCA4&CG9            POINT TO FIRST CCB      @D33FDVS 39720000
          OI    IJCRSW,IJCR5&CG9       SET 1ST TIME SWITCH     @D33FDVS 39760000
          B     IJCAD&CG9              CONTINUE                @D33FDVS 39800000
IJCA6&CG9 SH    1,IJCA4&CG9            POINT TO 1ST CCB        @D33FDVS 39840000
          AIF   (T'&RDONLY NE 'O').FRDL                        @D33FDVS 39880000
IJCAD&CG9 XI    IJCA1&CG9,X'80'        SET CCB SW OFF          @D33FDVS 39920000
          AGO   .FRDM                                          @D33FDVS 39960000
.FRDL     ANOP                                                 @D33FDVS 40000000
IJCAD&CG9 XI    72(IJCGD&CG9),X'80'    SET CCB SW OFF          @D14BDBF 40040000
.FRDM     B     IJCAB&CG9              GO TO WAIT              @D33FDVS 40080000
IJCA5&CG9 AH    1,IJCA4&CG9            POINT TO 2ND CCB        @D33FDVS 40120000
          SVC   IJCR1&CG9              EXCP                    @D33FDVS 40160000
          B     IJCA6&CG9                                      @D33FDVS 40200000
IJCAB&CG9 TM    IJCRC1,IJCR4&CG9       WAIT CHANNEL END        @D33FDVS 40240000
          BO    *+6                                            @D33FDVS 40280000
          SVC   7                                              @D33FDVS 40320000
          OI    IJCR2C,X'80'           FAST REQ FROM NOW       @DA12186 40360000
         AIF   (T'&RDONLY NE 'O').EL1                          @D33FDVS 40400000
         AIF   ('&WORKA' NE '').EL3                            @D33FDVS 40440000
          ST    IJCGE&CG9,IJCRD&CG9    STORE REG 14            @D14BDBF 40480000
          AGO   .EL4                                           @D33FDVS 40520000
.EL1     ANOP                                                  @D33FDVS 40560000
         ST    IJCGE&CG9,12(IJCGD&CG9)  SAVE REG 14            @DY38452 40600000
         AGO   .EL4                                            @D33FDVS 40640000
.EL3      ANOP                                                 @D33FDVS 40680000
         ST    IJCGE&CG9,IJCRD&CG9+4   STORE REG 14            @D14BDBF 40720000
.EL4      L     IJCGE&CG9,IJCRCC       L R14 WITH IOAREA1 ADDR @D14BDBF 40760000
         AIF ('&WORKA' NE '').EL5                              @D33FDVS 40800000
          EX    0,IJCRLP               LOAD USER POINTER REG   @D33FDVS 40840000
.EL5     TM    IJCRST,IJCRX&CG9  TEST FOR U.E. IN CCB CSW STAT @D33FDVS 40880000
         BZ    IJCAC&CG9                                       @D33FDVS 40920000
         TM    IJCRC1,IJCR5&CG9  /* OR /& IN SYSIPT, SYSRDR?   @D33FDVS 40960000
         BO    IJCAA&CG9                                       @D33FDVS 41000000
          AIF   (T'&RDONLY NE 'O').EL6                         @D33FDVS 41040000
         AIF   (T'&WORKA NE 'O').EL7                           @D33FDVS 41080000
          L     IJCGE&CG9,IJCRD&CG9    RESTORE REGISTER 14     @D14BDBF 41120000
         AGO   .EL8                                            @D33FDVS 41160000
.EL6     ANOP                                                  @D33FDVS 41200000
         L     IJCGE&CG9,12(IJCGD&CG9)  RESTORE REGISTER 14    @DY38452 41240000
         AGO   .EL8                                            @D33FDVS 41280000
.EL7     ANOP                                                  @D33FDVS 41320000
         L     IJCGE&CG9,IJCRD&CG9+4   RESTORE REGISTER 14     @D14BDBF 41360000
.EL8     ANOP                                                  @D33FDVS 41400000
          AIF   (T'&RDONLY NE 'O').FRDN                        @D33FDVS 41440000
         TM    IJCA1&CG9,X'80'         TEST CCB SWITCH         @D33FDVS 41480000
         AGO   .FRDO                                           @D33FDVS 41520000
.FRDN    TM    72(IJCGD&CG9),X'80'     TEST CCB SWITCH         @D14BDBF 41560000
.FRDO    BNO   IJCA2&CG9               GO TO TEST CCB SW       @D33FDVS 41600000
         SH    1,IJCA4&CG9             POINT TO FIRST CCB      @D33FDVS 41640000
         B     IJCA3&CG9               READ FURTHER            @D33FDVS 41680000
.FRDU     ANOP                                                 @D33FDVS 41720000
IJCAA&CG9 EQU  *                                               @D33FDVS 41760000
          NI    IJCRSW,X'BF'           TURN OFF 1ST TIME SW    @D33FDVS 41800000
          AIF   (T'&RDONLY NE 'O').FRDP                        @D33FDVS 41840000
          TM    IJCA1&CG9,X'80'        TEST CCB SWITCH         @D33FDVS 41880000
          AGO   .FRDQ                                          @D33FDVS 41920000
.FRDP     TM    72(IJCGD&CG9),X'80'    TEST CCB SWITCH         @D14BDBF 41960000
.FRDQ     BNO   IJCA7&CG9              BR IF NOT ON            @D33FDVS 42000000
          SH    1,IJCA4&CG9            POINT TO FIRST CCB      @D33FDVS 42040000
          NI    IJCRSW,X'BF'           SET FIRST TIME SW OFF   @D33FDVS 42080000
          B     IJCA8&CG9              CONTINUE                @D33FDVS 42120000
IJCA7&CG9 AH    1,IJCA4&CG9            POINT TO SECOND CCB     @D33FDVS 42160000
          NI    IJCRSW,X'BF'           SET FIRST TIME SW OFF   @D33FDVS 42200000
IJCA8&CG9 L     IJCGE&CG9,IJCREF       L R14 WITH EOF RTN ADDR @D14BDBF 42240000
          BR    IJCGE&CG9              GO TO EOF ROUTINE.      @D14BDBF 42280000
IJCAC&CG9 EQU   *                                              @D33FDVS 42320000
         AIF   (T'&RDONLY NE 'O').EL9                          @D33FDVS 42360000
          AIF   ('&WORKA' EQ '').ELA                           @D33FDVS 42400000
         SPACE 1                                               @D14BDBF 42440000
*        MOVE IOAREA TO WORKA         REG.0 = ADDR OF WORKA    @D14BDBF 42480000
         STM   IJCG0&CG9,IJCG3&CG9,IJCRD&CG9+16  SAVE REG 0-3  @DA35715 42520000
         L     IJCG2&CG9,IJCRCC        GET ADDR OF IOAREA      @D14BDBF 42560000
         LH    IJCG1&CG9,IJCRCT        GET BLOCKSIZE           @D14BDBF 42600000
         LR    IJCG3&CG9,IJCG1&CG9     GET BLOCKSIZE           @D14BDBF 42640000
         MVCL  IJCG0&CG9,IJCG2&CG9     MOVE IOAREA TO WORKA    @D14BDBF 42680000
         LM    IJCG0&CG9,IJCG3&CG9,IJCRD&CG9+16  RESET REG 0-3 @DA35715 42720000
         SPACE 1                                               @D14BDBF 42760000
          L     IJCGE&CG9,IJCRD&CG9+4  RESET REG14             @DA33810 42800000
          AGO   .ELB                                           @D33FDVS 42840000
.EL9     ANOP                                                  @D14BDBF 42880000
         SPACE 1                                               @D14BDBF 42920000
*        MOVE IOAREA TO WORKA         REG.0 = ADDR OF WORKA    @D14BDBF 42960000
         STM   IJCG0&CG9,IJCG3&CG9,20(IJCGD&CG9) SAVE REG 0-3  @DA35715 43000000
         L     IJCG2&CG9,IJCRCC        GET ADDR OF IOAREA      @D14BDBF 43040000
         LH    IJCG1&CG9,IJCRCT        GET BLOCKSIZE           @D14BDBF 43080000
         LR    IJCG3&CG9,IJCG1&CG9     GET BLOCKSIZE           @D14BDBF 43120000
         MVCL  IJCG0&CG9,IJCG2&CG9     MOVE IOAREA TO WORKA    @D14BDBF 43160000
         LM    IJCG0&CG9,IJCG3&CG9,20(IJCGD&CG9) RESET REG 0-3 @DA35715 43200000
         SPACE 1                                               @D14BDBF 43240000
         L     IJCGE&CG9,12(IJCGD&CG9)  RESET REG 14           @DY38452 43280000
         AGO   .ELB                                            @D33FDVS 43320000
.ELA     AIF   (T'&RDONLY NE 'O').ELD                          @D33FDVS 43360000
         AIF   ('&WORKA' NE '').ELC                            @D33FDVS 43400000
          L     IJCGE&CG9,IJCRD&CG9    RESTORE REG 14          @D14BDBF 43440000
         AGO   .ELB                                            @D33FDVS 43480000
.ELC     L     IJCGE&CG9,IJCRD&CG9+4   RESTORE REG 14          @D14BDBF 43520000
         AGO   .ELB                                            @D33FDVS 43560000
.ELD     L     IJCGE&CG9,12(IJCGD&CG9)  RESTORE REG 14         @DY38452 43600000
.ELB      BR    IJCGE&CG9              BACK TO USER            @D14BDBF 43640000
         SPACE 1                                               @D14BDBF 43680000
IJCA4&CG9 DC    H'56'             LENGTH OF DTFCD              @D33FDVS 43720000
          AIF   (T'&RDONLY NE 'O').ELE                         @D33FDVS 43760000
IJCA1&CG9 DC    AL1(0)            CCB PIVOT BYTE               @D33FDVS 43800000
.ELE      ANOP                                                 @D33FDVS 43840000
IJCR0&CG9 EQU   50                     ABNORMAL EOJ                     43880000
IJCR1&CG9 EQU   0                      SYSXCP                           43920000
IJCG0&CG9 EQU   0                      REG 0                   @D14BDBF 43960000
IJCG1&CG9 EQU   1                      REG 1                   @D14BDBF 44000000
IJCG2&CG9 EQU   2                      REG 2                   @D14BDBF 44040000
IJCG3&CG9 EQU   3                      REG 3                   @D14BDBF 44080000
IJCGC&CG9 EQU   12                     REG12                   @D14BDBF 44120000
IJCGD&CG9 EQU   13                     REG13                   @D14BDBF 44160000
IJCGE&CG9 EQU   14                     REG14                   @D14BDBF 44200000
IJCGF&CG9 EQU   15                     REG15                   @D14BDBF 44240000
IJCR4&CG9 EQU   X'80'                                                   44280000
IJCR5&CG9 EQU   X'40'                                                   44320000
IJCR6&CG9 EQU   X'20'                                                   44360000
IJCR7&CG9 EQU  X'23'                                                3-6 44400000
IJCR8&CG9 EQU   X'04'                                                   44440000
IJCLQ&CG9 EQU  X'C2'                                                    44480000
IJCRX&CG9 EQU   X'01'                                                   44520000
IJCBR&CG9 EQU   X'47'                  BR OP CODE                   4-0 44560000
IJC0A&CG9 EQU   X'0A'                  SVC OP CODE                  4-0 44600000
IJCRK&CG9 EQU   X'10'                  GET-PUT TEST                 4-0 44640000
IJCRM&CG9 EQU   7                      WAIT                         4-0 44680000
IJCMM&CG9 EQU   X'E2'                  READ OR READ WITH DMII       4-0 44720000
IJCMJ&CG9 EQU   0                      EXCP                         4-0 44760000
IJC08&CG9 EQU   X'08'                       SET MODE                4-0 44800000
IJCX4&CG9 EQU   X'48'                        CODE SWITCH            4-0 44840000
          AIF   ('&AL1' GT 'E' AND '&AL1' LT '6').R17M              4-0 44880000
          AIF   (T'&RDONLY NE 'O').R17M                        @DA09627 44920000
IJCRJ&CG9 DC    3F'0'                  ASOCFLE ADDRESS              4-0 44960000
.R17M     AIF   (T'&SEPASMB NE 'O').R17A                            4-0 45000000
&SYSECT  CSECT                                                          45040000
.R17A    MEXIT                                                          45080000
.CBMOD   ANOP                                                           45120000
&AL1     SETC  '1'                                                  4-0 45160000
       AIF ('&CG1' EQ '1442').EC5                                       45200000
&AL1     SETC  '2'                                                  4-0 45240000
       AIF ('&CG1' EQ '2520').EC5                                       45280000
&AL1     SETC  '0'                                                  4-0 45320000
       AIF ('&CG1' EQ '2540').EC5                                       45360000
         AIF   ('&CG1' NE '2596').R17AA                             4-0 45400000
          MNOTE 9,'COMBINED FILE INVALID FOR 2596.  MACRO NOT GENERATEDX45440000
               .'                                                   4-0 45480000
         MEXIT                                                      4-0 45520000
.R17AA   ANOP                                                       4-0 45560000
          MNOTE 0,'IMPROPER DEVICE. ''2540'' ASSUMED'                   45600000
&CG1  SETC  '2540'                                                      45640000
.EC5      AIF   (T'&FUNC EQ 'O').EC5C                               4-0 45680000
          MNOTE 0,'FUNC PARAMETER INVALID. IGNORED'                 4-0 45720000
.EC5C     AIF   (T'&RDONLY EQ 'O').EC5AA                            4-0 45760000
&NAM     SETC  'IJCF&CNTL.B&WKIO&AL1'                               3-3 45800000
         AGO   .EC5AB                                               3-3 45840000
.EC5AA   ANOP                                                       3-3 45880000
&NAM SETC 'IJCF&CNTL.C&WKIO&AL1'                                    3-3 45920000
.EC5AB   AIF   (T'&LABEL EQ 'O').EEE                                3-3 45960000
&NAM      SETC  '&LABEL'                                                46000000
.EEE      AIF   (T'&SEPASMB EQ 'O').FFF                                 46040000
          PUNCH ' CATALOG &NAM..OBJ                     REPLACE=YES'    46080000
.FFF      AIF   (T'&CTLCHR EQ 'O').R17B                                 46120000
          MNOTE 0,'CTLCHR INVALID PARAMETER. IGNORED'                   46160000
.R17B     AIF   (T'&CRDERR EQ 'O').R17C                                 46200000
          MNOTE 0,'CRDERR INVALID PARAMETER. IGNORED'                   46240000
.R17C     AIF  ('&RECFM2' EQ '' OR '&RECFM2' EQ 'FIXUNB').R17D @D14BDBF 46280000
          MNOTE 0,'IMPROPER RECFORM. ''FIXUNB'' ASSUMED'                46320000
&RECFM2   SETC  'FIXUNB'                                       @D14BDBF 46360000
.R17D     AIF (T'&IOAREA2 EQ 'O').R17E                                  46400000
          MNOTE 0,'IOAREA2 NOT NEEDED. PARAMETER IGNORED'               46440000
.R17E     ANOP                                                          46480000
IJCRP&CG9 DSECT                                                         46520000
IJCC0&CG9  DS  CL2                      RES.COUNT                       46560000
IJCC1&CG9  DS  CL2                      COMM.BYTES                      46600000
IJCC2&CG9  DS  CL2                      CSW STATUS BYTES                46640000
IJCC3&CG9  DS  CL2                      LOGICAL UNIT ADDRESS            46680000
           DS  CL1                      NOT USED                        46720000
IJCC4&CG9  DS  CL3                      CCW ADDRESS                     46760000
IJCC5&CG9  DS  CL1                      STATUS BYTE                     46800000
IJCC6&CG9  DS  CL3                      CSW-CCW ADDRESS                 46840000
           DS  CL4                      ADDRESS OF LOGICAL MODULE       46880000
IJCC7&CG9  DS  CL1                                                      46920000
IJCCD&CG9  DS  CL1                      C.CODE                          46960000
IJCCE&CG9  DS  CL1                      C.CODE                          47000000
IJCCF&CG9  DS  CL1                      C.CODE                          47040000
IJCCH&CG9  DS  CL1                      OP.CODE                         47080000
IJCCI&CG9  DS  CL3                      ADD.OF DATA                     47120000
IJCCJ&CG9  DS  CL1                      FLAGS                           47160000
           DS  CL1                      NOT USED                        47200000
IJCCK&CG9  DS  CL2                      BLKSIZE                         47240000
IJCC8&CG9  DS  1F                       ADD.OF DATA IN IOAREA1          47280000
IJCC9&CG9  DS  1F                       ADD.OF DATA IN IOAREA2          47320000
IJCCA&CG9  DS  CL2                      BLKSIZE FOR INPUT               47360000
IJCCB&CG9  DS  CL2                      BLKSIZE FOR OUTPUT              47400000
IJCN1&CG9   DS  CL6                                                     47440000
IJCN2&CG9   DS  CL6                                                     47480000
IJCCC&CG9  DS  CL4                      ADD.OF EOF ROUTINE              47520000
IJCWA&CG9  DS  2F                                                       47560000
IJCN3&CG9  DS CL6                                                       47600000
IJCN4&CG9  DS CL4                                                       47640000
IJCZ8&CG9  DS  CL2                                                      47680000
IJCZ7&CG9  DS  CL4                                                      47720000
&NAM      CSECT                                                         47760000
          AIF   (T'&LABEL NE 'O').XUXU                                  47800000
          AIF   ('&CNTL' NE 'C').XUXU                                   47840000
&ENT      SETC  '&NAM'(1,4)'Z'.'&NAM'(6,3)                              47880000
          ENTRY &ENT                                                    47920000
&ENT      EQU   *                                                       47960000
.XUXU USING IJCC0&CG9,1                                                 48000000
         USING *,15                                                     48040000
         AIF   ('&CONTROL' EQ '').CB60                                  48080000
          B    IJCMB&CG9                                                48120000
         AGO   .CB61                                                    48160000
.CB60    ANOP                                                           48200000
       SVC  IJCZ3&CG9    CONTROL ERROR                                  48240000
       DC  H'0'                                                         48280000
.CB61   SVC  IJCZ3&CG9                                                  48320000
       DC  H'0'                                                         48360000
          B    IJCMC&CG9                BRANCH TO GET                   48400000
          B    IJCMD&CG9                BRANCH TO PUT                   48440000
          DC    CL8'&NAM'              MODULE NAME                      48480000
        DC   C'C440'  /*@@LVLID*/  CHANGE LEVEL                @D41TDKY 48520000
        DC   CL43'5686-007 (C) COPYRIGHT IBM CORP. 1981,1988'  @D41TDKY 48560000
        DC   CL37'LICENSED MATERIALS-PROPERTY OF IBM  '        @D41TDKY 48600000
        DC   CL8'DY38452 '           LAST APAR FIXED           @DY38452 48640000
      AIF ('&CG1' EQ '1442').CB50                                       48680000
IJCMC&CG9  CLI IJCCH&CG9,X'C2'                                          48720000
      BE  IJCZ4&CG9                                                     48760000
IJCZ5&CG9  MVC  IJCCI&CG9.(3),IJCC8&CG9+1                               48800000
       AGO  .CB51                                                       48840000
.CB50    ANOP                                                           48880000
IJCMC&CG9 MVC  IJCCI&CG9.(3),IJCC8&CG9+1                                48920000
.CB51  ANOP                                                             48960000
          MVC  IJCCK&CG9,IJCCA&CG9      BLKSIZE TO CCW                  49000000
          MVC  IJCCH&CG9,IJCCD&CG9           CCC TO CCW                 49040000
          SVC  0                             BEGIN TO READ              49080000
       TM  IJCC1&CG9,X'80'                                              49120000
       BO  *+6                                                          49160000
       SVC 7                                                            49200000
          ST   IJCGE&CG9,IJCWA&CG9+4         SAVE REGISTER 14  #        49240000
          L    IJCGE&CG9,IJCC8&CG9                             #        49280000
          CLC  IJCM&CG9,0(IJCGE&CG9)         TEST IF LAST CARD #        49320000
          BNE  IJCME&CG9                                                49360000
          L    IJCGE&CG9,IJCCC&CG9           LOAD EOF ROUT ADDR#        49400000
       AIF ('&CG1' EQ '1442').CB41                                      49440000
         ST IJCGD&CG9,IJCWA&CG9                                @D14BDBF 49480000
         L  IJCGD&CG9,IJCC9&CG9                                @D14BDBF 49520000
         ST    IJCGD&CG9,IJCCH&CG9                             @D14BDBF 49560000
         EX  0,IJCN4&CG9                                                49600000
         EX 0,IJCN3&CG9                                                 49640000
         L  IJCGD&CG9,IJCWA&CG9                                @D14BDBF 49680000
         NI    IJCCF&CG9,X'F7'         PUNCH-FEED AND STACKER SEL   3-4 49720000
        AIF ('&WORKA' NE '').CB45                                       49760000
       B  IJCMD&CG9                                                     49800000
    AGO .CB56                                                           49840000
.CB45  B  IJCMR&CG9                                                     49880000
.CB56  ANOP                                                             49920000
IJCZ4&CG9  MVC  IJCWA&CG9.(8),IJCCH&CG9                                 49960000
         MVC   IJCCH&CG9+0(1),IJCCF&CG9                            3-10 50000000
       MVI  IJCCK&CG9+1,X'02'                                           50040000
       MVC  IJCCI&CG9.(3),IJCZ7&CG9+1                                   50080000
       SVC  0                                                           50120000
       TM  IJCC1&CG9,X'80'                                              50160000
       BO  *+6                                                          50200000
       SVC 7                                                            50240000
       MVC  IJCCH&CG9.(8),IJCWA&CG9                                     50280000
       B IJCZ5&CG9                                                      50320000
      AGO  .CB46                                                        50360000
.CB41  ANOP                                                             50400000
          BR   IJCGE&CG9                     GO TO EOF ROUTINE #        50440000
.CB46    AIF   ('&WORKA' EQ '').CB26                                    50480000
IJCME&CG9 ST IJCGD&CG9,IJCWA&CG9                 SAVE REGISTERS@D14BDBF 50520000
          LR   IJCGD&CG9,IJCG0&CG9               LOAD WORKA ADD@D14BDBF 50560000
         EX  0,IJCN1&CG9                                                50600000
         LM  IJCGD&CG9,IJCGE&CG9,IJCWA&CG9       RESTORE REGS  @D14BDBF 50640000
         BR  IJCGE&CG9                           RETURN TO USR @D14BDBF 50680000
IJCMD&CG9  STM  IJCGD&CG9,IJCGE&CG9,IJCWA&CG9    SAVE REGISTERS@D14BDBF 50720000
          LR   IJCGD&CG9,IJCG0&CG9               LOAD WORKA ADD@D14BDBF 50760000
          L    IJCGE&CG9,IJCC9&CG9               LOAD OUAREA AD@D14BDBF 50800000
          MVC  IJCCI&CG9.(3),IJCC9&CG9+1                                50840000
          EX   0,IJCN2&CG9                        WORKA TO IOAREA       50880000
          LM   IJCGD&CG9,IJCGE&CG9,IJCWA&CG9      RESTORE REG13@D14BDBF 50920000
IJCMR&CG9 MVC  IJCCH&CG9,IJCCF&CG9     MOVE COMMAND CODE TO CCW     3-4 50960000
          AGO  .CB29                                                    51000000
.CB26     ANOP                                                          51040000
IJCME&CG9 L  IJCGE&CG9,IJCWA&CG9+4                             @D14BDBF 51080000
          BR   IJCGE&CG9                                       @D14BDBF 51120000
IJCMD&CG9 MVC  IJCCH&CG9,IJCCF&CG9           CCC TO CCW                 51160000
          MVC  IJCCI&CG9.(3),IJCC9&CG9+1                                51200000
.CB29    ANOP                                                           51240000
          MVC  IJCCK&CG9,IJCCB&CG9           OUBLKSZ TO CCW             51280000
          SVC  0                             BEGIN TO PUNCH             51320000
       TM  IJCC1&CG9,X'80'                                              51360000
       BO  *+6                                                          51400000
       SVC 7                                                            51440000
          MVC  IJCCF&CG9,IJCCE&CG9                                      51480000
          BR   IJCGE&CG9                     RETURN TO USER    @D14BDBF 51520000
IJCM&CG9  DC   C'/* '                                          @DA12248 51560000
       AIF  ('&CONTROL' EQ '').CB66                                     51600000
       AIF ('&CG1' NE '1442').CB65                                      51640000
IJCMB&CG9 STC   0,IJCCF&CG9                                             51680000
          BR   IJCGE&CG9                     RETURN TO USER    @D14BDBF 51720000
        AGO .CB66                                                       51760000
.CB65     ANOP                                                          51800000
IJCMB&CG9  AH  0,IJCZ6&CG9                                              51840000
          STC  0,IJCCF&CG9                                              51880000
          BR   IJCGE&CG9                     RETURN TO USER    @D14BDBF 51920000
IJCZ6&CG9 DC    H'8'                                                    51960000
.CB66     ANOP                                                          52000000
IJCG0&CG9 EQU  0                             REGISTER  0       @D14BDBF 52040000
IJCGD&CG9 EQU  13                            REGISTER 13       @D14BDBF 52080000
IJCGE&CG9 EQU  14                            REGISTER 14       @D14BDBF 52120000
IJCZ3&CG9 EQU  50                                                       52160000
          AIF   (T'&SEPASMB NE 'O').CB66A                               52200000
&SYSECT  CSECT                                                          52240000
.CB66A   MEXIT                                                       JJ 52280000
.*                                                                   JJ 52320000
.*                                                                   JJ 52360000
.MFCX    ANOP                           MFCM/MFCU DEVICES            JJ 52400000
.*                                                                   JJ 52440000
&IJCMFCX SETA  &IJCMFCX+1                                            JJ 52480000
&X       SETC  '&IJCMFCX'                                            JJ 52520000
.*                                                                   JJ 52560000
.*                                                                   JJ 52600000
.* SYNTAX CHECK AND GENERATION OF MODULE NAME. THE MODULE NAME STARTSJJ 52640000
.* WITH THE 3 LETTERS IJC. THE REST CONSISTS OF FOLLOWING VARIABLES: JJ 52680000
.*                                                                   JJ 52720000
.* 1) &RECF = F     RECFORM=FIXUNB                                   JJ 52760000
.*          = U            =UNDEF                                    JJ 52800000
.*          = V            =VARUNB                                   JJ 52840000
.* 2) &CNTL = A     CTLCHR=ASA                                       JJ 52880000
.*          = Y           =YES                                       JJ 52920000
.*          = C     CONTROL=YES                                      JJ 52960000
.*          = Z     CONTROL AND CTLCHR OMITTED                       JJ 53000000
.* 3) &FTYP = H     TYPEFLE=INPUT  AND RDONLY=YES                    JJ 53040000
.*          = I            =INPUT  AND RDONLY OMITTED                JJ 53080000
.*          = N            =OUTPUT AND RDONLY=YES                    JJ 53120000
.*          = O            =OUTPUT AND RDONLY OMITTED                JJ 53160000
.* 4) &WKIO = W     ONE IOAREA  AND WORK AREA                        JJ 53200000
.*          = B     TWO IOAREAS AND WORK AREA                        JJ 53240000
.*          = Z     ONE IOAREA                                       JJ 53280000
.*          = I     TWO IOAREAS                                      JJ 53320000
.* 5) &DEV  = 8     DEVICE=2560 AND FUNC=R OR P OR OMITTED           JJ 53360000
.*          = 9     DEVICE=5425 AND FUNC=R OR P OR OMITTED     @DL2994J 53400000
.*          = F     DEVICE=2560 AND FUNC=RP                    @DL2994J 53440000
.*          = G     DEVICE=2560 AND FUNC=RW                    @DL2994J 53480000
.*          = H     DEVICE=2560 AND FUNC=PW                    @DL2994J 53520000
.*          = I     DEVICE=2560 AND FUNC=I                           JJ 53560000
.*          = J     DEVICE=2560 AND FUNC=RPW                   @DL2994J 53600000
.*          = K     DEVICE=5425 AND FUNC=RP                    @DL2994J 53640000
.*          = L     DEVICE=5425 AND FUNC=RW                    @DL2994J 53680000
.*          = M     DEVICE=5425 AND FUNC=PW                    @DL2994J 53720000
.*          = N     DEVICE=5425 AND FUNC=I                     @DL2994J 53760000
.*          = O     DEVICE=5425 AND FUNC=RPW                   @DL2994J 53800000
.*                                                                   JJ 53840000
         AIF   (K'&DEVICE GT 5).MFCX1                                JJ 53880000
         AIF   (K'&DEVICE NE 5).MFCX2                                JJ 53920000
         AIF   ('&DEVICE'(5,1) EQ 'P').MFCX2                         JJ 53960000
         AIF   ('&DEVICE'(5,1) EQ 'S').MFCX2                         JJ 54000000
.MFCX1   MNOTE 0,'INVALID DEVICE SPECIFIED. ''&CG1'' ASSUMED'        JJ 54040000
.MFCX2   ANOP                                                        JJ 54080000
&RECF    SETC  'F'                                                   JJ 54120000
         AIF   ('&RECFM2' EQ 'FIXUNB').MF2                     @D14BDBF 54160000
&RECF    SETC  'U'                                                   JJ 54200000
         AIF   ('&RECFM2' EQ 'UNDEF').MF1                      @D14BDBF 54240000
&RECF    SETC  'V'                                                   JJ 54280000
         AIF   ('&RECFM2' EQ 'VARUNB').MF1                     @D14BDBF 54320000
         MNOTE 0,'IMPROPER RECFORM. MACRO NOT GENERATED'             JJ 54360000
         MEXIT                                                       JJ 54400000
.MF1     AIF   ('&TYPEFLE' NE 'INPUT' AND '&FUNC' NE 'I').MF2        JJ 54440000
&RECF    SETC  'F'                                                   JJ 54480000
         MNOTE 0,'IMPROPER RECFORM. ''FIXUNB'' ASSUMED'              JJ 54520000
&RECFM2   SETC  'FIXUNB'                                       @D14BDBF 54560000
.*                                                                   JJ 54600000
.MF2     ANOP                                                        JJ 54640000
         AIF   (T'&CTLCHR EQ 'O').MF5                                JJ 54680000
         AIF   (T'&CONTROL NE 'O').MF4                               JJ 54720000
         AIF   ('&TYPEFLE' NE 'OUTPUT').MF3                          JJ 54760000
&CNTL    SETC  'A'                                                   JJ 54800000
         AIF   ('&CTLCHR' EQ 'ASA').MF8                              JJ 54840000
&CNTL    SETC  'Y'                                                   JJ 54880000
         AIF   ('&CTLCHR' EQ 'YES').MF8                              JJ 54920000
         MNOTE 0,'IMPROPER CTLCHR. ''YES'' ASSUMED'                  JJ 54960000
         AGO   .MF8                                                  JJ 55000000
.MF3     MNOTE 0,'INVALID CTLCHR PARAMETER. IGNORED'                 JJ 55040000
         AGO   .MF7                                                  JJ 55080000
.MF4     MNOTE 0,'CTLCHR AND CONTROL BOTH SPECIFIED. CTLCHR IGNORED' JJ 55120000
.*                                                                   JJ 55160000
.MF5     AIF   (T'&CONTROL EQ 'O').MF7                               JJ 55200000
&CNTL    SETC  'C'                                                   JJ 55240000
         AIF   ('&TYPEFLE' NE 'INPUT').MF6                           JJ 55280000
         AIF   (T'&IOAREA2 NE 'O').MF6A                              JJ 55320000
         AIF   ('&FUNC' NE 'RP' AND '&FUNC' NE 'RPW').MF6            JJ 55360000
.MF6A    MNOTE 0,'INVALID CONTROL PARAMETER. IGNORED'                JJ 55400000
         AGO   .MF7                                                  JJ 55440000
.MF6     AIF   ('&CONTROL' EQ 'YES').MF8                             JJ 55480000
         MNOTE 0,'IMPROPER CONTROL PARAMETER. ''YES'' ASSUMED'       JJ 55520000
         AGO   .MF8                                                  JJ 55560000
.MF7     ANOP                                                        JJ 55600000
&CNTL    SETC  'Z'                                                   JJ 55640000
.*                                                                   JJ 55680000
.MF8     ANOP                                                        JJ 55720000
         AIF   ('&TYPEFLE' NE 'INPUT').MF9                           JJ 55760000
&FTYP    SETC  'H'                                                   JJ 55800000
         AIF   (T'&RDONLY NE 'O').MF11                               JJ 55840000
&FTYP    SETC  'I'                                                   JJ 55880000
         AGO   .MF12                                                 JJ 55920000
.MF9     AIF   ('&TYPEFLE' EQ 'OUTPUT').MF10                         JJ 55960000
         MNOTE 0,'IMPROPER TYPEFLE. MACRO NOT GENERATED'             JJ 56000000
         MEXIT                                                       JJ 56040000
.MF10    ANOP                                                        JJ 56080000
&FTYP    SETC  'N'                                                   JJ 56120000
         AIF   (T'&RDONLY NE 'O').MF11                               JJ 56160000
&FTYP    SETC  'O'                                                   JJ 56200000
.MF11    AIF   (T'&RDONLY EQ 'O' OR '&RDONLY' EQ 'YES').MF12         JJ 56240000
         MNOTE 0,'IMPROPER RDONLY. ''YES'' ASSUMED'                  JJ 56280000
.*                                                                   JJ 56320000
.MF12    ANOP                                                        JJ 56360000
         AIF   (T'&IOAREA2 EQ 'O').MF15                              JJ 56400000
&WKIO    SETC  'B'                                                   JJ 56440000
         AIF   (K'&FUNC GT 1).MF14                                   JJ 56480000
         AIF   ('&FUNC' EQ 'I').MF14                                 JJ 56520000
         AIF   (T'&WORKA NE 'O').MF13                                JJ 56560000
&WKIO    SETC  'I'                                                   JJ 56600000
.MF13    AIF   ('&IOAREA2' EQ 'YES').MF16                            JJ 56640000
         MNOTE 0,'IMPROPER IOAREA2. ''YES'' ASSUMED'                 JJ 56680000
         AGO   .MF16                                                 JJ 56720000
.MF14    MNOTE 0,'INVALID IOAREA2. IGNORED'                          JJ 56760000
.MF15    ANOP                                                        JJ 56800000
&WKIO    SETC  'W'                                                   JJ 56840000
         AIF   (T'&WORKA NE 'O').MF16                                JJ 56880000
&WKIO    SETC  'Z'                                                   JJ 56920000
.MF16    AIF   (T'&WORKA EQ 'O' OR '&WORKA' EQ 'YES').MF17           JJ 56960000
         MNOTE 0,'IMPROPER WORKA. ''YES'' ASSUMED'                   JJ 57000000
.*                                                                   JJ 57040000
.MF17    ANOP                                                        JJ 57080000
&FUNCT   SETC  '8FGHIJ'                                              JJ 57120000
         AIF   ('&CG1' EQ '2560').MF20                               JJ 57160000
&FUNCT   SETC  '9KLMNO'                                              JJ 57200000
.MF20    ANOP                                                        JJ 57240000
&ASF     SETA  1                                                     JJ 57280000
         AIF   ('&FUNC' EQ '').MF24                                  JJ 57320000
         AIF   ('&TYPEFLE' EQ 'OUTPUT').MF21                         JJ 57360000
         AIF   ('&FUNC' EQ 'P' OR '&FUNC' EQ 'I').MF23               JJ 57400000
         AIF   ('&FUNC' EQ 'PW').MF23                                JJ 57440000
         AIF   ('&FUNC' EQ 'R').MF24                                 JJ 57480000
&ASF     SETA  2                                                     JJ 57520000
         AIF   ('&FUNC' EQ 'RP').MF24                                JJ 57560000
&ASF     SETA  3                                                     JJ 57600000
         AIF   ('&FUNC' EQ 'RW').MF24                                JJ 57640000
&ASF     SETA  6                                                     JJ 57680000
         AIF   ('&FUNC' EQ 'RPW').MF24                               JJ 57720000
         AGO   .MF22                                                 JJ 57760000
.MF21    AIF   ('&FUNC' EQ 'R' OR '&FUNC' EQ 'RW').MF23              JJ 57800000
         AIF   ('&FUNC' EQ 'P').MF24                                 JJ 57840000
&ASF     SETA  2                                                     JJ 57880000
         AIF   ('&FUNC' EQ 'RP').MF24                                JJ 57920000
&ASF     SETA  4                                                     JJ 57960000
         AIF   ('&FUNC' EQ 'PW').MF24                                JJ 58000000
&ASF     SETA  5                                                     JJ 58040000
         AIF   ('&FUNC' EQ 'I').MF24                                 JJ 58080000
&ASF     SETA  6                                                     JJ 58120000
         AIF   ('&FUNC' EQ 'RPW').MF24                               JJ 58160000
.MF22    MNOTE 0,'INVALID FUNC PARAMETER. MACRO NOT GENERATED'       JJ 58200000
         MEXIT                                                       JJ 58240000
.MF23    MNOTE 0,'FUNC VALUE INVALID FOR &TYPEFLE FILE.                *58280000
               MACRO NOT GENERATED'                                  JJ 58320000
         MEXIT                                                       JJ 58360000
.MF24    ANOP                                                        JJ 58400000
&DEV     SETC  '&FUNCT'(&ASF,1)                                      JJ 58440000
.*                                                                   JJ 58480000
.MF27    AIF   (T'&CRDERR EQ 'O').MF28                               JJ 58520000
         MNOTE 0,'INVALID CRDERR. IGNORED'                           JJ 58560000
.MF28    AIF   (T'&SEPASMB EQ 'O' OR '&SEPASMB' EQ 'YES').MF29       JJ 58600000
         MNOTE 0,'IMPROPER SEPASMB. ''YES'' ASSUMED'                 JJ 58640000
.MF29    ANOP                                                        JJ 58680000
&NAM     SETC  'IJC&RECF&CNTL&FTYP&WKIO&DEV'                         JJ 58720000
         AIF   (T'&LABEL EQ 'O').MF30                                JJ 58760000
&NAM     SETC  '&LABEL'                                              JJ 58800000
.MF30    AIF   (T'&SEPASMB EQ 'O').MF31                              JJ 58840000
          PUNCH ' CATALOG &NAM..OBJ                     REPLACE=YES'    58880000
.MF31    AIF   ('&TYPEFLE' EQ 'OUTPUT').MF100                        JJ 58920000
.*                                                                   JJ 58960000
.*             INPUT FILES                                           JJ 59000000
.*                                                                   JJ 59040000
IJC00A&X DSECT                                                       JJ 59080000
IJC01A&X DS    CL2  RESIDUAL COUNT                                   JJ 59120000
IJC02A&X DS    CL1  COMMUNICATION BYTE 1                             JJ 59160000
         DS    CL1  COMMUNICATION BYTE 2                             JJ 59200000
         DS    CL2  CSW STATUS BYTES                                 JJ 59240000
         DS    CL2  LOGICAL UNIT ADDRESS                             JJ 59280000
IJC03A&X DS    CL4  CCW ADDRESS                                @DA06223 59320000
         DS    CL1  STATUS BYTE                                      JJ 59360000
         DS    CL3  CCW ADDRESS  IN CSW                              JJ 59400000
IJC94A&X DS    CL4  SWITCHES AND ADDRESS OF LOGIC MODULE             JJ 59440000
         DS    CL1  DTF TYPE                                         JJ 59480000
IJC09A&X DS    CL1  SWITCHES                                         JJ 59520000
IJC10A&X DS    CL1  NORMAL COMMAND CODE                              JJ 59560000
IJC11A&X DS    CL1  CONTROL COMMAND CODE                             JJ 59600000
IJC12A&X DS    CL4  ADDRESS OF IOAREA2                               JJ 59640000
IJC13A&X DS    CL1  SWITCHES                                         JJ 59680000
         DS    CL3  ADDRESS OF EOF ROUTINE                           JJ 59720000
         AIF   ('&CD' NE '5425').MF31A                         @DL2994J 59760000
IJC14A&X DS    CL8  CCW  STACKER SELECT                        @DL2994J 59800000
.MF31A   ANOP                                                  @DL2994J 59840000
IJC15A&X DS    CL1  CCW  COMMAND CODE - READ AND FEED                JJ 59880000
         DS    CL3       ADDRESS OF IOAREA1                          JJ 59920000
         DS    CL1       FLAGS                                 @DL2994J 59960000
         DS    CL1                                             @DL2994J 60000000
IJC16A&X DS    CL2       COUNT                                 @DY38452 60040000
         AIF   ('&CD' EQ '5425').MF31B                         @DL2994J 60080000
IJC14A&X DS    CL8  CCW  STACKER SELECT                        @DL2994J 60120000
.MF31B   ANOP                                                  @DL2994J 60160000
IJC20A&X DS    CL4  LA   &IOREG,0(14)                                JJ 60200000
IJC21A&X DS    CL6  MVC  0(&BLKSIZE,13),0(14)                        JJ 60240000
IJC26A&X DS    CL6  CLC  0(&EOFL,14),64(1)                           JJ 60280000
         DS    CL4  EOF IDENTIFIER                                   JJ 60320000
IJC22A&X DS    CL4  ADDRESS OF ERROPT OR BRANCH INSTRUCTIONS         JJ 60360000
         AIF   (K'&FUNC LE 1).MF33                                   JJ 60400000
IJC23A&X DS    CL4  ADDRESS OF ASSOCIATED DTF TABLE                  JJ 60440000
IJC24A&X DS    CL6  MVC 0(&BLKSIZE,14),IJC27A&X                      JJ 60480000
IJC27A&X DS    0C   BUFFER FOR CARD IMAGE (LENGTH=&BLKSIZE)          JJ 60520000
.MF33    ANOP                                                        JJ 60560000
&NAM     CSECT                                                       JJ 60600000
         AIF   (T'&LABEL NE 'O').MF37                                JJ 60640000
         AIF   ('&CNTL' NE 'C').MF37                                 JJ 60680000
&ENT     SETC  '&NAM'(1,4)'Z'.'&NAM'(6,3)                            JJ 60720000
         ENTRY &ENT                                                  JJ 60760000
&ENT     EQU   *                                                     JJ 60800000
.MF37    USING IJC01A&X,1                                            JJ 60840000
         USING *,15                                                  JJ 60880000
         AIF   ('&CNTL' NE 'C').MF38                                 JJ 60920000
         B     IJC45A&X                 BRANCH TO CONTROL ROUTINE    JJ 60960000
         AGO   .MF39                                                 JJ 61000000
.MF38    SVC   50                       CONTROL ERROR                JJ 61040000
         DC    H'0'                                                  JJ 61080000
.MF39    SVC   50                       PRTOV ERROR                  JJ 61120000
         DC    H'0'                                                  JJ 61160000
         B     IJC30A&X                 BRANCH TO GET ROUTINE        JJ 61200000
IJC99A&X SVC   50                       PUT ERROR  OR MACRO-         JJ 61240000
         DC    H'0'                     SEQU. ERROR (IF ASSOC.FILE)  JJ 61280000
         B     IJC97A&X                 BR TO ERROPT = SKIP          JJ 61320000
         B     IJC98A&X                 BR TO ERROPT = IGNORE        JJ 61360000
         DC    CL8'&NAM'                                             JJ 61400000
        DC   C'C440'  /*@@LVLID*/  CHANGE LEVEL                @D41TDKY 61440000
        DC   CL43'5686-007 (C) COPYRIGHT IBM CORP. 1981,1988'  @D41TDKY 61480000
        DC   CL37'LICENSED MATERIALS-PROPERTY OF IBM  '        @D41TDKY 61520000
IJC30A&X EQU   *                                                     JJ 61560000
.MF40    AIF   (T'&FUNC EQ 'O' OR '&FUNC' EQ 'R').MF50               JJ 61600000
         AIF   (T'&RDONLY EQ 'O').MF40C                              JJ 61640000
         STM   IJC12B&X,IJC01B&X,0(IJC13B&X) SAVE REG'S 12-1         JJ 61680000
         LR    IJC12B&X,IJC13B&X       SAVE POINTER TO SAVE AREA     JJ 61720000
         AGO   .MF40E                                                JJ 61760000
.MF40C   ANOP                                                        JJ 61800000
         STM   IJC13B&X,IJC01B&X,IJC51A&X SAVE REG'S 13-1            JJ 61840000
.MF40E   ANOP                                                        JJ 61880000
         TM    IJC94A&X,IJC24B&X        FILE OPENED IGN        @DA08769 61920000
         BO    IJC1AA&X                 YES, BRANCH            @DA08769 61960000
         TM    IJC09A&X,IJC21B&X        FILE OPENED                  JJ 62000000
         BZ    IJC99A&X                 NO                           JJ 62040000
IJC1AA&X EQU   *                                               @DA08769 62080000
         AIF   ('&FUNC' EQ 'RW').MF41                                JJ 62120000
         L     IJC13B&X,IJC23A&X        ADDR OF PUNCH DTF INTO REG 13JJ 62160000
         TM    IJC16B&X.(IJC13B&X),IJC22B&X SEQUENCE ERROR           JJ 62200000
         BO    IJC99A&X                 YES                          JJ 62240000
         OI    IJC16B&X.(IJC13B&X),IJC22B&X SET GET SW               JJ 62280000
.MF41    TM    IJC09A&X,IJC23B&X        FIRST TIME                   JJ 62320000
         BO    IJC34A&X                 NO                           JJ 62360000
         OI    IJC09A&X,IJC23B&X        SET FIRST TIME SW            JJ 62400000
         SVC   0                        READ INTO DTF TABLE BUFFER   JJ 62440000
         AIF   ('&FUNC' EQ 'RP').MF44                                JJ 62480000
         AIF   ('&FUNC' NE 'RW').MF42                                JJ 62520000
         L    IJC13B&X,IJC23A&X         GET ADDR OF PRINT DTF TABLE  JJ 62560000
         OI    IJC27B&X.(IJC13B&X),IJC26B&X   SET PRINT CNTRL SW     JJ 62600000
.MF42    ANOP                                                        JJ 62640000
         B     IJC36A&X                                              JJ 62680000
.MF44    ANOP                                                        JJ 62720000
IJC34A&X EQU   *                                                     JJ 62760000
         AIF   ('&FUNC' EQ 'RP').MF48                                JJ 62800000
         L     IJC13B&X,IJC23A&X        GET ADDR OF ASSOC. DTF TABLE JJ 62840000
         AIF   ('&FUNC' EQ 'RW').MF45                                JJ 62880000
         L     IJC13B&X,IJC25B&X.(IJC13B&X) GET ADDR OF PRINT DTF TABJJ 62920000
.MF45    TM    IJC27B&X.(IJC13B&X),IJC26B&X WAS LAST CARD PRINTED    JJ 62960000
         AIF   ('&FUNC' NE 'RW').MF46                                JJ 63000000
         BO    IJC35A&X                 NO                           JJ 63040000
         OI    IJC27B&X.(IJC13B&X),IJC26B&X SET PRINT SWITCH         JJ 63080000
         B     IJC36A&X                                              JJ 63120000
         AGO   .MF47                                                 JJ 63160000
.MF46    BZ    IJC36A&X                 YES                          JJ 63200000
         XI    IJC27B&X.(IJC13B&X),IJC26B&X SET PRINT SWITCH         JJ 63240000
         L     IJC01B&X,IJC23A&X        ADDR OF PUNCH DTF INTO REG 1 JJ 63280000
         SVC   0                        PUNCH LAST CARD              JJ 63320000
         AIF   (T'&RDONLY EQ 'O').MF46A                              JJ 63360000
         L     IJC01B&X,20(IJC12B&X)    RESTORE REG 1                JJ 63400000
         AGO   .MF47                                                 JJ 63440000
.MF46A   L     IJC01B&X,IJC51A&X+16     RESTORE REG 1                JJ 63480000
.MF47    ANOP                                                        JJ 63520000
IJC35A&X EQU   *                                               @DL2994J 63560000
         AIF   ('&CD' NE '5425' OR '&FUNC' NE 'RW').MF47A      @DL2994J 63600000
         AIF   ('&CNTL' NE 'C').MF47A                          @DL2994J 63640000
         MVC   IJC14A&X.(1),IJC11A&X  * UPDATE CONTROL         @DL2994J 63680000
         MVC   IJC11A&X.(1),IJC10A&X  * COMMAND CODE           @DL2994J 63720000
.MF47A   SVC   0                        READ INTO DTF BUFFER   @DL2994J 63760000
.MF48    ANOP                                                        JJ 63800000
IJC36A&X TM    IJC02A&X,IJC21B&X        TEST FOR CHANNEL END         JJ 63840000
         BO    *+6                                                   JJ 63880000
         SVC   7                        WAIT FOR CHANNEL END         JJ 63920000
         L     IJC14B&X,IJC12A&X        ADDR OF IOAREA INTO REG 14   JJ 63960000
         TM    IJC94A&X,IJC29B&X        ERROPT SPECIFIED             JJ 64000000
         BZ    IJC96A&X                 NO                           JJ 64040000
         TM    IJC02A&X+1,IJC28B&X      HAS ERROR OCCURRED           JJ 64080000
         BZ    IJC96A&X                 NO                           JJ 64120000
         CLI   IJC22A&X,IJC30B&X        TEST FOR ERROPT PARAMETER    JJ 64160000
         BE    IJC22A&X                 BR IF SKIP OR IGNORE         JJ 64200000
         L     IJC14B&X,IJC22A&X        GET ADDR OF ERROR ROUTINE    JJ 64240000
         L     IJC01B&X,IJC15A&X        GET ADDR OF ERROR RECORD     JJ 64280000
         AIF   (T'&RDONLY EQ 'O').MF48H                              JJ 64320000
         BALR  IJC14B&X,IJC14B&X        BR TO USER ROUTINE           JJ 64360000
         LM    IJC14B&X,IJC01B&X,8(IJC13B&X) RESTORE REGS 14-1       JJ 64400000
IJC97A&X SVC   0                        RE-ISSUE READ COMMAND        JJ 64440000
         B     IJC36A&X                 CONTINUE NORMAL PROCESS      JJ 64480000
         AGO   .MF48I                                                JJ 64520000
.MF48H   CNOP  2,4                                                   JJ 64560000
         BALR  IJC14B&X,IJC14B&X        BR TO USER ROUTINE           JJ 64600000
         LM    IJC14B&X,IJC01B&X,16(IJC14B&X) RESTORE REGS 14-1      JJ 64640000
IJC97A&X SVC   0                        RE-ISSUE READ COMMAND        JJ 64680000
         B     IJC36A&X                 CONTINUE NORMAL PROCESS      JJ 64720000
         DC    H'0'                     FILL BYTES                   JJ 64760000
IJC51A&X DC    5F'0'                    REGISER SAVE AREA            JJ 64800000
.MF48I   ANOP                                                        JJ 64840000
IJC98A&X EX    0,IJC24A&X               ERROR RECORD INTO IOAREA1    JJ 64880000
         LR    IJC01B&X,IJC14B&X        REG 1 POINTS TO ERROR RECORD JJ 64920000
         B     IJC39A&X                 RETURN TO USER               JJ 64960000
IJC96A&X EQU   *                                                     JJ 65000000
         EX    0,IJC24A&X               DTF BUFFER CONTENTS TO IOAREAJJ 65040000
         EX    0,IJC26A&X               END OF FILE (/*)             JJ 65080000
         BNE   IJC38A&X                 NO                           JJ 65120000
         AIF   (T'&RDONLY EQ 'O').MF48A                              JJ 65160000
         MVC   9(3,IJC12B&X),IJC13A&X+1 REPLACE RETURN ADDRESS       JJ 65200000
         AGO   .MF48B                                                JJ 65240000
.MF48A   MVC   IJC51A&X+5(3),IJC13A&X+1 REPLACE RETURN ADDRESS       JJ 65280000
.MF48B   XI    IJC09A&X,IJC23B&X        SET OFF FIRST TIME SWITCH    JJ 65320000
         AIF   ('&WKIO' NE 'W').MF49A                                JJ 65360000
         B     IJC39A&X                                              JJ 65400000
.MF49A   ANOP                                                        JJ 65440000
IJC38A&X EQU   *                                                     JJ 65480000
         AIF   ('&WKIO' NE 'W').MF49B                                JJ 65520000
         LR    IJC13B&X,IJC00B&X        ADDR OF WORK AREA INTO REG 13JJ 65560000
         ST    IJC12B&X,IJC46A&X        SAVE REGISTER 12       @DY38452 65600000
         LH    IJC12B&X,IJC16A&X        LOAD REG 12 WITH COUNT @DY38452 65640000
         BCTR  IJC12B&X,0               PREPARE MOVE TO WORKA  @DY38452 65680000
         EX    IJC12B&X,IJC47A&X        IOAREA CONTENTS INTO   @DY38452 65720000
*                                       WORK AREA              @DY38452 65760000
         L     IJC12B&X,IJC46A&X        RESTORE REGISTER 12    @DY38452 65800000
.MF49B   ANOP                                                        JJ 65840000
IJC39A&X EQU   *                        RESTORE REGISTERS            JJ 65880000
         AIF   (T'&RDONLY EQ 'O').MF49I                              JJ 65920000
         LM    IJC12B&X,IJC14B&X,0(IJC12B&X)                         JJ 65960000
         AGO   .MF62                                                 JJ 66000000
.MF49I   ANOP                                                        JJ 66040000
         LM    IJC13B&X,IJC14B&X,IJC51A&X                            JJ 66080000
         AGO   .MF62                                                 JJ 66120000
.MF50    ANOP                                                        JJ 66160000
         AIF   (T'&WORKA EQ 'O').MF52                                JJ 66200000
         AIF   (T'&RDONLY EQ 'O').MF51                               JJ 66240000
         STM   IJC12B&X,IJC01B&X,IJC00B&X.(IJC13B&X) SAVE REG'S 12-1 JJ 66280000
         LR    IJC12B&X,IJC13B&X        SAVE POINTER TO SAVE AREA    JJ 66320000
         AGO   .MF54                                                 JJ 66360000
.MF51    STM   IJC13B&X,IJC01B&X,IJC51A&X SAVE REGISTERS 13-1        JJ 66400000
         AGO   .MF54                                                 JJ 66440000
.MF52    AIF   (T'&RDONLY EQ 'O').MF53                               JJ 66480000
          STM   IJC14B&X,IJC01B&X,4(IJC13B&X) SAVE REGS 14-1         JJ 66520000
         AGO   .MF54                                                 JJ 66560000
.MF53    STM   IJC14B&X,IJC01B&X,IJC51A&X+4 SAVE REGS 14-1           JJ 66600000
.MF54    ANOP                                                  @DA06223 66640000
         AIF   (T'&IOAREA2 NE 'O').MF55                        @DA08282 66680000
         AIF   ('&CD' NE '5425' OR '&CNTL' NE 'C').MF54A       @DL2994J 66720000
         MVC   IJC14A&X.(1),IJC11A&X  * UPDATE CONTROL         @DL2994J 66760000
         MVC   IJC11A&X.(1),IJC10A&X  * COMMAND CODE           @DL2994J 66800000
.MF54A   SVC   0                        READ AND FEED          @DL2994J 66840000
         AGO   .MF56                                                 JJ 66880000
.MF55    TM    IJC09A&X,IJC23B&X        FIRST TIME                   JJ 66920000
         BO    IJC41A&X                 NO                           JJ 66960000
         OI    IJC09A&X,IJC23B&X        SET OFF FIRST TIME SWITCH    JJ 67000000
         SVC   0                        READ AND FEED                JJ 67040000
.MF56    ANOP                                                        JJ 67080000
IJC41A&X TM    IJC02A&X,IJC21B&X        TEST FOR CHANNEL END         JJ 67120000
         BO    *+6                                                   JJ 67160000
         SVC   7                        WAIT FOR CHANNEL END         JJ 67200000
         AIF   ('&CD' NE '2560').MF561                         @DA08282 67240000
         LA    IJC14B&X,IJC15A&X        GET ADDR OF CCW        @DA08282 67280000
         ST    IJC14B&X,IJC03A&X        STORE IN CCB           @DA08282 67320000
.MF561   ANOP                                                  @DA08282 67360000
         L     IJC14B&X,IJC15A&X        ADDR OF IOAREA1 INTO REG 14  JJ 67400000
         TM    IJC94A&X,IJC29B&X        ERROPT SPECIFIED             JJ 67440000
         BZ    IJC96A&X                 NO                           JJ 67480000
         TM    IJC02A&X+1,IJC28B&X      HAS ERROR OCCURRED           JJ 67520000
         BZ    IJC96A&X                 NO                           JJ 67560000
         CLI   IJC22A&X,IJC30B&X        TEST FOR ERROPT PARAMETER    JJ 67600000
         BE    IJC22A&X                 BR IF SKIP OR IGNORE         JJ 67640000
         L     IJC14B&X,IJC22A&X        GET ADDR OF ERROR ROUTINE    JJ 67680000
         L     IJC01B&X,IJC15A&X        GET ADDR OF ERROR RECORD     JJ 67720000
         AIF   (T'&RDONLY EQ 'O').MF56H                              JJ 67760000
         BALR  IJC14B&X,IJC14B&X        BR TO USER ROUTINE           JJ 67800000
         LM    IJC14B&X,IJC01B&X,8(IJC13B&X) RESTORE REGS 14-1       JJ 67840000
IJC97A&X SVC   0                        RE-ISSUE READ COMMAND        JJ 67880000
         B     IJC41A&X                 CONTINUE NORMAL PROCESS      JJ 67920000
         AGO   .MF56I                                                JJ 67960000
.MF56H   CNOP  2,4                                                   JJ 68000000
         BALR  IJC14B&X,IJC14B&X        BR TO USER ROUTINE           JJ 68040000
         LM    IJC14B&X,IJC01B&X,16(IJC14B&X) RESTORE REGS 14-1      JJ 68080000
IJC97A&X SVC   0                        RE-ISSUE READ COMMAND        JJ 68120000
         B     IJC41A&X                 CONTINUE NORMAL PROCESS      JJ 68160000
         DC    H'0'                     FILL BYTES                   JJ 68200000
IJC51A&X DC    5F'0'                    REGISER SAVE AREA            JJ 68240000
.MF56I   ANOP                                                        JJ 68280000
IJC98A&X EQU   *                                                     JJ 68320000
         AIF   ('&WKIO' EQ 'W' OR '&WKIO' EQ 'Z').MF56K NO IOAREA2   JJ 68360000
         XI    IJC09A&X,IJC23B&X        SET OFF FIRST TIME SW        JJ 68400000
.MF56K   LR    IJC01B&X,IJC14B&X        REG 1 POINTS TO ERROR RECORD JJ 68440000
         B     IJC95A&X                 RETURN TO USER               JJ 68480000
IJC96A&X EQU   *                                                     JJ 68520000
         AIF   (T'&IOAREA2 EQ 'O').MF58A                       @DM08868 68560000
         MVC   IJC15A&X+1(3),IJC12A&X+1 EXCHANGE ADDRESSES     @DM08868 68600000
         ST    IJC14B&X,IJC12A&X              OF IOAREAS       @DM08868 68640000
         AIF   (T'&WORKA NE 'O').MF58A                         @DM08868 68680000
         EX    0,IJC20A&X               LOAD USER'S IOREG      @DM08868 68720000
.MF58A   ANOP                                                  @DM08868 68760000
         TM    IJC02A&X,IJC23B&X        /* OR /& IF SYSIPT OR SYSRDR JJ 68800000
         BO    IJC42A&X                 YES                          JJ 68840000
         EX    0,IJC26A&X               END OF FILE                  JJ 68880000
         BNE   IJC43A&X                 NO                           JJ 68920000
IJC42A&X L     IJC14B&X,IJC13A&X        GET USERS EOF ADDRESS        JJ 68960000
         AIF   (T'&IOAREA2 EQ 'O').MF56A                             JJ 69000000
         XI    IJC09A&X,IJC23B&X        SET OFF FIRST TIME SW        JJ 69040000
.MF56A   B     IJC44A&X                                              JJ 69080000
IJC43A&X EQU   *                                                     JJ 69120000
         AIF   (T'&WORKA EQ 'O').MF57                                JJ 69160000
         LR    IJC13B&X,IJC00B&X        ADDR OF WORK AREA INTO REG 13JJ 69200000
         ST    IJC12B&X,IJC46A&X        SAVE REGISTER 12       @DY38452 69240000
         LH    IJC12B&X,IJC16A&X        LOAD REG 12 WITH COUNT @DY38452 69280000
         BCTR  IJC12B&X,0               PREPARE MOVE TO WORKA  @DY38452 69320000
         EX    IJC12B&X,IJC47A&X        IOAREA CONTENTS INTO   @DY38452 69360000
*                                       WORK AREA              @DY38452 69400000
         L     IJC12B&X,IJC46A&X        RESTORE REGISTER 12    @DY38452 69440000
.MF57    AIF   (T'&IOAREA2 EQ 'O').MF58                              JJ 69480000
         SVC   0                        READ AND FEED          @DL2994J 69520000
.MF58    ANOP                                                        JJ 69560000
IJC95A&X EQU   *                                                     JJ 69600000
         AIF   (T'&WORKA EQ 'O').MF60                                JJ 69640000
         AIF   (T'&RDONLY EQ 'O').MF59                               JJ 69680000
         LM    IJC12B&X,IJC14B&X,0(IJC12B&X) RESTORE REGISTERS 12-14 JJ 69720000
         AGO   .MF62                                                 JJ 69760000
.MF59    LM    IJC13B&X,IJC14B&X,IJC51A&X RESTORE REGISTERS 13-14    JJ 69800000
         AGO   .MF62                                                 JJ 69840000
.MF60    AIF   (T'&RDONLY EQ 'O').MF61                               JJ 69880000
         L     IJC14B&X,4(IJC13B&X)     RESTORE RETURN ADDRESS       JJ 69920000
         AGO   .MF62                                                 JJ 69960000
.MF61    L     IJC14B&X,IJC51A&X+4      RESTORE RETURN ADDRESS       JJ 70000000
.MF62    ANOP                                                        JJ 70040000
IJC44A&X EQU   *                                                     JJ 70080000
         BR    IJC14B&X                 RETURN                       JJ 70120000
         AIF   ('&CNTL' NE 'C').MF63                                 JJ 70160000
IJC45A&X SRA   IJC00B&X,2(IJC00B&X) SHIFT STACKER NUMBER             JJ 70200000
         AH    IJC00B&X,IJC52A&X        ADD X'0013'                  JJ 70240000
         AIF   ('&CD' NE '5425').MF62A                         @DL2994J 70280000
         NI    IJC11A&X,IJC21B&X        CLEAR SS CODE          @DL2994J 70320000
         O     IJC00B&X,IJC11A&X-3      SET HOPPER BIT         @DL2994J 70360000
         STC   IJC00B&X,IJC11A&X        STORE SS CODE          @DL2994J 70400000
         AGO   .MF62B                                          @DL2994J 70440000
.MF62A   NI    IJC15A&X,IJC21B&X        CLEAR SS CODE          @DL2994J 70480000
         STC   IJC00B&X,IJC11A&X                                     JJ 70520000
         OC    IJC15A&X.(1),IJC11A&X    STACKER NUMBER INTO CCC      JJ 70560000
         SVC   0                                                     JJ 70600000
         TM    IJC02A&X,IJC21B&X        TEST FOR CHANNEL END         JJ 70640000
         BO    *+6                                                   JJ 70680000
         SVC   7                        WAIT FOR CHANNEL END         JJ 70720000
         MVC   IJC15A&X.(1),IJC10A&X    RESTORE NORMAL COMMAND CODE  JJ 70760000
.MF62B   BR    IJC14B&X                 RETURN                 @DL2994J 70800000
IJC52A&X DC    Y(X'0013')                                            JJ 70840000
.MF63    ANOP                                                        JJ 70880000
         DS    0F                       ALLIGN                 @DY38452 70920000
IJC46A&X DC    1F'0'                         WORKAREA SAVE R12 @DY38452 70960000
IJC47A&X MVC   0(0,13),0(14)     CONTENTS OF IOAREA INTO WORKA @DY38452 71000000
IJC00B&X EQU   0                                                     JJ 71040000
IJC01B&X EQU   1                                                     JJ 71080000
IJC12B&X EQU   12                                                    JJ 71120000
IJC13B&X EQU   13                                                    JJ 71160000
IJC14B&X EQU   14                                                    JJ 71200000
IJC21B&X EQU   X'80'     OPEN SWITCH,TRAFFIC BIT IN CCB,HOPPER BIT   JJ 71240000
IJC24B&X EQU   X'20'     IGNORE BIT                            @DA08769 71280000
IJC23B&X EQU   X'40' FIRST TIME SWITCH OR EOF INDICATOR FOR SYSIN    JJ 71320000
IJC28B&X EQU   X'10'     DATA OR EQUIPM. CHECK SW IN CCB             JJ 71360000
IJC29B&X EQU   X'40'     ERROPT SWITCH                               JJ 71400000
IJC30B&X EQU   X'47'     BRANCH OP-CODE                              JJ 71440000
         AIF   (K'&FUNC LE 1).MF180                                  JJ 71480000
IJC16B&X EQU   16                                                    JJ 71520000
IJC22B&X EQU   X'10'     SEQUENCE CONTROL (ON BY GET, OFF BY PUT)    JJ 71560000
IJC25B&X EQU   X'40'     OFFSET OF PRINT DTF ADDR IN PUNCH DTF TABLE JJ 71600000
IJC26B&X EQU   X'20'     PRINT SWITCH (ON:PR ALLOWED,                JJ 71640000
*                                      OFF: PR DISALLOWED)           JJ 71680000
IJC27B&X EQU   X'2C'     OFFSET OF SWITCH IJC26BXX IN PRINT DTF TABLEJJ 71720000
         AGO   .MF180                                                JJ 71760000
.*                                                                   JJ 71800000
.*             OUTPUT FILES                                          JJ 71840000
.*                                                                   JJ 71880000
.MF100   ANOP                                                        JJ 71920000
IJC00C&X DSECT                                                       JJ 71960000
IJC01C&X DS    CL2  RESIDUAL COUNT                                   JJ 72000000
IJC02C&X DS    CL2  COMMUNICATION BYTES                              JJ 72040000
         DS    CL2  CSW STATUS BYTES                                 JJ 72080000
         DS    CL2  LOGICAL UNIT ADDRESS                             JJ 72120000
IJC03C&X DS    CL1  NOT USED,MUST CONTAIN X'00'                      JJ 72160000
         DS    CL3  ADDRESS OF CCW                                   JJ 72200000
         DS    CL1  STATUS BYTE                                      JJ 72240000
         DS    CL3  CCW ADDRESS IN CSW                               JJ 72280000
IJC26C&X DS    CL4  ADDRESS OF LOGICAL MODULE                        JJ 72320000
IJC27C&X DS    CL1  DTF TYPE                                         JJ 72360000
IJC04C&X DS    CL1  SWITCHES                                         JJ 72400000
IJC05C&X DS    CL1  NORMAL CONTROL COMMAND                           JJ 72440000
IJC06C&X DS    CL1  ACTUAL CONTROL COMMAND                           JJ 72480000
IJC07C&X DS    CL4  ADDRESS OF IOAREA1                               JJ 72520000
IJC08C&X DS    CL4  BUCKET                                           JJ 72560000
IJC09C&X DS    CL2  LR 12,&RECSIZE (UNDEFINED RECORDS)               JJ 72600000
IJC10C&X DS    CL4  LA &IOREG,0(14)                                  JJ 72640000
         DS    CL1  SWITCHES                                         JJ 72680000
         DS    CL1  BLANK                                            JJ 72720000
         DS    CL8   EJECT CCW                                       JJ 72760000
IJC13C&X DS    CL1  CCW - STACKER SELECT                             JJ 72800000
         DS    CL3       NOT USED                                    JJ 72840000
IJC14C&X DS    CL1       FLAGS                                       JJ 72880000
         DS    CL3       NOT USED                                    JJ 72920000
IJC15C&X DS    CL1  CCW - PUNCH                                      JJ 72960000
         DS    CL3       ADDRESS OF IOAREA 2                         JJ 73000000
         DS    CL1       FLAGS                                       JJ 73040000
         DS    CL1       NOT USED                                    JJ 73080000
IJC16C&X DS    CL2       COUNT                                       JJ 73120000
         AIF   (T'&FUNC EQ 'O' OR '&FUNC' EQ 'P').MF103              JJ 73160000
         AIF   ('&FUNC' EQ 'I').MF101                                JJ 73200000
IJC17C&X DS    CL4  ADDRESS OF ASSOCIATED DTF TABLE                  JJ 73240000
IJC20C&X DS    CL1  BLANK                                            JJ 73280000
IJC21C&X DS    0C   BUFFER FOR CARD IMAGE (LENGTH=&BLKSIZE)          JJ 73320000
         AGO   .MF103                                                JJ 73360000
.MF101   AIF   ('&CD' NE '2560').MF103                               JJ 73400000
IJC22C&X DS    CL8 CCW - LOAD PRINT HEAD-BUFFER 1                    JJ 73440000
IJC23C&X DS    CL8  CCW - LOAD PRINT HEAD BUFFER 2                   JJ 73480000
IJC24C&X DS    CL8  CCW - PRINT                                      JJ 73520000
IJC25C&X DS    CL64 PRINT BUFFER FOR LINE 2                          JJ 73560000
.MF103   ANOP                                                        JJ 73600000
&NAM     CSECT                                                       JJ 73640000
         AIF   (T'&LABEL NE 'O').MF104                               JJ 73680000
         AIF   ('&CNTL' NE 'C').MF104                                JJ 73720000
&ENT     SETC  '&NAM'(1,4)'Z'.'&NAM'(6,3)                            JJ 73760000
         ENTRY &ENT                                                  JJ 73800000
&ENT     EQU   *                                                     JJ 73840000
.MF104   USING IJC01C&X,1                                            JJ 73880000
         USING *,15                                                  JJ 73920000
         AIF   ('&CNTL' NE 'C').MF105                                JJ 73960000
         B     IJC40C&X                 BRANCH TO CONTROL ROUTINE    JJ 74000000
         AGO   .MF106                                                JJ 74040000
.MF105   SVC   50                       CONTROL ERROR                JJ 74080000
         DC    H'0'                                                  JJ 74120000
.MF106   SVC   50                       PRINTOV ERROR                JJ 74160000
         DC    H'0'                                                  JJ 74200000
IJC99C&X SVC   50                       GET ERROR OR MACRO SEQU.-    JJ 74240000
         DC    H'0'                     ERROR (IF ASSOCIATED FILE)   JJ 74280000
         B     IJC30C&X                 BRANCH TO PUT ROUTINE        JJ 74320000
         DC    CL8'&NAM'                MODULE NAME                  JJ 74360000
        DC   C'C440'  /*@@LVLID*/  CHANGE LEVEL                @D41TDKY 74400000
        DC   CL43'5686-007 (C) COPYRIGHT IBM CORP. 1981,1988'  @D41TDKY 74440000
        DC   CL37'LICENSED MATERIALS-PROPERTY OF IBM  '        @D41TDKY 74480000
IJC30C&X EQU   *                                                     JJ 74520000
         AIF   ('&WKIO' NE 'Z').MF107                          @DA07285 74560000
         AIF   ('&RECF' NE 'F').MF107                          @DA07285 74600000
         AIF   ('&CNTL' EQ 'A' OR '&CNTL' EQ 'Y').MF107        @DA07285 74640000
         AIF   (T'&FUNC NE 'O' AND K'&FUNC NE 1).MF107         @DA07285 74680000
         AIF   (T'&RDONLY EQ 'O').MF106A                             JJ 74720000
         ST    IJC14B&X,0(IJC13B&X)     SAVE RETURN ADDRESS          JJ 74760000
         AGO   .MF109                                                JJ 74800000
.MF106A  ST    IJC14B&X,IJC37C&X        SAVE RETURN ADDRESS          JJ 74840000
         AGO   .MF109                                                JJ 74880000
.MF107   AIF   (T'&RDONLY EQ 'O').MF108                              JJ 74920000
         STM   IJC11B&X,IJC14B&X,0(IJC13B&X) SAVE REG'S 11-14        JJ 74960000
         AGO   .MF108A                                               JJ 75000000
.MF108   STM   IJC12B&X,IJC14B&X,IJC37C&X REGISTERS 12-14            JJ 75040000
.MF108A  AIF   ('&RECF' NE 'U').MF108B                               JJ 75080000
         EX    0,IJC09C&X               BLKSIZE INTO REG 12          JJ 75120000
         AGO   .MF108E                                               JJ 75160000
.MF108B  AIF   (K'&FUNC GT 1).MF108D                                 JJ 75200000
         AIF   (T'&WORKA EQ 'O').MF108E                              JJ 75240000
.MF108D  LH    IJC12B&X,IJC16C&X        BLKSIZE INTO REG 12          JJ 75280000
.MF108E  AIF   ('&RDONLY' EQ '').MF109                               JJ 75320000
         LR    IJC11B&X,IJC13B&X                                     JJ 75360000
.MF109   AIF   (T'&FUNC EQ 'O' OR K'&FUNC EQ 1).MF110                JJ 75400000
         TM    IJC26C&X,IJC35B&X        FILE OPENED IGN        @DA08769 75440000
         BO    IJC3CC&X                 YES, BRANCH            @DA08769 75480000
         TM    IJC04C&X,IJC30B&X        FILE OPEN                    JJ 75520000
         BZ    IJC99C&X                 NO                           JJ 75560000
IJC3CC&X EQU   *                                               @DA08769 75600000
         AIF   ('&FUNC' EQ 'PW').MF110                               JJ 75640000
         TM    IJC26C&X,IJC31B&X        SEQUENCE ERROR               JJ 75680000
         BZ    IJC99C&X                 YES                          JJ 75720000
         XI    IJC26C&X,IJC31B&X        SET CONTROL SWITCH OFF       JJ 75760000
.MF110   AIF   ('&FUNC' EQ 'RP' OR '&FUNC' EQ 'RPW').MF110A          JJ 75800000
         TM    IJC04C&X,IJC32B&X       TEST FIRST TIME               JJ 75840000
         BO    IJC33C&X                 NOT FIRST TIME               JJ 75880000
         OI    IJC04C&X,IJC32B&X        SET FIRST TIME SWITCH        JJ 75920000
         SVC   0                        EJECT LAST CARD              JJ 75960000
         TM    IJC02C&X,IJC30B&X        TEST DEVICE END              JJ 76000000
         BO    *+6                                                   JJ 76040000
         SVC   7                        WAIT                         JJ 76080000
.MF110A  ANOP                                                  @DA06223 76120000
IJC33C&X EQU   *                                                     JJ 76160000
         AIF   (T'&FUNC EQ 'O' OR K'&FUNC EQ 1).MF112          @DA08282 76200000
         LA    IJC14B&X,IJC13C&X        ADDR OF SSELECT CCW          JJ 76240000
         ST    IJC14B&X,IJC03C&X        INTO CCB                     JJ 76280000
         AIF   ('&FUNC' NE 'PW').MF112                         @DA06223 76320000
         L     IJC14B&X,IJC17C&X        GET ADDR OF PRINT DTF        JJ 76360000
         TM    IJC33B&X.(IJC14B&X),IJC34B&X WAS LAST CARD PRINTED    JJ 76400000
         BZ    IJC34C&X                 YES                          JJ 76440000
         SVC   0                        PUNCH LAST CARD              JJ 76480000
IJC34C&X OI    IJC33B&X.(IJC14B&X),IJC34B&X SET PRINT SWITCH         JJ 76520000
         TM    IJC02C&X,IJC30B&X        TEST DEVICE END              JJ 76560000
         BO    *+6                                                   JJ 76600000
         SVC   7                        WAIT DEVICE END              JJ 76640000
.MF112   AIF   ('&FUNC' NE 'RPW').MF112A                             JJ 76680000
         L     IJC14B&X,IJC17C&X        ADDR OF PRINT DTF INTO REG 13JJ 76720000
         OI    IJC33B&X.(IJC14B&X),IJC34B&X SET PRINT SWITCH         JJ 76760000
.MF112A  AIF   (K'&FUNC GT 1).MF200                                  JJ 76800000
         AIF   ('&WKIO' EQ 'Z').MF113                                JJ 76840000
         TM    IJC02C&X,IJC30B&X        TEST FOR DEVICE END          JJ 76880000
         BO    *+6                                                   JJ 76920000
         SVC   7                        WAIT FOR DEVICE END          JJ 76960000
.MF113   ANOP                                                  @DA08282 77000000
         LA    IJC14B&X,IJC13C&X        ADDRESS OF SSELECT CCW @DA08282 77040000
         ST    IJC14B&X,IJC03C&X        INTO CCB               @DA08282 77080000
         AIF   (T'&WORKA NE 'O' OR '&RECF' NE 'F').MF200       @DA08282 77120000
         AIF   ('&CNTL' EQ 'Y' OR '&CNTL' EQ 'A').MF200              JJ 77160000
         AIF   ('&WKIO' EQ 'B' OR '&WKIO' EQ 'I').MF200              JJ 77200000
         AIF   ('&FUNC' NE 'I').MF114                                JJ 77240000
.MF200   ANOP                                                        JJ 77280000
&REG     SETA  14                                                    JJ 77320000
         AIF   (T'&WORKA EQ 'O').MF201                               JJ 77360000
&REG     SETA  13                                                    JJ 77400000
         LR    IJC13B&X,IJC00B&X        GET ADDR OF WORKA INTO REG 13JJ 77440000
.MF201   L     IJC14B&X,IJC07C&X        ADDR OF IOAREA1 INTO REG 14  JJ 77480000
         AIF   ('&RECF' EQ 'V').MF201A                               JJ 77520000
         AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'Y').MF204             JJ 77560000
         BCTR  IJC14B&X,0               ADJUST IOAREA1 ADDR          JJ 77600000
         AGO   .MF204                                                JJ 77640000
.MF201A  SH    IJC14B&X,IJC38C&X        ADJUST IOAREA1 ADDR          JJ 77680000
         MVC   IJC08C&X.(2),0(&REG)     BLKSIZE INTO                 JJ 77720000
         LH    IJC12B&X,IJC08C&X        REG 12                       JJ 77760000
&OFFS    SETA  4                                                     JJ 77800000
.MF204   AIF   ('&CNTL' NE 'A' AND '&CNTL' NE 'Y').MF208             JJ 77840000
         AIF   ('&CNTL' EQ 'A').MF205                                JJ 77880000
         MVC   IJC13C&X.(1),&OFFS.(&REG) CONTROL COMMAND INTO CCW    JJ 77920000
         AGO   .MF206A                                               JJ 77960000
.MF205   IC    IJC13B&X,&OFFS.(&REG)    ASA CHAR INTO REG 13         JJ 78000000
         SH    IJC13B&X,IJC39C&X        GET STACKER NUMBER           JJ 78040000
         SLA   IJC13B&X,4(0)            SHIFT STACKER NUMBER         JJ 78080000
         STC   IJC13B&X,IJC06C&X        SS NUMBER INTO ACTUAL CCC    JJ 78120000
         NI    IJC13C&X,IJC40B&X        CLEAR CCW COMMAND CODE       JJ 78160000
         OC    IJC13C&X.(1),IJC06C&X    SS NUMBER INTO CCW           JJ 78200000
.MF206   AIF   (T'&WORKA EQ 'O').MF206A                              JJ 78240000
         LR    IJC13B&X,IJC00B&X        GET ADDR OF WORKA INTO REG 13JJ 78280000
.MF206A  ANOP                                                        JJ 78320000
&OFFS    SETA  &OFFS+1                                               JJ 78360000
.MF208   AIF   (T'&WORKA EQ 'O').MF210                               JJ 78400000
         AIF   ('&RECF' NE 'F').MF209                                JJ 78440000
         AIF   ('&CNTL' EQ 'A' OR '&CNTL' EQ 'Y').MF209A             JJ 78480000
.MF209   BCTR  IJC12B&X,0               PREPARE MOVE TO IOAREA       JJ 78520000
.MF209A  EX    12,IJC41C&X              WORKA INTO IOAREA1           JJ 78560000
.MF210   AIF   ('&RECF' EQ 'F').MF211                                JJ 78600000
         AIF   (T'&WORKA EQ 'O').MF210B                              JJ 78640000
         AIF   (&OFFS EQ 1).MF210A                                   JJ 78680000
         LA    IJC12B&X,1(IJC12B&X)     GET CORRECT RECORD LENGTH    JJ 78720000
         AIF   (&OFFS EQ 0).MF210A                                   JJ 78760000
         SH    IJC12B&X,IJC38C&X        DATA LENGTH INTO             JJ 78800000
         AGO   .MF210A                                               JJ 78840000
.MF210B  AIF   (&OFFS EQ 0).MF210A                                   JJ 78880000
         AIF   (&OFFS EQ 1).MF210C                                   JJ 78920000
         SH    IJC12B&X,IJC38C&X        DATA LENGTH INTO             JJ 78960000
         AGO   .MF210A                                               JJ 79000000
.MF210C  BCTR  IJC12B&X,0                                            JJ 79040000
.MF210A  STH   IJC12B&X,IJC16C&X        BYTE COUNT IN CCW            JJ 79080000
.MF211   AIF   (T'&FUNC NE 'O' AND K'&FUNC NE 1).MF114               JJ 79120000
         AIF   ('&WKIO' EQ 'W' OR '&WKIO' EQ 'Z').MF114              JJ 79160000
         L     IJC14B&X,IJC15C&X                                     JJ 79200000
         MVC   IJC15C&X+1(3),IJC07C&X+1 EXCHANGE IOAREA ADDRESSES    JJ 79240000
         ST    IJC14B&X,IJC07C&X        DITO                         JJ 79280000
.MF114   AIF   ('&CNTL' NE 'C').MF115                                JJ 79320000
         MVC   IJC13C&X.(1),IJC06C&X    ACTUAL CONTROL CODE TO CCW   JJ 79360000
         MVC   IJC06C&X.(1),IJC05C&X    NORMAL TO ACTUAL CCC         JJ 79400000
.MF115   AIF   (K'&FUNC LE 1).MF117 SIMPLE FILE                      JJ 79440000
         AIF   ('&RECF' NE 'F').MF115B                               JJ 79480000
         AIF   (&OFFS EQ 0 AND T'&WORKA NE 'O').MF115C               JJ 79520000
.MF115B  BCTR  IJC12B&X,0               PREPARE EX INSTR             JJ 79560000
.MF115C  EX    IJC12B&X,IJC42C&X        IOAREA INTO DTF BUFFER       JJ 79600000
         AIF   ('&FUNC' EQ 'PW').MF118                               JJ 79640000
         OI    IJC14C&X,IJC32B&X        SET CHAIN BIT IN SS CCW      JJ 79680000
         EX    IJC12B&X,IJC43C&X        TEST FOR BLANK BUFFER        JJ 79720000
         BNE   IJC50C&X                 NOT BLANK                    JJ 79760000
         XI    IJC14C&X,IJC32B&X        SET CHAIN BIT IN SS CCW OFF  JJ 79800000
IJC50C&X EQU   *                                                     JJ 79840000
         AIF   ('&FUNC' NE 'RP').MF118                               JJ 79880000
.MF116   SVC   0                        PUNCH CARD                   JJ 79920000
         L     IJC01B&X,IJC17C&X        ADDR OF READ DTF INTO REG 1  JJ 79960000
         SVC   0                        READ NEXT CARD INTO DTF BUFFEJJ 80000000
         AGO   .MF118                                                JJ 80040000
.MF117   AIF   ('&FUNC' NE 'I' OR '&CD' NE '2560').MF117A            JJ 80080000
         MVC   IJC25C&X+48(16),64+&OFFS.(IJC14B&X) GET SECOND LINE   JJ 80120000
.MF117A  SVC   0                        PUNCH CARD                   JJ 80160000
         AIF   ('&WKIO' NE 'Z').MF118                                JJ 80200000
         TM    IJC02C&X,IJC30B&X        TEST DEVICE END              JJ 80240000
         BO    *+6                                                   JJ 80280000
         SVC   7                        WAIT FOR DEVICE END          JJ 80320000
.MF118   ANOP                                                        JJ 80360000
IJC35C&X EQU   *                                                     JJ 80400000
         AIF   ('&FUNC' NE 'P' AND T'&FUNC NE 'O').MF118A            JJ 80440000
         TM    IJC26C&X,IJC29B&X        ERROPT SPECIFIED             JJ 80480000
         BZ    IJC96C&X                 NO                           JJ 80520000
         TM    IJC02C&X+1,IJC28B&X      HAS ERROR OCCURRED           JJ 80560000
         BZ    IJC96C&X                 NO                           JJ 80600000
         L     IJC01B&X,IJC07C&X        ADDR OF ERROR RECORD         JJ*80640000
                                        INTO REG 1                   JJ 80680000
IJC96C&X EQU   *                                                     JJ 80720000
.MF118A  ANOP                                                        JJ 80760000
         AIF   ('&WKIO' NE 'Z').MF120                                JJ 80800000
         AIF   ('&RECF' NE 'F').MF120                                JJ 80840000
         AIF   ('&CNTL' EQ 'A' OR '&CNTL' EQ 'Y').MF120              JJ 80880000
         AIF   (T'&FUNC NE 'O' AND K'&FUNC NE 1).MF120               JJ 80920000
         AIF   (T'&RDONLY EQ 'O').MF119                              JJ 80960000
         L     IJC14B&X,0(IJC13B&X)          RESTORE RETURN ADDR     JJ 81000000
         AGO   .MF122                                                JJ 81040000
.MF119   L     IJC14B&X,IJC37C&X             RESTORE RETURN ADDR     JJ 81080000
         AGO   .MF122                                                JJ 81120000
.MF120   AIF   ('&WKIO' EQ 'I').MF121A                               JJ 81160000
         AIF   (T'&RDONLY EQ 'O').MF121                              JJ 81200000
         LM    IJC11B&X,IJC14B&X,0(IJC11B&X) RESTORE REG'S 11-14     JJ 81240000
         AGO   .MF122                                                JJ 81280000
.MF121   LM    IJC12B&X,IJC14B&X,IJC37C&X    RESTORE REG'S 12-14     JJ 81320000
         AGO   .MF122                                                JJ 81360000
.MF121A  AIF   (T'&RDONLY EQ 'O').MF121B                             JJ 81400000
         LM    IJC11B&X,IJC13B&X,0(IJC11B&X) RESTORE REG'S 11-13     JJ 81440000
         AIF   ('&RECF' EQ 'V').MF121AA                              JJ 81480000
         AIF   ('&CNTL' NE 'Y' AND '&CNTL' NE 'A').MF121AX           JJ 81520000
         BCTR  IJC14B&X,0    ADJUST IOAREA ADDRESS                   JJ 81560000
         AGO   .MF121AX                                              JJ 81600000
.MF121AA SH    IJC14B&X,IJC38C&X   ADJUST IOAREA ADDRESS             JJ 81640000
.MF121AX ANOP                                                        JJ 81680000
         EX    0,IJC10C&X               LOAD USER'S IOREG            JJ 81720000
         L     IJC14B&X,12(IJC13B&X)    GET RETURN ADDRESS           JJ 81760000
         AGO   .MF122                                                JJ 81800000
.MF121B  LM    IJC12B&X,IJC13B&X,IJC37C&X RESTORE REG 12,13          JJ 81840000
         AIF   ('&RECF' EQ 'V').MF121BB                              JJ 81880000
         AIF   ('&CNTL' NE 'Y' AND '&CNTL' NE 'A').MF121BX           JJ 81920000
         BCTR  IJC14B&X,0    ADJUST IOAREA ADDRESS                   JJ 81960000
         AGO   .MF121BX                                              JJ 82000000
.MF121BB SH    IJC14B&X,IJC38C&X   ADJUST IOAREA ADDRESS             JJ 82040000
.MF121BX ANOP                                                        JJ 82080000
         EX    0,IJC10C&X               LOAD USER'S IOREG            JJ 82120000
         L     IJC14B&X,IJC37C&X+8      RESTORE RETURN ADDR          JJ 82160000
.MF122   ANOP                                                        JJ 82200000
IJC36C&X EQU   *                                                     JJ 82240000
         BR    IJC14B&X                                              JJ 82280000
         AIF   (T'&RDONLY NE 'O').MF124                              JJ 82320000
IJC37C&X DS    0F                            REGISTER SAVE AREA      JJ 82360000
         AIF   (K'&FUNC GT 1).MF123                                  JJ 82400000
         AIF   (T'&IOAREA2 NE 'O' OR T'&WORKA NE 'O').MF123          JJ 82440000
         AIF   ('&RECF' NE 'F').MF123                                JJ 82480000
         AIF   ('&CNTL' EQ 'A' OR '&CNTL' EQ 'Y').MF123              JJ 82520000
         DC    F'0'                                                  JJ 82560000
         AGO   .MF124                                                JJ 82600000
.MF123   DC    3F'0'                                                 JJ 82640000
.MF124   ANOP                                                        JJ 82680000
         AIF   ('&RECFM2' NE 'VARUNB').MF124A                  @D14BDBF 82720000
IJC38C&X DC    H'&OFFS'                 OFFSET OF DATA IN RECORD     JJ 82760000
.MF124A  AIF   ('&CNTL' NE 'A').MF124B                               JJ 82800000
IJC39C&X DC    Y(X'E4')                                              JJ 82840000
.MF124B  AIF   ('&CNTL' NE 'C').MF126                                JJ 82880000
IJC40C&X SRA   IJC00B&X,IJC02B&X.(IJC00B&X) SHIFT STACKER NUMBER     JJ 82920000
         AH    IJC00B&X,IJC51C&X   ADJUST STACKER NUMBER             JJ 82960000
         NI    IJC06C&X,IJC36B&X        CLEAR ACTUAL CONTROL CODE    JJ 83000000
         O     IJC00B&X,IJC27C&X                                     JJ 83040000
         STC   IJC00B&X,IJC06C&X        GET NEW CONTROL COMMAND      JJ 83080000
.MF125   BR    IJC14B&X                 RETURN TO USER               JJ 83120000
IJC51C&X DC    Y(X'10')                                              JJ 83160000
IJC02B&X EQU   2                        SHIFT OF SS NUMBER           JJ 83200000
IJC36B&X EQU   X'83'                                                 JJ 83240000
.MF126   AIF   (T'&WORKA EQ 'O').MF126A                              JJ 83280000
IJC41C&X MVC   0(0,14),0(13)            CONTENTS OF WORKA INTO IOAREAJJ 83320000
.MF126A  AIF   (T'&FUNC EQ 'O' OR K'&FUNC EQ 1).MF126B               JJ 83360000
IJC42C&X MVC   IJC21C&X.(0),&OFFS.(14)  IOAREA INTO DTF BUFFER       JJ 83400000
         AIF   ('&FUNC' EQ 'PW').MF126B                              JJ 83440000
IJC43C&X CLC   IJC20C&X.(0),IJC21C&X    TEST FOR BLANK BUFFER        JJ 83480000
.MF126B  ANOP                                                        JJ 83520000
IJC00B&X EQU   0                                                     JJ 83560000
IJC01B&X EQU   1                                                     JJ 83600000
IJC11B&X EQU   11                                                    JJ 83640000
IJC12B&X EQU   12                                                    JJ 83680000
IJC13B&X EQU   13                                                    JJ 83720000
IJC14B&X EQU   14                                                    JJ 83760000
IJC28B&X EQU   X'10'     DATA OR EQUIPM. CHECK SW IN CCB             JJ 83800000
IJC29B&X EQU   X'40'     ERROPT SWITCH                               JJ 83840000
IJC30B&X EQU   X'80' OPEN SWITCH,TRAFFIC BIT IN CCB,HOPPER BIT IN CCCJJ 83880000
IJC31B&X EQU   X'10' SEQUENCE CONTROL (ON BY GET, OFF BY PUT)        JJ 83920000
IJC32B&X EQU   X'40' FIRST TIME, CCW CHAINING SWITCH                 JJ 83960000
IJC33B&X EQU   X'2C' OFFSET OF PRINT SWITCH IN PRINT DTF             JJ 84000000
IJC34B&X EQU   X'20' PRINT SWITCH (ON: PR ALLOWED,                   JJ 84040000
*                                  OFF: PR DISALLOWED)               JJ 84080000
IJC35B&X EQU   X'20'                    IGNORE BIT             @DA08769 84120000
IJC40B&X EQU   X'83'                    MASK TO CLEAR CCW COMMAND    JJ 84160000
.MF180   AIF   (T'&SEPASMB NE 'O').MF181                             JJ 84200000
&SYSECT  CSECT                                                       JJ 84240000
.MF181   MEND                                                        JJ 84280000
