*%GOTO PLSACCCB;                      /* BEGIN OF PLS COMMENT           00040000
         MACRO                                                          00080000
&LABEL1  LBRACCCB &MF=,                                                X00120000
               &AREA=,                                                 X00160000
               &LAMB=,                                                 X00200000
               &LIBTYPE=,                                              X00240000
               &LIBUSE=,                                               X00280000
               &CHAINID=,                                              X00320000
               &LIBINFO=,                                              X00360000
               &CHAIN=,                                                X00400000
               &FILENAM=,                                              X00440000
               &SUBLIB=,                                               X00480000
               &DEFINE=,                                               X00520000
               &REPLACE=,                                              X00560000
               &LEVEL=,                                                X00600000
               &DEFAULT=,                                              X00640000
               &CONTROL=,                                              X00680000
               &LOCKOPT=,                                              X00720000
               &KEEP=,                                                 X00736001
               &PID=,                                                  X00752001
               &WAREA=,                                                X00768001
               &LEN=                                                    00784001
.*                                                                      00800000
.*                                                                      00840000
         GBLB  &LBRACMP            CONTROL GENERATION OF DSECTS         00880000
         GBLC  &FC                 FUNCTION CODE PASSED BY LBRACCES     00920000
         GBLB  &SYNERR             SYNTAX ERROR IN LBRACCES OR LBRACCCB 00960000
         GBLB  &INNER              LBRACCCB CALLED AS INNER MACRO       01000000
         GBLA  &LBR0SCO            CONTROL GENERATION OF SYSCOM DSECT   01040000
         LCLC  &REG                PREPARE STRING FOR ST INSTRUCTION    01080000
         LCLC  &DTLLABL            LABEL FOR DTL MACRO                  01120000
         LCLC  &PARM               PREPARE PARAMETERS FOR DTL MACRO     01160000
         LCLB  &SYNER1             SYNTAX ERROR IN LBRACCCB             01200000
         LCLB  &REGERR             REGISTER NOTATION INVALID            01240000
         LCLB  &CNTERR             ONLY CONSTANT ALLOWED       @D52EDUT 01260001
         LCLA  &K1                 TEMPORARY COUNT FIELD                01280000
         LCLA  &K2                 TEMPORARY COUNT FIELD       @D52EDUT 01300001
         LCLA  &K1LCK              TEMPORARY COUNT FIELD                01320000
.*                                                                      01360000
.*                                                                      01400000
.* IBM DISK OPERATING SYSTEM                                            01440000
.*                                                                      01480000
         AIF   (&INNER).NOCOM                                           01520000
         SPACE                                                          01560000
*  LIBRARIAN - LBRACCCB - 5666-301-06-H07  VERSION 85-04-09             01600000
         SPACE                                                          01640000
.NOCOM   ANOP                                                           01680000
.*                                                                      01720000
.*                                                                      01760000
.*************************************************************          01800000
.*        5666-301 COPYRIGHT IBM CORP 1979,1985              *          01840000
.*        LICENSED MATERIAL - PROGRAM PROPERTY OF IBM        *          01880000
.*        REFER TO COPYRIGHT INSTRUCTIONS                    *          01920000
.*                 FORM NUMBER G120-2083                     *          01960000
.*************************************************************          02000000
.*                                                                      02040000
.* A000000-999999                                              @D36JDKG 02080000
.*                                                                      02120000
         AGO   .ENDPCP                                                  02160000
*/*   MODULE LBRACCCB - LIBRARIAN MACRO LBRACCCB                        02200000
*/**                                                                    02240000
*/****  START OF SPECIFICATIONS  *************************************/ 02280000
*/**                                                                    02320000
*/**  MACRO NAME:  LBRACCCB                                             02360000
*/**                                                                    02400000
*/**  MACRO TYPE:  EXTERNAL LIBRARIAN MACRO, BILINGUAL                  02440000
*/**                                                                    02480000
*/**  DESCRIPTIVE NAME:  MACRO FOR HIGH LEVEL ACCESS CONTROL BLOCK      02520000
*/**                                                                    02560000
*/**  SYNTAX OF MACRO:                                                  02600000
*/**                                                                    02640000
*/**     ASSEMBLER:                                                     02680000
*/**                                                                    02720000
*/** <LABEL> LBRACCCB MF = DCL | GEN | MOD | MAP                        02760000
*/**                  <,AREA = NAME | (R)>                              02800000
*/**                  <,LIBTYPE = PHASE|OBJ|SOURCE|PROC|SPHASE|SOBJ|    02840000
*/**                              SSOURCE|SPROC|LBR|DUMP>               02880000
*/**                  <,LIBUSE = SEARCH | TO | FROM | ACCESS | CATALOG  02920000
*/**                             | USER>                                02960000
*/**                  <,CHAINID = NAME | (R)>                           03000000
*/**                  <,LIBINFO = NAME | (R)>                           03040000
*/**                  <,CHAIN = TEMP | PERM | BOTH>                     03080000
*/**                  <,LAMB = NAME | (R)>                              03120000
*/**                  <,FILENAM = NAME | (R)>                           03160000
*/**                  <,SUBLIB = NAME | (R)>                            03200000
*/**                  <,DEFINE = OLD | NEW | DUMMY>                     03240000
*/**                  <,REPLACE = YES | NO>                             03280000
*/**                  <,LEVEL = LIB | SUBLIB | BOTH>                    03320000
*/**                  <,DEFAULT = YES | NO>                             03360000
*/**                  <,CONTROL = S | E>                                03400000
*/**                  <,LOCKOPT = 1 | 2>                                03440000
*/**                  <,KEEP = YES | NO>                                03480000
*/**                  <,PID = NAME | (R)>                      @D52EDUT 03490001
*/**                  <,WAREA = NAME | (R)>                    @D52EDUT 03500001
*/**                  <,LEN = NAME | (R)>                      @D52EDUT 03510001
*/**                                                                    03520000
*/**                                                                    03560000
*/**     PLS2:                                                          03600000
*/**                                                                    03640000
*/** ? <LABEL:> LBRACCCB MF(DCL | GEN | MOD | MAP)                      03680000
*/**                    <AREA(NAME | (R))>                              03720000
*/**                    <LIBTYPE(PHASE|OBJ|SOURCE|PROC|SPHASE|SOBJ|     03760000
*/**                             SSOURCE|SPROC|LBR|DUMP)>               03800000
*/**                    <LIBUSE(SEARCH | TO | FROM | ACCESS | CATALOG   03840000
*/**                            | USER)>                                03880000
*/**                    <CHAINID(NAME | (R))>                           03920000
*/**                    <LIBINFO(NAME | (R))>                           03960000
*/**                    <CHAIN(TEMP | PERM | BOTH)>                     04000000
*/**                    <LAMB(NAME | (R))>                              04040000
*/**                    <FILENAM(NAME | (R))>                           04080000
*/**                    <SUBLIB(NAME | (R))>                            04120000
*/**                    <DEFINE(OLD | NEW | DUMMY)>                     04160000
*/**                    <REPLACE(YES | NO)>                             04200000
*/**                    <LEVEL(LIB | SUBLIB | BOTH)>                    04240000
*/**                    <DEFAULT(YES | NO)>                             04280000
*/**                    <CONTROL(S | E)>                                04320000
*/**                    <LOCKOPT(1 | 2)>                                04360000
*/**                    <KEEP(YES | NO)>                                04400000
*/**                    <PID(NAME | (R))>                     @D52EDUT  04410001
*/**                    <WAREA(NAME | (R))>                   @D52EDUT  04420001
*/**                    <LEN(NAME | (R))>                     @D52EDUT  04430001
*/**                     ;                                              04440000
*/*   EJECT                                                             04480000
*/**  INPUT:    SPECIFICATION OF MACRO                                  04520000
*/**                                                                    04560000
*/**  OUTPUT:   FOR MF = DCL                                            04600000
*/**            THE CONTROL BLOCK IS DEFINED INLINE AND THE             04640000
*/**            THE SPECIFIED PARAMETERS ARE FILLED IN.                 04680000
*/**            NON-SPECIFIED PARAMETERS ARE CLEARED.                   04720000
*/**                                                                    04760000
*/**            FOR MF = GEN                                            04800000
*/**            THE SPECIFIED PARAMETERS ARE FILLED INTO                04840000
*/**            THE CONTROL BLOCK DEFINED BY 'AREA'.                    04880000
*/**            NON-SPECIFIED PARAMETERS ARE CLEARED.                   04920000
*/**                                                                    04960000
*/**            FOR MF = MOD                                            05000000
*/**            THE SPECIFIED PARAMETERS ARE FILLED INTO                05040000
*/**            THE CONTROL BLOCK DEFINED BY 'AREA'.                    05080000
*/**            NON-SPECIFIED PARAMETERS REMAIN UNCHANGED.              05120000
*/**                                                                    05160000
*/**            FOR MF = MAP                                            05200000
*/**            ON THE FIRST CALL OF A LBRACCES OR A                    05240000
*/**            LBRACCCB MACRO IN A MODULE THE FOLLOWING                05280000
*/**            MAPS ARE PROVIDED WITH THE INDICATED NAMES:             05320000
*/**                                                                    05360000
*/**              SYSCOM     SYSTEM COMMUNICATION REGION                05400000
*/**              INLCLPT    LIBRARY POINTER TABLE                      05440000
*/**              INLCLOT    LIBRARY OFFSET TABLE                       05480000
*/**              LOTENTR    LIBRARY OFFSET TABLE ENTRY                 05520000
*/**              INLCLDTE   LIBRARY DEFINITION TABLE                   05560000
*/**              INLCSDTE   SUBLIB  DEFINITION TABLE                   05600000
*/**              LBRACCDS   LIBRARY ACCESS CONTROL BLOCK               05640000
*/**                                                                    05680000
*/**            FOR PLS  A MAP OF THE LOCK TABLE ENTRY WITH             05720000
*/**            NAME DTLADR IS GENERATED AS WELL.                       05760000
*/**                                                                    05800000
*/**            OTHERWISE, NO OUTPUT WILL BE GENERATED.                 05840000
*/**                                                                    05880000
*/**  FUNCTION:                                                         05920000
*/**                                                                    05960000
*/**                                                                    06000000
*/**  THE CONTROL BLOCK FOR THE LBRACCES MACRO AND A LOCK               06040000
*/**  TABLE ENTRY ARE DEFINED AND FILLED UP WITH THE SPECIFIED          06080000
*/**  PARAMETERS.                                                       06120000
*/***                                                                   06160000
*/**  REGISTER USAGE FOR LBRACCCB MACRO (ONLY FOR MF=GEN|MOD):          06200000
*/**                                                                    06240000
*/**    REG  0   USED FOR CONTROL BLOCK MODIFICATION                    06280000
*/**    REG  1   USED TO ADDRESS THE CONTROL BLOCK                      06320000
*/**    REG 14   USED FOR CONTROL BLOCK MODIFICATION                    06360000
*/**    REG 15   USED FOR CONTROL BLOCK MODIFICATION                    06400000
*/**                                                                    06440000
*/**    REGISTER 0, 1 AND 15 ARE ALSO USED BY MACROS GENDTL|MODDTL      06480000
*/**                                                                    06520000
*/**  RETURN CODES FROM LANGUAGE PROCESSOR:                             06560000
*/**     0       MACRO EXPANSION SUCCESSFUL                             06600000
*/**     4       PARAMETERS HAVE BEEN IGNORED DUE TO CONFLICTS          06640000
*/**     8       INVALID PARAMETERS SPECIFIED                           06680000
*/**                                                                    06720000
*/**  NOTES:                                                            06760000
*/**                                                                    06800000
*/**     CHANGE ACTIVITIES:                                             06840000
*/**                                                                    06880000
*/**        SUPPORT OF LIBRARY CONCATENATION                            06920000
*/**        SUPPORT OF VSE/AF 2.1 LIBRARIAN                   @D14LDFB  06960000
*/**        VSAM-EXTENSION OF SHARED LIBRARY                  @D21SDFB  07000000
*/**        LIBR API EXTENSION                                @D51IDJS  07013301
*/**        EXTENSION FOR LBRACCES LIBTYPE(ALL) ESA 1.3       @D52EDUT  07026601
*/**                                                                    07040000
*/**        DY35004 INCLUDES CAF-CODE @D21SDFB.               @DY35004  07080000
*/**        PREPARE FOR MSHP PLS3 TO PLX CONVERSION           @D66GDMK  07090001
*/**                                                                    07120000
*/**     <...> DENOTES, THAT THIS PARAMETER IS OPTIONAL.                07160000
*/**                                                                    07200000
*/****  END OF SPECIFICATIONS  ***************************************/ 07240000
*/*   EJECT                                                             07280000
*/**  PARAMETER DESCRIPTION:                                            07320000
*/**                                                                    07360000
*/**    MF       SPECIFIES THE MAIN FUNCTION TO BE EXECUTED:            07400000
*/**               DCL    DEFINES THE STORAGE FOR THE CONTROL           07440000
*/**                      BLOCK AND THE LOCK TABLE ENTRY AND            07480000
*/**                      SETS UP INFORMATION IN IT AS SPECIFIED        07520000
*/**                      BY THE OTHER PARAMETERS.(STATIC ALLOCATION,   07560000
*/**                      I.E. INLINE CONTROL BLOCK GENERATION)         07600000
*/**                      NON-SPECIFIED PARAMETERS ARE CLEARED.         07640000
*/**                      REGISTER NOTATION IS NOT ALLOWED              07680000
*/**                      FOR MF=DCL. A LABEL IS REQUIRED FOR           07720000
*/**                      FOR MF=DCL. AREA IS IGNORED FOR MF=DCL.       07760000
*/**               GEN    GENERATES THE CONTROL BLOCK AND THE           07800000
*/**                      LOCK TABLE ENTRY IN THE SPECIFIED AREA        07840000
*/**                      AND SETS UP INFORMATION AS SPECIFIED BY       07880000
*/**                      THE OTHER PARAMETERS.(DYNAMIC ALLOCATION,     07920000
*/**                      I.E. STORAGE ADDRESSED BY AREA IS             07960000
*/**                      FILLED UP WITH THE SPECIFIED PARA-            08000000
*/**                      METERS). NON-SPECIFIED PARAMETERS             08040000
*/**                      ARE CLEARED.                                  08080000
*/**               MOD    MODIFIES THE CONTROL BLOCK IN THE             08120000
*/**                      SPECIFIED AREA AND SETS UP INFOR-             08160000
*/**                      MATION AS SPECIFIED BY THE OTHER              08200000
*/**                      PARAMETERS.(DYNAMIC ALLOCATION,               08240000
*/**                      I.E. STORAGE ADDRESSED BY AREA IS             08280000
*/**                      FILLED UP WITH THE SPECIFIED PARA-            08320000
*/**                      METERS). NON SPECIFIED PARAMETERS             08360000
*/**                      REMAIN UNCHANGED.                             08400000
*/**               MAP    PROVIDES THE ABOVE SPECIFIED MAPS,            08440000
*/**                      UNLESS THEY HAVE BEEN GENERATED BY            08480000
*/**                      A PREVIOUS LBRACCCB OR LBRACCES               08520000
*/**                      MACRO IN THE MODULE.                          08560000
*/**                                                                    08600000
*/**    FOR A DESCRIPTION OF ALL OTHER PARAMETERS SEE MACRO LBRACCES.   08640000
*/*  SPACE 5                                                            08680000
*/** VALID PARAMETERS FOR 'MF=DCL':                                     08720000
*/**      LIBTYPE                   (* = NO REGISTER NOTATION)          08760000
*/**      LIBUSE                                                        08800000
*/**      CHAINID  *                                                    08840000
*/**      LIBINFO  *                                                    08880000
*/**      CHAIN                                                         08920000
*/**      LAMB     *                                                    08960000
*/**      DEFAULT                                                       09000000
*/**      CONTROL                                                       09040000
*/**      LOCKOPT                                                       09080000
*/**      KEEP                                                          09120000
*/**      WAREA    *                                                    09133301
*/**      PID      *  ONLY CONSTANT ALLOWED                             09146601
*/**                                                                    09160000
*/** VALID PARAMETERS FOR 'MF=GEN|MOD':                                 09200000
*/**      AREA                                                          09240000
*/**      LIBTYPE                                                       09280000
*/**      LIBUSE                                                        09320000
*/**      CHAINID                                                       09360000
*/**      LIBINFO                                                       09400000
*/**      CHAIN                                                         09440000
*/**      LAMB                                                          09480000
*/**      FILENAM                                                       09520000
*/**      SUBLIB                                                        09560000
*/**      DEFINE                                                        09600000
*/**      REPLACE                                                       09640000
*/**      LEVEL                                                         09680000
*/**      DEFAULT                                                       09720000
*/**      CONTROL                                                       09760000
*/**      LOCKOPT                                                       09800000
*/**      KEEP                                                          09840000
*/**      WAREA                                                         09850001
*/**      LEN                                                           09860001
*/**      PID                                                           09870001
*/**                                                                    09880000
*/** VALID PARAMETERS FOR 'MF=MAP':                                     09920000
*/**      NONE                                                          09960000
*/*   EJECT                                                             10000000
.ENDPCP  ANOP                                                           10040000
.*                                                                      10080000
.*       DO NOT GENERATE ANY DSECTS OR EQUATES, IF &LBRACMP = 1         10120000
.*                                                                      10160000
         AIF   (&LBRACMP).NOCOPY                                        10200000
.*                                                                      10240000
.*       DO NOT GENERATE DSECT FOR SYSCOM, IF &LBR0SCO = 1              10280000
.*                                                                      10320000
         AIF   (&LBR0SCO NE 0).NOSYSCO                                  10360000
SYSCOM   SYSCOM                    DSECT FOR SYSCOM                     10400000
&LBR0SCO SETA  1                                                        10440000
         EJECT                                                          10480000
.NOSYSCO ANOP                                                           10520000
         INLCLPT DSECT=YES,        DSECT FOR                           X10560000
               TABLE=YES,            LIBRARY POINTER TABLE AND         X10600000
               ROW=YES,              LIBRARY POINTER TABLE ROW         X10640000
               FCODE=YES             FUNCTION CODES                     10680000
         EJECT                                                          10720000
         INLCLOT DSECT=YES,        DSECT FOR                           X10760000
               TABLE=YES,            LIBRARY OFFSET TABLE AND          X10800000
               ENTRY=YES             LIBRARY OFFSET TABLE ENTRY         10840000
         EJECT                                                          10880000
         INLCLDTE DSECT=YES        DSECT FOR LIBRARY DEFINITION TAB     10920000
         EJECT                                                          10960000
         INLCSDTE DSECT=YES        DSECT FOR SUBLIB  DEFINITION TAB     11000000
         EJECT                                                          11040000
         LBRACCDS                  DSECT FOR CONTROL BLOCK              11080000
         EJECT                                                          11120000
&LBRACMP SETB  1                   DO NOT GENERATE MAPS FOR NEXT CALL   11160000
&SYSECT  CSECT                     RESUME CSECT                         11200000
.NOCOPY  ANOP                                                           11240000
         AIF   ('&MF' NE 'MAP').CHKPARM                                 11280000
.*                                                                      11320000
.*       FOR MF=MAP NO OTHER PARAMETERS ARE VALID                       11360000
.*                                                             @D14LDFB 11400000
&K1      SETA  (K'&AREA+K'&LIBTYPE+K'&LIBUSE+K'&LIBINFO+K'&CHAIN)       11440000
&K1      SETA  (&K1+K'&FILENAM+K'&LAMB+K'&CHAINID)             @D14LDFB 11480000
&K1      SETA  (&K1+K'&DEFAULT+K'&CONTROL+K'&REPLACE)          @D14LDFB 11520000
&K1      SETA  (&K1+K'&LOCKOPT+K'&KEEP+K'&SUBLIB+K'&DEFINE+K'&LEVEL)    11560000
&K1      SETA  (&K1+K'&PID+K'&WAREA+K'&LEN)                    @D52EDUT 11580001
         AIF   (&K1 EQ 0).TERM                                          11600000
         MNOTE 4,'ALL OTHER PARAMETERS IGNORED FOR MF=MAP'              11640000
.TERM    ANOP                                                           11680000
         MEXIT                                                          11720000
.*                                                                      11760000
.*       CHECK MAIN FUNCTION                                            11800000
.*                                                                      11840000
.CHKPARM ANOP                                                           11880000
         AIF   (T'&MF NE 'O').CHECKMF                                   11920000
         AIF   ('&MF' NE '').CHECKMF                                    11960000
         MNOTE 8,'MF IS NOT SPECIFIED, GENERATION SUPPRESSED'           12000000
.*       SYNTAX CHECK CONTINUES                                         12040000
&SYNER1  SETB  1                                                        12080000
         AGO   .VALMF                                                   12120000
.CHECKMF ANOP                                                           12160000
         AIF   ('&MF' EQ 'DCL').VALMF                                   12200000
         AIF   ('&MF' EQ 'GEN').VALMF                                   12240000
         AIF   ('&MF' EQ 'MOD').VALMF                                   12280000
         AIF   ('&MF' EQ 'MAP').VALMF                                   12320000
         MNOTE 8,'MF REQUEST IS INVALID, GENERATION SUPPRESSED'         12360000
.*       SYNTAX CHECK CONTINUES                                         12400000
&SYNER1  SETB  1                                                        12440000
.VALMF   ANOP                                                           12480000
.*                                                                      12520000
.*       CHECK LIBRARY TYPE                                             12560000
.*                                                                      12600000
         AIF   (T'&LIBTYPE EQ 'O').VALTYPE                              12640000
         AIF   ('&LIBTYPE' EQ '').VALTYPE                               12680000
         AIF   ('&LIBTYPE' EQ 'PHASE').VALTYPE                 @D14LDFB 12720000
         AIF   ('&LIBTYPE' EQ 'OBJ').VALTYPE                   @D14LDFB 12760000
         AIF   ('&LIBTYPE' EQ 'SOURCE').VALTYPE                @D14LDFB 12800000
         AIF   ('&LIBTYPE' EQ 'PROC').VALTYPE                  @D14LDFB 12840000
         AIF   ('&LIBTYPE' EQ 'SPHASE').VALTYPE                @D14LDFB 12880000
         AIF   ('&LIBTYPE' EQ 'SOBJ').VALTYPE                  @D14LDFB 12920000
         AIF   ('&LIBTYPE' EQ 'SSOURCE').VALTYPE               @D14LDFB 12960000
         AIF   ('&LIBTYPE' EQ 'SPROC').VALTYPE                 @D14LDFB 13000000
         AIF   ('&LIBTYPE' EQ 'LBR').VALTYPE                   @D14LDFB 13040000
         AIF   ('&LIBTYPE' EQ 'DUMP').VALTYPE                  @D14LDFB 13080000
         AIF   ('&LIBTYPE' EQ 'ALL').VALTYPE                   @D52EDUT 13100001
         MNOTE 8,'LIBTYPE REQUEST IS INVALID, GENERATION SUPPRESSED'    13120000
.*       SYNTAX CHECK CONTINUES                                         13160000
&SYNER1  SETB  1                                                        13200000
.VALTYPE ANOP                                                           13240000
.*                                                             @D52EDUT 13241101
.*       CHECK WORKAREA                                        @D52EDUT 13242201
.*                                                             @D52EDUT 13243301
         AIF   ('&LIBTYPE' NE 'ALL').VALWRK                    @D52EDUT 13244401
         AIF   (T'&WAREA  EQ 'O').ERRWRK                       @D52EDUT 13245501
         AIF   ('&WAREA' EQ '').ERRWRK                         @D52EDUT 13246601
         AIF   ('&MF' EQ 'DCL').VALWRK1                        @D52EDUT 13247701
         AIF   (T'&LEN  EQ 'O').ERRWRK                         @D52EDUT 13248801
         AIF   ('&LEN' EQ '').ERRWRK                           @D52EDUT 13249901
         AGO   .VALWRK1                                        @D52EDUT 13251001
.ERRWRK  ANOP                                                  @D52EDUT 13252101
    MNOTE 8,'WORKAREA OR LEN REQUEST IS INVALID, GENERATION SUPPRESSED' 13253201
.*       SYNTAX CHECK CONTINUES                                @D52EDUT 13254301
&SYNER1  SETB  1                                               @D52EDUT 13255401
.VALWRK1 ANOP                                                  @D52EDUT 13256501
.*                                                             @D52EDUT 13257601
.*       CHECK SPECIFICATION OF OTHER PARAMETERS               @D52EDUT 13258701
.*                                                             @D52EDUT 13259801
&K2      SETA  (K'&LIBUSE+K'&LIBINFO+K'&CHAIN)                 @D52EDUT 13260901
&K2      SETA  (&K2+K'&FILENAM+K'&LAMB+K'&CHAINID)             @D52EDUT 13262001
&K2      SETA  (&K2+K'&DEFAULT+K'&CONTROL+K'&REPLACE)          @D52EDUT 13263101
&K2      SETA  (&K2+K'&LOCKOPT+K'&KEEP+K'&SUBLIB+K'&DEFINE)    @D52EDUT 13264201
&K2      SETA  (&K2+K'&PID+K'&LEVEL)                           @D52EDUT 13265301
         AIF   (&K2 EQ 0).VALKEP                               @D52EDUT 13266401
         MNOTE 4,'INVALID PARAMETERS SPECIFIED FOR LIBTYPE = ALL'       13267501
&SYNER1  SETB  1                                               @D52EDUT 13268601
         AGO .VALKEP                                                    13269701
.VALWRK  ANOP                                                  @D52EDUT 13270801
&K2      SETA  (K'&WAREA+K'&LEN)                               @D52EDUT 13271901
         AIF   (&K2 EQ 0).VALPRM                               @D52EDUT 13273001
         MNOTE 4,'INVALID PARAMETERS SPECIFIED FOR LIBTYPE ¬= ALL'      13274101
&SYNER1  SETB  1                                               @D52EDUT 13275201
.VALPRM  ANOP                                                  @D52EDUT 13276301
.*                                                                      13280000
.*       CHECK LIBRARY USE                                              13320000
.*                                                                      13360000
         AIF   (T'&LIBUSE EQ 'O').VALUSE                                13400000
         AIF   ('&LIBUSE' EQ '').VALUSE                                 13440000
         AIF   ('&LIBUSE' EQ 'SEARCH').VALUSE                           13480000
         AIF   ('&LIBUSE' EQ 'TO').VALUSE                               13520000
         AIF   ('&LIBUSE' EQ 'FROM').VALUSE                             13560000
         AIF   ('&LIBUSE' EQ 'ACCESS').VALUSE                  @D14LDFB 13600000
         AIF   ('&LIBUSE' EQ 'CATALOG').VALUSE                 @D14LDFB 13640000
         AIF   ('&LIBUSE' EQ 'USER').VALCHID                   @D14LDFB 13680000
         MNOTE 8,'LIBUSE REQUEST IS INVALID, GENERATION SUPPRESSED'     13720000
.*       SYNTAX CHECK CONTINUES                                         13760000
&SYNER1  SETB  1                                                        13800000
         AGO   .VALUSE                                                  13840000
.VALCHID ANOP                                                  @D14LDFB 13880000
         AIF   (T'&CHAINID NE 'O').VALCHI1                     @D14LDFB 13920000
         MNOTE 8,'LIBUSE REQUEST IS INVALID, GENERATION SUPPRESSED'     13960000
.*       SYNTAX CHECK CONTINUES                                @D14LDFB 14000000
&SYNER1  SETB  1                                               @D14LDFB 14040000
         AGO   .VALUSE                                         @D14LDFB 14080000
.VALCHI1 ANOP                                                  @D14LDFB 14120000
         AIF   ('&CHAINID' NE '').VALUSE                       @D14LDFB 14160000
         MNOTE 8,'LIBUSE REQUEST IS INVALID, GENERATION SUPPRESSED'     14200000
.*       SYNTAX CHECK CONTINUES                                @D14LDFB 14240000
&SYNER1  SETB  1                                               @D14LDFB 14280000
.VALUSE  ANOP                                                           14320000
.*                                                                      14360000
.*       CHECK SEARCH ORDER                                             14400000
.*                                                                      14440000
         AIF   (T'&CHAIN EQ 'O').VALCHN                                 14480000
         AIF   ('&CHAIN' EQ '').VALCHN                                  14520000
         AIF   ('&CHAIN' EQ 'TEMP').VALCHN                              14560000
         AIF   ('&CHAIN' EQ 'PERM').VALCHN                              14600000
         AIF   ('&CHAIN' EQ 'BOTH').VALCHN                              14640000
         MNOTE 8,'CHAIN REQUEST IS INVALID, GENERATION SUPPRESSED'      14680000
.*       SYNTAX CHECK CONTINUES                                         14720000
&SYNER1  SETB  1                                                        14760000
.VALCHN  ANOP                                                           14800000
.*                                                             @D14LDFB 14840000
.*       CHECK DEFINE                                          @D14LDFB 14880000
.*                                                             @D14LDFB 14920000
         AIF   (T'&DEFINE  EQ 'O').VALDFN                      @D14LDFB 14960000
         AIF   ('&DEFINE'  EQ '').VALDFN                       @D14LDFB 15000000
         AIF   ('&DEFINE'  EQ 'OLD').VALDFN                    @D14LDFB 15040000
         AIF   ('&DEFINE'  EQ 'NEW').VALDFN                    @D14LDFB 15080000
         AIF   ('&DEFAULT' EQ 'DUMMY').VALDFN                  @D14LDFB 15120000
         MNOTE 8,'DEFINE  REQUEST IS INVALID, GENERATION SUPPRESSED'    15160000
.*       SYNTAX CHECK CONTINUES                                @D14LDFB 15200000
&SYNER1  SETB  1                                               @D14LDFB 15240000
.VALDFN  ANOP                                                  @D14LDFB 15280000
.*                                                             @D14LDFB 15320000
.*       CHECK REPLACE                                         @D14LDFB 15360000
.*                                                             @D14LDFB 15400000
         AIF   (T'&REPLACE EQ 'O').VALREP                      @D14LDFB 15440000
         AIF   ('&REPLACE' EQ '').VALREP                       @D14LDFB 15480000
         AIF   ('&REPLACE' EQ 'YES').VALREP                    @D14LDFB 15520000
         AIF   ('&REPLACE' EQ 'NO').VALREP                     @D14LDFB 15560000
         MNOTE 8,'REPLACE REQUEST IS INVALID, GENERATION SUPPRESSED'    15600000
.*       SYNTAX CHECK CONTINUES                                @D14LDFB 15640000
&SYNER1  SETB  1                                               @D14LDFB 15680000
.VALREP  ANOP                                                  @D14LDFB 15720000
.*                                                             @D14LDFB 15760000
.*       CHECK LEVEL                                           @D14LDFB 15800000
.*                                                             @D14LDFB 15840000
         AIF   (T'&LEVEL   EQ 'O').VALLEV                      @D14LDFB 15880000
         AIF   ('&LEVEL'   EQ '').VALLEV                       @D14LDFB 15920000
         AIF   ('&LEVEL'   EQ 'LIB').VALLEV                    @D14LDFB 15960000
         AIF   ('&LEVEL'   EQ 'SUBLIB').VALLEV                 @D14LDFB 16000000
         AIF   ('&LEVEL'   EQ 'BOTH').VALLEV                   @D14LDFB 16040000
         MNOTE 8,'LEVEL   REQUEST IS INVALID, GENERATION SUPPRESSED'    16080000
.*       SYNTAX CHECK CONTINUES                                @D14LDFB 16120000
&SYNER1  SETB  1                                               @D14LDFB 16160000
.VALLEV  ANOP                                                  @D14LDFB 16200000
.*                                                                      16240000
.*       CHECK DEFAULT                                                  16280000
.*                                                                      16320000
         AIF   (T'&DEFAULT EQ 'O').VALDEF                               16360000
         AIF   ('&DEFAULT' EQ '').VALDEF                                16400000
         AIF   ('&DEFAULT' EQ 'YES').VALDEF                             16440000
         AIF   ('&DEFAULT' EQ 'NO').VALDEF                              16480000
         MNOTE 8,'DEFAULT REQUEST IS INVALID, GENERATION SUPPRESSED'    16520000
.*       SYNTAX CHECK CONTINUES                                         16560000
&SYNER1  SETB  1                                                        16600000
.VALDEF  ANOP                                                           16640000
.*                                                                      16680000
.*       CHECK CONTROL                                                  16720000
.*                                                                      16760000
         AIF   (T'&CONTROL EQ 'O').VALCON                               16800000
         AIF   ('&CONTROL' EQ '').VALCON                                16840000
         AIF   ('&CONTROL' EQ 'S').VALCON                               16880000
         AIF   ('&CONTROL' EQ 'E').VALCON                               16920000
         MNOTE 8,'CONTROL REQUEST IS INVALID, GENERATION SUPPRESSED'    16960000
.*       SYNTAX CHECK CONTINUES                                         17000000
&SYNER1  SETB  1                                                        17040000
.VALCON  ANOP                                                           17080000
.*                                                                      17120000
.*       CHECK LOCKOPT                                                  17160000
.*                                                                      17200000
         AIF   (T'&LOCKOPT EQ 'O').VALSHR                               17240000
         AIF   ('&LOCKOPT' EQ '').VALSHR                                17280000
         AIF   ('&LOCKOPT' EQ '1').VALSHR                               17320000
         AIF   ('&LOCKOPT' EQ '2').VALSHR                               17360000
         MNOTE 8,'LOCKOPT REQUEST IS INVALID, GENERATION SUPPRESSED'    17400000
.*       SYNTAX CHECK CONTINUES                                         17440000
&SYNER1  SETB  1                                                        17480000
.VALSHR  ANOP                                                           17520000
.*                                                                      17560000
.*       CHECK KEEP                                                     17600000
.*                                                                      17640000
         AIF   (T'&KEEP EQ 'O').VALKEP                                  17680000
         AIF   ('&KEEP' EQ '').VALKEP                                   17720000
         AIF   ('&KEEP' EQ 'YES').VALKEP                                17760000
         AIF   ('&KEEP' EQ 'NO').VALKEP                                 17800000
         MNOTE 8,'KEEP REQUEST IS INVALID, GENERATION SUPPRESSED'       17840000
.*       SYNTAX CHECK CONTINUES                                         17880000
&SYNER1  SETB  1                                                        17920000
.VALKEP  ANOP                                                           17960000
.*                                                                      18000000
.*       CROSS CHECKING FOR MF=DCL: AREA AND REGISTER NOTATION INVALID  18040000
.*       FILENAM,SUBLIB,DEFINE,LEVEL,REPLACE,LEN IGNORED                18066601
.*       FOR PID ONLY CHARACTER CONSTANT ALLOWED                        18093201
.*                                                             @D14LDFB 18120000
.*                                                             @D52LDUT 18140001
.*       CHECK IF AREA IS SPECIFIED FOR MF=DCL                          18160000
.*                                                                      18200000
         AIF   ('&MF' NE 'DCL').CHKMDGN                                 18240000
         AIF   (T'&AREA EQ 'O').VALDCL                                  18280000
         AIF   ('&AREA' EQ '').VALDCL                                   18320000
         MNOTE 4,'AREA IGNORED FOR MF=DCL'                              18360000
.*       SYNTAX CHECK CONTINUES                                         18400000
.VALDCL  ANOP                                                           18440000
.*                                                                      18480000
.*       CHECK REGISTER NOTATION FOR LIBINFO                            18520000
.*                                                                      18560000
         AIF   (T'&LIBINFO EQ 'O').CHKRCID                              18600000
         AIF   ('&LIBINFO' EQ '').CHKRCID                               18640000
         AIF   ('&LIBINFO'(1,1) NE '(').CHKRCID                         18680000
&REGERR  SETB  1                                                        18720000
.CHKRCID ANOP                                                           18760000
.*                                                                      18800000
.*       CHECK REGISTER NOTATION FOR CHAINID                            18840000
.*                                                                      18880000
         AIF   (T'&CHAINID EQ 'O').CHKRLAM                              18920000
         AIF   ('&CHAINID' EQ '').CHKRLAM                               18960000
         AIF   ('&CHAINID'(1,1) NE '(').CHKRLAM                         19000000
&REGERR  SETB  1                                                        19040000
.CHKRLAM ANOP                                                           19080000
.*                                                                      19120000
.*       CHECK REGISTER NOTATION FOR LAMB                               19160000
.*                                                                      19200000
         AIF   (T'&LAMB EQ 'O').CHKRWAR                        @D14LDFB 19240001
         AIF   ('&LAMB' EQ '').CHKRWAR                         @D14LDFB 19280001
         AIF   ('&LAMB'(1,1) NE '(').CHKRWAR                   @D14LDFB 19320001
&REGERR  SETB  1                                               @D14LDFB 19360000
.CHKRWAR ANOP                                                           19361901
.*                                                                      19363801
.*       CHECK REGISTER NOTATION FOR WAREA                              19365701
.*                                                                      19367601
         AIF   (T'&WAREA EQ 'O').CHKRPD                        @D52EDUT 19369501
         AIF   ('&WAREA' EQ '').CHKRPD                         @D52EDUT 19371401
         AIF   ('&WAREA'(1,1) NE '(').CHKRPD                   @D52EDUT 19373301
&REGERR  SETB  1                                               @D52EDUT 19375201
.CHKRPD  ANOP                                                           19377101
.*                                                                      19379001
.*       CHECK REGISTER NOTATION FOR PID                                19380901
.*                                                                      19382801
         AIF   (T'&PID EQ 'O').CHKRDT                          @D52EDUT 19384701
         AIF   ('&PID' EQ '').CHKRDT                           @D52EDUT 19386601
         AIF   ('&PID'(1,1) NE '(').CHKRCN                     @D52EDUT 19388501
&CNTERR  SETB  1                                               @D52EDUT 19390401
.CHKRCN  ANOP                                                           19392301
         AIF   ('&PID'(1,1) EQ '''').CHKRDT                    @D52EDUT 19394201
         AIF   ('&PID'(1,4) EQ '''').CHKRDT                    @D52EDUT 19396101
&CNTERR  SETB  1                                               @D52EDUT 19398001
.CHKRDT  ANOP                                                           19400000
.NOREG   ANOP                                                           19440000
         AIF   (NOT &REGERR).NOCNT                             @D52EDUT 19480001
         MNOTE 8,'NO REGISTER NOTATION FOR MF=DCL, GENERATION SUPPRESSEX19520000
               D'                                                       19560000
&SYNER1  SETB  1                                                        19568001
.NOCNT   AIF   (NOT &CNTERR).CHKFILN                           @D52EDUT 19576001
         MNOTE 8,'ONLY CONSTANT PID ALLOWED FOR MF=DCL, GENERATION SUPPX19584001
               RESSED'                                         @D52EDUT 19592001
.*       SYNTAX CHECK CONTINUES                                         19600000
&SYNER1  SETB  1                                                        19640000
.CHKFILN ANOP                                                           19680000
         AIF   (T'&FILENAM EQ 'O').CHKSUBL                     @D14LDFB 19720000
         AIF   ('&FILENAM' EQ '').CHKSUBL                      @D14LDFB 19760000
         MNOTE 4,'FILENAM REQUEST IGNORED FOR MF=DCL'                   19800000
.CHKSUBL ANOP                                                  @D14LDFB 19840000
         AIF   (T'&SUBLIB EQ 'O').CHKDFNE                      @D14LDFB 19880000
         AIF   ('&SUBLIB' EQ '').CHKDFNE                       @D14LDFB 19920000
         MNOTE 4,'SUBLIB REQUEST IGNORED FOR MF=DCL'           @D14LDFB 19960000
.*       SYNTAX CHECK CONTINUES                                         20000000
.CHKDFNE ANOP                                                  @D14LDFB 20040000
         AIF   (T'&DEFINE EQ 'O').CHKREPL                      @D14LDFB 20080000
         AIF   ('&DEFINE' EQ '').CHKREPL                       @D14LDFB 20120000
         MNOTE 4,'DEFINE REQUEST IGNORED FOR MF=DCL'           @D14LDFB 20160000
.*       SYNTAX CHECK CONTINUES                                         20200000
.CHKREPL ANOP                                                  @D14LDFB 20240000
         AIF   (T'&REPLACE EQ 'O').CHKLEVL                     @D14LDFB 20280000
         AIF   ('&REPLACE' EQ '').CHKLEVL                      @D14LDFB 20320000
         MNOTE 4,'REPLACE REQUEST IGNORED FOR MF=DCL'          @D14LDFB 20360000
.*       SYNTAX CHECK CONTINUES                                         20400000
.CHKLEVL ANOP                                                  @D14LDFB 20440000
         AIF   (T'&LEVEL  EQ 'O').CHKLEN                       @D14LDFB 20480001
         AIF   ('&LEVEL'  EQ '').CHKLEN                        @D14LDFB 20520001
         MNOTE 4,'LEVEL  REQUEST IGNORED FOR MF=DCL'           @D14LDFB 20560000
         AGO   .CHKSYN                                         @D14LDFB 20600000
.CHKLEN  ANOP                                                  @D52EDUT 20606601
         AIF   (T'&LEN  EQ 'O').CHKSYN                         @D52EDUT 20613201
         AIF   ('&LEN'  EQ '').CHKSYN                          @D52EDUT 20619801
         MNOTE 4,'LEN  REQUEST IGNORED FOR MF=DCL'             @D52EDUT 20626401
         AGO   .CHKSYN                                         @D52EDUT 20633001
.CHKMDGN ANOP                                                           20640000
         AIF (T'&AREA NE 'O').CHKSYN                                    20680000
         AIF ('&AREA' NE '').CHKSYN                                     20720000
         AIF (&INNER).CHKSYN                                            20760000
         MNOTE 8,'AREA MUST BE SPECIFIED FOR MF=GEN|MOD, GENERATION SUPX20800000
               PRESSED'                                                 20840000
&SYNER1  SETB  1                                                        20880000
.CHKSYN  ANOP                                                           20920000
.*                                                                      20960000
.*       GENERATION OF CODE IS SUPPRESSED IF A SYNTAX ERROR WAS         21000000
.*       FOUND EITHER IN LBRACCES OR LBRACCCB                           21040000
.*                                                                      21080000
         AIF   (NOT (&SYNER1 OR &SYNERR)).CHKGEN                        21120000
         AIF   (NOT &INNER).NOSYNER                                     21160000
&SYNERR  SETB  1                                                        21200000
.NOSYNER ANOP                                                           21240000
         MEXIT                                                          21280000
.CHKGEN  ANOP                                                           21320000
         AIF   ('&MF' EQ 'GEN' OR '&MF' EQ 'MOD').CHKGEN1               21360000
         AIF   ('&LABEL1' NE '').GENCB                                  21400000
         MNOTE 8,'NO LABEL FOR MF=DCL, GENERATION SUPPRESSED'           21440000
         MEXIT                                                          21480000
.GENCB   ANOP                                                           21520000
.*                                                                      21560000
.*       GENERATE INLINE CONTROL BLOCK WITH DC'S                        21600000
.*                                                                      21640000
&LABEL1  DS    0F                                                       21680000
.*                                                                      21720000
.*       LIBINFO                                                        21760000
.*                                                                      21800000
         AIF   (T'&LIBINFO EQ 'O').NOINFO                               21840000
         AIF   ('&LIBINFO' EQ '').NOINFO                                21880000
         DC    A(&LIBINFO)            LIBINFO                           21920000
         AGO   .CHKDTF                                                  21960000
.NOINFO  ANOP                                                           22000000
         DC    F'0'                   LIBINFO                           22040000
.CHKDTF  ANOP                                                  @D14LDFB 22080000
.*                                                             @D14LDFB 22120000
.*       CHAINID                                               @D14LDFB 22160000
.*                                                             @D14LDFB 22200000
         AIF   (T'&CHAINID EQ 'O').NODTF                       @D14LDFB 22240000
         AIF   ('&CHAINID' EQ '').NODTF                        @D14LDFB 22280000
         DC    A(&CHAINID)            CHAINID                  @D14LDFB 22320000
         AGO   .CHKIOA                                         @D14LDFB 22360000
.NODTF   ANOP                                                           22400000
         DC    F'0'                                            @D14LDFB 22440000
.CHKIOA  ANOP                                                           22480000
.NOIOA   ANOP                                                           22520000
         DC    F'0'                                            @D14LDFB 22560000
.CHKLAM  ANOP                                                  @D14LDFB 22600000
.*                                                                      22640000
.*       ADDRESS OF LOCK TABLE ENTRY                                    22680000
.*                                                                      22720000
         DC    A(LBRD&SYSNDX)         LOCK TABLE ENTRY                  22760000
.*                                                                      22800000
.*       LAMB                                                           22840000
.*                                                                      22880000
         AIF   (T'&LAMB EQ 'O').NOLAM                          @D14LDFB 22920000
         AIF   ('&LAMB' EQ '').NOLAM                           @D14LDFB 22960000
         DC    A(&LAMB)               LAMB                     @D14LDFB 23000000
         AGO   .DTLADR                                         @D14LDFB 23040000
.NOLAM   ANOP                                                  @D14LDFB 23080000
         DC    F'0'                   LAMB                     @D14LDFB 23120000
.DTLADR  ANOP                                                           23160000
.*                                                                      23200000
.*       MAIN FUNCTION                                                  23240000
.*                                                                      23280000
         DC    X'0'                   MAIN FUNCTION                     23320000
.*                                                                      23360000
.*       LIBTYPE                                                        23400000
.*                                                                      23440000
         AIF   (T'&LIBTYPE EQ 'O').SETNOTY                              23480000
         AIF   ('&LIBTYPE' EQ '').SETNOTY                               23520000
         AIF   ('&LIBTYPE' NE 'PHASE').CHCKRL                  @D14LDFB 23560000
         DC    AL1(LBRCL)             LIBTYPE                           23600000
         AGO   .SETREQ                                                  23640000
.CHCKRL  ANOP                                                           23680000
         AIF   ('&LIBTYPE' NE 'OBJ').CHCKSL                    @D14LDFB 23720000
         DC    AL1(LBRRL)             LIBTYPE                           23760000
         AGO   .SETREQ                                                  23800000
.CHCKSL  ANOP                                                           23840000
         AIF   ('&LIBTYPE' NE 'SOURCE').CHCKPL                 @D14LDFB 23880000
         DC    AL1(LBRSL)             LIBTYPE                           23920000
         AGO   .SETREQ                                                  23960000
.CHCKPL  AIF   ('&LIBTYPE' NE 'PROC').CHCKSCL                  @D14LDFB 24000000
         DC    AL1(LBRPL)             LIBTYPE                           24040000
         AGO   .SETREQ                                                  24080000
.CHCKSCL ANOP                                                           24120000
         AIF   ('&LIBTYPE' NE 'SPHASE').CHCKSRL                @D14LDFB 24160000
         DC    AL1(LBRSCL)            LIBTYPE                           24200000
         AGO   .SETREQ                                                  24240000
.CHCKSRL ANOP                                                           24280000
         AIF   ('&LIBTYPE' NE 'SOBJ').CHCKSSL                  @D14LDFB 24320000
         DC    AL1(LBRSRL)            LIBTYPE                           24360000
         AGO   .SETREQ                                                  24400000
.CHCKSSL ANOP                                                           24440000
         AIF   ('&LIBTYPE' NE 'SSOURCE').CHCKSPL               @D14LDFB 24480000
         DC    AL1(LBRSSL)            LIBTYPE                           24520000
         AGO   .SETREQ                                                  24560000
.CHCKSPL AIF   ('&LIBTYPE' NE 'SPROC').CHCKDMP                 @D14LDFB 24600000
         DC    AL1(LBRSPL)            LIBTYPE                           24640000
         AGO   .SETREQ                                                  24680000
.CHCKDMP AIF   ('&LIBTYPE' NE 'DUMP').CHCKLBR                  @D14LDFB 24720000
         DC    AL1(LBRDUMP)           LIBTYPE                  @D14LDFB 24760000
         AGO   .SETREQ                                         @D14LDFB 24800000
.CHCKLBR AIF   ('&LIBTYPE' NE 'LBR').SETNOTY                   @D14LDFB 24840000
         DC    AL1(LBRLBRTY)          LIBTYPE                  @D14LDFB 24880000
         AGO   .SETREQ                                         @D14LDFB 24920000
.CHCKALL AIF   ('&LIBTYPE' NE 'ALL').SETNOTY                   @D52EDUT 24930001
         DC    AL1(LBRALL)          LIBTYPE                    @D52EDUT 24940001
         AGO   .SETREQ                                         @D52EDUT 24950001
.SETNOTY ANOP                                                           24960000
         DC    X'0'                   LIBTYPE                           25000000
.SETREQ  ANOP                                                           25040000
.*                                                                      25080000
.*       LIBUSE                                                         25120000
.*                                                                      25160000
         AIF   (T'&LIBUSE EQ 'O').SETNUSE                               25200000
         AIF   ('&LIBUSE' EQ '').SETNUSE                                25240000
         AIF   ('&LIBUSE' NE 'SEARCH').CHCKTO                           25280000
         DC    AL1(LBRSEARC)          LIBUSE                            25320000
         AGO   .SETCHN                                                  25360000
.CHCKTO  ANOP                                                           25400000
         AIF   ('&LIBUSE' NE 'TO').CHCKFR                               25440000
         DC    AL1(LBRTO)             LIBUSE                            25480000
         AGO   .SETCHN                                                  25520000
.CHCKFR  ANOP                                                           25560000
         AIF   ('&LIBUSE' NE 'FROM').CHCKACC                   @D14LDFB 25600000
         DC    AL1(LBRFROM)           LIBUSE                            25640000
         AGO   .SETCHN                                                  25680000
.CHCKACC ANOP                                                  @D14LDFB 25720000
         AIF   ('&LIBUSE' NE 'ACCESS').CHCKUSR                 @D14LDFB 25760000
         DC    AL1(LBRACC)            LIBUSE                   @D14LDFB 25800000
         AGO   .SETCHN                                                  25840000
.CHCKUSR ANOP                                                  @D14LDFB 25880000
         AIF   ('&LIBUSE' NE 'USER').CHCKCAT                   @D14LDFB 25920000
         DC    AL1(LBRUSER)           LIBUSE                   @D14LDFB 25960000
         AGO   .SETCHN                                                  26000000
.CHCKCAT AIF   ('&LIBUSE' NE 'CATALOG').SETNUSE                @D14LDFB 26040000
         DC    AL1(LBRCAT)            LIBUSE                   @D14LDFB 26080000
         AGO   .SETCHN                                                  26120000
.SETNUSE ANOP                                                           26160000
         DC    X'0'                   LIBUSE                            26200000
.SETCHN  ANOP                                                           26240000
.*                                                                      26280000
.*       CHAIN (BOTH IS THE DEFAULT VALUE)                              26320000
.*                                                                      26360000
         AIF   (T'&CHAIN EQ 'O').SETBOTH                                26400000
         AIF   ('&CHAIN' EQ '').SETBOTH                                 26440000
         AIF   ('&CHAIN' NE 'TEMP').CHKPERM                             26480000
         DC    AL1(LBRTEMP)           CHAIN                             26520000
         AGO   .SETERR                                                  26560000
.CHKPERM ANOP                                                           26600000
         AIF   ('&CHAIN' NE 'PERM').SETBOTH                             26640000
         DC    AL1(LBRPERM)           CHAIN                             26680000
         AGO   .SETERR                                                  26720000
.SETBOTH ANOP                                                           26760000
         DC    AL1(LBRBOTH)           CHAIN                             26800000
.SETERR  ANOP                                                           26840000
.SETNOER ANOP                                                           26880000
         DC    X'0'                                            @D14LDFB 26920000
.SETDEF  ANOP                                                           26960000
.*                                                                      27000000
.*       DEFAULT (YES IS THE DEFAULT VALUE)                             27040000
.*                                                                      27080000
         AIF   (T'&DEFAULT EQ 'O').SETDEFY                              27120000
         AIF   ('&DEFAULT' EQ '').SETDEFY                               27160000
         AIF   ('&DEFAULT' EQ 'NO').SETDEFN                             27200000
.SETDEFY ANOP                                                           27240000
         DC    AL1(LBRDFLTY)          DEFAULT                           27280000
         AGO   .SETLOG                                                  27320000
.SETDEFN DC    AL1(LBRDFLTN)          DEFAULT                           27360000
.SETLOG  ANOP                                                           27400000
         DC    XL2'0'                 LOGICAL UNIT             @D14LDFB 27440001
.*                                                                      27480000
.*       SET ADDR OF LIBRARY EDT                                        27520000
.*                                                                      27560000
         DC    XL4'0'                 START ADDRESS OF EDT     @D14LDFB 27600000
.*                                                                      27640000
.*       RETURN INFORMATION                                             27680000
.*                                                                      27720000
         DC    XL4'0'                 FOR INTERNAL USE ONLY    @D14LDFB 27760000
.*                                                                      27800000
.*       INTERNAL USE ONLY AND RESERVED FIELDS                          27840000
.*                                                                      27880000
         DC    XL4'0'                 FOR INTERNAL USE ONLY             27920000
.*                                                             @D14LDFB 27960000
.*       DEFINE (OLD IS THE DEFAULT VALUE)                     @D14LDFB 28000000
.*                                                             @D14LDFB 28040000
         AIF   (T'&DEFINE EQ 'O').SETOLD                       @D14LDFB 28080000
         AIF   ('&DEFINE' EQ '').SETOLD                        @D14LDFB 28120000
         AIF   ('&DEFINE' NE 'NEW').CHKDUMY                    @D14LDFB 28160000
         DC    AL1(LBRDNNEW)          DEFINE                   @D14LDFB 28200000
         AGO   .SETLEV                                         @D14LDFB 28240000
.CHKDUMY ANOP                                                  @D14LDFB 28280000
         AIF   ('&DEFINE' NE 'DUMMY').SETOLD                   @D14LDFB 28320000
         DC    AL1(LBRDNDUM)          DEFINE                   @D14LDFB 28360000
         AGO   .SETLEV                                         @D14LDFB 28400000
.SETOLD  ANOP                                                  @D14LDFB 28440000
         DC    AL1(LBRDNOLD)          DEFINE                   @D14LDFB 28480000
.SETLEV  ANOP                                                  @D14LDFB 28520000
.*                                                             @D14LDFB 28560000
.*       LEVEL (BOTH IS THE DEFAULT VALUE)                     @D14LDFB 28600000
.*                                                             @D14LDFB 28640000
         AIF   (T'&LEVEL  EQ 'O').SETBTH                       @D14LDFB 28680000
         AIF   ('&LEVEL'  EQ '').SETBTH                        @D14LDFB 28720000
         AIF   ('&LEVEL'  NE 'LIB').CHKSBL                     @D14LDFB 28760000
         DC    AL1(LBRLIBLV)          LEVEL                    @D14LDFB 28800000
         AGO   .SETREP                                         @D14LDFB 28840000
.CHKSBL  ANOP                                                  @D14LDFB 28880000
         AIF   ('&LEVEL'  NE 'SUBLIB').SETBTH                  @D14LDFB 28920000
         DC    AL1(LBRSUBLV)          LEVEL                    @D14LDFB 28960000
         AGO   .SETREP                                         @D14LDFB 29000000
.SETBTH  ANOP                                                  @D14LDFB 29040000
         DC    AL1(LBRBTHLV)          LEVEL                    @D14LDFB 29080000
.SETREP  ANOP                                                  @D14LDFB 29120000
.*                                                             @D14LDFB 29160000
.*       REPLACE (NO IS THE DEFAULT VALUE)                     @D14LDFB 29200000
.*                                                             @D14LDFB 29240000
         AIF   (T'&REPLACE EQ 'O').SETRNO                      @D14LDFB 29280000
         AIF   ('&REPLACE' EQ '').SETRNO                       @D14LDFB 29320000
         AIF   ('&REPLACE' NE 'YES').SETRNO                    @D14LDFB 29360000
         DC    AL1(LBRRPYES)          REPLACE=YES              @D14LDFB 29400000
         AGO   .SETLEVO                                        @D14LDFB 29440000
.SETRNO  ANOP                                                  @D14LDFB 29480000
         DC    AL1(LBRRPNO)           REPLACE=NO               @D14LDFB 29520000
.SETLEVO ANOP                                                  @D14LDFB 29560000
.*                                                                      29568801
.*       API OPTIONS                                           @D51IDJS 29577601
.*                                                                      29586401
         DC    XL1'0'                 LBR API OPTION           @D51IDJS 29595201
.*                                                                      29604001
.*       MODIFICATION LEVEL                                    @D52EDUT 29612801
.*                                                                      29621601
         DC    XL4'0001'              MOFIFICATION LEVEL       @D52EDUT 29630401
.*                                                                      29640000
.*       ENTRY OF LIBRARY DEFINITION TABLE                              29680000
.*                                                                      29720000
         DC    XL(LDTELEN)'0'         LIBRARY DEFINITION TABLE ENTRY    29760000
.*                                                             @D14LDFB 29800000
.*       ENTRY OF SUBLIBRARY DEFINITION TABLE                  @D14LDFB 29840000
.*                                                             @D14LDFB 29880000
         DC    XL(SDTELEN)'0'         SDT ENTRY                @D14LDFB 29920000
.*                                                                      29921401
.*       ADDRESS AND LENGTH OF WORK AREA                       @D52EDUT 29922801
.*                                                                      29924201
.SETWKA  ANOP                                                  @D52EDUT 29925601
         AIF   (T'&WAREA EQ 'O').SETWAR                        @D52EDUT 29927001
         AIF   ('&WAREA' EQ '').SETWAR                         @D52EDUT 29928401
         AIF   ('&WAREA'(1,1) EQ '(').SETWAR                   @D52EDUT 29929801
         DC    AL4(&WAREA)             ADDRESS WORK AREA       @D52EDUT 29931201
         AGO   .SETLEN                                         @D52EDUT 29932601
.SETWAR  ANOP                                                  @D52EDUT 29934001
         DC    AL4(0)                                          @D52EDUT 29935401
.SETLEN  ANOP                                                  @D52EDUT 29936801
         DC    XL4'0'                                          @D52EDUT 29938201
.*                                                             @D52EDUT 29939601
.*       PID                                                   @D52EDUT 29941001
.*                                                             @D52EDUT 29942401
.SPID    ANOP                                                  @D52EDUT 29943801
         AIF   (T'&PID EQ 'O').SETPID                          @D52EDUT 29945201
         AIF   ('&PID' EQ '').SETPID                           @D52EDUT 29946601
         DC    CL2&PID                PID                      @D52EDUT 29948001
         AGO   .SRESV                                          @D52EDUT 29949401
.SETPID  ANOP                                                  @D52EDUT 29950801
         DC    XL2'0'                 PID                      @D52EDUT 29952201
.SRESV   ANOP                                                  @D52EDUT 29953601
         DC    XL18'0'                FOR FURTHER USE          @D52EDUT 29955001
.SLOCK   ANOP                                                  @D52EDUT 29956401
.*                                                                      29960000
.*       ENTRY OF LOCK TABLE                                            30000000
.*                                                                      30040000
&DTLLABL SETC  'LBRD&SYSNDX'                                            30080000
&K1      SETA  K'&CONTROL+K'&LOCKOPT+K'&KEEP                            30120000
         AIF   (&K1 NE 0).PARM                                          30160000
&DTLLABL DTL   NAME=*                                                   30200000
         MEXIT                                                          30240000
.PARM    ANOP                                                           30280000
         AIF   (K'&CONTROL EQ 0).NCON                                   30320000
         AIF   (K'&LOCKOPT EQ 0).CONNLOC                                30360000
         AIF   (K'&KEEP EQ 0).CONLOCK                                   30400000
&DTLLABL DTL   NAME=*,                                                 X30440000
               CONTROL=&CONTROL,LOCKOPT=&LOCKOPT,KEEP=&KEEP             30480000
         MEXIT                                                          30520000
.CONLOCK ANOP                                                           30560000
&DTLLABL DTL   NAME=*,                                                 X30600000
               CONTROL=&CONTROL,LOCKOPT=&LOCKOPT                        30640000
         MEXIT                                                          30680000
.CONNLOC AIF   (K'&KEEP EQ 0).CONNLNK                                   30720000
&DTLLABL DTL   NAME=*,                                                 X30760000
               CONTROL=&CONTROL,KEEP=&KEEP                              30800000
         MEXIT                                                          30840000
.CONNLNK ANOP                                                           30880000
&DTLLABL DTL   NAME=*,                                                 X30920000
               CONTROL=&CONTROL                                         30960000
         MEXIT                                                          31000000
.NCON    ANOP                                                           31040000
         AIF   (K'&LOCKOPT EQ 0).KEEP                                   31080000
         AIF   (K'&KEEP EQ 0).NCLOCNK                                   31120000
&DTLLABL DTL   NAME=*,                                                 X31160000
               LOCKOPT=&LOCKOPT,KEEP=&KEEP                              31200000
         MEXIT                                                          31240000
.NCLOCNK ANOP                                                           31280000
&DTLLABL DTL   NAME=*,                                                 X31320000
               LOCKOPT=&LOCKOPT                                         31360000
         MEXIT                                                          31400000
.KEEP    ANOP                                                           31440000
&DTLLABL DTL   NAME=*,                                                 X31480000
               KEEP=&KEEP                                               31520000
         MEXIT                                                          31560000
.CHKGEN1 ANOP                                                           31600000
.*                                                                      31640000
.*       DYNAMIC GENERATION OR MODIFICATION OF CONTROL BLOCK            31680000
.*                                                                      31720000
         AIF   ('&LABEL1' EQ '').NOLAB                                  31760000
&LABEL1  DS    0H                                                       31800000
.NOLAB   ANOP                                                           31840000
.*                                                                      31880000
.*       ADDRESSING OF CONTROL BLOCK VIA REGISTER 1                     31920000
.*                                                                      31960000
         AIF   ('&AREA' EQ '(1)').USING1                                32000000
         AIF   ('&AREA'(1,1) NE '(').NRAR                               32040000
&REG     SETC  '&AREA'(2,K'&AREA-2)                                     32080000
         LR    LBRACCR1,&REG         ADDRESS OF CONTROL BLOCK           32120000
         AGO   .USING1                                                  32160000
.NRAR    ANOP                                                           32200000
         LA    LBRACCR1,&AREA        ADDRESS OF CONTROL BLOCK           32240000
.USING1  ANOP                                                           32280000
         USING LBRACCDS,LBRACCR1     ADDRESSABILITY FOR CONTROL BLOCK   32320000
         AIF   ('&MF' NE 'GEN').NOTGEN                                  32360000
.*                                                                      32400000
.*       FOR MF=GEN THE CONTROL BLOCK MUST BE CLEARED                   32440000
.*                                                                      32480000
         XC    LBRACCDS(LBRACDSL),LBRACCDS CLEAR CONTROL BLOCK          32520000
.NOTGEN  ANOP                                                           32560000
.*                                                                      32600000
.*       INSERT LIBINFO, IF SPECIFIED                                   32640000
.*                                                                      32680000
         AIF   (T'&LIBINFO EQ 'O').CHKDTF1                              32720000
         AIF   ('&LIBINFO' EQ '').CHKDTF1                               32760000
         AIF   ('&LIBINFO'(1,1) NE '(').NRINFO                          32800000
&REG     SETC  '&LIBINFO'(2,K'&LIBINFO-2)                               32840000
         ST    &REG,LBRINFO          INSERT LIBINFO                     32880000
         AGO   .CHKDTF1                                                 32920000
.NRINFO  ANOP                                                           32960000
         LA    LBRACCR0,&LIBINFO                                        33000000
         ST    LBRACCR0,LBRINFO      INSERT LIBINFO                     33040000
.CHKDTF1 ANOP                                                           33080000
.*                                                             @D14LDFB 33120000
.*       INSERT CHAINID, IF SPECIFIED                          @D14LDFB 33160000
.*                                                             @D14LDFB 33200000
         AIF   (T'&CHAINID EQ 'O').CHKLAM1                     @D14LDFB 33240000
         AIF   ('&CHAINID' EQ '').CHKLAM1                      @D14LDFB 33280000
         AIF   ('&CHAINID'(1,1) NE '(').NRDTF1                 @D14LDFB 33320000
&REG     SETC  '&CHAINID'(2,K'&CHAINID-2)                      @D14LDFB 33360000
         ST    &REG,LBRCHID          INSERT CHAINID            @D14LDFB 33400000
         AGO   .CHKLAM1                                        @D14LDFB 33440000
.NRDTF1  ANOP                                                  @D14LDFB 33480000
         LA    LBRACCR0,&CHAINID                               @D14LDFB 33520000
         ST    LBRACCR0,LBRCHID      INSERT CHAINID            @D14LDFB 33560000
.CHKLAM1 ANOP                                                  @D14LDFB 33600000
.*                                                                      33640000
.*       INSERT LAMB, IF SPECIFIED                                      33680000
.*                                                                      33720000
         AIF   (T'&LAMB EQ 'O').CHKIOA1                        @D14LDFB 33760000
         AIF   ('&LAMB' EQ '').CHKIOA1                         @D14LDFB 33800000
         AIF   ('&LAMB'(1,1) NE '(').NRLAM                     @D14LDFB 33840000
&REG     SETC  '&LAMB'(2,K'&LAMB-2)                            @D14LDFB 33880000
         ST    &REG,LBRLAMB          INSERT LAMB               @D14LDFB 33920000
         AGO   .CHKIOA1                                        @D14LDFB 33960000
.NRLAM   ANOP                                                  @D14LDFB 34000000
         LA    LBRACCR0,&LAMB                                  @D14LDFB 34040000
         ST    LBRACCR0,LBRLAMB      INSERT LAMB               @D14LDFB 34080000
.CHKIOA1 ANOP                                                           34120000
.CHKMF1  ANOP                                                           34160000
.*                                                                      34200000
.*       INSERT FUNCTION CODE, IF CALLED AS INNER MACRO                 34240000
.*                                                                      34280000
         AIF   ('&FC' NE 'GET').CHCALI1                                 34320000
         MVI   LBRMF,LBRGET          INSERT MAIN FUNCTION               34360000
         AGO   .RESETF1                                                 34400000
.CHCALI1 ANOP                                                           34440000
         AIF   ('&FC' NE 'ADDLIB').CHCREM1                              34480000
         MVI   LBRMF,LBRADLIB        INSERT MAIN FUNCTION               34520000
         AGO   .RESETF1                                                 34560000
.CHCREM1 AIF   ('&FC' NE 'REMOVE').CHCLOC1                              34600000
         MVI   LBRMF,LBRREMOV        INSERT MAIN FUNCTION               34640000
         AGO   .RESETF1                                                 34680000
.CHCLOC1 ANOP                                                           34720000
         AIF   ('&FC' NE 'LOCK').CHCUNL1                                34760000
         MVI   LBRMF,LBRLOCK         INSERT MAIN FUNCTION               34800000
         AGO   .RESETF1                                                 34840000
.CHCUNL1 ANOP                                                           34880000
         AIF   ('&FC' NE 'UNLOCK').CHCEXT1                     @D14LDFB 34920000
         MVI   LBRMF,LBRUNLOC        INSERT MAIN FUNCTION               34960000
         AGO   .RESETF1                                        @D14LDFB 35000000
.CHCEXT1 ANOP                                                  @D14LDFB 35040000
         AIF   ('&FC' NE 'EXTEND').CHCUPD1                     @D21SDFB 35080000
         MVI   LBRMF,LBREXTND        INSERT MAIN FUNCTION      @D14LDFB 35120000
         AGO   .RESETF1                                        @D14LDFB 35160000
.CHCUPD1 ANOP                                                  @D21SDFB 35200000
         AIF   ('&FC' NE 'EXTUPD').RESETF1                     @D21SDFB 35240000
         MVI   LBRMF,LBRUPDEX        INSERT MAIN FUNCTION      @D21SDFB 35280000
.RESETF1 ANOP                                                           35320000
.CHKTYP1 ANOP                                                           35360000
.*                                                                      35400000
.*       INSERT LIBTYPE, IF SPECIFIED                                   35440000
.*                                                                      35480000
         AIF   (T'&LIBTYPE EQ 'O').SETREQ1                              35520000
         AIF   ('&LIBTYPE' EQ '').SETREQ1                               35560000
         AIF   ('&LIBTYPE' NE 'PHASE').CHCKRL1                 @D14LDFB 35600000
         MVI   LBRTYPE,LBRCL         INSERT LIBTYPE                     35640000
         AGO   .SETREQ1                                                 35680000
.CHCKRL1 ANOP                                                           35720000
         AIF   ('&LIBTYPE' NE 'OBJ').CHCKSL1                   @D14LDFB 35760000
         MVI   LBRTYPE,LBRRL         INSERT LIBTYPE                     35800000
         AGO   .SETREQ1                                                 35840000
.CHCKSL1 ANOP                                                           35880000
         AIF   ('&LIBTYPE' NE 'SOURCE').CHCKPL1                @D14LDFB 35920000
         MVI   LBRTYPE,LBRSL         INSERT LIBTYPE                     35960000
         AGO   .SETREQ1                                                 36000000
.CHCKPL1 ANOP                                                           36040000
         AIF   ('&LIBTYPE' NE 'PROC').CHCKSC1                  @D14LDFB 36080000
         MVI   LBRTYPE,LBRPL         INSERT LIBTYPE                     36120000
         AGO   .SETREQ1                                                 36160000
.CHCKSC1 ANOP                                                           36200000
         AIF   ('&LIBTYPE' NE 'SPHASE').CHCKSR1                @D14LDFB 36240000
         MVI   LBRTYPE,LBRSCL        INSERT LIBTYPE                     36280000
         AGO   .SETREQ1                                                 36320000
.CHCKSR1 ANOP                                                           36360000
         AIF   ('&LIBTYPE' NE 'SOBJ').CHCKSS1                  @D14LDFB 36400000
         MVI   LBRTYPE,LBRSRL        INSERT LIBTYPE                     36440000
         AGO   .SETREQ1                                                 36480000
.CHCKSS1 ANOP                                                           36520000
         AIF   ('&LIBTYPE' NE 'SSOURCE').CHCKSP1               @D14LDFB 36560000
         MVI   LBRTYPE,LBRSSL        INSERT LIBTYPE                     36600000
         AGO   .SETREQ1                                                 36640000
.CHCKSP1 AIF   ('&LIBTYPE' NE 'SPROC').CHCKDM1                 @D14LDFB 36680000
         MVI   LBRTYPE,LBRSPL        INSERT LIBTYPE                     36720000
         AGO   .SETREQ1                                        @D14LDFB 36760000
.CHCKDM1 AIF   ('&LIBTYPE' NE 'DUMP').CHCKLB1                  @D14LDFB 36800000
         MVI   LBRTYPE,LBRDUMP       INSERT LIBTYPE            @D14LDFB 36840000
         AGO   .SETREQ1                                        @D14LDFB 36880000
.CHCKLB1 AIF   ('&LIBTYPE' NE 'LBR').CHCKAL1                   @D14LDFB 36920001
         MVI   LBRTYPE,LBRLBRTY      INSERT LIBTYPE            @D14LDFB 36960000
.CHCKAL1 AIF   ('&LIBTYPE' NE 'ALL').SETREQ1                   @D52EDUT 36973301
         MVI   LBRTYPE,LBRALL        INSERT LIBTYPE            @D52EDUT 36986601
.SETREQ1 ANOP                                                           37000000
.*                                                                      37040000
.*       INSERT LIBUSE, IF SPECIFIED                                    37080000
.*                                                                      37120000
         AIF   (T'&LIBUSE EQ 'O').SETCHN1                               37160000
         AIF   ('&LIBUSE' EQ '').SETCHN1                                37200000
         AIF   ('&LIBUSE' NE 'SEARCH').CHCKTO1                          37240000
         MVI   LBRUSE,LBRSEARC       INSERT LIBUSE                      37280000
         AGO   .SETCHN1                                                 37320000
.CHCKTO1 ANOP                                                           37360000
         AIF   ('&LIBUSE' NE 'TO').CHCKFR1                              37400000
         MVI   LBRUSE,LBRTO          INSERT LIBUSE                      37440000
         AGO   .SETCHN1                                                 37480000
.CHCKFR1 ANOP                                                           37520000
         AIF   ('&LIBUSE' NE 'FROM').CHCKAC1                   @D14LDFB 37560000
         MVI   LBRUSE,LBRFROM        INSERT LIBUSE                      37600000
         AGO   .SETCHN1                                                 37640000
.CHCKAC1 ANOP                                                  @D14LDFB 37680000
         AIF   ('&LIBUSE' NE 'ACCESS').CHCKUR1                 @D14LDFB 37720000
         MVI   LBRUSE,LBRACC         INSERT LIBUSE             @D14LDFB 37760000
         AGO   .SETCHN1                                                 37800000
.CHCKUR1 ANOP                                                  @D14LDFB 37840000
         AIF   ('&LIBUSE' NE 'USER').CHCKCA1                   @D14LDFB 37880000
         MVI   LBRUSE,LBRUSER        INSERT LIBUSE             @D14LDFB 37920000
         AGO   .SETCHN1                                                 37960000
.CHCKCA1 AIF   ('&LIBUSE' NE 'CATALOG').SETCHN1                @D14LDFB 38000000
         MVI   LBRUSE,LBRCAT         INSERT LIBUSE             @D14LDFB 38040000
.SETCHN1 ANOP                                                           38080000
.*                                                                      38120000
.*       INSERT CHAIN, IF SPECIFIED                                     38160000
.*                                                                      38200000
         AIF   (T'&CHAIN NE 'O').SETCHN2                                38240000
         AIF   ('&CHAIN' NE '').SETCHN2                                 38280000
         AIF   ('&MF' NE 'GEN').SETERR1                        @D52EDUT 38300001
         MVI   LBRCHAIN,LBRBOTH      INSERT CHAIN(DEFAULT)     @D52EDUT 38320001
         AGO   .SETERR1                                        @D52EDUT 38340001
.SETCHN2 ANOP                                                           38360000
         AIF   ('&CHAIN' NE 'TEMP').CHKPER1                             38400000
         MVI   LBRCHAIN,LBRTEMP      INSERT CHAIN                       38440000
         AGO   .SETERR1                                                 38480000
.CHKPER1 ANOP                                                           38520000
         AIF   ('&CHAIN' NE 'PERM').CHKBTH1                             38560000
         MVI   LBRCHAIN,LBRPERM      INSERT CHAIN                       38600000
         AGO   .SETERR1                                                 38640000
.CHKBTH1 AIF   ('&CHAIN' NE 'BOTH').SETERR1                             38680000
.SETBTH1 ANOP                                                           38720000
         MVI   LBRCHAIN,LBRBOTH      INSERT CHAIN                       38760000
.SETERR1 ANOP                                                           38800000
.SETDEF1 ANOP                                                           38840000
.*                                                                      38880000
.*       INSERT DEFAULT, IF SPECIFIED                                   38920000
.*                                                                      38960000
         AIF   (T'&DEFAULT EQ 'O').MDFL                        @D14LDFB 39000001
         AIF   ('&DEFAULT' EQ '').MDFL                         @D14LDFB 39040001
.SETDEF2 ANOP                                                           39080000
         AIF   ('&DEFAULT' NE 'YES').CHKDEN1                            39120000
.SETDFY1 ANOP                                                           39160000
         MVI   LBRDFLT,LBRDFLTY      INSERT DEFAULT                     39200000
         AGO   .SETDISP                                                 39240000
.CHKDEN1 AIF   ('&DEFAULT' NE 'NO').SETDISP                             39280000
         MVI   LBRDFLT,LBRDFLTN      INSERT DEFAULT                     39320000
         AGO   .SETDISP                                                 39328001
.MDFL    ANOP                                                  @D52EDUT 39336001
         AIF   ('&MF' NE 'GEN').SETLEVL                        @D52EDUT 39344001
         MVI   LBRDFLT,LBRDFLTY      INSERT DEFAULT(DEFAULT)   @D52EDUT 39352001
.SETDISP ANOP                                                           39360000
.SETLEVL ANOP                                                  @D14LDFB 39400000
.*                                                             @D14LDFB 39440000
.*       INSERT LEVEL,  IF SPECIFIED                           @D14LDFB 39480000
.*                                                             @D14LDFB 39520000
         AIF   (T'&LEVEL  NE 'O').SETLVL2                      @D14LDFB 39560000
         AIF   ('&LEVEL'  NE '').SETLVL2                       @D14LDFB 39600000
         AIF   ('&MF' NE 'GEN').SETDFN                         @D52EDUT 39620001
         MVI   LBRLEVEL,LBRBTHLV     INSERT LEVEL(DEFAULT)     @D52EDUT 39640001
         AGO   .SETDFN                                         @D52EDUT 39660001
.SETLVL2 ANOP                                                  @D14LDFB 39680000
         AIF   ('&LEVEL'  NE 'LIB').CHKSUB1                    @D14LDFB 39720000
         MVI   LBRLEVEL,LBRLIBLV     INSERT LEVEL              @D14LDFB 39760000
         AGO   .SETDFN                                         @D14LDFB 39800000
.CHKSUB1 ANOP                                                  @D14LDFB 39840000
         AIF   ('&LEVEL'  NE 'SUBLIB').CHKBTH2                 @D14LDFB 39880000
         MVI   LBRLEVEL,LBRSUBLV     INSERT LEVEL              @D14LDFB 39920000
         AGO   .SETDFN                                         @D14LDFB 39960000
.CHKBTH2 AIF   ('&LEVEL' NE 'BOTH').SETDFN                     @D14LDFB 40000000
.SETBTH2 ANOP                                                  @D14LDFB 40040000
         MVI   LBRLEVEL,LBRBTHLV     INSERT LEVEL              @D14LDFB 40080000
.SETDFN  ANOP                                                  @D14LDFB 40120000
.*                                                             @D14LDFB 40160000
.*       INSERT DEFINE, IF SPECIFIED                           @D14LDFB 40200000
.*                                                             @D14LDFB 40240000
         AIF   (T'&DEFINE NE 'O').SETDFN2                      @D14LDFB 40280000
         AIF   ('&DEFINE' NE '').SETDFN2                       @D14LDFB 40320000
         AIF   ('&MF' NE 'GEN').SETLOGU                        @D52EDUT 40340001
         MVI   LBRDEFNE,LBRDNOLD     INSERT DEFINE(DEFAULT)    @D52EDUT 40360001
         AGO   .SETLOGU                                        @D52EDUT 40380001
.SETDFN2 ANOP                                                  @D14LDFB 40400000
         AIF   ('&DEFINE' NE 'NEW').CHKDUM1                    @D14LDFB 40440000
         MVI   LBRDEFNE,LBRDNNEW     INSERT DEFINE             @D14LDFB 40480000
         AGO   .SETLOGU                                        @D14LDFB 40520000
.CHKDUM1 ANOP                                                  @D14LDFB 40560000
         AIF   ('&DEFINE' NE 'DUMMY').CHKOLD1                  @D14LDFB 40600000
         MVI   LBRDEFNE,LBRDNDUM     INSERT DEFINE             @D14LDFB 40640000
         AGO   .SETLOGU                                        @D14LDFB 40680000
.CHKOLD1 AIF   ('&DEFINE' NE 'OLD').SETLOGU                    @D14LDFB 40720000
.SETOLD1 ANOP                                                  @D14LDFB 40760000
         MVI   LBRDEFNE,LBRDNOLD     INSERT DEFINE             @D14LDFB 40800000
.SETLOGU ANOP                                                           40840000
.*                                                             @D14LDFB 40880000
.*       INSERT REPLACE, IF SPECIFIED                          @D14LDFB 40920000
.*                                                             @D14LDFB 40960000
         AIF   (T'&REPLACE NE 'O').SETRPN2                     @D14LDFB 41000000
         AIF   ('&REPLACE' NE '').SETRPN2                      @D14LDFB 41040000
         AIF   ('&MF' NE 'GEN').SETMOD                         @D52EDUT 41060001
         MVI   LBRREPLC,LBRRPNO      INSERT REPLACE            @D52EDUT 41080001
         AGO   .SETMOD                                         @D52EDUT 41100001
.SETRPN2 ANOP                                                  @D14LDFB 41120000
         AIF   ('&REPLACE' NE 'YES').CHKNO1                    @D14LDFB 41160000
         MVI   LBRREPLC,LBRRPYES     INSERT REPLACE            @D14LDFB 41200000
         AGO   .SETMOD                                         @D14LDFB 41240001
.CHKNO1  AIF   ('&REPLACE' NE 'NO').SETMOD                     @D14LDFB 41280001
.SETNO1  ANOP                                                  @D14LDFB 41320000
         MVI   LBRREPLC,LBRRPNO      INSERT REPLACE            @D14LDFB 41360000
.*                                                             @D52EDUT 41365001
.*       INSERT MODIFICATION LEVEL FOR MF = GEN                @D52EDUT 41370001
.*                                                             @D52EDUT 41375001
.SETMOD  ANOP                                                           41380001
         AIF   ('&MF' NE 'GEN').SETLDT                         @D52EDUT 41385001
         LA    LBRACR15,1(0)                       @PROBU054   @D52EDUT 41390001
         ST    LBRACR15,LBRMOD                     @PROBU054   @D52EDUT 41395001
.SETLDT  ANOP                                                           41400000
.*                                                                      41440000
.*       INSERT FILENAM, IF SPECIFIED                                   41480000
.*                                                                      41520000
         AIF (T'&FILENAM EQ 'O').SETSDT                        @D14LDFB 41560000
         AIF ('&FILENAM' EQ '').SETSDT                         @D14LDFB 41600000
.*                                                                      41640000
.*       ESTABLISH ADDRESSABILITY TO LDT ENTRY                          41680000
.*                                                                      41720000
         LA    LBRACR15,LBRLDT       ESTABLISH ADDRESSABILITY           41760000
         USING INLCLDTE,LBRACR15     TO LIBRARY DEFINITION TABLE ENTRY  41800000
.*                                                                      41840000
.*       INSERT FILENAM                                                 41880000
.*                                                                      41920000
         AIF   ('&FILENAM'(1,1) NE '(').NRFILN                          41960000
&REG     SETC  '&FILENAM'(2,K'&FILENAM-2)                               42000000
         MVC   LDTEFNME,0(&REG)      INSERT FILENAM                     42040000
         AGO   .DROP15                                         @D14LDFB 42080000
.NRFILN  ANOP                                                           42120000
         MVC   LDTEFNME,&FILENAM     INSERT FILENAM                     42160000
.DROP15  ANOP                                                           42200000
         DROP  LBRACR15                                                 42240000
.SETSDT  ANOP                                                  @D14LDFB 42280000
.*                                                             @D14LDFB 42320000
.*       INSERT SUBLIB, IF SPECIFIED                           @D14LDFB 42360000
.*                                                             @D14LDFB 42400000
         AIF   (T'&SUBLIB  EQ 'O').INSPID                      @D14LDFB 42440001
         AIF   ('&SUBLIB'  EQ '').INSPID                       @D14LDFB 42480001
.*                                                             @D14LDFB 42520000
.*       ESTABLISH ADDRESSABILITY TO SDT ENTRY                 @D14LDFB 42560000
.*                                                             @D14LDFB 42600000
         LA    LBRACR15,LBRSDT       ESTABLISH ADDRESSABILITY  @D14LDFB 42640000
         USING INLCSDTE,LBRACR15     TO LIBRARY DEFINITION TABLE ENTRY  42680000
.*                                                             @D14LDFB 42720000
.*       INSERT SUBLIB                                         @D14LDFB 42760000
.*                                                             @D14LDFB 42800000
         AIF   ('&SUBLIB'(1,1) NE '(').NRSUBN                  @D14LDFB 42840000
&REG     SETC  '&SUBLIB'(2,K'&SUBLIB-2)                        @D14LDFB 42880000
         MVC   SDTENAME,0(&REG)      INSERT SUBLIB             @D14LDFB 42920000
         AGO   .DRPR15                                         @D14LDFB 42960000
.NRSUBN  ANOP                                                  @D14LDFB 43000000
         MVC   SDTENAME,&SUBLIB      INSERT SUBLIB             @D14LDFB 43040000
.DRPR15  ANOP                                                  @D14LDFB 43080000
         DROP  LBRACR15                                        @D14LDFB 43120000
.INSPID  ANOP                                                  @D52EDUT 43121001
         AIF   (T'&PID NE 'O').SOTPID                          @D52EDUT 43122001
         AIF   ('&PID' NE '').SOTPID                           @D52EDUT 43123001
         AIF   ('&MF' NE 'GEN').SETWRK                         @D52EDUT 43123501
         XC    LBRPID,LBRPID       INSERT PID(DEFAULT)         @D52EDUT 43124001
         AGO   .SETWRK                                         @D52EDUT 43125001
.SOTPID  ANOP                                                  @D52EDUT 43126001
         AIF   ('&PID'(1,1) NE '(').NRPID                      @D52EDUT 43127001
&REG     SETC  '&PID'(2,K'&PID-2)                              @D52EDUT 43128001
         MVC   LBRPID,0(&REG)        INSERT PID                @D52EDUT 43129001
         AGO   .SETWRK                                         @D52EDUT 43130001
.NRPID   ANOP                                                  @D52EDUT 43131001
         AIF   ('&PID'(1,1) NE '''').NCPID                     @D52EDUT 43132001
&REG     SETC  'C&PID'                                         @D52EDUT 43133001
         MVC   LBRPID,&REG           INSERT PID                @D52EDUT 43134001
         AGO   .SETWRK                                         @D52EDUT 43135001
.NCPID   ANOP                                                  @D14LDFB 43136001
         MVC   LBRPID,&PID         INSERT PID                  @D52EDUT 43137001
.SETWRK  ANOP                                                  @D52EDUT 43138001
         AIF   (T'&WAREA EQ 'O').INSLEN                        @D52EDUT 43139001
         AIF   ('&WAREA' EQ '').INSLEN                         @D52EDUT 43140001
         AIF   ('&WAREA'(1,1) EQ '(').NRWRK                    @D52EDUT 43141001
         LA    LBRACCR0,&WAREA                                 @D52EDUT 43142001
         ST    LBRACCR0,LBRWRK        INSERT WORK AREA         @D52EDUT 43143001
         AGO   .INSLEN                                         @D52EDUT 43144001
.NRWRK   ANOP                                                  @D52EDUT 43145001
&REG     SETC  '&WAREA'(2,K'&WAREA-2)                          @D52EDUT 43146001
         ST    &REG,LBRWRK           INSERT WORKAREA           @D52EDUT 43147001
.INSLEN  ANOP                                                  @D52EDUT 43148001
         AIF   (T'&LEN EQ 'O').SETCON                          @D52EDUT 43149001
         AIF   ('&LEN' EQ '').SETCON                           @D52EDUT 43150001
         AIF   ('&LEN'(1,1) NE '(').NRLEN                      @D52EDUT 43151001
&REG     SETC  '&LEN'(2,K'&LEN-2)                              @D52EDUT 43152001
         MVC   LBRLEN,0(&REG)        INSERT LENGTH             @D52EDUT 43153001
         AGO   .SETCON                                         @D52EDUT 43154001
.NRLEN   ANOP                                                  @D52EDUT 43155001
         MVC   LBRLEN,&LEN         INSERT WORK AREA LENGTH     @D52EDUT 43156001
.SETCON  ANOP                                                           43160000
         AIF   ('&FC' EQ 'LOCK' OR '&FC' EQ 'UNLOCK').MODLCK            43200000
.*                                                                      43240000
.*       INSERT LOCK OPTIONS, IF SPECIFIED                              43280000
.*                                                                      43320000
.*       MODIFY LOCK TABLE ENTRY FOR MF = MOD                           43360000
.*                                                                      43400000
.*       GENERATE LOCK TABLE ENTRY FOR MF = GEN                         43440000
.*                                                                      43480000
.*       REGISTER 1 WILL BE DESTROYED BY MODDTL|GENDTL. SINCE IT IS     43520000
.*       USED TO ADDRESS THE CONTROL BLOCK IT HAS TO BE SAVED BEFORE    43560000
.*       USING THE MODDTL|GENDTL MACROS. SAVING IS DONE IN R2, WHICH    43600000
.*       IS SAVED BEFORE IN THE CONTROL BLOCK.                          43640000
.*                                                                      43680000
         AIF   (T'&CONTROL EQ 'O' AND T'&LOCKOPT EQ 'O' AND            X43720000
                T'&KEEP EQ 'O' AND '&MF' NE 'GEN').EXIT                 43760000
         AIF   ('&CONTROL' EQ '' AND '&LOCKOPT' EQ '' AND              X43800000
                '&KEEP' EQ '' AND '&MF' NE 'GEN').EXIT                  43840000
.*       ST    LBRACCR2,LBRSAVE2     SAVE REGISTER 2 IN CONTROL BLOCK   43875501
.*       LR    LBRACCR2,LBRACCR1     SAVE REGISTER 1 IN REGISTER 2      43911001
.*       LA    LBRACCR14,LBRDTL1     ADDRESS OF LOCK TABLE ENTRY        43946601
         LA    LBRACR14,0            CLAEAR LOCK TABLE ADDR. @D52RDUT   43973201
         AIF   ('&MF' NE 'GEN').LOADDTL                                 44000000
         ST    LBRACR14,LBRDTL       PUT IT INTO CONTROL BLOCK          44040000
.LOADDTL ANOP                                                           44080000
.* FROM HERE TO .EXIT DELETED BECAUSE OF CHANGE OF DTL @D52RDUT         44100001
&K1      SETA  K'&CONTROL+K'&LOCKOPT+K'&KEEP                            44120000
.*       AIF   (&K1 NE 0).PARM1                                         44160001
.*       AIF   ('&MF' NE 'GEN').REST2                                   44200001
.*       GENDTL ADDR=(LBRACR14)                                         44240001
.*       AGO   .REST2                                                   44280001
.PARM1   ANOP                                                           44320000
.*       AIF   (K'&CONTROL EQ 0).NC                                     44360001
.*       AIF   (K'&LOCKOPT EQ 0).CNL                                    44400001
.*       AIF   (K'&KEEP EQ 0).CL                                        44440001
.*       AIF   ('&MF' EQ 'MOD').MOD1                                    44480001
.*       AIF   ('&MF' NE 'GEN').REST2                                   44520001
.*       GENDTL ADDR=(LBRACR14),                                     X  44560001
.*             CONTROL=&CONTROL,LOCKOPT=&LOCKOPT,KEEP=&KEEP             44600001
.*       AGO   .REST2                                                   44640001
.MOD1    ANOP                                                           44680000
.*       MODDTL ADDR=(LBRACR14),                                     X  44720001
.*             CONTROL=&CONTROL,LOCKOPT=&LOCKOPT,KEEP=&KEEP             44760001
.*       AGO   .REST2                                                   44800001
.CL      ANOP                                                           44840000
.*       AIF   ('&MF' EQ 'MOD').MOD2                                    44880001
.*       AIF   ('&MF' NE 'GEN').REST2                                   44920001
.*       GENDTL ADDR=(LBRACR14),                                     X  44960001
.*             CONTROL=&CONTROL,LOCKOPT=&LOCKOPT                        45000001
.*       AGO   .REST2                                                   45040001
.MOD2    ANOP                                                           45080000
.*       MODDTL ADDR=(LBRACR14),                                     X  45120001
.*             CONTROL=&CONTROL,LOCKOPT=&LOCKOPT                        45160001
.*       AGO   .REST2                                                   45200001
.CNL     AIF   (K'&KEEP EQ 0).CNLNK                                     45240000
.*       AIF   ('&MF' EQ 'MOD').MOD3                                    45280001
.*       AIF   ('&MF' NE 'GEN').REST2                                   45320001
.*       GENDTL ADDR=(LBRACR14),                                     X  45360001
.*             CONTROL=&CONTROL,KEEP=&KEEP                              45400001
.*       AGO   .REST2                                                   45440001
.MOD3    ANOP                                                           45480000
.*       MODDTL ADDR=(LBRACR14),                                     X  45520001
.*             CONTROL=&CONTROL,KEEP=&KEEP                              45560001
.*       AGO   .REST2                                                   45600001
.CNLNK   ANOP                                                           45640000
.*       AIF   ('&MF' EQ 'MOD').MOD4                                    45680001
.*       AIF   ('&MF' NE 'GEN').REST2                                   45720001
.*       GENDTL ADDR=(LBRACR14),                                     X  45760001
.*             CONTROL=&CONTROL                                         45800001
.*       AGO   .REST2                                                   45840001
.MOD4    ANOP                                                           45880000
.*       MODDTL ADDR=(LBRACR14),                                     X  45920001
.*             CONTROL=&CONTROL                                         45960001
.*       AGO   .REST2                                                   46000001
.NC      ANOP                                                           46040000
.*       AIF   (K'&LOCKOPT EQ 0).K                                      46080001
.*       AIF   (K'&KEEP EQ 0).NCLNK                                     46120001
.*       AIF   ('&MF' EQ 'MOD').MOD5                                    46160001
.*       AIF   ('&MF' NE 'GEN').REST2                                   46200001
.*       GENDTL ADDR=(LBRACR14),                                     X  46240001
.*             LOCKOPT=&LOCKOPT,KEEP=&KEEP                              46280001
.*       AGO   .REST2                                                   46320001
.MOD5    ANOP                                                           46360000
.*       MODDTL ADDR=(LBRACR14),                                     X  46400001
.*             LOCKOPT=&LOCKOPT,KEEP=&KEEP                              46440001
.*       AGO   .REST2                                                   46480001
.NCLNK   ANOP                                                           46520000
.*       AIF   ('&MF' EQ 'MOD').MOD6                                    46560001
.*       AIF   ('&MF' NE 'GEN').REST2                                   46600001
.*       GENDTL ADDR=(LBRACR14),                                     X  46640001
.*             LOCKOPT=&LOCKOPT                                         46680001
.*       AGO   .REST2                                                   46720001
.MOD6    ANOP                                                           46760000
.*       MODDTL ADDR=(LBRACR14),                                     X  46800001
.*             LOCKOPT=&LOCKOPT                                         46840001
.*       AGO   .REST2                                                   46880001
.K       ANOP                                                           46920000
.*       AIF   ('&MF' EQ 'MOD').MOD7                                    46960001
.*       AIF   ('&MF' NE 'GEN').REST2                                   47000001
.*       GENDTL ADDR=(LBRACR14),                                     X  47040001
.*             KEEP=&KEEP                                               47080001
.*       AGO   .REST2                                                   47120001
.MOD7    ANOP                                                           47160000
.*       MODDTL ADDR=(LBRACR14),                                     X  47200001
.*             KEEP=&KEEP                                               47240001
.REST2   ANOP                                                           47280000
.*       LR    LBRACCR1,LBRACCR2     RESTORE REG 1 FROM REGISTER 2      47320001
.*       L     LBRACCR2,LBRSAVE2     RESTORE REG 2 FROM CONTROL BLOCK   47360001
.*       AGO   .EXIT                                                    47400001
.MODLCK  ANOP                                                           47440000
.*                                                                      47480000
.*       WHEN CALLED AS INNER MACRO FOR MF = LOCK IT PASSES             47520000
.*       THE LOCK OPTIONS (IF ANY) TO THE DTL MACRO AND GETS THE        47560000
.*       ADDRESSES OF THE VOLID AND RESOURCE NAME.                      47600000
.*                                                                      47640000
.*                                                                      47680000
.*       L     15,LBRINFO            LIBRARY DEFINITION                 47720001
.*       USING LIBINFO,15                                               47760001
.*       L     15,LBRINFOC                     TABLE POINTER            47800001
.*       USING INLCLDTE,15                                              47840001
.*       LA    14,LDTEVOLS           VOLID POINTER                      47880001
.*       LA    15,LDTERNME           RESOURCE NAME POINTER              47920001
.*       DROP  15                                                       47960001
.*       L     1,LBRDTL              ADDRESS OF LOCK TABLE ENTRY        48000001
.* &K1LCK   SETA  K'&CONTROL+K'&LOCKOPT+K'&KEEP                         48040001
.*       AIF   (&K1LCK NE 0).PARMLCK                                    48080001
.*       MODDTL ADDR=(1),                                            X  48120001
.*             NAME=(15),VOLID=(14)                                     48160001
.*       AGO   .EXIT                                                    48200001
.PARMLCK ANOP                                                           48240000
.*       AIF   (K'&CONTROL EQ 0).NCLCK                                  48280001
.*       AIF   (K'&LOCKOPT EQ 0).CNLLCK                                 48320001
.*       AIF   (K'&KEEP EQ 0).CLLCK                                     48360001
.*       MODDTL ADDR=(1),                                            X  48400001
.*             CONTROL=&CONTROL,LOCKOPT=&LOCKOPT,KEEP=&KEEP,         X  48440001
.*             NAME=(15),VOLID=(14)                                     48480001
.*       AGO   .EXIT                                                    48520001
.CLLCK   ANOP                                                           48560000
.*       MODDTL ADDR=(1),                                            X  48600001
.*             CONTROL=&CONTROL,LOCKOPT=&LOCKOPT,                    X  48640001
.*             NAME=(15),VOLID=(14)                                     48680001
.*       AGO   .EXIT                                                    48720001
.CNLLCK  AIF   (K'&KEEP EQ 0).CNLNKLK                                   48760000
.*       MODDTL ADDR=(1),                                            X  48800001
.*             CONTROL=&CONTROL,KEEP=&KEEP,                          X  48840001
.*             NAME=(15),VOLID=(14)                                     48880001
.*       AGO   .EXIT                                                    48920001
.CNLNKLK ANOP                                                           48960000
.*       MODDTL ADDR=(1),                                            X  49000001
.*             CONTROL=&CONTROL,                                     X  49040001
.*             NAME=(15),VOLID=(14)                                     49080001
.*       AGO   .EXIT                                                    49120001
.NCLCK   ANOP                                                           49160000
.*       AIF   (K'&LOCKOPT EQ 0).KLCK                                   49200001
.*       AIF   (K'&KEEP EQ 0).NCLNKLK                                   49240001
.*       MODDTL ADDR=(1),                                            X  49280001
.*             LOCKOPT=&LOCKOPT,KEEP=&KEEP,                          X  49320001
.*             NAME=(15),VOLID=(14)                                     49360001
.*       AGO   .EXIT                                                    49400001
.NCLNKLK ANOP                                                           49440000
.*       MODDTL ADDR=(1),                                            X  49480001
.*             LOCKOPT=&LOCKOPT,                                     X  49520001
.*             NAME=(15),VOLID=(14)                                     49560001
.*       AGO   .EXIT                                                    49600001
.KLCK    ANOP                                                           49640000
.*       MODDTL ADDR=(1),                                            X  49680001
.*             KEEP=&KEEP,                                           X  49720001
.*             NAME=(15),VOLID=(14)                                     49760001
.EXIT    ANOP                                                           49800000
&FC      SETC  ''                                                       49840000
         DROP  LBRACCR1                                                 49880000
         MEND                             END OF PLS COMMENT         */ 49920000
*%PLSACCCB:;                                                            49960000
*%LBRACCCB: MACRO KEYS(MF,                                              50000000
*                      AREA,                                            50040000
*                      LIBTYPE,                                         50080000
*                      LIBUSE,                                          50120000
*                      CHAINID,                                         50160000
*                      LIBINFO,                                         50200000
*                      CHAIN,                                           50240000
*                      LAMB,                                            50280000
*                      FILENAM,                                         50320000
*                      SUBLIB,                                          50360000
*                      DEFINE,                                          50400000
*                      REPLACE,                                         50440000
*                      LEVEL,                                           50480000
*                      DEFAULT,                                         50520000
*                      CONTROL,                                         50560000
*                      LOCKOPT,                                         50600000
*                      KEEP,                                            50608001
*                                                          /*@D14LDFB*/ 50616001
*                      PID,                                             50624001
*                                                          /*@D52EDUT*/ 50632001
*                      WAREA,                                           50640001
*                                                          /*@D52EDUT*/ 50648001
*                      LEN,                                             50656001
*                                                          /*@D52EDUT*/ 50664001
*                      CSECT);                             /*@D52EDUT*/ 50672001
* /*******************************************************************/ 50680000
* /*  PLS PART OF LBRACCCB MACRO, DESCRIPTION SEE ASM PART           */ 50720000
* /*******************************************************************/ 50760000
* DCL (SYNERR,                        /* SYNTAX ERROR IN MACRO       */ 50800000
*      INNER,                         /* LBRACCCB IS INNER MACRO     */ 50840000
*      RC,                            /* RETURN CODE FOR LBRACCES    */ 50880000
*      LBRACMP,                       /* CONTROLS GENERATION OF MAPS */ 50920000
*      LBR0SCO)                       /* CONTROLS DSECT OF SYSCOM    */ 50960000
*      FIXED EXTERNAL;                                                  51000000
* DCL (FC,                            /* MAIN FUNCTION OF LBRACCES   */ 51040000
*      TAREA)                         /* ADDRESS OF CONTROL BLOCK    */ 51080000
*      CHARACTER EXTERNAL;                                              51120000
* DCL P   CHARACTER;                                   /* TEMP */       51160002
* DCL (IN,IN1,TLABEL,TINFO,TBYTE,TCHID) CHARACTER;/*@D14LDFB*/          51170002
* DCL (COL1,COLA,COLA1,COLB,COLC,COLD,RCL,SYNER1,REGERR,RCWARN,RCERR,   51200000
*      CHAREA,K2,CNTERR) FIXED;                            /*@D52EDUT*/ 51240001
* COL1 = MACGLMAR;                                                      51290002
* COLA = MACLMAR;                                                       51320000
* COLA1 = COLA+5;                                                       51360000
* COLB = COLA+13;                                                       51400000
* COLC = COLB+10;                                                       51440000
* COLD = COLC+12;                                                       51480000
* RCWARN = 4;                                                           51520000
* RCERR = 8;                                                            51560000
* RCL = 0;                                                              51600000
* SYNERR= 0;                                                            51613301
* SYNER1=0;                                                             51626601
* IN = MACLABEL||' '||MACNAME||' '||MACLIST||' '||MACKEYS;              51640000
* IN1 = ' LIBRARIAN - LBRACCCB - 5666-301-06-H07  - VERSION 85-04-09';  51680000
* /*******************************************************************/ 51720000
* /*  DO NOT GENERATE ANY MAPS OR EQUATES, IF LBRACMP = 1            */ 51760000
* /*******************************************************************/ 51800000
* IF LBRACMP = 0 THEN                                                   51840000
*    DO;                                                                51880000
*    IF MF(1) = 'MAP' THEN                                              51920000
*       DO;                                                             51960000
*       P = MACPARM;                                      /* TEMP */    51970004
*       ANS (COMMENT(IN)) COL(COLA1) SKIP RESCAN;                       52000000
*       ANS (COMMENT(IN1)) COL(COLA) SKIP RESCAN;                       52040000
*       END;                                                            52080000
*    ANS ('? INLCLPT BASED(YES) TABLE(YES) ROW(YES) FCODE(YES);')       52120000
*           COL(COLA) SKIP RESCAN;                                      52160000
*    ANS ('? INLCLOT BASED(YES) TABLE(YES) ENTRY(YES);') COL(COLA)      52200000
*          SKIP RESCAN;                                                 52240000
*    ANS ('? INLCLDTE BASED(YES);') COL(COLA) SKIP RESCAN;              52280000
*    ANS ('? INLCSDTE BASED(YES);') COL(COLA) SKIP RESCAN; /*@D14LDFB*/ 52320000
*    ANS ('? LBRACCDS;') COL(COLA) SKIP RESCAN;                         52360000
*    ANS (MACCONC||'INCLUDE SYSLIB(MAPDTL);') COL(COLA) SKIP RESCAN;    52400000
*    LBRACMP = 1;                                                       52440000
* /*******************************************************************/ 52480000
* /*  DO NOT GENERATE DSECT FOR SYSCOM, IF LBR0SCO = 1               */ 52520000
* /*******************************************************************/ 52560000
*    IF P = 'ASM'  THEN                                 /* TEMP  */     52600005
*                GOTO ASM;                              /* TEMP  */     52610002
*    IF LBR0SCO = 0 THEN                                                52620002
*       DO;                                                             52640000
        ANS ('%INCLUDE SYSLIB(SYSCOM) NOSEGMENT;')        /* @D66GDMK*/ 52650016
                                 RESCAN  COL(COLA) SKIP;  /* @D66GDMK*/ 52660014
*       LBR0SCO = 1;                                                    52800000
*       END;                                                            52840000
*    GOTO NOASM;                                        /* TEMP  */     52881003
*    ASM:                                               /* TEMP  */     52890002
*    IF LBR0SCO = 0 THEN                                /* TEMP  */     52891002
*       DO;                                             /* TEMP  */     52892002
*       ANS ('GENERATE DATA;') COL(COLA) SKIP;          /* TEMP  */     52893002
*       ANS ('SYSCOM   SYSCOM') COL(COL1);              /* TEMP  */     52893102
*       ANS (MACCONC||'ENDGEN;') COL(COLA) SKIP RESCAN; /* TEMP  */     52893202
*       LBR0SCO = 1;                                    /* TEMP  */     52894002
*       END;                                            /* TEMP  */     52896003
*    NOASM:                                             /* TEMP  */     52900002
*    END;                                                               52910003
* /*******************************************************************/ 52920000
* /*  FOR MF(MAP) NO OTHER PARAMETERS ARE VALID                      */ 52960000
* /*******************************************************************/ 53000000
* IF MF(1) = 'MAP' THEN                                                 53040000
*    DO;                                                                53080000
*    K2 = NUMBER(AREA) + NUMBER(LIBTYPE) + NUMBER(LIBUSE) +             53120001
*       NUMBER(LIBINFO) + NUMBER(CHAIN) + NUMBER(CHAINID) +             53160000
*    NUMBER(FILENAM)+ NUMBER(LAMB)+ NUMBER(DEFAULT)+ NUMBER(REPLACE)+   53210001
*       NUMBER(DEFINE) + NUMBER(CONTROL) + NUMBER(LOCKOPT) +            53280000
*       NUMBER(KEEP) + NUMBER(SUBLIB) + NUMBER(LEVEL)+                  53304001
*       NUMBER(PID) + NUMBER(WAREA) + NUMBER(LEN);                      53328001
*                                                          /*@D52EDUT*/ 53352001
*    IF K2 ¬= 0 THEN DO;                                   /*@D52EDUT*/ 53376001
*       ANS MSG ('ALL OTHER PARAMETERS IGNORED FOR MF(MAP)')            53400000
*                 SKIP COL(COLA);                                       53440000
*       RCL = RCWARN;                                                   53480000
*       END;                                                            53520000
*    GOTO MEND;                                                         53560000
*    END;                                                               53600000
* IF INNER = 0 THEN                                                     53640000
*    DO;                                                                53680000
*    ANS (COMMENT(IN)) COL(COLA) SKIP RESCAN;                           53720000
*    ANS (COMMENT(IN1)) COL(COLA) SKIP RESCAN;                          53760000
*    RC = 0;                                                            53800000
*    END;                                                               53840000
* /*******************************************************************/ 53880000
* /*  CHECK MAIN FUNCTION                                            */ 53920000
* /*******************************************************************/ 53960000
* IF NUMBER(MF) = 0 THEN                                                54000000
*    DO;                                                                54040000
*    ANS MSG ('MF IS NOT SPECIFIED, GENERATION SUPPRESSED')             54080000
*                                      COL(COLA) SKIP;                  54120000
* /*  SYNTAX CHECK CONTINUES                                         */ 54160000
*    RCL = RCERR;                                                       54200000
*    SYNER1 = 1;                                                        54240000
*    GOTO VALMF;                                                        54280000
*    END;                                                               54320000
* IF MF(1) = 'DCL' THEN                                                 54360000
*    GOTO VALMF;                                                        54400000
* IF MF(1) = 'GEN' THEN                                                 54440000
*    GOTO VALMF;                                                        54480000
* IF MF(1) = 'MOD' THEN                                                 54520000
*    GOTO VALMF;                                                        54560000
* ANS MSG ('MF REQUEST IS INVALID, GENERATION SUPPRESSED')              54600000
*                                     COL(COLA) SKIP;                   54640000
* /*  SYNTAX CHECK CONTINUES                                         */ 54680000
* RCL = RCERR;                                                          54720000
* SYNER1 = 1;                                                           54760000
* VALMF:;                                                               54800000
* /*******************************************************************/ 54840000
* /*  CHECK LIBTYPE                                                  */ 54880000
* /*******************************************************************/ 54920000
* IF NUMBER(LIBTYPE) = 0 THEN                                           54960000
*    GOTO VALTYPE;                                                      55000000
* IF LIBTYPE(1) = 'PHASE' THEN                             /*@D14LDFB*/ 55040000
*    GOTO VALTYPE;                                                      55080000
* IF LIBTYPE(1) = 'OBJ' THEN                               /*@D14LDFB*/ 55120000
*    GOTO VALTYPE;                                                      55160000
* IF LIBTYPE(1) = 'SOURCE' THEN                            /*@D14LDFB*/ 55200000
*    GOTO VALTYPE;                                                      55240000
* IF LIBTYPE(1) = 'PROC' THEN                              /*@D14LDFB*/ 55280000
*    GOTO VALTYPE;                                                      55320000
* IF LIBTYPE(1) = 'SPHASE' THEN                            /*@D14LDFB*/ 55360000
*    GOTO VALTYPE;                                                      55400000
* IF LIBTYPE(1) = 'SOBJ' THEN                              /*@D14LDFB*/ 55440000
*    GOTO VALTYPE;                                                      55480000
* IF LIBTYPE(1) = 'SSOURCE' THEN                           /*@D14LDFB*/ 55520000
*    GOTO VALTYPE;                                                      55560000
* IF LIBTYPE(1) = 'SPROC' THEN                             /*@D14LDFB*/ 55600000
*    GOTO VALTYPE;                                                      55640000
* IF LIBTYPE(1) = 'LBR'   THEN                             /*@D14LDFB*/ 55680000
*    GOTO VALTYPE;                                         /*@D14LDFB*/ 55720000
* IF LIBTYPE(1) = 'DUMP'  THEN                             /*@D14LDFB*/ 55760000
*    GOTO VALTYPE;                                         /*@D14LDFB*/ 55800000
* IF LIBTYPE(1) = 'ALL'  THEN                              /*@D52EDUT*/ 55813301
*    GOTO VALTYPE;                                         /*@D52EDUT*/ 55826601
* ANS MSG ('LIBTYPE REQUEST IS INVALID, GENERATION SUPPRESSED')         55840000
*                                          COL(COLA) SKIP;              55880000
* /*  SYNTAX CHECK CONTINUES                                         */ 55920000
* RCL = RCERR;                                                          55960000
* SYNER1  = 1;                                                          56000000
* VALTYPE:;                                                             56040000
* /**********************************************************@D52EDUT*/ 56041001
* /*  CHECK WORKAREA FOR LIBTYPE = ALL                       @D52EDUT*/ 56042001
* /**********************************************************@D52EDUT*/ 56043001
* IF LIBTYPE(1) ¬= 'ALL' THEN                              /*@D52EDUT*/ 56044001
*    DO;                                                   /*@D52EDUT*/ 56045001
*    K2= NUMBER(WAREA) + NUMBER(LEN);                      /*@D52EDUT*/ 56046001
*    IF K2 ¬= 0 THEN DO;                                   /*@D52EDUT*/ 56047001
* ANS MSG ('INVALID PARAMETERS SPECIFIED FOR LIBTYPE ¬= ALL')           56048001
*       COL(COLA) SKIP;                                    /*@D52EDUT*/ 56049001
*       RCL = RCERR;                                       /*@D52EDUT*/ 56050001
*       SYNER1 = 1;                                        /*@D52EDUT*/ 56051001
*       END;                                               /*@D52EDUT*/ 56052001
*    END;                                                  /*@D52EDUT*/ 56053001
*    ELSE DO;                                              /*@D52EDUT*/ 56054001
*      IF (NUMBER(WAREA) = 0) |  (WAREA = '') | ((MF(1)¬='DCL') &       56055001
*        ((NUMBER(LEN) = 0) | (LEN = '')))THEN DO;         /*@D52EDUT*/ 56056001
*         ANS MSG                                                       56057001
*       ('WORKAREA OR LEN REQUEST IS INVALID, GENERATION SUPPRESSED')   56058001
*         COL(COLA) SKIP;                                  /*@D52EDUT*/ 56059001
*         RCL = RCERR;                                     /*@D52EDUT*/ 56060001
*         SYNER1  = 1;                                     /*@D52EDUT*/ 56061001
*         END;                                             /*@D52EDUT*/ 56062001
*      ELSE DO;                                            /*@D52EDUT*/ 56063001
*        K2=  NUMBER(LIBUSE) +                                          56064001
*             NUMBER(LIBINFO) + NUMBER(CHAIN) + NUMBER(CHAINID) +       56065001
*             NUMBER(FILENAM) + NUMBER(LAMB) +                          56066001
*             NUMBER(DEFAULT) + NUMBER(REPLACE) +                       56067001
*             NUMBER(DEFINE) + NUMBER(CONTROL) + NUMBER(LOCKOPT) +      56068001
*             NUMBER(KEEP) + NUMBER(SUBLIB) + NUMBER(LEVEL)+            56069001
*             NUMBER(PID);                                 /*@D52EDUT*/ 56070001
*        IF K2 ¬= 0 THEN DO;                               /*@D52EDUT*/ 56071001
*       ANS MSG ('INVALID PARAMETERS SPECIFIED FOR LIBTYPE = ALL')      56072001
*           COL(COLA) SKIP;                                /*@D52EDUT*/ 56073001
*           RCL = RCERR;                                   /*@D52EDUT*/ 56074001
*           SYNER1  = 1;                                   /*@D52EDUT*/ 56075001
*           END;                                           /*@D52EDUT*/ 56076001
*        END;                                              /*@D52EDUT*/ 56077001
*     END;                                                 /*@D52EDUT*/ 56078001
* /*******************************************************************/ 56080000
* /*  CHECK LIBUSE                                                   */ 56120000
* /*******************************************************************/ 56160000
* IF NUMBER(LIBUSE) = 0 THEN                                            56200000
*    GOTO VALUSE;                                                       56240000
* IF LIBUSE(1) = 'SEARCH' THEN                                          56280000
*    GOTO VALUSE;                                                       56320000
* IF LIBUSE(1) = 'TO' THEN                                              56360000
*    GOTO VALUSE;                                                       56400000
* IF LIBUSE(1) = 'FROM' THEN                                            56440000
*    GOTO VALUSE;                                                       56480000
* IF LIBUSE(1) = 'ACCESS' THEN                             /*@D14LDFB*/ 56520000
*    GOTO VALUSE;                                                       56560000
* IF LIBUSE(1) = 'USER'   THEN                             /*@D14LDFB*/ 56600000
*    IF NUMBER(CHAINID) ¬= 0 THEN                          /*@D14LDFB*/ 56640000
*    GOTO VALUSE;                                                       56680000
* IF LIBUSE(1) = 'CATALOG' THEN                            /*@D14LDFB*/ 56720000
*    GOTO VALUSE;                                                       56760000
* ANS MSG ('LIBUSE REQUEST IS INVALID, GENERATION SUPPRESSED')          56800000
*                                         COL(COLA) SKIP;               56840000
* /*  SYNTAX CHECK CONTINUES                                         */ 56880000
* RCL = RCERR;                                                          56920000
* SYNER1 = 1;                                                           56960000
* VALUSE:;                                                              57000000
* /*******************************************************************/ 57040000
* /*  CHECK SEARCH ORDER                                             */ 57080000
* /*******************************************************************/ 57120000
* IF NUMBER(CHAIN) = 0 THEN                                             57160000
*    GOTO VALCHN;                                                       57200000
* IF CHAIN(1) = 'TEMP' THEN                                             57240000
*    GOTO VALCHN;                                                       57280000
* IF CHAIN(1) = 'PERM' THEN                                             57320000
*    GOTO VALCHN;                                                       57360000
* IF CHAIN(1) = 'BOTH' THEN                                             57400000
*    GOTO VALCHN;                                                       57440000
* ANS MSG ('CHAIN REQUEST IS INVALID, GENERATION SUPPRESSED')           57480000
*                                        COL(COLA) SKIP;                57520000
* /*  SYNTAX CHECK CONTINUES                                         */ 57560000
* RCL = RCERR;                                                          57600000
* SYNER1 = 1;                                                           57640000
* VALCHN:;                                                              57680000
* /*******************************************************************/ 57720000
* /*  CHECK DEFINE                                           @D14LDFB*/ 57760000
* /*******************************************************************/ 57800000
* IF NUMBER(DEFINE) = 0 THEN                               /*@D14LDFB*/ 57840000
*    GOTO VALDFN;                                          /*@D14LDFB*/ 57880000
* IF DEFINE(1) = 'NEW' THEN                                /*@D14LDFB*/ 57920000
*    GOTO VALDFN;                                          /*@D14LDFB*/ 57960000
* IF DEFINE(1) = 'DUMMY' THEN                              /*@D14LDFB*/ 58000000
*    GOTO VALDFN;                                          /*@D14LDFB*/ 58040000
* IF DEFINE(1) = 'OLD' THEN                                /*@D14LDFB*/ 58080000
*    GOTO VALDFN;                                          /*@D14LDFB*/ 58120000
* ANS MSG ('DEFINE REQUEST IS INVALID, GENERATION SUPPRESSED')          58160000
*                                        COL(COLA) SKIP;   /*@D14LDFB*/ 58200000
* /*  SYNTAX CHECK CONTINUES                                 @D14LDFB*/ 58240000
* RCL = RCERR;                                             /*@D14LDFB*/ 58280000
* SYNER1 = 1;                                              /*@D14LDFB*/ 58320000
* VALDFN:;                                                 /*@D14LDFB*/ 58360000
* /*******************************************************************/ 58400000
* /*  CHECK REPLACE                                          @D14LDFB*/ 58440000
* /*******************************************************************/ 58480000
* IF NUMBER(REPLACE) = 0 THEN                              /*@D14LDFB*/ 58520000
*    GOTO VALREP;                                          /*@D14LDFB*/ 58560000
* IF REPLACE(1) = 'YES' THEN                               /*@D14LDFB*/ 58600000
*    GOTO VALREP;                                          /*@D14LDFB*/ 58640000
* IF REPLACE(1) = 'NO' THEN                                /*@D14LDFB*/ 58680000
*    GOTO VALREP;                                          /*@D14LDFB*/ 58720000
* ANS MSG ('REPLACE REQUEST IS INVALID, GENERATION SUPPRESSED')         58760000
*                                        COL(COLA) SKIP;   /*@D14LDFB*/ 58800000
* /*  SYNTAX CHECK CONTINUES                                 @D14LDFB*/ 58840000
* RCL = RCERR;                                             /*@D14LDFB*/ 58880000
* SYNER1 = 1;                                              /*@D14LDFB*/ 58920000
* VALREP:;                                                 /*@D14LDFB*/ 58960000
* /*******************************************************************/ 59000000
* /*  CHECK LEVEL                                            @D14LDFB*/ 59040000
* /*******************************************************************/ 59080000
* IF NUMBER(LEVEL)  = 0 THEN                               /*@D14LDFB*/ 59120000
*    GOTO VALLVL;                                          /*@D14LDFB*/ 59160000
* IF LEVEL(1)  = 'LIB' THEN                                /*@D14LDFB*/ 59200000
*    GOTO VALLVL;                                          /*@D14LDFB*/ 59240000
* IF LEVEL(1) = 'SUBLIB' THEN                              /*@D14LDFB*/ 59280000
*    GOTO VALLVL;                                          /*@D14LDFB*/ 59320000
* IF LEVEL(1) = 'BOTH' THEN                                /*@D14LDFB*/ 59360000
*    GOTO VALLVL;                                          /*@D14LDFB*/ 59400000
* ANS MSG ('LEVEL  REQUEST IS INVALID, GENERATION SUPPRESSED')          59440000
*                                        COL(COLA) SKIP;   /*@D14LDFB*/ 59480000
* /*  SYNTAX CHECK CONTINUES                                 @D14LDFB*/ 59520000
* RCL = RCERR;                                             /*@D14LDFB*/ 59560000
* SYNER1 = 1;                                              /*@D14LDFB*/ 59600000
* VALLVL:;                                                 /*@D14LDFB*/ 59640000
* /*******************************************************************/ 59680000
* /*  CHECK DEFAULT                                                  */ 59720000
* /*******************************************************************/ 59760000
* IF NUMBER(DEFAULT) = 0 THEN                                           59800000
*    GOTO VALDEF;                                                       59840000
* IF DEFAULT(1) = 'YES' THEN                                            59880000
*    GOTO VALDEF;                                                       59920000
* IF DEFAULT(1) = 'NO' THEN                                             59960000
*    GOTO VALDEF;                                                       60000000
* ANS MSG ('DEFAULT REQUEST IS INVALID, GENERATION SUPPRESSED')         60040000
*                                          COL(COLA) SKIP;              60080000
* /*  SYNTAX CHECK CONTINUES                                         */ 60120000
* RCL = RCERR;                                                          60160000
* SYNER1 = 1;                                                           60200000
* VALDEF:;                                                              60240000
* /*******************************************************************/ 60280000
* /*  CHECK CONTROL                                                  */ 60320000
* /*******************************************************************/ 60360000
* IF NUMBER(CONTROL) = 0 THEN                                           60400000
*    GOTO VALCON;                                                       60440000
* IF CONTROL(1) = 'S' THEN                                              60480000
*    GOTO VALCON;                                                       60520000
* IF CONTROL(1) = 'E' THEN                                              60560000
*    GOTO VALCON;                                                       60600000
* ANS MSG ('CONTROL REQUEST IS INVALID, GENERATION SUPPRESSED')         60640000
*                                          COL(COLA) SKIP;              60680000
* /*  SYNTAX CHECK CONTINUES                                         */ 60720000
* RCL = RCERR;                                                          60760000
* SYNER1 = 1;                                                           60800000
* VALCON:;                                                              60840000
* /*******************************************************************/ 60880000
* /*  CHECK LOCKOPT                                                  */ 60920000
* /*******************************************************************/ 60960000
* IF NUMBER(LOCKOPT) = 0 THEN                                           61000000
*    GOTO VALSHR;                                                       61040000
* IF LOCKOPT(1) = '1' THEN                                              61080000
*    GOTO VALSHR;                                                       61120000
* IF LOCKOPT(1) = '2' THEN                                              61160000
*    GOTO VALSHR;                                                       61200000
* ANS MSG ('LOCKOPT REQUEST IS INVALID, GENERATION SUPPRESSED')         61240000
*                                          COL(COLA) SKIP;              61280000
* /*  SYNTAX CHECK CONTINUES                                         */ 61320000
* RCL = RCERR;                                                          61360000
* SYNER1 = 1;                                                           61400000
* VALSHR:;                                                              61440000
* /*******************************************************************/ 61480000
* /*  CHECK KEEP                                                     */ 61520000
* /*******************************************************************/ 61560000
* IF NUMBER(KEEP) = 0 THEN                                              61600000
*    GOTO VALKEP;                                                       61640000
* IF KEEP(1) = 'YES' THEN                                               61680000
*    GOTO VALKEP;                                                       61720000
* IF KEEP(1) = 'NO' THEN                                                61760000
*    GOTO VALKEP;                                                       61800000
* ANS MSG ('KEEP REQUEST IS INVALID, GENERATION SUPPRESSED')            61840000
*                                       COL(COLA) SKIP;                 61880000
* /*  SYNTAX CHECK CONTINUES                                         */ 61920000
* RCL = RCERR;                                                          61960000
* SYNER1 = 1;                                                           62000000
* VALKEP:;                                                              62040000
* /*******************************************************************/ 62080000
* /*  CROSS CHECKING FOR MF(DCL): AREA AND REGISTER NOTATION INVALID */ 62120000
* /*  FOR PID ONLY CONSTANT ALLOWED                                  */ 62146601
* /*          SUBLIB,DEFINE,LEVEL,FILENAM,REPLACE,LEN IGNORED        */ 62173201
* /*******************************************************************/ 62200000
* IF MF(1) = 'DCL' THEN                                                 62240000
*    DO;                                                                62280000
* /*******************************************************************/ 62320000
* /*  CHECK IF AREA IS SPECIFIED FOR MF(DCL)                         */ 62360000
* /*******************************************************************/ 62400000
*    IF NUMBER(AREA) ¬= 0 THEN                                          62440000
*       DO;                                                             62480000
*       ANS MSG ('AREA IGNORED FOR MF(DCL)')                            62520000
*                 SKIP COL(COLA);                                       62560000
* /*  SYNTAX CHECK CONTINUES                                         */ 62600000
*       RCL = RCWARN;                                                   62640000
*       END;                                                            62680000
* /*******************************************************************/ 62720000
* /*  CHECK REGISTER NOTATION FOR LIBINFO                            */ 62760000
* /*******************************************************************/ 62800000
*    IF NUMBER(LIBINFO) > 0 THEN                                        62840000
*       IF LIBINFO(1,1:1) = '(' THEN                                    62880000
*          REGERR = 1;                                                  62920000
* /*  SYNTAX CHECK CONTINUES                                         */ 62960000
* /*******************************************************************/ 63000000
* /*  CHECK REGISTER NOTATION FOR CHAINID                            */ 63040000
* /*******************************************************************/ 63080000
*    IF NUMBER(CHAINID) > 0 THEN                           /*@D14LDFB*/ 63120000
*       IF CHAINID(1,1:1) = '(' THEN                       /*@D14LDFB*/ 63160000
*          REGERR = 1;                                     /*@D14LDFB*/ 63200000
* /*  SYNTAX CHECK CONTINUES                               /*@D14LDFB*/ 63240000
* /*******************************************************************/ 63280000
* /*  CHECK REGISTER NOTATION FOR LAMB                               */ 63320000
* /*******************************************************************/ 63360000
*    IF NUMBER(LAMB) > 0 THEN                              /*@D14LDFB*/ 63400000
*       IF LAMB(1,1:1) = '(' THEN                          /*@D14LDFB*/ 63440000
*          REGERR = 1;                                     /*@D14LDFB*/ 63480000
* /*  SYNTAX CHECK CONTINUES                               /*@D52EDUT*/ 63482301
* /*******************************************************************/ 63484601
* /*  CHECK REGISTER NOTATION FOR WORKAREA                           */ 63486901
* /*******************************************************************/ 63489201
*    IF NUMBER(WAREA) > 0 THEN                             /*@D52EDUT*/ 63491501
*       IF WAREA(1,1:1) = '(' THEN                         /*@D52EDUT*/ 63493801
*          REGERR = 1;                                     /*@D52EDUT*/ 63496101
* /*******************************************************************/ 63498401
* /*  CHECK REGISTER NOTATION FOR PID                                */ 63500701
* /*******************************************************************/ 63503001
*    IF NUMBER(PID) > 0 THEN DO;                           /*@D52EDUT*/ 63505301
*       IF PID(1,1:1) = '(' THEN                           /*@D52EDUT*/ 63507601
*          CNTERR = 1;                                     /*@D52EDUT*/ 63509901
*       IF PID(1,1:1) ¬='''' | PID(1,4:4)¬='''' THEN       /*@D52EDUT*/ 63512201
*          CNTERR = 1;                                     /*@D52EDUT*/ 63514501
*       END;                                                            63516801
* /*  SYNTAX CHECK CONTINUES                                         */ 63520000
*    IF REGERR = 1 THEN                                                 63560000
*       DO;                                                             63600000
*       ANS MSG ('NO REGISTER NOTATION FOR MF(DCL),' ||                 63640000
*            ' GENERATION SUPPRESSED')                                  63680000
*            COL(COLA) SKIP;                                            63720000
*       RCL = RCERR;                                                    63800000
*       SYNER1 = 1;                                                     63840000
*       END;                                                            63844001
*    IF CNTERR = 1 THEN                                   /*@D52EDUT*/  63848001
*       DO;                                                /*@D52EDUT*/ 63852001
*       ANS MSG ('ONLY CONSTANT PID ALLOWED FOR MF(DCL),'||/*@D52EDUT*/ 63856001
*            ' GENERATION SUPPRESSED')                     /*@D52EDUT*/ 63860001
*            COL(COLA) SKIP;                               /*@D52EDUT*/ 63864001
* /*  SYNTAX CHECK CONTINUES                                         */ 63868001
*       RCL = RCERR;                                       /*@D52EDUT*/ 63872001
*       SYNER1 = 1;                                        /*@D52EDUT*/ 63876001
*       END;                                                            63880000
*    IF NUMBER(FILENAM) ¬= 0 THEN                                       63920000
*       DO;                                                             63960000
*       ANS MSG ('FILENAM REQUEST IGNORED FOR MF(DCL)')                 64000000
*                 COL(COLA) SKIP;                                       64040000
* /*  GENERATION CONTINUES                                           */ 64080000
*       RCL = RCWARN;                                                   64120000
*       END;                                                            64160000
*    IF NUMBER(SUBLIB)  ¬= 0 THEN                          /*@D14LDFB*/ 64200000
*       DO;                                                /*@D14LDFB*/ 64240000
*       ANS MSG ('SUBLIB  REQUEST IGNORED FOR MF(DCL)')    /*@D14LDFB*/ 64280000
*                 COL(COLA) SKIP;                          /*@D14LDFB*/ 64320000
* /*  GENERATION CONTINUES                                           */ 64360000
*       RCL = RCWARN;                                      /*@D14LDFB*/ 64400000
*       END;                                               /*@D14LDFB*/ 64440000
*    IF NUMBER(DEFINE)  ¬= 0 THEN                          /*@D14LDFB*/ 64480000
*       DO;                                                /*@D14LDFB*/ 64520000
*       ANS MSG ('DEFINE  REQUEST IGNORED FOR MF(DCL)')    /*@D14LDFB*/ 64560000
*                 COL(COLA) SKIP;                          /*@D14LDFB*/ 64600000
* /*  GENERATION CONTINUES                                           */ 64640000
*       RCL = RCWARN;                                      /*@D14LDFB*/ 64680000
*       END;                                               /*@D14LDFB*/ 64720000
*    IF NUMBER(REPLACE) ¬= 0 THEN                          /*@D14LDFB*/ 64760000
*       DO;                                                /*@D14LDFB*/ 64800000
*       ANS MSG ('REPLACE REQUEST IGNORED FOR MF(DCL)')    /*@D14LDFB*/ 64840000
*                 COL(COLA) SKIP;                          /*@D14LDFB*/ 64880000
* /*  GENERATION CONTINUES                                           */ 64920000
*       RCL = RCWARN;                                      /*@D14LDFB*/ 64960000
*       END;                                               /*@D14LDFB*/ 65000000
*    IF NUMBER(LEVEL)   ¬= 0 THEN                          /*@D14LDFB*/ 65040000
*       DO;                                                /*@D14LDFB*/ 65080000
*       ANS MSG ('LEVEL   REQUEST IGNORED FOR MF(DCL)')    /*@D14LDFB*/ 65120000
*                 COL(COLA) SKIP;                          /*@D14LDFB*/ 65160000
* /*  GENERATION CONTINUES                                           */ 65165001
*       RCL = RCWARN;                                      /*@D14LDFB*/ 65170001
*       END;                                               /*@D14LDFB*/ 65175001
*    IF NUMBER(LEN)  ¬= 0 THEN                             /*@D52EDUT*/ 65180001
*       DO;                                                /*@D52EDUT*/ 65185001
*       ANS MSG ('LEN REQUEST IGNORED FOR MF(DCL)')        /*@D52EDUT*/ 65190001
*                 COL(COLA) SKIP;                          /*@D52EDUT*/ 65195001
* /*  GENERATION CONTINUES                                           */ 65200000
*       RCL = RCWARN;                                      /*@D14LDFB*/ 65240000
*       END;                                               /*@D14LDFB*/ 65280000
*    END;                                                               65320000
* ELSE                                                                  65360000
*    DO;                                                                65400000
*    IF MF(1) = 'MOD' THEN                                              65440000
*       CHAREA = 1;                                                     65480000
*    IF MF(1) = 'GEN' THEN                                              65520000
*       CHAREA = 1;                                                     65560000
*    IF CHAREA = 1 THEN                                                 65600000
*       IF  NUMBER(AREA) = 0  THEN                                      65640001
*          DO;                                                          65680000
*          ANS MSG('AREA MUST BE SPECIFIED FOR MF(GEN|MOD),'            65720000
*               ||' GENERATION SUPPRESSED') COL(COLA) SKIP;             65760000
*          RCL = RCERR;                                                 65800000
*          SYNER1 = 1;                                                  65840000
*          END;                                                         65880000
*    END;                                                               65920000
* /*******************************************************************/ 65960000
* /*  GENERATION OF CODE IS SUPPRESSED, IF A SYNTAX ERROR WAS FOUND  */ 66000000
* /*  EITHER IN LBRACCES OR LBRACCCB MACRO                           */ 66040000
* /*******************************************************************/ 66080000
* IF SYNER1 = 1 THEN                                                    66120000
*    SYNERR = 1;                                                        66160000
* IF SYNERR = 1 THEN                                                    66200000
*    GOTO MEND;                                                         66240000
* IF MF(1) = 'DCL' THEN                                                 66280000
*    DO;                                                                66320000
*    IF MACLABEL = '' THEN                                              66360000
*       DO;                                                             66400000
*       ANS MSG ('NO LABEL FOR MF(DCL), GENERATION SUPPRESSED')         66440000
*         COL(COLA) SKIP;                                               66480000
*       RCL = 8;                                                        66520000
*       GOTO MEND;                                                      66560000
*       END;                                                            66600000
* /*******************************************************************/ 66640000
* /*  GENERATE INLINE CONTROL BLOCK WITH DCL'S                       */ 66680000
* /*******************************************************************/ 66720000
*    TLABEL = MACLABEL(1:(LENGTH(MACLABEL)-1));                         66760000
*    ANS ('DCL ') COL(COLA) SKIP;                                       66800000
*    ANS ('1 TLABEL STATIC LOCAL BDY(WORD),')                           66840000
*         COL(COLA) SKIP RESCAN;                                        66880000
* /*******************************************************************/ 66920000
* /*  LIBINFO                                                        */ 66960000
* /*******************************************************************/ 67000000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             67040000
*    IF NUMBER(LIBINFO) = 0 THEN                                        67080000
*       ANS ('INIT(0),') COL(COLB);                                     67120000
*    ELSE                                                               67160000
*       ANS ('INIT(ADDR'||LIBINFO||'),') COL(COLB) RESCAN;              67200000
*    ANS ('/* ADDRESS OF LOT + LDT PTRS */') COL(COLD);                 67240000
* /*******************************************************************/ 67280000
* /*  CHAINID                                                        */ 67320000
* /*******************************************************************/ 67360000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                /*@D14LDFB*/ 67400000
*    IF NUMBER(CHAINID) = 0 THEN                           /*@D14LDFB*/ 67440000
*       ANS ('INIT(0),') COL(COLB);                        /*@D14LDFB*/ 67480000
*    ELSE                                                  /*@D14LDFB*/ 67520000
*       ANS ('INIT(ADDR'||CHAINID||'),') COL(COLB) RESCAN; /*@D14LDFB*/ 67560000
*    ANS ('/*ADDRESS OF USER LOT ID @D14LDFB*/') COL(COLD);/*@D14LDFB*/ 67600000
* /*******************************************************************/ 67640000
* /*  RESERVED                                                       */ 67680000
* /*******************************************************************/ 67720000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             67760000
*       ANS ('INIT(0),') COL(COLB);                                     67800000
*    ANS ('/* RESERVED           @D14LDFB*/') COL(COLD);                67840000
* /*******************************************************************/ 67880000
* /*  ADDRESS OF LOCK TABLE ENTRY                                    */ 67920000
* /*******************************************************************/ 67960000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             68000000
*    ANS ('INIT(ADDR(LBRD'||MACINDEX||')),') COL(COLB) RESCAN;          68040000
*    ANS ('/* ADDRESS OF LOCK TABLE ENTRY */') COL(COLD);               68080000
* /*******************************************************************/ 68120000
* /*  LAMB                                                           */ 68160000
* /*******************************************************************/ 68200000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                /*@D14LDFB*/ 68240000
*    IF NUMBER(LAMB) = 0 THEN                              /*@D14LDFB*/ 68280000
*       ANS ('INIT(0),') COL(COLB);                        /*@D14LDFB*/ 68320000
*    ELSE                                                  /*@D14LDFB*/ 68360000
*       ANS ('INIT(ADDR'||LAMB||'),') COL(COLB) RESCAN;    /*@D14LDFB*/ 68400000
*    ANS ('/* ADDRESS OF LAMB OF CALLER */') COL(COLD);    /*@D14LDFB*/ 68440000
* /*******************************************************************/ 68480000
* /*  MAIN FUNCTION                                                  */ 68520000
* /*******************************************************************/ 68560000
*    ANS ('2 * BIT(8) ') COL(COLA+1) SKIP;                              68600000
*    ANS ('INIT(0),') COL(COLB);                                        68640000
*    ANS ('/* MAIN FUNCTION */') COL(COLD);                             68680000
* /*******************************************************************/ 68720000
* /*  LIBTYPE                                                        */ 68760000
* /*******************************************************************/ 68800000
*    ANS ('2 * BIT(8) ') COL(COLA+1) SKIP;                              68840000
*    IF NUMBER(LIBTYPE) ¬= 0 THEN                                       68880000
*       DO;                                                             68920000
*       IF LIBTYPE(1) = 'PHASE' THEN                       /*@D14LDFB*/ 68960000
*          ANS ('INIT(LBRCL),') COL(COLB);                              69000000
*       IF LIBTYPE(1) = 'OBJ' THEN                         /*@D14LDFB*/ 69040000
*          ANS ('INIT(LBRRL),') COL(COLB);                              69080000
*       IF LIBTYPE(1) = 'SOURCE' THEN                      /*@D14LDFB*/ 69120000
*          ANS ('INIT(LBRSL),') COL(COLB);                              69160000
*       IF LIBTYPE(1) = 'PROC' THEN                        /*@D14LDFB*/ 69200000
*          ANS ('INIT(LBRPL),') COL(COLB);                              69240000
*       IF LIBTYPE(1) = 'SPHASE' THEN                      /*@D14LDFB*/ 69280000
*          ANS ('INIT(LBRSCL),') COL(COLB);                             69320000
*       IF LIBTYPE(1) = 'SOBJ' THEN                        /*@D14LDFB*/ 69360000
*          ANS ('INIT(LBRSRL),') COL(COLB);                             69400000
*       IF LIBTYPE(1) = 'SSOURCE' THEN                     /*@D14LDFB*/ 69440000
*          ANS ('INIT(LBRSSL),') COL(COLB);                             69480000
*       IF LIBTYPE(1) = 'SPROC' THEN                       /*@D14LDFB*/ 69520000
*          ANS ('INIT(LBRSPL),') COL(COLB);                             69560000
*       IF LIBTYPE(1) = 'LBR'   THEN                       /*@D14LDFB*/ 69600000
*          ANS ('INIT(LBRLBRTY),') COL(COLB);              /*@D14LDFB*/ 69640000
*       IF LIBTYPE(1) = 'DUMP'  THEN                       /*@D14LDFB*/ 69680000
*          ANS ('INIT(LBRDUMP),') COL(COLB);               /*@D14LDFB*/ 69720000
*       IF LIBTYPE(1) = 'ALL'  THEN                        /*@D52EDUT*/ 69733301
*          ANS ('INIT(LBRALL ),') COL(COLB);               /*@D52EDUT*/ 69746601
*       END;                                                            69760000
*    ELSE                                                               69800000
*       ANS ('INIT(0),') COL(COLB);                                     69840000
*    ANS ('/* LIBRARY TYPE */') COL(COLD);                              69880000
* /*******************************************************************/ 69920000
* /*  LIBUSE                                                         */ 69960000
* /*******************************************************************/ 70000000
*    ANS ('2 * BIT(8) ') COL(COLA+1) SKIP;                              70040000
*    IF NUMBER(LIBUSE) ¬= 0 THEN                                        70080000
*       DO;                                                             70120000
*       IF LIBUSE(1) = 'SEARCH' THEN                                    70160000
*          ANS ('INIT(LBRSEARC),') COL(COLB);                           70200000
*       IF LIBUSE(1) = 'TO' THEN                                        70240000
*          ANS ('INIT(LBRTO),') COL(COLB);                              70280000
*       IF LIBUSE(1) = 'FROM' THEN                                      70320000
*          ANS ('INIT(LBRFROM),') COL(COLB);                            70360000
*       IF LIBUSE(1) = 'ACCESS'  THEN                      /*@D14LDFB*/ 70400000
*          ANS ('INIT(LBRACC),') COL(COLB);                /*@D14LDFB*/ 70440000
*       IF LIBUSE(1) = 'USER'  THEN                        /*@D14LDFB*/ 70480000
*          ANS ('INIT(LBRUSER),') COL(COLB);              /*@D14LDFB*/  70520000
*       IF LIBUSE(1) = 'CATALOG' THEN                      /*@D14LDFB*/ 70560000
*          ANS ('INIT(LBRCAT),') COL(COLB);                /*@D14LDFB*/ 70600000
*       END;                                                            70640000
*    ELSE                                                               70680000
*       ANS ('INIT(0),') COL(COLB);                                     70720000
*    ANS ('/* USAGE OF LIBRARY */') COL(COLD);                          70760000
* /*******************************************************************/ 70800000
* /*  CHAIN                                                          */ 70840000
* /*******************************************************************/ 70880000
*    ANS ('2 * BIT(8) ') COL(COLA+1) SKIP;                              70920000
*    IF NUMBER(CHAIN) ¬= 0 THEN                                         70960000
*       DO;                                                             71000000
*       IF CHAIN(1) = 'TEMP' THEN                                       71040000
*          ANS ('INIT(LBRTEMP),') COL(COLB);                            71080000
*       IF CHAIN(1) = 'PERM' THEN                                       71120000
*          ANS ('INIT(LBRPERM),') COL(COLB);                            71160000
*       IF CHAIN(1) = 'BOTH' THEN                                       71200000
*          ANS ('INIT(LBRBOTH),') COL(COLB);                            71240000
*       END;                                                            71280000
*    ELSE                                                               71320000
*       ANS ('INIT(LBRBOTH),') COL(COLB);                               71360000
*    ANS ('/* SEARCH ORDER */') COL(COLD);                              71400000
* /*******************************************************************/ 71440000
* /*  RESERVED                                                       */ 71480000
* /*******************************************************************/ 71520000
*    ANS ('2 * BIT(8) ') COL(COLA+1) SKIP;                              71560000
*       ANS ('INIT(0),') COL(COLB);                                     71600000
*    ANS ('/* RESERVED @D14LDFB*/') COL(COLD);                          71640000
* /*******************************************************************/ 71680000
* /*  DEFAULT                                                        */ 71720000
* /*******************************************************************/ 71760000
*    ANS ('2 * BIT(8) ') COL(COLA+1) SKIP;                              71800000
*    IF NUMBER(DEFAULT) ¬= 0 THEN                                       71840000
*       DO;                                                             71880000
*       IF DEFAULT(1) = 'YES' THEN                                      71920000
*          ANS ('INIT(LBRDFLTY),') COL(COLB);                           71960000
*       IF DEFAULT(1) = 'NO' THEN                                       72000000
*          ANS ('INIT(LBRDFLTN),') COL(COLB);                           72040000
*       END;                                                            72080000
*    ELSE                                                               72120000
*       ANS ('INIT(LBRDFLTY),') COL(COLB);                              72160000
*    ANS ('/* DEFAULT HANDLING */') COL(COLD);                          72200000
* /*******************************************************************/ 72240000
* /*  - LOGICAL UNIT -                                               */ 72280001
* /*******************************************************************/ 72320000
*    ANS ('2 * BIT(16)') COL(COLA+1) SKIP;                              72360000
*    ANS ('INIT(0),') COL(COLB);                                        72400000
*    ANS ('/* LOGICAL UNIT @D14LDFB*/') COL(COLD);         /*@D14LDFB*/ 72440001
* /*******************************************************************/ 72480000
* /*  ADDR OF LIBRARY EDT                                    @D14LDFB*/ 72520000
* /*******************************************************************/ 72560000
*    ANS ('2 * PTR(31)') COL(COLA+1) SKIP;                              72600000
*    ANS ('INIT(0),') COL(COLB);                                        72640000
*    ANS ('/* ADDR OF EDT   @D14LDFB*/') COL(COLD);        /*@D14LDFB*/ 72680000
* /*******************************************************************/ 72720000
* /*  RETURN INFORMATION                                             */ 72760000
* /*******************************************************************/ 72800000
*    ANS ('2 * BIT(8)') COL(COLA+1) SKIP;                               72840000
*    ANS ('INIT(0),') COL(COLB);                                        72880000
*    ANS ('/* FOR INTERNAL USE ONLY */') COL(COLD);                     72920000
*    ANS ('2 * BIT(8)') COL(COLA+1) SKIP;                               72960000
*    ANS ('INIT(0),') COL(COLB);                                        73000000
*    ANS ('/* FOR INTERNAL USE ONLY */') COL(COLD);                     73040000
*    ANS ('2 * BIT(8)') COL(COLA+1) SKIP;                               73080000
*    ANS ('INIT(0),') COL(COLB);                                        73120000
*    ANS ('/* FOR INTERNAL USE ONLY */') COL(COLD);                     73160000
*    ANS ('2 * BIT(8)') COL(COLA+1) SKIP;                  /*@D14LDFB*/ 73200000
*    ANS ('INIT(0),') COL(COLB);                           /*@D14LDFB*/ 73240000
*    ANS ('/* FOR INTERNAL USE ONLY */') COL(COLD);        /*@D14LDFB*/ 73280000
* /*******************************************************************/ 73320000
* /*  INTERNAL USE ONLY AND RESERVED FIELDS                          */ 73360000
* /*******************************************************************/ 73400000
*    ANS ('2 * CHAR(4)') COL(COLA+1) SKIP;                              73440000
*    ANS ('INIT(''''B),') COL(COLB);                                    73480000
*    ANS ('/* FOR INTERNAL USE ONLY */') COL(COLD);                     73520000
* /*******************************************************************/ 73560000
* /*  DEFINE                                                 @D14LDFB*/ 73600000
* /*******************************************************************/ 73640000
*    ANS ('2 * BIT(8) ') COL(COLA+1) SKIP;                 /*@D14LDFB*/ 73680000
*    IF NUMBER(DEFINE) ¬= 0 THEN                           /*@D14LDFB*/ 73720000
*       DO;                                                /*@D14LDFB*/ 73760000
*       IF DEFINE(1) = 'NEW' THEN                          /*@D14LDFB*/ 73800000
*          ANS ('INIT(LBRDNNEW),') COL(COLB);              /*@D14LDFB*/ 73840000
*       IF DEFINE(1) = 'DUMMY' THEN                        /*@D14LDFB*/ 73880000
*          ANS ('INIT(LBRDNDUM),') COL(COLB);              /*@D14LDFB*/ 73920000
*       IF DEFINE(1) = 'OLD' THEN                          /*@D14LDFB*/ 73960000
*          ANS ('INIT(LBRDNOLD),') COL(COLB);              /*@D14LDFB*/ 74000000
*       END;                                               /*@D14LDFB*/ 74040000
*    ELSE                                                  /*@D14LDFB*/ 74080000
*       ANS ('INIT(LBRDNOLD),') COL (COLB);                /*@D14LDFB*/ 74120000
*    ANS ('/* DEFINE       */') COL(COLD);                 /*@D14LDFB*/ 74160000
* /*******************************************************************/ 74200000
* /*  LEVEL                                                  @D14LDFB*/ 74240000
* /*******************************************************************/ 74280000
*    ANS ('2 * BIT(8) ') COL(COLA+1) SKIP;                 /*@D14LDFB*/ 74320000
*    IF NUMBER(LEVEL)  ¬= 0 THEN                           /*@D14LDFB*/ 74360000
*       DO;                                                /*@D14LDFB*/ 74400000
*       IF LEVEL(1)  = 'LIB' THEN                          /*@D14LDFB*/ 74440000
*          ANS ('INIT(LBRLIBLV),') COL(COLB);              /*@D14LDFB*/ 74480000
*       IF LEVEL(1) = 'SUBLIB' THEN                        /*@D14LDFB*/ 74520000
*          ANS ('INIT(LBRSUBLV),') COL(COLB);              /*@D14LDFB*/ 74560000
*       IF LEVEL(1) = 'BOTH' THEN                          /*@D14LDFB*/ 74600000
*          ANS ('INIT(LBRBTHLV),') COL(COLB);              /*@D14LDFB*/ 74640000
*       END;                                               /*@D14LDFB*/ 74680000
*    ELSE                                                  /*@D14LDFB*/ 74720000
*       ANS ('INIT(LBRBTHLV),') COL (COLB);                /*@D14LDFB*/ 74760000
*    ANS ('/* LEVEL        */') COL(COLD);                 /*@D14LDFB*/ 74800000
* /*******************************************************************/ 74840000
* /*  DEFINE                                                 @D14LDFB*/ 74880000
* /*******************************************************************/ 74920000
*    ANS ('2 * BIT(8) ') COL(COLA+1) SKIP;                 /*@D14LDFB*/ 74960000
*    IF NUMBER(REPLACE)¬= 0 THEN                           /*@D14LDFB*/ 75000000
*       DO;                                                /*@D14LDFB*/ 75040000
*       IF REPLACE(1)= 'YES' THEN                          /*@D14LDFB*/ 75080000
*          ANS ('INIT(LBRRPYES),') COL(COLB);              /*@D14LDFB*/ 75120000
*       IF REPLACE(1) = 'NO' THEN                          /*@D14LDFB*/ 75160000
*          ANS ('INIT(LBRRPNO),') COL(COLB);               /*@D14LDFB*/ 75200000
*       END;                                               /*@D14LDFB*/ 75240000
*    ELSE                                                  /*@D14LDFB*/ 75280000
*       ANS ('INIT(LBRRPNO),')  COL (COLB);                /*@D14LDFB*/ 75320000
*    ANS ('/* REPLACE      */') COL(COLD);                 /*@D14LDFB*/ 75360000
* /*******************************************************************/ 75400000
* /*  API OPTION                                           /*@D51IDJS*/ 75405701
* /*******************************************************************/ 75411401
*    ANS ('2 * BIT(8)') COL(COLA+1) SKIP;                  /*@D51IDJS*/ 75417101
*    ANS ('INIT(''00''X),') COL(COLB);                     /*@D51IDJS*/ 75422801
*    ANS ('/* LBR API OPTION */') COL(COLD);               /*@D51IDJS*/ 75428501
* /*******************************************************************/ 75434201
* /*          MODIFICATION LEVEL                           /*@D52EDUT*/ 75440001
* /*******************************************************************/ 75480000
*    ANS ('2 * BIN FIXED(31)') COL(COLA+1) SKIP;          /*@D52EDUT*/  75520001
*    ANS ('INIT(1)    ,') COL(COLB);                       /*@D52EDUT*/ 75560001
*    ANS ('/* MODIFICATION LEVEL */') COL(COLD);           /*@D52EDUT*/ 75600001
* /*******************************************************************/ 75640000
* /*  ENTRY OF LIBRARY DEFINITION TABLE                              */ 75680000
* /*******************************************************************/ 75720000
*    ANS ('2 * CHAR(LENGTH(INLCLDTE))') COL(COLA+1) SKIP;               75760000
*    ANS ('INIT(''''B),') COL(COLB);                                    75800000
*    ANS ('/* ENTRY OF LDT */') COL(COLD);                              75840000
* /*******************************************************************/ 75880000
* /*  ENTRY OF SUBLIBRARY DEFINITION TABLE                   @D14LDFB*/ 75920000
* /*******************************************************************/ 75960000
*    ANS ('2 * CHAR(LENGTH(INLCSDTE))') COL(COLA+1) SKIP;  /*@D14LDFB*/ 76000000
*    ANS ('INIT(''''B),') COL(COLB);                       /*@D14LDFB*/ 76040001
*    ANS ('/* ENTRY OF SDT */') COL(COLD);                 /*@D14LDFB*/ 76080000
* /*******************************************************************/ 76081601
* /*  ENTRY OF WORKAREA AND LENGTH                           @D52EDUT*/ 76083201
* /*******************************************************************/ 76084801
*    ANS ('2 * POINTER(31) ') COL(COLA+1) SKIP;            /*@D52EDUT*/ 76086401
*    IF NUMBER(WAREA) ¬= 0 THEN                            /*@D52EDUT*/ 76088001
*       ANS ('INIT(ADDR'||WAREA||'),') COL(COLB) RESCAN;   /*@D52EDUT*/ 76089601
*    ELSE                                                  /*@D52EDUT*/ 76091201
*       ANS ('INIT(0),') COL(COLB);                        /*@D52EDUT*/ 76092801
*    ANS ('/* WORK AREA @D52EDUT*/') COL(COLD);            /*@D52EDUT*/ 76094401
*    ANS ('2 * BIN FIXED(31) ') COL(COLA+1) SKIP;          /*@D52EDUT*/ 76096001
*    ANS ('INIT(0),') COL(COLB);                           /*@D52EDUT*/ 76097601
*    ANS ('/* LENGTH   @D52EDUT*/') COL(COLD);             /*@D52EDUT*/ 76099201
* /*******************************************************************/ 76100801
* /*  ENTRY OF PID                                           @D52EDUT*/ 76102401
* /*******************************************************************/ 76104001
*    ANS ('2 * CHAR(2)       ') COL(COLA+1) SKIP;          /*@D52EDUT*/ 76105601
*    IF NUMBER(PID) ¬= 0 THEN                              /*@D52EDUT*/ 76107201
*       ANS ('INIT('||PID(1)||'),') COL(COLB);             /*@D52EDUT*/ 76108801
*    ELSE                                                  /*@D52EDUT*/ 76110401
*       ANS ('INIT(''0000''X),') COL(COLB);                /*@D52EDUT*/ 76112001
*    ANS ('/* PID     @D52EDUT*/') COL(COLD);              /*@D52EDUT*/ 76113601
*    ANS ('2 * CHAR(18);     ') COL(COLA+1) SKIP;          /*@D52EDUT*/ 76115201
*    ANS ('/* FOR FURTHER USE @D52EDUT*/') COL(COLD);      /*@D52EDUT*/ 76116801
* /*******************************************************************/ 76120000
* /*  ENTRY OF LOCK TABLE                                            */ 76160000
* /*******************************************************************/ 76200000
*    ANS ('GENERATE DATA DEFS(LBRD'||MACINDEX||');')                    76240000
*                   COL(COLA) RESCAN;                                   76280000
*    ANS ('LBRD'||MACINDEX||' DTL')COL(COL1) RESCAN;                    76320000
*    IF NUMBER(CONTROL)+NUMBER(LOCKOPT)+NUMBER(KEEP) = 0 THEN           76360000
*       ANS ('NAME=* ') COL(COL1+15) RESCAN;                            76400000
*    ELSE                                                               76440000
*       DO;                                                             76480000
*       ANS ('NAME=*, ') COL(COL1+15) RESCAN;                           76520000
*       ANS ('X') COL(MACGRMAR) RESCAN;                                 76560000
*       IF NUMBER(CONTROL) ¬= 0 THEN                                    76600000
*          PARM = 'CONTROL='||CONTROL(1);                               76640000
*       IF NUMBER(LOCKOPT) ¬= 0 THEN                                    76680000
*          IF PARM = '' THEN                                            76720000
*             PARM = 'LOCKOPT='||LOCKOPT(1);                            76760000
*          ELSE                                                         76800000
*             PARM = PARM||',LOCKOPT='||LOCKOPT(1);                     76840000
*       IF NUMBER(KEEP) ¬= 0 THEN                                       76880000
*          IF PARM = '' THEN                                            76920000
*             PARM = 'KEEP='||KEEP(1);                                  76960000
*          ELSE                                                         77000000
*             PARM = PARM||',KEEP='||KEEP(1);                           77040000
*       ANS (PARM) COL(COL1+15) RESCAN;                                 77080000
*       END;                                                            77120000
*    ANS (MACCONC||'ENDGEN;')COL(COLA) SKIP RESCAN;                     77160000
*    ANS ('DCL LBRD'||MACINDEX||' STATIC LOCAL GENERATED CHAR(1);')     77200000
*                   COL(COLA) SKIP RESCAN;                              77240000
*    ANS ('/* VARIABLE DECLARED FOR ADDRESSING PURPOSES ONLY */')       77280000
*                   COL(COLA) SKIP RESCAN;                              77320000
*    END;  /* MF = DCL */                                  /*@D52EDUT*/ 77360001
* ELSE                                                                  77400000
*    DO;                                                                77440000
* /*******************************************************************/ 77480000
* /*  DYNAMIC GENERATION OR MODIFICATION OF CONTROL BLOCK            */ 77520000
* /*******************************************************************/ 77560000
* /*******************************************************************/ 77600000
* /*  ADDRESSING OF CONTROL BLOCK                                    */ 77640000
* /*******************************************************************/ 77680000
*    IF MACLABEL ¬= '' THEN                                             77720000
*       ANS (MACLABEL||';') SKIP COL(COLA);                             77760000
*    ANS ('RFY LBRACCR1 RSTD;')                                         77800000
*         COL(COLA) SKIP RESCAN;                                        77840000
*    IF AREA(1,1:1) = '(' THEN                                          77880000
*       ANS ('LBRACCR1 = '||AREA(1,1)||';')SKIP COL(COLA) RESCAN;       77920000
*    ELSE                                                               77960000
*       ANS ('LBRACCR1 = ADDR'||AREA||';') SKIP COL(COLA) RESCAN;       78000000
*    ANS ('/* REGISTER 1 POINTS TO CONTROL BLOCK */') COL(COLD);        78040000
*    ANS ('RFY LBRACCDS BASED(LBRACCR1);')                              78080000
*         COL(COLA) SKIP RESCAN;                                        78120000
*    IF MF(1) = 'GEN' THEN                                              78160000
*       DO;                                                             78200000
* /*******************************************************************/ 78240000
* /*  FOR MF(GEN) THE CONTROL BLOCK MUST BE CLEARED                  */ 78280000
* /*******************************************************************/ 78320000
*       ANS ('LBRACCDS = ''''B;') COL(COLA) SKIP;                       78360000
*       ANS ('/* CLEAR CONTROL BLOCK */') COL(COLD);                    78400000
* /*******************************************************************/ 78440000
* /*  FOR MF(GEN) THE LOCK TABLE ENTRY IS ALLOCATED AND ITS ADDRESS  */ 78480000
* /*              IS STORED IN THE CONTROL BLOCK                     */ 78520000
* /*******************************************************************/ 78560000
* /*    ANS ('DCL LBRD'||MACINDEX||' CHAR(LENGTH(DTLADR));') @D52RDUT*/ 78600001
* /*          COL(COLA) SKIP RESCAN;                         @D52RDUT*/ 78640001
*       ANS ('/* ALLOCATE LOCK TABLE ENTRY */') COL(COLD);              78680000
* /*    ANS ('LBRDTL = ADDR(LBRD'||MACINDEX||');')           @D52RDUT*/ 78706601
*       ANS ('LBRDTL = ''0000''X;'               )    /*     @D52RDUT*/ 78733201
*             COL(COLA) SKIP RESCAN;                                    78760000
*       ANS ('/* AND PUT ADDRESS IN CONTROL BLOCK */') COL(COLD);       78800000
*       END;                                                            78840000
* /*******************************************************************/ 78880000
* /*  INSERT LIBINFO, IF SPECIFIED                                   */ 78920000
* /*******************************************************************/ 78960000
*    IF NUMBER(LIBINFO) = 0 THEN                                        79000000
*       GOTO CHKUSR1;                                                   79040000
*    IF LIBINFO(1,1:1) = '(' THEN                                       79080000
*       TINFO = LIBINFO(1,1);                                           79120000
*    ELSE                                                               79160000
*       TINFO = 'ADDR('||LIBINFO(1)||')';                               79200000
*    ANS ('LBRINFO = '||TINFO||';') COL(COLA) SKIP RESCAN;              79240000
*    ANS ('/* INSERT LIBINFO */') COL(COLD);                            79280000
*    CHKUSR1:;                                             /*@D14LDFB*/ 79320000
* /*******************************************************************/ 79360000
* /*  INSERT CHAINID, IF SPECIFIED                                   */ 79400000
* /*******************************************************************/ 79440000
*    IF NUMBER(CHAINID) = 0 THEN                           /*@D14LDFB*/ 79480000
*       GOTO CHKLAM1;                                      /*@D14LDFB*/ 79520000
*    IF CHAINID(1,1:1) = '(' THEN                          /*@D14LDFB*/ 79560000
*       TCHID = CHAINID(1,1);                              /*@D14LDFB*/ 79600000
*    ELSE                                                  /*@D14LDFB*/ 79640000
*       TCHID = 'ADDR('||CHAINID(1)||')';                  /*@D14LDFB*/ 79680000
*    ANS ('LBRCHID = '||TCHID||';') COL(COLA) SKIP RESCAN; /*@D14LDFB*/ 79720000
*    ANS ('/* INSERT CHAINID */') COL(COLD);               /*@D14LDFB*/ 79760000
*    CHKLAM1:;                                             /*@D14LDFB*/ 79800000
* /*******************************************************************/ 79840000
* /*  INSERT LAMB, IF SPECIFIED                                      */ 79880000
* /*******************************************************************/ 79920000
*    IF NUMBER(LAMB) = 0 THEN                              /*@D14LDFB*/ 79960000
*       GOTO CHKDTF1;                                      /*@D14LDFB*/ 80000000
*    IF LAMB(1,1:1) = '(' THEN                             /*@D14LDFB*/ 80040000
*       TINFO = LAMB(1,1);                                 /*@D14LDFB*/ 80080000
*    ELSE                                                  /*@D14LDFB*/ 80120000
*       TINFO = 'ADDR('||LAMB(1)||')';                     /*@D14LDFB*/ 80160000
*    ANS ('LBRLAMB = '||TINFO||';') COL(COLA) SKIP RESCAN; /*@D14LDFB*/ 80200000
*    ANS ('/* INSERT LAMB */') COL(COLD);                  /*@D14LDFB*/ 80240000
*    CHKDTF1:;                                                          80280000
* /*******************************************************************/ 80320000
* /*  INSERT FUNCTION CODE, IF CALLED AS INNER MACRO                 */ 80360000
* /*******************************************************************/ 80400000
*    IF FC = '' THEN                                                    80440000
*       GOTO CHKTYP1;                                                   80480000
*    IF FC = 'GET' THEN                                                 80520000
*       TBYTE = 'LBRGET';                                               80560000
*    ELSE                                                               80600000
*       IF FC = 'ADDLIB' THEN                                           80640000
*          TBYTE = 'LBRADLIB';                                          80680000
*             ELSE                                                      80720000
*                IF FC = 'REMOVE' THEN                                  80760000
*                   TBYTE = 'LBRREMOV';                                 80800000
*                ELSE                                                   80840000
*                   IF FC = 'LOCK' THEN                                 80880000
*                      TBYTE = 'LBRLOCK';                               80920000
*                   ELSE                                                80960000
*                      IF FC = 'UNLOCK' THEN                            81000000
*                         TBYTE = 'LBRUNLOC';                           81040000
*                   ELSE                                   /*@D14LDFB*/ 81080000
*                      IF FC = 'EXTEND' THEN               /*@D14LDFB*/ 81120000
*                         TBYTE = 'LBREXTND';              /*@D14LDFB*/ 81160000
*                   ELSE                                   /*@D21SDFB*/ 81200000
*                      IF FC = 'EXTUPD' THEN               /*@D21SDFB*/ 81240000
*                         TBYTE = 'LBRUPDEX';              /*@D21SDFB*/ 81280000
*                      ELSE                                             81320000
*                         GOTO CHKTYP1;                                 81360000
*    ANS ('LBRMF = '||TBYTE||';')                                       81400000
*          COL(COLA) SKIP RESCAN;                                       81440000
*    ANS ('/* INSERT MAIN FUNCTION */')                                 81480000
*          COL(COLD);                                                   81520000
*    CHKTYP1:;                                                          81560000
* /*******************************************************************/ 81600000
* /*  INSERT LIBTYPE, IF SPECIFIED                                   */ 81640000
* /*******************************************************************/ 81680000
*    IF NUMBER(LIBTYPE) = 0 THEN                                        81720000
*       GOTO SETREQ1;                                                   81760000
*    IF LIBTYPE(1) = 'PHASE' THEN                          /*@D14LDFB*/ 81800000
*       TBYTE = 'LBRCL';                                                81840000
*    ELSE                                                               81880000
*       IF LIBTYPE(1) = 'OBJ' THEN                         /*@D14LDFB*/ 81920000
*          TBYTE = 'LBRRL';                                             81960000
*       ELSE                                                            82000000
*          IF LIBTYPE(1) = 'SOURCE' THEN                   /*@D14LDFB*/ 82040000
*             TBYTE = 'LBRSL';                                          82080000
*          ELSE                                                         82120000
*             IF LIBTYPE(1) = 'PROC' THEN                  /*@D14LDFB*/ 82160000
*                TBYTE = 'LBRPL';                                       82200000
*             ELSE                                                      82240000
*                IF LIBTYPE(1) = 'SPHASE' THEN             /*@D14LDFB*/ 82280000
*                   TBYTE = 'LBRSCL';                                   82320000
*                ELSE                                                   82360000
*                   IF LIBTYPE(1) = 'SOBJ' THEN            /*@D14LDFB*/ 82400000
*                      TBYTE = 'LBRSRL';                                82440000
*                   ELSE                                                82480000
*                      IF LIBTYPE(1) = 'SSOURCE' THEN      /*@D14LDFB*/ 82520000
*                         TBYTE = 'LBRSSL';                             82560000
*                      ELSE                                             82600000
*                         IF LIBTYPE(1) = 'SPROC' THEN     /*@D14LDFB*/ 82640000
*                            TBYTE = 'LBRSPL';                          82680000
*                      ELSE                                /*@D14LDFB*/ 82720000
*                         IF LIBTYPE(1) = 'DUMP'  THEN     /*@D14LDFB*/ 82760000
*                            TBYTE = 'LBRDUMP';            /*@D14LDFB*/ 82800000
*                      ELSE                                /*@D14LDFB*/ 82840000
*                         IF LIBTYPE(1) = 'LBR'   THEN     /*@D14LDFB*/ 82880000
*                            TBYTE = 'LBRLBRTY';           /*@D14LDFB*/ 82920000
*                         ELSE                                          82960000
*                            IF LIBTYPE(1) = 'ALL'   THEN  /*@D52EDUT*/ 82976001
*                               TBYTE = 'LBRALL';          /*@D52EDUT*/ 82992001
*                            ELSE                                       83008001
*                               GOTO SETREQ1;                           83024001
*    ANS ('LBRTYPE = '||TBYTE||';') COL(COLA) SKIP RESCAN;              83040000
*    ANS ('/* INSERT LIBTYPE */') COL(COLD);                            83080000
*    SETREQ1:;                                                          83120000
* /*******************************************************************/ 83160000
* /*  INSERT LIBUSE, IF SPECIFIED                                    */ 83200000
* /*******************************************************************/ 83240000
*    IF NUMBER(LIBUSE) = 0 THEN                                         83280000
*       GOTO SETCHN1;                                                   83320000
*    ELSE                                                               83360000
*       IF LIBUSE(1) = 'SEARCH' THEN                                    83400000
*          TBYTE = 'LBRSEARC';                                          83440000
*       ELSE                                                            83480000
*          IF LIBUSE(1) = 'TO' THEN                                     83520000
*             TBYTE = 'LBRTO';                                          83560000
*          ELSE                                                         83600000
*             IF LIBUSE(1) = 'FROM' THEN                                83640000
*                TBYTE = 'LBRFROM';                                     83680000
*             ELSE                                                      83720000
*                IF LIBUSE(1) = 'ACCESS'  THEN             /*@D14LDFB*/ 83760000
*                   TBYTE = 'LBRACC';                      /*@D14LDFB*/ 83800000
*             ELSE                                                      83840000
*                IF LIBUSE(1) = 'USER'    THEN             /*@D14LDFB*/ 83880000
*                   TBYTE = 'LBRUSER';                     /*@D14LDFB*/ 83920000
*                ELSE                                                   83960000
*                IF LIBUSE(1) = 'CATALOG' THEN             /*@D14LDFB*/ 84000000
*                   TBYTE = 'LBRCAT';                      /*@D14LDFB*/ 84040000
*                   ELSE                                                84080000
*                      GOTO SETCHN1;                                    84120000
*    ANS ('LBRUSE = '||TBYTE||';') COL(COLA) SKIP RESCAN;               84160000
*    ANS ('/* INSERT LIBUSE */') COL(COLD);                             84200000
*    SETCHN1:;                                                          84240000
* /*******************************************************************/ 84280000
* /*  INSERT CHAIN, IF SPECIFIED                                     */ 84320000
* /*******************************************************************/ 84360000
*    IF NUMBER(CHAIN) = 0 THEN                                          84400000
*       DO;                                                             84440000
*       IF MF(1) = 'GEN' THEN                                           84480000
*          DO;                                                          84520000
*          TBYTE = 'LBRBOTH';                                           84560000
*          GOTO SETCHN2;                                                84600000
*          END;                                                         84640000
*       ELSE                                                            84680000
*          GOTO SETDFN1;                                   /*@D14LDFB*/ 84720000
*       END;                                                            84760000
*    IF CHAIN(1) = 'TEMP' THEN                                          84800000
*       TBYTE = 'LBRTEMP';                                              84840000
*    ELSE                                                               84880000
*       IF CHAIN(1) = 'PERM' THEN                                       84920000
*          TBYTE = 'LBRPERM';                                           84960000
*       ELSE                                                            85000000
*          IF CHAIN(1) = 'BOTH' THEN                                    85040000
*             TBYTE = 'LBRBOTH';                                        85080000
*           ELSE                                                        85120000
*              GOTO SETDFN1;                               /*@D14LDFB*/ 85160000
*    SETCHN2:;                                                          85200000
*    ANS ('LBRCHAIN = '||TBYTE||';') COL(COLA) SKIP RESCAN;             85240000
*    ANS ('/* INSERT CHAIN */') COL(COLD);                              85280000
*    SETDFN1:;                                             /*@D14LDFB*/ 85320000
* /*******************************************************************/ 85360000
* /*  INSERT DEFINE, IF SPECIFIED                            @D14LDFB*/ 85400000
* /*******************************************************************/ 85440000
*    IF NUMBER(DEFINE) = 0 THEN                            /*@D14LDFB*/ 85480000
*       DO;                                                /*@D14LDFB*/ 85520000
*       IF MF(1) = 'GEN' THEN                              /*@D14LDFB*/ 85560000
*          DO;                                             /*@D14LDFB*/ 85600000
*          TBYTE = 'LBRDNOLD';                             /*@D14LDFB*/ 85640000
*          GOTO SETDFN2;                                   /*@D14LDFB*/ 85680000
*          END;                                            /*@D14LDFB*/ 85720000
*       ELSE                                               /*@D14LDFB*/ 85760000
*          GOTO SETREP1;                                   /*@D14LDFB*/ 85800000
*       END;                                               /*@D14LDFB*/ 85840000
*    IF DEFINE(1) = 'NEW' THEN                             /*@D14LDFB*/ 85880000
*       TBYTE = 'LBRDNNEW';                                /*@D14LDFB*/ 85920000
*    ELSE                                                  /*@D14LDFB*/ 85960000
*       IF DEFINE(1) = 'DUMMY' THEN                        /*@D14LDFB*/ 86000000
*          TBYTE = 'LBRDNDUM';                             /*@D14LDFB*/ 86040000
*       ELSE                                               /*@D14LDFB*/ 86080000
*          IF DEFINE(1) = 'OLD' THEN                       /*@D14LDFB*/ 86120000
*             TBYTE = 'LBRDNOLD';                          /*@D14LDFB*/ 86160000
*           ELSE                                           /*@D14LDFB*/ 86200000
*              GOTO SETREP1;                               /*@D14LDFB*/ 86240000
*    SETDFN2:;                                             /*@D14LDFB*/ 86280000
*    ANS ('LBRDEFNE = '||TBYTE||';') COL(COLA) SKIP RESCAN;/*@D14LDFB*/ 86320000
*    ANS ('/* INSERT DEFINE */') COL(COLD);                /*@D14LDFB*/ 86360000
*    SETREP1:;                                             /*@D14LDFB*/ 86400000
* /*******************************************************************/ 86440000
* /*  INSERT REPLACE , IF SPECIFIED                          @D14LDFB*/ 86480001
* /*******************************************************************/ 86520000
*    IF NUMBER(REPLACE) = 0 THEN                           /*@D14LDFB*/ 86560000
*       DO;                                                /*@D14LDFB*/ 86600000
*       IF MF(1) = 'GEN' THEN                              /*@D14LDFB*/ 86640000
*          DO;                                             /*@D14LDFB*/ 86680000
*          TBYTE = 'LBRRPNO';                              /*@D14LDFB*/ 86720000
*          GOTO SETREP2;                                   /*@D14LDFB*/ 86760000
*          END;                                            /*@D14LDFB*/ 86800000
*       ELSE                                               /*@D14LDFB*/ 86840000
*          GOTO SETLVL1;                                   /*@D14LDFB*/ 86880000
*       END;                                               /*@D14LDFB*/ 86920000
*    IF REPLACE(1)= 'YES' THEN                             /*@D14LDFB*/ 86960000
*       TBYTE = 'LBRRPYES';                                /*@D14LDFB*/ 87000000
*    ELSE                                                  /*@D14LDFB*/ 87040000
*       IF REPLACE(1) = 'NO'   THEN                        /*@D14LDFB*/ 87080000
*          TBYTE = 'LBRRPNO';                              /*@D14LDFB*/ 87120000
*           ELSE                                           /*@D14LDFB*/ 87160000
*              GOTO SETLVL1;                               /*@D14LDFB*/ 87200000
*    SETREP2:;                                             /*@D14LDFB*/ 87240000
*    ANS ('LBRREPLC = '||TBYTE||';') COL(COLA) SKIP RESCAN;/*@D14LDFB*/ 87280000
*    ANS ('/* INSERT REPLACE*/') COL(COLD);                /*@D14LDFB*/ 87320000
*    SETLVL1:;                                             /*@D14LDFB*/ 87360000
* /*******************************************************************/ 87400000
* /*  INSERT LEVEL,  IF SPECIFIED                            @D14LDFB*/ 87440000
* /*******************************************************************/ 87480000
*    IF NUMBER(LEVEL)  = 0 THEN                            /*@D14LDFB*/ 87520000
*       DO;                                                /*@D14LDFB*/ 87560000
*       IF MF(1) = 'GEN' THEN                              /*@D14LDFB*/ 87600000
*          DO;                                             /*@D14LDFB*/ 87640000
*          TBYTE = 'LBRBTHLV';                             /*@D14LDFB*/ 87680000
*          GOTO SETLVL2;                                   /*@D14LDFB*/ 87720000
*          END;                                            /*@D14LDFB*/ 87760000
*       ELSE                                               /*@D14LDFB*/ 87800000
*          GOTO SETPID ;                                   /*@D52EDUT*/ 87840001
*       END;                                               /*@D14LDFB*/ 87880000
*    IF LEVEL(1) = 'LIB'  THEN                             /*@D14LDFB*/ 87920000
*       TBYTE = 'LBRLIBLV';                                /*@D14LDFB*/ 87960000
*    ELSE                                                  /*@D14LDFB*/ 88000000
*       IF LEVEL(1) = 'SUBLIB' THEN                        /*@D14LDFB*/ 88040000
*          TBYTE = 'LBRSUBLV';                             /*@D14LDFB*/ 88080000
*       ELSE                                               /*@D14LDFB*/ 88120000
*          IF LEVEL(1) = 'BOTH' THEN                       /*@D14LDFB*/ 88160000
*             TBYTE = 'LBRBTHLV';                          /*@D14LDFB*/ 88200000
*           ELSE                                           /*@D14LDFB*/ 88240000
*              GOTO SETPID;                                /*@D52EDUT*/ 88280001
*    SETLVL2:;                                             /*@D14LDFB*/ 88320000
*    ANS ('LBRLEVEL = '||TBYTE||';') COL(COLA) SKIP RESCAN;/*@D14LDFB*/ 88360000
*    ANS ('/* INSERT LEVEL  */') COL(COLD);                /*@D14LDFB*/ 88400000
*    SETPID:;                                              /*@D52EDUT*/ 88401401
* /*******************************************************************/ 88402801
* /*  SET PID IF SPECIFIED                                   @D52EDUT*/ 88404201
* /*******************************************************************/ 88405601
*    IF NUMBER(PID) ¬= 0  THEN DO;                         /*@D52EDUT*/ 88407001
*       IF PID(1,1:1) = '''' THEN DO;                      /*@D52EDUT*/ 88408401
*          ANS ('LBRPID = ' || PID(1)||';')                /*@D52EDUT*/ 88409801
*          COL(COLA) SKIP RESCAN;                          /*@D52EDUT*/ 88411201
*          ANS ('/* INSERT PID    */') COL(COLD);          /*@D52EDUT*/ 88412601
*          END;                                            /*@D52EDUT*/ 88414001
*       ELSE DO;                                                        88415401
*          IF PID(1,1:1) = '(' THEN                        /*@D52EDUT*/ 88416801
*             TINFO = PID(1,1);                            /*@D52EDUT*/ 88418201
*          ELSE                                            /*@D52EDUT*/ 88419601
*             TINFO = 'ADDR(' || PID(1) || ')';            /*@D52EDUT*/ 88421001
*          ANS ('LBRACR15 = '||TINFO||';')                 /*@D52EDUT*/ 88422401
*             COL(COLA) SKIP RESCAN;                       /*@D52EDUT*/ 88423801
*          ANS ('LBRPID = LBRACR15 -> LBRAUXPD;')          /*@D52EDUT*/ 88425201
*             COL(COLA) SKIP RESCAN;                       /*@D52EDUT*/ 88426601
*          ANS ('/* INSERT PID    */') COL(COLD);          /*@D52EDUT*/ 88428001
*          END;                                            /*@D52EDUT*/ 88429401
*       END;                                               /*@D52EDUT*/ 88430801
*    ELSE DO;                                              /*@D52EDUT*/ 88432201
*       ANS ('LBRPID = ''0000''X;')                        /*@D52EDUT*/ 88433601
*          COL(COLA) SKIP RESCAN;                          /*@D52EDUT*/ 88435001
*       ANS ('/* INSERT PID    */') COL(COLD);             /*@D52EDUT*/ 88436401
*       END;                                               /*@D52EDUT*/ 88437801
* /*******************************************************************/ 88439201
* /*  WORKAREA                                               @D52EDUT*/ 88440601
* /*******************************************************************/ 88442001
*    IF NUMBER(WAREA) ¬= 0  THEN DO;                       /*@D52EDUT*/ 88443401
*       IF WAREA(1,1:1) = '(' THEN DO;                     /*@D52EDUT*/ 88444801
*          TINFO = WAREA(1,1   );                          /*@D52EDUT*/ 88446201
*          END;                                            /*@D52EDUT*/ 88447601
*       ELSE DO;                                           /*@D52EDUT*/ 88449001
*          TINFO = 'ADDR('||WAREA(1)||')';                 /*@D52EDUT*/ 88450401
*          END;                                            /*@D52EDUT*/ 88451801
*    ANS ('LBRWRK  = '||TINFO||';') COL(COLA) SKIP RESCAN; /*@D52EDUT*/ 88453201
*    ANS ('/* INSERT LBRWRK  */') COL(COLD);               /*@D52EDUT*/ 88454601
*       END;                                               /*@D52EDUT*/ 88456001
* /*******************************************************************/ 88457401
* /*  SET LENGTH IF SPECIFIED                                @D52EDUT*/ 88458801
* /*******************************************************************/ 88460201
*    IF NUMBER(LEN) ¬= 0  THEN DO;                         /*@D52EDUT*/ 88461601
*       IF LEN(1,1:1) = '(' THEN                           /*@D52EDUT*/ 88463001
*          TINFO = LEN(1,1);                               /*@D52EDUT*/ 88464401
*       ELSE                                               /*@D52EDUT*/ 88465801
*          TINFO = 'ADDR(' || LEN(1) || ')';               /*@D52EDUT*/ 88467201
*       ANS ('LBRACR15 = '||TINFO||';')                    /*@D52EDUT*/ 88468601
*          COL(COLA) SKIP RESCAN;                          /*@D52EDUT*/ 88470001
*       ANS ('LBRLEN = LBRACR15 -> LBRAUXLN;')             /*@D52EDUT*/ 88471401
*          COL(COLA) SKIP RESCAN;                          /*@D52EDUT*/ 88472801
*       ANS ('/* INSERT LEN    */') COL(COLD);             /*@D52EDUT*/ 88474201
*       END;                                               /*@D52EDUT*/ 88475601
* /*******************************************************************/ 88480000
* /*  INSERT DEFAULT, IF SPECIFIED                                   */ 88520000
* /*******************************************************************/ 88560000
*    IF NUMBER(DEFAULT) = 0 THEN                                        88600000
*       DO;                                                             88640000
*       IF MF(1) = 'GEN' THEN                                           88680000
*          DO;                                                          88720000
*          TBYTE = 'LBRDFLTY';                                          88760000
*          GOTO SETDEF2;                                                88800000
*          END;                                                         88840000
*       ELSE                                                            88880000
*          GOTO SETLOGU;                                                88920000
*       END;                                                            88960000
*    IF DEFAULT(1) = 'YES' THEN                                         89000000
*       TBYTE = 'LBRDFLTY';                                             89040000
*    ELSE                                                               89080000
*       IF DEFAULT(1) = 'NO' THEN                                       89120000
*          TBYTE = 'LBRDFLTN';                                          89160000
*       ELSE                                                            89200000
*          GOTO SETLOGU;                                                89240000
*    SETDEF2:;                                                          89280000
*    ANS ('LBRDFLT = '||TBYTE||';') COL(COLA) SKIP RESCAN;              89320000
*    ANS ('/* INSERT DEFAULT */') COL(COLD);                            89360000
*    SETLOGU:;                                                          89400000
* /*******************************************************************/ 89405001
* /*  INSERT MODIFICATION LEVEL                              @D52EDUT*/ 89410001
* /*******************************************************************/ 89415001
*  IF MF(1) = 'GEN' THEN DO;                               /*@D52EDUT*/ 89420001
*     ANS ('LBRMOD = 1;') COL(COLA) SKIP RESCAN ;          /*@D52EDUT*/ 89425001
*     ANS ('/* INSERT MODIFICATION LEVEL @D52EDUT*/') COL(COLD);        89430001
*     END;                                                 /*@D52EDUT*/ 89435001
*  IF NUMBER(FILENAM) +                                                 89440000
*       NUMBER(SUBLIB) = 0 THEN                            /*@D14LDFB*/ 89480000
*       GOTO SETLOC1;                                                   89520000
*    ANS ('RFY LBRACR15 RSTD;') COL(COLA) SKIP;            /*@D52EDUT*/ 89560001
*    SETLDT:;                                                           89600000
* /*******************************************************************/ 89640000
* /*  INSERT FILENAM, IF SPECIFIED                           @D14LDFB*/ 89680000
* /*******************************************************************/ 89720000
*    IF NUMBER(FILENAM) ¬= 0 THEN                                       89760000
*       DO;                                                /*@D14LDFB*/ 89800000
*       ANS ('RFY INLCLDTE BASED(ADDR(LBRLDT));')                       89840000
*          COL(COLA) SKIP RESCAN;                                       89880000
*          IF FILENAM(1,1:1) = '(' THEN                                 89920000
*             TINFO = FILENAM(1,1);                                     89960000
*          ELSE                                                         90000000
*             TINFO = 'ADDR(' || FILENAM(1) || ')';                     90040000
*          ANS ('LBRACR15 = '||TINFO||';')                              90080000
*             COL(COLA) SKIP RESCAN;                                    90120000
*          ANS ('LDTEFNME = LBRACR15 -> LBRAUXFN;')                     90160000
*             COL(COLA) SKIP RESCAN;                                    90200000
*          ANS ('/* INSERT FILENAM */') COL(COLD);                      90240000
*       ANS ('RFY INLCLDTE;')                                           90280000
*          COL(COLA) SKIP RESCAN;                                       90320000
*       END;                                                            90360000
*    SETSDT:;                                              /*@D14LDFB*/ 90400000
* /*******************************************************************/ 90440000
* /*  INSERT SUBLIB, IF SPECIFIED                            @D14LDFB*/ 90480000
* /*******************************************************************/ 90520000
*    IF NUMBER(SUBLIB) ¬= 0 THEN                           /*@D14LDFB*/ 90560000
*       DO;                                                /*@D14LDFB*/ 90600000
*       ANS ('RFY INLCSDTE BASED(ADDR(LBRSDT));')          /*@D14LDFB*/ 90640000
*          COL(COLA) SKIP RESCAN;                          /*@D14LDFB*/ 90680000
*          IF SUBLIB(1,1:1) = '(' THEN                     /*@D14LDFB*/ 90720000
*             TINFO = SUBLIB(1,1);                         /*@D14LDFB*/ 90760000
*          ELSE                                            /*@D14LDFB*/ 90800000
*             TINFO = 'ADDR(' || SUBLIB(1) || ')';         /*@D14LDFB*/ 90840000
*          ANS ('LBRACR15 = '||TINFO||';')                 /*@D14LDFB*/ 90880000
*             COL(COLA) SKIP RESCAN;                       /*@D14LDFB*/ 90920000
*          ANS ('SDTENAME = LBRACR15 -> LBRAUXSN;')        /*@D14LDFB*/ 90960000
*             COL(COLA) SKIP RESCAN;                       /*@D14LDFB*/ 91000000
*          ANS ('/* INSERT SUBLIB */') COL(COLD);          /*@D14LDFB*/ 91040000
*       ANS ('RFY INLCSDTE;')                              /*@D14LDFB*/ 91080000
*          COL(COLA) SKIP RESCAN;                          /*@D14LDFB*/ 91120000
*       END;                                               /*@D14LDFB*/ 91160000
*       ANS ('RFY LBRACR15;')                              /*@D14LDFB*/ 91200000
*          COL(COLA) SKIP;                                 /*@D14LDFB*/ 91240000
*    SETLOC1:;                                                          91280000
*    IF FC = 'LOCK' THEN                                                91320000
*      GOTO MODLCK;                                                     91360000
*    IF FC = 'UNLOCK' THEN                                              91400000
*      GOTO MODLCK;                                                     91440000
* /*******************************************************************/ 91480000
* /*  INSERT LOCK OPTIONS, IF SPECIFIED BY MF(MOD)                   */ 91520000
* /*******************************************************************/ 91560000
*    IF NUMBER(CONTROL) + NUMBER(LOCKOPT) + NUMBER(KEEP) ¬= 0 THEN      91600000
*       DO;                                                             91640000
*       IF NUMBER(CONTROL) = 0 THEN                                     91680000
*          TCON = '';                                                   91720000
*       ELSE                                                            91760000
*          TCON = ',CONTROL=' || CONTROL(1);                            91800000
*       IF NUMBER(LOCKOPT) = 0 THEN                                     91840000
*          TSHR = '';                                                   91880000
*       ELSE                                                            91920000
*          TSHR = ',LOCKOPT=' || LOCKOPT(1);                            91960000
*       IF NUMBER(KEEP) = 0 THEN                                        92000000
*          TKEEP = '';                                                  92040000
*       ELSE                                                            92080000
*          TKEEP = ',KEEP=' || KEEP(1);                                 92120000
*       PARM = TCON || TSHR || TKEEP;                                   92160000
*       END;                                                            92200000
*    IF MF(1) = 'MOD' THEN                                              92240000
*       IF PARM = '' THEN                                               92280000
*          DO;                                                          92320000
*          IF INNER ¬= 1 THEN                                           92360000
*             DO;                                                       92400000
*             ANS ('RFY (LBRACCR1,LBRACCDS);')                          92440000
*                   COL(COLA) SKIP;                                     92480000
*             END;                                                      92520000
*          GOTO MEND;                                                   92560000
*          END;                                                         92600000
* /* FROM HERE TO MEND DELETED TO AVOID DENERATION OF DTL    @D52RDUT*/ 92650001
* MODLCK:;                                                              94160000
*  ANS ('RFY (LBRACCR1,LBRACCDS);')                    /*  @D52RDUT*/   94210001
*        COL(COLA) SKIP;                                                96040000
*  END;                                                                 96080000
* MEND:;                                                                96120000
* FC = '';                                                              96160000
* /*******************************************************************/ 96200000
* /*  AVOID TWO RETURN CODES, IF LBRACCCB WAS CALLED AS INNER MACRO  */ 96240000
* /*******************************************************************/ 96280000
* IF INNER = 1 THEN                                                     96320000
*    DO;                                                                96360000
*    IF RC < RCL THEN                                                   96400000
*       RC = RCL;                                                       96440000
*    RCL = 0;                                                           96480000
*    END;                                                               96520000
* RETURN CODE(RCL);                                                     96560000
* %END;                                                                 96600000
*/*   ENDMODULE LBRACCCB                                           */   96640000
