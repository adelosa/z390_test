*%GOTO PLSIALCB;                      /* BEGIN OF PLS COMMENT           00010004
         MACRO                                                          00020004
&LABEL1  LIBRDCB &FUNC=,                                               X00030004
               &AREA=,                                                 X00040004
               &CHAIN=,                                                X00050004
               &CHAINID=,                                              X00060004
               &LIB=,                                                  X00070004
               &SUBLIB=,                                               X00080004
               &MEMBER=,                                               X00090004
               &TYPE=,                                                 X00100004
               &DIRINF=,                                               X00110004
               &DIRINFL=,                                              X00120004
               &BUFFER=,                                               X00130004
               &BUFSIZE=,                                              X00140004
               &RECFM=,                                                X00150004
               &LRECL=,                                                X00160004
               &RECNO=,                                                X00170004
               &UNITS=,                                                X00180004
               &DATAID=,                                               X00190004
               &DATALEN=,                                              X00200004
               &DATA=,                                                 X00210004
               &CATALOG=,                                              X00220004
               &SCOPE=,                                                X00230004
               &SYSIPT=,                                               X00240004
               &CONT=,                                                 X00250004
               &NMEMBER=,                                              X00260004
               &NTYPE=,                                                X00270004
               &LOCKID=,                                               X00280004
               &NOTEINF=,                                              X00290004
               &NOTECTL=,                                              X00300004
               &COMMIT=,                                               X00310004
               &NOTFND=,                                               X00320004
               &EODAD=,                                                X00330004
               &SRVEXIT=,                                              X00340004
               &EROPT=,                                                X00350004
               &ERRAD=                                       @D52RDUT   00360004
.*                                                                      00370004
.*                                                                      00380004
         GBLB  &IALACMP            CONTROL GENERATION OF DSECTS         00390004
.*       GBLA  &LBR0SCO            CONTROL GENERATION OF SYSC @D61NDMF  00400004
         GBLC  &IALFC              FUNCTION CODE PASSED BY LIBR         00410004
         GBLC  &IALOP1             OPEN OPTION 1                        00420004
         GBLC  &IALOP2             OPEN OPTION 2                        00430004
         GBLB  &IALINN             LIBRDCB CALLED AS IALINN MACRO       00440004
         GBLB  &IALSYER            SYNTAX ERROR OF LIBR|LIBRDCB         00450004
         LCLC  &REG                PREPARE STRING FOR ST INSTRUCTION    00460004
         LCLB  &REGERR             REGISTER NOTATION INVALID            00470004
         LCLA  &K1                 TEMPORARY COUNT FIELD                00480004
         LCLA  &K2                 TEMPORARY COUNT FIELD                00490004
         LCLA  &K3                 TEMPORARY COUNT FIELD                00500004
         AIF   (&IALINN).NOCOM                                          00510004
&IALSYER SETB 0                    RESET IALSYER, IF CALL AS OUTER      00520004
&IALFC   SETC ''                                                        00530004
         SPACE                                                          00540004
*  LIBRARIAN - LIBRDCB - 5686-032-06-DB6   VERSION 91-06-22             00550004
         SPACE                                                          00560004
.NOCOM   ANOP                                                           00570004
         AGO   .ENDPCP                                                  00580004
*        LICENSED MATERIALS - PROPERTY OF IBM                           00590004
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                    00600004
*        5686-032 (C) COPYRIGHT IBM CORP. 1984, 1992                    00610004
*        SEE COPYRIGHT INSTRUCTIONS                                     00620004
.*                                                                      00630004
.* A000000-999999                                              @D51IDJS 00640004
.*   SUPPORT FOR TRANSACTION SERVER LTS                        @D52TDJS 00650004
.*   PROGRAM CHECK IF &LABEL1 NOT ALREADY ON FULLWORD BOUNDARY @DY44323 00660004
.*      VSE/ESA 2.4 07/1997 @D64VDMF                           @DY44323 00661004
.*                                                                      00662004
*/****  START OF SPECIFICATIONS  *************************************/ 00663004
*/**                                                                    00664004
*/**  MACRO NAME:  LIBRDCB                                              00665004
*/**                                                                    00666004
*/**  MACRO TYPE:  EXTERNAL LIBRARIAN MACRO, BILINGUAL                  00667004
*/**                                                                    00668004
*/**  DESCRIPTIVE NAME:  MACRO FOR INTERACTIVE LIBRARIAN CONTROL        00669004
*/**                     BLOCK DEFINITION                               00670004
*/**                                                                    00680004
*/**  SYNTAX OF MACRO:                                                  00690004
*/**                                                                    00700004
*/**     ASSEMBLER:                                                     00710004
*/**                                                                    00720004
*/** <LABEL> LIBRDCB FUNC = GEN | MOD | MAP                             00730004
*/**                  <,AREA = NAME | (R)>                              00740004
*/**                  <,CHAIN = NAME | (R)>                             00750004
*/**                  <,CHAINID = NAME | (R)>                           00760004
*/**                  <,LIB = NAME | (R)                                00770004
*/**                   ,SUBLIB = NAME | (R)>                            00780004
*/**                  <,MEMBER = NAME | (R)>                            00790004
*/**                   ,TYPE = NAME | (R)>                              00800004
*/**                  <,DIRINF = NAME | (R)>                            00810004
*/**                   ,DIRINFL = VALUE | (RV)>                         00820004
*/**                  <,BUFFER = NAME | (R)                             00830004
*/**                   ,BUFSIZE = VALUE | (RV)>                         00840004
*/**                  <,RECFM = S | F | V >                             00850004
*/**                  <,RECNO = VALUE | (RV)>                           00860004
*/**                  <,UNITS = VALUE | (RV)>                           00870004
*/**                  <,DATAID = NAME | (R)                             00880004
*/**                   ,DATALEN = NAME | (R)                            00890004
*/**                   ,DATA = NAME | (R)>                              00900004
*/**                  <,CONT = YES | NO >                               00910004
*/**                  <,NOTFND = NAME | (R)>                            00920004
*/**                  <,EODAD = NAME | (R)>                             00930004
*/**                  <,SRVEXIT = NAME | (R)>                  @D52TDJS 00940004
*/**                  <,EROPT= RET | CANCEL >                           00950004
*/**                  <,ERRAD = NAME | (R)>                             00960004
*/**                                                                    00970004
*/**                                                                    00980004
*/**                                                                    00990004
*/**                                                                    01000004
*/**                                                                    01010004
*/**     PL/S3:                                                         01020004
*/**                                                                    01030004
*/** ? <LABEL:> LIBRDCB FUNC(GEN | MOD | MAP)                           01040004
*/**                   <AREA(NAME | (R))>                               01050004
*/**                   <CHAIN(NAME | (R))>                              01060004
*/**                   <CHAINID(NAME | (R))>                            01070004
*/**                   <LIB(NAME | (R))                                 01080004
*/**                    SUBLIB(NAME | (R))>                             01090004
*/**                   <MEMBER(NAME | (R))>                             01100004
*/**                    TYPE(NAME | (R))>                               01110004
*/**                   <DIRINF(NAME | (R)                               01120004
*/**                    DIRINFL(VALUE | (RV))>                          01130004
*/**                   <BUFFER(NAME | (R))                              01140004
*/**                    BUFSIZE(VALUE | (RV))>                          01150004
*/**                   <RECFM(S | F | V )>                              01160004
*/**                   <RECNO(VALUE | (RV))>                            01170004
*/**                   <UNITS(VALUE | (RV))>                            01180004
*/**                   <DATAID(NAME | (R))                              01190004
*/**                    DATALEN(NAME | (R))                             01200004
*/**                    DATA(NAME | (R))>                               01210004
*/**                   <CONT( YES | NO )>                               01220004
*/**                   <NOTFND(NAME | (R))>                             01230004
*/**                   <EODAD(NAME | (R))>                              01240004
*/**                   <SRVEXIT(NAME | (R))>                   @D52TDJS 01250004
*/**                   <EROPT(RET | CANCEL)>                            01260004
*/**                   <ERRAD(NAME | (R))>                              01270004
*/**                     ;                                              01280004
*/*   EJECT                                                             01290004
*/**  INPUT:    SPECIFICATION OF MACRO                                  01300004
*/**                                                                    01310004
*/**  OUTPUT:                                                           01320004
*/**            FOR FUNC = GEN                                          01330004
*/**            THE SPECIFIED PARAMETERS ARE FILLED INTO                01340004
*/**            THE CONTROL BLOCK DEFINED BY 'AREA'.                    01350004
*/**            NON-SPECIFIED PARAMETERS ARE CLEARED.                   01360004
*/**                                                                    01370004
*/**            FOR FUNC = MOD                                          01380004
*/**            THE SPECIFIED PARAMETERS ARE FILLED INTO                01390004
*/**            THE CONTROL BLOCK DEFINED BY 'AREA'.                    01400004
*/**            NON-SPECIFIED PARAMETERS REMAIN UNCHANGED.              01410004
*/**                                                                    01420004
*/**            FOR FUNC = MAP                                          01430004
*/**            A MAP OF THE LIBRARIAN DATA CONTROL BLOCK WILL          01440004
*/**            GENERATED.                                              01450004
*/**            ON THE FIRST CALL OF A LIBR OR A                        01460004
*/**            LIBRDCB MACRO IN A MODULE THE FOLLOWING                 01470004
*/**            MAPS ARE PROVIDED WITH THE INDICATED NAMES:             01480004
*/**                                                                    01490004
*/**              LDCB       LIBRARY ACCESS DATA CONTROL BLOCK          01500004
*/**                                                                    01510004
*/**            OTHERWISE, NO OUTPUT WILL BE GENERATED.                 01520004
*/**                                                                    01530004
*/**  FUNCTION:                                                         01540004
*/**                                                                    01550004
*/**  THE CONTROL BLOCK FOR THE LIBR MACRO                              01560004
*/**  IS DEFINED AND FILLED UP WITH THE SPECIFIED                       01570004
*/**  PARAMETERS.                                                       01580004
*/***                                                                   01590004
*/**  REGISTER USAGE FOR LIBRDCB MACRO (ONLY FOR FUNC=GEN|MOD):         01600004
*/**                                                                    01610004
*/**    REG  0   USED FOR CONTROL BLOCK MODIFICATION                    01620004
*/**    REG  1   USED TO ADDRESS THE CONTROL BLOCK                      01630004
*/**    REG 14   USED FOR CONTROL BLOCK MODIFICATION                    01640004
*/**    REG 15   USED FOR CONTROL BLOCK MODIFICATION                    01650004
*/**                                                                    01660004
*/**  RETURN CODES FROM LANGUAGE PROCESSOR:                             01670004
*/**     0       MACRO EXPANSION SUCCESSFUL                             01680004
*/**     4       PARAMETERS HAVE BEEN IGNORED DUE TO CONFLICTS          01690004
*/**     8       INVALID PARAMETERS SPECIFIED                           01700004
*/**                                                                    01710004
*/**  NOTES:                                                            01720004
*/**                                                                    01730004
*/**     CHANGE ACTIVITIES:                                             01740004
*/**                                                                    01750004
*/**        SUPPORT OF INTERACTIVE LIBRARIAN                            01760004
*/**                                                                    01770004
*/**     <...> DENOTES, THAT THIS PARAMETER IS OPTIONAL.                01780004
*/**                                                                    01790004
*/****  END OF SPECIFICATIONS  ***************************************/ 01800004
*/*   EJECT                                                             01810004
*/**  PARAMETER DESCRIPTION:                                            01820004
*/**                                                                    01830004
*/**    FUNC     SPECIFIES THE MAIN FUNCTION TO BE EXECUTED:            01840004
*/**                                                                    01850004
*/**               GEN    GENERATES THE CONTROL BLOCK                   01860004
*/**                      IN THE SPECIFIED AREA                         01870004
*/**                      AND SETS UP INFORMATION AS SPECIFIED BY       01880004
*/**                      THE OTHER PARAMETERS.(DYNAMIC ALLOCATION,     01890004
*/**                      I.E. STORAGE ADDRESSED BY AREA IS             01900004
*/**                      FILLED UP WITH THE SPECIFIED PARA-            01910004
*/**                      METERS). NON-SPECIFIED PARAMETERS             01920004
*/**                      ARE CLEARED.                                  01930004
*/**                                                                    01940004
*/**               MOD    MODIFIES THE CONTROL BLOCK IN THE             01950004
*/**                      SPECIFIED AREA AND SETS UP INFOR-             01960004
*/**                      MATION AS SPECIFIED BY THE OTHER              01970004
*/**                      PARAMETERS.(DYNAMIC ALLOCATION,               01980004
*/**                      I.E. STORAGE ADDRESSED BY AREA IS             01990004
*/**                      FILLED UP WITH THE SPECIFIED PARA-            02000004
*/**                      METERS). NON SPECIFIED PARAMETERS             02010004
*/**                      REMAIN UNCHANGED.                             02020004
*/**                                                                    02030004
*/**               MAP    PROVIDES THE ABOVE SPECIFIED MAPS,            02040004
*/**                      UNLESS THEY HAVE BEEN GENERATED BY            02050004
*/**                      A PREVIOUS LIBRDCB OR LIBR                    02060004
*/**                      MACRO IN THE MODULE.                          02070004
*/**                                                                    02080004
*/**    FOR A DESCRIPTION OF ALL OTHER PARAMETERS SEE MACRO LIBR.       02090004
*/*  SPACE 5                                                            02100004
*/**                                                                    02110004
*/** VALID PARAMETERS FOR 'FUNC=GEN|MOD':                               02120004
*/**      AREA                                                          02130004
*/**      CHAIN                                                         02140004
*/**      CHAINID                                                       02150004
*/**      LIB                                                           02160004
*/**      SUBLIB                                                        02170004
*/**      MEMBER                                                        02180004
*/**      TYPE                                                          02190004
*/**      DIRINF                                                        02200004
*/**      DIRINFL                                                       02210004
*/**      BUFFER                                                        02220004
*/**      BUFSIZE                                                       02230004
*/**      RECFM                                                         02240004
*/**      LRECL                                                         02250004
*/**      RECNO                                                         02260004
*/**      UNITS                                                         02270004
*/**      DATAID                                                        02280004
*/**      DATALEN                                                       02290004
*/**      DATA                                                          02300004
*/**      NOTFND                                                        02310004
*/**      CONT                                                          02320004
*/**      EODAD                                                         02330004
*/**      SRVEXIT                                              @D52TDJS 02340004
*/**      EROPT                                                         02350004
*/**      ERRAD                                                         02360004
*/**                                                                    02370004
*/** VALID PARAMETERS FOR 'FUNC=MAP':                                   02380004
*/**      NONE                                                          02390004
*/*   EJECT                                                             02400004
.ENDPCP  ANOP                                                           02410004
.*                                                                      02420004
.*       INCLUDE LPT                                                    02430004
.*                                                                      02440004
.*       INLCLPT FCODE=YES,DSECT=YES,TABLE=YES                          02450004
.*                                                                      02460004
.*       DO NOT GENERATE DSECT FOR SYSCOM, IF &LBR0SCO = 1              02470004
.*                                                                      02480004
.*       AIF   (&LBR0SCO NE 0).NOSYSCO                                  02490004
.* SYSCOM   SYSCOM                    DSECT FOR SYSCOM                  02500004
.* &LBR0SCO SETB  1                                                     02510004
.*       EJECT                                                          02520004
.NOSYSCO ANOP                                                           02530004
.*                                                                      02540004
.*       DO NOT GENERATE ANY DSECTS OR EQUATES, IF &IALACMP = 1         02550004
.*                                                                      02560004
         AIF   (&IALACMP).NOCOPY                                        02570004
         INLCIALC                  DSECT FOR CONTROL BLOCK              02580004
         EJECT                                                          02590004
&IALACMP SETB  1                   DO NOT GENERATE MAPS FOR NEXT CALL   02600004
&SYSECT  CSECT                       RESUME CSECT                       02610004
.NOCOPY  ANOP                                                           02620004
         AIF   (&IALINN AND '&IALFC' EQ 'SHOWCB').MEND                  02630004
         AIF (&IALINN).START                                            02640004
.*                                                                      02650004
.*       FOR LIBRDCB AS OUTER MACRO SOME PARAMETERS ARE                 02660004
.*       INVALID                                                        02670004
.*                                                                      02680004
&K1      SETA (K'&CATALOG+K'&SCOPE)                                     02690004
&K1      SETA (&K1+K'&NMEMBER+K'&NTYPE)                                 02700004
&K1      SETA (&K1+K'&NOTEINF+K'&NOTECTL+K'&COMMIT+K'&SYSIPT)           02710004
&K1      SETA (&K1+K'&LOCKID)                                 @D52RDUT  02720004
         AIF   (&K1 EQ 0).START                                         02730004
         MNOTE 8,'INVALID PARAMETER SPECIFIED, GENERATION SUPPRESSED'   02740004
&IALSYER SETB 1                                                         02750004
.START   ANOP                                                           02760004
         AIF   ('&FUNC' NE 'MAP').CHKOFUN                               02770004
.*                                                                      02780004
.*       FOR FUNC=MAP NO OTHER PARAMETERS ARE VALID                     02790004
.*                                                                      02800004
&K1      SETA  (K'&CHAIN+K'&CHAINID+K'&AREA)                            02810004
&K1      SETA  (&K1+K'&LIB+K'&SUBLIB+K'&MEMBER+K'&TYPE)                 02820004
&K1      SETA  (&K1+K'&DIRINF+K'&DIRINFL)                               02830004
&K1      SETA  (&K1+K'&RECFM+K'&LRECL+K'&BUFFER+K'&BUFSIZE)             02840004
&K1      SETA  (&K1+K'&RECNO+K'&UNITS)                                  02850004
&K1      SETA  (&K1+K'&DATAID+K'&DATALEN+K'&DATA)                       02860004
&K1      SETA  (&K1+K'&CONT+K'&NOTFND+K'&EODAD+K'&ERRAD+K'&EROPT)       02870004
&K1      SETA  (&K1+K'&SRVEXIT)                                @D52TDJS 02880004
&K1      SETA  (&K1+K'&LOCKID)                                @D52RDUT  02890004
         AIF   (&K1 EQ 0).TERM                                          02900004
         MNOTE 4,'ALL OTHER PARAMETERS IGNORED FOR FUNC=MAP'            02910004
.TERM    ANOP                                                           02920004
         AGO .MEND                                                      02930004
.*                                                                      02940004
.*       CHECK MACRO FUNCTION                                           02950004
.*                                                                      02960004
.CHKOFUN ANOP                                                           02970004
         AIF   (T'&FUNC NE 'O').CHECKMF                                 02980004
         MNOTE 8,'FUNC IS NOT SPECIFIED, GENERATION SUPPRESSED'         02990004
         AGO .MEND                                                      03000004
.CHECKMF ANOP                                                           03010004
         AIF   ('&FUNC' EQ 'GEN').VALMF                                 03020004
         AIF   ('&FUNC' EQ 'MOD').VALMF                                 03030004
         MNOTE 8,'FUNC REQUEST IS INVALID, GENERATION SUPPRESSED'       03040004
         AGO .MEND                                                      03050004
.VALMF   ANOP                                                           03060004
.*                                                                      03070004
.*       CHECK VALIDATION OF VALUE PARAMETERS                           03080004
.*                                                                      03090004
.*       CHECK SCOPE                                                    03100004
.*                                                                      03110004
.CHECKSC ANOP                                                           03120004
         AIF   (T'&SCOPE EQ 'O').VALSC                                  03130004
         AIF   (K'&SCOPE EQ 0).VALSC                                    03140004
         AIF   ('&SCOPE' EQ 'TASK').VALSC                               03150004
         AIF   ('&SCOPE' EQ 'JOB').VALSC                                03160004
         AIF   ('&SCOPE' EQ 'PART').VALSC                               03170004
         MNOTE 8,'SCOPE REQUEST IS INVALID, GENERATION SUPPRESSED'      03180004
.*       SYNTAX CHECK CONTINUES                                         03190004
&IALSYER SETB  1                                                        03200004
.VALSC   ANOP                                                           03210004
.*       CHECK NOTECONTROL                                              03220004
.*                                                                      03230004
.CHECKNC ANOP                                                           03240004
         AIF   (T'&NOTECTL EQ 'O').VALNC                                03250004
         AIF   (K'&NOTECTL EQ 0).VALNC                                  03260004
         AIF   ('&NOTECTL' EQ 'YES').VALNC                              03270004
         AIF   ('&NOTECTL' EQ 'NO').VALNC                               03280004
         MNOTE 8,'NOTECTL REQUEST IS INVALID, GENERATION SUPPRESSED'    03290004
.*       SYNTAX CHECK CONTINUES                                         03300004
&IALSYER SETB  1                                                        03310004
.VALNC   ANOP                                                           03320004
.*       CHECK SYSIPT OTION                                             03330004
.*                                                                      03340004
.CHECKSY ANOP                                                           03350004
         AIF   (T'&SYSIPT EQ 'O').VALSY                                 03360004
         AIF   (K'&SYSIPT EQ 0).VALSY                                   03370004
         AIF   ('&SYSIPT' EQ 'YES').VALSY                               03380004
         AIF   ('&SYSIPT' EQ 'NO').VALSY                                03390004
         MNOTE 8,'SYSIPT REQUEST IS INVALID, GENERATION SUPPRESSED'     03400004
.*       SYNTAX CHECK CONTINUES                                         03410004
&IALSYER SETB  1                                                        03420004
.VALSY   ANOP                                                           03430004
.*       CHECK COMMIT FOR LIBR CLOSE                                    03440004
.*                                                                      03450004
.CHECKCO ANOP                                                           03460004
         AIF   (T'&COMMIT EQ 'O').VALCO                                 03470004
         AIF   (K'&COMMIT EQ 0).VALCO                                   03480004
         AIF   ('&COMMIT' EQ 'YES').VALCO                               03490004
         AIF   ('&COMMIT' EQ 'NO').VALCO                                03500004
         MNOTE 8,'COMMIT REQUEST IS INVALID, GENERATION SUPPRESSED'     03510004
.*       SYNTAX CHECK CONTINUES                                         03520004
&IALSYER SETB  1                                                        03530004
.VALCO   ANOP                                                           03540004
.*       CHECK RECORD FORMAT                                            03550004
.*                                                                      03560004
.CHECKRF ANOP                                                           03570004
         AIF   (T'&RECFM EQ 'O').VALRF                                  03580004
         AIF   ('&RECFM' EQ 'S').VALRF                                  03590004
         AIF   ('&RECFM' EQ 'F').VALRF                                  03600004
         MNOTE 8,'RECFM REQUEST IS INVALID, GENERATION SUPPRESSED'      03610004
.*       SYNTAX CHECK CONTINUES                                         03620004
&IALSYER SETB  1                                                        03630004
.VALRF   ANOP                                                           03640004
.*       CHECK EROPT                                                    03650004
.*                                                                      03660004
.CHECKEO ANOP                                                           03670004
         AIF   (T'&EROPT EQ 'O').VALEO                                  03680004
         AIF   ('&EROPT' EQ 'RET').VALEO                                03690004
         AIF   ('&EROPT' EQ 'CANCEL').VALEO                             03700004
         MNOTE 8,'EROPT REQUEST IS INVALID, GENERATION SUPPRESSED'      03710004
.*       SYNTAX CHECK CONTINUES                                         03720004
&IALSYER SETB  1                                                        03730004
.VALEO   ANOP                                                           03740004
.*       CHECK CONT                                                     03750004
.*                                                                      03760004
.CHECKCN ANOP                                                           03770004
         AIF   (T'&CONT EQ 'O').VALCONT                                 03780004
         AIF   ('&CONT' EQ 'YES').VALCONT                               03790004
         AIF   ('&CONT' EQ 'NO').VALCONT                                03800004
         MNOTE 8,'CONT REQUEST IS INVALID, GENERATION SUPPRESSED'       03810004
.*       SYNTAX CHECK CONTINUES                                         03820004
&IALSYER SETB  1                                                        03830004
.VALCONT ANOP                                                           03840004
.*                                                                      03850004
.*       CHECK BUFFER,BUFSIZE                                           03860004
.*                                                                      03870004
&K1      SETA  (K'&BUFFER)                                              03880004
&K2      SETA  (K'&BUFSIZE)                                             03890004
         AIF   (&K1 EQ 0 AND &K2 EQ 0 ).CHKVIF                          03900004
         AIF   (&K1 GT 0 AND &K2 GT 0 ).CHKVIF                          03910004
         MNOTE 8,'BUFFER,BUFSIZE MUST BE SPECIFIED TOGETHER,  GENERATIOX03920004
               N SUPPRESSED'                                            03930004
.*       SYNTAX CHECK CONTINUES                                         03940004
&IALSYER SETB  1                                                        03950004
.CHKVIF  ANOP                                                           03960004
.*                                                                      03970004
.*       CHECK DATA,DATAID,DATALEN                                      03980004
.*                                                                      03990004
&K1      SETA  (K'&DATA)                                                04000004
&K2      SETA  (K'&DATAID)                                              04010004
&K3      SETA  (K'&DATALEN)                                             04020004
         AIF   (&K1 EQ 0 AND &K2 EQ 0 AND &K3 EQ 0).CHKLSLB             04030004
         AIF   (&K1 GT 0 AND &K2 GT 0 AND &K3 GT 0).CHKLSLB             04040004
         MNOTE 8,'DATA,DATAID,DATALEN MUST BE SPECIFIED TOGETHER, GENERX04050004
               ATION SUPPRESSED'                                        04060004
.*       SYNTAX CHECK CONTINUES                                         04070004
&IALSYER SETB  1                                                        04080004
.CHKLSLB ANOP                                                           04090004
.*                                                                      04100004
.*       CHECK LIB,SUBLIB                                               04110004
.*                                                                      04120004
         AIF   ('&IALFC' EQ 'STATLIB').CHKMETY                          04130004
&K1      SETA  (K'&LIB)                                                 04140004
&K2      SETA  (K'&SUBLIB)                                              04150004
         AIF   (&K1 EQ 0 AND &K2 EQ 0).CHKMETY                          04160004
         AIF   (&K1 GT 0 AND &K2 GT 0).CHKMETY                          04170004
         MNOTE 8,'LIB,SUBLIB MUST BE SPECIFIED TOGETHER,GENERATION SUPPX04180004
               RESSED'                                                  04190004
.*       SYNTAX CHECK CONTINUES                                         04200004
&IALSYER SETB  1                                                        04210004
.CHKMETY ANOP                                                           04220004
.*                                                                      04230004
.*       MEMBER, MEMBERTYPE                                             04240004
.*                                                                      04250004
&K1      SETA  (K'&MEMBER)                                              04260004
&K2      SETA  (K'&TYPE)                                                04270004
         AIF   (&K1 EQ 0 AND &K2 EQ 0).CHKDIRI                          04280004
         AIF   (&K1 GT 0 AND &K2 GT 0).CHKDIRI                          04290004
         MNOTE 8,'MEMBERNAME AND TYPE MUST BE SPECIFIED TOGETHER, GENERX04300004
               ATION SUPRESSED'                                         04310004
.*       SYNTAX CHECK CONTINUES                                         04320004
&IALSYER SETB  1                                                        04330004
.*                                                                      04340004
.*       CHECK DIRECTORY PARAMETER                                      04350004
.*                                                                      04360004
.CHKDIRI ANOP                                                           04370004
&K1      SETA  (K'&DIRINF)                                              04380004
&K2      SETA  (K'&DIRINFL)                                             04390004
         AIF   (&K1 EQ 0 AND &K2 EQ 0).CHKFLRC                          04400004
         AIF   (&K1 GT 0 AND &K2 GT 0).CHKFLRC                          04410004
         MNOTE 8,'DIRINF,DIRINFL MUST BE SPECIFIED TOGETHER,GENERATION X04420004
               SUPPRESSED'                                              04430004
.*       SYNTAX CHECK CONTINUES                                         04440004
&IALSYER SETB  1                                                        04450004
.CHKFLRC ANOP                                                           04460004
.*                                                                      04470004
.*       IF LRECL IS SPECIFIED, RECFM MUST BE F OR V                    04480004
.*                                                                      04490004
         AIF   ('&LRECL' EQ '').CKCTLRC                                 04500004
         AIF   ('&RECFM' NE 'S').CKCTLRC                                04510004
         MNOTE 4,'LRECL IS INVALID AT RECFM=S, PARAMETER IGNORED'       04520004
.CKCTLRC ANOP                                                           04530004
.*                                                                      04540004
.* FOR FUNCTION = GEN,MOD AREA MUST BE SPECIFIED                        04550004
.*                                                                      04560004
.CHKMDGN ANOP                                                           04570004
         AIF ('&AREA' NE '').GEMDGN                                     04580004
.ERAREA1 MNOTE 8,'AREA MUST BE SPECIFIED FOR FUNC=GEN|MOD, GENERATION SX04590004
               UPPRESSED'                                               04600004
.*       SYNTAX CHECK CONTINUES                                         04610004
&IALSYER SETB  1                                                        04620004
.GEMDGN  ANOP                                                           04630004
.*                                                                      04640004
.*       IF AN SYNTAX ERROR OCCURS, THE GENERATION WILL BE SUPPRESSED   04650004
.*                                                                      04660004
         AIF ( NOT &IALSYER ).GEMDGN1                                   04670004
.*                                                                      04680004
.*       ERROR EXIT FOR FUNC=MOD OR FUNC=GEN                            04690004
.*                                                                      04700004
         AGO  .MEND                                                     04710004
.GEMDGN1 ANOP                                                           04720004
.*                                                                      04730004
.*       FOR LIBRDCB AS OUTER MACRO THE FUNCTION CODE (LDCB FUNCTION)   04740004
.*       IS CLEARED                                                     04750004
.*                                                                      04760004
         AIF   (&IALINN).NOSETF1                                        04770004
&IALFC   SETC  ' '                                                      04780004
.NOSETF1 ANOP                                                           04790004
.*                                                                      04800004
.*       DYNAMIC GENERATION OR MODIFICATION OF CONTROL BLOCK            04810004
.*                                                                      04820004
         AIF   ('&LABEL1' EQ '').NOLAB                                  04830004
&LABEL1  DS    0H                                             @DY44323  04840004
.NOLAB   ANOP                                                           04850004
.*                                                                      04860004
.*       ADDRESSING OF CONTROL BLOCK VIA REGISTER 1                     04870004
.*                                                                      04880004
         AIF   ('&AREA' EQ '(1)').USING1                                04890004
         AIF   ('&AREA'(1,1) NE '(').NRAR                               04900004
&REG     SETC  '&AREA'(2,K'&AREA-2)                                     04910004
         LR    IALCBR1,&REG            ADDRESS OF CONTROL BLOCK         04920004
         AGO   .USING1                                                  04930004
.NRAR    ANOP                                                           04940004
         LA    IALCBR1,&AREA           ADDRESS OF CONTROL BLOCK         04950004
.USING1  ANOP                                                           04960004
         USING INLCIALC,IALCBR1        ADDRESSABILITY FOR CONTROL BLOCK 04970004
         AIF   ('&FUNC' NE 'GEN').NOTGEN                                04980004
.*                                                                      04990004
.*       FOR FUNC=GEN THE CONTROL BLOCK MUST BE CLEARED                 05000004
.*                                                                      05010004
         XC    INLCIALC(IALCCBLN),INLCIALC CLEAR CONTROL BLOCK          05020004
         MVC   IALCID,=CL4'IALC' SET INITIAL VALUES                     05030004
         MVC   IALCNORC,=F'-1'                                          05040004
         LA    IALCBR0,IALCMSG                                          05050004
         ST    IALCBR0,IALCMSGA                                         05060004
         MVI   IALCMSG,C' '                                             05070004
         MVC   IALCMSG+1(119),IALCMSG                                   05080004
.NOTGEN  ANOP                                                           05090004
         MVC   IALCCMD,=CL8'&IALFC'                                     05100004
.*                                                                      05110004
.*       INSERT GLOBAL VARIABLES                                        05120004
.*                                                                      05130004
.*       OPEN OPTIONS                                                   05140004
         AIF   ('&IALFC' NE 'OPEN').GLBCLS                              05150004
         AIF   ('&IALOP1' NE 'INPUT').GLBOP1                            05160004
         MVI   IALCOPEN,IALCINP        OPEN FOR INPUT                   05170004
         AGO   .GLBCLS                                                  05180004
.GLBOP1  ANOP                                                           05190004
         AIF   ('&IALOP1' NE 'INOUT').GLBOP2                            05200004
         MVI   IALCOPEN,IALCIOUT       OPEN FOR INOUT                   05210004
         AGO   .GLBCLS                                                  05220004
.GLBOP2  ANOP                                                           05230004
         AIF   ('&IALOP1' NE 'UPDATE').GLBOP3                           05240004
         MVI   IALCOPEN,IALCUPD        OPEN FOR UPDATE                  05250004
         AGO   .GLBCLS                                                  05260004
.GLBOP3  ANOP                                                           05270004
         AIF   ('&IALOP2' NE 'NOREPLACE').GLBOP4                        05280004
         MVI   IALCOPEN,IALCOUTN       OPEN FOR OUTPUT NOREPLACE        05290004
         AGO   .GLBCLS                                                  05300004
.GLBOP4  ANOP                                                           05310004
         MVI   IALCOPEN,IALCOUTR       OPEN FOR OUTPUT REPLACE          05320004
.GLBCLS  ANOP                                                           05330004
.*                                                                      05340004
.*       INSERT LIB, IF SPECIFIED                                       05350004
.*                                                                      05360004
         AIF   (T'&LIB EQ 'O').CHKSLB1                                  05370004
         AIF   ('&LIB'(1,1) NE '(').NRLIB                               05380004
&REG     SETC  '&LIB'(2,K'&LIB-2)                                       05390004
         ST    &REG,IALCLIB            INSERT LIB                       05400004
         AGO   .CHKSLB1                                                 05410004
.NRLIB   ANOP                                                           05420004
         LA    IALCBR0,&LIB                                             05430004
         ST    IALCBR0,IALCLIB         INSERT LIB                       05440004
.CHKSLB1 ANOP                                                           05450004
.*                                                                      05460004
.*       INSERT SUBLIB, IF SPECIFIED                                    05470004
.*                                                                      05480004
         AIF   (T'&SUBLIB EQ 'O').CHKMBR1                               05490004
         AIF   ('&SUBLIB'(1,1) NE '(').NRSLB                            05500004
&REG     SETC  '&SUBLIB'(2,K'&SUBLIB-2)                                 05510004
         ST    &REG,IALCSLIB           INSERT SUBLIB                    05520004
         AGO   .CHKMBR1                                                 05530004
.NRSLB   ANOP                                                           05540004
         LA    IALCBR0,&SUBLIB                                          05550004
         ST    IALCBR0,IALCSLIB        INSERT SUBLIB                    05560004
.CHKMBR1 ANOP                                                           05570004
.*                                                                      05580004
.*       INSERT MEMBER, IF SPECIFIED                                    05590004
.*                                                                      05600004
         AIF   (T'&MEMBER EQ 'O').CHKTYP1                               05610004
         AIF   ('&MEMBER'(1,1) NE '(').NRMBR                            05620004
&REG     SETC  '&MEMBER'(2,K'&MEMBER-2)                                 05630004
         ST    &REG,IALCMEMB           INSERT MEMBER                    05640004
         AGO   .CHKTYP1                                                 05650004
.NRMBR   ANOP                                                           05660004
         LA    IALCBR0,&MEMBER                                          05670004
         ST    IALCBR0,IALCMEMB        INSERT MEMBER                    05680004
.CHKTYP1 ANOP                                                           05690004
.*                                                                      05700004
.*       INSERT TYPE, IF SPECIFIED                                      05710004
.*                                                                      05720004
         AIF   (T'&TYPE EQ 'O').CHKMBR2                                 05730004
         AIF   ('&TYPE'(1,1) NE '(').NRTYP                              05740004
&REG     SETC  '&TYPE'(2,K'&TYPE-2)                                     05750004
         ST    &REG,IALCTYPE           INSERT TYPE                      05760004
         AGO   .CHKMBR2                                                 05770004
.NRTYP   ANOP                                                           05780004
         LA    IALCBR0,&TYPE                                            05790004
         ST    IALCBR0,IALCTYPE        INSERT TYPE                      05800004
.CHKMBR2 ANOP                                                           05810004
.*                                                                      05820004
.*       INSERT NMEMBER, IF SPECIFIED                                   05830004
.*                                                                      05840004
         AIF   (T'&NMEMBER EQ 'O').CHKTYP2                              05850004
         AIF   ('&NMEMBER'(1,1) NE '(').NRMBR2                          05860004
&REG     SETC  '&NMEMBER'(2,K'&NMEMBER-2)                               05870004
         ST    &REG,IALCNMBR           INSERT NMEMBER                   05880004
         AGO   .CHKTYP2                                                 05890004
.NRMBR2  ANOP                                                           05900004
         LA    IALCBR0,&NMEMBER                                         05910004
         ST    IALCBR0,IALCNMBR        INSERT NMEMBER                   05920004
.CHKTYP2 ANOP                                                           05930004
.*                                                                      05940004
.*       INSERT NTYPE, IF SPECIFIED                                     05950004
.*                                                                      05960004
         AIF   (T'&NTYPE EQ 'O').CHKLOCK                      @D52RDUT  05970004
         AIF   ('&NTYPE'(1,1) NE '(').NRTYP2                            05980004
&REG     SETC  '&NTYPE'(2,K'&NTYPE-2)                                   05990004
         ST    &REG,IALCNTYP           INSERT NTYPE                     06000004
         AGO   .CHKLOCK                                       @D52RDUT  06010004
.NRTYP2  ANOP                                                           06020004
         LA    IALCBR0,&NTYPE                                           06030004
         ST    IALCBR0,IALCNTYP        INSERT NTYPE                     06040004
.CHKLOCK ANOP                                                 @D52RDUT  06050004
.*                                                            @D52RDUT  06060004
.*       INSERT LOCKID IF SPECIFIED                           @D52RDUT  06070004
.*                                                            @D52RDUT  06080004
         AIF   (T'&LOCKID EQ 'O').CHKACC1                     @D52RDUT  06090004
         AIF   ('&LOCKID'(1,1) NE '(').NRLOCK                 @D52RDUT  06100004
&REG     SETC  '&LOCKID'(2,K'&LOCKID-2)                       @D52RDUT  06110004
         ST    &REG,IALCLKID           INSERT LOCKID          @D52RDUT  06120004
         OI    IALCMDFL,IALCLKMD       LOCKID MODIFIED        @D52TDJS  06130004
         AGO   .CHKACC1                                       @D52RDUT  06140004
.NRLOCK  ANOP                                                 @D52RDUT  06150004
         LA    IALCBR0,&LOCKID                                @D52RDUT  06160004
         ST    IALCBR0,IALCLKID        INSERT LOCKID          @D52RDUT  06170004
         OI    IALCMDFL,IALCLKMD       LOCKID MODIFIED        @D52TDJS  06180004
.CHKACC1 ANOP                                                           06190004
.*                                                                      06200004
.*       INSERT CHAIN, IF SPECIFIED                                     06210004
.*                                                                      06220004
         AIF   (T'&CHAIN EQ 'O').CHKCAT1                                06230004
         AIF   (K'&CHAIN EQ 0).CHKCAT1                                  06240004
         AIF   ('&CHAIN'(1,1) NE '(').NRACC1                            06250004
&REG     SETC  '&CHAIN'(2,K'&CHAIN-2)                                   06260004
         ST    &REG,IALCACCS           INSERT CHAIN                     06270004
         AGO   .CHKCAT1                                                 06280004
.NRACC1  ANOP                                                           06290004
         LA    IALCBR0,&CHAIN                                           06300004
         ST    IALCBR0,IALCACCS        INSERT CHAIN                     06310004
.CHKCAT1 ANOP                                                           06320004
.*                                                                      06330004
.*       INSERT CATALOG, IF SPECIFIED                                   06340004
.*                                                                      06350004
         AIF   (T'&CATALOG EQ 'O').NRCAT0                               06360004
         AIF   (K'&CATALOG EQ 0).NRCAT0                                 06370004
         AIF   ('&CATALOG'(1,1) NE '(').NRCAT1                          06380004
&REG     SETC  '&CATALOG'(2,K'&CATALOG-2)                               06390004
         ST    &REG,IALCCTLG           INSERT CATALOG                   06400004
         AGO   .CHKCHD1                                                 06410004
.NRCAT1  ANOP                                                           06420004
         LA    IALCBR0,&CATALOG                                         06430004
         ST    IALCBR0,IALCCTLG        INSERT CATALOG                   06440004
         AGO   .CHKCHD1                                                 06450004
.NRCAT0  ANOP                                                           06460004
.*  CLEAR ENTRY IF NOT SPECIFIED IN STATE ENTITY=CHAIN                  06470004
         AIF   ('&IALFC' NE 'STATCHN').CHKCHD1                          06480004
         LA    IALCBR0,0               RESET CATALOG ADDRESS            06490004
         ST    IALCBR0,IALCCTLG                                         06500004
         AGO   .CHKCHD1                                                 06510004
.CHKCHD1 ANOP                                                           06520004
.*                                                                      06530004
.*       INSERT CHAINID, IF SPECIFIED                                   06540004
.*                                                                      06550004
         AIF   (T'&CHAINID EQ 'O').CHKNTI1                              06560004
         AIF   ('&CHAINID'(1,1) NE '(').NRCHD1                          06570004
&REG     SETC  '&CHAINID'(2,K'&CHAINID-2)                               06580004
         ST    &REG,IALCCHID           INSERT CHAINID                   06590004
         AGO   .CHKNTI1                                                 06600004
.NRCHD1  ANOP                                                           06610004
         LA    IALCBR0,&CHAINID                                         06620004
         ST    IALCBR0,IALCCHID        INSERT CHAINID                   06630004
.CHKNTI1 ANOP                                                           06640004
.*                                                                      06650004
.*       INSERT NOTE INFORMATION, IF SPECIFIED                          06660004
.*                                                                      06670004
         AIF   (T'&NOTEINF EQ 'O').CHKNTC1                              06680004
         AIF   (K'&NOTEINF EQ 0).CHKNTC1                                06690004
         AIF   ('&NOTEINF'(1,1) NE '(').NRNTI1                          06700004
&REG     SETC  '&NOTEINF'(2,K'&NOTEINF-2)                               06710004
         ST    &REG,IALCNOTE           INSERT NOTE INFORMATION          06720004
         AGO   .CHKNTC1                                                 06730004
.NRNTI1  ANOP                                                           06740004
         LA    IALCBR0,&NOTEINF                                         06750004
         ST    IALCBR0,IALCNOTE        INSERT NOTE INFORMATION          06760004
.CHKNTC1 ANOP                                                           06770004
.*                                                                      06780004
.*       INSERT NOTE CONTROL IF SPECIFIED                               06790004
.*                                                                      06800004
         AIF   (T'&NOTECTL EQ 'O').CHKBUF1                              06810004
         AIF   (K'&NOTECTL EQ 0).CHKBUF1                                06820004
         AIF   ('&NOTECTL' NE 'YES').CHKNTCN                            06830004
         OI    IALCOPTS,IALCNCTL       NOTE CONTROL = YES               06840004
         AGO   .CHKBUF1                                                 06850004
.CHKNTCN ANOP                                                           06860004
         NI    IALCOPTS,X'FF'-IALCNCTL NOTE CONTROL = NO                06870004
.CHKBUF1 ANOP                                                           06880004
.*                                                                      06890004
.*       INSERT BUFFER, IF SPECIFIED                                    06900004
.*                                                                      06910004
         AIF   (T'&BUFFER EQ 'O').CHKBSZ1                               06920004
         AIF   ('&BUFFER'(1,1) NE '(').NRBUF                            06930004
&REG     SETC  '&BUFFER'(2,K'&BUFFER-2)                                 06940004
         ST    &REG,IALCBUFF           INSERT BUFFER ADDRESS            06950004
         AGO   .CHKBSZ1                                                 06960004
.NRBUF   ANOP                                                           06970004
         LA    IALCBR0,&BUFFER                                          06980004
         ST    IALCBR0,IALCBUFF        INSERT BUFFER ADDRESS            06990004
.CHKBSZ1 ANOP                                                           07000004
.*                                                                      07010004
.*       INSERT BUFSIZE, IF SPECIFIED                                   07020004
.*                                                                      07030004
         AIF   (T'&BUFSIZE EQ 'O').CHKRCF1                              07040004
         AIF   ('&BUFSIZE'(1,1) NE '(').NRBSZ                           07050004
&REG     SETC  '&BUFSIZE'(2,K'&BUFSIZE-2)                               07060004
         ST    &REG,IALCBSIZ           INSERT BUFFER LENGTH             07070004
         AGO   .CHKRCF1                                                 07080004
.NRBSZ   ANOP                                                           07090004
         LA    IALCBR0,&BUFSIZE                                         07100004
         ST    IALCBR0,IALCBSIZ        INSERT BUFFER LENGTH             07110004
.CHKRCF1 ANOP                                                           07120004
.*                                                                      07130004
.*       INSERT RECFM, IF SPECIFIED                                     07140004
.*                                                                      07150004
         AIF   (T'&RECFM EQ 'O').CKCOMT1                                07160004
         AIF   ('&RECFM' NE 'S').NSRUN                                  07170004
         MVI   IALCRCFM,IALCRFUN       INSERT RECORD FORMAT             07180004
         OI    IALCMDFL,IALCRFMD       RECFM MODIFIED BY USER  @D52TDJS 07190004
         AGO   .DFLTUN                                                  07200004
.NSRUN   ANOP                                                           07210004
         AIF   ('&RECFM' NE 'F').NSRFX                                  07220004
         MVI   IALCRCFM,IALCRFFX       INSERT RECORD FORMAT             07230004
         OI    IALCMDFL,IALCRFMD       RECFM MODIFIED BY USER  @D52TDJS 07240004
         AGO   .DFLTUN                                                  07250004
.NSRFX   ANOP                                                           07260004
.*                                                                      07270004
.*   ON EACH MODIFY OF RECFM WITHOUT UNIT, UNIT IS SET TO DEFAULT       07280004
.*                                                                      07290004
.DFLTUN  ANOP                                                           07300004
         AIF   (K'&UNITS NE 0).DFLTLRC                                  07310004
         AIF   ('&RECFM' EQ 'F').DFLTUN1                                07320004
         MVC   IALCNORC,=F'0'          UNIT IS SET TO DEFAULT           07330004
         OI    IALCMDFL,IALCUNMD       UNITS MODIFIED BY USER  @D52TDJS 07340004
         AGO   .DFLTLRC                                                 07350004
.DFLTUN1 ANOP                                                           07360004
         MVC   IALCNORC,=F'1'          UNIT IS SET TO DEFAULT           07370004
         OI    IALCMDFL,IALCUNMD       UNITS MODIFIED BY USER  @D52TDJS 07380004
.*                                                                      07390004
.*   ON EACH MODIFY OF RECFM WITHOUT LRECL, LRECL IS CLEARED            07400004
.*                                                                      07410004
.DFLTLRC ANOP                                                           07420004
         AIF   (K'&LRECL NE 0).CKCOMT1                                  07430004
         MVC   IALCLREC,=F'0'          LRECL IS CLEARED                 07440004
.CKCOMT1 ANOP                                                           07450004
.*                                                                      07460004
.*       INSERT COMMIT PARAMETER                                        07470004
.*                                                                      07480004
         AIF   (K'&COMMIT EQ 0).CHKSCP1                                 07490004
         AIF   (T'&COMMIT EQ 'O').CHKSCP1                               07500004
         AIF   ('&COMMIT' NE 'NO').CKCOMT2                              07510004
         OI    IALCCLSE,IALCNCMT       COMMIT = NO                      07520004
         AGO   .CHKSCP1                                                 07530004
.CKCOMT2 ANOP                                                           07540004
         NI    IALCCLSE,X'FF'-IALCNCMT COMMIT = YES                     07550004
.CHKSCP1 ANOP                                                           07560004
.*                                                                      07570004
.*       INSERT SCOPE, IF SPECIFIED                                     07580004
.*                                                                      07590004
         AIF   (T'&SCOPE EQ 'O').CHKCTC1                                07600004
         AIF   (K'&SCOPE EQ 0).CHKCTC1                                  07610004
         AIF   ('&SCOPE' NE 'TASK').NRSCPT1                             07620004
         MVI   IALCSCOP,IALCTASK       INSERT SCOPE                     07630004
         AGO   .CHKCTC1                                                 07640004
.NRSCPT1 ANOP                                                           07650004
         AIF   ('&SCOPE' NE 'JOB').NRSCPJ1                              07660004
         MVI   IALCSCOP,IALCJOB        INSERT SCOPE                     07670004
         AGO   .CHKCTC1                                                 07680004
.NRSCPJ1 ANOP                                                           07690004
         AIF   ('&SCOPE' NE 'PART').CHKCTC1                             07700004
         MVI   IALCSCOP,IALCPART       INSERT SCOPE                     07710004
.CHKCTC1 ANOP                                                           07720004
.*                                                                      07730004
.*       INSERT SYSIPT PARAMETER                                        07740004
.*                                                                      07750004
         AIF   (T'&SYSIPT EQ 'O').CHKCNT1                               07760004
         AIF   (K'&SYSIPT EQ 0).CHKCNT1                                 07770004
         AIF   ('&SYSIPT' NE 'YES').CHKSPTN                             07780004
         OI    IALCATTR,IALCSIPT       INSERT SYSIPT                    07790004
         AGO   .CHKRCL1                                                 07800004
.CHKSPTN ANOP                                                           07810004
         NI    IALCATTR,X'FF'-IALCSIPT INSERT SYSIPT                    07820004
.CHKCNT1 ANOP                                                           07830004
.*                                                                      07840004
.*       INSERT CONT PARAMETER                                          07850004
.*                                                                      07860004
         AIF   (T'&CONT EQ 'O').CHKRCL1                                 07870004
         AIF   ('&CONT' EQ 'YES').CHKCNT2                               07880004
         OI    IALCOPTS,IALCNCNT       INSERT CONTINUATION OPTION       07890004
         AGO   .CHKRCL1                                                 07900004
.CHKCNT2 ANOP                                                           07910004
         NI    IALCOPTS,X'FF'-IALCNCNT INSERT CONTINUATION OPTION       07920004
.CHKRCL1 ANOP                                                           07930004
.*                                                                      07940004
.*       INSERT LRECL, IF SPECIFIED                                     07950004
.*                                                                      07960004
         AIF   (T'&LRECL EQ 'O').CHKNRC1                                07970004
         AIF   ('&LRECL'(1,1) NE '(').NRRCL                             07980004
&REG     SETC  '&LRECL'(2,K'&LRECL-2)                                   07990004
         ST    &REG,IALCLREC           INSERT LRECL                     08000004
         AGO   .CHKNRC1                                                 08010004
.NRRCL   ANOP                                                           08020004
         LA    IALCBR0,&LRECL                                           08030004
         ST    IALCBR0,IALCLREC        INSERT LRECL                     08040004
.CHKNRC1 ANOP                                                           08050004
.*                                                                      08060004
.*       INSERT UNITS, IF SPECIFIED                                     08070004
.*                                                                      08080004
         AIF   (T'&UNITS EQ 'O').CHKRCN1                                08090004
         AIF   ('&UNITS'(1,1) NE '(').NRLEN                             08100004
&REG     SETC  '&UNITS'(2,K'&UNITS-2)                                   08110004
         ST    &REG,IALCNORC           INSERT UNITS                     08120004
         OI    IALCMDFL,IALCUNMD       UNITS MODIFIED BY USER  @D52TDJS 08130004
         AGO   .CHKRCN1                                                 08140004
.NRLEN   ANOP                                                           08150004
         LA    IALCBR0,&UNITS                                           08160004
         ST    IALCBR0,IALCNORC        INSERT UNITS                     08170004
         OI    IALCMDFL,IALCUNMD       UNITS MODIFIED BY USER  @D52TDJS 08180004
.CHKRCN1 ANOP                                                           08190004
.*                                                                      08200004
.*       INSERT RECNO, IF SPECIFIED                                     08210004
.*                                                                      08220004
         AIF   (T'&RECNO EQ 'O').CHKMVL1                                08230004
         AIF   ('&RECNO'(1,1) NE '(').NRRECN1                           08240004
&REG     SETC  '&RECNO'(2,K'&RECNO-2)                                   08250004
         ST    &REG,IALCRCNO           INSERT RECNO                     08260004
         OI    IALCMDFL,IALCRCMD       RECNO MODIFIED BY USER  @D52TDJS 08270004
         AGO   .CHKMVL1                                                 08280004
.NRRECN1 ANOP                                                           08290004
         LA    IALCBR0,&RECNO                                           08300004
         ST    IALCBR0,IALCRCNO        INSERT RECNO                     08310004
         OI    IALCMDFL,IALCRCMD       RECNO MODIFIED BY USER  @D52TDJS 08320004
.CHKMVL1 ANOP                                                           08330004
.*                                                                      08340004
.*       INSERT DIRINF, IF SPECIFIED                                    08350004
.*                                                                      08360004
         AIF   (T'&DIRINF EQ 'O').CHKDRL1                               08370004
         AIF   ('&DIRINF'(1,1) NE '(').NRDRF                            08380004
&REG     SETC  '&DIRINF'(2,K'&DIRINF-2)                                 08390004
         ST    &REG,IALCDENT           INSERT ADDRESS OF STATUS BLOCK   08400004
         AGO   .CHKDRL1                                                 08410004
.NRDRF   ANOP                                                           08420004
         LA    IALCBR0,&DIRINF                                          08430004
         ST    IALCBR0,IALCDENT        INSERT ADDRESS OF STATUS BLOCK   08440004
.CHKDRL1 ANOP                                                           08450004
.*                                                                      08460004
.*       INSERT DIRINFL, IF SPECIFIED                                   08470004
.*                                                                      08480004
         AIF   (T'&DIRINFL EQ 'O').CHKVFD1                              08490004
         AIF   ('&DIRINFL'(1,1) NE '(').NRDRL                           08500004
&REG     SETC  '&DIRINFL'(2,K'&DIRINFL-2)                               08510004
         ST    &REG,IALCDIRL           INSERT LENGTH OF STATUS BLOCK    08520004
         AGO   .CHKVFD1                                                 08530004
.NRDRL   ANOP                                                           08540004
         LA    IALCBR0,&DIRINFL                                         08550004
         ST    IALCBR0,IALCDIRL        INSERT LENGTH OF STATUS BLOCK    08560004
.CHKVFD1 ANOP                                                           08570004
.*                                                                      08580004
.*       INSERT DATAID, IF SPECIFIED                                    08590004
.*                                                                      08600004
         AIF   (T'&DATAID EQ 'O').CHKVLN1                               08610004
         AIF   ('&DATAID'(1,1) NE '(').NRVID                            08620004
&REG     SETC  '&DATAID'(2,K'&DATAID-2)                                 08630004
         ST    &REG,IALCVID            INSERT ADDRESS OF VIF ID         08640004
         AGO   .CHKVLN1                                                 08650004
.NRVID   ANOP                                                           08660004
         LA    IALCBR0,&DATAID                                          08670004
         ST    IALCBR0,IALCVID         INSERT ADDRESS OF VIF ID         08680004
.CHKVLN1 ANOP                                                           08690004
.*                                                                      08700004
.*       INSERT DATALEN, IF SPECIFIED                                   08710004
.*                                                                      08720004
         AIF   (T'&DATALEN EQ 'O').CHKVDT1                              08730004
         AIF   ('&DATALEN'(1,1) NE '(').NRVLN                           08740004
&REG     SETC  '&DATALEN'(2,K'&DATALEN-2)                               08750004
         ST    &REG,IALCVLEN           INSERT VIF DATA LENGTH           08760004
         AGO   .CHKVDT1                                                 08770004
.NRVLN   ANOP                                                           08780004
         LA    IALCBR0,&DATALEN                                         08790004
         ST    IALCBR0,IALCVLEN        INSERT VIF DATA LENGTH           08800004
.CHKVDT1 ANOP                                                           08810004
.*                                                                      08820004
.*       INSERT DATA, IF SPECIFIED                                      08830004
.*                                                                      08840004
         AIF   (T'&DATA EQ 'O').CHKNFD1                                 08850004
         AIF   ('&DATA'(1,1) NE '(').NRVDT                              08860004
&REG     SETC  '&DATA'(2,K'&DATA-2)                                     08870004
         ST    &REG,IALCVDAT           INSERT ADDRESS OF VIF DATA       08880004
         AGO   .CHKNFD1                                                 08890004
.NRVDT   ANOP                                                           08900004
         LA    IALCBR0,&DATA                                            08910004
         ST    IALCBR0,IALCVDAT        INSERT ADDRESS OF VIF DATA       08920004
.CHKNFD1 ANOP                                                           08930004
.*                                                                      08940004
.*       INSERT NOTFND, IF SPECIFIED                                    08950004
.*                                                                      08960004
         AIF   (T'&NOTFND EQ 'O').CHKEOF1                               08970004
         AIF   ('&NOTFND'(1,1) NE '(').NRNFD                            08980004
&REG     SETC  '&NOTFND'(2,K'&NOTFND-2)                                 08990004
         ST    &REG,IALCNFND           INSERT ADDRESS OF NOT-FOUND EXIT 09000004
         AGO   .CHKEOF1                                                 09010004
.NRNFD   ANOP                                                           09020004
         LA    IALCBR0,&NOTFND                                          09030004
         ST    IALCBR0,IALCNFND        INSERT ADDRESS OF NOT-FOUND EXIT 09040004
.CHKEOF1 ANOP                                                           09050004
.*                                                                      09060004
.*       INSERT EODAD, IF SPECIFIED                                     09070004
.*                                                                      09080004
         AIF   (T'&EODAD EQ 'O').CHKERR1                                09090004
         AIF   ('&EODAD'(1,1) NE '(').NREOF                             09100004
&REG     SETC  '&EODAD'(2,K'&EODAD-2)                                   09110004
         ST    &REG,IALCEOF            INSERT ADDRESS OF EOF EXIT       09120004
         AGO   .CHKERR1                                                 09130004
.NREOF   ANOP                                                           09140004
         LA    IALCBR0,&EODAD                                           09150004
         ST    IALCBR0,IALCEOF         INSERT ADDRESS OF EOF EXIT       09160004
.CHKERR1 ANOP                                                           09170004
.*                                                                      09180004
.*       INSERT ERPOT                                                   09190004
.*                                                                      09200004
         AIF   (T'&EROPT EQ 'O').CHKSYN1                                09210004
         AIF   ('&EROPT' NE 'CANCEL').CHKSYCA                           09220004
         OI    IALCEROP,IALCCANC       INSERT ERROR OPTION              09230004
         AGO   .CHKSYN1                                                 09240004
.CHKSYCA ANOP                                                           09250004
         NI    IALCEROP,X'FF'-IALCCANC INSERT ERROR OPTION              09260004
.CHKSYN1 ANOP                                                           09270004
.*                                                                      09280004
.*       INSERT ERROR EXIT, IF SPECIFIED                                09290004
.*                                                                      09300004
         AIF   (T'&ERRAD EQ 'O').CHKSVX1                                09310004
         AIF   ('&ERRAD'(1,1) NE '(').NRERR                             09320004
&REG     SETC  '&ERRAD'(2,K'&ERRAD-2)                                   09330004
         ST    &REG,IALCERR            INSERT ADDRESS OF ERROR EXIT     09340004
         AGO   .CHKSVX1                                                 09350004
.NRERR   ANOP                                                           09360004
         LA    IALCBR0,&ERRAD                                           09370004
         ST    IALCBR0,IALCERR         INSERT ADDRESS OF ERROR EXIT     09380004
.CHKSVX1 ANOP                                                           09390004
.*                                                             @D52TDJS 09400004
.*       INSERT SRVEXIT, IF SPECIFIED                          @D52TDJS 09410004
.*                                                             @D52TDJS 09420004
         AIF   (T'&SRVEXIT EQ 'O').CHKNEXT                     @D52TDJS 09430004
         AIF   ('&SRVEXIT'(1,1) NE '(').NRSRVEX                @D52TDJS 09440004
&REG     SETC  '&SRVEXIT'(2,K'&SRVEXIT-2)                      @D52TDJS 09450004
         ST    &REG,IALCSRVX      INSERT ADDRESS OF SERVICE EXIT        09460004
         AGO   .CHKNEXT                                                 09470004
.NRSRVEX ANOP                                                           09480004
         LA    IALCBR0,&SRVEXIT                                         09490004
         ST    IALCBR0,IALCSRVX   INSERT ADDRESS OF SERVICE EXIT        09500004
.CHKNEXT ANOP                                                           09510004
         DROP  IALCBR1                                                  09520004
.MEND    ANOP                                                           09530004
         MEND                             END OF PLS COMMENT         */ 09540004
*%PLSIALCB:;                                                            09550004
*%LIBRDCB: MACRO KEYS(FUNC,                                             09560004
*                      AREA,                                            09570004
*                      LIB,                                             09580004
*                      SUBLIB,                                          09590004
*                      MEMBER,                                          09600004
*                      TYPE,                                            09610004
*                      NMEMBER,                                         09620004
*                      NTYPE,                                           09630004
*                      LOCKID,                          /*@D52RDUT*/    09640004
*                      CATALOG,                                         09650004
*                      SCOPE,                                           09660004
*                      BUFFER,                                          09670004
*                      BUFSIZE,                                         09680004
*                      COMMIT,                                          09690004
*                      NOTEINF,                                         09700004
*                      NOTECTL,                                         09710004
*                      RECFM,                                           09720004
*                      LRECL,                                           09730004
*                      RECNO,                                           09740004
*                      UNITS,                                           09750004
*                      SYSIPT,                                          09760004
*                      CHAIN,                                           09770004
*                      CHAINID,                                         09780004
*                      DIRINF,                                          09790004
*                      DIRINFL,                                         09800004
*                      CONT,                                            09810004
*                      DATA,                                            09820004
*                      DATAID,                                          09830004
*                      DATALEN,                                         09840004
*                      NOTFND,                                          09850004
*                      EODAD,                                           09860004
*                      SRVEXIT,                                         09870004
*                      EROPT,                                           09880004
*                      ERRAD);                                          09890004
* /*******************************************************************/ 09900004
* /*  PLS PART OF LIBRDCB MACRO, DESCRIPTION SEE ASM PART            */ 09910004
* /*******************************************************************/ 09920004
* DCL (IALSYER,                       /* SYNTAX ERROR IN MACRO       */ 09930004
*      IALINN,                        /* LIBRDCB IS INNER  MACRO     */ 09940004
*      IALRC,                         /* RETURN CODE FOR IALSYER     */ 09950004
*  /*  LBR0SCO,                       /* CONTROLS SYSCOM GEN @D61NDMF*/ 09960004
*      IALACMP)                       /* CONTROLS GENERATION OF MAPS */ 09970004
*      FIXED EXTERNAL;                                                  09980004
* DCL (IALFC,                         /* MAIN FUNCTION OF LBRACCES   */ 09990004
*      IALOP1,                        /* OPEN OPTION PASSED BY IALC  */ 10000004
*      IALOP2,                        /* OPEN OPTION PASSED BY IALC  */ 10010004
*      IALCLOP,                       /* CLOSE OPTION PASSED BY IALC */ 10020004
*      IALNTOP)                                                         10030004
*      CHARACTER EXTERNAL;                                              10040004
* DCL (IN,TLABEL,TINFO,TMSGADR) CHARACTER;                              10050004
* DCL (COL1,COLA,COLA1,COLB,COLC,COLD,REGERR,RCWARN,RCERR,              10060004
*      CHAREA) FIXED;                                                   10070004
* COL1 = MACGLMAR;                                                      10080004
* COLA = MACLMAR;                                                       10090004
* COLA1 = COLA+5;                                                       10100004
* COLB = COLA+13;                                                       10110004
* COLC = COLB+10;                                                       10120004
* COLD = COLC+12;                                                       10130004
* RCWARN = 4;                                                           10140004
* RCERR = 8;                                                            10150004
* IN = MACLABEL||' '||MACNAME||' '||MACLIST||' '||MACKEYS;              10160004
* IN1 = ' LIBRARIAN - LIBRDCB - 5686-032-06-DB6  - VERSION 91-06-21';   10170004
* IF IALINN = 0 THEN                 /* MACRO CALLED AS OUTER MACRO  */ 10180004
* DO;                                                                   10190004
*   IALRC = 0;                       /* RESET RETURN CODE            */ 10200004
*   IALSYER = 0;                     /* RESET IALSYER                */ 10210004
*   IALFC = '';                      /* RESET FUNCTION CODE          */ 10220004
*   ANS (COMMENT(IN)) COL(COLA) SKIP RESCAN; /* ISSUE MACRO HEADER */   10230004
*   ANS (COMMENT(IN1)) COL(COLA) SKIP RESCAN;                           10240004
* END;                                                                  10250004
* /* INCLUDE LPT                                                     */ 10260004
* /* ANS ('? INLCLPT FCODE(YES) BASED(YES) TABLE(YES);') COL(COLA)   */ 10270004
* /*        SKIP RESCAN;                                             */ 10280004
* /*                                                                 */ 10290004
* /*  DO NOT GENERATE ANY MAPS OR EQUATES, IF IALACMP = 1            */ 10300004
* /*                                                                 */ 10310004
*    IF IALACMP = 0 THEN                                                10320004
*    DO;                                                                10330004
*      ANS ('? INLCIALC;') COL(COLA) SKIP RESCAN;                       10340004
*    IALACMP = 1;                                                       10350004
*    END;                                                               10360004
* /*                                                                 */ 10370004
* /*  DO NOT GENERATE DSECT FOR SYSCOM, IF LBR0SCO = 1               */ 10380004
* /*                                                                 */ 10390004
* /*IF LBR0SCO = 0 THEN                                              */ 10400004
* /* DO;                                                             */ 10410004
* /*   ANS ('GENERATE DATA;') COL(COLA) SKIP;                        */ 10420004
* /*   ANS ('SYSCOM   SYSCOM') COL(COL1);                            */ 10430004
* /*   ANS (MACCONC||'ENDGEN;') COL(COLA) SKIP RESCAN;               */ 10440004
* /*   LBR0SCO = 1;                                                  */ 10450004
* /* END;                                                            */ 10460004
* /*                                                                 */ 10470004
* /*  RETURN IF IALC SHOWCB WAS THE CALLER                           */ 10480004
* /*                                                                 */ 10490004
* IF IALFC = 'SHOWCB' THEN RETURN CODE(0);                              10500004
* /*                                                                 */ 10510004
* /*     FOR LIBRDCB AS OUTER MACRO SOME PARAMETERS ARE INVALID      */ 10520004
* /*                                                                 */ 10530004
* IF IALINN = 0 THEN                 /* LIBRDCB CALLED AS OUT. MACRO */ 10540004
* DO;                                                                   10550004
*   IF CATALOG(1) = ''  |                                              10560004
*     SCOPE(1)    = ''  |                                              10570004
*     NMEMBER(1)  = ''  |                                              10580004
*     NTYPE(1)    = ''  |                                              10590004
*     NOTEINF(1)  = ''  |                                              10600004
*     NOTECTL(1)  = ''  |                                              10610004
*     COMMIT(1)   = ''  |                                              10620004
*     SYSIPT(1)   = ''  |                                              10630004
*     LOCKID(1)   = ''  THEN              /*                @D52RDUT*/ 10640004
*   DO;                                                                 10650004
*      ANS MSG ('INVALID PARAMETER SPECIFIED, GENERATION SUPPRESSED')   10660004
*              COL(COLA) SKIP NORESCAN;                                 10670004
*      IALRC = RCERR;                                                   10680004
*      IALSYER =1;                                                      10690004
*   END;                                                                10700004
* END;                                                                  10710004
* /*                                                                 */ 10720004
* /*  FOR FUNC(MAP) NO OTHER PARAMETERS ARE VALID                    */ 10730004
* /*                                                                 */ 10740004
* IF FUNC(1) = 'MAP' THEN                                               10750004
* DO;                                                                   10760004
*   IF LENGTH(AREA(1)) + LENGTH(LIB(1)) + LENGTH(SUBLIB(1)) +           10770004
*      LENGTH(MEMBER(1)) + LENGTH(TYPE(1)) +                            10780004
*      LENGTH(BUFFER(1)) + LENGTH(BUFSIZE(1)) +                         10790004
*      LENGTH(RECFM(1)) +  LENGTH(LRECL(1)) +                           10800004
*      LENGTH(RECNO(1)) + LENGTH(UNITS(1)) +                            10810004
*      LENGTH(CHAIN(1)) + LENGTH(CHAINID(1)) +                          10820004
*      LENGTH(DIRINF(1)) + LENGTH(DIRINFL(1)) + LENGTH(DATA(1)) +       10830004
*      LENGTH(DATAID(1)) + LENGTH(DATALEN(1)) + LENGTH(NOTFND(1)) +     10840004
*      LENGTH(EROPT(1)) + LENGTH(CONT(1)) +                             10850004
*      LENGTH(SRVEXIT(1)) +                               /* @D52TDJS*/ 10860004
*      LENGTH(EODAD(1)) + LENGTH(ERRAD(1)) +                            10870004
*      LENGTH(LOCKID(1)) = 0 THEN                         /*@D52RDUT*/ 10880004
*   DO;                                                                 10890004
*     ANS MSG ('ALL OTHER PARAMETERS IGNORED FOR FUNC(MAP)')            10900004
*               SKIP COL(COLA);                                         10910004
*     IALRC = RCWARN;                                                   10920004
*   END;                                                                10930004
*   GOTO MEND;                                                          10940004
* END;                                                                  10950004
* /*                                                                 */ 10960004
* /*  CHECK MACRO FUNCTION                                           */ 10970004
* /*                                                                 */ 10980004
* IF FUNC(1) = '' THEN                                                  10990004
* DO;                                                                   11000004
*   ANS MSG ('FUNC IS NOT SPECIFIED, GENERATION SUPPRESSED')            11010004
*             COL(COLA) SKIP;                                           11020004
*   IALRC = RCERR;                                                      11030004
*   GOTO MEND;                                                          11040004
* END;                                                                  11050004
* IF FUNC(1) = 'GEN' |                                                  11060004
*    FUNC(1) = 'MOD' THEN;                                              11070004
* ELSE DO;                                                              11080004
*   ANS MSG ('FUNC REQUEST IS INVALID, GENERATION SUPPRESSED')          11090004
*             COL(COLA) SKIP;                                           11100004
*   IALRC = RCERR;                                                      11110004
*   GOTO MEND;                                                          11120004
* END;                                                                  11130004
* VALMF:;                                                               11140004
* /*                                                                 */ 11150004
* /*     CHECK VALIDATION OF VALUE PARAMETERS                        */ 11160004
* /*                                                                 */ 11170004
* /* CHECK RECORD FORMAT                                             */ 11180004
* IF RECFM(1) = '' |                                                    11190004
*    RECFM(1) = 'S' |                                                   11200004
*    RECFM(1) = 'F'   THEN;                                             11210004
* ELSE DO;                                                              11220004
*   ANS MSG                                                             11230004
*   ('RECFM REQUEST IS INVALID, GENERATION SUPPRESSED')                 11240004
*   COL(COLA) SKIP;                                                     11250004
*   IALRC = RCERR;                                                      11260004
*   IALSYER = 1;                                                        11270004
* END;                                                                  11280004
* /* CHECK SCOPE                                                     */ 11290004
* IF SCOPE(1) = '' |                                                    11300004
*    SCOPE(1) = 'TASK' |                                                11310004
*    SCOPE(1) = 'JOB'  |                                                11320004
*    SCOPE(1) = 'PART'   THEN;                                          11330004
* ELSE DO;                                                              11340004
*   ANS MSG                                                             11350004
*   ('SCOPE REQUEST IS INVALID, GENERATION SUPPRESSED')                 11360004
*   COL(COLA) SKIP;                                                     11370004
*   IALRC = RCERR;                                                      11380004
*   IALSYER = 1;                                                        11390004
* END;                                                                  11400004
* /* CHECK NOTECONTROL                                               */ 11410004
* IF NOTECTL(1) = '' |                                                  11420004
*    NOTECTL(1) = 'YES' |                                               11430004
*    NOTECTL(1) = 'NO'  THEN;                                           11440004
* ELSE DO;                                                              11450004
*   ANS MSG                                                             11460004
*   ('NOTECTL REQUEST IS INVALID, GENERATION SUPPRESSED')               11470004
*   COL(COLA) SKIP;                                                     11480004
*   IALRC = RCERR;                                                      11490004
*   IALSYER = 1;                                                        11500004
* END;                                                                  11510004
* /* CHECK SYSIPT                                                    */ 11520004
* IF SYSIPT(1) = '' |                                                   11530004
*    SYSIPT(1) = 'YES' |                                                11540004
*    SYSIPT(1) = 'NO'  THEN;                                            11550004
* ELSE DO;                                                              11560004
*   ANS MSG                                                             11570004
*   ('SYSIPT REQUEST IS INVALID, GENERATION SUPPRESSED')                11580004
*   COL(COLA) SKIP;                                                     11590004
*   IALRC = RCERR;                                                      11600004
*   IALSYER = 1;                                                        11610004
* END;                                                                  11620004
* /* CHECK CONT                                                      */ 11630004
* IF CONT(1) = '' |                                                     11640004
*    CONT(1) = 'YES' |                                                  11650004
*    CONT(1) = 'NO'  THEN;                                              11660004
* ELSE DO;                                                              11670004
*   ANS MSG                                                             11680004
*   ('CONT REQUEST IS INVALID, GENERATION SUPPRESSED')                  11690004
*   COL(COLA) SKIP;                                                     11700004
*   IALRC = RCERR;                                                      11710004
*   IALSYER = 1;                                                        11720004
* END;                                                                  11730004
* /* CHECK COMMIT                                                    */ 11740004
* IF COMMIT(1) = '' |                                                   11750004
*    COMMIT(1) = 'YES' |                                                11760004
*    COMMIT(1) = 'NO'  THEN;                                            11770004
* ELSE DO;                                                              11780004
*   ANS MSG                                                             11790004
*   ('COMMIT REQUEST IS INVALID, GENERATION SUPPRESSED')                11800004
*   COL(COLA) SKIP;                                                     11810004
*   IALRC = RCERR;                                                      11820004
*   IALSYER = 1;                                                        11830004
* END;                                                                  11840004
* /* CHECK EROPT                                                     */ 11850004
* IF EROPT(1) = '' |                                                    11860004
*    EROPT(1) = 'RET' |                                                 11870004
*    EROPT(1) = 'CANCEL'   THEN;                                        11880004
* ELSE DO;                                                              11890004
*   ANS MSG                                                             11900004
*   ('EROPT REQUEST IS INVALID, GENERATION SUPPRESSED')                 11910004
*   COL(COLA) SKIP;                                                     11920004
*   IALRC = RCERR;                                                      11930004
*   IALSYER = 1;                                                        11940004
* END;                                                                  11950004
* /*                                                                 */ 11960004
* /*       SOME PARAMETERS CAN ONLY BE SPECIFIED TOGETHER            */ 11970004
* /*                                                                 */ 11980004
* /*  BUFFER,BUFSIZE                                                 */ 11990004
* IF BUFFER(1) = '' & BUFSIZE(1) = '' THEN;                             12000004
* ELSE DO;                                                              12010004
*   IF BUFFER(1) = '' & BUFSIZE(1) = '' THEN;                         12020004
*   ELSE DO;                                                            12030004
*     ANS MSG                                                           12040004
*('BUFFER, BUFSIZE MUST BE SPECIFIED TOGETHER, GENERATION SUPPRESSED')  12050004
*       COL(COLA) SKIP;                                                 12060004
*     IALRC = RCERR;                                                    12070004
*     IALSYER = 1;                                                      12080004
*   END;                                                                12090004
* END;                                                                  12100004
* /*  DATA,DATAID,DATALEN                                            */ 12110004
* IF DATA(1) = '' & DATAID(1) = '' & DATALEN(1) = '' THEN;              12120004
* ELSE DO;                                                              12130004
*   IF DATA(1) = '' & DATAID(1) = '' & DATALEN(1)= '' THEN;          12140004
*   ELSE DO;                                                            12150004
*       ANS MSG                                                         12160004
*       ('DATA,DATAID,DATALEN MUST BE SPECIFIED TOGETHER, ' ||          12170004
*       'GENERATION SUPPRESSED')                                        12180004
*        COL(COLA) SKIP;                                                12190004
*       IALRC = RCERR;                                                  12200004
*       IALSYER = 1;                                                    12210004
*   END;                                                                12220004
* END;                                                                  12230004
* /*  LIB,SUBLIB  ( NOT AT STATE(LIB) OR STATE(MEMBER)               */ 12240004
* IF IALFC = 'STATLIB' THEN; /* SKIP CHECK AT STATE(LIB)    */          12250004
* ELSE DO;                                                              12260004
*   IF LIB(1) = '' & SUBLIB(1) = '' THEN;                               12270004
*   ELSE DO;                                                            12280004
*     IF LIB(1) = '' & SUBLIB(1) = '' THEN;                           12290004
*     ELSE DO;                                                          12300004
*       ANS MSG                                                         12310004
*     ('LIB,SUBLIB  MUST BE SPECIFIED TOGETHER, GENERATION SUPPRESSED') 12320004
*       COL(COLA) SKIP;                                                 12330004
*       IALRC = RCERR;                                                  12340004
*       IALSYER = 1;                                                    12350004
*     END;                                                              12360004
*   END;                                                                12370004
* END;                                                                  12380004
* /*  MEMBER AND MEMBER TYPE                                         */ 12390004
* IF MEMBER(1) = '' & TYPE(1) = '' THEN;                                12400004
* ELSE DO;                                                              12410004
*   IF MEMBER(1) = '' & TYPE(1) = '' THEN;                            12420004
*   ELSE DO;                                                            12430004
*     ANS MSG                                                           12440004
*('MEMBER, TYPE MUST BE SPECIFIED TOGETHER, GENERATION SUPPRESSED')     12450004
*       COL(COLA) SKIP;                                                 12460004
*     IALRC = RCERR;                                                    12470004
*     IALSYER = 1;                                                      12480004
*   END;                                                                12490004
* END;                                                                  12500004
* /*  DIRECTORY PARAMETER                                            */ 12510004
* IF DIRINF(1) = '' & DIRINFL(1) = '' THEN;                             12520004
* ELSE DO;                                                              12530004
*   IF DIRINF(1) = '' & DIRINFL(1) = '' THEN;                         12540004
*   ELSE DO;                                                            12550004
*     ANS MSG                                                           12560004
*('DIRINF, DIRINFL MUST BE SPECIFIED TOGETHER, GENERATION SUPPRESSED')  12570004
*       COL(COLA) SKIP;                                                 12580004
*     IALRC = RCERR;                                                    12590004
*     IALSYER = 1;                                                      12600004
*   END;                                                                12610004
* END;                                                                  12620004
* /*                                                                 */ 12630004
* /*     IF LRECL IS SPECIFIED, RECFM MUST BE F OR V                 */ 12640004
* /*                                                                 */ 12650004
* IF LRECL(1) = '' THEN                                                12660004
* DO;                                                                   12670004
*   IF RECFM(1) = 'S' THEN                                              12680004
*   DO;                                                                 12690004
*     ANS MSG                                                           12700004
*('LRECL  IS INVALID AT RECFM=S, PARAMETER IGNORED')                    12710004
*     COL(COLA) SKIP;                                                   12720004
*     IALRC = RCWARN;                                                   12730004
*   END;                                                                12740004
* END;                                                                  12750004
*                                                                       12760004
* /* AREA MUST BE SPECIFIED FOR GEN OR MOD                           */ 12770004
*                                                                       12780004
* IF NUMBER(AREA) = 0 THEN                                              12790004
* DO;                                                                   12800004
*     ANS MSG                                                           12810004
*   ('AREA MUST BE SPECIFED FOR FUNC(GEN|MOD), GENERATION SUPPRESSED')  12820004
*     COL(COLA) SKIP;                                                   12830004
*     IALRC = RCERR;                                                    12840004
*     IALSYER = 1;                                                      12850004
* END;                                                                  12860004
*                                                                       12870004
*  /* GENERATION OF CODE IS SUPPRESSED, FOR ANY SYNTAX ERRORS EITHER */ 12880004
*  /* LIBR OR LIBRDCB                                                */ 12890004
*                                                                       12900004
* IF IALSYER = 1 THEN GOTO MEND;                                        12910004
*   IF IALINN = 0 THEN IALFC = ' '; /* CLEAR FUNCTION CODE, IF CALLED   12920004
* /*                                                                 */ 12930004
* /*  DYNAMIC GENERATION OR MODIFICATION OF CONTROL BLOCK            */ 12940004
* /*                                                                 */ 12950004
* /*                                                                 */ 12960004
* /*  ADDRESSING OF CONTROL BLOCK                                    */ 12970004
* /*                                                                 */ 12980004
*    IF MACLABEL = '' THEN                                             12990004
*       ANS (MACLABEL||';') SKIP COL(COLA);                             13000004
*    ANS ('RFY IALCBR1 RSTD;')                                          13010004
*         COL(COLA) SKIP RESCAN;                                        13020004
*    IF AREA(1,1:1) = '(' THEN                                          13030004
*       ANS ('IALCBR1 = '||AREA(1,1)||';')SKIP COL(COLA) RESCAN;        13040004
*    ELSE                                                               13050004
*       ANS ('IALCBR1 = ADDR('||AREA(1)||');') SKIP COL(COLA) RESCAN;   13060004
*    ANS ('/* REGISTER 1 POINTS TO CONTROL BLOCK */') COL(COLD);        13070004
*    ANS ('RFY INLCIALC BASED(IALCBR1);')                               13080004
*         COL(COLA) SKIP RESCAN;                                        13090004
*    IF FUNC(1) = 'GEN' THEN                                            13100004
*       DO;                                                             13110004
* /*                                                                 */ 13120004
* /*  FOR FUNC(GEN) THE CONTROL BLOCK MUST BE CLEARED                */ 13130004
* /*                                                                 */ 13140004
*       ANS ('IALCCB = ''''B;') COL(COLA) SKIP;                         13150004
*       ANS ('/* CLEAR CONTROL BLOCK */') COL(COLD);                    13160004
*       ANS ('IALCID = ''IALC'';') COL(COLA) SKIP;                      13170004
*       ANS ('/* SET INITIAL VALUES  */') COL(COLD);                    13180004
*       ANS ('IALCNORC = -1;') COL(COLA) SKIP;                          13190004
*       ANS ('IALCMSGA = ADDR(IALCMSG);') COL(COLA) SKIP;               13200004
*       ANS ('IALCMSG = '' '';') COL (COLA) SKIP;                       13210004
*       END;                                                            13220004
*       ANS ('IALCCMD = '''||IALFC||''';') COL(COLA) SKIP;              13230004
*       ANS ('/* INSERT COMMAND      */') COL(COLD);                    13240004
* /*                                                                 */ 13250004
* /*    INSERT GLOBAL VARIABLES                                      */ 13260004
* /*                                                                 */ 13270004
* /*    OPEN OPTION                                                  */ 13280004
*       IF IALFC = 'OPEN' THEN                                          13290004
*         DO;                                                           13300004
*          IF IALOP1='INPUT' THEN                                       13310004
*          DO;                                                          13320004
*       ANS ('IALCOPEN = ''''X;') COL(COLA) SKIP;                       13330004
*       ANS ('IALCINP = ''1''B;') COL(COLA) SKIP;                       13340004
*       ANS ('/* INSERT OPEN OPTION  */') COL(COLD);                    13350004
*          END;                                                         13360004
*          IF  IALOP1='UPDATE' THEN                                     13370004
*          DO;                                                          13380004
*       ANS ('IALCOPEN = ''''X;') COL(COLA) SKIP;                       13390004
*       ANS ('IALCUPD = ''1''B;') COL(COLA) SKIP;                       13400004
*       ANS ('/* INSERT OPEN OPTION  */') COL(COLD);                    13410004
*          END;                                                         13420004
*          IF  IALOP1='INOUT' THEN                                      13430004
*          DO;                                                          13440004
*       ANS ('IALCOPEN = ''''X;') COL(COLA) SKIP;                       13450004
*       ANS ('IALCIOUT = ''1''B;') COL(COLA) SKIP;                      13460004
*       ANS ('/* INSERT OPEN OPTION  */') COL(COLD);                    13470004
*          END;                                                         13480004
*          IF  IALOP1='OUTPUT' THEN                                     13490004
*          DO;                                                          13500004
*       ANS ('IALCOPEN = ''''X;') COL(COLA) SKIP;                       13510004
*       ANS ('/* INSERT OPEN OPTION  */') COL(COLD);                    13520004
*             IF IALOP2 = 'REPLACE' THEN                                13530004
*       ANS ('IALCOUTR = ''1''B;') COL(COLA) SKIP;                      13540004
*              ELSE                                                     13550004
*       ANS ('IALCOUTN = ''1''B;') COL(COLA) SKIP;                      13560004
*          END;                                                         13570004
*          END;                                                         13580004
* /*                                                                 */ 13590004
* /*  INSERT LIB, IF SPECIFIED                                      */  13600004
* /*                                                                 */ 13610004
*    IF LIB(1) = '' THEN                                               13620004
*    DO;                                                                13630004
*      IF LIB(1,1:1) = '(' THEN                                         13640004
*         TINFO = LIB(1,1);                                             13650004
*      ELSE                                                             13660004
*         TINFO = 'ADDR('||LIB(1)||')';                                 13670004
*      ANS ('IALCLIB = '||TINFO||';') COL(COLA) SKIP RESCAN;            13680004
*      ANS ('/* INSERT LIB     */') COL(COLD);                          13690004
*    END;                                                               13700004
* /*                                                                 */ 13710004
* /*  INSERT SUBLIB, IF SPECIFIED                                    */ 13720004
* /*                                                                 */ 13730004
*    IF SUBLIB(1) = '' THEN                                            13740004
*    DO;                                                                13750004
*      IF SUBLIB(1,1:1) = '(' THEN                                      13760004
*         TINFO = SUBLIB(1,1);                                          13770004
*      ELSE                                                             13780004
*         TINFO = 'ADDR('||SUBLIB(1)||')';                              13790004
*      ANS ('IALCSLIB = '||TINFO||';') COL(COLA) SKIP RESCAN;           13800004
*      ANS ('/* INSERT SUBLIB  */') COL(COLD);                          13810004
*    END;                                                               13820004
* /*                                                                 */ 13830004
* /*  INSERT MEMBER, IF SPECIFIED                                    */ 13840004
* /*                                                                 */ 13850004
*    IF MEMBER(1) = '' THEN                                            13860004
*    DO;                                                                13870004
*      IF MEMBER(1,1:1) = '(' THEN                                      13880004
*         TINFO = MEMBER(1,1);                                          13890004
*      ELSE                                                             13900004
*         TINFO = 'ADDR('||MEMBER(1)||')';                              13910004
*      ANS ('IALCMEMB = '||TINFO||';') COL(COLA) SKIP RESCAN;           13920004
*      ANS ('/* INSERT MEMBER  */') COL(COLD);                          13930004
*    END;                                                               13940004
* /*                                                                 */ 13950004
* /*  INSERT TYPE, IF SPECIFIED                                      */ 13960004
* /*                                                                 */ 13970004
*    IF TYPE(1) = '' THEN                                              13980004
*    DO;                                                                13990004
*      IF TYPE(1,1:1) = '(' THEN                                        14000004
*         TINFO = TYPE(1,1);                                            14010004
*      ELSE                                                             14020004
*         TINFO = 'ADDR('||TYPE(1)||')';                                14030004
*      ANS ('IALCTYPE = '||TINFO||';') COL(COLA) SKIP RESCAN;           14040004
*      ANS ('/* INSERT TYPE    */') COL(COLD);                          14050004
*    END;                                                               14060004
* /*                                                                 */ 14070004
* /*  INSERT NMEMBER, IF SPECIFIED                                   */ 14080004
* /*                                                                 */ 14090004
*    IF NMEMBER(1) = '' THEN                                           14100004
*    DO;                                                                14110004
*      IF NMEMBER(1,1:1) = '(' THEN                                     14120004
*         TINFO = NMEMBER(1,1);                                         14130004
*      ELSE                                                             14140004
*         TINFO = 'ADDR('||NMEMBER(1)||')';                             14150004
*      ANS ('IALCNMBR = '||TINFO||';') COL(COLA) SKIP RESCAN;           14160004
*      ANS ('/* INSERT NMEMBER */') COL(COLD);                          14170004
*    END;                                                               14180004
* /*                                                                 */ 14190004
* /*  INSERT NTYPE, IF SPECIFIED                                     */ 14200004
* /*                                                                 */ 14210004
*    IF NTYPE(1) = '' THEN                                             14220004
*    DO;                                                                14230004
*      IF NTYPE(1,1:1) = '(' THEN                                       14240004
*         TINFO = NTYPE(1,1);                                           14250004
*      ELSE                                                             14260004
*         TINFO = 'ADDR('||NTYPE(1)||')';                               14270004
*      ANS ('IALCNTYP = '||TINFO||';') COL(COLA) SKIP RESCAN;           14280004
*      ANS ('/* INSERT NTYPE   */') COL(COLD);                          14290004
*    END;                                                               14300004
* /*                                                         @D52RDUT*/ 14310004
* /*  INSERT LOCKID, IF SPECIFIED                            @D52RDUT*/ 14320004
* /*                                                         @D52RDUT*/ 14330004
*    IF LOCKID(1) = '' THEN                               /*@D52RDUT*/ 14340004
*    DO;                                                   /*@D52RDUT*/ 14350004
*      IF LOCKID(1,1:1) = '(' THEN                         /*@D52RDUT*/ 14360004
*         TINFO = LOCKID(1,1);                             /*@D52RDUT*/ 14370004
*      ELSE                                                /*@D52RDUT*/ 14380004
*         TINFO = 'ADDR('||LOCKID(1)||')';                 /*@D52RDUT*/ 14390004
*      ANS ('IALCLKID = '||TINFO||';') COL(COLA) SKIP      /*@D52RDUT*/ 14400004
*                                       RESCAN;            /*@D52RDUT*/ 14410004
*      ANS ('/* INSERT LOCKID @D52RDUT*/') COL(COLD);      /*@D52RDUT*/ 14420004
*      ANS('IALCLKMD = ''1''B;') COL(COLA) SKIP RESCAN;   /* @D52TDJS*/ 14430004
*  ANS ('/* LOCKID MODIFIED        @D52TDJS*/') COL(COLD);/* @D52TDJS*/ 14440004
*    END;                                                  /*@D52RDUT*/ 14450004
* /*                                                                 */ 14460004
* /*  INSERT CHAIN, IF SPECIFIED                                   */   14470004
* /*                                                                 */ 14480004
*    IF CHAIN(1) = '' THEN                                             14490004
*    DO;                                                                14500004
*      IF CHAIN(1,1:1) = '(' THEN                                       14510004
*         TINFO = CHAIN(1,1);                                           14520004
*      ELSE                                                             14530004
*         TINFO = 'ADDR('||CHAIN(1)||')';                               14540004
*      ANS ('IALCACCS = '||TINFO||';') COL(COLA) SKIP RESCAN;           14550004
*      ANS ('/* INSERT CHAIN   */') COL(COLD);                          14560004
*    END;                                                               14570004
* /*                                                                 */ 14580004
* /*  INSERT CATALOG, IF SPECIFIED                                 */   14590004
* /*                                                                 */ 14600004
*    IF CATALOG(1) = '' THEN                                           14610004
*    DO;                                                                14620004
*      IF CATALOG(1,1:1) = '(' THEN                                     14630004
*         TINFO = CATALOG(1,1);                                         14640004
*      ELSE                                                             14650004
*         TINFO = 'ADDR('||CATALOG(1)||')';                             14660004
*      ANS ('IALCCTLG = '||TINFO||';') COL(COLA) SKIP RESCAN;           14670004
*      ANS ('/* INSERT CATALOG */') COL(COLD);                          14680004
*    END;                                                               14690004
*    ELSE DO;                                                           14700004
*      IF IALFC = 'STATCHN' THEN                                        14710004
*      DO;                                                              14720004
*        ANS ('IALCCTLG = 0;') COL(COLA) SKIP RESCAN;                   14730004
*        ANS ('/* RESET CATALOG ENTRY */') COL(COLD);                   14740004
*      END;                                                             14750004
*     END;                                                              14760004
* /*                                                                 */ 14770004
* /*  INSERT CHAINID, IF SPECIFIED                                 */   14780004
* /*                                                                 */ 14790004
*    IF CHAINID(1) = '' THEN                                           14800004
*    DO;                                                                14810004
*      IF CHAINID(1,1:1) = '(' THEN                                     14820004
*         TINFO = CHAINID(1,1);                                         14830004
*      ELSE                                                             14840004
*         TINFO = 'ADDR('||CHAINID(1)||')';                             14850004
*      ANS ('IALCCHID = '||TINFO||';') COL(COLA) SKIP RESCAN;           14860004
*      ANS ('/* INSERT CHAINID */') COL(COLD);                          14870004
*    END;                                                               14880004
* /*                                                                 */ 14890004
* /*  INSERT NOTEINF, IF SPECIFIED                                 */   14900004
* /*                                                                 */ 14910004
*    IF NOTEINF(1) = '' THEN                                           14920004
*    DO;                                                                14930004
*      IF NOTEINF(1,1:1) = '(' THEN                                     14940004
*         TINFO = NOTEINF(1,1);                                         14950004
*      ELSE                                                             14960004
*         TINFO = 'ADDR('||NOTEINF(1)||')';                             14970004
*      ANS ('IALCNOTE = '||TINFO||';') COL(COLA) SKIP RESCAN;           14980004
*      ANS ('/* INSERT NOTEINF */') COL(COLD);                          14990004
*    END;                                                               15000004
* /*                                                                 */ 15010004
* /*  INSERT NOTECONTROL, IF SPECIFIED                               */ 15020004
* /*                                                                 */ 15030004
*    IF NOTECTL(1) = '' THEN                                           15040004
*    DO;                                                                15050004
*      IF NOTECTL(1) = 'YES' THEN                                       15060004
*      DO;                                                              15070004
*        ANS ('IALCNCTL = ''1''B;') COL(COLA) SKIP RESCAN;              15080004
*        ANS ('/* INSERT NOTECTL */') COL(COLD);                        15090004
*      END;                                                             15100004
*      ELSE DO;                                                         15110004
*        ANS ('IALCNCTL = ''''B;') COL(COLA) SKIP RESCAN;               15120004
*        ANS ('/* INSERT NOTECTL */') COL(COLD);                        15130004
*      END;                                                             15140004
*    END;                                                               15150004
* /*                                                                 */ 15160004
* /*  INSERT BUFFER, IF SPECIFIED                                    */ 15170004
* /*                                                                 */ 15180004
*    IF BUFFER(1) = '' THEN                                            15190004
*    DO;                                                                15200004
*      IF BUFFER(1,1:1) = '(' THEN                                      15210004
*         TINFO = BUFFER(1,1);                                          15220004
*      ELSE                                                             15230004
*         TINFO = 'ADDR('||BUFFER(1)||')';                              15240004
*      ANS ('IALCBUFF = '||TINFO||';') COL(COLA) SKIP RESCAN;           15250004
*      ANS ('/* INSERT BUFFER    */') COL(COLD);                        15260004
*    END;                                                               15270004
* /*                                                                 */ 15280004
* /*  INSERT BUFSIZE, IF SPECIFIED                                   */ 15290004
* /*                                                                 */ 15300004
*    IF BUFSIZE(1) = '' THEN                                           15310004
*    DO;                                                                15320004
*      IF BUFSIZE(1,1:1) = '(' THEN                                     15330004
*         TINFO = BUFSIZE(1,1);                                         15340004
*      ELSE                                                             15350004
*         TINFO = BUFSIZE(1);                                           15360004
*      ANS ('IALCBSIZ = '||TINFO||';') COL(COLA) SKIP RESCAN;           15370004
*      ANS ('/* INSERT BUFFERSIZE    */') COL(COLD);                    15380004
*    END;                                                               15390004
* /*                                                                 */ 15400004
* /*    INSERT RECFM, IF SPECIFIED                                   */ 15410004
* /*                                                                 */ 15420004
*    IF RECFM(1) = '' THEN                                             15430004
*    DO;                                                                15440004
*      ANS ('IALCRCFM = ''''B;') COL(COLA) SKIP RESCAN;                 15450004
*      ANS ('/* INSERT RECFM         */') COL(COLD);                    15460004
*      ANS('IALCRFMD = ''1''B;') COL(COLA) SKIP RESCAN;/* @D52TDJS*/    15470004
*  ANS ('/* RECFM MODIFIED BY USER @D52TDJS*/') COL(COLD);/* @D52TDJS*/ 15480004
*      IF RECFM(1) = 'S'                                                15490004
*         THEN  ANS('IALCRFUN = ''1''B;')  COL(COLA) SKIP RESCAN;       15500004
*         ELSE IF RECFM(1) = 'F'                                        15510004
*              THEN  ANS('IALCRFFX = ''1''B;') COL(COLA) SKIP RESCAN;   15520004
* /*                                                                 */ 15530004
* /*  ON EACH MODIFY OF RECFM WITHOUT UNITS, UNITS IS SET TO DEFAULT */ 15540004
* /*                                                                 */ 15550004
*      IF UNITS(1) = '' THEN         /* SET UNITS TO DEFAULT         */ 15560004
*      DO;                                                              15570004
*        IF RECFM(1) = 'S' THEN                                         15580004
*        DO;                                                            15590004
*          ANS('IALCNORC = 0;') COL(COLA) SKIP RESCAN;                  15600004
*          ANS ('/* UNIT IS SET TO DEFAULT */') COL(COLD);              15610004
*         ANS('IALCUNMD = ''1''B;') COL(COLA) SKIP RESCAN;/* @D52TDJS*/ 15620004
*  ANS ('/* UNITS MODIFIED BY USER @D52TDJS*/') COL(COLD);/* @D52TDJS*/ 15630004
*        END;                                                           15640004
*        ELSE DO;                                                       15650004
*          ANS('IALCNORC = 1;') COL(COLA) SKIP RESCAN;                  15660004
*          ANS ('/* UNIT IS SET TO DEFAULT */') COL(COLD);              15670004
*         ANS('IALCUNMD = ''1''B;') COL(COLA) SKIP RESCAN;/* @D52TDJS*/ 15680004
*  ANS ('/* UNITS MODIFIED BY USER @D52TDJS*/') COL(COLD);/* @D52TDJS*/ 15690004
*        END;                                                           15700004
*      END;                                                             15710004
* /*                                                                 */ 15720004
* /*  ON EACH MODIFY OF RECFM WITHOUT LRECL, LRECL IS CLEARED        */ 15730004
* /*                                                                 */ 15740004
*     IF LRECL(1) = '' THEN          /* CLEAR LRECL                  */ 15750004
*     DO;                                                               15760004
*       ANS('IALCLREC = 0;') COL(COLA) SKIP RESCAN;                     15770004
*       ANS ('/* CLEAR LRECL            */') COL(COLD);                 15780004
*     END;                                                              15790004
*   END;                                                                15800004
* /*                                                                 */ 15810004
* /*    INSERT COMMIT, IF SPECIFIED                                  */ 15820004
* /*                                                                 */ 15830004
*   IF COMMIT(1) = '' THEN                                             15840004
*   DO;                                                                 15850004
*     ANS ('IALCCLSE = ''''B;') COL(COLA) SKIP RESCAN;                  15860004
*     ANS ('/* INSERT COMMIT       */') COL(COLD);                      15870004
*     IF COMMIT(1) = 'NO'                                               15880004
*        THEN ANS ('IALCNCMT = ''1''B;') COL(COLA) SKIP RESCAN;         15890004
*   END;                                                                15900004
* /*                                                                 */ 15910004
* /*  INSERT CONT, IF SPECIFIED                                      */ 15920004
* /*                                                                 */ 15930004
*    IF CONT(1) = '' THEN                                              15940004
*    DO;                                                                15950004
*      IF CONT(1) = 'YES' THEN                                          15960004
*      DO;                                                              15970004
*        ANS ('IALCNCNT = ''''B;') COL(COLA) SKIP RESCAN;               15980004
*        ANS ('/* INSERT CONTINUATION OPTION      */') COL(COLD);       15990004
*      END;                                                             16000004
*      ELSE DO;                                                         16010004
*        ANS ('IALCNCNT = ''1''B;') COL(COLA) SKIP RESCAN;              16020004
*        ANS ('/* INSERT CONTINUATION OPTION     */') COL(COLD);        16030004
*      END;                                                             16040004
*    END;                                                               16050004
* /*                                                                 */ 16060004
* /*    INSERT SCOPE, IF SPECIFIED                                   */ 16070004
* /*                                                                 */ 16080004
*   IF SCOPE(1) = '' THEN                                              16090004
*   DO;                                                                 16100004
*     ANS ('IALCSCOP = ''''B;') COL(COLA) SKIP RESCAN;                  16110004
*     ANS ('/* INSERT SCOPE        */') COL(COLD);                      16120004
*     IF SCOPE(1) = 'TASK'                                              16130004
*        THEN ANS ('IALCTASK = ''1''B;') COL(COLA) SKIP RESCAN;         16140004
*        ELSE IF SCOPE(1) = 'JOB'                                       16150004
*                THEN ANS ('IALCJOB = ''1''B;') COL(COLA) SKIP RESCAN;  16160004
*                ELSE ANS ('IALCPART = ''1''B;') COL(COLA) SKIP RESCAN; 16170004
*   END;                                                                16180004
* /*                                                                 */ 16190004
* /*  INSERT SYSIPT, IF SPECIFIED                                    */ 16200004
* /*                                                                 */ 16210004
*    IF SYSIPT(1) = '' THEN                                            16220004
*    DO;                                                                16230004
*      IF SYSIPT(1) = 'YES' THEN                                        16240004
*      DO;                                                              16250004
*        ANS ('IALCSIPT = ''1''B;') COL(COLA) SKIP RESCAN;              16260004
*        ANS ('/* INSERT SYSIPT      */') COL(COLD);                    16270004
*      END;                                                             16280004
*      ELSE DO;                                                         16290004
*        ANS ('IALCSIPT = ''''B;') COL(COLA) SKIP RESCAN;               16300004
*        ANS ('/* INSERT SYSIPT     */') COL(COLD);                     16310004
*      END;                                                             16320004
*    END;                                                               16330004
* /*                                                                 */ 16340004
* /*  INSERT LRECL, IF SPECIFIED                                     */ 16350004
* /*                                                                 */ 16360004
*    IF LRECL(1) = '' THEN                                             16370004
*    DO;                                                                16380004
*      IF LRECL(1,1:1) = '(' THEN                                       16390004
*         TINFO = LRECL(1,1);                                           16400004
*      ELSE                                                             16410004
*         TINFO = LRECL(1);                                             16420004
*      ANS ('IALCLREC = '||TINFO||';') COL(COLA) SKIP RESCAN;           16430004
*      ANS ('/* INSERT LRECL         */') COL(COLD);                    16440004
*    END;                                                               16450004
* /*                                                                 */ 16460004
* /*  INSERT UNITS, IF SPECIFIED                                     */ 16470004
* /*                                                                 */ 16480004
*    IF UNITS(1) = '' THEN                                             16490004
*    DO;                                                                16500004
*      IF UNITS(1,1:1) = '(' THEN                                       16510004
*         TINFO = UNITS(1,1);                                           16520004
*      ELSE                                                             16530004
*         TINFO = UNITS(1);                                             16540004
*      ANS ('IALCNORC = '||TINFO||';') COL(COLA) SKIP RESCAN;           16550004
*     ANS ('/* INSERT UNITS         */') COL(COLD);                     16560004
*     ANS('IALCUNMD = ''1''B;') COL(COLA) SKIP RESCAN;    /* @D52TDJS*/ 16570004
*  ANS ('/* UNITS MODIFIED BY USER @D52TDJS*/') COL(COLD);/* @D52TDJS*/ 16580004
*    END;                                                               16590004
* /*                                                                 */ 16600004
* /*  INSERT RECNO, IF SPECIFIED                                     */ 16610004
* /*                                                                 */ 16620004
*    IF RECNO(1) = '' THEN                                             16630004
*    DO;                                                                16640004
*      IF RECNO(1,1:1) = '(' THEN                                       16650004
*         TINFO = RECNO(1,1);                                           16660004
*      ELSE                                                             16670004
*         TINFO = RECNO(1);                                             16680004
*      ANS ('IALCRCNO = '||TINFO||';') COL(COLA) SKIP RESCAN;           16690004
*      ANS ('/* INSERT RECNO         */') COL(COLD);                    16700004
*     ANS('IALCRCMD = ''1''B;') COL(COLA) SKIP RESCAN;    /* @D52TDJS*/ 16710004
*  ANS ('/* RECNO MODIFIED BY USER @D52TDJS*/') COL(COLD);/* @D52TDJS*/ 16720004
*    END;                                                               16730004
* /*                                                                 */ 16740004
* /*  INSERT DIRINF, IF SPECIFIED                                    */ 16750004
* /*                                                                 */ 16760004
*    IF DIRINF(1) = '' THEN                                            16770004
*    DO;                                                                16780004
*      IF DIRINF(1,1:1) = '(' THEN                                      16790004
*         TINFO = DIRINF(1,1);                                          16800004
*      ELSE                                                             16810004
*         TINFO = 'ADDR('||DIRINF(1)||')';                              16820004
*      ANS ('IALCDENT = '||TINFO||';') COL(COLA) SKIP RESCAN;           16830004
*      ANS ('/* INSERT DIRINF    */') COL(COLD);                        16840004
*    END;                                                               16850004
* /*                                                                 */ 16860004
* /*  INSERT DIRINFL, IF SPECIFIED                                   */ 16870004
* /*                                                                 */ 16880004
*    IF DIRINFL(1) = '' THEN                                           16890004
*    DO;                                                                16900004
*      IF DIRINFL(1,1:1) = '(' THEN                                     16910004
*         TINFO = DIRINFL(1,1);                                         16920004
*      ELSE                                                             16930004
*         TINFO = DIRINFL(1);                                           16940004
*      ANS ('IALCDIRL = '||TINFO||';') COL(COLA) SKIP RESCAN;           16950004
*      ANS ('/* INSERT DIRINFL       */') COL(COLD);                    16960004
*    END;                                                               16970004
* /*                                                                 */ 16980004
* /*  INSERT DATAID, IF SPECIFIED                                    */ 16990004
* /*                                                                 */ 17000004
*    IF DATAID(1) = '' THEN                                            17010004
*    DO;                                                                17020004
*      IF DATAID(1,1:1) = '(' THEN                                      17030004
*         TINFO = DATAID(1,1);                                          17040004
*      ELSE                                                             17050004
*         TINFO = 'ADDR('||DATAID(1)||')';                              17060004
*      ANS ('IALCVID = '||TINFO||';') COL(COLA) SKIP RESCAN;            17070004
*      ANS ('/* INSERT DATAID    */') COL(COLD);                        17080004
*    END;                                                               17090004
* /*                                                                 */ 17100004
* /*  INSERT DATALEN, IF SPECIFIED                                   */ 17110004
* /*                                                                 */ 17120004
*    IF DATALEN(1) = '' THEN                                           17130004
*    DO;                                                                17140004
*      IF DATALEN(1,1:1) = '(' THEN                                     17150004
*         TINFO = DATALEN(1,1);                                         17160004
*      ELSE                                                             17170004
*         TINFO = 'ADDR('||DATALEN(1)||')';                             17180004
*      ANS ('IALCVLEN = '||TINFO||';') COL(COLA) SKIP RESCAN;           17190004
*      ANS ('/* INSERT DATALEN       */') COL(COLD);                    17200004
*    END;                                                               17210004
* /*                                                                 */ 17220004
* /*  INSERT DATA, IF SPECIFIED                                      */ 17230004
* /*                                                                 */ 17240004
*    IF DATA(1) = '' THEN                                              17250004
*    DO;                                                                17260004
*      IF DATA(1,1:1) = '(' THEN                                        17270004
*         TINFO = DATA(1,1);                                            17280004
*      ELSE                                                             17290004
*         TINFO = 'ADDR('||DATA(1)||')';                                17300004
*      ANS ('IALCVDAT = '||TINFO||';') COL(COLA) SKIP RESCAN;           17310004
*      ANS ('/* INSERT DATA      */') COL(COLD);                        17320004
*    END;                                                               17330004
* /*                                                                 */ 17340004
* /*  INSERT NOTFND, IF SPECIFIED                                    */ 17350004
* /*                                                                 */ 17360004
*    IF NOTFND(1) = '' THEN                                            17370004
*    DO;                                                                17380004
*      IF NOTFND(1,1:1) = '(' THEN                                      17390004
*         TINFO = NOTFND(1,1);                                          17400004
*      ELSE                                                             17410004
*         TINFO = 'ADDR('||NOTFND(1)||')';                              17420004
*      ANS ('IALCNFND = '||TINFO||';') COL(COLA) SKIP RESCAN;           17430004
*      ANS ('/* INSERT NOTFND LABEL   */') COL(COLD);                   17440004
*    END;                                                               17450004
* /*                                                                 */ 17460004
* /*  INSERT EROPT,  IF SPECIFIED                                    */ 17470004
* /*                                                                 */ 17480004
*    IF EROPT(1) = '' THEN                                             17490004
*    DO;                                                                17500004
*      IF EROPT(1) = 'CANCEL' THEN                                      17510004
*      DO;                                                              17520004
*        ANS ('IALCCANC = ''1''B;') COL(COLA) SKIP RESCAN;              17530004
*        ANS ('/* INSERT ERROR OPT.  */') COL(COLD);                    17540004
*      END;                                                             17550004
*      ELSE DO;                                                         17560004
*        ANS ('IALCCANC = ''''B;') COL(COLA) SKIP RESCAN;               17570004
*        ANS ('/* INSERT ERROR OPT. */') COL(COLD);                     17580004
*      END;                                                             17590004
*    END;                                                               17600004
* /*                                                                 */ 17610004
* /*  INSERT EODAD, IF SPECIFIED                                     */ 17620004
* /*                                                                 */ 17630004
*    IF EODAD(1) = '' THEN                                             17640004
*    DO;                                                                17650004
*      IF EODAD(1,1:1) = '(' THEN                                       17660004
*         TINFO = EODAD(1,1);                                           17670004
*      ELSE                                                             17680004
*         TINFO = 'ADDR('||EODAD(1)||')';                               17690004
*      ANS ('IALCEOF = '||TINFO||';') COL(COLA) SKIP RESCAN;            17700004
*      ANS ('/* INSERT EOF LABEL   */') COL(COLD);                      17710004
*    END;                                                               17720004
* /*                                                         @D52TDJS*/ 17730004
* /*  INSERT SRVEXIT IF SPECIFIED                            @D52TDJS*/ 17740004
* /*                                                         @D52TDJS*/ 17750004
*    IF SRVEXIT(1) = '' THEN                              /*@D52TDJS*/ 17760004
*    DO;                                                   /*@D52TDJS*/ 17770004
*      IF SRVEXIT(1,1:1) = '(' THEN                        /*@D52TDJS*/ 17780004
*         TINFO = SRVEXIT(1,1);                            /*@D52TDJS*/ 17790004
*      ELSE                                                /*@D52TDJS*/ 17800004
*         TINFO = 'ADDR('||SRVEXIT(1)||')';                /*@D52TDJS*/ 17810004
*    ANS ('IALCSRVX = '||TINFO||';') COL(COLA) SKIP RESCAN;/*@D52TDJS*/ 17820004
*    ANS ('/* INSERT SERVICE EXIT LABEL   */') COL(COLD);  /*@D52TDJS*/ 17830004
*    END;                                                  /*@D52TDJS*/ 17840004
* /*                                                                 */ 17850004
* /*  INSERT ERRAD, IF SPECIFIED                                     */ 17860004
* /*                                                                 */ 17870004
*    IF ERRAD(1) = '' THEN                                             17880004
*    DO;                                                                17890004
*      IF ERRAD(1,1:1) = '(' THEN                                       17900004
*         TINFO = ERRAD(1,1);                                           17910004
*      ELSE                                                             17920004
*         TINFO = 'ADDR('||ERRAD(1)||')';                               17930004
*      ANS ('IALCERR = '||TINFO||';') COL(COLA) SKIP RESCAN;            17940004
*      ANS ('/* INSERT ERROR LABEL   */') COL(COLD);                    17950004
*    END;                                                               17960004
*    ANS ('RFY IALCBR1,INLCIALC;')                                      17970004
*         COL(COLA) SKIP RESCAN;                                        17980004
* MEND:;                                                                17990004
* IF IALINN = 1 THEN RETURN CODE(0);                                    18000004
* RETURN CODE(IALRC);                                                   18010004
* %END;                                                                 18020004
*/*   ENDMODULE LIBRDCB                                            */   18030004
