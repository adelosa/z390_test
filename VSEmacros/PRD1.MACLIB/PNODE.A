*%GOTO PLSNDT;                                                          00001000
*/*                                                                     00002000
         MACRO                                                          00003000
&NAME    PNODE &NODE=,             NODE NAME                           *00004000
               &PWD=,              PASSWORD ASSIGNED TO NODE           *00005000
               &AUTH=,             AUTHORITY GIVEN TO NODE             *00006000
               &ROUTE1=,           PRIME ROUTE                         *00007000
               &ROUTE2=,           ALTERNATE ROUTE                     *00008000
               &APPLID=,           APPLICATION ID    (SNA ONLY)        *00009000
               &IPHOSTAD=,         DECIMAL DOTTED TCP/IP ADDR @D65CDAT *00010000
               &ISHOSTAD=,         DECIMAL DOT. TCP SSL ADDR. @D66CDAT *00011000
               &IPHOSTNM=,         TCP/IP ADDR. BY SYMB. NAME @D65CDAT *00012000
               &ISHOSTNM=,         TCP SSL ADDR. BY SYMB. NM. @D66CDAT *00013000
               &PORT=,             TCP/IP PORT NUMBER         @D65CDAT *00014000
               &SPORT=,            TCP/IP SSL PORT NUMBER     @D66CDAT *00015000
               &ENCRYPT=,          SSL ENCRYPTION LEVEL       @D66CDAT *00016000
               &SECTYPE=,          TYPE OF SECURITY PROTOCOL  @D66CDAT *00017000
               &KEYRING=,          SSL-KEY LIB.SUBLIB         @D66CDAT *00018000
               &DNAME=,            SSL-KEY MEMBER IN LIB.SUBL.@D66CDAT *00019000
               &IPEXTRAD=,         TCP/IP ADDR. FOR EXTERNAL  @DY46046 *00019500
               &LOCAL=,            SPECIFIES OWN NODE ENTRY            *00020000
               &BUFSIZE=,&MAXBUF=,                                     *00021000
               &DSECT=NO,          DSECT GENERATION REQUESTED (YES|NO) *00022000
               &DUMMY=DUMMY        END OF PROTOTYPE STMT                00023000
.*                                                                      00024000
.*             GLOBALS DEFINITIONS                                      00025000
.*                                                                      00026000
         GBLA  &CNT                NUMBER OF NODE ENTRIES GENERATED     00027000
.*                                                                      00028000
         GBLB  &ABORT              ABORT ANY MACRO CHECKING             00029000
         GBLB  &FIRST              FIRST TIME THROUGH SWITCH            00030000
         GBLB  &OWN                OWN NODE ENTRY SWITCH                00031000
.*                                                                      00032000
         GBLC  &PHASE              PHASE NAME                           00033000
         GBLC  &HDR                HEADER LABEL                         00034000
.*                                                                      00035000
.*             LOCAL DEFINITIONS                                        00036000
.*                                                                      00037000
         LCLA  &WL                 USED AS LOOP COUNT                   00038000
         LCLA  &I                  LOOP COUNT FOR CHECKING PARAMETER    00039000
         LCLA  &S                  LOOP POSITION PARAMETER    @D65CDAT  00040000
         LCLA  &AT                 AUTHORITY FLAGS                      00041000
         LCLA  &FLG                FLAG BYTE                            00042000
         LCLA  &FLG2               FLAG BYTE 2                @D66CDAT  00043000
         LCLA  &BSZ                NETWORK TP-BUFFER SIZE               00044000
         LCLA  &HOLN               LEN(DOTTED/SYMBOLIC ADDR)  @D65CDAT  00045000
         LCLA  &DGRP               IP/ADDR DOT GROUP          @D65CDAT  00046000
         LCLA  &HOPT               TCP/IP PORT NUMBER         @D65CDAT  00047000
         LCLA  &SOPT               TCP/IP SSL PORT NUMBER     @D66CDAT  00048000
         LCLA  &BF(4)              NO OF BUFFERS FOR XMITTERS           00049000
         LCLA  &MAX(2)             MAX NO OF BUFFERS                    00050000
         LCLA  &MIN(2)             MIN NO OF BUFFERS                    00051000
         LCLA  &IPA(4)             4 BYTES OF BINARY IP-ADDR  @D65CDAT  00052000
         LCLA  &EXA(4)             4 BYTES OF EXTERN IP ADDR  @DY46046  00052300
         LCLA  &EXLN               LEN(DOTTED/EXTERN IP ADDR) @DY46046  00052600
.*                                                                      00053000
         LCLB  &LOC                VALID LOCAL SPECIFICATION            00054000
.*                                                                      00055000
         LCLC  &DEST1              PRIMARY ROUTING                      00056000
         LCLC  &DEST2              ALTERNATE ROUTING                    00057000
         LCLC  &PW                 PASSWORD                             00058000
         LCLC  &APPL               APPLICATION ID                       00059000
         LCLC  &HONM               DOTTED OR SYMB. HOST NAME  @D65CDAT  00060000
         LCLC  &HOGP               DOTTED CHARACTER GROUP     @D65CDAT  00061000
         LCLC  &LKEYR              SSL KEY DATABASE           @D66CDAT  00062000
         LCLC  &LKEYM              SSL KEY MEMBER IN DATABASE @D66CDAT  00063000
         LCLC  &SSLTP              TYPE OF SECURITY PROTOCOL  @D66CDAT  00064000
         LCLC  &CHAR1              ALPHABETIC CHARACTER TABLE           00065000
         LCLC  &CHAR2              ALPHAMERIC CHARACTER TABLE           00066000
.*                                                                      00067000
.*                                                                      00068000
         AGO   .ZZZ                                                     00069000
*        LICENSED MATERIALS - PROPERTY OF IBM                           00070000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                    00071000
*        5686-CF7 (C) COPYRIGHT IBM CORP. 1982, 2004                    00072000
*        SEE COPYRIGHT INSTRUCTIONS                                     00073000
.ZZZ     ANOP                                                           00074000
         AGO   .PBY                                                     00075000
.*                                                                      00076000
.*       IBM DISK OPERATING SYSTEM / VIRTUAL STORAGE EXTENDED (DOS/VSE) 00077000
.*       PNODE  -  5686-CF7-03                                          00078000
.*                                                                      00079000
.**** START OF SPECIFICATIONS ***************************************** 00080000
.*                                                                    * 00081000
.*    MODULE-NAME  =  PNODE                                           * 00082000
.*                                                                    * 00083000
.*    DESCRIPTIVE-NAME  =  VSE/POWER NETWORK DEFINTION MACRO          * 00084000
.*                                                                    * 00085000
.*    CHANGE ACTIVITY  =  AS FOLLOWS                                  * 00086000
.*                                                                    * 00087000
.* A000000-9999999                                            @D03PIPW* 00088000
.* EXTENDED BUFFER SIZE                                       @D22PIPW* 00089000
.* EXTEND PNET BSC/CTC BUFSIZE TO 4000 BYTES                  @D61FDAT* 00090000
.* NEW EQUATE FOR NDTF1 TO INVALIDATE DUPLICATE SNA APPLIDS   @DY44263* 00091000
.* RELEASE 6.3 UPGRADE, INCREASE DEFAULT BUFSIZE 400->1112    @D63PDAT* 00092000
.* PNET TCP SUPPORT, EXTENDED NDT ENTRY (VERSION 04.0)        @D65CDAT* 00093000
.* PNET TCP SUPPORT, EXTENDED NDT ENTRY (VERSION 05.0)        @D65CDAT* 00094000
.* PNET TCP SUPPORT, DEFINE TIME STAMP FOR MSG 1RC6I          @D65CDHS* 00095000
.* COLLECTED CHANGES FOR PNET TCP PTF                         @DY45514* 00096000
.* PNET SSL SUPPORT, EXTENDED NDT ENTRY (VERSION 06.0)        @D66CDAT* 00097000
.* PNET SSL SUPPORT, SET DEFAULT SPORT=375 (E.G.)             @D66CDAT* 00098000
.* PNET SSL SUPPORT, CHANGE 'TCS' NODE TO 'SSL'               @D66CDAT* 00099000
.* PNET SSL KEY=, LOCAL=YES VALUE TO BE DEFAULT FOR LOCAL=NO  @D66CDAT* 00100000
.* PNET SSL - SSLTYPE=SECTYPE, KEY=DNAME, LOW/HIGH=WEAK/STRONG@D66CDAT* 00101000
.* PNET SSL - DEFAULT SPORT 375 CHANGED TO 2252               @D66QDAT* 00102000
.* PNET SSL - SUPPORT ENCRYPT=NORMAL,SUPPRESS SECTYPE=TLS31   @DY45806* 00103000
.* PNET TCP - SUPPORT IPEXTRAD=LOCAL ADDR EXTERNALLY KNOWN    @DY46046* 00103500
.* PNET ALL - NEW DEFAULT (4,4) FOR MAXBUF                    @DY46287* 00103500
.*                                                                    * 00104000
.***  END OF SPECIFICATIONS   ***************************************** 00105000
.*                                                                      00106000
.*                                                                      00107000
.PBY     ANOP                                                           00108000
.*                                                                      00109000
.*                                                                      00110000
.* *******************************************************************  00111000
.*                                                                   *  00112000
.*       NOTE: TO MAKE PLS MACRO EXPANSION SUCCESSFUL FOLLOW THE     *  00113000
.*       =====  LISTED RULES IN THE ASSEMBLER PART OF THE MACRO:     *  00114000
.*             1- AVOID UNMATCHED APOSTROPHES!                       *  00115000
.*             2- AVOID UNMATCHED PLS COMMENT DELIMETERS!            *  00116000
.*             3- AVOID USE OF 'PERCENT SIGN' AND 'QUESTION MARK'!   *  00117000
.*                                                                   *  00118000
.* *******************************************************************  00119000
.*                                                                      00120000
.*                                                                      00121000
&CHAR1   SETC  'ABCDEFGHIJKLMNOPQRSTUVWXYZ@#$'   ALPHABETIC CHARACTERS  00122000
&CHAR2   SETC  'ABCDEFGHIJKLMNOPQRSTUVWXYZ@#$0123456789'  ALPHAMERIC    00123000
&NUM     SETC  '0123456789.'                     NUMERIC DIGITS         00124000
.*                                                                      00125000
.********************************************************************** 00126000
.*             CHECK FOR POSITIONAL OPERANDS                          * 00127000
.********************************************************************** 00128000
.GEN000  ANOP                                                           00129000
         AIF   (N'&SYSLIST EQ 0).GEN010                                 00130000
         SPACE 2                                                        00131000
         MNOTE 8,' POSITIONAL OPERANDS NOT ALLOWED - MACRO IGNORED.'    00132000
         SPACE 2                                                        00133000
         MEXIT                                                          00134000
.*                                                                      00135000
.********************************************************************** 00136000
.*             CHECK IF DSECT GENERATION REQUESTED (DSECT=YES)        * 00137000
.********************************************************************** 00138000
.GEN010  ANOP                                                           00139000
         AIF   (T'&DSECT EQ 'O' OR '&DSECT' EQ 'NO').GEN020             00140000
         AIF   ('&DSECT' EQ 'YES').GEN015  GENERATE DSECT               00141000
         SPACE 2                                                        00142000
         MNOTE 8,' INVALID DSECT SPECIFICATION, MACRO IGNORED'          00143000
         SPACE 2                                                        00144000
         MEXIT                                                          00145000
.*                                                                      00146000
.GEN015  ANOP                                                           00147000
         TITLE '&NAME      VSE/POWER (PNET)   NETWORK DEFINITION TABLE' 00148000
         SPACE 2                                                        00149000
*********************************************************************** 00150000
*                                                                     * 00151000
*              NETWORK DEFINITION TABLE HEADER                        * 00152000
*                                                                     * 00153000
*********************************************************************** 00154000
.*                                                                    * 00155000
.*             WHENEVER THIS DSECT IS CHANGED,                        * 00156000
.*             THE PLS-PART HAS TO BE UPDATED                         * 00157000
.*                                                                    * 00158000
         SPACE 1                                                        00159000
NTHDS    DSECT ,                   HEADER DEFINITION DSECT              00160000
NTHSD    DC    CL16' '             STORAGE DESCRIPTOR                   00161000
NTHFE    DC    A(0)                ADDRESS OF FIRST ENTRY IN TABLE      00162000
NTHNE    DC    H'0'                NUMBER OF ENTRIES IN TABLE           00163000
NTHMX    DC    H'160'              MAX. # TCP/IP SOCKET CALLS  @D66CDAT 00164000
NTHOE    DC    A(0)                ADDRESS OF OWN ENTRY IN TABLE        00165000
NTHVM    DC    CL4'06.0'           NETWORK DEF. TABLE VERS. ID @D66CDAT 00166000
*                                                                       00167000
         DC    XL2'00'             RESERVED FOR FUTURE USE     @D65CDAT 00168000
         DS    CL44                COPYRIGHT INFORMATION       @D65CDAT 00169000
         DC    XL50'00'            RESERVED FOR FUTURE USE     @D65CDAT 00170000
NTHLN    EQU   *-NTHDS             LENGTH OF HEADER                     00171000
         SPACE 2                                                        00172000
*********************************************************************** 00173000
*                                                                     * 00174000
*              VSE/POWER NETWORK DEFINITION TABLE                     * 00175000
*                                                                     * 00176000
*********************************************************************** 00177000
.*                                                                    * 00178000
.*             WHENEVER THIS DSECT IS CHANGED,                        * 00179000
.*             THE PLS-PART HAS TO BE UPDATED                         * 00180000
.*                                                                    * 00181000
         SPACE 1                                                        00182000
*        THE NETWORK DEFINITION TABLE, ASSEMBLED BY MACRO PNODE,        00183000
*        CONTAINS INFORMATION ABOUT EACH NODE IN THE NETWORK.           00184000
         SPACE 1                                                        00185000
NDTDS    DSECT ,                   NETWORK DEFINITION TABLE DSECT       00186000
NDTNM    DC    CL8' '              NODE NAME                            00187000
NDTPW    DC    CL8' '              PASSWORD                             00188000
NDTAF    DC    XL1'00'             AUTHORITY FLAGS                      00189000
NDTAS    EQU   X'F0'               .. NODE IS 'SYSTEM' AUTHORIZED       00190000
NDTAN    EQU   X'50'               .. NODE IS 'NETWORK' AUTHORIZED      00191000
NDTNU    EQU   X'20'               .. NOT USED                          00192000
NDTAJ    EQU   X'10'               .. NODE IS 'JOB' AUTHORIZED          00193000
NDTAE    EQU   X'00'               .. NODE IS NOT AUTHORIZED AT ALL     00194000
         DC    XL2'00'             RESERVED FOR FUTURE USE              00195000
NDTF1    DC    X'00'               FLAG BYTE 1                          00196000
NDTLI    EQU   X'80'               .. ADJACENT BSC/CTC NODE             00197000
NDTVA    EQU   X'40'               .. SNA TYPE NODE                     00198000
*                                     MAY BE SET FOR OWN NODE! @D65CDAT 00199000
NDTF1IA  EQU   X'20'               .. INVALID SNA APPLID       @DY44263 00200000
NDTPA    EQU   X'10'               .. TCP TYPE NODE            @D65CDAT 00201000
NDTF1IP  EQU   X'08'               .. INVALID TCP ADDRESS      @D65CDAT 00202000
NDTSA    EQU   X'04'               .. SSL TYPE NODE            @D66CDAT 00203000
NDTPR    DC    CL8' '              PRIME ROUTE FOR BSC/CTC, OR @D65CDAT 00204000
*                                  APPLICATION ID FOR SNA, OR  @D65CDAT 00205000
*                                  '*ATP    ', IF TCP IPHOSTAD @D65CDAT 00206000
*                                  '*ATP    ', IF SSL ISHOSTAD @D66CDAT 00207000
*                                  '*NTP    ', IF TCP IPHOSTNM @D65CDAT 00208000
*                                  '*NTP    ', IF SSL ISHOSTNM @D66CDAT 00209000
NDTSR    DC    CL8' '              ALTERNATE ROUTE                      00210000
NDTBS    DC    AL2(0)              PNET BUFFERSIZE                      00211000
NDTNI    DC    AL1(4)              MAX. NO OF INPUT BUFFERS    @DY46287 00212000
NDTNO    DC    AL1(4)              MAX. NO OUTPUT BUFFERS      @DY46287 00213000
NDTPT    DC    AL2(0)              TCP/IP PORT NUMBER FOR ...  @D65CDAT 00214000
*                                  'CONNECT', IF REMOTE NODE OR@D65CDAT 00215000
*                                  'LISTEN', IF OWN NODE       @D65CDAT 00216000
NDTSPT   DC    AL2(0)              TCP/IP SSL PORT NUMBER FOR..@D66CDAT 00217000
*                                  'CONNECT', IF REMOTE NODE OR@D66CDAT 00218000
*                                  'LISTEN', IF OWN NODE       @D66CDAT 00219000
NDTHML   DC    AL4(0)              TCP, LENGTH OF NDTHM VALUE  @D65CDAT 00220000
NDTIPAD  DC    0F'0'               BINARY IP ADDRESS           @D65CDAT 00221000
NDTIPA1  DC    AL1(0)              BINARY IPADDR BYTE 1| FOR...@D65CDAT 00222000
NDTIPA2  DC    AL1(0)              BINARY IPADDR BYTE 2| DOTTED@D65CDAT 00223000
NDTIPA3  DC    AL1(0)              BINARY IPADDR BYTE 3| DECIM.@D65CDAT 00224000
NDTIPA4  DC    AL1(0)              BINARY IPADDR BYTE 4| VALUE @D65CDAT 00225000
NDTHM    DC    CL255' '            TCP/IP HOST NAME ...        @D65CDAT 00226000
*                                  FOR OWN NODE 'UNUSED',      @D65CDAT 00227000
*                                  FOR REMOTE NODE ...         @D65CDAT 00228000
*                                   DOTTED DECIMAL (NDTPR=*ATP)@D65CDAT 00229000
*                                   SYMBOLIC NAME, (NDTPR=*NTP)@D65CDAT 00230000
NDTF2    DC    X'00'               FLAG BYTE 2                 @D66CDAT 00231000
NDT2CRL  EQU   X'80'               .. ENCRYPT = LOW = WEAK     @D66CDAT 00232000
NDT2CRH  EQU   X'40'               .. ENCRYPT = HIGH = STRONG  @D66CDAT 00233000
NDT2CRN  EQU   X'20'               .. ENCRYPT = NORMAL         @DY45806 00234000
NDTMSGTM DC    F'0'                TIME STAMP FOR MSG 1RC6     @D65CDHS 00235000
NDTMSGDI DC    F'0'                DOM-ID FOR A-TYPE MSG       @DPTMD01 00236000
NDTIPEX  DC    0F'0'               BINARY EXTERNAL IP ADDRESS  @DY46046 00237090
NDTIPE1  DC    AL1(0)              BINARY IPADDR BYTE 1| FOR...@DY46046 00237180
NDTIPE2  DC    AL1(0)              BINARY IPADDR BYTE 2| DOTTED@DY46046 00237270
NDTIPE3  DC    AL1(0)              BINARY IPADDR BYTE 3| DECIM.@DY46046 00237360
NDTIPE4  DC    AL1(0)              BINARY IPADDR BYTE 4| VALUE @DY46046 00237450
NDTSSLT  DC    CL8' '              SSL TYPE OF SECURITY PROTOC.@D66CDAT 00238000
NDTKEYR  DC    CL16' '             LIB.SUBLIB SSL KEY DATABASE @D66CDAT 00239000
NDTKEYM  DC    CL8' '              DNAME KEY-MEMBER IN DATABASE@D66CDAT 00240000
*                                  .. BLANK, IF DNAME OF LOCAL @D65CDAT 00241000
         DC    7F'0'               RESERVED FOR FUTURE USE     @D66CDAT 00242000
NDTLN    EQU   *-NDTDS             LENGTH OF ENTRY                      00243000
         SPACE 2                                                        00244000
         AGO   .DONE               EXIT MACRO                           00245000
.*                                                                      00246000
.GEN020  ANOP                                                           00247000
.*                                                                      00248000
.********************************************************************** 00249000
.*             CHECK NAME SPECIFICATION                               * 00250000
.********************************************************************** 00251000
.*                                                                      00252000
.*       THE NAME SPECIFICATION ON THE FIRST PNODE MACRO IS ALSO        00253000
.*       USED AS PHASE INFORMATION FOR THE LINKAGE EDITOR.              00254000
.*                                                                      00255000
.NAME00  ANOP                                                           00256000
         AIF   (&FIRST).NAME50     BRANCH IF NOT FIRST TIME THROUGH     00257000
         AIF   (T'&NAME EQ 'O').NAMER1   IF OMITTED, REPORT ERROR       00258000
         AIF   (K'&NAME GT 8).NAMER2     IF GREATER 8, REPORT ERROR     00259000
.*                                                                      00260000
&PHASE   SETC  '&NAME'             SET UP PHASE NAME                    00261000
&HDR     SETC  'HDR&SYSNDX'                                             00262000
.*                                                                      00263000
         TITLE '&NAME      VSE/POWER (PNET)   NETWORK DEFINITION TABLE' 00264000
*********************************************************************** 00265000
* * *                                                             * * * 00266000
* * *       V S E  /  P O W E R   NETWORK DEFINITION TABLE        * * * 00267000
* * *                                                             * * * 00268000
*********************************************************************WS 00269000
.* IBM DISK OPERATING SYSTEM / VIRTUAL STORAGE EXTENDED (DOS/VSE)       00270000
         SPACE 2                                                        00271000
* VSE/POWER - PNODE - 5686-CF7-03                                       00272000
         SPACE 1                                                        00273000
******************************************************                  00274000
*                                                    *                  00275000
*   LICENSED MATERIALS - PROPERTY OF IBM             *                  00276000
*   THIS MACRO IS "RESTRICTED MATERIALS OF IBM"      *                  00277000
*   5686-CF7 (C) COPYRIGHT IBM CORP. 1982, 2004      *                  00278000
*   SEE COPYRIGHT INSTRUCTIONS                       *                  00279000
*                                                    *                  00280000
******************************************************                  00281000
         SPACE 2                                                        00282000
*        THE FOLLOWING STATEMENT PROVIDES THE NECESSARY 'PHASE'         00283000
*        STATEMENT FOR THE LINKAGE EDITOR.                              00284000
         SPACE 1                                                        00285000
         PUNCH ' PHASE &NAME,S'                                         00286000
         SPACE 2                                                        00287000
&NAME    CSECT ,                   START OF NETWORK TABLE               00288000
         SPACE 2                                                        00289000
         DC    CL16'NETWORK DEF TBLE'  STORAGE DESCRIPTOR      @D04PIPW 00290000
&HDR     DS    0CL16               HEADER INFORMATION                   00291000
         DC    A(0)                ADDRESS OF FIRST ENTRY IN TABLE      00292000
         DC    H'0'                NUMBER OF ENTRIES IN TABLE           00293000
         DC    H'160'              MAX. # TCP/IP SOCKET CALLS  @D66CDAT 00294000
         DC    A(0)                ADDRESS OF OWN ENTRY IN TABLE        00295000
         DC    CL4'06.0'           DEFINITION TABLE VERSION ID @D66CDAT 00296000
         SPACE 2                                                        00297000
         DC    XL2'00'                                         @D65CDAT 00298000
         SPACE 1                                                        00299000
         IPW$CPY   YB=1982,YC=2001,BRANCH=NO COPYRIGHT CONST.  @D66CDAT 00300000
         SPACE 1                                                        00301000
         DC    XL50'00'                                        @D65CDAT 00302000
         SPACE 1                                                        00303000
         AGO   .NODE00             AND CONTINUE                         00304000
.*                                                                      00305000
.NAME50  ANOP                                                           00306000
         AIF   (T'&NAME EQ 'O').NODE00   IF OMITTED, BRANCH             00307000
         AIF   (K'&NAME LT 9).NODE00     IF LESS THAN 9, THAT IS OK     00308000
         SPACE 2                                                        00309000
         MNOTE 8,' INVALID NAME SPECIFICATION, NAME IGNORED'            00310000
         SPACE 1                                                        00311000
         AGO   .NODE00             AND CONTINUE                         00312000
.*                                                                      00313000
.NAMER1  ANOP                                                           00314000
&ABORT   SETB  1                   TURN ON SWITCH TO SKIP CHECKING      00315000
         SPACE 2                                                        00316000
         MNOTE 12,' NAME SPECIFICATION REQUIRED ON FIRST PNODE MACRO'   00317000
         SPACE 2                                                        00318000
         MEXIT                                                          00319000
.*                                                                      00320000
.NAMER2  ANOP                                                           00321000
&ABORT   SETB  1                   TURN ON SWITCH TO SKIP CHECKING      00322000
         SPACE 2                                                        00323000
         MNOTE 12,' INVALID NAME SPECIFICATION'                         00324000
         SPACE 2                                                        00325000
         MEXIT                                                          00326000
.*                                                                      00327000
.********************************************************************** 00328000
.*             CHECK NODE SPECIFICATION                               * 00329000
.********************************************************************** 00330000
.*                                                                      00331000
.*       THE NODE PARAMETER IS MANDATORY AND MUST BE ALPHAMERIC,        00332000
.*       FIRST CHARACTER ALPHABETIC. THE MAXIMUM LENGTH IS 8 BYTES.     00333000
.*                                                                      00334000
.NODE00  ANOP                                                           00335000
         AIF   (T'&NODE EQ 'O').NODERR1    IF OMITTED, ERROR            00336000
         AIF   (K'&NODE GT 8).NODERR2      IF GREATER 8, ERROR          00337000
&WL      SETA  1                   SET LOOP COUNT                       00338000
.NODE10  ANOP                                                           00339000
         AIF   ('&NODE'(1,1) EQ '&CHAR1'(&WL,1)).NODE20                 00340000
&WL      SETA  &WL+1               BUMP TO NEXT CHARACTER IN TABLE      00341000
         AIF   (&WL GT 29).NODERR2  IF NOT FOUND, ERROR                 00342000
         AGO   .NODE10             AND TRY THIS ONE                     00343000
.NODE20  ANOP                                                           00344000
&WL      SETA  1                   SET LOOP COUNT FOR OTHER TABLE       00345000
&I       SETA  2                   START CHECKING WITH 2ND CHARACTER    00346000
.NODE25  ANOP                                                           00347000
         AIF   (&I GT K'&NODE).NODE40  IT IS DONE, CHECK FOR 'SNA'      00348000
.NODE30  ANOP                                                           00349000
         AIF   ('&NODE'(&I,1) EQ '&CHAR2'(&WL,1)).NODE35                00350000
&WL      SETA  &WL+1               BUMP TO NEXT CHARACTER IN TABLE      00351000
         AIF   (&WL GT 39).NODERR2   NOT FOUND, ERROR                   00352000
         AGO   .NODE30             TRY THIS CHARACTER                   00353000
.NODE35  ANOP                                                           00354000
&WL      SETA  1                   SET LOOP COUNT AGAIN                 00355000
&I       SETA  &I+1                CHECK NEXT CHARACTER OF NODE NAME    00356000
         AGO   .NODE25             AND START CHECKING                   00357000
.NODE40  ANOP                                                           00358000
         AIF   ('&NODE' EQ 'SNA').NODERR2  NODE NAME IS SNA             00359000
         AGO   .LOC000             NODE IS ALRIGHT                      00360000
.*                                                                      00361000
.NODERR1 ANOP                                                           00362000
         SPACE 2                                                        00363000
         MNOTE 8,' NODE PARAMETER MISSING, MACRO IGNORED'               00364000
         SPACE 2                                                        00365000
         MEXIT                                                          00366000
.*                                                                      00367000
.NODERR2 ANOP                                                           00368000
         SPACE 2                                                        00369000
         MNOTE 8,' INVALID NODE SPECIFICATION, MACRO IGNORED'           00370000
         SPACE 2                                                        00371000
         MEXIT                                                          00372000
.*                                                                      00373000
.********************************************************************** 00374000
.*             CHECK LOCAL SPECIFICATION                              * 00375000
.********************************************************************** 00376000
.*                                                                      00377000
.*       THE LOCAL PARAMETER SPECIFIES THAT THIS NODE ENTRY DEFINES     00378000
.*       THE OWN NODE.                                                  00379000
.*                                                                      00380000
.LOC000  ANOP                                                           00381000
         AIF   (T'&LOCAL EQ 'O').PWD000   BRANCH IF OMITTED             00382000
         AIF   ('&LOCAL' EQ 'NO').PWD000  BRANCH IF LOCAL=NO            00383000
         AIF   ('&LOCAL' NE 'YES').LOCERR1  REPORT ERROR IF NOT 'YES'   00384000
         AIF   (&OWN).LOCERR1      LOCAL=YES CAN ONLY ONCE BE SPECIFIED 00385000
&OWN     SETB  1                   TURN ON SWITCH                       00386000
&LOC     SETB  1                   TURN ON VALID LOCAL SWITCH           00387000
         AGO   .PWD000             AND CONTINUE                         00388000
.*                                                                      00389000
.LOCERR1 ANOP                                                           00390000
         SPACE 2                                                        00391000
         MNOTE 8,' INVALID LOCAL SPECIFICATION OR ALREADY SPECIFIED'    00392000
         SPACE 2                                                        00393000
.*                                                                      00394000
.********************************************************************** 00395000
.*             CHECK PWD SPECIFICATION                                * 00396000
.********************************************************************** 00397000
.*                                                                      00398000
.*       THE PWD PARAMETER IS OPTIONAL, BUT IF SPECIFIED, IT MUST BE    00399000
.*       ALPHAMERIC. THE MAXIMUM LENGTH IS 8 BYTES.                     00400000
.*       BLANKS ARE ASSUMED AS DEFAULT.                                 00401000
.*                                                                      00402000
.PWD000  ANOP                                                           00403000
&PW      SETC  ' '                 SET DEFAULT PASSWORD                 00404000
         AIF   (T'&PWD EQ 'O').ROUT100    IF OMITTED, GO CONTINUE       00405000
         AIF   (K'&PWD GT 8).PWDERR2      IF GREATER 8, ERROR           00406000
&WL      SETA  1                   SET LOOP COUNT FOR OTHER TABLE       00407000
&I       SETA  1                   START CHECKING WITH 1ST CHARACTER    00408000
.PWD025  ANOP                                                           00409000
         AIF   (&I GT K'&PWD).PWD050    IT IS DONE, PASSWORD IS OK      00410000
.PWD030  ANOP                                                           00411000
         AIF   ('&PWD'(&I,1) EQ '&CHAR2'(&WL,1)).PWD035                 00412000
&WL      SETA  &WL+1               BUMP TO NEXT CHARACTER IN TABLE      00413000
         AIF   (&WL GT 39).PWDERR2   NOT FOUND, ERROR                   00414000
         AGO   .PWD030             TRY THIS CHARACTER                   00415000
.PWD035  ANOP                                                           00416000
&WL      SETA  1                   SET LOOP COUNT AGAIN                 00417000
&I       SETA  &I+1                CHECK NEXT CHARACTER OF PASSWORD     00418000
         AGO   .PWD025             AND START CHECKING                   00419000
.PWD050  ANOP                                                           00420000
&PW      SETC  '&PWD'              TAKE SPECIFIED PASSWORD              00421000
         AGO   .ROUT100            AND CONTINUE                         00422000
.*                                                                      00423000
.PWDERR2 ANOP                                                           00424000
         SPACE 2                                                        00425000
         MNOTE 8,' INVALID PWD SPECIFICATION, DEFAULT ASSUMED'          00426000
         SPACE 1                                                        00427000
         AGO   .ROUT100            JOIN MAINLINE                        00428000
.*                                                                      00429000
.********************************************************************** 00430000
.*             CHECK ROUTE1 SPECIFICATION                             * 00431000
.********************************************************************** 00432000
.*                                                                      00433000
.*       THE ROUTE1 PARAMETER IS OPTIONAL AND SPECIFIES A DESTINATION   00434000
.*       NODE, THEREFORE IT MUST BE ALPHAMERIC, FIRST CHARACTER         00435000
.*       ALPHABETIC. THE MAXIMUM LENGTH IS EIGHT BYTES.                 00436000
.*       AS DEFAULT (OMITTED), BLANKS ARE GENERATED.                    00437000
.*                                                                      00438000
.ROUT100 ANOP                                                           00439000
&DEST1   SETC  ' '                 INDICATE GENERATION OF BLANKS        00440000
         AIF   (&LOC).ROUT200      GEN BLANKS FOR OWN NODE              00441000
&FLG     SETA  &FLG+128            ASSUME 'LINK' CONNECTION             00442000
         AIF   (T'&ROUTE1 EQ 'O').ROUT200    IF OMITTED, BRANCH         00443000
&FLG     SETA  &FLG-128            UNDO MADE ASSUMPTION                 00444000
         AIF   (K'&ROUTE1 GT 8).ROUT1R2      IF GREATER 8, ERROR        00445000
&WL      SETA  1                   SET LOOP COUNT                       00446000
.ROUT110 ANOP                                                           00447000
         AIF   ('&ROUTE1'(1,1) EQ '&CHAR1'(&WL,1)).ROUT120              00448000
&WL      SETA  &WL+1               BUMP TO NEXT CHARACTER IN TABLE      00449000
         AIF   (&WL GT 29).ROUT1R2  IF NOT FOUND, ERROR                 00450000
         AGO   .ROUT110            AND TRY THIS ONE                     00451000
.ROUT120 ANOP                                                           00452000
&WL      SETA  1                   SET LOOP COUNT FOR OTHER TABLE       00453000
&I       SETA  2                   START CHECKING WITH 2ND CHARACTER    00454000
.ROUT125 ANOP                                                           00455000
         AIF   (&I GT K'&ROUTE1).ROUT150  IT IS DONE, ROUTE1 IS OK      00456000
.ROUT130 ANOP                                                           00457000
         AIF   ('&ROUTE1'(&I,1) EQ '&CHAR2'(&WL,1)).ROUT135             00458000
&WL      SETA  &WL+1               BUMP TO NEXT CHARACTER IN TABLE      00459000
         AIF   (&WL GT 39).ROUT1R2   NOT FOUND, ERROR                   00460000
         AGO   .ROUT130            TRY THIS CHARACTER                   00461000
.ROUT135 ANOP                                                           00462000
&WL      SETA  1                   SET LOOP COUNT AGAIN                 00463000
&I       SETA  &I+1                CHECK NEXT CHARACTER OF ROUTE1       00464000
         AGO   .ROUT125            AND START CHECKING                   00465000
.ROUT150 ANOP                                                           00466000
&DEST1   SETC  '&ROUTE1'           SET UP VALID ROUTE1                  00467000
         AGO   .ROUT200            AND CONTINUE                         00468000
.*                                                                      00469000
.ROUT1R2 ANOP                                                           00470000
         SPACE 2                                                        00471000
         MNOTE 8,' INVALID ROUTE1 SPECIFICATION, SET NOT SPECIFIED'     00472000
         SPACE 1                                                        00473000
.*                                                                      00474000
.********************************************************************** 00475000
.*             CHECK ROUTE2 SPECIFICATION                             * 00476000
.********************************************************************** 00477000
.*                                                                      00478000
.*       THE ROUTE2 PARAMETER IS OPTIONAL AND SPECIFIES A DESTINATION   00479000
.*       NODE, THEREFORE IT MUST BE ALPHAMERIC, FIRST CHARACTER         00480000
.*       ALPHABETIC. THE MAXIMUM LENGTH IS EIGHT BYTES.                 00481000
.*       AS DEFAULT (OMITTED), BLANKS ARE GENERATED.                    00482000
.*                                                                      00483000
.ROUT200 ANOP                                                           00484000
&DEST2   SETC  ' '                 INDICATE GENERATION OF BLANKS        00485000
         AIF   (&LOC).ROUT290      GEN BLANKS FOR OWN NODE              00486000
         AIF   (T'&ROUTE2 EQ 'O').ROUT290    IF OMITTED, BRANCH         00487000
         AIF   (K'&ROUTE2 GT 8).ROUT2R2      IF GREATER 8, ERROR        00488000
&WL      SETA  1                   SET LOOP COUNT                       00489000
.ROUT210 ANOP                                                           00490000
         AIF   ('&ROUTE2'(1,1) EQ '&CHAR1'(&WL,1)).ROUT220              00491000
&WL      SETA  &WL+1               BUMP TO NEXT CHARACTER IN TABLE      00492000
         AIF   (&WL GT 29).ROUT2R2  IF NOT FOUND, ERROR                 00493000
         AGO   .ROUT210            AND TRY THIS ONE                     00494000
.ROUT220 ANOP                                                           00495000
&WL      SETA  1                   SET LOOP COUNT FOR OTHER TABLE       00496000
&I       SETA  2                   START CHECKING WITH 2ND CHARACTER    00497000
.ROUT225 ANOP                                                           00498000
         AIF   (&I GT K'&ROUTE2).ROUT250  IT IS DONE, ROUTE1 IS OK      00499000
.ROUT230 ANOP                                                           00500000
         AIF   ('&ROUTE2'(&I,1) EQ '&CHAR2'(&WL,1)).ROUT235             00501000
&WL      SETA  &WL+1               BUMP TO NEXT CHARACTER IN TABLE      00502000
         AIF   (&WL GT 39).ROUT2R2   NOT FOUND, ERROR                   00503000
         AGO   .ROUT230            TRY THIS CHARACTER                   00504000
.ROUT235 ANOP                                                           00505000
&WL      SETA  1                   SET LOOP COUNT AGAIN                 00506000
&I       SETA  &I+1                CHECK NEXT CHARACTER OF ROUTE2       00507000
         AGO   .ROUT225            AND START CHECKING                   00508000
.ROUT250 ANOP                                                           00509000
&DEST2   SETC  '&ROUTE2'           SET UP VALID ROUTE2                  00510000
         AGO   .ROUT290            AND CONTINUE                         00511000
.*                                                                      00512000
.ROUT2R2 ANOP                                                           00513000
         SPACE 2                                                        00514000
         MNOTE 8,' INVALID ROUTE2 SPECIFICATION, SET NOT SPECIFIED'     00515000
         SPACE 1                                                        00516000
.ROUT290 ANOP                                                           00517000
.*                                                                      00518000
.********************************************************************** 00519000
.*             CHECK APPLID SPECIFICATION                             * 00520000
.********************************************************************** 00521000
.*                                                                      00522000
.*       THE APPL PARAMETER SPECIFIES THE APPLICATION ID OF THE NODE    00523000
.*       WHICH IS USED BY VTAM WHEN ESTABLISHING A SESSION WITH         00524000
.*       THE APPL. THE APPLICATION ID MUST BE ALPHAMERIC,               00525000
.*       FIRST CHARACTER ALPHABETIC. THE MAXIMUM LENGTH IS 8 BYTES.     00526000
.*       THE PARAMETER IS EXCLUSIVE WITH EITHER THE ROUTE1     @D65CDAT 00527000
.*       PARAMETER OR THE IPHOSTAD OR THE IPHOSTNM PARAMETER,  @D65CDAT 00528000
.*       OR THE ISHOSTAD OR THE ISHOSTNM PARAMETER.            @D66CDAT 00529000
.*                                                                      00530000
         AIF   (NOT &LOC).APPL05  IF NOT THE LOCAL NODE                 00531000
&APPL    SETC  '&NODE'  DEFAULT APPLID TO LOCAL NODE NAME               00532000
         AIF   (T'&APPLID NE 'O').APPL05   IF PRESENT, GO CHECK@D65CDAT 00533000
&FLG     SETA  &FLG+64             INDICATE SNA TYPE NODE      @D65CDAT 00534000
         AGO   .APPL90             GO FOR NEXT PARAMETER       @D65CDAT 00535000
.*                                                                      00536000
.APPL05  ANOP                                                           00537000
         AIF   (T'&APPLID EQ 'O').APPL90   IF OMITTED, BRANCH           00538000
         AIF   (K'&APPLID GT 8).APPLER1    IF GREATER 8, ERROR          00539000
         AIF   (T'&ROUTE1 NE 'O').APPLER2  REPORT ERROR IF SPECIFIED    00540000
         AIF   (T'&IPHOSTAD NE 'O').APPLER3 ERROR IF SPECIFIED @D65CDAT 00541000
         AIF   (T'&IPHOSTNM NE 'O').APPLER4 ERROR IF SPECIFIED @D65CDAT 00542000
         AIF   (T'&ISHOSTAD NE 'O').APPLER5 ERROR IF SPECIFIED @D66CDAT 00543000
         AIF   (T'&ISHOSTNM NE 'O').APPLER6 ERROR IF SPECIFIED @D65CDAT 00544000
&WL      SETA  1                   SET LOOP COUNT                       00545000
.APPL10  ANOP                                                           00546000
         AIF   ('&APPLID'(1,1) EQ '&CHAR1'(&WL,1)).APPL20               00547000
&WL      SETA  &WL+1               BUMP TO NEXT CHARACTER IN TABLE      00548000
         AIF   (&WL GT 29).APPLER1  IF NOT FOUND, ERROR                 00549000
         AGO   .APPL10             AND TRY THIS ONE                     00550000
.APPL20  ANOP                                                           00551000
&WL      SETA  1                   SET LOOP COUNT FOR OTHER TABLE       00552000
&I       SETA  2                   START CHECKING WITH 2ND CHARACTER    00553000
.APPL25  ANOP                                                           00554000
         AIF   (&I GT K'&APPLID).APPL50  IT IS DONE, APPLID IS OK       00555000
.APPL30  ANOP                                                           00556000
         AIF   ('&APPLID'(&I,1) EQ '&CHAR2'(&WL,1)).APPL35              00557000
&WL      SETA  &WL+1               BUMP TO NEXT CHARACTER IN TABLE      00558000
         AIF   (&WL GT 39).APPLER1   NOT FOUND, ERROR                   00559000
         AGO   .APPL30             TRY THIS CHARACTER                   00560000
.APPL35  ANOP                                                           00561000
&WL      SETA  1                   SET LOOP COUNT AGAIN                 00562000
&I       SETA  &I+1                CHECK NEXT CHARACTER OF APPLID NAME  00563000
         AGO   .APPL25             AND START CHECKING                   00564000
.*                                                                      00565000
.APPLER1 ANOP                                                           00566000
         SPACE 2                                                        00567000
         MNOTE 8,' INVALID APPLID SPECIFICATION, MACRO IGNORED'         00568000
         SPACE 2                                                        00569000
         MEXIT                                                          00570000
.*                                                                      00571000
.APPLER2 ANOP                                                           00572000
         SPACE 2                                                        00573000
         MNOTE 8,' APPLID AND ROUTE1 ARE EXCLUSIVE, MACRO IGNORED'      00574000
         SPACE 2                                                        00575000
         MEXIT                                                          00576000
.*                                                                      00577000
.APPLER3 ANOP                                                  @D65CDAT 00578000
         SPACE 2                                               @D65CDAT 00579000
         MNOTE 8,' APPLID AND IPHOSTAD ARE EXCLUSIVE, MACRO IGNORED'    00580000
         SPACE 2                                               @D65CDAT 00581000
         MEXIT                                                 @D65CDAT 00582000
.*                                                                      00583000
.APPLER4 ANOP                                                  @D65CDAT 00584000
         SPACE 2                                               @D65CDAT 00585000
         MNOTE 8,' APPLID AND IPHOSTNM ARE EXCLUSIVE, MACRO IGNORED'    00586000
         SPACE 2                                               @D65CDAT 00587000
         MEXIT                                                 @D65CDAT 00588000
.*                                                                      00589000
.APPLER5 ANOP                                                  @D66CDAT 00590000
         SPACE 2                                               @D66CDAT 00591000
         MNOTE 8,' APPLID AND ISHOSTAD ARE EXCLUSIVE, MACRO IGNORED'    00592000
         SPACE 2                                               @D66CDAT 00593000
         MEXIT                                                 @D66CDAT 00594000
.*                                                                      00595000
.APPLER6 ANOP                                                  @D66CDAT 00596000
         SPACE 2                                               @D66CDAT 00597000
         MNOTE 8,' APPLID AND ISHOSTNM ARE EXCLUSIVE, MACRO IGNORED'    00598000
         SPACE 2                                               @D66CDAT 00599000
         MEXIT                                                 @D66CDAT 00600000
.*                                                                      00601000
.APPL50  ANOP                                                           00602000
&FLG     SETA  &FLG+64             INDICATE SNA TYPE NODE               00603000
&APPL    SETC  '&APPLID'           SAVE APPLICATION ID                  00604000
.*                                                                      00605000
.APPL90  ANOP                                                           00606000
.*                                                                      00607000
.********************************************************************** 00608000
.*             CHECK IPHOSTAD SPECIFICATION                           * 00609000
.********************************************************************AT 00610000
.*                                                                      00611000
.*       THE IPHOSTAD PARAMETER SPECIFIES THE IP ADDRESS OF    @D65CDAT 00612000
.*       THE FOREIGN HOST, BY WHICH THE REMOTE NJE NODE        @D65CDAT 00613000
.*       SHOULD BE CONTACTED.                                  @D65CDAT 00614000
.*       FOR THE LOCAL NODE, THAT EVALUATES THE IP ADDRESS OF  @D65CDAT 00615000
.*       ITS OWN HOST BY THE 'GETHOSTID' REQUEST, THE IPHOSTAD @D65CDAT 00616000
.*       PARAMETER IS NOT ACCEPTED.                            @D65CDAT 00617000
.*       FOR REMOTE NODES, IPHOSTAD IS EXCLUSIVE WITH THE ...  @D65CDAT 00618000
.*         - APPLID PARAMETER (ALREADY VERIFIED NEAR 'APPL05') @D65CDAT 00619000
.*         - ROUTE1 PARAMETER ---> MNOTE AND MEXIT             @D65CDAT 00620000
.*         - IPHOSTNM PARAMETER  --> MNOTE AND MEXIT           @D65CDAT 00621000
.*         - ISHOSTAD PARAMETER  --> MNOTE AND MEXIT           @D66CDAT 00622000
.*         - ISHOSTNM PARAMETER  --> MNOTE AND MEXIT           @D66CDAT 00623000
.*         - SPORT PARAMETER     --> MNOTE AND MEXIT           @D66CDAT 00624000
.*       WHEN ACCEPTED, IPHOSTAD SHOULD HAVE THE FORMAT OF A   @D65CDAT 00625000
.*       DOTTED DECIMAL TCP/IP ADDRESS AS FOLLOWS:             @D65CDAT 00626000
.*         0.0.0.0 --> 0.0.0.255 --> ... 255.255.255.255       @D65CDAT 00627000
.*       LEADING ZEROS E.G. 016.08.198.32 WILL BE ACCEPTED     @D65CDAT 00628000
.*                                                                      00629000
&HONM    SETC  ' '                 SET GENERATION OF BLANKS    @D65CDAT 00630000
         AIF   (T'&IPHOSTAD EQ 'O').IPAD90  IF OMITTED, BYPASS @D65CDAT 00631000
.*                                                                      00632000
         AIF   (&LOC).IPADER1      IF LOCAL NODE, ERROR        @D65CDAT 00633000
.*                                                                      00634000
.IPAD00  ANOP                                                  @D65CDAT 00635000
         AIF   (T'&ROUTE1 NE 'O').IPADER2   ERROR IF SPECIFIED @D65CDAT 00636000
         AIF   (T'&IPHOSTNM NE 'O').IPADER3 ERROR IF SPECIFIED @D65CDAT 00637000
         AIF   (T'&ISHOSTAD NE 'O').IPADERB ERROR IF SPECIFIED @D66CDAT 00638000
         AIF   (T'&ISHOSTNM NE 'O').IPADERC ERROR IF SPECIFIED @D66CDAT 00639000
         AIF   (T'&SPORT NE 'O').IPADERD    ERROR IF SPECIFIED @D66CDAT 00640000
.*                                                                      00641000
         AIF   (K'&IPHOSTAD LT 7).IPADER4  ERROR IF < 7 DIGITS @D65CDAT 00642000
         AIF   (K'&IPHOSTAD GT 15).IPADER4 ERROR IF > 15 DIGITS@D65CDAT 00643000
&HOLN    SETA  K'&IPHOSTAD         RECORD SPECIFIED LENGTH     @D65CDAT 00644000
.*                                                                      00645000
.*       REJECT DOTTED DECIMAL STARTING OR ENDING WITH DOT     @D65CDAT 00646000
.*                                                                      00647000
         AIF   ('&IPHOSTAD'(1,1) EQ '.').IPADER5  GO FOR ERROR @D65CDAT 00648000
         AIF   ('&IPHOSTAD'(&HOLN,1) EQ '.').IPADER5  GO ERROR @D65CDAT 00649000
.*                                                                      00650000
.*       REJECT DOTTED DECIMAL WITHOUT 3 DOTS                  @D65CDAT 00651000
.*                                                                      00652000
&WL      SETA  0                   INIT DOT COUNTER            @D65CDAT 00653000
&I       SETA  1                   SET INDEX TO IPHOSTAD START @D65CDAT 00654000
.IPAD05  ANOP                                                  @D65CDAT 00655000
         AIF   (&I GT &HOLN).IPAD15   STOP WHEN ALL CHECKED    @D65CDAT 00656000
         AIF   ('&IPHOSTAD'(&I,1) NE '.').IPAD10  BYPASS NO DOT@D65CDAT 00657000
&WL      SETA  &WL+1               INCREMENT DOT COUNTER       @D65CDAT 00658000
.IPAD10  ANOP                                                  @D65CDAT 00659000
&I       SETA  &I+1                INCREMENT IPHOSTAD INDEX    @D65CDAT 00660000
         AGO   .IPAD05             GO AND CONTINUE CHECKING    @D65CDAT 00661000
.*                                                                      00662000
.IPAD15  ANOP                                                  @D65CDAT 00663000
         AIF   (&WL NE 3).IPADER6  FLAG ERROR, WRONG STRUCTURE @D65CDAT 00664000
.*                                                                      00665000
.*       REJECT DOTTED DECIMAL WITH SUBSEQUENT DOTS            @D65CDAT 00666000
.*       NOTE: WE KNOW ALREADY, THAT THERE ARE 3 MIDDLE DOTS   @D65CDAT 00667000
.*                                                                      00668000
&I       SETA  1                   SET INDEX TO IPHOSTAD START @D65CDAT 00669000
.IPAD20  ANOP                                                  @D65CDAT 00670000
         AIF   (&I GT &HOLN).IPAD30   STOP WHEN ALL CHECKED    @D65CDAT 00671000
         AIF   ('&IPHOSTAD'(&I,1) NE '.').IPAD25  BYPASS NO DOT@D65CDAT 00672000
         AIF   ('&IPHOSTAD'(&I+1,1) EQ '.').IPADER7  GO ERROR  @D65CDAT 00673000
.IPAD25  ANOP                                                  @D65CDAT 00674000
&I       SETA  &I+1                INCREMENT IPHOSTAD INDEX    @D65CDAT 00675000
         AGO   .IPAD20             GO AND CONTINUE CHECKING    @D65CDAT 00676000
.*                                                                      00677000
.IPAD30  ANOP                      GO WITH CORRECT DOT STRUCT. @D65CDAT 00678000
.*                                                                      00679000
.*       CHECK INPUT CHARACTERS FOR BEING NUMERIC              @D65CDAT 00680000
.*                                                                      00681000
&I       SETA  1                   START AT FIRST INPUT DIGIT  @D65CDAT 00682000
&WL      SETA  1                   START AT FIRST NUM-DIGIT    @D65CDAT 00683000
.IPAGPA  ANOP                                                           00684000
         AIF   (&I GT &HOLN).IPAGPD    DONE, INPUT IS NUMERIC  @D65CDAT 00685000
.IPAGPB  ANOP                                                           00686000
         AIF   ('&IPHOSTAD'(&I,1) EQ '&NUM'(&WL,1)).IPAGPC     @D65CDAT 00687000
&WL      SETA  &WL+1               BUMP TO NEXT DIGIT IN NUM   @D65CDAT 00688000
         AIF   (&WL GT 11).IPADER8 NOT NUMERIC, GO FOR ERROR   @D65CDAT 00689000
         AGO   .IPAGPB             TRY NEXT DIGIT OF NUM TABLE @D65CDAT 00690000
.IPAGPC  ANOP                                                           00691000
&WL      SETA  1                   SET FOR START IN NUM TABLE  @D65CDAT 00692000
&I       SETA  &I+1                SET FOR NEXT INPUT CHAR.    @D65CDAT 00693000
         AGO   .IPAGPA             GO AND CHECK THIS CHARACTER @D65CDAT 00694000
.IPAGPD  ANOP                                                           00695000
.*                                                                      00696000
.*                                                                      00697000
.*       REJECT DOT-GROUPS THAT ARE LONGER THAN 3 DIGITS       @D65CDAT 00698000
.*       REJECT DOT-GROUPS THAT ARE GREATER 255                @D65CDAT 00699000
.*       PASS DOT GROUPS TO ARITHMETIC VARIABLE IPA(1-4)       @D65CDAT 00700000
.*                                                                      00701000
.*                                                                      00702000
&WL      SETA  1                   INIT DOT GROUP INDEX        @D65CDAT 00703000
&I       SETA  1                   SET INDEX TO IPHOSTAD START @D65CDAT 00704000
&S       SETA  1                   SET TO START OF DOT GROUP   @D65CDAT 00705000
.IPAD40  ANOP                                                  @D65CDAT 00706000
         AIF   ('&IPHOSTAD'(&I,1) NE '.').IPAD50  BYPASS NO DOT@D65CDAT 00707000
.*                                                                      00708000
.IPAD44  ANOP                      ENTRY FOR LAST DOT GROUP    @D65CDAT 00709000
         AIF   (&I-&S GT 3).IPADERA    IF TOO BIG GROUP, ERROR @D65CDAT 00710000
.*                                                                      00711000
&HOGP    SETC  '&IPHOSTAD'(&S,&I-&S)   COPY DOT GROUP C-TYPE   @D65CDAT 00712000
&DGRP    SETA  &HOGP                   COPY DOT GROUP A-TYPE   @D65CDAT 00713000
         AIF   (&DGRP GT 255).IPADER9  TOO BIG, GO FOR ERROR   @D65CDAT 00714000
&IPA(&WL) SETA  &HOGP                    SET BINARY ADDR. BYTE @D65CDAT 00715000
.*                                                                      00716000
         AIF   (&I GT &HOLN).IPAD55  LEAVE CHECK LOOP FINALLY  @D65CDAT 00717000
.*                                                                      00718000
&WL      SETA  &WL+1               INCREMENT DOT GROUP COUNTER @D65CDAT 00719000
&I       SETA  &I+1                INCREMENT IPHOSTAD INDEX    @D65CDAT 00720000
&S       SETA  &I                  SET TO START OF DOT GROUP   @D65CDAT 00721000
         AGO   .IPAD40             GO AND CONTINUE CHECKING    @D65CDAT 00722000
.IPAD50  ANOP                                                  @D65CDAT 00723000
&I       SETA  &I+1                INCREMENT IPHOSTAD INDEX    @D65CDAT 00724000
         AIF   (&I GT &HOLN).IPAD44  GO RESPECT LAST GOT GROUP @D65CDAT 00725000
         AGO   .IPAD40             GO AND CONTINUE CHECKING    @D65CDAT 00726000
.*                                                                      00727000
.IPAD55  ANOP                                                  @D65CDAT 00728000
.*                                                                      00729000
.*       INDICATE 'TCP' NODE TYPE WITH DOTTED DECIMAL ADDRESS  @D65CDAT 00730000
.*                                                                      00731000
&FLG     SETA  &FLG+16             INDICATE TCP TYPE NODE      @D65CDAT 00732000
&HONM    SETC  '&IPHOSTAD'         SAVE DOTTED DECIMAL ADDRESS @D65CDAT 00733000
&DEST1   SETC  '*ATP    '          INDICATE 'DOTTED DEC. ADDR' @D65CDAT 00734000
         AGO   .IPAD90             GO FOR NEXT PARAMETER       @D65CDAT 00735000
.*                                                                      00736000
.IPADER1 ANOP                                                  @D65CDAT 00737000
         SPACE 2                                               @D65CDAT 00738000
         MNOTE 8,' IPHOSTAD INVALID FOR LOCAL NODE, MACRO IGNORED'      00739000
         SPACE 2                                               @D65CDAT 00740000
         MEXIT                                                 @D65CDAT 00741000
.*                                                                      00742000
.IPADER2 ANOP                                                  @D65CDAT 00743000
         SPACE 2                                               @D65CDAT 00744000
         MNOTE 8,' IPHOSTAD AND ROUTE1 ARE EXCLUSIVE, MACRO IGNORED'    00745000
         SPACE 2                                               @D65CDAT 00746000
         MEXIT                                                 @D65CDAT 00747000
.*                                                                      00748000
.IPADER3 ANOP                                                  @D65CDAT 00749000
         SPACE 2                                               @D65CDAT 00750000
         MNOTE 8,' IPHOSTAD AND IPHOSTNM ARE EXCLUSIVE, MACRO IGNORED'  00751000
         SPACE 2                                               @D65CDAT 00752000
         MEXIT                                                 @D65CDAT 00753000
.*                                                                      00754000
.IPADER4 ANOP                                                  @D65CDAT 00755000
         SPACE 2                                               @D65CDAT 00756000
         MNOTE 8,' IPHOSTAD < 7 OR > 15 DIGITS, MACRO IGNORED'          00757000
         SPACE 2                                               @D65CDAT 00758000
         MEXIT                                                 @D65CDAT 00759000
.*                                                                      00760000
.IPADER5 ANOP                                                  @D65CDAT 00761000
         SPACE 2                                               @D65CDAT 00762000
         MNOTE 8,' IPHOSTAD STARTING/ENDING WITH DOT, MACRO IGNORED'    00763000
         SPACE 2                                               @D65CDAT 00764000
         MEXIT                                                 @D65CDAT 00765000
.*                                                                      00766000
.IPADER6 ANOP                                                  @D65CDAT 00767000
         SPACE 2                                               @D65CDAT 00768000
         MNOTE 8,' IPHOSTAD NO STRUCTURE WITH 3 DOTS, MACRO IGNORED'    00769000
         SPACE 2                                               @D65CDAT 00770000
         MEXIT                                                 @D65CDAT 00771000
.*                                                                      00772000
.IPADER7 ANOP                                                  @D65CDAT 00773000
         SPACE 2                                               @D65CDAT 00774000
         MNOTE 8,' IPHOSTAD WITH SUBSEQUENT DOTS, MACRO IGNORED'        00775000
         SPACE 2                                               @D65CDAT 00776000
         MEXIT                                                 @D65CDAT 00777000
.*                                                                      00778000
.IPADER8 ANOP                                                  @D65CDAT 00779000
         SPACE 2                                               @D65CDAT 00780000
         MNOTE 8,' IPHOSTAD WITH NON-NUMERIC ADDRESS, MACRO IGNORED'    00781000
         SPACE 2                                               @D65CDAT 00782000
         MEXIT                                                 @D65CDAT 00783000
.*                                                                      00784000
.IPADER9 ANOP                                                  @D65CDAT 00785000
         SPACE 2                                               @D65CDAT 00786000
         MNOTE 8,'IPHOSTAD WITH DOT GROUP ADDRESS > 255, MACRO IGNORED' 00787000
         SPACE 2                                               @D65CDAT 00788000
         MEXIT                                                 @D65CDAT 00789000
.IPADERA ANOP                                                  @D65CDAT 00790000
         SPACE 2                                               @D65CDAT 00791000
         MNOTE 8,'IPHOSTAD WITH DOT GROUP LONGER THAN 3, MACRO IGNORED' 00792000
         SPACE 2                                               @D65CDAT 00793000
         MEXIT                                                 @D65CDAT 00794000
.*                                                                      00795000
.IPADERB ANOP                                                  @D66CDAT 00796000
         SPACE 2                                               @D66CDAT 00797000
         MNOTE 8,' IPHOSTAD AND ISHOSTAD ARE EXCLUSIVE, MACRO IGNORED'  00798000
         SPACE 2                                               @D66CDAT 00799000
         MEXIT                                                 @D66CDAT 00800000
.*                                                                      00801000
.IPADERC ANOP                                                  @D66CDAT 00802000
         SPACE 2                                               @D66CDAT 00803000
         MNOTE 8,' IPHOSTAD AND ISHOSTNM ARE EXCLUSIVE, MACRO IGNORED'  00804000
         SPACE 2                                               @D66CDAT 00805000
         MEXIT                                                 @D66CDAT 00806000
.*                                                                      00807000
.IPADERD ANOP                                                  @D66CDAT 00808000
         SPACE 2                                               @D66CDAT 00809000
         MNOTE 8,' IPHOSTAD AND SPORT ARE EXCLUSIVE, MACRO IGNORED'     00810000
         SPACE 2                                               @D66CDAT 00811000
         MEXIT                                                 @D66CDAT 00812000
.*                                                                      00813000
.IPAD90  ANOP                      END OF IPHOSTAD CHECKING    @D65CDAT 00814000
.*                                                                      00815000
.********************************************************************** 00816000
.*             CHECK IPHOSTNM SPECIFICATION                           * 00817000
.********************************************************************AT 00818000
.*                                                                      00819000
.*       THE IPHOSTNM PARAMETER IS THE SYMBOLIC ADDRESS OF     @D65CDAT 00820000
.*       THE FOREIGN HOST, BY WHICH THE REMOTE NJE NODE        @D65CDAT 00821000
.*       SHOULD BE CONTACTED.                                  @D65CDAT 00822000
.*       FOR THE LOCAL NODE, WHICH EVALUATES THE IP ADDRESS OF @D65CDAT 00823000
.*       ITS OWN HOST BY THE 'GETHOSTID' REQUEST, THE IPHOSTNM @D65CDAT 00824000
.*       PARAMETER IS NOT ACCEPTED.                            @D65CDAT 00825000
.*       FOR REMOTE NODES, IPHOSTNM IS EXCLUSIVE WITH THE ...  @D65CDAT 00826000
.*         - APPLID PARAMETER (ALREADY VERIFIED NEAR 'APPL05') @D65CDAT 00827000
.*         - IPHOSTAD PARAMETER (VERIFIED NEAR 'IPAD00')       @D65CDAT 00828000
.*         - ROUTE1 PARAMETER ---> MNOTE AND MEXIT             @D65CDAT 00829000
.*         - ISHOSTAD PARAMETER ---> MNOTE AND MEXIT           @D66CDAT 00830000
.*         - ISHOSTNM PARAMETER ---> MNOTE AND MEXIT           @D66CDAT 00831000
.*         - SPORT PARAMETER     --> MNOTE AND MEXIT           @D66CDAT 00832000
.*       WHEN ACCEPTED, IPHOSTNM MAY SPECIFY ANY CHARACTER     @D65CDAT 00833000
.*       UP TO A LENGTH OF 255. CONVERTING THIS SYMBOLIC       @D65CDAT 00834000
.*       ADDRESS TO A BINARY 4 DIGIT IP ADDRESS IS LEFT TO     @D65CDAT 00835000
.*       THE TD-SUBTASK USING THE 'GETHOSTBYNAME' SERVICE.     @D65CDAT 00836000
.*                                                                      00837000
         AIF   (T'&IPHOSTNM EQ 'O').IPNM90  IF OMITTED, BYPASS @D65CDAT 00838000
.*                                                                      00839000
         AIF   (&LOC).IPNMER1      IF LOCAL NODE, ERROR        @D65CDAT 00840000
.*                                                                      00841000
.IPNM00  ANOP                                                  @D65CDAT 00842000
         AIF   (T'&ROUTE1 NE 'O').IPNMER2   ERROR IF SPECIFIED @D65CDAT 00843000
         AIF   (T'&ISHOSTAD NE 'O').IPNMER4   ERROR IF SPECIF. @D66CDAT 00844000
         AIF   (T'&ISHOSTNM NE 'O').IPNMER5   ERROR IF SPECIF. @D66CDAT 00845000
         AIF   (T'&SPORT NE 'O').IPNMER6      ERROR IF SPECIF. @D66CDAT 00846000
         AIF   (K'&IPHOSTNM GT 255).IPNMER3  ERR IF > 255 DIGIT@D65CDAT 00847000
&HOLN    SETA  K'&IPHOSTNM         RECORD SPECIFIED LENGTH     @D65CDAT 00848000
.*                                                                      00849000
.*       INDICATE 'TCP' NODE TYPE WITH SYMBOLIC ADDRESS        @D65CDAT 00850000
.*                                                                      00851000
&FLG     SETA  &FLG+16             INDICATE TCP TYPE NODE      @D65CDAT 00852000
&HONM    SETC  '&IPHOSTNM'         SAVE SYMBOLIC HOST ADDRESS  @D65CDAT 00853000
&DEST1   SETC  '*NTP    '          INDICATE 'SYMBOLIC ADDRESS' @D65CDAT 00854000
         AGO   .IPNM90             GO FOR NEXT PARAMETER       @D65CDAT 00855000
.*                                                                      00856000
.IPNMER1 ANOP                                                  @D65CDAT 00857000
         SPACE 2                                               @D65CDAT 00858000
         MNOTE 8,' IPHOSTNM INVALID FOR LOCAL NODE, MACRO IGNORED'      00859000
         SPACE 2                                               @D65CDAT 00860000
         MEXIT                                                 @D65CDAT 00861000
.*                                                                      00862000
.IPNMER2 ANOP                                                  @D65CDAT 00863000
         SPACE 2                                               @D65CDAT 00864000
         MNOTE 8,' IPHOSTNM AND ROUTE1 ARE EXCLUSIVE, MACRO IGNORED'    00865000
         SPACE 2                                               @D65CDAT 00866000
         MEXIT                                                 @D65CDAT 00867000
.*                                                                      00868000
.IPNMER3 ANOP                                                  @D65CDAT 00869000
         SPACE 2                                               @D65CDAT 00870000
         MNOTE 8,' IPHOSTNM LONGER THAN 255, MACRO IGNORED'             00871000
         SPACE 2                                               @D65CDAT 00872000
         MEXIT                                                 @D65CDAT 00873000
.*                                                                      00874000
.IPNMER4 ANOP                                                  @D66CDAT 00875000
         SPACE 2                                               @D66CDAT 00876000
         MNOTE 8,' IPHOSTNM AND ISHOSTAD ARE EXCLUSIVE, MACRO IGNORED'  00877000
         SPACE 2                                               @D66CDAT 00878000
         MEXIT                                                 @D66CDAT 00879000
.*                                                                      00880000
.IPNMER5 ANOP                                                  @D66CDAT 00881000
         SPACE 2                                               @D66CDAT 00882000
         MNOTE 8,' IPHOSTNM AND ISHOSTNM ARE EXCLUSIVE, MACRO IGNORED'  00883000
         SPACE 2                                               @D66CDAT 00884000
         MEXIT                                                 @D66CDAT 00885000
.*                                                                      00886000
.IPNMER6 ANOP                                                  @D66CDAT 00887000
         SPACE 2                                               @D66CDAT 00888000
         MNOTE 8,' IPHOSTNM AND SPORT ARE EXCLUSIVE, MACRO IGNORED'     00889000
         SPACE 2                                               @D66CDAT 00890000
         MEXIT                                                 @D66CDAT 00891000
.*                                                                      00892000
.IPNM90  ANOP                      END OF IPHOSTNM CHECKING    @D65CDAT 00893000
.*                                                                      00894000
.********************************************************************** 00895000
.*        CHECK ISHOSTAD SPECIFICATION (IPHOSTAD FOR SSL NODE)        * 00896000
.********************************************************************AT 00897000
.*                                                                      00898000
.*       THE ISHOSTAD PARAMETER SPECIFIES THE SSL IP ADDRESS   @D66CDAT 00899000
.*       OF THE FOREIGN HOST, BY WHICH THE REMOTE NJE NODE     @D66CDAT 00900000
.*       SHOULD BE CONTACTED.                                  @D66CDAT 00901000
.*       FOR THE LOCAL NODE, THAT EVALUATES THE IP ADDRESS OF  @D66CDAT 00902000
.*       ITS OWN HOST BY THE 'GETHOSTID' REQUEST, THE ISHOSTAD @D66CDAT 00903000
.*       PARAMETER IS NOT ACCEPTED.                            @D66CDAT 00904000
.*       FOR REMOTE NODES, ISHOSTAD IS EXCLUSIVE WITH THE ...  @D66CDAT 00905000
.*         - APPLID PARAMETER (ALREADY VERIFIED NEAR 'APPL05') @D66CDAT 00906000
.*         - ROUTE1 PARAMETER ---> MNOTE AND MEXIT             @D66CDAT 00907000
.*         - IPHOSTAD PARAMETER (ALREADY VERIF. NEAR 'IPAD00'  @D66CDAT 00908000
.*         - IPHOSTNM PARAMETER (ALREADY VERIF. NEAR 'IPNM00'  @D66CDAT 00909000
.*         - ISHOSTNM PARAMETER  --> MNOTE AND MEXIT           @D66CDAT 00910000
.*         - PORT PARAMETER      --> MNOTE AND MEXIT           @D66CDAT 00911000
.*       WHEN ACCEPTED, ISHOSTAD SHOULD HAVE THE FORMAT OF A   @D66CDAT 00912000
.*       DOTTED DECIMAL TCP/IP ADDRESS AS FOLLOWS:             @D66CDAT 00913000
.*         0.0.0.0 --> 0.0.0.255 --> ... 255.255.255.255       @D66CDAT 00914000
.*       LEADING ZEROS E.G. 016.08.198.32 WILL BE ACCEPTED     @D66CDAT 00915000
.*                                                                      00916000
         AIF   (T'&ISHOSTAD EQ 'O').ISAD90  IF OMITTED, BYPASS @D66CDAT 00917000
.*                                                                      00918000
         AIF   (&LOC).ISADER1      IF LOCAL NODE, ERROR        @D66CDAT 00919000
.*                                                                      00920000
.ISAD00  ANOP                                                  @D66CDAT 00921000
         AIF   (T'&ROUTE1 NE 'O').ISADER2   ERROR IF SPECIFIED @D66CDAT 00922000
         AIF   (T'&ISHOSTNM NE 'O').ISADER3 ERROR IF SPECIFIED @D66CDAT 00923000
         AIF   (T'&PORT NE 'O').ISADERB     ERROR IF SPECIFIED @D66CDAT 00924000
.*                                                                      00925000
         AIF   (K'&ISHOSTAD LT 7).ISADER4  ERROR IF < 7 DIGITS @D66CDAT 00926000
         AIF   (K'&ISHOSTAD GT 15).ISADER4 ERROR IF > 15 DIGITS@D66CDAT 00927000
&HOLN    SETA  K'&ISHOSTAD         RECORD SPECIFIED LENGTH     @D66CDAT 00928000
.*                                                                      00929000
.*       REJECT DOTTED DECIMAL STARTING OR ENDING WITH DOT     @D66CDAT 00930000
.*                                                                      00931000
         AIF   ('&ISHOSTAD'(1,1) EQ '.').ISADER5  GO FOR ERROR @D66CDAT 00932000
         AIF   ('&ISHOSTAD'(&HOLN,1) EQ '.').ISADER5  GO ERROR @D66CDAT 00933000
.*                                                                      00934000
.*       REJECT DOTTED DECIMAL WITHOUT 3 DOTS                  @D66CDAT 00935000
.*                                                                      00936000
&WL      SETA  0                   INIT DOT COUNTER            @D66CDAT 00937000
&I       SETA  1                   SET INDEX TO ISHOSTAD START @D66CDAT 00938000
.ISAD05  ANOP                                                  @D66CDAT 00939000
         AIF   (&I GT &HOLN).ISAD15   STOP WHEN ALL CHECKED    @D66CDAT 00940000
         AIF   ('&ISHOSTAD'(&I,1) NE '.').ISAD10  BYPASS NO DOT@D66CDAT 00941000
&WL      SETA  &WL+1               INCREMENT DOT COUNTER       @D66CDAT 00942000
.ISAD10  ANOP                                                  @D66CDAT 00943000
&I       SETA  &I+1                INCREMENT ISHOSTAD INDEX    @D66CDAT 00944000
         AGO   .ISAD05             GO AND CONTINUE CHECKING    @D66CDAT 00945000
.*                                                                      00946000
.ISAD15  ANOP                                                  @D66CDAT 00947000
         AIF   (&WL NE 3).ISADER6  FLAG ERROR, WRONG STRUCTURE @D66CDAT 00948000
.*                                                                      00949000
.*       REJECT DOTTED DECIMAL WITH SUBSEQUENT DOTS            @D66CDAT 00950000
.*       NOTE: WE KNOW ALREADY, THAT THERE ARE 3 MIDDLE DOTS   @D66CDAT 00951000
.*                                                                      00952000
&I       SETA  1                   SET INDEX TO ISHOSTAD START @D66CDAT 00953000
.ISAD20  ANOP                                                  @D66CDAT 00954000
         AIF   (&I GT &HOLN).ISAD30   STOP WHEN ALL CHECKED    @D66CDAT 00955000
         AIF   ('&ISHOSTAD'(&I,1) NE '.').ISAD25  BYPASS NO DOT@D66CDAT 00956000
         AIF   ('&ISHOSTAD'(&I+1,1) EQ '.').ISADER7  GO ERROR  @D66CDAT 00957000
.ISAD25  ANOP                                                  @D66CDAT 00958000
&I       SETA  &I+1                INCREMENT ISHOSTAD INDEX    @D66CDAT 00959000
         AGO   .ISAD20             GO AND CONTINUE CHECKING    @D66CDAT 00960000
.*                                                                      00961000
.ISAD30  ANOP                      GO WITH CORRECT DOT STRUCT. @D66CDAT 00962000
.*                                                                      00963000
.*       CHECK INPUT CHARACTERS FOR BEING NUMERIC              @D66CDAT 00964000
.*                                                                      00965000
&I       SETA  1                   START AT FIRST INPUT DIGIT  @D66CDAT 00966000
&WL      SETA  1                   START AT FIRST NUM-DIGIT    @D66CDAT 00967000
.ISAGPA  ANOP                                                           00968000
         AIF   (&I GT &HOLN).ISAGPD    DONE, INPUT IS NUMERIC  @D66CDAT 00969000
.ISAGPB  ANOP                                                           00970000
         AIF   ('&ISHOSTAD'(&I,1) EQ '&NUM'(&WL,1)).ISAGPC     @D66CDAT 00971000
&WL      SETA  &WL+1               BUMP TO NEXT DIGIT IN NUM   @D66CDAT 00972000
         AIF   (&WL GT 11).ISADER8 NOT NUMERIC, GO FOR ERROR   @D66CDAT 00973000
         AGO   .ISAGPB             TRY NEXT DIGIT OF NUM TABLE @D66CDAT 00974000
.ISAGPC  ANOP                                                           00975000
&WL      SETA  1                   SET FOR START IN NUM TABLE  @D66CDAT 00976000
&I       SETA  &I+1                SET FOR NEXT INPUT CHAR.    @D66CDAT 00977000
         AGO   .ISAGPA             GO AND CHECK THIS CHARACTER @D66CDAT 00978000
.ISAGPD  ANOP                                                           00979000
.*                                                                      00980000
.*                                                                      00981000
.*       REJECT DOT-GROUPS THAT ARE LONGER THAN 3 DIGITS       @D66CDAT 00982000
.*       REJECT DOT-GROUPS THAT ARE GREATER 255                @D66CDAT 00983000
.*       PASS DOT GROUPS TO ARITHMETIC VARIABLE IPA(1-4)       @D66CDAT 00984000
.*                                                                      00985000
.*                                                                      00986000
&WL      SETA  1                   INIT DOT GROUP INDEX        @D66CDAT 00987000
&I       SETA  1                   SET INDEX TO ISHOSTAD START @D66CDAT 00988000
&S       SETA  1                   SET TO START OF DOT GROUP   @D66CDAT 00989000
.ISAD40  ANOP                                                  @D66CDAT 00990000
         AIF   ('&ISHOSTAD'(&I,1) NE '.').ISAD50  BYPASS NO DOT@D66CDAT 00991000
.*                                                                      00992000
.ISAD44  ANOP                      ENTRY FOR LAST DOT GROUP    @D66CDAT 00993000
         AIF   (&I-&S GT 3).ISADERA    IF TOO BIG GROUP, ERROR @D66CDAT 00994000
.*                                                                      00995000
&HOGP    SETC  '&ISHOSTAD'(&S,&I-&S)   COPY DOT GROUP C-TYPE   @D66CDAT 00996000
&DGRP    SETA  &HOGP                   COPY DOT GROUP A-TYPE   @D66CDAT 00997000
         AIF   (&DGRP GT 255).ISADER9  TOO BIG, GO FOR ERROR   @D66CDAT 00998000
&IPA(&WL) SETA  &HOGP                    SET BINARY ADDR. BYTE @D66CDAT 00999000
.*                                                                      01000000
         AIF   (&I GT &HOLN).ISAD55  LEAVE CHECK LOOP FINALLY  @D66CDAT 01001000
.*                                                                      01002000
&WL      SETA  &WL+1               INCREMENT DOT GROUP COUNTER @D66CDAT 01003000
&I       SETA  &I+1                INCREMENT ISHOSTAD INDEX    @D66CDAT 01004000
&S       SETA  &I                  SET TO START OF DOT GROUP   @D66CDAT 01005000
         AGO   .ISAD40             GO AND CONTINUE CHECKING    @D66CDAT 01006000
.ISAD50  ANOP                                                  @D66CDAT 01007000
&I       SETA  &I+1                INCREMENT ISHOSTAD INDEX    @D66CDAT 01008000
         AIF   (&I GT &HOLN).ISAD44  GO RESPECT LAST GOT GROUP @D66CDAT 01009000
         AGO   .ISAD40             GO AND CONTINUE CHECKING    @D66CDAT 01010000
.*                                                                      01011000
.ISAD55  ANOP                                                  @D66CDAT 01012000
.*                                                                      01013000
.*       INDICATE 'SSL' NODE TYPE WITH DOTTED DECIMAL ADDRESS  @D66CDAT 01014000
.*                                                                      01015000
&FLG     SETA  &FLG+4              INDICATE SSL TYPE NODE      @D66CDAT 01016000
&HONM    SETC  '&ISHOSTAD'         SAVE DOTTED DECIMAL ADDRESS @D66CDAT 01017000
&DEST1   SETC  '*ATP    '          INDICATE 'DOTTED DEC. ADDR' @D66CDAT 01018000
         AGO   .ISAD90             GO FOR NEXT PARAMETER       @D66CDAT 01019000
.*                                                                      01020000
.ISADER1 ANOP                                                  @D66CDAT 01021000
         SPACE 2                                               @D66CDAT 01022000
         MNOTE 8,' ISHOSTAD INVALID FOR LOCAL NODE, MACRO IGNORED'      01023000
         SPACE 2                                               @D66CDAT 01024000
         MEXIT                                                 @D66CDAT 01025000
.*                                                                      01026000
.ISADER2 ANOP                                                  @D66CDAT 01027000
         SPACE 2                                               @D66CDAT 01028000
         MNOTE 8,' ISHOSTAD AND ROUTE1 ARE EXCLUSIVE, MACRO IGNORED'    01029000
         SPACE 2                                               @D66CDAT 01030000
         MEXIT                                                 @D66CDAT 01031000
.*                                                                      01032000
.ISADER3 ANOP                                                  @D66CDAT 01033000
         SPACE 2                                               @D66CDAT 01034000
         MNOTE 8,' ISHOSTAD AND ISHOSTNM ARE EXCLUSIVE, MACRO IGNORED'  01035000
         SPACE 2                                               @D66CDAT 01036000
         MEXIT                                                 @D66CDAT 01037000
.*                                                                      01038000
.ISADER4 ANOP                                                  @D66CDAT 01039000
         SPACE 2                                               @D66CDAT 01040000
         MNOTE 8,' ISHOSTAD < 7 OR > 15 DIGITS, MACRO IGNORED'          01041000
         SPACE 2                                               @D66CDAT 01042000
         MEXIT                                                 @D66CDAT 01043000
.*                                                                      01044000
.ISADER5 ANOP                                                  @D66CDAT 01045000
         SPACE 2                                               @D66CDAT 01046000
         MNOTE 8,' ISHOSTAD STARTING/ENDING WITH DOT, MACRO IGNORED'    01047000
         SPACE 2                                               @D66CDAT 01048000
         MEXIT                                                 @D66CDAT 01049000
.*                                                                      01050000
.ISADER6 ANOP                                                  @D66CDAT 01051000
         SPACE 2                                               @D66CDAT 01052000
         MNOTE 8,' ISHOSTAD NO STRUCTURE WITH 3 DOTS, MACRO IGNORED'    01053000
         SPACE 2                                               @D66CDAT 01054000
         MEXIT                                                 @D66CDAT 01055000
.*                                                                      01056000
.ISADER7 ANOP                                                  @D66CDAT 01057000
         SPACE 2                                               @D66CDAT 01058000
         MNOTE 8,' ISHOSTAD WITH SUBSEQUENT DOTS, MACRO IGNORED'        01059000
         SPACE 2                                               @D66CDAT 01060000
         MEXIT                                                 @D66CDAT 01061000
.*                                                                      01062000
.ISADER8 ANOP                                                  @D66CDAT 01063000
         SPACE 2                                               @D66CDAT 01064000
         MNOTE 8,' ISHOSTAD WITH NON-NUMERIC ADDRESS, MACRO IGNORED'    01065000
         SPACE 2                                               @D66CDAT 01066000
         MEXIT                                                 @D66CDAT 01067000
.*                                                                      01068000
.ISADER9 ANOP                                                  @D66CDAT 01069000
         SPACE 2                                               @D66CDAT 01070000
         MNOTE 8,'ISHOSTAD WITH DOT GROUP ADDRESS > 255, MACRO IGNORED' 01071000
         SPACE 2                                               @D66CDAT 01072000
         MEXIT                                                 @D66CDAT 01073000
.*                                                                      01074000
.ISADERA ANOP                                                  @D66CDAT 01075000
         SPACE 2                                               @D66CDAT 01076000
         MNOTE 8,'ISHOSTAD WITH DOT GROUP LONGER THAN 3, MACRO IGNORED' 01077000
         SPACE 2                                               @D66CDAT 01078000
         MEXIT                                                 @D66CDAT 01079000
.*                                                                      01080000
.ISADERB ANOP                                                  @D66CDAT 01081000
         SPACE 2                                               @D66CDAT 01082000
         MNOTE 8,' ISHOSTAD AND PORT ARE EXCLUSIVE, MACRO IGNORED'      01083000
         SPACE 2                                               @D66CDAT 01084000
         MEXIT                                                 @D66CDAT 01085000
.*                                                                      01086000
.ISAD90  ANOP                      END OF ISHOSTAD CHECKING    @D66CDAT 01087000
.*                                                                      01088000
.********************************************************************** 01089000
.*        CHECK ISHOSTNM SPECIFICATION (IPHOSTNM FOR SSL NODES)       * 01090000
.********************************************************************AT 01091000
.*                                                                      01092000
.*       THE ISHOSTNM PARAMETER IS THE SYMBOLIC ADDRESS OF     @D66CDAT 01093000
.*       THE FOREIGN HOST (USED FOR A SECURED SOCKET COMMUNI-  @D66CDAT 01094000
.*       CATION), BY WHICH THE REMOTE NJE NODE SHOULD BE       @D66CDAT 01095000
.*       CONTACTED                                             @D66CDAT 01096000
.*       FOR THE LOCAL NODE, WHICH EVALUATES THE IP ADDRESS OF @D66CDAT 01097000
.*       ITS OWN HOST BY THE 'GETHOSTID' REQUEST, THE ISHOSTNM @D66CDAT 01098000
.*       PARAMETER IS NOT ACCEPTED.                            @D66CDAT 01099000
.*       FOR REMOTE NODES, ISHOSTNM IS EXCLUSIVE WITH THE ...  @D66CDAT 01100000
.*         - APPLID PARAMETER (ALREADY VERIFIED NEAR 'APPL05') @D66CDAT 01101000
.*         - IPHOSTAD PARAMETER (VERIFIED NEAR 'IPAD00')       @D66CDAT 01102000
.*         - IPHOSTNM PARAMETER (VERIFIED NEAR 'IPNM00')       @D66CDAT 01103000
.*         - ISHOSTAD PARAMETER (VERIFIED NEAR 'ISAD00')       @D66CDAT 01104000
.*         - ROUTE1 PARAMETER ---> MNOTE AND MEXIT             @D66CDAT 01105000
.*         - PORT PARAMETER      --> MNOTE AND MEXIT           @D66CDAT 01106000
.*       WHEN ACCEPTED, ISHOSTNM MAY SPECIFY ANY CHARACTER     @D66CDAT 01107000
.*       UP TO A LENGTH OF 255. CONVERTING THIS SYMBOLIC       @D66CDAT 01108000
.*       ADDRESS TO A BINARY 4 DIGIT IP ADDRESS IS LEFT TO     @D66CDAT 01109000
.*       THE SD-SUBTASK USING THE 'GETHOSTBYNAME' SERVICE.     @D66CDAT 01110000
.*                                                                      01111000
         AIF   (T'&ISHOSTNM EQ 'O').ISNM90  IF OMITTED, BYPASS @D66CDAT 01112000
.*                                                                      01113000
         AIF   (&LOC).ISNMER1      IF LOCAL NODE, ERROR        @D66CDAT 01114000
.*                                                                      01115000
.ISNM00  ANOP                                                  @D66CDAT 01116000
         AIF   (T'&ROUTE1 NE 'O').ISNMER2   ERROR IF SPECIFIED @D66CDAT 01117000
         AIF   (T'&PORT NE 'O').ISNMER4     ERROR IF SPECIFIED @D66CDAT 01118000
         AIF   (K'&ISHOSTNM GT 255).ISNMER3  ERR IF > 255 DIGIT@D66CDAT 01119000
&HOLN    SETA  K'&ISHOSTNM         RECORD SPECIFIED LENGTH     @D66CDAT 01120000
.*                                                                      01121000
.*       INDICATE 'SSL' NODE TYPE WITH SYMBOLIC ADDRESS        @D66CDAT 01122000
.*                                                                      01123000
&FLG     SETA  &FLG+4              INDICATE SSL TYPE NODE      @D66CDAT 01124000
&HONM    SETC  '&ISHOSTNM'         SAVE SYMBOLIC HOST ADDRESS  @D66CDAT 01125000
&DEST1   SETC  '*NTP    '          INDICATE 'SYMBOLIC ADDRESS' @D66CDAT 01126000
         AGO   .ISNM90             GO FOR NEXT PARAMETER       @D66CDAT 01127000
.*                                                                      01128000
.ISNMER1 ANOP                                                  @D66CDAT 01129000
         SPACE 2                                               @D66CDAT 01130000
         MNOTE 8,' ISHOSTNM INVALID FOR LOCAL NODE, MACRO IGNORED'      01131000
         SPACE 2                                               @D66CDAT 01132000
         MEXIT                                                 @D66CDAT 01133000
.*                                                                      01134000
.ISNMER2 ANOP                                                  @D66CDAT 01135000
         SPACE 2                                               @D66CDAT 01136000
         MNOTE 8,' ISHOSTNM AND ROUTE1 ARE EXCLUSIVE, MACRO IGNORED'    01137000
         SPACE 2                                               @D66CDAT 01138000
         MEXIT                                                 @D66CDAT 01139000
.*                                                                      01140000
.ISNMER3 ANOP                                                  @D66CDAT 01141000
         SPACE 2                                               @D66CDAT 01142000
         MNOTE 8,' ISHOSTNM LONGER THAN 255, MACRO IGNORED'             01143000
         SPACE 2                                               @D66CDAT 01144000
         MEXIT                                                 @D66CDAT 01145000
.*                                                                      01146000
.ISNMER4 ANOP                                                  @D66CDAT 01147000
         SPACE 2                                               @D66CDAT 01148000
         MNOTE 8,' ISHOSTNM AND PORT ARE EXCLUSIVE, MACRO IGNORED'      01149000
         SPACE 2                                               @D66CDAT 01150000
         MEXIT                                                 @D66CDAT 01151000
.*                                                                      01152000
.ISNM90  ANOP                      END OF ISHOSTNM CHECKING    @D66CDAT 01153000
.*                                                                      01154000
.********************************************************************** 01155000
.*             CHECK MAXBUF SPECIFICATION                             * 01156000
.********************************************************************** 01157000
.*                                                                      01158000
.*       THE MAXBUF PARAMETER SPECIFIES THE MAXIMUM NUMBER OF  @D65CDAT 01159000
.*       PNET BUFFERS TO BE USED BY RECEIVER AND TRANSMITTER   @D65CDAT 01160000
.*       TASKS.                                                @D65CDAT 01161000
.*       FOR ALL LINKS, MAXBUF CAN BE SPECIFIED,               @DY46287 01162000
.*       THE DEFAULT IS (4,4).                                 @DY46287 01163000
.*       THE PARAMETER IS OPTIONAL, IGNORED FOR LOCAL ENTRY.   @D65CDAT 01165000
.*                                                                      01166000
.MBUF00  ANOP                                                           01167000
         AIF   (&LOC).MBUF60       IGNORE FOR LOCAL ENTRY      @D65CDAT 01168000
.*                                                                      01169000
&BF(1)   SETA  4                   DEFAULT INPUT BUFFERS       @DY46287 01170000
&BF(2)   SETA  4                   DEFAULT OUTPUT BUFFERS      @DY46287 01171000
.*                                                             @DY46287 01190000
&MIN(1)  SETA  3                   MIN VALUE FOR INPUT BUFFERS @DY46287 01191000
&MIN(2)  SETA  1                   MIN VALUE FOR OUTPUT BUFF'S @DY46287 01192000
.*                                                             @DY46287 01193000
&MAX(1)  SETA  16                  MAX VAL. TCP/SSL INPUT BUF. @DY46287 01194000
&MAX(2)  SETA  16                  MAX VAL. TCP/SSL OUTPUT BUF.@DY46287 01195000
.*                                                             @DY46287 01196000
         AIF   (T'&IPHOSTAD NE 'O').MBUF04 GO FOR TCP(AD) NODE @DY46287 01172000
         AIF   (T'&ISHOSTAD NE 'O').MBUF04 GO FOR SSL(AD) NODE @DY46287 01173000
         AIF   (T'&ISHOSTNM NE 'O').MBUF04 GO FOR SSL(NM) NODE @DY46287 01174000
         AIF   (T'&IPHOSTNM NE 'O').MBUF04 GO FOR TCP(NM) NODE @DY46287 01175000
.*                                                             @DY46287 01193000
&MAX(1)  SETA  255                 MAX VALUE INPUT BUFFERS     @DY46287 01194000
&MAX(2)  SETA  255                 MAX VALUE OUTPUT BUFFERS    @DY46287 01195000
.*                                                             @DY46287 01196000
.MBUF04  ANOP                                                  @DY46287 01167000
         AIF   (N'&MAXBUF EQ 0).MBUF60     OMITTED ?                    01197000
         AIF   (N'&MAXBUF GT 2).MBUF50     MAX 2 ENTRIES                01198000
&WL      SETA  1                   INIT LOOP COUNTER                    01199000
.MBUF10  ANOP                                                           01200000
         AIF   (T'&MAXBUF(&WL) EQ 'O').MBUF40  OMITTED ?                01201000
         AIF   (T'&MAXBUF(&WL) NE 'N').MBUF20  IS NUMERIC ?             01202000
         AIF   (&MAXBUF(&WL) LT &MIN(&WL)).MBUF20 VALUE LT MIN          01203000
         AIF   (&MAXBUF(&WL) LE &MAX(&WL)).MBUF30 VALUE GT MAX          01204000
.MBUF20  ANOP                                                           01205000
         SPACE 1                                                        01206000
         MNOTE 3,' INVALID MAXBUF &MAXBUF(&WL), DEFAULT ASSUMED'        01207000
         SPACE 1                                                        01208000
         AGO   .MBUF40             AND CONTINUE                         01209000
.MBUF30  ANOP                                                           01210000
&BF(&WL) SETA  &MAXBUF(&WL)        SET BUFFER NUMBER                    01211000
.MBUF40  ANOP                                                           01212000
&WL      SETA  &WL+1               ADD ONE TO LOOP COUNTER              01213000
         AIF   (N'&MAXBUF GE &WL).MBUF10  LOOP TILL ALL CHECKED         01214000
         AGO   .MBUF60             IT IS OK, BRANCH                     01215000
.MBUF50  ANOP                                                           01216000
         SPACE 1                                                        01217000
         MNOTE 3,' INVALID MAXBUF SPECIFICATION, DEFAULT ASSUMED'       01218000
         SPACE 1                                                        01219000
.MBUF60  ANOP                                                           01220000
.*                                                                      01221000
.********************************************************************** 01222000
.*             CHECK BUFSIZE SPECIFICATION                            * 01223000
.********************************************************************** 01224000
.*                                                                      01225000
.*       THE PARAMETER IS OPTIONAL, IGNORED FOR LOCAL ENTRY.   @D65CDAT 01226000
.*       THE BUFSIZE PARAMETER SPECIFIES THE SIZE IN BYTES OF           01227000
.*       EACH VSE/POWER PNET BUFFER. THE VALUE CAN BE FROM              01228000
.*       300 TO 32000 BYTES, IT WILL BE ROUNDED UP TO THE NEXT @D65CDAT 01229000
.*       MULTIPLE OF 2.                                                 01230000
.*       IF THE PARAMETER IS OMITTED, A DEFAULT OF 1112 IS SET.@D65CDAT 01231000
.*       THE FOLLOWING EXCEPTIONS EXIST ...                    @D65CDAT 01232000
.*        - FOR A BSC/CTCA LINE THE MAXIMUM IS 4000 BYTES      @D65CDAT 01233000
.*        - FOR A TCP LINK, THE DEFAULT IS 4096 BYTES          @D65CDAT 01234000
.*        - FOR A SSL LINK, THE DEFAULT IS 4096 BYTES          @D66CDAT 01235000
.*                                                                      01236000
         AIF   (&LOC).BUFS20           IGNORE FOR LOCAL ENTRY  @D65CDAT 01237000
.*                                                                      01238000
&BSZ     SETA  4096                    SET TCP & SSL DEFAULT   @D65CDAT 01239000
         AIF   (T'&IPHOSTAD NE 'O').BUFS04 GO FOR TCP(AD) NODE @D65CDAT 01240000
         AIF   (T'&ISHOSTAD NE 'O').BUFS04 GO FOR SSL(AD) NODE @D66CDAT 01241000
         AIF   (T'&ISHOSTNM NE 'O').BUFS04 GO FOR SSL(NM) NODE @D66CDAT 01242000
         AIF   (T'&IPHOSTNM NE 'O').BUFS04 GO FOR TCP(NM) NODE @D65CDAT 01243000
&BSZ     SETA  1112                    SET CTC/BSC/SNA DEFAULT @D63PDAT 01244000
.*                                                                      01245000
.BUFS04  ANOP                                                  @D22PIPW 01246000
&I       SETA  32000                   SET MAX SNA/TCP/SSL LINK@D66CDAT 01247000
         AIF   (T'&APPLID NE 'O').BUFS06                       @D65CDAT 01248000
         AIF   (T'&IPHOSTAD NE 'O').BUFS06 GO FOR TCP(AD) NODE @D65CDAT 01249000
         AIF   (T'&IPHOSTNM NE 'O').BUFS06 GO FOR TCP(NM) NODE @D65CDAT 01250000
         AIF   (T'&ISHOSTAD NE 'O').BUFS06 GO FOR SSL(AD) NODE @D66CDAT 01251000
         AIF   (T'&ISHOSTNM NE 'O').BUFS06 GO FOR SSL(NM) NODE @D66CDAT 01252000
&I       SETA  4000                    SET MAX. BSC/CTC LINE   @D65CDAT 01253000
.BUFS06  ANOP                                                  @D65CDAT 01254000
         AIF   (T'&BUFSIZE EQ 'O').BUFS20  IF OMITTED, BRANCH           01255000
         AIF   (T'&BUFSIZE NE 'N').BUFS10  NUMERIC ?, YES, OK           01256000
         AIF   (&BUFSIZE GT &I).BUFS10 GREATER THAN MAXIMUM ?  @D22PIPW 01257000
         AIF   (&BUFSIZE LT 300).BUFS10    LESS THAN MINIMUM ?          01258000
&BSZ     SETA  ((&BUFSIZE-1)/2+1)*2    ROUND IT UP                      01259000
         AGO   .BUFS20                 AND CONTINUE                     01260000
         SPACE 1                                                        01261000
.BUFS10  ANOP                                                           01262000
         MNOTE 3,' INVALID BUFSIZE SPECIFICATION, DEFAULT ASSUMED'      01263000
         SPACE 1                                                        01264000
.BUFS20  ANOP                                                           01265000
.*                                                                      01266000
.********************************************************************** 01267000
.*             CHECK PORT SPECIFICATION                               * 01268000
.********************************************************************AT 01269000
.*                                                                      01270000
.*       THE PARAMETER IS OPTIONAL, ACCEPTED FOR THE LOCAL     @D65CDAT 01271000
.*       NODE AND FOR TCP LINKS.                               @D65CDAT 01272000
.*       THE PORT PARAMETER SPECIFIES FOR ...                  @D65CDAT 01273000
.*        - THE LOCAL NODE, THE TCP/IP PORT TO 'LISTEN' TO     @D65CDAT 01274000
.*          FOR INCOMING 'CONNECT' REQUESTS                    @D65CDAT 01275000
.*        - REMOTE NODES, THE TCP/IP PORT TO CONNECT TO ON     @D65CDAT 01276000
.*          THE FOREIGN HOST FOR CONTACTING THIS NJE NODE      @D65CDAT 01277000
.*       THE PORT PARAMETER COMES WITH UP TO 5 NUMERIC DIGITS, @D65CDAT 01278000
.*       AND SHOULD NOT SPECIFY A NUMBER GREATER THAN 32767.   @D65CDAT 01279000
.*       ITS DEFAULT IS 175.                                   @D65CDAT 01280000
.*       PORT PARAMETER SHOULD NOT BE 2252, WHICH IS DEFAULT   @D66QDAT 01281000
.*       FOR SPORT (SSL I.E. SECURED SOCKET PORT).             @D66CDAT 01282000
.*                                                                      01283000
         AIF   (&LOC).PORT10           PROCESS FOR LOCAL NODE  @D65CDAT 01284000
         AIF   (T'&IPHOSTAD NE 'O').PORT10 GO FOR TCP(AD) NODE @D65CDAT 01285000
         AIF   (T'&IPHOSTNM NE 'O').PORT10 GO FOR TCP(NM) NODE @D65CDAT 01286000
         AGO   .PORT90                 BYPASS FOR OTHERS       @D65CDAT 01287000
.*                                                                      01288000
.PORT10  ANOP                                                  @D65CDAT 01289000
.*                                                                      01290000
&HOPT    SETA  175                     SET PORT DEFAULT        @D65CDAT 01291000
         AIF   (T'&PORT EQ 'O').PORT90 IF OMITTED, USE DEFAULT @D65CDAT 01292000
         AIF   (T'&PORT NE 'N').PORT30 IF NOT NUMERIC, ERROR   @D65CDAT 01293000
         AIF   (K'&PORT GT 5).PORT40   IF < 5 DIGITS, ERROR    @D65CDAT 01294000
         AIF   (&PORT GT 32767).PORT50 IF TOO BIG VALUE, ERROR @D65CDAT 01295000
         AIF   (&PORT EQ 2252).PORT60  EQUAL DFLT. SPORT, ERROR@D66QDAT 01296000
&HOPT    SETA  &PORT                   ACCEPT SPECIFICATION    @D65CDAT 01297000
         AGO   .PORT90                 GO FOR NEXT PARAMETER   @D65CDAT 01298000
         SPACE 1                                                        01299000
.PORT30  ANOP                                                           01300000
         SPACE 2                                               @D65CDAT 01301000
         MNOTE 8,' PORT NOT NUMERIC, MACRO IGNORED'                     01302000
         SPACE 2                                               @D65CDAT 01303000
         MEXIT                                                 @D65CDAT 01304000
.PORT40  ANOP                                                           01305000
         SPACE 2                                               @D65CDAT 01306000
         MNOTE 8,' PORT MORE THAN 5 DIGITS, MACRO IGNORED'              01307000
         SPACE 2                                               @D65CDAT 01308000
         MEXIT                                                 @D65CDAT 01309000
.PORT50  ANOP                                                           01310000
         SPACE 2                                               @D65CDAT 01311000
         MNOTE 8,' PORT GREATER THAN 32767, MACRO IGNORED'              01312000
         SPACE 2                                               @D65CDAT 01313000
         MEXIT                                                 @D65CDAT 01314000
.PORT60  ANOP                                                           01315000
         SPACE 2                                               @D66CDAT 01316000
         MNOTE 8,' PORT EQUAL TO SPORT DEFAULT, MACRO IGNORED'          01317000
         SPACE 2                                               @D66CDAT 01318000
         MEXIT                                                 @D66CDAT 01319000
.*                                                                      01320000
.PORT90  ANOP                                                  @D65CDAT 01321000
.*                                                                      01322000
.********************************************************************** 01323000
.*             CHECK SPORT SPECIFICATION                              * 01324000
.********************************************************************AT 01325000
.*                                                                      01326000
.*       THE PARAMETER IS OPTIONAL, ACCEPTED FOR THE LOCAL     @D66CDAT 01327000
.*       NODE AND FOR SSL LINKS.                               @D66CDAT 01328000
.*       THE SPORT PARAMETER SPECIFIES FOR ...                 @D66CDAT 01329000
.*        - THE LOCAL NODE, THE TCP/IP SSL PORT TO 'LISTEN' TO @D66CDAT 01330000
.*          FOR INCOMING 'CONNECT' REQUESTS                    @D66CDAT 01331000
.*        - REMOTE NODES, THE TCP/IP SSL PORT TO CONNECT TO ON @D66CDAT 01332000
.*          THE FOREIGN HOST FOR CONTACTING THIS NJE NODE      @D66CDAT 01333000
.*       THE SPORT PARAMETER COMES WITH UP TO 5 NUMERIC DIGITS,@D66CDAT 01334000
.*       AND SHOULD NOT SPECIFY A NUMBER GREATER THAN 32767.   @D66CDAT 01335000
.*       ITS DEFAULT IS 2252.                                  @D66QDAT 01336000
.*       SPORT PARAMETER SHOULD NOT BE 175, WHICH IS DEFAULT   @D66CDAT 01337000
.*       FOR PORT (NON SECURED SOCKET PORT). ALSO, SPORT SHOULD@D66CDAT 01338000
.*       NOT BE EQUAL TO PORT.                                 @D66CDAT 01339000
.*                                                                      01340000
         AIF   (&LOC).SORT10           PROCESS FOR LOCAL NODE  @D66CDAT 01341000
         AIF   (T'&ISHOSTAD NE 'O').SORT10 GO FOR SSL(AD) NODE @D66CDAT 01342000
         AIF   (T'&ISHOSTNM NE 'O').SORT10 GO FOR SSL(NM) NODE @D66CDAT 01343000
         AGO   .SORT90                 BYPASS FOR OTHERS       @D66CDAT 01344000
.*                                                                      01345000
.SORT10  ANOP                                                  @D66CDAT 01346000
.*                                                                      01347000
&SOPT    SETA  2252                    SET SPORT DEFAULT       @D66QDAT 01348000
         AIF   (T'&SPORT EQ 'O').SORT90 IF OMITTED, USE DEFLT. @D66CDAT 01349000
         AIF   (T'&SPORT NE 'N').SORT30 IF NOT NUMERIC, ERROR  @D66CDAT 01350000
         AIF   (K'&SPORT GT 5).SORT40   IF < 5 DIGITS, ERROR   @D66CDAT 01351000
         AIF   (&SPORT GT 32767).SORT50 IF TOO BIG VALUE, ERR. @D66CDAT 01352000
         AIF   (&SPORT EQ 175).SORT60  EQUAL DFLT. PORT, ERROR @D66CDAT 01353000
         AIF   (&SPORT EQ &PORT).SORT70 SAME AS PORT, ERROR  @D66CDAT   01354000
&SOPT    SETA  &SPORT                  ACCEPT SPECIFICATION    @D66CDAT 01355000
         AGO   .SORT90                 GO FOR NEXT PARAMETER   @D66CDAT 01356000
         SPACE 1                                                        01357000
.SORT30  ANOP                                                           01358000
         SPACE 2                                               @D66CDAT 01359000
         MNOTE 8,' SPORT NOT NUMERIC, MACRO IGNORED'                    01360000
         SPACE 2                                               @D66CDAT 01361000
         MEXIT                                                 @D66CDAT 01362000
.SORT40  ANOP                                                           01363000
         SPACE 2                                               @D66CDAT 01364000
         MNOTE 8,' SPORT MORE THAN 5 DIGITS, MACRO IGNORED'             01365000
         SPACE 2                                               @D66CDAT 01366000
         MEXIT                                                 @D66CDAT 01367000
.SORT50  ANOP                                                           01368000
         SPACE 2                                               @D66CDAT 01369000
         MNOTE 8,' SPORT GREATER THAN 32767, MACRO IGNORED'             01370000
         SPACE 2                                               @D66CDAT 01371000
         MEXIT                                                 @D66CDAT 01372000
.SORT60  ANOP                                                           01373000
         SPACE 2                                               @D66CDAT 01374000
         MNOTE 8,' SPORT EQUAL TO PORT DEFAULT, MACRO IGNORED'          01375000
         SPACE 2                                               @D66CDAT 01376000
         MEXIT                                                 @D66CDAT 01377000
.SORT70  ANOP                                                           01378000
         SPACE 2                                               @D66CDAT 01379000
         MNOTE 8,' SPORT EQUAL TO PORT VALUE, MACRO IGNORED'            01380000
         SPACE 2                                               @D66CDAT 01381000
         MEXIT                                                 @D66CDAT 01382000
.*                                                                      01383000
.SORT90  ANOP                                                  @D66CDAT 01384000
.*                                                                      01385000
.********************************************************************** 01386000
.*        CHECK KEYRING SPECIFICATION (FOR LOCAL NODE)                * 01387000
.********************************************************************AT 01388000
.*                                                                      01389000
.*       THE KEYRING PARAMETER NAMES THE VSE/ESA LIB.SUBLIB    @D66CDAT 01390000
.*       USED AS KEY DATABASE FOR SECURED SOCKET LAYER (SSL)   @D66CDAT 01391000
.*       COMMUNICATIONS.                                       @D66CDAT 01392000
.*       KEYRING IS ONLY ACCEPTED FOR THE LOCAL NODE, AND HAS  @D66CDAT 01393000
.*       THE DEFAULT OF 'CRYPTO.KEYRING'.                      @D66CDAT 01394000
.*       KEYRING ACCEPTS AT MOST 16 DIGITS WITH AT MOST 7.8    @D66CDAT 01395000
.*       DIGITS FOR THE LIB AND SUBLIB SPECIFICATION WITH      @D66CDAT 01396000
.*       THEIR VSE DEFINED CHARACTER TYPES.                    @D66CDAT 01397000
.*                                                                      01398000
&LKEYR   SETC  ' '                 SET BLANK GENERATION        @D66CDAT 01399000
         AIF   (&LOC).KEYR10       IF LOCAL NODE GO AND ACCEPT @D66CDAT 01400000
         AIF   (T'&KEYRING NE 'O').KEYRER1  ERROR IF SPECIFIED @D66CDAT 01401000
         AGO   .KEYR90             GO FOR NEXT PARAMETER       @D66CDAT 01402000
.*                                                                      01403000
.KEYR10  ANOP                      PROCESS FOR LOCAL NODE      @D66CDAT 01404000
&LKEYR   SETC  'CRYPTO.KEYRING'    SET LOCAL DEFAULT           @D66CDAT 01405000
         AIF   (T'&KEYRING EQ 'O').KEYR90 GO FOR NEXT PARAMETER@D66CDAT 01406000
         AIF   (K'&KEYRING GT 16).KEYRER2   ERROR IF TOO LONG  @D66CDAT 01407000
.*                                                                      01408000
.*             --OPEN-- VSE-SPECIFIC CHECK OF LIB.SUBLIB       @D66CDAT 01409000
.*                                                                      01410000
&LKEYR   SETC  '&KEYRING'          ACCEPT SPECIFIED VALUE      @D66CDAT 01411000
         AGO   .KEYR90             GO FOR NEXT PARAMETER       @D66CDAT 01412000
.*                                                                      01413000
.KEYRER1 ANOP                                                  @D66CDAT 01414000
         SPACE 2                                               @D66CDAT 01415000
         MNOTE 8,' KEYRING INVALID FOR NON LOCAL NODE, MACRO IGNORED'   01416000
         SPACE 2                                               @D66CDAT 01417000
         MEXIT                                                 @D66CDAT 01418000
.*                                                                      01419000
.KEYRER2 ANOP                                                  @D66CDAT 01420000
         SPACE 2                                               @D66CDAT 01421000
         MNOTE 8,' KEYRING > 16 DIGITS, MACRO IGNORED'                  01422000
         SPACE 2                                               @D66CDAT 01423000
         MEXIT                                                 @D66CDAT 01424000
.*                                                                      01425000
.KEYR90  ANOP                      END OF KEYRING CHECKING     @D66CDAT 01426000
.*                                                                      01427000
.********************************************************************** 01428000
.*        CHECK DNAME SPECIFICATION (FOR LOCAL AND SSL NODES)         * 01429000
.********************************************************************AT 01430000
.*                                                                      01431000
.*       THE DNAME PARAMETER NAMES THE VSE/ESA LIB.SUBLIB MEMB.@D66CDAT 01432000
.*       USED AS ENCRYPTION KEY FOR THE SECURED SOCKET LAYER   @D66CDAT 01433000
.*       (SSL) COMMUNICATION.                                  @D66CDAT 01434000
.*       DNAME IS ACCEPTED FOR THE LOCAL NODE, AND OBTAINS THE @D66CDAT 01435000
.*       DEFAULT OF 'SAMPLE'.                                  @D66CDAT 01436000
.*       DNAME IS ACCEPTED FOR NON-LOCAL SSL NODES AND OBTAINS @D66CDAT 01437000
.*       AS DEFAULT THE KEY VALUE SPECIFIED FOR THE LOCAL NODE.@D66CDAT 01438000
.*       THIS IS GENERATED AS BLANK IN AN SSL PNODE ENTRY AND  @D66CDAT 01439000
.*       IS MADE EFFECTIVE AT NCB STARTUP TIME.                @D66CDAT 01440000
.*       DNAME ACCEPTS AT MOST 8 DIGITS FOR THE SUBLIB MEMBER  @D66CDAT 01441000
.*       NAME, WITH THE VSE CONVENTIONS FOR CHARACTER TYPE.    @D66CDAT 01442000
.*                                                                      01443000
&LKEYM   SETC  ' '                 SET BLANK GENERATION        @D66CDAT 01444000
         AIF   (&LOC).KEYM10       IF LOCAL NODE GO AND ACCEPT @D66CDAT 01445000
         AIF   (T'&ISHOSTAD NE 'O').KEYM06 ACCEPT FOR SSL NODE @D66CDAT 01446000
         AIF   (T'&ISHOSTNM NE 'O').KEYM06 ACCEPT FOR SSL NODE @D66CDAT 01447000
         AIF   (T'&DNAME NE 'O').KEYMER1    ERROR IF SPECIFIED @D66CDAT 01448000
         AGO   .KEYM90             GO FOR NEXT PARAMETER       @D66CDAT 01449000
.*                                                                      01450000
.KEYM06  ANOP                      PROCESS FOR SSL NODES       @D66CDAT 01451000
         AIF   (T'&DNAME NE 'O').KEYM16 CHECK SPECIFIED VALUE  @D66CDAT 01452000
         AGO   .KEYM90             GO WITH DEFAULT OF BLANK    @D66CDAT 01453000
.*                                                                      01454000
.KEYM10  ANOP                      PROCESS FOR ACCEPTED NODES  @D66CDAT 01455000
&LKEYM   SETC  'SAMPLE'            SET DEFAULT                 @D66CDAT 01456000
         AIF   (T'&DNAME EQ 'O').KEYM90 GO FOR NEXT PARAMETER  @D66CDAT 01457000
.*                                                                      01458000
.KEYM16  ANOP                      PROCESS FOR ACCEPTED NODES  @D66CDAT 01459000
         AIF   (K'&DNAME GT 8).KEYMER2  ERROR IF TOO LONG      @D66CDAT 01460000
.*                                                                      01461000
.*             --OPEN-- VSE-SPECIFIC CHECK OF SUBLIB MEMBER    @D66CDAT 01462000
.*                                                                      01463000
&LKEYM   SETC  '&DNAME'            ACCEPT SPECIFIED VALUE      @D66CDAT 01464000
         AGO   .KEYM90             GO FOR NEXT PARAMETER       @D66CDAT 01465000
.*                                                                      01466000
.KEYMER1 ANOP                                                  @D66CDAT 01467000
         SPACE 2                                               @D66CDAT 01468000
         MNOTE 8,' DNAME INVALID FOR NON SSL NODE, MACRO IGNORED'       01469000
         SPACE 2                                               @D66CDAT 01470000
         MEXIT                                                 @D66CDAT 01471000
.*                                                                      01472000
.KEYMER2 ANOP                                                  @D66CDAT 01473000
         SPACE 2                                               @D66CDAT 01474000
         MNOTE 8,' DNAME > 8 DIGITS, MACRO IGNORED'                     01475000
         SPACE 2                                               @D66CDAT 01476000
         MEXIT                                                 @D66CDAT 01477000
.*                                                                      01478000
.KEYM90  ANOP                      END OF DNAME CHECKING       @D66CDAT 01479000
.*                                                                      01480000
.********************************************************************** 01481000
.*        CHECK SECTYPE SPECIFCATION (LOCAL NODE)                     * 01482000
.********************************************************************AT 01483000
.*                                                                      01484000
.*       THE SECTYPE PARAMETER SPECIFIES THE TYPE OF SECURITY  @D66CDAT 01485000
.*       PROTOCOL TO BE REQUESTED FROM THE TCP/IP HOST FOR     @D66CDAT 01486000
.*       SSL COMMUNICATIONS.                                   @D66CDAT 01487000
.*       SECTYPE IS ACCEPTED ONLY FOR THE LOCAL NODE.          @D66CDAT 01488000
.*       SECTYPE HAS A DEFAULT OF 'SSL30' AND ALLOWS ONLY TO   @D66CDAT 01489000
.*       SPECIFY 'SSL30' OR 'TLS31'.                           @D66CDAT 01490000
.*       CSI DOES NOT YET SUPPORT 'TLS31' FOR A CLIENT         @DY45806 01491000
.*       'TLS31' DEFAULTS TO 'SSL30' AND MNOTE                 @DY45806 01492000
.*                                                                      01493000
&SSLTP   SETC  ' '                 SET BLANK GENERATION        @D66CDAT 01494000
         AIF   (&LOC).SSLT10       IF LOCAL NODE GO AND ACCEPT @D66CDAT 01495000
         AIF   (T'&SECTYPE NE 'O').SSLTER1  ERROR IF SPECIFIED @D66CDAT 01496000
         AGO   .SSLT90             GO FOR NEXT PARAMETER       @D66CDAT 01497000
.*                                                                      01498000
.SSLT10  ANOP                      PROCESS FOR LOCAL NODE      @D66CDAT 01499000
&SSLTP   SETC  'SSL30'             SET DEFAULT                 @D66CDAT 01500000
         AIF   (T'&SECTYPE EQ 'O').SSLT90   GO NEXT PARAMETER  @D66CDAT 01501000
         AIF   (K'&SECTYPE GT 8).SSLTER2    ERROR IF TOO LONG  @D66CDAT 01502000
         AIF   ('&SECTYPE' EQ 'SSL30').SSLT20  ACCEPT 'SSL30'  @D66CDAT 01503000
         AIF   ('&SECTYPE' EQ 'TLS31').SSLT30  ACCEPT 'TLS31'  @DY45806 01504000
         AGO   .SSLTER3            GO FOR ERROR                @D66CDAT 01505000
.*                                                                      01506000
.SSLT20  ANOP                                                  @D66CDAT 01507000
&SSLTP   SETC  '&SECTYPE'          ACCEPT SPECIFIED VALUE      @D66CDAT 01508000
         AGO   .SSLT90             GO FOR NEXT PARAMETER       @D66CDAT 01509000
.*                                                                      01510000
.SSLT30  ANOP                                                  @DY45806 01511000
         SPACE 2                                               @DY45806 01512000
         MNOTE 3,' TLS31 NOT YET SUPPORTED, SSL30 ASSUMED    ' @DY45806 01513000
         SPACE 2                                               @DY45806 01514000
         AGO   .SSLT90             GO FOR NEXT PARAMETER       @DY45806 01515000
.*                                                             @DY45806 01516000
.SSLTER1 ANOP                                                  @D66CDAT 01517000
         SPACE 2                                               @D66CDAT 01518000
         MNOTE 8,' SECTYPE ONLY ACCEPTED FOR LOCAL NODE, MACRO IGNORED' 01519000
         SPACE 2                                               @D66CDAT 01520000
         MEXIT                                                 @D66CDAT 01521000
.*                                                                      01522000
.SSLTER2 ANOP                                                  @D66CDAT 01523000
         SPACE 2                                               @D66CDAT 01524000
         MNOTE 8,' SECTYPE > 8 DIGITS, MACRO IGNORED'                   01525000
         SPACE 2                                               @D66CDAT 01526000
         MEXIT                                                 @D66CDAT 01527000
.*                                                                      01528000
.SSLTER3 ANOP                                                  @D66CDAT 01529000
         SPACE 2                                               @D66CDAT 01530000
         MNOTE 8,' SECTYPE - INVALID SPECIFICATION, MACRO IGNORED'      01531000
         SPACE 2                                               @D66CDAT 01532000
         MEXIT                                                 @D66CDAT 01533000
.*                                                                      01534000
.SSLT90  ANOP                      END OF SSLTYPE CHECKING     @D66CDAT 01535000
.*                                                                      01536000
.********************************************************************** 01537000
.*        CHECK ENCRYPT SPECIFICATION (FOR SSL NODES)                 * 01538000
.********************************************************************AT 01539000
.*                                                                      01540000
.*       THE ENCRYPT PARAMETER SPECIFIES THE ENCRYPTION LEVEL  @D66CDAT 01541000
.*       TO BE USED FOR SSL COMMUNICATIONS.                    @D66CDAT 01542000
.*       ENCRYPT IS ACCEPTED ONLY FOR NON-LOCAL SSL NODES, AND @D66CDAT 01543000
.*       HAS THE DEFAULT OF 'WEAK'.                            @D66CDAT 01544000
.*       ENCRYPT ACCEPTS AT MOST 6 DIGITS AND THE VALUES MAY   @D66CDAT 01545000
.*       BE 'WEAK' AND 'STRONG'.                               @D66CDAT 01546000
.*                                                                      01547000
         AIF   (T'&ISHOSTAD NE 'O').CRYP10 ACCEPT FOR SSL NODE @D66CDAT 01548000
         AIF   (T'&ISHOSTNM NE 'O').CRYP10 ACCEPT FOR SSL NODE @D66CDAT 01549000
         AIF   (T'&ENCRYPT NE 'O').CRYPER1  ERROR IF SPECIFIED @D66CDAT 01550000
         AGO   .CRYP90             GO FOR NEXT PARAMETER       @D66CDAT 01551000
.*                                                                      01552000
.CRYP10  ANOP                      PROCESS FOR ACCEPTED NODES  @D66CDAT 01553000
&FLG2    SETA  &FLG2+32            SET DEFAULT OF 'NORMAL'     @DY45806 01554000
         AIF   (T'&ENCRYPT EQ 'O').CRYP90   GO FOR NEXT PARM.  @D66CDAT 01555000
&FLG2    SETA  &FLG2-32            RE-SET DEFAULT              @DY45806 01556000
         AIF   (K'&ENCRYPT GT 6).CRYPER2    ERROR IF TOO LONG  @D66CDAT 01557000
         AIF   ('&ENCRYPT' NE 'WEAK').CRYP20 GO FOR STRONG     @DY45806 01558000
&FLG2    SETA  &FLG2+132           SET 'WEAK' FLAG             @DY45806 01559000
         AGO   .CRYP90             GO FOR NEXT PARAMETER       @DY45806 01560000
.*                                                                      01561000
.CRYP20  ANOP                      PROCESS FOR ACCEPTED NODES  @D66CDAT 01562000
         AIF   ('&ENCRYPT' NE 'STRONG').CRYP30  GO FOR NORMAL  @DY45806 01563000
&FLG2    SETA  &FLG2+64            SET 'STRONG' FLAG           @D66CDAT 01564000
         AGO   .CRYP90             GO FOR NEXT PARAMETER       @D66CDAT 01565000
.CRYP30  ANOP                      PROCESS FOR ACCEPTED NODES  @D66CDAT 01566000
         AIF   ('&ENCRYPT' NE 'NORMAL').CRYPER3  GO FOR ERROR  @DY45806 01567000
&FLG2    SETA  &FLG2+32            SET 'NORMAL' FLAG           @DY45806 01568000
         AGO   .CRYP90             GO FOR NEXT PARAMETER       @DY45806 01569000
.*                                                                      01570000
.CRYPER1 ANOP                                                  @D66CDAT 01571000
         SPACE 2                                               @D66CDAT 01572000
         MNOTE 8,' ENCRYPT ONLY ACCEPTED FOR SSL NODE, MACRO IGNORED'   01573000
         SPACE 2                                               @D66CDAT 01574000
         MEXIT                                                 @D66CDAT 01575000
.*                                                                      01576000
.CRYPER2 ANOP                                                  @D66CDAT 01577000
         SPACE 2                                               @D66CDAT 01578000
         MNOTE 8,' ENCRYPT > 6 DIGITS, MACRO IGNORED'                   01579000
         SPACE 2                                               @D66CDAT 01580000
         MEXIT                                                 @D66CDAT 01581000
.*                                                                      01582000
.CRYPER3 ANOP                                                  @D66CDAT 01583000
         SPACE 2                                               @D66CDAT 01584000
         MNOTE 8,' ENCRYPT - INVALID SPECIFICATION, MACRO IGNORED'      01585000
         SPACE 2                                               @D66CDAT 01586000
         MEXIT                                                 @D66CDAT 01587000
.*                                                                      01588000
.CRYP90  ANOP                      END OF ENCRYPT CHECKING     @D66CDAT 01589000
.*                                                                      01589005
.********************************************************************** 01589010
.*             CHECK IPEXTRAD SPECIFICATION                           * 01589015
.*******************************************************************HUS 01589020
.*                                                                      01589025
.*       THE IPEXTRAD PARAMETER SPECIFIES THE IP ADDRESS OF    @DY46046 01589030
.*       THE LOCAL NODE:                                       @DY46046 01589035
.*        - BY WHICH THE REMOTE NJE NODE SHOULD CONTACT THE    @DY46046 01589040
.*          LOCAL NODE                                         @DY46046 01589045
.*        - WHICH THE LOCAL NJE NODE SHOULD USE FOR NJE CONTROL@DY46046 01589050
.*          RECORDS SENT TO THE REMOTE NODE (INSTEAD OF USING  @DY46046 01589055
.*          THE VALUE RETRIEVED BY THE 'GETHOSTID' REQUEST).   @DY46046 01589060
.*       FOR THE LOCAL NODE, THE IPEXTRAD IS NOT ACCEPTED.     @DY46046 01589065
.*       FOR REMOTE NODES, IPEXTRAD IS ONLY ACCEPTED, IF ONE   @DY46046 01589070
.*       OF THE FOLLOWING PARAMETERS HAS BEEN SPECIFIED:       @DY46046 01589075
.*         - IPHOSTAD PARAMETER                                @DY46046 01589080
.*         - IPHOSTNM PARAMETER                                @DY46046 01589085
.*         - ISHOSTAD PARAMETER                                @DY46046 01589090
.*         - ISHOSTNM PARAMETER                                @DY46046 01589095
.*       WHEN ACCEPTED, IPEXTRAD SHOULD HAVE THE FORMAT OF A   @DY46046 01589100
.*       DOTTED DECIMAL TCP/IP ADDRESS AS FOLLOWS:             @DY46046 01589105
.*         0.0.0.0 --> 0.0.0.255 --> ... 255.255.255.255       @DY46046 01589110
.*       LEADING ZEROS E.G. 016.08.198.32 WILL BE ACCEPTED     @DY46046 01589115
.*                                                             @DY46046 01589120
         AIF   (T'&IPEXTRAD EQ 'O').IPEX90  IF OMITTED, BYPASS @DY46046 01589125
.*                                                             @DY46046 01589130
         AIF   (&LOC).IPEXER1      IF LOCAL NODE, ERROR        @DY46046 01589135
.*                                                             @DY46046 01589140
.IPEX00  ANOP                                                  @DY46046 01589145
         AIF   (T'&IPHOSTAD NE 'O').IPEX01  CONTINUE           @DY46046 01589150
         AIF   (T'&IPHOSTNM NE 'O').IPEX01  CONTINUE           @DY46046 01589155
         AIF   (T'&ISHOSTAD NE 'O').IPEX01  CONTINUE           @DY46046 01589160
         AIF   (T'&ISHOSTNM NE 'O').IPEX01  CONTINUE           @DY46046 01589165
         AGO   .IPEXER2            GO FOR ERROR                @DY46046 01589170
.*                                                             @DY46046 01589175
.IPEX01  ANOP                                                  @DY46046 01589180
         AIF   (K'&IPEXTRAD LT 7).IPEXER4  ERROR IF < 7 DIGITS @DY46046 01589185
         AIF   (K'&IPEXTRAD GT 15).IPEXER4 ERROR IF > 15 DIGITS@DY46046 01589190
.*                                                             @DY46046 01589195
&EXLN    SETA  K'&IPEXTRAD         RECORD SPECIFIED LENGTH     @DY46046 01589200
.*                                                             @DY46046 01589205
.*       REJECT DOTTED DECIMAL STARTING OR ENDING WITH DOT     @DY46046 01589210
.*                                                             @DY46046 01589215
         AIF   ('&IPEXTRAD'(1,1) EQ '.').IPEXER5  GO FOR ERROR @DY46046 01589220
         AIF   ('&IPEXTRAD'(&EXLN,1) EQ '.').IPEXER5  GO ERROR @DY46046 01589225
.*                                                             @DY46046 01589230
.*       REJECT DOTTED DECIMAL WITHOUT 3 DOTS                  @DY46046 01589235
.*                                                             @DY46046 01589240
&WL      SETA  0                   INIT DOT COUNTER            @DY46046 01589245
&I       SETA  1                   SET INDEX TO IPEXTRAD START @DY46046 01589250
.IPEX05  ANOP                                                  @DY46046 01589255
         AIF   (&I GT &EXLN).IPEX15   STOP WHEN ALL CHECKED    @DY46046 01589260
         AIF   ('&IPEXTRAD'(&I,1) NE '.').IPEX10  BYPASS NO DOT@DY46046 01589265
&WL      SETA  &WL+1               INCREMENT DOT COUNTER       @DY46046 01589270
.IPEX10  ANOP                                                  @DY46046 01589275
&I       SETA  &I+1                INCREMENT IPEXTRAD INDEX    @DY46046 01589280
         AGO   .IPEX05             GO AND CONTINUE CHECKING    @DY46046 01589285
.*                                                             @DY46046 01589290
.IPEX15  ANOP                                                  @DY46046 01589295
         AIF   (&WL NE 3).IPEXER6  FLAG ERROR, WRONG STRUCTURE @DY46046 01589300
.*                                                             @DY46046 01589305
.*       REJECT DOTTED DECIMAL WITH SUBSEQUENT DOTS            @DY46046 01589310
.*       NOTE: WE KNOW ALREADY, THAT THERE ARE 3 MIDDLE DOTS   @DY46046 01589315
.*                                                             @DY46046 01589320
&I       SETA  1                   SET INDEX TO IPEXTRAD START @DY46046 01589325
.IPEX20  ANOP                                                  @DY46046 01589330
         AIF   (&I GT &EXLN).IPEX30   STOP WHEN ALL CHECKED    @DY46046 01589335
         AIF   ('&IPEXTRAD'(&I,1) NE '.').IPEX25  BYPASS NO DOT@DY46046 01589340
         AIF   ('&IPEXTRAD'(&I+1,1) EQ '.').IPEXER7  GO ERROR  @DY46046 01589345
.IPEX25  ANOP                                                  @DY46046 01589350
&I       SETA  &I+1                INCREMENT IPEXTRAD INDEX    @DY46046 01589355
         AGO   .IPEX20             GO AND CONTINUE CHECKING    @DY46046 01589360
.*                                                             @DY46046 01589365
.IPEX30  ANOP                      GO WITH CORRECT DOT STRUCT. @DY46046 01589370
.*                                                             @DY46046 01589375
.*       CHECK INPUT CHARACTERS FOR BEING NUMERIC              @DY46046 01589380
.*                                                             @DY46046 01589385
&I       SETA  1                   START AT FIRST INPUT DIGIT  @DY46046 01589390
&WL      SETA  1                   START AT FIRST NUM-DIGIT    @DY46046 01589395
.IPEXPA  ANOP                                                  @DY46046 01589400
         AIF   (&I GT &EXLN).IPEXPD    DONE, INPUT IS NUMERIC  @DY46046 01589405
.IPEXPB  ANOP                                                  @DY46046 01589410
         AIF   ('&IPEXTRAD'(&I,1) EQ '&NUM'(&WL,1)).IPEXPC     @DY46046 01589415
&WL      SETA  &WL+1               BUMP TO NEXT DIGIT IN NUM   @DY46046 01589420
         AIF   (&WL GT 11).IPEXER8 NOT NUMERIC, GO FOR ERROR   @DY46046 01589425
         AGO   .IPEXPB             TRY NEXT DIGIT OF NUM TABLE @DY46046 01589430
.IPEXPC  ANOP                                                  @DY46046 01589435
&WL      SETA  1                   SET FOR START IN NUM TABLE  @DY46046 01589440
&I       SETA  &I+1                SET FOR NEXT INPUT CHAR.    @DY46046 01589445
         AGO   .IPEXPA             GO AND CHECK THIS CHARACTER @DY46046 01589450
.IPEXPD  ANOP                                                  @DY46046 01589455
.*                                                             @DY46046 01589460
.*                                                             @DY46046 01589465
.*       REJECT DOT-GROUPS THAT ARE LONGER THAN 3 DIGITS       @DY46046 01589470
.*       REJECT DOT-GROUPS THAT ARE GREATER 255                @DY46046 01589475
.*       PASS DOT GROUPS TO ARITHMETIC VARIABLE EXA(1-4)       @DY46046 01589480
.*                                                             @DY46046 01589485
.*                                                             @DY46046 01589490
&WL      SETA  1                   INIT DOT GROUP INDEX        @DY46046 01589495
&I       SETA  1                   SET INDEX TO IPEXTRAD START @DY46046 01589500
&S       SETA  1                   SET TO START OF DOT GROUP   @DY46046 01589505
.IPEX40  ANOP                                                  @DY46046 01589510
         AIF   ('&IPEXTRAD'(&I,1) NE '.').IPEX50  BYPASS NO DOT@DY46046 01589515
.*                                                             @DY46046 01589520
.IPEX44  ANOP                      ENTRY FOR LAST DOT GROUP    @DY46046 01589525
         AIF   (&I-&S GT 3).IPEXERA    IF TOO BIG GROUP, ERROR @DY46046 01589530
.*                                                             @DY46046 01589535
&HOGP    SETC  '&IPEXTRAD'(&S,&I-&S)   COPY DOT GROUP C-TYPE   @DY46046 01589540
&DGRP    SETA  &HOGP                   COPY DOT GROUP A-TYPE   @DY46046 01589545
         AIF   (&DGRP GT 255).IPEXER9  TOO BIG, GO FOR ERROR   @DY46046 01589550
&EXA(&WL) SETA  &HOGP                    SET BINARY ADDR. BYTE @DY46046 01589555
.*                                                             @DY46046 01589560
         AIF   (&I GT &EXLN).IPEX55  LEAVE CHECK LOOP FINALLY  @DY46046 01589565
.*                                                             @DY46046 01589570
&WL      SETA  &WL+1               INCREMENT DOT GROUP COUNTER @DY46046 01589575
&I       SETA  &I+1                INCREMENT IPEXTRAD INDEX    @DY46046 01589580
&S       SETA  &I                  SET TO START OF DOT GROUP   @DY46046 01589585
         AGO   .IPEX40             GO AND CONTINUE CHECKING    @DY46046 01589590
.IPEX50  ANOP                                                  @DY46046 01589595
&I       SETA  &I+1                INCREMENT IPEXTRAD INDEX    @DY46046 01589600
         AIF   (&I GT &EXLN).IPEX44  GO RESPECT LAST GOT GROUP @DY46046 01589605
         AGO   .IPEX40             GO AND CONTINUE CHECKING    @DY46046 01589610
.*                                                             @DY46046 01589615
.IPEX55  ANOP                                                  @DY46046 01589620
         AGO   .IPEX90             GO FOR NEXT PARAMETER       @DY46046 01589625
.*                                                             @DY46046 01589630
.IPEXER1 ANOP                                                  @DY46046 01589635
         SPACE 2                                               @DY46046 01589640
         MNOTE 8,' IPEXTRAD INVALID FOR LOCAL NODE, MACRO IGNORED'      01589645
         SPACE 2                                               @DY46046 01589650
         MEXIT                                                 @DY46046 01589655
.*                                                             @DY46046 01589660
.IPEXER2 ANOP                                                  @DY46046 01589665
         SPACE 2                                               @DY46046 01589670
         MNOTE 8,' IPEXTRAD FOR NON TCP/SSL NODE, MACRO IGNORED'        01589675
         SPACE 2                                               @DY46046 01589680
         MEXIT                                                 @DY46046 01589685
.*                                                             @DY46046 01589690
.IPEXER4 ANOP                                                  @DY46046 01589695
         SPACE 2                                               @DY46046 01589700
         MNOTE 8,' IPEXTRAD < 7 OR > 15 DIGITS, MACRO IGNORED' @DY46046 01589705
         SPACE 2                                               @DY46046 01589710
         MEXIT                                                 @DY46046 01589715
.*                                                             @DY46046 01589720
.IPEXER5 ANOP                                                  @DY46046 01589725
         SPACE 2                                               @DY46046 01589730
         MNOTE 8,' IPEXTRAD STARTING/ENDING WITH DOT, MACRO IGNORED'    01589735
         SPACE 2                                               @DY46046 01589740
         MEXIT                                                 @DY46046 01589745
.*                                                             @DY46046 01589750
.IPEXER6 ANOP                                                  @DY46046 01589755
         SPACE 2                                               @DY46046 01589760
         MNOTE 8,' IPEXTRAD NO STRUCTURE WITH 3 DOTS, MACRO IGNORED'    01589765
         SPACE 2                                               @DY46046 01589770
         MEXIT                                                 @DY46046 01589775
.*                                                             @DY46046 01589780
.IPEXER7 ANOP                                                  @DY46046 01589785
         SPACE 2                                               @DY46046 01589790
         MNOTE 8,' IPEXTRAD WITH SUBSEQUENT DOTS, MACRO IGNORED'        01589795
         SPACE 2                                               @DY46046 01589800
         MEXIT                                                 @DY46046 01589805
.*                                                             @DY46046 01589810
.IPEXER8 ANOP                                                  @DY46046 01589815
         SPACE 2                                               @DY46046 01589820
         MNOTE 8,' IPEXTRAD WITH NON-NUMERIC ADDRESS, MACRO IGNORED'    01589825
         SPACE 2                                               @DY46046 01589830
         MEXIT                                                 @DY46046 01589835
.*                                                             @DY46046 01589840
.IPEXER9 ANOP                                                  @DY46046 01589845
         SPACE 2                                               @DY46046 01589850
         MNOTE 8,'IPEXTRAD WITH DOT GROUP ADDRESS > 255, MACRO IGNORED' 01589855
         SPACE 2                                               @DY46046 01589860
         MEXIT                                                 @DY46046 01589865
.IPEXERA ANOP                                                  @DY46046 01589870
         SPACE 2                                               @DY46046 01589875
         MNOTE 8,'IPEXTRAD WITH DOT GROUP LONGER THAN 3, MACRO IGNORED' 01589880
         SPACE 2                                               @DY46046 01589885
         MEXIT                                                 @DY46046 01589890
.*                                                                      01589895
.IPEX90  ANOP                      END OF IPEXTRAD CHECKING    @DY46046 01589900
.*                                                                      01590000
.********************************************************************** 01591000
.*             CHECK AUTH SPECIFICATION                               * 01592000
.********************************************************************** 01593000
.*                                                                      01594000
.*       THE AUTH PARAMETER IS OPTIONAL AND SPECIFIES THE               01595000
.*       AUTHORITY GIVEN TO THAT PARTICULAR NODE.                       01596000
.*       VALID SPECIFICATION IS:                                        01597000
.*             JOB    -  NODE HAS OWNERSHIP CONTROL OVER JOBS           01598000
.*             NOJOB  -  NODE HAS NO CONTROL OVER JOBS                  01599000
.*             NET    -  NODE HAS ENOUGH AUTHORITY TO CONTROL SYSTEM    01600000
.*                       TYPE FUNCTION  (NETWORK)                       01601000
.*                                                                      01602000
.*       BASED ON THE SPECIFICATION ANY COMBINATION OF FOLLOWING        01603000
.*       BIT FLAGS WILL BE SET.                                         01604000
.*             X'F0'  -  SYSTEM AUTHORITY  (NOT USED, ONLY FOR LOCAL)   01605000
.*             X'50'  -  NODE HAS NETWORK AUTHORIZATION                 01606000
.*             X'20'  -  NODE CAN CONTROL DEVICES (NOT APPICABLE        01607000
.*                       FOR VSE/POWER)                                 01608000
.*             X'10'  -  NODE HAS OWNERSHIP CONTROL OVER JOBS           01609000
.*                                                                      01610000
.*       IF THE AUTH PARAMETER IS OMITTED, 'JOB' IS ASSUMED.            01611000
.*                                                                      01612000
.AUTH00  ANOP                                                           01613000
&AT      SETA  16                  INITIALIZE DEFAULT AUTH FLAGS        01614000
         AIF   (NOT &LOC).AUTH05   IF NOT LOCAL NODE                    01615000
&AT      SETA  240                 SET SYS AS DEFAULT FOR OWN NODE      01616000
.AUTH05  ANOP                                                           01617000
         AIF   (T'&AUTH EQ 'O').GENIT   IF OMITTED, USE DEFAULT         01618000
         AIF   ('&AUTH' EQ 'JOB').GENIT  THAT IS OK TOO                 01619000
         AIF   ('&AUTH' NE 'NOJOB').AUTH10  GO AND CHECK FOR 'NET'      01620000
&AT      SETA  0                   SET NOJOB AUTHORITY                  01621000
         AGO   .GENIT              AND CONTINUE MAINLINE                01622000
.AUTH10  ANOP                                                           01623000
         AIF   ('&AUTH' NE 'NET').AUTHE1    REPORT ERROR, IF NOT 'NET'  01624000
&AT      SETA  80                  SET SYSTEM AUTHORITY                 01625000
         AGO   .GENIT              AND CONTINUE                         01626000
.*                                                                      01627000
.AUTHE1 ANOP                                                            01628000
         SPACE 2                                                        01629000
         MNOTE 8,' AUTH SPECIFICATION INVALID, DEFAULT ASSUMED'         01630000
         SPACE 1                                                        01631000
.*                                                                      01632000
.********************************************************************** 01633000
.*             GENERATE NODE TABLE ENTRY                              * 01634000
.********************************************************************** 01635000
.*                                                                      01636000
.GENIT   ANOP                                                           01637000
&CNT     SETA  &CNT+1              ADD ONE TO NUMBER OF DEFINED NODES   01638000
         SPACE 1                                                        01639000
&NODE    DS    0H                                                       01640000
         DC    CL8'&NODE'          NODE NAME                            01641000
         DC    CL8'&PW'            PASSWORD ASSIGNED TO ABOVE NODE      01642000
         DC    AL1(&AT)            AUTHORIZATION FLAGS                  01643000
         DC    XL2'00'             RESERVED FOR FUTURE USE              01644000
         DC    AL1(&FLG)           FLAG BYTE                            01645000
         AIF   ('&APPL' EQ '').GENIT20   GEN PRIME ROUTE IF NO APPL     01646000
         DC    CL8'&APPL'          VTAM APPLICATION ID                  01647000
         AGO   .GENIT30            AND CONTINUE                         01648000
.GENIT20 ANOP                                                           01649000
         DC    CL8'&DEST1'         PRIME ROUTE                          01650000
.GENIT30 ANOP                                                           01651000
         DC    CL8'&DEST2'         ALTERNATE ROUTE                      01652000
         DC    AL2(&BSZ)           PNET BUFFERSIZE                      01653000
         DC    AL1(&BF(1))         MAX. NO OF INPUT BUFFERS             01654000
         DC    AL1(&BF(2))         MAX. NO JOB OUTPUT BUFFERS           01655000
         DC    AL2(&HOPT)          TCP/IP PORT NUMBER          @D65CDAT 01656000
         DC    AL2(&SOPT)          TCP/IP SPORT NUMBER         @D66CDAT 01657000
         DC    AL4(&HOLN)          LENGTH OF NDTHM VALUE       @D65CDAT 01658000
         DC    AL1(&IPA(1))        BYTE-1 BIN. TCP/IP ADDRESS  @D65CDAT 01659000
         DC    AL1(&IPA(2))        BYTE-2 BIN. TCP/IP ADDRESS  @D65CDAT 01660000
         DC    AL1(&IPA(3))        BYTE-3 BIN. TCP/IP ADDRESS  @D65CDAT 01661000
         DC    AL1(&IPA(4))        BYTE-4 BIN. TCP/IP ADDRESS  @D65CDAT 01662000
         DC    CL255'&HONM'        DOTTED OR SYMBOLIC HOST NAME@D65CDAT 01663000
         DC    AL1(&FLG2)          FLAG BYTE 2                 @D66CDAT 01664000
         DC    AL4(0)              TIME STAMP FOR MSG 1RC6I    @D66CDAT 01665000
         DC    AL4(0)              DOM-ID FOR A-TYPE MSG       @D66CDAT 01666000
         DC    AL1(&EXA(1))        BYTE-1 BIN. EXTERN IP ADDR  @DY46046 01667190
         DC    AL1(&EXA(2))        BYTE-2 BIN. EXTERN IP ADDR  @DY46046 01667380
         DC    AL1(&EXA(3))        BYTE-3 BIN. EXTERN IP ADDR  @DY46046 01667570
         DC    AL1(&EXA(4))        BYTE-4 BIN. EXTERN IP ADDR  @DY46046 01667760
         DC    CL8'&SSLTP'         SSL TYPE OF SECURITY PROTOC.@D66CDAT 01668000
         DC    CL16'&LKEYR'        LIB.SUBLIB SSL KEY DATABASE @D66CDAT 01669000
         DC    CL8'&LKEYM'         DNAME KEY-MEMBER IN DATABASE@D66CDAT 01670000
*                                  .. BLANK, IF DNAME OF LOCAL @D66CDAT 01671000
         DC    XL28'00'            RESERVED                    @D66CDAT 01672000
         SPACE 2                                                        01673000
.*                                                                      01674000
.*       THE FOLLOWING CODE OVERWRITES THE ALREADY BUILT TABLE-         01675000
.*       HEADER WITH THE NEW INFORMATION.                               01676000
.*                                                                      01677000
         AIF   (&FIRST).GENIT80    BRANCH IF FIRST TIME THROUGH         01678000
         ORG   &HDR                RESET TO HEADER AREA                 01679000
         DC    A(&NODE)            ADDRESS OF FIRST NODE ENTRY          01680000
         AGO   .GENIT85                                                 01681000
.GENIT80 ANOP                                                           01682000
         ORG   &HDR+4              RESET ORIGIN                         01683000
.GENIT85 ANOP                                                           01684000
         DC    AL2(&CNT)           NUMBER OF ENTRIES IN NDT TABLE       01685000
         AIF   (NOT &LOC).GENIT90                                       01686000
         ORG   &HDR+8              RESET ORIGIN                         01687000
         DC    A(&NODE)            ADDRESS OF OWN NODE ENTRY            01688000
.GENIT90 ANOP                                                           01689000
         ORG   ,                   PREVENT CODE BEING OVERRUN           01690000
         SPACE 3                                                        01691000
.DONE    ANOP                      IT IS DONE, LEAVE MACRO              01692000
&FIRST   SETB  1                   TURN ON FIRST TIME TROUGH SWITCH     01693000
         MEND                                                           01694000
*                                                                   */  01695000
*%PLSNDT:;                   /* VSE/POWER NETWORK DEFINITION TABLE  */  01696000
*/*******************************************************************/  01697000
*/*                                                                 */  01698000
*/* IBM DISK OPERATING SYSTEM                                       */  01699000
*/* VSE/POWER - 5686-CF7-03                                         */  01700000
*/* PNODE MACRO INSTRUCTION                                         */  01701000
*/*                                                                 */  01702000
*/* NETWORK DEFINITION TABLE                                        */  01703000
*/*                                                                 */  01704000
*/*******************************************************************/  01705000
*DECLARE                      /*                                    */  01706000
*1 NTH BASED(PNCBNDT) BDY(WORD),   /* HEADER FOR NDT                */  01707000
*  5 NTHSD  CHAR(16),         /* SECTION DESCRIPTOR                 */  01708000
*  5 NTHFE  PTR(31) ,         /* ADDR OF 1ST ENTRY IN TABLE         */  01709000
*  5 NTHNE  BIN(15) ,         /* NUMBER OF ENTRIES IN TABLE         */  01710000
*  5 NTHMX  BIN(15) ,         /* MAX. # TCP/IP SOCKET CALLS @D65CDAT*/  01711000
*  5 NTHOE  PTR(31) ,         /* ADDR OF OWN ENTRY IN TABLE         */  01712000
*  5 NTHVM  CHAR(4) ,         /* VERSION.RELEASE LEVEL              */  01713000
*  5 *       CHAR(2),         /* UNUSED                     @D65CDAT*/  01714000
*  5 *       CHAR(44),        /* COPYRIGHT INFORMATION      @D65CDAT*/  01715000
*  5 *       CHAR(50);        /* UNUSED                     @D65CDAT*/  01716000
*DECLARE                      /*                                    */  01717000
*1 NDTEN BASED(NDTPTR) BDY(WORD),  /* ENTRY IN NDT                  */  01718000
*  5 NDTNM   CHAR( 8),        /* NODE NAME                          */  01719000
*  5 NDTPW   CHAR( 8),        /* PASSWORD                           */  01720000
*  5 NDTAF   BIN(8)  ,        /* AUTHORITY FLAGS                    */  01721000
*  5 *       BIT(16) ,        /* RESERVED                           */  01722000
*  5 NDTF1   BIN(8)  ,        /* FLAG BYTE 1                        */  01723000
*   7 NDTLI  BIT(1)  ,        /* ADJACENT BSC/CTC NODE              */  01724000
*   7 NDTVA  BIT(1)  ,        /* SNA TYPE NODE                      */  01725000
*   7 NDTF1IA  BIT(1)  ,      /* INVALID SNA APPLID         @DY44263*/  01726000
*   7 NDTPA  BIT(1)  ,        /* TCP TYPE NODE              @D65CDAT*/  01727000
*   7 NDTF1IP  BIT(1),        /* INVALID TCP ADDRESS        @D65CDAT*/  01728000
*   7 NDTSA  BIT(1)  ,        /* SSL TYPE NODE              @D66CDAT*/  01729000
*   7 *      BIT(2)  ,        /* RESERVED                   @D66CDAT*/  01730000
*  5 NDTPR   CHAR( 8),        /* PRIME ROUTE, APPL, TCP-IND.@D65CDAT*/  01731000
*  5 NDTSR   CHAR( 8),        /* ALTERNATE ROUTE                    */  01732000
*  5 NDTBS   BIT(16) ,        /* PNET BUFFERSIZE                    */  01733000
*  5 NDTNI   BIN( 8) ,        /* MAX. NO OF INPUT BUFFERS           */  01734000
*  5 NDTNO   BIN( 8) ,        /* MAX. NO OF OUTPUT BUFFERS          */  01735000
*  5 NDTPT   BIT(16) ,        /* TCP/IP PORT NUMBER         @D65CDAT*/  01736000
*  5 NDTSPT  BIT(16) ,        /* TCP/IP SPORT NUMBER        @D66CDAT*/  01737000
*  5 NDTHML  BIN(32) ,        /* LENGTH OF NDTHM VALUE      @D65CDAT*/  01738000
*  5 NDTIPA1 BIN( 8) ,        /* BINARY IPADDR BYTE 1       @D65CDAT*/  01739000
*  5 NDTIPA2 BIN( 8) ,        /* BINARY IPADDR BYTE 2       @D65CDAT*/  01740000
*  5 NDTIPA3 BIN( 8) ,        /* BINARY IPADDR BYTE 3       @D65CDAT*/  01741000
*  5 NDTIPA4 BIN( 8) ,        /* BINARY IPADDR BYTE 4       @D65CDAT*/  01742000
*  5 NDTHM   CHAR(255),       /* DECIMAL OR SYMB. HOST NAME @D65CDAT*/  01743000
*  5 NDTF2   BIN(8)  ,        /* FLAG BYTE 2                @D66CDAT*/  01744000
*   7 NDT2CRL  BIT(1)  ,      /* ENCRYPT = LOW = WEAK       @D66CDAT*/  01745000
*   7 NDT2CRH  BIT(1)  ,      /* ENCRYPT = HIGH = STRONG    @D66CDAT*/  01746000
*   7 *      BIT(6)  ,        /* RESERVED                   @D66CDAT*/  01747000
*  5 NDTMSGTM BIN(32),        /* TIME STAMP FOR MSG         @D65CDHS*/  01748000
*  5 *        BIN(32),        /* DOM-ID FOR A-TYPE MSG      @D66CDHS*/  01749000
*  5 NDTIPEX  BIN(32),        /* EXTERNAL HOME IP ADDR      @DY46046*/  01750490
*  5 NDTSSLT CHAR(08),        /* SSL TYPE OF SECURITY PROT. @D66CDAT*/  01751000
*  5 NDTKEYR CHAR(16),        /* LIB.SUBLIB SSL KEY DATABASE@D66CDAT*/  01752000
*  5 NDTKEYM CHAR(08),        /* DNAME MEMBER IN DATABASE   @D66CDAT*/  01753000
*  5 *       CHAR(28);        /* RESERVED                   @D66CDAT*/  01754000
*DCL NDTPTR PTR(31),          /* PTR FOR ENTRY IN NDT               */  01755000
*    NCBLPTR PTR(31);         /* PTR FOR LOOP IN NCB-CHAIN          */  01756000
