.* IBM  DISK OPERATING SYSTEM                                           00050000
.* ISFMS - ISMOD3 - 5686-007-02-C440                           @U31TUJS 00100000
.* COPYRIGHT = THIS MACRO IS "RESTRICTED MATERIALS OF IBM"     @D41TDKY 00150000
.*             5686-007 (C) COPYRIGHT IBM CORP. 1977,1989      @U31TUJS 00200000
.*             ALL RIGHTS RESERVED                             @U31TUJS 00250000
.*             LICENSED MATERIALS - PROPERTY OF IBM            @U31TUJS 00300000
.*             SEE COPYRIGHT INSTRUCTIONS, G120-2083           @U31TUJS 00350000
* ISFMS - ISMOD3 - 5686-007-02-C440                            @U31TUJS 00400000
         AIF   (&SW(24)).FU             RDONLY SPECIFIED       @DL30SMP 00450000
IJHCSAVE DS    13F'0'                   SAVE AREA FOR USER'S REGISTERS. 00500000
.FU      ANOP                                                       3-3 00550000
IJHSDISP DC    H'4096'                 USED TO ESTABLISH SECOND     3-4 00600000
*                                         BASE REGISTER             3-4 00650000
         AIF   (NOT (&SW(2) OR &SW(4))).FX                          3-4 00700000
IJHAWRNK EQU   *                                               @DL30SMP 00750000
         AIF   (&SW(24)).FV             RDONLY SPECIFIED       @DL30SMP 00800000
         STM   2,14,IJHCSAVE            SAVE USER REGISTERS         3-4 00850000
         AGO   .FW                                                  3-4 00900000
.FV      ANOP                                                       3-4 00950000
         AIF   (NOT &SW(15)).FV1        RPS SUPPORT REQUIRED   @DL30SMP 01000000
         USING IJHVDTF,IJHREG13                                @DL30SMP 01050000
         LR    IJHREG15,IJHREG13        SAVE USER R13 IN R15   @DL30SMP 01100000
         L     IJHREG13,IJHCCCB+IJHVD8  GET ADDRESS OF THE     @DL30SMP 01150000
         LA    IJHREG13,IJHVD0(IJHREG13)  DTFIS EXTENSION      @DL30SMP 01200000
         ST    IJHREG15,IJHVUR13        SAVE USER REGISTER 13  @DL30SMP 01250000
         L     IJHREG15,IJHADDR         RESTORE BASE REGISTER  @DL30SMP 01300000
         AH    IJHREG13,IJHVC184        CALCULATE ADDR DTFIS   @DL30SMP 01350000
*                                       EXTENSION SAVE AREA    @DL30SMP 01400000
         DROP  IJHREG13                                        @DL30SMP 01450000
.FV1     ANOP                                                  @DL30SMP 01500000
         STM  2,14,0(13)               SAVE USER REGISTERS          3-4 01550000
         LR   0,13                      POINTER TO SAVE AREA        3-4 01600000
.FW      ANOP                                                       3-4 01650000
         LR    14,15                    ESTABLISH                   3-4 01700000
         AH    14,IJHSDISP                ADDRESSABILITY            3-4 01750000
         AIF   (NOT &SW(23)).FW1        ERREXT NE YES          @DL30SMP 01800000
         AIF   (NOT(&SW(2) OR &SW(4) OR &SW(8)OR &SW(10))).FW1 @DL30SMP 01850000
.*                                      BR IF RETRVE & SEQNTL  @DL30SMP 01900000
         NI    IJHCILN,X'7F'                                        3-8 01950000
.FW1     ANOP                                                       3-8 02000000
         B     IJHAWRKY                                             3-4 02050000
.FX      ANOP                                                       3-4 02100000
         AIF   (NOT (&SW(2) OR &SW(4) OR &SW(8) OR &SW(10))).F3     3-4 02150000
IJHCWATF EQU   *                                               @DL30SMP 02200000
         AIF   (NOT &SW(15)).FX1       RPS SUPPORT REQUIRED   @DL30SMP  02250000
         USING IJHVDTF,IJHREG13                                @DL30SMP 02300000
         LR    IJHREG15,IJHREG13       SAVE USER R13 IN R15    @DL30SMP 02350000
         L     IJHREG13,IJHCCCB+IJHVD8 GET ADDRESS OF THE      @DL30SMP 02400000
         LA    IJHREG13,IJHVD0(IJHREG13)  DTFIS EXTENSION      @DL30SMP 02450000
         ST    IJHREG15,IJHVUR13       SAVE USER REGISTER 13   @DL30SMP 02500000
         L     IJHREG15,IJHADDR        RESTORE BASE REGISTER   @DL30SMP 02550000
         AH    IJHREG13,IJHVC184       CALCULATE ADDR DTFIS    @DL30SMP 02600000
*                                      EXTENSION SAVE AREA     @DL30SMP 02650000
         DROP  IJHREG13                                        @DL30SMP 02700000
.FX1     ANOP                                                  @DL30SMP 02750000
         AIF   (&SW(23)).FZ                                         3-4 02800000
         AIF   (&SW(24)).FY             RDONLY SPECIFIED       @DL30SMP 02850000
         STM   2,14,IJHCSAVE            SAVE USER REGISTERS         3-4 02900000
         AGO   .F2                                                  3-4 02950000
.FY      ANOP                                                       3-4 03000000
         STM   2,14,0(13)               SAVE USER REGISTERS         3-4 03050000
         LR    0,13                     POINTER TO SAVE AREA        3-4 03100000
         AGO   .F2                                                  3-4 03150000
.FZ      ANOP                                                       3-4 03200000
         AIF   (&SW(24)).F0            RDONLY SPECIFIED        @DL30SMP 03250000
         STM   2,14,IJHCSAVE           SAVE USER REGISTER          3-10 03300000
         AGO   .F1                                                  3-4 03350000
.F0      ANOP                                                       3-4 03400000
         STM   2,14,0(13)              SAVE USER REGISTER          3-10 03450000
         LR    0,13                    SET RETURN ADDRESS      @DA01056 03500000
.F1      ANOP                                                       3-4 03550000
.F2      ANOP                                                       3-4 03600000
IJHCWATR EQU   *                                               @DL30SMP 03650000
         LR    14,15                    ESTABLISH                   3-4 03700000
         AH    14,IJHSDISP                ADDRESSABILITY            3-4 03750000
         B     IJHCWATB                                             3-4 03800000
.F3      ANOP                                                       3-4 03850000
         AIF   (NOT &SW(9)).GA                                      3-4 03900000
IJHSGETB EQU   *                                               @DL30SMP 03950000
         AIF   (&SW(24)).F4            RDONLY SPECIFIED        @DL30SMP 04000000
         STM   2,14,IJHCSAVE           SAVE USER REGISTERS          3-4 04050000
         AGO   .F5                                                  3-4 04100000
.F4      ANOP                                                       3-4 04150000
         AIF   (NOT &SW(15)).F41        RPS SUPPORT REQUIRED   @DL30SMP 04200000
         USING IJHVDTF,IJHREG13                                @DL30SMP 04250000
         LR    IJHREG15,IJHREG13        SAVE USER R13 IN R15   @DL30SMP 04300000
         L     IJHREG13,IJHCCCB+IJHVD8  GET ADDRESS OF THE     @DL30SMP 04350000
         LA    IJHREG13,IJHVD0(IJHREG13)  DTFIS EXTENSION      @DL30SMP 04400000
         ST    IJHREG15,IJHVUR13        SAVE USER REGISTER 13  @DL30SMP 04450000
         L     IJHREG15,IJHADDR         RESTORE BASE REGISTER  @DL30SMP 04500000
         AH    IJHREG13,IJHVC184        CALCULATE ADDR DTFIS   @DL30SMP 04550000
*                                       EXTENSION SAVE AREA    @DL30SMP 04600000
         DROP  IJHREG13                                        @DL30SMP 04650000
.F41     ANOP                                                  @DL30SMP 04700000
         STM   2,14,0(13)              SAVE USER REGISTERS          3-4 04750000
.F5      LR    14,15                   ESTABLISH                    3-4 04800000
         AH    14,IJHSDISP                ADDRESSABILITY            3-4 04850000
         B     IJHSGET                 GO TO GET ROUTINE            3-4 04900000
IJHSPUTB EQU   *                                               @DL30SMP 04950000
         AIF   (&SW(24)).F6            RDONLY SPEDIFIED        @DL30SMP 05000000
         STM   2,14,IJHCSAVE           SAVE USER REGISTERS          3-4 05050000
         AGO   .F7                                                  3-4 05100000
.F6      ANOP                                                       3-4 05150000
         AIF   (NOT &SW(15)).F61       RPS SUPPORT REQUIRED    @DL30SMP 05200000
         USING IJHVDTF,IJHREG13                                @DL30SMP 05250000
         LR    IJHREG15,IJHREG13       SAVE USER R13 IN R15    @DL30SMP 05300000
         L     IJHREG13,IJHCCCB+IJHVD8 GET ADDRESS OF THE      @DL30SMP 05350000
         LA    IJHREG13,IJHVD0(IJHREG13)  DTFIS EXTENSION      @DL30SMP 05400000
         ST    IJHREG15,IJHVUR13       SAVE USER REGISTER 13   @DL30SMP 05450000
         L     IJHREG15,IJHADDR        RESTORE BASE REGISTER   @DL30SMP 05500000
         AH    IJHREG13,IJHVC184       CALCULATE ADDR DTFIS    @DL30SMP 05550000
*                                      EXTENSION SAVE AREA     @DL30SMP 05600000
         DROP  IJHREG13                                        @DL30SMP 05650000
.F61     ANOP                                                  @DL30SMP 05700000
         STM   2,14,0(13)              SAVE USER REGISTERS          3-4 05750000
.F7      LR    14,15                   ESTABLISH                    3-4 05800000
         AH    14,IJHSDISP                ADDRESSABILITY            3-4 05850000
         B     IJHSPUT                 GO TO PUT ROUTINE            3-4 05900000
IJHESTLB EQU   *                                               @DL30SMP 05950000
         AIF   (&SW(24)).F8            RDONLY SPECIFIED        @DL30SMP 06000000
         STM   2,14,IJHCSAVE           SAVE USER REGISTERS          3-4 06050000
         AGO   .F9                                                  3-4 06100000
.F8      ANOP                                                       3-4 06150000
         AIF   (NOT &SW(15)).F81       RPS SUPPORT REQUIRED    @DL30SMP 06200000
         USING IJHVDTF,IJHREG13                                @DL30SMP 06250000
         LR    IJHREG15,IJHREG13       SAVE USER R13 IN R15    @DL30SMP 06300000
         L     IJHREG13,IJHCCCB+IJHVD8 GET ADDRESS OF THE      @DL30SMP 06350000
         LA    IJHREG13,IJHVD0(IJHREG13)  DTFIS EXTENSION      @DL30SMP 06400000
         ST    IJHREG15,IJHVUR13       SAVE USER REGISTER 13   @DL30SMP 06450000
         L     IJHREG15,IJHADDR        RESTORE BASE REGISTER   @DL30SMP 06500000
         AH    IJHREG13,IJHVC184       CALCULATE ADDR DTFIS    @DL30SMP 06550000
*                                      EXTENSION SAVE AREA     @DL30SMP 06600000
         DROP  IJHREG13                                        @DL30SMP 06650000
.F81     ANOP                                                  @DL30SMP 06700000
         STM   2,14,0(13)              SAVE USER REGISTERS          3-4 06750000
         LR    0,13                                                 3-6 06800000
.F9      LR    14,15                   ESTABLISH                    3-4 06850000
         AH    14,IJHSDISP                ADDRESSABILITY            3-4 06900000
         B     IJHSESTL                GO TO ESETL ROUTINE          3-4 06950000
.GA      ANOP                                                       3-4 07000000
.*   FOR NEITHER ADD NOR RANDOM RETRIEVE FUNCTIONS, SKIP TO SEQUENTIAL. 07050000
         AIF   (NOT &SW(8)).GI                                      3-4 07100000
IJHREADB EQU   *                                               @DL30SMP 07150000
         AIF   (&SW(24)).GB            RDONLY SPECIFIED        @DL30SMP 07200000
         STM   2,14,IJHCSAVE           SAVE USER REGISTERS          3-4 07250000
         AGO   .GC                                                  3-4 07300000
.GB      ANOP                                                       3-4 07350000
         AIF   (NOT &SW(15)).GB1       RPS SUPPORT REQUIRED    @DL30SMP 07400000
         USING IJHVDTF,IJHREG13                                @DL30SMP 07450000
         LR    IJHREG15,IJHREG13       SAVE USER R13 IN R15    @DL30SMP 07500000
         L     IJHREG13,IJHCCCB+IJHVD8 GET ADDRESS OF THE      @DL30SMP 07550000
         LA    IJHREG13,IJHVD0(IJHREG13)  DTFIS EXTENSION      @DL30SMP 07600000
         ST    IJHREG15,IJHVUR13       SAVE USER REGISTER 13   @DL30SMP 07650000
         L     IJHREG15,IJHADDR        RESTORE BASE REGISTER   @DL30SMP 07700000
         AH    IJHREG13,IJHVC184       CALCULATE ADDR DTFIS    @DL30SMP 07750000
*                                      EXTENSION SAVE AREA     @DL30SMP 07800000
         DROP  IJHREG13                                        @DL30SMP 07850000
.GB1     ANOP                                                  @DL30SMP 07900000
         STM   2,14,0(13)              SAVE USER REGISTERS          3-4 07950000
.GC      LR    14,15                   ESTABLISH                    3-4 08000000
         AH    14,IJHSDISP                ADDRESSABILITY            3-4 08050000
         AIF   (NOT &SW(23)).GD                                     3-7 08100000
         AIF   (NOT(&SW(2) OR &SW(4) OR &SW(8) OR &SW(10))).GD @DL30SMP 08150000
.*                                     BR IF RETRVE & SEQNTL   @DL30SMP 08200000
         NI    IJHCILN,X'7F'            TURN OFF WAITF INDICATOR    3-7 08250000
.GD      ANOP                                                       3-7 08300000
         B     IJHRREAD                GO TO RANDOM READ ROUTINE    3-4 08350000
IJHRWRTB EQU   *                                               @DL30SMP 08400000
         AIF   (&SW(24)).GE            RDONLY SPECIFIED        @DL30SMP 08450000
         STM   2,14,IJHCSAVE           SAVE USER REGISTERS          3-4 08500000
         AGO   .GF                                                  3-4 08550000
.GE      ANOP                                                       3-4 08600000
         AIF   (NOT &SW(15)).GE1       RPS SUPPORT REQUIRED    @DL30SMP 08650000
         USING IJHVDTF,IJHREG13                                @DL30SMP 08700000
         LR    IJHREG15,IJHREG13       SAVE USER R13 IN R15    @DL30SMP 08750000
         L     IJHREG13,IJHCCCB+IJHVD8 GET ADDRESS OF THE      @DL30SMP 08800000
         LA    IJHREG13,IJHVD0(IJHREG13)  DTFIS EXTENSION      @DL30SMP 08850000
         ST    IJHREG15,IJHVUR13       SAVE USER REGISTER 13   @DL30SMP 08900000
         L     IJHREG15,IJHADDR        RESTORE BASE REGISTER   @DL30SMP 08950000
         AH    IJHREG13,IJHVC184       CALCULATE ADDR DTFIS    @DL30SMP 09000000
*                                      EXTENSION SAVE AREA     @DL30SMP 09050000
         DROP  IJHREG13                                        @DL30SMP 09100000
.GE1     ANOP                                                  @DL30SMP 09150000
         STM   2,14,0(13)              SAVE USER REGISTERS          3-4 09200000
.GF      LR    14,15                   ESTABLISH                    3-4 09250000
         AH    14,IJHSDISP                ADDRESSABILITY            3-4 09300000
         B     IJHRWRT                 GO TO RANDOM WRITE ROUTINE   3-4 09350000
         AIF   (NOT &SW(11)).GI                                     3-9 09400000
IJHFREEB EQU   *                                               @DL30SMP 09450000
         AIF   (&SW(24)).GG            RDONLY SPECIFIED        @DL30SMP 09500000
         STM   IJHREG2,IJHREG14,IJHCSAVE SAVE USER REGS             3-9 09550000
         AGO   .GH                                                  3-9 09600000
.GG      ANOP                                                       3-9 09650000
         AIF   (NOT &SW(15)).GG1       RPS SUPPORT REQUIRED    @DL30SMP 09700000
         USING IJHVDTF,IJHREG13                                @DL30SMP 09750000
         LR    IJHREG15,IJHREG13       SAVE USER R13 IN R15    @DL30SMP 09800000
         L     IJHREG13,IJHCCCB+IJHVD8 GET ADDRESS OF THE      @DL30SMP 09850000
         LA    IJHREG13,IJHVD0(IJHREG13)  DTFIS EXTENSION      @DL30SMP 09900000
         ST    IJHREG15,IJHVUR13       SAVE USER REGISTER 13   @DL30SMP 09950000
         L     IJHREG15,IJHADDR        RESTORE BASE REGISTER   @DL30SMP 10000000
         AH    IJHREG13,IJHVC184       CALCULATE ADDR DTFIS    @DL30SMP 10050000
*                                      EXTENSION SAVE AREA     @DL30SMP 10100000
         DROP  IJHREG13                                        @DL30SMP 10150000
.GG1     ANOP                                                  @DL30SMP 10200000
         STM   IJHREG2,IJHREG14,0(IJHREG13) SAVE USER REGS          3-9 10250000
         LR    IJHREG0,IJHREG13        SAVE ADDR OF SAVE AREA       3-9 10300000
.GH      LR    IJHREG14,IJHREG15       ESTABLISH ADDRESSABILITY     3-9 10350000
         AH    IJHREG14,IJHSDISP                                    3-9 10400000
         TM    IJHCSTBY,IJHRDERR       ERROR ON READ                3-9 10450000
         BM    IJHSER2                 YES, EXIT                    3-9 10500000
         BAL   IJHREG4,IJHCINIT        INITIALIZE TABLE POINTERS    3-9 10550000
         MVC   IJHCSADR(IJHDL8),IJHRIDSV GET ID SAVED BY READ       3-9 10600000
         BAL   IJHREG10,IJHCMCAL       GET LOGICAL UNIT ADDR        3-9 10650000
         B     IJHSER2H                FREE AND EXIT TO USER        3-9 10700000
.GI      ANOP                                                       3-4 10750000
         AIF   ((NOT &SW(2)) AND (NOT &SW(8))).D5                   3-9 10800000
         AIF   (NOT &SW(21)).GO                                     3-9 10850000
IJHCXCOR LR    14,15                   ESTABLISH                    3-4 10900000
         AH    14,IJHSDISP                ADDRESSABILITY            3-4 10950000
         B     IJHXCOR                 BRANCH TO INDEX IN CORE ROUTI3-4 11000000
         AGO   .GN                                                  3-4 11050000
.GJ      ANOP                                                       3-4 11100000
*********************************************************************** 11150000
*NAME: SEARCH OF CORE INDEX.                                          * 11200000
*FUNCTION: TO SEARCH THE INDEX IN CORE, READING IN MORE OF THE        * 11250000
*          CYLINDER INDEX AS NECESSARY.                               * 11300000
*ENTRY POINT: 'IJHCXCOR'--SEARCH CORE INDEX.                          * 11350000
*INPUT: #1,#2,&#3 POINT TO DTF TABLES.                                * 11400000
*       #4 IS RETURN REGISTER.                                        * 11450000
*       #13 POINTS TO APPLICABLE KEY.                                 * 11500000
*       END OF INDEX BIT (X'40' IN CORE INDEX BYTE) WILL BE ON, IF    * 11550000
*           APPLICABLE.                                               * 11600000
*OUTPUT: FOR NORMAL EXIT, POINTER TO APPLICABLE TRACK INDEX WILL BE   * 11650000
*            IN DATA READ IN AREA.                                    * 11700000
*EXITS: NORMAL  --BR 4, RETURN TO CALLING ROUTINE.                    * 11750000
*       ABNORMAL--B 'IJHCEXWT', GO TO DO INDICES SEARCH; INDEX IN     * 11800000
*                 CORE NOT SPECIFIED, OR SUPPRESSED DUE TO            * 11850000
*                 INSUFFICIENT VACANCIES OR I/O ERROR CONDITION.      * 11900000
*EXTERNAL ROUTINES: NONE.                                             * 11950000
*REGISTER USE:#4 IS RETURN REGISTER.                                  * 12000000
*              #5 CONTAINS KEY LENGTH LESS ONE.                       * 12050000
*              #6 POINTS TO INDEX IN CORE KEYS.                       * 12100000
*              #7 CONTAINS KEY LENGTH PLUS SIX.                       * 12150000
*              #8 POINTS TO DATA READ IN AREA %10 BYTES<.             * 12200000
*              #9 POINTS TO LAST BYTE OF HIT KEY.                     * 12250000
*              #14 IS NOT USED, BUT AVAILABLE.                        * 12300000
*              #13 POINTS TO KEYARG.                                  * 12350000
*NOTES: INSUFFICIENT VACANCIES OR I/O ERRORS CAN SUPPRESS INDEX       * 12400000
*       IN CORE OPTION.                                               * 12450000
*********************************************************************** 12500000
IJHXCOR  TM    IJHCOPT,X'10'           IF NO INDEX IN CORE          3-4 12550000
         BZ    IJHCEXWT                   SPECIFIED, GO HERE.           12600000
         MVI   IJHCSTBY,X'00'           INITIALIZE STATUS BYTE.         12650000
         USING IJHCTBLX,10              ESTABLISH ADDRESSABILITY FOR    12700000
         LH    10,IJHNEG40                INDEX IN CORE PARAMETERS.     12750000
         AR    10,3                                                     12800000
         TM    IJHCORBT,X'80'           IF TRANSIENT HAS NOT BEEN       12850000
         BO    IJHCINDX                   CALLED FOR FIRST TIME, GO     12900000
*                                         HERE.                         12950000
         AIF   (NOT &SW(4)).GK          ADDRTR NOT SPECIFIED   @DL30SMP 13000000
         MVC   IJHCORKY,IJHCRKEY        MOVE KEY ADDRESS IN DTF     3-4 13050000
         TM    IJHCRTR,X'10'            READ ISSUED                 3-4 13100000
         BO    IJHCLKEY                 BRANCH IF YES               3-4 13150000
         MVC   IJHCORKY,IJHADKEY                                    3-4 13200000
.GK      ANOP                                                       3-4 13250000
IJHCLKEY L     6,IJHCORST               INITIALIZE POINTER TO CORE  3-4 13300000
*                                         INDEX ENTRIES.                13350000
         L     13,IJHCORKY                                          3-4 13400000
         OI    IJHCORBT,X'10'          SET CYL IND BIT              3-4 13450000
         LH    5,IJHCKYSZ               GET KEY LENGTH LESS ONE.        13500000
         BCTR  5,0                                                      13550000
         EX    5,IJHCCLC1               IF KEY IS NOT GREATER THAN      13600000
         BNH   IJHCEXWT                FIRST CORE INDEX, GO HERE    3-3 13650000
         NI    IJHCNTSW,X'FE'           TURN OFF SEEK SWITCH        3-4 13700000
         NI    IJHCORBT,X'EF'          SET CI BIT OFF,DON'T SRCH CI 3-4 13750000
         LA    7,7                      GET KEY LENGTH PLUS SIX.        13800000
         AR    7,5                                                      13850000
IJHCBUMP AR    6,7                      INCREMENT CORE INDEX POINTER.   13900000
         EX    5,IJHCCLC1               IF KEY IS HIGHER THAN ENTRY,    13950000
         BH    IJHCBUMP                   LOOP HERE.                    14000000
         AIF   (NOT &SW(15)).GK1       RPS NOT SPECIFIED       @DL30SMP 14050000
         ST    IJHREG6,IJHVTRS         SAVE REGISTER 6         @DL30SMP 14100000
         ICM   IJHREG6,IJHVM1,IJHCCCB+IJHVD9  SET BASE FOR EXT @DL30SMP 14150000
IJHCTRDX L     IJHREG8,IJHCCCW+IJHVD56 GET DATA ADDR WERE      @DL30SMP 14200000
*                                      BYTE POINTER TO TRACK   @DL30SMP 14250000
*                                      INDEX WILL BE PLACED.   @DL30SMP 14300000
         L     IJHREG6,IJHVTRS         RESTORE REGISTER 6      @DL30SMP 14350000
         AGO   .GK2                                            @DL30SMP 14400000
.GK1     ANOP                                                  @DL30SMP 14450000
IJHCTRDX L     8,IJHCCCW+48            GET DATA ADDR INTO WHICH 10  3-2 14500000
*                                         BYTE POINTER TO TRACK INDEX   14550000
*                                         WILL BE PLACED.               14600000
.GK2     ANOP                                                  @DL30SMP 14650000
         LR    9,6                      GET POINTER TO LAST BYTE OF     14700000
         AR    9,5                        KEY WHERE "HIT" OCCURRED.     14750000
         MVC   0(6,8),1(9)      MOVE PNTR FROM CORE INDEX.     @DA02102 14800000
         CLI   0(6),X'FF'               FOR HIT ON KEY OTHER THAN       14850000
         BNE   IJHCHRFP                   ALL F'S, GO HERE.             14900000
         LTR   5,5                      FOR KEYLEN=1,          @DA00126 14950000
         BZ    *+14                     BRANCH AROUND          @DA00126 15000000
         BCTR  5,0                                                      15050000
         EX    5,IJHCCLC2                                               15100000
         BNE   IJHCHRFP                                                 15150000
         MVC   6(4,8),7(9)             MOVE REST OF PNTR       @DM08068 15200000
         TM    IJHCORBT,X'40'           IF END OF INDEX SWITCH IS ON,   15250000
         BCR   1,4                        RETURN TO CALLING ROUTINE.    15300000
         AIF   (&SW(24)).GL             RDONLY SPECIFIED       @DL30SMP 15350000
IJHCINDX LR    0,1                      GET POINTER TO DTF TABLE #1.    15400000
         LA    1,IJHCCON2               GET POINTER TO TRANSIENT NAME.  15450000
         ST    13,IJHCORKY              STORE POINTER TO KEY.           15500000
         SVC   2                        FETCH TRANSIENT.                15550000
         LR    1,0                      RESTORE REGISTER 1.             15600000
         AGO   .GM                                                  3-3 15650000
.GL      ANOP                                                       3-3 15700000
IJHCINDX ST    13,IJHCORKY             STORE POINTER TO KEY         3-3 15750000
         LR    13,0                    POINTER TO SAVE AREA         3-3 15800000
         LR    0,1                     GET POINTER TO DTF TABLE #1  3-3 15850000
         LA    1,IJHCCON2          GET POINTER TO TRANSIENT NAME    3-3 15900000
         SVC   2                       FETCH TRANSIENT              3-3 15950000
         LR    1,0                     RESTORE REGISTER 1           3-3 16000000
         LR    0,13                    POINTER TO SAVE AREA         3-3 16050000
.GM      ANOP                                                       3-3 16100000
         B     IJHXCOR                 BRANCH                       3-4 16150000
         AGO   .D7                                                  3-4 16200000
.GN      ANOP                                                       3-4 16250000
*********************************************************************** 16300000
IJHCCLC1 CLC   0(0,13),0(6)                                             16350000
IJHCCLC2 CLC   0(0,6),1(6)                                              16400000
*********************************************************************** 16450000
IJHCHRFP MVC   6(4,8),IJHCCON1          SIMULATE "HRFP".                16500000
         BR    4                        RETURN TO CALLING ROUTINE.      16550000
*********************************************************************** 16600000
IJHCCON1 DC    X'00000107'              CONSTANT.                       16650000
IJHCCON2 DC    CL8'$$BINDEX'            CONSTANT.                       16700000
IJHNEG40 DC    H'-40'                   CONSTANT.                       16750000
*********************************************************************** 16800000
.GO      ANOP                                                       3-9 16850000
IJHCERCA MVC   IJHCSADR(7),IJHCMIS      MOVE HIGHEST LEVEL INDEX START  16900000
         TM    IJHCILN,X'02'              (MASTER OR CYLINDER) ADDRESS  16950000
         BO    *+10                       TO SEARCH ADDRESS.            17000000
IJHAA11  MVC   IJHCSADR(7),IJHCCIS                                      17050000
         BR    4                        RETURN.                         17100000
*********************************************************************** 17150000
*NAME: CCW BUILDER SUBROUTINE.                                        * 17200000
*FUNCTION: TO BUILD A CCW CHAIN.                                      * 17250000
*ENTRY POINTS: 'IJHCBLD1' FOR AN ADD.                                 * 17300000
*              'IJHCBLD2' FOR RANDOM RETRIEVAL.                       * 17350000
*INPUT: #4 CONTAINS POINTER TO CCW BUILDING STRING.                   * 17400000
*OUTPUT: #4 CONTAINS RETURN ADDRESS.                                  * 17450000
*EXIT: BR 4, RETURN TO CALLING ROUTINE.                               * 17500000
*EXTERNAL ROUTINES: NONE.                                             * 17550000
*REGISTER USE: #4 POINTS TO STRING.                                   * 17600000
*              #8 POINTS TO CCW BUILD AREA.                           * 17650000
*              #9 IS WORK REGISTER.                                   * 17700000
*              #10 POINTS TO LIST OF DATA AREA ADDRESSES.             * 17750000
*NOTES: NO REGISTERS ARE SAVED.                                       * 17800000
*********************************************************************** 17850000
*A STRING CONTAINS FOUR HEX NUMBERS:                                  * 17900000
*    1)OP-CODE OR TIC INDICATOR.                                      * 17950000
*    2)POINTER TO DATA AREA ADDRESS OR TIC POINTER.                   * 18000000
*    3)FLAGS (DATA CHAIN FLAG INDICATES A WRITE).                     * 18050000
*    4)RELATIVE POINTER TO RECORD LENGTH.                             * 18100000
*********************************************************************** 18150000
         AIF   (&SW(24)).GP        RDONLY SPECIFIED            @DL30SMP 18200000
IJHCRBD  DC    H'0'                WORK AREA IN 4 LOW ORDER BITS    3-3 18250000
.GP      ANOP                                                       3-3 18300000
* LOAD POINTER TO APPLICABLE LIST OF DATA AREA ADDRESSES.               18350000
         AIF   (&SW(3) AND NOT &SW(4)).GQ    IOROUT EQ RETRIEVE     3-2 18400000
IJHCBLD1 LA    10,IJHCILST                                              18450000
         AIF   (&SW(2) AND NOT &SW(4)).GR    IOROUT EQ ADD          3-2 18500000
         B     *+8                                                      18550000
.GQ      AIF   (&SW(2) AND NOT &SW(4)).GR    IOROUT EQ ADD          3-2 18600000
IJHCBLD2 LA    10,IJHCASAD                                              18650000
.GR      ANOP                                                       3-9 18700000
         AIF   (NOT &SW(15)).GR1       RPS NOT SPECIFIED       @DL30SMP 18750000
         ST    IJHREG6,IJHVTRS         SAVE REGISTER 6         @DL30SMP 18800000
         ICM   IJHREG6,IJHVM1,IJHCCCB+IJHVD9  SET BASE FOR EXT @DL30SMP 18850000
.GR1     ANOP                                                  @DL30SMP 18900000
         LA    8,IJHCCCW                LOAD POINTER TO CCW BUILD AREA. 18950000
         AIF   (&SW(24)).GS        RDONLY SPECIFIED            @DL30SMP 19000000
IJHCLOPX MVN   IJHCRBD+1(1),0(4)   GET BITS 4-7 FROM FIRST BYTE IN  3-3 19050000
         LH    9,IJHCRBD           CCW BUILD STRING (POINTER TO     3-3 19100000
         AGO   .GT                                                  3-3 19150000
.GS      ANOP                                                       3-3 19200000
IJHCLOPX LR    13,0                     POINT TO SAVE AREA          3-4 19250000
         L     0,68(13)                 SAVE REG 5                  3-4 19300000
IJHCLOPY SR    9,9                      ZERO TWO BYTES              3-4 19350000
         STH   9,70(13)                  OF WORK AREA               3-3 19400000
         MVN   71(1,13),0(4)       GET BITS 4-7 FROM FIRST BYTE IN  3-3 19450000
         LH    9,70(13)            CCW BUILD STRING (POINTER TO     3-3 19500000
.GT      ANOP                                                       3-3 19550000
         SLL   9,2                        DATA OR TIC POINTER) & *4.    19600000
         TM    0(4),X'F0'               GO TO TIC-ROUTINE IF            19650000
         BZ    IJHCTICR                   APPLICABLE.                   19700000
         AIF   (NOT &SW(15)).GT1        RPS NOT SPECIFIED      @DL30SMP 19750000
         BO    IJHVBLDC                 RPS CCW                @DL30SMP 19800000
IJHCNRPS EQU   *                                               @DL30SMP 19850000
.GT1     ANOP                                                  @DL30SMP 19900000
         L     9,0(9,10)                PICK UP DATA AREA ADDRESS.      19950000
IJHCSTRE ST    9,0(8)                   STORE DATA ADDRESS IN CCW.      20000000
         LH    9,0(4)                   PICK UP BITS 0-3 FROM FIRST     20050000
         SLL   9,16                       BYTE IN CCW BUILD STRING      20100000
         SRL   9,28                       (OP-CODE INDICATOR).          20150000
         IC    9,IJHCSTRI(9)            GET OP-CODE FROM OP-STRING.     20200000
         STC   9,0(8)                   STORE OP-CODE IN CCW.           20250000
         MVI   4(8),X'00'             ZERO FLAG BYTES               3-6 20300000
         MVZ   4(1,8),1(4)              MOVE FLAG BITS TO CCW.          20350000
         AIF   (&SW(24)).GU             RDONLY SPECIFIED       @DL30SMP 20400000
         MVN   IJHCRBD+1(1),1(4)        GET BITS 4-7 FROM BYTE 2 IN CCW 20450000
         LH    9,IJHCRBD                  BUILD STRING ANG MULTIPLY BY  20500000
         AR    9,9                        2.                            20550000
         AGO   .GV                                                  3-3 20600000
.GU      ANOP                                                       3-3 20650000
         MVN   71(1,13),1(4)       GET BITS 4-7 FROM BYTE 2 IN CCW  3-3 20700000
         LH    9,70(13)                  BUILD STRING AND MULTIPLY  3-3 20750000
         AR    9,9                         BY 2.                    3-3 20800000
.GV      ANOP                                                       3-3 20850000
         LH    9,IJHCRESZ(9)            GET DATA LENGTH AND PLACE IN    20900000
         STH   9,6(8)                     CCW.                          20950000
         TM    1(4),X'80'               IF OP-CODE IS A WRITE,          21000000
         BO    IJHCBH98                   GO HERE.                      21050000
IJHCE99  TM    1(4),X'40'               TEST FOR END OF STRING.         21100000
         LA    4,2(4)                   BUMP STRING POINTER BY 2.       21150000
         BC    7,IJHLEO1                IF END OF STRING            3-4 21200000
         AIF   (NOT &SW(24)).GW         RDONLY NOT SPECIFIED   @DL30SMP 21250000
         ST    0,68(13)                 RESTORE REG 5               3-4 21300000
         LR    0,13                     RESTORE REG 0               3-4 21350000
.GW      ANOP                                                       3-4 21400000
         AIF   (NOT &SW(15)).GW1       RPS NOT SPECIFIED       @DL30SMP 21450000
         L     IJHREG6,IJHVTRS         RESTORE REGISTER 6      @DL30SMP 21500000
.GW1     ANOP                                                  @DL30SMP 21550000
         BR    4                                                        21600000
IJHLEO1  LA    8,8(8)                   GET ADDR OF NEXT CCW            21650000
         AIF   (NOT &SW(24)).GX         RDONLY NOT SPECIFIED   @DL30SMP 21700000
         B     IJHCLOPY                                             3-4 21750000
         AGO   .GY                                                  3-4 21800000
.GX      ANOP                                                       3-4 21850000
         B     IJHCLOPX                                             3-4 21900000
.GY      ANOP                                                       3-4 21950000
IJHCTICR AR    9,8                      ADD CCW ADDRESS TO RELATIVE TIC 22000000
         SH    9,IJHCC32                  POINTER AND SUBTRACT 32.      22050000
         B     IJHCSTRE                 BRANCH TO STORE DATA ADDRESS.   22100000
IJHCC32  DC    H'32'                    CONSTANT.                       22150000
IJHCBH98 NI    4(8),X'7F'               TURN OFF DATA CHAINING BIT.     22200000
         TM    IJHCOPT,X'04'            IF VERIFY OPTION WAS NOT        22250000
         BO    IJHCE99                    SPECIFIED, TERMINATE COMMAND  22300000
         NI    4(8),X'3F'                 CHAINING.                     22350000
         B     IJHCE99                  BRANCH.                         22400000
         AIF   (NOT &SW(15)).GY1        RPS NOT SPECIFIED      @DL30SMP 22450000
         SPACE 2                                               @DL30SMP 22500000
*************************************************************  @DL30SMP 22550000
*                     BUILD RPS CCW'S                       *  @DL30SMP 22600000
*    THIS ROUTINE WILL DETERMINE IF THE DTF IS AN RPS       *  @DL30SMP 22650000
*    TYPE. IF IT IS NOT, NO RPS CCW'S WILL BE BUILT. IF     *  @DL30SMP 22700000
*    IT IS AN RPS TYPE DTF, A TEST WILL BE MADE TO SEE IF   *  @DL30SMP 22750000
*    THIS CCW CHAIN IS BEING BUILT FOR EITHER A MASTER      *  @DL30SMP 22800000
*    OR CYLINDER INDEX OPERATION. IF IT IS A TEST IS MADE   *  @DL30SMP 22850000
*    TO SEE IF THE INDEX DEVICE TYPE SUPPORTS RPS. IF IT    *  @DL30SMP 22900000
*    DOES NOT, THE CCW IS NOT BUILT. AFTER THE CCW IS BUILT *  @DL30SMP 22950000
*    THE SECTOR ARGUMENT FOR THE RECORD REQUIRED IS CALCU-  *  @DL30SMP 23000000
*    LATED IF NECESSARY.                                    *  @DL30SMP 23050000
*************************************************************  @DL30SMP 23100000
         SPACE 2                                               @DL30SMP 23150000
IJHVBLDC EQU   * .                                             @DL30SMP 23200000
         TM    IJHCILN,IJHVRPSF .       RPS DTF                @DL30SMP 23250000
         BNO   IJHVBLD7 .               NO, BUILD DUMMY CCW    @DA13542 23300000
         TM    IJHVD1(IJHREG4),IJHVMICI MI OR CI CCW CHAIN     @DL30SMP 23350000
         BNO   IJHVBLD1 .               NO, BUILD RPS CCW      @DL30SMP 23400000
         TM    IJHCILN,IJHVRPSI .       HI-INDEX DEV RPS TYPE  @DL30SMP 23450000
         BNO   IJHVBLD7 .               NO, BUILD DUMMY CCW    @DA13542 23500000
IJHVBLD1 EQU   *                                               @DL30SMP 23550000
         LA    IJHREG9,IJHVARG .        YES, CALCULATE SECTOR  @DL30SMP 23600000
         LA    IJHREG9,IJHVD0(IJHREG9) .ARGUMENT FIELD ADDRESS @DL30SMP 23650000
         AH    IJHREG9,IJHVD70(IJHREG13) .AND PUT IT           @DL30SMP 23700000
         ST    IJHREG9,IJHVD0(IJHREG8) .INTO THE CCW           @DL30SMP 23750000
         LA    IJHREG9,IJHVRSOC .       OBTAIN CCW             @DL30SMP 23800000
         MVN   IJHVD71(IJHVL1,IJHREG13),IJHVD1(IJHREG4) .      @DL30SMP 23850000
         AH    IJHREG9,IJHVD70(IJHREG13)  OP-CODE AND PLACE    @DL30SMP 23900000
         STC   IJHREG9,IJHVD0(IJHREG8) .IN CCW                 @DL30SMP 23950000
         LA    IJHREG9,IJHVC1 .         PUT LENGTH VALUE       @DL30SMP 24000000
         ST    IJHREG9,IJHVD4(IJHREG8) .IN CCW                 @DL30SMP 24050000
         OI    IJHVD4(IJHREG8),IJHVCCF .SET COMMAND CHAINING   @DL30SMP 24100000
* .                                     FLAG ON IN CCW         @DL30SMP 24150000
         CLI   IJHVD0(IJHREG8),IJHVRCCW READ SECTOR CCW        @DA03766 24200000
         BE    IJHVBLDR .               YES, BUILD NEXT CCW    @DA03766 24250000
         TM    IJHVD0(IJHREG4),IJHVSAF0 SECTOR ARG FIELD 0     @DL30SMP 24300000
         BZ    IJHVBLDR .               YES, BUILD NEXT CCW    @DL30SMP 24350000
         TM    IJHVD1(IJHREG4),IJHVSSC .SUPPRESS SECTOR CALUC. @DL30SMP 24400000
         BO    IJHVBLDR .               YES, BUILD NEXT CCW    @DL30SMP 24450000
         STM   IJHREG0,IJHREG1,IJHVWRK1 SAVE REGISTERS 0 & 1   @DL30SMP 24500000
         ICM   IJHREG0,IJHVM2,IJHCKYSZ+IJHVD1 .PUT KEY LENGTH  @DL30SMP 24550000
* .                                     IN PARAMETER REGISTER  @DL30SMP 24600000
         TM    IJHVD1(IJHREG4),IJHVMICI MI OR CI CCW CHAIN     @DL30SMP 24650000
         BNO   IJHVBLD2 .               NO, SET PD DEVICE CODE @DL30SMP 24700000
         ICM   IJHREG1,IJHVM3,IJHCHNDV .PUT HI-INDEX DEVICE    @DL30SMP 24750000
* .                                     TYPE CODE IN PARM REG  @DL30SMP 24800000
         B     IJHVBLD3 .               DETERMINE DATA FLD LTH @DL30SMP 24850000
IJHVBLD2 EQU   *                                               @DL30SMP 24900000
         ICM   IJHREG1,IJHVM3,IJHCPDDV .PUT PD DEVICE TYPE     @DL30SMP 24950000
* .                                     CODE IN PARM REG       @DL30SMP 25000000
IJHVBLD3 EQU   *                                               @DL30SMP 25050000
         TM    IJHVD1(IJHREG4),IJHVICC .INDEX CCW CHAIN        @DL30SMP 25100000
         BZ    IJHVBLD4 .               NO, PD OFL CCW CHAIN   @DL30SMP 25150000
         ICM   IJHREG0,IJHVM4,IJHCKYLC+IJHVD4 .PUT LENGTH      @DL30SMP 25200000
* .                                     INDEX DATA FIELD IN    @DL30SMP 25250000
* .                                     PARAMETER REGISTER     @DL30SMP 25300000
         B     IJHVBLD6 .               DETERMINE RECORD #     @DL30SMP 25350000
IJHVBLD4 EQU   *                                               @DL39SMP 25400000
         TM    IJHVD1(IJHREG4),IJHVPDOF PD OFL CCW CHAIN       @DL30SMP 25450000
         BNO   IJHVBLD5 .               NO, PUT BLKSIZE IN     @DL30SMP 25500000
* .                                     PARAMETER REGISTER     @DL30SMP 25550000
         ICM   IJHREG0,IJHVM4,IJHCRL10 .PUT RECORD SIZE + 10   @DL30SMP 25600000
* .                                     IN PARAMETER REGISTER  @DL30SMP 25650000
         B     IJHVBLD6 .               DETERMINE RECORD #     @DL30SMP 25700000
IJHVBLD5 EQU   *                                               @DL30SMP 25750000
         ICM   IJHREG0,IJHVM4,IJHCBLSZ .PUT BLKSIZE IN         @DL30SMP 25800000
* .                                     PARAMETER REGISTER     @DL30SMP 25850000
IJHVBLD6 EQU   *                                               @DL30SMP 25900000
         MVN   IJHVD71(IJHVL1,IJHREG13),IJHVD2(IJHREG4)        @DL30SMP 25950000
         LH    IJHREG9,IJHVD70(IJHREG13) .DETERMINE ADDRESS    @DL30SMP 26000000
         SLL   IJHREG9,IJHVS2 .         OF SEARCH ARGUMENT AND @DL30SMP 26050000
         L     IJHREG9,IJHVD0(IJHREG9,IJHREG10) .PUT RECORD    @DL30SMP 26100000
         ICM   IJHREG0,IJHVM5,IJHVD4(IJHREG9) .NUMBER IN       @DL30SMP 26150000
* .                                     PARAMETER REGISTER     @DL30SMP 26200000
         SVC   IJHSVC75 .               CALCULATE SECTOR ARG   @DL30SMP 26250000
         L     IJHREG9,IJHVD0(IJHREG8) .LOAD ADDR SEC ARG FLD  @DL30SMP 26300000
         STC   IJHREG0,IJHVD0(IJHREG9) .PUT SECTOR ARGUMENT    @DL30SMP 26350000
* .                                     INTO SECTOR ARG FIELD  @DL30SMP 26400000
         LM    IJHREG0,IJHREG1,IJHVWRK1 RESTORE REG'S 0 AND 1  @DL30SMP 26450000
IJHVBLDR EQU   *                                               @DL30SMP 26500000
         LA    IJHREG4,IJHVD2(IJHREG4)  POINT TO NEXT PARM.    @DL30SMP 26550000
         B     IJHLEO1                  BUILD NEXT CCW         @DL30SMP 26600000
IJHVBLD7 EQU   *                                               @DA13542 26650000
         LA    IJHREG7,8(8)             DATA ADDR IN DUMMY CCW @DA13542 26700000
         ST    IJHREG7,0(8)             STORE IN CCW           @DA13542 26750000
         MVI   0(8),X'08'               COMMAND CODE           @DA13542 26800000
         B     IJHVBLDR                 BUILD NEXT CCW         @DA13542 26850000
         SPACE 2                                               @DL30SMP 26900000
.GY1     ANOP                                                  @DL30SMP 26950000
IJHCSTRI DC    X'08060D1D1292296931E90E051E1AB1'                        27000000
*********************************************************************** 27050000
         AIF   (NOT &SW(8)).IE                                      3-9 27100000
IJHRG4   EQU   4                                                        27150000
IJHRG5   EQU   5                                                        27200000
IJHRG6   EQU   6                                                        27250000
IJHRG9   EQU   9                                                        27300000
IJHRG10  EQU   14                                                       27350000
IJHRG11  EQU   11                                                       27400000
IJHRG12  EQU   12                                                       27450000
IJHRG13  EQU   13                                                       27500000
         AGO   .HQ                                                  3-4 27550000
.GZ      ANOP                                                       3-4 27600000
*********************************************************************** 27650000
*NAME: RANDOM RETRIEVAL READ ROUTINE.                                 * 27700000
*FUNCTION: TO SEARCH MASTER, CYLINDER, AND TRACK INDICES.             * 27750000
*ENTRY POINT: 'IJHRREAD'.                                             * 27800000
*INPUT: #1 POINTS TO THE DTFIS TABLE.                                 * 27850000
*       #14 POINTS TO RETURN POINT.                                   * 27900000
*       #15 POINTS TO LOGIC MODULE.                                   * 27950000
*OUTPUT: TRACK INDEX SEARCH INITIALIZED.                              * 28000000
*EXITS: IF NEXT SEARCH IS OF A TRACK INDEX, BR 14, RETURN TO USER.    * 28050000
*       OTHERWISE, BRANCH TO NEXT ROUTINE.                            * 28100000
*EXTERNAL ROUTINES: 'IJHCINIT'--INITIALIZE DTFIS POINTERS.            * 28150000
*                   'IJHCBLD2'--CCW BUILDER.                          * 28200000
*                   'IJHCERCA'--GET INDEX START ADDRESS.              * 28250000
*                   'IJHCEXWT'--EXCP AND WAIT.                        * 28300000
*                   'IJHRESCO'--EXCP AND RETURN TO USER.              * 28350000
*REGISTER USE: #1,#2,#3 POINT TO DTFIS TABLES.                        * 28400000
*              #4 IS RETURN REGISTER & WORK REGISTER.                 * 28450000
*              #14 POINTS TO RETURN POINT.                            * 28500000
*              #15 POINTS TO LOGIC MODULE.                            * 28550000
*NOTES: USER'S REGISTERS ARE SAVED & RESTORED.                        * 28600000
*********************************************************************** 28650000
         AIF   (NOT &SW(11)).G0                                     3-9 28700000
         SVC   IJHSVC36                FREE HELD TRACK              3-9 28750000
         NI    IJHCILN,X'FF'-IJHNDXHD  CLEAR INDEX TRACK HELD BIT   3-9 28800000
.G0      ANOP                                                       3-9 28850000
IJHRREAD EQU   *                       RANDOM READ ROUTINE          3-4 28900000
         AIF   (NOT &SW(24)).G1        RDONLY NOT SPECIFIED    @DL30SMP 28950000
         LR    0,13                    POINTER TO SAVE AREA         3-3 29000000
.G1      ANOP                                                       3-3 29050000
         BAL   4,IJHCINIT               INITIALIZE POINTERS TO DTFIS.   29100000
         NI    IJHCRTR,X'CD'            TURN OVERFLOW SWITCH AND WRITE  29150000
         OI    IJHCRTR,X'10'              WAIT FLAG OFF, READ WAIT ON.  29200000
         BAL   IJHRG4,IJHCBLD2          BRANCH TO CCW BUILDER.          29250000
*MASTER OR CYLINDER INDEX SEARCH.                                       29300000
         DC    X'7461'                  SEARCH KEY EQUAL/HIGH.          29350000
* CCW CONTENTS: X'69', POINTER TO KEYARG, FLAGS 60, KEY LENGTH.         29400000
         AIF   (NOT &SW(15)).G11        RPS NOT SPECIFIED      @DL30SMP 29450000
         DC    X'0E6B'                  TIC TO *+24            @DL30SMP 29500000
* CCW CONTENTS  X'08', POINTER TO *+24, FLAGS 60, 5.           @DL30SMP 29550000
         DC    X'F081' .                SET SECTOR (ARG = 0)   @DL30SMP 29600000
* CCW CONTENTS: X'23', PTR TO SECTOR ARG, FLAGS 60, LNTH = 1 . @DL30SMP 29650000
         AGO   .G12                                            @DL30SMP 29700000
.G11     ANOP                                                  @DL30SMP 29750000
         DC    X'0C6B'                  TIC TO *+16.           @DA14282 29800000
* CCW CONTENTS: X'08', POINTER TO *+16, FLAGS 60, 5.           @DA14282 29850000
.G12     ANOP                                                  @DL30SMP 29900000
         DC    X'D17B'                  READ HOME ADDRESS.              29950000
* CCW CONTENTS: X'1A', 'IJHCBCKT', FLAGS 70, 5.                         30000000
         DC    X'536C'                 READ ID(M/T)  ***            3-4 30050000
* CCW CONTENT X'92','IOAREAR',FLAGS 60,10   ***                     3-4 30100000
         DC    X'7461'                  SEARCH KEY EQUAL/HIGH.          30150000
*CCW CONTENTS : X'69', POINTER TO KEYARG, FLAGS 60, KEY LENGTH.         30200000
         DC    X'046B'                  TIC TO *-16.                    30250000
* CCW CONTENTS: X'08', POINTER TO *-16, FLAGS 60, 05.                   30300000
         DC    X'110C'                  READ THE ADDRESS.               30350000
* CCW CONTENTS: X'06', 'IJHCBCKT', FLAGS 00, 10.                        30400000
IJHRSRCH BAL   4,IJHCERCA               MOVE INDEX START ADDRESS TO     30450000
*                                         SEARCH ADDRESS.               30500000
         CLC   IJHCCLPA(5),IJHCRTR+1   MBBCC OF FIRST/LAST PD =    3-9  30550000
         BNE   IJHNONUL                NO   BRANCH                  3-9 30600000
         CLC   IJHCCLPA+5(3),IJHCPNT+1 YES,HHR LESS THAN BEGIN      3-9 30650000
         BNL   IJHNONUL                NO,BRANCH                    3-9 30700000
         OI    IJHCSTBY,X'10'          YES, NULL FILE, POST NRF     3-9 30750000
         B     IJHSER2                 RETURN TO USER               3-9 30800000
IJHNONUL EQU  *                                                     3-9 30850000
         AIF   (NOT &SW(23)).G3                                     3-4 30900000
         LA    4,IJHCBCKT               IOAREA ADDRESS              3-4 30950000
         AIF   (&SW(24)).G2                                         3-4 31000000
         ST    4,IJHEWORK               SAVE IOAREA ADDRESS         3-4 31050000
         MVI   IJHEWORK,X'12'           INDICATE READ MASTER INDEX  3-4 31100000
         L     IJHRG13,IJHCRKEY         INITIALIZE POINTER TO KEYARG3-4 31150000
         TM    IJHCILN,X'02'            IF MASTER INDEX PRESENT,    3-4 31200000
         BO    *+8                        GO HERE                   3-4 31250000
IJHRCERC MVI   IJHEWORK,X'22'           INDICATE READ CYLINDER INDEX3-4 31300000
         OI    IJHCNTSW,X'01'          SET SEEK SWITCH  ***         3-4 31350000
         AGO   .G4                                                  3-4 31400000
.G2      ANOP                                                       3-4 31450000
         ST    4,44(13)                 SAVE IOAREA ADDRESS         3-4 31500000
         MVI   44(13),X'12'             INDICATE READ MASTER INDEX  3-4 31550000
         TM    IJHCILN,X'02'            IF MASTER INDEX PRESENT,    3-4 31600000
         BO    IJHRSKSW                     GO HERE                 3-9 31650000
IJHRCERC LR    IJHREG13,IJHREG0        RESTORE SAVE REGISTER        3-9 31700000
         MVI   IJHDL44(IJHREG13),IJHRCYLX IND READ CYLINDER INDEX   3-9 31750000
IJHRSKSW OI    IJHCNTSW,IJHSKSW        SET SEEK SWITCH              3-9 31800000
         L     IJHRG13,IJHCRKEY         INITIALIZE POINTER TO KEYARG3-4 31850000
         AGO   .G4                                                  3-4 31900000
.G3      ANOP                                                       3-4 31950000
         L     IJHRG13,IJHCRKEY         INITIALIZE POINTER TO KEYARG.   32000000
IJHRCERC OI    IJHCNTSW,X'01'          SET SEEK SWITCH  ***         3-4 32050000
.G4      ANOP                                                       3-4 32100000
         BAL   IJHRG4,IJHCXCOR         BRANCH TO MI/CI  SEARCH  **  3-4 32150000
         LR    13,0                                                3-10 32200000
IJHRCER1 TM    IJHCNTSW,IJHSKSW        NEED SEEK CHECK              3-9 32250000
         BZ    IJHRPIPO                NO,   ***                    3-4 32300000
         L     9,IJHCRARA              COUNT AREA FOR SEEK CHK ***  3-4 32350000
         BAL   4,IJHSKERR              TEST FOR OVER/UNDER SEEK     3-4 32400000
         AIF   (NOT &SW(24)).G5        RDONLY NOT SPECIFIED    @DL30SMP 32450000
         B     IJHRREAD+2   RE-EXECUTE CCW CHAIN                    3-7 32500000
         AGO   .G6                                                  3-7 32550000
.G5      ANOP                                                       3-7 32600000
         B     IJHRREAD   RE-EXECUTE CCW CHAIN                      3-7 32650000
.G6      ANOP                                                       3-7 32700000
         NI    IJHCNTSW,X'FE'          GOOD SEEK,TURN OFF SWITCH *  3-4 32750000
         TM    IJHCNTSW,X'80'          OVER/UNDER SWITCH ON        3-8  32800000
         BZ    IJHRPIPO                NO                  9999999 3-8  32850000
         LA    IJHREG4,IJHRCER1        RESTORE REGISTER 4           3-9 32900000
         B     IJHBUMP                 YES, RETURN TO FINISH WAIT  3-8  32950000
IJHRPIPO MVC   IJHCSADR(9),IJHCBCKT     MOVE IN NEXT INDEX ADDRESS.     33000000
         TM    IJHCSADR+8,X'F6'         IF NEXT SEARCH IS OF THE TRACK  33050000
         BZ    IJHRSALT                   INDEX, GO HERE.               33100000
IJHREXSL SR    IJHRG4,IJHRG4            GET INDEX ENTRY TYPE.           33150000
         IC    IJHRG4,IJHCSADR+8                                        33200000
         LTR   IJHRG4,IJHRG4            IF INDEX ENTRY TYPE IS NORMAL   33250000
         BZ    IJHRNORM                   UNSHARED TRACK, GO HERE.      33300000
         SRA   IJHRG4,2                 SHIFT OUT INDEX LEVEL.          33350000
         LH    IJHRG4,IJHRVCTR(IJHRG4)  GET ADDRESS OF NEXT ROUTINE.    33400000
         N     IJHRG4,IJHRCLEN            (ELIMINATE HIGH ORDER BITS).  33450000
