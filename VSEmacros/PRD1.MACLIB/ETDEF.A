*%/*                                                                    00048300
         MACRO                                                          00096600
&NAME    ETDEF &TYPE=,             INITIAL | ENTRY | SET | FINAL       *00144900
               &AKM=,              Authorization Key Mask              *00193200
               &ARR=,              Associated Recovery Routine Address *00241500
               &ASCMODE=,          PRIMARY | AR                        *00289800
               &ASYNCH=,           YES | NO                        @L2A*00338100
               &CANCEL=,           YES | NO                        @L2A*00386400
               &EAX=,              Extended Authorization index        *00434700
               &EK=,               Entry Key                           *00483000
               &EKM=,              Entry Key Mask                      *00531300
               &ETEADR=,           ENTRY address/name                  *00579600
               &HEADER=,           HEADER address/name                 *00627900
               &NUMETE=,           Number of entries                   *00676200
               &PARM1=,            User parameter 1                    *00724500
               &PARM2=,            User parameter 2                    *00772800
               &PC=,               STACKING | BASIC                    *00821100
               &PKM=,              OR | REPLACE                        *00869400
               &PROGRAM=,          Program name                        *00917700
               &RECORD=,           YES | NO                        @01A*00966000
               &ROUTINE=,          Routine address                     *01014300
               &RAMODE=,           Routine address AMODE           @D2A*01062600
               &SASN=,             OLD | NEW                           *01110900
               &SSWITCH=,          NO | YES  XM Space Switch           *01159200
               &STATE=,            PROBLEM | SUPERVISOR                *01207500
               &RELATED=           Any value                            01255800
         AGO   .SKIP                                                 */ 01304100
*/****  START OF SPECIFICATIONS  *************************************/ 01352400
*/*                                                                  */ 01400700
*/*01*  MACRO NAME = ETDEF                                           */ 01449000
*/*                                                                  */ 01497300
*/*01*  DESCRIPTIVE NAME = Entry Table Definition                    */ 01545600
*/*                                                                  */ 01593900
*/*01*  COPYRIGHT=                                                   */ 01642200
*/*         5685-001                                                 */ 01690500
*/*         THIS MACRO IS "RESTRICTED MATERIALS OF IBM"              */ 01738800
*/*         (C) COPYRIGHT IBM CORP. 1988                             */ 01787100
*/*         LICENSED MATERIALS - PROPERTY OF IBM                     */ 01835400
*/*                                                                  */ 01883700
*/*01*  STATUS =  HBB4430                                        @L2C*/ 01932000
*/*                                                                  */ 01980300
*/*01*  FUNCTION =                                                   */ 02028600
*/*       Define or set entry table entries.                         */ 02076900
*/*       ETDEF will create a FORMAT=1 Entry Table Descriptor        */ 02125200
*/*       or reset lists of entry table descriptors that will        */ 02173500
*/*       be used as input to the Entry Table Create process.        */ 02221800
*/*                                                                  */ 02270100
*/*02*    OPERATION =                                                */ 02318400
*/*         The ETDEF macro parses the keywords according to         */ 02366700
*/*         the TYPE parameter.  It will either initialize or        */ 02415000
*/*         set entries for the entry table entry.                   */ 02463300
*/*                                                                  */ 02511600
*/*         In the event of an error, syntax checking will attempt   */ 02559900
*/*         to continue for the remainder of the input. No data      */ 02608200
*/*         will be generated.                                       */ 02656500
*/*                                                                  */ 02704800
*/*01*  INPUT =  (BAL)                                               */ 02753100
*/*        TYPE=            INITIAL | ENTRY | FINAL | SET            */ 02801400
*/*                          Required, no default                    */ 02849700
*/*                                                                  */ 02898000
*/*               INITIAL  Specifies that an entry table descriptor  */ 02946300
*/*                        list is starting. The header for the      */ 02994600
*/*                        list will be generated.                   */ 03042900
*/*               ENTRY    Specifies that an entry table descriptor  */ 03091200
*/*                        is to be generated. Each entry in the     */ 03139500
*/*                        list must be within the scope of an       */ 03187800
*/*                        INITIAL - FINAL pair.                     */ 03236100
*/*               FINAL    Specifies that the entry table descriptor */ 03284400
*/*                        list is complete.                         */ 03332700
*/*               SET      Specifies that an entry table descriptor  */ 03381000
*/*                        or header is to be initialized or reset.  */ 03429300
*/*                                                                  */ 03477600
*/*                                                                  */ 03525900
*/*02*   INPUT when TYPE is INITIAL or FINAL                         */ 03574200
*/*                                                                  */ 03622500
*/*           ,RELATED=     Any value                                */ 03670800
*/*                                                                  */ 03719100
*/*                                                                  */ 03767400
*/*02*   INPUT when TYPE is ENTRY                                    */ 03815700
*/*                                                                  */ 03864000
*/*       ,AKM=             Authorization Key Mask. Required.        */ 03912300
*/*                          The AKM can be a single number or pair  */ 03960600
*/*                          of numbers (low:high) separated by a    */ 04008900
*/*                          colon to indicate a range. Multiple     */ 04057200
*/*                          ranges may be specified and parenthesis */ 04105500
*/*                          are optional.  Example:                 */ 04153800
*/*                             AKM=(2,(3),5:8,(10:12),15)  would    */ 04202100
*/*                             result in: B'0011011110111001'       */ 04250400
*/*                             or decimal: 14265.                   */ 04298700
*/*       ,PROGRAM=       1 Program name. Character string of        */ 04347000
*/*                          maximum length 8, optionally enclosed   */ 04395300
*/*                          in single quotation marks.              */ 04443600
*/*       ,ROUTINE=       1 Routine address. A-type address.         */ 04491900
*/*                                                                  */ 04540200
*/*           ,ARR=         Associated Recovery Routine Address.     */ 04588500
*/*           ,ASCMODE=     PRIMARY | AR                             */ 04636800
*/*           ,ASYNCH=,     YES | NO  Valid only with ARR            */ 04685100
*/*           ,CANCEL=,     YES | NO  Valid only with ARR (See NOTES)*/ 04733400
*/*           ,EAX=         Extended Authorization index. Halfword   */ 04781700
*/*                          decimal value (self-defining term).     */ 04830000
*/*           ,EK=          Entry Key. Decimal number or constant    */ 04878300
*/*                          from 0 -15.                             */ 04926600
*/*           ,EKM=         Entry Key Mask. See AKM. Required when   */ 04974900
*/*                          PKM=REPLACE.                            */ 05023200
*/*           ,PARM1=       User parameter 1. A-type address or      */ 05071500
*/*                          character string of maximum length 4,   */ 05119800
*/*                          enclosed in single quotation marks.     */ 05168100
*/*           ,PARM2=       User parameter 2. See PARM1              */ 05216400
*/*           ,PC=          STACKING | BASIC                         */ 05264700
*/*           ,PKM=         OR | REPLACE                             */ 05313000
*/*           ,RAMODE=      31 | 24  Valid only with ROUTINE.        */ 05361300
*/*           ,SASN=        OLD | NEW                                */ 05409600
*/*           ,SSWITCH=     NO | YES                                 */ 05457900
*/*           ,STATE=       PROBLEM | SUPERVISOR                     */ 05506200
*/*           ,RELATED=     Any value                                */ 05554500
*/*                                                                  */ 05602800
*/*                                                                  */ 05651100
*/*02*   INPUT when TYPE is SET and HEADER is to be changed          */ 05699400
*/*                                                                  */ 05747700
*/*       ,HEADER=          HEADER name. RX-address or register      */ 05796000
*/*                          (1) - (15).                             */ 05844300
*/*       ,NUMETE=          Number of entries.  Symbol, decimal      */ 05892600
*/*                          number (1 to 128), or register.         */ 05940900
*/*           ,RECORD=      YES | NO.   INTERNAL USE ONLY.           */ 05989200
*/*                                                                  */ 06037500
*/*           ,RELATED=     Any value                                */ 06085800
*/*                                                                  */ 06134100
*/*                                                                  */ 06182400
*/*02*   INPUT when TYPE is SET and ETEADR is to be changed          */ 06230700
*/*                                                                  */ 06279000
*/*       ,ETEADR=          ENTRY name. RX-address or register       */ 06327300
*/*                          (1) - (15).                             */ 06375600
*/*       ,AKM=             Authorization Key Mask. Required.        */ 06423900
*/*                          The AKM can be a single number or pair  */ 06472200
*/*                          of numbers (low:high) separated by a    */ 06520500
*/*                          colon to indicate a range. Multiple     */ 06568800
*/*                          ranges may be specified and parenthesis */ 06617100
*/*                          are optional.  Example:                 */ 06665400
*/*                             AKM=(2,(3),5:8,(10:12),15)  would    */ 06713700
*/*                             result in: B'0011011110111001'       */ 06762000
*/*                             or decimal: 14265.                   */ 06810300
*/*       ,PROGRAM=       1 Program name. Character string of        */ 06858600
*/*                          maximum length 8, optionally enclosed   */ 06906900
*/*                          in single quotation marks.              */ 06955200
*/*       ,ROUTINE=       1 Routine address. A-type address or       */ 07003500
*/*                          register.                               */ 07051800
*/*                                                                  */ 07100100
*/*           ,ARR=         Associated Recovery Routine Address.     */ 07148400
*/*                          A-type address or register, or quoted   */ 07196700
*/*                          character string of maximum length 8.   */ 07245000
*/*           ,ASCMODE=     PRIMARY | AR                             */ 07293300
*/*           ,ASYNCH=,     YES | NO  Valid only with ARR            */ 07341600
*/*           ,CANCEL=,     YES | NO  Valid only with ARR (See NOTES)*/ 07389900
*/*           ,EAX=         Extended Authorization index.            */ 07438200
*/*                          Halfword decimal value, or register.    */ 07486500
*/*           ,EK=          Entry Key. Decimal number or constant    */ 07534800
*/*                          from 0 -15.                             */ 07583100
*/*           ,EKM=         Entry Key Mask. See AKM. Required when   */ 07631400
*/*                          PKM=REPLACE.                            */ 07679700
*/*           ,PARM1=       User parameter 1. A-type address or      */ 07728000
*/*                          character string of maximum length 4,   */ 07776300
*/*                          enclosed in single quotation marks.     */ 07824600
*/*                          Register form may contain data.         */ 07872900
*/*           ,PARM2=       User parameter 2. See PARM1              */ 07921200
*/*           ,PC=          STACKING | BASIC                         */ 07969500
*/*           ,PKM=         OR | REPLACE                             */ 08017800
*/*           ,RAMODE=      31 | 24  Valid only with ROUTINE.        */ 08066100
*/*           ,SASN=        OLD | NEW                                */ 08114400
*/*           ,SSWITCH=     NO | YES                                 */ 08162700
*/*           ,STATE=       PROBLEM | SUPERVISOR                     */ 08211000
*/*           ,RELATED=     Any value                                */ 08259300
*/*                                                                  */ 08307600
*/*03*    NOTES =                                                    */ 08355900
*/*         -  The following are not valid with PC=BASIC:            */ 08404200
*/*             ARR, ASCMODE=AR, ASYNCH, CANCEL, EAX, EK,            */ 08452500
*/*             PKM=REPLACE, SASN=NEW                                */ 08500800
*/*         -  Mutually exclusive keywords are noted numerically.    */ 08549100
*/*         -  Default options are listed first. If a default is     */ 08597400
*/*            is not listed, the parameter will be given a value    */ 08645700
*/*            of zero.                                              */ 08694000
*/*         -  The EKM is required when STATE=PROBLEM and the EK     */ 08742300
*/*            is specified.                                         */ 08790600
*/*         -  When CANCEL=NO is specified, the PC routine must be   */ 08838900
*/*            in supervisor state (STATE=SUPERVISOR), or the EKM    */ 08887200
*/*            must contain a system key, or the AKM can only have   */ 08935500
*/*            system keys and PKM=OR.                               */ 08983800
*/*         -  If explicit register notation is specified, only      */ 09032100
*/*            registers (2) through (12) may be used, unless        */ 09080400
*/*            noted otherwise.                                      */ 09128700
*/*                                                                  */ 09177000
*/*                                                                  */ 09225300
*/*01*  NOTES =                                                      */ 09273600
*/*                                                                  */ 09321900
*/*02*    RESTRICTIONS = None                                        */ 09370200
*/*                                                                  */ 09418500
*/*02*    DEPENDENCIES =                                             */ 09466800
*/*                      If the offsets in the IHAETD mapping        */ 09515100
*/*                      macro change, the SETA symbols defined      */ 09563400
*/*                      under 'IHAETD offsets' in the BAL source    */ 09611700
*/*                      must also be changed respectively.          */ 09660000
*/*                                                                  */ 09708300
*/*03*      CHARACTER-CODE DEPENDENCIES= EBCDIC                      */ 09756600
*/*                                                                  */ 09804900
*/*01*  MODULE TYPE = BIL MACRO                                      */ 09853200
*/*                                                                  */ 09901500
*/*02*    PROCESSOR = ASSEMBLER-H  or  PLAS                          */ 09949800
*/*                                                                  */ 09998100
*/*02*    INVOCATION = See MACRO definition                          */ 10046400
*/*                                                                  */ 10094700
*/*01*  COMPONENT  =  SCXMS (PC/AUTH)                                */ 10143000
*/*                                                                  */ 10191300
*/*01*  DISTRIBUTION LIBRARY = AMACLIB                               */ 10239600
*/*                                                                  */ 10287900
*/**** END OF SPECIFICATIONS *****************************************/ 10336200
*/*                                                                     10384500
.*                                                                      10432800
.*   CHANGE ACTIVITY =                                                  10481100
.*      $L0=AR      HBB3310 851118 PD16LD: Access Registers             10529400
.*      $D1=DCR0006 HBB3310 851118 PD16LD: ARR in quotes                10577700
.*      $P1=PC40037 HBB3310 860404 PD16LD: Inconsistent error checking  10626000
.*                                         with PLAS version            10674300
.*      $P2=PC40042 HBB3310 860404 PD16LD: Null sublist is processed    10722600
.*      $P3=PC40157 HBB3310 860825 PD16LD: Change MNOTE text            10770900
.*      $P4=PC40345 HBB3310 861020 PD16LD: Negative EK value            10819200
.*      $L1=AR      HBB3310 870406 PD16LD: Access Registers             10867500
.*      $D2=DCR0248 HBB3310 870406 PD16LD: Make EKM optional and add    10915800
.*                                         RAMODE keyword               10964100
.*      $P5=PC41695 HBB3310 871123 PD16LD: EAX default is 0, not loc 0  11012400
.*      $L2=ARREN   JBB3311 880418 PD16LD: ARR Enhancement              11060700
.*      $D3=DCR0012 JBB3311 880418 PD16LD: EKM required with EK when    11109000
.*                                         STATE=PROBLEM                11157300
.*      $D4=DCR0014 JBB3311 880418 PD16LD: Check AKM with CANCEL=NO     11205600
.*      $01=OY55354 HBB4430 920625 PD16EJ: Add RECORD keyword           11253900
.*                                                                      11302200
.********************************************************************** 11350500
.*                                                                      11398800
.SKIP    ANOP ,                                                         11447100
*        MACDATE  06/25/92                                              11495400
.*                                                                      11543700
.********************************************************************** 11592000
.*                                                                    * 11640300
.*       Declare GLOBAL and LOCAL variables                           * 11688600
.*                                                                    * 11736900
.********************************************************************** 11785200
.*                                                                      11833500
         GBLA  &IHAETDI       LIST counter                              11881800
         GBLC  &IHAETDN       LIST name                                 11930100
.*                                                                      11978400
         LCLA  &AKMV          AKM - Decimal value                       12026700
         LCLC  &AMOD          OI or NI the AMODE qualifier         @D2A 12075000
         LCLC  &ARRV          Associated Recovery Routine address       12123300
         LCLA  &AWK           Arithmetic work variable                  12171600
         LCLA  &COLN          Colon used but no parens (range value)    12219900
         LCLC  &CWK           Character work variable                   12268200
         LCLC  &CWK1          Character work variable              @01A 12316500
         LCLA  &DECVAL        Decimal work variable                     12364800
         LCLC  &EAXV          Extended Authorization Index              12413100
         LCLB  &AKMUSER       AKM specified a user key (flag)      @D4A 12461400
         LCLB  &EKMSYS        EKM specified a system key (flag)    @L2A 12509700
         LCLA  &EKMV          EKM - Decimal value                       12558000
         LCLC  &EKV           Entry Key value                           12606300
         LCLC  &EM(20)        General error messages                    12654600
         LCLC  &ENTV          ENTRY name (ETEADR or HEADER)             12702900
         LCLA  &ER1           Entry register low bound (ETEADR,HEADER)  12751200
         LCLA  &ER2           Entry register high bound (ETEADR,HEADER) 12799500
         LCLA  &FBYTE         FLAG byte                                 12847800
         LCLA  &FBSUP,&FBXMSS  FLAG byte settings                       12896100
         LCLB  &IHBBIT(16)    Bit array                                 12944400
         LCLA  &IHBBITL       Length of bit array &IHBBIT               12992700
         LCLB  &IHBERR        Error flag                                13041000
         LCLC  &KEYS1(22)     Keywords invalid with INITIAL,FINAL  @01C 13089300
         LCLC  &KEYN1(22)     Keyword names for &KEYS1             @01C 13137600
         LCLA  &K1SIZE        Dimension of &KEYS1 and &KEYN1       @L1A 13185900
         LCLC  &KEYS2(19)     Keywords invalid with HEADER         @L2C 13234200
         LCLC  &KEYN2(19)     Keyword names for &KEYS2             @L2C 13282500
         LCLA  &K2SIZE        Dimension of &KEYS2 and &KEYN2       @L1A 13330800
         LCLC  &KEYS4(4)      Keywords invalid with TYPE=ENTRY     @01C 13379100
         LCLC  &KEYN4(4)      Keyword names for &KEYS4             @01C 13427400
         LCLA  &K4SIZE        Dimension of &KEYS4 and &KEYN4       @L1A 13475700
         LCLC  &KEYS5(8)      Keywords invalid with PC=BASIC       @L2A 13524000
         LCLC  &KEYN5(8)      Keyword names for &KEYS5             @L2A 13572300
         LCLA  &K5SIZE        Dimension of &KEYS5 and &KEYN5       @L2A 13620600
         LCLA  &L1            Lower bound                               13668900
         LCLA  &L2            Upper bound                               13717200
         LCLA  &LPAFB1        Flag for LPA, byte 1                 @L2A 13765500
         LCLA  &LPA1CAN         LPA Flag  CANCEL option for ARR    @L2A 13813800
         LCLA  &LPA1ASY         LPA Flag  ASYNCH option for ARR    @L2A 13862100
         LCLA  &NDX           Substring index                           13910400
         LCLC  &NUMV          NUMETE value                              13958700
         LCLA  &OBYTE         OPTION byte                               14007000
         LCLA  &OBPCTC,&OBPKC   OPTION byte settings                    14055300
         LCLA  &OBPKMC,&OBEAXC  OPTION byte settings                    14103600
         LCLA  &OBASC,&OBSASN   OPTION byte settings                    14151900
         LCLA  &PAREN         Parenthesis used                          14200200
         LCLC  &PARM1V        USER parameter 1                          14248500
         LCLC  &PARM2V        USER parameter 2                          14296800
         LCLC  &PGM           PROGRAM NAME                              14345100
         LCLC  &RANGE(2)      Lower/upper range values                  14393400
         LCLC  &RTNV          ROUTINE address                           14441700
         LCLC  &RTNAMOD       AMODE for register form of ROUTINE   @D2A 14490000
         LCLA  &RVAL          Range value pointer                       14538300
         LCLA  &R1            Register usage lower bound                14586600
         LCLA  &R2            Register usage upper bound                14634900
         LCLA  &SUB           Sublist element number                    14683200
         LCLA  &SYSKEY        Highest system key                   @L2A 14731500
         LCLA  &USERKEY       Highest user key                     @L2A 14779800
         LCLC  &VALUE         Sublist element                           14828100
.*                                                                      14876400
.********************************************************************** 14924700
.*       Declares for IHAETD offsets and lengths                      * 14973000
.********************************************************************** 15021300
.*                                                                      15069600
         LCLA  &ETDFMT        Offset to FORMAT NUMBER                   15117900
         LCLA  &ETDFMTE       Extended format indicator                 15166200
         LCLA  &ETDRCRD       Record=YES|NO indicator              @01A 15214500
         LCLA  &ETDNUM        Offset to NUMBER OF ENTRIES               15262800
.*                                                                      15311100
         LCLA  &ETDFLG        Offset to FLAG BYTE                       15359400
         LCLA  &ETDPRO        Offset to PROGRAM name                    15407700
         LCLA  &ETDPRO1       Offset to first word of ETDPRO            15456000
         LCLA  &ETDPRO2       Offset to second word of ETDPRO           15504300
         LCLA  &ETDAKM        Offset to AKM                             15552600
         LCLA  &ETDEKM        Offset to EKM                             15600900
         LCLA  &ETDPAR        Offset to PARM1                           15649200
         LCLA  &ETDOPT1       Offset to OPTION BYTE 1                   15697500
         LCLA  &ETDEK         Offset to EK                              15745800
         LCLA  &ETDEAX        Offset to EAX                             15794100
         LCLA  &ETDARR        Offset to ARR                             15842400
         LCLA  &ETDARR1       Offset to first word of ETDARR            15890700
         LCLA  &ETDARR2       Offset to second word of ETDARR           15939000
         LCLA  &ETDPAR2       Offset to PARM2                           15987300
         LCLA  &ETDLPA1       Offset to LPA FLAG BYTE 1            @L2A 16035600
.*                                                                      16083900
         LCLA  &ETDNUML       Length of NUMBER OF ENTRIES               16132200
         LCLA  &ETDPROL       Length of PROGRAM name                    16180500
         LCLA  &ETDPR1L       Length of first word of ETDPRO            16228800
         LCLA  &ETDPR2L       Length of second word of ETDPRO           16277100
         LCLA  &ETDAKML       Length of AKM                             16325400
         LCLA  &ETDEKML       Length of EKM                             16373700
         LCLA  &ETDPA1L       Length of PARM1                           16422000
         LCLA  &ETDEAXL       Length of EAX                             16470300
         LCLA  &ETDARRL       Length of ARR                             16518600
         LCLA  &ETDAR1L       Length of first word of ETDARR            16566900
         LCLA  &ETDAR2L       Length of second word of ETDARR           16615200
         LCLA  &ETDPA2L       Length of PARM2                           16663500
.*                                                                      16711800
.********************************************************************** 16760100
.*                                                                    * 16808400
.*       IHAETD offsets       These SETs should not be changed        * 16856700
.*                            unless the offsets in the IHAETD        * 16905000
.*                            mapping macro have been changed.        * 16953300
.*                                                                    * 17001600
.********************************************************************** 17049900
.*                                                                      17098200
&ETDFMT  SETA    0            Offset to FORMAT NUMBER                   17146500
&ETDFMTE SETA    1            Extended format indicator                 17194800
&ETDRCRD SETA    0            Record=NO indicator                  @01A 17243100
&ETDRCO  SETA    1            Offset to Header Flag Byte           @01A 17291400
&ETDNUM  SETA    2            Offset to NUMBER OF ENTRIES               17339700
.*                                                                      17388000
&ETDFLG  SETA    1            Offset to FLAG BYTE                       17436300
&ETDPRO  SETA    4            Offset to PROGRAM name                    17484600
&ETDPRO1 SETA    4            Offset to first word of ETDPRO            17532900
&ETDPRO2 SETA    8            Offset to second word of ETDPRO           17581200
&ETDAKM  SETA   12            Offset to AKM                             17629500
&ETDEKM  SETA   14            Offset to EKM                             17677800
&ETDPAR  SETA   16            Offset to PARM1                           17726100
&ETDOPT1 SETA   20            Offset to OPTION BYTE 1                   17774400
&ETDEK   SETA   21            Offset to EK                              17822700
&ETDEAX  SETA   22            Offset to EAX                             17871000
&ETDARR  SETA   24            Offset to ARR                             17919300
&ETDARR1 SETA   24            Offset to first word of ETDPRO            17967600
&ETDARR2 SETA   28            Offset to second word of ETDPRO           18015900
&ETDPAR2 SETA   32            Offset to PARM2                           18064200
&ETDLPA1 SETA   36            Offset to LPA FLAG BYTE 1            @L2A 18112500
.*                                                                      18160800
&ETDNUML SETA      2          Length of NUMBER OF ENTRIES               18209100
&ETDPROL SETA      8          Length of PROGRAM name                    18257400
&ETDPR1L SETA      4          Length of first word of ETDPRO            18305700
&ETDPR2L SETA      4          Length of second word of ETDPRO           18354000
&ETDAKML SETA      2          Length of AKM                             18402300
&ETDEKML SETA      2          Length of EKM                             18450600
&ETDPA1L SETA      4          Length of PARM1                           18498900
&ETDEAXL SETA      2          Length of EAX                             18547200
&ETDARRL SETA      8          Length of ARR                             18595500
&ETDAR1L SETA      4          Length of first word of ETDARR            18643800
&ETDAR2L SETA      4          Length of second word of ETDARR           18692100
&ETDPA2L SETA      4          Length of PARM2                           18740400
.*                                                                      18788700
.********************************************************************** 18837000
.*                                                                    * 18885300
.*       Constants                                                    * 18933600
.*                                                                    * 18981900
.********************************************************************** 19030200
.*                                                                      19078500
&IHBBITL SETA  16             Length of bit array &IHBBIT               19126800
&R1      SETA   2             General register lower bound              19175100
&R2      SETA  12             General register upper bound              19223400
&ER1     SETA   1             Entry register low bound (ETEADR,HEADER)  19271700
&ER2     SETA  15             Entry register high bound (ETEADR,HEADER) 19320000
&SYSKEY  SETA   7             Highest system key (0 - 7)           @L2A 19368300
&USERKEY SETA  15             Highest user key (8 - 15)            @L2A 19416600
.*                                                                      19464900
.*       (&FBYTE)             ETDFLG flag byte settings                 19513200
&FBSUP   SETA  128            X'80'  Supervisor State                   19561500
&FBXMSS  SETA   64            X'40'  XM Space Switch                    19609800
.*                                                                      19658100
.*       (&OBYTE)             ETDOPTB1 Option byte 1 flag settings      19706400
&OBPCTC  SETA  128            X'80'  Stacking PC                        19754700
&OBPKC   SETA   16            X'10'  Replace PSW key                    19803000
&OBPKMC  SETA    8            X'08'  Replace PKM                        19851300
&OBEAXC  SETA    4            X'04'  Replace EAX                        19899600
&OBASC   SETA    2            X'02'  AR mode                            19947900
&OBSASN  SETA    1            X'01'  SASN=NEW PASN                      19996200
.*                                                                      20044500
.*       (&LPAFB1)            ETDLPAF1  LPA flag byte 1 settings   @L2A 20092800
&LPA1CAN SETA  128            X'80'  CANCEL option for ARR         @L2A 20141100
&LPA1ASY SETA   64            X'40'  ASYNCH option for ARR         @L2A 20189400
.*                                                                      20237700
.********************************************************************** 20286000
.*                                                                    * 20334300
.*       Tables                                                       * 20382600
.*                                                                    * 20430900
.********************************************************************** 20479200
.*                                                                      20527500
.********************************************************************** 20575800
.*       Keywords not valid with TYPE=INITIAL | FINAL              @L1A 20624100
.********************************************************************** 20672400
&KEYS1(1)  SETC  '&AKM'                                            @L1A 20720700
&KEYS1(2)  SETC  '&ARR'                                            @L1A 20769000
&KEYS1(3)  SETC  '&ASCMODE'                                        @L1A 20817300
&KEYS1(4)  SETC  '&EAX'                                            @L1A 20865600
&KEYS1(5)  SETC  '&EK'                                             @L1A 20913900
&KEYS1(6)  SETC  '&EKM'                                            @L1A 20962200
&KEYS1(7)  SETC  '&ETEADR'                                         @L1A 21010500
&KEYS1(8)  SETC  '&HEADER'                                         @L1A 21058800
&KEYS1(9)  SETC  '&NUMETE'                                         @L1A 21107100
&KEYS1(10) SETC  '&PARM1'                                          @L1A 21155400
&KEYS1(11) SETC  '&PARM2'                                          @L1A 21203700
&KEYS1(12) SETC  '&PC'                                             @L1A 21252000
&KEYS1(13) SETC  '&PKM'                                            @L1A 21300300
&KEYS1(14) SETC  '&PROGRAM'                                        @L1A 21348600
&KEYS1(15) SETC  '&ROUTINE'                                        @L1A 21396900
&KEYS1(16) SETC  '&RAMODE'                                         @D2A 21445200
&KEYS1(17) SETC  '&SASN'                                           @L1A 21493500
&KEYS1(18) SETC  '&SSWITCH'                                        @L1A 21541800
&KEYS1(19) SETC  '&STATE'                                          @L1A 21590100
&KEYS1(20) SETC  '&ASYNCH'                                         @L2A 21638400
&KEYS1(21) SETC  '&CANCEL'                                         @L2A 21686700
&KEYS1(22) SETC  '&RECORD'                                         @01A 21735000
.*                            Keyword names for &KEYS1                  21783300
&KEYN1(1)  SETC  'AKM'                                             @L1A 21831600
&KEYN1(2)  SETC  'ARR'                                             @L1A 21879900
&KEYN1(3)  SETC  'ASCMODE'                                         @L1A 21928200
&KEYN1(4)  SETC  'EAX'                                             @L1A 21976500
&KEYN1(5)  SETC  'EK'                                              @L1A 22024800
&KEYN1(6)  SETC  'EKM'                                             @L1A 22073100
&KEYN1(7)  SETC  'ETEADR'                                          @L1A 22121400
&KEYN1(8)  SETC  'HEADER'                                          @L1A 22169700
&KEYN1(9)  SETC  'NUMETE'                                          @L1A 22218000
&KEYN1(10) SETC  'PARM1'                                           @L1A 22266300
&KEYN1(11) SETC  'PARM2'                                           @L1A 22314600
&KEYN1(12) SETC  'PC'                                              @L1A 22362900
&KEYN1(13) SETC  'PKM'                                             @L1A 22411200
&KEYN1(14) SETC  'PROGRAM'                                         @L1A 22459500
&KEYN1(15) SETC  'ROUTINE'                                         @L1A 22507800
&KEYN1(16) SETC  'RAMODE'                                          @D2A 22556100
&KEYN1(17) SETC  'SASN'                                            @L1A 22604400
&KEYN1(18) SETC  'SSWITCH'                                         @L1A 22652700
&KEYN1(19) SETC  'STATE'                                           @L1A 22701000
&KEYN1(20) SETC  'ASYNCH'                                          @L2A 22749300
&KEYN1(21) SETC  'CANCEL'                                          @L2A 22797600
&KEYN1(22) SETC  'RECORD'                                          @01A 22845900
&K1SIZE    SETA  22           Dimension of &KEYS1 and &KEYN1       @01C 22894200
.*                                                                      22942500
.********************************************************************** 22990800
.*       Keywords not valid with HEADER                            @L1A 23039100
.********************************************************************** 23087400
&KEYS2(1)  SETC  '&AKM'                                            @L1A 23135700
&KEYS2(2)  SETC  '&ARR'                                            @L1A 23184000
&KEYS2(3)  SETC  '&ASCMODE'                                        @L1A 23232300
&KEYS2(4)  SETC  '&EAX'                                            @L1A 23280600
&KEYS2(5)  SETC  '&EK'                                             @L1A 23328900
&KEYS2(6)  SETC  '&EKM'                                            @L1A 23377200
&KEYS2(7)  SETC  '&ETEADR'                                         @L1A 23425500
&KEYS2(8)  SETC  '&PARM1'                                          @L1A 23473800
&KEYS2(9)  SETC  '&PARM2'                                          @L1A 23522100
&KEYS2(10) SETC  '&PC'                                             @L1A 23570400
&KEYS2(11) SETC  '&PKM'                                            @L1A 23618700
&KEYS2(12) SETC  '&PROGRAM'                                        @L1A 23667000
&KEYS2(13) SETC  '&ROUTINE'                                        @L1A 23715300
&KEYS2(14) SETC  '&RAMODE'                                         @D2A 23763600
&KEYS2(15) SETC  '&SASN'                                           @L1A 23811900
&KEYS2(16) SETC  '&SSWITCH'                                        @L1A 23860200
&KEYS2(17) SETC  '&STATE'                                          @L1A 23908500
&KEYS2(18) SETC  '&ASYNCH'                                         @L2A 23956800
&KEYS2(19) SETC  '&CANCEL'                                         @L2A 24005100
.*                            Keyword names for &KEYS2             @L1A 24053400
&KEYN2(1)  SETC  'AKM'                                             @L1A 24101700
&KEYN2(2)  SETC  'ARR'                                             @L1A 24150000
&KEYN2(3)  SETC  'ASCMODE'                                         @L1A 24198300
&KEYN2(4)  SETC  'EAX'                                             @L1A 24246600
&KEYN2(5)  SETC  'EK'                                              @L1A 24294900
&KEYN2(6)  SETC  'EKM'                                             @L1A 24343200
&KEYN2(7)  SETC  'ETEADR'                                          @L1A 24391500
&KEYN2(8)  SETC  'PARM1'                                           @L1A 24439800
&KEYN2(9)  SETC  'PARM2'                                           @L1A 24488100
&KEYN2(10) SETC  'PC'                                              @L1A 24536400
&KEYN2(11) SETC  'PKM'                                             @L1A 24584700
&KEYN2(12) SETC  'PROGRAM'                                         @L1A 24633000
&KEYN2(13) SETC  'ROUTINE'                                         @L1A 24681300
&KEYN2(14) SETC  'RAMODE'                                          @D2A 24729600
&KEYN2(15) SETC  'SASN'                                            @L1A 24777900
&KEYN2(16) SETC  'SSWITCH'                                         @L1A 24826200
&KEYN2(17) SETC  'STATE'                                           @L1A 24874500
&KEYN2(18) SETC  'ASYNCH'                                          @L2A 24922800
&KEYN2(19) SETC  'CANCEL'                                          @L2A 24971100
&K2SIZE    SETA  19           Dimension of &KEYS2 and &KEYN2       @L2C 25019400
.*                                                                      25067700
.********************************************************************** 25116000
.*       Keywords not valid with TYPE=ENTRY                        @L1A 25164300
.********************************************************************** 25212600
&KEYS4(1)  SETC  '&ETEADR'                                         @L1A 25260900
&KEYS4(2)  SETC  '&HEADER'                                         @L1A 25309200
&KEYS4(3)  SETC  '&NUMETE'                                         @L1A 25357500
&KEYS4(4)  SETC  '&RECORD'                                         @01A 25405800
.*                            Keyword names for &KEYS4             @L1A 25454100
&KEYN4(1)  SETC  'ETEADR'                                          @L1A 25502400
&KEYN4(2)  SETC  'HEADER'                                          @L1A 25550700
&KEYN4(3)  SETC  'NUMETE'                                          @L1A 25599000
&KEYN4(4)  SETC  'RECORD'                                          @01A 25647300
&K4SIZE    SETA  4            Dimension of &KEYS4 and &KEYN4       @01C 25695600
.*                                                                      25743900
.********************************************************************** 25792200
.*       Keywords not valid with PC=BASIC                          @L2A 25840500
.********************************************************************** 25888800
&KEYS5(1)  SETC  '&ARR'                                            @L2A 25937100
&KEYS5(2)  SETC  '&ASYNCH'                                         @L2A 25985400
&KEYS5(3)  SETC  '&CANCEL'                                         @L2A 26033700
&KEYS5(4)  SETC  '&EAX'                                            @L2A 26082000
&KEYS5(5)  SETC  '&EK'                                             @L2A 26130300
           AIF   ('&ASCMODE(1)' NE 'AR').PCBASC                    @L2A 26178600
&KEYS5(6)  SETC  '&ASCMODE'                                        @L2A 26226900
.PCBASC    ANOP  ,                                                 @L2A 26275200
           AIF   ('&PKM(1)' NE 'REPLACE').PCBPKM                   @L2A 26323500
&KEYS5(7)  SETC  '&PKM'                                            @L2A 26371800
.PCBPKM    ANOP  ,                                                 @L2A 26420100
           AIF   ('&SASN(1)' NE 'NEW').PCBSAS                      @L2A 26468400
&KEYS5(8)  SETC  '&SASN'                                           @L2A 26516700
.PCBSAS    ANOP  ,                                                 @L2A 26565000
.*                            Keyword names for &KEYS5             @L2A 26613300
&KEYN5(1)  SETC  'ARR PARAMETER'                                   @L2A 26661600
&KEYN5(2)  SETC  'ASYNCH PARAMETER'                                @L2A 26709900
&KEYN5(3)  SETC  'CANCEL PARAMETER'                                @L2A 26758200
&KEYN5(4)  SETC  'EAX PARAMETER'                                   @L2A 26806500
&KEYN5(5)  SETC  'EK PARAMETER'                                    @L2A 26854800
&KEYN5(6)  SETC  'ASCMODE=&ASCMODE'                                @L2A 26903100
&KEYN5(7)  SETC  'PKM=&PKM'                                        @L2A 26951400
&KEYN5(8)  SETC  'SASN=&SASN'                                      @L2A 26999700
&K5SIZE    SETA  8            Dimension of &KEYS5 and &KEYN5       @L2A 27048000
.*                                                                      27096300
.********************************************************************** 27144600
.*                                                                    * 27192900
.*       Initialization                                               * 27241200
.*                                                                    * 27289500
.********************************************************************** 27337800
         ACTR  10000          Set for infinite loop control             27386100
.*                            Reset Global Variables                    27434400
&IHBERR  SETB  0              Reset error flag                          27482700
.*                            Set up the default flag bytes             27531000
&FBYTE   SETA  0               ETDFLG flag byte                         27579300
&OBYTE   SETA  0               ETDOPTB1 option byte                     27627600
.*                                                                      27675900
.********************************************************************** 27724200
.*                                                                    * 27772500
.*       Generic suffixes for MNOTE Error Messages                    * 27820800
.*             (Refer to MNOTEs at end of listing)                    * 27869100
.*                                                                    * 27917400
.********************************************************************** 27965700
.*                                                                      28014000
&EM(1)   SETC 'PARAMETER IS NOT VALID WHEN TYPE=&TYPE'                  28062300
&EM(2)   SETC 'PARAMETER IS NOT VALID WITH HEADER'                      28110600
&EM(3)   SETC 'PARAMETER IS NOT VALID WITH ETEADR'                      28158900
&EM(4)   SETC 'PARAMETER CONTAINS TOO MANY SUBLISTS'                    28207200
&EM(5)   SETC 'PARAMETER IS REQUIRED WHEN TYPE=&TYPE'                   28255500
&EM(6)   SETC 'PARAMETER IS MISSING SUBLIST ENTRY' ||'n - IGNORED' @P1C 28303800
&EM(7)   SETC 'MAY NOT USE A REGISTER WHEN TYPE=&TYPE'                  28352100
&EM(8)   SETC 'IS NOT VALID WITH PC=BASIC'                              28400400
&EM(9)   SETC 'PARAMETER REQUIRES A VALUE'                         @P3C 28448700
&EM(10)  SETC 'PARAMETER MUST BE ''''YES'''' OR ''''NO'''' '       @01C 28497000
&EM(11)  SETC 'PARAMETER MAY ONLY BE SPECIFIED WITH'               @L2A 28545300
&EM(12)  SETC 'NOT SUPPORTED IN VSE/ESA.'                      @D63XDUG 28569400
.*                                                                      28593600
.********************************************************************** 28641900
.*                                                                    * 28690200
.*       Check for positional parameters                              * 28738500
.*                                                                    * 28786800
.********************************************************************** 28835100
.*                                                                      28883400
         AIF   (N'&SYSLIST GE 1).ERR01          Too many positionals    28931700
.EXPOS   ANOP ,                                                         28980000
.*                                                                      29028300
.********************************************************************** 29076600
.*                                                                    * 29124900
.*       Validate and process according to the TYPE parameter         * 29173200
.*                                                                    * 29221500
.********************************************************************** 29269800
.*                                                                      29318100
.*                                              Check TYPE parameter    29366400
         AIF   ('&TYPE' EQ '').ERR02            TYPE is required   @P1C 29414700
         AIF   (N'&TYPE GT 1).ERR02A            Too many sublists  @P1C 29463000
.CKTYPE  ANOP ,                                 Check TYPE parameter    29511300
         AIF   ('&TYPE(1)' EQ '').ERR02B        No sublist value   @P1A 29559600
         AIF   ('&TYPE(1)' EQ 'SET').DOSET      Process TYPE=SET        29607900
         AIF   ('&TYPE(1)' EQ 'ENTRY').DOENTRY  Process TYPE=ENTRY      29656200
         AIF   ('&TYPE(1)' EQ 'INITIAL').DOINIT Process TYPE=INITIAL    29704500
         AIF   ('&TYPE(1)' EQ 'FINAL').DOINIT   Process TYPE=FINAL      29752800
         AGO   .ERR04                           TYPE is not valid       29801100
.*                                                                      29849400
.********************************************************************** 29897700
.*                                                                    * 29946000
.*       TYPE=INITIAL and TYPE=FINAL                                  * 29994300
.*                                                                    * 30042600
.********************************************************************** 30090900
.*                                                                      30139200
.DOINIT  ANOP  ,                Check for invalid parameters            30187500
&NDX     SETA  0                            Init index counter     @L1C 30235800
.TYPELOP ANOP  ,                            Beginning of loop      @L1C 30284100
&NDX     SETA  &NDX+1                       Increment counter      @L1C 30332400
         AIF   (&NDX GT &K1SIZE).EXTYPEL    End of list?           @L1C 30380700
         AIF   ('&KEYS1(&NDX)' EQ '').TYPELOP Value not specified  @L1C 30429000
         MNOTE 8,' &KEYN1(&NDX) &EM(1)'     Not valid with TYPE    @L1C 30477300
&IHBERR  SETB  1                            Indicate error              30525600
         AGO   .TYPELOP                     Loop back              @L1C 30573900
.EXTYPEL ANOP  ,                            End of keyword list    @L1C 30622200
         AIF   (&IHBERR EQ 1).EXIT      Exit if errors encountered      30670500
         AIF   ('&TYPE(1)' EQ 'FINAL').DOFINAL                          30718800
.*                                                                      30767100
.********************************************************************** 30815400
.*       Process TYPE=INITIAL                                         * 30863700
.********************************************************************** 30912000
.*                                                                      30960300
&NAME    DS    0D                  ENTRY TABLE DESCRIPTION LIST         31008600
         DC    XL1'01'             FORMAT NUMBER OF ETD                 31056900
         DC    AL1(0)              RESERVED. MUST BE ZERO               31105200
&IHAETDN SETC  'ETD&SYSNDX'        List name                            31153500
         DC    AL2(&IHAETDN)       NUMBER OF ENTRY DESCRIPTIONS         31201800
&IHAETDI SETA  0                   Set list counter                     31250100
         AGO   .EXIT               Done                                 31298400
.*                                                                      31346700
.********************************************************************** 31395000
.*       Process TYPE=FINAL                                           * 31443300
.********************************************************************** 31491600
.*                                                                      31539900
.DOFINAL ANOP  ,      Generate equate for number of entries in list     31588200
         AIF   ('&IHAETDN' EQ '').ERR08   Ensure INITIAL specified      31636500
         AIF   ('&NAME' EQ '').FINAME     No label specified            31684800
&NAME    EQU   *                                                        31733100
.FINAME  ANOP  ,                                                        31781400
&IHAETDN EQU   &IHAETDI            NUMBER OF ENTRIES IN LIST            31829700
&IHAETDN SETC  ''                  Reset list name                      31878000
         AGO   .EXIT               Done                                 31926300
.*                                                                      31974600
.********************************************************************** 32022900
.*                                                                    * 32071200
.*       TYPE=SET                                                     * 32119500
.*                                                                    * 32167800
.********************************************************************** 32216100
.*                                                                      32264400
.DOSET   ANOP  ,                    No invalid parameters               32312700
.*                                                                      32361000
.*                                  Check for required keywords         32409300
         AIF   ('&HEADER' NE '').DOSHEAD   HEADER specified             32457600
         AIF   ('&ETEADR' NE '').DOSENTR   ETEADR specified             32505900
         AGO   .ERR09               ETEADR or HEADER required           32554200
.*                                                                    * 32602500
.********************************************************************** 32650800
.*                                                                    * 32699100
.*       TYPE=SET,HEADER=addr                                         * 32747400
.*                                                                    * 32795700
.********************************************************************** 32844000
.DOSHEAD ANOP ,                Check for invalid parameters             32892300
&NDX     SETA  0                            Init index counter     @L1C 32940600
.HEADLOP ANOP  ,                            Beginning of loop      @L1C 32988900
&NDX     SETA  &NDX+1                       Increment counter      @L1C 33037200
         AIF  (&NDX GT &K2SIZE).EXHEADL     End of list?           @L1C 33085500
         AIF  ('&KEYS2(&NDX)' EQ '').HEADLOP Value not specified   @L1C 33133800
         MNOTE 8,' &KEYN2(&NDX) &EM(2)'     Not valid with HEADER  @L1C 33182100
&IHBERR  SETB  1                            Indicate error              33230400
         AGO   .HEADLOP                     Loop back              @L1C 33278700
.EXHEADL ANOP  ,                            End of keyword list    @L1C 33327000
.********************************************************************** 33375300
.*       HEADER parameter                                             * 33423600
.********************************************************************** 33471900
.*                                                                      33520200
         AIF   (N'&HEADER GT 1).ERR37B         Too many sublists        33568500
&ENTV    SETC  '+'.'&HEADER'                   RX type suffix           33616800
         AIF   ('&HEADER'(1,1) NE '(').EXHEAD  Not register format      33665100
&ENTV    SETC  '&HEADER(1)'                    Register format (Rx)     33713400
         AIF   (T'&HEADER NE 'N').EXHEAD       Must be a symbol         33761700
&AWK     SETA  K'&HEADER-2                     Length of register       33810000
&CWK     SETC  '&HEADER'(2,&AWK)               Isolate register number  33858300
         AIF   ('&CWK' LT '&ER1' OR '&CWK' GT '&ER2').ERR37A  Bad reg   33906600
.EXHEAD  ANOP  ,                                                        33954900
.*                                                                      34003200
.********************************************************************** 34051500
.*       NUMETE parameter                         ( 1 - 128 )         * 34099800
.********************************************************************** 34148100
.*                                                                      34196400
&L1      SETA  1                               Minimum value            34244700
&L2      SETA  128                             Maximum value            34293000
         AIF   ('&NUMETE(1)' EQ '').ERR39      NUMETE is required  @P1C 34341300
         AIF   (N'&NUMETE GT 1).ERR39B         Too many sublists        34389600
         AIF   ('&NUMETE'(1,1) EQ '(').NUMREG  Register form            34437900
         AIF   (T'&NUMETE NE 'N').NUMESET      Must be a symbol         34486200
         AIF   (&NUMETE LT &L1).ERR39A         Minimum value            34534500
         AIF   (&NUMETE GT &L2).ERR39A         Maximum value            34582800
         AGO   .NUMESET                        Done                     34631100
.NUMREG  ANOP  ,                                                        34679400
         AIF   (T'&NUMETE NE 'N').NUMESET      Must be a symbol         34727700
&AWK     SETA  K'&NUMETE-2                     Length of register       34776000
&CWK     SETC  '&NUMETE'(2,&AWK)               Isolate register         34824300
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR39C Reg invalid  34872600
.NUMESET ANOP  ,                                                        34920900
&NUMV    SETC  '&NUMETE(1)'                    Value                    34969200
.EXNUMET ANOP  ,                                                        35017500
.*                                                                      35065800
.********************************************************************** 35114100
.*       RECORD parameter                         ( YES | NO )        * 35162400
.********************************************************************** 35210700
.*                                                                      35259000
         AIF   ('&RECORD' EQ '').EXRECRD       Not specified       @01A 35307300
         AIF   (N'&RECORD GT 1).ERR55B         Too many sublists   @01A 35355600
         AIF   ('&RECORD(1)' EQ 'YES').EXRECRD Default             @01A 35403900
         AIF   ('&RECORD(1)' NE 'NO').ERR55    Error               @01A 35452200
&ETDRCRD SETA 1                                Indicate RECORD(NO) @01A 35500500
.EXRECRD ANOP ,                                                    @01A 35548800
.*                                                                      35597100
.********************************************************************** 35645400
.*                                                                    * 35693700
.*       SET  Entry Table Descriptor entry for                        * 35742000
.*              TYPE=SET,HEADER=addr                                  * 35790300
.*                                                                    * 35838600
.********************************************************************** 35886900
         AIF   (&IHBERR EQ 1).EXIT        Exit if errors encountered    35935200
         AIF   ('&ENTV'(1,1) EQ '+').HEASYMF   Symbol form              35983500
.*                                             Register form            36031800
&NAME    MVI   &ETDFMT.(&ENTV),&ETDFMTE        FORMAT NUMBER            36080100
&CWK     SETC  '&ETDNUM.(&ETDNUML,&ENTV)'      Target of MVC for NUMETE 36128400
&CWK1    SETC  '&ETDRCO.(&ENTV)'               Target of OI for    @01A 36176700
.*                                             RECORD                   36225000
         AGO   .GENUREC                        Generate RECORD          36273300
.*                                                                      36321600
.HEASYMF ANOP  ,                               Symbolic name form       36369900
&NAME    MVI   &ETDFMT.&ENTV,&ETDFMTE          FORMAT NUMBER            36418200
&CWK     SETC  '&ETDNUM.&ENTV.(&ETDNUML)'      Target of MVC for NUMETE 36466500
&CWK1    SETC  '&ETDRCO.&ENTV'                 Target of OI for    @01A 36514800
.*                                             RECORD                   36563100
.*--------------------------------------------------------------------* 36611400
.GENUREC ANOP  ,                                                   @01A 36659700
         AIF   (&ETDRCRD EQ 0).GENUMET     If RECORD(YES) generate @01A 36708000
.*                                         NUMETE code                  36756300
.*                                                                      36804600
.*  The following OR sets ETDRCRD to indicate that this is a            36852900
.*  RECORD=NO entry table.  The hardcoded value allows the macro        36901200
.*  to be used without the inclusion of the ETD.                        36949500
.*                                                                      36997800
         OI    &CWK1,X'80'                     RECORD=NO TABLE     @01A 37046100
.*--------------------------------------------------------------------* 37094400
.GENUMET ANOP  ,                                                        37142700
         AIF   ('&NUMETE'(1,1) EQ '(').NUMEREG Register format          37191000
         AIF   (T'&NUMETE EQ 'N').NUMEDEC      Positive number          37239300
         MVC   &CWK,&NUMV                      NUMBER OF ENTRIES        37287600
         AGO   .EXIT                           Done                     37335900
.NUMEDEC ANOP  ,                                                        37384200
         MVC   &CWK,=Y(&NUMV)                  NUMBER OF ENTRIES        37432500
         AGO   .EXIT                           Done                     37480800
.NUMEREG ANOP  ,                                                        37529100
         AIF   ('&ENTV'(1,1) EQ '+').NUMHSYM   Symbol form              37577400
         STH   &NUMV,&ETDNUM.(,&ENTV)          NUMBER OF ENTRIES        37625700
         AGO   .EXIT                           Done                     37674000
.NUMHSYM ANOP  ,                                                        37722300
         STH   &NUMV,&ETDNUM.&ENTV             NUMBER OF ENTRIES        37770600
         AGO   .EXIT                           Done                     37818900
.*                                                                      37867200
.********************************************************************** 37915500
.*                                                                    * 37963800
.*       TYPE=SET,ETEADR=addr                                         * 38012100
.*                                                                    * 38060400
.********************************************************************** 38108700
.DOSENTR ANOP ,                        Check for invalid parameters     38157000
         AIF ('&NUMETE' EQ '').SENUM     Invalid parameter              38205300
         MNOTE 8,' NUMETE &EM(3)'        Not valid with ETEADR          38253600
&IHBERR  SETB  1                         Indicate error                 38301900
.SENUM   ANOP  ,                                                        38350200
.*        Note: The HEADER parameter is not valid with ETEADR=&ETEADR.  38398500
.*              This check was made at .DOSET above, which would not    38446800
.*              permit processing to arrive here.                       38495100
.*                                                                      38543400
.********************************************************************** 38591700
.*       ETEADR parameter                                             * 38640000
.********************************************************************** 38688300
.*                                                                      38736600
         AIF   (N'&ETEADR GT 1).ERR34B          Too many sublists       38784900
&ENTV    SETC  '+'.'&ETEADR'                    RX type suffix          38833200
         AIF   ('&ETEADR'(1,1) NE '(').EXETEAD  Not register format     38881500
&ENTV    SETC  '&ETEADR(1)'                     Register format (Rx)    38929800
         AIF   (T'&ETEADR NE 'N').EXETEAD       Must be a symbol        38978100
&AWK     SETA  K'&ETEADR-2                      Length of register      39026400
&CWK     SETC  '&ETEADR'(2,&AWK)                Isolate register number 39074700
         AIF   ('&CWK' LT '&ER1' OR '&CWK' GT '&ER2').ERR34  Bad reg    39123000
.EXETEAD ANOP  ,                                                        39171300
         AGO   .DOKEYS                 Continue keyword validation      39219600
.*                                                                      39267900
.********************************************************************** 39316200
.*                                                                    * 39364500
.*       TYPE=ENTRY                                                   * 39412800
.*                                                                    * 39461100
.********************************************************************** 39509400
.*                                                                      39557700
.DOENTRY ANOP ,                        Check for invalid parameters     39606000
&NDX     SETA  0                            Init index counter     @L1C 39654300
.ENTRLOP ANOP  ,                            Beginning of loop      @L1C 39702600
&NDX     SETA  &NDX+1                       Increment counter      @L1C 39750900
         AIF   (&NDX GT &K4SIZE).EXENTRL    End of list?           @L1C 39799200
         AIF   ('&KEYS4(&NDX)' EQ '').ENTRLOP Value not specified  @L1C 39847500
         MNOTE 8,' &KEYN4(&NDX) &EM(1)'     Not valid with ENTRY   @L1C 39895800
&IHBERR  SETB  1                            Indicate error              39944100
         AGO   .ENTRLOP                     Loop back              @L1C 39992400
.EXENTRL ANOP  ,                            End of keyword list    @L1C 40040700
.*                                                                      40089000
.********************************************************************** 40137300
.*                                                                    * 40185600
.*       TYPE=ENTRY or TYPE=SET,ETEADR=addr      Valid keywords       * 40233900
.*                                                                    * 40282200
.********************************************************************** 40330500
.*                                                                      40378800
.DOKEYS  ANOP  ,                       Process keywords                 40427100
.*                                                                      40475400
.********************************************************************** 40523700
.*                                                                    * 40572000
.*       AKM parameter                 (key list)   Required          * 40620300
.********************************************************************** 40668600
.*                                                                      40716900
         AIF   ('&AKM' EQ '').ERR22    AKM not specified                40765200
         AIF   ('&AKM' EQ '()').ERR22B No value within parens      @P2A 40813500
&L1      SETA  0                       Lower range value                40861800
&L2      SETA  15                      Upper range value                40910100
.*                                                                      40958400
.*                                     Reset the &IHBBIT bit array      41006700
&NDX     SETA  1                       Set index counter                41055000
.AKMRSET ANOP                          Loop to zero the bit array       41103300
&IHBBIT(&NDX) SETB 0                   Zero this bit                    41151600
&NDX     SETA  &NDX+1                  Increment the counter and        41199900
         AIF   (&NDX LE &IHBBITL).AKMRSET   loop for all bits           41248200
.*                                                                      41296500
.********************************************************************** 41344800
.*       Parse and isolate the lower and upper range value            * 41393100
.********************************************************************** 41441400
.*                                                                      41489700
.*                                 Process each sublist entry           41538000
&SUB     SETA  1                       Set sublist counter              41586300
.*                                                                      41634600
.AKMSET  ANOP  ,                       Loop for each sublist entry      41682900
         AIF   (T'&AKM(&SUB) EQ 'O').WAR22   Null sublist entry         41731200
&VALUE   SETC  '&AKM(&SUB)'            Isolate range sublist            41779500
.*                                                                      41827800
&RVAL    SETA  1                       First range value                41876100
&NDX     SETA  0                       Point at nothing                 41924400
&PAREN   SETA  0                       Initialize to no parens used     41972700
         AIF   ('&VALUE'(1,1) NE '(').AKMVALL  First char not '('       42021000
&PAREN   SETA  1                       Parenthesis used                 42069300
&NDX     SETA  1                       Point at parenthesis             42117600
.*                                                                      42165900
.********************************************************************** 42214200
.*                                                                      42262500
.AKMVALL ANOP                          Loop to isolate ranges           42310800
         AIF   (&RVAL GT 2).ERR22A     Too many entries                 42359100
&AWK     SETA  &NDX                    Index prior to number            42407400
.AKMCHRL ANOP                          Loop for number                  42455700
&NDX     SETA  &NDX+1                  Point to next character          42504000
         AIF   ('&VALUE'(&NDX,1) EQ ':').AKMSNUM    End of number       42552300
         AIF   ('&VALUE'(&NDX,1) EQ ')').AKMSNUM    End of number       42600600
         AIF   ('&VALUE'(&NDX,1) LT '0').ERR22A     Not decimal         42648900
         AIF   ('&VALUE'(&NDX,1) GT '9').ERR22A     Not decimal         42697200
         AIF   (&NDX LT K'&VALUE).AKMCHRL  Check next character         42745500
.AKMSNUM ANOP  ,                                                        42793800
         AIF   (&PAREN EQ 0).AKMSVAL      Number not in parens          42842100
         AIF   (&AWK+1 EQ &NDX).ERR22A    No number '(:' or ':)'        42890400
         AGO   .AKMRANG                   Go save value                 42938700
.AKMSVAL ANOP  ,                                                        42987000
         AIF   ('&VALUE'(&NDX,1) NE ':').AKMRANG    End of number       43035300
         AIF   (&NDX EQ K'&VALUE).ERR22A  Missing high range 'xx:'      43083600
&COLN    SETA  1                          Account for colon             43131900
.*                                                                      43180200
.AKMRANG ANOP  ,                          Save range value              43228500
&RANGE(&RVAL)  SETC  '&VALUE'(&AWK+1,&NDX-&AWK-&PAREN-&COLN)            43276800
&COLN    SETA  0                          Reset colon indicator         43325100
.*                                        Process next sublist entry    43373400
&RANGE(2) SETC '&RANGE(&RVAL)'            Set upper range...            43421700
&RVAL    SETA  &RVAL+1                    Next range value              43470000
         AIF   (&NDX LT K'&VALUE).AKMVALL  Another entry to process...  43518300
.*                                                                    * 43566600
.********************************************************************** 43614900
.*                                                                    * 43663200
         AIF   ('&RANGE(1)' LT '&L1').ERR22A  Less than lower bound     43711500
         AIF   ('&RANGE(2)' GT '&L2').ERR22A  Greater than upper bound  43759800
         AIF   ('&RANGE(1)' GT '&RANGE(2)').ERR22A  Invalid range       43808100
.*                                            Set the required bits     43856400
&AWK     SETA  &RANGE(1)-&L1+1                 Start bit position       43904700
.AKMBITL ANOP  ,                               Loop                     43953000
&IHBBIT(&AWK) SETB 1                           Set the required bit     44001300
&AWK     SETA  &AWK+1                          Next position            44049600
         AIF   (&AWK LE &RANGE(2)-&L1+1).AKMBITL  Loop for all bits     44097900
.*                                                                      44146200
.AKMNEXT ANOP  ,                                                        44194500
&SUB     SETA  &SUB+1                    Increment the counter          44242800
         AIF   (&SUB LE N'&AKM).AKMSET   and loop for each sublist      44291100
.*                                                                      44339400
.********************************************************************** 44387700
.*       Convert binary array (&IHBBIT) to decimal value              * 44436000
.********************************************************************** 44484300
.*                                                                    * 44532600
&AWK     SETA  1                            Binary power multiplier     44580900
&NDX     SETA  &IHBBITL                     Point at low order bit      44629200
&DECVAL  SETA  &IHBBIT(&NDX)                Initialize decimal value    44677500
.AKMDEC  ANOP  ,                                                        44725800
&NDX     SETA  &NDX-1                       Index to next bit           44774100
&AWK     SETA  &AWK*2                       Increment by power of 2     44822400
&DECVAL  SETA  &AWK*&IHBBIT(&NDX)+&DECVAL   Add to current value        44870700
         AIF   (&NDX GT 1).AKMDEC           Loop for all bits           44919000
&AKMV    SETA  &DECVAL                      Set result                  44967300
         AIF   (&DECVAL EQ 0).ERR22B        No bits were set       @P2A 45015600
.*                                                                      45063900
.********************************************************************** 45112200
.*       Check AKM for a user key (8-15) when CANCEL=NO               * 45160500
.********************************************************************** 45208800
.*                                                                      45257100
         AIF   ('&CANCEL' NE 'NO').EXAKM    CANCEL=NO not specifid @D4A 45305400
&NDX     SETA  &SYSKEY+2                    Init for indexing      @D4A 45353700
&AKMUSER SETB  1                            Init user key found    @D4A 45402000
.AKMUSE  ANOP  ,                                                   @D4A 45450300
         AIF   (&IHBBIT(&NDX) EQ 1).EXAKM   Exit if user key       @D4A 45498600
&NDX     SETA  &NDX+1                       Index to next bit      @D4A 45546900
         AIF   (&NDX LE &USERKEY+1).AKMUSE  Loop for all bits      @D4A 45595200
&AKMUSER SETB  0                            No user key found      @D4A 45643500
.*                                                                      45691800
.EXAKM   ANOP  ,                                                        45740100
.*                                                                      45788400
.********************************************************************** 45836700
.*                                                                    * 45885000
.*       ARR parameter                       (address)                * 45933300
.********************************************************************** 45981600
.*                                                                      46029900
&L2      SETA  8                               Maximum length      @D1A 46078200
         AIF   ('&ARR' EQ '').ARRDFLT          Take default             46126500
         AIF   (N'&ARR GT 1).ERR25B            Too many sublists        46174800
         AIF   ('&TYPE(1)' EQ 'SET').ARRVAL    Continue                 46223100
         AIF   ('&ARR'(1,1) EQ '(').ERR25      Register form invalid    46271400
.ARRVAL  ANOP  ,                                                        46319700
         AIF   ('&ARR'(1,1) NE '''').ARRSET    Address or register @D1A 46368000
         AIF   (K'&ARR-2 GT &L2).ERR25A        Maximum length      @D1A 46416300
.ARRSET  ANOP  ,                                                   @D1A 46464600
&ARRV    SETC  '&ARR'                          ARR value                46512900
         AIF   ('&ARR'(1,1) NE '(').EXARR      Not register form        46561200
         AIF   (T'&ARR NE 'N').EXARR            Must be a symbol        46609500
&AWK     SETA  K'&ARR-2                         Length of register      46657800
&CWK     SETC  '&ARR'(2,&AWK)                   Isolate register        46706100
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR25C Reg invalid  46754400
         AGO   .EXARR                          Done                     46802700
.ARRDFLT ANOP  ,                                                        46851000
&ARRV    SETC  '0'                             Default value            46899300
.EXARR   ANOP  ,                                                        46947600
.*                                                                      46995900
.********************************************************************** 47044200
.*                                                                    * 47092500
.*       ASCMODE parameter                   ( PRIMARY | AR )         * 47140800
.********************************************************************** 47189100
.*                                                                      47237400
         AIF   ('&ASCMODE' EQ '').EXASCM           Set default value    47285700
         AIF   (N'&ASCMODE GT 1).ERR26B            Too many sublists    47334000
         AIF   ('&ASCMODE(1)' EQ 'PRIMARY').EXASCM Default value        47382300
         AIF   ('&ASCMODE(1)' NE 'AR').ERR26       Error...             47430600
&OBYTE   SETA  &OBYTE+&OBASC                       ASCMODE=AR           47478900
.EXASCM  ANOP ,                                                         47527200
.*                                                                      47575500
.********************************************************************** 47623800
.*                                                                    * 47672100
.*       ASYNCH parameter                   ( YES | NO )              * 47720400
.*                                                                    * 47768700
.*       The ARR will/will not be interrupted by asynchronous exits   * 47817000
.********************************************************************** 47865300
.*                                             ARR ASYNCH          @L2A 47913600
         AIF   ('&ASYNCH' EQ '').EXASYNC       Set default value   @L2A 47961900
         AIF   (N'&ASYNCH GT 1).ERR27B         Too many sublists   @L2A 48010200
         AIF   ('&ASYNCH(1)' EQ 'YES').EXASYNC Default             @L2A 48058500
         AIF   ('&ASYNCH(1)' NE 'NO').ERR27    Error               @L2A 48106800
         AIF   ('&ASYNCH(1)' EQ 'NO').ERR27A   NOT SUPPORTED   @D63XDUG 48130900
&LPAFB1  SETA  &LPAFB1+&LPA1ASY                ASYNCH=NO           @L2A 48155100
.EXASYNC ANOP ,                                                    @L2A 48203400
.*                                                                      48251700
.********************************************************************** 48300000
.*                                                                    * 48348300
.*       CANCEL parameter                   ( YES | NO )              * 48396600
.*                                                                    * 48444900
.*  The ARR will/will not be interrupted by CANCEL/DETACH processing  * 48493200
.********************************************************************** 48541500
.*                                             ARR CANCEL          @L2A 48589800
         AIF   ('&CANCEL' EQ '').EXCANCL       Set default value   @L2A 48638100
         AIF   (N'&CANCEL GT 1).ERR28B         Too many sublists   @L2A 48686400
         AIF   ('&CANCEL(1)' EQ 'YES').EXCANCL Default             @L2A 48734700
         AIF   ('&CANCEL(1)' NE 'NO').ERR28    Error               @L2A 48783000
         AIF   ('&CANCEL(1)' EQ 'NO').ERR28A   NOT SUPPORTED   @D63XDUG 48807100
&LPAFB1  SETA  &LPAFB1+&LPA1CAN                CANCEL=NO           @L2A 48831300
.EXCANCL ANOP ,                                                    @L2A 48879600
.*                                                                      48927900
.********************************************************************** 48976200
.*                                                                    * 49024500
.*       EAX parameter                       (halfword value)         * 49072800
.********************************************************************** 49121100
.*                                                                      49169400
         AIF   ('&EAX' EQ '').EAXDFLT        Take default               49217700
         AIF   (N'&EAX GT 1).ERR29B          Too many sublists          49266000
         AIF   ('&TYPE(1)' EQ 'SET').EAXVAL  Continue                   49314300
         AIF   ('&EAX'(1,1) EQ '(').ERR29    Register form invalid      49362600
.EAXVAL  ANOP  ,                                                        49410900
&EAXV    SETC  '&EAX'                        Value                      49459200
&OBYTE   SETA  &OBYTE+&OBEAXC                Set EAX specified bit      49507500
         AIF   ('&EAX'(1,1) EQ '-').ERR29A   Negative value        @P4A 49555800
         AIF   ('&EAX'(1,1) NE '(').EXEAX    Not a register             49604100
.*                                           Register form              49652400
         AIF   (T'&EAX NE 'N').EXEAX            Must be a symbol        49700700
&AWK     SETA  K'&EAX-2                         Length of register      49749000
&CWK     SETC  '&EAX'(2,&AWK)                   Isolate register        49797300
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR29C Reg invalid  49845600
         AGO   .EXEAX                        Done                       49893900
.EAXDFLT ANOP  ,                                                        49942200
&EAXV    SETC  '0'                           Default value              49990500
.EXEAX   ANOP  ,                                                        50038800
.*                                                                      50087100
.********************************************************************** 50135400
.*                                                                    * 50183700
.*       EK  parameter                       (0-15)                   * 50232000
.********************************************************************** 50280300
.*                                                                      50328600
&L1      SETA  0                             Minimum value              50376900
&L2      SETA  15                            Maximum value              50425200
         AIF   ('&EK' EQ '').EKDFLT          Take default               50473500
         AIF   (N'&EK GT 1).ERR31B           Too many sublists          50521800
&EKV     SETC  '&EK(1)'                      Value                      50570100
&OBYTE   SETA  &OBYTE+&OBPKC                 Set EK specified bit       50618400
         AIF   (T'&EK EQ 'N').EKDEC          Positive number       @P4C 50666700
         AIF   ('&EK'(1,1) EQ '-').ERR31     Negative value        @P4A 50715000
         AIF   ('&EK'(1,1) NE '(').EXEK      Must be a Constant    @P4A 50763300
         AIF   ('&EK'(2,1) EQ '-').ERR31     Negative value        @P4A 50811600
         AGO   .EXEK                         Done                  @P4A 50859900
.EKDEC   ANOP  ,                                                   @P4A 50908200
         AIF   (&EK(1) LT &L1 OR &EK(1) GT &L2).ERR31   Min/max value   50956500
         AGO   .EXEK                         Done                       51004800
.EKDFLT  ANOP  ,                                                        51053100
&EKV     SETC  '0'                           Default value              51101400
.EXEK    ANOP  ,                                                        51149700
.*                                                                      51198000
.********************************************************************** 51246300
.*                                                                    * 51294600
.*       EKM parameter                 (key list)                     * 51342900
.********************************************************************** 51391200
.*                                                                      51439500
         AIF   ('&EKM' EQ '').EXEKM    Take default of zero        @D2C 51487800
         AIF   ('&EKM' EQ '()').ERR32B No value within parens      @P2A 51536100
&L1      SETA  0                       Lower range value                51584400
&L2      SETA  15                      Upper range value                51632700
.*                                                                      51681000
.*                                     Reset the &IHBBIT bit array      51729300
&NDX     SETA  1                       Set index counter                51777600
.EKMRSET ANOP                          Loop to zero the bit array       51825900
&IHBBIT(&NDX) SETB 0                   Zero this bit                    51874200
&NDX     SETA  &NDX+1                  Increment the counter and        51922500
         AIF   (&NDX LE &IHBBITL).EKMRSET   loop for all bits           51970800
.*                                                                      52019100
.********************************************************************** 52067400
.*       Parse and isolate the lower and upper range value            * 52115700
.********************************************************************** 52164000
.*                                                                      52212300
.*                                 Process each sublist entry           52260600
&SUB     SETA  1                       Set sublist counter              52308900
.*                                                                      52357200
.EKMSET  ANOP  ,                       Loop for each sublist entry      52405500
         AIF   (T'&EKM(&SUB) EQ 'O').WAR32   Null sublist entry         52453800
&VALUE   SETC  '&EKM(&SUB)'            Isolate range sublist            52502100
.*                                                                      52550400
&RVAL    SETA  1                       First range value                52598700
&NDX     SETA  0                       Point at nothing                 52647000
&PAREN   SETA  0                       Initialize to no parens used     52695300
         AIF   ('&VALUE'(1,1) NE '(').EKMVALL  First char not '('       52743600
&PAREN   SETA  1                       Parenthesis used                 52791900
&NDX     SETA  1                       Point at parenthesis             52840200
.*                                                                      52888500
.********************************************************************** 52936800
.*                                                                      52985100
.EKMVALL ANOP                          Loop to isolate ranges           53033400
         AIF   (&RVAL GT 2).ERR32A     Too many entries                 53081700
&AWK     SETA  &NDX                    Index prior to number            53130000
.EKMCHRL ANOP                          Loop for number                  53178300
&NDX     SETA  &NDX+1                  Point to next character          53226600
         AIF   ('&VALUE'(&NDX,1) EQ ':').EKMSNUM    End of number       53274900
         AIF   ('&VALUE'(&NDX,1) EQ ')').EKMSNUM    End of number       53323200
         AIF   ('&VALUE'(&NDX,1) LT '0').ERR32A     Not decimal         53371500
         AIF   ('&VALUE'(&NDX,1) GT '9').ERR32A     Not decimal         53419800
         AIF   (&NDX LT K'&VALUE).EKMCHRL  Check next character         53468100
.EKMSNUM ANOP  ,                                                        53516400
         AIF   (&PAREN EQ 0).EKMSVAL      Number not in parens          53564700
         AIF   (&AWK+1 EQ &NDX).ERR32A    No number '(:' or ':)'        53613000
         AGO   .EKMRANG                   Go save value                 53661300
.EKMSVAL ANOP  ,                                                        53709600
         AIF   ('&VALUE'(&NDX,1) NE ':').EKMRANG    End of number       53757900
         AIF   (&NDX EQ K'&VALUE).ERR32A  Missing high range 'xx:'      53806200
&COLN    SETA  1                          Account for colon             53854500
.*                                                                      53902800
.EKMRANG ANOP  ,                          Save range value              53951100
&RANGE(&RVAL)  SETC  '&VALUE'(&AWK+1,&NDX-&AWK-&PAREN-&COLN)            53999400
&COLN    SETA  0                          Reset colon indicator         54047700
.*                                        Process next sublist entry    54096000
&RANGE(2) SETC '&RANGE(&RVAL)'            Set upper range...            54144300
&RVAL    SETA  &RVAL+1                    Next range value              54192600
         AIF   (&NDX LT K'&VALUE).EKMVALL  Another entry to process...  54240900
.*                                                                    * 54289200
.********************************************************************** 54337500
.*                                                                    * 54385800
         AIF   ('&RANGE(1)' LT '&L1').ERR32A  Less than lower bound     54434100
         AIF   ('&RANGE(2)' GT '&L2').ERR32A  Greater than upper bound  54482400
         AIF   ('&RANGE(1)' GT '&RANGE(2)').ERR32A  Invalid range       54530700
.*                                            Set the required bits     54579000
&AWK     SETA  &RANGE(1)-&L1+1                 Start bit position       54627300
.EKMBITL ANOP  ,                               Loop                     54675600
&IHBBIT(&AWK) SETB 1                           Set the required bit     54723900
&AWK     SETA  &AWK+1                          Next position            54772200
         AIF   (&AWK LE &RANGE(2)-&L1+1).EKMBITL  Loop for all bits     54820500
.*                                                                      54868800
.EKMNEXT ANOP  ,                                                        54917100
&SUB     SETA  &SUB+1                    Increment the counter          54965400
         AIF   (&SUB LE N'&EKM).EKMSET   and loop for each sublist      55013700
.*                                                                      55062000
.********************************************************************** 55110300
.*       Convert binary array (&IHBBIT) to decimal value              * 55158600
.********************************************************************** 55206900
.*                                                                    * 55255200
&AWK     SETA  1                            Binary power multiplier     55303500
&NDX     SETA  &IHBBITL                     Point at low order bit      55351800
&DECVAL  SETA  &IHBBIT(&NDX)                Initialize decimal value    55400100
.EKMDEC  ANOP  ,                                                        55448400
&NDX     SETA  &NDX-1                       Index to next bit           55496700
&AWK     SETA  &AWK*2                       Increment by power of 2     55545000
&DECVAL  SETA  &AWK*&IHBBIT(&NDX)+&DECVAL   Add to current value        55593300
         AIF   (&NDX GT 1).EKMDEC           Loop for all bits           55641600
&EKMV    SETA  &DECVAL                      Set result                  55689900
         AIF   (&DECVAL EQ 0).ERR32B        No bits were set       @P2A 55738200
.*                                                                      55786500
.********************************************************************** 55834800
.*       Check EKM for a system key (0-7) when CANCEL=NO              * 55883100
.********************************************************************** 55931400
.*                                                                      55979700
         AIF   ('&CANCEL' NE 'NO').EXEKM    CANCEL=NO not specifid @L2A 56028000
&NDX     SETA  0                            Init for indexing      @L2A 56076300
&EKMSYS  SETB  1                            Init system key found  @L2A 56124600
.EKMSYS  ANOP  ,                                                   @L2A 56172900
&NDX     SETA  &NDX+1                       Index to next bit      @L2A 56221200
         AIF   (&IHBBIT(&NDX) EQ 1).EXEKM   Exit if system key     @L2A 56269500
         AIF   (&NDX LE &SYSKEY).EKMSYS     Loop for all bits      @L2A 56317800
&EKMSYS  SETB  0                            No system key found    @L2A 56366100
.*                                                                      56414400
.EXEKM   ANOP  ,                                                        56462700
.*                                                                      56511000
.********************************************************************** 56559300
.*                                                                    * 56607600
.*       PARM1 parameter                      (user parm 1)           * 56655900
.********************************************************************** 56704200
.*                                                                      56752500
&L2      SETA  4                               Maximum length           56800800
         AIF   ('&PARM1' EQ '').PM1DFLT        Take default             56849100
         AIF   (N'&PARM1 GT 1).ERR43B          Too many sublists        56897400
         AIF   ('&TYPE(1)' EQ 'SET').PM1VAL    Continue                 56945700
         AIF   ('&PARM1'(1,1) EQ '(').ERR43    Register form invalid    56994000
.PM1VAL  ANOP  ,                                                        57042300
         AIF   ('&PARM1'(1,1) NE '''').PM1SET  Address or register      57090600
         AIF   (K'&PARM1-2 GT &L2).ERR43A      Maximum length           57138900
.PM1SET  ANOP  ,                                                        57187200
&PARM1V  SETC  '&PARM1'                        Value                    57235500
         AIF   ('&PARM1'(1,1) NE '(').EXPARM1  Not register form        57283800
         AIF   (T'&PARM1 NE 'N').EXPARM1        Must be a symbol        57332100
&AWK     SETA  K'&PARM1-2                       Length of register      57380400
&CWK     SETC  '&PARM1'(2,&AWK)                 Isolate register        57428700
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR43C Reg invalid  57477000
         AGO   .EXPARM1                        Done                     57525300
.PM1DFLT ANOP ,                                                         57573600
&PARM1V  SETC  '0'                             Default value            57621900
.EXPARM1 ANOP  ,                                                        57670200
.*                                                                      57718500
.********************************************************************** 57766800
.*                                                                    * 57815100
.*       PARM2 parameter                       (user parm 2)          * 57863400
.********************************************************************** 57911700
.*                                                                      57960000
&L2      SETA  4                               Maximum length           58008300
         AIF   ('&PARM2' EQ '').PM2DFLT        Take default             58056600
         AIF   (N'&PARM2 GT 1).ERR44B          Too many sublists        58104900
         AIF   ('&TYPE(1)' EQ 'SET').PM2VAL    Continue                 58153200
         AIF   ('&PARM2'(1,1) EQ '(').ERR44    Register form invalid    58201500
.PM2VAL  ANOP  ,                                                        58249800
         AIF   ('&PARM2'(1,1) NE '''').PM2SET  Address or register      58298100
         AIF   (K'&PARM2-2 GT &L2).ERR44A      Maximum length           58346400
.PM2SET  ANOP  ,                                                        58394700
&PARM2V  SETC  '&PARM2'                        Value                    58443000
         AIF   ('&PARM2'(1,1) NE '(').EXPARM2  Not register form        58491300
         AIF   (T'&PARM2 NE 'N').EXPARM2        Must be a symbol        58539600
&AWK     SETA  K'&PARM2-2                       Length of register      58587900
&CWK     SETC  '&PARM2'(2,&AWK)                 Isolate register        58636200
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR44C Reg invalid  58684500
         AGO   .EXPARM2                        Done                     58732800
.PM2DFLT ANOP ,                                                         58781100
&PARM2V  SETC  '0'                             Default value            58829400
.EXPARM2 ANOP  ,                                                        58877700
.*                                                                      58926000
.********************************************************************** 58974300
.*                                                                    * 59022600
.*       PC parameter                       ( STACKING | BASIC )      * 59070900
.********************************************************************** 59119200
.*                                                                      59167500
         AIF   ('&PC' EQ '').PCBITS         Set default value           59215800
         AIF   (N'&PC GT 1).ERR45B          Too many sublists           59264100
         AIF   ('&PC(1)' EQ 'STACKING').PCBITS   Default value          59312400
         AIF   ('&PC(1)' NE 'BASIC').ERR45       Error...               59360700
         AIF   ('&PC(1)' EQ 'BASIC').ERR45A      Not supported @D63XDUG 59384800
         AGO   .EXPC                        PC=BASIC                    59409000
.PCBITS ANOP ,                                                          59457300
&OBYTE   SETA  &OBYTE+&OBPCTC               PC=STACKING                 59505600
.EXPC ANOP ,                                                            59553900
.*                                                                      59602200
.********************************************************************** 59650500
.*                                                                    * 59698800
.*       PKM parameter                  ( OR | REPLACE )              * 59747100
.********************************************************************** 59795400
.*                                                                      59843700
         AIF   ('&PKM' EQ '').EXPKM         Set default value (OR)      59892000
         AIF   (N'&PKM GT 1).ERR46B         Too many sublists           59940300
         AIF   ('&PKM(1)' EQ 'OR').EXPKM    OR EKM with PKM             59988600
.*                                           in PKM Control reg         60036900
         AIF   ('&PKM(1)' NE 'REPLACE').ERR46 Error...                  60085200
&OBYTE   SETA  &OBYTE+&OBPKMC               REPLACE PKM                 60133500
.*                                           in PKM Control reg         60181800
.EXPKM   ANOP ,                                                         60230100
.*                                                                      60278400
.********************************************************************** 60326700
.*                                                                    * 60375000
.*       PROGRAM/ROUTINE parameters                                   * 60423300
.*                                    Mutually exclusive and required * 60471600
.********************************************************************** 60519900
.*                                                                      60568200
         AIF   ('&PROGRAM' EQ '').NOPROG1        PROGRAM not specified  60616500
         AIF   ('&ROUTINE' NE '').ERR48          ROUTINE specified too  60664800
         AIF   (N'&PROGRAM GT 1).ERR48B          Too many sublists @P1M 60713100
         AIF   ('&PROGRAM'(1,1) EQ '(').ERR48A   Register form invalid  60761400
&L2      SETA  8                                 Maximum name length    60809700
         AIF   ('&PROGRAM'(1,1) EQ '''').PROQUOT Are quotes used...     60858000
&PGM     SETC  '&PROGRAM'                        Set PROGRAM name       60906300
         AIF   (K'&PROGRAM GT &L2).ERR48C        Name too long          60954600
         AGO   .EXPROUT                                                 61002900
.PROQUOT ANOP  ,                                 Name in quotes         61051200
&PGM     SETC  '&PROGRAM'(2,K'&PROGRAM-2)        Set PROGRAM name       61099500
         AIF   (K'&PROGRAM-2 GT &L2).ERR48C      Name too long          61147800
         AGO   .EXPROUT                                                 61196100
.********************************************************************** 61244400
.*                                                                    * 61292700
.*       ROUTINE parameter                                            * 61341000
.********************************************************************** 61389300
.NOPROG1 ANOP  ,                                 Assume ROUTINE...      61437600
         AIF   ('&ROUTINE' EQ '').ERR49          ROUTINE not specified  61485900
         AIF   (N'&ROUTINE GT 1).ERR49B          Too many sublists      61534200
         AIF   ('&ROUTINE(1)' EQ '').ERR49D      ROUTINE=()        @P1A 61582500
         AIF   ('&TYPE(1)' EQ 'SET').RTNVAL      Continue               61630800
         AIF   ('&ROUTINE'(1,1) EQ '(').ERR49A   Register form invalid  61679100
.RTNVAL  ANOP  ,                                                        61727400
&RTNV    SETC  '&ROUTINE(1)'                     ROUTINE value     @D2A 61775700
         AIF   ('&ROUTINE'(1,1) NE '(').EXPROUT  Not register form      61824000
         AIF   (T'&ROUTINE NE 'N').EXPROUT       Must be a symbol       61872300
&AWK     SETA  K'&ROUTINE-2                      Length of register     61920600
&CWK     SETC  '&ROUTINE'(2,&AWK)                Isolate register       61968900
         AIF   ('&CWK' LT '&R1' OR '&CWK' GT '&R2').ERR49C Reg invalid  62017200
.EXPROUT ANOP  ,                                                        62065500
.*                                                                      62113800
.********************************************************************** 62162100
.*                                                                    * 62210400
.*       RAMODE parameter                   31 or 24                  * 62258700
.********************************************************************** 62307000
.*                                                                      62355300
         AIF   ('&RAMODE' EQ '').RAM31           Default AMODE=31  @D2A 62403600
         AIF   (N'&RAMODE GT 1).ERR50B           Too many sublists @D2A 62451900
         AIF   ('&RAMODE(1)' EQ '31').RAM31      Done              @D2A 62500200
         AIF   ('&RAMODE(1)' NE '24').ERR50A     Error             @D2A 62548500
&RTNAMOD SETC  'X''7F'''                         AMODE=24          @D2A 62596800
&AMOD    SETC  'NI'                              NI X'7F'          @D2A 62645100
         AGO   .EXRAMOD                          Done              @D2A 62693400
.RAM31   ANOP  ,                                                   @D2A 62741700
&RTNAMOD SETC  'X''80'''                         Default AMODE=31  @D2A 62790000
&AMOD    SETC  'OI'                              OI X'80'          @D2A 62838300
         AIF   ('&TYPE(1)' EQ 'SET').EXRAMOD     Done if TYPE=SET  @D2A 62886600
&RTNV    SETC  '&ROUTINE(1)+X''80000000'''       For TYPE=ENTRY    @D2A 62934900
.EXRAMOD ANOP  ,                                                   @D2A 62983200
.*                                                                      63031500
.********************************************************************** 63079800
.*                                                                    * 63128100
.*       SASN parameter                     ( OLD | NEW )             * 63176400
.********************************************************************** 63224700
.*                                                                      63273000
         AIF   ('&SASN' EQ '').ERR52        Default not supported       63321301
         AIF   (N'&SASN GT 1).ERR52B        Too many sublists           63369600
         AIF   ('&SASN(1)' EQ 'OLD').ERR52  Default not supported       63417901
         AIF   ('&SASN(1)' NE 'NEW').ERR52  Error...                    63466200
&OBYTE   SETA  &OBYTE+&OBSASN               SASN=PASN of stacking PC    63514500
.EXSASN  ANOP ,                                                         63562800
.*                                                                      63611100
.********************************************************************** 63659400
.*                                                                    * 63707700
.*       SSWITCH parameter                  ( NO | YES )              * 63756000
.********************************************************************** 63804300
.*                                             XM Space Switch          63852600
         AIF   ('&SSWITCH' EQ '').EXSSWIT      Set default value        63900900
         AIF   (N'&SSWITCH GT 1).ERR53B        Too many sublists        63949200
         AIF   ('&SSWITCH(1)' EQ 'NO').EXSSWIT Default                  63997500
         AIF   ('&SSWITCH(1)' NE 'YES').ERR53  Error                    64045800
&FBYTE   SETA  &FBYTE+&FBXMSS                  Space Switch             64094100
.EXSSWIT ANOP ,                                                         64142400
.*                                                                      64190700
.********************************************************************** 64239000
.*                                                                    * 64287300
.*       STATE parameter                    ( PROBLEM | SUPERVISOR )  * 64335600
.********************************************************************** 64383900
.*                                          Program Execution State     64432200
         AIF   ('&STATE' EQ '').EXSTATE     Set default value           64480500
         AIF   (N'&STATE GT 1).ERR54B       Too many sublists           64528800
         AIF   ('&STATE(1)' EQ 'PROBLEM').EXSTATE   Default value       64577100
         AIF   ('&STATE(1)' NE 'SUPERVISOR').ERR54  Error...            64625400
&FBYTE   SETA  &FBYTE+&FBSUP                Supervisor state            64673700
.EXSTATE ANOP ,                                                         64722000
.*                                                                      64770300
.********************************************************************** 64818600
.*                                                                    * 64866900
.*       Check for invalid parameter combinations                     * 64915200
.*                                                                    * 64963500
.********************************************************************** 65011800
         AIF   ('&PC(1)' NE 'BASIC').PCBASIC   PC is not BASIC          65060100
.*                                        PC=BASIC not valid with...    65108400
&NDX     SETA  0                            Init index counter     @L2C 65156700
.PCBLOOP ANOP  ,                            Beginning of loop      @L2C 65205000
&NDX     SETA  &NDX+1                       Increment counter      @L2C 65253300
         AIF   (&NDX GT &K5SIZE).PCBASIC    End of list?           @L2C 65301600
         AIF   ('&KEYS5(&NDX)' EQ '').PCBLOOP Value not specified  @L2C 65349900
         MNOTE 8,' &KEYN5(&NDX) &EM(8)'     Not valid with ENTRY   @L2C 65398200
&IHBERR  SETB  1                            Indicate error         @L2C 65446500
         AGO   .PCBLOOP                     Loop back              @L2C 65494800
.*                                                                      65543100
.PCBASIC ANOP  ,                          End of PC=BASIC checking      65591400
.*--------------------------------------------------------------------- 65639700
.*             If STATE=PROBLEM and EK specified - EKM required    @D3A 65688000
         AIF   ('&STATE' EQ 'PROBLEM' AND '&EK' NE '' AND '&EKM' EQ '')X65736300
               .ERR32C                                             @D3A 65784600
.EKMREQA ANOP  ,                                                   @D3A 65832900
.*                            If PKM=REPLACE then EKM is required  @D2A 65881200
         AIF   ('&PKM(1)' EQ 'REPLACE' AND '&EKM' EQ '').ERR32     @D2A 65929500
.EKMREQD ANOP  ,                                                   @D2A 65977800
.*                            RAMODE is valid only with ROUTINE    @D2A 66026100
         AIF   ('&RAMODE' NE '' AND '&ROUTINE' EQ '').ERR50        @D2A 66074400
.RTNOPT  ANOP  ,                                                   @D2A 66122700
.*--------------------------------------------------------------------- 66171000
.*                            ASYNCH is valid only with ARR        @L2A 66219300
         AIF   ('&ASYNCH' NE '' AND '&ARR' EQ '').ERR27C           @L2A 66267600
.ASYARR  ANOP  ,                                                   @L2A 66315900
.*                            CANCEL is valid only with ARR        @L2A 66364200
         AIF   ('&CANCEL' NE '' AND '&ARR' EQ '').ERR28C           @L2A 66412500
.CANARR  ANOP  ,                                                   @L2A 66460800
.*              CANCEL=NO is valid when the PC routine is in            66509100
.*              supervisor state, or EKM has a system key, or           66557400
.*              AKM has only system keys and PKM=OR                @L2A 66605700
         AIF   ('&CANCEL' EQ '' OR '&CANCEL' EQ 'YES').CANPCSK     @L2A 66654000
         AIF   ('&STATE' EQ 'SUPERVISOR').CANPCSK                  @L2A 66702300
         AIF   (&EKMSYS EQ 1).CANPCSK        System key specified  @D4C 66750600
         AIF   (&AKMUSER EQ 1 OR '&PKM' EQ 'REPLACE').ERR28D       @D4C 66798900
.CANPCSK ANOP  ,                                                   @L2A 66847200
.*                                                                      66895500
.********************************************************************** 66943800
.*                                                                    * 66992100
.*       Generate or set Entry Table Descriptor entry                 * 67040400
.*                                                                    * 67088700
.********************************************************************** 67137000
.*                                                                      67185300
         AIF   ('&TYPE(1)' EQ 'SET').ETDSET    Go reset table           67233600
.*                                                                      67281900
.********************************************************************** 67330200
.*                                                                    * 67378500
.*       GENERATE Entry Table Descriptor entry for                    * 67426800
.*                TYPE=ENTRY                                          * 67475100
.*                                                                    * 67523400
.********************************************************************** 67571700
.*                                                                      67620000
         AIF   ('&IHAETDN' EQ '').ERR08    Ensure INITIAL specified     67668300
         AIF   (&IHBERR EQ 1).EXIT         Exit if errors encountered   67716600
.*                                                                      67764900
&NAME    DC    AL1(&IHAETDI)       INDEX FOR THIS ENTRY                 67813200
&IHAETDI SETA  &IHAETDI+1          Increment ENTRY counter              67861500
         DC    AL1(&FBYTE)         FLAG BYTE                            67909800
         DC    H'0'                RESERVED                             67958100
.*                                            Generate PROGRAM name     68006400
.*                                             or ROUTINE address.      68054700
         AIF   ('&PROGRAM' EQ '').NOPROG2        No PROGRAM             68103000
         DC    CL8'&PGM'           PROGRAM NAME                         68151300
         AGO   .PGMRTNZ                                                 68199600
.NOPROG2 ANOP  ,                                 ROUTINE address        68247900
         DC    A(0)                ZERO PADDING                         68296200
         DC    A(&RTNV)            ROUTINE ADDRESS                 @D2C 68344500
.PGMRTNZ ANOP  ,                                                        68392800
.*                                 Generate AKM and EKM.                68441100
         DC    AL2(&AKMV)          AUTHORIZATION KEY MASK               68489400
         DC    AL2(&EKMV)          ENTRY KEY MASK                       68537700
.*                                                                      68586000
.*                                 Generate USER PARM 1                 68634300
         AIF   ('&PARM1V'(1,1) NE '''').PRM1ADR   Not quoted string     68682600
         DC    CL4&PARM1V          PARAMETER 1                          68730900
         AGO   .PARMX                                                   68779200
.PRM1ADR ANOP  ,                                                        68827500
         DC    A(&PARM1V)          PARAMETER 1                          68875800
.PARMX   ANOP  ,                                                        68924100
.*                                                                      68972400
.********************************************************************** 69020700
.*             FORMAT=1 extension                                     * 69069000
.********************************************************************** 69117300
.*                                 Generate option byte and EAX.        69165600
         DC    AL1(&OBYTE)         ETD OPTIONS BYTE 1                   69213900
         DC    AL1(&EKV.*16)       ENTRY KEY (HIGH ORDER 4 BITS)        69262200
         DC    AL2(&EAXV)          EXTENDED AUTHORIZATION INDEX         69310500
.*                                                                      69358800
.*                                 Generate ARR                         69407100
         AIF   ('&ARRV'(1,1) NE '''').ARRADR   Not quoted string        69455400
         DC    CL8&ARRV            ASSOCIATED RECOVERY ROUTINE NAME     69503700
         AGO   .ARRVX                                                   69552000
.ARRADR  ANOP  ,                                                        69600300
         DC    A(0)                ZERO PADDING                         69648600
         DC    A(&ARRV)            ASSOCIATED RECOVERY ROUTINE ADDRESS  69696900
.ARRVX   ANOP  ,                                                        69745200
.*                                                                      69793500
.*                                 Generate USER PARM 2                 69841800
         AIF   ('&PARM2V'(1,1) NE '''').PRM2ADR   Not quoted string     69890100
         DC    CL4&PARM2V          PARAMETER 2                          69938400
         AGO   .PARM2X                                                  69986700
.PRM2ADR ANOP  ,                                                        70035000
         DC    A(&PARM2V)          PARAMETER 2                          70083300
.PARM2X  ANOP  ,                                                        70131600
.*                                                                      70179900
         DC    AL1(&LPAFB1)        LPA FLAG BYTE 1                 @L2A 70228200
         DC    XL3'0'              RESERVED - MUST BE ZERO         @L2C 70276500
         AGO   .EXIT                                                    70324800
.********************************************************************** 70373100
.*                                                                    * 70421400
.*       SET  Entry Table Descriptor entry for                        * 70469700
.*              TYPE=SET,ETEADR=addr                                  * 70518000
.*                                                                    * 70566300
.********************************************************************** 70614600
.ETDSET  ANOP  ,                                                        70662900
         AIF   (&IHBERR EQ 1).EXIT         Exit if errors encountered   70711200
         AIF   ('&ENTV'(1,1) EQ '+').SETSYM    Symbol form              70759500
.*--------------------------------------------------------------------* 70807800
.*                                             BASE-Register form       70856100
&NAME    MVI   &ETDFLG.(&ENTV),&FBYTE          FLAG BYTE                70904400
.*                                             Reset the PROGRAM name   70952700
.*                                              or ROUTINE address.     71001000
         AIF   ('&PROGRAM' EQ '').RNOPRO3      No PROGRAM name          71049300
&CWK     SETC  '&ETDPRO.(&ETDPROL,&ENTV)'      Target of MVC            71097600
         MVC   &CWK,=CL8'&PGM'                 PROGRAM NAME             71145900
         AGO   .RPGMX                                                   71194200
.RNOPRO3 ANOP  ,                                                        71242500
.*                                             ROUTINE address          71290800
         MVC   &ETDPRO1.(&ETDPR1L,&ENTV),=F'0' ZEROS                    71339100
         AIF   ('&ROUTINE'(1,1) EQ '(').RRTNREG Register format         71387400
&CWK     SETC  '&ETDPRO2.(&ETDPR2L,&ENTV)'      Target of MVC           71435700
         MVC   &CWK,=A(&RTNV)                  ROUTINE ADDRESS     @D2C 71484000
         AGO   .RPGMX                                                   71532300
.RRTNREG ANOP  ,                                                        71580600
         ST    &RTNV,&ETDPRO2.(,&ENTV)         ROUTINE ADDRESS     @D2C 71628900
.RPGMX   ANOP  ,                                                        71677200
         &AMOD &ETDPRO2.(&ENTV),&RTNAMOD       AMODE QUALIFIER     @D2A 71725500
.*                                             Reset the AKM and EKM    71773800
&CWK     SETC  '&ETDAKM.(&ETDAKML,&ENTV)'      Target of MVC            71822100
         MVC   &CWK,=AL2(&AKMV)                AKM                      71870400
&CWK     SETC  '&ETDEKM.(&ETDEKML,&ENTV)'      Target of MVC            71918700
         MVC   &CWK,=AL2(&EKMV)                EKM                      71967000
.*                                                                      72015300
.*                                             Reset USER PARM 1.       72063600
         AIF   ('&PARM1V'(1,1) EQ '(').RPRMREG Register format          72111900
&CWK     SETC  '&ETDPAR.(&ETDPA1L,&ENTV)'      Target of MVC            72160200
         AIF   ('&PARM1V'(1,1) EQ '''').RPRMQU Enclosed in quotes       72208500
         MVC   &CWK,=A(&PARM1V)                PARAMETER 1              72256800
         AGO   .RPRM1X                                                  72305100
.RPRMQU  ANOP  ,                                                        72353400
         MVC   &CWK,=CL4&PARM1V                PARAMETER 1              72401700
         AGO   .RPRM1X                                                  72450000
.RPRMREG ANOP  ,                                                        72498300
         ST    &PARM1(1),&ETDPAR.(,&ENTV)      PARAMETER 1              72546600
.RPRM1X  ANOP  ,                                                        72594900
.*                                                                      72643200
.********************************************************************** 72691500
.*             FORMAT=1 extension              (BASE-register form)   * 72739800
.********************************************************************** 72788100
.*                                                                      72836400
         MVI   &ETDOPT1.(&ENTV),&OBYTE         ETD OPTION BYTE 1        72884700
.*                                             Reset the EK             72933000
         MVI   &ETDEK.(&ENTV),&EKV.*16         ENTRY KEY (HIGH 4 BITS)  72981300
.*                                             Reset the EAX            73029600
         AIF   ('&EAXV'(1,1) EQ '(').REAXREG   Register format          73077900
&CWK     SETC  '&ETDEAX.(&ETDEAXL,&ENTV)'      Target of MVC            73126200
         AIF   (T'&EAX EQ 'O').REAXDEC         Default value       @P5A 73174500
         AIF   (T'&EAX EQ 'N').REAXDEC         Positive number          73222800
         MVC   &CWK,&EAXV                      EAX                      73271100
         AGO   .REAXX                                                   73319400
.REAXDEC ANOP ,                                                         73367700
         MVC   &CWK,=AL2(&EAXV)                EAX                      73416000
         AGO   .REAXX                                                   73464300
.REAXREG ANOP  ,                                                        73512600
         STH   &EAX(1),&ETDEAX.(,&ENTV)        EAX                      73560900
.REAXX   ANOP  ,                                                        73609200
.*                       Reset the ASSOCIATED RECOVERY ROUTINE ADDRESS  73657500
         AIF   ('&ARRV'(1,1) NE '''').RNOARRQ  Not ARR quoted name      73705800
&CWK     SETC  '&ETDARR.(&ETDARRL,&ENTV)'      Target of MVC            73754100
         MVC   &CWK,=CL8&ARRV                  ASSOC RECOVERY RTN NAME  73802400
         AGO   .RARRX                                                   73850700
.RNOARRQ ANOP  ,                                                        73899000
.*                                             ARR address              73947300
         MVC   &ETDARR1.(&ETDAR1L,&ENTV),=F'0' ZEROS                    73995600
         AIF   ('&ARRV'(1,1) EQ '(').RARRREG   Register format          74043900
&CWK     SETC  '&ETDARR2.(&ETDAR2L,&ENTV)'      Target of MVC           74092200
         MVC   &CWK,=A(&ARRV)                  ASSOC RECOVERY RTN ADDR  74140500
         AGO   .RARRX                                                   74188800
.RARRREG ANOP  ,                                                        74237100
         ST    &ARR(1),&ETDARR2.(,&ENTV)       ASSOC RECOVERY RTN ADDR  74285400
.RARRX   ANOP  ,                                                        74333700
.*                                             Reset USER PARM2         74382000
         AIF   ('&PARM2V'(1,1) EQ '(').RPM2REG Register format          74430300
&CWK     SETC  '&ETDPAR2.(&ETDPA2L,&ENTV)'     Target of MVC            74478600
         AIF   ('&PARM2V'(1,1) EQ '''').RPM2QU Enclosed in quotes       74526900
         MVC   &CWK,=A(&PARM2V)                PARAMETER 2              74575200
         AGO   .RPRM2X                                                  74623500
.RPM2QU  ANOP  ,                                                        74671800
         MVC   &CWK,=CL4&PARM2V                PARAMETER 2              74720100
         AGO   .RPRM2X                                                  74768400
.RPM2REG ANOP ,                                                         74816700
         ST    &PARM2(1),&ETDPAR2.(,&ENTV)     PARAMETER 2              74865000
.RPRM2X  ANOP  ,                                                        74913300
         MVI   &ETDLPA1.(&ENTV),&LPAFB1        LPA FLAG BYTE 1     @L2A 74961600
         AGO   .EXIT                                                    75009900
.*                                                                      75058200
.*--------------------------------------------------------------------* 75106500
.SETSYM  ANOP  ,                                                        75154800
.*                                             BASE-Symbol form         75203100
&NAME    MVI   &ETDFLG.&ENTV,&FBYTE            FLAG BYTE                75251400
.*                                             Reset the PROGRAM name   75299700
.*                                              or ROUTINE address.     75348000
         AIF   ('&PROGRAM' EQ '').SNOPRO3      No PROGRAM name          75396300
&CWK     SETC  '&ETDPRO.&ENTV.(&ETDPROL)'      Target of MVC            75444600
         MVC   &CWK,=CL8'&PGM'                 PROGRAM NAME             75492900
         AGO   .SPGMX                                                   75541200
.SNOPRO3 ANOP  ,                                                        75589500
.*                                             ROUTINE address          75637800
         MVC   &ETDPRO1.&ENTV.(&ETDPR1L),=F'0' ZEROS                    75686100
         AIF   ('&ROUTINE'(1,1) EQ '(').SRTNREG Register format         75734400
&CWK     SETC  '&ETDPRO2.&ENTV.(&ETDPR2L)'      Target of MVC           75782700
         MVC   &CWK,=A(&RTNV)                  ROUTINE ADDRESS     @D2C 75831000
         AGO   .SPGMX                                                   75879300
.SRTNREG ANOP  ,                                                        75927600
         ST    &RTNV,&ETDPRO2.&ENTV            ROUTINE ADDRESS     @D2C 75975900
.SPGMX   ANOP  ,                                                        76024200
         &AMOD &ETDPRO2.&ENTV,&RTNAMOD         AMODE QUALIFIER     @D2A 76072500
.*                                             Reset the AKM and EKM    76120800
&CWK     SETC  '&ETDAKM.&ENTV.(&ETDAKML)'      Target of MVC            76169100
         MVC   &CWK,=AL2(&AKMV)                AKM                      76217400
&CWK     SETC  '&ETDEKM.&ENTV.(&ETDEKML)'      Target of MVC            76265700
         MVC   &CWK,=AL2(&EKMV)                EKM                      76314000
.*                                                                      76362300
.*                                             Reset USER PARM 1.       76410600
         AIF   ('&PARM1V'(1,1) EQ '(').SPRMREG Register format          76458900
&CWK     SETC  '&ETDPAR.&ENTV.(&ETDPA1L)'      Target of MVC            76507200
         AIF   ('&PARM1V'(1,1) EQ '''').SPRMQU Enclosed in quotes       76555500
         MVC   &CWK,=A(&PARM1V)                PARAMETER 1              76603800
         AGO   .SPRM1X                                                  76652100
.SPRMQU  ANOP  ,                                                        76700400
         MVC   &CWK,=CL4&PARM1V                PARAMETER 1              76748700
         AGO   .SPRM1X                                                  76797000
.SPRMREG ANOP  ,                                                        76845300
         ST    &PARM1(1),&ETDPAR.&ENTV         PARAMETER 1              76893600
.SPRM1X  ANOP  ,                                                        76941900
.*                                                                      76990200
.********************************************************************** 77038500
.*             FORMAT=1 extension              (BASE-symbol form)     * 77086800
.********************************************************************** 77135100
.*                                                                      77183400
         MVI   &ETDOPT1.&ENTV,&OBYTE           ETD OPTION BYTE 1        77231700
.*                                             Reset the EK             77280000
         MVI   &ETDEK.&ENTV,&EKV.*16           ENTRY KEY (HIGH 4 BITS)  77328300
.*                                             Reset the EAX            77376600
         AIF   ('&EAXV'(1,1) EQ '(').SEAXREG   Register format          77424900
&CWK     SETC  '&ETDEAX.&ENTV.(&ETDEAXL)'      Target of MVC            77473200
         AIF   (T'&EAX EQ 'O').SEAXDEC         Default value       @P5A 77521500
         AIF   (T'&EAX EQ 'N').SEAXDEC         Positive number          77569800
         MVC   &CWK,&EAXV                      EAX                      77618100
         AGO   .SEAXX                                                   77666400
.SEAXDEC ANOP ,                                                         77714700
         MVC   &CWK,=AL2(&EAXV)                EAX                      77763000
         AGO   .SEAXX                                                   77811300
.SEAXREG ANOP  ,                                                        77859600
         STH   &EAX(1),&ETDEAX.&ENTV           EAX                      77907900
.SEAXX   ANOP  ,                                                        77956200
.*                       Reset the ASSOCIATED RECOVERY ROUTINE ADDRESS  78004500
         AIF   ('&ARRV'(1,1) NE '''').SNOARRQ  Not ARR quoted name      78052800
&CWK     SETC  '&ETDARR.&ENTV.(&ETDARRL)'      Target of MVC            78101100
         MVC   &CWK,=CL8&ARRV                  ASSOC RECOVERY RTN NAME  78149400
         AGO   .SARRX                                                   78197700
.SNOARRQ ANOP  ,                                                        78246000
.*                                             ARR address              78294300
         MVC   &ETDARR1.&ENTV.(&ETDAR1L),=F'0' ZEROS                    78342600
         AIF   ('&ARRV'(1,1) EQ '(').SARRREG   Register format          78390900
&CWK     SETC  '&ETDARR2.&ENTV.(&ETDAR2L)'      Target of MVC           78439200
         MVC   &CWK,=A(&ARRV)                  ASSOC RECOVERY RTN ADDR  78487500
         AGO   .SARRX                                                   78535800
.SARRREG ANOP  ,                                                        78584100
         ST    &ARR(1),&ETDARR2.&ENTV          ASSOC RECOVERY RTN ADDR  78632400
.SARRX   ANOP  ,                                                        78680700
.*                                             Reset USER PARM2         78729000
         AIF   ('&PARM2V'(1,1) EQ '(').SPM2REG Register format          78777300
&CWK     SETC  '&ETDPAR2.&ENTV.(&ETDPA2L)'     Target of MVC            78825600
         AIF   ('&PARM2V'(1,1) EQ '''').SPM2QU Enclosed in quotes       78873900
         MVC   &CWK,=A(&PARM2V)                PARAMETER 2              78922200
         AGO   .SPRM2X                                                  78970500
.SPM2QU  ANOP  ,                                                        79018800
         MVC   &CWK,=CL4&PARM2V                PARAMETER 2              79067100
         AGO   .SPRM2X                                                  79115400
.SPM2REG ANOP ,                                                         79163700
         ST    &PARM2(1),&ETDPAR2.&ENTV        PARAMETER 2              79212000
.SPRM2X  ANOP  ,                                                        79260300
         MVI   &ETDLPA1.&ENTV,&LPAFB1          LPA FLAG BYTE 1     @L2A 79308600
         AGO   .EXIT                                                    79356900
.*                                                                      79405200
.********************************************************************** 79453500
.*                                                                    * 79501800
.*       MNOTES                                                       * 79550100
.*                                                                    * 79598400
.********************************************************************** 79646700
.*                                                                      79695000
.ERR01   ANOP  ,                                                        79743300
         MNOTE 8,' TOO MANY POSITIONAL PARAMETERS'                      79791600
&IHBERR  SETB  1                    Indicate error                      79839900
         AGO   .EXPOS               Continue keyword validation         79888200
.*                                                                      79936500
.ERR02   ANOP  ,                                                        79984800
         MNOTE 8,' TYPE PARAMETER IS REQUIRED'                          80033100
         AGO   .EXIT                Done                                80081400
.*                                                                      80129700
.ERR02A  ANOP  ,                                                   @P1C 80178000
         MNOTE 8,' TYPE &EM(4)'     Too many sublists              @P1C 80226300
&IHBERR  SETB  1                    Indicate error                      80274600
         AGO   .CKTYPE              Continue keyword validation         80322900
.*                                                                      80371200
.ERR02B  ANOP  ,                                                   @P1A 80419500
         MNOTE 8,' TYPE &EM(9)'     Missing sublist value          @P1A 80467800
         AGO   .EXIT                Done                           @P1A 80516100
.*                                                                      80564400
.ERR04   ANOP  ,                                                        80612700
         MNOTE 8,' TYPE PARAMETER IS NOT VALID - &TYPE'                 80661000
         AGO   .EXIT                Done                                80709300
.*                                                                      80757600
.ERR08   ANOP  ,                                                        80805900
         MNOTE 8,' ETDEF TYPE=&TYPE IS NOT PRECEDED BY ETDEF TYPE=INITIX80854200
               AL'                                                      80902500
         AGO   .EXIT                Done                                80950800
.*                                                                      80999100
.ERR09   ANOP  ,                                                        81047400
       MNOTE 8,' ETEADR OR HEADER MUST BE SPECIFIED WHEN TYPE=&TYPE'    81095700
         AGO   .EXIT                Done                                81144000
.********************************************************************** 81192300
.ERR22   ANOP  ,                                                        81240600
         MNOTE 8,' AKM &EM(5)'      Parameter is required               81288900
&IHBERR  SETB  1                    Indicate error                      81337200
         AGO   .EXAKM               Continue keyword validation         81385500
.*                                                                      81433800
.WAR22   ANOP    ,                                                      81482100
         MNOTE 4,' AKM &EM(6) &SUB - IGNORED'     Missing sublist  @P1C 81530400
         AGO   .AKMNEXT             Continue sublist validation         81578700
.*                                                                      81627000
.ERR22A  ANOP  ,                                                        81675300
         MNOTE 8,' AKM PARAMETER SUBLIST VALUE IS NOT VALID - &VALUE '  81723600
&IHBERR  SETB  1                    Indicate error                      81771900
         AGO   .AKMNEXT             Continue sublist validation         81820200
.*                                                                      81868500
.ERR22B  ANOP  ,                                                   @P2A 81916800
         MNOTE 8,' AKM &EM(9)'      No valid value                 @P2A 81965100
&IHBERR  SETB  1                    Indicate error                 @P2A 82013400
         AGO   .EXAKM               Continue keyword validation    @P2A 82061700
.********************************************************************** 82110000
.ERR25   ANOP  ,                                                        82158300
         MNOTE 8,' ARR &EM(7)'      Not use a register                  82206600
&IHBERR  SETB  1                    Indicate error                      82254900
         AGO   .EXARR               Continue keyword validation         82303200
.*                                                                      82351500
.ERR25A  ANOP  ,                                                   @D1A 82399800
         MNOTE 8,' ARR MUST BE FROM 1 TO &L2 CHARACTERS'           @D1A 82448100
&IHBERR  SETB  1                    Indicate error                 @D1A 82496400
         AGO   .EXARR               Continue keyword validation    @D1A 82544700
.*                                                                      82593000
.ERR25B  ANOP  ,                                                        82641300
         MNOTE 8,' ARR &EM(4)'      Too many sublists                   82689600
&IHBERR  SETB  1                    Indicate error                      82737900
         AGO   .EXARR               Continue keyword validation         82786200
.*                                                                      82834500
.ERR25C  ANOP  ,                                                        82882800
         MNOTE 8,' ARR MUST USE REGISTER &R1 THRU &R2'                  82931100
&IHBERR  SETB  1                    Indicate error                      82979400
         AGO   .EXARR               Continue keyword validation         83027700
.*                                                                      83076000
.********************************************************************** 83124300
.ERR26   ANOP  ,                                                        83172600
         MNOTE 8,' ASCMODE PARAMETER MUST BE ''PRIMARY'' OR ''AR'''     83220900
&IHBERR  SETB  1                    Indicate error                      83269200
         AGO   .EXASCM              Continue keyword validation         83317500
.*                                                                      83365800
.ERR26B  ANOP  ,                                                        83414100
         MNOTE 8,' ASCMODE &EM(4)'  Too many sublists                   83462400
&IHBERR  SETB  1                    Indicate error                      83510700
         AGO   .EXASCM              Continue keyword validation         83559000
.*                                                                      83607300
.********************************************************************** 83655600
.ERR27   ANOP  ,                                                   @L2A 83703900
         MNOTE 8,' ASYNCH &EM(10)'  Must be YES or NO              @L2A 83752200
&IHBERR  SETB  1                    Indicate error                 @L2A 83800500
         AGO   .EXASYNC             Continue keyword validation    @L2A 83848800
.*                                                                 @L2A 83897100
.ERR27A  ANOP  ,                                               @D63XDUG 83905100
         MNOTE 8,' ASYNCH=NO &EM(12)' Not supported in VSE/ESA @D63XDUG 83913100
&IHBERR  SETB  1                    Indicate error             @D63XDUG 83921100
         AGO   .EXASYNC             Continue keyword validation@D63XDUG 83929100
.*                                                             @D63XDUG 83937100
.ERR27B  ANOP  ,                                                   @L2A 83945400
         MNOTE 8,' ASYNCH &EM(4)'   Too many sublists              @L2A 83993700
&IHBERR  SETB  1                    Indicate error                 @L2A 84042000
         AGO   .EXASYNC             Continue keyword validation    @L2A 84090300
.*                                                                 @L2A 84138600
.ERR27C  ANOP  ,                                                   @L2A 84186900
         MNOTE 8,' ASYNCH &EM(11) ARR' Invalid without ARR         @L2A 84235200
&IHBERR  SETB  1                    Indicate error                 @L2A 84283500
         AGO   .ASYARR              Continue keyword validation    @L2A 84331800
.********************************************************************** 84380100
.ERR28   ANOP  ,                                                   @L2A 84428400
         MNOTE 8,' CANCEL &EM(10)'  Must be YES or NO              @L2A 84476700
&IHBERR  SETB  1                    Indicate error                 @L2A 84525000
         AGO   .EXCANCL             Continue keyword validation    @L2A 84573300
.*                                                                 @L2A 84621600
.ERR28A  ANOP  ,                                               @D63XDUG 84629600
         MNOTE 8,' CANCEL=NO &EM(12)' Not supported in VSE/ESA @D63XDUG 84637600
&IHBERR  SETB  1                    Indicate error             @D63XDUG 84645600
         AGO   .EXCANCL             Continue keyword validation@D63XDUG 84653600
.*                                                             @D63XDUG 84661600
.ERR28B  ANOP  ,                                                   @L2A 84669900
         MNOTE 8,' CANCEL &EM(4)'   Too many sublists              @L2A 84718200
&IHBERR  SETB  1                    Indicate error                 @L2A 84766500
         AGO   .EXCANCL             Continue keyword validation    @L2A 84814800
.*                                                                 @L2A 84863100
.ERR28C  ANOP  ,                                                   @L2A 84911400
         MNOTE 8,' CANCEL &EM(11) ARR' Invalid without ARR         @L2A 84959700
&IHBERR  SETB  1                    Indicate error                 @L2A 85008000
         AGO   .CANARR              Continue keyword validation    @L2A 85056300
.*                                                                 @L2A 85104600
.ERR28D  ANOP  ,                                                   @L2A 85152900
         MNOTE 8,' CANCEL=NO IS ONLY VALID WHEN THE PC ROUTINE IS IN SU*85201200
               PERVISOR   STATE, OR EKM SPECIFIED A SYSTEM KEY, OR AKM *85249500
               HAS ONLY   SYSTEM KEYS AND PKM=OR.'                 @L2A 85297800
&IHBERR  SETB  1                    Indicate error                 @L2A 85346100
         AGO   .CANPCSK             Continue keyword validation    @L2A 85394400
.********************************************************************** 85442700
.ERR29   ANOP  ,                                                        85491000
         MNOTE 8,' EAX &EM(7)'      Not use a register                  85539300
&IHBERR  SETB  1                    Indicate error                      85587600
         AGO   .EXEAX               Continue keyword validation         85635900
.*                                                                      85684200
.ERR29A  ANOP  ,                                                   @P4A 85732500
         MNOTE 8,' EAX PARAMETER IS NOT VALID - &EAX(1) '          @P4A 85780800
&IHBERR  SETB  1                    Indicate error                 @P4A 85829100
         AGO   .EXEAX               Continue sublist validation    @P4A 85877400
.*                                                                      85925700
.ERR29B  ANOP  ,                                                        85974000
         MNOTE 8,' EAX &EM(4)'      Too many sublists                   86022300
&IHBERR  SETB  1                    Indicate error                      86070600
         AGO   .EXEAX               Continue keyword validation         86118900
.*                                                                      86167200
.ERR29C  ANOP  ,                                                        86215500
         MNOTE 8,' EAX MUST USE REGISTER &R1 THRU &R2'                  86263800
&IHBERR  SETB  1                    Indicate error                      86312100
         AGO   .EXEAX               Continue keyword validation         86360400
.*                                                                      86408700
.********************************************************************** 86457000
.ERR31   ANOP  ,                                                        86505300
        MNOTE 8,' EK PARAMETER MUST BE A DECIMAL VALUE FROM &L1 TO &L2' 86553600
&IHBERR  SETB  1                    Indicate error                      86601900
         AGO   .EXEK                Continue keyword validation         86650200
.*                                                                      86698500
.ERR31B  ANOP  ,                                                        86746800
         MNOTE 8,' EK &EM(4)'       Too many sublists                   86795100
&IHBERR  SETB  1                    Indicate error                      86843400
         AGO   .EXEK                Continue keyword validation         86891700
.*                                                                      86940000
.********************************************************************** 86988300
.ERR32   ANOP  ,                                                        87036600
         MNOTE 8,' EKM PARAMETER IS REQUIRED WITH PKM=REPLACE'     @D2C 87084900
&IHBERR  SETB  1                    Indicate error                      87133200
         AGO   .EKMREQD             Continue keyword validation    @D2C 87181500
.*                                                                      87229800
.WAR32   ANOP    ,                                                      87278100
         MNOTE 4,' EKM &EM(6) &SUB - IGNORED'     Missing sublist  @P1C 87326400
         AGO   .EKMNEXT             Continue sublist validation         87374700
.*                                                                      87423000
.ERR32A  ANOP  ,                                                        87471300
         MNOTE 8,' EKM PARAMETER SUBLIST VALUE IS NOT VALID - &VALUE '  87519600
&IHBERR  SETB  1                    Indicate error                      87567900
         AGO   .EKMNEXT             Continue sublist validation         87616200
.*                                                                      87664500
.ERR32B  ANOP  ,                                                   @P2A 87712800
         MNOTE 8,' EKM &EM(9)'      No valid value                 @P2A 87761100
&IHBERR  SETB  1                    Indicate error                 @P2A 87809400
         AGO   .EXEKM               Continue keyword validation    @P2A 87857700
.*                                                                      87906000
.ERR32C  ANOP  ,                                                   @D3A 87954300
        MNOTE 8,' EKM PARAMETER IS REQUIRED WITH EK AND STATE=PROBLEM'  88002600
&IHBERR  SETB  1                    Indicate error                 @D3A 88050900
         AGO   .EKMREQA             Continue keyword validation    @D3A 88099200
.********************************************************************** 88147500
.ERR34   ANOP  ,                                                        88195800
         MNOTE 8,' ETEADR MUST USE REGISTER &ER1 THRU &ER2'             88244100
&IHBERR  SETB  1                    Indicate error                      88292400
         AGO   .EXETEAD             Continue keyword validation         88340700
.*                                                                      88389000
.ERR34B  ANOP  ,                                                        88437300
         MNOTE 8,' ETEADR &EM(4)'   Too many sublists                   88485600
&IHBERR  SETB  1                    Indicate error                      88533900
         AGO   .EXETEAD             Continue keyword validation         88582200
.********************************************************************** 88630500
.ERR37A  ANOP  ,                                                        88678800
         MNOTE 8,' HEADER MUST USE REGISTER &ER1 THRU &ER2'             88727100
&IHBERR  SETB  1                    Indicate error                      88775400
         AGO   .EXHEAD              Continue keyword validation         88823700
.*                                                                      88872000
.ERR37B  ANOP  ,                                                        88920300
         MNOTE 8,' HEADER &EM(4)'   Too many sublists                   88968600
&IHBERR  SETB  1                    Indicate error                      89016900
         AGO   .EXHEAD              Continue keyword validation         89065200
.********************************************************************** 89113500
.ERR39   ANOP  ,                                                        89161800
         MNOTE 8,' NUMETE PARAMETER IS REQUIRED WITH HEADER'            89210100
&IHBERR  SETB  1                    Indicate error                      89258400
         AGO   .EXNUMET             Continue keyword validation         89306700
.*                                                                      89355000
.ERR39A  ANOP  ,                                                        89403300
         MNOTE 8,' NUMETE PARAMETER MUST BE A DECIMAL VALUE FROM &L1 TOX89451600
                &L2'                                                    89499900
&IHBERR  SETB  1                    Indicate error                      89548200
         AGO   .EXNUMET             Continue keyword validation         89596500
.*                                                                      89644800
.ERR39B  ANOP  ,                                                        89693100
         MNOTE 8,' NUMETE &EM(4)'   Too many sublists                   89741400
&IHBERR  SETB  1                    Indicate error                      89789700
         AGO   .EXNUMET             Continue keyword validation         89838000
.*                                                                      89886300
.ERR39C  ANOP  ,                                                        89934600
         MNOTE 8,' NUMETE MUST USE REGISTER &R1 THRU &R2'               89982900
&IHBERR  SETB  1                    Indicate error                      90031200
         AGO   .EXNUMET             Continue keyword validation         90079500
.********************************************************************** 90127800
.ERR43   ANOP  ,                                                        90176100
         MNOTE 8,' PARM1 &EM(7)'    Not use a register                  90224400
&IHBERR  SETB  1                    Indicate error                      90272700
         AGO   .EXPARM1             Continue keyword validation         90321000
.*                                                                      90369300
.ERR43A  ANOP  ,                                                        90417600
         MNOTE 8,' PARM1 MUST BE FROM 1 TO &L2 CHARACTERS'              90465900
&IHBERR  SETB  1                    Indicate error                      90514200
         AGO   .EXPARM1             Continue keyword validation         90562500
.*                                                                      90610800
.ERR43B  ANOP  ,                                                        90659100
         MNOTE 8,' PARM1 &EM(4)'    Too many sublists                   90707400
&IHBERR  SETB  1                    Indicate error                      90755700
         AGO   .EXPARM1             Continue keyword validation         90804000
.*                                                                      90852300
.ERR43C  ANOP  ,                                                        90900600
         MNOTE 8,' PARM1 MUST USE REGISTER &R1 THRU &R2'                90948900
&IHBERR  SETB  1                    Indicate error                      90997200
         AGO   .EXPARM1             Continue keyword validation         91045500
.********************************************************************** 91093800
.ERR44   ANOP  ,                                                        91142100
         MNOTE 8,' PARM2 &EM(7)'    Not use a register                  91190400
&IHBERR  SETB  1                    Indicate error                      91238700
         AGO   .EXPARM2             Continue keyword validation         91287000
.*                                                                      91335300
.ERR44A  ANOP  ,                                                        91383600
         MNOTE 8,' PARM2 MUST BE FROM 1 TO &L2 CHARACTERS'              91431900
&IHBERR  SETB  1                    Indicate error                      91480200
         AGO   .EXPARM2             Continue keyword validation         91528500
.*                                                                      91576800
.ERR44B  ANOP  ,                                                        91625100
         MNOTE 8,' PARM2 &EM(4)'    Too many sublists                   91673400
&IHBERR  SETB  1                    Indicate error                      91721700
         AGO   .EXPARM2             Continue keyword validation         91770000
.*                                                                      91818300
.ERR44C  ANOP  ,                                                        91866600
         MNOTE 8,' PARM2 MUST USE REGISTER &R1 THRU &R2'                91914900
&IHBERR  SETB  1                    Indicate error                      91963200
         AGO   .EXPARM2             Continue keyword validation         92011500
.********************************************************************** 92059800
.ERR45   ANOP  ,                                                        92108100
         MNOTE 8,' PC PARAMETER MUST BE ''STACKING'' OR ''BASIC'''      92156400
&IHBERR  SETB  1                    Indicate error                      92204700
         AGO   .EXPC                Continue keyword validation         92253000
.*                                                                      92301300
.ERR45A  ANOP  ,                                               @D63XDUG 92309300
         MNOTE 8,' PC=BASIC &EM(12)' Not supported in VSE/ESA  @D63XDUG 92317300
&IHBERR  SETB  1                    Indicate error             @D63XDUG 92325300
         AGO   .EXPC                Continue keyword validation@D63XDUG 92333300
.*                                                             @D63XDUG 92341300
.ERR45B  ANOP  ,                                                        92349600
         MNOTE 8,' PC &EM(4)'       Too many sublists                   92397900
&IHBERR  SETB  1                    Indicate error                      92446200
         AGO   .EXPC                Continue keyword validation         92494500
.********************************************************************** 92542800
.ERR46   ANOP  ,                                                        92591100
         MNOTE 8,' PKM PARAMETER MUST BE ''OR'' OR ''REPLACE'''         92639400
&IHBERR  SETB  1                    Indicate error                      92687700
         AGO   .EXPKM               Continue keyword validation         92736000
.*                                                                      92784300
.ERR46B  ANOP  ,                                                        92832600
         MNOTE 8,' PKM &EM(4)'      Too many sublists                   92880900
&IHBERR  SETB  1                    Indicate error                      92929200
         AGO   .EXPKM               Continue keyword validation         92977500
.*                                                                      93025800
.********************************************************************** 93074100
.ERR48   ANOP  ,                                                        93122400
         MNOTE 8,' PROGRAM AND ROUTINE ARE MUTUALLY EXCLUSIVE'          93170700
&IHBERR  SETB  1                    Indicate error                      93219000
         AGO   .EXPROUT             Continue keyword validation         93267300
.*                                                                      93315600
.ERR48A  ANOP  ,                                                        93363900
         MNOTE 8,' PROGRAM &EM(7)'  Not use a register                  93412200
&IHBERR  SETB  1                    Indicate error                      93460500
         AGO   .EXPROUT             Continue keyword validation         93508800
.*                                                                      93557100
.ERR48B  ANOP  ,                                                        93605400
         MNOTE 8,' PROGRAM &EM(4)'  Too many sublists                   93653700
&IHBERR  SETB  1                    Indicate error                      93702000
         AGO   .EXPROUT             Continue keyword validation         93750300
.*                                                                      93798600
.ERR48C  ANOP  ,                                                        93846900
         MNOTE 8,' PROGRAM=&PGM EXCEEDS &L2 CHARACTERS'                 93895200
&IHBERR  SETB  1                    Indicate error                      93943500
         AGO   .EXPROUT             Continue keyword validation         93991800
.********************************************************************** 94040100
.ERR49   ANOP  ,                                                        94088400
         MNOTE 8,' PROGRAM OR ROUTINE MUST BE SPECIFIED'                94136700
&IHBERR  SETB  1                    Indicate error                      94185000
         AGO   .EXPROUT             Continue keyword validation         94233300
.*                                                                      94281600
.ERR49A  ANOP  ,                                                        94329900
         MNOTE 8,' ROUTINE &EM(7)'  Not use a register                  94378200
&IHBERR  SETB  1                    Indicate error                      94426500
         AGO   .EXPROUT             Continue keyword validation         94474800
.*                                                                      94523100
.ERR49B  ANOP  ,                                                        94571400
         MNOTE 8,' ROUTINE &EM(4)'  Too many sublists                   94619700
&IHBERR  SETB  1                    Indicate error                      94668000
         AGO   .EXPROUT             Continue keyword validation         94716300
.*                                                                      94764600
.ERR49C  ANOP  ,                                                        94812900
         MNOTE 8,' ROUTINE MUST USE REGISTER &R1 THRU &R2'              94861200
&IHBERR  SETB  1                    Indicate error                      94909500
         AGO   .EXPROUT             Continue keyword validation         94957800
.*                                                                      95006100
.ERR49D  ANOP  ,                                                   @P1A 95054400
         MNOTE 8,' ROUTINE &EM(9)'  Missing value                  @P1A 95102700
&IHBERR  SETB  1                    Indicate error                 @P1A 95151000
         AGO   .EXPROUT             Continue keyword validation    @P1A 95199300
.********************************************************************** 95247600
.ERR50   ANOP  ,                                                   @D2A 95295900
         MNOTE 8,' RAMODE &EM(11) ROUTINE'                         @L2C 95344200
&IHBERR  SETB  1                    Indicate error                 @D2A 95392500
         AGO   .RTNOPT              Continue keyword validation    @D2A 95440800
.*                                                                 @D2A 95489100
.ERR50A  ANOP  ,                                                   @D2A 95537400
         MNOTE 8,' RAMODE PARAMETER MUST BE ''31'' OR ''24'''      @D2A 95585700
&IHBERR  SETB  1                    Indicate error                 @D2A 95634000
         AGO   .EXRAMOD             Continue keyword validation    @D2A 95682300
.*                                                                 @D2A 95730600
.ERR50B  ANOP  ,                                                   @D2A 95778900
         MNOTE 8,' RAMODE &EM(4)' Too many sublists                @D2A 95827200
&IHBERR  SETB  1                    Indicate error                 @D2A 95875500
         AGO   .EXRAMOD             Continue keyword validation    @D2A 95923800
.********************************************************************** 95972100
.ERR52   ANOP  ,                                                        96020400
         MNOTE 8,' SASN = NEW MUST BE SPECIFIED.'                       96068702
&IHBERR  SETB  1                    Indicate error                      96117000
         AGO   .EXSASN              Continue keyword validation         96165300
.*                                                                      96213600
.ERR52B  ANOP  ,                                                        96261900
         MNOTE 8,' SASN &EM(4)'     Too many sublists                   96310200
&IHBERR  SETB  1                    Indicate error                      96358500
         AGO   .EXSASN              Continue keyword validation         96406800
.*                                                                      96455100
.********************************************************************** 96503400
.ERR53   ANOP  ,                                                        96551700
         MNOTE 8,' SSWITCH &EM(10)' Must be YES or NO                   96600000
&IHBERR  SETB  1                    Indicate error                      96648300
         AGO   .EXSSWIT             Continue keyword validation         96696600
.*                                                                      96744900
.ERR53B  ANOP  ,                                                        96793200
         MNOTE 8,' SSWITCH &EM(4)'  Too many sublists                   96841500
&IHBERR  SETB  1                    Indicate error                      96889800
         AGO   .EXSSWIT             Continue keyword validation         96938100
.********************************************************************** 96986400
.ERR54   ANOP  ,                                                        97034700
       MNOTE 8,' STATE PARAMETER MUST BE ''PROBLEM'' OR ''SUPERVISOR''' 97083000
&IHBERR  SETB  1                    Indicate error                      97131300
         AGO   .EXSTATE             Continue keyword validation         97179600
.*                                                                      97227900
.ERR54B  ANOP  ,                                                        97276200
         MNOTE 8,' STATE &EM(4)'    Too many sublists                   97324500
&IHBERR  SETB  1                    Indicate error                      97372800
         AGO   .EXSTATE             Continue keyword validation         97421100
.*                                                                      97469400
.********************************************************************** 97517700
.ERR55   ANOP  ,                                                   @01A 97566000
         MNOTE 8,' RECORD &EM(10)'  Must be YES or NO              @01A 97614300
&IHBERR  SETB  1                    Indicate error                 @01A 97662600
         AGO   .EXRECRD             Continue keyword validation    @01A 97710900
.*                                                                 @01A 97759200
.ERR55B  ANOP  ,                                                   @01A 97807500
         MNOTE 8,' RECORD &EM(4)'   Too many sublists              @01A 97855800
&IHBERR  SETB  1                    Indicate error                 @01A 97904100
         AGO   .EXRECRD             Continue keyword validation    @01A 97952400
.*                                                                      98000700
.********************************************************************** 98049000
.*                                                                    * 98097300
.*       EXIT                                                         * 98145600
.*                                                                    * 98193900
.********************************************************************** 98242200
.EXIT    ANOP  ,                                                        98290500
         MNOTE ' '                    Null MNOTES allow spacing to      98338800
         MNOTE ' '                     occur if NOGEN specified         98387100
         MEND ,                                                         98435400
**/                                                                     98483700
* ETDEF:                                                                98532000
*    MACRO                                                              98580300
*     KEYS     (TYPE,         /* INITIAL | ENTRY | SET | FINAL       */ 98628600
*               AKM,          /* Authorization Key Mask              */ 98676900
*               ARR,          /* Associated Recovery Routine Address */ 98725200
*               ASCMODE,      /* PRIMARY | AR                        */ 98773500
*               ASYNCH,       /* YES | NO                        @L2A*/ 98821800
*               CANCEL,       /* YES | NO                        @L2A*/ 98870100
*               EAX,          /* Extended Authorization index        */ 98918400
*               EK,           /* Entry Key                           */ 98966700
*               EKM,          /* Entry Key Mask                      */ 99015000
*               ETEADR,       /* ENTRY address/name                  */ 99063300
*               HEADER,       /* HEADER address/name                 */ 99111600
*               NUMETE,       /* Number of entries                   */ 99159900
*               PARM1,        /* User parameter 1                    */ 99208200
*               PARM2,        /* User parameter 2                    */ 99256500
*               PC,           /* STACKING | BASIC                    */ 99304800
*               PKM,          /* OR | REPLACE                        */ 99353100
*               PROGRAM,      /* Program name                        */ 99401400
*               RECORD,       /* YES | NO                        @01C*/ 99449700
*               ROUTINE,      /* Routine address                     */ 99498000
*               RAMODE,       /* Routine address AMODE           @D2A*/ 99546300
*               SASN,         /* OLD | NEW                           */ 99594600
*               SSWITCH,      /* NO | YES  XM Space Switch           */ 99642900
*               STATE,        /* PROBLEM | SUPERVISOR                */ 99691200
*               RELATED);     /* Any value                           */ 99739500
*     ANS('?'|| MACLABEL||' ETDEFP '||MACLIST||MACKEYS||';');           99787800
*%END    ETDEF;                                                         99836100
