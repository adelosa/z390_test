*% GO TO MAPXPLS ;   /*                                                 00010036
      MACRO                                                             00020036
&NAME MAPEXTR  &ID=,                                           @D51MDGL*00030036
               &MODE=,                                         @D51MDGL*00040036
               &PREFIX=,                                       @D51ODGL*00050036
               &RECID=,      FOR COMPATIBILITY WITH MAPDEVIN   @D51ODGL*00060036
               &DSECT=NO                                       @D51MDGL 00070036
.*                                                                      00080036
         LCLA  &TID                                            @D51MDGL 00090036
         LCLC  &P         INTERNAL PREFIX                      @D51ODGL 00100036
         LCLC  &G         TYPE OF GETVIS INDICATION            @D51ODGL 00110036
.*                                                                      00120036
.**************************************************************         00130036
*                                                             *@D51MDGL 00140036
.*       IBM VSE / ADVANCED FUNCTIONS                         *@D51MDGL 00150036
*        SUPERVISOR - MAPEXTR - 5686-066-06                   *@D61DDEM 00160036
.*                                                                      00170036
         AGO   .CPRIGHT                                                 00180036
.*                                                                      00190036
*        LICENSED MATERIALS - PROGRAM PROPERTY OF IBM         *@D51MDGL 00200036
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"          *@D51MDGL 00210036
*        5686-066 (C) COPYRIGHT IBM CORP. 1990, 2002          *@D67FDMZ 00220036
*        SEE COPYRIGHT INSTRUCTIONS                           *@D51MDGL 00230036
.*                                                                      00240036
.CPRIGHT ANOP                                                           00250036
.********************************************************************** 00260036
.*                                                                      00270036
.* CHECK VALIDITY OF RECID OPERAND                             @D25IDAP 00280036
.*                                                                      00290036
.********************************************************************** 00300036
         AIF   (T'&RECID EQ 'O').CHKID                         @D51MDGL 00310036
         AIF   ('&ID' EQ 'DEVICE').CHKID                       @D51ODGL 00320036
         MNOTE 8,'RECID PARAMETER ONLY ALLOWED FOR ID=DEVICE'  @D51ODGL 00330036
         MEXIT                                                 @D51ODGL 00340036
.CHKID   ANOP                                                  @D51ODGL 00350036
.********************************************************************** 00360036
.*                                                                      00370036
.* CHECK VALIDITY OF ID OPERAND.                               @D51MDGL 00380036
.*                                                                      00390036
.********************************************************************** 00400036
         AIF   (T'&ID NE 'O').START                            @D51MDGL 00410036
         MNOTE 8,'MISSING KEYWORD ID'                          @D51MDGL 00420036
.START   ANOP                                                  @D51MDGL 00430036
.*  ID = PUB2                                                 *         00440036
.*------------------------------------------------------------*         00450036
         AIF   ('&ID' NE 'PUB2').NPUB2                         @D51MDGL 00460036
         MNOTE 4,'NO PUB2 MAPPING AVAILABLE BY MAPEXTR'        @D51MDGL 00470036
         MEXIT                                                 @D51MDGL 00480036
.NPUB2   ANOP                                                  @D51MDGL 00490036
.*  ID = BDY    BOUNDARY                                      *         00500036
.*------------------------------------------------------------*         00510036
         AIF   ('&ID' NE 'BDY').NBDY                           @D51MDGL 00520036
         AIF   (T'&MODE EQ    'O').BDY1000 MODE OMITTED        @D51MDGL 00530036
         AIF   ('&MODE' EQ    'T').BDY1000 MODE = T            @D51MDGL 00540036
         AIF   ('&MODE' EQ    'P').BDY2000 MODE = P            @D51MDGL 00550036
         AIF   ('&MODE' EQ 'SYSP').BDY3000 MODE = SYSP         @D51MDGL 00560036
         AIF   ('&MODE' EQ 'TEMP').BDY4000 MODE = TEMP         @D51MDGL 00570036
         AIF   ('&MODE' EQ 'PERM').BDY5000 MODE = PERM         @D51MDGL 00580036
         MNOTE 8,'ILLEGAL MODE FOR EXTRACT ID=BDY'             @D51MDGL 00590036
         MEXIT                                                 @D51MDGL 00600036
.BDY1000 ANOP   MODE=T                                         @D51MDGL 00610036
&NAME    MAPBDY DSECT=&DSECT                                   @KX40308 00620036
         MEXIT                                                 @D51MDGL 00630036
.*------------------------------------------------------------*         00640036
.BDY2000 ANOP   MODE=P                                         @D51MDGL 00650036
&NAME    MAPBDYVR DSECT=&DSECT                                 @KX40308 00660036
         MEXIT                                                 @D51MDGL 00670036
.*------------------------------------------------------------*         00680036
.BDY3000 ANOP   MODE=SYSP                                      @D51MDGL 00690036
*---------------------------------------------------------------------* 00700036
* MAPPING FOR SERVICE:   EXTRACT ID=BDY,MODE=SYSP              @D51IDGL 00710036
*---------------------------------------------------------------------* 00720036
&P       SETC  'MAP'                                           @D51ODGL 00730036
         AIF   (T'&PREFIX EQ 'O').BDY3010                      @D51ODGL 00740036
&P       SETC  '&PREFIX'                                       @D51ODGL 00750036
.BDY3010 ANOP                                                  @D51MDGL 00760036
         AIF ('&DSECT' EQ 'YES').BDY3025                       @D51IDGL 00770036
         AIF (T'&NAME EQ 'O').BDY3020                          @D51IDGL 00780036
&NAME    DS    0F        START OF CONTROL BLOCK                @D51IDGL 00790036
         AGO  .BDY3030                                         @D51IDGL 00800036
.BDY3020 ANOP                                                  @D51IDGL 00810036
&P.SYSP  DS    0F        START OF CONTROL BLOCK                @D51IDGL 00820036
         AGO  .BDY3030                                         @D51IDGL 00830036
.BDY3025 AIF (T'&NAME EQ 'O').BDY3028                          @D51IDGL 00840036
&NAME    DSECT           START OF DSECT                        @D51IDGL 00850036
         AGO  .BDY3030                                         @D51IDGL 00860036
.BDY3028 ANOP                                                  @D51IDGL 00870036
&P.SYSP  DSECT           START OF DSECT                        @D51IDGL 00880036
.BDY3030 ANOP                                                  @D51IDGL 00890036
&P.SUPBG DC    A(0)      1ST BYTE OF SUPERVISOR                @D51IDGL 00900036
&P.SUPND DC    A(0)      LAST BYTE OF SUPERVISOR               @D51IDGL 00910036
&P.SSBEG DC    A(0)      1ST BYTE OF SDAID AREA                @D51IDGL 00920036
&P.SSEND DC    A(0)      LAST BYTE OF SDAID AREA               @D51IDGL 00930036
&P.SVA   DC    A(0)      1ST BYTE OF LOW SVA                   @D51IDGL 00940036
&P.ESVA  DC    A(0)      LAST BYTE OF LOW SVA                  @D51IDGL 00950036
&P.SPBEG DC    A(0)      1ST BYTE OF SHARED PART. AREA         @D51IDGL 00960036
&P.SPEND DC    A(0)      LAST BYTE OF SHARED PART.AREA         @D51IDGL 00970036
&P.PRPBG DC    A(0)      1ST BYTE OF PRIV. PART. AREA          @D51IDGL 00980036
&P.PRPND DC    A(0)      LAST BYTE OF PRIV. PART. AREA         @D51IDGL 00990036
&P.VPBEG DC    A(0)      1ST BYTE OF VPOOL AREA                @D51IDGL 01000036
&P.VPEND DC    A(0)      LAST BYTE OF VPOOL AREA               @D51IDGL 01010036
&P.SVIS  DC    A(0)      1ST BYTE OF SYSTEM GETVIS AREA        @D51IDGL 01020036
&P.SVISE DC    A(0)      LAST BYTE OF SYSTEM GETVIS AREA       @D51IDGL 01030036
&P.PPBEG DC    A(0)      1ST BYTE OF PROBL.PROGR. AREA         @D51IDGL 01040036
&P.SVA3B DC    A(0)      1ST BYTE OF 31 BIT ADDRESSABLE SVA    @D51IDGL 01050036
&P.SVA3E DC    A(0)      LAST BYTE OF 31 BIT ADDR. SVA         @D51IDGL 01060036
&P.SGV3B DC    A(0)      1ST BYTE OF 31 BIT ADDR. GETVIS       @D51IDGL 01070036
&P.SGV3E DC    A(0)      LAST BYTE OF 31 BIT ADDR. GETVIS      @D51IDGL 01080036
&P.VLB3B DC    A(0)      1ST BYTE OF 31 BIT ADDR. VIRTUAL LIB. @D51IDGL 01090036
&P.VLB3E DC    A(0)      LAST BYTE OF 31 BIT ADDR. VIRTUAL LIB.@D51IDGL 01100036
&P.VSIZE DC    A(0)      TOTAL VIRTUAL STORAGE SIZE IN KBYTE   @D51IDGL 01110036
&P.SYSVS DC    A(0)      TOTAL VSIZE OF SYST.USED ADDR.SPACES  @D51IDGL 01120036
&P.SPFLL DC    A(0)      SYSTEM PFIX LIMIT IN LOW AREA (PAGES) @D51IDGL 01130036
&P.SPFCL DC    A(0)      SYS. PFIX COUNTER IN LOW AREA (PAGES) @D51IDGL 01140036
&P.SPFL3 DC    A(0)      SYS. PFIX LIMIT IN HIGH AREA  (PAGES) @D51IDGL 01150036
&P.SPFC3 DC    A(0)      SYS. PFIX COUNTER IN HIGH AREA(PAGES) @D51IDGL 01160036
         AIF (T'&NAME EQ 'O').BDY3040                          @D51IDGL 01170036
&P.SYLEN EQU   *-&NAME            LENGTH OF DATA AREA          @D51IDGL 01180036
         AGO  .BDY3050                                         @D51IDGL 01190036
.BDY3040 ANOP                                                  @D51IDGL 01200036
&P.SYLEN EQU   *-&P.SYSP          LENGTH OF DATA AREA          @D51IDGL 01210036
.BDY3050 ANOP                                                  @D51IDGL 01220036
         MEXIT                                                 @D51MDGL 01230036
.*------------------------------------------------------------*         01240036
.BDY4000 ANOP  MODE=TEMP                                       @D51MDGL 01250036
*---------------------------------------------------------------------* 01260036
* MAPPING FOR SERVICE:   EXTRACT ID=BDY,MODE=TEMP              @D51IDGL 01270036
*---------------------------------------------------------------------* 01280036
&P       SETC  'MAP'                                           @D51ODGL 01290036
         AIF   (T'&PREFIX EQ 'O').BDY4010                      @D51ODGL 01300036
&P       SETC  '&PREFIX'                                       @D51ODGL 01310036
.BDY4010 ANOP                                                  @D51MDGL 01320036
         AIF ('&DSECT' EQ 'YES').BDY4025                       @D51IDGL 01330036
         AIF (T'&NAME EQ 'O').BDY4020                          @D51IDGL 01340036
&NAME    DS    0F        START OF CONTROL BLOCK                @D51IDGL 01350036
         AGO  .BDY4030                                         @D51IDGL 01360036
.BDY4020 ANOP                                                  @D51IDGL 01370036
&P.BDYTM DS    0F        START OF CONTROL BLOCK                @D51IDGL 01380036
         AGO  .BDY4030                                         @D51IDGL 01390036
.BDY4025 AIF (T'&NAME EQ 'O').BDY4028                          @D51IDGL 01400036
&NAME    DSECT           START OF DSECT                        @D51IDGL 01410036
         AGO  .BDY4030                                         @D51IDGL 01420036
.BDY4028 ANOP                                                  @D51IDGL 01430036
&P.BDYTM DSECT           START OF DSECT                        @D51IDGL 01440036
.BDY4030 ANOP                                                  @D51IDGL 01450036
&P.PTBEG DC    A(0)   1ST ADDRESSABLE BYTE OF PARTITION        @D51IDGL 01460036
&P.PTPPE DC    A(0)   LST ADDRESSABLE BYTE OF PARTITION        @D51IDGL 01470036
&P.PTEND DC    A(0)   LST ADDR. BYTE OF PARTITION, INCL. GETVIS@D51IDGL 01480036
&P.PFXLL DC    A(0)   PFIX LIMIT (K-BYTES) OR ZERO (REAL MODE) @D51IDGL 01490036
&P.PFXCL DC    A(0)   PFIX COUNT (NUMBER OF PFIXED PAGES)      @D51IDGL 01500036
&P.PFXL3 DC    A(0)   PFIX LIMIT FOR STORAGE ABOVE 16 MB LINE  @D51IDGL 01510036
&P.PFXC3 DC    A(0)   PFIX COUNT FOR STORAGE ABOVE 16 MB LINE  @D51IDGL 01520036
         AIF (T'&NAME EQ 'O').BDY4040                          @D51IDGL 01530036
&P.BDYTL EQU   *-&NAME            LENGTH OF DATA AREA          @D51IDGL 01540036
         AGO  .BDY4050                                         @D51IDGL 01550036
.BDY4040 ANOP                                                  @D51IDGL 01560036
&P.BDYTL EQU   *-&P.BDYTM         LENGTH OF DATA AREA          @D51IDGL 01570036
.BDY4050 ANOP                                                  @D51IDGL 01580036
         MEXIT                                                 @D51MDGL 01590036
.*------------------------------------------------------------*         01600036
.BDY5000 ANOP  MODE=PERM                                       @D51MDGL 01610036
*---------------------------------------------------------------------* 01620036
* MAPPING FOR SERVICE:   EXTRACT ID=BDY,MODE=PERM              @D51IDGL 01630036
*---------------------------------------------------------------------* 01640036
&P       SETC  'MAP'                                           @D51ODGL 01650036
         AIF   (T'&PREFIX EQ 'O').BDY5010                      @D51ODGL 01660036
&P       SETC  '&PREFIX'                                       @D51ODGL 01670036
.BDY5010 ANOP                                                  @D51MDGL 01680036
         AIF ('&DSECT' EQ 'YES').BDY5025                       @D51IDGL 01690036
         AIF (T'&NAME EQ 'O').BDY5020                          @D51IDGL 01700036
&NAME    DS    0F        START OF CONTROL BLOCK                @D51IDGL 01710036
         AGO  .BDY5030                                         @D51IDGL 01720036
.BDY5020 ANOP                                                  @D51IDGL 01730036
&P.BDYPM DS    0F        START OF CONTROL BLOCK                @D51IDGL 01740036
         AGO  .BDY5030                                         @D51IDGL 01750036
.BDY5025 AIF (T'&NAME EQ 'O').BDY5028                          @D51IDGL 01760036
&NAME    DSECT           START OF DSECT                        @D51IDGL 01770036
         AGO  .BDY5030                                         @D51IDGL 01780036
.BDY5028 ANOP                                                  @D51IDGL 01790036
&P.BDYPM DSECT           START OF DSECT                        @D51IDGL 01800036
.BDY5030 ANOP                                                  @D51IDGL 01810036
&P.VPBEG DC    A(0)   1ST ADDRESSABLE BYTE OF PARTITION        @D51IDGL 01820036
&P.VPPPE DC    A(0)   LST ADDR. BYTE OF PROGRAM AREA IN PART.  @D51IDGL 01830036
&P.VPEND DC    A(0)   LST ADDR. BYTE OF PARTITION, INCL. GETVIS@D51IDGL 01840036
&P.RPBEG DC    A(0)   1ST BYTE OF REAL PARTITION               @D51IDGL 01850036
&P.RPEND DC    A(0)   LST BYTE OF REAL PARTITION               @D51IDGL 01860036
&P.PFXLL DC    A(0)   PFIX LIMIT FOR STORAGE BELOW 16 MB LINE  @D51IDGL 01870036
&P.PFXL3 DC    A(0)   PFIX LIMIT FOR STORAGE ABOVE 16 MB LINE  @D51IDGL 01880036
         AIF (T'&NAME EQ 'O').BDY5040                          @D51IDGL 01890036
&P.BDYPL EQU   *-&NAME            LENGTH OF DATA AREA          @D51IDGL 01900036
         AGO  .BDY5050                                         @D51IDGL 01910036
.BDY5040 ANOP                                                  @D51IDGL 01920036
&P.BDYPL EQU   *-&P.BDYPM         LENGTH OF DATA AREA          @D51IDGL 01930036
.BDY5050 ANOP                                                  @D51IDGL 01940036
         MEXIT                                                 @D51MDGL 01950036
.NBDY    ANOP                                                  @D51MDGL 01960036
.*------------------------------------------------------------*         01970036
.*  ID = CR     CONTROL REGISTERS                             *         01980036
.*------------------------------------------------------------*         01990036
         AIF   ('&ID' NE 'CR').NCR                             @D51MDGL 02000036
         MNOTE 4,'NO SUCH MAPPING AVAILABLE BY MAPEXTR'        @D51MDGL 02010036
         MEXIT                                                 @D51MDGL 02020036
.NCR     ANOP                                                  @D51MDGL 02030036
.*  ID = DVTY   DEVICE TYPE                                   *         02040036
.*------------------------------------------------------------*         02050036
         AIF   ('&ID' NE 'DVTY').NDVTY                         @D51MDGL 02060036
         MNOTE 4,'NO SUCH MAPPING AVAILABLE BY MAPEXTR'        @D51MDGL 02070036
         MEXIT                                                 @D51MDGL 02080036
.NDVTY   ANOP                                                  @D51MDGL 02090036
.*  ID = PUB    GET COPY OF PHYSICAL UNIT BLOCK               *         02100036
.*------------------------------------------------------------*         02110036
         AIF   ('&ID' NE 'PUB').NPUB                           @D51MDGL 02120036
         MNOTE 4,'NO SUCH MAPPING AVAILABLE BY MAPEXTR'        @D51MDGL 02130036
         MEXIT                                                 @D51MDGL 02140036
.NPUB    ANOP                                                  @D51MDGL 02150036
.*  ID = CPUID  GET CPU IDENTIFICATION                        *         02160036
.*------------------------------------------------------------*         02170036
         AIF   ('&ID' NE 'CPUID').NCPUID                       @D51MDGL 02180036
         AIF   (T'&MODE EQ 'O').CPUI000 MODE OMITTED           @D51MDGL 02190036
         AIF   ('&MODE' EQ 'REAL').CPUI100 MODE = REAL         @D51MDGL 02200036
         MNOTE 8,'ILLEGAL MODE FOR EXTRACT ID=CPUID'           @D51MDGL 02210036
         MEXIT                                                 @D51MDGL 02220036
.CPUI000 ANOP                                                  @D51ODGL 02230036
*---------------------------------------------------------------------* 02240036
* MAPPING FOR SERVICE:   EXTRACT ID=CPUID                      @D51IDGL 02250036
*---------------------------------------------------------------------* 02260036
         AGO   .CPUI001                                        @D51ODGL 02270036
.CPUI100 ANOP                                                  @D51ODGL 02280036
*---------------------------------------------------------------------* 02290036
* MAPPING FOR SERVICE:   EXTRACT ID=CPUID,MODE=REAL            @D51IDGL 02300036
*---------------------------------------------------------------------* 02310036
.CPUI001 ANOP                                                  @D51ODGL 02320036
&P       SETC  'MAP'                                           @D51ODGL 02330036
         AIF   (T'&PREFIX EQ 'O').CPUI010                      @D51ODGL 02340036
&P       SETC  '&PREFIX'                                       @D51ODGL 02350036
.CPUI010 ANOP                                                  @D51MDGL 02360036
         AIF ('&DSECT' EQ 'YES').CPUI025                       @D51IDGL 02370036
         AIF (T'&NAME EQ 'O').CPUI020                          @D51IDGL 02380036
&NAME    DS    0F        START OF CONTROL BLOCK                @D51IDGL 02390036
         AGO  .CPUI030                                         @D51IDGL 02400036
.CPUI020 ANOP                                                  @D51IDGL 02410036
&P.CPUSL DS    0F        START OF CONTROL BLOCK                @D51IDGL 02420036
         AGO  .CPUI030                                         @D51IDGL 02430036
.CPUI025 AIF (T'&NAME EQ 'O').CPUI028                          @D51IDGL 02440036
&NAME    DSECT           START OF DSECT                        @D51IDGL 02450036
         AGO  .CPUI030                                         @D51IDGL 02460036
.CPUI028 ANOP                                                  @D51IDGL 02470036
&P.CPUSL DSECT           START OF DSECT                        @D51IDGL 02480036
.CPUI030 ANOP                                                  @D51IDGL 02490036
&P.CPUID DS    0XL8   TOTAL CPUID                              @D51IDGL 02500036
&P.CPUVC DC    X'0'   CPU VERSION CODE                         @D51IDGL 02510036
&P.CPUIN DC    XL3'0' CPU IDENTIFICATION NUMBER                @D51IDGL 02520036
&P.CPUMN DC    XL2'0' CPU MODEL NUMBER                         @D51IDGL 02530036
         DC    XL2'0' RESERVED                                 @D51IDGL 02540036
&P.LOGID DC    CL2'0' SYSLOG ID OF CALLING PARTITION IN EBCDIC @D51IDGL 02550036
&P.VSEID DC    CL8' ' VSE-MACHINE ID                           @DY45557 02560036
         AIF (T'&NAME EQ 'O').CPUI040                          @D51IDGL 02570036
&P.CPUL  EQU   *-&NAME            LENGTH OF DATA AREA          @D51IDGL 02580036
         MEXIT                                                 @D51IDGL 02590036
.CPUI040 ANOP                                                  @D51IDGL 02600036
&P.CPUL  EQU   *-&P.CPUSL         LENGTH OF DATA AREA          @D51IDGL 02610036
         MEXIT                                                 @D51MDGL 02620036
.NCPUID  ANOP                                                  @D51MDGL 02630036
.*  ID = MAP    GET LIST OF PIKS RESIDING IN SPECIFIED SPACE  *         02640036
.*------------------------------------------------------------*         02650036
         AIF   ('&ID' NE 'MAP').NMAP                           @D51MDGL 02660036
         MNOTE 4,'NO SUCH MAPPING AVAILABLE BY MAPEXTR'        @D51MDGL 02670036
         MEXIT                                                 @D51MDGL 02680036
.NMAP    ANOP                                                  @D51MDGL 02690036
.*  ID = DEVICE                                               *         02700036
.*------------------------------------------------------------*         02710036
         AIF   ('&ID' NE 'DEVICE').NDEVICE                     @D51MDGL 02720036
*---------------------------------------------------------------------* 02730036
* MAPPING FOR SERVICE:   EXTRACT ID=DEVICE                     @D51IDGL 02740036
*---------------------------------------------------------------------* 02750036
&P       SETC  'IJB'                                           @D51ODGL 02760036
         AIF   (T'&PREFIX EQ 'O').DEV0010                      @D51ODGL 02770036
&P       SETC  '&PREFIX'                                       @D51ODGL 02780036
.DEV0010 ANOP                                                  @D51MDGL 02790036
         AIF ('&DSECT' EQ 'YES').DEV0025                       @D51IDGL 02800036
         AIF (T'&NAME EQ 'O').DEV0020                          @D51IDGL 02810036
&NAME    DS    0F        START OF CONTROL BLOCK                @D51IDGL 02820036
         AGO  .DEV0030                                         @D51IDGL 02830036
.DEV0020 ANOP                                                  @D51IDGL 02840036
&P.DVINF DS   0F         START OF CONTROL BLOCK                @D51IDGL 02850036
         AGO  .DEV0030                                         @D51IDGL 02860036
.DEV0025 AIF (T'&NAME EQ 'O').DEV0028                          @D51IDGL 02870036
&NAME    DSECT           START OF DSECT                        @D51IDGL 02880036
         AGO  .DEV0030                                         @D51IDGL 02890036
.DEV0028 ANOP                                                  @D51IDGL 02900036
&P.DVINF DSECT           START OF DSECT                        @D51IDGL 02910036
.DEV0030 ANOP                                                  @D51IDGL 02920036
&P.DVCUU DS    H                  CUU ADDRESS                           02930036
&P.DVDTC DS    X                  VSE DEVICE TYPE CODE                  02940036
&P.DVSNS DS    0XL7               SENSE DEVICE TYPE INFORMATION         02950036
&P.DVSNV DS    X                  VALIDITY FLAG                @D21FDRP 02960036
&P.DVVAL EQU   X'FF'              ENTRY IS VALID                        02970036
&P.DVCUN DS    XL2                CONTROL-UNIT TYPE NUMBER              02980036
&P.DVCUM DS    X                  CONROL-UNIT MODEL NUMBER              02990036
&P.DVDTN DS    XL2                DEVICE TYPE NUMBER                    03000036
&P.DVDTM DS    X                  DEVICE TYPE MODEL NUMBER              03010036
         AIF   ('&RECID' EQ 'NO').DEV0100                      @D66EDAP 03020036
&P.DVOBR DS    XL2                OBR - OS DEVICE CODE         @D21IDGN 03030036
&P.DVMDR DS    X                  MDR DEVICE CODE              @D21IDGN 03040036
&P.DVCID DS    X                  CU ID FROM RDC COMMAND       @D21IDAP 03050036
         AIF   ('&RECID' EQ 'CART').DEV0070                    @D28ADAP 03051043
         AIF   ('&RECID' EQ 'SCSI').DEV0080                    @DSCSI   03060040
         AIF   ('&RECID' EQ 'QDIO').DEV0090                    @D66EDAP 03061037
&P.DVRCC DS    X                  CONTROL UNIT TYPE CODE REAL  @DY45299 03070036
&P.DVRDC DS    X                  DEVICE TYPE CODE (OBR) REAL  @DY45299 03080036
         AGO   .DEV0100           JOIN MAIN PATH               @DSCSI   03081040
.DEV0070 ANOP                                                  @D28ADAP 03081143
* HERE INSERT  TAPE SUBSYSTEM FEATURE INFORMATION              @D28ADAP 03081244
         AGO   .DEV0100           JOIN MAIN PATH               @D28ADAP 03081343
.DEV0080 ANOP                                                  @DSCSI   03081443
.*                                                             @DSCSI   03081543
.*       SCSI SPECIFIC INFORMATION                             @DSCSI   03081643
.*                                                             @DSCSI   03081743
&P.DFCPA DS    XL2                FCP ADDRESS                  @DSCSI   03082039
&P.DWWPN DS    XL8                WORLD-WIDE PORT NUMBER       @DSCSI   03083039
&P.DLUN  DS    XL8                LUN ADDRESS                  @DSCSI   03084039
         AGO   .DEV0100           JOIN MAIN PATH               @DSCSI   03085039
.*                                                             @DSCSI   03086040
.*       QDIO SPEZIFIC INFORMATION                             @DSCSI   03087040
.*                                                             @DSCSI   03088040
.DEV0090 ANOP                                                  @D21IDGN 03100036
&P.DVSCH DS    XL2                OSAX SUBCHANNEL NUMBER       @D66EDAP 03110036
&P.DVDTY DS    X                  QDIO DEVICE QUALIFIER CODE   @D66EDAP 03120036
&P.DFEAT DS    X                  DEVICE FEATURES              @D66EDAP 03130036
&P.DPCI  EQU   X'80'              DEVICE PRESENTS PCI          @D66EDAP 03140036
&P.SIGAR EQU   X'40'              DEVICE REQUIRES SIGA READ    @D66EDAP 03150036
&P.SIGAW EQU   X'20'              DEVICE REQUIRES SIGA WRITE   @D66EDAP 03160036
&P.SIGAS EQU   X'10'              DEVICE REQUIRES SIGA SYNC    @D66EDAP 03170036
&P.DVCAD DS    XL2                CHPID ID & DEVICE ADDRESS    @D66EDAP 03180036
&P.DVEST DS    XL3                ESTABLISH COMMAND INFO       @D66EDAP 03190036
&P.DVACT DS    XL3                ACTIVATION COMMAND INFO      @D66EDAP 03200036
&P.DIQNO DS    XL1                NUMBER OF INPUT QUEUES       @D66EDAP 03210036
&P.DOQNO DS    XL1                NUMBER OF OUTPUT QUEUES      @D66EDAP 03220036
&P.DQFMT DS    XL1                QDIO QUEUE FORMAT            @D67FDMZ 03230036
&P.DFLG1 DS    XL1                ADD. (I)QDIO FEATURES        @D67FDMZ 03240036
&P.AINTF EQU   X'80'              ADAPTER INTERRUPTION FACILITY@D67FDMZ 03250036
&P.SCSC  EQU   X'40'              SET CSC COMMAND SUPPORTED    @D67FDMZ 03260036
&P.SCSCF EQU   X'20'              SET CSC FAST COMMAND SUPPORT.@D67FDMZ 03270036
&P.DCULA DS    XL1                CNTRL UNIT IMAGE ID          @D67FDMZ 03280036
.DEV0100 ANOP                                                  @D66EDAP 03290036
&P.DVLEN EQU   *-&P.DVCUU         LENGTH OF AREA                        03300036
         MEXIT                                                 @D51MDGL 03310036
.NDEVICE ANOP                                                  @D51MDGL 03320036
.*  ID = SENSE                                                *         03330036
.*------------------------------------------------------------*         03340036
         AIF   ('&ID' NE 'SENSE').NSENSE                       @D51MDGL 03350036
         MNOTE 4,'NO SUCH MAPPING AVAILABLE BY MAPEXTR'        @D51MDGL 03360036
         MEXIT                                                 @D51MDGL 03370036
.NSENSE  ANOP                                                  @D51MDGL 03380036
.*  ID = PART                         SERVICE FOR IUI ONLY !  *         03390036
.*------------------------------------------------------------*         03400036
         AIF   ('&ID' NE 'PART').NPART                         @D51MDGL 03410036
*---------------------------------------------------------------------* 03420036
* MAPPING FOR SERVICE:  EXTRACT ID=PART                        @D51MDGL 03430036
*---------------------------------------------------------------------* 03440036
&P       SETC  'MAP'                                           @D51ODGL 03450036
         AIF   (T'&PREFIX EQ 'O').PART010                      @D51ODGL 03460036
&P       SETC  '&PREFIX'                                       @D51ODGL 03470036
.PART010 ANOP                                                  @D51MDGL 03480036
         AIF ('&DSECT' EQ 'YES').PART030                       @D51MDGL 03490036
         AIF (T'&NAME EQ 'O').PART020                          @D51MDGL 03500036
&NAME    DS    0F        START OF CONTROL BLOCK                @D51MDGL 03510036
         AGO  .PART050                                         @D51MDGL 03520036
.PART020 ANOP                                                  @D51MDGL 03530036
&P.PART  DS    0F        START OF CONTROL BLOCK                @D51MDGL 03540036
         AGO  .PART050                                         @D51MDGL 03550036
.PART030 AIF (T'&NAME EQ 'O').PART040                          @D51MDGL 03560036
&NAME    DSECT           START OF DSECT                        @D51MDGL 03570036
         AGO  .PART050                                         @D51MDGL 03580036
.PART040 ANOP                                                  @D51MDGL 03590036
&P.PART  DSECT           START OF DSECT                        @D51MDGL 03600036
.PART050 ANOP                                                  @D51MDGL 03610036
&P.PTGVC DC    A(0)   START OF PARTITION GETVIS CONTR.AREA     @D51MDGL 03620036
&P.DYGVC DC    A(0)   START OF DYN.SPACE GETVIS CONT.AREA      @D51MDGL 03630036
&P.PTBEG DC    A(0)   1ST BYTE OF VIRTUAL/REAL PARTITION       @D51MDGL 03640036
&P.PTHPH DC    A(0)   HIGHEST PHASE LOAD ADDRESS               @D51MDGL 03650036
&P.PTNAM DC    CL8'0' NAME OF JOB IN PARTITION                 @D51MDGL 03660036
&P.PTPPE DC    A(0)   CURRENT PROBLEM PROGRAM END ADDRESS      @D51MDGL 03670036
&P.PTEND DC    A(0)   LAST ADDR. BYTE OF VIRT./REAL PARTITION  @D51MDGL 03680036
&P.DYGVB DC    A(0)   BEGIN OF SPACE GETVIS AREA               @D51MDGL 03690036
&P.DYGVE DC    A(0)   END OF DYNAMIC SPACE GETVIS AREA         @D51MDGL 03700036
&P.PTFLG DC    XL3'0' RESERVED                                 @D51MDGL 03710036
&P.PTPIB DC    X'00'  PIBFLAG FROM PIB                         @D51MDGL 03720036
* INFORMATION ABOUT PARTITION GETVIS AREA                      @D51MDGL 03730036
&P.PTGCL DC    A(0)   LENGTH OF PART.GETV.CONTR.AREA (BELOW)   @D51MDGL 03740036
&P.PTGHW DC    A(0)   MAX.CONSUMED PART.GETV. SO FAR (BELOW)   @D51MDGL 03750036
&P.PTGFR DC    A(0)   CURRENT TOTAL FREE PART. GETV. (BELOW)   @D51MDGL 03760036
&P.PTGUS DC    A(0)   CURRENT TOTAL USED PART. GETV. (BELOW)   @D51MDGL 03770036
&P.PTGMF DC    A(0)   CURRENT MAX.CONTIG. FREE. P.GETV.(BELOW) @D51MDGL 03780036
* INFORMATION ABOUT DYNAMIC SPACE GETVIS AREA                  @D51MDGL 03790036
&P.DYGCL DC    A(0)   LNG. OF DYNAMIC SPACE GETV. CONTR. AREA  @D51MDGL 03800036
&P.DYGHW DC    A(0)   MAX.CONSUMED DYN.SPACE GETV. SO FAR      @D51MDGL 03810036
&P.DYGFR DC    A(0)   CURRENT TOTAL FREE DYN.SPACE GETVIS      @D51MDGL 03820036
&P.DYGUS DC    A(0)   CURRENT TOTAL USED DYN.SPACE GETVIS      @D51MDGL 03830036
&P.DYGMF DC    A(0)   CURRENT MAX.CONTIG. FREE DYN.SPACE GETV. @D51MDGL 03840036
* INFORMATION ABOUT PARTITION PERMANENT BOUNDARIES             @D51MDGL 03850036
&P.VPBEG DC    A(0)   1ST BYTE OF VIRT.PARTITION               @D51IDGL 03860036
&P.VPEND DC    A(0)   LST BYTE OF VIRT.PARTITION, INCL. GETVIS @D51IDGL 03870036
&P.RPBEG DC    A(0)   1ST BYTE OF REAL PARTITION               @D51IDGL 03880036
&P.RPEND DC    A(0)   LST BYTE OF REAL PARTITION               @D51IDGL 03890036
* INFORMATION ABOUT PARTITION GETVIS WITH LOC=ANY              @D51MDGL 03900036
&P.PAGCL DC    A(0)   LENGTH OF PART.GETV.CONTR.AREA (LOC.ANY) @D51MDGL 03910036
&P.PAGHW DC    A(0)   MAX.CONSUMED PART.GETV. SO FAR (LOC.ANY) @D51MDGL 03920036
&P.PAGFR DC    A(0)   CURRENT TOTAL FREE PART. GETV. (LOC.ANY) @D51MDGL 03930036
&P.PAGUS DC    A(0)   CURRENT TOTAL USED PART. GETV. (LOC.ANY) @D51MDGL 03940036
&P.PAGMF DC    A(0)   CURRENT MAX.CONTIG.FREE P.GETV.(LOC.ANY) @D51MDGL 03950036
         AIF (T'&NAME EQ 'O').PART060                          @D51MDGL 03960036
&P.PARTL EQU   *-&NAME            LENGTH OF DATA AREA          @D51MDGL 03970036
         MEXIT                                                 @D51MDGL 03980036
.PART060 ANOP                                                  @D51MDGL 03990036
&P.PARTL EQU   *-&P.PART          LENGTH OF DATA AREA          @D51MDGL 04000036
         MEXIT                                                 @D51MDGL 04010036
.NPART   ANOP                                                  @D51MDGL 04020036
.*  ID = SVA                   SERVICE ONLY FOR IUI !!        *         04030036
.*------------------------------------------------------------*         04040036
         AIF   ('&ID' NE 'SVA').NSVA                           @D51MDGL 04050036
*---------------------------------------------------------------------* 04060036
* MAPPING FOR SERVICE:  EXTRACT ID=SVA                         @D51MDGL 04070036
*---------------------------------------------------------------------* 04080036
&P       SETC  'XTR'                                           @D51ODGL 04090036
         AIF   (T'&PREFIX EQ 'O').SVA0010                      @D51ODGL 04100036
&P       SETC  '&PREFIX'                                       @D51ODGL 04110036
.SVA0010 ANOP                                                  @D51MDGL 04120036
         AIF ('&DSECT' EQ 'YES').SVA0020                       @D51MDGL 04130036
         AIF (T'&NAME EQ 'O').SVA0030                          @D51MDGL 04140036
&NAME    DS    0F        START OF CONTROL BLOCK                @D51MDGL 04150036
         AGO  .SVA0050                                         @D51MDGL 04160036
.SVA0030 ANOP                                                  @D51MDGL 04170036
&P.SVA   DS    0F        START OF CONTROL BLOCK                @D51MDGL 04180036
         AGO  .SVA0050                                         @D51MDGL 04190036
.SVA0020 AIF (T'&NAME EQ 'O').SVA0040                          @D51MDGL 04200036
&NAME    DSECT           START OF DSECT                        @D51MDGL 04210036
         AGO  .SVA0050                                         @D51MDGL 04220036
.SVA0040 ANOP                                                  @D51MDGL 04230036
&P.SVA   DSECT           START OF DSECT                        @D51MDGL 04240036
.SVA0050 ANOP                                                  @D51MDGL 04250036
&P.SVAB  DC    A(0)       1ST BYTE OF SVA LOW                  @D51MDGL 04260036
&P.SVAE  DC    A(0)       LST BYTE OF SVA LOW                  @D51MDGL 04270036
&P.VLIBB DC    A(0)       1ST BYTE OF VIRTUAL LIBRARY LOW      @D51MDGL 04280036
&P.VLIBF DC    A(0)       AMOUNT OF FREE SPACE IN VIRT.LIBR.   @D51MDGL 04290036
&P.VLIBE DC    A(0)       LST BYTE OF VIRTUAL LIBRARY LOW      @D51MDGL 04300036
&P.SVISC DC    A(0)       1ST BYTE OF SYST.GETVIS CONTROL      @D51MDGL 04310036
&P.SVIS  DC    A(0)       1ST ALLOCATABLE BYTE OF SYST. GETVIS @D51MDGL 04320036
&P.SVISE DC    A(0)       LST BYTE OF SYSTEM GETVIS AREA       @D51MDGL 04330036
* INFORMATION ABOUT SYSTEM GETVIS AREA                         @D51MDGL 04340036
&P.SVGCL DC    A(0)        LNG OF GETVIS CNTL.AREA IN LOW PART @D51MDGL 04350036
&P.SVGHW DC    A(0)        LARGEST AMOUNT USED UP UNTIL NOW    @D51MDGL 04360036
&P.SVGFR DC    A(0)        TOTAL AMOUNT OF FREE GETVIS SPACE   @D51MDGL 04370036
&P.SVGUS DC    A(0)        TOTAL AMOUNT OF USED GETVIS SPACE   @D51MDGL 04380036
&P.SVGMF DC    A(0)        LARGEST CONTIGUOUS FREE GETVIS SPACE@D51MDGL 04390036
&P.SVGRS DC    A(0)        NUMBER OF RESERVED PAGES IN GETVIS  @D51MDGL 04400036
&P.SLAB  DC    A(0)       1ST BYTE OF LABEL AREA               @D51MDGL 04410036
&P.SLAE  DC    A(0)       LST BYTE OF LABEL AREA               @D51MDGL 04420036
&P.VPOLB DC    A(0)       1ST BYTE OF VPOOL                    @D51MDGL 04430036
&P.VPOLE DC    A(0)       LST BYTE OF VPOOL                    @D51MDGL 04440036
*  INFORMATION ABOUT SVA HIGH                                  @D51ODGL 04450036
&P.SVA3B DC    A(0)       1ST BYTE OF SVA HIGH                 @D51MDGL 04460036
&P.SVA3E DC    A(0)       LST BYTE OF SVA HIGH                 @D51MDGL 04470036
&P.SGV3B DC    A(0)       1ST BYTE ALLOCATABLE AREA OF GETVIS  @D51MDGL 04480036
&P.SGV3E DC    A(0)       LST BYTE OF SYSTEM GETVIS AREA       @D51MDGL 04490036
&P.VLB3B DC    A(0)       1ST BYTE OF VIRTUAL LIBRARY HIGH     @D51MDGL 04500036
&P.VLB3E DC    A(0)       LST BYTE OF VIRTUAL LIBRARY HIGH     @D51MDGL 04510036
&P.VLB3F DC    A(0)       AMOUNT OF FREE SPACE IN VIRT.LIBR.   @D51MDGL 04520036
*  INFORMATION ABOUT SYSTEM GETVIS AREA                        @D51MDGL 04530036
&P.SAGCL DC    A(0)        LNG OF GETVIS CNTL AREA IN HIGH PART@D51MDGL 04540036
&P.SAGHW DC    A(0)        LARGEST AMOUNT USED UP UNTIL NOW    @D51MDGL 04550036
&P.SAGFR DC    A(0)        TOTAL AMOUNT OF FREE GETVIS SPACE   @D51MDGL 04560036
&P.SAGUS DC    A(0)        TOTAL AMOUNT OF USED GETVIS SPACE   @D51MDGL 04570036
&P.SAGMF DC    A(0)        LARGEST CONTIGUOUS FREE GETVIS SPACE@D51MDGL 04580036
         AIF (T'&NAME EQ 'O').SVA0060                          @D51MDGL 04590036
&P.SVALN EQU   *-&NAME            LENGTH OF DATA AREA          @D51MDGL 04600036
         MEXIT                                                 @D51MDGL 04610036
.SVA0060 ANOP                                                  @D51MDGL 04620036
&P.SVALN EQU   *-&P.SVA           LENGTH OF DATA AREA          @D51MDGL 04630036
         MEXIT                                                 @D51MDGL 04640036
.NSVA    ANOP                                                  @D51MDGL 04650036
.*  ID = SAINFO                SERVICE FOR STAND ALONE SUP.   *         04660036
.*------------------------------------------------------------*         04670036
         AIF   ('&ID' NE 'SAINFO').NSAINFO                     @D61DDGL 04680036
*---------------------------------------------------------------------* 04690036
* MAPPING FOR SERVICE:  EXTRACT ID=SAINFO                      @D61DDGL 04700036
*---------------------------------------------------------------------* 04710036
&P       SETC  'XTR'                                           @D61DDGL 04720036
         AIF   (T'&PREFIX EQ 'O').SAI0010                      @D61DDGL 04730036
&P       SETC  '&PREFIX'                                       @D61DDGL 04740036
.SAI0010 ANOP                                                  @D61DDGL 04750036
         AIF ('&DSECT' EQ 'YES').SAI0020                       @D61DDGL 04760036
         AIF (T'&NAME EQ 'O').SAI0030                          @D61DDGL 04770036
&NAME    DS    0F        START OF CONTROL BLOCK                @D61DDGL 04780036
         AGO  .SAI0050                                         @D61DDGL 04790036
.SAI0030 ANOP                                                  @D61DDGL 04800036
&P.SAI   DS    0F        START OF CONTROL BLOCK                @D61DDGL 04810036
         AGO  .SAI0050                                         @D61DDGL 04820036
.SAI0020 AIF (T'&NAME EQ 'O').SAI0040                          @D61DDGL 04830036
&NAME    DSECT           START OF DSECT                        @D61DDGL 04840036
         AGO  .SAI0050                                         @D61DDGL 04850036
.SAI0040 ANOP                                                  @D61DDGL 04860036
&P.SAINF DSECT           START OF DSECT                        @D61DDGL 04870036
.SAI0050 ANOP                                                  @D61DDGL 04880036
&P.FNDNO DC    A(0)       NUMBER OF FOUND ENTRIES              @D61DDGL 04890036
&P.FLAGS DC    A(0)       FLAG WORD                            @D61DDGL 04900036
&P.EXTCD DC    CL6' '     EXTERNAL DEVICE TYPE CODE            @D61DDGL 04910036
&P.PDVTY DC    AL1(0)     PUB DEVICE TYPE CODE                 @D61DDGL 04920036
&P.PMODE DC    AL1(0)     DEFAULT MODE OF DEVICE               @D61DDGL 04930036
&P.ENTLN EQU   *-&P.EXTCD LENGTH OF ONE ENTRY IN LIST          @D61DDGL 04940036
         MEXIT                                                 @D61DDGL 04950036
.NSAINFO ANOP                                                  @D61DDGL 04960036
.*  ID = ATLCUU                SERVICE FOR STAND ALONE SUP.   *         04970036
.*------------------------------------------------------------*         04980036
         AIF   ('&ID' NE 'ATLCUU').NATLCUU                     @D61DDGL 04990036
         AIF   (T'&MODE EQ 'O').ATLCU02                        @D61DDEM 05000036
         MNOTE 8,'MODE PARAMETER NOT SUPPORTED FOR ID=ATLCUU'  @D61DDEM 05010036
         MEXIT                                                 @D61DDEM 05020036
.ATLCU02 ANOP                                                  @D61DDEM 05030036
*---------------------------------------------------------------------* 05040036
* MAPPING FOR SERVICE:  EXTRACT ID=ATLCUU                      @D61DDGL 05050036
*---------------------------------------------------------------------* 05060036
&P       SETC  'XTR'                                           @D61DDGL 05070036
         AIF   (T'&PREFIX EQ 'O').ATLCU10                      @D61DDGL 05080036
&P       SETC  '&PREFIX'                                       @D61DDGL 05090036
.ATLCU10 ANOP                                                  @D61DDGL 05100036
         AIF ('&DSECT' EQ 'YES').ATLCU20                       @D61DDGL 05110036
         AIF (T'&NAME EQ 'O').ATLCU30                          @D61DDGL 05120036
&NAME    DS   0F                                               @D61DDGL 05130036
         AGO  .ATLCU50                                         @D61DDGL 05140036
.ATLCU30 ANOP                                                  @D61DDGL 05150036
&P.CUU   DS    0F                 START OF DSECT               @D61DDGL 05160036
         AGO  .ATLCU50                                         @D61DDGL 05170036
.ATLCU20 AIF (T'&NAME EQ 'O').ATLCU40                          @D61DDGL 05180036
&NAME    DSECT                                                 @D61DDGL 05190036
         AGO  .ATLCU50                                         @D61DDGL 05200036
.ATLCU40 ANOP                                                  @D61DDGL 05210036
&P.ATLCU DSECT                    START OF DSECT               @D61DDGL 05220036
.ATLCU50 ANOP                                                  @D61DDGL 05230036
&P.ATVER DC    AL4(0)     VERSION IDENTIFICATION               @D61DDGL 05240036
&P.ATCUU DC    AL2(0)     ZERO ON INPUT, CUU ON RETURN         @D61DDGL 05250036
&P.ATDVT DC    CL6' '     EXT. DEV.TYPE CODE (EBCDIC)          @D61DDGL 05260036
&P.ATLNM DC    CL8' '     NAME OF AUTOMATIC TAPE LIBRARY       @D61DDGL 05270036
&P.ATLLN EQU   *-&P.ATVER LENGTH OF ONE LIST                   @D61DDGL 05280036
         MEXIT                                                 @D61DDGL 05290036
.NATLCUU ANOP                                                  @D61DDGL 05300036
.**************************************************************         05310036
.*  ID = GETVIS                                               *         05320036
.*------------------------------------------------------------*         05330036
         AIF   ('&ID' NE 'GETVIS').ILLEGID                     @D51MDGL 05340036
         AIF   (T'&MODE EQ  'O').GVS1000   MODE OMITTED        @D51MDGL 05350036
         AIF   ('&MODE' EQ 'PT').GVS1000   MODE = PARTITION    @D51MDGL 05360036
         AIF   ('&MODE' EQ 'SP').GVS2000   MODE = DYN.SPACE    @D51MDGL 05370036
         AIF   ('&MODE' EQ 'SV').GVS3000   MODE = SYSTEM GETV. @D51MDGL 05380036
         MNOTE 8,'ILLEGAL MODE FOR EXTRACT ID=GETVIS'          @D51MDGL 05390036
         MEXIT                                                 @D51MDGL 05400036
.GVS1000 ANOP                                                  @D51MDGL 05410036
*---------------------------------------------------------------------* 05420036
* MAPPING FOR SERVICE:   EXTRACT ID=GETVIS,MODE=PT             @D51IDGL 05430036
*---------------------------------------------------------------------* 05440036
&G       SETC   'PTG'                                          @D51ODGL 05450036
         AGO    .GVS4000                                       @D51ODGL 05460036
.GVS2000 ANOP                                                  @D51MDGL 05470036
*---------------------------------------------------------------------* 05480036
* MAPPING FOR SERVICE:   EXTRACT ID=GETVIS,MODE=SP             @D51IDGL 05490036
*---------------------------------------------------------------------* 05500036
&G       SETC   'DYG'                                          @D51ODGL 05510036
         AGO    .GVS4000                                       @D51ODGL 05520036
.GVS3000 ANOP                                                  @D51MDGL 05530036
*---------------------------------------------------------------------* 05540036
* MAPPING FOR SERVICE:   EXTRACT ID=GETVIS,MODE=SV             @D51IDGL 05550036
*---------------------------------------------------------------------* 05560036
&G       SETC   'SVG'                                          @D51ODGL 05570036
.*       AGO    .GVS4000                                       @D51ODGL 05580036
.GVS4000 ANOP                                                  @D51MDGL 05590036
&P       SETC  'MAP'                                           @D51ODGL 05600036
         AIF   (T'&PREFIX EQ 'O').GVS4010                      @D51ODGL 05610036
&P       SETC  '&PREFIX'                                       @D51ODGL 05620036
.GVS4010 ANOP                                                  @D51MDGL 05630036
         AIF ('&DSECT' EQ 'YES').GVS4025                       @D51IDGL 05640036
         AIF (T'&NAME EQ 'O').GVS4020                          @D51IDGL 05650036
&NAME    DS   0F                                               @D51IDGL 05660036
         AGO  .GVS4030                                         @D51IDGL 05670036
.GVS4020 ANOP                                                  @D51IDGL 05680036
&P.&G    DS   0F                  START OF DSECT               @D51IDGL 05690036
         AGO  .GVS4030                                         @D51IDGL 05700036
.GVS4025 AIF (T'&NAME EQ 'O').GVS4028                          @D51IDGL 05710036
&NAME    DSECT                                                 @D51IDGL 05720036
         AGO  .GVS4030                                         @D51IDGL 05730036
.GVS4028 ANOP                                                  @D51IDGL 05740036
&P.&G    DSECT           START OF DSECT                        @D51IDGL 05750036
.GVS4030 ANOP                                                  @D51IDGL 05760036
&P.&G.CL DC    A(0)   LENGTH OF GETVIS CONTROL AREA            @D51IDGL 05770036
&P.&G.HW DC    A(0)   HIGH WATER MARK, MAX. EVER USED SO FAR   @D51IDGL 05780036
&P.&G.FR DC    A(0)   CURRENT FREE GETVIS SPACE                @D51IDGL 05790036
&P.&G.US DC    A(0)   CURRENT USED GETVIS SPACE                @D51IDGL 05800036
&P.&G.MF DC    A(0)   MAXIMUM CONTIGUOUS FREE SPACE            @D51IDGL 05810036
         AIF (T'&NAME EQ 'O').GVS4040                          @D51IDGL 05820036
&P.&G.LN EQU   *-&NAME            LENGTH OF DATA AREA          @D51IDGL 05830036
         AGO  .GVS4050                                         @D51IDGL 05840036
.GVS4040 ANOP                                                  @D51IDGL 05850036
&P.&G.LN EQU   *-&P.&G            LENGTH OF DATA AREA          @D51IDGL 05860036
.GVS4050 ANOP                                                  @D51IDGL 05870036
         MEXIT                                                 @D51MDGL 05880036
.********************************************************************** 05890036
.*                                                                      05900036
.* END OF MACRO PROCESSING...                                  @D149DWK 05910036
.*                                                                      05920036
.********************************************************************** 05930036
.ILLEGID MNOTE 8,'&ID IS NOT A VALID ID'                       @D51MDGL 05940036
.MACEND  ANOP                                                           05950036
         MEND                                                        */ 05960036
*%MAPXPLS : ;                                                           05970036
*%MAPEXTR:  MACRO  KEYS(ID,MODE,PREFIX,RECID);            /* @D51MDGL*/ 05980036
* /*******************************************************************/ 05990036
* /*                                                                 */ 06000036
* /*  LIST MACRO INVOCATION IN SOURCE                                */ 06010036
* /*                                                                 */ 06020036
* /*******************************************************************/ 06030036
*    ANS ('/* '||MACLABEL||' '||MACNAME||' '||MACLIST||' '||MACKEYS||   06040036
*         '*/') COL(MACLMAR);                                           06050036
* ANS ('/*                                                  */')        06060036
* COL(MACLMAR);                                                         06070036
* ANS ('/*  MAPPING MACRO FOR SUPERVISOR EXTRACT SERVICES   */')        06080036
* COL(MACLMAR);                                                         06090036
* ANS ('/*                                                  */')        06100036
* COL(MACLMAR);                                                         06110036
* /*******************************************************************/ 06120036
* /*                                                                 */ 06130036
* /*  PLS PART OF EXTRACT MACRO . DESCRIPTION SEE ASM PART           */ 06140036
* /*                                                                 */ 06150036
* /*******************************************************************/ 06160036
*    DCL (N,TID)FIXED;                     /*                @D51MDGL*/ 06170036
*    DCL (IKEY,PER,GVIND)CHAR;             /*                @D51MDGL*/ 06180036
*    DCL (VID(14))CHAR;                    /*                @D51MDGL*/ 06190036
* /*******************************************************************/ 06200036
* /*                                                                 */ 06210036
* /* CHECK GIVEN ID                                          @D51MDGL*/ 06220036
* /*                                                                 */ 06230036
* /*******************************************************************/ 06240036
*    IF (LENGTH(MACLABEL) > 0) THEN DO;                    /*@D51..GL*/ 06250036
*      MNAME  = MACLABEL(1:LENGTH(MACLABEL)-1);            /*@D51..GL*/ 06260036
*    END;                                                  /*@D51..GL*/ 06270036
*    ELSE DO;                                              /*@D51..GL*/ 06280036
*      MNAME = '';                                         /*@D51..GL*/ 06290036
*    END;                                                  /*@D51..GL*/ 06300036
*    VID(1) = 'PUB2';                      /* ID = PUB2              */ 06310036
*    VID(2) = 'DVTY';                      /* ID = DVTY              */ 06320036
*    VID(3) = 'BDY';                       /* ID = BDY               */ 06330036
*    VID(4) = 'CR';                        /* ID = CR                */ 06340036
*    VID(5) = 'PUB';                       /* ID = PUB               */ 06350036
*    VID(6) = 'CPUID';                     /* ID = CPUID             */ 06360036
*    VID(7) = 'MAP';                       /* ID = MAP               */ 06370036
*    VID(8) = 'DEVICE';                    /* ID = DEVICE            */ 06380036
*    VID(9) = 'SENSE';                     /* ID = SENSE             */ 06390036
*    VID(10) = 'GETVIS';                   /* ID = GETVIS            */ 06400036
*    VID(11) = 'PART';                     /* ID = PART    (IUI ONLY)*/ 06410036
*    VID(12) = 'SVA';                      /* ID = SVA     (IUI ONLY)*/ 06420036
*    VID(13) = 'SAINFO';                   /* ID = SAINFO            */ 06430036
*    VID(14) = 'ATLCUU';                   /* ID = ATLCUU            */ 06440036
*    IF NUMBER(ID) = 0  THEN               /* ID GIVEN               */ 06450036
*      DO;                                 /* NO                     */ 06460036
*        IKEY = 'ID';                      /* SET PARM FOR MNOTE     */ 06470036
*        GO TO MERR1;                      /* WRITE MNOTE            */ 06480036
*      END;                                /*                        */ 06490036
*                                          /*                        */ 06500036
* CHID:                                    /* CHECK & SET ID @D51MDGL*/ 06510036
*    N = N + 1;                            /* SET INDEX FOR  @D51MDGL*/ 06520036
*    IF N < 14+1 THEN DO;                  /* ID CHECK       @D61DDGL*/ 06530036
*      IF ID(1) = VID(N) THEN DO;          /* ID FOUND       @D51MDGL*/ 06540036
*        TID = N ;                         /* SET ID-FLAG    @D51MDGL*/ 06550036
*      END;                                /*                @D51MDGL*/ 06560036
*      ELSE DO;                            /*                @D51MDGL*/ 06570036
*        GO TO CHID;                       /* SEARCH NEXT    @D51MDGL*/ 06580036
*      END;                                /* END SEARCH     @D51MDGL*/ 06590036
*    END;                                  /*                @D51MDGL*/ 06600036
*    ELSE DO;                              /* NOT FOUND      @D51MDGL*/ 06610036
*      IKEY = 'ID-';                       /* SET IKEY       @D51MDGL*/ 06620036
*      GO TO MERR4;                        /* TELL ERROR     @D51MDGL*/ 06630036
*    END;                                  /*                @D51MDGL*/ 06640036
* /*******************************************************************/ 06650036
* /*                                                                 */ 06660036
* /*     CREATE DSECT FOR DESIRED SERVICE                            */ 06670036
* /*                                                                 */ 06680036
* /*******************************************************************/ 06690036
* IF TID = 1 THEN DO;           /* IF ID = PUB2              @D51MDGL*/ 06700036
*   ANS MSG('NO MAPPING AVAILABLE FOR THIS SERVICE')RESCAN;             06710036
*   RETURN CODE(4);                                                     06720036
* END;                                     /*                @D51MDGL*/ 06730036
* IF TID = 2 THEN DO;           /* IF ID = DVTY              @D51MDGL*/ 06740036
*   ANS MSG('NO MAPPING AVAILABLE FOR THIS SERVICE')RESCAN;             06750036
*   RETURN CODE(4);                                                     06760036
* END;                                     /*                @D51MDGL*/ 06770036
* IF TID = 3 THEN DO;           /* IF ID = BDY               @D51MDGL*/ 06780036
*   IF ((NUMBER(MODE) = 0)|                /* MODE = OMITTED @D51MDGL*/ 06790036
*       (MODE(1)='T')) THEN DO;            /* MODE = T       @D51MDGL*/ 06800036
*     ANS('DCL 1  MAPBDY BASED,      '||                                06810036
*         '/* DSECT FOR ID=BDY,MODE=T  */')                             06820036
*     RESCAN COL(MACLMAR);                                              06830036
*     ANS('     2 PBEGIN FIXED(31),  '||                                06840036
*         '/* PARTITION START ADDRESS  */')                             06850036
*     RESCAN COL(MACLMAR);                                              06860036
*     ANS('     2 PENDLOG FIXED(31), '||                                06870036
*         '/* PARTITION LOGICAL END    */')                             06880036
*     RESCAN COL(MACLMAR);                                              06890036
*     ANS('     2 PGEND   FIXED(31), '||                                06900036
*         '/* PARTITION PHYSICAL END   */')                             06910036
*     RESCAN COL(MACLMAR);                                              06920036
*     ANS('     2 PFIXLMT FIXED(31), '||                                06930036
*         '/* PFIX LIMIT IN K BYTES    */')                             06940036
*     RESCAN COL(MACLMAR);                                              06950036
*     ANS('     2 PFIXCNT FIXED(31); '||                                06960036
*         '/* NUMBER OF PFIXED PAGES   */')                             06970036
*     RESCAN COL(MACLMAR);                                              06980036
*     RETURN CODE(0);                                                   06990036
*   END;                                   /*                @D51MDGL*/ 07000036
*   IF MODE(1) = 'P' THEN DO;              /* MODE = P       @D51MDGL*/ 07010036
*     ANS ('DCL 1 MAPBDYVR BASED,   '||                    /*@D51..GL*/ 07020036
*        ' /*DSECT FOR ID=BDY,MODE=P*/')                   /*@D51..GL*/ 07030036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07040036
*     ANS ('    2 VPBEGIN   PTR(31),'||                    /*@D51..GL*/ 07050036
*        ' /*VIRTUAL PART.START ADDRESS*/')                /*@D51..GL*/ 07060036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07070036
*     ANS ('    2 VPEND     PTR(31),'||                    /*@D51..GL*/ 07080036
*        ' /*VIRTUAL PART.LOGICAL END*/')                  /*@D51..GL*/ 07090036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07100036
*     ANS ('    2 VPGEND    PTR(31),'||                    /*@D51..GL*/ 07110036
*        ' /*VIRTUAL PART.PHYSICAL END*/')                 /*@D51..GL*/ 07120036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07130036
*     ANS ('    2 RPBEGIN   PTR(31),'||                    /*@D51..GL*/ 07140036
*        ' /*REAL PARTITION START ADDRESS*/')              /*@D51..GL*/ 07150036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07160036
*     ANS ('    2 RPEND     PTR(31);'||                    /*@D51..GL*/ 07170036
*        ' /*REAL PARTITION END ADDRESS*/')                /*@D51..GL*/ 07180036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07190036
*     RETURN CODE(0);                                                   07200036
*   END;                                   /*                @D51MDGL*/ 07210036
*   IF MODE(1) = 'TEMP' THEN DO;           /* MODE = TEMP    @D51MDGL*/ 07220036
*     PRE = PREFIX(1);                                                  07230036
*     IF (PRE = '') THEN DO;                                            07240036
*       PRE = 'MAP';                                                    07250036
*     END;                                                              07260036
*     IF (MNAME = '') THEN DO;                            /*@D51..GL*/ 07270036
*       ANS ('DCL 1 '||MNAME||'    BASED,   '||            /*@D51..GL*/ 07280036
*          ' /*DSECT FOR ID=BDY,MODE=TEMP*/')              /*@D51..GL*/ 07290036
*       RESCAN COL(MACLMAR);                               /*@D51..GL*/ 07300036
*     END;                                                 /*@D51..GL*/ 07310036
*     ELSE DO;                                             /*@D51..GL*/ 07320036
*       ANS ('DCL 1 '||PRE||'BDYTM BASED,   '||            /*@D51..GL*/ 07330036
*          ' /*DSECT FOR ID=BDY,MODE=TEMP*/')              /*@D51..GL*/ 07340036
*       RESCAN COL(MACLMAR);                               /*@D51..GL*/ 07350036
*     END;                                                 /*@D51..GL*/ 07360036
*     ANS ('    2 '||PRE||'PTBEG  PTR(31),'||              /*@D51..GL*/ 07370036
*        ' /*1ST ADDRESSABLE BYTE OF PARTITION*/')         /*@D51..GL*/ 07380036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07390036
*     ANS ('    2 '||PRE||'PTPPE  PTR(31),'||              /*@D51..GL*/ 07400036
*        ' /*LST ADDRESSABLE BYTE OF PARTITION*/')         /*@D51..GL*/ 07410036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07420036
*     ANS ('    2 '||PRE||'PTEND  PTR(31),'||              /*@D51..GL*/ 07430036
*        ' /*LST ADDR. BYTE OF PARTITION, INCL.GETVIS*/')  /*@D51..GL*/ 07440036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07450036
*     ANS ('    2 '||PRE||'PFXLL  PTR(31),'||              /*@D51..GL*/ 07460036
*        ' /*PFIX LIMIT (K-BYTES) OR ZERO (REAL MODE)*/')  /*@D51..GL*/ 07470036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07480036
*     ANS ('    2 '||PRE||'PFXCL  PTR(31),'||              /*@D51..GL*/ 07490036
*        ' /*PFIX COUNT (NUMBER OF PFIXED PAGES)*/')       /*@D51..GL*/ 07500036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07510036
*     ANS ('    2 '||PRE||'PFXL3  PTR(31),'||              /*@D51..GL*/ 07520036
*        ' /*PFIX LIMIT FOR STORAGE ABOVE 16 MB LINE*/')   /*@D51..GL*/ 07530036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07540036
*     ANS ('    2 '||PRE||'PFXC3  PTR(31);'||              /*@D51..GL*/ 07550036
*        ' /*PFIX COUNT FOR STORAGE ABOVE 16 MB LINE*/')   /*@D51..GL*/ 07560036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07570036
*     RETURN CODE(0);                                                   07580036
*   END;                                   /*                @D51MDGL*/ 07590036
*   IF MODE(1) = 'PERM' THEN DO;           /* MODE = PERM    @D51MDGL*/ 07600036
*     PRE = PREFIX(1);                                                  07610036
*     IF (PRE = '') THEN DO;                                            07620036
*       PRE = 'MAP';                                                    07630036
*     END;                                                              07640036
*     IF (MNAME = '') THEN DO;                            /*@D51..GL*/ 07650036
*       ANS ('DCL 1 '||MNAME||'    BASED,   '||            /*@D51..GL*/ 07660036
*          ' /*DSECT FOR ID=BDY,MODE=TEMP*/')              /*@D51..GL*/ 07670036
*       RESCAN COL(MACLMAR);                               /*@D51..GL*/ 07680036
*     END;                                                 /*@D51..GL*/ 07690036
*     ELSE DO;                                             /*@D51..GL*/ 07700036
*       ANS ('DCL 1 '||PRE||'BDYPM BASED,   '||            /*@D51..GL*/ 07710036
*          ' /*DSECT FOR ID=BDY,MODE=PERM*/')              /*@D51..GL*/ 07720036
*       RESCAN COL(MACLMAR);                               /*@D51..GL*/ 07730036
*     END;                                                 /*@D51..GL*/ 07740036
*     ANS ('    2 '||PRE||'VPBEG  PTR(31),'||              /*@D51..GL*/ 07750036
*        ' /*1ST ADDRESSABLE BYTE OF PARTITION*/')         /*@D51..GL*/ 07760036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07770036
*     ANS ('    2 '||PRE||'VPPPE  PTR(31),'||              /*@D51..GL*/ 07780036
*        ' /*LST ADDR. BYTE OF PROGRAM AREA IN PART.*/')   /*@D51..GL*/ 07790036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07800036
*     ANS ('    2 '||PRE||'VPEND  PTR(31),'||              /*@D51..GL*/ 07810036
*        ' /*LST ADDR. BYTE OF PARTITION, INCL. GETVIS*/') /*@D51..GL*/ 07820036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07830036
*     ANS ('    2 '||PRE||'RPBEG  PTR(31),'||              /*@D51..GL*/ 07840036
*        ' /*1ST BYTE OF REAL PARTITION*/')                /*@D51..GL*/ 07850036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07860036
*     ANS ('    2 '||PRE||'RPEND  PTR(31),'||              /*@D51..GL*/ 07870036
*        ' /*LST BYTE OF REAL PARTITION*/')                /*@D51..GL*/ 07880036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07890036
*     ANS ('    2 '||PRE||'PFXLL  PTR(31),'||              /*@D51..GL*/ 07900036
*        ' /*PFIX LIMIT FOR STORAGE BELOW 16 MB LINE*/')   /*@D51..GL*/ 07910036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07920036
*     ANS ('    2 '||PRE||'PFXL3  PTR(31);'||              /*@D51..GL*/ 07930036
*        ' /*PFIX LIMIT FOR STORAGE ABOVE 16 MB LINE*/')   /*@D51..GL*/ 07940036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 07950036
*     RETURN CODE(0);                                                   07960036
*   END;                                   /*                @D51MDGL*/ 07970036
*   IF MODE(1) = 'SYSP' THEN DO;           /* MODE = SYSP    @D51MDGL*/ 07980036
*     PRE = PREFIX(1);                                                  07990036
*     IF (PRE = '') THEN DO;                                            08000036
*       PRE = 'MAP';                                                    08010036
*     END;                                                              08020036
*     IF (MNAME = '') THEN DO;                            /*@D51..GL*/ 08030036
*       ANS ('DCL 1 '||MNAME||'   BASED,    '||            /*@D51..GL*/ 08040036
*          ' /* DUMMY SECTION FOR ID=SYSP */')             /*@D51..GL*/ 08050036
*       RESCAN COL(MACLMAR);                               /*@D51..GL*/ 08060036
*     END;                                                 /*@D51..GL*/ 08070036
*     ELSE DO;                                             /*@D51..GL*/ 08080036
*       ANS ('DCL 1 '||PRE||'SYSP BASED,    '||            /*@D51..GL*/ 08090036
*          ' /* DUMMY SECTION FOR ID=SYSP */')             /*@D51..GL*/ 08100036
*       RESCAN COL(MACLMAR);                               /*@D51..GL*/ 08110036
*     END;                                                 /*@D51..GL*/ 08120036
*     ANS ('    2 '||PRE||'SUPBG  PTR(31),'||              /*@D51..GL*/ 08130036
*        ' /*1ST BYTE OF SUPERVISOR*/')                    /*@D51..GL*/ 08140036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08150036
*     ANS ('    2 '||PRE||'SUPND  PTR(31),'||              /*@D51..GL*/ 08160036
*        ' /*LAST BYTE OF SUPERVISOR*/')                   /*@D51..GL*/ 08170036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08180036
*     ANS ('    2 '||PRE||'SSBEG  PTR(31),'||              /*@D51..GL*/ 08190036
*        ' /*1ST BYTE OF SDAID AREA*/')                    /*@D51..GL*/ 08200036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08210036
*     ANS ('    2 '||PRE||'SSEND  PTR(31),'||              /*@D51..GL*/ 08220036
*        ' /*LAST BYTE OF SDAID AREA*/')                   /*@D51..GL*/ 08230036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08240036
*     ANS ('    2 '||PRE||'SVA    PTR(31),'||              /*@D51..GL*/ 08250036
*        ' /*1ST BYTE OF SVA*/')                           /*@D51..GL*/ 08260036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08270036
*     ANS ('    2 '||PRE||'ESVA   PTR(31),'||              /*@D51..GL*/ 08280036
*        ' /*LAST BYTE OF SVA*/')                          /*@D51..GL*/ 08290036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08300036
*     ANS ('    2 '||PRE||'SPBEG  PTR(31),'||              /*@D51..GL*/ 08310036
*        ' /*1ST BYTE OF SHARED PART. AREA*/')             /*@D51..GL*/ 08320036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08330036
*     ANS ('    2 '||PRE||'SPEND  PTR(31),'||              /*@D51..GL*/ 08340036
*        ' /*LAST BYTE OF SHARED PART.AREA*/')             /*@D51..GL*/ 08350036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08360036
*     ANS ('    2 '||PRE||'PRPBG  PTR(31),'||              /*@D51..GL*/ 08370036
*        ' /*1ST BYTE OF PRIV. PART. AREA*/')              /*@D51..GL*/ 08380036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08390036
*     ANS ('    2 '||PRE||'PRPND  PTR(31),'||              /*@D51..GL*/ 08400036
*        ' /*LAST BYTE OF PRIV. PART. AREA*/')             /*@D51..GL*/ 08410036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08420036
*     ANS ('    2 '||PRE||'VPBEG  PTR(31),'||              /*@D51..GL*/ 08430036
*        ' /*1ST BYTE OF VPOOL AREA*/')                    /*@D51..GL*/ 08440036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08450036
*     ANS ('    2 '||PRE||'VPEND  PTR(31),'||              /*@D51..GL*/ 08460036
*        ' /*LAST BYTE OF VPOOL AREA*/')                   /*@D51..GL*/ 08470036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08480036
*     ANS ('    2 '||PRE||'SVIS   PTR(31),'||              /*@D51..GL*/ 08490036
*        ' /*1ST BYTE OF SYSTEM GETVIS AREA*/')            /*@D51..GL*/ 08500036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08510036
*     ANS ('    2 '||PRE||'SVISE  PTR(31),'||              /*@D51..GL*/ 08520036
*        ' /*LAST BYTE OF SYSTEM GETVIS AREA*/')           /*@D51..GL*/ 08530036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08540036
*     ANS ('    2 '||PRE||'PPBEG  PTR(31),'||              /*@D51..GL*/ 08550036
*        ' /*1ST BYTE OF PROBL.PROGR. AREA*/')             /*@D51..GL*/ 08560036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08570036
*     ANS ('    2 '||PRE||'SVA3B  PTR(31),'||              /*@D51..GL*/ 08580036
*        ' /*1ST BYTE OF 31 BIT ADDRESSABLE SVA*/')        /*@D51..GL*/ 08590036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08600036
*     ANS ('    2 '||PRE||'SVA3E  PTR(31),'||              /*@D51..GL*/ 08610036
*        ' /*LAST BYTE OF 31 BIT ADDR. SVA*/')             /*@D51..GL*/ 08620036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08630036
*     ANS ('    2 '||PRE||'SGV3B  PTR(31),'||              /*@D51..GL*/ 08640036
*        ' /*1ST BYTE OF 31 BIT ADDR. GETVIS*/')           /*@D51..GL*/ 08650036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08660036
*     ANS ('    2 '||PRE||'SGV3E  PTR(31),'||              /*@D51..GL*/ 08670036
*        ' /*LAST BYTE OF 31 BIT ADDR. GETVIS*/')          /*@D51..GL*/ 08680036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08690036
*     ANS ('    2 '||PRE||'VLB3B  PTR(31),'||              /*@D51..GL*/ 08700036
*        ' /*1ST BYTE OF 31 BIT ADDR. VIRTUAL LIB.*/')     /*@D51..GL*/ 08710036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08720036
*     ANS ('    2 '||PRE||'VLB3E  PTR(31),'||              /*@D51..GL*/ 08730036
*        ' /*LAST BYTE OF 31 BIT ADDR. VIRTUAL LIB.*/')    /*@D51..GL*/ 08740036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08750036
*     ANS ('    2 '||PRE||'VSIZE  PTR(31),'||              /*@D51..GL*/ 08760036
*        ' /*TOTAL VIRTUAL STORAGE SIZE IN KBYTE */')      /*@D51..GL*/ 08770036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08780036
*     ANS ('    2 '||PRE||'SYSVS  PTR(31),'||              /*@D51..GL*/ 08790036
*          ' /*TOTAL VSIZE OF SYST.USED ADDR.SPACES */')   /*@D51..GL*/ 08800036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08810036
*     ANS ('    2 '||PRE||'SPFLL  PTR(31),'||              /*@D51..GL*/ 08820036
*          ' /*SYSTEM PFIX LIMIT IN LOW AREA (PAGES)*/')   /*@D51..GL*/ 08830036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08840036
*     ANS ('    2 '||PRE||'SPFCL  PTR(31),'||              /*@D51..GL*/ 08850036
*          ' /*SYS. PFIX COUNTER IN LOW AREA (PAGES)*/')   /*@D51..GL*/ 08860036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08870036
*     ANS ('    2 '||PRE||'SPFL3  PTR(31),'||              /*@D51..GL*/ 08880036
*          ' /*SYS. PFIX LIMIT IN HIGH AREA (PAGES)*/')    /*@D51..GL*/ 08890036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08900036
*     ANS ('    2 '||PRE||'SPFC3  PTR(31);'||              /*@D51..GL*/ 08910036
*          ' /*SYS. PFIX COUNTER IN HIGH AREA(PAGES)*/')   /*@D51..GL*/ 08920036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 08930036
*                                                                       08940036
*     RETURN CODE(0);                                                   08950036
*   END;                                   /*                @D51MDGL*/ 08960036
*   IKEY = 'MODE-';                        /* FOR ERRORMSG   @D51MDGL*/ 08970036
*   GO TO MERR4;                           /* TELL ERROR     @D51MDGL*/ 08980036
* END;                                     /*                @D51MDGL*/ 08990036
* IF TID = 4 THEN DO;           /* IF ID = CONTROL REGS      @D51MDGL*/ 09000036
*   ANS MSG('NO MAPPING AVAILABLE FOR THIS SERVICE')RESCAN;             09010036
*   RETURN CODE(4);                                                     09020036
* END;                                     /*                @D51MDGL*/ 09030036
* IF TID = 5 THEN DO;           /* IF ID = PUB               @D51MDGL*/ 09040036
*   ANS MSG('NO MAPPING AVAILABLE FOR THIS SERVICE')RESCAN;             09050036
*   RETURN CODE(4);                                                     09060036
* END;                                     /*                @D51MDGL*/ 09070036
* IF TID = 6 THEN DO;           /* IF ID = CPUID             @D51MDGL*/ 09080036
*   PRE = PREFIX(1);                                                    09090036
*   IF (PRE = '') THEN DO;                                              09100036
*     PRE = 'MAP';                                                      09110036
*   END;                                                                09120036
*   IF (MNAME = '') THEN DO;                              /*@D51..GL*/ 09130036
*     ANS ('DCL 1 '||MNAME||'    BASED,   '||              /*@D51..GL*/ 09140036
*          ' /*DUMMY SECTION FOR ID=CPUID*/')              /*@D51..GL*/ 09150036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 09160036
*   END;                                                   /*@D51..GL*/ 09170036
*   ELSE DO;                                               /*@D51..GL*/ 09180036
*     ANS ('DCL 1 '||PRE||'CPUSL BASED,   '||              /*@D51..GL*/ 09190036
*          ' /*DUMMY SECTION FOR ID=CPUID*/')              /*@D51..GL*/ 09200036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 09210036
*   END;                                                   /*@D51..GL*/ 09220036
*   ANS ('    2 '||PRE||'CPUID  CHAR(8),'||                /*@D51..GL*/ 09230036
*        ' /*TOTAL CPUID*/')                               /*@D51..GL*/ 09240036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09250036
*   ANS ('    3 '||PRE||'CPUVC  CHAR,   '||                /*@D51..GL*/ 09260036
*        ' /*CPU VERSION CODE*/')                          /*@D51..GL*/ 09270036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09280036
*   ANS ('    3 '||PRE||'CPUIN  CHAR(3),'||                /*@D51..GL*/ 09290036
*        ' /*CPU IDENTIFICATION NUMBER*/')                 /*@D51..GL*/ 09300036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09310036
*   ANS ('    3 '||PRE||'CPUMN  CHAR(2),'||                /*@D51..GL*/ 09320036
*        ' /*CPU MODEL NUMBER*/')                          /*@D51..GL*/ 09330036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09340036
*   ANS ('    3 *               CHAR(2),'||                /*@D51..GL*/ 09350036
*        ' /* RESERVED */')                                /*@D51..GL*/ 09360036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09370036
*   ANS ('    2 '||PRE||'LOGID  CHAR(2),'||                /*@D51..GL*/ 09380036
*        ' /*SYSLOG ID OF CALLING PARTITION IN EBCDIC*/')  /*@D51..GL*/ 09390036
*   RESCAN COL(MACLMAR);                                   /*@DY45557*/ 09400036
*   ANS ('    2 '||PRE||'VSEID  CHAR(8);'||                /*@DY45557*/ 09410036
*        ' /*VSE MACHINE-ID                          */')  /*@DY45557*/ 09420036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09430036
*   RETURN CODE(0);                                                     09440036
* END;                                     /*                @D51MDGL*/ 09450036
* IF TID = 7 THEN DO;           /* IF ID = MAP               @D51MDGL*/ 09460036
*   ANS MSG('NO MAPPING AVAILABLE FOR THIS SERVICE')RESCAN;             09470036
*   RETURN CODE(4);                                                     09480036
* END;                                     /*                @D51MDGL*/ 09490036
* IF TID = 8 THEN DO;           /* IF ID = DEVICE            @D51MDGL*/ 09500036
*   PRE = PREFIX(1);                                                    09510036
*   IF (PRE = '') THEN DO;                                              09520036
*     PRE = 'IJB';                                                      09530036
*   END;                                                                09540036
*   IF (MNAME = '') THEN DO;                              /*@D51..GL*/ 09550036
*     ANS ('DCL 1 '||MNAME||' BASED,'||                    /*@D51..GL*/ 09560036
*          '  /*DUMMY SECTION FOR EXTRACT ID=DEVICE */')   /*@D51..GL*/ 09570036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 09580036
*   END;                                                   /*@D51..GL*/ 09590036
*   ELSE DO;                                               /*@D51..GL*/ 09600036
*     ANS ('DCL 1 '||PRE||'DVINF BASED,'||                 /*@D51..GL*/ 09610036
*          '  /*DUMMY SECTION FOR EXTRACT ID=DEVICE */')   /*@D51..GL*/ 09620036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 09630036
*   END;                                                   /*@D51..GL*/ 09640036
*   ANS ('    2 '||PRE||'DVCUU  BIT(16),  '||              /*@D51..GL*/ 09650036
*        ' /*CUU ADDRESS*/')                               /*@D51..GL*/ 09660036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09670036
*   ANS ('    2 '||PRE||'DVDTC  BIT(8), '||                /*@D51..GL*/ 09680036
*        ' /*VSE DEVICE TYPE CODE*/')                      /*@D51..GL*/ 09690036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09700036
*   ANS ('    2 '||PRE||'DVSNS  CHAR(7),'||                /*@D51..GL*/ 09710036
*        ' /*SENSE DEVICE TYPE INFORMATION*/')             /*@D51..GL*/ 09720036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09730036
*   ANS ('    3 '||PRE||'DVSNV  BIT(8), '||                /*@D51..GL*/ 09740036
*        ' /*VALIDITY FLAG*/')                             /*@D51..GL*/ 09750036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09760036
*   ANS ('    3 '||PRE||'DVCUN  CHAR(2),'||                /*@D51..GL*/ 09770036
*        ' /*CONTROL-UNIT TYPE NUMBER*/')                  /*@D51..GL*/ 09780036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09790036
*   ANS ('    3 '||PRE||'DVCUM  BIT(8), '||                /*@D51..GL*/ 09800036
*        ' /*CONROL-UNIT MODEL NUMBER*/')                  /*@D51..GL*/ 09810036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09820036
*   ANS ('    3 '||PRE||'DVDTN  CHAR(2),'||                /*@D51..GL*/ 09830036
*        ' /*DEVICE TYPE NUMBER*/')                        /*@D51..GL*/ 09840036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09850036
*   ANS ('    3 '||PRE||'DVDTM  BIT(8), '||                /*@D51..GL*/ 09860036
*        ' /*DEVICE TYPE MODEL NUMBER*/')                  /*@D51..GL*/ 09870036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 09880036
*   IF (RECID(1) = 'NO') THEN DO;                         /*@D66EDAP*/ 09890036
*     ANS ('    2 '||PRE||'DVTYP  CHAR(3),'||              /*@D51..GL*/ 09900036
*          ' /*DEVICE TYPE CODES   */')                    /*@D51..GL*/ 09910036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 09920036
*     ANS ('    3 '||PRE||'DVOBR  BIT(16),'||              /*@D51..GL*/ 09930036
*          ' /*OBR - CODE            */')                  /*@D51..GL*/ 09940036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 09950036
*     ANS ('    3 '||PRE||'DVMDR  BIT(8), '||              /*@D51..GL*/ 09960036
*          ' /*MDR - CODE            */')                  /*@D51..GL*/ 09970036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 09980036
*     ANS ('    2 '||PRE||'DVCID  BIT(8), '||              /*@D66EDAP*/ 09990036
*          ' /*CU TYPE CODE          */')                  /*@D66EDAP*/ 10000036
*     RESCAN COL(MACLMAR);                                 /*@D66EDAP*/ 10010036
*      IF (RECID(1) = 'QDIO') THEN DO;                     /*@D66EDAP*/ 10020036
*        ANS ('    2 '||PRE||'DVSCH  BIT(16), '||          /*@D66EDAP*/ 10030036
*             ' /*SUBCHANNEL NUMBER     */')               /*@D66EDAP*/ 10040036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10050036
*        ANS ('    2 '||PRE||'DVDTY  BIT(8), '||           /*@D66EDAP*/ 10060036
*             ' /*DEVICE QUALIFIER CODE */')               /*@D66EDAP*/ 10070036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10080036
*        ANS ('    2 '||PRE||'DFEAT  BIT(8), '||           /*@D66EDAP*/ 10090036
*             ' /*DEVICE FEATURES       */')               /*@D66EDAP*/ 10100036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10110036
*        ANS ('    3 '||PRE||'DPCI   BIT(1), '||           /*@D66EDAP*/ 10120036
*             ' /*UNSOLICITED PCI       */')               /*@D66EDAP*/ 10130036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10140036
*        ANS ('    3 '||PRE||'SIGAR  BIT(1), '||           /*@D66EDAP*/ 10150036
*             ' /*SIGA READ  REQUIRED   */')               /*@D66EDAP*/ 10160036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10170036
*        ANS ('    3 '||PRE||'SIGAW  BIT(1), '||           /*@D66EDAP*/ 10180036
*             ' /*SIGA WRITE REQUIRED   */')               /*@D66EDAP*/ 10190036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10200036
*        ANS ('    3 '||PRE||'SIGAS  BIT(1), '||           /*@D66EDAP*/ 10210036
*             ' /*SIGA SYNC  REQUIRED   */')               /*@D66EDAP*/ 10220036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10230036
*        ANS ('    3 '||PRE||'RESVD  BIT(4), '||           /*@D66EDAP*/ 10240036
*             ' /*RESERVED BITS         */')               /*@D66EDAP*/ 10250036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10260036
*        ANS ('    2 '||PRE||'DVCAD  BIT(8), '||           /*@D66EDAP*/ 10270036
*             ' /*CHPID ID              */')               /*@D66EDAP*/ 10280036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10290036
*        ANS ('    2 '||PRE||'DVDAD  BIT(8), '||           /*@D66EDAP*/ 10300036
*             ' /*DEVICE ADDRESS        */')               /*@D66EDAP*/ 10310036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10320036
*        ANS ('    2 '||PRE||'DVEST  BIT(24), '||          /*@D66EDAP*/ 10330036
*             ' /*ESTABLISH COMMAND INFO*/')               /*@D66EDAP*/ 10340036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10350036
*        ANS ('    2 '||PRE||'DVACT  BIT(24), '||          /*@D66EDAP*/ 10360036
*             ' /*ACTIVATE  COMMAND INFO*/')               /*@D66EDAP*/ 10370036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10380036
*        ANS ('    2 '||PRE||'DIQNO  FIXED(8), '||         /*@D66EDAP*/ 10390036
*             ' /*INPUT QUEUE NUMBER    */')               /*@D66EDAP*/ 10400036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10410036
*        ANS ('    2 '||PRE||'DOQNO  FIXED(8), '||         /*@D66EDAP*/ 10420036
*             ' /*OUTPUT QUEUE NUMBER   */')               /*@D66EDAP*/ 10430036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10440036
*        ANS ('    2 '||PRE||'DQFMT  FIXED(8), '||         /*@D67FDMZ*/ 10450036
*             ' /*QDIO QUEUE FORMAT     */')               /*@D67FDMZ*/ 10460036
*        RESCAN COL(MACLMAR);                              /*@D66EDAP*/ 10470036
*        ANS ('    2 '||PRE||'DFLG1  BIT(8), '||           /*@D67FDMZ*/ 10480036
*             ' /*ADDITIONAL IQDIO FEATURE */')            /*@D67FDMZ*/ 10490036
*        RESCAN COL(MACLMAR);                              /*@D67FDMZ*/ 10500036
*        ANS ('    3 '||PRE||'AINTF  BIT(1), '||           /*@D67FDMZ*/ 10510036
*             ' /*ADAPTER INTERRUPT FAC.*/')               /*@D67FDMZ*/ 10520036
*        RESCAN COL(MACLMAR);                              /*@D67FDMZ*/ 10530036
*        ANS ('    3 '||PRE||'SCSC   BIT(1), '||           /*@D67FDMZ*/ 10540036
*             ' /*SET CSC COMMAND SUPP. */')               /*@D67FDMZ*/ 10550036
*        RESCAN COL(MACLMAR);                              /*@D67FDMZ*/ 10560036
*        ANS ('    3 '||PRE||'SCSCF  BIT(1), '||           /*@D67FDMZ*/ 10570036
*             ' /*SET CSC FAST CMD SUPP.*/')               /*@D67FDMZ*/ 10580036
*        RESCAN COL(MACLMAR);                              /*@D67FDMZ*/ 10590036
*        ANS ('    3 '||PRE||'RESVD  BIT(5), '||           /*@D67FDMZ*/ 10600036
*             ' /*RESERVED BITS         */')               /*@D67FDMZ*/ 10610036
*        RESCAN COL(MACLMAR);                              /*@D67FDMZ*/ 10620036
*        ANS ('    2 '||PRE||'DCULA   FIXED(8); '||        /*@D67FDMZ*/ 10630036
*             ' /*CNTRL UNIT IMAGE ID   */')               /*@D67FDMZ*/ 10640036
*        RESCAN COL(MACLMAR);                              /*@D67FDMZ*/ 10650036
*      END;                                                /*@D66EDAP*/ 10660036
*      ELSE                                                /*@DSCISMZ*/ 10660142
*         IF (RECID(1) = 'SCSI') THEN DO;                  /*@DSCSI  */ 10661040
*           ANS ('    2 '||PRE||'DFCPA  BIT(16), '||       /*@DSCSI  */ 10662040
*                ' /*FCP ADDRESS (CUU)     */')            /*@DSCSI  */ 10663040
*           RESCAN COL(MACLMAR);                           /*@DSCSI  */ 10664040
*           ANS ('    2 '||PRE||'DWWPN  CHAR(8), '||       /*@DSCSI  */ 10665040
*                ' /*WORLD-WIDE PORT NUMBER*/')            /*@DSCSI  */ 10666040
*           RESCAN COL(MACLMAR);                           /*@DSCSI  */ 10667040
*           ANS ('    2 '||PRE||'DLUN  CHAR(8); '||        /*@DSCSI  */ 10668041
*                ' /*DEVICE LUN ADDRESS    */')            /*@DSCSI  */ 10669040
*           RESCAN COL(MACLMAR);                           /*@DSCSI  */ 10669440
*         END;                                             /*@DSCSI  */ 10669540
*      ELSE DO;                                            /*@D51..GL*/ 10670036
*        ANS ('    2 '||PRE||'DVRCC  BIT(8), '||           /*@DY45299*/ 10680036
*             ' /*CONTROL UNIT TYPE REAL*/')               /*@DY45299*/ 10690036
*        RESCAN COL(MACLMAR);                              /*@DY45299*/ 10700036
*        ANS ('    2 '||PRE||'DVRDC  BIT(8); '||           /*@DY45299*/ 10710036
*             ' /*DEVICE TYPE (OBR) REAL*/')               /*@DY45299*/ 10720036
*        RESCAN COL(MACLMAR);                              /*@DY45299*/ 10730036
*      END;                                                /*@D51..GL*/ 10740036
*   END;                                                   /*@D51..GL*/ 10750036
*   ANS('DCL '||PRE||'DVVAL BIT(8) CONSTANT(''FF''X);'||   /*@D51..GL*/ 10760036
*       ' /*TO CHECK VALIDITY OF SENSE ID INFO */')        /*@D51..GL*/ 10770036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 10780036
*   RETURN CODE(0);                                                     10790036
* END;                                     /*                @D51MDGL*/ 10800036
* IF TID = 9 THEN DO;           /* IF ID = SENSE             @D51MDGL*/ 10810036
*   ANS MSG('NO MAPPING AVAILABLE FOR THIS SERVICE')RESCAN;             10820036
*   RETURN CODE(4);                                                     10830036
* END;                                     /*                @D51MDGL*/ 10840036
* IF TID = 10 THEN DO;          /* IF ID = GETVIS            @D51MDGL*/ 10850036
*   PRE = PREFIX(1);                                      /* @D51ODGL*/ 10860036
*   IF (PRE = '') THEN DO;                                              10870036
*     PRE = 'MAP';                                                      10880036
*   END;                                                                10890036
*   IF ((NUMBER(MODE) = 0)|                /* MODE = OMITTED @D51MDGL*/ 10900036
*       (MODE(1)='PT')) THEN DO;           /* MODE = PARTIT. @D51MDGL*/ 10910036
*     GVIND = 'PTG';                                       /*@D51..GL*/ 10920036
*   END;                                   /*                @D51MDGL*/ 10930036
*   ELSE IF MODE(1) = 'SP' THEN DO;        /* MODE = DYN.SPCE@D51MDGL*/ 10940036
*     GVIND = 'DYG';                                       /*@D51..GL*/ 10950036
*   END;                                   /*                @D51MDGL*/ 10960036
*   ELSE IF MODE(1) = 'SV' THEN DO;        /* MODE = SVA     @D51MDGL*/ 10970036
*     GVIND = 'SVG';                                       /*@D51..GL*/ 10980036
*   END;                                   /*                @D51MDGL*/ 10990036
*   ELSE DO;                                               /*@D51..GL*/ 11000036
*     IKEY = 'MODE-';                      /* FOR ERRORMSG   @D51MDGL*/ 11010036
*     GO TO MERR4;                         /* TELL ERROR     @D51MDGL*/ 11020036
*   END;                                                   /*@D51..GL*/ 11030036
*   IF (MNAME = '') THEN DO;                              /*@D51..GL*/ 11040036
*     ANS ('DCL 1 '||MNAME||' BASED,     '||               /*@D51..GL*/ 11050036
*          ' /*DSECT FOR ID=GETVIS      */')               /*@D51..GL*/ 11060036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 11070036
*   END;                                                   /*@D51..GL*/ 11080036
*   ELSE DO;                                               /*@D51..GL*/ 11090036
*     ANS ('DCL 1 '||PRE||GVIND||' BASED,     '||          /*@D51..GL*/ 11100036
*          ' /*DSECT FOR ID=GETVIS      */')               /*@D51..GL*/ 11110036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 11120036
*   END;                                                   /*@D51..GL*/ 11130036
*   ANS ('    2 '||PRE||GVIND||'CL  PTR(31),'||            /*@D51..GL*/ 11140036
*        ' /*LENGTH OF GETVIS CONTROL AREA*/')             /*@D51..GL*/ 11150036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11160036
*   ANS ('    2 '||PRE||GVIND||'HW  PTR(31),'||            /*@D51..GL*/ 11170036
*        ' /*HIGH WATER MARK, MAX. EVER USED SO FAR*/')    /*@D51..GL*/ 11180036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11190036
*   ANS ('    2 '||PRE||GVIND||'FR  PTR(31),'||            /*@D51..GL*/ 11200036
*        ' /*CURRENT FREE GETVIS SPACE*/')                 /*@D51..GL*/ 11210036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11220036
*   ANS ('    2 '||PRE||GVIND||'US  PTR(31),'||            /*@D51..GL*/ 11230036
*        ' /*CURRENT USED GETVIS SPACE*/')                 /*@D51..GL*/ 11240036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11250036
*   ANS ('    2 '||PRE||GVIND||'MF  PTR(31);'||            /*@D51..GL*/ 11260036
*        ' /*MAXIMUM CONTIGUOUS FREE SPACE*/')             /*@D51..GL*/ 11270036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11280036
*                                                                       11290036
*   RETURN CODE(0);                                                     11300036
* END;                                     /*                @D51MDGL*/ 11310036
* IF TID = 11 THEN DO;          /* IF ID = PART              @D51MDGL*/ 11320036
*   PRE = PREFIX(1);                                      /* @D51ODGL*/ 11330036
*   IF (PRE = '') THEN DO;                                              11340036
*     PRE = 'MAP';                                                      11350036
*   END;                                                                11360036
*   IF (MNAME = '') THEN DO;                              /*@D51..GL*/ 11370036
*     ANS ('DCL 1 '||MNAME||'   BASED,    '||              /*@D51..GL*/ 11380036
*          ' /*DUMMY SECTION FOR ID=PART*/')               /*@D51..GL*/ 11390036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 11400036
*   END;                                                   /*@D51..GL*/ 11410036
*   ELSE DO;                                               /*@D51..GL*/ 11420036
*     ANS ('DCL 1 '||PRE||'PART BASED,    '||              /*@D51..GL*/ 11430036
*          ' /*DUMMY SECTION FOR ID=PART*/')               /*@D51..GL*/ 11440036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 11450036
*   END;                                                   /*@D51..GL*/ 11460036
*   ANS ('    2 '||PRE||'PTGVC  PTR(31),'||                /*@D51..GL*/ 11470036
*        ' /*START OF PARTITION GETVIS CONTR.AREA*/')      /*@D51..GL*/ 11480036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11490036
*   ANS ('    2 '||PRE||'DYGVC  PTR(31),'||                /*@D51..GL*/ 11500036
*        ' /*START OF DYN.SPACE GETVIS CONT.AREA*/')       /*@D51..GL*/ 11510036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11520036
*   ANS ('    2 '||PRE||'PTBEG  PTR(31),'||                /*@D51..GL*/ 11530036
*        ' /*1ST BYTE OF VIRTUAL/REAL PARTITION*/')        /*@D51..GL*/ 11540036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11550036
*   ANS ('    2 '||PRE||'PTHPH  PTR(31),'||                /*@D51..GL*/ 11560036
*        ' /*HIGHEST PHASE LOAD ADDRESS*/')                /*@D51..GL*/ 11570036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11580036
*   ANS ('    2 '||PRE||'PTNAM  CHAR(8),'||                /*@D51..GL*/ 11590036
*        ' /*NAME OF JOB IN PARTITION*/')                  /*@D51..GL*/ 11600036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11610036
*   ANS ('    2 '||PRE||'PTPPE  PTR(31),'||                /*@D51..GL*/ 11620036
*        ' /*CURRENT PROBLEM PROGRAM END ADDRESS*/')       /*@D51..GL*/ 11630036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11640036
*   ANS ('    2 '||PRE||'PTEND  PTR(31),'||                /*@D51..GL*/ 11650036
*        ' /*LAST ADDR. BYTE OF VIRT./REAL PARTITION*/')   /*@D51..GL*/ 11660036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11670036
*   ANS ('    2 '||PRE||'DYGVB  PTR(31),'||                /*@D51..GL*/ 11680036
*        ' /*BEGIN OF SPACE GETVIS AREA*/')                /*@D51..GL*/ 11690036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11700036
*   ANS ('    2 '||PRE||'DYGVE  PTR(31),'||                /*@D51..GL*/ 11710036
*        ' /*END OF DYNAMIC SPACE GETVIS AREA*/')          /*@D51..GL*/ 11720036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11730036
*   ANS ('    2     *           CHAR(3),'||                /*@D51..GL*/ 11740036
*        ' /*RESERVED*/')                                  /*@D51..GL*/ 11750036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11760036
*   ANS ('    2 '||PRE||'PTPIB   BIT(8),'||                /*@D51..GL*/ 11770036
*        ' /*PIBFLAG FROM PIB*/')                          /*@D51..GL*/ 11780036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11790036
*   ANS ('    2 '||PRE||'PTGCL  PTR(31),'||                /*@D51..GL*/ 11800036
*        ' /*LNG. OF PART.GETV.CONTR.AREA (BELOW)*/')      /*@D51..GL*/ 11810036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11820036
*   ANS ('    2 '||PRE||'PTGHW  PTR(31),'||                /*@D51..GL*/ 11830036
*        ' /*MAX.CONSUMED PART.GETV.SO FAR (BELOW)*/')     /*@D51..GL*/ 11840036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11850036
*   ANS ('    2 '||PRE||'PTGFR  PTR(31),'||                /*@D51..GL*/ 11860036
*        ' /*CURRENT TOTAL FREE PART.GETV. (BELOW) */')    /*@D51..GL*/ 11870036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11880036
*   ANS ('    2 '||PRE||'PTGUS  PTR(31),'||                /*@D51..GL*/ 11890036
*        ' /*CURRENT TOTAL USED PART.GETV. (BELOW) */')    /*@D51..GL*/ 11900036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11910036
*   ANS ('    2 '||PRE||'PTGMF  PTR(31),'||                /*@D51..GL*/ 11920036
*        ' /*CURRENT MAX.CONTIG.FREE P.GV. (BELOW) */')    /*@D51..GL*/ 11930036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11940036
*   ANS ('    2 '||PRE||'DYGCL  PTR(31),'||                /*@D51..GL*/ 11950036
*        ' /*LNG OF DYNAM. SPACE GETV. CONTR. AREA*/')     /*@D51..GL*/ 11960036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 11970036
*   ANS ('    2 '||PRE||'DYGHW  PTR(31),'||                /*@D51..GL*/ 11980036
*        ' /*MAX.CONSUMED DYN.SPACE GETVIS SO FAR */')     /*@D51..GL*/ 11990036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12000036
*   ANS ('    2 '||PRE||'DYGFR  PTR(31),'||                /*@D51..GL*/ 12010036
*        ' /*CURRENT TOTAL FREE DYN.SP. GETVIS */')        /*@D51..GL*/ 12020036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12030036
*   ANS ('    2 '||PRE||'DYGUS  PTR(31),'||                /*@D51..GL*/ 12040036
*        ' /*CURRENT TOTAL USED DYN.SP. GETVIS */')        /*@D51..GL*/ 12050036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12060036
*   ANS ('    2 '||PRE||'DYGMF  PTR(31),'||                /*@D51..GL*/ 12070036
*        ' /*CURRENT MAX.CONTIG. FREE DYN.SP. GETV.*/')    /*@D51..GL*/ 12080036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12090036
*   ANS ('    2 '||PRE||'VPBEG  PTR(31),'||                /*@D51..GL*/ 12100036
*        ' /*1ST BYTE OF VIRTUAL PARTITION */')            /*@D51..GL*/ 12110036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12120036
*   ANS ('    2 '||PRE||'VPEND  PTR(31),'||                /*@D51..GL*/ 12130036
*        ' /*LST BYTE OF VIRT.PART.,INCL. GETVIS*/')       /*@D51..GL*/ 12140036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12150036
*   ANS ('    2 '||PRE||'RPBEG  PTR(31),'||                /*@D51..GL*/ 12160036
*        ' /*1ST BYTE OF REAL PARTITION*/')                /*@D51..GL*/ 12170036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12180036
*   ANS ('    2 '||PRE||'RPEND  PTR(31),'||                /*@D51..GL*/ 12190036
*        ' /*LST BYTE OF REAL PARTITION*/')                /*@D51..GL*/ 12200036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12210036
*   ANS ('    2 '||PRE||'PAGCL  PTR(31),'||                /*@D51..GL*/ 12220036
*        ' /*LNG. OF PART.GETV.CONTR.AREA   (ANY)*/')      /*@D51..GL*/ 12230036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12240036
*   ANS ('    2 '||PRE||'PAGHW  PTR(31),'||                /*@D51..GL*/ 12250036
*        ' /*MAX.CONSUMED PART.GETV. SO FAR (ANY)*/')      /*@D51..GL*/ 12260036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12270036
*   ANS ('    2 '||PRE||'PAGFR  PTR(31),'||                /*@D51..GL*/ 12280036
*        ' /*CURRENT TOTAL FREE PART. GETV. (ANY)*/')      /*@D51..GL*/ 12290036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12300036
*   ANS ('    2 '||PRE||'PAGUS  PTR(31),'||                /*@D51..GL*/ 12310036
*        ' /*CURRENT TOTAL USED PART. GETV. (ANY)*/')      /*@D51..GL*/ 12320036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12330036
*   ANS ('    2 '||PRE||'PAGMF  PTR(31);'||                /*@D51..GL*/ 12340036
*        ' /*CURRENT MAX.CONTIG.FREE P.GETV. (ANY)*/')     /*@D51..GL*/ 12350036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12360036
*   RETURN CODE(0);                        /*                @D51MDGL*/ 12370036
* END;                                     /*                @D51MDGL*/ 12380036
* IF TID = 12 THEN DO;          /* IF ID = SVA               @D51MDGL*/ 12390036
*   PRE = PREFIX(1);                                      /* @D51ODGL*/ 12400036
*   IF (PRE = '') THEN DO;                                              12410036
*     PRE = 'XTR';                                                      12420036
*   END;                                                                12430036
*   IF (MNAME = '') THEN DO;                              /*@D51..GL*/ 12440036
*     ANS ('DCL 1 '||MNAME||'   BASED,    '||              /*@D51..GL*/ 12450036
*          ' /*DUMMY SECTION FOR ID=SVA */')               /*@D51..GL*/ 12460036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 12470036
*   END;                                                   /*@D51..GL*/ 12480036
*   ELSE DO;                                               /*@D51..GL*/ 12490036
*     ANS ('DCL 1 '||PRE||'SVA  BASED,    '||              /*@D51..GL*/ 12500036
*          ' /*DUMMY SECTION FOR ID=SVA */')               /*@D51..GL*/ 12510036
*     RESCAN COL(MACLMAR);                                 /*@D51..GL*/ 12520036
*   END;                                                   /*@D51..GL*/ 12530036
*   ANS ('    2 '||PRE||'SVAB   PTR(31),'||                /*@D51..GL*/ 12540036
*        ' /*1ST BYTE OF SVA LOW*/')                       /*@D51..GL*/ 12550036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12560036
*   ANS ('    2 '||PRE||'SVAE   PTR(31),'||                /*@D51..GL*/ 12570036
*        ' /*LST BYTE OF SVA LOW*/')                       /*@D51..GL*/ 12580036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12590036
*   ANS ('    2 '||PRE||'VLIBB  PTR(31),'||                /*@D51..GL*/ 12600036
*        ' /*1ST BYTE OF VIRTUAL LIBRARY LOW*/')           /*@D51..GL*/ 12610036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12620036
*   ANS ('    2 '||PRE||'VLIBF  PTR(31),'||                /*@D51..GL*/ 12630036
*        ' /*AMOUNT OF FREE SPACE IN VIRT.LIBR.*/')        /*@D51..GL*/ 12640036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12650036
*   ANS ('    2 '||PRE||'VLIBE  PTR(31),'||                /*@D51..GL*/ 12660036
*        ' /*LST BYTE OF VIRTUAL LIBRARY LOW*/')           /*@D51..GL*/ 12670036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12680036
*   ANS ('    2 '||PRE||'SVISC  PTR(31),'||                /*@D51..GL*/ 12690036
*        ' /*1ST BYTE OF SYST.GETVIS CONTROL*/')           /*@D51..GL*/ 12700036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12710036
*   ANS ('    2 '||PRE||'SVIS   PTR(31),'||                /*@D51..GL*/ 12720036
*        ' /*1ST ALLOCATABLE BYTE OF SYST. GETVIS*/')      /*@D51..GL*/ 12730036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12740036
*   ANS ('    2 '||PRE||'SVISE  PTR(31),'||                /*@D51..GL*/ 12750036
*        ' /*LST BYTE OF SYSTEM GETVIS AREA*/')            /*@D51..GL*/ 12760036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12770036
*   ANS ('    2 '||PRE||'SVGCL  PTR(31),'||                /*@D51..GL*/ 12780036
*        ' /*LNG OF GETVIS CNTL.AREA IN LOW PART*/')       /*@D51..GL*/ 12790036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12800036
*   ANS ('    2 '||PRE||'SVGHW  PTR(31),'||                /*@D51..GL*/ 12810036
*        ' /*LARGEST AMOUNT USED UP UNTIL NOW*/')          /*@D51..GL*/ 12820036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12830036
*   ANS ('    2 '||PRE||'SVGFR  PTR(31),'||                /*@D51..GL*/ 12840036
*        ' /*TOTAL AMOUNT OF FREE GETVIS SPACE*/')         /*@D51..GL*/ 12850036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12860036
*   ANS ('    2 '||PRE||'SVGUS  PTR(31),'||                /*@D51..GL*/ 12870036
*        ' /*TOTAL AMOUNT OF USED GETVIS SPACE*/')         /*@D51..GL*/ 12880036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12890036
*   ANS ('    2 '||PRE||'SVGMF  PTR(31),'||                /*@D51..GL*/ 12900036
*        ' /*LARGEST CONTIGUOUS FREE GETVIS SPACE*/')      /*@D51..GL*/ 12910036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12920036
*   ANS ('    2 '||PRE||'SVGRS  PTR(31),'||                /*@D51..GL*/ 12930036
*        ' /*NUMBER OF RESERVED PAGES IN GETVIS*/')        /*@D51..GL*/ 12940036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12950036
*   ANS ('    2 '||PRE||'SLAB   PTR(31),'||                /*@D51..GL*/ 12960036
*        ' /*1ST BYTE OF LABEL AREA*/')                    /*@D51..GL*/ 12970036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 12980036
*   ANS ('    2 '||PRE||'SLAE   PTR(31),'||                /*@D51..GL*/ 12990036
*        ' /*LST BYTE OF LABEL AREA*/')                    /*@D51..GL*/ 13000036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13010036
*   ANS ('    2 '||PRE||'VPOLB  PTR(31),'||                /*@D51..GL*/ 13020036
*        ' /*1ST BYTE OF VPOOL*/')                         /*@D51..GL*/ 13030036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13040036
*   ANS ('    2 '||PRE||'VPOLE  PTR(31),'||                /*@D51..GL*/ 13050036
*        ' /*LST BYTE OF VPOOL*/')                         /*@D51..GL*/ 13060036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13070036
*   ANS ('    2 '||PRE||'SVA3B  PTR(31),'||                /*@D51..GL*/ 13080036
*        ' /*1ST BYTE OF SVA HIGH*/')                      /*@D51..GL*/ 13090036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13100036
*   ANS ('    2 '||PRE||'SVA3E  PTR(31),'||                /*@D51..GL*/ 13110036
*        ' /*LST BYTE OF SVA HIGH*/')                      /*@D51..GL*/ 13120036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13130036
*   ANS ('    2 '||PRE||'SGV3B  PTR(31),'||                /*@D51..GL*/ 13140036
*        ' /*1ST BYTE ALLOCATABLE AREA OF GETVIS*/')       /*@D51..GL*/ 13150036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13160036
*   ANS ('    2 '||PRE||'SGV3E  PTR(31),'||                /*@D51..GL*/ 13170036
*        ' /*LST BYTE OF SYSTEM GETVIS AREA*/')            /*@D51..GL*/ 13180036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13190036
*   ANS ('    2 '||PRE||'VLB3B  PTR(31),'||                /*@D51..GL*/ 13200036
*        ' /*1ST BYTE OF VIRTUAL LIBRARY HIGH*/')          /*@D51..GL*/ 13210036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13220036
*   ANS ('    2 '||PRE||'VLB3E  PTR(31),'||                /*@D51..GL*/ 13230036
*        ' /*LST BYTE OF VIRTUAL LIBRARY HIGH*/')          /*@D51..GL*/ 13240036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13250036
*   ANS ('    2 '||PRE||'VLB3F  PTR(31),'||                /*@D51..GL*/ 13260036
*        ' /*AMOUNT OF FREE SPACE IN VIRT.LIBR.*/')        /*@D51..GL*/ 13270036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13280036
*   ANS ('    2 '||PRE||'SAGCL  PTR(31),'||                /*@D51..GL*/ 13290036
*        ' /*GETVIS CNTL AREA LNG IN HIGH PART */')        /*@D51..GL*/ 13300036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13310036
*   ANS ('    2 '||PRE||'SAGHW  PTR(31),'||                /*@D51..GL*/ 13320036
*        ' /*LARGEST AMOUNT USED UP UNTIL NOW*/')          /*@D51..GL*/ 13330036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13340036
*   ANS ('    2 '||PRE||'SAGFR  PTR(31),'||                /*@D51..GL*/ 13350036
*        ' /*TOTAL AMOUNT OF FREE GETVIS SPACE*/')         /*@D51..GL*/ 13360036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13370036
*   ANS ('    2 '||PRE||'SAGUS  PTR(31),'||                /*@D51..GL*/ 13380036
*        ' /*TOTAL AMOUNT OF USED GETVIS SPACE*/')         /*@D51..GL*/ 13390036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13400036
*   ANS ('    2 '||PRE||'SAGMF  PTR(31);'||                /*@D51..GL*/ 13410036
*        ' /*LARGEST CONTIGUOUS FREE GETVIS SPACE*/')      /*@D51..GL*/ 13420036
*   RESCAN COL(MACLMAR);                                   /*@D51..GL*/ 13430036
*                                                                       13440036
*                                                                       13450036
*   RETURN CODE(0);                        /*                @D51MDGL*/ 13460036
* END;                                     /*                @D51MDGL*/ 13470036
* IF TID = 13 THEN DO;          /* IF ID = SAINFO            @D61MDGL*/ 13480036
*   PRE = PREFIX(1);                                      /* @D61ODGL*/ 13490036
*   IF (PRE = '') THEN DO;                                              13500036
*     PRE = 'XTR';                                                      13510036
*   END;                                                                13520036
*   IF (MNAME = '') THEN DO;                              /*@D61DDGL*/ 13530036
*     ANS ('DCL 1 '||MNAME||'   BASED,    '||              /*@D61DDGL*/ 13540036
*          ' /*DUMMY SECTION FOR ID=SAINFO*/')             /*@D61DDGL*/ 13550036
*     RESCAN COL(MACLMAR);                                 /*@D61DDGL*/ 13560036
*   END;                                                   /*@D61DDGL*/ 13570036
*   ELSE DO;                                               /*@D61DDGL*/ 13580036
*     ANS ('DCL 1 '||PRE||'SAINF BASED,   '||              /*@D61DDGL*/ 13590036
*          ' /*DUMMY SECTION FOR ID=SAINFO*/')             /*@D61DDGL*/ 13600036
*     RESCAN COL(MACLMAR);                                 /*@D61DDGL*/ 13610036
*   END;                                                   /*@D61DDGL*/ 13620036
*   ANS ('    2 '||PRE||'FNDNO  PTR(31),'||                /*@D61DDGL*/ 13630036
*        ' /*NO OF FOUND ENTRIES*/')                       /*@D61DDGL*/ 13640036
*   RESCAN COL(MACLMAR);                                   /*@D61DDGL*/ 13650036
*   ANS ('    2 '||PRE||'FLAGS  PTR(31),'||                /*@D61DDGL*/ 13660036
*        ' /*FLAG BYTES         */')                       /*@D61DDGL*/ 13670036
*   RESCAN COL(MACLMAR);                                   /*@D61DDGL*/ 13680036
*   ANS ('    2 '||PRE||'EXTCD  PTR(31),'||                /*@D61DDGL*/ 13690036
*        ' /*EXTERNAL DEVICE TYPE CODE */')                /*@D61DDGL*/ 13700036
*   RESCAN COL(MACLMAR);                                   /*@D61DDGL*/ 13710036
*   ANS ('    2 '||PRE||'PDVTY  PTR(31),'||                /*@D61DDGL*/ 13720036
*        ' /*PUB DEVICE TYPE CODE */')                     /*@D61DDGL*/ 13730036
*   RESCAN COL(MACLMAR);                                   /*@D61DDGL*/ 13740036
*   ANS ('    2 '||PRE||'PMODE  PTR(31);'||                /*@D61DDGL*/ 13750036
*        ' /*DEFAULT MODE OF DEVICE */')                   /*@D61DDGL*/ 13760036
*   RESCAN COL(MACLMAR);                                   /*@D61DDGL*/ 13770036
*                                                                       13780036
*                                                                       13790036
*   RETURN CODE(0);                        /*                @D51MDGL*/ 13800036
* END;                                     /*                @D51MDGL*/ 13810036
* IF TID = 14 THEN DO;          /* IF ID = ATLCUU            @D61MDGL*/ 13820036
*    IF (NUMBER(MODE) = 0) THEN DO; /* MODE NOT ALLOWED     @D61MDGL*/ 13830036
*      IKEY = 'MODE-';                     /* SET IKEY       @D61DDGL*/ 13840036
*      GO TO MERR4;                        /* TELL ERROR     @D61DDEM*/ 13850036
*    END;                                  /*                @D61DDEM*/ 13860036
*    IF (NUMBER(RECID) = 0) THEN DO; /* RECID NOT ALLOWED   @D61MDGL*/ 13870036
*      IKEY = 'RECID-';                    /* SET IKEY       @D61DDGL*/ 13880036
*      GO TO MERR4;                        /* TELL ERROR     @D61DDEM*/ 13890036
*    END;                                  /*                @D61DDEM*/ 13900036
*   PRE = PREFIX(1);                                      /* @D61ODGL*/ 13910036
*   IF (PRE = '') THEN DO;                                              13920036
*     PRE = 'XTR';                                                      13930036
*   END;                                                                13940036
*   IF (MNAME = '') THEN DO;                              /*@D61DDGL*/ 13950036
*     ANS ('DCL 1 '||MNAME||'   BASED,    '||              /*@D61DDGL*/ 13960036
*          ' /*DUMMY SECTION FOR ID=ATLCUU*/')             /*@D61DDGL*/ 13970036
*     RESCAN COL(MACLMAR);                                 /*@D61DDGL*/ 13980036
*   END;                                                   /*@D61DDGL*/ 13990036
*   ELSE DO;                                               /*@D61DDGL*/ 14000036
*     ANS ('DCL 1 '||PRE||'ATLCU BASED,   '||              /*@D61DDGL*/ 14010036
*          ' /*DUMMY SECTION FOR ID=ATLCUU*/')             /*@D61DDGL*/ 14020036
*     RESCAN COL(MACLMAR);                                 /*@D61DDGL*/ 14030036
*   END;                                                   /*@D61DDGL*/ 14040036
*   ANS ('    2 '||PRE||'ATVER  PTR(31),'||                /*@D61DDGL*/ 14050036
*        ' /*VERSION OF INVOCAT.*/')                       /*@D61DDGL*/ 14060036
*   RESCAN COL(MACLMAR);                                   /*@D61DDGL*/ 14070036
*   ANS ('    2 '||PRE||'ATCUU  PTR(16),'||                /*@D61DDGL*/ 14080036
*        ' /*CUU VALUE (ANSWER) */')                       /*@D61DDGL*/ 14090036
*   RESCAN COL(MACLMAR);                                   /*@D61DDGL*/ 14100036
*   ANS ('    2 '||PRE||'ATDVT  CHAR(6),'||                /*@D61DDGL*/ 14110036
*        ' /*PUB DEVICE TYPE CODE */')                     /*@D61DDGL*/ 14120036
*   RESCAN COL(MACLMAR);                                   /*@D61DDGL*/ 14130036
*   ANS ('    2 '||PRE||'ATLNM  CHAR(8);'||                /*@D61DDGL*/ 14140036
*        ' /*LIBRARY NAME         */')                     /*@D61DDGL*/ 14150036
*   RESCAN COL(MACLMAR);                                   /*@D61DDGL*/ 14160036
*                                                                       14170036
*                                                                       14180036
*   RETURN CODE(0);                        /*                @D51MDGL*/ 14190036
* END;                                     /*                @D51MDGL*/ 14200036
* /**********************************************************@D51MDGL*/ 14210036
* /*                                                         @D51MDGL*/ 14220036
* /*     MNOTE DECLARATIONS                                  @D51MDGL*/ 14230036
* /*                                                         @D51MDGL*/ 14240036
* /**********************************************************@D51MDGL*/ 14250036
* MERR4:                                   /* ERROR NR 4     @D51MDGL*/ 14260036
* ANS MSG('INVALID IKEY OPERAND GIVEN,GENERATION SUPPRESSED;')RESCAN;   14270036
* ANS ('/* INVALID '||IKEY||' OPERAND GIVEN,GENERATION SUPPRESSED */')  14280036
* RESCAN COL(MACLMAR);                                                  14290036
* RETURN CODE(8);                          /*                @D51MDGL*/ 14300036
* MERR1:                                   /* WRITE MNOTE FOR        */ 14310036
* ANS MSG('IKEY OPERAND NOT GIVEN,GENERATION SUPPRESSED;')RESCAN ;      14320036
* ANS ('/* '||IKEY||' OPERAND NOT GIVEN,GENERATION SUPPRESSED */')      14330036
* RESCAN COL(MACLMAR);                                                  14340036
* RETURN CODE(8);                          /* MISSING OPERAND        */ 14350036
*%END;                                     /*                        */ 14360036
