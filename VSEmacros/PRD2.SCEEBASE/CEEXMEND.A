.********************************************************************** 00001000
.*                                                                    * 00002000
.*  CEEXMEND - BAL macro to mark the end of an LE/VSE messages module.* 00003000
.*                                                                    * 00004000
.*  Licensed Materials - Property of IBM                              * 00005000
.*                                                                    * 00006000
.*  5686-094  (C) Copyright IBM Corp. 1991,  1996                     * 00007000
.*  All rights reserved.                                              * 00008000
.*                                                                    * 00009000
.*                                                                    * 00010000
.*      US Government Users Restricted Rights - Use, duplication or   * 00011000
.*      disclosure restricted by GSA ADP Schedule Contract with IBM   * 00012000
.*      Corp.                                                         * 00013000
.*                                                                    * 00014000
.*  STATUS - Release level of this macro                              * 00015000
.*           LE/VSE Version 1 Release 4 Modification 0                * 00016000
.*                                                                    * 00017000
.*  FUNCTION:                                                         * 00018000
.*       This macro is used to establish the end of an LE/VSE         * 00019000
.*       messages module.                                             * 00020000
.*                                                                    * 00021000
.*  DEPENDENCIES - This macro is not to be called by a user routine.  * 00022000
.*                 Rather it is used by the ASSEMBLE routine generated* 00023000
.*                 by CEEBLDTX to contain the messages for use by     * 00024000
.*                 LE/VSE.                                            * 00025000
.*                                                                    * 00026000
.*  RESTRICTIONS - Used only by the ASSEMBLE routine generated by     * 00027000
.*                 CEEBLDTX.                                          * 00028000
.*                                                                    * 00029000
.*  REGISTER CONVENTIONS - none                                       * 00030000
.*                                                                    * 00031000
.*  LINKAGE - CEEXMEND                No parameters                   * 00032000
.*                                                                    * 00033000
.*  MESSAGES - none                                                   * 00034000
.*                                                                    * 00035000
.********************************************************************** 00036000
         MACRO                                                          00037000
&LABEL   CEEXMEND                                                       00038000
.*                                                                      00039000
         GBLA  &USECTR                                                  00040000
         GBLA  &UNUSED1(250),&UNUSED2(250),&UNUSED3(250),&UNUSED4(250)  00041000
         GBLA  &MLOW                                                    00042000
         GBLA  &MHIGH                                                   00043000
         GBLC  &MODNAME                                                 00044000
         GBLC  &ZEROS                                                   00045000
         LCLA  &MSGCTR                                                  00046000
         LCLA  &MSGNUML                                                 00047000
         LCLC  &MSGNAME                                                 00048000
         LCLB  &UNUSED                                                  00049000
.*                                                                      00050000
         ACTR  32000                                                    00051000
.*--------------------------------------------------------------------- 00052000
.*                                                                      00053000
.* This is the beginning of the table of offsets to the messages.  The  00054000
.* message formatting routine will look into this table to find the     00055000
.* the offset from the beginning of the message table to the parts      00056000
.* for that message.                                                    00057000
.*                                                                      00058000
.*--------------------------------------------------------------------- 00059000
         DS    0F                                                       00060000
MSGSOFF  DS    0C                                                       00061000
.*--------------------------------------------------------------------- 00062000
.*                                                                      00063000
.* Reset the use counter, for every message in the list, find all the   00064000
.* unused message numbers up until it                                   00065000
.*                                                                      00066000
.*--------------------------------------------------------------------- 00067000
&USECTR  SETA  1                                                        00068000
&MSGCTR  SETA  &MLOW                                                    00069000
.LOOP    ANOP                                                           00070000
         AIF   (&MSGCTR GT &MHIGH).ENDLOOP                              00071000
         AIF   (&USECTR LE 750).XMEND1                                  00072000
         AIF   (&MSGCTR NE &UNUSED4(&USECTR-750)).UNUSED0               00073000
         AGO   .UNUSED1                                                 00074000
.XMEND1  ANOP                                                           00075000
         AIF   (&USECTR LE 500).XMEND2                                  00076000
         AIF   (&MSGCTR NE &UNUSED3(&USECTR-500)).UNUSED0               00077000
         AGO   .UNUSED1                                                 00078000
.XMEND2  ANOP                                                           00079000
         AIF   (&USECTR LE 250).XMEND3                                  00080000
         AIF   (&MSGCTR NE &UNUSED2(&USECTR-250)).UNUSED0               00081000
         AGO   .UNUSED1                                                 00082000
.XMEND3  ANOP                                                           00083000
         AIF   (&MSGCTR NE &UNUSED1(&USECTR)).UNUSED0                   00084000
.UNUSED1 ANOP                                                           00085000
&UNUSED  SETB  1                                                        00086000
         AGO   .XMEND4                                                  00087000
.UNUSED0 ANOP                                                           00088000
&UNUSED  SETB  0                                                        00089000
.XMEND4  ANOP                                                           00090000
.*                                                                      00091000
.*                                                                      00092000
.* If a message number has not been used, then the offset to the        00093000
.* message is zero, i.e. point to the first message in the list,        00094000
.* which is the default error message.  (This message will not actually 00095000
.* get printed out), but if it is encountered, a feedback code can be   00096000
.* issued by the message formatting routine.                            00097000
.*                                                                      00098000
         AIF   (NOT &UNUSED).XMEND5                                     00099000
.*                                                                      00100000
         DC    F'0'                                                     00101000
.*                                                                      00102000
&USECTR  SETA  &USECTR+1                                                00103000
         AGO  .LOOPCHK                                                  00104000
.*                                                                      00105000
.* If a message number has been used, then the offset to the message    00106000
.* is the address of the message - the address of the beginning of      00107000
.* the table.                                                           00108000
.* Remember:  The message name is Mxxxx where xxxx is the message       00109000
.* number padded on the left with zeros.                                00110000
.*                                                                      00111000
.XMEND5  ANOP                                                           00112000
&MSGNAME SETC  '&MSGCTR'                                                00113000
&MSGNUML SETA  K'&MSGNAME                                               00114000
         AIF   (&MSGNUML GE 4).XMEND6                                   00115000
&MSGNAME SETC  'M'.'&ZEROS'(1,4-&MSGNUML).'&MSGNAME'                    00116000
         AGO   .XMEND7                                                  00117000
.XMEND6  ANOP                                                           00118000
&MSGNAME SETC  'M'.'&MSGNAME'                                           00119000
.XMEND7  ANOP                                                           00120000
.*                                                                      00121000
         DC    AL4(&MSGNAME-MSGSTBL)                                    00122000
.*                                                                      00123000
.LOOPCHK ANOP                                                           00124000
&MSGCTR  SETA  &MSGCTR+1                                                00125000
         AGO   .LOOP                                                    00126000
.ENDLOOP ANOP                                                           00127000
.*--------------------------------------------------------------------- 00128000
.*                                                                      00129000
.* Trailing data at the end of the file, includes MACRO CEEXMGF which   00130000
.* contains the declarations for the CEEM_xxx_TYPE equates.             00131000
.*                                                                      00132000
.*--------------------------------------------------------------------- 00133000
         DS    0A                                                       00134000
MSGSEND  EQU   *                                                        00135000
         DS    0C                                                       00136000
         ORG   MSGSEND                                                  00137000
*                                                                       00138000
CEEM_INS_TYPE       EQU 0                                               00139000
CEEM_TXT_TYPE       EQU 1                                               00140000
CEEM_TAB_TYPE       EQU 2                                               00141000
CEEM_DBC_TYPE       EQU 3                                               00142000
CEEM_NOQ_TYPE       EQU 4                                               00143000
CEEM_TBN_TYPE       EQU 5                                               00144000
CEEM_TBF_TYPE       EQU 6                                               00145000
CEEM_TBT_TYPE       EQU 7                                               00146000
         DS    0D                                                       00147000
@ENDDATA EQU   *                                                        00148000
@MODLEN  EQU   @ENDDATA-&MODNAME                                        00149000
         END   &MODNAME                                                 00150000
.*                                                                      00151000
         MEND                                                           00152000
