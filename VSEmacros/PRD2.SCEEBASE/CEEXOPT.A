*/********************************************************************* 00001000
*                                                                     * 00002000
*       Language Environment/VSE V1 R4 M4                             * 00003000
*                                                                     * 00004000
*    :module                                                          * 00005000
*       CEEXOPT - Macro to generate CEEUOPT and CEEDOPT CSECTs of     * 00006000
*                   run-time options                                  * 00007000
*    :emodule                                                         * 00008000
*                                                                     * 00009000
*    :security                                                        * 00010000
*                                                                     * 00011000
*      Licensed Materials - Property of IBM                           * 00012000
*                                                                     * 00013000
*      5686-066-32-65K  (C) Copyright IBM Corporation 1991, 2003      * 00014000
*      All rights reserved.                                           * 00015000
*                                                                     * 00016000
*                                                                     * 00017000
*       US Government Users Restricted Rights - Use, duplication or   * 00018000
*       disclosure restricted by GSA ADP Schedule Contract with IBM   * 00019000
*       Corp.                                                         * 00020000
*                                                                     * 00021000
*                                                                     * 00022000
*    :esecurity                                                       * 00023000
*                                                                     * 00024000
*    :status                                                          * 00025000
*       LE/VSE Version 1 Release 4 Modification 3                     * 00026000
*    :estatus                                                         * 00027000
*                                                                     * 00028000
*    :function                                                        * 00029000
*       The CEEXOPT macro, when invoked during the assembly of        * 00030000
*       CEEDOPT ASSEMBLE at LE/VSE installation time, generates the   * 00031000
*       Options Control Block structure necessary to establish        * 00032000
*       installation default options.  Each option must be designated * 00033000
*       overridable or non-overridable.  The invocation of CEEXOPT    * 00034000
*       within CEEUOPT ASSEMBLE produces an Options Control Block     * 00035000
*       which may be linked with the user program.  Although options  * 00036000
*       in CEEUOPT's invocation of CEEXOPT may not be designated      * 00037000
*       overridable or non-overridable, they will take precedence     * 00038000
*       over any corresponding overridable CEEDOPT options.           * 00039000
*    :efunction                                                       * 00040000
*                                                                     * 00041000
*    :notes                                                           * 00042000
*       Dependencies - The list of country identifiers, CTRYLST, and  * 00043000
*                      the list of national languages, NATLLST, must  * 00044000
*                      be kept current.  Likewise, CTRYNUM, the       * 00045000
*                      number of countries, and NATLNUM, the number   * 00046000
*                      of national languages, must match the numbers  * 00047000
*                      of entries in their respective lists.  The     * 00048000
*                      declarations of CTRYLST and NATLLST should be  * 00049000
*                      kept properly dimensioned.  See under run-time * 00050000
*                      options COUNTRY and NATLANG in the LE/VSE FPS  * 00051000
*                      for further details.                           * 00052000
*                                                                     * 00053000
*                      RELEASE should be updated for subsequent       * 00054000
*                      releases of LE/VSE.                            * 00055000
*                                                                     * 00056000
*       Restrictions - May only be invoked in CEEUOPT or CEEDOPT.     * 00057000
*                                                                     * 00058000
*                      A restriction on macro instruction operands is * 00059000
*                      that they may not exceed 255 characters in     * 00060000
*                      length.  Thus, for example, it will not be     * 00061000
*                      possible for each suboption of the TEST or     * 00062000
*                      NOTEST option to attain the maximum allowable  * 00063000
*                      length specified in the LE/VSE specifications. * 00064000
*                      (If the number of characters to the right of   * 00065000
*                      the equal sign for any keyword parameter in    * 00066000
*                      the CEEXOPT invocation in CEEUOPT or CEEDOPT   * 00067000
*                      is greater than 255, a return code of 12 will  * 00068000
*                      be produced for the assembly, and none of the  * 00069000
*                      options will have been properly parsed.)       * 00070000
*                                                                     * 00071000
*       Examples of correct parameter passing in CEEDOPT (note that   * 00072000
*       OVR or NONOVR, denoting overridable or non-overridable,       * 00073000
*       respectively, must always be the second sublist item):        * 00074000
*                                                                     * 00075000
*            ALL31=((ON),OVR) or ALL31=(ON,OVR)                       * 00076000
*            HEAP=((64K,64K,ANYWHERE,KEEP),NONOVR)                    * 00077000
*                                                                     * 00078000
*       Examples of correct parameter passing in CEEUOPT:             * 00079000
*                                                                     * 00080000
*            ALL31=(ON) or ALL31=ON                                   * 00081000
*            HEAP=(64K,64K,ANYWHERE,KEEP)                             * 00082000
*    :enotes                                                          * 00083000
*                                                                     * 00084000
*    :regs - Register Conventions                                     * 00085000
*       (none)                                                        * 00086000
*    :eregs                                                           * 00087000
*                                                                     * 00088000
*    :entry                                                           * 00089000
*       (none)                                                        * 00090000
*    :eentry                                                          * 00091000
*                                                                     * 00092000
*    :exit                                                            * 00093000
*       (none)                                                        * 00094000
*    :eexit                                                           * 00095000
*                                                                     * 00096000
*    :retcode                                                         * 00097000
*       Possible return codes for the assembly (produced by MNOTE):   * 00098000
*          0: no errors detected                                      * 00099000
*          4: COUNTRY or NATLANG code was accepted but unknown        * 00100000
*          8: all errors except those listed for 4 or 16              * 00101000
*         16: CEEXOPT was not invoked within CEEUOPT or CEEDOPT       * 00102000
*       Certain errors of macro invocation are captured by the        * 00103000
*       assembler itself, producing other return codes.  See Restric- * 00104000
*       tions (above) for an example.                                 * 00105000
*    :eretcode                                                        * 00106000
*                                                                     * 00107000
*    :external - List of external routines used by this module        * 00108000
*       (none)                                                        * 00109000
*    :eexternal                                                       * 00110000
*                                                                     * 00111000
*    :data - Major data areas, control blocks, tables, etc.           * 00112000
*       (none)                                                        * 00113000
*    :edata                                                           * 00114000
*                                                                     * 00115000
*    :macros                                                          * 00116000
*       Macros defined in this module                                 * 00117000
*         (none)                                                      * 00118000
*       Macros used by this module                                    * 00119000
*          CEEXSIMP - generates DCs for options whose only suboption  * 00120000
*                     is ON|OFF                                       * 00121000
*          CEEXHARD - generates DCs for non-LE/VSE options without    * 00122000
*                     suboptions, hard-coding them on or off          * 00123000
*          CEEXCALC - converts STACK or HEAP (etc.) numeric subop-    * 00124000
*                     tions in the form n|nK|nk|nM|nm to their        * 00125000
*                     numeric character equivalents                   * 00126000
*          CEEXSTCH - converts STORAGE character suboptions in the    * 00127000
*                     form 'A'|"A"|C1|NONE to their DC operand equiv- * 00128000
*                     alents                                          * 00129000
*          CEEXSTRI - calculates effective length of strings option-  * 00130000
*                     ally enclosed in single or double quotes,       * 00131000
*                     ensuring they do not exceed a maximum length    * 00132000
*          CEEXNUMB - determines if a character string consists only  * 00133000
*                     of valid binary, decimal, or hex characters     * 00134000
*          CEEXAPRC - determines ABPERC suboption type, extracting    * 00135000
*                     its numeric value if any and converting it to   * 00136000
*                     a DC operand                                    * 00137000
*    :emacros                                                         * 00138000
*                                                                     * 00139000
*    :include                                                         * 00140000
*       (none)                                                        * 00141000
*    :einclude                                                        * 00142000
*                                                                     * 00143000
*    :messages                                                        * 00144000
*       (none)                                                        * 00145000
*    :emessages                                                       * 00146000
*                                                                     * 00147000
*    :pseudocode                                                      * 00148000
*       (none)                                                        * 00149000
*    :epseudocode                                                     * 00150000
*                                                                     * 00151000
*    :history                                                         * 00152000
*                                                                     * 00153000
*       PQ04876 - New option RETZERO(ON|OFF).                         * 00154000
*       PQ08538 - New option HEAPCHK,                                 * 00155000
*                 New suboption UADUMP of TERMTHDACT                  * 00156000
*       PQ17345 - New option USRHDLR/NOUSRHDLR                        * 00157000
*                                                                     * 00158000
* ******************************************************************* * 00159000
*     LE/VSE Version 1 Release 4 Modification Level 1 Changes :       * 00160000
*                                                                     * 00161000
* $01  GWH - Allow sub-option MAX | MIN on TRAP runtime option.       * 00162000
*                (Equiv. to SPIE/NOSPIE for LE/MVS)                   * 00163000
*          - Set LE/VSE CEEXOPT Release number to 4.                  * 00164000
*                                                                     * 00165000
* $02  GWH - Disallow use of YES,NO,ON,OFF PHASE names for            * 00166000
*            USRHDLR option                                           * 00167000
*                                                                     * 00168000
* ******************************************************************* * 00169000
*     LE/VSE Version 1 Release 4 Modification Level 2 Changes :       * 00170000
*                                                                     * 00171000
* $03=A399.12           20010321  JH: Added LSTQ & reg_stor_amount    * 00172000
*                                     TERMTHDACT suboptions for       * 00173000
*                                     DCRs A399.12 and A399.16        * 00174000
*                                     (CICSDDS) (LE/VSE release 1.4.2)* 00175000
* ******************************************************************* * 00176000
*     LE/VSE Version 1 Release 4 Modification Level 3 Changes :       * 00177000
*                                                                     * 00178000
* $04=A399.05           09 MAY 03 JH: Add   room for call level       * 00179000
*                                     heapchk suboption. Adjust       * 00180000
*                                     release level of this OCB.      * 00181000
* $05=PQ72056           20030319 GWH: Change CEEUOPT so that all      * 00182190
*                                     TERMTHDACT options are          * 00182380
*                                     optional.                   @05A* 00182570
* ******************************************************************* * 00176000
*     LE/VSE Version 1 Release 4 Modification Level 4 Changes :       * 00177000
*                                                                     * 00178000
* $06                   23 MAY 03 JH: If use default ALL31(OFF) option* 00179000
*                                     ,You must use stack below.      * 00180000
*                                     This is diagnosed by MNOTE(0)   * 00180000
*                                     only because we didn't want to  * 00180000
*                                     change previous warning levels. * 00180000
*                                     The Info message is also          00180000
*                                     restricted to CEEUOPT.            00180000
*                                     (Design by GH)                  * 00180000
*                                                                     * 00182760
*    :ehistory                                                        * 00183000
*                                                                     * 00184000
*    :epls                                                            * 00185000
**********************************************************************/ 00186000
         MACRO                                                          00187000
         CEEXOPT &ABPERC=,                                             X00188000
               &ABTERMENC=,                                            X00189000
               &AIXBLD=,                                               X00190000
               &ALL31=,                                                X00191000
               &ANYHEAP=,                                              X00192000
               &BELOWHEAP=,                                            X00193000
               &CBLOPTS=,                                              X00194000
               &CBLPSHPOP=,                                            X00195000
               &CHECK=,                                                X00196000
               &COUNTRY=,                                              X00197000
               &DEBUG=,                                                X00198000
               &DEPTHCONDLMT=,                                         X00199000
               &ENVAR=,                                                X00200000
               &ERRCOUNT=,                                             X00201000
               &HEAP=,                                                 X00202000
               &HEAPCHK=,                                              X00203000
               &LIBSTACK=,                                             X00204000
               &MSGFILE=,                                              X00205000
               &MSGQ=,                                                 X00206000
               &NATLANG=,                                              X00207000
               &NOTEST=,                                               X00208000
               &NOUSRHDLR=,                                            X00209000
               &RETZERO=,                                              X00210000
               &RPTOPTS=,                                              X00211000
               &RPTSTG=,                                               X00212000
               &RTEREUS=,                                              X00213000
               &STACK=,                                                X00214000
               &STORAGE=,                                              X00215000
               &TERMTHDACT=,                                           X00216000
               &TEST=,                                                 X00217000
               &TRACE=,                                                X00218000
               &TRAP=,                                                 X00219000
               &UPSI=,                                                 X00220000
               &USRHDLR=,                                              X00221000
               &XUFLOW=                                                 00222000
.********************************************************************** 00223000
.*   SET symbols                                                      * 00224000
.********************************************************************** 00225000
         GBLA  &ABTYPE                 ABPERC suboption type            00226000
         LCLA  &ANYWHR                 Location ANYWHERE (  0 = X'00')  00227000
         LCLA  &BELOW                  Location BELOW    (128 = X'80')  00228000
         GBLA  &BIT1                   Value of 1st bit of 8 (128)      00229000
         GBLA  &BIT2                   Value of 2nd bit of 8 ( 64)      00230000
         GBLA  &BIT3                   Value of 3rd bit of 8 ( 32)      00231000
         GBLA  &BIT4                   Value of 4th bit of 8 ( 16)      00232000
         GBLA  &BIT5                   Value of 5th bit of 8 (  8)      00233000
         LCLA  &BIT6                   Value of 6th bit of 8 (  4)      00234000
         LCLA  &BIT7                   Value of 7th bit of 8 (  2)      00235000
         LCLA  &BIT8                   Value of 8th bit of 8 (  1)      00236000
         LCLA  &CTRYIND                Index for searching CTRYLST      00237000
         LCLA  &CTRYNUM                Number of countries in CTRYLST   00238000
         LCLA  &FLAG                   Options bit flag (additive)      00239000
         LCLA  &FREE                   Disposition FREE (64 = X'40')    00240000
         LCLA  &KEEP                   Disposition KEEP ( 0 = X'00')    00241000
         LCLA  &LOCDISP                Location + disposition flag      00242000
         LCLA  &MSGMAX                 Max val for MSGFILE lrecl, blk   00243000
         LCLA  &MSGVAL                 Value for MSGFILE lrecl, blk     00244000
         LCLA  &NATLIND                Index for searching NATLLST      00245000
         LCLA  &NATLNUM                Number of languages in NATLLST   00246000
         GBLA  &NONOVR                 Non-overridable bit (64 = X'40') 00247000
         GBLA  &OFF                    Option off (0 = X'00')           00248000
         GBLA  &ON                     Option on bit (128 = X'80')      00249000
         LCLA  &RFMIND                 Index for searching RFMLST       00250000
         LCLA  &RFMNUM                 Number of recfms in RFMLST       00251000
         GBLA  &SETBITS                STORAGE char set bits (additive) 00252000
         GBLA  &STRLEN                 Effective length from CEEXSTRI   00253000
         LCLA  &TEMPVAL                Temporary numeric value          00254000
         LCLA  &VALBITS                Suboptions valid bits (additive) 00255000
         GBLA  &VALID                  Option valid bit (1 = X'01')     00256000
.*   Rounded values                                                   * 00257000
         LCLA  &AHTR4                  ANYHEAP init size 4K             00258000
         LCLA  &AHTR8                  ANYHEAP init size 8 bytes        00259000
         LCLA  &AHRR4                  ANYHEAP incr size 4K             00260000
         LCLA  &AHRR8                  ANYHEAP incr size 8 bytes        00261000
         LCLA  &BHTR4                  BELOWHEAP init size 4K           00262000
         LCLA  &BHTR8                  BELOWHEAP init size 8 bytes      00263000
         LCLA  &BHRR4                  BELOWHEAP incr size 4K           00264000
         LCLA  &BHRR8                  BELOWHEAP incr size 8 bytes      00265000
         LCLA  &HPTR4                  HEAP init size 4K                00266000
         LCLA  &HPTR8                  HEAP init size 8 bytes           00267000
         LCLA  &HPRR4                  HEAP incr size 4K                00268000
         LCLA  &HPRR8                  HEAP incr size 8 bytes           00269000
         LCLA  &HT24R4                 HEAP init24 size 4K              00270000
         LCLA  &HT24R8                 HEAP init24 size 8 bytes         00271000
         LCLA  &HR24R4                 HEAP incr24 size 4K              00272000
         LCLA  &HR24R8                 HEAP incr24 size 8 bytes         00273000
         LCLA  &LSTR4                  LIBSTACK init size 4K            00274000
         LCLA  &LSTR8                  LIBSTACK init size 8 bytes       00275000
         LCLA  &LSRR4                  LIBSTACK incr size 4K            00276000
         LCLA  &LSRR8                  LIBSTACK incr size 8 bytes       00277000
         LCLA  &NSTR4                  NONIPTSTACK init size 4K         00278000
         LCLA  &NSTR8                  NONIPTSTACK init size 8 bytes    00279000
         LCLA  &NSRR4                  NONIPTSTACK incr size 4K         00280000
         LCLA  &NSRR8                  NONIPTSTACK incr size 8 bytes    00281000
         LCLA  &SKTR4                  STACK init size 4K               00282000
         LCLA  &SKTR8                  STACK init size 8 bytes          00283000
         LCLA  &SKRR4                  STACK incr size 4K               00284000
         LCLA  &SKRR8                  STACK incr size 8 bytes          00285000
         LCLA  &SRR4                   STORAGE reserve 4K               00286000
         LCLA  &SRR8                   STORAGE reserve 8 bytes          00287000
         LCLA  &THTR4                  THREADHEAP init size 4K          00288000
         LCLA  &THTR8                  THREADHEAP init size 8 bytes     00289000
         LCLA  &THRR4                  THREADHEAP incr size 4K          00290000
         LCLA  &THRR8                  THREADHEAP incr size 8 bytes     00291000
.*                                                                      00292000
         LCLB  &ALLOK                  1 = no suboption errors found    00293000
         GBLB  &APRCOK                 1 = no CEEXAPRC errors found     00294000
         GBLB  &CALCOK                 1 = no CEEXCALC errors found     00295000
         GBLB  &DOPT                   0 = in CEEUOPT, 1 = in CEEDOPT   00296000
         GBLB  &NUMBOK                 1 = no CEEXNUMB errors found     00297000
         GBLB  &STCHOK                 1 = no CEEXSTCH errors found     00298000
         GBLB  &STRIOK                 1 = no CEEXSTRI errors found     00299000
.*                                                                      00300000
         LCLC  &ABCODE                 ABPERC abcode                    00301000
         LCLC  &ABEND                  ABTERMENC exitmode (ABEND = '2') 00302000
         LCLC  &ABTMODE                ABTERMENC exitmode               00303000
         GBLC  &ABNUM                  ABPERC numeric portion of abcode 00304000
         LCLC  &ALL                    TEST level (ALL = '4')           00305000
         LCLC  &AUTOXUF                XUFLOW level (AUTO = '1')        00306000
         LCLC  &BLKSIZE                MSGFILE block size               00307000
         LCLC  &CFILEN                 TEST/NOTEST comm file name len   00308000
         LCLC  &CLSLEN                 TEST/NOTEST comm list name len   00309000
         LCLC  &COMFILE                TEST/NOTEST command file name    00310000
         LCLC  &COMLIST                TEST/NOTEST command list name    00311000
         LCLC  &CTNAME                 COUNTRY identifier               00312000
         LCLC  &CTRYLST(159)           COUNTRY list of countries        00313000
         LCLC  &DDLEN                  MSGFILE length of DDname         00314000
         LCLC  &DDNAME                 MSGFILE DDname                   00315000
         LCLC  &DEPLMT                 DEPTHCONDLMT limit               00316000
         LCLC  &DSALLC                 STORAGE DSA allocation char      00317000
         LCLC  &DUMP                   TERMTHDACT level (DUMP = '1')    00318000
         LCLA  &ENVNUM                 ENVAR # sublist item             00319000
         LCLC  &ENVSTR(1)              Array of ENVAR string            00320000
         LCLA  &ESLEN                  ENVAR string length              00321000
         LCLC  &ERRNUM                 ERRCOUNT number                  00322000
         LCLC  &ERRUNUM                ERRUNIT number                   00323000
         LCLC  &ERROR                  TEST level (ERROR = '2')         00324000
         LCLC  &HPALLC                 STORAGE heap allocation char     00325000
         LCLC  &HPFREE                 STORAGE heap free char           00326000
         LCLC  &INCRSIZ                Increment size (STACK, etc.)     00327000
         LCLC  &INCR24                 HEAP below-line increment size   00328000
         LCLC  &INITSIZ                Initial size (STACK, etc.)       00329000
         LCLC  &INIT24                 HEAP below-line initial size     00330000
         LCLC  &LMODLEN                AUTOTASK load mod length         00331000
         LCLC  &LOADMOD                AUTOTASK load mod name           00332000
         LCLC  &LRECL                  MSGFILE logical record length    00333000
         LCLC  &MSG                    TERMTHDACT level (MSG = '4')     00334000
         LCLC  &MSGQNUM                MSGQ maximum number of entries   00335000
         LCLC  &NATLLST(45)            NATLANG list of languages        00336000
         LCLC  &NLNAME                 NATLANG language identifier      00337000
         LCLC  &NONE                   TEST level (NONE = '1')          00338000
         LCLC  &NONIPTOPTN             NONIPTSTACK option name          00339000
         LCLC  &NONIPTSOPTS(4)         (NO)NONIPTSTACK sub-options      00340000
         LCLC  &NONIPTSTACKOVR         OVR/NONOVR state                 00341000
         LCLC  &OFFREC                 RECPAD level (OFF = '4')         00342000
         LCLC  &OFFXUF                 XUFLOW level (OFF = '4')         00343000
         LCLC  &ONREC                  RECPAD level (ON = '2')          00344000
         LCLC  &ONXUF                  XUFLOW level (ON = '2')          00345000
         LCLC  &PARM1                  Copy of 1st suboption            00346000
         LCLC  &PARM2                  Copy of 2nd suboption            00347000
         LCLC  &PARM3                  Copy of 3rd suboption            00348000
         LCLC  &PARM4                  Copy of 4th suboption            00349000
         LCLC  &PARMOVR                Copy of OVR|NONOVR suboption     00350000
         LCLC  &PFILEN                 TEST/NOTEST pref file name len   00351000
         LCLC  &PREFILE                TEST/NOTEST pref file name       00352000
         LCLC  &PRTNUM                 PRTUNIT number                   00353000
         LCLC  &PUNNUM                 PUNUNIT number                   00354000
         LCLC  &RDRNUM                 RDRUNIT number                   00355000
         LCLC  &RECFM                  MSGFILE recfm                    00356000
         LCLC  &RFMLEN                 MSGFILE length of recfm          00357000
         LCLC  &RFMLST(12)             MSGFILE list of recfm            00358000
         LCLC  &QUIET                  TERMTHDACT level (QUIET = '8')   00359000
         LCLC  &RECLEVL                RECPAD level                     00360000
         LCLC  &RELEASE                Current version release number   00361000
         LCLC  &RETCODE                ABTERMENC exitmode (RETCODE='1') 00362000
         LCLC  &RSRVSIZ                STORAGE short reserve amount     00363000
         GBLC  &STORVAL                STORAGE character from CEEXSTCH  00364000
         GBLC  &STRING                 String returned from CEEXSTRI    00365000
         LCLC  &TASKNUM                AUTOTASK task number             00366000
         LCLC  &TEMPSTR                Temporary character string       00367000
         LCLC  &TERLEVL                TERMTHDACT information level     00368000
         LCLC  &TERTRACE               TERMTHDACT level (TRACE = '2')   00369000
         LCLC  &CICSDEST               TERMTHDACT second suboption@03A  00370000
         LCLC  &LSTQ        TERMTHDACT CICSDEST=LSTQ('64')  @03A        00371000
         LCLC  &MSGFL           TERMTHDACT CICSDEST=MSGFL('128')   @03A 00372000
         LCLA  &REGSTOR                TERMTHDACT third suboption @03A  00373000
         LCLC  &TSTLEVL                TEST/NOTEST test-level           00374000
         LCLC  &TSTOPT                 Indicates TEST vs. NOTEST option 00375000
         LCLC  &UADUMP                 TERMTHDACT level (UADUMP = '16') 00376000
         LCLC  &UPSISW                 UPSI switch values               00377000
         LCLC  &UHLEN                  USRHDLR routine length           00378000
         LCLC  &UHNAME                 USRHDLR routine name             00379000
         LCLC  &UHOPT                  USRHDLR vs. NOUSRHDLR option     00380000
         GBLC  &VALUE                  Numeric value from CEEXCALC      00381000
         LCLC  &VARREC                 RECPAD level (VAR = '1')         00382000
         GBLC  &WHSET                  Where set indicator              00383000
         GBLC  &WHSETDS                Where set (default setting)      00384000
         LCLC  &XUFLEVL                XUFLOW interrupt level           00385000
         LCLC  &CALLLVL                Call Level for HEAPCHK      @04A 00386000
.********************************************************************** 00387000
.*   Verify that invocation was in CEEUOPT or CEEDOPT, else exit.     * 00388000
.*   Make sure no positional parameters were passed.                  * 00389000
.*   Set arithmetic flags to proper values.                           * 00390000
.********************************************************************** 00391000
         AIF   ('&SYSECT' EQ 'CEEUOPT').AUOPT                           00392000
         AIF   ('&SYSECT' EQ 'CEEDOPT').ADOPT                           00393000
         MNOTE 16,'Aborting: invoke from CEEUOPT or CEEDOPT only.'      00394000
         MEXIT                                                          00395000
.*                                                                      00396000
.AUOPT   ANOP                          Indicate in CEEUOPT              00397000
&DOPT    SETB  0                                                        00398000
&WHSET   SETC  '200'                                                    00399000
         AGO   .APARM                                                   00400000
.*                                                                      00401000
.ADOPT   ANOP                          Indicate in CEEDOPT              00402000
&DOPT    SETB  1                                                        00403000
&WHSET   SETC  '100'                                                    00404000
.*                                                                      00405000
.APARM   ANOP                          Check for positional parms       00406000
         AIF   (N'&SYSLIST EQ 0).ASET                                   00407000
         MNOTE 8,'Positional parameter(s) disregarded.'                 00408000
.*                                                                      00409000
.ASET    ANOP                          Set various bit values           00410000
&ANYWHR  SETA  0                         0 = X'00'                      00411000
&BELOW   SETA  128                     128 = X'80'                      00412000
&BIT1    SETA  128                     128 = X'80'                      00413000
&BIT2    SETA  64                       64 = X'40'                      00414000
&BIT3    SETA  32                       32 = X'20'                      00415000
&BIT4    SETA  16                       16 = X'10'                      00416000
&BIT5    SETA  8                         8 = X'08'                      00417000
&BIT6    SETA  4                         4 = X'04'                      00418000
&BIT7    SETA  2                         2 = X'02'                      00419000
&BIT8    SETA  1                         1 = X'01'                      00420000
&FREE    SETA  64                       64 = X'40'                      00421000
&KEEP    SETA  0                         0 = X'00'                      00422000
&NONOVR  SETA  64                      Non-overridable bit (X'40)       00423000
&OFF     SETA  0                       Option off      bit (X'00')      00424000
&ON      SETA  128                     Option on       bit (X'80')      00425000
&VALID   SETA  1                       Option valid    bit (X'01')      00426000
.*                                                                      00427000
&ABEND   SETC  '2'                     ABTERMENC exit mode ABEND        00428000
&ALL     SETC  '4'                     TEST/NOTEST test level ALL       00429000
&AUTOXUF SETC  '1'                     XUFLOW interrupt level AUTO      00430000
&DUMP    SETC  '1'                     TERMTHDACT info level DUMP       00431000
&ERROR   SETC  '2'                     TEST/NOTEST test level ERROR     00432000
&MSG     SETC  '4'                     TERMTHDACT info level MSG        00433000
&NONE    SETC  '1'                     TEST/NOTEST test level NONE      00434000
&OFFREC  SETC  '4'                     RECPAD level OFF                 00435000
&OFFXUF  SETC  '4'                     XUFLOW interrupt level OFF       00436000
&ONREC   SETC  '2'                     RECPAD level ON                  00437000
&ONXUF   SETC  '2'                     XUFLOW interrupt level ON        00438000
&QUIET   SETC  '8'                     TERMTHDACT info level QUIET      00439000
&RELEASE SETC  '6'                   Level of this OCB  @01C  @03C @04C 00440000
&RETCODE SETC  '1'                     ABTERMENC exit mode RETCODE      00441000
&TERTRACE SETC  '2'                    TERMTHDACT info level TRACE      00442000
&UADUMP   SETC  '16'                   TERMTHDACT info level UADUMP     00443000
&VARREC  SETC  '1'                     RECPAD level OFF                 00444000
&MSGFL    SETC  '128'                  CICSDEST = MSGFL            @03A 00445000
&LSTQ SETC  '64'                   CICSDEST = LSTQ          @03A        00446000
&WHSETDS SETC  '50'                    Where set (default setting)      00447000
.********************************************************************** 00448000
.*   Initialize count and list of countries (COUNTRY option).         * 00449000
.*   Initialize count and list of national languages (NATLANG         * 00450000
.*   option).                                                         * 00451000
.********************************************************************** 00452000
&CTRYNUM SETA  159                     Count of countries in CTRYLST    00453000
&CTRYLST(1) SETC                                                       X00454000
               'AD','AE','AG','AL','AN','AO','AR','AT','AU','BB',      X00455000
               'BD','BE','BG','BH','BI','BJ','BM','BN','BO','BR',      X00456000
               'BS','BU','BW','CA','CF','CG','CH','CI','CL','CM',      X00457000
               'CN','CO','CR','CS','CY','DE','DK','DO','DZ',           X00458000
               'EC','EG','ES','ET','FI','FR','GA','GB','GH','GM',      X00459000
               'GN','GR','GT','GY','HK','HN','HU','ID','IE','IL',      X00460000
               'IN','IQ','IR','IS','IT','JM','JO','JP','KE','KR',      X00461000
               'KY','KW','LB','LC','LI','LK','LR','LS','LU','LY',      X00462000
               'MA','MC','MG','ML','MO','MR','MT','MU','MW','MX',      X00463000
               'MY','NA','NC','NE','NG','NI','NL','NO','NZ','OM',      X00464000
               'PA','PE','PH','PK','PL','PT','PY','QA','RO','SA',      X00465000
               'SC','SG','SD','SE','SL','SN','SR','SU','SY','SV',      X00466000
               'SZ','TD','TG','TH','TN','TR','TT','TW','TZ','US',      X00467000
               'UY','VE','VU','YE','YU','ZA','ZM','ZR','ZW','AF',      X00468000
               'CU','HT','PG','SO','WS','BF','GW','MZ','PR','UG',      X00469000
               'BA','CZ','EE','HR','LT','LV','MK','RU','SI','SK'        00470000
&NATLNUM SETA  45                      Count of languages in NATLLST    00471000
&NATLLST(1) SETC                                                       X00472000
               'AFR','ARA','BGR','CAT','CHT','CHS','CSY','DAN',        X00473000
               'DEU','DES','ELL','ENG','ENU','ESP','FIN','FRA',        X00474000
               'FRB','FRC','FRS','HEB','HUN','ISL','ITA','ITS',        X00475000
               'JPN','KOR','NLD','NLB','NOR','NON','PLK','PTG',        X00476000
               'PTB','RMS','ROM','RUS','SHC','SHL','SKY','SQI',        X00477000
               'SVE','THA','TRK','UEN','URD'                            00478000
.********************************************************************** 00479000
.*   Initialize count and list of valid record formats (MSGFILE       * 00480000
.*   option).                                                         * 00481000
.********************************************************************** 00482000
&RFMNUM  SETA  12                      Count of recfm in RFMLST         00483000
&RFMLST(1)  SETC                                                       X00484000
               'F','FA','FB','FBA','FBS','FBSA','U','UA','V','VA',     X00485000
               'VB','VBA'                                               00486000
.********************************************************************** 00487000
.*   Header: eyecatcher and internal pointer fields                   * 00488000
.*   Version release and module length                                * 00489000
.********************************************************************** 00490000
*                                                                       00491000
         DC    CL8'CEEOCB  '           Eyecatcher                       00492000
         DC    H'&RELEASE'             Version release of LE/VSE        00493000
         DC    AL2(LENGTH)             Length of options block          00494000
         DC    A(EXP_VEC-&SYSECT)      Expansion vector pointer         00495000
         DC    A(0)                    Reserved for future use          00496000
*                                                                       00497000
.********************************************************************** 00498000
.*   OPTIONS PROCESSING                                               * 00499000
.*                                                                    * 00500000
.*   The rightmost bit of each 8-bit options bit flag is the valid    * 00501000
.*   bit.  In CEEDOPT it is on for all options, in CEEUOPT only for   * 00502000
.*   those options actually specified in the macro instruction.  For  * 00503000
.*   non-LE/VSE options having no CEEXOPT parameters, the &DOPT flag  * 00504000
.*   therefore provides the value of the valid bit, and all such      * 00505000
.*   options are overridable.                                         * 00506000
.*                                                                    * 00507000
.*   Each block of suboptions is preceded by a fullword of valid      * 00508000
.*   bits: the high-order valid bit indicates whether the first       * 00509000
.*   suboption is valid, etc.  In CEEDOPT the valid bits are on for   * 00510000
.*   all existing suboptions.  In CEEUOPT the valid bits are on only  * 00511000
.*   for those suboptions actually specified in the macro instruc-    * 00512000
.*   ion.  For non-LE/VSE options having no CEEXOPT parameters, the   * 00513000
.*   &DOPT flag therefore provides the value of the valid bit for     * 00514000
.*   each existing suboption.                                         * 00515000
.*                                                                    * 00516000
.*   Macro CEEXHARD generates DCs for non-LE/VSE options having no    * 00517000
.*   suboptions.  It takes positional parameter &ON or &OFF to set    * 00518000
.*   the option on or off, respectively.                              * 00519000
.*                                                                    * 00520000
.*   Macro CEEXSIMP generates DCs for options whose only suboption is * 00521000
.*   ON|OFF.  It takes two positional parameters: the first is the    * 00522000
.*   option name; the second is the value of the option as passed to  * 00523000
.*   CEEXOPT from CEEUOPT or CEEDOPT.                                 * 00524000
.*                                                                    * 00525000
.*   Macro CEEXCALC is invoked for the numeric suboptions of STACK,   * 00526000
.*   HEAP, etc., to convert them to a value that may be used in a DC  * 00527000
.*   F instruction.  It also returns a flag &CALCOK that captures     * 00528000
.*   some of the suboption errors that may occur.  Since &CALCOK is   * 00529000
.*   used to set the valid and non-overridable option bits, this may  * 00530000
.*   mean that an option with erroneous suboptions is nonetheless     * 00531000
.*   marked valid and non-overridable.  In all such instances,        * 00532000
.*   however, the assembly produces a non-zero return code and a      * 00533000
.*   clear diagnostic message under the corresponding option in the   * 00534000
.*   listing.                                                         * 00535000
.*                                                                    * 00536000
.*   Macro CEEXSTCH is invoked for the character suboptions of the    * 00537000
.*   STORAGE option to convert them to a value that may be used as    * 00538000
.*   the operand of a DC instruction.  It also ORs the proper bit     * 00539000
.*   value into the global arithmetic variable &SETBITS to keep track * 00540000
.*   of which STORAGE character suboptions have been specified.  A    * 00541000
.*   flag &STCHOK captures all suboption errors that may occur,       * 00542000
.*   except for the specification of a suboption which is not validly * 00543000
.*   hex.  Since &STCHOK is used to set the valid and non-overridable * 00544000
.*   option bits, this may mean that STORAGE may be marked valid and  * 00545000
.*   non-overridable despite the existence of an invalidly hex sub-   * 00546000
.*   option.  Any such error is caught by the assembler, however,     * 00547000
.*   producing a non-zero return code for the assembly and a clear    * 00548000
.*   diagnostic message under the corresponding entry in the listing. * 00549000
.*                                                                    * 00550000
.*   Macro CEEXSTRI computes the effective length of a string, and    * 00551000
.*   ensures that it does not exceed a specified length (determined   * 00552000
.*   after stripping single or double quotes in which it may option-  * 00553000
.*   ally be enclosed).  Contiguous ampersands or single quotes are   * 00554000
.*   counted as only one character since '&&' or '''' as the operand  * 00555000
.*   of a DC instruction would generate only one character.  Any      * 00556000
.*   string exceeding the designated maximum effective length is      * 00557000
.*   truncated to that maximum.  Excessive length or mismatched       * 00558000
.*   quotes are reflected in the value of the global flag &STRIOK.    * 00559000
.*                                                                    * 00560000
.*   Macro CEEXNUMB examines a character string to determine if it    * 00561000
.*   consists solely of characters that are either validly binary,    * 00562000
.*   decimal, or hexadecimal, returning the result of its examination * 00563000
.*   in the global flag &NUMBOK.                                      * 00564000
.*                                                                    * 00565000
.*   Macro CEEXAPRC is invoked for the information level suboption of * 00566000
.*   ABPERC, returning its type in the global arithmetic variable     * 00567000
.*   &ABTYPE, and its extracted numeric value, if any, as a DC        * 00568000
.*   instruction operand in the global character variable &ABNUM.     * 00569000
.*   The global flag &APRCOK captures any error found.                * 00570000
.********************************************************************** 00571000
*    Reserved option                                                    00572000
.********************************************************************** 00573000
         CEEXHARD &ON                                                   00574000
.********************************************************************** 00575000
*    AIXBLD option                                                      00576000
.********************************************************************** 00577000
         CEEXSIMP AIXBLD,&AIXBLD                                        00578000
.********************************************************************** 00579000
*    ALL31 option                                                       00580000
.********************************************************************** 00581000
         CEEXSIMP ALL31,&ALL31                                          00582000
.********************************************************************** 00583000
*    BELOWHEAP option                                                   00584000
.*                                                                    * 00585000
.*   BELOWHEAP has only 3 suboption valid bits since only initial     * 00586000
.*   size, increment size, and disposition may be specified.  The     * 00587000
.*   location-disposition bit flags, however, have the same layout as * 00588000
.*   those in HEAP, but with the location bit in all cases hard-coded * 00589000
.*   on to signify BELOW.                                             * 00590000
.********************************************************************** 00591000
&FLAG    SETA  &ON                     Options flag initialized         00592000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3)                                 00593000
&INITSIZ SETC  '32768'                 Default initial size 32K         00594000
&INCRSIZ SETC  '16384'                 Default increment size 16K       00595000
&LOCDISP SETA  &BELOW+&FREE            Default location, disposition    00596000
&BHTR4   SETA  &INITSIZ                Init rounded value 4K            00597000
&BHTR8   SETA  &INITSIZ                Init rounded value 8 byte        00598000
&BHRR4   SETA  &INCRSIZ                Incr rounded value 4K            00599000
&BHRR8   SETA  &INCRSIZ                Incr rounded value 8 byte        00600000
&ALLOK   SETB  1                       Suboptions assumed error-free    00601000
         AIF   (&DOPT).BHPD            Go to CEEDOPT processing         00602000
.*                                     CEEUOPT processing               00603000
         AIF   (N'&BELOWHEAP EQ 0).BHPGEN Go set defaults, mark invalid 00604000
         AIF   ('&BELOWHEAP' EQ '()').BHPGEN                            00605000
         AIF   (N'&BELOWHEAP LE 3).BHPU1                                00606000
         MNOTE 8,'Too many suboptions -- BELOWHEAP marked invalid.'     00607000
         AGO   .BHPGEN                                                  00608000
.*                                                                      00609000
.BHPU1   ANOP                          Initial size processing          00610000
         AIF   ('&BELOWHEAP(1)' EQ '').BHPU4 If null, work on incr size 00611000
&TEMPSTR SETC  '&BELOWHEAP(1)'         Obtain initial size suboption    00612000
         AIF   ('&TEMPSTR'(1,1) NE '-').BHPU2                           00613000
         MNOTE 8,'BELOWHEAP initial size may not have a minus sign:'    00614000
         MNOTE 8,'it has been set to &INITSIZ and marked invalid.'      00615000
&ALLOK   SETB  0                       Indicate option invalid          00616000
         AGO   .BHPU4                  Go to increment size processing  00617000
.*                                                                      00618000
.BHPU2   ANOP                                                           00619000
         CEEXCALC &BELOWHEAP(1)        Obtain &VALUE and &CALCOK        00620000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            00621000
         AIF   (&CALCOK).BHPU3         If CEEXCALC OK, suboption valid  00622000
&ALLOK   SETB  0                       Indicate option invalid          00623000
         AGO   .BHPU4                  Go to incr size processing       00624000
.*                                                                      00625000
.BHPU3   ANOP                          Set 1st suboption valid bit on   00626000
&VALBITS SETA  &VALBITS+&BIT1                                           00627000
&BHTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             00628000
&BHTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             00629000
.*                                                                      00630000
.BHPU4   ANOP                          Increment size processing        00631000
         AIF   ('&BELOWHEAP(2)' EQ '').BHPU7 If null, work on location  00632000
&TEMPSTR SETC  '&BELOWHEAP(2)'         Obtain increment size suboption  00633000
         AIF   ('&TEMPSTR'(1,1) NE '-').BHPU5                           00634000
         MNOTE 8,'BELOWHEAP increment size may not have a minus sign:'  00635000
         MNOTE 8,'it has been set to &INCRSIZ and marked invalid.'      00636000
&ALLOK   SETB  0                       Indicate option invalid          00637000
         AGO   .BHPU7                  Go to location processing        00638000
.*                                                                      00639000
.BHPU5   ANOP                                                           00640000
         CEEXCALC &BELOWHEAP(2)        Obtain &VALUE and &CALCOK        00641000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            00642000
         AIF   (&CALCOK).BHPU6         If CEEXCALC OK, suboption valid  00643000
&ALLOK   SETB  0                       Indicate option invalid          00644000
         AGO   .BHPU7                  Go to location processing        00645000
.*                                                                      00646000
.BHPU6   ANOP                                                           00647000
&VALBITS SETA  &VALBITS+&BIT2          Set 2nd suboption valid bit on   00648000
&BHRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             00649000
&BHRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             00650000
.*                                                                      00651000
.BHPU7   ANOP                          Location processing              00652000
&LOCDISP SETA  &BELOW                  Location forced BELOW            00653000
.*                                                                      00654000
.*                                     Disposition processing           00655000
         AIF   ('&BELOWHEAP(3)' NE 'KEEP').BHPU8                        00656000
&LOCDISP SETA  &LOCDISP+&KEEP          Indicate disposition is KEEP     00657000
         AGO   .BHPU9                  Go mark suboption valid          00658000
.*                                                                      00659000
.BHPU8   ANOP                          Set disposition to default FREE  00660000
&LOCDISP SETA  &LOCDISP+&FREE                                           00661000
         AIF   ('&BELOWHEAP(3)' EQ 'FREE').BHPU9                        00662000
         AIF   ('&BELOWHEAP(3)' EQ '').BHPU10                           00663000
         MNOTE 8,'BELOWHEAP disposition unrecognized:'                  00664000
         MNOTE 8,'it has been set to FREE and marked invalid.'          00665000
&ALLOK   SETB  0                       Indicate option invalid          00666000
         AGO   .BHPU10                 Go examine BELOWHEAP validity    00667000
.*                                                                      00668000
.BHPU9   ANOP                          Set 3rd suboption valid bit on   00669000
&VALBITS SETA  &VALBITS+&BIT3                                           00670000
.*                                                                      00671000
.BHPU10  ANOP                          Determine if BELOWHEAP valid     00672000
         AIF   (NOT &ALLOK).BHPU11     If suboption error, need msg     00673000
         AIF   (&VALBITS EQ &OFF).BHPGEN If off, all suboptions null    00674000
&FLAG    SETA  &FLAG+&VALID            No errors, not all subopts null  00675000
         AGO   .BHPGEN                                                  00676000
.*                                                                      00677000
.BHPU11  ANOP                                                           00678000
         MNOTE 8,'BELOWHEAP marked invalid due to above error(s).'      00679000
         AGO   .BHPGEN                                                  00680000
.*                                                                      00681000
.BHPD    ANOP                          CEEDOPT processing               00682000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          00683000
&VALBITS SETA  &BIT1+&BIT2+&BIT3       Suboption valid bits set on      00684000
         AIF   (N'&BELOWHEAP EQ 2).BHPD1                                00685000
         MNOTE 8,'BELOWHEAP requires 2 sublist items: it has been set'  00686000
         MNOTE 8,'to defaults, and marked overridable and valid.'       00687000
         AGO   .BHPGEN                                                  00688000
.*                                                                      00689000
.BHPD1   ANOP                          Check # 1st sublist items        00690000
         AIF   (N'&BELOWHEAP(1) EQ 3).BHPD2                             00691000
         MNOTE 8,'BELOWHEAP(1) requires 3 suboptions: it has been set'  00692000
         MNOTE 8,'to defaults, and marked overridable and valid.'       00693000
         AGO   .BHPGEN                                                  00694000
.*                                                                      00695000
.BHPD2   ANOP                          Initial size processing          00696000
         AIF   ('&BELOWHEAP(1,1)' NE '').BHPD3                          00697000
         MNOTE 8,'BELOWHEAP must specify an initial size:'              00698000
         MNOTE 8,'it has been set to &INITSIZ..'                        00699000
&ALLOK   SETB  0                       Indicate error detected          00700000
         AGO   .BHPD5                  Go to increment size processing  00701000
.*                                                                      00702000
.BHPD3   ANOP                          Disallow leading minus sign      00703000
&TEMPSTR SETC  '&BELOWHEAP(1,1)'       Obtain initial size suboption    00704000
         AIF   ('&TEMPSTR'(1,1) NE '-').BHPD4                           00705000
         MNOTE 8,'BELOWHEAP initial size may not begin with'            00706000
         MNOTE 8,'a minus sign.  It has been set to &INITSIZ..'         00707000
&ALLOK   SETB  0                       Indicate error detected          00708000
         AGO   .BHPD5                  Go to increment size processing  00709000
.*                                                                      00710000
.BHPD4   ANOP                                                           00711000
         CEEXCALC &BELOWHEAP(1,1)      Obtain &VALUE and &CALCOK        00712000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            00713000
         AIF   (&CALCOK).BHPD4M                                         00714000
&ALLOK   SETB  0                       Indicate error detected          00715000
         AGO   .BHPD5                                                   00716000
.BHPD4M  ANOP                                                           00717000
&BHTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             00718000
&BHTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             00719000
.*                                                                      00720000
.BHPD5   ANOP                          Increment size processing        00721000
         AIF   ('&BELOWHEAP(1,2)' NE '').BHPD6                          00722000
         MNOTE 8,'BELOWHEAP must specify an increment size:'            00723000
         MNOTE 8,'it has been set to &INCRSIZ..'                        00724000
&ALLOK   SETB  0                       Indicate error detected          00725000
         AGO   .BHPD8                  Go to location processing        00726000
.*                                                                      00727000
.BHPD6   ANOP                          Disallow leading minus sign      00728000
&TEMPSTR SETC  '&BELOWHEAP(1,2)'       Obtain increment size suboption  00729000
         AIF   ('&TEMPSTR'(1,1) NE '-').BHPD7                           00730000
         MNOTE 8,'BELOWHEAP increment size may not begin with'          00731000
         MNOTE 8,'a minus sign.  It has been set to &INCRSIZ..'         00732000
&ALLOK   SETB  0                       Indicate error detected          00733000
         AGO   .BHPD8                  Go to location processing        00734000
.*                                                                      00735000
.BHPD7   ANOP                                                           00736000
         CEEXCALC &BELOWHEAP(1,2)      Obtain &VALUE and &CALCOK        00737000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            00738000
         AIF   (&CALCOK).BHPD7M                                         00739000
&ALLOK   SETB  0                       Indicate error detected          00740000
         AGO   .BHPD8                                                   00741000
.BHPD7M  ANOP                                                           00742000
&BHRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             00743000
&BHRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             00744000
.*                                                                      00745000
.BHPD8   ANOP                          Location processing              00746000
&LOCDISP SETA  &BELOW                  Location forced BELOW            00747000
.*                                                                      00748000
.*                                     Disposition processing           00749000
         AIF   ('&BELOWHEAP(1,3)' NE 'KEEP').BHPD9                      00750000
&LOCDISP SETA  &LOCDISP+&KEEP          Indicate disposition is KEEP     00751000
         AGO   .BHPD11                 Go check 2nd sublist item        00752000
.*                                                                      00753000
.BHPD9   ANOP                          Set disposition to default FREE  00754000
&LOCDISP SETA  &LOCDISP+&FREE                                           00755000
         AIF   ('&BELOWHEAP(1,3)' NE '').BHPD10                         00756000
         MNOTE 8,'BELOWHEAP must specify a disposition:'                00757000
         MNOTE 8,'it has been set to FREE.'                             00758000
&ALLOK   SETB  0                       Indicate error detected          00759000
         AGO   .BHPD11                 Go check 2nd sublist item        00760000
.*                                                                      00761000
.BHPD10  ANOP                                                           00762000
         AIF   ('&BELOWHEAP(1,3)' EQ 'FREE').BHPD11                     00763000
         MNOTE 8,'BELOWHEAP disposition unrecognized:'                  00764000
         MNOTE 8,'it has been set to FREE.'                             00765000
&ALLOK   SETB  0                       Indicate error detected          00766000
.*                                                                      00767000
.BHPD11  ANOP                          Check 2nd sublist item           00768000
         AIF   ('&BELOWHEAP(2)' NE 'OVR' AND                           X00769000
               '&BELOWHEAP(2)' NE 'NONOVR').BHPD12                      00770000
         AIF   (NOT &ALLOK).BHPD13     If errors, force overridable     00771000
         AIF   ('&BELOWHEAP(2)' EQ 'OVR').BHPGEN                        00772000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  00773000
         AGO   .BHPGEN                                                  00774000
.*                                                                      00775000
.BHPD12  ANOP                                                           00776000
         MNOTE 8,'Last BELOWHEAP sublist item must be OVR or NONOVR.'   00777000
.*                                                                      00778000
.BHPD13  ANOP                                                           00779000
         MNOTE 8,'Due to error(s) detected above, BELOWHEAP has'        00780000
         MNOTE 8,'been set overridable (with valid bits on).'           00781000
.*                                                                      00782000
.BHPGEN  ANOP                                                           00783000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 00784000
         DC    X'00'                   Unused                           00785000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   00786000
         DC    A(BHP_SUB-&SYSECT)      Offset of suboptions block       00787000
*                                                                       00788000
SUB      LOCTR                                                          00789000
BHP_SUB  DS    0F                      BELOWHEAP suboptions block       00790000
         DC    AL1(&VALBITS)           Suboption valid bits             00791000
         DC    AL3(0)                  Unused suboption valid bits      00792000
         DC    F'&INITSIZ'             BELOWHEAP initial size           00793000
         DC    F'&INCRSIZ'             BELOWHEAP increment size         00794000
         DC    AL1(&LOCDISP)           128 = BELOW, 64 = FREE           00795000
         DC    3X'00'                  Unused                           00796000
*                                                                       00797000
&SYSECT  LOCTR                                                          00798000
*                                                                       00799000
.********************************************************************** 00800000
*    CHECK option                                                       00801000
.********************************************************************** 00802000
         CEEXSIMP CHECK,&CHECK                                          00803000
*                                                                       00804000
.********************************************************************** 00805000
*    PLITASKCOUNT option - Unsupported in this release of LE/VSE        00806000
.********************************************************************** 00807000
&FLAG    SETA  &ON+&DOPT               Options flag initialized         00808000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 00809000
&PTCLMT  SETC  '20'                    PLI task count initialized       00810000
&ALLOK   SETB  1                       Suboptions assumed error-free    00811000
.*                                                                      00812000
.PTCGEN  ANOP                                                           00813000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 00814000
         DC    X'00'                   Unused                           00815000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   00816000
         DC    A(PTC_SUB-&SYSECT)      Offset of suboptions block       00817000
*                                                                       00818000
SUB      LOCTR                                                          00819000
PTC_SUB  DS    0F                      PLITASKCOUNT suboptions block    00820000
         DC    AL1(&VALBITS)           Suboption valid bits             00821000
         DC    AL3(0)                  Unused suboption valid bits      00822000
         DC    F'&PTCLMT'              PLITASKCOUNT # condition limit   00823000
*                                                                       00824000
&SYSECT  LOCTR                                                          00825000
.********************************************************************** 00826000
*    ABTERMENC option                                                   00827000
.********************************************************************** 00828000
&FLAG    SETA  &ON                     Options flag initialized         00829000
&VALBITS SETA  &OFF*(&BIT1)                                             00830000
&ABTMODE SETC  '&RETCODE'              Default exit mode                00831000
&ALLOK   SETB  1                       Suboptions assumed error-free    00832000
         AIF   (&DOPT).ABTD            Go to CEEDOPT processing         00833000
.*                                     CEEUOPT processing               00834000
         AIF   (N'&ABTERMENC EQ 0).ABTGEN                               00835000
         AIF   ('&ABTERMENC' EQ '()').ABTGEN                            00836000
         AIF   (N'&ABTERMENC EQ 1).ABTU1                                00837000
         MNOTE 8,'Too many suboptions -- ABTERMENC marked invalid.'     00838000
         AGO   .ABTGEN                                                  00839000
.*                                                                      00840000
.ABTU1   ANOP                          Check exit mode                  00841000
         AIF   ('&ABTERMENC(1)' EQ 'RETCODE').ABTU3                     00842000
         AIF   ('&ABTERMENC(1)' EQ 'ABEND').ABTU2                       00843000
         MNOTE 8,'ABTERMENC suboption not recognized: it'               00844000
         MNOTE 8,'has been set to RETCODE and marked invalid.'          00845000
         AGO   .ABTGEN                                                  00846000
.*                                                                      00847000
.ABTU2   ANOP                          Set exit mode to ABEND           00848000
&ABTMODE SETC  '&ABEND'                                                 00849000
.*                                                                      00850000
.ABTU3   ANOP                          ABTERMENC valid string           00851000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          00852000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       00853000
         AGO   .ABTGEN                                                  00854000
.*                                                                      00855000
.ABTD    ANOP                          CEEDOPT processing               00856000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          00857000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       00858000
         AIF   (N'&ABTERMENC EQ 2).ABTD1                                00859000
         MNOTE 8,'ABTERMENC requires 2 sublist items: it has been'      00860000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   00861000
         AGO   .ABTGEN                                                  00862000
.*                                                                      00863000
.ABTD1   ANOP                          Check # 1st sublist items        00864000
         AIF   (N'&ABTERMENC(1) EQ 1).ABTD2                             00865000
         MNOTE 8,'ABTERMENC(1) requires exactly 1 item: ABTERMENC'      00866000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   00867000
         AGO   .ABTGEN                                                  00868000
.*                                                                      00869000
.ABTD2   ANOP                          Disallow empty parentheses       00870000
         AIF   ('&ABTERMENC(1)' NE '()').ABTD3                          00871000
         MNOTE 8,'ABTERMENC(1) requires exactly 1 item: ABTERMENC'      00872000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   00873000
         AGO   .ABTGEN                                                  00874000
.*                                                                      00875000
.ABTD3   ANOP                          Check exit mode                  00876000
         AIF   ('&ABTERMENC(1,1)' EQ 'RETCODE').ABTD5                   00877000
         AIF   ('&ABTERMENC(1,1)' EQ 'ABEND').ABTD4                     00878000
         MNOTE 8,'ABTERMENC exit mode not recognized:'                  00879000
         MNOTE 8,'it has been set to RETCODE.'                          00880000
&ALLOK   SETB  0                       Indicate error detected          00881000
         AGO   .ABTD5                  Go check 2nd sublist item        00882000
.*                                                                      00883000
.ABTD4   ANOP                          Set exit mode to ABEND           00884000
&ABTMODE SETC  '&ABEND'                                                 00885000
.*                                                                      00886000
.ABTD5   ANOP                          Check 2nd sublist item           00887000
         AIF   ('&ABTERMENC(2)' NE 'OVR' AND                           X00888000
               '&ABTERMENC(2)' NE 'NONOVR').ABTD6                       00889000
         AIF   (NOT &ALLOK).ABTD7      If errors, force overridable     00890000
         AIF   ('&ABTERMENC(2)' EQ 'OVR').ABTGEN                        00891000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  00892000
         AGO   .ABTGEN                                                  00893000
.*                                                                      00894000
.ABTD6   ANOP                                                           00895000
         MNOTE 8,'Last ABTERMENC sublist item must be OVR or NONOVR.'   00896000
.*                                                                      00897000
.ABTD7   ANOP                                                           00898000
         MNOTE 8,'Due to error(s) detected above, ABTERMENC has'        00899000
         MNOTE 8,'been set overridable (with valid bits on).'           00900000
.*                                                                      00901000
.ABTGEN  ANOP                                                           00902000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 00903000
         DC    X'00'                   Unused                           00904000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   00905000
         DC    A(ABT_SUB-&SYSECT)      Offset of suboptions block       00906000
*                                                                       00907000
SUB      LOCTR                                                          00908000
ABT_SUB  DS    0F                      ABTERMENC suboptions block       00909000
         DC    AL1(&VALBITS)           Suboption valid bits             00910000
         DC    AL3(0)                  Unused suboption valid bits      00911000
         DC    F'&ABTMODE'             2=ABEND, 1=RETCODE               00912000
*                                                                       00913000
&SYSECT  LOCTR                                                          00914000
*                                                                       00915000
.********************************************************************** 00916000
*    COUNTRY option                                                     00917000
.********************************************************************** 00918000
&FLAG    SETA  &ON                     Options flag initialized         00919000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 00920000
&CTNAME  SETC  'US'                    Default country                  00921000
&ALLOK   SETB  1                       Suboptions assumed error-free    00922000
         AIF   (&DOPT).CNTD            Go to CEEDOPT processing         00923000
.*                                     CEEUOPT processing               00924000
         AIF   (N'&COUNTRY EQ 0).CNTGEN                                 00925000
         AIF   ('&COUNTRY' EQ '()').CNTGEN                              00926000
         AIF   (N'&COUNTRY EQ 1).CNTU1                                  00927000
         MNOTE 8,'Too many suboptions -- COUNTRY marked invalid.'       00928000
         AGO   .CNTGEN                                                  00929000
.*                                                                      00930000
.CNTU1   ANOP                          Check sublist item length        00931000
         AIF   (K'&COUNTRY(1) EQ 2).CNTU2                               00932000
         MNOTE 8,'Country identifier must be 2 characters: COUNTRY'     00933000
         MNOTE 8,'set to &CTNAME with valid bits off.'                  00934000
         AGO   .CNTGEN                                                  00935000
.*                                                                      00936000
.CNTU2   ANOP                          Check for valid COUNTRY ID       00937000
&CTRYIND SETA  1                       Initialize index for search      00938000
.*                                                                      00939000
.CNTU3   ANOP                          Top of search loop               00940000
         AIF   (&CTRYIND GT &CTRYNUM).CNTU4                             00941000
         AIF   ('&COUNTRY(1)' EQ '&CTRYLST(&CTRYIND)').CNTU5            00942000
&CTRYIND SETA  &CTRYIND+1              Increment index for search       00943000
         AGO   .CNTU3                  Continue search                  00944000
.*                                                                      00945000
.CNTU4   ANOP                          Indicate search failed           00946000
         MNOTE 4,'Warning: COUNTRY code &COUNTRY(1) is unknown.'        00947000
.*                                                                      00948000
.CNTU5   ANOP                          Set valid bits and COUNTRY       00949000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          00950000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       00951000
&CTNAME  SETC  '&COUNTRY(1)'           COUNTRY ID set to value passed   00952000
         AGO   .CNTGEN                                                  00953000
.*                                                                      00954000
.CNTD    ANOP                          CEEDOPT processing               00955000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          00956000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       00957000
         AIF   (N'&COUNTRY EQ 2).CNTD1                                  00958000
         MNOTE 8,'COUNTRY requires 2 sublist items: it has been'        00959000
         MNOTE 8,'set to &CTNAME, overridable, with valid bits on.'     00960000
         AGO   .CNTGEN                                                  00961000
.*                                                                      00962000
.CNTD1   ANOP                          Check # 1st sublist items        00963000
         AIF   (N'&COUNTRY(1) EQ 1).CNTD2                               00964000
         MNOTE 8,'COUNTRY(1) requires exactly 1 sublist item: COUNTRY'  00965000
         MNOTE 8,'set to &CTNAME and overridable, with valid bits on.'  00966000
         AGO   .CNTGEN                                                  00967000
.*                                                                      00968000
.CNTD2   ANOP                          Check sublist item length        00969000
         AIF   (K'&COUNTRY(1,1) EQ 2).CNTD3                             00970000
         MNOTE 8,'Country identifier must be 2 characters:'             00971000
         MNOTE 8,'COUNTRY has been set to default &CTNAME..'            00972000
&ALLOK   SETB  0                       Indicate error detected          00973000
         AGO   .CNTD7                  Go check 2nd sublist item        00974000
.*                                                                      00975000
.CNTD3   ANOP                          Check for valid COUNTRY ID       00976000
&CTRYIND SETA  1                       Initialize index for search      00977000
.*                                                                      00978000
.CNTD4   ANOP                          Top of search loop               00979000
         AIF   (&CTRYIND GT &CTRYNUM).CNTD5                             00980000
         AIF   ('&COUNTRY(1,1)' EQ '&CTRYLST(&CTRYIND)').CNTD6          00981000
&CTRYIND SETA  &CTRYIND+1              Increment index for search       00982000
         AGO   .CNTD4                  Continue search                  00983000
.*                                                                      00984000
.CNTD5   ANOP                          Indicate search failed           00985000
         MNOTE 4,'Warning: COUNTRY code &COUNTRY(1,1) is unknown.'      00986000
.*                                                                      00987000
.CNTD6   ANOP                          Set ID to value passed in        00988000
&CTNAME  SETC  '&COUNTRY(1,1)'         Set COUNTRY ID                   00989000
.*                                                                      00990000
.CNTD7   ANOP                          Check 2nd sublist item           00991000
         AIF   ('&COUNTRY(2)' NE 'OVR' AND                             X00992000
               '&COUNTRY(2)' NE 'NONOVR').CNTD8                         00993000
         AIF   (NOT &ALLOK).CNTD9      If errors, force overridable     00994000
         AIF   ('&COUNTRY(2)' EQ 'OVR').CNTGEN                          00995000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  00996000
         AGO   .CNTGEN                                                  00997000
.*                                                                      00998000
.CNTD8   ANOP                                                           00999000
         MNOTE 8,'Last COUNTRY sublist item must be OVR or NONOVR.'     01000000
.*                                                                      01001000
.CNTD9   ANOP                                                           01002000
         MNOTE 8,'Due to error(s) detected above, COUNTRY has'          01003000
         MNOTE 8,'been set overridable (with valid bits on).'           01004000
.*                                                                      01005000
.CNTGEN  ANOP                                                           01006000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 01007000
         DC    X'00'                   Unused                           01008000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   01009000
         DC    A(CNT_SUB-&SYSECT)      Offset of suboptions block       01010000
*                                                                       01011000
SUB      LOCTR                                                          01012000
CNT_SUB  DS    0F                      COUNTRY suboptions block         01013000
         DC    AL1(&VALBITS)           Suboption valid bits             01014000
         DC    AL3(0)                  Unused suboption valid bits      01015000
         DC    CL2'&CTNAME'            COUNTRY identifier               01016000
         DC    X'0000'                 Unused                           01017000
*                                                                       01018000
&SYSECT  LOCTR                                                          01019000
*                                                                       01020000
.********************************************************************** 01021000
*    DEBUG option                                                       01022000
.********************************************************************** 01023000
         CEEXSIMP DEBUG,&DEBUG                                          01024000
.********************************************************************** 01025000
*    ERRCOUNT option                                                    01026000
.********************************************************************** 01027000
&FLAG    SETA  &ON                     Options flag initialized         01028000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 01029000
&ERRNUM  SETC  '20'                    Error count initialized          01030000
&ALLOK   SETB  1                       Suboptions assumed error-free    01031000
         AIF   (&DOPT).ERRD            Go to CEEDOPT processing         01032000
.*                                     CEEUOPT processing               01033000
         AIF   (N'&ERRCOUNT EQ 0).ERRGEN                                01034000
         AIF   ('&ERRCOUNT' EQ '()').ERRGEN                             01035000
         AIF   (N'&ERRCOUNT EQ 1).ERRU1                                 01036000
         MNOTE 8,'Too many suboptions -- ERRCOUNT marked invalid.'      01037000
         AGO   .ERRGEN                                                  01038000
.*                                                                      01039000
.ERRU1   ANOP                          Disallow leading minus sign      01040000
&TEMPSTR SETC  '&ERRCOUNT(1)'          Obtain error count suboption     01041000
         AIF   ('&TEMPSTR'(1,1) NE '-').ERRU2                           01042000
         MNOTE 8,'ERRCOUNT may not have a minus sign: it'               01043000
         MNOTE 8,'has been set to &ERRNUM and marked invalid.'          01044000
         AGO   .ERRGEN                                                  01045000
.*                                                                      01046000
.ERRU2   ANOP                          Assume error count numeric       01047000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          01048000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       01049000
&ERRNUM  SETC  '&ERRCOUNT(1)'          Error count set to value passed  01050000
         AGO   .ERRGEN                                                  01051000
.*                                                                      01052000
.ERRD    ANOP                          CEEDOPT processing               01053000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          01054000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       01055000
         AIF   (N'&ERRCOUNT EQ 2).ERRD1                                 01056000
         MNOTE 8,'ERRCOUNT requires 2 sublist items: it has been'       01057000
         MNOTE 8,'set to &ERRNUM, overridable, with valid bits on.'     01058000
         AGO   .ERRGEN                                                  01059000
.*                                                                      01060000
.ERRD1   ANOP                          Check # 1st sublist items        01061000
         AIF   (N'&ERRCOUNT(1) EQ 1).ERRD2                              01062000
         MNOTE 8,'ERRCOUNT(1) needs exactly 1 sublist item: ERRCOUNT'   01063000
         MNOTE 8,'set to &ERRNUM and overridable, with valid bits on.'  01064000
         AGO   .ERRGEN                                                  01065000
.*                                                                      01066000
.ERRD2   ANOP                          Disallow empty parentheses       01067000
         AIF   ('&ERRCOUNT(1)' NE '()').ERRD3                           01068000
         MNOTE 8,'ERRCOUNT(1) needs exactly 1 sublist item: ERRCOUNT'   01069000
         MNOTE 8,'set to &ERRNUM and overridable, with valid bits on.'  01070000
         AGO   .ERRGEN                                                  01071000
.*                                                                      01072000
.ERRD3   ANOP                          Disallow leading minus sign      01073000
&TEMPSTR SETC  '&ERRCOUNT(1,1)'        Obtain error count suboption     01074000
         AIF   ('&TEMPSTR'(1,1) NE '-').ERRD4                           01075000
         MNOTE 8,'ERRCOUNT may not have a minus sign:'                  01076000
         MNOTE 8,'it has been set to &ERRNUM..'                         01077000
&ALLOK   SETB  0                       Indicate error detected          01078000
         AGO   .ERRD5                  Go check 2nd sublist item        01079000
.*                                                                      01080000
.ERRD4   ANOP                          Assume error count numeric       01081000
&ERRNUM  SETC  '&ERRCOUNT(1,1)'        Error count set to value passed  01082000
.*                                                                      01083000
.ERRD5   ANOP                          Check 2nd sublist item           01084000
         AIF   ('&ERRCOUNT(2)' NE 'OVR' AND                            X01085000
               '&ERRCOUNT(2)' NE 'NONOVR').ERRD6                        01086000
         AIF   (NOT &ALLOK).ERRD7      If errors, force overridable     01087000
         AIF   ('&ERRCOUNT(2)' EQ 'OVR').ERRGEN                         01088000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  01089000
         AGO   .ERRGEN                                                  01090000
.*                                                                      01091000
.ERRD6   ANOP                                                           01092000
         MNOTE 8,'Last ERRCOUNT sublist item must be OVR or NONOVR.'    01093000
.*                                                                      01094000
.ERRD7   ANOP                                                           01095000
         MNOTE 8,'Due to error(s) detected above, ERRCOUNT has'         01096000
         MNOTE 8,'been set overridable (with valid bits on).'           01097000
.*                                                                      01098000
.ERRGEN  ANOP                                                           01099000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 01100000
         DC    X'00'                   Unused                           01101000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   01102000
         DC    A(ERR_SUB-&SYSECT)      Offset of suboptions block       01103000
*                                                                       01104000
SUB      LOCTR                                                          01105000
ERR_SUB  DS    0F                      ERRCOUNT suboptions block        01106000
         DC    AL1(&VALBITS)           Suboption valid bits             01107000
         DC    AL3(0)                  Unused suboption valid bits      01108000
         DC    F'&ERRNUM'              ERRCOUNT # non-fatal errors      01109000
*                                                                       01110000
&SYSECT  LOCTR                                                          01111000
*                                                                       01112000
.********************************************************************** 01113000
*    FILEHIST option - Unsupported in this release of LE/VSE            01114000
.********************************************************************** 01115000
.*       CEEXSIMP FILEHIST,&FILEHIST                                    01116000
         CEEXHARD &OFF                 Disable this option this release 01117000
.********************************************************************** 01118000
*    ENVAR option                                                       01119000
.********************************************************************** 01120000
&FLAG    SETA  &ON                     Options flag initialized         01121000
&VALBITS SETA  &OFF*(&BIT1)                                             01122000
&ENVNUL  SETC  ' '                     Initialize envar null string     01123000
&ESLEN   SETA  0                       Initialize commands name length  01124000
&ALLOK   SETB  1                       Suboptions assumed error-free    01125000
&ENVCNT  SETA  1                       Set counter for looping          01126000
         AIF   (&DOPT).ENVD            Go to CEEDOPT processing         01127000
.*                                     CEEUOPT processing               01128000
         AIF   (N'&ENVAR EQ 0).ENVGEN                                   01129000
         AIF   ('&ENVAR' EQ '()').ENVGEN                                01130000
.*                                                                      01131000
&ENVNUM  SETA  N'&ENVAR                Get number of sublist items      01132000
.*                                                                      01133000
.ENVU1   ANOP                                      Loop                 01134000
         AIF   (&ENVCNT GT &ENVNUM).ENVU4          Done looping         01135000
&ENVSTR(&ENVCNT) SETC '&ENVAR(&ENVCNT)'            Obtain parameter     01136000
         CEEXSTRI &ENVSTR(&ENVCNT),250,ENVAR_string                     01137000
&ENVSTR(&ENVCNT) SETC  '&STRING'       Use CEEXSTRI's result            01138000
         AIF   (&STRIOK NE 1).ENVU3    If CEEXSTRI not OK, leave        01139000
&ESLEN   SETA  &ESLEN+&STRLEN          Use CEEXSTRI's result            01140000
         AIF   (&ESLEN GT 250).ENVU2   If length exceeds 250, leave     01141000
         AIF   (&ENVCNT EQ &ENVNUM).ENVUINC If last one, skip null ch   01142000
&ESLEN   SETA  &ESLEN+1                Add length 1 for null ch         01143000
.ENVUINC ANOP                                                           01144000
&ENVCNT  SETA  &ENVCNT+1               Increment count                  01145000
         AGO   .ENVU1                  Loop to ENVU1                    01146000
.*                                                                      01147000
.ENVU2   ANOP                                                           01148000
         MNOTE 8,'The total length of the combined ENVAR strings'       01149000
         MNOTE 8,'exceeded 250 characters.'                             01150000
.*                                                                      01151000
.ENVU3   ANOP                                                           01152000
&ESLEN   SETA  0                       Force to length zero             01153000
         MNOTE 8,'The ENVAR string is set to null.'                     01154000
         MNOTE 8,'ENVAR marked invalid due to above error.'             01155000
         AGO   .ENVGEN                                                  01156000
.*                                                                      01157000
.ENVU4   ANOP                          ENVAR valid string               01158000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          01159000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       01160000
         AGO   .ENVGEN                                                  01161000
.*                                                                      01162000
.ENVD    ANOP                          CEEDOPT processing               01163000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          01164000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       01165000
         AIF   (N'&ENVAR EQ 2).ENVD1                                    01166000
         MNOTE 8,'ENVAR requires 2 sublist items: it has been set'      01167000
         MNOTE 8,'to a default, overridable, with valid bits on.'       01168000
         AGO   .ENVGEN                                                  01169000
.*                                                                      01170000
.ENVD1   ANOP                          Disallow empty parentheses       01171000
         AIF   ('&ENVAR(1)' NE '()').ENVD2                              01172000
         MNOTE 8,'ENVAR(1) requires at least 1 sublist item: ENVAR'     01173000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   01174000
         AGO   .ENVGEN                                                  01175000
.*                                                                      01176000
.ENVD2   ANOP                                                           01177000
&ENVNUM  SETA  N'&ENVAR(1)             Get number of sublist items      01178000
.*                                                                      01179000
.ENVD3   ANOP                                      Loop                 01180000
         AIF   (&ENVCNT GT &ENVNUM).ENVD6          Done looping         01181000
&ENVSTR(&ENVCNT) SETC '&ENVAR(1,&ENVCNT)'          Obtain parameter     01182000
         CEEXSTRI &ENVSTR(&ENVCNT),250,ENVAR_string                     01183000
&ENVSTR(&ENVCNT) SETC  '&STRING'       Use CEEXSTRI's result            01184000
         AIF   (&STRIOK NE 1).ENVD5    If CEEXSTRI not OK, leave        01185000
&ESLEN   SETA  &ESLEN+&STRLEN          Use CEEXSTRI's result            01186000
         AIF   (&ESLEN GT 250).ENVD4   If length exceeds 250, leave     01187000
         AIF   (&ENVCNT EQ &ENVNUM).ENVDINC If last one, skip null ch   01188000
&ESLEN   SETA  &ESLEN+1                Add length 1 for comma           01189000
.ENVDINC ANOP                                                           01190000
&ENVCNT  SETA  &ENVCNT+1               Increment count                  01191000
         AGO   .ENVD3                  Loop to ENVD3                    01192000
.*                                                                      01193000
.ENVD4   ANOP                                                           01194000
         MNOTE 8,'The total length of the combined ENVAR strings'       01195000
         MNOTE 8,'exceeded 250 characters.'                             01196000
.*                                                                      01197000
.ENVD5   ANOP                                                           01198000
&ALLOK   SETB  0                       Indicate error detected          01199000
&ESLEN   SETA  0                       Force to length zero             01200000
         MNOTE 8,'The ENVAR string is set to null.'                     01201000
.*                                                                      01202000
.ENVD6   ANOP                          Check 2nd sublist item           01203000
         AIF   ('&ENVAR(2)' NE 'OVR' AND                               X01204000
               '&ENVAR(2)' NE 'NONOVR').ENVD7                           01205000
         AIF   (NOT &ALLOK).ENVD8      If errors, put out msg           01206000
         AIF   ('&ENVAR(2)' EQ 'OVR').ENVGEN                            01207000
         MNOTE 0,'Last ENVAR sublist item NONOVR has been forced'       01208000
         MNOTE 0,'to be OVR.'                                           01209000
         AGO   .ENVGEN                 Envar always forced overridable  01210000
.*                                                                      01211000
.ENVD7   ANOP                                                           01212000
         MNOTE 8,'Last ENVAR sublist item must be OVR or NONOVR.'       01213000
.*                                                                      01214000
.ENVD8   ANOP                                                           01215000
         MNOTE 8,'Due to error(s) detected above, ENVAR has'            01216000
         MNOTE 8,'been set overridable (with valid bits on).'           01217000
.*                                                                      01218000
.ENVGEN  ANOP                                                           01219000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 01220000
         DC    X'00'                   Unused                           01221000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   01222000
         DC    A(ENV_SUB-&SYSECT)      Offset of suboptions block       01223000
*                                                                       01224000
SUB      LOCTR                                                          01225000
ENV_SUB  DS    0F                      ENVAR suboptions block           01226000
         DC    AL1(&VALBITS)           Suboption valid bits             01227000
         DC    AL3(0)                  Unused suboption valid bits      01228000
         DC    A(ENVSTR-&SYSECT)       Offset of ENVAR string           01229000
*                                                                       01230000
ENVSTR   DS    0F                      ENVAR string                     01231000
         DC    H'&ESLEN'               Effective length of following    01232000
         AIF   (&ESLEN EQ 0).ENVNULL   If 0 length string               01233000
&ENVCNT  SETA  1                       Set counter for looping          01234000
         DS    0CL250                  ENVAR string                     01235000
.ENVLP   ANOP                               Loop                        01236000
         AIF   (&ENVCNT GT &ENVNUM).ENVDONE Done looping                01237000
         DC    C'&ENVSTR(&ENVCNT)'          DC each sublist item        01238000
         AIF   (&ENVCNT EQ &ENVNUM).ENVGINC If last one, no null ch     01239000
         DC    X'00'                        Concat null ch              01240000
.ENVGINC ANOP                                                           01241000
&ENVCNT  SETA  &ENVCNT+1               Increment count                  01242000
         AGO   .ENVLP                  Loop to ENVLP                    01243000
.ENVNULL DC    CL250'&ENVNUL'          ENVAR string                     01244000
.ENVDONE ANOP                                                           01245000
*                                                                       01246000
&SYSECT  LOCTR                                                          01247000
*                                                                       01248000
.********************************************************************** 01249000
*    FLOWC option (Cobol)                                               01250000
.********************************************************************** 01251000
&FLAG    SETA  &OFF+&DOPT              Valid if CEEDOPT, else invalid   01252000
         DC    AL1(&FLAG)              128 = ON, 1 = valid              01253000
         DC    X'00'                   Unused                           01254000
         DC    H'&WHSETDS'             Set to default setting           01255000
         DC    A(FLOC_SUB-&SYSECT)     Offset of suboptions block       01256000
*                                                                       01257000
SUB      LOCTR                                                          01258000
FLOC_SUB DS    0F                      FLOWC suboptions block           01259000
&VALBITS SETA  &DOPT*(&BIT1)                                            01260000
         DC    AL1(&VALBITS)           Suboption valid bits             01261000
         DC    AL3(0)                  Unused suboption valid bits      01262000
         DC    F'99'                   FLOWC max # procedures           01263000
*                                                                       01264000
&SYSECT  LOCTR                                                          01265000
*                                                                       01266000
.********************************************************************** 01267000
*    HEAP option                                                        01268000
.********************************************************************** 01269000
&FLAG    SETA  &ON                     Options flag initialized         01270000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3+&BIT4+&BIT5+&BIT6)               01271000
&INITSIZ SETC  '65536'                 Default initial size 64K         01272000
&INCRSIZ SETC  '65536'                 Default increment size 64K       01273000
&HPTR4   SETA  &INITSIZ                Init rounded value 4K            01274000
&HPTR8   SETA  &INITSIZ                Init rounded value 8 byte        01275000
&HPRR4   SETA  &INCRSIZ                Incr rounded value 4K            01276000
&HPRR8   SETA  &INCRSIZ                Incr rounded value 8 byte        01277000
&LOCDISP SETA  &ANYWHR+&KEEP           Default location, disposition    01278000
&INIT24  SETC  '16384'                 Default below-line init size 16K 01279000
&INCR24  SETC  '16384'                 Default below-line incr size 16K 01280000
&HT24R4  SETA  &INIT24                 Init24 rounded value 4K          01281000
&HT24R8  SETA  &INIT24                 Init24 rounded value 8 byte      01282000
&HR24R4  SETA  &INCR24                 Incr24 rounded value 4K          01283000
&HR24R8  SETA  &INCR24                 Incr24 rounded value 8 byte      01284000
&ALLOK   SETB  1                       Suboptions assumed error-free    01285000
         AIF   (&DOPT).HEPD            Go to CEEDOPT processing         01286000
.*                                     CEEUOPT processing               01287000
         AIF   (N'&HEAP EQ 0).HEPGEN   Go set defaults, mark invalid    01288000
         AIF   ('&HEAP' EQ '()').HEPGEN                                 01289000
         AIF   (N'&HEAP LE 6).HEPU1                                     01290000
         MNOTE 8,'Too many suboptions -- HEAP marked invalid.'          01291000
         AGO   .HEPGEN                                                  01292000
.*                                                                      01293000
.HEPU1   ANOP                          Initial size processing          01294000
         AIF   ('&HEAP(1)' EQ '').HEPU4 If null, work on incr size      01295000
&TEMPSTR SETC  '&HEAP(1)'              Obtain initial size suboption    01296000
         AIF   ('&TEMPSTR'(1,1) NE '-').HEPU2                           01297000
         MNOTE 8,'HEAP initial size may not have a minus sign:'         01298000
         MNOTE 8,'it has been set to &INITSIZ and marked invalid.'      01299000
&ALLOK   SETB  0                       Indicate option invalid          01300000
         AGO   .HEPU4                  Go to incr size processing       01301000
.*                                                                      01302000
.HEPU2   ANOP                                                           01303000
         CEEXCALC &HEAP(1)             Obtain &VALUE and &CALCOK        01304000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            01305000
         AIF   (&CALCOK).HEPU3         If CEEXCALC OK, suboption valid  01306000
&ALLOK   SETB  0                       Indicate option invalid          01307000
         AGO   .HEPU4                  Go to incr size processing       01308000
.*                                                                      01309000
.HEPU3   ANOP                          Set 1st suboption valid bit on   01310000
&VALBITS SETA  &VALBITS+&BIT1                                           01311000
&HPTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01312000
&HPTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             01313000
.*                                                                      01314000
.HEPU4   ANOP                          Increment size processing        01315000
         AIF   ('&HEAP(2)' EQ '').HEPU7 If null, work on location       01316000
&TEMPSTR SETC  '&HEAP(2)'              Obtain increment size suboption  01317000
         AIF   ('&TEMPSTR'(1,1) NE '-').HEPU5                           01318000
         MNOTE 8,'HEAP increment size may not have a minus sign:'       01319000
         MNOTE 8,'it has been set to &INCRSIZ and marked invalid.'      01320000
&ALLOK   SETB  0                       Indicate option invalid          01321000
         AGO   .HEPU7                  Go to location processing        01322000
.*                                                                      01323000
.HEPU5   ANOP                                                           01324000
         CEEXCALC &HEAP(2)             Obtain &VALUE and &CALCOK        01325000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            01326000
         AIF   (&CALCOK).HEPU6         If CEEXCALC OK, suboption valid  01327000
&ALLOK   SETB  0                       Indicate option invalid          01328000
         AGO   .HEPU7                  Go to location processing        01329000
.*                                                                      01330000
.HEPU6   ANOP                          Set 2nd suboption valid bit on   01331000
&VALBITS SETA  &VALBITS+&BIT2                                           01332000
&HPRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01333000
&HPRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             01334000
.*                                                                      01335000
.HEPU7   ANOP                          Location processing              01336000
&LOCDISP SETA  &ANYWHR                 Set location default             01337000
         AIF   ('&HEAP(3)' EQ '').HEPU10 If null, work on disposition   01338000
         AIF   ('&HEAP(3)' EQ 'BELOW').HEPU8                            01339000
         AIF   ('&HEAP(3)' EQ 'ANYWHERE' OR                            X01340000
               '&HEAP(3)' EQ 'ANY').HEPU9                               01341000
         MNOTE 8,'HEAP location unrecognized -- it has'                 01342000
         MNOTE 8,'been set to ANYWHERE and marked invalid.'             01343000
&ALLOK   SETB  0                       Indicate option invalid          01344000
         AGO   .HEPU10                 Go to disposition processing     01345000
.*                                                                      01346000
.HEPU8   ANOP                          Set location to below            01347000
&LOCDISP SETA  &BELOW                                                   01348000
.*                                                                      01349000
.HEPU9   ANOP                          Set 3rd suboption valid bit on   01350000
&VALBITS SETA  &VALBITS+&BIT3                                           01351000
.*                                                                      01352000
.HEPU10  ANOP                          Disposition processing           01353000
         AIF   ('&HEAP(4)' NE 'FREE').HEPU11                            01354000
&LOCDISP SETA  &LOCDISP+&FREE          Indicate disposition is FREE     01355000
         AGO   .HEPU12                 Go mark suboption valid          01356000
.*                                                                      01357000
.HEPU11  ANOP                          Set disposition to default KEEP  01358000
&LOCDISP SETA  &LOCDISP+&KEEP                                           01359000
         AIF   ('&HEAP(4)' EQ 'KEEP').HEPU12                            01360000
         AIF   ('&HEAP(4)' EQ '').HEPU13 Avoid setting suboption valid  01361000
         MNOTE 8,'HEAP disposition unrecognized -- it has'              01362000
         MNOTE 8,'been set to KEEP and marked invalid.'                 01363000
&ALLOK   SETB  0                       Indicate option invalid          01364000
         AGO   .HEPU13                 Go to init size 24 processing    01365000
.*                                                                      01366000
.HEPU12  ANOP                          Set 4th suboption valid bit on   01367000
&VALBITS SETA  &VALBITS+&BIT4                                           01368000
.*                                                                      01369000
.HEPU13  ANOP                          Initial size 24 processing       01370000
         AIF   ('&HEAP(5)' EQ '').HEPU16 If null, work on incr size 24  01371000
&TEMPSTR SETC  '&HEAP(5)'              Obtain initial size 24 suboption 01372000
         AIF   ('&TEMPSTR'(1,1) NE '-').HEPU14                          01373000
         MNOTE 8,'HEAP initial size 24 may not have a minus sign:'      01374000
         MNOTE 8,'it has been set to &INIT24 and marked invalid.'       01375000
&ALLOK   SETB  0                       Indicate option invalid          01376000
         AGO   .HEPU16                 Go to incr size 24 processing    01377000
.*                                                                      01378000
.HEPU14  ANOP                                                           01379000
         CEEXCALC &HEAP(5)             Obtain &VALUE and &CALCOK        01380000
&INIT24  SETC  '&VALUE'                Use CEEXCALC's result            01381000
         AIF   (&CALCOK).HEPU15        If CEEXCALC OK, suboption valid  01382000
&ALLOK   SETB  0                       Indicate option invalid          01383000
         AGO   .HEPU16                 Go to incr size 24 processing    01384000
.*                                                                      01385000
.HEPU15  ANOP                          Set 5th suboption valid bit on   01386000
&VALBITS SETA  &VALBITS+&BIT5                                           01387000
&HT24R4  SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01388000
&HT24R8  SETA  ((&VALUE+7)/8)*8          Calc rounded value             01389000
.*                                                                      01390000
.HEPU16  ANOP                          Increment size 24 processing     01391000
         AIF   ('&HEAP(6)' EQ '').HEPU19 Avoid setting suboption valid  01392000
&TEMPSTR SETC  '&HEAP(6)'              Obtain incr size 24 suboption    01393000
         AIF   ('&TEMPSTR'(1,1) NE '-').HEPU17                          01394000
         MNOTE 8,'HEAP increment size 24 may not have a minus sign:'    01395000
         MNOTE 8,'it has been set to &INCR24 and marked invalid.'       01396000
&ALLOK   SETB  0                       Indicate option invalid          01397000
         AGO   .HEPU19                 Go examine HEAP validity         01398000
.*                                                                      01399000
.HEPU17  ANOP                                                           01400000
         CEEXCALC &HEAP(6)             Obtain &VALUE and &CALCOK        01401000
&INCR24  SETC  '&VALUE'                Use CEEXCALC's result            01402000
         AIF   (&CALCOK).HEPU18        If CEEXCALC OK, suboption valid  01403000
&ALLOK   SETB  0                       Indicate option invalid          01404000
         AGO   .HEPU19                 Go examine HEAP validity         01405000
.*                                                                      01406000
.HEPU18  ANOP                          Set 6th suboption valid bit on   01407000
&VALBITS SETA  &VALBITS+&BIT6                                           01408000
&HR24R4  SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01409000
&HR24R8  SETA  ((&VALUE+7)/8)*8          Calc rounded value             01410000
.*                                                                      01411000
.HEPU19  ANOP                          Determine if HEAP option valid   01412000
         AIF   (NOT &ALLOK).HEPU20     If suboption error, need msg     01413000
         AIF   (&VALBITS EQ &OFF).HEPGEN If off, all suboptions null    01414000
&FLAG    SETA  &FLAG+&VALID            No errors, not all subopts null  01415000
         AGO   .HEPGEN                                                  01416000
.*                                                                      01417000
.HEPU20  ANOP                                                           01418000
         MNOTE 8,'HEAP option marked invalid due to above error(s).'    01419000
         AGO   .HEPGEN                                                  01420000
.*                                                                      01421000
.HEPD    ANOP                          CEEDOPT processing               01422000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          01423000
&VALBITS SETA  &BIT1+&BIT2+&BIT3+&BIT4+&BIT5+&BIT6 Set subopt val bits  01424000
         AIF   (N'&HEAP EQ 2).HEPD1                                     01425000
         MNOTE 8,'HEAP requires 2 sublist items: it has been set to'    01426000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 01427000
         AGO   .HEPGEN                                                  01428000
.*                                                                      01429000
.HEPD1   ANOP                          Check # 1st sublist items        01430000
         AIF   (N'&HEAP(1) EQ 6).HEPD2                                  01431000
         MNOTE 8,'HEAP(1) requires 6 suboptions: it has been set to'    01432000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 01433000
         AGO   .HEPGEN                                                  01434000
.*                                                                      01435000
.HEPD2   ANOP                          Initial size processing          01436000
         AIF   ('&HEAP(1,1)' NE '').HEPD3                               01437000
         MNOTE 8,'HEAP must specify an initial size:'                   01438000
         MNOTE 8,'it has been set to &INITSIZ..'                        01439000
&ALLOK   SETB  0                       Indicate error detected          01440000
         AGO   .HEPD5                  Go to increment size processing  01441000
.*                                                                      01442000
.HEPD3   ANOP                          Disallow leading minus sign      01443000
&TEMPSTR SETC  '&HEAP(1,1)'            Obtain initial size suboption    01444000
         AIF   ('&TEMPSTR'(1,1) NE '-').HEPD4                           01445000
         MNOTE 8,'HEAP initial size may not begin with'                 01446000
         MNOTE 8,'a minus sign.  It has been set to &INITSIZ..'         01447000
&ALLOK   SETB  0                       Indicate error detected          01448000
         AGO   .HEPD5                  Go to increment size processing  01449000
.*                                                                      01450000
.HEPD4   ANOP                                                           01451000
         CEEXCALC &HEAP(1,1)           Obtain &VALUE and &CALCOK        01452000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            01453000
         AIF   (&CALCOK).HEPD4M                                         01454000
&ALLOK   SETB  0                       Indicate error detected          01455000
         AGO   .HEPD5                                                   01456000
.HEPD4M  ANOP                                                           01457000
&HPTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01458000
&HPTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             01459000
.*                                                                      01460000
.HEPD5   ANOP                          Increment size processing        01461000
         AIF   ('&HEAP(1,2)' NE '').HEPD6                               01462000
         MNOTE 8,'HEAP must specify an increment size:'                 01463000
         MNOTE 8,'it has been set to &INCRSIZ..'                        01464000
&ALLOK   SETB  0                       Indicate error detected          01465000
         AGO   .HEPD8                  Go to location processing        01466000
.*                                                                      01467000
.HEPD6   ANOP                          Disallow leading minus sign      01468000
&TEMPSTR SETC  '&HEAP(1,2)'            Obtain increment size suboption  01469000
         AIF   ('&TEMPSTR'(1,1) NE '-').HEPD7                           01470000
         MNOTE 8,'HEAP increment size may not begin with'               01471000
         MNOTE 8,'a minus sign.  It has been set to &INCRSIZ..'         01472000
&ALLOK   SETB  0                       Indicate error detected          01473000
         AGO   .HEPD8                  Go to location processing        01474000
.*                                                                      01475000
.HEPD7   ANOP                                                           01476000
         CEEXCALC &HEAP(1,2)           Obtain &VALUE and &CALCOK        01477000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            01478000
         AIF   (&CALCOK).HEPD7M                                         01479000
&ALLOK   SETB  0                       Indicate error detected          01480000
         AGO   .HEPD8                                                   01481000
.HEPD7M  ANOP                                                           01482000
&HPRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01483000
&HPRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             01484000
.*                                                                      01485000
.HEPD8   ANOP                          Location processing              01486000
&LOCDISP SETA  &ANYWHR                 Set location default             01487000
         AIF   ('&HEAP(1,3)' NE '').HEPD9                               01488000
         MNOTE 8,'HEAP must specify a location:'                        01489000
         MNOTE 8,'it has been set to ANYWHERE.'                         01490000
&ALLOK   SETB  0                       Indicate error detected          01491000
         AGO   .HEPD11                 Go to disposition processing     01492000
.*                                                                      01493000
.HEPD9   ANOP                                                           01494000
         AIF   ('&HEAP(1,3)' EQ 'BELOW').HEPD10                         01495000
         AIF   ('&HEAP(1,3)' EQ 'ANYWHERE' OR                          X01496000
               '&HEAP(1,3)' EQ 'ANY').HEPD11                            01497000
         MNOTE 8,'HEAP location unrecognized:'                          01498000
         MNOTE 8,'it has been set to ANYWHERE.'                         01499000
&ALLOK   SETB  0                       Indicate error detected          01500000
         AGO   .HEPD11                 Go to disposition processing     01501000
.*                                                                      01502000
.HEPD10  ANOP                          Set location to below            01503000
&LOCDISP SETA  &BELOW                                                   01504000
.*                                                                      01505000
.HEPD11  ANOP                          Disposition processing           01506000
         AIF   ('&HEAP(1,4)' NE 'FREE').HEPD12                          01507000
&LOCDISP SETA  &LOCDISP+&FREE          Indicate disposition is FREE     01508000
         AGO   .HEPD14                 Go to init size 24 processing    01509000
.*                                                                      01510000
.HEPD12  ANOP                          Set disposition to default KEEP  01511000
&LOCDISP SETA  &LOCDISP+&KEEP                                           01512000
         AIF   ('&HEAP(1,4)' NE '').HEPD13                              01513000
         MNOTE 8,'HEAP must specify a disposition:'                     01514000
         MNOTE 8,'it has been set to KEEP.'                             01515000
&ALLOK   SETB  0                       Indicate error detected          01516000
         AGO   .HEPD14                 Go to init size 24 processing    01517000
.*                                                                      01518000
.HEPD13  ANOP                                                           01519000
         AIF   ('&HEAP(1,4)' EQ 'KEEP').HEPD14                          01520000
         MNOTE 8,'HEAP disposition unrecognized:'                       01521000
         MNOTE 8,'it has been set to KEEP.'                             01522000
&ALLOK   SETB  0                       Indicate error detected          01523000
.*                                                                      01524000
.HEPD14  ANOP                          Initial size 24 processing       01525000
         AIF   ('&HEAP(1,5)' NE '').HEPD15                              01526000
         MNOTE 8,'HEAP must specify an initial size 24:'                01527000
         MNOTE 8,'it has been set to &INIT24..'                         01528000
&ALLOK   SETB  0                       Indicate error detected          01529000
         AGO   .HEPD17                 Go to incr size 24 processing    01530000
.*                                                                      01531000
.HEPD15  ANOP                          Disallow leading minus sign      01532000
&TEMPSTR SETC  '&HEAP(1,5)'            Obtain initial size 24 suboption 01533000
         AIF   ('&TEMPSTR'(1,1) NE '-').HEPD16                          01534000
         MNOTE 8,'HEAP initial size 24 may not begin with'              01535000
         MNOTE 8,'a minus sign.  It has been set to &INIT24..'          01536000
&ALLOK   SETB  0                       Indicate error detected          01537000
         AGO   .HEPD17                 Go to incr size 24 processing    01538000
.*                                                                      01539000
.HEPD16  ANOP                                                           01540000
         CEEXCALC &HEAP(1,5)           Obtain &VALUE and &CALCOK        01541000
&INIT24  SETC  '&VALUE'                Use CEEXCALC's result            01542000
         AIF   (&CALCOK).HEPD16A                                        01543000
&ALLOK   SETB  0                       Indicate error detected          01544000
         AGO   .HEPD17                                                  01545000
.HEPD16A ANOP                                                           01546000
&HT24R4  SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01547000
&HT24R8  SETA  ((&VALUE+7)/8)*8          Calc rounded value             01548000
.*                                                                      01549000
.HEPD17  ANOP                          Increment size 24 processing     01550000
         AIF   ('&HEAP(1,6)' NE '').HEPD18                              01551000
         MNOTE 8,'HEAP must specify an increment size 24:'              01552000
         MNOTE 8,'it has been set to &INCR24..'                         01553000
&ALLOK   SETB  0                       Indicate error detected          01554000
         AGO   .HEPD20                 Go check 2nd sublist item        01555000
.*                                                                      01556000
.HEPD18  ANOP                          Disallow leading minus sign      01557000
&TEMPSTR SETC  '&HEAP(1,6)'            Obtain incr size 24 suboption    01558000
         AIF   ('&TEMPSTR'(1,1) NE '-').HEPD19                          01559000
         MNOTE 8,'HEAP increment size 24 may not begin with'            01560000
         MNOTE 8,'a minus sign.  It has been set to &INCR24..'          01561000
&ALLOK   SETB  0                       Indicate error detected          01562000
         AGO   .HEPD20                 Go check 2nd sublist item        01563000
.*                                                                      01564000
.HEPD19  ANOP                                                           01565000
         CEEXCALC &HEAP(1,6)           Obtain &VALUE and &CALCOK        01566000
&INCR24  SETC  '&VALUE'                Use CEEXCALC's result            01567000
         AIF   (&CALCOK).HEPD19A                                        01568000
&ALLOK   SETB  0                       Indicate error detected          01569000
         AGO   .HEPD20                                                  01570000
.HEPD19A ANOP                                                           01571000
&HR24R4  SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01572000
&HR24R8  SETA  ((&VALUE+7)/8)*8          Calc rounded value             01573000
.*                                                                      01574000
.HEPD20  ANOP                          Check 2nd sublist item           01575000
         AIF   ('&HEAP(2)' NE 'OVR' AND                                X01576000
               '&HEAP(2)' NE 'NONOVR').HEPD21                           01577000
         AIF   (NOT &ALLOK).HEPD22     If errors, force overridable     01578000
         AIF   ('&HEAP(2)' EQ 'OVR').HEPGEN                             01579000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  01580000
         AGO   .HEPGEN                                                  01581000
.*                                                                      01582000
.HEPD21  ANOP                                                           01583000
         MNOTE 8,'Last HEAP sublist item must be OVR or NONOVR.'        01584000
.*                                                                      01585000
.HEPD22  ANOP                                                           01586000
         MNOTE 8,'Due to error(s) detected above, HEAP has'             01587000
         MNOTE 8,'been set overridable (with valid bits on).'           01588000
.*                                                                      01589000
.HEPGEN  ANOP                                                           01590000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 01591000
         DC    X'00'                   Unused                           01592000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   01593000
         DC    A(HEP_SUB-&SYSECT)      Offset of suboptions block       01594000
*                                                                       01595000
SUB      LOCTR                                                          01596000
HEP_SUB  DS    0F                      HEAP suboptions block            01597000
         DC    AL1(&VALBITS)           Suboption valid bits             01598000
         DC    AL3(0)                  Unused suboption valid bits      01599000
         DC    F'&INITSIZ'             HEAP initial size                01600000
         DC    F'&INCRSIZ'             HEAP increment size              01601000
         DC    AL1(&LOCDISP)           128 = BELOW, 64 = FREE           01602000
         DC    3X'00'                  Unused                           01603000
         DC    F'&INIT24'              HEAP initial size 24             01604000
         DC    F'&INCR24'              HEAP increment size 24           01605000
*                                                                       01606000
&SYSECT  LOCTR                                                          01607000
*                                                                       01608000
.********************************************************************** 01609000
*    INQPCOPN option - Unsupported in this release of LE/VSE            01610000
.********************************************************************** 01611000
.*       CEEXSIMP INQPCOPN,&INQPCOPN                                    01612000
         CEEXHARD &OFF                 Disable this option this release 01613000
.********************************************************************** 01614000
*    INTERRUPT option - Unsupported in this release of LE/VSE           01615000
.********************************************************************** 01616000
.*       CEEXSIMP INTERRUPT,&INTERRUPT                                  01617000
         CEEXHARD &OFF                 Disable this option this release 01618000
.********************************************************************** 01619000
*    LIBSTACK option                                                    01620000
.*                                                                    * 01621000
.*   LIBSTACK has only 3 suboption valid bits since only initial      * 01622000
.*   size, increment size, and disposition may be specified.  The     * 01623000
.*   location-disposition bit flags, however, have the same layout as * 01624000
.*   those in STACK, but with the location bit in all cases hard-     * 01625000
.*   coded on to signify BELOW.                                       * 01626000
.********************************************************************** 01627000
&FLAG    SETA  &ON                     Options flag initialized         01628000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3)                                 01629000
&INITSIZ SETC  '32768'                 Default initial size 32K         01630000
&INCRSIZ SETC  '16384'                 Default increment size 16K       01631000
&LOCDISP SETA  &BELOW+&FREE            Default location, disposition    01632000
&LSTR4   SETA  &INITSIZ                Init rounded value 4K            01633000
&LSTR8   SETA  &INITSIZ                Init rounded value 8 byte        01634000
&LSRR4   SETA  &INCRSIZ                Incr rounded value 4K            01635000
&LSRR8   SETA  &INCRSIZ                Incr rounded value 8 byte        01636000
&ALLOK   SETB  1                       Suboptions assumed error-free    01637000
         AIF   (&DOPT).LBSD            Go to CEEDOPT processing         01638000
.*                                     CEEUOPT processing               01639000
         AIF   (N'&LIBSTACK EQ 0).LBSGEN Go set defaults, mark invalid  01640000
         AIF   ('&LIBSTACK' EQ '()').LBSGEN                             01641000
         AIF   (N'&LIBSTACK LE 3).LBSU1                                 01642000
         MNOTE 8,'Too many suboptions -- LIBSTACK marked invalid.'      01643000
         AGO   .LBSGEN                                                  01644000
.*                                                                      01645000
.LBSU1   ANOP                          Initial size processing          01646000
         AIF   ('&LIBSTACK(1)' EQ '').LBSU3 If null, work on incr size  01647000
         CEEXCALC &LIBSTACK(1)         Obtain &VALUE and &CALCOK        01648000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            01649000
         AIF   (&CALCOK).LBSU2         If CEEXCALC OK, suboption valid  01650000
&ALLOK   SETB  0                       Indicate option invalid          01651000
         AGO   .LBSU3                  Go to incr size processing       01652000
.*                                                                      01653000
.LBSU2   ANOP                          Set 1st suboption valid bit on   01654000
&VALBITS SETA  &VALBITS+&BIT1                                           01655000
         AIF   ('&VALUE'(1,1) EQ '-').LBSU3                             01656000
&LSTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01657000
&LSTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             01658000
.*                                                                      01659000
.LBSU3   ANOP                          Increment size processing        01660000
         AIF   ('&LIBSTACK(2)' EQ '').LBSU6 If null, work on location   01661000
&TEMPSTR SETC  '&LIBSTACK(2)'          Obtain increment size suboption  01662000
         AIF   ('&TEMPSTR'(1,1) NE '-').LBSU4                           01663000
         MNOTE 8,'LIBSTACK increment size may not have a minus sign:'   01664000
         MNOTE 8,'it has been set to &INCRSIZ and marked invalid.'      01665000
&ALLOK   SETB  0                       Indicate option invalid          01666000
         AGO   .LBSU6                  Go to location processing        01667000
.*                                                                      01668000
.LBSU4   ANOP                                                           01669000
         CEEXCALC &LIBSTACK(2)         Obtain &VALUE and &CALCOK        01670000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            01671000
         AIF   (&CALCOK).LBSU5         If CEEXCALC OK, suboption valid  01672000
&ALLOK   SETB  0                       Indicate option invalid          01673000
         AGO   .LBSU6                  Go to location processing        01674000
.*                                                                      01675000
.LBSU5   ANOP                                                           01676000
&VALBITS SETA  &VALBITS+&BIT2          Set 2nd suboption valid bit on   01677000
&LSRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01678000
&LSRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             01679000
.*                                                                      01680000
.LBSU6   ANOP                          Location processing              01681000
&LOCDISP SETA  &BELOW                  Location forced BELOW            01682000
.*                                                                      01683000
.*                                     Disposition processing           01684000
         AIF   ('&LIBSTACK(3)' NE 'KEEP').LBSU7                         01685000
&LOCDISP SETA  &LOCDISP+&KEEP          Indicate disposition is KEEP     01686000
         AGO   .LBSU8                  Go mark suboption valid          01687000
.*                                                                      01688000
.LBSU7   ANOP                          Set disposition to default FREE  01689000
&LOCDISP SETA  &LOCDISP+&FREE                                           01690000
         AIF   ('&LIBSTACK(3)' EQ 'FREE').LBSU8                         01691000
         AIF   ('&LIBSTACK(3)' EQ '').LBSU9                             01692000
         MNOTE 8,'LIBSTACK disposition unrecognized:'                   01693000
         MNOTE 8,'it has been set to FREE and marked invalid.'          01694000
&ALLOK   SETB  0                       Indicate option invalid          01695000
         AGO   .LBSU9                  Go examine LIBSTACK validity     01696000
.*                                                                      01697000
.LBSU8   ANOP                          Set 3rd suboption valid bit on   01698000
&VALBITS SETA  &VALBITS+&BIT3                                           01699000
.*                                                                      01700000
.LBSU9   ANOP                          Determine if LIBSTACK valid      01701000
         AIF   (NOT &ALLOK).LBSU10     If suboption error, need msg     01702000
         AIF   (&VALBITS EQ &OFF).LBSGEN If off, all suboptions null    01703000
&FLAG    SETA  &FLAG+&VALID            No errors, not all subopts null  01704000
         AGO   .LBSGEN                                                  01705000
.*                                                                      01706000
.LBSU10  ANOP                                                           01707000
         MNOTE 8,'LIBSTACK marked invalid due to above error(s).'       01708000
         AGO   .LBSGEN                                                  01709000
.*                                                                      01710000
.LBSD    ANOP                          CEEDOPT processing               01711000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          01712000
&VALBITS SETA  &BIT1+&BIT2+&BIT3       Suboption valid bits set on      01713000
         AIF   (N'&LIBSTACK EQ 2).LBSD1                                 01714000
         MNOTE 8,'LIBSTACK requires 2 sublist items: it has been set'   01715000
         MNOTE 8,'to defaults, and marked overridable and valid.'       01716000
         AGO   .LBSGEN                                                  01717000
.*                                                                      01718000
.LBSD1   ANOP                          Check # 1st sublist items        01719000
         AIF   (N'&LIBSTACK(1) EQ 3).LBSD2                              01720000
         MNOTE 8,'LIBSTACK(1) requires 3 suboptions: it has been set'   01721000
         MNOTE 8,'to defaults, and marked overridable and valid.'       01722000
         AGO   .LBSGEN                                                  01723000
.*                                                                      01724000
.LBSD2   ANOP                          Initial size processing          01725000
         AIF   ('&LIBSTACK(1,1)' NE '').LBSD3                           01726000
         MNOTE 8,'LIBSTACK must specify an initial size:'               01727000
         MNOTE 8,'it has been set to &INITSIZ..'                        01728000
&ALLOK   SETB  0                       Indicate error detected          01729000
         AGO   .LBSD4                  Go to increment size processing  01730000
.*                                                                      01731000
.LBSD3   ANOP                                                           01732000
         CEEXCALC &LIBSTACK(1,1)       Obtain &VALUE and &CALCOK        01733000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            01734000
         AIF   (&CALCOK).LBSD3M                                         01735000
&ALLOK   SETB  0                       Indicate error detected          01736000
         AGO   .LBSD4                                                   01737000
.LBSD3M  ANOP                                                           01738000
         AIF   ('&VALUE'(1,1) EQ '-').LBSD4                             01739000
&LSTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01740000
&LSTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             01741000
.*                                                                      01742000
.LBSD4   ANOP                          Increment size processing        01743000
         AIF   ('&LIBSTACK(1,2)' NE '').LBSD5                           01744000
         MNOTE 8,'LIBSTACK must specify an increment size:'             01745000
         MNOTE 8,'it has been set to &INCRSIZ..'                        01746000
&ALLOK   SETB  0                       Indicate error detected          01747000
         AGO   .LBSD7                  Go to location processing        01748000
.*                                                                      01749000
.LBSD5   ANOP                          Disallow leading minus sign      01750000
&TEMPSTR SETC  '&LIBSTACK(1,2)'        Obtain increment size suboption  01751000
         AIF   ('&TEMPSTR'(1,1) NE '-').LBSD6                           01752000
         MNOTE 8,'LIBSTACK increment size may not begin with'           01753000
         MNOTE 8,'a minus sign.  It has been set to &INCRSIZ..'         01754000
&ALLOK   SETB  0                       Indicate error detected          01755000
         AGO   .LBSD7                  Go to location processing        01756000
.*                                                                      01757000
.LBSD6   ANOP                                                           01758000
         CEEXCALC &LIBSTACK(1,2)       Obtain &VALUE and &CALCOK        01759000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            01760000
         AIF   (&CALCOK).LBSD6M                                         01761000
&ALLOK   SETB  0                       Indicate error detected          01762000
         AGO   .LBSD7                                                   01763000
.LBSD6M  ANOP                                                           01764000
         AIF   ('&VALUE'(1,1) EQ '-').LBSD4                             01765000
&LSRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             01766000
&LSRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             01767000
.*                                                                      01768000
.LBSD7   ANOP                          Location processing              01769000
&LOCDISP SETA  &BELOW                  Location forced BELOW            01770000
.*                                                                      01771000
.*                                     Disposition processing           01772000
         AIF   ('&LIBSTACK(1,3)' NE 'KEEP').LBSD8                       01773000
&LOCDISP SETA  &LOCDISP+&KEEP          Indicate disposition is KEEP     01774000
         AGO   .LBSD10                 Go check 2nd sublist item        01775000
.*                                                                      01776000
.LBSD8   ANOP                          Set disposition to default FREE  01777000
&LOCDISP SETA  &LOCDISP+&FREE                                           01778000
         AIF   ('&LIBSTACK(1,3)' NE '').LBSD9                           01779000
         MNOTE 8,'LIBSTACK must specify a disposition:'                 01780000
         MNOTE 8,'it has been set to FREE.'                             01781000
&ALLOK   SETB  0                       Indicate error detected          01782000
         AGO   .LBSD10                 Go check 2nd sublist item        01783000
.*                                                                      01784000
.LBSD9   ANOP                                                           01785000
         AIF   ('&LIBSTACK(1,3)' EQ 'FREE').LBSD10                      01786000
         MNOTE 8,'LIBSTACK disposition unrecognized:'                   01787000
         MNOTE 8,'it has been set to FREE.'                             01788000
&ALLOK   SETB  0                       Indicate error detected          01789000
.*                                                                      01790000
.LBSD10  ANOP                          Check 2nd sublist item           01791000
         AIF   ('&LIBSTACK(2)' NE 'OVR' AND                            X01792000
               '&LIBSTACK(2)' NE 'NONOVR').LBSD11                       01793000
         AIF   (NOT &ALLOK).LBSD12     If errors, force overridable     01794000
         AIF   ('&LIBSTACK(2)' EQ 'OVR').LBSGEN                         01795000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  01796000
         AGO   .LBSGEN                                                  01797000
.*                                                                      01798000
.LBSD11  ANOP                                                           01799000
         MNOTE 8,'Last LIBSTACK sublist item must be OVR or NONOVR.'    01800000
.*                                                                      01801000
.LBSD12  ANOP                                                           01802000
         MNOTE 8,'Due to error(s) detected above, LIBSTACK has'         01803000
         MNOTE 8,'been set overridable (with valid bits on).'           01804000
.*                                                                      01805000
.LBSGEN  ANOP                                                           01806000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 01807000
         DC    X'00'                   Unused                           01808000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   01809000
         DC    A(LBS_SUB-&SYSECT)      Offset of suboptions block       01810000
*                                                                       01811000
SUB      LOCTR                                                          01812000
LBS_SUB  DS    0F                      LIBSTACK suboptions block        01813000
         DC    AL1(&VALBITS)           Suboption valid bits             01814000
         DC    AL3(0)                  Unused suboption valid bits      01815000
         DC    F'&INITSIZ'             LIBSTACK initial size            01816000
         DC    F'&INCRSIZ'             LIBSTACK increment size          01817000
         DC    AL1(&LOCDISP)           128 = BELOW, 64 = FREE           01818000
         DC    3X'00'                  Unused                           01819000
*                                                                       01820000
&SYSECT  LOCTR                                                          01821000
*                                                                       01822000
.********************************************************************** 01823000
*    MSGQ option                                                        01824000
.********************************************************************** 01825000
&FLAG    SETA  &ON                     Options flag initialized         01826000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 01827000
&MSGQNUM SETC  '15'                    Initialize max # MIB entries     01828000
&ALLOK   SETB  1                       Suboptions assumed error-free    01829000
         AIF   (&DOPT).MSQD            Go to CEEDOPT processing         01830000
.*                                     CEEUOPT processing               01831000
         AIF   (N'&MSGQ EQ 0).MSQGEN                                    01832000
         AIF   ('&MSGQ' EQ '()').MSQGEN                                 01833000
         AIF   (N'&MSGQ EQ 1).MSQU1                                     01834000
         MNOTE 8,'Too many suboptions -- MSGQ marked invalid.'          01835000
         AGO   .MSQGEN                                                  01836000
.*                                                                      01837000
.MSQU1   ANOP                          Disallow leading minus sign      01838000
&TEMPSTR SETC  '&MSGQ(1)'              Obtain MSGQ suboption            01839000
         AIF   ('&TEMPSTR'(1,1) NE '-').MSQU2                           01840000
         MNOTE 8,'MSGQ may not have a minus sign: it has'               01841000
         MNOTE 8,'been set to &MSGQNUM and marked invalid.'             01842000
         AGO   .MSQGEN                                                  01843000
.*                                                                      01844000
.MSQU2   ANOP                          Prevent zero value               01845000
&TEMPVAL SETA  &MSGQ(1)                Obtain MSGQ, assume numeric      01846000
         AIF   (&TEMPVAL NE 0).MSQU3                                    01847000
.*                                                                    * 01848000
.*   Note that if MSGQ is not numeric, the error is captured:         * 01849000
.*       ARITHMETIC TERM IS NOT SELF-DEFINING TERM.  DEFAULT=0        * 01850000
.*   appears in the listing for the MSGQ option, and &TEMPVAL is set  * 01851000
.*   to zero, causing the following MNOTEs to also appear.            * 01852000
.*                                                                    * 01853000
         MNOTE 8,'MSGQ may not have value zero: it has'                 01854000
         MNOTE 8,'been set to &MSGQNUM and marked invalid.'             01855000
         AGO   .MSQGEN                                                  01856000
.*                                                                      01857000
.MSQU3   ANOP                                                           01858000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          01859000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       01860000
&MSGQNUM SETC  '&MSGQ(1)'              MSGQ set to value passed         01861000
         AGO   .MSQGEN                                                  01862000
.*                                                                      01863000
.MSQD    ANOP                          CEEDOPT processing               01864000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          01865000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       01866000
         AIF   (N'&MSGQ EQ 2).MSQD1                                     01867000
         MNOTE 8,'MSGQ requires 2 sublist items: it has been'           01868000
         MNOTE 8,'set to &MSGQNUM, overridable, with valid bits on.'    01869000
         AGO   .MSQGEN                                                  01870000
.*                                                                      01871000
.MSQD1   ANOP                          Check # 1st sublist items        01872000
         AIF   (N'&MSGQ(1) EQ 1).MSQD2                                  01873000
         MNOTE 8,'MSGQ(1) requires exactly 1 sublist item: MSGQ'        01874000
         MNOTE 8,'set to &MSGQNUM and overridable, with valid bits on.' 01875000
         AGO   .MSQGEN                                                  01876000
.*                                                                      01877000
.MSQD2   ANOP                          Disallow empty parentheses       01878000
         AIF   ('&MSGQ(1)' NE '()').MSQD3                               01879000
         MNOTE 8,'MSGQ(1) requires exactly 1 sublist item: MSGQ'        01880000
         MNOTE 8,'set to &MSGQNUM and overridable, with valid bits on.' 01881000
         AGO   .MSQGEN                                                  01882000
.*                                                                      01883000
.MSQD3   ANOP                          Disallow leading minus sign      01884000
&TEMPSTR SETC  '&MSGQ(1,1)'            Obtain MSGQ suboption            01885000
         AIF   ('&TEMPSTR'(1,1) NE '-').MSQD4                           01886000
         MNOTE 8,'MSGQ may not have a minus sign:'                      01887000
         MNOTE 8,'it has been set to &MSGQNUM..'                        01888000
&ALLOK   SETB  0                       Indicate error detected          01889000
         AGO   .MSQD6                  Go check 2nd sublist item        01890000
.*                                                                      01891000
.MSQD4   ANOP                          Prevent zero value               01892000
&TEMPVAL SETA  &MSGQ(1,1)              Obtain MSGQ, assume numeric      01893000
         AIF   (&TEMPVAL NE 0).MSQD5                                    01894000
.*                                                                    * 01895000
.*   Note that if MSGQ is not numeric, the error is captured:         * 01896000
.*       ARITHMETIC TERM IS NOT SELF-DEFINING TERM.  DEFAULT=0        * 01897000
.*   appears in the listing for the MSGQ option, and &TEMPVAL is set  * 01898000
.*   to zero, causing the following MNOTEs to also appear.            * 01899000
.*                                                                    * 01900000
         MNOTE 8,'MSGQ may not have value zero:'                        01901000
         MNOTE 8,'it has been set to &MSGQNUM..'                        01902000
&ALLOK   SETB  0                       Indicate error detected          01903000
         AGO   .MSQD6                  Go check 2nd sublist item        01904000
.*                                                                      01905000
.MSQD5   ANOP                          Assume MSGQ numeric              01906000
&MSGQNUM SETC  '&MSGQ(1,1)'            MSGQ set to value passed         01907000
.*                                                                      01908000
.MSQD6   ANOP                          Check 2nd sublist item           01909000
         AIF   ('&MSGQ(2)' NE 'OVR' AND                                X01910000
               '&MSGQ(2)' NE 'NONOVR').MSQD7                            01911000
         AIF   (NOT &ALLOK).MSQD8      If errors, force overridable     01912000
         AIF   ('&MSGQ(2)' EQ 'OVR').MSQGEN                             01913000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  01914000
         AGO   .MSQGEN                                                  01915000
.*                                                                      01916000
.MSQD7   ANOP                                                           01917000
         MNOTE 8,'Last MSGQ sublist item must be OVR or NONOVR.'        01918000
.*                                                                      01919000
.MSQD8   ANOP                                                           01920000
         MNOTE 8,'Due to error(s) detected above, MSGQ has'             01921000
         MNOTE 8,'been set overridable (with valid bits on).'           01922000
.*                                                                      01923000
.MSQGEN  ANOP                                                           01924000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 01925000
         DC    X'00'                   Unused                           01926000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   01927000
         DC    A(MSQ_SUB-&SYSECT)      Offset of suboptions block       01928000
*                                                                       01929000
SUB      LOCTR                                                          01930000
MSQ_SUB  DS    0F                      MSGQ suboptions block            01931000
         DC    AL1(&VALBITS)           Suboption valid bits             01932000
         DC    AL3(0)                  Unused suboption valid bits      01933000
         DC    F'&MSGQNUM'             MSGQ maximum # MIB entries       01934000
*                                                                       01935000
&SYSECT  LOCTR                                                          01936000
*                                                                       01937000
.********************************************************************** 01938000
*    MSGFILE option                                                     01939000
.********************************************************************** 01940000
&FLAG    SETA  &ON                     Options flag initialized         01941000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3+&BIT4) Suboption valid bits init 01942000
&DDNAME  SETC  'SYSLST'                Default DDname of message file   01943000
&DDLEN   SETC  '6'                     Default length of DDname         01944000
&RECFM   SETC  'FBA'                   Default RECFM of message file    01945000
&RFMLEN  SETC  '3'                     Default length of RECFM          01946000
&LRECL   SETC  '121'                   Default logical record length    01947000
&BLKSIZE SETC  '0'                     Default block size               01948000
&MSGMAX  SETA  32760                   Max lrecl and blksize            01949000
&ALLOK   SETB  1                       Suboptions assumed error-free    01950000
         AIF   (&DOPT).MSGD            Go to CEEDOPT processing         01951000
.*                                     CEEUOPT processing               01952000
         AIF   (N'&MSGFILE EQ 0).MSGGEN                                 01953000
         AIF   ('&MSGFILE' EQ '()').MSGGEN                              01954000
         AIF   (N'&MSGFILE EQ 1).MSGU1                                  01955000
         MNOTE 8,'Too many suboptions -- MSGFILE marked invalid.'       01956000
         AGO   .MSGGEN                                                  01957000
.*                                                                      01958000
.MSGU1   ANOP                                                           01959000
         AIF   ('&MSGFILE(1)' EQ '').MSGU3 If null, work on recfm       01960000
&DDNAME  SETC  '&MSGFILE(1)'           Obtain ddname                    01961000
         CEEXSTRI &DDNAME,8,DDname     Get &STRING, &STRLEN, &STRIOK    01962000
&DDNAME  SETC  '&STRING'               Use CEEXSTRI's result            01963000
&DDLEN   SETC  '&STRLEN'               Use CEEXSTRI's result            01964000
         AIF   (&STRIOK).MSGU2         If CEEXSTRI OK, suboption valid  01965000
&ALLOK   SETB  0                       Indicate option invalid          01966000
.*                                                                      01967000
.MSGU2   ANOP                          Set 1st suboption valis bit on   01968000
&VALBITS SETA  &VALBITS+&BIT1                                           01969000
.*                                                                      01970000
.MSGU12  ANOP                          Determine if MSGFILE opt valid   01971000
         AIF   (NOT &ALLOK).MSGU13     If suboption error, need msg     01972000
         AIF   (&VALBITS EQ &OFF).MSGGEN If off, all suboptions null    01973000
&FLAG    SETA  &FLAG+&VALID            No errors, not all subopts null  01974000
         AGO   .MSGGEN                                                  01975000
.*                                                                      01976000
.MSGU13  ANOP                                                           01977000
         MNOTE 8,'MSGFILE marked invalid due to above error(s).'        01978000
         AGO   .MSGGEN                                                  01979000
.*                                                                      01980000
.MSGD    ANOP                          CEEDOPT processing               01981000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          01982000
&VALBITS SETA  &BIT1+&BIT2+&BIT3+&BIT4 Suboption valid bits set on      01983000
         AIF   (N'&MSGFILE EQ 2).MSGD1                                  01984000
         MNOTE 8,'MSGFILE requires 2 sublist items: it has been'        01985000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   01986000
         AGO   .MSGGEN                                                  01987000
.*                                                                      01988000
.MSGD1   ANOP                          Check # 1st sublist items        01989000
         AIF   (N'&MSGFILE(1) EQ 1).MSGD2                               01990000
         MNOTE 8,'MSGFILE(1) requires exactly 1 sublist item: MSGFILE'  01991000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   01992000
         AGO   .MSGGEN                                                  01993000
.*                                                                      01994000
.MSGD2   ANOP                          Disallow empty parentheses       01995000
         AIF   ('&MSGFILE(1)' NE '()').MSGD3                            01996000
         MNOTE 8,'MSGFILE(1) requires exactly 1 sublist item: MSGFILE'  01997000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   01998000
         AGO   .MSGGEN                                                  01999000
.*                                                                      02000000
.MSGD3   ANOP                          Ddname processing                02001000
         AIF   ('&MSGFILE(1,1)' NE '').MSGD4                            02002000
         MNOTE 8,'MSGFILE must specify a ddname. It has been set to'    02003000
         MNOTE 8,'&DDNAME.'                                             02004000
&ALLOK   SETB  0                       Indicate option invalid          02005000
         AGO   .MSGD16                 Check 2nd sublist item           02006000
.*                                                                      02007000
.MSGD4   ANOP                                                           02008000
&DDNAME  SETC  '&MSGFILE(1,1)'         Obtain ddname                    02009000
         CEEXSTRI &DDNAME,8,DDname     Get &STRING, &STRLEN, &STRIOK    02010000
&DDNAME  SETC  '&STRING'               Use CEEXSTRI's result            02011000
&DDLEN   SETC  '&STRLEN'               Use CEEXSTRI's result            02012000
         AIF   (&STRIOK).MSGD16        If OK, check 2nd sublist item    02013000
&ALLOK   SETB  0                       Indicate error detected          02014000
.*                                                                      02015000
.MSGD16  ANOP                          Check 2nd sublist item           02016000
         AIF   ('&MSGFILE(2)' NE 'OVR' AND                             X02017000
               '&MSGFILE(2)' NE 'NONOVR').MSGD17                        02018000
         AIF   (NOT &ALLOK).MSGD18     If errors, force overridable     02019000
         AIF   ('&MSGFILE(2)' EQ 'OVR').MSGGEN                          02020000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  02021000
         AGO   .MSGGEN                                                  02022000
.*                                                                      02023000
.MSGD17  ANOP                                                           02024000
         MNOTE 8,'Last MSGFILE sublist item must be OVR or NONOVR.'     02025000
.*                                                                      02026000
.MSGD18  ANOP                                                           02027000
         MNOTE 8,'Due to error(s) detected above, MSGFILE has'          02028000
         MNOTE 8,'been set overridable (with valid bits on).'           02029000
.*                                                                      02030000
.MSGGEN  ANOP                                                           02031000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 02032000
         DC    X'00'                   Unused                           02033000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   02034000
         DC    A(MSG_SUB-&SYSECT)      Offset of suboptions block       02035000
*                                                                       02036000
SUB      LOCTR                                                          02037000
MSG_SUB  DS    0F                      MSGFILE suboptions block         02038000
         DC    AL1(&VALBITS)           Suboption valid bits             02039000
         DC    AL3(0)                  Unused suboption valid bits      02040000
         DC    A(DDNAME-&SYSECT)       Offset of DDname                 02041000
         DC    A(RECFM-&SYSECT)        Offset of RECFM                  02042000
         DC    F'&LRECL'               Logical record length            02043000
         DC    F'&BLKSIZE'             Block size                       02044000
*                                                                       02045000
DDNAME   DS    0F                      MSGFILE DDname                   02046000
         DC    H'&DDLEN'               Effective length of following    02047000
         DC    CL8'&DDNAME'            MSGFILE DDname                   02048000
         DC    CL2' '                  Unused                           02049000
*                                                                       02050000
RECFM    DS    0F                      Record format                    02051000
         DC    H'&RFMLEN'              Effective length of following    02052000
         DC    CL5'&RECFM'             Record format                    02053000
         DC    CL1' '                  Unused                           02054000
*                                                                       02055000
&SYSECT  LOCTR                                                          02056000
*                                                                       02057000
.********************************************************************** 02058000
*    NATLANG option                                                     02059000
.********************************************************************** 02060000
&FLAG    SETA  &ON                     Options flag initialized         02061000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 02062000
&NLNAME  SETC  'UEN'                   Default national language        02063000
&ALLOK   SETB  1                       Suboptions assumed error-free    02064000
         AIF   (&DOPT).NATD            Go to CEEDOPT processing         02065000
.*                                     CEEUOPT processing               02066000
         AIF   (N'&NATLANG EQ 0).NATGEN                                 02067000
         AIF   ('&NATLANG' EQ '()').NATGEN                              02068000
         AIF   (N'&NATLANG EQ 1).NATU1                                  02069000
         MNOTE 8,'Too many suboptions -- NATLANG marked invalid.'       02070000
         AGO   .NATGEN                                                  02071000
.*                                                                      02072000
.NATU1   ANOP                          Check sublist item length        02073000
         AIF   (K'&NATLANG(1) EQ 3).NATU2                               02074000
         MNOTE 8,'Language identifier must be 3 characters: NATLANG'    02075000
         MNOTE 8,'set to &NLNAME with valid bits off.'                  02076000
         AGO   .NATGEN                                                  02077000
.*                                                                      02078000
.NATU2   ANOP                          Check for valid NATLANG ID       02079000
&NATLIND SETA  1                       Initialize index for search      02080000
.*                                                                      02081000
.NATU3   ANOP                          Top of search loop               02082000
         AIF   (&NATLIND GT &NATLNUM).NATU4                             02083000
         AIF   ('&NATLANG(1)' EQ '&NATLLST(&NATLIND)').NATU5            02084000
&NATLIND SETA  &NATLIND+1              Increment index for search       02085000
         AGO   .NATU3                  Continue search                  02086000
.*                                                                      02087000
.NATU4   ANOP                          Indicate search failed           02088000
         MNOTE 4,'Warning: NATLANG code &NATLANG(1) is unknown.'        02089000
.*                                                                      02090000
.NATU5   ANOP                          Set valid bits and NATLANG       02091000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          02092000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       02093000
&NLNAME  SETC  '&NATLANG(1)'           NATLANG ID set to value passed   02094000
         AGO   .NATGEN                                                  02095000
.*                                                                      02096000
.NATD    ANOP                          CEEDOPT processing               02097000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          02098000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       02099000
         AIF   (N'&NATLANG EQ 2).NATD1                                  02100000
         MNOTE 8,'NATLANG requires 2 sublist items: it has been'        02101000
         MNOTE 8,'set to &NLNAME, overridable, with valid bits on.'     02102000
         AGO   .NATGEN                                                  02103000
.*                                                                      02104000
.NATD1   ANOP                          Check # 1st sublist items        02105000
         AIF   (N'&NATLANG(1) EQ 1).NATD2                               02106000
         MNOTE 8,'NATLANG(1) requires exactly 1 sublist item: NATLANG'  02107000
         MNOTE 8,'set to &NLNAME and overridable, with valid bits on.'  02108000
         AGO   .NATGEN                                                  02109000
.*                                                                      02110000
.NATD2   ANOP                          Check sublist item length        02111000
         AIF   (K'&NATLANG(1,1) EQ 3).NATD3                             02112000
         MNOTE 8,'Language identifier must be 3 characters:'            02113000
         MNOTE 8,'NATLANG has been set to default &NLNAME..'            02114000
&ALLOK   SETB  0                       Indicate error detected          02115000
         AGO   .NATD7                  Go check 2nd sublist item        02116000
.*                                                                      02117000
.NATD3   ANOP                          Check for valid NATLANG ID       02118000
&NATLIND SETA  1                       Initialize index for search      02119000
.*                                                                      02120000
.NATD4   ANOP                          Top of search loop               02121000
         AIF   (&NATLIND GT &NATLNUM).NATD5                             02122000
         AIF   ('&NATLANG(1,1)' EQ '&NATLLST(&NATLIND)').NATD6          02123000
&NATLIND SETA  &NATLIND+1              Increment index for search       02124000
         AGO   .NATD4                  Continue search                  02125000
.*                                                                      02126000
.NATD5   ANOP                          Indicate search failed           02127000
         MNOTE 4,'Warning: NATLANG code &NATLANG(1,1) is unknown.'      02128000
.*                                                                      02129000
.NATD6   ANOP                          Set ID                           02130000
&NLNAME  SETC  '&NATLANG(1,1)'         Set NATLANG ID                   02131000
.*                                                                      02132000
.NATD7   ANOP                          Check 2nd sublist item           02133000
         AIF   ('&NATLANG(2)' NE 'OVR' AND                             X02134000
               '&NATLANG(2)' NE 'NONOVR').NATD8                         02135000
         AIF   (NOT &ALLOK).NATD9      If errors, force overridable     02136000
         AIF   ('&NATLANG(2)' EQ 'OVR').NATGEN                          02137000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  02138000
         AGO   .NATGEN                                                  02139000
.*                                                                      02140000
.NATD8   ANOP                                                           02141000
         MNOTE 8,'Last NATLANG sublist item must be OVR or NONOVR.'     02142000
.*                                                                      02143000
.NATD9   ANOP                                                           02144000
         MNOTE 8,'Due to error(s) detected above, NATLANG has'          02145000
         MNOTE 8,'been set overridable (with valid bits on).'           02146000
.*                                                                      02147000
.NATGEN  ANOP                                                           02148000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 02149000
         DC    X'00'                   Unused                           02150000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   02151000
         DC    A(NAT_SUB-&SYSECT)      Offset of suboptions block       02152000
*                                                                       02153000
SUB      LOCTR                                                          02154000
NAT_SUB  DS    0F                      NATLANG suboptions block         02155000
         DC    AL1(&VALBITS)           Suboption valid bits             02156000
         DC    AL3(0)                  Unused suboption valid bits      02157000
         DC    CL3'&NLNAME'            NATLANG identifier               02158000
         DC    X'00'                   Unused                           02159000
*                                                                       02160000
&SYSECT  LOCTR                                                          02161000
*                                                                       02162000
.********************************************************************** 02163000
*    ERRUNIT option - Unsupported in this release of LE/VSE             02164000
.********************************************************************** 02165000
&FLAG    SETA  &ON+&DOPT               Options flag initialized         02166000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 02167000
&ERRUNUM SETC  '6'                     Error unit initialized           02168000
&ALLOK   SETB  1                       Suboptions assumed error-free    02169000
.*                                                                      02170000
.ERRUGEN ANOP                                                           02171000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 02172000
         DC    X'00'                   Unused                           02173000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   02174000
         DC    A(ERRU_SUB-&SYSECT)     Offset of suboptions block       02175000
*                                                                       02176000
SUB      LOCTR                                                          02177000
ERRU_SUB DS    0F                      ERRUNIT suboptions block         02178000
         DC    AL1(&VALBITS)           Suboption valid bits             02179000
         DC    AL3(0)                  Unused suboption valid bits      02180000
         DC    F'&ERRUNUM'             ERRUNIT # non-fatal errors       02181000
*                                                                       02182000
&SYSECT  LOCTR                                                          02183000
*                                                                       02184000
.********************************************************************** 02185000
*    OCSTATUS option - Unsupported in this release of LE/VSE            02186000
.********************************************************************** 02187000
.*       CEEXSIMP OCSTATUS,&OCSTATUS                                    02188000
         CEEXHARD &OFF                 Disable this option this release 02189000
.********************************************************************** 02190000
*    POSIX option - Unsupported in this release of LE/VSE               02191000
.********************************************************************** 02192000
.*       CEEXSIMP POSIX,&POSIX                                          02193000
         CEEXHARD &OFF                 Disable this option this release 02194000
.********************************************************************** 02195000
*    RPTSTG option                                                      02196000
.********************************************************************** 02197000
         CEEXSIMP RPTSTG,&RPTSTG                                        02198000
.********************************************************************** 02199000
*    RTEREUS option                                                     02200000
.********************************************************************** 02201000
         CEEXSIMP RTEREUS,&RTEREUS                                      02202000
.********************************************************************** 02203000
*    SIMVRD option - Unsupported in this release of LE/VSE              02204000
.********************************************************************** 02205000
.*       CEEXSIMP SIMVRD,&SIMVRD                                        02206000
         CEEXHARD &OFF                 Disable this option this release 02207000
.********************************************************************** 02208000
*    STACK option                                                       02209000
.********************************************************************** 02210000
&FLAG    SETA  &ON                     Options flag initialized         02211000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3+&BIT4)                           02212000
&INITSIZ SETC  '524288'                Default initial size 512K        02213000
&INCRSIZ SETC  '524288'                Default increment size 512K      02214000
&LOCDISP SETA  &ANYWHR+&KEEP           Default location, disposition    02215000
&SKTR4   SETA  &INITSIZ                Init rounded value 4K            02216000
&SKTR8   SETA  &INITSIZ                Init rounded value 8 byte        02217000
&SKRR4   SETA  &INCRSIZ                Incr rounded value 4K            02218000
&SKRR8   SETA  &INCRSIZ                Incr rounded value 8 byte        02219000
&ALLOK   SETB  1                       Suboptions assumed error-free    02220000
         AIF   (&DOPT).STKD            Go to CEEDOPT processing         02221000
.*                                     CEEUOPT processing               02222000
         AIF   (N'&STACK EQ 0).STKGEN  Go set defaults, mark invalid    02223000
         AIF   ('&STACK' EQ '()').STKGEN                                02224000
         AIF   (N'&STACK LE 4).STKU1                                    02225000
         MNOTE 8,'Too many suboptions -- STACK marked invalid.'         02226000
         AGO   .STKGEN                                                  02227000
.*                                                                      02228000
.STKU1   ANOP                          Initial size processing          02229000
         AIF   ('&STACK(1)' EQ '').STKU3 If null, work on incr size     02230000
         CEEXCALC &STACK(1)            Obtain &VALUE and &CALCOK        02231000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            02232000
         AIF   (&CALCOK).STKU2         If CEEXCALC OK, suboption valid  02233000
&ALLOK   SETB  0                       Indicate option invalid          02234000
         AGO   .STKU3                  Go to incr size processing       02235000
.*                                                                      02236000
.STKU2   ANOP                          Set 1st suboption valid bit on   02237000
&VALBITS SETA  &VALBITS+&BIT1                                           02238000
         AIF   ('&VALUE'(1,1) EQ '-').STKU3                             02239000
&SKTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             02240000
&SKTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             02241000
.*                                                                      02242000
.STKU3   ANOP                          Increment size processing        02243000
         AIF   ('&STACK(2)' EQ '').STKU6 If null, work on location      02244000
&TEMPSTR SETC  '&STACK(2)'             Obtain increment size suboption  02245000
         AIF   ('&TEMPSTR'(1,1) NE '-').STKU4                           02246000
         MNOTE 8,'STACK increment size may not have a minus sign:'      02247000
         MNOTE 8,'it has been set to &INCRSIZ and marked invalid.'      02248000
&ALLOK   SETB  0                       Indicate option invalid          02249000
         AGO   .STKU6                  Go to location processing        02250000
.*                                                                      02251000
.STKU4   ANOP                                                           02252000
         CEEXCALC &STACK(2)            Obtain &VALUE and &CALCOK        02253000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            02254000
         AIF   (&CALCOK).STKU5         If CEEXCALC OK, suboption valid  02255000
&ALLOK   SETB  0                       Indicate option invalid          02256000
         AGO   .STKU6                  Go to location processing        02257000
.*                                                                      02258000
.STKU5   ANOP                                                           02259000
&VALBITS SETA  &VALBITS+&BIT2          Set 2nd suboption valid bit on   02260000
&SKRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             02261000
&SKRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             02262000
.*                                                                      02263000
.STKU6   ANOP                          Location processing              02264000
&LOCDISP SETA  &ANYWHR                 Set location default             02265000
         AIF   ('&STACK(3)' EQ '').STKU9 If null, work on disposition   02266000
         AIF   ('&STACK(3)' EQ 'BELOW').STKU7                           02267000
         AIF   ('&STACK(3)' EQ 'ANYWHERE' OR                           X02268000
               '&STACK(3)' EQ 'ANY').STKU8                              02269000
         MNOTE 8,'STACK location unrecognized -- it has'                02270000
         MNOTE 8,'been set to ANYWHERE and marked invalid.'             02271000
&ALLOK   SETB  0                       Indicate option invalid          02272000
         AGO   .STKU9                  Go to disposition processing     02273000
.*                                                                      02274000
.STKU7   ANOP                          Set location to below            02275000
&LOCDISP SETA  &BELOW                                                   02276000
.*                                                                      02277000
.STKU8   ANOP                          Set 3rd suboption valid bit on   02278000
&VALBITS SETA  &VALBITS+&BIT3                                                   
.STKU9   ANOP                          Disposition processing           02281000
         AIF   ('&STACK(4)' NE 'FREE').STKU10                           02282000
&LOCDISP SETA  &LOCDISP+&FREE          Indicate disposition is FREE     02283000
         AGO   .STKU11                 Go mark suboption valid          02284000
.*                                                                      02285000
.STKU10  ANOP                          Set disposition to default KEEP  02286000
&LOCDISP SETA  &LOCDISP+&KEEP                                           02287000
         AIF   ('&STACK(4)' EQ 'KEEP').STKU11                           02288000
         AIF   ('&STACK(4)' EQ '').STKU12 Avoid setting suboption valid 02289000
         MNOTE 8,'STACK disposition unrecognized -- it has'             02290000
         MNOTE 8,'been set to KEEP and marked invalid.'                 02291000
&ALLOK   SETB  0                       Indicate option invalid          02292000
         AGO   .STKU12                 Go examine STACK validity        02293000
.*                                                                      02294000
.STKU11  ANOP                          Set 4th suboption valid bit on   02295000
&VALBITS SETA  &VALBITS+&BIT4                                           02296000
.*                                                                      02297000
.STKU12  ANOP                          Determine if STACK option valid  02298000
         AIF   (NOT &ALLOK).STKU13     If suboption error, need msg     02299000
         AIF   (&VALBITS EQ &OFF).STKGEN If off, all suboptions null    02300000
&FLAG    SETA  &FLAG+&VALID            No errors, not all subopts null  02301000
         AGO   .STKGEN                                                  02302000
.*                                                                      02303000
.STKU13  ANOP                                                           02304000
         MNOTE 8,'STACK option marked invalid due to above error(s).'   02305000
         AGO   .STKGEN                                                  02306000
.*                                                                      02307000
.STKD    ANOP                          CEEDOPT processing               02308000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          02309000
&VALBITS SETA  &BIT1+&BIT2+&BIT3+&BIT4 Suboption valid bits set on      02310000
         AIF   (N'&STACK EQ 2).STKD1                                    02311000
         MNOTE 8,'STACK requires 2 sublist items: it has been set to'   02312000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 02313000
         AGO   .STKGEN                                                  02314000
.*                                                                      02315000
.STKD1   ANOP                          Check # 1st sublist items        02316000
         AIF   (N'&STACK(1) EQ 4).STKD2                                 02317000
         MNOTE 8,'STACK(1) requires 4 suboptions: it has been set to'   02318000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 02319000
         AGO   .STKGEN                                                  02320000
.*                                                                      02321000
.STKD2   ANOP                          Initial size processing          02322000
         AIF   ('&STACK(1,1)' NE '').STKD3                              02323000
         MNOTE 8,'STACK must specify an initial size:'                  02324000
         MNOTE 8,'it has been set to &INITSIZ..'                        02325000
&ALLOK   SETB  0                       Indicate error detected          02326000
         AGO   .STKD4                  Go to increment size processing  02327000
.*                                                                      02328000
.STKD3   ANOP                                                           02329000
         CEEXCALC &STACK(1,1)          Obtain &VALUE and &CALCOK        02330000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            02331000
         AIF   (&CALCOK).STKD3M                                         02332000
&ALLOK   SETB  0                       Indicate error detected          02333000
         AGO   .STKD4                                                   02334000
.STKD3M  ANOP                                                           02335000
         AIF   ('&VALUE'(1,1) EQ '-').STKD4                             02336000
&SKTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             02337000
&SKTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             02338000
.*                                                                      02339000
.STKD4   ANOP                          Increment size processing        02340000
         AIF   ('&STACK(1,2)' NE '').STKD5                              02341000
         MNOTE 8,'STACK must specify an increment size:'                02342000
         MNOTE 8,'it has been set to &INCRSIZ..'                        02343000
&ALLOK   SETB  0                       Indicate error detected          02344000
         AGO   .STKD7                  Go to location processing        02345000
.*                                                                      02346000
.STKD5   ANOP                          Disallow leading minus sign      02347000
&TEMPSTR SETC  '&STACK(1,2)'           Obtain increment size suboption  02348000
         AIF   ('&TEMPSTR'(1,1) NE '-').STKD6                           02349000
         MNOTE 8,'STACK increment size may not begin with'              02350000
         MNOTE 8,'a minus sign.  It has been set to &INCRSIZ..'         02351000
&ALLOK   SETB  0                       Indicate error detected          02352000
         AGO   .STKD7                  Go to location processing        02353000
.*                                                                      02354000
.STKD6   ANOP                                                           02355000
         CEEXCALC &STACK(1,2)          Obtain &VALUE and &CALCOK        02356000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            02357000
         AIF   (&CALCOK).STKD6M                                         02358000
&ALLOK   SETB  0                       Indicate error detected          02359000
         AGO   .STKD7                                                   02360000
.STKD6M  ANOP                                                           02361000
&SKRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             02362000
&SKRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             02363000
.*                                                                      02364000
.STKD7   ANOP                          Location processing              02365000
&LOCDISP SETA  &ANYWHR                 Set location default             02366000
         AIF   ('&STACK(1,3)' NE '').STKD8                              02367000
         MNOTE 8,'STACK must specify a location:'                       02368000
         MNOTE 8,'it has been set to ANYWHERE.'                         02369000
&ALLOK   SETB  0                       Indicate error detected          02370000
         AGO   .STKD10                 Go to disposition processing     02371000
.*                                                                      02372000
.STKD8   ANOP                                                           02373000
         AIF   ('&STACK(1,3)' EQ 'BELOW').STKD9                         02374000
         AIF   ('&STACK(1,3)' EQ 'ANYWHERE' OR                         X02375000
               '&STACK(1,3)' EQ 'ANY').STKD10                           02376000
         MNOTE 8,'STACK location unrecognized:'                         02377000
         MNOTE 8,'it has been set to ANYWHERE.'                         02378000
&ALLOK   SETB  0                       Indicate error detected          02379000
         AGO   .STKD10                 Go to disposition processing     02380000
.*                                                                      02381000
.STKD9   ANOP                          Set location to below            02382000
&LOCDISP SETA  &BELOW                                                   02383000
.*                                                                      02384000
.STKD10  ANOP                          Disposition processing           02385000
         AIF   ('&STACK(1,4)' NE 'FREE').STKD11                         02386000
&LOCDISP SETA  &LOCDISP+&FREE          Indicate disposition is FREE     02387000
         AGO   .STKD13                 Go check 2nd sublist item        02388000
.*                                                                      02389000
.STKD11  ANOP                          Set disposition to default KEEP  02390000
&LOCDISP SETA  &LOCDISP+&KEEP                                           02391000
         AIF   ('&STACK(1,4)' NE '').STKD12                             02392000
         MNOTE 8,'STACK must specify a disposition:'                    02393000
         MNOTE 8,'it has been set to KEEP.'                             02394000
&ALLOK   SETB  0                       Indicate error detected          02395000
         AGO   .STKD13                 Go check 2nd sublist item        02396000
.*                                                                      02397000
.STKD12  ANOP                                                           02398000
         AIF   ('&STACK(1,4)' EQ 'KEEP').STKD13                         02399000
         MNOTE 8,'STACK disposition unrecognized:'                      02400000
         MNOTE 8,'it has been set to KEEP.'                             02401000
&ALLOK   SETB  0                       Indicate error detected          02402000
.*                                                                      02403000
.STKD13  ANOP                          Check 2nd sublist item           02404000
         AIF   ('&STACK(2)' NE 'OVR' AND                               X02405000
               '&STACK(2)' NE 'NONOVR').STKD14                          02406000
         AIF   (NOT &ALLOK).STKD15     If errors, force overridable     02407000
         AIF   ('&STACK(2)' EQ 'OVR').STKGEN                            02408000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  02409000
         AGO   .STKGEN                                                  02410000
.*                                                                      02411000
.STKD14  ANOP                                                           02412000
         MNOTE 8,'Last STACK sublist item must be OVR or NONOVR.'       02413000
.*                                                                      02414000
.STKD15  ANOP                                                           02415000
         MNOTE 8,'Due to error(s) detected above, STACK has'            02416000
         MNOTE 8,'been set overridable (with valid bits on).'           02417000
.*                                                                      02418000
.STKGEN  ANOP                                                           02419000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 02420000
         DC    X'00'                   Unused                           02421000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   02422000
         DC    A(STK_SUB-&SYSECT)      Offset of suboptions block       02423000
*                                                                       02424000
SUB      LOCTR                                                          02425000
STK_SUB  DS    0F                      STACK suboptions block           02426000
         DC    AL1(&VALBITS)           Suboption valid bits             02427000
         DC    AL3(0)                  Unused suboption valid bits      02428000
         DC    F'&INITSIZ'             STACK initial size               02429000
         DC    F'&INCRSIZ'             STACK increment size             02430000
         DC    AL1(&LOCDISP)           128 = BELOW, 64 = FREE           02431000
         DC    3X'00'                  Unused                           02432000
*                                                                       02433000
&SYSECT  LOCTR                                                          02434000
*                                                                       02435000
.********************************************************************** 02436000
*    STORAGE option                                                     02437000
.********************************************************************** 02438000
&FLAG    SETA  &ON                     Options flag initialized         02439000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3+&BIT4)                           02440000
&SETBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3)                                 02441000
&HPALLC  SETC  'X''00'''               Default heap alloc character     02442000
&HPFREE  SETC  'X''00'''               Default heap free  character     02443000
&DSALLC  SETC  'X''00'''               Default DSA  alloc character     02444000
&RSRVSIZ SETC  '8192'                  Default short storage reserve    02445000
&SRR4    SETA  &RSRVSIZ                reserve value rounded 4K         02446000
&SRR8    SETA  &RSRVSIZ                reserve value rounded 8 bytes    02447000
&ALLOK   SETB  1                       Suboptions assumed error-free    02448000
         AIF   (&DOPT).STOD            Go to CEEDOPT processing         02449000
.*                                     CEEUOPT processing               02450000
         AIF   (N'&STORAGE EQ 0).STOGEN Go set defaults, mark invalid   02451000
         AIF   ('&STORAGE' EQ '()').STOGEN                              02452000
         AIF   (N'&STORAGE LE 4).STOU1                                  02453000
         MNOTE 8,'Too many suboptions -- STORAGE marked invalid.'       02454000
         AGO   .STOGEN                                                  02455000
.*                                                                      02456000
.STOU1   ANOP                          Heap allocation value processing 02457000
         AIF   ('&STORAGE(1)' EQ '').STOU3 If null, work on heap free   02458000
         CEEXSTCH &STORAGE(1),1        Get &STORVAL, &STCHOK, &SETBITS  02459000
&HPALLC  SETC  '&STORVAL'              Use CEEXSTCH's result            02460000
         AIF   (&STCHOK).STOU2         If CEEXSTCH OK, suboption valid  02461000
&ALLOK   SETB  0                       Indicate option invalid          02462000
         AGO   .STOU3                  Go to heap free value processing 02463000
.*                                                                      02464000
.STOU2   ANOP                          Set 1st suboption valid bit on   02465000
&VALBITS SETA  &VALBITS+&BIT1                                           02466000
.*                                                                      02467000
.STOU3   ANOP                          Heap free value processing       02468000
         AIF   ('&STORAGE(2)' EQ '').STOU5 If null, work on DSA alloc   02469000
         CEEXSTCH &STORAGE(2),2        Get &STORVAL, &STCHOK, &SETBITS  02470000
&HPFREE  SETC  '&STORVAL'              Use CEEXSTCH's result            02471000
         AIF   (&STCHOK).STOU4         If CEEXSTCH OK, suboption valid  02472000
&ALLOK   SETB  0                       Indicate option invalid          02473000
         AGO   .STOU5                  Go to DSA alloc value processing 02474000
.*                                                                      02475000
.STOU4   ANOP                                                           02476000
&VALBITS SETA  &VALBITS+&BIT2          Set 2nd suboption valid bit on   02477000
.*                                                                      02478000
.STOU5   ANOP                          DSA allocation value processing  02479000
         AIF   ('&STORAGE(3)' EQ '').STOU7 If null, work on rsrv size   02480000
         CEEXSTCH &STORAGE(3),3        Get &STORVAL, &STCHOK, &SETBITS  02481000
&DSALLC  SETC  '&STORVAL'              Use CEEXSTCH's result            02482000
         AIF   (&STCHOK).STOU6         If CEEXSTCH OK, suboption valid  02483000
&ALLOK   SETB  0                       Indicate option invalid          02484000
         AGO   .STOU7                  Go to reserve size processing    02485000
.*                                                                      02486000
.STOU6   ANOP                          Set 3rd suboption valid bit on   02487000
&VALBITS SETA  &VALBITS+&BIT3                                           02488000
.*                                                                      02489000
.STOU7   ANOP                          Reserve size processing          02490000
         AIF   ('&STORAGE(4)' EQ '').STOU10 Avoid setting subopt valid  02491000
&TEMPSTR SETC  '&STORAGE(4)'           Obtain reserve size suboption    02492000
         AIF   ('&TEMPSTR'(1,1) NE '-').STOU8                           02493000
         MNOTE 8,'STORAGE reserve size may not have a minus sign:'      02494000
         MNOTE 8,'it has been set to &RSRVSIZ and marked invalid.'      02495000
&ALLOK   SETB  0                       Indicate option invalid          02496000
         AGO   .STOU10                 Go examine STORAGE validity      02497000
.*                                                                      02498000
.STOU8   ANOP                                                           02499000
         CEEXCALC &STORAGE(4)          Obtain &VALUE and &CALCOK        02500000
&RSRVSIZ SETC  '&VALUE'                Use CEEXCALC's result            02501000
         AIF   (&CALCOK).STOU9         If CEEXCALC OK, suboption valid  02502000
&ALLOK   SETB  0                       Indicate option invalid          02503000
         AGO   .STOU10                 Go examine STORAGE validity      02504000
.*                                                                      02505000
.STOU9   ANOP                          Set 4th suboption valid bit on   02506000
&VALBITS SETA  &VALBITS+&BIT4                                           02507000
&SRR4    SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             02508000
&SRR8    SETA  ((&VALUE+7)/8)*8          Calc rounded value             02509000
.*                                                                      02510000
.STOU10  ANOP                          Determine if STORAGE valid       02511000
         AIF   (NOT &ALLOK).STOU11     If suboption error, need msg     02512000
         AIF   (&VALBITS EQ &OFF).STOGEN If off, all suboptions null    02513000
&FLAG    SETA  &FLAG+&VALID            No errors, not all subopts null  02514000
         AGO   .STOGEN                                                  02515000
.*                                                                      02516000
.STOU11  ANOP                                                           02517000
         MNOTE 8,'STORAGE option marked invalid due to above error(s).' 02518000
         AGO   .STOGEN                                                  02519000
.*                                                                      02520000
.STOD    ANOP                          CEEDOPT processing               02521000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          02522000
&VALBITS SETA  &BIT1+&BIT2+&BIT3+&BIT4 Suboption valid bits set on      02523000
         AIF   (N'&STORAGE EQ 2).STOD1                                  02524000
         MNOTE 8,'STORAGE requires 2 sublist items: it has been set to' 02525000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 02526000
         AGO   .STOGEN                                                  02527000
.*                                                                      02528000
.STOD1   ANOP                          Check # 1st sublist items        02529000
         AIF   (N'&STORAGE(1) EQ 4).STOD2                               02530000
         MNOTE 8,'STORAGE(1) requires 4 suboptions: it has been set to' 02531000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 02532000
         AGO   .STOGEN                                                  02533000
.*                                                                      02534000
.STOD2   ANOP                          Heap allocation value processing 02535000
         AIF   ('&STORAGE(1,1)' NE '').STOD3                            02536000
         MNOTE 8,'STORAGE must specify a heap allocation value:'        02537000
         MNOTE 8,'it has been set to X''00''.'                          02538000
&ALLOK   SETB  0                       Indicate error detected          02539000
         AGO   .STOD4                  Go to heap free value processing 02540000
.*                                                                      02541000
.STOD3   ANOP                                                           02542000
         CEEXSTCH &STORAGE(1,1),1      Get &STORVAL, &STCHOK, &SETBITS  02543000
&HPALLC  SETC  '&STORVAL'              Use CEEXSTCH's result            02544000
         AIF   (&STCHOK).STOD4                                          02545000
&ALLOK   SETB  0                       Indicate error detected          02546000
.*                                                                      02547000
.STOD4   ANOP                          Heap free value processing       02548000
         AIF   ('&STORAGE(1,2)' NE '').STOD5                            02549000
         MNOTE 8,'STORAGE must specify a heap free value:'              02550000
         MNOTE 8,'it has been set to X''00''.'                          02551000
&ALLOK   SETB  0                       Indicate error detected          02552000
         AGO   .STOD6                  Go to DSA alloc value processing 02553000
.*                                                                      02554000
.STOD5   ANOP                                                           02555000
         CEEXSTCH &STORAGE(1,2),2      Get &STORVAL, &STCHOK, &SETBITS  02556000
&HPFREE  SETC  '&STORVAL'              Use CEEXSTCH's result            02557000
         AIF   (&STCHOK).STOD6                                          02558000
&ALLOK   SETB  0                       Indicate error detected          02559000
.*                                                                      02560000
.STOD6   ANOP                          DSA allocation value processing  02561000
         AIF   ('&STORAGE(1,3)' NE '').STOD7                            02562000
         MNOTE 8,'STORAGE must specify a DSA allocation value:'         02563000
         MNOTE 8,'it has been set to X''00''.'                          02564000
&ALLOK   SETB  0                       Indicate error detected          02565000
         AGO   .STOD8                  Go to reserve size processing    02566000
.*                                                                      02567000
.STOD7   ANOP                                                           02568000
         CEEXSTCH &STORAGE(1,3),3      Get &STORVAL, &STCHOK, &SETBITS  02569000
&DSALLC  SETC  '&STORVAL'              Use CEEXSTCH's result            02570000
         AIF   (&STCHOK).STOD8                                          02571000
&ALLOK   SETB  0                       Indicate error detected          02572000
.*                                                                      02573000
.STOD8   ANOP                          Reserve size processing          02574000
         AIF   ('&STORAGE(1,4)' NE '').STOD9                            02575000
         MNOTE 8,'STORAGE must specify a reserve size:'                 02576000
         MNOTE 8,'it has been set to &RSRVSIZ..'                        02577000
&ALLOK   SETB  0                       Indicate error detected          02578000
         AGO   .STOD11                 Go check 2nd sublist item        02579000
.*                                                                      02580000
.STOD9   ANOP                          Disallow leading minus sign      02581000
&TEMPSTR SETC  '&STORAGE(1,4)'         Obtain reserve size suboption    02582000
         AIF   ('&TEMPSTR'(1,1) NE '-').STOD10                          02583000
         MNOTE 8,'STORAGE reserve size may not begin with'              02584000
         MNOTE 8,'a minus sign.  It has been set to &RSRVSIZ..'         02585000
&ALLOK   SETB  0                       Indicate error detected          02586000
         AGO   .STOD11                 Go check 2nd sublist item        02587000
.*                                                                      02588000
.STOD10  ANOP                                                           02589000
         CEEXCALC &STORAGE(1,4)        Obtain &VALUE and &CALCOK        02590000
&RSRVSIZ SETC  '&VALUE'                Use CEEXCALC's result            02591000
         AIF   (&CALCOK).STOD10M                                        02592000
&ALLOK   SETB  0                       Indicate error detected          02593000
         AGO   .STOD11                                                  02594000
.STOD10M ANOP                                                           02595000
&SRR4    SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             02596000
&SRR8    SETA  ((&VALUE+7)/8)*8          Calc rounded value             02597000
.*                                                                      02598000
.STOD11  ANOP                          Check 2nd sublist item           02599000
         AIF   ('&STORAGE(2)' NE 'OVR' AND                             X02600000
               '&STORAGE(2)' NE 'NONOVR').STOD12                        02601000
         AIF   (NOT &ALLOK).STOD13     If errors, force overridable     02602000
         AIF   ('&STORAGE(2)' EQ 'OVR').STOGEN                          02603000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  02604000
         AGO   .STOGEN                                                  02605000
.*                                                                      02606000
.STOD12  ANOP                                                           02607000
         MNOTE 8,'Last STORAGE sublist item must be OVR or NONOVR.'     02608000
.*                                                                      02609000
.STOD13  ANOP                                                           02610000
         MNOTE 8,'Due to error(s) detected above, STORAGE has'          02611000
         MNOTE 8,'been set overridable (with valid bits on).'           02612000
.*                                                                      02613000
.STOGEN  ANOP                                                           02614000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 02615000
         DC    X'00'                   Unused                           02616000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   02617000
         DC    A(STO_SUB-&SYSECT)      Offset of suboptions block       02618000
*                                                                       02619000
SUB      LOCTR                                                          02620000
STO_SUB  DS    0F                      STORAGE suboptions block         02621000
         DC    AL1(&VALBITS)           Suboption valid bits             02622000
         DC    AL3(0)                  Unused suboption valid bits      02623000
         DC    AL1(&SETBITS)           Characters-specified flags       02624000
         DC    &HPALLC                 Allocated heap storage character 02625000
         DC    &HPFREE                 Freed heap storage character     02626000
         DC    &DSALLC                 Allocated DSA storage character  02627000
         DC    F'&RSRVSIZ'             Short on storage reserve size    02628000
*                                                                       02629000
&SYSECT  LOCTR                                                          02630000
*                                                                       02631000
.********************************************************************** 02632000
*    AUTOTASK option - Unsupported in this release of LE/VSE            02633000
.********************************************************************** 02634000
&FLAG    SETA  &OFF+&DOPT              Options flag off (assume NOAUTO) 02635000
&VALBITS SETA  &OFF*(&BIT1+&BIT2)                                       02636000
&LOADMOD SETC  ' '                     Default is NOAUTOTASK            02637000
&LMODLEN SETC  '0'                     Default is NOAUTOTASK            02638000
&TASKNUM SETC  '0'                     Default is NOAUTOTASK            02639000
&ALLOK   SETB  1                       Suboptions assumed error-free    02640000
.*                                                                      02641000
.AUTOGEN ANOP                                                           02642000
         DC    AL1(&FLAG)              128 = ON, 1 = valid              02643000
         DC    X'00'                   Unused                           02644000
         DC    H'&WHSET'               100 = set in DOPT, 200 = in UOPT 02645000
         DC    A(AUTO_SUB-&SYSECT)     Offset of suboptions block       02646000
*                                                                       02647000
SUB      LOCTR                                                          02648000
AUTO_SUB DS    0F                      AUTOTASK suboptions block        02649000
         DC    AL1(&VALBITS)           Suboption valid bits             02650000
         DC    AL3(0)                  Unused suboption valid bits      02651000
         DC    A(LOADMOD-&SYSECT)      Offset of load module name       02652000
         DC    F'&TASKNUM'             Number of subtasks               02653000
*                                                                       02654000
LOADMOD  DS    0F                      AUTOTASK load module             02655000
         DC    H'&LMODLEN'             Effective length of following    02656000
         DC    CL8'&LOADMOD'           Name of load module              02657000
         DC    CL2' '                  Unused                           02658000
*                                                                       02659000
&SYSECT  LOCTR                                                          02660000
*                                                                       02661000
.********************************************************************** 02662000
*    TRACE option                                                       02663000
.*                                                                      02664000
.* Format:                                                              02665000
.*  TRACE(ON , size ,DUMP   ,LE=n     <- External parameters     02666000
.*        OFF            NODUMP                                         02667000
.*                                                                      02668000
.* Where:                                                               02669000
.*        n - is a hexadecimal number (in the range 0 to 'FFFFFFFF'x)   02670000
.*            expressed as a series of from 1 to 8 EBCDIC characters    02671000
.*            (in the range 0 - 9, A - F)                               02672000
.*                                                                      02673000
.* The first three parameters are positional, the remaining parameters  02674000
.* are optional and may appear in any order.                            02675000
.*                                                                      02676000
.* Note: At this time only the external parameters can be specified     02677000
.*       in CEEDOPT, CEECOPT, CEEUOPT.  So no processing will be        02678000
.*       performed on the other parameters except to set there defaults 02679000
.********************************************************************** 02680000
&FLAG    SETA  &OFF                    Options flag initialized         02681000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3)                                 02682000
&INITSIZ SETC  '4096'                  Default trace buffer size 4K     02683000
&TRCFLG1 SETA  &ON                     Init trace flags                 02684000
&TRCLVL1 SETA  &BIT2+&BIT4             Init trace level verify flags    02685000
&TRCLVL2 SETA  &BIT1+&BIT5             Init trace level verify flags    02686000
&TRCLVL3 SETA  &OFF                    Init trace level verify flags    02687000
&TRCLVL4 SETA  &OFF                    Init trace level verify flags    02688000
&TRCGBL  SETC  '00'                    Init global level bits           02689000
&TRCCEL  SETC  '700'                   Init CEL level bits              02690000
&TRCC370 SETC  '00'                    Init C/370 level bits            02691000
&TRCDCE  SETC  '00'                    Init DCE level bits              02692000
&TRCSOCK SETC  '00'                    Init Sockets level bits          02693000
.*                                                                      02694000
         AIF   (&DOPT).TRCD            Go to CEEDOPT processing         02695000
.*                                                                      02696000
.* -----------------------------------------------------------------    02697000
.*     CEEUOPT processing                                               02698000
.* -----------------------------------------------------------------    02699000
         AIF   (N'&TRACE EQ 0).TRCGEN                                   02700000
         AIF   ('&TRACE' EQ '()').TRCGEN                                02701000
         AIF   (N'&TRACE LE 4).TRCU1                                    02702000
         MNOTE 8,'Too many suboptions -- TRACE marked invalid.'         02703000
         AGO   .TRCGEN                                                  02704000
.*                                                                      02705000
.*                                   *------------------------------    02706000
.*                                   * Process ON | OFF parameter       02707000
.*                                   *------------------------------    02708000
.TRCU1   ANOP                          Check ON|OFF                     02709000
         AIF   ('&TRACE(1)' EQ '').TRCU4 If null, work on table size    02710000
         AIF   ('&TRACE(1)' EQ 'ON').TRCU2                              02711000
         AIF   ('&TRACE(1)' EQ 'OFF').TRCU3                             02712000
         MNOTE 8,'TRACE was not set ON or OFF:'                         02713000
         MNOTE 8,'it has been set to OFF.'                              02714000
&ALLOK   SETB  0                       Indicate error detected          02715000
         AGO   .TRCU13                 Go examine TRACE validity        02716000
.*                                                                      02717000
.TRCU2   ANOP                          Set trace ON                     02718000
&FLAG    SETA  &ON+&VALID              Set valid bit on                 02719000
         AGO   .TRCU4                  Go check trace table size        02720000
.*                                                                      02721000
.TRCU3   ANOP                          Set trace OFF                    02722000
&FLAG    SETA  &OFF+&VALID             Set valid bit on                 02723000
         AGO   .TRCU4                  Go check trace table size        02724000
.*                                                                      02725000
.*                                   *------------------------------    02726000
.*                                   * Process trace table size         02727000
.*                                   *------------------------------    02728000
.TRCU4   ANOP                          Check trace table size           02729000
         AIF   ('&TRACE(2)' EQ '').TRCU7 If null, work on (no)dump      02730000
&TEMPSTR SETC  '&TRACE(2)'           Obtain trace table size            02731000
         AIF   ('&TEMPSTR'(1,1) NE '-').TRCU5                           02732000
         MNOTE 8,'TRACE table size may not begin with a minus sign:'    02733000
         MNOTE 8,'it has been set to &INITSIZ and marked invalid.'      02734000
&ALLOK   SETB  0                       Indicate error detected          02735000
         AGO   .TRCU7                  Go to (no)dump processing        02736000
.*                                                                      02737000
.TRCU5   ANOP                                                           02738000
         CEEXCALC &TRACE(2)            Obtain &VALUE and &CALCOK        02739000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            02740000
         AIF   (&CALCOK).TRCU6         If CEEXCALC OK, suboption valid  02741000
&ALLOK   SETB  0                       Indicate error detected          02742000
         AGO   .TRCU7                  Go to (no)dump processing        02743000
.*                                                                      02744000
.TRCU6   ANOP                          Set tbl sz subopt valid bit on   02745000
&VALBITS SETA  &VALBITS+&BIT1                                           02746000
.*                                                                      02747000
.*                                   *--------------------------------- 02748000
.*                                   * Process DUMP | NODUMP parameters 02749000
.*                                   *--------------------------------- 02750000
.TRCU7   ANOP                                                           02751000
         AIF   ('&TRACE(3)' EQ '').TRCU10 Go to LE=n processing         02752000
         AIF   ('&TRACE(3)' EQ 'DUMP').TRCU8                            02753000
         AIF   ('&TRACE(3)' EQ 'NODUMP').TRCU9                          02754000
         MNOTE 8,'TRACE sub-option 3 must be DUMP or NODUMP:'           02755000
         MNOTE 8,'it has been set to DUMP and marked invalid.'          02756000
&ALLOK   SETB  0                       Indicate error detected          02757000
         AGO   .TRCU10                 Go to LE=n processing            02758000
.*                                                                      02759000
.TRCU8   ANOP                          Set DUMP                         02760000
&VALBITS SETA  &VALBITS+&BIT3          Set (no)dump subopt val bit on   02761000
&TRCFLG1 SETA  &ON                     Set dump on                      02762000
         AGO   .TRCU10                 Go to LE=n processing            02763000
.*                                                                      02764000
.TRCU9   ANOP                          Set NODUMP                       02765000
&VALBITS SETA  &VALBITS+&BIT3          Set (no)dump subopt val bit on   02766000
&TRCFLG1 SETA  &OFF                    Set dump off                     02767000
.*                                                                      02768000
.*                                   *------------------------------    02769000
.*                                   * Process LE=n parameter           02770000
.*                                   *------------------------------    02771000
.TRCU10  ANOP                          Go examine TRACE validity        02772000
         AIF   ('&TRACE(4)' EQ '').TRCU13                               02773000
         CEEXSTRI &TRACE(4),11,TRACE_string                             02774000
         AIF   (&STRIOK AND '&STRING'(1,3) EQ 'LE=' AND                X02775000
                &STRLEN GT 3).TRCU11   Go to get level                  02776000
         MNOTE 8,'TRACE sub-option 4 if specified may only be LE=n:'    02777000
         MNOTE 8,'it has been set to LE=&TRCGBL and marked invalid.'    02778000
&ALLOK   SETB  0                       Indicate error detected          02779000
         AGO   .TRCU13                 Go examine TRACE validity        02780000
.*                                                                      02781000
.TRCU11  ANOP                          Get LE level                     02782000
&TEMPSTR SETC  ''                                                       02783000
&COUNTER SETA  4                       Start parsing after = sign       02784000
.TRCULP  ANOP                          Loop                             02785000
         AIF (&STRLEN LT &COUNTER).ENDULP                               02786000
&TEMPSTR SETC  '&TEMPSTR'.'&STRING'(&COUNTER,1)                         02787000
&COUNTER SETA  &COUNTER+1                                               02788000
         AGO   .TRCULP                                                  02789000
.ENDULP  ANOP                                                           02790000
&TEMPVAL SETA  &STRLEN-3               Length of LE level               02791000
         CEEXNUMB &TEMPSTR,H,&TEMPVAL  Valid hex digits?                02792000
         AIF   (&NUMBOK).TRCU12                                         02793000
         MNOTE 8,'TRACE sub-option 4 contains invalid hex digit(s):'    02794000
         MNOTE 8,'it has been set to &TRCGBL and marked invalid.'       02795000
&ALLOK   SETB  0                       Indicate error detected          02796000
         AGO   .TRCU13                 Go examine TRACE validity        02797000
.*                                                                      02798000
.TRCU12  ANOP                                                           02799000
&VALBITS SETA  &VALBITS+&BIT2          Set global valid bit on          02800000
&TRCGBL  SETC  '&TEMPSTR'              Set global level                 02801000
.*                                                                      02802000
.TRCU13  ANOP                          Determine TRACE is valid         02803000
         AIF   (NOT &ALLOK).TRCU14     If suboption error, need msg     02804000
         AGO   .TRCGEN                                                  02805000
.*                                                                      02806000
.TRCU14  ANOP                                                           02807000
         MNOTE 8,'TRACE valid bit and suboption valid bits set to'      02808000
         MNOTE 8,'reflect the errors detected above.'                   02809000
         AGO   .TRCGEN                                                  02810000
.*                                                                      02811000
.* -----------------------------------------------------------------    02812000
.*     CEEDOPT processing                                               02813000
.* -----------------------------------------------------------------    02814000
.TRCD    ANOP                          CEEDOPT processing               02815000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          02816000
&VALBITS SETA  &BIT1+&BIT2+&BIT3       Suboption valid bits set on      02817000
         AIF   (N'&TRACE EQ 2).TRCD1                                    02818000
         MNOTE 8,'TRACE requires 2 sublist items: it has been set'      02819000
         MNOTE 8,'to defaults, and marked overridable and valid.'       02820000
         AGO   .TRCGEN                                                  02821000
.*                                                                      02822000
.TRCD1   ANOP                          Check # 1st sublist items        02823000
         AIF   (N'&TRACE(1) EQ 4).TRCD2                                 02824000
         MNOTE 8,'TRACE(1) requires 4 suboptions: it has been set'      02825000
         MNOTE 8,'to defaults, and marked overridable and valid.'       02826000
         AGO   .TRCGEN                                                  02827000
.*                                                                      02828000
.*                                   *------------------------------    02829000
.*                                   * Process ON | OFF parameter       02830000
.*                                   *------------------------------    02831000
.TRCD2   ANOP                                                           02832000
         AIF   ('&TRACE(1,1)' NE '()').TRCD3                            02833000
         MNOTE 8,'TRACE must specify ON or OFF:'                        02834000
         MNOTE 8,'it has been set to OFF.'                              02835000
&ALLOK   SETB  0                       Indicate error detected          02836000
         AGO   .TRCD6                  Go check trace table size        02837000
.*                                                                      02838000
.TRCD3   ANOP                          Check ON|OFF                     02839000
         AIF   ('&TRACE(1,1)' EQ 'ON').TRCD4                            02840000
         AIF   ('&TRACE(1,1)' EQ 'OFF').TRCD5                           02841000
         MNOTE 8,'TRACE was not set ON or OFF:'                         02842000
         MNOTE 8,'it has been set to OFF.'                              02843000
&ALLOK   SETB  0                       Indicate error detected          02844000
         AGO   .TRCD6                  Go check trace table size        02845000
.*                                                                      02846000
.TRCD4   ANOP                          Set trace ON                     02847000
&FLAG    SETA  &FLAG+&ON                                                02848000
         AGO   .TRCD6                  Go check trace table size        02849000
.*                                                                      02850000
.TRCD5   ANOP                          Set trace OFF                    02851000
&FLAG    SETA  &FLAG+&OFF                                               02852000
         AGO   .TRCD6                  Go check trace table size        02853000
.*                                                                      02854000
.*                                   *------------------------------    02855000
.*                                   * Process trace table size         02856000
.*                                   *------------------------------    02857000
.TRCD6   ANOP                          Check trace table size           02858000
         AIF   ('&TRACE(1,2)' NE '').TRCD7                              02859000
         MNOTE 8,'TRACE must specify a table size:'                     02860000
         MNOTE 8,'it has been set to &INITSIZ..'                        02861000
&ALLOK   SETB  0                       Indicate error detected          02862000
         AGO   .TRCD9                  Go to (no)dump processing        02863000
.*                                                                      02864000
.TRCD7   ANOP                                                           02865000
&TEMPSTR SETC  '&TRACE(1,2)'           Obtain trace table size          02866000
         AIF   ('&TEMPSTR'(1,1) NE '-').TRCD8                           02867000
         MNOTE 8,'TRACE table size may not begin with a minus sign:'    02868000
         MNOTE 8,'it has been set to &INITSIZ..'                        02869000
&ALLOK   SETB  0                       Indicate error detected          02870000
         AGO   .TRCD9                  Go to (no)dump processing        02871000
.*                                                                      02872000
.TRCD8   ANOP                                                           02873000
         CEEXCALC &TRACE(1,2)          Obtain &VALUE and &CALCOK        02874000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            02875000
         AIF   (&CALCOK).TRCD9         If CEEXCALC OK, suboption valid  02876000
&ALLOK   SETB  0                       Indicate error detected          02877000
         AGO   .TRCD9                  Go to (no)dump processing        02878000
.*                                                                      02879000
.*                                   *--------------------------------- 02880000
.*                                   * Process DUMP | NODUMP parameters 02881000
.*                                   *--------------------------------- 02882000
.TRCD9   ANOP                                                           02883000
         AIF   ('&TRACE(1,3)' NE '').TRCD10                             02884000
         MNOTE 8,'TRACE must specify DUMP or NODUMP:'                   02885000
         MNOTE 8,'it has been set to DUMP.'                             02886000
&ALLOK   SETB  0                       Indicate error detected          02887000
         AGO   .TRCD13                 Go to LE=n processing            02888000
.*                                                                      02889000
.TRCD10  ANOP                                                           02890000
         AIF   ('&TRACE(1,3)' EQ 'DUMP').TRCD11                         02891000
         AIF   ('&TRACE(1,3)' EQ 'NODUMP').TRCD12                       02892000
         MNOTE 8,'TRACE sub-option 3 must be DUMP or NODUMP:'           02893000
         MNOTE 8,'it has been set to DUMP.'                             02894000
&ALLOK   SETB  0                       Indicate error detected          02895000
         AGO   .TRCD13                 Go to LE=n processing            02896000
.*                                                                      02897000
.TRCD11  ANOP                          Set DUMP                         02898000
&TRCFLG1 SETA  &ON                                                      02899000
         AGO   .TRCD13                 Go to LE=n processing            02900000
.*                                                                      02901000
.TRCD12  ANOP                          Set NODUMP                       02902000
&TRCFLG1 SETA  &OFF                                                     02903000
.*                                                                      02904000
.*                                   *------------------------------    02905000
.*                                   * Process LE=n parameter           02906000
.*                                   *------------------------------    02907000
.TRCD13  ANOP                                                           02908000
         AIF   ('&TRACE(1,4)' NE '').TRCD14                             02909000
         MNOTE 8,'TRACE must specify LE=n: it has been set to LE=0.'    02910000
&ALLOK   SETB  0                       Indicate error detected          02911000
         AGO   .TRCD100                Go check 2nd sublist item        02912000
.*                                                                      02913000
.TRCD14  ANOP                                                           02914000
         CEEXSTRI &TRACE(1,4),11,TRACE_string                           02915000
         AIF   (&STRIOK AND '&STRING'(1,3) EQ 'LE=' AND                X02916000
                &STRLEN GT 3).TRCD15  Go to get level                   02917000
         MNOTE 8,'TRACE sub-option 4 may only be LE=n:'                 02918000
         MNOTE 8,'it has been set to LE=&TRCGBL..'                      02919000
&ALLOK   SETB  0                       Indicate error detected          02920000
         AGO   .TRCD100                Go check 2nd sublist item        02921000
.*                                                                      02922000
.TRCD15  ANOP                          Get LE level                     02923000
&TEMPSTR SETC  ''                                                       02924000
&COUNTER SETA  4                       Start parsing after = sign       02925000
.TRCDLP  ANOP                          Loop                             02926000
         AIF (&STRLEN LT &COUNTER).ENDDLP                               02927000
&TEMPSTR SETC  '&TEMPSTR'.'&STRING'(&COUNTER,1)                         02928000
&COUNTER SETA  &COUNTER+1                                               02929000
         AGO   .TRCDLP                                                  02930000
.ENDDLP  ANOP                                                           02931000
&TEMPVAL SETA  &STRLEN-3                Length of LE level              02932000
         CEEXNUMB &TEMPSTR,H,&TEMPVAL   Valid hex digits?               02933000
         AIF   (&NUMBOK).TRCD16                                         02934000
         MNOTE 8,'TRACE sub-option 4 contains invalid hex digit(s):'    02935000
         MNOTE 8,'it has been set to &TRCGBL..'                         02936000
&ALLOK   SETB  0                        Indicate error detected         02937000
         AGO   .TRCD100                                                 02938000
.*                                                                      02939000
.TRCD16  ANOP                                                           02940000
&TRCGBL  SETC  '&TEMPSTR'              Set global level                 02941000
.*                                                                      02942000
.*                                   *------------------------------    02943000
.*                                   * Process OVR parameter            02944000
.*                                   *------------------------------    02945000
.TRCD100 ANOP                          Check 2nd sublist item           02946000
         AIF   ('&TRACE(2)' NE 'OVR' AND                               X02947000
               '&TRACE(2)' NE 'NONOVR').TRCD101                         02948000
         AIF   (NOT &ALLOK).TRCD102    If errors, force overridable     02949000
         AIF   ('&TRACE(2)' EQ 'OVR').TRCGEN                            02950000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  02951000
         AGO   .TRCGEN                                                  02952000
.*                                                                      02953000
.TRCD101 ANOP                                                           02954000
         MNOTE 8,'Last TRACE sublist item must be OVR or NONOVR.'       02955000
.*                                                                      02956000
.TRCD102 ANOP                                                           02957000
         MNOTE 8,'Due to error(s) detected above, TRACE has'            02958000
         MNOTE 8,'been set overridable (with valid bits on).'           02959000
.*                                                                      02960000
.* -----------------------------------------------------------------    02961000
.*     Generate the TRACE option                                        02962000
.* -----------------------------------------------------------------    02963000
.TRCGEN  ANOP                                                           02964000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 02965000
         DC    X'00'                   Unused                           02966000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   02967000
         DC    A(TRC_SUB-&SYSECT)      Offset of suboptions block       02968000
*                                                                       02969000
SUB      LOCTR                                                          02970000
TRC_SUB  DS    0F                      TRACE suboptions block           02971000
         DC    AL1(&VALBITS)           Suboption valid bits             02972000
         DC    AL3(0)                  Unused suboption valid bits      02973000
         DC    F'&INITSIZ'             Trace buffer size                02974000
         DC    XL4'&TRCGBL'            Global trace level bits          02975000
         DC    AL1(&TRCFLG1)           Trace flags ('80xxxxxx' = DUMP)  02976000
         DC    X'00'                   Trace flags ('xx00xxxx'       )  02977000
         DC    X'00'                   Trace flags ('xxxx00xx'       )  02978000
         DC    X'00'                   Trace flags ('xxxxxx00'       )  02979000
         DC    A(TRC_LVLV-&SYSECT)     Offset of Trace level verify     02980000
*                                       flags array                     02981000
         DC    A(TRC_LVLS-&SYSECT)     Offset of Trace level set        02982000
*                                       flags array                     02983000
         DC    A(TRC_LVL-&SYSECT)      Offset of Trace level array      02984000
*                                                                       02985000
TRC_LVLV DS    0F                      Trace level verify flags array   02986000
         DC    AL1(&TRCLVL1)           Verify flags for the following   02987000
         DC    AL1(&TRCLVL2)            array of trace level            02988000
         DC    AL1(&TRCLVL3)                                            02989000
         DC    AL1(&TRCLVL4)                                            02990000
*                                                                       02991000
TRC_LVLS DS    0F                      Trace level set flags array      02992000
         DC    XL4'00'                                                  02993000
*                                                                       02994000
TRC_LVL  DS    0F                      Trace level array                02995000
         DC    XL4'00'                 Unused trace level bits          02996000
         DC    XL4'&TRCCEL'            CEL trace level bits             02997000
         DC    XL4'00'                 Unused trace level bits          02998000
         DC    XL4'&TRCC370'           C/370 trace level bits           02999000
         DC    XL4'00'                 Unused trace level bits          03000000
         DC    XL4'00'                 Unused trace level bits          03001000
         DC    XL4'00'                 Unused trace level bits          03002000
         DC    XL4'00'                 Unused trace level bits          03003000
         DC    XL4'&TRCDCE'            DCE trace level bits             03004000
         DC    XL4'00'                 Unused trace level bits          03005000
         DC    XL4'00'                 Unused trace level bits          03006000
         DC    XL4'00'                 Unused trace level bits          03007000
         DC    XL4'&TRCSOCK'           Sockets trace level bits         03008000
         DC    XL4'00'                 Unused trace level bits          03009000
         DC    XL4'00'                 Unused trace level bits          03010000
         DC    XL4'00'                 Unused trace level bits          03011000
         DC    XL4'00'                 Unused trace level bits          03012000
         DC    XL4'00'                 Unused trace level bits          03013000
*                                                                       03014000
&SYSECT  LOCTR                                                          03015000
*                                                                       03016000
.********************************************************************** 03017000
*    THREADHEAP option - Unsupported in this release of LE/VSE          03018000
.********************************************************************** 03019000
&FLAG    SETA  &ON+&DOPT               Options flag initialized         03020000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3+&BIT4)                           03021000
&INITSIZ SETC  '4096'                  Default initial size 4K          03022000
&INCRSIZ SETC  '4096'                  Default increment size 4K        03023000
&LOCDISP SETA  &ANYWHR+&KEEP           Default location, disposition    03024000
&THTR4   SETA  &INITSIZ                Init rounded value 4K            03025000
&THTR8   SETA  &INITSIZ                Init rounded value 8 byte        03026000
&THRR4   SETA  &INCRSIZ                Incr rounded value 4K            03027000
&THRR8   SETA  &INCRSIZ                Incr rounded value 8 byte        03028000
&ALLOK   SETB  1                       Suboptions assumed error-free    03029000
.*                                                                      03030000
.THPGEN  ANOP                                                           03031000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 03032000
         DC    X'00'                   Unused                           03033000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   03034000
         DC    A(THP_SUB-&SYSECT)      Offset of suboptions block       03035000
*                                                                       03036000
SUB      LOCTR                                                          03037000
THP_SUB  DS    0F                      THREADHEAP suboptions block      03038000
         DC    AL1(&VALBITS)           Suboption valid bits             03039000
         DC    AL3(0)                  Unused suboption valid bits      03040000
         DC    F'&INITSIZ'             THREADHEAP initial size          03041000
         DC    F'&INCRSIZ'             THREADHEAP increment size        03042000
         DC    AL1(&LOCDISP)           128 = BELOW, 64 = FREE           03043000
         DC    3X'00'                  Unused                           03044000
*                                                                       03045000
&SYSECT  LOCTR                                                          03046000
*                                                                       03047000
.********************************************************************** 03048000
*    TEST/NOTEST option                                                 03049000
.*                                                                    * 03050000
.*   Note that if CEEXOPT has been invoked with the TEST option, and  * 03051000
.*   not with the NOTEST option, the options flag is set on.  In all  * 03052000
.*   other cases the options flag will remain off, indicating NOTEST. * 03053000
.********************************************************************** 03054000
&TSTOPT  SETC  'NOTEST'                Assume NOTEST specified          03055000
&FLAG    SETA  &OFF                    Options flag off (assume NOTEST) 03056000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3+&BIT4)                           03057000
&TSTLEVL SETC  '&ALL'                  Initialize test level            03058000
&COMFILE SETC  ' '                     Initialize commands file name    03059000
&CFILEN  SETC  '0'                     Initialize commands name length  03060000
&COMLIST SETC  ' '                     Initialize command list name     03061000
&CLSLEN  SETC  '0'                     Initialize command name length   03062000
&PREFILE SETC  ' '                     Initialize preference file name  03063000
&PFILEN  SETC  '0'                     Initialize preference name len   03064000
&ALLOK   SETB  1                       Suboptions assumed error-free    03065000
         AIF   (&DOPT).TSTD            Go to CEEDOPT processing         03066000
.*                                     CEEUOPT processing               03067000
         AIF   (N'&TEST EQ 0 OR N'&NOTEST EQ 0).TSTU1                   03068000
         MNOTE 8,'Macro has been invoked with both TEST and NOTEST:'    03069000
         MNOTE 8,'TEST/NOTEST has been set off and marked invalid.'     03070000
         AGO   .TSTGEN                                                  03071000
.*                                                                      03072000
.TSTU1   ANOP                          Check if neither option passed   03073000
         AIF   (N'&TEST EQ 0 AND N'&NOTEST EQ 0).TSTGEN                 03074000
         AIF   (N'&TEST NE 0).TSTU3    Go to setup for TEST option      03075000
.*                                     NOTEST option only was specified 03076000
         AIF   ('&NOTEST' EQ '()').TSTGEN                               03077000
         AIF   (N'&NOTEST LE 4).TSTU2                                   03078000
         MNOTE 8,'Too many suboptions -- NOTEST set off and invalid.'   03079000
         AGO   .TSTGEN                                                  03080000
.*                                                                      03081000
.TSTU2   ANOP                          Capture NOTEST parameters        03082000
&PARM1   SETC  '&NOTEST(1)'                                             03083000
&PARM2   SETC  '&NOTEST(2)'                                             03084000
&PARM3   SETC  '&NOTEST(3)'                                             03085000
&PARM4   SETC  '&NOTEST(4)'                                             03086000
         AGO   .TSTU5                  Go to TEST/NOTEST common code    03087000
.*                                                                      03088000
.TSTU3   ANOP                          TEST option only was specified   03089000
&TSTOPT  SETC  'TEST'                  Indicate TEST option specified   03090000
&FLAG    SETA  &ON                     Options flag on for TEST         03091000
         AIF   ('&TEST' EQ '()').TSTGEN                                 03092000
         AIF   (N'&TEST LE 4).TSTU4                                     03093000
         MNOTE 8,'Too many suboptions -- TEST set on and invalid.'      03094000
         AGO   .TSTGEN                                                  03095000
.*                                                                      03096000
.TSTU4   ANOP                          Capture TEST parameters          03097000
&PARM1   SETC  '&TEST(1)'                                               03098000
&PARM2   SETC  '&TEST(2)'                                               03099000
&PARM3   SETC  '&TEST(3)'                                               03100000
&PARM4   SETC  '&TEST(4)'                                               03101000
.*                                                                      03102000
.TSTU5   ANOP                          Common path for TEST or NOTEST   03103000
         AIF   ('&PARM1' EQ '').TSTU9  If null, work on commands_file   03104000
         AIF   ('&PARM1' EQ 'ALL').TSTU8                                03105000
         AIF   ('&PARM1' EQ 'ERROR').TSTU6                              03106000
         AIF   ('&PARM1' EQ 'NONE').TSTU7                               03107000
         MNOTE 8,'&TSTOPT 1st suboption (test level) not recognized:'   03108000
         MNOTE 8,'it has been set to ALL and marked invalid.'           03109000
&ALLOK   SETB  0                       Indicate option invalid          03110000
         AGO   .TSTU9                  Go to commands_file processing   03111000
.*                                                                      03112000
.TSTU6   ANOP                          Set test level to ERROR          03113000
&TSTLEVL SETC  '&ERROR'                                                 03114000
         AGO   .TSTU8                  Go mark suboption valid          03115000
.*                                                                      03116000
.TSTU7   ANOP                          Set test level to NONE           03117000
&TSTLEVL SETC  '&NONE'                                                  03118000
.*                                                                      03119000
.TSTU8   ANOP                          Set 1st suboption valid bit on   03120000
&VALBITS SETA  &VALBITS+&BIT1                                           03121000
.*                                                                      03122000
.TSTU9   ANOP                          Commands_file processing         03123000
         AIF   ('&PARM2' EQ '').TSTU11 If null, work on commands_list   03124000
         CEEXSTRI &PARM2,80,Commands_file Get &STRING, &STRLEN, &STRIOK 03125000
&COMFILE SETC  '&STRING'               Use CEEXSTRI's result            03126000
&CFILEN  SETC  '&STRLEN'               Use CEEXSTRI's result            03127000
         AIF   (&STRIOK).TSTU10        If CEEXSTRI OK, suboption valid  03128000
&ALLOK   SETB  0                       Indicate option invalid          03129000
         AGO   .TSTU11                 Go to prompt|command_list subopt 03130000
.*                                                                      03131000
.TSTU10  ANOP                          Set 2nd suboption valid bit on   03132000
&VALBITS SETA  &VALBITS+&BIT2                                           03133000
.*                                                                      03134000
.TSTU11  ANOP                          Prompt|command_list processing   03135000
         AIF   ('&PARM3' EQ '').TSTU13 If null, work on preference_file 03136000
         CEEXSTRI &PARM3,250,Command_list Get &STRING, &STRLEN, &STRIOK 03137000
&COMLIST SETC  '&STRING'               Use CEEXSTRI's result            03138000
&CLSLEN  SETC  '&STRLEN'               Use CEEXSTRI's result            03139000
         AIF   (&STRIOK).TSTU12        If CEEXSTRI OK, suboption valid  03140000
&ALLOK   SETB  0                       Indicate option invalid          03141000
         AGO   .TSTU13                 Go to preference_file processing 03142000
.*                                                                      03143000
.TSTU12  ANOP                          Set 3rd suboption valid bit on   03144000
&VALBITS SETA  &VALBITS+&BIT3                                           03145000
.*                                                                      03146000
.TSTU13  ANOP                          Preference_file processing       03147000
         AIF   ('&PARM4' EQ '').TSTU15 Avoid setting suboption valid    03148000
         CEEXSTRI &PARM4,80,Preference_file &STRING, &STRLEN, &STRIOK   03149000
&PREFILE SETC  '&STRING'               Use CEEXSTRI's result            03150000
&PFILEN  SETC  '&STRLEN'               Use CEEXSTRI's result            03151000
         AIF   (&STRIOK).TSTU14        If CEEXSTRI OK, suboption valid  03152000
&ALLOK   SETB  0                       Indicate option invalid          03153000
         AGO   .TSTU15                 Go examine TEST/NOTEST validity  03154000
.*                                                                      03155000
.TSTU14  ANOP                          Set 4th suboption valid bit on   03156000
&VALBITS SETA  &VALBITS+&BIT4                                           03157000
.*                                                                      03158000
.TSTU15  ANOP                          Determine if TEST/NOTEST valid   03159000
         AIF   (NOT &ALLOK).TSTU16     If suboption error, need msg     03160000
         AIF   (&VALBITS EQ &OFF).TSTGEN If off, all suboptions null    03161000
&FLAG    SETA  &FLAG+&VALID            No errors, not all subopts null  03162000
         AGO   .TSTGEN                                                  03163000
.*                                                                      03164000
.TSTU16  ANOP                                                           03165000
         MNOTE 8,'&TSTOPT option marked invalid due to above error(s).' 03166000
         AGO   .TSTGEN                                                  03167000
.*                                                                      03168000
.TSTD    ANOP                          CEEDOPT processing               03169000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          03170000
&VALBITS SETA  &BIT1+&BIT2+&BIT3+&BIT4 Suboption valid bits set on      03171000
         AIF   (N'&TEST EQ 0 OR N'&NOTEST EQ 0).TSTD1                   03172000
         MNOTE 8,'Macro has been invoked with both TEST and NOTEST:'    03173000
         MNOTE 8,'TEST/NOTEST has been set off, valid, overridable.'    03174000
         AGO   .TSTGEN                                                  03175000
.*                                                                      03176000
.TSTD1   ANOP                          Check if neither option passed   03177000
         AIF   (N'&TEST NE 0 OR N'&NOTEST NE 0).TSTD2                   03178000
         MNOTE 8,'Macro must be invoked with TEST or NOTEST:'           03179000
         MNOTE 8,'TEST/NOTEST has been set off, valid, overridable.'    03180000
         AGO   .TSTGEN                                                  03181000
.*                                                                      03182000
.TSTD2   ANOP                          Determine which option passed    03183000
         AIF   (N'&TEST NE 0).TSTD5    Go to setup for TEST option      03184000
.*                                     NOTEST option only was specified 03185000
         AIF   (N'&NOTEST EQ 2).TSTD3                                   03186000
         MNOTE 8,'NOTEST requires 2 sublist items: it has been set to'  03187000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 03188000
         AGO   .TSTGEN                                                  03189000
.*                                                                      03190000
.TSTD3   ANOP                          Check # 1st sublist items        03191000
         AIF   (N'&NOTEST(1) EQ 4).TSTD4                                03192000
         MNOTE 8,'NOTEST(1) requires 4 suboptions: it has been set to'  03193000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 03194000
         AGO   .TSTGEN                                                  03195000
.*                                                                      03196000
.TSTD4   ANOP                          Capture NOTEST parameters        03197000
&PARM1   SETC  '&NOTEST(1,1)'                                           03198000
&PARM2   SETC  '&NOTEST(1,2)'                                           03199000
&PARM3   SETC  '&NOTEST(1,3)'                                           03200000
&PARM4   SETC  '&NOTEST(1,4)'                                           03201000
&PARMOVR SETC  '&NOTEST(2)'                                             03202000
         AGO   .TSTD8                  Go to TEST/NOTEST common code    03203000
.*                                                                      03204000
.TSTD5   ANOP                          TEST option only was specified   03205000
&TSTOPT  SETC  'TEST'                  Indicate TEST option specified   03206000
&FLAG    SETA  &FLAG+&ON               Options flag on for TEST         03207000
         AIF   (N'&TEST EQ 2).TSTD6                                     03208000
         MNOTE 8,'TEST requires 2 sublist items: it has been set to'    03209000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 03210000
         AGO   .TSTGEN                                                  03211000
.*                                                                      03212000
.TSTD6   ANOP                          Check # 1st sublist items        03213000
         AIF   (N'&TEST(1) EQ 4).TSTD7                                  03214000
         MNOTE 8,'TEST(1) requires 4 suboptions: it has been set to'    03215000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 03216000
         AGO   .TSTGEN                                                  03217000
.*                                                                      03218000
.TSTD7   ANOP                          Capture TEST parameters          03219000
&PARM1   SETC  '&TEST(1,1)'                                             03220000
&PARM2   SETC  '&TEST(1,2)'                                             03221000
&PARM3   SETC  '&TEST(1,3)'                                             03222000
&PARM4   SETC  '&TEST(1,4)'                                             03223000
&PARMOVR SETC  '&TEST(2)'                                               03224000
.*                                                                      03225000
.TSTD8   ANOP                          Common path for TEST or NOTEST   03226000
         AIF   ('&PARM1' NE '').TSTD9  Go check test level explicitly   03227000
         MNOTE 8,'&TSTOPT must specify a test level:'                   03228000
         MNOTE 8,'it has been set to ALL.'                              03229000
&ALLOK   SETB  0                       Indicate error detected          03230000
         AGO   .TSTD12                 Go to commands_file processing   03231000
.*                                                                      03232000
.TSTD9   ANOP                          Check test level                 03233000
         AIF   ('&PARM1' EQ 'ALL').TSTD12                               03234000
         AIF   ('&PARM1' EQ 'ERROR').TSTD10                             03235000
         AIF   ('&PARM1' EQ 'NONE').TSTD11                              03236000
         MNOTE 8,'&TSTOPT test_level not recognized:'                   03237000
         MNOTE 8,'it has been set to ALL.'                              03238000
&ALLOK   SETB  0                       Indicate error detected          03239000
         AGO   .TSTD12                 Go to commands_file processing   03240000
.*                                                                      03241000
.TSTD10  ANOP                          Set test level to ERROR          03242000
&TSTLEVL SETC  '&ERROR'                                                 03243000
         AGO   .TSTD12                 Go to commands_file processing   03244000
.*                                                                      03245000
.TSTD11  ANOP                          Set test level to NONE           03246000
&TSTLEVL SETC  '&NONE'                                                  03247000
.*                                                                      03248000
.TSTD12  ANOP                          Commands_file processing         03249000
         AIF   ('&PARM2' NE '').TSTD13                                  03250000
         MNOTE 8,'&TSTOPT must specify a commands_file suboption:'      03251000
         MNOTE 8,'it has been set to a length &CFILEN blank string.'    03252000
&ALLOK   SETB  0                       Indicate error detected          03253000
         AGO   .TSTD14                 Go to command_list processing    03254000
.*                                                                      03255000
.TSTD13  ANOP                                                           03256000
         CEEXSTRI &PARM2,80,Commands_file Get &STRING, &STRLEN, &STRIOK 03257000
&COMFILE SETC  '&STRING'               Use CEEXSTRI's result            03258000
&CFILEN  SETC  '&STRLEN'               Use CEEXSTRI's result            03259000
         AIF   (&STRIOK).TSTD14                                         03260000
&ALLOK   SETB  0                       Indicate error detected          03261000
.*                                                                      03262000
.TSTD14  ANOP                          Prompt|command_list processing   03263000
         AIF   ('&PARM3' NE '').TSTD15                                  03264000
         MNOTE 8,'&TSTOPT must specify prompt|command_list suboption:'  03265000
         MNOTE 8,'it has been set to a length &CLSLEN blank string.'    03266000
&ALLOK   SETB  0                       Indicate error detected          03267000
         AGO   .TSTD16                 Go to preference_file processing 03268000
.*                                                                      03269000
.TSTD15  ANOP                                                           03270000
         CEEXSTRI &PARM3,250,Command_list Get &STRING, &STRLEN, &STRIOK 03271000
&COMLIST SETC  '&STRING'               Use CEEXSTRI's result            03272000
&CLSLEN  SETC  '&STRLEN'               Use CEEXSTRI's result            03273000
         AIF   (&STRIOK).TSTD16                                         03274000
&ALLOK   SETB  0                       Indicate error detected          03275000
.*                                                                      03276000
.TSTD16  ANOP                          Preference_file processing       03277000
         AIF   ('&PARM4' NE '').TSTD17                                  03278000
         MNOTE 8,'&TSTOPT must specify a preference_file suboption:'    03279000
         MNOTE 8,'it has been set to a length &PFILEN blank string.'    03280000
&ALLOK   SETB  0                       Indicate error detected          03281000
         AGO   .TSTD18                 Go check 2nd sublist item        03282000
.*                                                                      03283000
.TSTD17  ANOP                                                           03284000
         CEEXSTRI &PARM4,80,Preference_file &STRING, &STRLEN, &STRIOK   03285000
&PREFILE SETC  '&STRING'               Use CEEXSTRI's result            03286000
&PFILEN  SETC  '&STRLEN'               Use CEEXSTRI's result            03287000
         AIF   (&STRIOK).TSTD18                                         03288000
&ALLOK   SETB  0                       Indicate error detected          03289000
.*                                                                      03290000
.TSTD18  ANOP                          Check 2nd sublist item           03291000
         AIF   ('&PARMOVR' NE 'OVR' AND                                X03292000
               '&PARMOVR' NE 'NONOVR').TSTD19                           03293000
         AIF   (NOT &ALLOK).TSTD20     If errors, force overridable     03294000
         AIF   ('&PARMOVR' EQ 'OVR').TSTGEN                             03295000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  03296000
         AGO   .TSTGEN                                                  03297000
.*                                                                      03298000
.TSTD19  ANOP                                                           03299000
         MNOTE 8,'Last &TSTOPT sublist item must be OVR or NONOVR.'     03300000
.*                                                                      03301000
.TSTD20  ANOP                                                           03302000
         MNOTE 8,'Due to error(s) detected above, &TSTOPT has'          03303000
         MNOTE 8,'been set overridable (with valid bits on).'           03304000
.*                                                                      03305000
.TSTGEN  ANOP                                                           03306000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 03307000
         DC    X'00'                   Unused                           03308000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   03309000
         DC    A(TST_SUB-&SYSECT)      Offset of suboptions block       03310000
*                                                                       03311000
SUB      LOCTR                                                          03312000
TST_SUB  DS    0F                      TEST/NOTEST suboptions block     03313000
         DC    AL1(&VALBITS)           Suboption valid bits             03314000
         DC    AL3(0)                  Unused suboption valid bits      03315000
         DC    F'&TSTLEVL'             1 = NONE, 2 = ERROR, 4 = ALL     03316000
         DC    A(COMFILE-&SYSECT)      Offset of commands_file          03317000
         DC    A(COMLIST-&SYSECT)      Offset of command_list|prompt    03318000
         DC    A(PREFILE-&SYSECT)      Offset of preference_file        03319000
*                                                                       03320000
COMFILE  DS    0F                      TEST/NOTEST commands_file        03321000
         DC    H'&CFILEN'              Effective length of following    03322000
         DC    CL80'&COMFILE'          Commands_file name               03323000
         DC    CL2' '                  Unused                           03324000
*                                                                       03325000
COMLIST  DS    0F                      TEST/NOTEST command_list|prompt  03326000
         DC    H'&CLSLEN'              Effective length of following    03327000
         DC    CL250'&COMLIST'         Command_list name|prompt option  03328000
*                                                                       03329000
PREFILE  DS    0F                      TEST/NOTEST preference_file      03330000
         DC    H'&PFILEN'              Effective length of following    03331000
         DC    CL80'&PREFILE'          Preference_file name             03332000
         DC    CL2' '                  Unused                           03333000
*                                                                       03334000
&SYSECT  LOCTR                                                          03335000
*                                                                       03336000
.********************************************************************** 03337000
*    THREADSTACK option                                                 03338000
.********************************************************************** 03339000
&FLAG    SETA  &ON+&DOPT               Valid if CEEDOPT, else invalid   03340000
         DC    AL1(&FLAG)              128 = ON, 1 = valid              03341000
         DC    X'00'                   Unused                           03342000
         DC    H'&WHSETDS'             Set to default setting           03343000
         DC    A(THRE_SUB-&SYSECT)     Offset of suboptions block       03344000
*                                                                       03345000
SUB      LOCTR                                                          03346000
THRE_SUB DS    0F                      THREADSTACK suboptions block     03347000
&VALBITS SETA  &DOPT*(&BIT1+&BIT2+&BIT3+&BIT4)                          03348000
         DC    AL1(&VALBITS)           Suboption valid bits             03349000
         DC    AL3(0)                  Unused suboption valid bits      03350000
         DC    F'524288'               THREADSTACK initial size         03351000
         DC    F'524288'               THREADSTACK increment size       03352000
         DC    AL1(0)                  128 = BELOW, 64 = FREE           03353000
         DC    3X'00'                  Unused                           03354000
*                                                                       03355000
&SYSECT  LOCTR                                                          03356000
*                                                                       03357000
.********************************************************************** 03358000
*    TRAP option                                                        03359000
.********************************************************************** 03360000
.*       CEEXSIMP TRAP,&TRAP                                       @01C 03361000
.* *Begins*********************************************************@01A 03362000
.* Format:                                                              03363000
.*  TRAP(ON ., MAX  . .                     <- External parameters      03364000
.*       OFF   MIN                                                      03365000
.*                                                                      03366000
.* Note : Sub option is only accepted when TRAP(ON) is specified.       03367000
.*       TRAP(OFF) will mean the second option is ignored. This will    03368000
.*       then be defaulted to valid and MAX. Though the runtime will    03369000
.*       ignore this when TRAP(OFF) is detected.                        03370000
.*                                                                      03371000
.********************************************************************** 03372000
&FLAG    SETA  &OFF                    Options flag initialized         03373000
&VALBITS SETA  &OFF*(&BIT1)                                             03374000
&TRPFLG1 SETA  &ON                     Init trap  flags                 03375000
&ALLOK   SETB  1                     Suboptions assumed error-free      03376000
.*                                                                      03377000
         AIF   (&DOPT).TRPD            Go to CEEDOPT processing         03378000
.*                                                                      03379000
.* -----------------------------------------------------------------    03380000
.*     CEEUOPT processing                                               03381000
.* -----------------------------------------------------------------    03382000
         AIF   (N'&TRAP EQ 0).TRPGEN                                    03383000
         AIF   ('&TRAP' EQ '()').TRPGEN                                 03384000
         AIF   (N'&TRAP LE 2).TRPU1                                     03385000
         MNOTE 8,'Too many suboptions -- TRAP marked invalid.'          03386000
         AGO   .TRPGEN                                                  03387000
.*                                                                      03388000
.*                                   *------------------------------    03389000
.*                                   * Process ON | OFF parameter       03390000
.*                                   *------------------------------    03391000
.TRPU1   ANOP                          Check ON|OFF                     03392000
         AIF   ('&TRAP(1)' EQ '').TRPU4 If null, work on MIN/MAX        03393000
         AIF   ('&TRAP(1)' EQ 'ON').TRPU2                               03394000
         AIF   ('&TRAP(1)' EQ 'OFF').TRPU3                              03395000
         MNOTE 8,'TRAP was not set ON or OFF:'                          03396000
         MNOTE 8,'it has been set to ON.'                               03397000
&ALLOK   SETB  0                       Indicate error detected          03398000
         AGO   .TRPU7                  Go examine TRAP validity         03399000
.*                                                                      03400000
.TRPU2   ANOP                          Set trap ON                      03401000
&FLAG    SETA  &ON+&VALID              Set valid bit on                 03402000
         AGO   .TRPU4                  Go check trap MAX/MIN            03403000
.*                                                                      03404000
.TRPU3   ANOP                          Set trap OFF                     03405000
&FLAG    SETA  &OFF+&VALID             Set valid bit on                 03406000
         AGO   .TRPGEN                 Dont need subopts for OFF        03407000
.*       AGO   .TRPU4                  Go check trap MAX/MIN            03408000
.*                                                                      03409000
.*                                   *--------------------------------- 03410000
.*                                   * Process MAX | MIN parameters     03411000
.*                                   *--------------------------------- 03412000
.TRPU4   ANOP                                                           03413000
         AIF   ('&TRAP(2)' EQ '' AND                                   X03414000
                '&TRAP(1)' EQ 'ON').TRPU5     For TRAP(ON) set MAX      03415000
         AIF   ('&TRAP(2)' EQ 'MAX' AND                                X03416000
                '&TRAP(1)' EQ 'ON').TRPU5                               03417000
         AIF   ('&TRAP(2)' EQ 'MIN' AND                                X03418000
                '&TRAP(1)' EQ 'ON').TRPU6                               03419000
         MNOTE 8,'TRAP sub-option 2 can only be MAX or MIN if  '        03420000
         MNOTE 8,'TRAP(ON) is used. Option is marked invalid.'          03421000
&ALLOK   SETB  0                       Indicate error detected          03422000
         AGO   .TRPU7                  Go to LE=n processing            03423000
.*                                                                      03424000
.TRPU5   ANOP                          Set MAX                          03425000
&VALBITS SETA  &VALBITS+&BIT1          Set (no)MAX subopt val bit on    03426000
&TRPFLG1 SETA  &ON                     Set MAX on                       03427000
         AGO   .TRPU7                  Go to TRAP validity              03428000
.*                                                                      03429000
.TRPU6   ANOP                          Set MIN                          03430000
&VALBITS SETA  &VALBITS+&BIT1          Set (no)MAX subopt val bit on    03431000
&TRPFLG1 SETA  &OFF                    Set MAX off (or MIN)             03432000
.*                                                                      03433000
.TRPU7   ANOP                          Determine TRAP is valid          03434000
         AIF   (NOT &ALLOK).TRPU8     If suboption error, need msg      03435000
         AGO   .TRPGEN                                                  03436000
.*                                                                      03437000
.TRPU8   ANOP                                                           03438000
         MNOTE 8,'TRAP valid bit and suboption valid bits set to'       03439000
         MNOTE 8,'reflect the errors detected above.'                   03440000
         AGO   .TRPGEN                                                  03441000
.*                                                                      03442000
.*                                                                      03443000
.*                                                                      03444000
.* -----------------------------------------------------------------    03445000
.*     CEEDOPT processing                                               03446000
.* -----------------------------------------------------------------    03447000
.TRPD    ANOP                          CEEDOPT processing               03448000
         AIF   (N'&TRAP EQ 0).TRPGEN   Go set defaults, mark invalid    03449000
&FLAG    SETA  &ON+&VALID              Option valid bit set on          03450000
&VALBITS SETA  &BIT1                   Suboption valid bits set on      03451000
         AIF   (N'&TRAP EQ 2).TRPD1                                     03452000
         AIF   (N'&TRAP EQ 1).TRPD1                                     03453000
         MNOTE 8,'TRAP requires no more than 2 sublist items: it has'   03454000
         MNOTE 8,'been set to defaults, marked overridable and '        03455000
         MNOTE 8,'valid.'                                               03456000
         AGO   .TRPGEN                                                  03457000
.*                                                                      03458000
.TRPD1   ANOP                          Check # 1st sublist items        03459000
         AIF   (N'&TRAP(1) EQ 1).TRPD20                                 03460000
         AIF   (N'&TRAP(1) EQ 2).TRPD21                                 03461000
         MNOTE 8,'TRAP requires no more than 2 sublist items: it has'   03462000
         MNOTE 8,'been set to defaults,and marked overridable and '     03463000
         MNOTE 8,'valid.'                                               03464000
         AGO   .TRPGEN                                                  03465000
.*                                                                      03466000
.*                                   *------------------------------    03467000
.*                                   * Process ON | OFF parameter       03468000
.*                                   *------------------------------    03469000
.TRPD20  ANOP                                                           03470000
         AIF   ('&TRAP(1,1)' NE '()').TRPD3                             03471000
         MNOTE 8,'TRAP must specify ON or OFF:'                         03472000
         MNOTE 8,'it has been set to ON.'                               03473000
&ALLOK   SETB  0                       Indicate error detected          03474000
         AGO   .TRPD4                  Go check MAX/MIN                 03475000
.*                                                                      03476000
.TRPD21  ANOP                                                           03477000
         AIF   ('&TRAP(1,1)' NE '()').TRPD3                             03478000
         MNOTE 8,'TRAP must specify ON or OFF:'                         03479000
         MNOTE 8,'it has been set to ON.'                               03480000
&ALLOK   SETB  0                       Indicate error detected          03481000
         AGO   .TRPD4                  Go to TRAP validity              03482000
.*                                                                      03483000
.TRPD3   ANOP                          Check ON|OFF                     03484000
         AIF   ('&TRAP(1,1)' EQ 'ON').TRPD4                             03485000
         AIF   ('&TRAP(1,1)' EQ 'OFF').TRPD5                            03486000
         MNOTE 8,'TRAP was not set ON or OFF:'                          03487000
         MNOTE 8,'it has been set to OFF.'                              03488000
&ALLOK   SETB  0                       Indicate error detected          03489000
         AIF   (N'&TRAP(1) EQ 1).TRPD8                                  03490000
         AGO   .TRPD6                  Go check trace table size        03491000
.*                                                                      03492000
.TRPD4   ANOP                          Set trap ON                      03493000
&FLAG    SETA  &ON+&VALID                                               03494000
         AIF   (N'&TRAP(1) EQ 1).TRPD8                                  03495000
         AGO   .TRPD6                  Go check MAX/MIN                 03496000
.*                                                                      03497000
.TRPD5   ANOP                          Set trap OFF                     03498000
&FLAG    SETA  &OFF+&VALID                                              03499000
         AIF   (N'&TRAP(1) EQ 1).TRPD9                                  03500000
         AGO   .TRPGEN                 Go gen TRAP option               03501000
.*       AGO   .TRPD6                  Go check MAX/MIN                 03502000
.*                                                                      03503000
.*                                   *--------------------------------- 03504000
.*                                   * Process MAX | MIN parameters     03505000
.*                                   *--------------------------------- 03506000
.TRPD6   ANOP                                                           03507000
         AIF   ('&TRAP(1,2)' NE '').TRPD7                               03508000
         MNOTE 8,'TRAP must specify MAX or MIN.'                        03509000
         MNOTE 8,'It has been set to MAX.'                              03510000
&ALLOK   SETB  0                       Indicate error detected          03511000
         AGO   .TRPD8                  Go to TRAP validity              03512000
.*                                                                      03513000
.TRPD7   ANOP                                                           03514000
         AIF   ('&TRAP(1,2)' EQ 'MAX' AND                              X03515000
                '&TRAP(1,1)' EQ 'ON').TRPD8                             03516000
         AIF   ('&TRAP(1,2)' EQ 'MIN' AND                              X03517000
                '&TRAP(1,1)' EQ 'ON').TRPD9                             03518000
         MNOTE 8,'TRAP sub-option 2 can be MAX or MIN only if'          03519000
         MNOTE 8,'TRAP(ON) is used.'                                    03520000
&ALLOK   SETB  0                       Indicate error detected          03521000
         AIF   ('&TRAP(1,1)' EQ 'OFF').TRPD9                            03522000
         AIF   ('&TRAP(1,1)' EQ 'ON').TRPD8                             03523000
         AGO   .TRPD100                Go to TRAP validity              03524000
.*                                                                      03525000
.TRPD8   ANOP                          Set MAX                          03526000
         AIF   (&ALLOK).TRPDMX                                          03527000
         MNOTE 8,'TRAP sub-option 2 has been set to MAX.'               03528000
.TRPDMX  ANOP                                                           03529000
&TRPFLG1 SETA  &ON                                                      03530000
         AGO   .TRPD100                Go to check OVR                  03531000
.*                                                                      03532000
.TRPD9   ANOP                          Set MIN                          03533000
         AIF   (&ALLOK).TRPDMN                                          03534000
         MNOTE 8,'TRAP sub-option 2 has been set to MIN.'               03535000
.TRPDMN  ANOP                                                           03536000
&TRPFLG1 SETA  &OFF                                                     03537000
.*                                                                      03538000
.*                                   *------------------------------    03539000
.*                                   * Process OVR parameter            03540000
.*                                   *------------------------------    03541000
.TRPD100 ANOP                          Check 2nd sublist item           03542000
         AIF   ('&TRAP(2)' NE 'OVR' AND                                X03543000
               '&TRAP(2)' NE 'NONOVR').TRPD101                          03544000
         AIF   (NOT &ALLOK).TRPD102   If errors, force overridable      03545000
         AIF   ('&TRAP(2)' EQ 'OVR').TRPGEN                             03546000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  03547000
         AGO   .TRPGEN                                                  03548000
.*                                                                      03549000
.TRPD101 ANOP                                                           03550000
         MNOTE 8,'Last TRAP sublist item must be OVR or NONOVR.'        03551000
.*                                                                      03552000
.TRPD102 ANOP                                                           03553000
         MNOTE 8,'Due to error(s) detected above, TRAP has'             03554000
         MNOTE 8,'been set overridable (with valid bits on).'           03555000
.*                                                                      03556000
.* -----------------------------------------------------------------    03557000
.*     Generate the TRAP option                                         03558000
.* -----------------------------------------------------------------    03559000
.TRPGEN  ANOP                                                           03560000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 03561000
         DC    X'00'                   Unused                           03562000
         DC    H'&WHSET'               100=DOPT 200=UOPT                03563000
         DC    A(TRP_SUB-&SYSECT)      Offset of suboptions block       03564000
*                                                                       03565000
SUB      LOCTR                                                          03566000
TRP_SUB  DS    0F                      TRACE suboptions block           03567000
         DC    AL1(&VALBITS)           Suboption valid bits             03568000
         DC    AL3(0)                  Unused suboption valid bits      03569000
         DC    AL1(&TRPFLG1)           Trap  flags ('80xxxxxx' = MAX)   03570000
         DC    AL3(0)                  Unused trap flags                03571000
*                                                                       03572000
&SYSECT  LOCTR                                                          03573000
*                                                                       03574000
.*End**************************************************************@01A 03575000
.********************************************************************** 03576000
*    UPSI option                                                        03577000
.********************************************************************** 03578000
&FLAG    SETA  &ON                     Options flag initialized         03579000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 03580000
&UPSISW  SETC  '00000000'              Default UPSI switch values       03581000
&ALLOK   SETB  1                       Suboptions assumed error-free    03582000
         AIF   (&DOPT).UPSD            Go to CEEDOPT processing         03583000
.*                                     CEEUOPT processing               03584000
         AIF   (N'&UPSI EQ 0).UPSGEN                                    03585000
         AIF   ('&UPSI' EQ '()').UPSGEN                                 03586000
         AIF   (N'&UPSI EQ 1).UPSU1                                     03587000
         MNOTE 8,'Too many suboptions -- UPSI marked invalid.'          03588000
         AGO   .UPSGEN                                                  03589000
.*                                                                      03590000
.UPSU1   ANOP                          Check sublist item length        03591000
         AIF   (K'&UPSI(1) EQ 8).UPSU2                                  03592000
         MNOTE 8,'UPSI must have exactly 8 switches: it has'            03593000
         MNOTE 8,'been set to &UPSISW and marked invalid.'              03594000
         AGO   .UPSGEN                                                  03595000
.*                                                                      03596000
.UPSU2   ANOP                          Verify UPSI flags are binary     03597000
         CEEXNUMB &UPSI(1),B,8         Obtain &NUMBOK                   03598000
         AIF   (&NUMBOK).UPSU3                                          03599000
         MNOTE 8,'UPSI switches must either be 0 or 1: they'            03600000
         MNOTE 8,'have been set to &UPSISW and marked invalid.'         03601000
         AGO   .UPSGEN                                                  03602000
.*                                                                      03603000
.UPSU3   ANOP                                                           03604000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          03605000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       03606000
&UPSISW  SETC  '&UPSI(1)'              UPSI set to values passed        03607000
         AGO   .UPSGEN                                                  03608000
.*                                                                      03609000
.UPSD    ANOP                          CEEDOPT processing               03610000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          03611000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       03612000
         AIF   (N'&UPSI EQ 2).UPSD1                                     03613000
         MNOTE 8,'UPSI requires 2 sublist items: it has been'           03614000
         MNOTE 8,'set to &UPSISW, overridable, with valid bits on.'     03615000
         AGO   .UPSGEN                                                  03616000
.*                                                                      03617000
.UPSD1   ANOP                          Check # 1st sublist items        03618000
         AIF   (N'&UPSI(1) EQ 1).UPSD2                                  03619000
         MNOTE 8,'UPSI(1) requires exactly 1 sublist item: UPSI'        03620000
         MNOTE 8,'set to &UPSISW and overridable, with valid bits on.'  03621000
         AGO   .UPSGEN                                                  03622000
.*                                                                      03623000
.UPSD2   ANOP                          Disallow empty parentheses       03624000
         AIF   ('&UPSI(1)' NE '()').UPSD3                               03625000
         MNOTE 8,'UPSI(1) requires exactly 1 sublist item: UPSI'        03626000
         MNOTE 8,'set to &UPSISW and overridable, with valid bits on.'  03627000
         AGO   .UPSGEN                                                  03628000
.*                                                                      03629000
.UPSD3   ANOP                          Check sublist item length        03630000
         AIF   (K'&UPSI(1,1) EQ 8).UPSD4                                03631000
         MNOTE 8,'UPSI must have exactly 8 switches:'                   03632000
         MNOTE 8,'it has been set to &UPSISW..'                         03633000
&ALLOK   SETB  0                       Indicate error detected          03634000
         AGO   .UPSD6                  Go check 2nd sublist item        03635000
.*                                                                      03636000
.UPSD4   ANOP                          Verify UPSI flags are binary     03637000
         CEEXNUMB &UPSI(1,1),B,8       Obtain &NUMBOK                   03638000
         AIF   (&NUMBOK).UPSD5                                          03639000
         MNOTE 8,'UPSI switches must either be 0 or 1:'                 03640000
         MNOTE 8,'they have been set to &UPSISW..'                      03641000
&ALLOK   SETB  0                       Indicate error detected          03642000
         AGO   .UPSD6                  Go check 2nd sublist item        03643000
.*                                                                      03644000
.UPSD5   ANOP                          UPSI set to value passed         03645000
&UPSISW  SETC  '&UPSI(1,1)'                                             03646000
.*                                                                      03647000
.UPSD6   ANOP                          Check 2nd sublist item           03648000
         AIF   ('&UPSI(2)' NE 'OVR' AND                                X03649000
               '&UPSI(2)' NE 'NONOVR').UPSD7                            03650000
         AIF   (NOT &ALLOK).UPSD8      If errors, force overridable     03651000
         AIF   ('&UPSI(2)' EQ 'OVR').UPSGEN                             03652000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  03653000
         AGO   .UPSGEN                                                  03654000
.*                                                                      03655000
.UPSD7   ANOP                                                           03656000
         MNOTE 8,'Last UPSI sublist item must be OVR or NONOVR.'        03657000
.*                                                                      03658000
.UPSD8   ANOP                                                           03659000
         MNOTE 8,'Due to error(s) detected above, UPSI has'             03660000
         MNOTE 8,'been set overridable (with valid bits on).'           03661000
.*                                                                      03662000
.UPSGEN  ANOP                                                           03663000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 03664000
         DC    X'00'                   Unused                           03665000
         DC    H'&WHSET'               100 = set in DOPT, 200 = in UOPT 03666000
         DC    A(UPSI_SUB-&SYSECT)     Offset of suboptions block       03667000
*                                                                       03668000
SUB      LOCTR                                                          03669000
UPSI_SUB DS    0F                      UPSI suboptions block            03670000
         DC    AL1(&VALBITS)           Suboption valid bits             03671000
         DC    AL3(0)                  Unused suboption valid bits      03672000
         DC    CL8'&UPSISW'            8 UPSI switches                  03673000
*                                                                       03674000
&SYSECT  LOCTR                                                          03675000
*                                                                       03676000
.********************************************************************** 03677000
*    VCTRSAVE option - Unsupported in this release of LE/VSE            03678000
.********************************************************************** 03679000
.*       CEEXSIMP VCTRSAVE,&VCTRSAVE                                    03680000
         CEEXHARD &OFF                 Disable this option this release 03681000
.********************************************************************** 03682000
*    PRTUNIT option - Unsupported in this release of LE/VSE             03683000
.********************************************************************** 03684000
&FLAG    SETA  &ON+&DOPT               Options flag initialized         03685000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 03686000
&PRTNUM  SETC  '6'                     Prtunit initialized              03687000
&ALLOK   SETB  1                       Suboptions assumed error-free    03688000
.*                                                                      03689000
.PRTGEN  ANOP                                                           03690000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 03691000
         DC    X'00'                   Unused                           03692000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   03693000
         DC    A(PRT_SUB-&SYSECT)      Offset of suboptions block       03694000
*                                                                       03695000
SUB      LOCTR                                                          03696000
PRT_SUB  DS    0F                      PRTUNIT suboptions block         03697000
         DC    AL1(&VALBITS)           Suboption valid bits             03698000
         DC    AL3(0)                  Unused suboption valid bits      03699000
         DC    F'&PRTNUM'              PRTUNIT # non-fatal errors       03700000
*                                                                       03701000
&SYSECT  LOCTR                                                          03702000
*                                                                       03703000
.********************************************************************** 03704000
*    XUFLOW option                                                      03705000
.********************************************************************** 03706000
&FLAG    SETA  &ON                     Options flag initialized         03707000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 03708000
&XUFLEVL SETC  '&AUTOXUF'              Default interrupt level          03709000
&ALLOK   SETB  1                       Suboptions assumed error-free    03710000
         AIF   (&DOPT).XUFD            Go to CEEDOPT processing         03711000
.*                                     CEEUOPT processing               03712000
         AIF   (N'&XUFLOW EQ 0).XUFGEN                                  03713000
         AIF   ('&XUFLOW' EQ '()').XUFGEN                               03714000
         AIF   (N'&XUFLOW EQ 1).XUFU1                                   03715000
         MNOTE 8,'Too many suboptions -- XUFLOW marked invalid.'        03716000
         AGO   .XUFGEN                                                  03717000
.*                                                                      03718000
.XUFU1   ANOP                          Check interrupt level            03719000
         AIF   ('&XUFLOW(1)' EQ 'AUTO').XUFU4                           03720000
         AIF   ('&XUFLOW(1)' EQ 'ON').XUFU2                             03721000
         AIF   ('&XUFLOW(1)' EQ 'OFF').XUFU3                            03722000
         MNOTE 8,'XUFLOW suboption not recognized: it'                  03723000
         MNOTE 8,'has been set to AUTO and marked invalid.'             03724000
         AGO   .XUFGEN                                                  03725000
.*                                                                      03726000
.XUFU2   ANOP                          Set interrupt level to ON        03727000
&XUFLEVL SETC  '&ONXUF'                                                 03728000
         AGO   .XUFU4                  Go mark option valid             03729000
.*                                                                      03730000
.XUFU3   ANOP                          Set interrupt level to OFF       03731000
&XUFLEVL SETC  '&OFFXUF'                                                03732000
.*                                                                      03733000
.XUFU4   ANOP                          XUFLOW valid string              03734000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          03735000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       03736000
         AGO   .XUFGEN                                                  03737000
.*                                                                      03738000
.XUFD    ANOP                          CEEDOPT processing               03739000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          03740000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       03741000
         AIF   (N'&XUFLOW EQ 2).XUFD1                                   03742000
         MNOTE 8,'XUFLOW requires 2 sublist items: it has been'         03743000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   03744000
         AGO   .XUFGEN                                                  03745000
.*                                                                      03746000
.XUFD1   ANOP                          Check # 1st sublist items        03747000
         AIF   (N'&XUFLOW(1) EQ 1).XUFD2                                03748000
         MNOTE 8,'XUFLOW(1) requires exactly 1 item: XUFLOW has been'   03749000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   03750000
         AGO   .XUFGEN                                                  03751000
.*                                                                      03752000
.XUFD2   ANOP                          Disallow empty parentheses       03753000
         AIF   ('&XUFLOW(1)' NE '()').XUFD3                             03754000
         MNOTE 8,'XUFLOW(1) requires exactly 1 item: XUFLOW has been'   03755000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   03756000
         AGO   .XUFGEN                                                  03757000
.*                                                                      03758000
.XUFD3   ANOP                          Check interrupt level            03759000
         AIF   ('&XUFLOW(1,1)' EQ 'AUTO').XUFD6                         03760000
         AIF   ('&XUFLOW(1,1)' EQ 'ON').XUFD4                           03761000
         AIF   ('&XUFLOW(1,1)' EQ 'OFF').XUFD5                          03762000
         MNOTE 8,'XUFLOW interrupt level not'                           03763000
         MNOTE 8,'recognized: it has been set to AUTO.'                 03764000
&ALLOK   SETB  0                       Indicate error detected          03765000
         AGO   .XUFD6                  Go check 2nd sublist item        03766000
.*                                                                      03767000
.XUFD4   ANOP                          Set interrupt level to ON        03768000
&XUFLEVL SETC  '&ONXUF'                                                 03769000
         AGO   .XUFD6                  Go check 2nd sublist item        03770000
.*                                                                      03771000
.XUFD5   ANOP                          Set interrupt level to OFF       03772000
&XUFLEVL SETC  '&OFFXUF'                                                03773000
.*                                                                      03774000
.XUFD6   ANOP                          Check 2nd sublist item           03775000
         AIF   ('&XUFLOW(2)' NE 'OVR' AND                              X03776000
               '&XUFLOW(2)' NE 'NONOVR').XUFD7                          03777000
         AIF   (NOT &ALLOK).XUFD8      If errors, force overridable     03778000
         AIF   ('&XUFLOW(2)' EQ 'OVR').XUFGEN                           03779000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  03780000
         AGO   .XUFGEN                                                  03781000
.*                                                                      03782000
.XUFD7   ANOP                                                           03783000
         MNOTE 8,'Last XUFLOW sublist item must be OVR or NONOVR.'      03784000
.*                                                                      03785000
.XUFD8   ANOP                                                           03786000
         MNOTE 8,'Due to error(s) detected above, XUFLOW has'           03787000
         MNOTE 8,'been set overridable (with valid bits on).'           03788000
.*                                                                      03789000
.XUFGEN  ANOP                                                           03790000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 03791000
         DC    X'00'                   Unused                           03792000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   03793000
         DC    A(XUF_SUB-&SYSECT)      Offset of suboptions block       03794000
*                                                                       03795000
SUB      LOCTR                                                          03796000
XUF_SUB  DS    0F                      XUFLOW suboptions block          03797000
         DC    AL1(&VALBITS)           Suboption valid bits             03798000
         DC    AL3(0)                  Unused suboption valid bits      03799000
         DC    F'&XUFLEVL'             4 = OFF, 2 = ON, 1 = AUTO        03800000
*                                                                       03801000
&SYSECT  LOCTR                                                          03802000
*                                                                       03803000
.********************************************************************** 03804000
*    CBLOPTS option                                                     03805000
.********************************************************************** 03806000
         CEEXSIMP CBLOPTS,&CBLOPTS                                      03807000
.********************************************************************** 03808000
*    NONONIPTSTACK/NONIPTSTACK option - Unsupported in this release of  03809000
*                                       LE/VSE                          03810000
.********************************************************************** 03811000
&FLAG    SETA  &OFF+&DOPT              Options flag initialized         03812000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3+&BIT4)                           03813000
&INITSIZ SETC  '4096'                  Default initial size             03814000
&INCRSIZ SETC  '4096'                  Default increment size           03815000
&LOCDISP SETA  &BELOW+&KEEP            Default location, disposition    03816000
&NSTR4   SETA  &INITSIZ                Init rounded value 4K            03817000
&NSTR8   SETA  &INITSIZ                Init rounded value 8 byte        03818000
&NSRR4   SETA  &INCRSIZ                Incr rounded value 4K            03819000
&NSRR8   SETA  &INCRSIZ                Incr rounded value 8 byte        03820000
&ALLOK   SETB  1                       Suboptions assumed error-free    03821000
.*                                                                      03822000
.NISGEN  ANOP                                                           03823000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 03824000
         DC    X'00'                   Unused                           03825000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   03826000
         DC    A(NIS_SUB-&SYSECT)      Offset of suboptions block       03827000
*                                                                       03828000
SUB      LOCTR                                                          03829000
NIS_SUB  DS    0F                      NONIPTSTACK suboptions block     03830000
         DC    AL1(&VALBITS)           Suboption valid bits             03831000
         DC    AL3(0)                  Unused suboption valid bits      03832000
         DC    F'&INITSIZ'             NONIPTSTACK initial size         03833000
         DC    F'&INCRSIZ'             NONIPTSTACK increment size       03834000
         DC    AL1(&LOCDISP)           128 = BELOW, 64 = FREE           03835000
         DC    3X'00'                  Unused                           03836000
*                                                                       03837000
&SYSECT  LOCTR                                                          03838000
*                                                                       03839000
.********************************************************************** 03840000
*    RPTOPTS option                                                     03841000
.********************************************************************** 03842000
         CEEXSIMP RPTOPTS,&RPTOPTS                                      03843000
.********************************************************************** 03844000
*    ANYHEAP option                                                     03845000
.********************************************************************** 03846000
&FLAG    SETA  &ON                     Options flag initialized         03847000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3+&BIT4)                           03848000
&INITSIZ SETC  '32768'                 Default initial size 32K         03849000
&INCRSIZ SETC  '16384'                 Default increment size 16K       03850000
&LOCDISP SETA  &ANYWHR+&FREE           Default location, disposition    03851000
&AHTR4   SETA  &INITSIZ                Init rounded value 4K            03852000
&AHTR8   SETA  &INITSIZ                Init rounded value 8 byte        03853000
&AHRR4   SETA  &INCRSIZ                Incr rounded value 4K            03854000
&AHRR8   SETA  &INCRSIZ                Incr rounded value 8 byte        03855000
&ALLOK   SETB  1                       Suboptions assumed error-free    03856000
         AIF   (&DOPT).AHPD            Go to CEEDOPT processing         03857000
.*                                     CEEUOPT processing               03858000
         AIF   (N'&ANYHEAP EQ 0).AHPGEN Go set defaults, mark invalid   03859000
         AIF   ('&ANYHEAP' EQ '()').AHPGEN                              03860000
         AIF   (N'&ANYHEAP LE 4).AHPU1                                  03861000
         MNOTE 8,'Too many suboptions -- ANYHEAP marked invalid.'       03862000
         AGO   .AHPGEN                                                  03863000
.*                                                                      03864000
.AHPU1   ANOP                          Initial size processing          03865000
         AIF   ('&ANYHEAP(1)' EQ '').AHPU4 If null, work on incr size   03866000
&TEMPSTR SETC  '&ANYHEAP(1)'           Obtain initial size suboption    03867000
         AIF   ('&TEMPSTR'(1,1) NE '-').AHPU2                           03868000
         MNOTE 8,'ANYHEAP initial size may not have a minus sign:'      03869000
         MNOTE 8,'it has been set to &INITSIZ and marked invalid.'      03870000
&ALLOK   SETB  0                       Indicate option invalid          03871000
         AGO   .AHPU4                  Go to incr size processing       03872000
.*                                                                      03873000
.AHPU2   ANOP                                                           03874000
         CEEXCALC &ANYHEAP(1)          Obtain &VALUE and &CALCOK        03875000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            03876000
         AIF   (&CALCOK).AHPU3         If CEEXCALC OK, suboption valid  03877000
&ALLOK   SETB  0                       Indicate option invalid          03878000
         AGO   .AHPU4                  Go to incr size processing       03879000
.*                                                                      03880000
.AHPU3   ANOP                          Set 1st suboption valid bit on   03881000
&VALBITS SETA  &VALBITS+&BIT1                                           03882000
&AHTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             03883000
&AHTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             03884000
.*                                                                      03885000
.AHPU4   ANOP                          Increment size processing        03886000
         AIF   ('&ANYHEAP(2)' EQ '').AHPU7 If null, work on location    03887000
&TEMPSTR SETC  '&ANYHEAP(2)'           Obtain increment size suboption  03888000
         AIF   ('&TEMPSTR'(1,1) NE '-').AHPU5                           03889000
         MNOTE 8,'ANYHEAP increment size may not have a minus sign:'    03890000
         MNOTE 8,'it has been set to &INCRSIZ and marked invalid.'      03891000
&ALLOK   SETB  0                       Indicate option invalid          03892000
         AGO   .AHPU7                  Go to location processing        03893000
.*                                                                      03894000
.AHPU5   ANOP                                                           03895000
         CEEXCALC &ANYHEAP(2)          Obtain &VALUE and &CALCOK        03896000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            03897000
         AIF   (&CALCOK).AHPU6         If CEEXCALC OK, suboption valid  03898000
&ALLOK   SETB  0                       Indicate option invalid          03899000
         AGO   .AHPU7                  Go to location processing        03900000
.*                                                                      03901000
.AHPU6   ANOP                                                           03902000
&VALBITS SETA  &VALBITS+&BIT2          Set 2nd suboption valid bit on   03903000
&AHRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             03904000
&AHRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             03905000
.*                                                                      03906000
.AHPU7   ANOP                          Location processing              03907000
&LOCDISP SETA  &ANYWHR                 Set location default             03908000
         AIF   ('&ANYHEAP(3)' EQ '').AHPU10 If null, go to disposition  03909000
         AIF   ('&ANYHEAP(3)' EQ 'BELOW').AHPU8                         03910000
         AIF   ('&ANYHEAP(3)' EQ 'ANYWHERE' OR                         X03911000
               '&ANYHEAP(3)' EQ 'ANY').AHPU9                            03912000
         MNOTE 8,'ANYHEAP location unrecognized -- it'                  03913000
         MNOTE 8,'has been set to ANYWHERE and marked invalid.'         03914000
&ALLOK   SETB  0                       Indicate option invalid          03915000
         AGO   .AHPU10                 Go to disposition processing     03916000
.*                                                                      03917000
.AHPU8   ANOP                          Set location to below            03918000
&LOCDISP SETA  &BELOW                                                   03919000
.*                                                                      03920000
.AHPU9   ANOP                          Set 3rd suboption valid bit on   03921000
&VALBITS SETA  &VALBITS+&BIT3                                           03922000
.*                                                                      03923000
.AHPU10  ANOP                          Disposition processing           03924000
         AIF   ('&ANYHEAP(4)' NE 'KEEP').AHPU11                         03925000
&LOCDISP SETA  &LOCDISP+&KEEP          Indicate disposition is KEEP     03926000
         AGO   .AHPU12                 Go mark suboption valid          03927000
.*                                                                      03928000
.AHPU11  ANOP                          Set disposition to default FREE  03929000
&LOCDISP SETA  &LOCDISP+&FREE                                           03930000
         AIF   ('&ANYHEAP(4)' EQ 'FREE').AHPU12                         03931000
         AIF   ('&ANYHEAP(4)' EQ '').AHPU13 Avoid setting subopt valid  03932000
         MNOTE 8,'ANYHEAP disposition unrecognized -- it'               03933000
         MNOTE 8,'has been set to FREE and marked invalid.'             03934000
&ALLOK   SETB  0                       Indicate option invalid          03935000
         AGO   .AHPU13                 Go examine ANYHEAP validity      03936000
.*                                                                      03937000
.AHPU12  ANOP                          Set 4th suboption valid bit on   03938000
&VALBITS SETA  &VALBITS+&BIT4                                           03939000
.*                                                                      03940000
.AHPU13  ANOP                          Determine if ANYHEAP opt valid   03941000
         AIF   (NOT &ALLOK).AHPU14     If suboption error, need msg     03942000
         AIF   (&VALBITS EQ &OFF).AHPGEN If off, all suboptions null    03943000
&FLAG    SETA  &FLAG+&VALID            No errors, not all subopts null  03944000
         AGO   .AHPGEN                                                  03945000
.*                                                                      03946000
.AHPU14  ANOP                                                           03947000
         MNOTE 8,'ANYHEAP option marked invalid due to above error(s).' 03948000
         AGO   .AHPGEN                                                  03949000
.*                                                                      03950000
.AHPD    ANOP                          CEEDOPT processing               03951000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          03952000
&VALBITS SETA  &BIT1+&BIT2+&BIT3+&BIT4 Suboption valid bits set on      03953000
         AIF   (N'&ANYHEAP EQ 2).AHPD1                                  03954000
         MNOTE 8,'ANYHEAP requires 2 sublist items: it has been set to' 03955000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 03956000
         AGO   .AHPGEN                                                  03957000
.*                                                                      03958000
.AHPD1   ANOP                          Check # 1st sublist items        03959000
         AIF   (N'&ANYHEAP(1) EQ 4).AHPD2                               03960000
         MNOTE 8,'ANYHEAP(1) requires 4 suboptions: it has been set to' 03961000
         MNOTE 8,'defaults and marked overridable, with valid bits on.' 03962000
         AGO   .AHPGEN                                                  03963000
.*                                                                      03964000
.AHPD2   ANOP                          Initial size processing          03965000
         AIF   ('&ANYHEAP(1,1)' NE '').AHPD3                            03966000
         MNOTE 8,'ANYHEAP must specify an initial size:'                03967000
         MNOTE 8,'it has been set to &INITSIZ..'                        03968000
&ALLOK   SETB  0                       Indicate error detected          03969000
         AGO   .AHPD5                  Go to increment size processing  03970000
.*                                                                      03971000
.AHPD3   ANOP                          Disallow leading minus sign      03972000
&TEMPSTR SETC  '&ANYHEAP(1,1)'         Obtain initial size suboption    03973000
         AIF   ('&TEMPSTR'(1,1) NE '-').AHPD4                           03974000
         MNOTE 8,'ANYHEAP initial size may not begin with'              03975000
         MNOTE 8,'a minus sign.  It has been set to &INITSIZ..'         03976000
&ALLOK   SETB  0                       Indicate error detected          03977000
         AGO   .AHPD5                  Go to increment size processing  03978000
.*                                                                      03979000
.AHPD4   ANOP                                                           03980000
         CEEXCALC &ANYHEAP(1,1)        Obtain &VALUE and &CALCOK        03981000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            03982000
         AIF   (&CALCOK).AHPD4M                                         03983000
&ALLOK   SETB  0                       Indicate error detected          03984000
.*         AGO   .AHPD5                                                 03985000
.AHPD4M  ANOP                                                           03986000
&AHTR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             03987000
&AHTR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             03988000
.*                                                                      03989000
.AHPD5   ANOP                          Increment size processing        03990000
         AIF   ('&ANYHEAP(1,2)' NE '').AHPD6                            03991000
         MNOTE 8,'ANYHEAP must specify an increment size:'              03992000
         MNOTE 8,'it has been set to &INCRSIZ..'                        03993000
&ALLOK   SETB  0                       Indicate error detected          03994000
         AGO   .AHPD8                  Go to location processing        03995000
.*                                                                      03996000
.AHPD6   ANOP                          Disallow leading minus sign      03997000
&TEMPSTR SETC  '&ANYHEAP(1,2)'         Obtain increment size suboption  03998000
         AIF   ('&TEMPSTR'(1,1) NE '-').AHPD7                           03999000
         MNOTE 8,'ANYHEAP increment size may not begin with'            04000000
         MNOTE 8,'a minus sign.  It has been set to &INCRSIZ..'         04001000
&ALLOK   SETB  0                       Indicate error detected          04002000
         AGO   .AHPD8                  Go to location processing        04003000
.*                                                                      04004000
.AHPD7   ANOP                                                           04005000
         CEEXCALC &ANYHEAP(1,2)        Obtain &VALUE and &CALCOK        04006000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            04007000
         AIF   (&CALCOK).AHPD7M                                         04008000
&ALLOK   SETB  0                       Indicate error detected          04009000
.*         AGO   .AHPD8                                                 04010000
.AHPD7M  ANOP                                                           04011000
&AHRR4   SETA  ((&VALUE+4095)/4096)*4096 Calc rounded value             04012000
&AHRR8   SETA  ((&VALUE+7)/8)*8          Calc rounded value             04013000
.*                                                                      04014000
.AHPD8   ANOP                          Location processing              04015000
&LOCDISP SETA  &ANYWHR                 Set location default             04016000
         AIF   ('&ANYHEAP(1,3)' NE '').AHPD9                            04017000
         MNOTE 8,'ANYHEAP must specify a location:'                     04018000
         MNOTE 8,'it has been set to ANYWHERE.'                         04019000
&ALLOK   SETB  0                       Indicate error detected          04020000
         AGO   .AHPD11                 Go to disposition processing     04021000
.*                                                                      04022000
.AHPD9   ANOP                                                           04023000
         AIF   ('&ANYHEAP(1,3)' EQ 'BELOW').AHPD10                      04024000
         AIF   ('&ANYHEAP(1,3)' EQ 'ANYWHERE' OR                       X04025000
               '&ANYHEAP(1,3)' EQ 'ANY').AHPD11                         04026000
         MNOTE 8,'ANYHEAP location unrecognized:'                       04027000
         MNOTE 8,'it has been set to ANYWHERE.'                         04028000
&ALLOK   SETB  0                       Indicate error detected          04029000
         AGO   .AHPD11                 Go to disposition processing     04030000
.*                                                                      04031000
.AHPD10  ANOP                          Set location to below            04032000
&LOCDISP SETA  &BELOW                                                   04033000
.*                                                                      04034000
.AHPD11  ANOP                          Disposition processing           04035000
         AIF   ('&ANYHEAP(1,4)' NE 'KEEP').AHPD12                       04036000
&LOCDISP SETA  &LOCDISP+&KEEP          Indicate disposition is KEEP     04037000
         AGO   .AHPD14                 Go check 2nd sublist item        04038000
.*                                                                      04039000
.AHPD12  ANOP                          Set disposition to default FREE  04040000
&LOCDISP SETA  &LOCDISP+&FREE                                           04041000
         AIF   ('&ANYHEAP(1,4)' NE '').AHPD13                           04042000
         MNOTE 8,'ANYHEAP must specify a disposition:'                  04043000
         MNOTE 8,'it has been set to FREE.'                             04044000
&ALLOK   SETB  0                       Indicate error detected          04045000
         AGO   .AHPD14                 Go check 2nd sublist item        04046000
.*                                                                      04047000
.AHPD13  ANOP                                                           04048000
         AIF   ('&ANYHEAP(1,4)' EQ 'FREE').AHPD14                       04049000
         MNOTE 8,'ANYHEAP disposition unrecognized:'                    04050000
         MNOTE 8,'it has been set to FREE.'                             04051000
&ALLOK   SETB  0                       Indicate error detected          04052000
.*                                                                      04053000
.AHPD14  ANOP                          Check 2nd sublist item           04054000
         AIF   ('&ANYHEAP(2)' NE 'OVR' AND                             X04055000
               '&ANYHEAP(2)' NE 'NONOVR').AHPD15                        04056000
         AIF   (NOT &ALLOK).AHPD16     If errors, force overridable     04057000
         AIF   ('&ANYHEAP(2)' EQ 'OVR').AHPGEN                          04058000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  04059000
         AGO   .AHPGEN                                                  04060000
.*                                                                      04061000
.AHPD15  ANOP                                                           04062000
         MNOTE 8,'Last ANYHEAP sublist item must be OVR or NONOVR.'     04063000
.*                                                                      04064000
.AHPD16  ANOP                                                           04065000
         MNOTE 8,'Due to error(s) detected above, ANYHEAP has'          04066000
         MNOTE 8,'been set overridable (with valid bits on).'           04067000
.*                                                                      04068000
.AHPGEN  ANOP                                                           04069000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 04070000
         DC    X'00'                   Unused                           04071000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   04072000
         DC    A(AHP_SUB-&SYSECT)      Offset of suboptions block       04073000
*                                                                       04074000
SUB      LOCTR                                                          04075000
AHP_SUB  DS    0F                      ANYHEAP suboptions block         04076000
         DC    AL1(&VALBITS)           Suboption valid bits             04077000
         DC    AL3(0)                  Unused suboption valid bits      04078000
         DC    F'&INITSIZ'             ANYHEAP initial size             04079000
         DC    F'&INCRSIZ'             ANYHEAP increment size           04080000
         DC    AL1(&LOCDISP)           128 = BELOW, 64 = FREE           04081000
         DC    3X'00'                  Unused                           04082000
*                                                                       04083000
&SYSECT  LOCTR                                                          04084000
*                                                                       04085000
.********************************************************************** 04086000
*    ABPERC option                                                      04087000
.********************************************************************** 04088000
&FLAG    SETA  &ON                     Options flag initialized         04089000
&VALBITS SETA  &OFF*(&BIT1)                                             04090000
&ABTYPE  SETA  &BIT1                   Default parameter NONE           04091000
&ABNUM   SETC  'F''0'''                Default numeric part of abcode   04092000
&ABCODE  SETC  ' '                     Default abcode blank             04093000
&ALLOK   SETB  1                       Suboptions assumed error-free    04094000
         AIF   (&DOPT).ABPD            Go to CEEDOPT processing         04095000
.*                                     CEEUOPT processing               04096000
         AIF   (N'&ABPERC EQ 0).ABPGEN                                  04097000
         AIF   ('&ABPERC' EQ '()').ABPGEN                               04098000
         AIF   (N'&ABPERC EQ 1).ABPU1                                   04099000
         MNOTE 8,'Too many suboptions -- ABPERC marked invalid.'        04100000
         AGO   .ABPGEN                                                  04101000
.*                                                                      04102000
.ABPU1   ANOP                                                           04103000
         CEEXAPRC &ABPERC(1)           Get &ABTYPE, &ABNUM, &APRCOK     04104000
         AIF   (&APRCOK).ABPU2                                          04105000
         MNOTE 8,'ABPERC option marked invalid due to above error.'     04106000
         AGO   .ABPGEN                                                  04107000
.*                                                                      04108000
.ABPU2   ANOP                                                           04109000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          04110000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       04111000
         AIF   ('&ABPERC(1)' EQ 'NONE').ABPGEN                          04112000
&ABCODE  SETC  '&ABPERC(1)'            Set abcode to value passed       04113000
         AGO   .ABPGEN                                                  04114000
.*                                                                      04115000
.ABPD    ANOP                          CEEDOPT processing               04116000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          04117000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       04118000
         AIF   (N'&ABPERC EQ 2).ABPD1                                   04119000
         MNOTE 8,'ABPERC requires 2 sublist items: it has been'         04120000
         MNOTE 8,'set to NONE and overridable, with valid bits on.'     04121000
         AGO   .ABPGEN                                                  04122000
.*                                                                      04123000
.ABPD1   ANOP                          Check # 1st sublist items        04124000
         AIF   (N'&ABPERC(1) EQ 1).ABPD2                                04125000
         MNOTE 8,'ABPERC(1) requires exactly 1 sublist item: ABPERC'    04126000
         MNOTE 8,'set to NONE and overridable, with valid bits on.'     04127000
         AGO   .ABPGEN                                                  04128000
.*                                                                      04129000
.ABPD2   ANOP                          Disallow empty parentheses       04130000
         AIF   ('&ABPERC(1)' NE '()').ABPD3                             04131000
         MNOTE 8,'ABPERC(1) requires exactly 1 sublist item: ABPERC'    04132000
         MNOTE 8,'set to NONE and overridable, with valid bits on.'     04133000
         AGO   .ABPGEN                                                  04134000
.*                                                                      04135000
.ABPD3   ANOP                                                           04136000
         CEEXAPRC &ABPERC(1,1)         Get &ABTYPE, &ABNUM, &APRCOK     04137000
         AIF   (&APRCOK).ABPD4                                          04138000
&ALLOK   SETB  0                       Indicate error detected          04139000
         AGO   .ABPD5                  Go check 2nd sublist item        04140000
.*                                                                      04141000
.ABPD4   ANOP                                                           04142000
         AIF   ('&ABPERC(1,1)' EQ 'NONE').ABPD5                         04143000
&ABCODE  SETC  '&ABPERC(1,1)'          Set abcode to value passed       04144000
.*                                                                      04145000
.ABPD5   ANOP                          Check 2nd sublist item           04146000
         AIF   ('&ABPERC(2)' NE 'OVR' AND                              X04147000
               '&ABPERC(2)' NE 'NONOVR').ABPD6                          04148000
         AIF   (NOT &ALLOK).ABPD7      If errors, force overridable     04149000
         AIF   ('&ABPERC(2)' EQ 'OVR').ABPGEN                           04150000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  04151000
         AGO   .ABPGEN                                                  04152000
.*                                                                      04153000
.ABPD6   ANOP                                                           04154000
         MNOTE 8,'Last ABPERC sublist item must be OVR or NONOVR.'      04155000
.*                                                                      04156000
.ABPD7   ANOP                                                           04157000
         MNOTE 8,'Due to error(s) detected above, ABPERC has'           04158000
         MNOTE 8,'been set overridable (with valid bits on).'           04159000
         AGO   .ABPGEN                                                  04160000
.*                                                                      04161000
.ABPGEN  ANOP                                                           04162000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 04163000
         DC    X'00'                   Unused                           04164000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   04165000
         DC    A(ABP_SUB-&SYSECT)      Offset of suboptions block       04166000
*                                                                       04167000
SUB      LOCTR                                                          04168000
ABP_SUB  DS    0F                      ABPERC suboptions block          04169000
         DC    AL1(&VALBITS)           Suboption valid bits             04170000
         DC    AL3(0)                  Unused suboption valid bits      04171000
         DC    AL1(&ABTYPE)            128=NONE, 64=U, 32=S, 16=x, 8=I  04172000
         DC    AL3(0)                  Unused                           04173000
         DC    &ABNUM                  Numeric portion of U/S/I abcode  04174000
         DC    CL8'&ABCODE'            Abcode (blank-padded)            04175000
*                                                                       04176000
&SYSECT  LOCTR                                                          04177000
*                                                                       04178000
.********************************************************************** 04179000
*    TERMTHDACT option                                                  04180000
.********************************************************************** 04181000
&FLAG    SETA  &ON                     Options flag initialized         04182000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3)                            @03C 04183000
&TERLEVL SETC  '&TERTRACE'             Default information level        04184000
&CICSDEST SETC '&MSGFL'                 Default CICS Destination   @03A 04185000
&REGSTOR SETA  0                       Default reg_stor_amount     @03A 04186000
&STORMAX SETA  256                     Maximum reg_stor_amount     @03A 04187000
                                                                        04188000
&ALLOK   SETB  1                       Suboptions assumed error-free    04189000
         AIF   (&DOPT).TERD            Go to CEEDOPT processing         04190000
.*                                     CEEUOPT processing               04191000
         AIF   (N'&TERMTHDACT EQ 0).TERGEN                              04192000
         AIF   ('&TERMTHDACT' EQ '()').TERGEN                           04193000
         AIF   (N'&TERMTHDACT LE 3).TERU1                          @05C 04194590
         MNOTE 8,'Too many suboptions -- TERMTHDACT marked invalid.'    04195180
         AGO   .TERGEN                                                  04196000
.*                                                                      04197000
.TERU1   ANOP                          Check information level          04198000
         AIF   ('&TERMTHDACT(1)' EQ 'QUIET').TERU2                      04199000
         AIF   ('&TERMTHDACT(1)' EQ 'TRACE').TERU5                      04200000
         AIF   ('&TERMTHDACT(1)' EQ 'MSG').TERU3                        04201000
         AIF   ('&TERMTHDACT(1)' EQ 'DUMP').TERU4                       04202000
         AIF   ('&TERMTHDACT(1)' EQ 'UADUMP').TERU31                    04203000
         MNOTE 8,'TERMTHDACT suboption not recognized: it'              04204000
         MNOTE 8,'has been set to TRACE and marked invalid.'       @03C 04205000
         AGO   .TERU5C                 Go check cicsdest           @03C 04206000
.*                                                                      04207000
.TERU2   ANOP                          Set information level to QUIET   04208000
&TERLEVL SETC  '&QUIET'                                                 04209000
         AGO   .TERU5                  Go mark option valid             04210000
.*                                                                      04211000
.TERU3   ANOP                          Set information level to MSG     04212000
&TERLEVL SETC  '&MSG'                                                   04213000
         AGO   .TERU5                  Go mark option valid             04214000
.*                                                                      04215000
.TERU31  ANOP                          Set information level to UADUMP  04216000
&TERLEVL SETC  '&UADUMP'                                                04217000
         AGO   .TERU5                  Go mark option valid             04218000
.*                                                                      04219000
.TERU4   ANOP                          Set information level to DUMP    04220000
&TERLEVL SETC  '&DUMP'                                                  04221000
.*                                                                      04222000
.TERU5   ANOP                          TERMTHDACT valid string          04223000
.* Start of @03A Processing                                             04224000
.* Validate cicsdest CICSDDS/MSGFL suboption                            04225000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       04226000
.TERU5C  ANOP                          TERMTHDACT valid string          04227000
         AIF   ('&TERMTHDACT(2)' EQ '').TERU8                           04228000
         AIF   ('&TERMTHDACT(2)' EQ 'LSTQ').TERU6                       04229000
         AIF   ('&TERMTHDACT(2)' EQ 'MSGFL').TERU7                      04230000
         MNOTE 8,'TERMTHDACT dump destination suboption '               04231000
         MNOTE 8,'not recognized. It has been '                         04232000
         MNOTE 8,'set to MSGFL and marked invalid.'                     04233000
         AGO   .TERU8                 Go process reg_stor_amount        04234000
.TERU6   ANOP                                                           04235000
&CICSDEST SETC  '&LSTQ'                                                 04236000
.TERU7   ANOP                          CICSDEST suboption valid         04237000
&VALBITS SETA  &VALBITS+&BIT2          Suboption valid bit set on       04238000
.TERU8   ANOP                          Set cisdest to MSGFL             04239000
.* Validate reg_stor_amount suboption                                   04240000
          AIF   ('&TERMTHDACT(3)' EQ '').TERU11                         04241000
&TMPSTOR  SETC '&TERMTHDACT(3)'       Check for negative value          04242000
          AIF ('&TMPSTOR'(1,1) EQ '-').TERU9                            04243000
&REGSTOR  SETA &TERMTHDACT(3)                                           04244000
          AIF (&REGSTOR GT &STORMAX).TERU9                              04245000
          AGO .TERU10                                                   04246000
.TERU9    ANOP                        REGSTOR value is invalid          04247000
&REGSTOR  SETA 0                                                        04248000
         MNOTE 8,'TERMTHDACT reg_stor_amount suboption '                04249000
         MNOTE 8,'is not in the valid range 0-256. It has '             04250000
         MNOTE 8,'been set to 0 and marked invalid.'                    04251000
         AGO   .TERU11                Go check for option conflict      04252000
.TERU10  ANOP                         Value valid. Round it             04253000
&VALBITS SETA  &VALBITS+&BIT3         Suboption valid bit set on        04254000
&REGSTOR SETA  ((&REGSTOR+31)/32)*32 Multiple of 32                     04255000
.TERU11  ANOP                         Check for option conflict         04256000
         AIF  (&CICSDEST NE &LSTQ).TERU12                               04257000
         AIF  (&TERLEVL EQ &TERTRACE).TERU12                            04258000
         AIF  (&TERLEVL EQ &DUMP).TERU12                                04259000
         AIF  (&TERLEVL EQ &UADUMP).TERU12                              04260000
&VALBITS SETA (&VALBITS AND NOT &BIT1)                                  04261000
&TERLEVL SETC '&TERTRACE'                                               04262000
         MNOTE 8,'The TERMTHDACT level setting of &TERMTHDACT(1)'       04263000
         MNOTE 8,'conflicts with the LSTQ suboption.'                   04264000
         MNOTE 8,'A level of at least TRACE must be used with LSTQ.'    04265000
         MNOTE 8,'The termthdact level suboption'                       04266000
         MNOTE 8,'was set to TRACE and marked invalid.'                 04267000
         AGO   .TERU13                                                  04268000
.TERU12  ANOP                                                           04269000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          04270000
.TERU13  ANOP                                                           04271000
.* End of @03A processing                                               04272000
         AGO   .TERGEN                                                  04273000
.*                                                                      04274000
.TERD    ANOP                          CEEDOPT processing               04275000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          04276000
&VALBITS SETA  &BIT1+&BIT2+&BIT3       Suboption valid bit set on  @03C 04277000
         AIF   (N'&TERMTHDACT EQ 2).TERD1                               04278000
         MNOTE 8,'TERMTHDACT requires 2 sublist items: it has been'     04279000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   04280000
         AGO   .TERGEN                                                  04281000
.*                                                                      04282000
.TERD1   ANOP                          Check # 1st sublist items        04283000
         AIF   (N'&TERMTHDACT(1) EQ 3).TERD2                       @03C 04284000
         MNOTE 8,'TERMTHDACT(1) requires exactly 3 items: TERMTHDACT'   04285000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   04286000
         AGO   .TERGEN                                                  04287000
.*                                                                      04288000
.TERD2   ANOP                          Disallow empty parentheses       04289000
         AIF   ('&TERMTHDACT(1)' NE '()').TERD3                         04290000
         MNOTE 8,'TERMTHDACT(1) requires exactly 3 items: TERMTHDACT'   04291000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   04292000
         AGO   .TERGEN                                                  04293000
.*                                                                      04294000
.TERD3   ANOP                          Check information level          04295000
         AIF   ('&TERMTHDACT(1,1)' EQ 'QUIET').TERD4                    04296000
         AIF   ('&TERMTHDACT(1,1)' EQ 'TRACE').TERD7                    04297000
         AIF   ('&TERMTHDACT(1,1)' EQ 'MSG').TERD5                      04298000
         AIF   ('&TERMTHDACT(1,1)' EQ 'DUMP').TERD6                     04299000
         AIF   ('&TERMTHDACT(1,1)' EQ 'UADUMP').TERD51                  04300000
         MNOTE 8,'TERMTHDACT information level not'                     04301000
         MNOTE 8,'recognized: it has been set to TRACE.'     @03C       04302000
&ALLOK   SETB  0                       Indicate error detected          04303000
         AGO   .TERD7                  Go check 2nd sublist item        04304000
.*                                                                      04305000
.TERD4   ANOP                          Set information level to QUIET   04306000
&TERLEVL SETC  '&QUIET'                                                 04307000
         AGO   .TERD7                  Go check 2nd sublist item        04308000
.*                                                                      04309000
.TERD5   ANOP                          Set information level to MSG     04310000
&TERLEVL SETC  '&MSG'                                                   04311000
         AGO   .TERD7                  Go check 2nd sublist item        04312000
.*                                                                      04313000
.TERD51  ANOP                          Set information level to UADUMP  04314000
&TERLEVL SETC  '&UADUMP'                                                04315000
         AGO   .TERD7                  Go check 2nd sublist item        04316000
.*                                                                      04317000
.TERD6   ANOP                          Set information level to DUMP    04318000
&TERLEVL SETC  '&DUMP'                                                  04319000
.*                                                                      04320000
.* Start of @03A processing                                             04321000
.TERD7   ANOP                          Check 2nd parameter              04322000
         AIF   ('&TERMTHDACT(1,2)' EQ '').TERD7E                        04323000
         AIF   ('&TERMTHDACT(1,2)' EQ 'MSGFL').TERD7E                   04324000
         AIF   ('&TERMTHDACT(1,2)' EQ 'LSTQ').TERD7C                    04325000
         MNOTE 8,'TERMTHDACT dump destination suboption '               04326000
         MNOTE 8,'not recognized.It has been set to MSGFL'              04327000
&ALLOK   SETB  0                       Indicate error detected          04328000
         AGO   .TERD7E                 Go validate reg_stor_amount      04329000
.TERD7C  ANOP                                                           04330000
&CICSDEST SETC  '&LSTQ'                                                 04331000
.* Validate reg_stor_amount suboption                                   04332000
.TERD7E   ANOP                                                          04333000
&TMPSTOR  SETC '&TERMTHDACT(1,3)'     Check for negative value          04334000
          AIF ('&TMPSTOR'(1,1) EQ '-').TERD7F                           04335000
&REGSTOR  SETA &TERMTHDACT(1,3)                                         04336000
          AIF (&REGSTOR GT &STORMAX).TERD7F                             04337000
          AGO .TERD7H                                                   04338000
.TERD7F   ANOP                        REGSTOR value is invalid          04339000
&REGSTOR  SETA 0                                                        04340000
         MNOTE 8,'TERMTHDACT reg_stor_amount suboption '                04341000
         MNOTE 8,'is not in the valid range 0-256. It has been'         04342000
         MNOTE 8,'set to 0.'                                            04343000
&ALLOK   SETB  0                       Indicate error detected          04344000
         AGO   .TERD7J                                                  04345000
.TERD7H   ANOP                                                          04346000
&REGSTOR SETA  ((&REGSTOR+31)/32)*32 Multiple of 32                     04347000
.*                                                                      04348000
.TERD7J   ANOP                         Check for option conflict        04349000
         AIF  (&CICSDEST NE &LSTQ).TERD7L                               04350000
         AIF  (&TERLEVL EQ &TERTRACE).TERU12                            04351000
         AIF  (&TERLEVL EQ &DUMP).TERU12                                04352000
         AIF  (&TERLEVL EQ &UADUMP).TERU12                              04353000
&TERLEVL SETC '&TERTRACE'                                               04354000
         MNOTE 8,'The TERMTHDACT level setting of &TERMTHDACT(1,1)'     04355000
         MNOTE 8,'conflicts with the LSTQ suboption.'                   04356000
         MNOTE 8,'A level of at least TRACE must be used with LSTQ.'    04357000
         MNOTE 8,'The termthdact level suboption'                       04358000
         MNOTE 8,'was set to TRACE.'                                    04359000
&ALLOK   SETB  0                       Indicate error detected          04360000
.TERD7L   ANOP                                                          04361000
.* End of @03A processing                                               04362000
         AIF   ('&TERMTHDACT(2)' NE 'OVR' AND                          X04363000
               '&TERMTHDACT(2)' NE 'NONOVR').TERD8                      04364000
         AIF   (NOT &ALLOK).TERD9      If errors, force overridable     04365000
         AIF   ('&TERMTHDACT(2)' EQ 'OVR').TERGEN                       04366000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  04367000
         AGO   .TERGEN                                                  04368000
.*                                                                      04369000
.TERD8   ANOP                                                           04370000
         MNOTE 8,'Last TERMTHDACT sublist item must be OVR or NONOVR.'  04371000
.*                                                                      04372000
.TERD9   ANOP                                                           04373000
         MNOTE 8,'Due to error(s) detected above, TERMTHDACT has'       04374000
         MNOTE 8,'been set overridable (with valid bits on).'           04375000
.*                                                                      04376000
.TERGEN  ANOP                                                           04377000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 04378000
         DC    X'00'                   Unused                           04379000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   04380000
         DC    A(TER_SUB-&SYSECT)      Offset of suboptions block       04381000
*                                                                       04382000
SUB      LOCTR                                                          04383000
TER_SUB  DS    0F                      TERMTHDACT suboptions block      04384000
         DC    AL1(&VALBITS)           Suboption valid bits             04385000
         DC    AL3(0)                  Unused suboption valid bits      04386000
         DC    F'&TERLEVL'       16=UADUMP,8=QUIET,4=MSG,2=TRACE,1=DUMP 04387000
.*                                     2=TRACE,1=DUMP                   04388000
         DC    AL1(&CICSDEST)          128=MSGFL,64=LSTQ           @03A 04389000
         DC    AL3(0)                  Unused                      @03A 04390000
         DC    H'&REGSTOR'             reg_stor_amount suboption   @03A 04391000
         DC    AL2(0)                  Unused                      @03A 04392000
*                                                                       04393000
&SYSECT  LOCTR                                                          04394000
*                                                                       04395000
.********************************************************************** 04396000
*    DEPTHCONDLMT option                                                04397000
.********************************************************************** 04398000
&FLAG    SETA  &ON                     Options flag initialized         04399000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 04400000
&DEPLMT  SETC  '10'                    Depth cond limit initialized     04401000
&ALLOK   SETB  1                       Suboptions assumed error-free    04402000
         AIF   (&DOPT).DEPD            Go to CEEDOPT processing         04403000
.*                                     CEEUOPT processing               04404000
         AIF   (N'&DEPTHCONDLMT EQ 0).DEPGEN                            04405000
         AIF   ('&DEPTHCONDLMT' EQ '()').DEPGEN                         04406000
         AIF   (N'&DEPTHCONDLMT EQ 1).DEPU1                             04407000
         MNOTE 8,'Too many suboptions -- DEPTHCONDLMT marked invalid.'  04408000
         AGO   .DEPGEN                                                  04409000
.*                                                                      04410000
.DEPU1   ANOP                          Disallow leading minus sign      04411000
&TEMPSTR SETC  '&DEPTHCONDLMT(1)'      Obtain depth limit suboption     04412000
         AIF   ('&TEMPSTR'(1,1) NE '-').DEPU2                           04413000
         MNOTE 8,'DEPTHCONDLMT may not have a minus sign: it'           04414000
         MNOTE 8,'has been set to &DEPLMT and marked invalid.'          04415000
         AGO   .DEPGEN                                                  04416000
.*                                                                      04417000
.DEPU2   ANOP                          Assume depthcondlmt numeric      04418000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          04419000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       04420000
&DEPLMT  SETC  '&DEPTHCONDLMT(1)'      Depth limit set to value passed  04421000
         AGO   .DEPGEN                                                  04422000
.*                                                                      04423000
.DEPD    ANOP                          CEEDOPT processing               04424000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          04425000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       04426000
         AIF   (N'&DEPTHCONDLMT EQ 2).DEPD1                             04427000
         MNOTE 8,'DEPTHCONDLMT requires 2 sublist items: it has been'   04428000
         MNOTE 8,'set to &DEPLMT, overridable, with valid bits on.'     04429000
         AGO   .DEPGEN                                                  04430000
.*                                                                      04431000
.DEPD1   ANOP                          Check # 1st sublist items        04432000
         AIF   (N'&DEPTHCONDLMT(1) EQ 1).DEPD2                          04433000
         MNOTE 8,'DEPTHCONDLMT(1) needs exactly 1 sublist item:'        04434000
         MNOTE 8,'DEPTHCONDLMT set to &DEPLMT and overridable,'         04435000
         MNOTE 8,'with valid bits on.'                                  04436000
         AGO   .DEPGEN                                                  04437000
.*                                                                      04438000
.DEPD2   ANOP                          Disallow empty parentheses       04439000
         AIF   ('&DEPTHCONDLMT(1)' NE '()').DEPD3                       04440000
         MNOTE 8,'DEPTHCONDLMT(1) needs exactly 1 sublist item:'        04441000
         MNOTE 8,'DEPTHCONDLMT set to &DEPLMT and overridable,'         04442000
         MNOTE 8,'with valid bits on.'                                  04443000
         AGO   .DEPGEN                                                  04444000
.*                                                                      04445000
.DEPD3   ANOP                          Disallow leading minus sign      04446000
&TEMPSTR SETC  '&DEPTHCONDLMT(1,1)'    Obtain depth cond limit subopt   04447000
         AIF   ('&TEMPSTR'(1,1) NE '-').DEPD4                           04448000
         MNOTE 8,'DEPTHCONDLMT may not have a minus sign:'              04449000
         MNOTE 8,'it has been set to &DEPLMT..'                         04450000
&ALLOK   SETB  0                       Indicate error detected          04451000
         AGO   .DEPD5                  Go check 2nd sublist item        04452000
.*                                                                      04453000
.DEPD4   ANOP                          Assume depth cond limit numeric  04454000
&DEPLMT  SETC  '&DEPTHCONDLMT(1,1)'    Depth limit set to value passed  04455000
.*                                                                      04456000
.DEPD5   ANOP                          Check 2nd sublist item           04457000
         AIF   ('&DEPTHCONDLMT(2)' NE 'OVR' AND                        X04458000
               '&DEPTHCONDLMT(2)' NE 'NONOVR').DEPD6                    04459000
         AIF   (NOT &ALLOK).DEPD7      If errors, force overridable     04460000
         AIF   ('&DEPTHCONDLMT(2)' EQ 'OVR').DEPGEN                     04461000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  04462000
         AGO   .DEPGEN                                                  04463000
.*                                                                      04464000
.DEPD6   ANOP                                                           04465000
         MNOTE 8,'Last DEPTHCONDLMT sublist item must be OVR or'        04466000
         MNOTE 8,'NONOVR.'                                              04467000
.*                                                                      04468000
.DEPD7   ANOP                                                           04469000
         MNOTE 8,'Due to error(s) detected above, DEPTHCONDLMT has'     04470000
         MNOTE 8,'been set overridable (with valid bits on).'           04471000
.*                                                                      04472000
.DEPGEN  ANOP                                                           04473000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 04474000
         DC    X'00'                   Unused                           04475000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   04476000
         DC    A(DEP_SUB-&SYSECT)      Offset of suboptions block       04477000
*                                                                       04478000
SUB      LOCTR                                                          04479000
DEP_SUB  DS    0F                      DEPTHCONDLMT suboptions block    04480000
         DC    AL1(&VALBITS)           Suboption valid bits             04481000
         DC    AL3(0)                  Unused suboption valid bits      04482000
         DC    F'&DEPLMT'              DEPTHCONDLMT # condition limit   04483000
*                                                                       04484000
&SYSECT  LOCTR                                                          04485000
*                                                                       04486000
.********************************************************************** 04487000
*    CBLPSHPOP option                                                   04488000
.********************************************************************** 04489000
         CEEXSIMP CBLPSHPOP,&CBLPSHPOP                                  04490000
.********************************************************************** 04491000
*    CBLQDA option - Unsupported in this release of LE/VSE              04492000
.********************************************************************** 04493000
.*       CEEXSIMP CBLQDA,&CBLQDA                                        04494000
         CEEXHARD &OFF                 Disable this option this release 04495000
.********************************************************************** 04496000
*    PUNUNIT option - Unsupported in this release of LE/VSE             04497000
.********************************************************************** 04498000
&FLAG    SETA  &ON+&DOPT               Options flag initialized         04499000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 04500000
&PUNNUM  SETC  '7'                     Pununit initialized              04501000
&ALLOK   SETB  1                       Suboptions assumed error-free    04502000
.*                                                                      04503000
.PUNGEN  ANOP                                                           04504000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 04505000
         DC    X'00'                   Unused                           04506000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   04507000
         DC    A(PUN_SUB-&SYSECT)      Offset of suboptions block       04508000
*                                                                       04509000
SUB      LOCTR                                                          04510000
PUN_SUB  DS    0F                      PUNUNIT suboptions block         04511000
         DC    AL1(&VALBITS)           Suboption valid bits             04512000
         DC    AL3(0)                  Unused suboption valid bits      04513000
         DC    F'&PUNNUM'              PUNUNIT # non-fatal errors       04514000
*                                                                       04515000
&SYSECT  LOCTR                                                          04516000
*                                                                       04517000
.********************************************************************** 04518000
*    RDRUNIT option - Unsupported in this release of LE/VSE             04519000
.********************************************************************** 04520000
&FLAG    SETA  &ON+&DOPT               Options flag initialized         04521000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 04522000
&RDRNUM  SETC  '5'                     Rdrunit initialized              04523000
&ALLOK   SETB  1                       Suboptions assumed error-free    04524000
.*                                                                      04525000
.RDRGEN  ANOP                                                           04526000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 04527000
         DC    X'00'                   Unused                           04528000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   04529000
         DC    A(RDR_SUB-&SYSECT)      Offset of suboptions block       04530000
*                                                                       04531000
SUB      LOCTR                                                          04532000
RDR_SUB  DS    0F                      RDRUNIT suboptions block         04533000
         DC    AL1(&VALBITS)           Suboption valid bits             04534000
         DC    AL3(0)                  Unused suboption valid bits      04535000
         DC    F'&RDRNUM'              RDRUNIT # non-fatal errors       04536000
*                                                                       04537000
&SYSECT  LOCTR                                                          04538000
*                                                                       04539000
.********************************************************************** 04540000
*    RECPAD option - Unsupported in this release of LE/VSE              04541000
.********************************************************************** 04542000
&FLAG    SETA  &ON+&DOPT               Options flag initialized         04543000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 04544000
&RECLEVL SETC  '&OFFREC'               Default recpad level             04545000
&ALLOK   SETB  1                       Suboptions assumed error-free    04546000
.*                                                                      04547000
.RECGEN  ANOP                                                           04548000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 04549000
         DC    X'00'                   Unused                           04550000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   04551000
         DC    A(REC_SUB-&SYSECT)      Offset of suboptions block       04552000
*                                                                       04553000
SUB      LOCTR                                                          04554000
REC_SUB  DS    0F                      RECPAD suboptions block          04555000
         DC    AL1(&VALBITS)           Suboption valid bits             04556000
         DC    AL3(0)                  Unused suboption valid bits      04557000
         DC    F'&RECLEVL'             4 = OFF, 2 = ON, 1 = VAR         04558000
*                                                                       04559000
&SYSECT  LOCTR                                                          04560000
*                                                                       04561000
.********************************************************************** 04562000
*    USRHDLR option                                                     04563000
.********************************************************************** 04564000
&UHOPT   SETC  'NOUSRHDLR'             Assumed NOUSRHDLR specified      04565000
&FLAG    SETA  &OFF                    Options flag initialized         04566000
&VALBITS SETA  &OFF*(&BIT1)            Suboption valid bits initialized 04567000
&UHNAME  SETC  ' '                     Default user hdlr routine name   04568000
&UHLEN   SETC  '0'                     Default length of routine name   04569000
&UHALLOK SETB  1                      Suboptions assumed error-free@02C 04570000
         AIF   (&DOPT).UHD             Go to CEEDOPT processing         04571000
.*                                     CEEUOPT processing               04572000
         AIF   (N'&USRHDLR EQ 0 OR N'&NOUSRHDLR EQ 0).UHU1              04573000
         MNOTE 8,'Macro has been invoked with both USRHDLR and'         04574000
         MNOTE 8,'NOUSRHDLR: This option has been set off and'          04575000
         MNOTE 8,'marked invalid.'                                      04576000
         AGO   .UHGEN                                                   04577000
.*                                                                      04578000
.UHU1    ANOP                          Check if neither option passed   04579000
         AIF   (N'&USRHDLR EQ 0 AND N'&NOUSRHDLR EQ 0).UHGEN            04580000
         AIF   (N'&USRHDLR NE 0).UHU3  Go to setup for USRHDLR option   04581000
.*                                     NOUSRHDLR only was specified     04582000
         AIF   ('&NOUSRHDLR' EQ '()').UHGEN                             04583000
         AIF   (N'&NOUSRHDLR EQ 1).UHU2                                 04584000
         MNOTE 8,'Too many suboptions -- NOUSRHDLR marked invalid.'     04585000
.UHU2    ANOP                          Name ignored for NOUSRHDLR       04586000
         AGO   .UHGEN                                                   04587000
.UHU3    ANOP                          USRHDLR only was specified       04588000
&UHOPT   SETC  'USRHDLR'               Indicate USRHDLR specified       04589000
&FLAG    SETA  &ON                     Options flag for USRHDLR         04590000
         AIF   ('&USRHDLR' EQ '()').UHGEN                               04591000
         AIF   (N'&USRHDLR EQ 1).UHU4                                   04592000
         MNOTE 8,'Too many suboptions -- USRHDLR marked invalid.'       04593000
         AGO   .UHGEN                                                   04594000
.*                                                                      04595000
.UHU4    ANOP                                                           04596000
&UHNAME  SETC  '&USRHDLR(1)'           Obtain parameter                 04597000
         AIF   ('&UHNAME' EQ 'YES').UHINVNM                        @02A 04598000
         AIF   ('&UHNAME' EQ 'OFF').UHINVNM                        @02A 04599000
         AIF   ('&UHNAME' EQ 'ON').UHINVNM                         @02A 04600000
         AIF   ('&UHNAME' EQ 'NO').UHINVNM                         @02A 04601000
         CEEXSTRI &UHNAME,8,UHname     Get &STRING, &STRLEN, &STRIOK    04602000
&UHNAME  SETC  '&STRING'               Use CEEXSTRI's result            04603000
&UHLEN   SETC  '&STRLEN'               Use CEEXSTRI's result            04604000
         AIF   (&STRIOK).UHU5          If CEEXSTRI OK, go mark valid    04605000
         MNOTE 8,'USRHDLR marked invalid due to above error.'           04606000
         AGO   .UHGEN                                                   04607000
.UHINVNM ANOP                          Unsupported name used       @02A 04608000
         MNOTE 8,'USRHDLR module name &USRHDLR(1) is invalid.'     @02A 04609000
         MNOTE 8,'Use of OFF, ON, YES or NO as modules names is '  @02A 04610000
         MNOTE 8,'not permitted.'                                  @02A 04611000
         MNOTE 8,'USRHDLR marked invalid due to above error.'      @02A 04612000
         AGO   .UHGEN                                              @02A 04613000
.*                                                                      04614000
.UHU5    ANOP                          USRHDLR valid string             04615000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          04616000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       04617000
         AGO   .UHGEN                                                   04618000
.*                                                                      04619000
.UHD     ANOP                          CEEDOPT processing               04620000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          04621000
&VALBITS SETA  &BIT1                   Suboption valid bit set on       04622000
         AIF   (N'&USRHDLR EQ 0 OR N'&NOUSRHDLR EQ 0).UHD1              04623000
         MNOTE 8,'Macro has been invoked with both USRHDLR and'         04624000
         MNOTE 8,'NOUSRHDLR: This option has been set off, valid,'      04625000
         MNOTE 8,'and overridable.'                                     04626000
         AGO   .UHGEN                                                   04627000
.*                                                                      04628000
.UHD1    ANOP                          Check if neither option passed   04629000
         AIF   (N'&USRHDLR NE 0 OR N'&NOUSRHDLR NE 0).UHD2              04630000
         MNOTE 8,'Macro must be invoked with USRHDLR or NOUSRHDLR:'     04631000
         MNOTE 8,'This option has been set off, valid, overridable.'    04632000
         AGO   .UHGEN                                                   04633000
.*                                                                      04634000
.UHD2    ANOP                          Determine which option passed    04635000
         AIF   (N'&USRHDLR NE 0).UHD4  Go to setup for USRHDLR          04636000
.*                                     NOUSRHDLR only was specified     04637000
         AIF   (N'&NOUSRHDLR EQ 2).UHD3                                 04638000
         MNOTE 8,'NOUSRHDLR requires 2 sublist items: it has been'      04639000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   04640000
         AGO   .UHGEN                                                   04641000
.UHD3    ANOP                          Check # 1st sublist items        04642000
         AIF   (N'&NOUSRHDLR(1) LE 1).UHD31                             04643000
         MNOTE 8,'NOUSRHDLR(1) requires 1 or 0 sublist item:'           04644000
         MNOTE 8,'NOUSRHDLR set to a default, overridable, with'        04645000
         MNOTE 8,'valid bits on.'                                       04646000
         AGO   .UHGEN                                                   04647000
.UHD31   ANOP                          Check 2nd sublist item           04648000
         AIF   ('&NOUSRHDLR(2)' EQ 'OVR' OR                            X04649000
                '&NOUSRHDLR(2)' EQ 'NONOVR').UHD32                      04650000
         MNOTE 8,'Last NOUSRHDLR sublist item must be OVR or NONOVR.'   04651000
         AGO   .UHD9                                                    04652000
.UHD32   ANOP                          Check for NOUSRHDLR NONOVR       04653000
         AIF   ('&NOUSRHDLR(2)' EQ 'OVR').UHGEN                         04654000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable              04655000
         AGO   .UHGEN                                                   04656000
.UHD4    ANOP                          USRHDLR only was specified       04657000
&UHOPT   SETC  'USRHDLR'               Indicate USRHDLR specified       04658000
&FLAG    SETA  &FLAG+&ON               Options flag on for USRHDLR      04659000
         AIF   (N'&USRHDLR EQ 2).UHD5                                   04660000
         MNOTE 8,'USRHDLR requires 2 sublist items: it has been'        04661000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   04662000
         AGO   .UHGEN                                                   04663000
.UHD5    ANOP                          Check # 1st sublist items        04664000
         AIF   (N'&USRHDLR(1) LE 1).UHD6                                04665000
         MNOTE 8,'USRHDLR(1) requires 1 or 0 sublist item: USRHDLR'     04666000
         MNOTE 8,'set to a default, overridable, with valid bits on.'   04667000
         AGO   .UHGEN                                                   04668000
.*                                                                      04669000
.UHD6    ANOP                                                           04670000
&UHNAME  SETC  '&USRHDLR(1,1)'         Obtain parameter                 04671000
         AIF   ('&USRHDLR(1)' EQ '()').UHGEN                            04672000
         AIF   ('&UHNAME' EQ 'YES').DHINVNM                        @02A 04673000
         AIF   ('&UHNAME' EQ 'OFF').DHINVNM                        @02A 04674000
         AIF   ('&UHNAME' EQ 'ON').DHINVNM                         @02A 04675000
         AIF   ('&UHNAME' EQ 'NO').DHINVNM                         @02A 04676000
         CEEXSTRI &UHNAME,8,UHname     Get &STRING, &STRLEN, &STRIOK    04677000
&UHNAME  SETC  '&STRING'               Use CEEXSTRI's result            04678000
&UHLEN   SETC  '&STRLEN'               Use CEEXSTRI's result            04679000
         AIF   (&STRIOK).UHD7                                           04680000
&UHALLOK SETB  0                       Indicate error detected     @02C 04681000
.DHINVNM ANOP                          Unsupported name used       @02A 04682000
&VALBITS SETA  &OFF*(&BIT1)            Suboption invalid           @02A 04683000
         MNOTE 4,'USRHDLR module name &USRHDLR(1) is invalid.'     @02A 04684000
         MNOTE 4,'Use of OFF, ON, YES or NO as modules names is '  @02A 04685000
         MNOTE 4,'not permitted.'                                  @02A 04686000
         MNOTE 4,'Due to error(s) detected above, &UHOPT has'      @02A 04687000
         MNOTE 4,'been set overridable (with valid bits off).'     @02A 04688000
         AGO   .UHGEN                                              @02A 04689000
.*                                                                      04690000
.UHD7    ANOP                          Check 2nd sublist item           04691000
         AIF   ('&USRHDLR(2)' NE 'OVR' AND                             X04692000
               '&USRHDLR(2)' NE 'NONOVR').UHD8                          04693000
         AIF   (NOT &UHALLOK).UHD9     If errors, force overridable@02C 04694000
         AIF   ('&USRHDLR(2)' EQ 'OVR').UHGEN                           04695000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  04696000
         AGO   .UHGEN                                                   04697000
.*                                                                      04698000
.UHD8    ANOP                                                           04699000
         MNOTE 8,'Last USRHDLR sublist item must be OVR or NONOVR.'     04700000
.*                                                                      04701000
.UHD9    ANOP                                                           04702000
         MNOTE 8,'Due to error(s) detected above, &UHOPT has'           04703000
         MNOTE 8,'been set overridable (with valid bits on).'           04704000
.*                                                                      04705000
.UHGEN   ANOP                                                           04706000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 04707000
         DC    X'00'                   Unused                           04708000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   04709000
         DC    A(UH_SUB-&SYSECT)       Offset of suoptions block        04710000
*                                                                       04711000
SUB      LOCTR                                                          04712000
UH_SUB   DS    0F                      USRHDLR suboptions block         04713000
         DC    AL1(&VALBITS)           Suboption valid bits             04714000
         DC    AL3(0)                  Unused suboption valid bits      04715000
         DC    A(UHNAME-&SYSECT)       Offset of UHname                 04716000
*                                                                       04717000
UHNAME   DS    0F                      USRHDLR UHname                   04718000
         DC    H'&UHLEN'               Effective length of following    04719000
         DC    CL8'&UHNAME'            USRHDLR UHname                   04720000
         DC    CL2' '                  Unused                           04721000
*                                                                       04722000
&SYSECT  LOCTR                                                          04723000
*                                                                       04724000
.**************************************************************@PQ04876 04725000
*    RETZERO option                                            @PQ04876 04726000
.**************************************************************@PQ04876 04727000
         CEEXSIMP RETZERO,&RETZERO                             @PQ04876 04728000
*                                                                       04729000
.********************************************************************** 04730000
*    HEAPCHK option                                                     04731000
.*                                                                      04732000
.* Format:                                                              04733000
.*  HEAPCHK(ON , frequency ,delay   )                             04734000
.*          OFF                                                         04735000
.*                                                             @CH0123A 04736000
.********************************************************************** 04737000
&FLAG    SETA  &OFF                    Options flag initialized         04738000
&VALBITS SETA  &OFF*(&BIT1+&BIT2+&BIT3)                            @04C 04739000
&INCRSIZ SETC  '1'                     Default Frequency is 1           04740000
&INITSIZ SETC  '0'                     Default Delay is 0               04741000
&CALLLVL SETC  '0'                     Default Call Level is 10    @04A 04742000
.*                                                                      04743000
         AIF   (&DOPT).HPCD            Go to CEEDOPT processing         04744000
.*                                                                      04745000
.* -----------------------------------------------------------------    04746000
.*     CEEUOPT processing                                               04747000
.* -----------------------------------------------------------------    04748000
         AIF   (N'&HEAPCHK EQ 0).HPCGEN                                 04749000
         AIF   ('&HEAPCHK' EQ '()').HPCGEN                              04750000
         AIF   (N'&HEAPCHK LE 3).HPCU1                                  04751000
         MNOTE 8,'Too many suboptions -- HEAPCHK marked invalid.'       04752000
         AGO   .HPCGEN                                                  04753000
.*                                                                      04754000
.*                                   *------------------------------    04755000
.*                                   * Process ON | OFF parameter       04756000
.*                                   *------------------------------    04757000
.HPCU1   ANOP                          Check ON|OFF                     04758000
         AIF   ('&HEAPCHK(1)' EQ '').HPCU4 If null, work on frequency   04759000
         AIF   ('&HEAPCHK(1)' EQ 'ON').HPCU2                            04760000
         AIF   ('&HEAPCHK(1)' EQ 'OFF').HPCU3                           04761000
         MNOTE 8,'HEAPCHK was not set ON or OFF:'                       04762000
         MNOTE 8,'it has been set to OFF.'                              04763000
&ALLOK   SETB  0                       Indicate error detected          04764000
         AGO   .HPCU10                 Go examine HEAPCHK validity      04765000
.*                                                                      04766000
.HPCU2   ANOP                          Set HeapChk ON                   04767000
&FLAG    SETA  &ON+&VALID              Set valid bit on                 04768000
         AGO   .HPCU4                  Go check frequency               04769000
.*                                                                      04770000
.HPCU3   ANOP                          Set HeapChk OFF                  04771000
&FLAG    SETA  &OFF+&VALID             Set valid bit on                 04772000
         AGO   .HPCU4                  Go check frequency               04773000
.*                                                                      04774000
.*                                   *------------------------------    04775000
.*                                   * Process frequency                04776000
.*                                   *------------------------------    04777000
.HPCU4   ANOP                          Check frequency                  04778000
         AIF   ('&HEAPCHK(2)' EQ '').HPCU7 If null, work on delay       04779000
&TEMPSTR SETC  '&HEAPCHK(2)'           Obtain frequecy value            04780000
         AIF   ('&TEMPSTR'(1,1) NE '-').HPCU5                           04781000
         MNOTE 8,'HEAPCHK frequency may not begin with a minus sign:'   04782000
         MNOTE 8,'it has been set to &INCRSIZ and marked invalid.'      04783000
&ALLOK   SETB  0                       Indicate error detected          04784000
         AGO   .HPCU7                  Go to delay processing           04785000
.*                                                                      04786000
.HPCU5   ANOP                                                           04787000
         CEEXCALC &HEAPCHK(2)          Obtain &VALUE and &CALCOK        04788000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            04789000
         AIF   (&CALCOK).HPCU6         If CEEXCALC OK, suboption valid  04790000
&ALLOK   SETB  0                       Indicate error detected          04791000
         AGO   .HPCU7                  Go to delay processing           04792000
.*                                                                      04793000
.HPCU6   ANOP                          Set freq. subopt valid bit on    04794000
&VALBITS SETA  &VALBITS+&BIT1                                           04795000
         AGO   .HPCU7                  Go to delay processing           04796000
.*                                                                      04797000
.*                                   *------------------------------    04798000
.*                                   * Process delay                    04799000
.*                                   *------------------------------    04800000
.HPCU7   ANOP                          Check delay                      04801000
         AIF   ('&HEAPCHK(3)' EQ '').HPCU10 If null, examine validity   04802000
&TEMPSTR SETC  '&HEAPCHK(3)'           Obtain frequecy value            04803000
         AIF   ('&TEMPSTR'(1,1) NE '-').HPCU8                           04804000
         MNOTE 8,'HEAPCHK delay may not begin with a minus sign:'       04805000
         MNOTE 8,'it has been set to &INITSIZ and marked invalid.'      04806000
&ALLOK   SETB  0                       Indicate error detected          04807000
         AGO   .HPCU10                 Go examine HEAPCHK validity      04808000
.*                                                                      04809000
.HPCU8   ANOP                                                           04810000
         CEEXCALC &HEAPCHK(3)          Obtain &VALUE and &CALCOK        04811000
&CALLLVL SETC  '0'                     Default Call Level is 10    @04A 04812000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            04813000
         AIF   (&CALCOK).HPCU9         If CEEXCALC OK, suboption valid  04814000
&ALLOK   SETB  0                       Indicate error detected          04815000
         AGO   .HPCU10                 Go examine HEAPCHK validity      04816000
.*                                                                      04817000
.HPCU9   ANOP                          Set delay subopt valid bit on    04818000
&VALBITS SETA  &VALBITS+&BIT2                                           04819000
         AGO   .HPCU10                 Go examine HEAPCHK validity      04820000
.*                                                                      04821000
.HPCU10  ANOP                          Determine HEAPCHK is valid       04822000
         AIF   (NOT &ALLOK).HPCU11     If suboption error, need msg     04823000
         AGO   .HPCGEN                                                  04824000
.*                                                                      04825000
.HPCU11  ANOP                                                           04826000
         MNOTE 8,'HEAPCHK valid bit and suboption valid bits set to'    04827000
         MNOTE 8,'reflect the errors detected above.'                   04828000
         AGO   .HPCGEN                                                  04829000
.* -----------------------------------------------------------------    04831000
.*     CEEDOPT processing                                               04832000
.* -----------------------------------------------------------------    04833000
.HPCD    ANOP                          CEEDOPT processing               04834000
&FLAG    SETA  &FLAG+&VALID            Option valid bit set on          04835000
&VALBITS SETA  &BIT1+&BIT2+&BIT3       Suboption valid bits set on @04C 04836000
         AIF   (N'&HEAPCHK EQ 2).HPCD1                                  04837000
         MNOTE 8,'HEAPCHK requires 2 sublist items: it has been set'    04838000
         MNOTE 8,'to defaults, and marked overridable and valid.'       04839000
         AGO   .HPCGEN                                                  04840000
.*                                                                      04841000
.HPCD1   ANOP                          Check # 1st sublist items        04842000
         AIF   (N'&HEAPCHK(1) EQ 3).HPCD2                               04843000
         MNOTE 8,'HEAPCHK(1) requires 3 suboptions: it has been set'    04844000
         MNOTE 8,'to defaults, and marked overridable and valid.'       04845000
         AGO   .HPCGEN                                                  04846000
.*                                                                      04847000
.*                                   *------------------------------    04848000
.*                                   * Process ON | OFF parameter       04849000
.*                                   *------------------------------    04850000
.HPCD2   ANOP                                                           04851000
         AIF   ('&HEAPCHK(1,1)' NE '()').HPCD3                          04852000
         MNOTE 8,'HEAPCHK must specify ON or OFF:'                      04853000
         MNOTE 8,'it has been set to OFF.'                              04854000
&ALLOK   SETB  0                       Indicate error detected          04855000
         AGO   .HPCD6                  Go check frequency               04856000
.*                                                                      04857000
.HPCD3   ANOP                          Check ON|OFF                     04858000
         AIF   ('&HEAPCHK(1,1)' EQ 'ON').HPCD4                          04859000
         AIF   ('&HEAPCHK(1,1)' EQ 'OFF').HPCD5                         04860000
         MNOTE 8,'HEAPCHK was not set ON or OFF:'                       04861000
         MNOTE 8,'it has been set to OFF.'                              04862000
&ALLOK   SETB  0                       Indicate error detected          04863000
         AGO   .HPCD6                  Go check frequency               04864000
.*                                                                      04865000
.HPCD4   ANOP                          Set HeapChk ON                   04866000
&FLAG    SETA  &FLAG+&ON                                                04867000
         AGO   .HPCD6                  Go check frequency               04868000
.*                                                                      04869000
.HPCD5   ANOP                          Set HeapChk OFF                  04870000
&FLAG    SETA  &FLAG+&OFF                                               04871000
         AGO   .HPCD6                  Go check frequency               04872000
.*                                                                      04873000
.*                                   *------------------------------    04874000
.*                                   * Process frequency                04875000
.*                                   *------------------------------    04876000
.HPCD6   ANOP                          Check frequency                  04877000
         AIF   ('&HEAPCHK(1,2)' NE '').HPCD7                            04878000
         MNOTE 8,'HEAPCHK must specify a frequency:'                    04879000
         MNOTE 8,'it has been set to &INCRSIZ..'                        04880000
&ALLOK   SETB  0                       Indicate error detected          04881000
         AGO   .HPCD9                  Go to delay processing           04882000
.*                                                                      04883000
.HPCD7   ANOP                                                           04884000
&TEMPSTR SETC  '&HEAPCHK(1,2)'         Obtain frequency value           04885000
         AIF   ('&TEMPSTR'(1,1) NE '-').HPCD8                           04886000
         MNOTE 8,'HEAPCHK frequency may not begin with a minus sign:'   04887000
         MNOTE 8,'it has been set to &INCRSIZ..'                        04888000
&ALLOK   SETB  0                       Indicate error detected          04889000
         AGO   .HPCD9                  Go to delay processing           04890000
.*                                                                      04891000
.HPCD8   ANOP                                                           04892000
         CEEXCALC &HEAPCHK(1,2)        Obtain &VALUE and &CALCOK        04893000
&INCRSIZ SETC  '&VALUE'                Use CEEXCALC's result            04894000
         AIF   (&CALCOK).HPCD9         If CEEXCALC OK, suboption valid  04895000
&ALLOK   SETB  0                       Indicate error detected          04896000
         AGO   .HPCD9                  Go to delay processing           04897000
.*                                                                      04898000
.*                                   *------------------------------    04899000
.*                                   * Process delay                    04900000
.*                                   *------------------------------    04901000
.HPCD9   ANOP                          Check delay                      04902000
         AIF   ('&HEAPCHK(1,3)' NE '').HPCD10                           04903000
         MNOTE 8,'HEAPCHK must specify a frequency:'                    04904000
         MNOTE 8,'it has been set to &INITSIZ..'                        04905000
&ALLOK   SETB  0                       Indicate error detected          04906000
         AGO   .HPCD100                Go examine 2nd sublist item      04907000
.*                                                                      04908000
.HPCD10  ANOP                                                           04909000
&TEMPSTR SETC  '&HEAPCHK(1,3)'         Obtain delay value               04910000
         AIF   ('&TEMPSTR'(1,1) NE '-').HPCD11                          04911000
         MNOTE 8,'HEAPCHK delay may not begin with a minus sign:'       04912000
         MNOTE 8,'it has been set to &INITSIZ..'                        04913000
&ALLOK   SETB  0                       Indicate error detected          04914000
         AGO   .HPCD100                Go examine 2nd sublist item      04915000
.*                                                                      04916000
.HPCD11  ANOP                                                           04917000
         CEEXCALC &HEAPCHK(1,3)        Obtain &VALUE and &CALCOK        04918000
&INITSIZ SETC  '&VALUE'                Use CEEXCALC's result            04919000
         AIF   (&CALCOK).HPCD100       If CEEXCALC OK, suboption valid  04920000
&ALLOK   SETB  0                       Indicate error detected          04921000
         AGO   .HPCD100                Go examine 2nd sublist item      04922000
.*                                                                      04923000
.*                                   *------------------------------    04924000
.*                                   * Process OVR parameter            04925000
.*                                   *------------------------------    04926000
.HPCD100 ANOP                          Check 2nd sublist item           04927000
         AIF   ('&HEAPCHK(2)' NE 'OVR' AND                             X04928000
               '&HEAPCHK(2)' NE 'NONOVR').HPCD101                       04929000
         AIF   (NOT &ALLOK).HPCD102    If errors, force overridable     04930000
         AIF   ('&HEAPCHK(2)' EQ 'OVR').HPCGEN                          04931000
&FLAG    SETA  &FLAG+&NONOVR           Set non-overridable (no errors)  04932000
         AGO   .HPCGEN                                                  04933000
.*                                                                      04934000
.HPCD101 ANOP                                                           04935000
         MNOTE 8,'Last HEAPCHK sublist item must be OVR or NONOVR.'     04936000
.*                                                                      04937000
.HPCD102 ANOP                                                           04938000
         MNOTE 8,'Due to error(s) detected above, HEAPCHK has'          04939000
         MNOTE 8,'been set overridable (with valid bits on).'           04940000
.*                                                                      04941000
.* -----------------------------------------------------------------    04942000
.*     Generate the HEAPCHK option                                      04943000
.* -----------------------------------------------------------------    04944000
.HPCGEN  ANOP                                                           04945000
         DC    AL1(&FLAG)              128 = ON, 64 = NONOVR, 1 = valid 04946000
         DC    X'00'                   Unused                           04947000
         DC    H'&WHSET'               100 = set in DOPT, 200 in UOPT   04948000
         DC    A(HPC_SUB-&SYSECT)      Offset of suboptions block       04949000
*                                                                       04950000
SUB      LOCTR                                                          04951000
HPC_SUB  DS    0F                      HEAPCHK suboptions block         04952000
         DC    AL1(&VALBITS)           Suboption valid bits             04953000
         DC    AL3(0)                  Unused suboption valid bits      04954000
         DC    F'&INCRSIZ'             HeapChk frequency                04955000
         DC    F'&INITSIZ'             HeapChk initial delay            04956000
         DC    F'&CALLLVL'             HeapChk call level          @04A 04957000
*                                                                       04958000
&SYSECT  LOCTR                                                          04959000
*                                                                       04960000
.* Start of @06A                                                                
.*********************************************************************          
.*CEEUOPT option conflict                                                       
.*********************************************************************          
.*********************************************************************          
.* Check for possible ALL31,STACK option conflict                               
.*    If ALL31(OFF) is specified STACK(,,BELOW) should also be                  
.*    specified, otherwise possible option conflict. Cannot be                  
.*    sure since not all options have to be specified on CEEUOPT                
.*    invokation.                                                               
.*********************************************************************          
.*                                                                      04743000
         AIF   (&DOPT).STKAL2          Go to CEEDOPT processing         04744000
         AIF   ('&ALL31(1)' EQ 'OFF' AND                               X        
               '&STACK(3)' NE 'BELOW').STKAL1                                   
         AIF   (('&STACK(3)' EQ 'ANY'  OR '&STACK(3)' EQ 'ANYWHERE')   X        
                AND '&ALL31(1)' NE 'ON').STKAL1                                 
         AGO   .STKAL2                                                          
.STKAL1  ANOP                                                                   
         MNOTE 0,'If you use ALL31(OFF),You must specify STACK(BELOW)'          
         MNOTE 0,'Check for possible option conflict.'                          
.STKAL2  ANOP                                                                   
.* End of @06A                                                                  
.*                                                                      04830000
.********************************************************************** 04961000
.*   Expansion Vector                                                 * 04962000
.********************************************************************** 04963000
EXP_VEC  DC    A(RND_4-&SYSECT)                                         04964000
         DC    A(RND_8-&SYSECT)                                         04965000
RND_4    DC    A(&BHTR4)                                                04966000
         DC    A(&BHRR4)                                                04967000
         DC    A(&AHTR4)                                                04968000
         DC    A(&AHRR4)                                                04969000
         DC    A(&HPTR4)                                                04970000
         DC    A(&HPRR4)                                                04971000
         DC    A(&HT24R4)                                               04972000
         DC    A(&HR24R4)                                               04973000
         DC    A(&LSTR4)                                                04974000
         DC    A(&LSRR4)                                                04975000
         DC    A(&SKTR4)                                                04976000
         DC    A(&SKRR4)                                                04977000
         DC    A(&SRR4)                                                 04978000
RND_8    DC    A(&BHTR8)                                                04979000
         DC    A(&BHRR8)                                                04980000
         DC    A(&AHTR8)                                                04981000
         DC    A(&AHRR8)                                                04982000
         DC    A(&HPTR8)                                                04983000
         DC    A(&HPRR8)                                                04984000
         DC    A(&HT24R8)                                               04985000
         DC    A(&HR24R8)                                               04986000
         DC    A(&LSTR8)                                                04987000
         DC    A(&LSRR8)                                                04988000
         DC    A(&SKTR8)                                                04989000
         DC    A(&SKRR8)                                                04990000
         DC    A(&SRR8)                                                 04991000
*                                                                       04992000
.********************************************************************** 04993000
.*   Note that the location counter is set to SUB immediately before  * 04994000
.*   the determination of module length so that the suboptions blocks * 04995000
.*   are included in the calculation.                                 * 04996000
.********************************************************************** 04997000
SUB      LOCTR                                                          04998000
LENGTH   EQU   *-&SYSECT               Options block length             04999000
         MEND                                                           05000000
