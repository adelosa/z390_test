         MACRO                                                          00050000
&NAME    IHBRDWRA  &RPL=,&IHBRW=,&ACB=,&AREA=,&AREALEN=,&RECLEN=,      *00100000
               &AAREA=,&AAREALN=,&ARECLEN=,&ECB=,&EXIT=,&CODESEL=,     *00150000
               &OPTCD=,&ARG=,&NIB=,&BRANCH=,&OBSQVAL=,&SIGDATA=,       *00200000
               &RESPOND=,&CONTROL=,&CHNGDIR=,&SSENSEO=,&STYPE=,        *00250000
               &SEQNO=,&USENSEO=,&IBSQVAL=,&RTYPE=,&IBSQAC=,&SSENSMO=, *00300000
               &OBSQAC=,&POST=,&CHAIN=,&OPTION=,&SCANOPT=,&BRACKET=,   *00350000
               &CRYPT=,&THRDPTY=,&SONCODE=,&PSTIMER=                    00400000
.* /***** START OF SPECIFICATIONS ************************************/ 00450000
.* /*                                                                */ 00500000
.* /*  MACRO NAME: IHBRDWRA                                          */ 00550000
.* /*                                                                */ 00600000
.* /*  DESCRIPTIVE NAME: INNER INTERFACE MACRO FOR API REQUEST       */ 00650000
.* /*                    MACROS                                      */ 00700000
.* /*                                                                */ 00750000
.* /*  COPYRIGHT = LICENSED MATERIALS - PROPERTY OF IBM              */ 00800000
.* /*                                                                */ 01000000
.* /*              THIS PRODUCT CONTAINS                             */ 01008300
.* /*              "RESTRICTED MATERIALS OF IBM"                     */ 01016600
.* /*                                                                */ 01024900
.* /*              5686-065 (C) COPYRIGHT IBM CORP 1979, 1994.       */ 01033200
.* /*              ALL RIGHTS RESERVED.                              */ 01041500
.* /*                                                                */ 01049800
.* /*              U.S. GOVERNMENT USERS RESTRICTED RIGHTS -         */ 01058100
.* /*              USE, DUPLICATION OR DISCLOSURE RESTRICTED         */ 01066400
.* /*              BY GSA ADP SCHEDULE CONTRACT WITH IBM CORP.       */ 01074700
.* /*                                                                */ 01083000
.* /*              SEE COPYRIGHT INSTRUCTIONS.                       */ 01091300
.* /*                                                                */ 01100000
.* /*  FUNCTION: GENERATES IN-LINE CODE FOR THE FOLLOWING API        */ 01150000
.* /*            REQUEST MACROS THAT USE AN RPL:  CLSDST,            */ 01200000
.* /*            INQUIRE, INTRPRET, OPNDST, OPNSEC, RECEIVE,         */ 01250000
.* /*            REQSESS, RESETSR, SEND, SESSIONC, SETLOGON,         */ 01300000
.* /*            SIMLOGON, AND TERMSESS.  THE GENERATED              */ 01350000
.* /*            CODE LOADS THE RPL ADDRESS INTO REGISTER 1,         */ 01400000
.* /*            MODIFIES RPL FIELDS AS INDICATED BY THE RPL         */ 01450000
.* /*            MODIFIERS ON THE REQUEST MACRO, LOADS A             */ 01500000
.* /*            REQUEST CODE INTO REGISTER ZERO, AND BRANCHES       */ 01550000
.* /*            TO THE INTERFACE ROUTINE WHOSE ADDRESS IS IN        */ 01600000
.* /*            THE ACB LOCATED VIA THE RPL.  ANY CODE TO           */ 01650000
.* /*            MODIFY THE RPL IS BYPASSED IF THE RPL IS            */ 01700000
.* /*            ALREADY ACTIVE.                                     */ 01750000
.* /*                                                                */ 01800000
.* /*  NOTES: NONE                                                   */ 01850000
.* /*                                                                */ 02000000
.* /*  PROCESSOR: ASSEMBLER                                          */ 02050000
.* /*                                                                */ 02100000
.* /*  CREATED BY: MACRO DEVELOPMENT TEAM                            */ 02150000
.* /*                                                                */ 02200000
.* /*  INTERNAL MACROS: NONE                                         */ 02250000
.* /*                                                                */ 02300000
.* /*  EXTERNAL REFERENCES: NONE                                     */ 02350000
.* /*                                                                */ 02400000
.* /*  CHANGE ACTIVITY:                                              */ 02450000
.* /*  CHANGE 01 - 01/19/77 - ADDED QUEUED RESPONSE SUPPORT  @D34EKMP*/ 02500000
.* /*  CHANGE 02 - 02/16/77 - ADDED CONTROL SBI/BIS SUPPORT  @D34EKMP*/ 02550000
.* /*  CHANGE 03 - 04/27/77 - CORRECTED CONTROL SDT SUPPORT  @PI10125*/ 02600000
.* /*  CHANGE 04 - 05/25/77 - CORRECTED RPL SIGDATA SUPPORT  @VS45960*/ 02650000
.* /*  CHANGE 05 - 10/26/77 - CORRECTED INQ SESSKEY SUPPORT  @XM30862*/ 02700000
.* /*  CHANGE 06 - 04/12/78 - ADDED THRDPTY NOTIFY  SUPPORT  @D17AKMP*/ 02750000
.* /*  CHANGE 07 - 05/22/81 - DCR 4747.06                    @D5B4747*/ 02800000
.* /*  CHANGE 08 - 09/24/81 - SYSROUTE OF APAR ZA46611       @AD46611*/ 02850000
.* /*  CHANGE 09 - 09/24/81 - DCR 4790.03                    @D479003*/ 02900000
.* /*  CHANGE 10 - 01/12/82 - PTM P010128                    @P5X0128*/ 02950000
.* /*  CHANGE 11 - 11/22/82 - PTM P011983 DY30663 MNOTE      @DA30663*/ 03000000
.* /*  CHANGE 12 - 02/15/84 - DCR 4912.08 DOS/761            @R491208*/ 03025000
.* /*  CHANGE 13 - 04/21/87 - DCR 5070.01 DOS/777 - COPIED THE MVS   */ 03028500
.* /*                         INTEGRATION DEL TO THE DOS DEVELOPMENT */ 03032000
.* /*                         DEL, KEEPING THE DOS RPL OFFSETS, AND  */ 03035500
.* /*                         REMOVING THE SUPPORT FOR CRYPTO AND    */ 03039000
.* /*                         BRANCH. (SEE MVS VERSION PROLOGUE FOR  */ 03042500
.* /*                         FICHE FLAG DESCRIPTIONS)       @R507001*/ 03046000
.* /*  CHANGE 14 - 07/14/87 - APAR OY06517 - OPTSCAN NOT CHECKING    */ 03047300
.* /*                         FOR NULLS IN PARAMETERS PASSED @OY06517*/ 03048600
.* /*                                                                */ 03050000
.* /* $MAC(IHBRDWRA),COMP(API),PROD(VTAM): Inner interface macro for */ 03056200
.* /*                                      API requests              */ 03062400
.* /*                                                                */ 03068600
.* /* FLAG REASON   RELEASE DATE   ORIGIN  FLAG DESCRIPTORS          */ 03074800
.* /* ---- -------- ------- ------ ------- ------------------------  */ 03081000
.* /* $G1= MS@@@MST VSE3300 890606 551204: VSE UNIQUE                */ 03087200
.* /* $H1= ZP@@@MST VSE3400 901106 601407: VSE PL/AS CONVERSION      */ 03089200
.* /*                                      COMMENT CHANGES ONLY      */ 03091200
.* /* $01= OY36649  VM340   911014 349122: QUEUED SESSION TERMINATION*/ 03092300
.* /* $H2= VS@@@MST VSE/ESA 930412 879315: VSE 4.3 STARTUP           */ 03092800
.* /* $02= OY62380  SNAIP   930421 879315: Allow CHNGDIR=NREQ to be  */ 03092900
.* /*                                      specified though ignored  */ 03093000
.* /*                                      (still issued by CICS)    */ 03093100
.* /* $U2= P110087  GENRES  930908 879315: Downward compatibility    */ 03093200
.* /* $03= OY67066  VSE/ESA 940628 677775: ADD SUPPORT FOR INQUIRE   */ 03094900
.* /*                                      OPTCD=STATUS (AE FIX FOR  */ 03096600
.* /*                                      OY63087)                  */ 03098300
.* /* $W1= P117054  VMVSCS  941202 879315: Conditional CS mode       */ 03099100
.* /***** END OF SPECIFICATIONS **************************************/ 03100000
.*                                                                      03150000
.* A-000000-999999                                           @XL03HMV   03200000
.*                                                                      03250000
* IHBRDWRA - ACF/VTAM -- VSE/ESA                                        03300000
*                                                                       03350000
* COPYRIGHT = LICENSED MATERIALS - PROPERTY OF IBM                      03364200
*                                                                       03378400
*             THIS PRODUCT CONTAINS                                     03392600
*             "RESTRICTED MATERIALS OF IBM"                             03406800
*                                                                       03421000
*             5686-065 (C) COPYRIGHT IBM CORP 1979, 1994.               03435200
*             ALL RIGHTS RESERVED.                                      03449400
*                                                                       03463600
*             U.S. GOVERNMENT USERS RESTRICTED RIGHTS -                 03477800
*             USE, DUPLICATION OR DISCLOSURE RESTRICTED                 03492000
*             BY GSA ADP SCHEDULE CONTRACT WITH IBM CORP.               03506200
*                                                                       03520400
*             SEE COPYRIGHT INSTRUCTIONS.                               03534600
*                                                                       03550000
         GBLB  &IHBRPLY(20)                                             03600000
         GBLC  &IHBTBL(20)                                              03650000
         GBLA  &IHBNUM                                                  03700000
         LCLA  &PLARG,&PLNIB,&PLAREA,&PLRLEN,&PLBUFL,&PLACTIV,&PLEXTDS  03750000
         LCLA  &PLOPTC1,&PLDACB,&PLECB,&PLAAREA,&PLAARLN,&PLARCLN       03800000
         LCLA  &ACBRTN,&SYN,&ASY,&POPTCD2,&POPTCD3,&OPTERR,&PLSSMO      03850000
         LCLA  &NUM,&LEN,&CNTINQ,&MSK1CTR,&MSK2CTR,&MSK3CTR,&MSK4CTR    03900000
         LCLA  &CNTSTL,&PLUSFLD                                    @H2A 03916600
         LCLA  &PLOPT4                                             @H2A 03933200
.* *************** VTL ADDITIONS ****************                       03950000
         LCLA  &NM,&NUM2,&PLRH3,&PLSRTYP,&PLVTFL2,&PLCHN,&PLCNTRL       04000000
         LCLA  &PLCNTDF,&PLCNTSC,&PLOBSQV,&PLIBSQV,&PLOBSQ,&PLIBSQ      04050000
         LCLA  &PLSEQNO,&PLSSNSO,&PLUSNSO,&PLCNTDC,&PLSSEO,&PLSIGDA     04100000
         LCLA  &SCODE                                          @R491100 04125000
.* ************ END VTL ADDITIONS ***************                       04150000
         LCLB  &CA,&CS,&PASS,&RELEASE,&NERASE,&EAU,&ERASE,&NOTIFY       04183300
         LCLB  &SPEC,&ANY,&LBT,&LBM,&BLK,&COND,&UNCOND             @W1C 04233300
         LCLB  &LOCK,&ACCEPT,&ACQUIRE,&QUIESCE,&START,&STOP             04300000
         LCLB  &CONALL,&CONANY,&Q,&NQ,&LGONMSG,&DEVCHAR,&TERMS,&APPSTAT 04350000
         LCLB  &COUNTS,&RNNAME,&CIDXLAT,&TOPLGON,&BSCID,&DISPLAY        04400000
         LCLB  &RELRQ,&NRELRQ,&UNCONDL,&ACTIVE,&SESSION,&PEND           04450000
         LCLB  &BIT0,&BIT01,&SPARM,&SPARM1,&SKEY                        04500000
         LCLB  &NBUFLST,&BUFFLST,&CONTCHN,&NCNTCHN             @D5B4747 04550000
         LCLB  &NLMPEO,&LMPEO,&USERRH,&NUSERRH                 @D5B4747 04600000
         LCLB  &USERVAR                                        @R489318 04606200
         LCLB  &SONCD,&NSONCD,&UNBIND,&SENSE,&NSENSE,&HOLD     @R491100 04612500
         LCLB  &RSPQUE,&NRSPQU                                 @R491101 04625000
         LCLB  &MTS,&NMTS                                          @G1A 04631200
         LCLB  &TERMQ                                              @01A 04634300
         LCLB  &STATUS                                             @03A 04642100
.* *************** VTL ADDITIONS ****************                       04650000
         LCLB  &KEEP,&TRUNC,&NIBTK                                      04700000
         LCLB  &FMHDR,&NFMHDR                                           04750000
         LCLB  &KEEP1,&TRUNC1,&NIBTK1,&FMHDR1                           04800000
         LCLC  &OPT1,&OPT,&CHAR1,&CHAR2,&CHAR3,&CHAR4                   04900000
         LCLC  &OPT4X                                              @H2A 04925000
.* ************ END VTL ADDITIONS ***************                       04950000
  LCLB  &CS1,&PASS1,&NERASE1,&EAU1,&ERASE1,&NOTIFY1                     05000000
  LCLB  &ANY1,&LBT1,&LBM1,&BLK1,&COND1,&UNCOND1                    @W1C 05050000
  LCLB  &LOCK1,&ACCEPT1,&ACQUIR1,&QUIESC1,&START1,&STOP1                05100000
  LCLB  &CONALL1,&CONANY1,&NQ1,&LGONMS1,&DEVCHR1,&TERMS1,&APSTAT1       05150000
  LCLB  &COUNTS1,&RNNAME1,&CIDXLT1,&TOPLGN1,&BSCID1,&DISPLY1            05200000
  LCLB  &NRELRQ1,&UNCNDL1,&ACTIVE1,&SESION1,&PEND1,&SKEY1      @XM30862 05250000
  LCLB  &BUFLST1,&CNTCHN1,&LMPEO1,&USERRH1                     @D5B4747 05300000
  LCLB  &USRVAR1                                               @R489318 05304100
  LCLB  &SONCD1,&NSONCD1,&UNBIND1,&SENSE1,&NSENSE1,&HOLD1      @R491100 05308300
  LCLB  &RSPQUE1,&NRSPQU1                                      @R491101 05316600
  LCLB  &MTS1                                                      @G1A 05320700
  LCLB  &TERMQ1                                                    @01A 05322800
  LCLB  &QSESS,&QALL,&QNOTE                                    @R504800 05333200
  LCLB  &QSESS1,&QNOTE1,&QALL1                                 @R504800 05341500
  LCLB  &CONDCS,&CONDCS1                                           @W1A 05342900
  LCLB  &CSSPEC,&CONDCSS                                           @W1A 05344300
  LCLB  &PERSIQ,&PERST,&NPERST,&RESTOR,&PSTIME,&NQN                @H2A 05345700
  LCLB  &STATUS1                                                   @04A 05347800
.* ********** DISPLACEMENT OF RPL FIELDS **********                     05350000
&PLARG   SETA  8     * VSE *                                            05391100
&PLAREA  SETA  12    * VSE *                                            05432200
&PLRLEN  SETA  16    * VSE *                                            05473300
&PLBUFL  SETA  20    * VSE *                                            05514400
&SCODE   SETA  28    * VSE DISPLACEMENT INTO RPL TO SONCODE *  @R491208 05555500
&PLEXTDS SETA  34    * VSE *                                            05596600
&PLOPTC1 SETA  32    * VSE *                                            05637700
&PLOPT4  SETA  35    * VSE VTAM DISPLACEMENT *                     @H2A 05678800
&POPTCD2 SETA  64    * VSE *                                            05719900
&POPTCD3 SETA  68    * VSE *                                            05761000
&PLDACB  SETA  24    * VSE *                                            05802100
&PLECB   SETA  44    * VSE *                                            05843200
&PLAAREA SETA  40    * VSE *                                            05884300
&PLAARLN SETA  48    * VSE *                                            05925400
&PLARCLN SETA  52    * VSE *                                            05966500
&PLUSFLD SETA  60    * VSE VTAM DISPLACEMENT *                     @H2A 06007600
.* *************** VTL ADDITIONS ****************                       06050000
&PLRH3    SETA  72   * VSE *             THIRD RH BYTE                  06100000
&PLSRTYP  SETA  73   * VSE *             SEND OR RECEIVE TYPE FIELD     06150000
&PLVTFL2  SETA  75   * VSE *             VTAM FLAGS FIELD               06200000
&PLCHN    SETA  76   * VSE *             POSITION IN RU CHAIN FIELD     06250000
&PLCNTRL  SETA  77   * VSE *             RU CONTROL CODE FIELD          06300000
&PLCNTDF  SETA  77   * VSE *             DATA FLOW CONTROL CODES FIELD  06350000
&PLCNTDC  SETA  78   * VSE *             DATA FLOW CONTROL CODES FIELD  06400000
&PLCNTSC  SETA  79   * VSE *             SESSION CONTROL CODES FIELD    06450000
&PLOBSQV  SETA  80   * VSE *             STSN OUTBOUND SEQ. NO. FIELD   06500000
&PLIBSQV  SETA  82   * VSE *             STSN INBOUND SEQ. NO. FIELD    06550000
&PLOBSQ   SETA  84   * VSE *             STSN OUTBOUND ACTION CODES     06600000
&PLIBSQ   SETA  85   * VSE *             STSN INBOUND ACTION CODES      06650000
&PLSEQNO  SETA  86   * VSE *             SEQUENCE NUMBER FIELD          06700000
&PLSSNSO  SETA  88   * VSE *             SYSTEM SENSE OUTPUT FIELD      06750000
&PLSSEO   SETA  88   * VSE *             SYSTEM SENSE ERROR CODES       06800000
&PLSSMO   SETA  89   * VSE *             SYSTEM SENSE ERROR CODES       06850000
&PLUSNSO  SETA  90   * VSE *             USER SENSE OUTPUT FIELD        06900000
&PLACTIV  SETA  92   * VSE *             RPL ACTIVE BYTE                06950000
&PLSIGDA  SETA  96   * VSE *             SIGNAL DATA FOUR BYTES         07000000
.* ************ END VTL ADDITIONS ***************                       07050000
&ASY     SETA  00                                                       07100000
&SYN     SETA  00                                                       07150000
&BIT0    SETB  0                                                        07200000
&CNTINQ  SETA  0                                                        07250000
&CNTSTL  SETA  0                                                   @H2A 07275000
&MSK1CTR SETA  0                                                        07300000
&MSK2CTR SETA  0                                                        07350000
&MSK3CTR SETA  0                                                        07400000
&MSK4CTR SETA  0                                                        07450000
&OPTERR  SETA  0                                                        07500000
&CA      SETB  0                                                        07550000
&CS      SETB  0                                                        07600000
&PASS    SETB  0                                                        07650000
&RELEASE SETB  0                                                        07700000
&NERASE  SETB  0                                                        07750000
&EAU     SETB  0                                                        07800000
&ERASE   SETB  0                                                        07850000
&SPEC    SETB  0                                                        07900000
&ANY     SETB  0                                                        07950000
&BLK     SETB  0                                                        08100000
&LBM     SETB  0                                                        08150000
&LBT     SETB  0                                                        08200000
&COND    SETB  0                                                        08250000
&UNCOND  SETB  0                                                        08300000
&LOCK    SETB  0                                                        08350000
&ACCEPT  SETB  0                                                        08400000
&ACQUIRE SETB  0                                                        08450000
&CONALL  SETB  0                                                        08500000
&CONANY  SETB  0                                                        08550000
&QUIESCE SETB  0                                                        08600000
&START   SETB  0                                                        08650000
&STOP    SETB  0                                                        08700000
&LGONMSG SETB  0                                                        08750000
&DEVCHAR SETB  0                                                        08800000
&TERMS   SETB  0                                                        08850000
&APPSTAT SETB  0                                                        08900000
&COUNTS  SETB  0                                                        08950000
&RNNAME  SETB  0                                                        09000000
&CIDXLAT SETB  0                                                        09050000
&TOPLGON SETB  0                                                        09100000
&BSCID   SETB  0                                                        09150000
&DISPLAY SETB  0                                                        09200000
&SPARM   SETB  0                                                        09250000
&SKEY    SETB  0                                                        09300000
&Q       SETB  0                                                        09350000
&NQ      SETB  0                                                        09400000
&RELRQ   SETB  0                                                        09450000
&NRELRQ  SETB  0                                                        09500000
&PEND    SETB  0                                                        09550000
&SESSION SETB  0                                                        09600000
&ACTIVE  SETB  0                                                        09650000
&UNCONDL SETB  0                                                        09700000
&NOTIFY  SETB  0                                                        09725000
&NBUFLST SETB  0                                               @D5B4747 09750000
&BUFFLST SETB  0                                               @D5B4747 09800000
&CONTCHN SETB  0                                               @D5B4747 09850000
&NCNTCHN SETB  0                                               @D5B4747 09900000
&NLMPEO  SETB  0                                               @D5B4747 09950000
&LMPEO   SETB  0                                               @D5B4747 10000000
&USERRH  SETB  0                                               @D5B4747 10050000
&NUSERRH SETB  0                                               @D5B4747 10100000
&USERVAR SETB  0                                               @R489318 10101900
&SONCD   SETB  0                                               @R491100 10103800
&NSONCD  SETB  0                                               @R491100 10107600
&UNBIND  SETB  0                                               @R491100 10111400
&SENSE   SETB  0                                               @R491100 10115200
&NSENSE  SETB  0                                               @R491100 10119000
&HOLD    SETB  0                                               @R491100 10122800
&RSPQUE  SETB  0                                               @R491101 10126600
&NRSPQU  SETB  0                                               @R491101 10130400
&QSESS   SETB  0                                               @R504800 10138000
&QNOTE   SETB  0                                               @R504800 10141800
&QALL    SETB  0                                               @R504800 10145600
&MTS     SETB  0                                                   @G1A 10147000
&NMTS    SETB  0                                                   @G1A 10148400
&TERMQ   SETB  0                                                   @01A 10149200
&PERSIQ  SETB  0                                                   @H2A 10149300
&PERST   SETB  0                                                   @H2A 10149400
&NPERST  SETB  0                                                   @H2A 10149500
&RESTOR  SETB  0                                                   @H2A 10149600
&PSTIME  SETB  0                                                   @H2A 10149700
&CONDCS  SETB  0                                                   @W1A 10156800
&CSSPEC  SETB  0                                                   @W1A 10163900
&CONDCSS SETB  0                                                   @W1A 10171000
&NQN     SETB  0                                                   @H2A 10178100
&STATUS  SETB  0                                                   @03A 10185200
.* *************** VTL ADDITIONS ****************                       10192300
&KEEP    SETB  0                                                        10200000
&TRUNC   SETB  0                                                        10250000
&NIBTK   SETB  0                                                        10300000
&FMHDR   SETB  0                                                        10350000
&NFMHDR  SETB  0                                                        10400000
&KEEP1      SETB  1                                                     10500000
&TRUNC1     SETB  1                                                     10550000
&NIBTK1     SETB  1                                                     10600000
&FMHDR1     SETB  1                                                     10650000
.* ************ END VTL ADDITIONS ***************                       10750000
&BIT01      SETB  1                                                     10800000
&CS1        SETB  1                                                     10850000
&PASS1      SETB  1                                                     10900000
&NERASE1    SETB  1                                                     10950000
&EAU1       SETB  1                                                     11000000
&ERASE1     SETB  1                                                     11050000
&ANY1       SETB  1                                                     11100000
&LBT1       SETB  1                                                     11200000
&LBM1       SETB  1                                                     11250000
&BLK1       SETB  1                                                     11300000
&COND1      SETB  1                                                     11350000
&UNCOND1    SETB  1                                                     11400000
&LOCK1      SETB  1                                                     11450000
&ACCEPT1    SETB  1                                                     11500000
&ACQUIR1    SETB  1                                                     11550000
&CONALL1    SETB  1                                                     11600000
&CONANY1    SETB  1                                                     11650000
&QUIESC1    SETB  1                                                     11700000
&START1     SETB  1                                                     11750000
&STOP1      SETB  1                                                     11800000
&LGONMS1    SETB  1                                                     11850000
&DEVCHR1    SETB  1                                                     11900000
&TERMS1     SETB  1                                                     11950000
&APSTAT1    SETB  1                                                     12000000
&COUNTS1    SETB  1                                                     12050000
&RNNAME1    SETB  1                                                     12100000
&CIDXLT1    SETB  1                                                     12150000
&TOPLGN1    SETB  1                                                     12200000
&BSCID1     SETB  1                                                     12250000
&DISPLY1    SETB  1                                                     12300000
&SPARM1     SETB  1                                                     12350000
&SKEY1      SETB  1                                          @XM30862   12400000
&NQ1        SETB  1                                                     12450000
&NRELRQ1    SETB  1                                                     12500000
&PEND1      SETB  1                                                     12550000
&SESION1    SETB  1                                                     12600000
&ACTIVE1    SETB  1                                                     12650000
&UNCNDL1    SETB  1                                                     12700000
&NOTIFY1    SETB  1                                                     12725000
&BUFLST1    SETB  1                                            @D5B4747 12750000
&CNTCHN1    SETB  1                                            @D5B4747 12800000
&LMPEO1     SETB  1                                            @D5B4747 12850000
&USERRH1    SETB  1                                            @D5B4747 12900000
&USRVAR1    SETB  1                                            @R489318 12905000
&SONCD1     SETB  1                                            @R491100 12910000
&NSONCD1    SETB  1                                            @R491100 12915000
&UNBIND1    SETB  1                                            @R491100 12920000
&SENSE1     SETB  1                                            @R491100 12930000
&NSENSE1    SETB  1                                            @R491100 12935000
&HOLD1      SETB  1                                            @R491100 12937500
&RSPQUE1    SETB  1                                            @R491101 12940000
&NRSPQU1    SETB  1                                            @R491101 12945000
&QSESS1     SETB  1                                            @R504800 12947000
&QNOTE1     SETB  1                                            @R504800 12948000
&QALL1      SETB  1                                            @R504800 12949000
&MTS1       SETB  1                                                @G1A 12949500
&TERMQ1     SETB  1                                                @01A 12949700
&STATUS1    SETB  1                                                @03A 12949800
&CONDCS1    SETB  1                                                @W1A 12949900
&ACBRTN  SETA  8   DISPLACEMENT IN ACB OF THE ADDR OF THE INTERFACE RTN 12950000
&OPT4X   SETC 'X''00'''             INITIALIZE OPT4X VALUE         @H2A 12975000
         AIF   ('&SCANOPT' NE '').OPTSCAN  RECURSIVE CALL TO OPTSCAN?   13000000
         AIF   ('&RPL' EQ '').NORPL  THIS IS AN ERROR CONDITION         13050000
.* ******************************************************************** 13100000
.*                        GETRPL SUBROUTINE                             13150000
.* GENERATES CODE TO LOAD THE ADDRESS OF THE RPL INTO REGISTER 1        13200000
.* ******************************************************************** 13250000
.GETRPL  ANOP                                                           13300000
         AIF   ('&RPL'(1,1) NE '(').GEN1  THIS BR FOR NON REG FORM      13350000
         AIF   ('&RPL' EQ '(1)').ENDRPL   NO LR INSTRUCTION NECESSARY   13400000
&NAME    LR    1,&RPL(1)             PUT ADDRESS OF RPL IN REGISTER 1   13450000
         CNOP  0,4                                                      13500000
         AGO   .ENDRPL1                                                 13550000
.GEN1    ANOP                                                           13600000
         CNOP  0,4                                                      13650000
&NAME    LA    1,&RPL                PUT ADDRESS OF RPL IN REGISTER 1   13700000
         AGO   .ENDRPL1                                                 13750000
.ENDRPL  ANOP                                                           13800000
         CNOP  0,4                                                      13850000
         AIF   ('&NAME' EQ '').ENDRPL1                                  13900000
&NAME    EQU   *                                                        13950000
.ENDRPL1 ANOP                                                           14000000
         AIF   ('&ACB' NE '' OR '&AREA' NE '' OR '&AREALEN' NE '').GEN  14050000
         AIF   ('&ECB' NE '' OR '&AAREA' NE '' OR '&RECLEN' NE '').GEN  14100000
         AIF   ('&ARG' NE '' OR '&OPTCD' NE '' OR '&AAREALN' NE '').GEN 14150000
         AIF   ('&NIB' NE '' OR '&EXIT' NE '' OR '&CRYPT' NE '').GEN    14183300
.*                                                           @D440518   14216600
         AIF   ('&ARECLEN' NE '' OR '&BRANCH' NE '').GEN                14250000
         AIF   ('&SIGDATA' NE '' OR '&AREALEN' NE '').GEN               14300000
.* *************** VTL ADDITIONS ****************                       14350000
         AIF   ('&RESPOND' NE '' OR '&CONTROL' NE '').GEN               14400000
         AIF   ('&CHNGDIR' NE '' OR '&SSENSEO' NE '').GEN               14450000
         AIF   ('&STYPE' NE '' OR '&RTYPE' NE '' ).GEN                  14500000
         AIF   ('&IBSQAC' NE '' OR '&OBSQAC' NE '').GEN                 14550000
         AIF   ('&POST' NE '' OR '&CHAIN' NE '').GEN                    14600000
         AIF   ('&SEQNO' NE '' OR '&USENSEO' NE '').GEN                 14650000
         AIF   ('&IBSQVAL' NE '' OR '&OBSQVAL' NE '').GEN               14700000
         AIF   ('&SSENSMO' NE '' OR '&BRACKET' NE '').GEN               14750000
         AIF   ('&THRDPTY' NE '' OR '&SONCODE' NE '').GEN               14825000
.* ************ END VTL ADDITIONS ***************                       14837500
         AIF   ('&PSTIMER' NE '').GEN                              @H2A 14843700
         AGO   .GENREQ                                                  14850000
.* ******************************************************************** 14900000
.*                     MDFYRPL SUBROUTINE                               14950000
.* GENERATES CODE TO MODIFY RPL FIELDS AT EXECUTION TIME.  INVOKES THE  15000000
.* FOLLOWING SUBROUTINES: MDFYOPT, GENMSK, MDFYRECD, AND THROUGH MDFY-  15050000
.* RECD, MDFYRESP, MDFYCHN, MDFYCTRL, MDFYCDIR, MDFYSSNS, MDFYRTYP,     15100000
.*                MDFYIBSQ, MDFYOBSQ, AND OPTSCAN.                      15150000
.* ******************************************************************** 15200000
.GEN     ANOP                                                           15250000
         TM    &PLACTIV.(1),X'FF'     IS THE RPL ACTIVE?                15300000
         BO    IHB&SYSNDX            YES BR AROUND MODIFY CODE          15350000
.CKACB   ANOP                                                           15400000
         AIF   ('&ACB' EQ '').CKAREA IS THERE AN ACB PARAMETER?         15450000
         AIF   ('&ACB'(1,1) NE '(').GEN2  REGISTER NOTATION?            15500000
         ST    &ACB(1),&PLDACB.(1)   PUT ACB ADDRESS IN THE RPL         15550000
         AGO   .CKAREA                                                  15600000
.GEN2    ANOP                                                           15650000
         LA    15,&ACB               GET ADDRESS OF NEW ACB             15700000
         ST 15,&PLDACB.(1)           AND PUT IT IN THE RPL              15750000
.CKAREA  ANOP                                                           15800000
         AIF   ('&AREA' EQ '').CKALEN  IS THERE AN AREA PARAMETER?      15850000
         AIF   ('&AREA'(1,1) NE '(').GEN3  REGISTER NOTATION?           15900000
         ST    &AREA(1),&PLAREA.(1)  PUT ADDRESS OF AREA IN THE RPL     15950000
         AGO   .CKALEN                                                  16000000
.GEN3    ANOP                                                           16050000
         LA    15,&AREA              GET ADDRESS OF NEW AREA            16100000
         ST    15,&PLAREA.(1)         AND PUT IT IN THE RPL             16150000
.CKALEN  ANOP                                                           16200000
         AIF   ('&AREALEN' EQ '').CKRLEN  IS THERE AN AREA LENGTH PARM? 16250000
         AIF   ('&AREALEN'(1,1) NE '(').GEN4  REGISTER NOTATION?        16300000
         ST    &AREALEN(1),&PLBUFL.(1)     PUT AREA LENGTH IN THE RPL   16350000
         AGO   .CKRLEN                                                  16400000
.GEN4    ANOP                                                           16450000
         B     *+8                                                      16500000
         DC    A(&AREALEN)                                              16550000
         L     15,*-4                GET NEW AREA LENGTH                16600000
         ST    15,&PLBUFL.(1)        AND PUT IT IN THE RPL              16650000
.CKRLEN  ANOP                                                           16700000
         AIF   ('&RECLEN' EQ '').CKAAR  IS THERE A RECORD LENGTH PARM?  16750000
         AIF   ('&RECLEN'(1,1) NE '(').GEN5  REGISTER NOTATION?         16800000
         ST    &RECLEN(1),&PLRLEN.(1)  PUT NEW RECORD LENGTH IN THE RPL 16850000
         AGO   .CKAAR                                                   16900000
.GEN5    ANOP                                                           16950000
         B     *+8                                                      17000000
         DC    A(&RECLEN)                                               17050000
         L     15,*-4                GET NEW RECORD LENGTH              17100000
         ST    15,&PLRLEN.(1)        AND PUT IT IN THE RPL              17150000
.CKAAR   ANOP                                                           17200000
         AIF   ('&AAREA' EQ '').CKAALN  IS THERE AN AAREA PARM?         17250000
         AIF   ('&AAREA'(1,1) NE '(').GEN6  REGISTER NOTATION?          17300000
         ST    &AAREA(1),&PLAAREA.(1)  PUT AAREA ADDRESS IN THE RPL     17350000
         AGO   .CKAALN                                                  17400000
.GEN6    ANOP                                                           17450000
         LA    15,&AAREA             GET ADDRESS OF AAREA               17500000
         ST    15,&PLAAREA.(1)       AND PUT IT IN THE RPL              17550000
.CKAALN  ANOP                                                           17600000
         AIF   ('&AAREALN' EQ '').CKARLN  IS THERE AN AAREALN PARM?     17650000
         AIF   ('&AAREALN'(1,1) NE '(').GEN7  REGISTER NOTATION?        17700000
         ST    &AAREALN(1),&PLAARLN.(1)   PUT AAREA LENGTH IN THE RPL   17750000
         AGO   .CKARLN                                                  17800000
.GEN7    ANOP                                                           17850000
         B     *+8                                                      17900000
         DC    A(&AAREALN)                                              17950000
         L     15,*-4                GET NEW AAREA LENGTH               18000000
         ST    15,&PLAARLN.(1)       AND PUT IT IN THE RPL              18050000
.CKARLN  ANOP                                                           18100000
         AIF   ('&ARECLEN' EQ '').CKARG  IS THERE AN ARECORD LNG PARM?  18150000
         AIF   ('&ARECLEN'(1,1) NE '(').GEN8  REGISTER NOTATION?        18200000
         ST    &ARECLEN(1),&PLARCLN.(1)  PUT ARECORD LENGTH IN THE RPL  18250000
         AGO   .CKARG                                                   18300000
.GEN8    ANOP                                                           18350000
         B     *+8                                                      18400000
         DC    A(&ARECLEN)                                              18450000
         L     15,*-4                GET NEW ARECORD LENGTH             18500000
         ST    15,&PLARCLN.(1)       AND PUT IT IN THE RPL              18550000
.CKARG   ANOP                                                           18600000
         AIF   ('&ARG' NE '' AND '&NIB' NE '').CKARGER  IS THERE AN ARG 18650000
         AIF   ('&ARG' EQ '').CKNIB  IS THERE AN ARG PARAMETER?         18700000
         AIF   ('&ARG'(1,1) NE '(').GEN9  REGISTER NOTATION?            18750000
         ST    &ARG(1),&PLARG.(1)    PUT NEW ARGUMENT IN THE RPL        18800000
         NI    &PLEXTDS.(1),X'FB'     SET NIB POINTER OFF               18850000
         AGO   .CKECB                                                   18900000
.CKNIB   ANOP                                                           18950000
         AIF   ('&NIB' EQ '').CKECB  IS THERE AN NIB PARAMETER?         19000000
         AIF   ('&NIB'(1,1) NE '(').CKNIB1  REGISTER NOTATION?          19050000
         ST    &NIB(1),&PLARG.(1)    PUT NIB POINTER IN THE RPL         19100000
         OI    &PLEXTDS.(1),X'04'     SET NIB POINTER ON                19150000
         AGO   .CKECB                                                   19200000
.CKNIB1  ANOP                                                           19250000
         LA    15,&NIB               GET NEW NIB POINTER                19300000
         ST    15,&PLARG.(1)         AND PUT IT IN THE RPL              19350000
         OI    &PLEXTDS.(1),X'04'     SET NIB POINTER ON                19400000
         AGO   .CKECB                                                   19450000
.CKARGER ANOP                                                           19500000
  MNOTE 4,'PARAMETERS ARG AND NIB CONFLICT - BOTH DISREGARDED' @P011983 19550000
         AGO   .CKECB                                                   19600000
.GEN9    ANOP                                                           19650000
  MNOTE 4,'PARAMETER ARG DOES NOT REFLECT REGISTER NOTATION - IGNORED'  19700000
.*                                                             @P011983 19725000
.CKECB   ANOP                                                           19750000
         AIF   ('&ECB' NE '' AND '&EXIT' NE '').GEN10  BOTH SPECIFIED?  19800000
         AIF   ('&ECB' NE '').ECBGEN  NO - IF ECB= WAS SPECIFIED, BR    19850000
         AIF   ('&EXIT' EQ '').CKTHRDP  EXIT= SPECIFIED?  NO - BRANCH   19900000
         AIF   ('&EXIT'(1,1) EQ '(').GEN10A  YES - REGISTER NOTATION?   19950000
         LA    15,&EXIT              GET ADDRESS OF EXIT ROUTINE        20000000
         ST    15,&PLECB.(1)         AND PUT IT IN THE RPL              20050000
         AGO   .FLGSETA                                                 20100000
.GEN10A  ANOP                                                           20150000
         ST    &EXIT(1),&PLECB.(1)  PUT EXIT ROUTINE ADDRESS IN THE RPL 20200000
.FLGSETA ANOP                                                           20250000
         NI    &PLOPTC1.(1),X'FE'        SET ECB FLAG OFF               20300000
         NI    &PLEXTDS.(1),X'BF'      SET NOEXIT BIT OFF               20350000
         OI    &PLEXTDS.(1),X'20'      SET EXIT BIT ON                  20400000
         AGO   .CKTHRDP                                                 20450000
.ECBGEN  ANOP                                                           20500000
         AIF   ('&ECB' EQ 'INTERNAL').FLGSETC    INTERNAL ECB SPECIFIED 20550000
         AIF   ('&ECB'(1,1) EQ '(').GEN10B  REGISTER NOTATION? YES - BR 20600000
         LA    15,&ECB               GET ADDRESS OF ECB                 20650000
         ST    15,&PLECB.(1)         AND PUT IT IN THE RPL              20700000
         AGO   .FLGSETB                                                 20750000
.GEN10B  ANOP                                                           20800000
         ST    &ECB(1),&PLECB.(1)    PUT NEW ECB ADDRESS IN THE RPL     20850000
.FLGSETB ANOP                                                           20900000
         OI    &PLOPTC1.(1),X'01'        SET ECB FLAG ON                20950000
         OI    &PLEXTDS.(1),X'40'      SET NOEXIT BIT ON                21000000
         NI    &PLEXTDS.(1),X'DF'      SET EXIT BIT OFF                 21050000
         AGO   .CKTHRDP                                                 21100000
.GEN10   ANOP                                                           21150000
        MNOTE 4,'ECB AND EXIT MUTUALLY EXCLUSIVE; INTERNAL ECB ASSUMED' 21200000
.FLGSETC ANOP                                                           21250000
         NI    &PLOPTC1.(1),X'FE'        SET ECB FLAG OFF               21300000
         OI    &PLEXTDS.(1),X'40'      SET NOEXIT BIT ON                21350000
         NI    &PLEXTDS.(1),X'DF'      SET EXIT BIT OFF                 21400000
.* ******************************************************************** 21450000
.* CHECK FOR THRDPTY=NOTIFY|NONOTIFY                                    21500000
.* ******************************************************************** 21550000
.CKTHRDP ANOP                                                  @G70AKMC 21600000
         AIF   ('&THRDPTY' EQ '').THRDPND                      @G70AKMC 21650000
         AIF   ('&THRDPTY' EQ 'NOTIFY').THRDP1                 @G70AKMC 21700000
         AIF   ('&THRDPTY' EQ 'NONOTIFY').THRDP2               @G70AKMC 21750000
         MNOTE 4,'THRDPTY=&THRDPTY IS NOT A VALID PARAMETER - IGNORED'  21800000
.*                                                             @P011983 21850000
         AGO   .THRDPND                                        @G70AKMC 21900000
.THRDP1  ANOP                                                  @G70AKMC 21950000
         AIF   ('&OPTCD' NE '').THRDP1A                        @G70AKMC 22000000
         OI    &POPTCD2.(1),X'40'      SET THRDPTY BIT ON      @G70AKMC 22050000
         AGO   .THRDPND                                        @G70AKMC 22100000
.THRDP1A ANOP                                                  @G70AKMC 22150000
&NOTIFY  SETB  1                                               @G70AKMC 22200000
&NOTIFY1 SETB  0                                               @G70AKMC 22250000
&MSK1CTR SETA  &MSK1CTR+1                                      @G70AKMC 22300000
&MSK2CTR SETA  &MSK2CTR+1                                      @G70AKMC 22350000
         AGO   .THRDPND                                        @G70AKMC 22400000
.THRDP2  ANOP                                                  @G70AKMC 22450000
         AIF   ('&OPTCD' NE '').THRDPND                        @G70AKMC 22500000
         NI    &POPTCD2.(1),X'DF'      SET THRDPTY BIT OFF     @G70AKMC 22550000
.THRDPND ANOP                                                  @G70AKMC 22600000
.* ******************************************************************** 22650000
.* CHECK FOR SONCODE=CODE                                               22657100
.* ******************************************************************** 22664200
         AIF   ('&SONCODE' EQ '').SONEND                       @R491100 22671300
         MVI   &SCODE.(1),&SONCODE     SET RPL SONCODE         @R491100 22678400
.SONEND  ANOP                                                  @R491100 22685500
.* ******************************************************************** 22692600
.* CHECK FOR PSTIMER=VALUE WITHOUT OPTCD                                22693400
.* (IF ANY OPTCD IS SPECIFIED, PSTIMER IS CHECKED AGAINST OPTCDS LATER) 22694200
.* ******************************************************************** 22695000
         AIF   (('&OPTCD' NE '') OR ('&PSTIMER' EQ '')).PSTMND     @H2A 22695800
         MNOTE 4,'PARMS=PSTIMER CAN ONLY BE SPECIFIED WITH OPTCD=PERSIS*22696600
               T - PSTIMER IGNORED'                                @H2A 22697400
.PSTMND  ANOP                                                      @H2A 22698200
.* ******************************************************************** 22699000
.*                       MDFYOPT SUBROUTINE                             22700000
.* VALIDITY CHECKS OPTCD OPTIONS AND SETS SWITCHES IN A MASK.  INVOKES  22750000
.* GENMASK TO GENERATE CODE IF REQUIRED.  ISSUES MNOTES FOR INVALID     22800000
.*                   OPTIONS THAT ARE SPECIFIED.                        22850000
.* ******************************************************************** 22900000
.CKOPTCD ANOP                                                           22950000
         AIF   ('&OPTCD' EQ '').CKSEQNO                                 23000000
&NUM     SETA N'&OPTCD                                                  23050000
.SETOPT   ANOP                                                          23100000
&LEN     SETA K'&OPTCD(&NUM)                                            23150000
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'N').NOPTS                        23200000
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'C').COPTS                        23250000
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'E').EOPTS                        23300000
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'A').AOPTS                        23350000
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'U').UOPTS               @R489301 23366600
         AIF  ('&OPTCD(&NUM)'(1,1) EQ 'H').HOPTS               @R491100 23383200
         AIF  ('&OPTCD(&NUM)'(1,1) NE 'S').XOPTS                        23400000
         AIF ('&OPTCD(&NUM)'(1,&LEN) NE 'SPEC').SOPTS1                  23450000
&SPEC    SETB 1                                                         23500000
&ANY1    SETB 0                                                         23550000
&MSK2CTR SETA  &MSK2CTR+1                                               23600000
         AGO  .GETNEXT                                                  23650000
.SOPTS1  ANOP                                                           23700000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SYN').SOPTS2                  23750000
&SYN     SETA 1                                                         23800000
         AGO  .GETNEXT                                                  23850000
.SOPTS2  ANOP                                                           23900000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSION').SOPTS3              23950000
&SESSION SETB 1                                                         24000000
&PEND1   SETB 0                                                         24050000
&SESION1 SETB 0                                                         24100000
&ACTIVE1 SETB 0                                                         24150000
&UNCNDL1 SETB 0                                                         24200000
&MSK1CTR SETA  &MSK1CTR+1                                               24250000
&MSK2CTR SETA  &MSK2CTR+1                                               24300000
         AGO  .GETNEXT                                                  24350000
.SOPTS3  ANOP                                                           24400000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'START').SOPTS4                24450000
&START   SETB 1                                                         24500000
&CNTSTL  SETA &CNTSTL+1                                            @H2A 24550000
         AGO  .GETNEXT                                                  24800000
.SOPTS4  ANOP                                                           24850000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'STOP').SOPTS5                 24900000
&STOP    SETB 1                                                         24950000
&CNTSTL  SETA &CNTSTL+1                                            @H2A 25000000
         AGO  .GETNEXT                                                  25250000
.SOPTS5  ANOP                                                           25300000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSPARM').SOPTS6             25350000
&SPARM   SETB 1                                                         25400000
&CNTINQ  SETA &CNTINQ+1                                                 25450000
         AGO  .GETNEXT                                                  25500000
.SOPTS6  ANOP                                                           25550000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SESSKEY').SOPTS7              25600000
&SKEY    SETB 1                                                         25650000
&CNTINQ  SETA &CNTINQ+1                                      @XM30862   25700000
         AGO  .GETNEXT                                                  25750000
.SOPTS7  ANOP                                                @R491100   25800000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SONCODE').SOPTS8   @R491100   25802900
&SONCD   SETB 1                                              @R491100   25805800
&SONCD1  SETB 0                                              @R491100   25808700
&NSONCD1 SETB 0                                              @R491100   25811600
&MSK3CTR SETA  &MSK3CTR+1                                    @R491100   25814500
&MSK4CTR SETA  &MSK4CTR+1                                    @R491100   25817400
         AGO  .GETNEXT                                       @R491100   25820300
.SOPTS8  ANOP                                                @R491100   25823200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'SENSE').SOPTS9     @R491100   25826100
&SENSE   SETB 1                                              @R491100   25829000
&SENSE1  SETB 0                                              @R491100   25831900
&NSENSE1 SETB 0                                              @R491100   25834800
&MSK3CTR SETA  &MSK3CTR+1                                    @R491100   25837700
&MSK4CTR SETA  &MSK4CTR+1                                    @R491100   25840600
         AGO  .GETNEXT                                       @R491100   25843500
.SOPTS9  ANOP                                                @R491100   25846400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'STATUS').SOPTS10       @03A   25847000
&STATUS  SETB 1                                                  @03A   25847600
&CNTINQ  SETA &CNTINQ+1                                          @03A   25848200
         AGO  .GETNEXT                                           @03A   25848800
.SOPTS10 ANOP                                                    @03A   25849400
         AGO  .INVLDOP                                                  25850000
.XOPTS   ANOP                                                           25900000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'UNCONDL').XOPTS1A             25950000
&UNCONDL SETB 1                                                         26000000
&PEND1   SETB 0                                                         26050000
&SESION1 SETB 0                                                         26100000
&ACTIVE1 SETB 0                                                         26150000
&UNCNDL1 SETB 0                                                         26200000
&MSK1CTR SETA  &MSK1CTR+1                                               26250000
&MSK2CTR SETA  &MSK2CTR+1                                               26300000
         AGO  .GETNEXT                                                  26350000
.XOPTS1A ANOP                                                           26400000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'UNCOND').XOPTS1B     @D5B4747 26450000
&UNCOND  SETB 1                                                         26500000
&UNCOND1 SETB 0                                                         26550000
&COND1   SETB 0                                                         26600000
&LOCK1   SETB 0                                                         26650000
&UNBIND1 SETB 0                                                @R491100 26662500
&TERMQ1  SETB 0                                                    @01A 26664500
&MSK1CTR SETA  &MSK1CTR+1                                               26666600
&MSK2CTR SETA  &MSK2CTR+1                                               26670700
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 26675000
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 26687500
         AGO  .GETNEXT                                                  26800000
.XOPTS1B ANOP                                                  @D5B4747 26850000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'USERRH').XOPTS1      @D5B4747 26900000
&USERRH  SETB 1                                                @D5B4747 26950000
&USERRH1 SETB 0                                                @D5B4747 27000000
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747 27050000
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 27100000
         AGO  .GETNEXT                                         @D5B4747 27150000
.XOPTS1  ANOP                                                           27200000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PEND').XOPTS2                 27250000
&PEND    SETB 1                                                         27300000
&PEND1   SETB 0                                                         27350000
&SESION1 SETB 0                                                         27400000
&ACTIVE1 SETB 0                                                         27450000
&UNCNDL1 SETB 0                                                         27500000
&MSK1CTR SETA  &MSK1CTR+1                                               27550000
&MSK2CTR SETA  &MSK2CTR+1                                               27600000
         AGO  .GETNEXT                                                  27650000
.XOPTS2  ANOP                                                           27700000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PASS').XOPTS3                 27750000
&PASS    SETB 1                                                         27800000
&PASS1   SETB 0                                                         27850000
&TERMQ1  SETB 0                                                    @01A 27875000
&MSK1CTR SETA  &MSK1CTR+1                                               27900000
&MSK2CTR SETA  &MSK2CTR+1                                               27950000
&MSK4CTR SETA  &MSK4CTR+1                                          @01A 27975000
         AGO  .GETNEXT                                                  28000000
.XOPTS3  ANOP                                                           28050000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LOCK').XOPTS4                 28100000
&LOCK    SETB 1                                                         28150000
&LOCK1   SETB 0                                                         28200000
&COND1   SETB 0                                                         28250000
&UNCOND1 SETB 0                                                         28270000
&UNBIND1 SETB 0                                                @R489318 28290000
&TERMQ1  SETB 0                                                    @01A 28293300
&MSK1CTR SETA  &MSK1CTR+1                                               28296600
&MSK2CTR SETA  &MSK2CTR+1                                               28303200
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 28310000
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 28330000
         AGO  .GETNEXT                                                  28450000
.XOPTS4  ANOP                                                           28500000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QUIESCE').XOPTS5              28550000
&QUIESCE SETB 1                                                         28600000
&CNTSTL  SETA &CNTSTL+1                                            @H2A 28650000
         AGO  .GETNEXT                                                  28900000
.XOPTS5  ANOP                                                           28950000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'Q').XOPTS6A          @R504800 29000000
&Q       SETB 1                                                         29050000
&NQ1     SETB 0                                                         29100000
&MSK1CTR SETA  &MSK1CTR+1                                               29150000
&MSK2CTR SETA  &MSK2CTR+1                                               29200000
         AGO  .GETNEXT                                                  29250000
.XOPTS6A ANOP                                                  @R504800 29253800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QALL').XOPTS6B       @R504800 29257600
&QALL    SETB 1                                                @R504800 29261400
&QSESS1  SETB 0                                                @R504800 29265200
&QNOTE1  SETB 0                                                @R504800 29269000
&MSK3CTR SETA  &MSK3CTR+1                                      @R504800 29272800
&MSK4CTR SETA  &MSK4CTR+1                                      @R504800 29276600
         AGO  .GETNEXT                                         @R504800 29280400
.XOPTS6B ANOP                                                  @R504800 29284200
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QSESSLIM').XOPTS6C   @R504800 29288000
&QSESS   SETB 1                                                @R504800 29291800
&QALL1   SETB 0                                                @R504800 29295600
&QNOTE1  SETB 0                                                @R504800 29299400
&MSK3CTR SETA  &MSK3CTR+1                                      @R504800 29303200
&MSK4CTR SETA  &MSK4CTR+1                                      @R504800 29307000
         AGO  .GETNEXT                                         @R504800 29310800
.XOPTS6C ANOP                                                  @R504800 29314600
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'QNOTENAB').XOPTS6D   @R504800 29318400
&QNOTE   SETB 1                                                @R504800 29322200
&QALL1   SETB 0                                                @R504800 29326000
&QSESS1  SETB 0                                                @R504800 29329800
&MSK3CTR SETA  &MSK3CTR+1                                      @R504800 29333600
&MSK4CTR SETA  &MSK4CTR+1                                      @R504800 29337400
         AGO  .GETNEXT                                         @R504800 29341200
.XOPTS6D ANOP                                                  @R504800 29345000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RELRQ').XOPTS7                29350000
&RELRQ  SETB 1                                                          29400000
&NRELRQ1 SETB 0                                                         29450000
&MSK1CTR SETA  &MSK1CTR+1                                               29500000
&MSK2CTR SETA  &MSK2CTR+1                                               29550000
         AGO  .GETNEXT                                                  29600000
.XOPTS7  ANOP                                                           29650000
         AIF ('&OPTCD(&NUM)'(1,&LEN) NE 'RELEASE').XOPTS8               29700000
&RELEASE   SETB 1                                                       29750000
&MSK2CTR SETA  &MSK2CTR+1                                               29800000
&PASS1   SETB 0                                                         29850000
&TERMQ1  SETB 0                                                    @01A 29866600
&MSK4CTR SETA  &MSK4CTR+1                                          @01A 29883200
         AGO  .GETNEXT                                                  29900000
.XOPTS8  ANOP                                                           29950000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BLK').XOPTS9                  30000000
&BLK     SETB 1                                                         30050000
&BLK1    SETB 0                                                         30100000
&LBT1    SETB 0                                                         30150000
&LBM1    SETB 0                                                         30200000
&MSK1CTR SETA  &MSK1CTR+1                                               30250000
&MSK2CTR SETA  &MSK2CTR+1                                               30300000
         AGO  .GETNEXT                                                  30350000
.XOPTS9  ANOP                                                           30400000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LBM').COPTSA                  30450000
&LBM     SETB 1                                                         30500000
&LBM1    SETB 0                                                         30550000
&LBT1    SETB 0                                                         30600000
&BLK1    SETB 0                                                         30650000
&MSK1CTR SETA  &MSK1CTR+1                                               30700000
&MSK2CTR SETA  &MSK2CTR+1                                               30750000
         AGO  .GETNEXT                                                  30800000
.COPTSA  ANOP                                                           30850000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LBT').XOPTSB                  30900000
&LBT     SETB 1                                                         30950000
&LBT1    SETB 0                                                         31000000
&LBM1    SETB 0                                                         31050000
&BLK1    SETB 0                                                         31100000
&MSK1CTR SETA  &MSK1CTR+1                                               31150000
&MSK2CTR SETA  &MSK2CTR+1                                               31200000
         AGO  .GETNEXT                                                  31250000
.XOPTSB  ANOP                                                           31300000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LOGONMSG').XOPTSD             31350000
&LGONMSG SETB 1                                                         31400000
&CNTINQ  SETA &CNTINQ+1                                                 31450000
         AGO  .GETNEXT                                                  31500000
.XOPTSD  ANOP                                                           31550000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'DEVCHAR').XOPTSE              31600000
&DEVCHAR SETB 1                                                         31650000
&CNTINQ  SETA &CNTINQ+1                                                 31700000
         AGO  .GETNEXT                                                  31750000
.XOPTSE  ANOP                                                           31800000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TERMS').XOPTSF                31850000
&TERMS   SETB 1                                                         31900000
&CNTINQ  SETA &CNTINQ+1                                                 31950000
         AGO  .GETNEXT                                                  32000000
.XOPTSF  ANOP                                                           32050000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RNNAME').XOPTSG               32100000
&RNNAME  SETB 1                                                         32150000
&CNTINQ  SETA &CNTINQ+1                                                 32200000
         AGO  .GETNEXT                                                  32250000
.XOPTSG  ANOP                                                           32300000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TOPLOGON').XOPTSH             32350000
&TOPLGON SETB 1                                                         32400000
&CNTINQ  SETA &CNTINQ+1                                                 32450000
         AGO  .GETNEXT                                                  32500000
.XOPTSH  ANOP                                                           32550000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BSCID').XOPTSI                32600000
&BSCID   SETB 1                                                         32650000
&CNTINQ  SETA &CNTINQ+1                                                 32700000
         AGO  .GETNEXT                                                  32750000
.XOPTSI  ANOP                                                           32800000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'DISPLAY').XOPTSJ              32850000
&DISPLAY SETB 1                                                         32900000
&CNTINQ  SETA &CNTINQ+1                                                 32950000
         AGO  .GETNEXT                                                  33000000
.XOPTSJ  ANOP                                                           33050000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'BUFFLST').XOPTSJ1    @D5B4747 33100000
&BUFFLST SETB 1                                                @D5B4747 33150000
&BUFLST1 SETB 0                                                @D5B4747 33200000
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747 33250000
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 33300000
         AGO  .GETNEXT                                         @D5B4747 33350000
.XOPTSJ1 ANOP                                                  @D5B4747 33400000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'LMPEO').XOPTSJ3      @D5B4747 33450000
&LMPEO   SETB 1                                                @D5B4747 33500000
&LMPEO1  SETB 0                                                @D5B4747 33550000
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747 33600000
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 33650000
         AGO  .GETNEXT                                         @D5B4747 33700000
.XOPTSJ3 ANOP                                                  @D5B4747 33750000
.* *************** VTL ADDITIONS ****************                       33800000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'KEEP').XOPTSL                 33850000
&KEEP    SETB 1                                                         33900000
&KEEP1   SETB 0                                                         33950000
&TRUNC1  SETB 0                                                         34000000
&NIBTK1  SETB 0                                                         34050000
&MSK3CTR SETA  &MSK3CTR+1                                               34100000
&MSK4CTR SETA  &MSK4CTR+1                                               34150000
         AGO  .GETNEXT                                                  34200000
.XOPTSL  ANOP                                                           34250000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TRUNC').XOPTSM                34300000
&TRUNC   SETB 1                                                         34350000
&TRUNC1  SETB 0                                                         34400000
&NIBTK1  SETB 0                                                         34450000
&KEEP1   SETB 0                                                         34500000
&MSK3CTR SETA  &MSK3CTR+1                                               34550000
&MSK4CTR SETA  &MSK4CTR+1                                               34600000
         AGO  .GETNEXT                                                  34650000
.XOPTSM  ANOP                                                           34700000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'FMHDR').XOPTSN                34750000
&FMHDR   SETB 1                                                         34800000
&FMHDR1  SETB 0                                                         34850000
&NFMHDR  SETB 0                                                         34900000
&MSK3CTR SETA  &MSK3CTR+1                                               34950000
&MSK4CTR SETA  &MSK4CTR+1                                               35000000
         AGO  .GETNEXT                                                  35050000
.XOPTSN  ANOP                                                           35100000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RSPQUED').XOPTSO     @R491101 35115600
&RSPQUE  SETB 1                                                @R491101 35131200
&NRSPQU1 SETB 0                                                @R491101 35132500
&RSPQUE1 SETB 0                                                @R491101 35133800
&MSK3CTR SETA  &MSK3CTR+1                                      @R491101 35135100
&MSK4CTR SETA  &MSK4CTR+1                                      @R491101 35136400
         AGO  .GETNEXT                                         @R491101 35137700
.XOPTSO  ANOP                                                  @R491101 35143800
.* ************ END VTL ADDITIONS ***************                       35150000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'MTS').XOPTSP             @G1A 35157100
&MTS     SETB 1                                                    @G1A 35164200
&MSK3CTR SETA  &MSK3CTR+1                                          @G1A 35171300
         AGO  .GETNEXT                                             @G1A 35178400
.XOPTSP  ANOP                                                      @G1A 35185500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PERSIST').XOPTSQ         @H2A 35185600
&PERST   SETB 1                                                    @H2A 35185700
&OPT4X   SETC 'X''80'''             RPLPERS  VALUE                 @U2C 35185800
&CNTSTL  SETA &CNTSTL+1                                            @H2A 35185900
         AGO  .GETNEXT                                             @H2A 35186000
.XOPTSQ  ANOP                                                      @H2A 35186100
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'PERSESS').XOPTSR         @H2A 35186200
&PERSIQ  SETB 1                                                    @H2A 35186300
&OPT4X   SETC 'X''20'''             RPLINQPS VALUE                 @U2C 35186400
&CNTINQ  SETA &CNTINQ+1                                            @H2A 35186500
         AGO  .GETNEXT                                             @H2A 35186600
.XOPTSR  ANOP                                                      @H2A 35186700
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'RESTORE').XOPTSS         @H2A 35186800
&OPT4X   SETC 'X''10'''             RPLOPRES VALUE                 @U2C 35186900
&RESTOR  SETB 1                                                    @H2A 35187000
&ACCEPT1 SETB 0                                                    @H2A 35187100
&ACQUIR1 SETB 0                                                    @H2A 35187200
&MSK1CTR SETA  &MSK1CTR+1                                          @H2A 35187300
&MSK2CTR SETA  &MSK2CTR+1                                          @H2A 35187400
         AGO  .GETNEXT                                             @H2A 35187500
.XOPTSS  ANOP                                                      @H2A 35187600
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'TERMQ').XOPTSQ           @01A 35187700
&TERMQ   SETB 1                                                    @01A 35187800
&TERMQ1  SETB 0                                                    @01A 35187900
&LOCK1   SETB 0                                                    @01A 35188000
&COND1   SETB 0                                                    @01A 35188100
&UNCOND1 SETB 0                                                    @01A 35188300
&UNBIND1 SETB 0                                                    @01A 35188700
&PASS1   SETB 0                                                    @01A 35189100
&MSK2CTR SETA  &MSK2CTR+1                                          @01A 35189500
&MSK3CTR SETA  &MSK3CTR+1                                          @01A 35189900
&MSK4CTR SETA  &MSK4CTR+1                                          @01A 35190300
         AGO  .GETNEXT                                             @01A 35190700
.XOPTST  ANOP                                                      @H2C 35191600
.*                                                                      35192600
.INVLDOP ANOP                                                           35200000
     MNOTE 4,'OPTCD=&OPTCD(&NUM) IS NOT A VALID PARAMETER - IGNORED '   35250000
.*                                                             @P011983 35275000
         AGO .GETNEXT                                                   35300000
.NOPTS   ANOP                                                           35350000
.* *************** VTL ADDITIONS ****************                       35400000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NIBTK').NOPTS2                35450000
&NIBTK   SETB 1                                                         35500000
&NIBTK1  SETB 0                                                         35550000
&KEEP1   SETB 0                                                         35600000
&TRUNC1  SETB 0                                                         35650000
&MSK3CTR SETA  &MSK3CTR+1                                               35700000
&MSK4CTR SETA  &MSK4CTR+1                                               35750000
         AGO  .GETNEXT                                                  35800000
.NOPTS2  ANOP                                                           35850000
.* ************ END VTL ADDITIONS ***************                       35900000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NERASE').NOPTS3               35950000
&NERASE  SETB 1                                                         36000000
&NERASE1 SETB 0                                                         36050000
&EAU1    SETB 0                                                         36100000
&ERASE1  SETB 0                                                         36150000
&MSK1CTR SETA  &MSK1CTR+1                                               36200000
&MSK2CTR SETA  &MSK2CTR+1                                               36250000
         AGO  .GETNEXT                                                  36300000
.NOPTS3  ANOP                                                           36350000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NCONV').NOPTS41      @D5B4747 36400000
.* *** NCONV NO LONGER SUPPORTED, IGNORED ***                      @W1C 36450000
         AGO  .GETNEXT                                                  36600000
.NOPTS41 ANOP                                                  @D5B4747 36650000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NBUFFLST').NOPTS43   @D5B4747 36700000
&NBUFLST SETB 1                                                @D5B4747 36750000
&BUFLST1 SETB 0                                                @D5B4747 36800000
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 36850000
         AGO  .GETNEXT                                         @D5B4747 36900000
.NOPTS43 ANOP                                                  @D5B4747 36950000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NCONTCHN').NOPTS45   @D5B4747 37000000
&NCNTCHN SETB 1                                                @D5B4747 37050000
&CNTCHN1 SETB 0                                                @D5B4747 37100000
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 37150000
         AGO  .GETNEXT                                         @D5B4747 37200000
.NOPTS45 ANOP                                                  @D5B4747 37250000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NLMPEO').NOPTS46     @D5B4747 37300000
&NLMPEO  SETB 1                                                @D5B4747 37350000
&LMPEO1  SETB 0                                                @D5B4747 37400000
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 37450000
         AGO  .GETNEXT                                         @D5B4747 37500000
.NOPTS46 ANOP                                                  @P5B8733 37550000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NUSERRH').NOPTS48    @R489318 37600000
&NUSERRH SETB 1                                                @D5B4747 37650000
&USERRH1 SETB 0                                                @D5B4747 37700000
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 37750000
         AGO  .GETNEXT                                         @D5B4747 37800000
.NOPTS48 ANOP                                                  @R489301 37805500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NSONCODE').NOPTS49   @R491100 37811000
&NSONCD  SETB 1                                                @R491100 37816500
&NSONCD1 SETB 0                                                @R491100 37822000
&SONCD1  SETB 0                                                @R491100 37827500
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 37833000
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 37838500
         AGO  .GETNEXT                                         @R491100 37844000
.NOPTS49 ANOP                                                  @R491100 37849500
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NSENSE').NOPTS50     @R491100 37855000
&NSENSE  SETB 1                                                @R491100 37860500
&NSENSE1 SETB 0                                                @R491100 37866000
&SENSE1  SETB 0                                                @R491100 37871500
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 37877000
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 37882500
         AGO  .GETNEXT                                         @R491100 37888000
.NOPTS50 ANOP                                                  @R491100 37893500
.* *************** VTL ADDITIONS ****************                       37900000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NFMHDR').NOPTS5               37950000
&NFMHDR  SETB 1                                                         38000000
&FMHDR1  SETB 0                                                         38050000
&MSK4CTR SETA  &MSK4CTR+1                                               38100000
         AGO  .GETNEXT                                                  38150000
.NOPTS5  ANOP                                                           38200000
.* *********** END VTL ADDITIONS ****************                       38250000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NQ').NOPTS6                   38300000
&NQ      SETB 1                                                         38350000
&NQ1     SETB 0                                                         38400000
&MSK2CTR SETA  &MSK2CTR+1                                               38450000
         AGO  .GETNEXT                                                  38500000
.NOPTS6  ANOP                                                           38550000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NRELRQ').NOPTS8               38600000
&NRELRQ SETB 1                                                          38650000
&NRELRQ1 SETB 0                                                         38700000
&MSK2CTR SETA  &MSK2CTR+1                                               38750000
         AGO  .GETNEXT                                                  38800000
.NOPTS8  ANOP                                                           38824000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NRSPQUED').NOPTS51   @R491101 38848000
&NRSPQU  SETB 1                                                @R491101 38872200
&NRSPQU1 SETB 0                                                @R491101 38876000
&RSPQUE1 SETB 0                                                @R491101 38879800
&MSK3CTR SETA  &MSK3CTR+1                                      @R491101 38883600
&MSK4CTR SETA  &MSK4CTR+1                                      @R491101 38887400
         AGO  .GETNEXT                                         @R491101 38891200
.NOPTS51 ANOP                                                           38895000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NMTS').NOPTS52           @G1A 38895800
&NMTS    SETB 1                                                    @G1A 38896600
&MTS1    SETB 0                                                    @G1A 38897000
&MSK4CTR SETA  &MSK4CTR+1                                          @G1A 38897400
         AGO  .GETNEXT                                             @G1A 38898200
.NOPTS52 ANOP                                                      @G1A 38899000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NPERSIST').NOPTS53       @H2A 38902600
&NPERST  SETB 1                                                    @H2A 38906200
&OPT4X   SETC 'X''40'''             RPLNPERS VALUE                 @U2C 38909800
&CNTSTL  SETA &CNTSTL+1                                            @H2A 38913400
         AGO  .GETNEXT                                             @H2A 38917000
.NOPTS53 ANOP                                                      @H2A 38920600
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'NQN').NOPTS54            @H2A 38924200
&NQN     SETB 1                                                    @H2A 38927800
&OPT4X   SETC 'X''04'''             RPLNQN   VALUE                 @U2C 38931400
&CNTINQ  SETA &CNTINQ+1                                            @H2A 38935000
         AGO  .GETNEXT                                             @H2A 38938600
.NOPTS54 ANOP                                                      @H2A 38942200
         AGO  .INVLDOP                                                  38945800
.COPTS   ANOP                                                           38950000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CS').COPTS2                   39000000
&CSSPEC  SETB 1                                                    @W1A 39025000
&CS      SETB 1                                                         39050000
&CS1     SETB 0                                                         39100000
&CONDCS1 SETB 0                                                    @W1A 39125000
&MSK1CTR SETA  &MSK1CTR+1                                               39150000
&MSK2CTR SETA  &MSK2CTR+1                                               39200000
         AGO  .GETNEXT                                                  39250000
.COPTS2  ANOP                                                           39300000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'COND').COPTS3                 39350000
&COND    SETB 1                                                         39400000
&COND1   SETB 0                                                         39450000
&LOCK1   SETB 0                                                         39500000
&UNCOND1  SETB 0                                                        39520000
&UNBIND1  SETB 0                                               @R491100 39540000
&TERMQ1  SETB 0                                                    @01A 39543300
&MSK1CTR SETA  &MSK1CTR+1                                               39546600
&MSK2CTR SETA  &MSK2CTR+1                                               39553200
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 39560000
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 39580000
         AGO  .GETNEXT                                                  39700000
.COPTS3  ANOP                                                           39750000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONV').COPTS4                 39800000
.* *** CONV NO LONGER SUPPORTED, IGNORED ***                       @W1C 39850000
         AGO  .GETNEXT                                                  40050000
.COPTS4  ANOP                                                           40100000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONALL').COPTS5               40150000
&CONALL  SETB 1                                                         40200000
&CONALL1 SETB 0                                                         40250000
&CONANY1 SETB 0                                                         40300000
&MSK1CTR SETA  &MSK1CTR+1                                               40350000
&MSK2CTR SETA  &MSK2CTR+1                                               40400000
         AGO  .GETNEXT                                                  40450000
.COPTS5  ANOP                                                           40500000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONANY').COPTS6               40550000
&CONANY  SETB 1                                                         40600000
&CONANY1 SETB 0                                                         40650000
&CONALL1 SETB 0                                                         40700000
&MSK1CTR SETA  &MSK1CTR+1                                               40750000
&MSK2CTR SETA  &MSK2CTR+1                                               40800000
         AGO  .GETNEXT                                                  40850000
.COPTS6  ANOP                                                           40900000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CA').COPTS7                   40950000
&CA      SETB 1                                                         41000000
&CS1     SETB 0                                                         41050000
&CONDCS1 SETB 0                                                    @W1A 41075000
&MSK2CTR SETA  &MSK2CTR+1                                               41100000
         AGO  .GETNEXT                                                  41150000
.COPTS7  ANOP                                                           41200000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'COUNTS').COPTS8               41250000
&COUNTS  SETB 1                                                         41300000
&CNTINQ  SETA &CNTINQ+1                                                 41350000
         AGO  .GETNEXT                                                  41400000
.COPTS8  ANOP                                                           41450000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CIDXLATE').COPTS9             41500000
&CIDXLAT SETB 1                                                         41550000
&CNTINQ  SETA &CNTINQ+1                                                 41600000
         AGO  .GETNEXT                                                  41650000
.COPTS9  ANOP                                                  @R489301 41700000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONTCHN').COPTS10        @W1C 41750000
&CONTCHN SETB 1                                                @D5B4747 41800000
&CNTCHN1 SETB 0                                                @D5B4747 41850000
&MSK1CTR SETA  &MSK1CTR+1                                      @D5B4747 41900000
&MSK2CTR SETA  &MSK2CTR+1                                      @D5B4747 41950000
         AGO  .GETNEXT                                         @D5B4747 42000000
.COPTS10 ANOP                                                      @W1A 42000400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'CONDCS').XOPTS           @W1A 42000800
&CONDCSS SETB 1                                                    @W1A 42001200
&CONDCS  SETB 1                                                    @W1A 42001600
&CONDCS1 SETB 0                                                    @W1A 42002000
&CS      SETB 1                                                    @W1A 42002400
&CS1     SETB 0                                                    @W1A 42002800
&MSK1CTR SETA &MSK1CTR+1                                           @W1A 42003200
&MSK2CTR SETA &MSK2CTR+1                                           @W1A 42003600
         AGO  .GETNEXT                                             @W1A 42004000
.UOPTS   ANOP                                                  @R489301 42005300
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'USERVAR').UOPTS1     @R489318 42010600
&USERVAR SETB 1                                                @R489318 42015900
&CNTINQ  SETA &CNTINQ+1                                        @R489318 42021200
         AGO  .GETNEXT                                         @R489318 42026500
.UOPTS1  ANOP                                                  @R489318 42031800
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'UNBIND').XOPTS       @R491100 42037100
&UNBIND  SETB 1                                                @R491100 42042400
&UNBIND1 SETB 0                                                @R491100 42047700
&COND1   SETB 0                                                @R491100 42053000
&LOCK1   SETB 0                                                @R491100 42058300
&UNCOND1 SETB 0                                                @R491100 42063600
&TERMQ1  SETB 0                                                    @01A 42066200
&MSK1CTR SETA  &MSK1CTR+1                                      @R491100 42068900
&MSK2CTR SETA  &MSK2CTR+1                                      @R491100 42074200
&MSK3CTR SETA  &MSK3CTR+1                                      @R491100 42079500
&MSK4CTR SETA  &MSK4CTR+1                                      @R491100 42084800
         AGO  .GETNEXT                                         @R491100 42090100
.HOPTS   ANOP                                                  @R489301 42095400
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'HOLD').XOPTS         @R491100 42100700
&HOLD    SETB 1                                                @R491100 42106000
&CNTSTL  SETA &CNTSTL+1                                            @H2A 42124500
         AGO  .GETNEXT                                         @R491100 42143100
.EOPTS   ANOP                                                           42150000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'EAU').EOPTS3                  42200000
&EAU     SETB 1                                                         42250000
&EAU1    SETB 0                                                         42300000
&ERASE1  SETB 0                                                         42350000
&NERASE1 SETB 0                                                         42400000
&MSK1CTR SETA  &MSK1CTR+1                                               42450000
&MSK2CTR SETA  &MSK2CTR+1                                               42500000
         AGO  .GETNEXT                                                  42550000
.EOPTS3  ANOP                                                           42600000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ERASE').EOPTS4                42650000
&ERASE   SETB 1                                                         42700000
&ERASE1  SETB 0                                                         42750000
&EAU1    SETB 0                                                         42800000
&NERASE1 SETB 0                                                         42850000
&MSK1CTR SETA  &MSK1CTR+1                                               42900000
&MSK2CTR SETA  &MSK2CTR+1                                               42950000
         AGO  .GETNEXT                                                  43000000
.EOPTS4  ANOP                                                           43050000
         AGO  .INVLDOP                                                  43100000
.AOPTS   ANOP                                                           43150000
         AIF ('&OPTCD(&NUM)'(1,&LEN) NE 'ANY').AOPTS1                   43200000
&ANY     SETB 1                                                         43250000
&ANY1    SETB 0                                                         43300000
&MSK1CTR SETA  &MSK1CTR+1                                               43350000
&MSK2CTR SETA  &MSK2CTR+1                                               43400000
         AGO  .GETNEXT                                                  43450000
.AOPTS1  ANOP                                                           43500000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ACCEPT').AOPTS2               43550000
&ACCEPT  SETB 1                                                         43600000
&ACCEPT1 SETB 0                                                         43650000
&ACQUIR1 SETB 0                                                         43700000
&MSK1CTR SETA  &MSK1CTR+1                                               43750000
&MSK2CTR SETA  &MSK2CTR+1                                               43800000
         AGO  .GETNEXT                                                  43850000
.AOPTS2  ANOP                                                           43900000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ACQUIRE').AOPTS3              43950000
&ACQUIRE SETB 1                                                         44000000
&ACCEPT1 SETB 0                                                         44050000
&ACQUIR1 SETB 0                                                         44100000
&MSK1CTR SETA  &MSK1CTR+1                                               44150000
&MSK2CTR SETA  &MSK2CTR+1                                               44200000
         AGO  .GETNEXT                                                  44250000
.AOPTS3  ANOP                                                           44300000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ASY').AOPTS4                  44350000
&ASY     SETA 1                                                         44400000
         AGO  .GETNEXT                                                  44450000
.AOPTS4  ANOP                                                           44500000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'ACTIVE').AOPTS5               44550000
&ACTIVE  SETB 1                                                         44600000
&PEND1   SETB 0                                                         44650000
&SESION1 SETB 0                                                         44700000
&ACTIVE1 SETB 0                                                         44750000
&UNCNDL1 SETB 0                                                         44800000
&MSK1CTR SETA  &MSK1CTR+1                                               44850000
&MSK2CTR SETA  &MSK2CTR+1                                               44900000
         AGO  .GETNEXT                                                  44950000
.AOPTS5  ANOP                                                           45000000
         AIF  ('&OPTCD(&NUM)'(1,&LEN) NE 'APPSTAT').AOPTS6              45050000
&APPSTAT SETB 1                                                         45100000
&CNTINQ  SETA &CNTINQ+1                                                 45150000
         AGO  .GETNEXT                                                  45200000
.AOPTS6  ANOP                                                           45250000
         AGO  .INVLDOP                                                  45300000
.GETNEXT ANOP                                                           45350000
&NUM     SETA  &NUM-1                                                   45400000
         AIF   ('&NUM' NE '0').SETOPT                                   45450000
.* ******************************************************************** 45500000
.*                      GENMSK SUBROUTINE                               45550000
.* CHECKS FOR MUTUALLY EXCLUSIVE OPTIONS (OF OPTCD) AND GENERATES CODE  45600000
.* TO MODIFY THE OPTION BYTES IN THE RPL.  ISSUES MNOTES FOR MUTUALLY   45650000
.*                       EXCLUSIVE OPTIONS.                             45700000
.* ******************************************************************** 45750000
.GENMSK  ANOP                                                           45800000
.* ******************************************************************** 45802000
.* CHECK FOR PSTIMER=VALUE                                         @H2A 45804000
.* ******************************************************************** 45806000
         AIF   ('&PSTIMER' EQ '').PSTIMND  PSTIMER SPECIFIED?      @H2A 45808000
         AIF   (NOT(&PERST)).PSTMERR   OPTCD=PERSIST NOT SET?      @H2A 45810000
&PSTIME  SETB  1                                                   @H2A 45812000
&OPT4X   SETC 'X''88'''             RPLPERS VALUE + RPLSLTMR       @U2C 45814000
&MSK3CTR SETA  &MSK3CTR+1                                          @H2A 45816000
&MSK4CTR SETA  &MSK4CTR+1                                          @H2A 45818000
         AIF   ('&PSTIMER'(1,1) NE '(').TVAL  REG NOTATION?        @H2A 45820000
         ST    &PSTIMER(1),&PLUSFLD.(1)  PUT TIMER VALUE IN RPL         45822000
.*                                                                 @H2A 45824000
         AGO   .PSTIMND                                            @H2A 45826000
.PSTMERR ANOP                                                      @H2A 45828000
         MNOTE 4,'PARMS=PSTIMER CAN ONLY BE SPECIFIED WITH OPTCD=PERSIS*45830000
               T - PSTIMER IGNORED'                                @H2A 45832000
         AGO   .PSTIMND                                            @H2A 45834000
.TVAL    ANOP                          CONSTANT SPECIFIED          @H2A 45836000
         B     *+8                                                 @H2A 45838000
         DC    A(&PSTIMER)                                         @H2A 45840000
         L     15,*-4                                              @H2A 45842000
         ST    15,&PLUSFLD.(1)         PUT TIMER VALUE IN RPL      @H2A 45844000
.PSTIMND ANOP                                                      @H2A 45846000
         AIF  ('&SYN' EQ '1' AND '&ASY' EQ '1').CNFLCT1                 45850000
         AIF  ('&SYN' NE '1' AND '&ASY' NE '1').MODOPT                  45900000
         AIF  ('&ASY' EQ '1').ASYSW                                     45950000
         NI    &PLOPTC1.(1),X'F7'     TURN OFF THE ASY BIT              46000000
         AGO   .MODOPT                                                  46050000
.ASYSW   ANOP                                                           46100000
         OI    &PLOPTC1.(1),X'08'     TURN ON THE ASY BIT               46150000
         AGO   .MODOPT                                                  46200000
.CNFLCT1 ANOP                                                           46250000
     MNOTE 4,'PARAMETERS SYN AND ASY CONFLICT BOTH DISREGARDED'         46300000
.*                                                             @P011983 46325000
.MODOPT  ANOP                                                           46350000
         AIF  ('&SPEC' EQ '1' AND '&ANY' EQ '1').CNFLCT2                46400000
.MODOPT2 ANOP                                                           46450000
         AIF  ('&CNTSTL' EQ '0' ).MODOPT3                          @H2A 46461700
         AIF  ('&CNTSTL' GT '1' ).CNFLCT3                          @H2A 46473400
         AIF  ('&IHBRW' EQ '21').STLOPT     MACRO IS SETLOGON      @H2A 46485100
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON SETLOGON            @H2A 46496800
         AIF  (NOT(&PERST OR &NPERST)).STLOPT                      @H2A 46508500
&OPTERR  SETA &OPTERR+1                                            @H2A 46520200
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE SETLOX46531900
               GON MACRO,   DISREGARDED'                           @H2A 46543600
         AGO   .MODOPT3                                            @H2A 46555300
.STLOPT  ANOP                                                      @H2A 46567000
&START1  SETB  0                                                   @H2A 46578700
&STOP1   SETB  0                                                   @H2A 46590400
&QUIESC1 SETB  0                                                   @H2A 46602100
&HOLD1   SETB  0                                                   @H2A 46613800
&MSK3CTR SETA  &MSK3CTR+1                                          @H2A 46625500
&MSK4CTR SETA  &MSK4CTR+1                                          @H2A 46637200
.MODOPT3 ANOP                                                           46650000
         AIF  ('&PASS' EQ '1' AND '&RELEASE' EQ '1').CNFLCT5            46800000
.MODOPT5 ANOP                                                           46850000
         AIF  ('&CA' EQ '1' AND '&CSSPEC' EQ '1').CNFLCT6          @W1C 46875000
         AIF  ('&CA' EQ '1' AND '&CONDCSS' EQ '1').CNFLCT6         @W1A 46900000
         AIF  ('&CSSPEC' EQ '1' AND '&CONDCSS' EQ '1').CNFLCT6     @W1A 46925000
.MODOPT6 ANOP                                                           46950000
         AIF  ('&ACCEPT' EQ '1' AND '&ACQUIRE' EQ '1').CNFLCT7          47000000
         AIF  ('&ACCEPT' EQ '1' AND '&RESTOR' EQ '1').CNFLCT7      @H2A 47005500
         AIF  ('&ACQUIRE' EQ '1' AND '&RESTOR' EQ '1').CNFLCT7     @H2A 47011000
         AIF  ('&IHBRW' EQ '23').MODOPT7    MACRO IS OPNDST        @H2A 47016500
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON OPNDST              @H2A 47022000
         AIF  (NOT(&RESTOR)).MODOPT7                               @H2A 47027500
&OPTERR  SETA &OPTERR+1                                            @H2A 47033000
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE OPNDSX47038500
               T MACRO,     DISREGARDED'                           @H2A 47044000
.MODOPT7 ANOP                                                           47050000
         AIF  ('&Q' EQ '1' AND '&NQ' EQ '1').CNFLCT8                    47100000
.MODOPT8 ANOP                                                           47150000
         AIF  ('&RELRQ' EQ '1' AND '&NRELRQ' EQ '1').CNFLCT9            47200000
.MODOPT9 ANOP                                                           47250000
         AIF  ('&ERASE' EQ '1' AND '&EAU' EQ '1').CNFLCTB               47300000
         AIF  ('&ERASE' EQ '1' AND '&NERASE' EQ '1').CNFLCTB            47350000
         AIF  ('&EAU' EQ '1' AND '&NERASE' EQ '1').CNFLCTB              47400000
.MODOPTB ANOP                                                           47450000
         AIF  ('&BLK' EQ '1' AND '&LBM' EQ '1').CNFLCTC                 47500000
         AIF  ('&BLK' EQ '1' AND '&LBT' EQ '1').CNFLCTC                 47550000
         AIF  ('&LBM' EQ '1' AND '&LBT' EQ '1').CNFLCTC                 47600000
.MODOPTC ANOP                                                           47650000
         AIF  ('&LOCK' EQ '1' AND '&COND' EQ '1').CNFLCTD               47700000
         AIF  ('&LOCK' EQ '1' AND '&UNCOND' EQ '1').CNFLCTD             47750000
         AIF  ('&LOCK' EQ '1' AND '&UNBIND' EQ '1').CNFLCTD    @R491100 47812500
         AIF  ('&COND' EQ '1' AND '&UNCOND' EQ '1').CNFLCTD             47818700
         AIF  ('&COND' EQ '1' AND '&UNBIND' EQ '1').CNFLCTD    @R491100 47825000
         AIF  ('&UNCOND' EQ '1' AND '&UNBIND' EQ '1').CNFLCTD  @R491100 47837500
.MODOPTD ANOP                                                           47850000
         AIF  ('&CONALL' EQ '1' AND '&CONANY' EQ '1').CNFLCTE           47900000
.MODOPTE ANOP                                                           47950000
         AIF  ('&PEND' EQ '1' AND '&SESSION' EQ '1').CNFLCTF            48000000
         AIF  ('&PEND' EQ '1' AND '&ACTIVE' EQ '1').CNFLCTF             48050000
         AIF  ('&PEND' EQ '1' AND '&UNCONDL' EQ '1').CNFLCTF            48100000
         AIF  ('&ACTIVE' EQ '1' AND '&SESSION' EQ '1').CNFLCTF          48150000
         AIF  ('&ACTIVE' EQ '1' AND '&UNCONDL' EQ '1').CNFLCTF          48200000
         AIF  ('&SESSION' EQ '1' AND '&UNCONDL' EQ '1').CNFLCTF         48250000
.MDOPTE1 ANOP                                                  @D5B4747 48300000
         AIF  ('&NBUFLST' EQ '1' AND '&BUFFLST' EQ '1').CNFLCF1         48350000
.*                                                             @D5B4747 48400000
.MDOPTE2 ANOP                                                  @D5B4747 48450000
         AIF  ('&CONTCHN' EQ '1' AND '&NCNTCHN' EQ '1').CNFLCF2         48500000
.*                                                             @D5B4747 48550000
.MDOPTE3 ANOP                                                  @D5B4747 48600000
         AIF  ('&NLMPEO' EQ '1' AND '&LMPEO' EQ '1').CNFLCF3            48633300
.*                                                             @D5B4747 48666600
.MDOPTE4 ANOP                                                  @D5B4747 48699900
         AIF  ('&NUSERRH' EQ '1' AND '&USERRH' EQ '1').CNFLCF4          48733200
.*                                                             @D5B4747 48766500
.MDOPTE5 ANOP                                                           48774800
         AIF  ('&MTS' EQ '1' AND '&NMTS' EQ '1').CNFLCF5                48783100
.*                                                                 @G1A 48791400
.MDOPTE6 ANOP                                                      @01A 48792100
         AIF  ('&PASS' EQ '1' AND '&TERMQ' EQ '1').CNFLCF6         @01A 48792800
         AIF  ('&RELEASE' EQ '1' AND '&TERMQ' EQ '1').CNFLCF6      @01A 48793500
.*                                                                      48794200
.MDOPTE7 ANOP                                                      @01A 48794900
         AIF  ('&LOCK' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7         @01A 48795600
         AIF  ('&COND' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7         @01A 48796300
         AIF  ('&UNCOND' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7       @01A 48797000
         AIF  ('&UNBIND' EQ '1' AND '&TERMQ' EQ '1').CNFLCF7       @01A 48797700
.*                                                                      48798400
.MODOPTF ANOP                                                           48800000
         AIF  ('&CNTINQ' EQ '0' ).MODOPTG                               48850000
         AIF  ('&CNTINQ' GT '1' ).CNFLCTG                               48900000
         AIF  ('&IHBRW' EQ '26').INQOPT     MACRO IS INQUIRE       @H2A 48905500
.* **** CHECK FOR OPTCD VALUES ONLY ALLOWED ON INQUIRE             @H2A 48911000
         AIF  (NOT(&PERSIQ OR &NQN)).INQOPT                        @H2A 48916500
&OPTERR  SETA &OPTERR+1                                            @H2A 48922000
         MNOTE 4,'AN OPTCD VALUE SPECIFIED IS ONLY ALLOWED ON THE INQUIX48927500
               RE MACRO,    DISREGARDED'                           @H2A 48933000
         AGO   .MODOPTG                                            @H2A 48938500
.INQOPT  ANOP                                                      @H2A 48944000
&LGONMS1 SETB  0                                                        48950000
&DEVCHR1 SETB  0                                                        49000000
&TERMS1  SETB  0                                                        49050000
&APSTAT1 SETB  0                                                        49100000
&COUNTS1 SETB  0                                                        49150000
&RNNAME1 SETB  0                                                        49200000
&CIDXLT1 SETB  0                                                        49250000
&TOPLGN1 SETB  0                                                        49300000
&BSCID1  SETB  0                                                        49350000
&DISPLY1 SETB  0                                                        49400000
&SPARM1  SETB  0                                                        49450000
&SKEY1   SETB  0                                             @XM30862   49483300
&USRVAR1 SETB  0                                             @R489318   49516600
&STATUS1 SETB  0                                                 @03A   49533300
&MSK3CTR SETA  &MSK3CTR+1                                               49550000
&MSK4CTR SETA  &MSK4CTR+1                                               49600000
.MODOPTG ANOP                                                           49650000
.* *************** VTL ADDITIONS ****************                       49700000
         AIF  ('&KEEP' EQ '1' AND '&TRUNC' EQ '1').CNFLCTI              49750000
         AIF  ('&KEEP' EQ '1' AND '&NIBTK' EQ '1').CNFLCTI              49800000
         AIF  ('&TRUNC' EQ '1' AND '&NIBTK' EQ '1').CNFLCTI             49850000
.MODOPTI ANOP                                                           49900000
         AIF  ('&NFMHDR' EQ '1' AND '&FMHDR' EQ '1').CNFLCTK            49950000
.MODOPTK ANOP                                                           50000000
.* ************ END VTL ADDITIONS ***************                       50050000
         AIF  ('&QALL' EQ '1' AND '&QSESS' EQ '1').CNFLCTL     @R504800 50054500
         AIF  ('&QALL' EQ '1' AND '&QNOTE' EQ '1').CNFLCTL     @R504800 50059000
         AIF  ('&QSESS' EQ '1' AND '&QNOTE' EQ '1').CNFLCTL    @R504800 50063500
.MODOPTL ANOP                                                  @R504800 50068000
         AIF  ('&NSONCD' EQ '1' AND '&SONCD' EQ '1').CNFLCTN   @R491100 50072500
.MODOPTN ANOP                                                  @R491100 50077000
         AIF  ('&NSENSE' EQ '1' AND '&SENSE' EQ '1').CNFLCTO   @R491100 50081500
.MODOPTO ANOP                                                  @R491100 50086000
         AIF  ('&RSPQUE' EQ '1' AND '&NRSPQU' EQ '1').CNFLCTP  @R491101 50090500
.MODOPTP ANOP                                                  @R491101 50095000
         AGO   .CKDONE                                                  50100000
.CNFLCT2 ANOP                                                           50150000
&OPTERR  SETA  &OPTERR+1                                                50200000
   MNOTE 4,'PARAMETERS SPEC AND ANY CONFLICT BOTH DISREGARDED' @P011983 50250000
         AGO   .MODOPT2                                            @W1C 50300000
.CNFLCT3 ANOP                                                           50350000
&OPTERR  SETA  &OPTERR+1                                                50400000
   MNOTE 4,'TWO OR MORE OF THE FOLLOWING CONFLICTING VALUES WERE SPECIFX50430000
               IED'                                                @H2C 50460000
   MNOTE 4,'     STOP, START, QUIESCE, HOLD, PERSIST, NPERSIST  '  @H2A 50490000
   MNOTE 4,'     - ALL DISREGARDED'                                @H2C 50520000
         AGO   .MODOPT3                                                 50550000
.CNFLCT5 ANOP                                                           50800000
&OPTERR  SETA  &OPTERR+1                                                50850000
   MNOTE 4,'PARAMETERS PASS AND RELEASE CONFLICT BOTH DISREGARDED'      50900000
.*                                                             @P011983 50925000
         AGO   .MODOPT5                                                 50950000
.CNFLCT6 ANOP                                                           51000000
&OPTERR  SETA  &OPTERR+1                                                51050000
   MNOTE 4,'PARAMETERS CA, CS, AND CONDCS CONFLICT, ALL DISREGARDED'   X51083300
                                                                   @W1C 51116600
         AGO   .MODOPT6                                                 51150000
.CNFLCT7 ANOP                                                           51200000
&OPTERR  SETA  &OPTERR+1                                                51250000
   MNOTE 4,'PARAMETERS ACCEPT AND-OR ACQUIRE AND-OR RESTORE'       @H2C 51283300
   MNOTE 4,'        CONFLICT, ALL DISREGARDED'                     @H2C 51316600
         AGO   .MODOPT7                                                 51350000
.CNFLCT8 ANOP                                                           51400000
&OPTERR  SETA  &OPTERR+1                                                51450000
   MNOTE 4,'PARAMETERS Q AND NQ CONFLICT BOTH DISREGARDED'     @P011983 51500000
         AGO   .MODOPT8                                                 51550000
.CNFLCT9 ANOP                                                           51600000
&OPTERR  SETA  &OPTERR+1                                                51650000
   MNOTE 4,'PARAMETERS RELRQ AND NRELRQ CONFLICT BOTH DISREGARDED'      51700000
.*                                                             @P011983 51725000
         AGO   .MODOPT9                                                 51750000
.CNFLCTB ANOP                                                           51800000
&OPTERR  SETA  &OPTERR+1                                                51850000
   MNOTE 4,'PARAMETERS ERASE AND-OR EAU AND-OR NERASE'         @P011983 51900000
   MNOTE 4,'        CONFLICT, ALL DISREGARDED     '            @P011983 51950000
         AGO   .MODOPTB                                                 52000000
.CNFLCTC ANOP                                                           52050000
&OPTERR  SETA  &OPTERR+1                                                52100000
   MNOTE 4,'PARAMETERS BLK AND-OR LBM AND-OR LBT'              @P011983 52150000
   MNOTE 4,'        CONFLICT, ALL DISREGARDED     '            @P011983 52200000
         AGO   .MODOPTC                                                 52250000
.CNFLCTD ANOP                                                           52300000
&OPTERR  SETA  &OPTERR+1                                                52350000
   MNOTE 4,'PARAMETERS LOCK AND-OR COND AND-OR UNCOND'         @R491100 52400000
   MNOTE 4,' AND-OR UNBIND  CONFLICT, ALL DISREGARDED'  @R491100        52450000
         AGO   .MODOPTD                                                 52500000
.CNFLCTE ANOP                                                           52550000
&OPTERR  SETA  &OPTERR+1                                                52600000
   MNOTE 4,'PARAMETERS CONALL AND CONANY CONFLICT, BOTH DISREGARDED '   52650000
.*                                                             @P011983 52675000
         AGO   .MODOPTE                                                 52700000
.CNFLCTF ANOP                                                           52750000
&OPTERR  SETA  &OPTERR+1                                                52800000
  MNOTE 4,'PARAMETERS PEND AND-OR SESSION AND-OR ACTIVE AND-OR UNCONDL' 52850000
.*                                                             @P011983 52875000
  MNOTE 4,'        CONFLICT, ALL DISREGARDED     '                      52900000
.*                                                             @P011983 52925000
         AGO   .MDOPTE1                                        @D5B4747 52950000
.CNFLCF1 ANOP                                                  @D5B4747 53000000
&OPTERR  SETA  &OPTERR+1                                       @D5B4747 53050000
   MNOTE 4,'PARAMETERS NBUFFLST AND BUFFLST CONFLICT, BOTH DISREGARDED' 53100000
.*                                                             @P011983 53150000
         AGO   .MDOPTE2                                        @D5B4747 53200000
.CNFLCF2 ANOP                                                  @D5B4747 53250000
&OPTERR  SETA  &OPTERR+1                                       @D5B4747 53300000
   MNOTE 4,'PARAMETERS CONTCHN AND NCONTCHN CONFLICT, BOTH DISREGARDED' 53350000
.*                                                             @P011983 53400000
         AGO   .MDOPTE3                                        @D5B4747 53450000
.CNFLCF3 ANOP                                                  @D5B4747 53500000
&OPTERR  SETA  &OPTERR+1                                       @D5B4747 53550000
   MNOTE 4,'PARAMETERS NLMPEO AND LMPEO CONFLICT, BOTH DISREGARDED'     53600000
.*                                                             @P011983 53650000
         AGO   .MDOPTE4                                        @D5B4747 53700000
.CNFLCF4 ANOP                                                  @D5B4747 53750000
&OPTERR  SETA  &OPTERR+1                                       @D5B4747 53800000
   MNOTE 4,'PARAMETERS USERRH AND NUSERRH CONFLICT, BOTH DISREGARDED'   53850000
.*                                                                 @G1A 53858300
         AGO   .MDOPTE5                                            @G1A 53866600
.CNFLCF5 ANOP                                                      @G1A 53874900
&OPTERR  SETA  &OPTERR+1                                           @G1A 53883200
   MNOTE 4,'PARAMETERS MTS AND NMTS CONFLICT, BOTH DISREGARDED'    @G1A 53891500
.*                                                             @P011983 53900000
         AGO   .MDOPTE6                                            @01A 53903800
.CNFLCF6 ANOP                                                      @01A 53907600
&OPTERR  SETA  &OPTERR+1                                           @01A 53911400
   MNOTE 4,'PARAMETERS PASS AND-OR RELEASE AND TERMQ CONFLICT'     @01A 53915200
   MNOTE 4,'ALL DISREGARDED'                                       @01A 53919000
.*                                                                      53922800
         AGO   .MDOPTE7                                            @01A 53926600
.CNFLCF7 ANOP                                                      @01A 53930400
&OPTERR  SETA  &OPTERR+1                                           @01A 53934200
   MNOTE 4,'PARAMETERS LOCK AND-OR COND AND-OR UNCOND AND-OR'      @01A 53938000
   MNOTE 4,'UNBIND AND TERMQ CONFLICT ALL DISREGARDED'             @01A 53941800
.*                                                                      53945600
         AGO   .MODOPTF                                        @D5B4747 53950000
.CNFLCTG ANOP                                                           54000000
&OPTERR  SETA  &OPTERR+1                                                54050000
  MNOTE 4,'TWO OR MORE OF THE FOLLOWING CONFLICTING VALUES WERE SPECIFIX54072800
               ED'                                                 @H2C 54095600
  MNOTE 4,'     LOGONMSG, DEVCHAR, TERMS, APPSTAT, COUNTS, RNNAME, '   X54118400
                                                                   @H2C 54141200
  MNOTE 4,'     CIDXLATE, TOPLOGON, BSCID, DISPLAY, SESSPARM, USERVAR,'X54164000
                                                                   @H2C 54186800
  MNOTE 4,'     PERSESS, NQN, STATUS -  ALL DISREGARDED'      @H2C @04C 54209900
.*                                                             @R489318 54233000
        AGO   .MODOPTG                                                  54250000
.* *************** VTL ADDITIONS ****************                       54300000
.CNFLCTI ANOP                                                           54350000
&OPTERR  SETA  &OPTERR+1                                                54400000
   MNOTE 4,'PARAMETERS KEEP AND-OR TRUNC AND-OR NIBTK CONFLICT,'        54450000
.*                                                             @P011983 54483300
   MNOTE 4,'       ALL DISREGARDED      '                      @P011983 54516600
          AGO  .MODOPTI                                                 54550000
.CNFLCTK ANOP                                                           54600000
&OPTERR  SETA  &OPTERR+1                                                54650000
   MNOTE 4,'PARAMETERS NFMHDR AND FMHDR CONFLICT, BOTH DISREGARDED'     54700000
.*                                                             @P011983 54725000
         AGO  .MODOPTK                                                  54750000
.CNFLCTL ANOP                                                  @R504800 54753100
&OPTERR  SETA  &OPTERR+1                                       @R504800 54753600
   MNOTE 4,'PARAMETERS QALL AND-OR QSESSLIM AND-OR QNOTENAB CONFLICT,'  54754100
   MNOTE 4,'       ALL DISREGARDED      '                      @R504800 54754600
         AGO  .MODOPTL                                         @R504800 54755100
.CNFLCTN ANOP                                                  @R491100 54755600
&OPTERR  SETA  &OPTERR+1                                       @R491100 54756200
   MNOTE 4,'PARAMETERS NSONCODE AND SONCODE CONFLICT, BOTH DISREGARDED' 54759300
.*                                                             @R491100 54762400
         AGO  .MODOPTN                                         @R491100 54765500
.CNFLCTO ANOP                                                  @R491100 54768600
&OPTERR  SETA  &OPTERR+1                                       @R491100 54771700
   MNOTE 4,'PARAMETERS NSENSE AND SENSE CONFLICT, BOTH DISREGARDED'     54774800
.*                                                             @R491100 54777900
         AGO  .MODOPTO                                         @R491100 54781000
.CNFLCTP ANOP                                                  @R491101 54784100
&OPTERR  SETA  &OPTERR+1                                       @R491101 54787200
   MNOTE 4,'PARAMETERS RSPQUED AND NRSPQUED CONFLICT, BOTH DISREGARDED' 54790300
.*                                                             @R491101 54793400
         AGO  .MODOPTP                                         @R491101 54796500
.* ************ END VTL ADDITIONS ***************                       54800000
.CKDONE  ANOP                                                           54850000
    AIF  ('&OPTCD' EQ '(SYN)' OR '&OPTCD' EQ '(ASY)').GOSET             54900000
    AIF  ('&OPTCD' EQ 'SYN' OR '&OPTCD' EQ 'ASY').GOSET                 54950000
         AGO  .GOSET1                                                   55000000
.GOSET   ANOP                                                           55050000
&NUM     SETA N'&OPTCD                                                  55100000
         AIF  ('&NUM' EQ '1').CKSEQNO                                   55150000
.GOSET1  ANOP                                                           55200000
    AIF  ('&OPTERR' GT '0').SETERR                                      55250000
    AIF  ('&MSK1CTR' GT '0' AND '&MSK2CTR' GT '0').GOSET2               55300000
    AIF  ('&MSK1CTR' GT '0').GOSET2A                                    55350000
    AIF  ('&MSK2CTR' GT '0').GOSET2B                                    55400000
.GOSET34 ANOP                                                           55450000
    AIF  ('&MSK3CTR' GT '0' AND '&MSK4CTR' GT '0').GOSET3               55500000
    AIF  ('&MSK3CTR' GT '0').GOSET3A                                    55550000
    AIF  ('&MSK4CTR' GT '0').GOSET3B                                    55600000
    AGO  .CKSEQNO                                                       55650000
.GOSET2  ANOP                                                           55700000
         B     *+14                                                @H2C 55750000
.OPTMSK1 ANOP                                                           55800000
*  OPTMSK FOR OR                                                        55825000
         DC    &OPT4X                                              @H2A 55833300
*                                        OPTCD BYTE 4              @H2A 55841600
         DC    B'&CS&NOTIFY&PASS&NERASE&EAU&ERASE&ANY&CONDCS'           55877700
*                                        OPTCD BYTE 5              @W1C 55913800
         DC    B'&BLK&LBM&LBT&COND&UNCOND&LOCK&BUFFLST&CONTCHN'         55950000
*                                        OPTCD BYTE 6          @D5B4747 55987500
         DC    B'&CONALL&CONANY&BIT0&Q&BIT0&RELRQ&BIT0&LMPEO'           56025000
*                                        OPTCD BYTE 7          @R489318 56062500
         DC    B'&ACQUIRE&ACCEPT&BIT0&PEND&SESSION&ACTIVE&UNCONDL&USERRX56100000
               H'                                                       56133300
*                                        OPTCD BYTE 8          @D5B4747 56166600
.OPTMSK2 ANOP                                                           56200000
*  OPTMSK FOR AND                                                       56225000
         DC    X'00'                                               @H2A 56275000
*                                        OPTCD BYTE 4              @H2A 56325000
         DC    B'&CS1&NOTIFY1&PASS1&NERASE1&EAU1&ERASE1&ANY1&CONDCS1'   56375000
*                                        OPTCD BYTE 5              @W1C 56425000
         DC    B'&BLK1&LBM1&LBT1&COND1&UNCOND1&LOCK1&BUFLST1&CNTCHN1'   57600000
*                                        OPTCD BYTE 6          @D5B4747 57650000
         DC    B'&CONALL1&CONANY1&BIT01&NQ1&BIT01&NRELRQ1&BIT01&LMPEO1' 57700000
*                                        OPTCD BYTE 7          @R489318 57750000
         DC    B'&ACQUIR1&ACCEPT1&BIT01&PEND1&SESION1&ACTIVE1&UNCNDL1&UX57800000
               SERRH1'                                                  57833300
*                                        OPTCD BYTE 8          @D5B4747 57866600
         NC    &POPTCD2.(4,1),*-4   TURN OFF UNNECESSARY OPTCD SWITCHES 57900000
         OC    &POPTCD2.(4,1),*-15  TURN ON NEW SET OF OPTCD SWITCHES   57901000
*                                                                  @H2C 57902000
         NC    &PLOPT4.(1,1),*-17   TURN OFF UNNECESSARY OPTCD SWITCHES 57903000
*                                                                  @H2A 57904000
         OC    &PLOPT4.(1,1),*-28   TURN ON NEW SET OF OPTCD SWITCHES   57905000
*                                                                  @H2A 57906000
         AGO   .GOSET34                                                 57907000
.GOSET2A ANOP                                                           57908000
         B     *+10                                                @H2C 57909000
.OPT1MSK ANOP                                                           57910000
*  OPTMSK FOR OR                                                        57911000
         DC    &OPT4X                                              @H2A 57912000
*                                        OPTCD BYTE 4              @H2A 57913000
         DC    B'&CS&NOTIFY&PASS&NERASE&EAU&ERASE&ANY&CONDCS'           57914000
*                                        OPTCD BYTE 5              @W1C 57915000
         DC    B'&BLK&LBM&LBT&COND&UNCOND&LOCK&BUFFLST&CONTCHN'         57916000
*                                        OPTCD BYTE 6          @D5B4747 57917000
         DC    B'&CONALL&CONANY&BIT0&Q&BIT0&RELRQ&BIT0&LMPEO'           57918000
*                                        OPTCD BYTE 7          @R489318 57919000
         DC    B'&ACQUIRE&ACCEPT&BIT0&PEND&SESSION&ACTIVE&UNCONDL&USERRX57920000
               H'                                                       57921000
*                                        OPTCD BYTE 8          @D5B4747 57922000
         DC    X'00'                     FILLER FOR ALIGNMENT      @H2A 57923000
         OC    &PLOPT4.(1,1),*-6   TURN ON NEW SET OF OPTCD SWITCHES    57924000
*                                                                  @H2A 57925000
         OC    &POPTCD2.(4,1),*-11 TURN ON NEW SET OF OPTCD SWITCHES    57926000
*                                                                  @H2C 57927000
         AGO   .GOSET34                                                 57928000
.GOSET2B ANOP                                                           57929000
         B     *+10                                                @H2C 57930000
.OPT2MSK ANOP                                                           57931000
*  OPTMSK FOR AND                                                       57932000
         DC    X'00'                                               @H2A 57933000
*                                        OPTCD BYTE 4              @H2A 57934000
         DC    B'&CS1&NOTIFY1&PASS1&NERASE1&EAU1&ERASE1&ANY1&CONDCS1'   57935000
*                                        OPTCD BYTE 5              @W1C 57936000
         DC    B'&BLK1&LBM1&LBT1&COND1&UNCOND1&LOCK1&BUFLST1&CNTCHN1'   57937000
*                                        OPTCD BYTE 6          @D5B4747 57938000
         DC    B'&CONALL1&CONANY1&BIT01&NQ1&BIT01&NRELRQ1&BIT01&LMPEO1' 57939000
*                                        OPTCD BYTE 7          @R489318 57940000
         DC    B'&ACQUIR1&ACCEPT1&BIT01&PEND1&SESION1&ACTIVE1&UNCNDL1&UX57941000
               SERRH1'                                                  57942000
*                                        OPTCD BYTE 8          @D5B4747 57943000
         DC    X'00'                     FILLER FOR ALIGNMENT      @H2A 57944000
         NC    &PLOPT4.(1,1),*-6    TURN OFF UNNECESSARY OPTCD SWITCHES 57945000
*                                                                  @H2A 57946000
         NC    &POPTCD2.(4,1),*-11  TURN OFF UNNECESSARY OPTCD SWITCHES 57947000
*                                                                  @H2C 57948000
         AGO   .GOSET34                                                 57950000
.GOSET3  ANOP                                                           58000000
         B     *+14                                                @H2C 58050000
.OPTMSK3 ANOP                                                           58100000
*  OPTMSK FOR OR                                                        58125000
         DC    &OPT4X                                              @H2A 58133300
*                                        OPTCD BYTE 4              @H2A 58141600
         DC    B'&LGONMSG&DEVCHAR&TERMS&COUNTS&APPSTAT&STATUS&CIDXLAT&TX58169400
               OPLGON'                                             @03C 58197200
*                                        OPTCD BYTE 9                   58225000
         DC    B'&BSCID&DISPLAY&SPARM&SKEY&USERVAR&UNBIND&SONCD&SENSE'  58250000
*                                        OPTCD BYTE 10        @R489318  58275000
         DC    B'&QUIESCE&START&STOP&HOLD&BIT0&MTS&TERMQ&BIT0'          58300000
*                                        OPTCD BYTE 11        @G1C @01C 58325000
.* *************** VTL ADDITIONS ****************                       58350000
         DC    B'&RSPQUE&KEEP&TRUNC&NIBTK&QSESS&QNOTE&QALL&FMHDR'       58383300
*                                        OPTCD BYTE 12         @R504800 58416600
.* ************ END VTL ADDITIONS ***************                       58450000
.OPTMSK4 ANOP                                                           58500000
*  OPTMSK FOR AND                                                       58525000
         DC    X'00'                                               @H2A 58533300
*                                        OPTCD BYTE 4              @H2A 58541600
         DC    B'&LGONMS1&DEVCHR1&TERMS1&COUNTS1&APSTAT1&STATUS1&CIDXLTX58570500
               1&TOPLGN1'                                          @04C 58599400
*                                        OPTCD BYTE 9                   58628500
         DC    B'&BSCID1&DISPLY1&SPARM1&SKEY1&USRVAR1&UNBIND1&SONCD1&SEX58657000
               NSE1'                                                    58685500
*                                        OPTCD BYTE 10        @R489318  58714000
         DC    B'&QUIESC1&START1&STOP1&HOLD1&BIT01&MTS1&TERMQ1&BIT01'   58742500
*                                        OPTCD BYTE 11        @G1C @01C 58771000
.* *************** VTL ADDITIONS ****************                       58800000
         DC    B'&RSPQUE1&KEEP1&TRUNC1&NIBTK1&QSESS1&QNOTE1&QALL1&FMHDRX58825000
               1'                                                       58850000
*                                        OPTCD BYTE 12         @R504800 58875000
.* ************ END VTL ADDITIONS ***************                       58900000
         NC    &POPTCD3.(4,1),*-4   TURN OFF UNNECESSARY OPTCD SWITCHES 58950000
         OC    &POPTCD3.(4,1),*-15  TURN ON NEW SET OF OPTCD SWITCHES   58964200
*                                                                  @H2C 58978400
         NC    &PLOPT4.(1,1),*-17   TURN OFF UNNECESSARY OPTCD SWITCHES 58992600
*                                                                  @H2A 59006800
         OC    &PLOPT4.(1,1),*-28   TURN ON NEW SET OF OPTCD SWITCHES   59021000
*                                                                  @H2A 59035200
         AGO   .CKSEQNO                                                 59050000
.GOSET3A ANOP                                                           59100000
         B     *+10                                                @H2C 59150000
.OPT3MSK ANOP                                                           59200000
*  OPTMSK FOR OR                                                        59225000
         DC    &OPT4X                                              @H2A 59233300
*                                        OPTCD BYTE 4              @H2A 59241600
         DC    B'&LGONMSG&DEVCHAR&TERMS&COUNTS&APPSTAT&STATUS&CIDXLAT&TX59269400
               OPLGON'                                             @03C 59297200
*                                        OPTCD BYTE 9                   59325000
         DC    B'&BSCID&DISPLAY&SPARM&SKEY&USERVAR&UNBIND&SONCD&SENSE'  59350000
*                                        OPTCD BYTE 10        @R489318  59375000
         DC    B'&QUIESCE&START&STOP&HOLD&BIT0&MTS&TERMQ&BIT0'          59400000
*                                        OPTCD BYTE 11        @G1C @01C 59425000
.* *************** VTL ADDITIONS ****************                       59450000
         DC    B'&BIT0&KEEP&TRUNC&NIBTK&BIT0&BIT0&BIT0&FMHDR'           59483300
*                                        OPTCD BYTE 12                  59516600
.* ************ END VTL ADDITIONS ***************                       59550000
         DC    X'00'                     FILLER FOR ALIGNMENT      @H2A 59566600
         OC    &POPTCD3.(4,1),*-5  TURN ON NEW SET OF OPTCD SWITCHES    59583200
*                                                                  @H2C 59599800
         OC    &PLOPT4.(1,1),*-12  TURN ON NEW SET OF OPTCD SWITCHES    59616400
*                                                                  @H2A 59633000
         AGO   .CKSEQNO                                                 59650000
.GOSET3B ANOP                                                           59700000
         B     *+10                                                @H2C 59750000
.OPT4MSK ANOP                                                           59800000
*  OPTMSK FOR AND                                                       59825000
         DC    X'00'                                               @H2A 59833300
*                                        OPTCD BYTE 4              @H2A 59841600
         DC    B'&LGONMS1&DEVCHR1&TERMS1&COUNTS1&APSTAT1&STATUS1&CIDXLTX59868200
               1&TOPLGN1'                                          @03C 59894800
*                                        OPTCD BYTE 9                   59921400
         DC    B'&BSCID1&DISPLY1&SPARM1&SKEY1&USRVAR1&UNBIND1&SONCD1&SEX59942800
               NSE1'                                                    59964200
*                                        OPTCD BYTE 10        @R489318  59985600
         DC    B'&QUIESC1&START1&STOP1&HOLD1&BIT01&MTS1&TERMQ1&BIT01'   60007000
*                                        OPTCD BYTE 11        @G1C @01C 60028400
.* *************** VTL ADDITIONS ****************                       60050000
         DC    B'&BIT01&KEEP1&TRUNC1&NIBTK1&BIT01&BIT01&BIT01&FMHDR1'   60083300
*                                        OPTCD BYTE 12                  60116600
.* ************ END VTL ADDITIONS ***************                       60150000
         DC    X'00'                     FILLER FOR ALIGNMENT      @H2A 60166600
         NC    &POPTCD3.(4,1),*-5   TURN OFF UNNECESSARY OPTCD SWITCHES 60183200
*                                                                  @H2C 60199800
         NC    &PLOPT4.(1,1),*-12  TURN OFF NECESSARY OPTCD SWITCHES    60216400
*                                                                  @H2A 60233000
         AGO   .CKSEQNO                                                 60250000
.* *************** VTL ADDITIONS ****************                       60300000
.SETERR  ANOP                                                           60350000
   MNOTE 4,'**********************************************************' 60400000
   MNOTE 4,'**           CONFLICTING OPTCD OPTIONS WERE             **' 60450000
   MNOTE 4,'**     SPECIFIED NO RPL OPTCD PARAMETER MANIPULATIVE    **' 60500000
   MNOTE 4,'**           INSTRUCTIONS WILL BE PRODUCED              **' 60550000
   MNOTE 4,'**********************************************************' 60600000
.*                                                             @P011983 60625000
.* ******************************************************************** 60650000
.*                       MDFYRECD SUBROUTINE                            60700000
.* VALIDITY CHECKS AND GENERATES CODE FOR RECORD MODE RPL OPTIONS.      60750000
.* INVOKES THE FOLLOWING SUBROUTINES: MDFYRESP, MDFYCHN, MDFYCTRL,      60800000
.* MDFYRH3, MDFYSSNS, MDFYRTYP, MDFYIBSQ, MDFYOBSQ, AND OPTSCAN.        60850000
.* ******************************************************************** 60900000
.CKSEQNO ANOP                                                           60950000
         AIF   ('&SEQNO' EQ '').CKIBSQV IS THERE A SEQ. NO. PARM?       61000000
         AIF   ('&SEQNO'(1,1) NE '(').CKSEQN1    REGISTER NOTATION?     61050000
         STH   &SEQNO(1),&PLSEQNO.(1)   PUT SEQ. NO. IN THE RPL         61100000
         AGO   .CKIBSQV                                                 61150000
.CKSEQN1 ANOP                                                           61200000
&CHAR1   SETC  '&SEQNO'(1,2)                                            61250000
&LEN     SETA  K'&SEQNO                                                 61300000
&CHAR2   SETC  '&SEQNO'(&LEN,1)                                         61350000
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ2                              61400000
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ2                              61450000
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ2                              61500000
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ2                              61550000
         AIF   ('&CHAR1' EQ 'A(').IHBCKP2                               61600000
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP2                               61650000
         AIF   ('&CHAR1' EQ 'S(').IHBCKP2                               61700000
         AIF   ('&CHAR1' LT '0').IHBERU2                                61750000
         AIF   ('&CHAR1' LE '9').IHBNUM2                                61800000
         AIF   ('&CHAR1' LT '00').IHBERU2                               61850000
.IHBNUM2 ANOP                                                           61900000
         B     *+6                                                      61950000
         DC    AL2(&SEQNO)         SEQUENCE NUMBER SPECIFIED AS NUMERIC 62000000
         AGO   .CKSEQN2                                                 62050000
.IHBERU2 MNOTE 4,'SEQNO=&SEQNO INVALID - IGNORED'              @P011983 62100000
         AGO   .CKIBSQV                                                 62150000
.IHBCKP2 AIF   ('&CHAR2' EQ ')').IHBGOP2                                62200000
         AGO   .IHBERQ2                                                 62250000
.IHBCKQ2 AIF   ('&CHAR2' EQ '''').IHBGOP2                               62300000
.IHBERQ2 MNOTE 4,SEQNO=&SEQNO INVALID - IGNORED'               @P011983 62350000
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      62400000
.*                                                             @P011983 62425000
         AGO   .CKIBSQV                                                 62450000
.IHBGOP2  ANOP                                                          62500000
&CHAR3   SETC  '&SEQNO'(3,&LEN-3)                                       62550000
&CHAR4   SETC  '&CHAR1'(2,1)                                            62600000
&CHAR1   SETC  '&CHAR1'(1,1)                                            62650000
         B     *+6                                                      62700000
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   SEQUENCE NUMBER FIELD      62750000
.CKSEQN2 ANOP                                                           62800000
         LH    15,*-2                   GET SEQUENCE NUMBER             62850000
         STH   15,&PLSEQNO.(1)          PUT SEQUENCE NUMBER IN THE RPL  62900000
.CKIBSQV ANOP                                                           62950000
         AIF   ('&IBSQVAL' EQ '').CKOBSQV  STSN INBOUND SEQ. NO.?       63000000
         AIF   ('&IBSQVAL'(1,1) NE '(').CKIBSV1  REGISTER NOTATION?     63050000
         STH   &IBSQVAL(1),&PLIBSQV.(1) PUT STSN INBOUND SEQ NO IN RPL  63100000
         AGO   .CKOBSQV                                                 63150000
.CKIBSV1 ANOP                                                           63200000
&CHAR1   SETC  '&IBSQVAL'(1,2)                                          63250000
&LEN     SETA  K'&IBSQVAL                                               63300000
&CHAR2   SETC  '&IBSQVAL'(&LEN,1)                                       63350000
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ3                              63400000
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ3                              63450000
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ3                              63500000
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ3                              63550000
         AIF   ('&CHAR1' EQ 'A(').IHBCKP3                               63600000
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP3                               63650000
         AIF   ('&CHAR1' EQ 'S(').IHBCKP3                               63700000
         AIF   ('&CHAR1' LT '0').IHBERU3                                63750000
         AIF   ('&CHAR1' LE '9').IHBNUM3                                63800000
         AIF   ('&CHAR1' LT '00').IHBERU3                               63850000
.IHBNUM3 ANOP                                                           63900000
         B     *+6                                                      63950000
         DC    AL2(&IBSQVAL)       INBOUND SEQ NO SPECIFIED AS NUMERIC  64000000
         AGO   .CKIBSV2                                                 64050000
.IHBERU3 MNOTE 4,'IBSQVAL=&IBSQVAL INVALID - IGNORED'          @P011983 64100000
         AGO   .CKOBSQV                                                 64150000
.IHBCKP3 AIF   ('&CHAR2' EQ ')').IHBGOP3                                64200000
         AGO   .IHBERQ3                                                 64250000
.IHBCKQ3 AIF   ('&CHAR2' EQ '''').IHBGOP3                               64300000
.IHBERQ3 MNOTE 4,IBSQVAL=&IBSQVAL INVALID - IGNORED'           @P011983 64350000
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      64400000
.*                                                             @P011983 64425000
         AGO   .CKOBSQV                                                 64450000
.IHBGOP3  ANOP                                                          64500000
         B     *+6                                                      64550000
&CHAR3   SETC  '&IBSQVAL'(3,&LEN-3)                                     64600000
&CHAR4   SETC  '&CHAR1'(2,1)                                            64650000
&CHAR1   SETC  '&CHAR1'(1,1)                                            64700000
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   INBOUND SEQ NO FIELD       64750000
.CKIBSV2 ANOP                                                           64800000
         LH    15,*-2                   GET STSN INBOUND SEQ NO         64850000
         STH   15,&PLIBSQV.(1)          PUT STSN INBOUND SEQ NO IN RPL  64900000
.CKOBSQV ANOP                                                           64950000
         AIF   ('&OBSQVAL' EQ '').CKRESPO    STSN OUTBOUND SEQ. NO.?    65000000
         AIF   ('&OBSQVAL'(1,1) NE '(').CKOBSV1   REGISTER NOTATION?    65050000
         STH   &OBSQVAL(1),&PLOBSQV.(1) PUT STSN OUTBOUND SEQ NO IN RPL 65100000
         AGO   .CKRESPO                                                 65150000
.CKOBSV1  ANOP                                                          65200000
&CHAR1   SETC  '&OBSQVAL'(1,2)                                          65250000
&LEN     SETA  K'&OBSQVAL                                               65300000
&CHAR2   SETC  '&OBSQVAL'(&LEN,1)                                       65350000
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ4                              65400000
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ4                              65450000
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ4                              65500000
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ4                              65550000
         AIF   ('&CHAR1' EQ 'A(').IHBCKP4                               65600000
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP4                               65650000
         AIF   ('&CHAR1' EQ 'S(').IHBCKP4                               65700000
         AIF   ('&CHAR1' LT '0').IHBERU4                                65750000
         AIF   ('&CHAR1' LE '9').IHBNUM4                                65800000
         AIF   ('&CHAR1' LT '00').IHBERU4                               65850000
.IHBNUM4 ANOP                                                           65900000
         B     *+6                                                      65950000
         DC    AL2(&OBSQVAL)      OUTBOUND SEQ NO SPECIFIED AS NUMERIC  66000000
         AGO   .CKOBSV2                                                 66050000
.IHBERU4 MNOTE 4,'OBSQVAL=&OBSQVAL INVALID - IGNORED'          @P011983 66100000
         AGO   .CKRESPO                                                 66150000
.IHBCKP4 AIF   ('&CHAR2' EQ ')').IHBGOP4                                66200000
         AGO   .IHBERQ4                                                 66250000
.IHBCKQ4 AIF   ('&CHAR2' EQ '''').IHBGOP4                               66300000
.IHBERQ4 MNOTE 4,OBSQVAL=&OBSQVAL INVALID - IGNORED'           @P011983 66350000
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      66400000
.*                                                             @P011983 66425000
         AGO   .CKRESPO                                                 66450000
.IHBGOP4  ANOP                                                          66500000
&CHAR3   SETC  '&OBSQVAL'(3,&LEN-3)                                     66550000
&CHAR4   SETC  '&CHAR1'(2,1)                                            66600000
&CHAR1   SETC  '&CHAR1'(1,1)                                            66650000
         B     *+6                                                      66700000
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   OUTBOUND SEQ NO FIELD      66750000
.CKOBSV2 ANOP                                                           66800000
         LH    15,*-2                   GET STSN OUTBOUND SEQ NO        66850000
         STH   15,&PLOBSQV.(1)         PUT STSN OUTBOUND SEQ NO IN RPL  66900000
.* ******************************************************************** 66950000
.*                      MDFYRESP SUBROUTINE                             67000000
.* INVOKES OPTSCAN TO CHECK FOR INVALID RESPOND OPTIONS.  GENERATES     67050000
.* CODE TO MODIFY THE RESPOND FIELD IN THE RPL AND MNOTES WHEN MUTUALLY 67100000
.*                EXCLUSIVE OPTIONS ARE SPECIFIED                       67150000
.* THIS SECTION REWRITTEN FOR QRESP SUPPORT                    @D434436 67200000
.* ******************************************************************** 67250000
.CKRESPO ANOP                                                           67300000
         AIF ('&RESPOND' EQ '').CKPOST  RESPOND OPTION SPECIFIED?       67350000
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                67400000
&IHBTBL(1)  SETC  'NQRESP'                                              67450000
&IHBTBL(2)  SETC  'QRESP'                                               67500000
&IHBTBL(3)  SETC  'NEX'                                                 67550000
&IHBTBL(4)  SETC  'EX'                                                  67600000
&IHBTBL(5)  SETC  'FME'                                                 67650000
&IHBTBL(6)  SETC  'NFME'                                                67700000
&IHBTBL(7)  SETC  'NRRN'                                                67750000
&IHBTBL(8)  SETC  'RRN'                                                 67800000
&IHBNUM  SETA  8                                                        67850000
         IHBRDWRA SCANOPT=&RESPOND,OPTION=RESPOND     GO TO OPTSCAN     67900000
.CKRESP1 ANOP                           RETURN FROM OPTSCAN             67950000
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKRESP2   NQRESP OR QRESP?  68000000
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKRESP4   NEX OR EX?        68050000
         AIF   (&IHBRPLY(5) OR &IHBRPLY(6)).CKRESP6   FME OR NFME?      68100000
         AIF   (&IHBRPLY(7) OR &IHBRPLY(8)).CKRESP8   NRRN OR RRN?      68150000
         AGO   .CKPOST                 NO VALID OPTIONS SPECIFIED       68200000
.CKRESP2 ANOP                                                           68250000
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).RSPERR1  NQRESP AND QRESP? 68300000
         AIF   (&IHBRPLY(1)).CKRESP3        NQRESP SPECIFIED            68350000
         AIF   (&IHBRPLY(2) EQ 0).CKRESP4   QRESP NOT SPECIFIED         68400000
         OI    &PLVTFL2.(1),X'08'       SET RPLQRI ON (RESPOND=QRESP)   68450000
         AGO   .CKRESP4                                                 68500000
.CKRESP3 ANOP                                                           68550000
         NI    &PLVTFL2.(1),X'F7'       SET RPLQRI OFF (RESPOND=NQRESP) 68600000
.CKRESP4 ANOP                                                           68650000
         AIF   (&IHBRPLY(3) AND &IHBRPLY(4)).RSPERR2  NEX AND EX?       68700000
         AIF   (&IHBRPLY(3)).CKRESP5        NEX SPECIFIED               68750000
         AIF   (&IHBRPLY(4) EQ 0).CKRESP6   NEX NOT SPECIFIED           68800000
         OI    &PLVTFL2.(1),X'04'       SET RPLEX ON (RESPOND=EX)       68850000
         AGO   .CKRESP6                                                 68900000
.CKRESP5 ANOP                                                           68950000
         NI    &PLVTFL2.(1),X'FB'       SET RPLEX OFF (RESPOND=NEX)     69000000
.CKRESP6 ANOP                                                           69050000
         AIF   (&IHBRPLY(5) AND &IHBRPLY(6)).RSPERR3  FME AND NFME?     69100000
         AIF   (&IHBRPLY(5)).CKRESP7    FME SPECIFIED                   69150000
         AIF   (&IHBRPLY(6) EQ 0).CKRESP8   NFME NOT SPECIFIED          69200000
         OI    &PLVTFL2.(1),X'02'       SET RPLNFME ON (RESPOND=NFME)   69250000
         AGO   .CKRESP8                                                 69300000
.CKRESP7 ANOP                                                           69350000
         NI    &PLVTFL2.(1),X'FD'       SET RPLNFME OFF (RESPOND=FME)   69400000
.CKRESP8 ANOP                                                           69450000
         AIF   (&IHBRPLY(7) AND &IHBRPLY(8)).RSPERR4  RRN AND NRRN?     69500000
         AIF   (&IHBRPLY(7)).CKRESP9    NRRN SPECIFIED                  69550000
         AIF   (&IHBRPLY(8) EQ 0).CKPOST    RRN NOT SPECIFIED           69600000
         OI    &PLVTFL2.(1),X'01'       SET RPLRRN ON (RESPOND=RRN)     69650000
         AGO   .CKPOST                                                  69700000
.CKRESP9 ANOP                                                           69750000
         NI    &PLVTFL2.(1),X'FE'       SET RPLRRN OFF (RESPOND=NRRN)   69800000
         AGO   .CKPOST                                                  69850000
.RSPERR1 MNOTE  4,'QRESP AND NQRESP SPECIFIED FOR RESPOND - BOTH IGNORE*69900000
               D'                                              @P011983 69950000
         AGO   .CKRESP4                                                 70000000
.RSPERR2 MNOTE  4,'EX AND NEX SPECIFIED FOR ''RESPOND'' - BOTH IGNORED' 70050000
.*                                                             @P011983 70075000
         AGO   .CKRESP6                                                 70100000
.RSPERR3 MNOTE  4,'FME AND NFME SPECIFIED FOR RESPOND - BOTH IGNORED'   70150000
.*                                                             @P011983 70175000
         AGO   .CKRESP8                                                 70200000
.RSPERR4 MNOTE  4,'RRN AND NRRN SPECIFIED FOR RESPOND - BOTH IGNORED'   70250000
.*                                                             @P011983 70275000
.********************************************************************** 70300000
.*  END OF LOGIC SECTION REWRITTEN FOR RPL QRESP SUPPORT       @D434436 70350000
.********************************************************************** 70400000
.CKPOST  ANOP                                                           70450000
         AIF   ('&POST' EQ '').CKCHAIN  IS THERE A POST PARM?           70500000
         AIF   ('&POST' EQ 'SCHED').PSTSKED                             70550000
         AIF   ('&POST' EQ 'RESP').PSTRESP                              70600000
         MNOTE 4,'POST=&POST INVALID--IGNORED'                 @P011983 70650000
         AGO   .CKCHAIN                                                 70700000
.PSTSKED ANOP                                                           70750000
         OI    &PLVTFL2.(1),X'80'     SET RPLSCHED FLAG ON (POST=SCHED) 70800000
         AGO   .CKCHAIN                                                 70850000
.PSTRESP ANOP                                                           70900000
         NI    &PLVTFL2.(1),X'7F'     SET RPLSCHED FLAG OFF (POST=RESP) 70950000
.* ******************************************************************** 71000000
.*                        MDFYCHN SUBROUTINE                            71050000
.* GENERATES CODE TO MODIFY THE CHAIN FIELD IN THE RPL.  ISSUES MNOTES  71100000
.* FOR BOTH MUTUALLY EXCLUSIVE AND INVALID OPTIONS.                     71150000
.* ******************************************************************** 71200000
.CKCHAIN ANOP                                                           71250000
         AIF   ('&CHAIN' EQ '').CKCTRL  CHAIN OPTION SPECIFIED?         71300000
         AIF   ('&CHAIN' EQ 'FIRST').CKCHN1                             71350000
         AIF   ('&CHAIN' EQ 'MIDDLE').CKCHN2                            71400000
         AIF   ('&CHAIN' EQ 'LAST').CKCHN3                              71450000
         AIF   ('&CHAIN' EQ 'ONLY').CKCHN4                              71500000
         MNOTE 4,'CHAIN=&CHAIN INVALID - IGNORED'              @P011983 71550000
         AGO   .CKCTRL                                                  71600000
.CKCHN1  ANOP                                                           71650000
         OI    &PLCHN.(1),X'80'         SET RPLFIRST ON (CHAIN=FIRST)   71700000
         NI    &PLCHN.(1),X'8F'         SET OTHER BITS IN FIELD OFF     71750000
         AGO   .CKCTRL                                                  71800000
.CKCHN2  ANOP                                                           71850000
         OI    &PLCHN.(1),X'40'         SET RPLMIDLE ON (CHAIN=MIDDLE)  71900000
         NI    &PLCHN.(1),X'4F'         SET OTHER BITS IN FIELD OFF     71950000
         AGO   .CKCTRL                                                  72000000
.CKCHN3  ANOP                                                           72050000
         OI    &PLCHN.(1),X'20'         SET RPLLAST ON (CHAIN=LAST)     72100000
         NI    &PLCHN.(1),X'2F'         SET OTHER BITS IN FIELD OFF     72150000
         AGO   .CKCTRL                                                  72200000
.CKCHN4  ANOP                                                           72250000
         OI    &PLCHN.(1),X'10'         SET RPLONLY ON (CHAIN=ONLY)     72300000
         NI    &PLCHN.(1),X'1F'         SET OTHER BITS IN FIELD OFF     72350000
.* ******************************************************************** 72400000
.*                       MDFYCTRL SUBROUTINE                            72450000
.* GENERATES CODE TO MODIFY THE CONTROL FIELD (RPLCNTRL) IN THE RPL.    72500000
.* ISSUES MNOTE FOR INVALID OPTION.                                     72550000
.* ******************************************************************** 72600000
.CKCTRL ANOP                                                            72650000
         AIF   ('&CONTROL' EQ '').CKCDIR   CONTROL OPTION SPECIFIED?    72700000
         XC    &PLCNTRL.(3,1),&PLCNTRL.(1) SET CONTROL CODES OFF        72750000
         AIF   ('&CONTROL' NE 'DATA').CKCTRL1                           72800000
         OI    &PLCNTDF.(1),X'80'       SET RPLDATA ON (CONTROL=DATA)   72850000
         AGO   .CKCDIR                                                  72900000
.CKCTRL1 ANOP                                                           72950000
         AIF   ('&CONTROL' NE 'CANCEL').CKCTRL2                         73000000
         OI    &PLCNTDF.(1),X'40'      SET RPLCNCEL ON (CONTROL=CANCEL) 73050000
         AGO   .CKCDIR                                                  73100000
.CKCTRL2 ANOP                                                           73150000
         AIF   ('&CONTROL' NE 'QC').CKCTRL3                             73200000
         OI    &PLCNTDF.(1),X'20'       SET RPLQC ON (CONTROL=QC)       73250000
         AGO   .CKCDIR                                                  73300000
.CKCTRL3 ANOP                                                           73350000
         AIF   ('&CONTROL' NE 'QEC').CKCTRL4                            73400000
         OI    &PLCNTDF.(1),X'10'      SET RPLQEC ON (CONTROL=QEC)      73450000
         AGO   .CKCDIR                                                  73500000
.CKCTRL4 ANOP                                                           73550000
         AIF   ('&CONTROL' NE 'CHASE').CKCTRL5                          73600000
         OI    &PLCNTDF.(1),X'08'      SET RPLCHASE ON (CONTROL=CHASE)  73650000
         AGO   .CKCDIR                                                  73700000
.CKCTRL5 ANOP                                                           73750000
         AIF   ('&CONTROL' NE 'RELQ').CKCTRL6                           73800000
         OI    &PLCNTDF.(1),X'04'      SET RPLRELQ ON (CONTROL=RELQ)    73850000
         AGO   .CKCDIR                                                  73900000
.CKCTRL6 ANOP                                                           73950000
         AIF   ('&CONTROL' NE 'BID').CKCTRL9                            74000000
         OI    &PLCNTDC.(1),X'80'      SET RPLBID ON (CONTROL=BID)      74050000
         AGO   .CKCDIR                                                  74100000
.CKCTRL9 ANOP                                                           74150000
         AIF   ('&CONTROL' NE 'RTR').CKCTRLA                            74200000
         OI    &PLCNTDC.(1),X'40'      SET RPLRTR ON (CONTROL=RTR)      74250000
         AGO   .CKCDIR                                                  74300000
.CKCTRLA ANOP                                                           74350000
         AIF   ('&CONTROL' NE 'LUS').CKCTRLB                            74400000
         OI    &PLCNTDC.(1),X'20'      SET RPLLUS ON (CONTROL=LUS)      74450000
         AGO   .CKCDIR                                                  74500000
.CKCTRLB ANOP                                                           74550000
         AIF   ('&CONTROL' NE 'SIGNAL').CKCTRLC                         74600000
         OI    &PLCNTDC.(1),X'10'      SET RPLSIGNL ON (CONTROL=SIGNAL) 74650000
         AGO   .CKCDIR                                                  74700000
.CKCTRLC ANOP                                                           74750000
         AIF   ('&CONTROL' NE 'BIND').CKCTRLD                           74800000
         OI    &PLCNTDC.(1),X'08'      SET RPLTBIND ON (CONTROL=BIND)   74850000
         AGO   .CKCDIR                                                  74900000
.CKCTRLD ANOP                                                           74950000
         AIF   ('&CONTROL' NE 'SBI').CKCTRLE                            75000000
         OI    &PLCNTDC.(1),X'02'      SET RPLSBI ON (CONTROL=SBI)      75050000
         AGO   .CKCDIR                                                  75100000
.CKCTRLE ANOP                                                           75150000
         AIF   ('&CONTROL' NE 'BIS').CKCTRLF                            75200000
         OI    &PLCNTDC.(1),X'01'      SET RPLBIS ON (CONTROL=BIS)      75250000
         AGO   .CKCDIR                                                  75300000
.CKCTRLF ANOP                                                           75350000
         AIF   ('&CONTROL' NE 'SDT').CKCTRLH                            75400000
         OI    &PLCNTSC.(1),X'80'      SET RPLSDT ON (CONTROL=SDT)      75450000
.*                                                           @PI10125   75500000
         AGO   .CKCDIR                                                  75550000
.CKCTRLH ANOP                                                           75600000
         AIF   ('&CONTROL' NE 'CLEAR').CKCTRLI                          75650000
         OI    &PLCNTSC.(1),X'40'      SET RPLCLEAR ON (CONTROL=CLEAR)  75700000
         AGO   .CKCDIR                                                  75750000
.CKCTRLI ANOP                                                           75800000
         AIF   ('&CONTROL' NE 'STSN').CKCTRLJ                           75850000
         OI    &PLCNTSC.(1),X'20'      SET RPLSTSN ON (CONTROL=STSN)    75900000
         AGO   .CKCDIR                                                  75950000
.CKCTRLJ ANOP                                                           76000000
         AIF   ('&CONTROL' NE 'SHUTD').CKCTRLK                          76050000
         OI    &PLCNTSC.(1),X'10'      SET RPLSHUTD ON (CONTROL=SHUTD)  76100000
         AGO   .CKCDIR                                                  76150000
.CKCTRLK ANOP                                                           76200000
         AIF   ('&CONTROL' NE 'SHUTC').CKCTRLL                          76250000
         OI    &PLCNTSC.(1),X'08'      SET RPLSHUTC ON (CONTROL=SHUTC)  76300000
         AGO   .CKCDIR                                                  76350000
.CKCTRLL ANOP                                                           76400000
         AIF   ('&CONTROL' NE 'RQR').CKCTRLM                            76450000
         OI    &PLCNTSC.(1),X'04'      SET RPLRQR ON (CONTROL=RQR)      76500000
         AGO   .CKCDIR                                                  76550000
.CKCTRLM ANOP                                                           76600000
         AIF   ('&CONTROL' NE 'RSHUTD').CKCTRLN                         76650000
         OI    &PLCNTSC.(1),X'02'      SET RPLRSHUT ON (CONTROL=RSHUTD) 76700000
         AGO   .CKCDIR                                                  76750000
.CKCTRLN ANOP                                                           76800000
         MNOTE 4,'CONTROL=&CONTROL INVALID - DATA ASSUMED'     @P011983 76850000
         OI    &PLCNTDF.(1),X'80'       SET RPLDATA ON (DEFAULT)        76900000
.* ******************************************************************** 76950000
.*                     MDFYRH3 SUBROUTINE                               77000000
.*  INVOKES OPTSCAN SUBROUTINE TO CHECK FOR INVALID CHNGDIR & BRACKET   77050000
.*  OPTIONS.  GENERATES CODE TO MODIFY THE CHNGDIR FIELD AND BRACKET    77100000
.*             FIELD (RPLRH3) IN THE RPL.                               77150000
.* ******************************************************************** 77200000
.CKCDIR  ANOP                                                           77250000
         AIF ('&CHNGDIR' EQ '').CKBRCKT  RESPOND OPTION SPECIFIED?      77300000
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                77350000
&IHBTBL(1)  SETC  'NCMD'                                                77400000
&IHBTBL(2)  SETC  'CMD'                                                 77450000
&IHBTBL(3)  SETC  'NREQ'                                                77500000
&IHBTBL(4)  SETC  'REQ'                                                 77550000
&IHBNUM  SETA  4                                                        77600000
         IHBRDWRA  SCANOPT=&CHNGDIR,OPTION=CHNGDIR   GO TO OPTSCAN      77650000
.CKCDIR1 ANOP                           RETURN FROM OPTSCAN             77700000
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKCDIR2     NCMD OR CMD?    77750000
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKCDIR4     NREQ OR REQ?    77800000
         MNOTE  4,'CHANGDIR=&CHNGDIR - INVALID IGNORED'        @P011983 77850000
         AGO   .CKBRCKT                 NO VALID OPTIONS SPECIFIED      77900000
.CKCDIR2 ANOP                                                           77950000
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).CDIRER1   NCMD AND CMD?    78000000
         AIF   (&IHBRPLY(1)).CKCDIR3    NCMD SPECIFIED                  78050000
         OI    &PLRH3.(1),X'20'          SET RPLCMD ON (CHNGDIR=CMD)    78100000
         AGO   .CKCDIR4                                                 78150000
.CKCDIR3 ANOP                                                           78200000
         NI    &PLRH3.(1),X'DF'          SET RPLCMD OFF (CHNGDIR=NCMD)  78250000
.CKCDIR4 ANOP                                                           78300000
         AIF   (NOT(&IHBRPLY(4))).CKBRCKT   REQ NOT SPECIFIED      @02C 78350000
         MNOTE 8,'CHNGDIR = REQ/NREQ NO LONGER SUPPORTED, IGNORED' @H2C 78400000
         AGO   .CKBRCKT                                                 78700000
.CDIRER1 MNOTE  4,'CMD AND NCMD SPECIFIED FOR CHNGDIR - BOTH IGNORED'   78750000
.*                                                             @P011983 78875000
.CKBRCKT ANOP                                                           78900000
         AIF   ('&BRACKET' EQ '').CKCDSEL  RESPOND OPTION SPECIFIED?    78950000
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                79000000
&IHBTBL(1) SETC  'NBB'                                                  79050000
&IHBTBL(2) SETC  'BB'                                                   79100000
&IHBTBL(3) SETC  'NEB'                                                  79150000
&IHBTBL(4) SETC  'EB'                                                   79200000
&IHBTBL(5) SETC  'NCEB'                                       @P5P8891  79250000
&IHBTBL(6) SETC  'CEB'                                        @P5P8891  79300000
&IHBNUM  SETA  6                                              @P5P8891  79350000
         IHBRDWRA  SCANOPT=&BRACKET,OPTION=BRACKET   GO TO OPTSCAN      79400000
.CKBRCK1 ANOP                           RETURN FROM OPTSCAN             79450000
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKBRCK2     NBB OR BB?      79500000
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKBRCK4     NEB OR EB?      79550000
         AIF   (&IHBRPLY(5) OR &IHBRPLY(6)).CKBRCK6     NCEB OR CEB?    79600000
.*                                                            @P5P8891  79650000
         MNOTE  4,'BRACKET=&BRACKET - INVALID IGNORED'         @P011983 79700000
         AGO   .CKCDSEL                 NO VALID OPTIONS SPECIFIED      79750000
.CKBRCK2 ANOP                                                           79800000
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).CBRKER1   NBB AND BB?      79850000
         AIF   (&IHBRPLY(1)).CKBRCK3     NBB SPECIFIED                  79900000
         OI    &PLRH3.(1),X'80'          SET RPLBB ON (BRACKET=BB)      79950000
         AGO   .CKBRCK4                                                 80000000
.CKBRCK3 ANOP                                                           80050000
         NI    &PLRH3.(1),X'7F'          SET RPLBB OFF (BRACKET=NBB)    80100000
.CKBRCK4 ANOP                                                           80150000
         AIF   (&IHBRPLY(3) AND &IHBRPLY(4)).CBRKER2   NEB AND EB?      80200000
         AIF   (&IHBRPLY(3)).CKBRCK5       NEB SPECIFIED                80250000
         AIF   (&IHBRPLY(4) EQ 0).CKBRCK6   EB NOT SPECIFIED  @P5P8891  80300000
         OI    &PLRH3.(1),X'40'         SET RPLEB ON (BRACKET=EB)       80350000
         AGO   .CKBRCK6                                       @P5P8891  80400000
.CKBRCK5 ANOP                                                           80450000
         NI    &PLRH3.(1),X'BF'         SET RPLEB OFF (BRACKET=NEB)     80500000
.CKBRCK6 ANOP                                                 @P5P8891  80550000
         AIF   (&IHBRPLY(5) AND &IHBRPLY(6)).CBRKER3  CNEB AND CEB?     80600000
.*                                                            @P5P8891  80650000
         AIF   (&IHBRPLY(5)).CKBRCK7       NEB SPECIFIED      @P5P8891  80700000
         AIF   (&IHBRPLY(6) EQ 0).CKCDSEL   EB NOT SPECIFIED  @P5P8891  80750000
         OI    &PLRH3.(1),X'01'   SET RPLCEB ON (BRACKET=CEB) @P5P8891  80800000
         AGO   .CKCDSEL                                       @D5P8891  80850000
.CKBRCK7 ANOP                                                 @D5P8891  80900000
         NI    &PLRH3.(1),X'FE'  SET RPLCEB OFF (BRACKET=NCEB)@D5P8891  80950000
         AGO   .CKCDSEL                                       @P5P8891  81000000
.CBRKER1 MNOTE  4,'BB AND NBB SPECIFIED FOR BRACKET - BOTH IGNORED'     81050000
.*                                                             @P011983 81075000
         AGO   .CKBRCK4                                                 81100000
.CBRKER2 MNOTE  4,'EB AND NEB SPECIFIED FOR BRACKET - BOTH IGNORED'     81150000
.*                                                             @P011983 81183300
         AGO   .CKBRCK6                                       @P5P8891  81216600
.CBRKER3 MNOTE  4,'CEB AND NCEB SPECIFIED FOR BRACKET - BOTH IGNORED'   81250000
.*                                                             @P011983 81300000
.CKCDSEL ANOP                                                           81350000
         AIF ('&CODESEL' EQ '').CKSSNS  CODESEL OPTION SPECIFIED?       81400000
         AIF ('&CODESEL' EQ 'ALT').CKCDSL1  CODESEL OPTION (ALT)?       81450000
     AIF ('&CODESEL' EQ 'STANDARD').CKCDSL2  CODESEL OPTION (STANDARD)? 81500000
         MNOTE 4,'CODESEL=&CODESEL INVALID - IGNORED'          @P011983 81550000
         AGO   .CKSSNS                                                  81600000
.CKCDSL1 ANOP                                                           81650000
         OI    &PLRH3.(1),X'08'         SET RPLCSI ON (CODESEL=ALT)     81700000
         AGO   .CKSSNS                                                  81750000
.CKCDSL2 ANOP                                                           81800000
         NI    &PLRH3.(1),X'F7'        SET RPLCSI ON (CODESEL=STANDARD) 81850000
.* ******************************************************************** 81900000
.*                     MDFYSSNS SUBROUTINE                              81950000
.*      GENERATES CODE TO MODIFY THE SSENSEO FIELD (RPLSSNSO)           82000000
.*      FIELD IN THE RPL.  ISSUES MNOTE FOR INVALID OPTIONS.            82050000
.* ******************************************************************** 82100000
.CKSSNS  ANOP                                                           82150000
         AIF ('&SSENSEO' EQ '').CKRTYP  SENSE OUTPUT OPTION SPECIFIED?  82200000
         AIF ('&SSENSEO' EQ 'CPM').CKSSNS1                              82250000
         AIF ('&SSENSEO' EQ 'STATE').CKSSNS2                            82300000
         AIF ('&SSENSEO' EQ 'FI').CKSSNS3                               82350000
         AIF ('&SSENSEO' EQ 'RR').CKSSNS4                               82400000
         AIF ('&SSENSEO' EQ '0').CKSSNS5                       @G70AKMC 82450000
         MNOTE 4,'SSENSEO=&SSENSEO INVALID - IGNORED'          @P011983 82500000
         AGO   .CKRTYP                                                  82550000
.CKSSNS1 ANOP                                                           82600000
         MVI   &PLSSEO.(1),X'40'        SET RPLCPMO ON (SSENSEO=CPM)    82650000
         AGO   .CKRTYP                                                  82700000
.CKSSNS2 ANOP                                                           82750000
         MVI   &PLSSEO.(1),X'20'        SET RPLSTATO ON (SSENSEO=STATE) 82800000
         AGO   .CKRTYP                                                  82850000
.CKSSNS3 ANOP                                                           82900000
         MVI   &PLSSEO.(1),X'10'        SET RPLFIO ON (SSENSEO=FI)      82950000
         AGO   .CKRTYP                                                  83000000
.CKSSNS4 ANOP                                                           83050000
         MVI   &PLSSEO.(1),X'08'        SET RPLRRO ON (SSENSEO=RR)      83100000
         AGO   .CKRTYP                                         @G70AKMC 83150000
.CKSSNS5 ANOP                                                  @G70AKMC 83200000
         MVI   &PLSSEO.(1),X'00'     SET RPLRRO ON (SSENSEO=0) @G70AKMC 83250000
.* ******************************************************************** 83300000
.*                 MDFYRTYP SUBROUTINE                                  83350000
.* INVOKES OPTSCAN SUBROUTINE TO CHECK FOR INVALID RTYPE OPTIONS.       83400000
.* GENERATES CODE TO MODIFY THE RTYPE FIELD (RPLRTYPE) FIELD IN THE     83450000
.* RPL.  ISSUES MNOTES FOR MUTUALLY EXCLUSIVE OPTIONS.                  83500000
.* ******************************************************************** 83550000
.CKRTYP  ANOP                                                           83600000
         AIF ('&RTYPE' EQ '').CKIBSQ       RTYPE OPTION SPECIFIED?      83650000
.* SET PARAMETERS FOR OPTSCAN SUBROUTINE                                83700000
&IHBTBL(1)  SETC  'NRESP'                                               83750000
&IHBTBL(2)  SETC  'RESP'                                                83800000
&IHBTBL(3)  SETC  'NDFSYN'                                              83850000
&IHBTBL(4)  SETC  'DFSYN'                                               83900000
&IHBTBL(5)  SETC  'NDFASY'                                              83950000
&IHBTBL(6)  SETC  'DFASY'                                               84000000
&IHBNUM  SETA  6                                                        84050000
         IHBRDWRA  OPTION=RTYPE,SCANOPT=&RTYPE   GO TO OPTSCAN          84100000
.CKRTYP1 ANOP                           RETURN FROM OPTSCAN             84150000
         AIF   (&IHBRPLY(1) OR &IHBRPLY(2)).CKRTYP2    NRESP OR RESP?   84200000
         AIF   (&IHBRPLY(3) OR &IHBRPLY(4)).CKRTYP4    NDFSYN OR DFSYN? 84250000
         AIF   (&IHBRPLY(5) OR &IHBRPLY(6)).CKRTYP6    DFASY OR NDFASY? 84300000
         AGO   .CKIBSQ                 NO VALID OPTIONS SPECIFIED       84350000
.CKRTYP2 ANOP                                                           84400000
         AIF   (&IHBRPLY(1) AND &IHBRPLY(2)).RTYERR1    NRESP AND RESP? 84450000
         AIF   (&IHBRPLY(1)).CKRTYP3    NRESP SPECIFIED                 84500000
         OI    &PLSRTYP.(1),X'08'        SET RPLRRESP ON (RTYPE=RESP)   84550000
         AGO   .CKRTYP4                                                 84600000
.CKRTYP3 ANOP                                                           84650000
         NI    &PLSRTYP.(1),X'F7'       SET RPLRRESP OFF (RTYPE=NRESP)  84700000
.CKRTYP4 ANOP                                                           84750000
         AIF   (&IHBRPLY(3) AND &IHBRPLY(4)).RTYERR2  NDFSYN AND DFSYN? 84800000
         AIF   (&IHBRPLY(3)).CKRTYP5    NDFSYN SPECIFIED                84850000
         AIF   (&IHBRPLY(4) EQ 0).CKRTYP6   DFSYN NOT SPECIFIED         84900000
         NI    &PLSRTYP.(1),X'FB'      SET RPLNFSYN OFF (RTYPE=DFSYN)   84950000
         AGO   .CKRTYP6                                                 85000000
.CKRTYP5 ANOP                                                           85050000
         OI    &PLSRTYP.(1),X'04'      SET RPLNFSYN ON (RTYPE=NDFSYN)   85100000
.CKRTYP6 ANOP                                                           85150000
         AIF   (&IHBRPLY(5) AND &IHBRPLY(6)).RTYERR3  NDFASY AND DFASY? 85200000
         AIF   (&IHBRPLY(5)).CKRTYP7    NDFASY SPECIFIED                85250000
         AIF   (&IHBRPLY(6) EQ 0).CKIBSQ   DFASY NOT SPECIFIED          85300000
         OI    &PLSRTYP.(1),X'02'      SET RPLDFASY ON (RTYPE=DFASY)    85350000
         AGO   .CKIBSQ                                                  85400000
.CKRTYP7 ANOP                                                           85450000
         NI    &PLSRTYP.(1),X'FD'      SET RPLDFASY OFF (RTYPE=NDFASY)  85500000
         AGO   .CKIBSQ                                                  85550000
.RTYERR1 MNOTE  4,'NRESP AND RESP SPECIFIED FOR RTYPE - BOTH IGNORED'   85600000
.*                                                             @P011983 85625000
         AGO   .CKRTYP4                                                 85650000
.RTYERR2 MNOTE  4,'NDFSYN AND DFSYN SPECIFIED FOR RTYPE - BOTH IGNORED' 85700000
.*                                                             @P011983 85725000
         AGO   .CKRTYP6                                                 85750000
.RTYERR3 MNOTE  4,'DFASY AND NDFASY SPECIFIED FOR RTYPE - BOTH IGNORED' 85800000
.*                                                             @P011983 85825000
.* *******************************************************************  85850000
.*                   MDFYIBSQ SUBROUTINE                                85900000
.* GENERATES CODE TO MODIFY THE IBSQAC FIELD (RPLIBSQ) IN THE RPL.      85950000
.* ISSUES MNOTES FOR INVALID OPTIONS OR IF MORE THAN ONE OPTION IS      86000000
.*                        SPECIFIED.                                    86050000
.* *******************************************************************  86100000
.CKIBSQ  ANOP                                                           86150000
         AIF   ('&IBSQAC' EQ '').CKOBSQ   IBSQAC OPTION SPECIFIED?      86200000
         AIF   ('&IBSQAC' EQ 'SET').CKIBSQ2                             86250000
         AIF   ('&IBSQAC' EQ 'TESTSET').CKIBSQ3                         86300000
         AIF   ('&IBSQAC' EQ 'RESET').CKIBSQ4                           86350000
         AIF   ('&IBSQAC' EQ 'IGNORE').CKIBSQ5                          86400000
         AIF   ('&IBSQAC' EQ 'TESTPOS').CKIBSQ6                         86450000
         AIF   ('&IBSQAC' EQ 'TESTNEG').CKIBSQ7                         86500000
         AIF   ('&IBSQAC' EQ 'INVALID').CKIBSQ8                         86550000
         MNOTE 4,'IBSQAC=&IBSQAC INVALID - IGNORED'            @P011983 86600000
         AGO   .CKOBSQ                                                  86650000
.CKIBSQ2 ANOP                                                           86700000
         MVI   &PLIBSQ.(1),X'80'        SET RPLISET ON (IBSQAC=SET)     86750000
         AGO   .CKOBSQ                                                  86800000
.CKIBSQ3 ANOP                                                           86850000
         MVI   &PLIBSQ.(1),X'40'        SET RPLITST ON (IBSQAC=TESTSET) 86900000
         AGO   .CKOBSQ                                                  86950000
.CKIBSQ4 ANOP                                                           87000000
         MVI   &PLIBSQ.(1),X'20'        SET RPLIRSET ON (IBSQAC=RESET)  87050000
         AGO   .CKOBSQ                                                  87100000
.CKIBSQ5 ANOP                                                           87150000
         MVI   &PLIBSQ.(1),X'10'        SET RPLIIGN ON (IBSQAC=IGNORE)  87200000
         AGO   .CKOBSQ                                                  87250000
.CKIBSQ6 ANOP                                                           87300000
         MVI   &PLIBSQ.(1),X'08'        SET RPLIPOS ON (IBSQAC=TESTPOS) 87350000
         AGO   .CKOBSQ                                                  87400000
.CKIBSQ7 ANOP                                                           87450000
         MVI   &PLIBSQ.(1),X'04'        SET RPLINEG ON (IBSQAC=TESTNEG) 87500000
         AGO   .CKOBSQ                                                  87550000
.CKIBSQ8 ANOP                                                           87600000
         MVI   &PLIBSQ.(1),X'02'        SET RPLIINV ON (IBSQAC=INVALID) 87650000
.* *******************************************************************  87700000
.*                   MDFYOBSQ SUBROUTINE                                87750000
.* GENERATES CODE TO MODIFY THE 0BSQAC FIELD (RPLOBSG) IN THE RPL.      87800000
.* ISSUES MNOTES FOR INVALID OPTIONS OR IF MORE THAN ONE OPTION IS      87850000
.*                        SPECIFIED.                                    87900000
.* *******************************************************************  87950000
.CKOBSQ  ANOP                                                           88000000
         AIF   ('&OBSQAC' EQ '').CKUSENS  OBSQAC OPTION SPECIFIED?      88050000
         AIF   ('&OBSQAC' EQ 'SET').CKOBSQ2                             88100000
         AIF   ('&OBSQAC' EQ 'TESTSET').CKOBSQ3                         88150000
         AIF   ('&OBSQAC' EQ 'RESET').CKOBSQ4                           88200000
         AIF   ('&OBSQAC' EQ 'IGNORE').CKOBSQ5                          88250000
         AIF   ('&OBSQAC' EQ 'TESTPOS').CKOBSQ6                         88300000
         AIF   ('&OBSQAC' EQ 'TESTNEG').CKOBSQ7                         88350000
         AIF   ('&OBSQAC' EQ 'INVALID').CKOBSQ8                         88400000
         MNOTE 4,'OBSQAC=&OBSQAC INVALID - IGNORED'            @P011983 88450000
         AGO   .CKUSENS                                                 88500000
.CKOBSQ2 ANOP                                                           88550000
         MVI   &PLOBSQ.(1),X'80'        SET RPLOSET ON (OBSQAC=SET)     88600000
         AGO   .CKUSENS                                                 88650000
.CKOBSQ3 ANOP                                                           88700000
         MVI   &PLOBSQ.(1),X'40'        SET RPLOTST ON (OBSQAC=TESTSET) 88750000
         AGO   .CKUSENS                                                 88800000
.CKOBSQ4 ANOP                                                           88850000
         MVI   &PLOBSQ.(1),X'20'        SET RPLORSET ON (OBSQAC=RESET)  88900000
         AGO   .CKUSENS                                                 88950000
.CKOBSQ5 ANOP                                                           89000000
         MVI   &PLOBSQ.(1),X'10'        SET RPLOIGN ON (OBSQAC=IGNORE)  89050000
         AGO   .CKUSENS                                                 89100000
.CKOBSQ6 ANOP                                                           89150000
         MVI   &PLOBSQ.(1),X'08'        SET RPLOPOS ON (OBSQAC=TESTPOS) 89200000
         AGO   .CKUSENS                                                 89250000
.CKOBSQ7 ANOP                                                           89300000
         MVI   &PLOBSQ.(1),X'04'        SET RPLONEG ON (OBSQAC=TESTNEG) 89350000
         AGO   .CKUSENS                                                 89400000
.CKOBSQ8 ANOP                                                           89450000
         MVI   &PLOBSQ.(1),X'02'        SET RPLOINV ON (OBSQAC=INVALID) 89500000
.* ******************************************************************** 89550000
.*               CONTINUATION OF MDFYRECD SUBROUTINE                    89600000
.*              (TO CHECK USENSEO AND STYPE OPERANDS)                   89650000
.* ******************************************************************** 89700000
.CKUSENS ANOP                                                           89750000
         AIF   ('&USENSEO' EQ '').CKSIGDA IS THERE A USER SENSE PARM?   89800000
         AIF   ('&USENSEO'(1,1) NE '(').CKUSEN1    REGISTER NOTATION?   89850000
         STH   &USENSEO(1),&PLUSNSO.(1)   PUT USER SENSE IN THE RPL     89900000
         AGO   .CKSIGDA                                                 89950000
.CKUSEN1 ANOP                                                           90000000
&CHAR1   SETC  '&USENSEO'(1,2)                                          90050000
&LEN     SETA  K'&USENSEO                                               90100000
&CHAR2   SETC  '&USENSEO'(&LEN,1)                                       90150000
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ5                              90200000
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ5                              90250000
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ5                              90300000
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ5                              90350000
         AIF   ('&CHAR1' EQ 'A(').IHBCKP5                               90400000
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP5                               90450000
         AIF   ('&CHAR1' EQ 'S(').IHBCKP5                               90500000
         AIF   ('&CHAR1' LT '0').IHBERU5                                90550000
         AIF   ('&CHAR1' LE '9').IHBNUM5                                90600000
         AIF   ('&CHAR1' LT '00').IHBERU5                               90650000
.IHBNUM5 ANOP                                                           90700000
         B     *+6                                                      90750000
         DC    AL2(&USENSEO)      USER SENSE BYTE SPECIFIED AS NUMERIC  90800000
         AGO   .CKUSEN2                                                 90850000
.IHBERU5 MNOTE 4,'USENSEO=&USENSEO INVALID - IGNORED'          @P011983 90900000
         AGO   .CKSIGDA                                                 90950000
.IHBCKP5 AIF   ('&CHAR2' EQ ')').IHBGOP5                                91000000
         AGO   .IHBERQ5                                                 91050000
.IHBCKQ5 AIF   ('&CHAR2' EQ '''').IHBGOP5                               91100000
.IHBERQ5 MNOTE 4,USENSEO=&USENSEO INVALID - IGNORED'           @P011983 91150000
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      91200000
.*                                                             @P011983 91225000
         AGO   .CKSIGDA                                                 91250000
.IHBGOP5  ANOP                                                          91300000
&CHAR3   SETC  '&USENSEO'(3,&LEN-3)                                     91350000
&CHAR4   SETC  '&CHAR1'(2,1)                                            91400000
&CHAR1   SETC  '&CHAR1'(1,1)                                            91450000
         B     *+6                                                      91500000
         DC    &CHAR1.L2&CHAR4&CHAR3&CHAR2   USER SENSE BYTE FIELD      91550000
.CKUSEN2 ANOP                                                           91600000
         LH    15,*-2                   GET USER SENSE BYTE             91650000
         STH   15,&PLUSNSO.(1)          PUT USER SENSE BYTE IN THE RPL  91700000
.CKSIGDA ANOP                                                           91750000
         AIF   ('&SIGDATA' EQ '').CKSTYPE IS THERE SIGNAL DATA?         91800000
         AIF   ('&SIGDATA'(1,1) NE '(').CKSIGN1    REGISTER NOTATION?   91850000
         ST    &SIGDATA(1),&PLSIGDA.(1)   PUT SIGNAL DATA IN THE RPL    91900000
         AGO   .CKSTYPE                                                 91950000
.CKSIGN1 ANOP                                                           92000000
&CHAR1   SETC  '&SIGDATA'(1,2)                                          92050000
&LEN     SETA  K'&SIGDATA                                               92100000
         CNOP  0,4                                           @ZA46611   92150000
&CHAR2   SETC  '&SIGDATA'(&LEN,1)                                       92200000
         AIF   ('&CHAR1' EQ 'C''').IHBCKQ6                              92250000
         AIF   ('&CHAR1' EQ 'X''').IHBCKQ6                              92300000
         AIF   ('&CHAR1' EQ 'H''').IHBCKQ6                              92350000
         AIF   ('&CHAR1' EQ 'F''').IHBCKQ6                              92400000
         AIF   ('&CHAR1' EQ 'A(').IHBCKP6                               92450000
         AIF   ('&CHAR1' EQ 'Y(').IHBCKP6                               92500000
         AIF   ('&CHAR1' EQ 'S(').IHBCKP6                               92550000
         AIF   ('&CHAR1' LT '0').IHBERU6                                92600000
         AIF   ('&CHAR1' LE '9').IHBNUM6                                92650000
         AIF   ('&CHAR1' LT '00').IHBERU6                               92700000
.IHBNUM6 ANOP                                                           92750000
         CNOP  0,4                                                      92800000
         B     *+8                                                      92850000
         DC    AL4(&SIGDATA)      SIGNAL DATA SPECIFIED AS NUMERIC      92900000
         AGO   .CKSIGN2                                                 92950000
.IHBERU6 MNOTE 4,'SIGDATA=&SIGDATA INVALID - IGNORED'          @P011983 93000000
         AGO   .CKSTYPE                                                 93050000
.IHBCKP6 AIF   ('&CHAR2' EQ ')').IHBGOP6                                93100000
         AGO   .IHBERQ6                                                 93150000
.IHBCKQ6 AIF   ('&CHAR2' EQ '''').IHBGOP6                               93200000
.IHBERQ6 MNOTE 4,'SIGDATA=&SIGDATA INVALID - IGNORED'          @P011983 93250000
         MNOTE 4,'CHECK FOR UNBALANCED PARENTHESES OR APOSTROPHES'      93300000
.*                                                             @P011983 93325000
         AGO   .CKSTYPE                                                 93350000
.IHBGOP6  ANOP                                                          93400000
&CHAR3   SETC  '&SIGDATA'(3,&LEN-3)                                     93450000
&CHAR4   SETC  '&CHAR1'(2,1)                                            93500000
&CHAR1   SETC  '&CHAR1'(1,1)                                            93550000
         B     *+8                                                      93600000
         DC    &CHAR1.L4&CHAR4&CHAR3&CHAR2   SIGNAL DATA FIELD          93700000
.CKSIGN2 ANOP                                                           93750000
         L     15,*-4                   GET SIGNAL DATA                 93800000
         ST    15,&PLSIGDA.(1)          PUT SIGNAL DATA IN THE RPL      93850000
.CKSTYPE ANOP                                                           93900000
         AIF   ('&STYPE' EQ '').CKSENMO IS THERE AN STYPE PARM?         93950000
         AIF   ('&STYPE' EQ 'REQ').CKSTYP1                              94000000
         AIF   ('&STYPE' EQ 'RESP').CKSTYP2                             94050000
         MNOTE 4,'STYPE=&STYPE INVALID - IGNORED'              @P011983 94100000
         AGO   .CKSENMO                                                 94150000
.CKSTYP1 ANOP                                                           94200000
         NI    &PLSRTYP.(1),X'7F'       SET RPLSRESP OFF (STYPE=REQ)    94250000
         AGO   .CKSENMO                                                 94300000
.CKSTYP2 ANOP                                                           94350000
         OI    &PLSRTYP.(1),X'80'       SET RPLSRESP ON (STYPE=RESP)    94400000
.CKSENMO ANOP                                                           94450000
         AIF   ('&SSENSMO' EQ '').CKCRYPT USER SENSE PARM?   @D440518   94500000
         AIF   ('&SSENSMO'(1,1) NE '(').CKSSEM1    REGISTER NOTATION?   94550000
         STC   &SSENSMO,&PLSSMO.(1)   PUT USER SENSE IN THE RPL         94600000
         AGO   .CKCRYPT                                      @D440518   94650000
.CKSSEM1 ANOP                                                           94700000
         MVI   &PLSSMO.(1),&SSENSMO   PUT USER SENSE IN THE RPL         94750000
.CKCRYPT ANOP                                                @D440518   94758300
         AIF   ('&CRYPT' EQ '').CKBRNCH CRYPT PARAMETER?     @D440518   94766600
         NI    &PLEXTDS.(1),X'F7'  SET CRYPT OFF FOR DOS                94774900
.*                                                           @R507001   94783200
         MNOTE  4,'CRYPT=&CRYPT INVALID FOR DOS - IGNORED'   @R507001   94791500
.* *************** END VTL ADDITIONS **********************             94800000
.CKBRNCH ANOP                                                           94850000
         AIF   ('&BRANCH' EQ '').GENLBL1 IS THERE AN BRANCH PARAMETER?  94900000
         NI    &PLEXTDS.(1),X'FD'    SET BRANCH ENTRY BIT OFF FOR DOS   94950000
.*                                                           @R507001   95000000
         MNOTE 4,'BRANCH=&BRANCH INVALID FOR DOS - IGNORED'             95050000
.*                                                           @R507001   95100000
.GENLBL1 ANOP                                                           95400000
IHB&SYSNDX  EQU   *                                                     95450000
.GENREQ  ANOP                                                           95500000
         AIF   ('&IHBRW' NE '').OKIBRW  IS THERE AN IHBRW PARAMETER?    95550000
         MNOTE 4,'IHBRW= WAS NOT SPECIFIED'                             95600000
         SR    0,0                   IHBRW NOT SPECIFIED OR INVALID     95650000
         AGO   .ENDRTN                                                  95700000
.OKIBRW  ANOP                                                           95750000
         LA    0,&IHBRW                        LOAD REQUEST CODE        95800000
.ENDRTN  ANOP                                                           95850000
         L     15,&PLDACB.(1)        GET ADDRESS OF ACB                 95900000
         L     15,&ACBRTN.(15)       GET ADDRESS OF INTERFACE RTN       95950000
         BALR  14,15                 GO TO THE INTERFACE ROUTINE        96000000
         MEXIT                                                          96050000
.NORPL   ANOP                                                           96100000
         MNOTE 12,'RPL= WAS NOT SPECIFIED'                              96150000
         MEXIT                                                          96200000
.* *************** VTL ADDITIONS ****************                       96250000
.* ******************************************************************** 96300000
.*                          OPTSCAN SUBROUTINE                          96350000
.* SCANS ANY SET OF OPTIONS AGAINST A TABLE OF VALID VALUES AND SETS    96400000
.* BITS IN A REPLY FIELD FOR EACH VALID OPTION FOUND.  GENERATES AN     96450000
.* MNOTE FOR EACH OPTION NOT IN THE TABLE OR SPECIFIED MORE THAN ONCE.  96500000
.* THE CALLING SUBROUTINE MUST CHECK TO SEE IF MUTUALLY EXCLUSIVE       96550000
.* OPTIONS HAVE BEEN SPECIFIED SINCE OPTSCAN CANNOT.  THE CALLING       96600000
.* SUBROUTINE MUST PASS THE VALID VALUES FOR THE OPTION TO BE CHECKED   96650000
.* IN THE ORDER IN WHICH THE REPLY BITS ARE TO BE SET (LEFT-TO RIGHT)   96700000
.* IN A TABLE UNDER THE NAME '&IHBTBL' AND HAVE EACH ENTRY IN THE       96750000
.* TABLE IN AN EIGHT-BYTE FIELD PADDED TO THE RIGHT.  THE NUMBER OF     96800000
.* ENTRIES IN THE TABLE MUST BE IN A FIELD CALLED '&IHBNUM'.  THE       96850000
.* SUBROUTINE IS CALLED BY INVOKING IHBRDWRA RECURSIVELY USING THE      96900000
.* OPERANDS 'SCANOPT' TO PASS THE OPTIONS SPECIFIED BY THE USER AND     96950000
.* 'OPTION' TO INDICATE THE NAME OF THE PARAMETER WHOSE OPERANDS ARE    97000000
.* BEING VALIDATED.  THE OPTSCAN SUBROUTINE WILL SET THE BITS IN A      97050000
.* FIELD CALLED '&IHBRPLY' ON IF AN OPTION IS PRESENT, THE BITS BEING   97100000
.* REPRESENTED IN THE SAME LEFT-TO-RIGHT ORDER AS WERE THE ENTRIES      97150000
.*                    IN THE FIELD '&IHBTBL'.                           97200000
.* ******************************************************************** 97250000
.OPTSCAN ANOP                                                           97300000
&NUM2    SETA  &IHBNUM                                                  97350000
&NUM     SETA  &IHBNUM                                                  97400000
&NM      SETA  N'&SCANOPT                                               97450000
.OPTSCN1 ANOP                                                           97500000
&IHBRPLY(&NUM2)  SETB  0                LOOP TO INITIALIZE              97550000
&NUM2    SETA  &NUM2-1                    REPLY FIELD                   97600000
         AIF   (&NUM2 GT 0).OPTSCN1                                     97650000
.OPTSCN2 ANOP                                                           97700000
&LEN     SETA  K'&SCANOPT(&NM)      NUMBER OF CHARS IN VALUE            97750000
         AIF   (&LEN EQ 0).REINDEX  IGNORE IF NULL PARAMETER   @OY06517 97775000
&OPT     SETC  '&SCANOPT(&NM)'                                          97800000
.OPTSCN3 ANOP                                                           97850000
         AIF ('&OPT' NE '&IHBTBL(&NUM)'(1,&LEN)).RESCAN                 97900000
         AIF   (&IHBRPLY(&NUM) EQ 0).SETBIT                             97950000
         MNOTE 4,'&OPTION=&OPT SPECIFIED MORE THAN ONCE - ACCEPTED'     98000000
.*                                                             @P011983 98025000
         AGO   .REINDEX                                                 98050000
.SETBIT  ANOP                                                           98100000
&IHBRPLY(&NUM)  SETB  1       TURN ON BIT IN REPLY FIELD                98150000
         AGO   .REINDEX                                                 98200000
.RESCAN  ANOP                                                           98250000
&NUM  SETA  &NUM-1    SET POINTER TO PREVIOUS ENTRY IN TABLE            98300000
         AIF   (&NUM GT 0).OPTSCN3                                      98350000
         MNOTE 4,'&OPTION=&OPT INVALID - IGNORED'              @P011983 98400000
.REINDEX ANOP                                                           98450000
&NUM     SETA  &IHBNUM                                                  98500000
         AIF   (&NM EQ 1).OPTSCN4     ALL VALUES CHECKED                98550000
&NM      SETA  &NM-1                  DECREMENT VALUE COUNTER           98600000
         AGO   .OPTSCN2                                                 98650000
.OPTSCN4 ANOP                     RETURN TO CALLING SUBROUTINE:         98700000
.* ************ END VTL ADDITIONS ***************                       98750000
         MEND                                                           98800000
