         MACRO                                                          00001000
         RAPSTAB    &TYPE=,&TERMID=,&LAST=NO,&AUTOCL=,&QFILE=IJQFILE,  *00002000
               &DFILE=IJDFILE,&QDISK=,&DDISK=,                         *00003000
               &DEVTYPE=,&BUFF=,&COMPRS=,&AUTONL=,&SCSPRT=,&VT=,       *00004000
               &SPACE0=,&SPACE1=,&SPACE2=,&SPACE3=,&BEGFIX=,           *00005000
               &PREFIX=,&SUFFIX=,&EOJFIX=,&CH1=,&CH2=,&CH3=,&CH4=,     *00006000
               &CH5=,&CH6=,&CH7=,&CH8=,&CH9=,&CH10=,&CH11=,&CH12=,     *00007000
               &ICTIME=,&WFMSG=,&DFLTFCB=,&FLASH=,                     *00008000
               &AUTORJE=,&AUTOSYS=,&AUTOFNO=,&CLOG=,&SLOG=,&PLOG=,     *00009000
               &JSEP=0,&GFCB=,&ENDISP=,&ICCF=,&JA=,                    *00010000
               &ERROR=YES,&PRINT=NO,&OPID=,&LIST=,                     *00011000
               &LPI8=,&LPI6=,&SVF=,&FF=,&BEGFMH=,&EOJFMH=,             *00012000
               &VMUSRID=,&RCF=,&RCFFID=,&PQF=,&PDF1=,&PDF2=,&PDF3=,    *00013000
               &PDF4=,&PDF5=,&RSCSID=,&RCTINTV=0030,&VRADDR=01C,       *00014000
               &RCTMODE=PSEUDO,&OPSYS=DOS                               00015000
         GBLA  &PCT,&VUT,&DCT,&SCN                                      00016000
         GBLC  &IDOPER,&IDTERM,&OPSYST                                  00017000
         LCLA  &I                                                       00018000
         LCLA  &N,&CFPL,&QFPL,&DF1PL,&DF2PL,&DF3PL,&DF4PL,&DF5PL,&HSL   00019000
         LCLC  &L,&ANL,&CMP,&SCS,&LVT                                   00020000
         LCLC  &IBUFF,&ICH1,&ICH2,&ICH3,&ICH4,&ICH5,&ICH6,&ICH7,&ICH8   00021000
         LCLC  &ICH9,&ICH10,&ICH11,&ICH12,&ISFIX,&IPFIX,&IEFIX          00022000
         LCLC  &ISP0,&ISP1,&ISP2,&ISP3,&IANL,&ICMP,&ISCS,&ILVT          00023000
         LCLC  &ILPI8,&ILPI6,&ISVF,&IBFIX,&IFF,&IBFMH1,&IEFMH1          00024000
         LCLC  &IBFMH2,&IEFMH2                                          00025000
         LCLC  &IBFMH3,&IEFMH3                                          00026000
         LCLC  &RCFA2                                                   00027000
         LCLC  &PQFA2                                                   00028000
         LCLC  &PDF1A2                                                  00029000
         LCLC  &PDF2A2                                                  00030000
         LCLC  &PDF3A2                                                  00031000
         LCLC  &PDF4A2                                                  00032000
         LCLC  &PDF5A2                                                  00033000
         LCLC  &RSCSI,&CC,&HH,&CFFLG,&VRA,&INTRVL                       00034000
         LCLC  &HEXCHS,&JS                                              00035000
         AIF   ('&TYPE' EQ 'INITIAL').INIT                              00036000
         AIF   ('&TYPE' EQ 'PRINTER').PRNT                              00037000
         AIF   ('&TYPE' EQ 'FINAL').FINAL                               00038000
         AIF   ('&TYPE' EQ 'IO').IO                                     00039000
         AIF   ('&TYPE' EQ 'DEVTAB').DEVTAB                             00040000
         AIF   ('&TYPE' EQ 'SCREEN').SCREEN                             00041000
         AIF   ('&TYPE' EQ 'SYSTEM').SYSTEM                             00042000
         MNOTE 8,'INVALID TYPE PARAMETER MACRO IGNORED'                 00043000
         SPACE 3                                                        00044000
         MEXIT                                                          00045000
.INIT    ANOP                                                           00046000
&OPSYST  SETC  '&OPSYS'                                                 00047000
&N       SETA  0                                                        00048000
         AIF   ('&ICCF' EQ 'NO').INIT01                                 00049000
         AIF   ('&ICCF' EQ '').INIT01                                   00050000
&N       SETA  &N+64                                                    00051000
.INIT01  ANOP                                                           00052000
         AIF   ('&CLOG' EQ 'NO').INIT02                                 00053000
         AIF   ('&CLOG' EQ '').INIT02                                   00054000
&N       SETA  &N+32                                                    00055000
.INIT02  ANOP                                                           00056000
         AIF   ('&SLOG' EQ 'NO').INIT03                                 00057000
         AIF   ('&SLOG' EQ '').INIT03                                   00058000
&N       SETA  &N+16                                                    00059000
.INIT03  ANOP                                                           00060000
         AIF   ('&PLOG' EQ 'NO').INIT04                                 00061000
         AIF   ('&PLOG' EQ '').INIT04                                   00062000
&N       SETA  &N+08                                                    00063000
.INIT04  ANOP                                                           00064000
         AIF   ('&JA' EQ 'NO').INIT05                                   00065000
         AIF   ('&JA' EQ '').INIT05                                     00066000
&N       SETA  &N+04                                                    00067000
.INIT05  ANOP                                                           00068000
         AIF   ('&ERROR' EQ 'NO').INIT06                                00069000
&N       SETA  &N+02                                                    00070000
.INIT06  ANOP                                                           00071000
         AIF   ('&PRINT' EQ 'NO').INIT07                                00072000
&N       SETA  &N+01                                                    00073000
.INIT07  ANOP                                                           00074000
         AIF   ('&OPSYST' EQ 'CMS').NOPCH                               00075000
         PUNCH ' PHASE CAPRTAB,*'                                       00076000
         PUNCH ' INCLUDE'                                               00077000
.NOPCH   ANOP                                                           00078000
CAPRTAB  CSECT                                                          00079000
*********************************************************************** 00080000
*                   ENTER X'10'(RX)                                   * 00081000
*                   WILL RETURN REGISTER 4 DEVICE CHAR                * 00082000
*********************************************************************** 00083000
*********************************************************************** 00084000
R0       EQU   0                                                        00085000
R1       EQU   1                                                        00086000
R2       EQU   2                                                        00087000
R3       EQU   3                                                        00088000
R4       EQU   4                                                        00089000
R5       EQU   5                                                        00090000
R6       EQU   6                                                        00091000
R7       EQU   7                                                        00092000
R8       EQU   8                                                        00093000
R9       EQU   9                  PROGRAM BASE REGISTER 2               00094000
R10      EQU   10                 COMMUNICATION AREA BASE REGISTER      00095000
R11      EQU   11                 EXEC INTERFACE BLOCK BASE REGISTER    00096000
R12      EQU   12                 PROGRAM BASE REGISTER 1               00097000
R13      EQU   13                 DYNAMIC STORAGE BASE REGISTER         00098000
R14      EQU   14                                                       00099000
R15      EQU   15                                                       00100000
         EJECT                                                          00101000
         DC    CL8'CAPRTAB'                                             00102000
         DC    A(CAPRSTRT)             ADDRESS OF CONTROL ADDRESSES     00103000
         DC    A(0)                                                     00104000
         EJECT                                                          00105000
         USING CAPRTAB,R15             BASE                             00106000
         LR    R15,R1                  LOAD BASE                        00107000
         L     R1,APCT                 ADDRESS OF PRINTER PROFILE       00108000
PRTL0000 DS    0H                                                       00109000
         CLI   0(R1),X'FF'             END                              00110000
         BE    PRTL9000                ...YES                           00111000
         CLC   0(8,R4),0(R1)           OURS                             00112000
         BE    PRTL0200                ...YES                           00113000
         LA    R1,12(R1)               NEXT                             00114000
         B     PRTL0000                                                 00115000
PRTL0200 DS    0H                                                       00116000
         L     R4,8(R1)                DEVICE CHARACTERICTICS           00117000
         BR    R14                     RETURN                           00118000
PRTL9000 DS    0H                                                       00119000
         SLR   R4,R4                   NO MATCH                         00120000
         BR    R14                     RETURN                           00121000
         LTORG                                                          00122000
         DS    0D                                                       00123000
         EJECT                                                          00124000
CAPRSTRT DC    C'4X'                                                    00125000
         DC    XL2'0000'                                                00126000
APCT     DC    A(PCT)                  PRINTER PROFILE                  00127000
         DC    CL8'&QFILE'             QFILE ID                         00128000
         DC    CL8'&DFILE'             DFILE ID                         00129000
         DC    A(SCN)                                                   00130000
         DC    A(VUT)                                                   00131000
         DC    A($QFILE)                                                00132000
         DC    A(QSS)                                                   00133000
         DC    A(QSEEK)                                                 00134000
         DC    A(QRDA)                                                  00135000
         DC    A($DFILE)                                                00136000
         DC    A(DSS)                                                   00137000
         DC    A(DSEEK)                                                 00138000
         DC    A(DRDA)                                                  00139000
         DC    A(XTENTAB)                                               00140000
         SPACE 1                                                        00141000
         DC    AL1(&N)                                                  00142000
         DC    XL3'00'                                                  00143000
         DC    4F'0'                                                    00144000
         AIF   ('&OPSYST' EQ 'CMS').NOJA                                00145000
         AIF   ('&JA' EQ 'NO').NOJA                                     00146000
         AIF   ('&JA' EQ '').NOJA                                       00147000
&JA      CCB   &JA,*                                                    00148000
         AGO   .NOJA1                                                   00149000
.NOJA    ANOP                                                           00150000
         DC    4F'0'                                                    00151000
.NOJA1   ANOP                                                           00152000
         SPACE 3                                                        00153000
         MEXIT                                                          00154000
.FINAL   ANOP                                                           00155000
         DC    X'FF'                                                    00156000
         AIF   (&PCT GT 0).PCTOK                                        00157000
PCT      EQU   0                                                        00158000
.PCTOK   ANOP                                                           00159000
         AIF   (&SCN GT 0).SCNOK                                        00160000
SCN      EQU   0                                                        00161000
.SCNOK   ANOP                                                           00162000
         AIF   (&VUT GT 0).VUTOK                                        00163000
VUT      EQU   0                                                        00164000
.VUTOK   ANOP                                                           00165000
         AIF   (&DCT GT 0).DCTOK                                        00166000
DCT      EQU   0                                                        00167000
.DCTOK   ANOP                                                           00168000
         SPACE 3                                                        00169000
         MEXIT                                                          00170000
.SCREEN  ANOP                                                           00171000
         MEXIT                                                          00172000
&IDTERM  SETC  'ALL'              DEFAULT TO ALL                        00173000
         AIF   ('&TERMID' EQ '').ID01                                   00174000
&IDTERM  SETC  '&TERMID'                                                00175000
.ID01    ANOP                                                           00176000
&IDOPER  SETC  'ALL'              DEFAULT TO ALL                        00177000
         AIF   ('&OPID' EQ '').ID02                                     00178000
&IDOPER  SETC  '&OPID'                                                  00179000
.ID02    ANOP                                                           00180000
         AIF   (&SCN GT 0).SCNSET                                       00181000
SCN      DS    0H                                                       00182000
&SCN     SETA  1                                                        00183000
         AGO   .NOORG2                                                  00184000
.SCNSET  ANOP                                                           00185000
         ORG   *-1                                                      00186000
.NOORG2  ANOP                                                           00187000
         AIF   ('&LIST' EQ '').BADSCRN                                  00188000
         DC    CL71&LIST                                                00189000
         AIF   ('&IDTERM' EQ 'ALL').ID03                                00190000
&I       SETA  K'&TERMID-1                                              00191000
         DC    AL1(&I),CL4'&IDTERM'                                     00192000
         AGO   .ID04                                                    00193000
.ID03    DC    X'FE',CL4'&IDTERM'                                       00194000
.ID04    ANOP                                                           00195000
         AIF   ('&IDOPER' EQ 'ALL').ID05                                00196000
&I       SETA  K'&OPID-1                                                00197000
         DC    AL1(&I),CL4'&IDOPER'                                     00198000
         AGO   .ID06                                                    00199000
.ID05    DC    X'FE',CL4'&IDOPER'                                       00200000
.ID06    ANOP                                                           00201000
         DC    X'FF'                                                    00202000
         SPACE 3                                                        00203000
         MEXIT                                                          00204000
.BADSCRN ANOP                                                           00205000
         MNOTE 8,'MISSING LIST CARD FOR SCREEN FEATURE. MACRO IGNORED'  00206000
         MEXIT                                                          00207000
.PRNT    ANOP                                                           00208000
         AIF   (&PCT GT 0).PCTS                                         00209000
PCT      DS    0D                                                       00210000
&PCT     SETA  1                                                        00211000
         AGO   .PF                                                      00212000
.PCTS    ANOP                                                           00213000
         ORG   *-1                                                      00214000
.PF      ANOP                                                           00215000
         DC    CL8'&TERMID'            TERM ID                          00216000
         DC    A($&DEVTYPE)            DEVICE CHARACTERISTICS           00217000
         DC    X'FF'                                                    00218000
         AIF   ('&TERMID' EQ '').BADTERM                                00219000
         MEXIT                                                          00220000
&N       SETA  1                                                        00221000
         AIF   ('&AUTOCL' EQ '').GOTIT                                  00222000
.AGAIN   ANOP                                                           00223000
         AIF   ('ABCDEFGHIJKLMNOPQRSTUVWXYZ'(&N,1) EQ '&AUTOCL').GOTIT  00224000
&N       SETA  &N+1                                                     00225000
         AIF   (&N LE 26).AGAIN                                         00226000
         MNOTE 8,'*** INVALID CLASS ***'                                00227000
         MEXIT                                                          00228000
.GOTIT   ANOP                                                           00229000
         AIF   (&PCT GT 0).PCTSET                                       00230000
PCT      DS    0D                                                       00231000
&PCT     SETA  1                                                        00232000
         AGO   .NOORG                                                   00233000
.PCTSET  ANOP                                                           00234000
         ORG   *-1                                                      00235000
.NOORG   ANOP                                                           00236000
TERM&SYSNDX DC 216X'00'                                                 00237000
         ORG   TERM&SYSNDX                                              00238000
         DC    CL8'&TERMID'                                             00239000
         ORG                                                            00240000
         AIF   ('&AUTOCL' EQ '').NOAUTO                                 00241000
         ORG   TERM&SYSNDX+X'14'                                        00242000
         DC    CL1'&AUTOCL'                                             00243000
&L       SETC  '&AUTORJE'                                               00244000
         AIF   ('&L' EQ '').RJEALL                                      00245000
         AIF   ('&L' EQ 'ALL').RJEALL                                   00246000
         AIF   ('&L' GT '200').RJE1                                     00247000
.RJE0    ANOP                                                           00248000
         ORG   TERM&SYSNDX+X'17'                                        00249000
         DC    AL1(&L)                                                  00250000
         AGO   .RJE2                                                    00251000
.RJEALL  ANOP                                                           00252000
&L       SETC  '255'                                                    00253000
         AGO   .RJE0                                                    00254000
.RJE1    MNOTE 8,'INVALID RJE ID. ALL ASSUMED'                          00255000
         AGO   .RJEALL                                                  00256000
.RJE2    ANOP                                                           00257000
&L       SETC  '&AUTOSYS'                                               00258000
         AIF   ('&L' EQ '').SYSALL                                      00259000
         AIF   ('&L' EQ 'ALL').SYSALL                                   00260000
         AIF   ('&L' GT '9').SYS1                                       00261000
.SYS0    ANOP                                                           00262000
         ORG   TERM&SYSNDX+X'23'                                        00263000
         DC    AL1(&L)                                                  00264000
         AGO   .SYS2                                                    00265000
.SYSALL  ANOP                                                           00266000
&L       SETC  '255'                                                    00267000
         AGO   .SYS0                                                    00268000
.SYS1    MNOTE 8,'INVALID SYS ID. ALL ASSUMED'                          00269000
         AGO   .SYSALL                                                  00270000
.SYS2    ANOP                                                           00271000
         ORG   TERM&SYSNDX+X'AB' SET DEFAULT AUTO FORMS                 00272000
         DC    X'FF'                                                    00273000
         AIF   ('&AUTOFNO' EQ '').NOAFNO                                00274000
         AIF   ('&AUTOFNO' EQ 'ALL').NOAFNO                             00275000
         ORG   TERM&SYSNDX+X'AB'                                        00276000
         DC    CL4'&AUTOFNO'                                            00277000
.NOAFNO  ANOP                                                           00278000
&AUTOCL.&AUTORJE.&AUTOSYS    EQU      *                                 00279000
.NOAUTO  ANOP                                                           00280000
         ORG   TERM&SYSNDX+X'34'                                        00281000
         DC    A($&DEVTYPE)                                             00282000
&L       SETC  '100'                                                    00283000
         AIF   ('&ICTIME' EQ '0').ICD                                   00284000
         AIF   ('&ICTIME' EQ '').IC0                                    00285000
&L       SETC  '&ICTIME'                                                00286000
.IC0     ANOP                                                           00287000
         ORG   TERM&SYSNDX+X'60'                                        00288000
         DC    PL4'&L'                                                  00289000
         AGO   .IC1                                                     00290000
.ICD     MNOTE 8,'INVALID IC TIME INTERVAL. DEFAULT OF 100 USED'        00291000
         AGO   .IC0                                                     00292000
.IC1     ANOP                                                           00293000
         ORG   TERM&SYSNDX+X'40'                                        00294000
&L       SETC  'RAPSFCB'                                                00295000
         AIF   ('&DFLTFCB' EQ '').FCBSET                                00296000
&L       SETC  '&DFLTFCB'                                               00297000
.FCBSET  DC    CL8'&L'                                                  00298000
&L       SETC  '128'              SET DEFAULT = YES                     00299000
         AIF   ('&WFMSG' EQ '').WF                                      00300000
         AIF   ('&WFMSG' EQ 'INITIAL').WFIN                             00301000
         AIF   ('&WFMSG' EQ 'ALL').WFALL                                00302000
         AIF   ('&WFMSG' EQ 'NO').NOWF                                  00303000
         AIF   ('&WFMSG' EQ 'YES').WF                                   00304000
&L       SETC  '64'               SET FOR ALARM                         00305000
         AIF   ('&WFMSG' EQ 'ALARM').WF                                 00306000
&L       SETC  '192'              MESSAGE AND ALARM                     00307000
         AGO   .WF                                                      00308000
.WFIN    ANOP                                                           00309000
&L       SETC  '160'              INITIAL+YES                           00310000
         AGO   .WF                                                      00311000
.WFALL   ANOP                                                           00312000
&L       SETC  '224'              INITIAL+YES+ALARM                     00313000
         AGO   .WF                                                      00314000
.NOWF    ANOP                                                           00315000
&L       SETC  '00'                                                     00316000
.WF      ANOP                                                           00317000
         ORG   TERM&SYSNDX+X'5F'                                        00318000
         DC    AL1(&L)                                                  00319000
         ORG   TERM&SYSNDX+X'64'                                        00320000
&L       SETC  '0'                                                      00321000
         AIF   ('&JSEP' EQ '').JSEPSET                                  00322000
         AIF   ('&JSEP' EQ 'NO').JSEPNO                                 00323000
&L       SETC  '&JSEP'                                                  00324000
         AGO   .JSEPSET                                                 00325000
.JSEPNO  ANOP                                                           00326000
&L       SETC  '255'                                                    00327000
.JSEPSET DC    AL1(&L)                                                  00328000
&L       SETC  'FCB2'                                                   00329000
         AIF   ('&GFCB' EQ '').GFCB                                     00330000
&L       SETC  '&GFCB'                                                  00331000
.GFCB    ANOP                                                           00332000
         ORG   TERM&SYSNDX+X'65'                                        00333000
         DC    CL4'&L'                                                  00334000
         AIF   ('&ENDISP' EQ '').NOEDISP                                00335000
         AIF   ('&ENDISP' EQ 'NORMAL').NOEDISP                          00336000
         ORG   TERM&SYSNDX+X'69'                                        00337000
         DC    CL66&ENDISP                                              00338000
         ORG                                                            00339000
.NOEDISP ANOP                                                           00340000
&L       SETC  'RAPS'                                                   00341000
         AIF   ('&FLASH' EQ '').NOFLASH                                 00342000
&L       SETC  '&FLASH'                                                 00343000
         ORG   TERM&SYSNDX+X'C0'                                        00344000
         DC    CL4'&FLASH'                                              00345000
.NOFLASH ANOP                                                           00346000
&RSCSI   SETC  'RSCS'                                                   00347000
         AIF   (T'&RSCSID EQ 'O').RSCSOM                                00348000
         AIF   (K'&RSCSID LT 9).RSCSOK                                  00349000
         MNOTE 8,'RSCSID KEYWORK INVALID, MACRO IGNORED'                00350000
         MEXIT                                                          00351000
.RSCSOK  ANOP                                                           00352000
&RSCSI   SETC  '&RSCSID'                                                00353000
.RSCSOM  ANOP                                                           00354000
         ORG   TERM&SYSNDX+X'C8'                                        00355000
         DC    CL8'&RSCSI'                                              00356000
         ORG                                                            00357000
         DC    X'FF'                                                    00358000
         SPACE 5                                                        00359000
         MEXIT                                                          00360000
.BADTERM ANOP                                                           00361000
         MNOTE 8,'MISSING TERMINAL IDENTIFIER MACRO IGNORED'            00362000
         MEXIT                                                          00363000
.IO      ANOP                                                           00364000
         AIF   ('&OPSYST' EQ 'CMS').IOC1                                00365000
&QFILE DTFPH TYPEFLE=INPUT,CCWADDR=QCCW,DEVICE=&QDISK,MOUNTED=ALL       00366000
         AGO   .IOD1                                                    00367000
.IOC1    ANOP                                                           00368000
&QFILE   DC    72X'00'                 RESERVED.                        00369000
.IOD1    ANOP                                                           00370000
         AIF   ('&QDISK' EQ 'FBA').QFBA                                 00371000
QCCW     DS    0D                                                       00372000
QSK      DC    X'07'               SEEK                                 00373000
         DC    AL3(QSEEK+1)                                             00374000
         DC    X'4000'                                                  00375000
         DC    H'6'                                                     00376000
QSS      DC    X'08'               TIC OR SET SECTOR                    00377000
         DC    AL3(QSH)                                                 00378000
         DC    X'0000'                                                  00379000
         DC    H'1'                                                     00380000
QSH      DC    X'31'               SEARCH                               00381000
         DC    AL3(QSEEK+3)                                             00382000
         DC    X'4000'                                                  00383000
         DC    H'5'                                                     00384000
QTI      DC    X'08'               TIC *-8                              00385000
         DC    AL3(QSH)                                                 00386000
         DC    X'0000'                                                  00387000
         DC    H'0'                                                     00388000
QRD      DC    X'06'               READ                                 00389000
QRDA     DC    AL3(0)                                                   00390000
         DC    X'2000'             SUPPRESS WLR                         00391000
         DC    H'216'                                                   00392000
QSEEK    DC    CL8'MBBCCHHR'                                            00393000
QSECTOR  DS    X                                                        00394000
         AGO   .QIOBD                                                   00395000
.QFBA    ANOP                                                           00396000
QCCW     DS    0D                                                       00397000
QDF      DC    X'63'               DEFINE EXTENT                        00398000
         DC    AL3(QED)                                                 00399000
         DC    X'4000'                                                  00400000
         DC    H'16'                                                    00401000
QLC      DC    X'43'               LOCATE                               00402000
         DC    AL3(QLW)                                                 00403000
         DC    X'4000'                                                  00404000
         DC    H'8'                                                     00405000
QRD      DC    X'42'               READ                                 00406000
QRDA     DC    AL3(0)                                                   00407000
         DC    X'2000'             SUPPRESS WLR                         00408000
         DC    H'216'                                                   00409000
QSEEK    EQU   *                                                        00410000
QED      DS    CL16                                                     00411000
QLW      DS    CL8                                                      00412000
QSS      EQU   0                                                        00413000
         AGO   .QIOBD                                                   00414000
.QIOBD   ANOP                                                           00415000
         AIF   ('&OPSYST' EQ 'CMS').IOC2                                00416000
&DFILE DTFPH TYPEFLE=INPUT,CCWADDR=DCCW,DEVICE=&DDISK,MOUNTED=ALL,     *00417000
               XTNTXIT=*-*                                              00418000
         AGO   .IOD2                                                    00419000
.IOC2    ANOP                                                           00420000
&DFILE   DC    72X'00'                 RESERVED.                        00421000
.IOD2    ANOP                                                           00422000
         AIF   ('&DDISK' EQ 'FBA').DFBA                                 00423000
DCCW     DS    0D                                                       00424000
DSK      DC    X'07'               SEEK                                 00425000
         DC    AL3(DSEEK+1)                                             00426000
         DC    X'4000'                                                  00427000
         DC    H'6'                                                     00428000
DSS      DC    X'08'               TIC OR SET SECTOR                    00429000
         DC    AL3(DSH)                                                 00430000
         DC    X'0000'                                                  00431000
         DC    H'1'                                                     00432000
DSH      DC    X'31'               SEARCH                               00433000
         DC    AL3(DSEEK+3)                                             00434000
         DC    X'4000'                                                  00435000
         DC    H'5'                                                     00436000
DTI      DC    X'08'               TIC *-8                              00437000
         DC    AL3(DSH)                                                 00438000
         DC    X'0000'                                                  00439000
         DC    H'0'                                                     00440000
DRD      DC    X'06'               READ                                 00441000
DRDA     DC    AL3(0)                                                   00442000
         DC    X'2000'             SUPPRESS WLR                         00443000
         DC    H'12288'                                                 00444000
DSEEK    DC    CL8'MBBCCHHR'                                            00445000
DSECTOR  DS    X                                                        00446000
         AGO   .DIOBD                                                   00447000
.DFBA    ANOP                                                           00448000
DCCW     DS    0D                                                       00449000
DDF      DC    X'63'               DEFINE EXTENT                        00450000
         DC    AL3(DED)                                                 00451000
         DC    X'4000'                                                  00452000
         DC    H'16'                                                    00453000
DLC      DC    X'43'               LOCATE                               00454000
         DC    AL3(DLW)                                                 00455000
         DC    X'4000'                                                  00456000
         DC    H'8'                                                     00457000
DRD      DC    X'42'               READ                                 00458000
DRDA     DC    AL3(0)                                                   00459000
         DC    X'2000'             SUPPRESS WLR                         00460000
         DC    H'12288'                                                 00461000
DSEEK    EQU   *                                                        00462000
DED      DS    CL16                                                     00463000
DLW      DS    CL8                                                      00464000
DSS      EQU   0                                                        00465000
         AGO   .DIOBD                                                   00466000
.DIOBD   ANOP                                                           00467000
XTENTAB  DC    5XL14'FFFFFFFFFFFFFFFFFFFFFFFFFFFF'                      00468000
$QFILE   EQU   &QFILE                                                   00469000
$DFILE   EQU   &DFILE                                                   00470000
         MEXIT                                                          00471000
.DEVTAB  ANOP                                                           00472000
$&DEVTYPE  DS    0D                                                     00473000
         DC    XL1'05'                 TYPE                             00474000
         DC    CL8'&DEVTYPE'           TERMINAL ID                      00475000
         DC    CL6' '                                                   00476000
         DC    CL2' '                                                   00477000
         DC    F'0'                    LENGTH NOT USED                  00478000
         DC    CL30'CAPRTAB &DEVTYPE'  DESCRIPTION                      00479000
&IANL    SETC  '00'                                                     00480000
&ICMP    SETC  '00'                                                     00481000
&ISCS    SETC  '00'                                                     00482000
&ILVT    SETC  '00'                                                     00483000
&ILPI8   SETC  ''                                                       00484000
&ILPI6   SETC  ''                                                       00485000
&ISVF    SETC  ''                                                       00486000
         AIF   ('&DEVTYPE' EQ '3287SCS').SCS3287                        00487000
         AIF   ('&DEVTYPE' EQ '3289SCS').SCS3289                        00488000
         AIF   ('&DEVTYPE' EQ '3262SCS').SCS3289                        00489000
         AIF   ('&DEVTYPE' EQ '3268SCS').SCS3289                        00490000
         AIF   ('&DEVTYPE' EQ '6670SCS').SCS6670                        00491000
         AIF   ('&DEVTYPE' EQ '3287' AND '&SCSPRT' EQ 'YES').SCS3287    00492000
         AIF   ('&DEVTYPE' EQ '3289' AND '&SCSPRT' EQ 'YES').SCS3289    00493000
         AIF   ('&DEVTYPE' EQ '3262' AND '&SCSPRT' EQ 'YES').SCS3289    00494000
         AIF   ('&DEVTYPE' EQ '3268' AND '&SCSPRT' EQ 'YES').SCS3289    00495000
         AIF   ('&DEVTYPE' EQ '6670' AND '&SCSPRT' EQ 'YES').SCS6670    00496000
         AIF   ('&DEVTYPE' EQ '2780').B6670                             00497000
         AIF   ('&DEVTYPE' EQ '3780').B6670                             00498000
         AIF   ('&DEVTYPE' EQ '3284').B3286                             00499000
         AIF   ('&DEVTYPE' EQ '3286').B3286                             00500000
         AIF   ('&DEVTYPE' EQ '3287').B3287                             00501000
         AIF   ('&DEVTYPE' EQ '3288').B3286                             00502000
         AIF   ('&DEVTYPE' EQ '3289').B3289                             00503000
         AIF   ('&DEVTYPE' EQ '3262').B3289                             00504000
         AIF   ('&DEVTYPE' EQ '3268').B3289                             00505000
         AIF   ('&DEVTYPE' EQ '6670').B6670                             00506000
         AIF   ('&DEVTYPE' EQ 'TWX').BTWX                               00507000
.B3289   ANOP                                                           00508000
&IBUFF   SETC  '1920'                                                   00509000
&ISFIX   SETC  '19'                                                     00510000
&IEFIX   SETC  '19'                                                     00511000
&ISP0    SETC  '0D'                                                     00512000
&ISP1    SETC  '15'                                                     00513000
&ISP2    SETC  '1515'                                                   00514000
&ISP3    SETC  '151515'                                                 00515000
&ICH1    SETC  '0C'                                                     00516000
&IFF     SETC  '0C'                                                     00517000
&ICMP    SETC  '80'                                                     00518000
         AGO   .PARMSET                                                 00519000
         SPACE 2                                                        00520000
.B3287   ANOP                                                           00521000
&IBUFF   SETC  '1920'                                                   00522000
&ISFIX   SETC  '19'                                                     00523000
&IEFIX   SETC  '19'                                                     00524000
&ISP0    SETC  '0D'                                                     00525000
&ISP1    SETC  '15'                                                     00526000
&ISP2    SETC  '1515'                                                   00527000
&ISP3    SETC  '151515'                                                 00528000
&ICH1    SETC  '0C'                                                     00529000
&IFF     SETC  '0C'                                                     00530000
&IANL    SETC  '80'                                                     00531000
&ICMP    SETC  '00'                                                     00532000
&ISCS    SETC  '00'                                                     00533000
&ILVT    SETC  '00'                                                     00534000
&ICMP    SETC  '80'                                                     00535000
         AGO   .PARMSET                                                 00536000
.B3286   ANOP                                                           00537000
&IBUFF   SETC  '1920'                                                   00538000
&ISFIX   SETC  '19'                                                     00539000
&IEFIX   SETC  '19'                                                     00540000
&ISP1    SETC  '15'                                                     00541000
&ISP2    SETC  '1515'                                                   00542000
&ISP3    SETC  '151515'                                                 00543000
&ICH1    SETC  '0C'                                                     00544000
&IFF     SETC  '0C'                                                     00545000
&IANL    SETC  '40'                                                     00546000
&ICMP    SETC  '80'                                                     00547000
         AGO   .PARMSET                                                 00548000
.B6670   ANOP                                                           00549000
&IBUFF   SETC  '256'                                                    00550000
&ISFIX   SETC  '26'                                                     00551000
&IEFIX   SETC  '03'                                                     00552000
&ISP0    SETC  '15'                                                     00553000
&ISP1    SETC  '1E'                                                     00554000
&ISP2    SETC  '1E1E'                                                   00555000
&ISP3    SETC  '1E1E1E'                                                 00556000
&ICH1    SETC  '0C'                                                     00557000
&IFF     SETC  '0C'                                                     00558000
&ISCS    SETC  '00'                                                     00559000
&ILVT    SETC  '00'                                                     00560000
&IANL    SETC  '00'                                                     00561000
         AGO   .PARMSET                                                 00562000
.SCS6670 ANOP                                                           00563000
&IBUFF   SETC  '256'                                                    00564000
&ISP0    SETC  '0D'                                                     00565000
&ISP1    SETC  '06'                                                     00566000
&ISP2    SETC  '0625'                                                   00567000
&ISP3    SETC  '062525'                                                 00568000
&ICH1    SETC  '3A0C0D'                                                 00569000
&IFF     SETC  '0C'                                                     00570000
&ISCS    SETC  '00'                                                     00571000
&ILVT    SETC  '00'                                                     00572000
&IANL    SETC  '00'                                                     00573000
&IBFMH1  SETC  '09013000'                                               00574000
&IBFMH2  SETC  '40000000'                                               00575000
&IBFMH3  SETC  '00'                                                     00576000
&IEFMH1  SETC  '09013000'                                               00577000
&IEFMH2  SETC  '20000000'                                               00578000
&IEFMH3  SETC  '00'                                                     00579000
         AGO   .PARMSET                                                 00580000
.V3289   ANOP                                                           00581000
.SCS3289 ANOP                                                           00582000
&IBUFF   SETC  '1920'                                                   00583000
&ISFIX   SETC  '14'                                                     00584000
&IEFIX   SETC  '14'                                                     00585000
&ISP0    SETC  '0D'                                                     00586000
&ISP1    SETC  '15'                                                     00587000
&ISP2    SETC  '1515'                                                   00588000
&ISP3    SETC  '151515'                                                 00589000
&ICH1    SETC  '04810D'                                                 00590000
&ICH2    SETC  '04820D'                                                 00591000
&ICH3    SETC  '04830D'                                                 00592000
&ICH4    SETC  '04840D'                                                 00593000
&ICH5    SETC  '04850D'                                                 00594000
&ICH6    SETC  '04860D'                                                 00595000
&ICH7    SETC  '04870D'                                                 00596000
&ICH8    SETC  '04880D'                                                 00597000
&ICH9    SETC  '04890D'                                                 00598000
&ICH10   SETC  '047A0D'                                                 00599000
&ICH11   SETC  '047B0D'                                                 00600000
&ICH12   SETC  '047C0D'                                                 00601000
&ISCS    SETC  '20'                                                     00602000
&ILVT    SETC  '10'                                                     00603000
&IFF     SETC  '0C'                                                     00604000
&ILPI8   SETC  '2BC60209'                                               00605000
&ILPI6   SETC  '2BC6020C'                                               00606000
&ISVF    SETC  '2BC20F'                                                 00607000
         AGO   .PARMSET                                                 00608000
.V3287   ANOP                                                           00609000
.SCS3287 ANOP                                                           00610000
&IBUFF   SETC  '1920'                                                   00611000
&ISFIX   SETC  '14'                                                     00612000
&IEFIX   SETC  '14'                                                     00613000
&ISP0    SETC  '0D'                                                     00614000
&ISP1    SETC  '15'                                                     00615000
&ISP2    SETC  '1515'                                                   00616000
&ISP3    SETC  '151515'                                                 00617000
&ICH1    SETC  '0C'                                                     00618000
&IANL    SETC  '40'                                                     00619000
&ISCS    SETC  '00'                                                     00620000
&ILVT    SETC  '10'                                                     00621000
&IFF     SETC  '0C'                                                     00622000
&ILPI8   SETC  '2BC60209'                                               00623000
&ILPI6   SETC  '2BC6020C'                                               00624000
&ISVF    SETC  '2BC203'                                                 00625000
         AGO   .PARMSET                                                 00626000
.BTWX    ANOP                                                           00627000
&IBUFF   SETC  '1000'                                                   00628000
&ISP0    SETC  '0D'                                                     00629000
&ISP1    SETC  '0D25'                                                   00630000
&ISP2    SETC  '0D2525'                                                 00631000
&ISP3    SETC  '0D252525'                                               00632000
&ICH1    SETC  '0C'                                                     00633000
&IFF     SETC  '0C'                                                     00634000
&IANL    SETC  '00'                                                     00635000
&ICMP    SETC  '00'                                                     00636000
         AGO   .PARMSET                                                 00637000
         SPACE 2                                                        00638000
.PARMSET ANOP                                                           00639000
&SCS     SETC  '&ISCS'                                                  00640000
         AIF   ('&SCSPRT' EQ '').NOSCS                                  00641000
&SCS     SETC  '00'                                                     00642000
         AIF   ('&SCSPRT' EQ 'NO').NOSCS                                00643000
&SCS     SETC  '20'                                                     00644000
.NOSCS   ANOP                                                           00645000
&ANL     SETC  '&IANL'                                                  00646000
         AIF   ('&AUTONL' EQ '').NOANL                                  00647000
&ANL     SETC  '00'                                                     00648000
         AIF   ('&AUTONL' EQ 'NO').NOANL                                00649000
&ANL     SETC  '40'                                                     00650000
.NOANL   ANOP                                                           00651000
&CMP     SETC  '&ICMP'                                                  00652000
         AIF   ('&COMPRS' EQ '').NOCOMP                                 00653000
&CMP     SETC  '00'                                                     00654000
         AIF   ('&COMPRS' EQ 'NO').NOCOMP                               00655000
&CMP     SETC  '80'                                                     00656000
.NOCOMP   ANOP                                                          00657000
&LVT     SETC  '&ILVT'                                                  00658000
         AIF   ('&VT' EQ '').NOVT                                       00659000
&LVT     SETC  '00'                                                     00660000
         AIF   ('&VT' EQ 'NO').NOVT                                     00661000
&LVT     SETC  '10'                                                     00662000
.NOVT     ANOP                                                          00663000
         AIF   ('&BUFF' EQ '').BUFFSET                                  00664000
&IBUFF   SETC  '&BUFF'                                                  00665000
.BUFFSET ANOP                                                           00666000
         DC    H'&IBUFF'               BUFFER SIZE                      00667000
         DC    AL1(X'&ANL'+X'&CMP'+X'&SCS'+X'&LVT'+X'08'+X'02')         00668000
         AIF   ('&SYSPARM' EQ '').NOSYSP                                00669000
         DC    CL8'&SYSPARM'             STAMP JUS IN CASE              00670000
         AGO   .SYSP                                                    00671000
.NOSYSP  ANOP                                                           00672000
         DC    CL8' '                    STAMP JUS IN CASE              00673000
.SYSP    ANOP                                                           00674000
         DS    0H                        LENGTH OF CONTROL INFORMATION  00675000
         DC    AL2($&SYSNDX.L)           LENGTH OF CONTROL INFORMATION  00676000
$&SYSNDX.B EQU *                                                        00677000
         AIF   ('&LPI6' EQ 'NO').NOLPI6                                 00678000
         AIF   ('&LPI6' EQ '').LPI6                                     00679000
&ILPI6   SETC  '&LPI6'                                                  00680000
&IFF     SETC  ''                                                       00681000
.LPI6    ANOP                                                           00682000
         AIF   ('&ILPI6' EQ '').NOLPI6                                  00683000
         DC    AL1(L'$&SYSNDX.L6)                                       00684000
$&SYSNDX.L6 DC X'&IFF&ILPI6'           LPI6                             00685000
         AGO   .ELPI6                                                   00686000
.NOLPI6  ANOP                                                           00687000
         DC    AL1(0)                  LPI6                             00688000
.ELPI6   ANOP                                                           00689000
         AIF   ('&LPI8' EQ 'NO').NOLPI8                                 00690000
         AIF   ('&LPI8' EQ '').LPI8                                     00691000
&ILPI8   SETC  '&LPI8'                                                  00692000
&IFF     SETC  ''                                                       00693000
.LPI8    ANOP                                                           00694000
         AIF   ('&ILPI8' EQ '').NOLPI8                                  00695000
         DC    AL1(L'$&SYSNDX.L8)                                       00696000
$&SYSNDX.L8 DC X'&IFF&ILPI8'               LPI8                         00697000
         AGO   .ELPI8                                                   00698000
.NOLPI8  ANOP                                                           00699000
         DC    AL1(0)                          LPI8                     00700000
.ELPI8   ANOP                                                           00701000
         AIF   ('&SVF' EQ 'NO').NOSVF                                   00702000
         AIF   ('&SVF' EQ '').SVF                                       00703000
&ISVF    SETC  '&SVF'                                                   00704000
.SVF     ANOP                                                           00705000
         AIF   ('&ISVF' EQ '').NOSVF                                    00706000
         DC    AL1(L'$&SYSNDX.VT)                                       00707000
$&SYSNDX.VT DC X'&ISVF'                SVF                              00708000
         AGO   .ESVF                                                    00709000
.NOSVF   ANOP                                                           00710000
         DC    AL1(0)                     SVF                           00711000
.ESVF    ANOP                                                           00712000
         AIF   ('&PREFIX' EQ 'NO').NOPFIX                               00713000
         AIF   ('&PREFIX' EQ '').PFIX                                   00714000
&IPFIX   SETC  '&PREFIX'                                                00715000
.PFIX    ANOP                                                           00716000
         AIF   ('&IPFIX' EQ '').NOPFIX                                  00717000
         DC    AL1(L'$&SYSNDX.PF)                                       00718000
$&SYSNDX.PF DC X'&IPFIX'                  PREFIX                        00719000
         AGO   .EOPFIX                                                  00720000
.NOPFIX  ANOP                                                           00721000
         DC    AL1(0)                      PREFIX                       00722000
.EOPFIX  ANOP                                                           00723000
         AIF   ('&SUFFIX' EQ 'NO').NOSFIX                               00724000
         AIF   ('&SUFFIX' EQ '').SFIX                                   00725000
&ISFIX   SETC  '&SUFFIX'                                                00726000
.SFIX    ANOP                                                           00727000
         AIF   ('&ISFIX' EQ '').NOSFIX                                  00728000
         DC    AL1(L'$&SYSNDX.SF)                                       00729000
$&SYSNDX.SF DC X'&ISFIX'                SUFFIX                          00730000
         AGO   .EOSFIX                                                  00731000
.NOSFIX  ANOP                                                           00732000
         DC    AL1(0)                         SUFFIX                    00733000
.EOSFIX  ANOP                                                           00734000
         AIF   ('&BEGFIX' EQ 'NO').NOBFIX                               00735000
         AIF   ('&BEGFIX' EQ '').BFIX                                   00736000
&IBFIX   SETC  '&BEGFIX'                                                00737000
.BFIX    ANOP                                                           00738000
         AIF   ('&IBFIX' EQ '').NOBFIX                                  00739000
         DC    AL1(L'$&SYSNDX.BF)                                       00740000
$&SYSNDX.BF DC X'&IBFIX'                       B PREFIX                 00741000
         AGO   .EOBFIX                                                  00742000
.NOBFIX  ANOP                                                           00743000
         DC    AL1(0)                          B PREFIX                 00744000
.EOBFIX  ANOP                                                           00745000
         AIF   ('&EOJFIX' EQ 'NO').NOEFIX                               00746000
         AIF   ('&EOJFIX' EQ '').EFIX                                   00747000
&IEFIX   SETC  '&EOJFIX'                                                00748000
.EFIX    ANOP                                                           00749000
         AIF   ('&IEFIX' EQ '').NOEFIX                                  00750000
         DC    AL1(L'$&SYSNDX.EF)                                       00751000
$&SYSNDX.EF DC X'&IEFIX'                EOJ FIX                         00752000
         AGO   .EOEFIX                                                  00753000
.NOEFIX  ANOP                                                           00754000
         DC    AL1(0)                   EOJ FIX                         00755000
.EOEFIX  ANOP                                                           00756000
         AIF   ('&BEGFMH' EQ 'NO').NOBFMH                               00757000
         AIF   ('&BEGFMH' EQ '').BFMH1                                  00758000
         DC    AL1(L'$&SYSNDX.FB)                                       00759000
$&SYSNDX.FB DC X'&BEGFMH'                   SPECIFIED BEGFMH            00760000
         AGO   .BFMH2                                                   00761000
.BFMH1   ANOP                                                           00762000
         AIF   ('&IBFMH1' EQ '').NOBFMH                                 00763000
         DC    AL1(L'$&SYSNDX.FB)                                       00764000
$&SYSNDX.FB DC X'&IBFMH1.&IBFMH2.&IBFMH3'   BEG FMH                     00765000
.BFMH2   ANOP                                                           00766000
         AGO   .EOBFMH                                                  00767000
.NOBFMH  ANOP                                                           00768000
         DC    AL1(0)                      BEG FMH                      00769000
.EOBFMH  ANOP                                                           00770000
         AIF   ('&EOJFMH' EQ 'NO').NOEFMH                               00771000
         AIF   ('&EOJFMH' EQ '').EFMH1                                  00772000
         DC    AL1(L'$&SYSNDX.FE)                                       00773000
$&SYSNDX.FE DC X'&EOJFMH'                   SPECIFIED EOJFMH            00774000
         AGO   .EFMH2                                                   00775000
.EFMH1   ANOP                                                           00776000
         AIF   ('&IEFMH1' EQ '').NOEFMH                                 00777000
         DC    AL1(L'$&SYSNDX.FE)                                       00778000
$&SYSNDX.FE DC X'&IEFMH1.&IEFMH2.&IEFMH3'   EOJFMH                      00779000
.EFMH2   ANOP                                                           00780000
         AGO   .EOEFMH                                                  00781000
.NOEFMH  ANOP                                                           00782000
         DC    AL1(0)                       EOJFMH                      00783000
.EOEFMH  ANOP                                                           00784000
         AIF   ('&SPACE0' EQ 'NO').NOSP0                                00785000
         AIF   ('&SPACE0' EQ '').SP0                                    00786000
&ISP0    SETC  '&SPACE0'                                                00787000
.SP0     ANOP                                                           00788000
         AIF   ('&ISP0' EQ '').NOSP0                                    00789000
         DC    AL1(L'$&SYSNDX.S0)                                       00790000
$&SYSNDX.S0 DC X'&ISP0'                SP0                              00791000
         AGO   .EOSP0                                                   00792000
.NOSP0   ANOP                                                           00793000
         DC    AL1(0)                     SP0                           00794000
.EOSP0   ANOP                                                           00795000
         AIF   ('&SPACE1' EQ 'NO').NOSP1                                00796000
         AIF   ('&SPACE1' EQ '').SP1                                    00797000
&ISP1    SETC  '&SPACE1'                                                00798000
.SP1     ANOP                                                           00799000
         AIF   ('&ISP1' EQ '').NOSP1                                    00800000
         DC    AL1(L'$&SYSNDX.S1)                                       00801000
$&SYSNDX.S1 DC X'&ISP1'                   SP1                           00802000
         AGO   .EOSP1                                                   00803000
.NOSP1   ANOP                                                           00804000
         DC    AL1(0)                        SP1                        00805000
.EOSP1   ANOP                                                           00806000
         AIF   ('&SPACE2' EQ 'NO').NOSP2                                00807000
         AIF   ('&SPACE2' EQ '').SP2                                    00808000
&ISP2    SETC  '&SPACE2'                                                00809000
.SP2     ANOP                                                           00810000
         AIF   ('&ISP2' EQ '').NOSP2                                    00811000
         DC    AL1(L'$&SYSNDX.S2)                                       00812000
$&SYSNDX.S2 DC X'&ISP2'                SP2                              00813000
         AGO   .EOSP2                                                   00814000
.NOSP2   ANOP                                                           00815000
         DC    AL1(0)                     SP2                           00816000
.EOSP2   ANOP                                                           00817000
         AIF   ('&SPACE3' EQ 'NO').NOSP3                                00818000
         AIF   ('&SPACE3' EQ '').SP3                                    00819000
&ISP3    SETC  '&SPACE3'                                                00820000
.SP3     ANOP                                                           00821000
         AIF   ('&ISP3' EQ '').NOSP3                                    00822000
         DC    AL1(L'$&SYSNDX.S3)                                       00823000
$&SYSNDX.S3 DC X'&ISP3'                      SP3                        00824000
         AGO   .EOSP3                                                   00825000
.NOSP3   ANOP                                                           00826000
         DC    AL1(0)                           SP3                     00827000
.EOSP3   ANOP                                                           00828000
         AIF   ('&CH1' EQ 'NO').NOCH1                                   00829000
         AIF   ('&CH1' EQ '').CH1                                       00830000
&ICH1    SETC  '&CH1'                                                   00831000
.CH1     ANOP                                                           00832000
         AIF   ('&ICH1' EQ '').NOCH1                                    00833000
         DC    AL1(L'$&SYSNDX.C1)                                       00834000
$&SYSNDX.C1 DC X'&ICH1'                CH1                              00835000
         AGO   .EOCH1                                                   00836000
.NOCH1   ANOP                                                           00837000
         DC    AL1(0)                     CH1                           00838000
.EOCH1   ANOP                                                           00839000
         AIF   ('&CH2' EQ 'NO').NOCH2                                   00840000
         AIF   ('&CH2' EQ '').CH2                                       00841000
&ICH2    SETC  '&CH2'                                                   00842000
.CH2     ANOP                                                           00843000
         AIF   ('&ICH2' EQ '').NOCH2                                    00844000
         DC    AL1(L'$&SYSNDX.C2)                                       00845000
$&SYSNDX.C2 DC X'&ICH2'                 CH2                             00846000
         AGO   .EOCH2                                                   00847000
.NOCH2   ANOP                                                           00848000
         DC    AL1(0)                      CH2                          00849000
.EOCH2   ANOP                                                           00850000
         AIF   ('&CH3' EQ 'NO').NOCH3                                   00851000
         AIF   ('&CH3' EQ '').CH3                                       00852000
&ICH3    SETC  '&CH3'                                                   00853000
.CH3     ANOP                                                           00854000
         AIF   ('&ICH3' EQ '').NOCH3                                    00855000
         DC    AL1(L'$&SYSNDX.C3)                                       00856000
$&SYSNDX.C3 DC X'&ICH3'                CH3                              00857000
         AGO   .EOCH3                                                   00858000
.NOCH3   ANOP                                                           00859000
         DC    AL1(0)                     CH3                           00860000
.EOCH3   ANOP                                                           00861000
         AIF   ('&CH4' EQ 'NO').NOCH4                                   00862000
         AIF   ('&CH4' EQ '').CH4                                       00863000
&ICH4    SETC  '&CH4'                                                   00864000
.CH4     ANOP                                                           00865000
         AIF   ('&ICH4' EQ '').NOCH4                                    00866000
         DC    AL1(L'$&SYSNDX.C4)       CH4                             00867000
$&SYSNDX.C4 DC X'&ICH4'                                                 00868000
         AGO   .EOCH4                                                   00869000
.NOCH4   ANOP                                                           00870000
         DC    AL1(0)                      CH4                          00871000
.EOCH4   ANOP                                                           00872000
         AIF   ('&CH5' EQ 'NO').NOCH5                                   00873000
         AIF   ('&CH5' EQ '').CH5                                       00874000
&ICH5    SETC  '&CH5'                                                   00875000
.CH5     ANOP                                                           00876000
         AIF   ('&ICH5' EQ '').NOCH5                                    00877000
         DC    AL1(L'$&SYSNDX.C5)                                       00878000
$&SYSNDX.C5 DC X'&ICH5'                CH5                              00879000
         AGO   .EOCH5                                                   00880000
.NOCH5   ANOP                                                           00881000
         DC    AL1(0)                     CH5                           00882000
.EOCH5   ANOP                                                           00883000
         AIF   ('&CH6' EQ 'NO').NOCH6                                   00884000
         AIF   ('&CH6' EQ '').CH6                                       00885000
&ICH6    SETC  '&CH6'                                                   00886000
.CH6     ANOP                                                           00887000
         AIF   ('&ICH6' EQ '').NOCH6                                    00888000
         DC    AL1(L'$&SYSNDX.C6)                                       00889000
$&SYSNDX.C6 DC X'&ICH6'                      CH6                        00890000
         AGO   .EOCH6                                                   00891000
.NOCH6   ANOP                                                           00892000
         DC    AL1(0)                           CH6                     00893000
.EOCH6   ANOP                                                           00894000
         AIF   ('&CH7' EQ 'NO').NOCH7                                   00895000
         AIF   ('&CH7' EQ '').CH7                                       00896000
&ICH7    SETC  '&CH7'                                                   00897000
.CH7     ANOP                                                           00898000
         AIF   ('&ICH7' EQ '').NOCH7                                    00899000
         DC    AL1(L'$&SYSNDX.C7)                                       00900000
$&SYSNDX.C7 DC X'&ICH7'                CH7                              00901000
         AGO   .EOCH7                                                   00902000
.NOCH7   ANOP                                                           00903000
         DC    AL1(0)                     CH7                           00904000
.EOCH7   ANOP                                                           00905000
         AIF   ('&CH8' EQ 'NO').NOCH8                                   00906000
         AIF   ('&CH8' EQ '').CH8                                       00907000
&ICH8    SETC  '&CH8'                                                   00908000
.CH8     ANOP                                                           00909000
         AIF   ('&ICH8' EQ '').NOCH8                                    00910000
         DC    AL1(L'$&SYSNDX.C8)      CH8                              00911000
$&SYSNDX.C8 DC X'&ICH8'                                                 00912000
         AGO   .EOCH8                                                   00913000
.NOCH8   ANOP                                                           00914000
         DC    AL1(0)                     CH8                           00915000
.EOCH8   ANOP                                                           00916000
         AIF   ('&CH9' EQ 'NO').NOCH9                                   00917000
         AIF   ('&CH9' EQ '').CH9                                       00918000
&ICH9    SETC  '&CH9'                                                   00919000
.CH9     ANOP                                                           00920000
         AIF   ('&ICH9' EQ '').NOCH9                                    00921000
         DC    AL1(L'$&SYSNDX.C9)                                       00922000
$&SYSNDX.C9 DC X'&ICH9'                CH9                              00923000
         AGO   .EOCH9                                                   00924000
.NOCH9   ANOP                                                           00925000
         DC    AL1(0)                     CH9                           00926000
.EOCH9   ANOP                                                           00927000
         AIF   ('&CH10' EQ 'NO').NOCH10                                 00928000
         AIF   ('&CH10' EQ '').CH10                                     00929000
&ICH10    SETC  '&CH10'                                                 00930000
.CH10     ANOP                                                          00931000
         AIF   ('&ICH10' EQ '').NOCH10                                  00932000
         DC    AL1(L'$&SYSNDX.C10)                                      00933000
$&SYSNDX.C10 DC X'&ICH10'              CH10                             00934000
         AGO   .EOCH10                                                  00935000
.NOCH10   ANOP                                                          00936000
         DC    AL1(0)                      CH10                         00937000
.EOCH10   ANOP                                                          00938000
         AIF   ('&CH11' EQ 'NO').NOCH11                                 00939000
         AIF   ('&CH11' EQ '').CH11                                     00940000
&ICH11    SETC  '&CH11'                                                 00941000
.CH11     ANOP                                                          00942000
         AIF   ('&ICH11' EQ '').NOCH11                                  00943000
         DC    AL1(L'$&SYSNDX.C11)                                      00944000
$&SYSNDX.C11 DC X'&ICH11'              CH11                             00945000
         AGO   .EOCH11                                                  00946000
.NOCH11   ANOP                                                          00947000
         DC    AL1(0)                      CH11                         00948000
.EOCH11   ANOP                                                          00949000
         AIF   ('&CH12' EQ 'NO').NOCH12                                 00950000
         AIF   ('&CH12' EQ '').CH12                                     00951000
&ICH12    SETC  '&CH12'                                                 00952000
.CH12     ANOP                                                          00953000
         AIF   ('&ICH12' EQ '').NOCH12                                  00954000
         DC    AL1(L'$&SYSNDX.C12)                                      00955000
$&SYSNDX.C12 DC X'&ICH12'                      CH12                     00956000
         AGO   .EOCH12                                                  00957000
.NOCH12   ANOP                                                          00958000
         DC    AL1(0)                              CH12                 00959000
.EOCH12   ANOP                                                          00960000
$&SYSNDX.L EQU *-$&SYSNDX.B           LENGTH                            00961000
         MEXIT                                                          00962000
.SYSTEM  ANOP                                                           00963000
         MEXIT                                                          00964000
         AIF   (&VUT GT 0).VUTSET                                       00965000
VUT      DS    0D                                                       00966000
&VUT     SETA  1                                                        00967000
.VUTSET  ANOP                                                           00968000
         AIF   (T'&VMUSRID EQ 'O').BADUID                               00969000
         AIF   (K'&VMUSRID LT 9).UIDOK                                  00970000
.BADUID  ANOP                                                           00971000
         MNOTE 8,'VM USERID MISSING OR INVALID, MACRO IGNORED'          00972000
         MEXIT                                                          00973000
.UIDOK   ANOP                                                           00974000
         AIF   (T'&RCF EQ 'O').BADCF                                    00975000
         AIF   (K'&RCF EQ 3).CFOK                                       00976000
.BADCF   ANOP                                                           00977000
         MNOTE 8,'RCF KEYWORD MISSING OR INVALID, MACRO IGNORED'        00978000
         MEXIT                                                          00979000
.CHKCF   ANOP                                                           00980000
         AIF   (K'&RCF NE 9).BADCF                                      00981000
.CFOK    ANOP                                                           00982000
         AIF   (T'&RCFFID EQ 'O').BADCFFI                               00983000
         AIF   (K'&RCFFID LE 46).CHKCFFI                                00984000
.BADCFFI ANOP                                                           00985000
         MNOTE 8,'RCFFID KEYWORD MISSING OR INVALID, MACRO IGNORED'     00986000
         MEXIT                                                          00987000
.CHKCFFI ANOP                                                           00988000
         AIF   ('&RCFFID'(1,1) NE '''').BADCFFI                         00989000
         AIF   ('&RCFFID'(K'&RCFFID,1) NE '''').BADCFFI                 00990000
.CFFIOK  ANOP                                                           00991000
         AIF   (T'&PQF EQ 'O').BADQF                                    00992000
         AIF   (K'&PQF EQ 3).QFOK                                       00993000
.BADQF   ANOP                                                           00994000
         MNOTE 8,'PQF KEYWORD MISSING OR INVALID, MACRO IGNORED'        00995000
         MEXIT                                                          00996000
.QFOK    ANOP                                                           00997000
         AIF   (T'&PDF1 EQ 'O').BADDF1                                  00998000
         AIF   (K'&PDF1 EQ 3).DF1OK                                     00999000
.BADDF1  ANOP                                                           01000000
         MNOTE 8,'PDF1 KEYWORD MISSING OR INVALID, MACRO IGNORED'       01001000
         MEXIT                                                          01002000
.DF1OK   ANOP                                                           01003000
         AIF   (T'&PDF5 EQ 'O').DF5OM                                   01004000
         AIF   (K'&PDF5 EQ 3).DF5OK                                     01005000
.BADDF5  ANOP                                                           01006000
         MNOTE 8,'PDF5 KEYWORD MISSING OR INVALID, MACRO IGNORED'       01007000
         MEXIT                                                          01008000
.DF5OM   ANOP                                                           01009000
.DF5OK   ANOP                                                           01010000
         AIF   (T'&PDF4 EQ 'O').DF4OM                                   01011000
         AIF   (K'&PDF4 EQ 3).DF4OK                                     01012000
.BADDF4  ANOP                                                           01013000
         MNOTE 8,'PDF4 KEYWORD MISSING OR INVALID, MACRO IGNORED'       01014000
         MEXIT                                                          01015000
.DF4OM   ANOP                                                           01016000
         AIF   (T'&PDF5 NE 'O').BADDF4                                  01017000
.DF4OK   ANOP                                                           01018000
         AIF   (T'&PDF3 EQ 'O').DF3OM                                   01019000
         AIF   (K'&PDF3 EQ 3).DF3OK                                     01020000
.BADDF3  ANOP                                                           01021000
         MNOTE 8,'PDF3 KEYWORD MISSING OR INVALID, MACRO IGNORED'       01022000
         MEXIT                                                          01023000
.DF3OM   ANOP                                                           01024000
         AIF   (T'&PDF5 NE 'O').BADDF3                                  01025000
         AIF   (T'&PDF4 NE 'O').BADDF3                                  01026000
.DF3OK   ANOP                                                           01027000
         AIF   (T'&PDF2 EQ 'O').DF2OM                                   01028000
         AIF   (K'&PDF2 EQ 3).DF2OK                                     01029000
.BADDF2  ANOP                                                           01030000
         MNOTE 8,'PDF2 KEYWORD MISSING OR INVALID, MACRO IGNORED'       01031000
         MEXIT                                                          01032000
.DF2OM   ANOP                                                           01033000
         AIF   (T'&PDF5 NE 'O').BADDF2                                  01034000
         AIF   (T'&PDF4 NE 'O').BADDF2                                  01035000
         AIF   (T'&PDF3 NE 'O').BADDF2                                  01036000
.DF2OK   ANOP                                                           01037000
&RCFA2   SETC  '&RCF'                                                   01038000
&PQFA2   SETC  '&PQF'                                                   01039000
&PDF1A2  SETC  '&PDF1'                                                  01040000
&PDF2A2  SETC  '000'                                                    01041000
&PDF3A2  SETC  '000'                                                    01042000
&PDF4A2  SETC  '000'                                                    01043000
&PDF5A2  SETC  '000'                                                    01044000
         AIF   (T'&PDF2 NE 'O').SETHS1                                  01045000
&HEXCHS  SETC  '&RCF'.'&PQF'.'&PDF1'                                    01046000
&HSL     SETA  9                                                        01047000
         AGO   .CHKHX2                                                  01048000
.SETHS1  ANOP                                                           01049000
&PDF2A2  SETC  '&PDF2'                                                  01050000
         AIF   (T'&PDF3 NE 'O').SETHS2                                  01051000
&HEXCHS  SETC  '&RCF'.'&PQF'.'&PDF1'.'&PDF2'                            01052000
&HSL     SETA  12                                                       01053000
         AGO   .CHKHX2                                                  01054000
.SETHS2  ANOP                                                           01055000
&PDF2A2  SETC  '&PDF2'                                                  01056000
&PDF3A2  SETC  '&PDF3'                                                  01057000
         AIF   (T'&PDF4 NE 'O').SETHS3                                  01058000
&HEXCHS  SETC  '&RCF'.'&PQF'.'&PDF1'.'&PDF2'.'&PDF3'                    01059000
&HSL     SETA  15                                                       01060000
         AGO   .CHKHX2                                                  01061000
.SETHS3  ANOP                                                           01062000
&PDF2A2  SETC  '&PDF2'                                                  01063000
&PDF3A2  SETC  '&PDF3'                                                  01064000
&PDF4A2  SETC  '&PDF4'                                                  01065000
         AIF   (T'&PDF5 NE 'O').SETHS4                                  01066000
&HEXCHS  SETC  '&RCF'.'&PQF'.'&PDF1'.'&PDF2'.'&PDF3'.'&PDF4'            01067000
&HSL     SETA  18                                                       01068000
         AGO   .CHKHX2                                                  01069000
.SETHS4  ANOP                                                           01070000
&PDF2A2  SETC  '&PDF2'                                                  01071000
&PDF3A2  SETC  '&PDF3'                                                  01072000
&PDF4A2  SETC  '&PDF4'                                                  01073000
&PDF5A2  SETC  '&PDF5'                                                  01074000
&HEXCHS  SETC  '&RCF'.'&PQF'.'&PDF1'.'&PDF2'.'&PDF3'.'&PDF4'.'&PDF5'    01075000
&HSL     SETA  21                                                       01076000
.CHKHX2  ANOP                                                           01077000
&N       SETA  0                                                        01078000
.CHKHX3  ANOP                                                           01079000
&N       SETA  &N+1                                                     01080000
         AIF   (&N GT &HSL).ALLOK                                       01081000
         AIF   ('&HEXCHS'(&N,1) LT 'A').NOTHC1                          01082000
         AIF   ('&HEXCHS'(&N,1) LT 'G').CHKHX3                          01083000
         AIF   ('&HEXCHS'(&N,1) GT '9').NOTHC1                          01084000
         AIF   ('&HEXCHS'(&N,1) GE '0').CHKHX3                          01085000
.NOTHC1  ANOP                                                           01086000
         AIF   (&N LT 4).BADCF                                          01087000
         AIF   (&N LT 7).BADQF                                          01088000
         AIF   (&N LT 10).BADDF1                                        01089000
         AIF   (&N LT 13).BADDF2                                        01090000
         AIF   (&N LT 16).BADDF3                                        01091000
         AIF   (&N LT 19).BADDF4                                        01092000
         AGO   .BADDF5                                                  01093000
.ALLOK   ANOP                                                           01094000
&CFFLG   SETC  '00'                                                     01095000
         AIF   ('&RCTMODE' EQ 'CONV').CONVT                             01096000
         AIF   ('&RCTMODE' EQ 'PSEUDO').PSEUDOT                         01097000
         MNOTE 4,'RCTMODE KEYWORD MISSING OR INVALID, RCTMODE=PSEUDO AS*01098000
               SUMED'                                                   01099000
.PSEUDOT ANOP                                                           01100000
&CFFLG   SETC  '80'                                                     01101000
.CONVT   ANOP                                                           01102000
&VRA     SETC  '01C'                                                    01103000
         AIF   (T'&VRADDR EQ 'O').BADVRA                                01104000
         AIF   (K'&VRADDR NE 3).BADVRA                                  01105000
&N       SETA  0                                                        01106000
.CHKHX4  ANOP                                                           01107000
&N       SETA  &N+1                                                     01108000
         AIF   (&N GT 3).VRAOK                                          01109000
         AIF   ('&VRADDR'(&N,1) LT 'A').BADVRA                          01110000
         AIF   ('&VRADDR'(&N,1) LT 'G').CHKHX4                          01111000
         AIF   ('&VRADDR'(&N,1) GT '9').BADVRA                          01112000
         AIF   ('&VRADDR'(&N,1) GE '0').CHKHX4                          01113000
.BADVRA  ANOP                                                           01114000
         MNOTE 4,'VRADDR KEYWORD MISSING OR INVALID, VRADDR=01C ASSUMED*01115000
               '                                                        01116000
         AGO   .CHKINT1                                                 01117000
.VRAOK   ANOP                                                           01118000
&VRA     SETC  '&VRADDR'                                                01119000
.CHKINT1 ANOP                                                           01120000
         AIF   (T'&RCTINTV EQ 'O').BADINT                               01121000
         AIF   (K'&RCTINTV NE 4).BADINT                                 01122000
&N       SETA  0                                                        01123000
.CHKDC2  ANOP                                                           01124000
&N       SETA  &N+1                                                     01125000
         AIF   (&N GT 4).CHKINT2                                        01126000
         AIF   ('&RCTINTV'(&N,1) GT '9').BADINT                         01127000
         AIF   ('&RCTINTV'(&N,1) GE '0').CHKDC2                         01128000
.CHKINT2 ANOP                                                           01129000
         AIF   ('&RCTINTV'(1,2) GT '59').BADINT                         01130000
         AIF   ('&RCTINTV'(3,2) GT '59').BADINT                         01131000
&INTRVL  SETC  '&RCTINTV'                                               01132000
         AGO   .INTOK                                                   01133000
.BADINT  ANOP                                                           01134000
&INTRVL  SETC  '0030'                                                   01135000
         MNOTE 4,'RCTINTV KEYWORD MISSING OR INVALID, RCTINTV=0030 ASSU*01136000
               MED'                                                     01137000
.INTOK   ANOP                                                           01138000
         AIF   (T'&JSEP EQ 'O').BADJS                                   01139000
         AIF   (K'&JSEP NE 1).BADJS                                     01140000
         AIF   ('&JSEP' GT '9').BADJS                                   01141000
         AIF   ('&JSEP' LT '0').BADJS                                   01142000
&JS      SETC  '&JSEP'                                                  01143000
         AGO   .JSOK                                                    01144000
.BADJS   ANOP                                                           01145000
&JS      SETC  '0'                                                      01146000
         MNOTE 4,'JSEP KEYWORD MISSING OR INVALID, JSEP=0 ASSUMED'      01147000
.JSOK    ANOP                                                           01148000
         DC    CL8'&VMUSRID'                                            01149000
         DC    XL8'00'                                                  01150000
         DC    XL2'00',XL2'&PQFA2',CL8' '                               01151000
         DC    XL2'00',XL2'&PDF1A2',CL8' '                              01152000
         DC    XL2'00',XL2'&PDF2A2',CL8' '                              01153000
         DC    XL2'00',XL2'&PDF3A2',CL8' '                              01154000
         DC    XL2'00',XL2'&PDF4A2',CL8' '                              01155000
         DC    XL2'00',XL2'&PDF5A2',CL8' '                              01156000
         DC    XL2'00',XL2'&RCFA2',CL8' '                               01157000
         DC    X'&CFFLG'                                                01158000
         DC    X'00'                                                    01159000
         DC    CL44&RCFFID                                              01160000
         DC    XL2'&VRA'                                                01161000
         DC    PL4'&INTRVL'                                             01162000
         DC    CL1'&JS'                                                 01163000
         MEND                                                           01164000
