         MACRO                                                          00001000
&NAME    CASORT  &PHASE=, NAME FOR CA-SORT                             -00002000
               &MODEL=,   CPU MODEL CODE (30/....)                     -00003000
               &OPT=,     OPTIMIZATION DEFAULT (E/D)                   -00004000
               &MSG=,     (LST/LOG/BOTH)                               -00005000
               &DYNAMD=,  CA-DYNAMD INTERFACE (NO/YES)                 -00006000
               &DYNAMFI=, CA-DYNAMFI INTERFACE (NO/50/42)              -00007000
               &DYNALOC=, DYNAMIC SORTWK ALLOCATION (NO/VOLSER,N) NEW  -00008000
               &RC=,      SET RETURN CODE AT EOJ VSE/SP (NO/YES)  NEW  -00009000
               &PFIX=,    PAGE FIXING (YES/NO)                         -00010000
               &OPSYS=,   OPERATING SYSTEM (VSE/VSE/DOSMVT)            -00011000
               &DEFDTF=,  DEFAULT DTF TYPES FOR SORTIN/SORTOUT         -00012000
               &PREOPEN=, PRE-OPEN OF SORTIN FILES                     -00013000
               &DISK=,    ELIGIBLE SORTWK DISK DEVICES                 -00014000
               &VCM=,     VCMA ALGORITHYM DETERMINATION                -00015000
               &EQUALS=,  EQUALS (YES/NO)                              -00016000
               &STORAGE=, MAX STORAGE FOR CA-SORT TO USE (NNNNK)       -00017000
               &RESERVE=, MIN GETVIS AREA RESERVED (NNNNK)      V73N001-00018000
               &CHECK=,   RECORD COUNT CHECKING WITH E35 EXITS         -00019000
               &WKASN=,   WKASN DEFAULT (ON/OFF) DEFAULT OFF           -00020000
               &WKXTNTS=, MAX WORKFILE EXTENTS - DEFAULT 25            -00020500
               &SPECIAL=, LIST OF SPECIAL PTFS TO BE APPLIED   V73N016 -00021000
               &JCLPRNT=,  PRINT FOR JCL INITIATED SORTS       V73N016 -00022000
               &INVPRNT=,  PRINT FOR PROGRAM INVOKED SORTS     V73N016 -00023000
               &INVCNCL=, CANCEL ON ERROR FOR INVOKED SORTS?   V73N016 -00024000
               &CHALT=,   INTERPRET 'CH' AS 'AQ'               V73N023 -00025000
               &ALTSEQ=,  ALTERNATE SEQUENCE TABLE             V73N023 -00026000
               &Y2PAST=,   SLIDING CENTURY WINDOW 80 YEARS             -00026500
               &DSPSIZE=, DATA SPACE SIZE                              -00026600
               &GVSIZE=,  GVSIZE                                       -00026700
               &GVRLOW=,  GVRLOW                                       -00026800
               &GVRANY=,  GVRANY                                       -00026900
               &EXPAND=                                                 00027000
.* ===========================================================          00028000
.*                                                                      00029000
.* IF YOU CHANGE THIS MACRO, PLEASE LOOK FOR CHANGES IN                 00030000
.* PPACELLS AND IN CASMCHEK.                                            00031000
.*                                                                      00032000
.* ===========================================================          00033000
.*                                                                      00034000
.* CA-SORT INSTALLATION TAILORING MACRO.                                00035000
.* COPYRIGHT (C) 1986                                          V72N400  00036000
.* BY COMPUTER ASSOCIATES INTERNATIONAL, INC.                           00037000
.* THIS MACRO ALLOWS THE CA-SORT USER TO GENERATE A CA-SORT ROOT PHASE  00038000
.* WITH USER-SPECIFIED DEFAULT OPTIONS.                                 00039000
.*                                                                      00040000
.* SAMPLE GENERATION-                                                   00041000
.*       // JOB CASORT GENERATION                                       00042000
.*       // OPTION CATAL                                                00043000
.*       // EXEC ASSEMBLY                                               00044000
.*             CASORT  PHASE=SORT,  PHASENAME IS SORT                 - 00045000
.*                   MODEL=148,     MODEL IS 148                      - 00046000
.*                   MSG=BOTH,      ROUTE MESSAGES TO SYSLOG AND LST  - 00047000
.*                   DYNAMD=YES,    CA-DYNAM/D IS INSTALLED ON SYSTEM - 00048000
.*                   OPSYS=VSE      DOS/VSE OPERATING SYSTEM   V72N499  00049000
.*             END   ,                                                  00050000
.*       /*                                                             00051000
.*       // EXEC LNKEDT                                                 00052000
.*       /&                                                             00053000
.*                                                                      00054000
.* NOTE- OWING TO THE ELISION OF SOME SYMBOLIC PARAMETERS, REDUNDANT    00055000
.* CODE MAY BE FOUND IN THE FOLLOWING MACRO DEFINITION.                 00056000
.*                                                                      00057000
.* DEFINE LCLCS FOR VERSION AND MOD LEVEL ETC ETC                       00058000
         LCLC  &VER,&MOD     VERSION AND MOD. LEVEL                     00059000
         LCLC  &VM            VERSION.MOD (3 CHARS ONLY E.G. 5.4)       00060000
         LCLC  &Q            VER AND MOD E.G.54                         00061000
         LCLC  &ID           CSECT IDENTIFICATION                       00062000
         LCLC  &FICSECT      CSECT NAME                                 00063000
.* DEFINE LCLCS TO BE SET TO FINAL GENERATION PARAMETERS                00064000
         LCLC  &PHASEP,&MODELP,&OPTP,&MSGP,&JCLPP,&INVPP       V73N017  00065000
         LCLC  &DYNAMDP,&PFIXP,&OPSYSP,&STORAGP,&RCP           V72SPRC  00066000
         LCLC  &RESERVP                                        V73N001  00067000
         LCLC  &SPEC                                           V73N016  00068000
         LCLC  &INVCNP                                         V73N017  00069000
         LCLA  &SP,&SPTF,&AA,&AB,&AC                           V73N023  00070000
         LCLB  &SPECR,&CHALTR,&CHALN,&ALTSN,&ALTR              V73N023  00071000
         LCLB  &INVCNR,&JCLPCTL,&JCLPNON,&INVPALL,&INVPNON     V73N017  00072000
         LCLC  &DEFDTFP,&DISKP,&VCMP,&EQUALSP,&CA,&Y2          V82M002  00073490
         LCLC  &PREOPP,&CHECKP,&EXPP,&CHALTP                   V73N023  00074000
         LCLC  &SMCLT        MVC TIME  * TIMINGS DERIVED                00075000
         LCLC  &SBYTM        BYT       * FROM                           00076000
         LCLC  &SLSTM        L/S       * MODEL                          00077000
         LCLC  &CPU          CPU MODEL E.G. 30 40 50 125 158            00078000
         LCLC  &VSTORE       NNNN OF STORAGE=NNNNK                      00079000
         LCLC  &VRESER       NNNN OF RESERVE=NNNNK             V73N001  00080000
.* DEFINE LCLA  USED TO GENERATE DEFAULT DTF TYPE                       00081000
         LCLA  &DTFTYP            SORTIN/SORTOUT DEFAULT DTF TYPE       00082000
         LCLA  &PREOPA            PRE-OPEN SWITCH                       00083000
         LCLA  &INVCNA            CANCEL INVOKED SORT SWITCH   V73N017  00084000
.* DEFILE LCLS FOR WKASN PARAMETER                             V70N261  00085000
         LCLC  &WKASNP            PARAMETER IN EFFECT          V70N261  00086000
         LCLB  &WKASNB            BIT SWTICH IN PPA            V70N261  00087000
.* DEFINE LCLS USED IN DISK SORTWK DEVICE GENERATION                    00088000
         LCLA  &DISKA                                                   00089000
         LCLA  &DISKA1                                                  00090000
         LCLA  &DISKA2                                                  00091000
         LCLB  &DISKB(11)                                               00092000
         LCLC  &DISKC(10)                                               00093000
.* DEFINE LCLS  USED IN CHECKING &STORAGE AND &RESERVE          V73N001 00094000
         LCLC  &D1           DIGITS 01234                               00095000
         LCLC  &D2           DIGITS 56789                               00096000
         LCLA  &D            INDEX THRU STRINGS OF VALID DECIMAL DIGITS 00097000
         LCLA  &C            INDEX THRU NNNN OF NNNNK                   00098000
         LCLA  &STORAGA       NNNN OF NNNNK IN CROSS-CHECKING           00099000
         LCLA  &RESERVA       NNNN OF NNNNK IN CROSS-CHECKING   V73N001 00100000
.* DEFINE LCLBS SET TO INDICATE AN ERROR IN A PARAMETER                 00101000
         LCLB  &MODELR,&OPTR,&MSGR,&JCLPR,&INVPR               V73N017  00102000
         LCLB  &DYNAMDR,&PFIXR,&OPSYSR,&STORAGR,&RCR           V72SPRC  00103000
         LCLB  &RESERVR                                        V73N001  00104000
         LCLB  &DEFDTFR,&DISKR,&EQUALSR,&WKASNPR               V70N261  00105000
         LCLB  &PREOPR,&VCMR,&CHECKR                                    00106000
         LCLB  &CAT          SET 1 FOR A CATASTROPHIC ERROR             00107000
.* DEFINE LCLBS CORRESPONDING TO BIT SWITCHES                           00108000
         LCLB  &S70          S/370                                      00109000
         LCLB  &RMP          RUN MESSAGES TO SYSLST                     00110000
         LCLB  &RML          RUN MESSAGES TO SYSLOG                     00111000
         LCLB  &OPD          ELAPSED TIME OPTIMISATION (OPT=D)          00112000
         LCLB  &MVT          DOS/MVT SYSTEM                             00113000
         LCLB  &CHKEQNO      CHECK=NO                                   00114000
         LCLB  &PFX          PAGE FIXING                                00115000
         LCLB  &DYN          DYNAM/D INTERFACE ACTIVE                   00116000
         LCLB  &SPRC         RC=YES                            V72SPRC  00117000
         LCLB  &INVCN        CANCEL ON ERROR FOR INVOKED SORTS V73N017  00118000
.* DEFINE LOCALS FOR VCM PARAMATER                                      00119000
         LCLB  &VCMNA                                                   00120000
         LCLB  &VCMLIMT                                                 00121000
         LCLB  &EQA                                                     00122000
.* DEFINE OTHER LCLBS CORRESPONDING TO PARAMETERS                       00123000
         LCLB  &M25,&M30,&M40,&M50,&M65                                 00124000
         LCLB  &M115,&M125,&M135,&M138,&M145,&M148,&M155,&M158,&M168    00125000
         LCLB  &M3031,&M3032,&M3033,&M4331,&M4341                       00126000
         LCLB  &M3080,&M3090,&M4361,&M4381,&M9370,&M9000       V73N001  00127000
         LCLB  &PHAB         PUNCH A PHASE STMT                         00128000
.* DEFINE LCLS FOR DYNAMFI PARAMATER                                    00129000
         LCLB  &DFI          DYNAM/FI REL 5.0 SWITCH           V72CDYN  00130000
         LCLB  &DYNFIR       DYNAM/FI ERROR SWITCH                      00131000
         LCLC  &DYNFIP                                                  00132000
.* DEFINE LCLS FOR DYNALOC PARAMATER                           V72N499  00133000
         LCLA  &WKNO                                           V72N499  00134000
         LCLB  &DYNALC,&DYNALCR                                V72N499  00135000
         LCLC  &VOLSER,&DYNALCP                                V72N499  00136000
.* DEFILE LCLS FOR WKXTNTS PARAMETER                           V81M008  00136200
         LCLA  &XTNTS                                          V81M008  00136400
         LCLB  &XTNTR                                          V81M008  00136600
.* SET VARIOUS LCLCS                                                    00137000
         LCLC  &DSP                                            V90M001  00138490
&VER     SETC  '9'           VERSION                           V90M001  00138980
&MOD     SETC  '0'           MODIFICATION LEVEL                V90M001  00139470
&VM      SETC  '&VER..&MOD'(1,3)  V.M                                   00140000
&Q       SETC  '&VER&MOD'(1,2)    VM                                    00141000
.* &Q       SETC  'BT'                                                  00142000
&ID      SETC  'A000'        CSECT ID                                   00143000
&FICSECT SETC 'CA&Q&ID'      CSECT NAME                                 00144000
&EXPP    SETC  'NO'                                                     00145000
.* NOW CHECK THE PARAMETERS                                             00146000
.* CHECK PHASE=                                                         00147000
&PHASEP  SETC  'CA&Q.SORT'   DEFAULT                                    00148000
&PHAB    SETB  1             ALWAYS PUNCH A PHASE STMT         V70N262  00149000
         AIF   (T'&PHASE EQ 'O').PHASEND IF OMITTED TAKE DEFAULT        00150000
&PHASEP  SETC  '&PHASE'                                                 00151000
.PHASEND ANOP  ,                                                        00152000
.* CHECK MODEL=                                                         00153000
&CPU     SETC  '4331'        DEFAULT                                    00154000
&MODELP  SETC  '&CPU'        GENERATION PARAMETER                       00155000
         AIF   (T'&MODEL EQ 'O').MODOK IF OMITTED, TAKE DEFAULT         00156000
.* ALLOW FOR, BUT IGNORE MACHINE SPECIFICATION 'A' OR 'B'               00157000
.*       SET &CPU IF MODEL DEFAULT NOT TAKEN                            00158000
.*             BUT FIRST THE KOUNT MUST BE KORREKT                      00159000
         AIF   (K'&MODEL LT 2 OR  K'&MODEL GT 5).MODERR ERROR           00160000
&MODELP  SETC  '&MODEL'                                                 00161000
&CPU     SETC  '&MODELP'                                                00162000
.* IF 'A' OR 'B' MACHINE SPECIFIED, ALLOW IT, BUT IGNORE 'A' OR 'B'     00163000
         AIF   ('&MODELP'(K'&MODEL,1) EQ 'A').SETCPU                    00164000
         AIF   ('&MODELP'(K'&MODEL,1) EQ 'B').SETCPU                    00165000
         AGO   .MODOK        &CPU ALREADY SET                           00166000
.SETCPU  ANOP  ,             'A' OR 'B' SPECIFIED                       00167000
&CPU     SETC  '&MODELP'(1,(K'&MODEL-1)) CPU MODEL E.G. 30 40 155       00168000
&MODELP  SETC  '&CPU'        GENERATION PARAMETER                       00169000
.MODOK   ANOP  ,                                                        00170000
.*       CHECK CPU                                                      00171000
&M25     SETB  ('&CPU' EQ '25')                                         00172000
&M30     SETB  ('&CPU' EQ '30')                                         00173000
&M40     SETB  ('&CPU' EQ '40')                                         00174000
&M50     SETB  ('&CPU' EQ '50')                                         00175000
&M65     SETB  ('&CPU' EQ '65')                                         00176000
&M115    SETB  ('&CPU' EQ '115')                                        00177000
&M125    SETB  ('&CPU' EQ '125')                                        00178000
&M135    SETB  ('&CPU' EQ '135')                                        00179000
&M138    SETB  ('&CPU' EQ '138')                                        00180000
&M145    SETB  ('&CPU' EQ '145')                                        00181000
&M148    SETB  ('&CPU' EQ '148')                                        00182000
&M155    SETB  ('&CPU' EQ '155')                                        00183000
&M158    SETB  ('&CPU' EQ '158')                                        00184000
&M168    SETB  ('&CPU' EQ '168')                                        00185000
&M3031   SETB  ('&CPU' EQ '3031')                                       00186000
&M3032   SETB  ('&CPU' EQ '3032')                                       00187000
&M3033   SETB  ('&CPU' EQ '3033')                                       00188000
&M3080   SETB  ('&CPU' EQ '3080')                               V73N001 00189000
&M3090   SETB  ('&CPU' EQ '3090')                               V73N001 00190000
&M9000   SETB  ('&CPU' EQ '9000')                               V73N001 00191000
&M4331   SETB  ('&CPU' EQ '4331')                                       00192000
&M4341   SETB  ('&CPU' EQ '4341')                                       00193000
&M4361   SETB  ('&CPU' EQ '4361')                               V73N001 00194000
&M4381   SETB  ('&CPU' EQ '4381')                               V73N001 00195000
&M9370   SETB  ('&CPU' EQ '9370')                               V73N001 00196000
.*                                                                      00197000
.*       SET SPEEDS FOR EACH MODEL                                      00198000
&SMCLT   SETC  '166'                                                    00199000
&SBYTM   SETC  '40'                                                     00200000
&SLSTM   SETC  '255'                                                    00201000
         AIF   (&M25).CHECKA                                            00202000
&SMCLT   SETC  '165'                                            V73N014 00203000
&SBYTM   SETC  '38'                                             V73N014 00204000
&SLSTM   SETC  '253'                                            V73N014 00205000
         AIF   (&M30).CHECKA                                            00206000
&SMCLT   SETC  '64'                                                     00207000
&SBYTM   SETC  '21'                                                     00208000
&SLSTM   SETC  '95'                                                     00209000
         AIF   (&M40).CHECKA                                            00210000
&SMCLT   SETC  '43'                                                     00211000
&SBYTM   SETC  '8'                                                      00212000
&SLSTM   SETC  '32'                                                     00213000
         AIF   (&M50).CHECKA                                            00214000
&SMCLT   SETC  '22'                                                     00215000
&SBYTM   SETC  '6'                                                      00216000
&SLSTM   SETC  '21'                                                     00217000
         AIF   (&M65).CHECKAB                                           00218000
&SMCLT   SETC  '96'                                                     00219000
&SBYTM   SETC  '12'                                                     00220000
&SLSTM   SETC  '92'                                                     00221000
         AIF   (&M115).CHECKA                                           00222000
&SMCLT   SETC  '38'                                                     00223000
&SBYTM   SETC  '12'                                                     00224000
&SLSTM   SETC  '65'                                                     00225000
         AIF   (&M125).CHECKA                                           00226000
&SMCLT   SETC  '26'                                                     00227000
&SBYTM   SETC  '12'                                                     00228000
&SLSTM   SETC  '32'                                                     00229000
         AIF   (&M135).CHECKA                                           00230000
&SMCLT   SETC  '24'                                             V73N014 00231000
&SBYTM   SETC  '11'                                             V73N014 00232000
&SLSTM   SETC  '28'                                             V73N014 00233000
         AIF   (&M138).CHECKA                                           00234000
&SMCLT   SETC  '17'                                                     00235000
&SBYTM   SETC  '9'                                                      00236000
&SLSTM   SETC  '23'                                                     00237000
         AIF   (&M145).CHECKA                                           00238000
&SMCLT   SETC  '15'                                             V73N014 00239000
&SBYTM   SETC  '7'                                              V73N014 00240000
&SLSTM   SETC  '18'                                             V73N014 00241000
         AIF   (&M148).CHECKA                                           00242000
&SMCLT   SETC  '13'                                             V73N014 00243000
&SBYTM   SETC  '5'                                              V73N014 00244000
&SLSTM   SETC  '12'                                             V73N014 00245000
         AIF   (&M4331).CHECKA                                          00246000
&SMCLT   SETC  '8'                                                      00247000
&SBYTM   SETC  '3'                                                      00248000
&SLSTM   SETC  '8'                                                      00249000
         AIF   (&M155).CHECKAB                                          00250000
&SMCLT   SETC  '12'                                             V73N014 00251000
&SBYTM   SETC  '4'                                              V73N014 00252000
&SLSTM   SETC  '10'                                             V73N014 00253000
         AIF   (&M158).CHECKA                                           00254000
&SMCLT   SETC  '11'                                             V73N014 00255000
&SBYTM   SETC  '4'                                              V73N014 00256000
&SLSTM   SETC  '9'                                              V73N014 00257000
         AIF   (&M168).CHECKA                                           00258000
&SMCLT   SETC  '10'                                             V73N014 00259000
&SBYTM   SETC  '3'                                              V73N014 00260000
&SLSTM   SETC  '8'                                              V73N014 00261000
         AIF   (&M3031).CHECKA                                          00262000
&SMCLT   SETC  '9'                                              V73N014 00263000
&SBYTM   SETC  '3'                                              V73N014 00264000
&SLSTM   SETC  '7'                                              V73N014 00265000
         AIF   (&M3032).CHECKA                                          00266000
&SMCLT   SETC  '8'                                              V73N014 00267000
&SBYTM   SETC  '3'                                              V73N014 00268000
&SLSTM   SETC  '7'                                              V73N014 00269000
         AIF   (&M3033).CHECKA                                          00270000
&SMCLT   SETC  '7'                                              V73N014 00271000
&SBYTM   SETC  '3'                                              V73N014 00272000
&SLSTM   SETC  '6'                                              V73N014 00273000
         AIF   (&M4341).CHECKA                                          00274000
&SMCLT   SETC  '6'                                              V73N014 00275000
&SBYTM   SETC  '3'                                              V73N014 00276000
&SLSTM   SETC  '5'                                              V73N014 00277000
         AIF   (&M4361).CHECKA                                          00278000
&SMCLT   SETC  '5'                                              V73N014 00279000
&SBYTM   SETC  '2'                                              V73N014 00280000
&SLSTM   SETC  '5'                                              V73N014 00281000
         AIF   (&M4381).CHECKA                                          00282000
&SMCLT   SETC  '5'                                              V73N014 00283000
&SBYTM   SETC  '2'                                              V73N014 00284000
&SLSTM   SETC  '4'                                              V73N014 00285000
         AIF   (&M9370).CHECKA                                          00286000
&SMCLT   SETC  '4'                                              V73N014 00287000
&SBYTM   SETC  '2'                                              V73N014 00288000
&SLSTM   SETC  '5'                                              V73N014 00289000
         AIF   (&M3080).CHECKA                                          00290000
&SMCLT   SETC  '4'                                              V73N014 00291000
&SBYTM   SETC  '2'                                              V73N014 00292000
&SLSTM   SETC  '4'                                              V73N014 00293000
         AIF   (&M3090).CHECKA                                          00294000
&SMCLT   SETC  '4'                                              V73N014 00295000
&SBYTM   SETC  '2'                                              V73N014 00296000
&SLSTM   SETC  '4'                                              V73N014 00297000
         AIF   (&M9000).CHECKA                                          00298000
         AGO    .MODERR           UNDEFINED MODEL TYPE                  00299000
.CHECKAB ANOP  ,              THIS MACHINE CAN BE 'A' OR 'B'            00300000
.CHECKA  ANOP  ,             THIS MACHINE MUST BE AN 'A'                00301000
.MACHOK  ANOP  ,             &MACH IS OK                                00302000
         AGO   .MODELND      ALL OK                                     00303000
.MODERR  ANOP  ,             MODEL PARAMETER IS IN ERROR                00304000
         MNOTE ' ''MODEL=&MODEL'' IS INVALID. SPECIFY ''25'',''30'',   -00305000
               ''40'',''50'',''65'','                                   00306000
         MNOTE '''115'',''125'',''135'',''138'',''145'',''148'',       -00307000
               ''155'',''158'',''168'',''9000'','                       00308000
         MNOTE '''3031'',''3032'',''3033'',''4331'',''4341'','  V73N001 00309000
         MNOTE '''4361'',''4381'',''3080'',''3090'',''9370''.'  V73N001 00310000
&MODELR  SETB  1             PARAMETER ERROR                            00311000
&CAT     SETB  1             CATASTROPHIC                               00312000
.MODELND ANOP  ,                                                        00313000
.* CHECK OPT=                                                           00314000
&OPTP    SETC  'E'           DEFAULT                                    00315000
         AIF   (T'&OPT EQ 'O').OPTOK IF OMITTED, TAKE DEFAULT           00316000
         AIF   (K'&OPT NE 1).OPTERR                                     00317000
&OPTP    SETC  '&OPT'                                                   00318000
.OPTOK   ANOP  ,                                                        00319000
&OPD     SETB  ('&OPTP' EQ 'D')                                         00320000
         AIF   ('&OPTP' EQ 'D' OR  '&OPTP' EQ 'E').OPTND  INVALID       00321000
.OPTERR  MNOTE ' ''OPT=&OPT'' IS INVALID. SPECIFY ''D'' OR ''E''.'      00322000
&OPTR    SETB  1             PARAMETER ERROR                            00323000
&CAT     SETB  1             CATASTROPHIC                               00324000
.OPTND   ANOP  ,                                                        00325000
.* CHECK MSG=                                                           00326000
&MSGP    SETC  'LST'         DEFAULT                                    00327000
         AIF   (T'&MSG EQ 'O').MSGOK                                    00328000
         AIF   (K'&MSG LT 3 OR K'&MSG GT 4).MSGERR                      00329000
&MSGP    SETC  '&MSG'                                                   00330000
.MSGOK   ANOP  ,                                                        00331000
&RMP     SETB  ('&MSGP' EQ 'LST' OR '&MSGP' EQ 'BOTH')                  00332000
&RML     SETB  ('&MSGP' EQ 'LOG' OR '&MSGP' EQ 'BOTH')                  00333000
         AIF   ('&MSGP' EQ 'LST' OR '&MSGP' EQ 'LOG' OR                -00334000
                '&MSGP' EQ 'BOTH').MSGND                                00335000
.MSGERR  MNOTE ' ''MSG=&MSG'' IS INVALID. SPECIFY ''LST'',''LOG'' OR ''-00336000
               BOTH''.'                                                 00337000
&MSGR    SETB  1             PARAMETER ERROR                            00338000
&CAT     SETB  1             CATASTROPHIC                               00339000
.MSGND   ANOP  ,                                                        00340000
.* CHECK JCLPRNT=                                                       00341000
&JCLPP   SETC  'ALL'         DEFAULT                                    00342000
         AIF   (T'&JCLPRNT EQ 'O').JCLPOK                               00343000
&JCLPP   SETC  '&JCLPRNT'                                               00344000
.JCLPOK  ANOP  ,                                                        00345000
&JCLPCTL SETB  ('&JCLPP' EQ 'CRITICAL')                                 00346000
&JCLPNON SETB  ('&JCLPP' EQ 'NONE')                                     00347000
         AIF   ('&JCLPP' EQ 'ALL' OR '&JCLPP' EQ 'NONE' OR             -00348000
                '&JCLPP' EQ 'CRITICAL').JCLPND                          00349000
.JCLPERR MNOTE ' ''JCLPRNT=&JCLPRNT'' IS INVALID. SPECIFY ''ALL'', ''CR-00350000
               ITICAL'', OR ''NONE'' '                                  00351000
&JCLPR   SETB  1             PARAMETER ERROR                            00352000
&CAT     SETB  1             CATASTROPHIC                               00353000
.JCLPND  ANOP  ,                                                        00354000
.* CHECK INVPRNT=                                                       00355000
&INVPP   SETC  'CRITICAL'    DEFAULT                                    00356000
         AIF   (T'&INVPRNT EQ 'O').INVPOK                               00357000
&INVPP   SETC  '&INVPRNT'                                               00358000
.INVPOK  ANOP  ,                                                        00359000
&INVPALL SETB  ('&INVPP' EQ 'ALL')                                      00360000
&INVPNON SETB  ('&INVPP' EQ 'NONE')                                     00361000
         AIF   ('&INVPP' EQ 'ALL' OR '&INVPP' EQ 'NONE' OR             -00362000
                '&INVPP' EQ 'CRITICAL').INVPND                          00363000
.INVPERR MNOTE ' ''INVPRNT=&INVPRNT'' IS INVALID. SPECIFY ''ALL'', ''CR-00364000
               ITICAL'', OR ''NONE'' '                                  00365000
&INVPR   SETB  1             PARAMETER ERROR                            00366000
&CAT     SETB  1             CATASTROPHIC                               00367000
.INVPND  ANOP  ,                                                        00368000
.* CHECK DYNAMD=                                                        00369000
&DYNAMDP SETC  'NO'         DEFAULT                                     00370000
         AIF   (T'&DYNAMD EQ 'O').DYNAMOK                               00371000
         AIF   (K'&DYNAMD LT 2 OR K'&DYNAMD GT 3).DYNAMRR               00372000
&DYNAMDP SETC  '&DYNAMD'                                                00373000
.DYNAMOK ANOP  ,                                                        00374000
&DYN     SETB  ('&DYNAMDP' EQ 'YES')                                    00375000
         AIF   ('&DYNAMDP' EQ 'YES' OR '&DYNAMDP' EQ 'NO').DYNAMND      00376000
.DYNAMRR MNOTE ' ''DYNAMD=&DYNAMD'' IS INVALID. SPECIFY ''YES'' OR ''NO-00377000
               ''.'                                                     00378000
&DYNAMDR SETB  1             PARAMETER ERROR                            00379000
&CAT     SETB  1             CATASTROPHIC                               00380000
.DYNAMND ANOP  ,                                                        00381000
.* CHECK DYNAMFI=                                              V72CDYN  00382000
&DYNFIP  SETC  'NO'         DEFAULT                            V72CDYN  00383000
         AIF   (T'&DYNAMFI EQ 'O').DYNFIOK                     V72CDYN  00384000
         AIF   (K'&DYNAMFI LT 2 OR K'&DYNAMFI GT 3).DYNFIRR    V72CDYN  00385000
&DYNFIP  SETC  '&DYNAMFI'                                      V72CDYN  00386000
.DYNFIOK ANOP  ,                                               V72CDYN  00387000
&DFI     SETB  ('&DYNFIP' EQ 'YES')                            V72CDYN  00388000
         AIF   ('&DYNFIP' EQ 'YES' OR '&DYNFIP' EQ 'NO').DYND  V72CDYN  00389000
.DYNFIRR MNOTE ' ''DYNAMFI=&DYNAMFI'' IS INVALID. SPECIFY ''YES'' OR ''-00390000
               NO''.'                                          V72CDYN  00391000
&DYNFIR  SETB  1             PARAMETER ERROR                   V72CDYN  00392000
&CAT     SETB  1             CATASTROPHIC                      V72CDYN  00393000
.DYND    ANOP  ,                                               V72CDYN  00394000
.* CHECK DYNALOC=                                              V72N499  00395000
&WKNO    SETA  3             DEFAULT 3 WORK FILES              V72CDYN  00396000
&DYNALC  SETB  0             DEFAULT TO DYNALOC=NO             V72N499  00397000
&DYNALCP SETC  'NO'          DEFAULT TO DYNALOC=NO             V72N499  00398000
&VOLSER  SETC  ' '           INITIALIZED TO BLANK              V72CDYN  00399000
         AIF   (T'&DYNALOC EQ 'O' ).ENDIT                      V72SPRC  00400000
         AIF   ('&DYNALOC' EQ 'NO').ENDIT                      V72SPRC  00401000
         AIF   (K'&DYNALOC(1) GT 6).ALLOERR                    V72N499  00402000
&DYNALC  SETB  1                                               V72N499  00403000
&DYNALCP SETC  'YES'                                           V72N499  00404000
&VOLSER  SETC  '&DYNALOC(1)'                                   V72N499  00405000
         AIF   (T'&DYNALOC(2) EQ 'O').ENDIT                    V72SPRC  00406000
.* CHECK VALIDITY OF THE NUMERIC PART                          V72CDYN  00407000
&D1      SETC  '01234'       5 VALID DECIMAL DIGITS            V72CDYN  00408000
&D2      SETC  '56789'       THE NEXT 5 DECIMAL DIGITS         V72CDYN  00409000
&C       SETA  0             INITIALISE INDEX FOR &DYNALOC(2)  V72N499  00410000
.NEXTRX  ANOP  ,             LOOP THRU &DYNAMFI                V72CDYN  00411000
&C       SETA  &C+1          INDEX TO NEXT CHAR OF &DYNALOC(2) V72N499  00412000
         AIF   (&C GT K'&DYNALOC(2)).GOODNBR  ALL VALID        V72N499  00413000
&D       SETA  0             INITIALISE INDEX FOR DIGIT STRINGSV72CDYN  00414000
.NEXTRY  ANOP  ,             LOOP THRU DECIMAL DIGITS          V72CDYN  00415000
&D       SETA  &D+1          INDEX TO NEXT CH OF DECIMAL STRINGV72CDYN  00416000
         AIF   (&D GT 5).ALLOERR INVALID CHAR                  V72CDYN  00417000
         AIF   ('&DYNALOC(2)'(&C,1) EQ '&D1'(&D,1)).NEXTRX     V72N499  00418000
         AIF   ('&DYNALOC(2)'(&C,1) EQ '&D2'(&D,1)).NEXTRX     V72N499  00419000
         AGO   .NEXTRY        TRY NEXT DECIMAL DIGIT           V72CDYN  00420000
.GOODNBR ANOP  ,              GOOD NUMERIC PART                V72CDYN  00421000
.*                                                             V72CDYN  00422000
&WKNO    SETA  &DYNALOC(2)   WORK FILE #                       V72N499  00423000
         AGO   .ENDIT                                          V72SPRC  00424000
.ALLOERR MNOTE ' ''DYNALOC=(&DYNALOC(1),&DYNALOC(2))'' IS INVALID. SPEC-00425000
               IFY DYNALOC=(VVVVVV,N)'                         V72N499  00426000
&DYNALCR SETB  1                                               V72N499  00427000
&CAT     SETB  1                                               V72N499  00428000
.ENDIT   ANOP  ,                                               V72SPRC  00429000
.RCHEK   ANOP  ,                                               V72SPRC  00430000
.* CHECK RC=                                                   V72SPRC  00431000
&RCP     SETC  'YES'        DEFAULT                            V72SPRC  00432000
         AIF   (T'&RC EQ 'O').RCAOK                            V72SPRC  00433000
         AIF   (K'&RC LT 2 OR K'&RC GT 3).RCERR                V72SPRC  00434000
&RCP     SETC  '&RC'                                           V72SPRC  00435000
.RCAOK   ANOP  ,                                               V72SPRC  00436000
&SPRC    SETB  ('&RCP' EQ 'YES')                               GO08162  00437490
         AIF   ('&RCP' EQ 'YES' OR '&RCP' EQ 'NO').RCEND       V72SPRC  00438000
.RCERR   MNOTE ' ''RC=&RC'' IS INVALID SPECIFY ''YES'' OR ''NO''.'      00439000
&RCR     SETB  1             PARAMETER ERROR                   V72SPRC  00440000
&CAT     SETB  1             CATASTROPHIC                      V72SPRC  00441000
.RCEND   ANOP  ,                                               V72SPRC  00442000
.* CHECK PFIX=                                                          00443000
&PFIXP   SETC  'YES'         DEFAULT                                    00444000
         AIF   (T'&PFIX EQ 'O').PFIXOK                                  00445000
         AIF   (K'&PFIX LT 2 OR K'&PFIX GT 3).PFIXERR                   00446000
&PFIXP   SETC  '&PFIX'                                                  00447000
.PFIXOK  ANOP  ,                                                        00448000
&PFX     SETB  ('&PFIXP' EQ 'YES')                                      00449000
         AIF   ('&PFIXP' EQ 'YES' OR '&PFIXP' EQ 'NO').PFIXND           00450000
.PFIXERR MNOTE ' ''PFIX=&PFIX'' IS INVALID. SPECIFY ''YES'' OR ''NO''.' 00451000
&PFIXR   SETB  1             PARAMETER ERROR                            00452000
&CAT     SETB  1             CATASTROPHIC                               00453000
.PFIXND  ANOP  ,                                                        00454000
.* CHECK OPSYS=                                                         00455000
&OPSYSP  SETC  'VSE'      DEFAULT                                       00456000
         AIF   (T'&OPSYS EQ 'O').OPSYSOK                                00457000
         AIF   (K'&OPSYS LT 3 OR K'&OPSYS GT 6).OPSERR                  00458000
&OPSYSP  SETC  '&OPSYS'                                                 00459000
.OPSYSOK ANOP  ,                                                        00460000
&MVT     SETB  ('&OPSYSP' EQ 'MVT')                                     00461000
         AIF   ('&OPSYSP' EQ 'VSE' OR                                  -00462000
               '&OPSYSP' EQ 'DOSVSE' OR '&OPSYSP' EQ 'MVT').OPSND       00463000
.OPSERR  MNOTE ' ''OPSYS=&OPSYS'' IS INVALID. SPECIFY ''VSE'',''DOSVSE -00464000
               '' OR ''MVT''.'                                          00465000
&OPSYSR  SETB  1             PARAMETER ERROR                            00466000
&CAT     SETB  1             CATASTROPHIC ERROR                         00467000
.OPSND   ANOP  ,                                                        00468000
.* CHECK DEFDTF=                                                        00469000
&DEFDTFP SETC  'CANCEL'      DEFAULT                                    00470000
         AIF   (T'&DEFDTF EQ 'O').DTFOK IF OMITTED, TAKE DEFAULT        00471000
         AIF   (K'&DEFDTF GT 6).DTFERR                                  00472000
&DEFDTFP SETC  '&DEFDTF'                                                00473000
.DTFOK   ANOP  ,                                                        00474000
         AIF   ('&DEFDTFP' NE 'CANCEL').DTFOK1                          00475000
&DTFTYP  SETA  127           CANCEL X'7F'                               00476000
         AGO   .DTFND        DONE                                       00477000
.DTFOK1  AIF   ('&DEFDTFP' NE 'TAPE').DTFOK2                            00478000
&DTFTYP  SETA  0             TAPE X'00'                                 00479000
         AGO   .DTFND        DONE                                       00480000
.DTFOK2  AIF   ('&DEFDTFP' NE 'DISK').DTFOK3                            00481000
&DTFTYP  SETA  32            DISK 3380 TYPE X'20'           V74N307     00482000
         AGO   .DTFND        DONE                                       00483000
.DTFOK3  AIF   ('&DEFDTFP' NE 'FBA').DTFOK4                             00484000
&DTFTYP  SETA  40            FBA SAM X'28'                  V74N307     00485000
         AGO   .DTFND        DONE                                       00486000
.DTFOK4  ANOP  ,                                                        00487000
.DTFERR  MNOTE ' ''DEFDTF=&DEFDTF'' IS INVALID. SPECIFY ''TAPE'', ''DIS-00488000
               K'', ''FBA'' OR ''CANCEL''.'                             00489000
&DEFDTFR SETB  1             PARAMETER ERROR                            00490000
&CAT     SETB  1             CATASTROPHIC                               00491000
.DTFND   ANOP  ,                                                        00492000
.* CHECK PREOPEN=                                                       00493000
&PREOPP  SETC  'NO'         DEFAULT                                     00494000
         AIF   (T'&PREOPEN EQ 'O').PREOK IF OMITTED, TAKE DEFAULT       00495000
         AIF   (K'&PREOPEN GT 3).PREERR                                 00496000
&PREOPP  SETC  '&PREOPEN'                                               00497000
.PREOK   ANOP  ,                                                        00498000
         AIF   ('&PREOPP' NE 'NO').PREOK1                               00499000
&PREOPA  SETA  128           SET FOR DO NOT OPEN X'80'                  00500000
         AGO   .PREND        DONE                                       00501000
.PREOK1  AIF   ('&PREOPP' NE 'YES').PREOK2                              00502000
&PREOPA  SETA  0             SET FOR PRE OPEN X'00'                     00503000
         AGO   .PREND        DONE                                       00504000
.PREOK2  ANOP  ,                                                        00505000
.PREERR  MNOTE ' ''PREOPEN=&PREOPEN'' IS INVALID. SPECIFY ''YES'' OR ''X00506000
               NO''.'                                                   00507000
&PREOPR  SETB  1             PARAMETER ERROR                            00508000
&CAT     SETB  1             CATASTROPHIC                               00509000
.PREND   ANOP  ,                                                        00510000
.* CHECK INVCNCL=                                                       00511000
&INVCNP  SETC  'NO'         DEFAULT                                     00512000
         AIF   (T'&INVCNCL EQ 'O').INVOK IF OMITTED, TAKE DEFAULT       00513000
         AIF   (K'&INVCNCL GT 3).INVERR                                 00514000
&INVCNP  SETC  '&INVCNCL'                                               00515000
.INVOK   ANOP  ,                                                        00516000
         AIF   ('&INVCNP' NE 'NO').INVOK1                               00517000
&INVCNA  SETA  2             SET FOR CANCEL INVOKED SORT X'02'          00518000
         AGO   .INVEND       DONE                                       00519000
.INVOK1  AIF   ('&INVCNP' NE 'YES').INVOK2                              00520000
&INVCNA  SETA  0             SET FOR CANCEL INVOKED SORT X'00'          00521000
         AGO   .INVEND       DONE                                       00522000
.INVOK2  ANOP  ,                                                        00523000
.INVERR  MNOTE ' ''INVCNCL=&INVCNCL'' IS INVALID. SPECIFY ''YES'' OR ''X00524000
               NO''.'                                                   00525000
&INVCNR  SETB  1             PARAMETER ERROR                            00526000
&CAT     SETB  1             CATASTROPHIC                               00527000
.INVEND  ANOP  ,                                                        00528000
&INVCN   SETB  ('&INVCNP' EQ 'YES')                                     00529000
.* CHECK CHALT=                                                         00530000
&CHALTP  SETC  'NO'         DEFAULT                                     00531000
         AIF   (T'&CHALT EQ 'O').CHAOK IF OMITTED, TAKE DEFAULT         00532000
         AIF   (K'&CHALT GT 3).CHAERR                                   00533000
&CHALTP  SETC  '&CHALT'                                                 00534000
.CHAOK   AIF   (('&CHALTP' EQ 'NO') OR ('&CHALTP' EQ 'YES')).CHAEND     00535000
.CHAERR  MNOTE ' ''CHALT=&CHALT'' IS INVALID. SPECIFY ''YES'' OR ''NO''X00536000
               .'                                                       00537000
&CHALTR  SETB  1             PARAMETER ERROR                            00538000
&CAT     SETB  1             CATASTROPHIC                               00539000
.CHAEND  ANOP  ,                                                        00540000
&CHALN   SETB  ('&CHALTP' EQ 'YES')                                     00541000
.* CHECK WKASN PARAMETER                                       V70N261  00542000
&WKASNP  SETC  'OFF'                   SET DEFAULT             V70N261  00543000
&WKASNB  SETB  (0)                     SET DEFAULT BIT         V70N261  00544000
         AIF   (T'&WKASN EQ 'O').NOMXEND   OMITTED, TAKE DFLT  V70N261  00545000
         AIF   ('&WKASN' EQ 'OFF').NOMXEND IF OFF ALL SET      V70N261  00546000
         AIF   ('&WKASN' NE 'ON').NOMXERR  NOT ON, IN ERR      V70N261  00547000
&WKASNP  SETC  '&WKASN'                SET VALUE FOR USER      V70N261  00548000
&WKASNB  SETB  (1)                     TURN ON BIT IN PPA      V70N261  00549000
         AGO   .NOMXEND                EXIT                    V70N261  00550000
.NOMXERR ANOP  ,                       ERROR TELL USER         V70N261  00551000
         MNOTE 12,'WKASN=&WKASN INVALID, SPECIFY ''ON'' OR ''OFF''.'   *00552000
                                       TELL USER OF ERROR      V70N261  00553000
&WKASNPR SETB  1             PARAMETER ERROR                   V70N261  00554000
&CAT     SETB  1             CATASTROPHIC                      V70N261  00555000
.NOMXEND ANOP  ,                                               V70N261  00556000
.* CHECK DISK=                                                          00557000
         AIF   (T'&DISK EQ 'O').DISKOMT                                 00558000
         AIF   ('&DISK'(1,1) EQ '(').DISKSUB                            00559000
&DISKP   SETC  '&DISK'                                                  00560000
.DISKCK  ANOP                                                           00561000
&DISKA2  SETA  1                                                        00562000
.DISKCK1 AIF ('&DISKP'(1,4) EQ                                         X00563000
               '2314334033303350337593453380339033103370'(&DISKA2,4)   X00564000
               ).DISKCK2                                                00565000
&DISKA2  SETA  &DISKA2+4                                                00566000
         AIF   (&DISKA2 NE 41).DISKCK1                       V74N307    00567000
         AGO   .DISKERR                                                 00568000
.DISKCK2 AIF   (K'&DISK NE 4 AND '&DISKP' NE '3330-11').DISKERR         00569000
&DISKB(1) SETB ('&DISKP' EQ '2314')                                     00570000
&DISKB(2) SETB ('&DISKP' EQ '3340')                                     00571000
&DISKB(3) SETB ('&DISKP' EQ '3330')                                     00572000
&DISKB(4) SETB ('&DISKP' EQ '3330-11')                                  00573000
&DISKB(5) SETB ('&DISKP' EQ '3350')                                     00574000
&DISKB(6) SETB ('&DISKP' EQ '3375')                                     00575000
&DISKB(7) SETB ('&DISKP' EQ '9345')                                     00576000
&DISKB(8) SETB ('&DISKP' EQ '3380')                                     00577000
&DISKB(9) SETB ('&DISKP' EQ '3390')                                     00578000
&DISKB(10) SETB ('&DISKP' EQ '3310')                                    00579000
&DISKB(11) SETB ('&DISKP' EQ '3370')                                    00580000
         AGO   .DISKEND                                                 00581000
.DISKSUB ANOP                                                           00582000
&DISKA   SETA  1                                                        00583000
&DISKA1  SETA  (N'&DISK)                                                00584000
.DISKLP  ANOP                                                           00585000
&DISKP   SETC  '&DISK(&DISKA)'                                          00586000
&DISKA2  SETA  1                                                        00587000
.DISKCK3 AIF   ('&DISKP'(1,4) EQ                                       X00588000
               '2314334033303350337593453380339033103370'(&DISKA2,4)   X00589000
               ).DISKCK4                                                00590000
&DISKA2  SETA  &DISKA2+4                                                00591000
         AIF   (&DISKA2 NE 41).DISKCK3                        V74N307   00592000
         AGO   .DISKERR                                                 00593000
.DISKCK4 AIF   (K'&DISK(&DISKA) NE 4 AND '&DISKP' NE '3330-11').DISKERR 00594000
&DISKB(1) SETB (&DISKB(1) EQ 1 OR '&DISKP' EQ '2314')                   00595000
&DISKB(2) SETB (&DISKB(2) EQ 1 OR '&DISKP' EQ '3340')                   00596000
&DISKB(3) SETB (&DISKB(3) EQ 1 OR '&DISKP' EQ '3330')                   00597000
&DISKB(4) SETB (&DISKB(4) EQ 1 OR '&DISKP' EQ '3330-11')                00598000
&DISKB(5) SETB (&DISKB(5) EQ 1 OR '&DISKP' EQ '3350')                   00599000
&DISKB(6) SETB (&DISKB(6) EQ 1 OR '&DISKP' EQ '3375')                   00600000
&DISKB(7) SETB (&DISKB(7) EQ 1 OR '&DISKP' EQ '9345')                   00601000
&DISKB(8) SETB (&DISKB(8) EQ 1 OR '&DISKP' EQ '3380')                   00602000
&DISKB(9) SETB (&DISKB(9) EQ 1 OR '&DISKP' EQ '3390')                   00603000
&DISKB(10) SETB (&DISKB(10) EQ 1 OR '&DISKP' EQ '3310')                 00604000
&DISKB(11) SETB (&DISKB(11) EQ 1 OR '&DISKP' EQ '3370')                 00605000
&DISKA   SETA  &DISKA+1                                                 00606000
&DISKA1  SETA  &DISKA1-1                                                00607000
         AIF   (&DISKA1 NE 0).DISKLP                                    00608000
         AGO   .DISKEND                                                 00609000
.DISKOMT MNOTE ' ''DISK= PARAMETER OMITTED.  SPECIFY 9345, 2314, 3340, X00610000
               3330, 3330-11, 3350, 3375, 3380, 3390, 3310, OR 3370 IN X00611000
               ANY COMBINATION'''                                       00612000
         AGO   .DISKER1                                                 00613000
.DISKERR MNOTE ' ''&DISKP INVALID IN DISK= PARAMETER.  SPECIFY 9345, 23X00614000
               14, 3340, 3330, 3330-11, 3350, 3375, 3380, 3390, 3310, OX00615000
               R 3370'' '                                               00616000
.DISKER1 ANOP                                                           00617000
&DISKR   SETB  1             PARAMETER ERROR                            00618000
&CAT     SETB  1             CATASTROPHIC                               00619000
.DISKEND ANOP                                                           00620000
.* CHECK VCM=                                                           00621000
&VCMP    SETC  'NO'         DEFAULT                                     00622000
         AIF   (T'&VCM EQ 'O').VCMOK                                    00623000
&VCMP    SETC  '&VCM'                                                   00624000
.VCMOK   ANOP  ,                                                        00625000
&VCMNA   SETB  ('&VCMP' EQ 'NEVER')                                     00626000
&VCMLIMT SETB  ('&VCMP' EQ 'LMT')                                       00627000
         AIF   ('&VCMP' EQ 'MAYBE' OR '&VCMP' EQ 'LMT' OR '&VCMP' EQ 'N-00628000
               O' OR '&VCMP' EQ 'YES' OR '&VCMP' EQ 'LIMIT').VCMEND     00629000
.VCMERR  MNOTE ' ''VCM=&VCM'' IS INVALID. SPECIFY ''YES'', ''NO'', OR '-00630000
               'LIMIT''.'                                               00631000
&VCMR    SETB  1             PARAMETER ERROR                            00632000
&CAT     SETB  1             CATASTROPHIC                               00633000
.VCMEND  ANOP  ,                                                        00634000
.* EQUALS TEST                                                          00635000
&EQUALSP SETC  'NO'          DEFAULT = NO                               00636000
         AIF   (T'&EQUALS EQ 'O').EQUOK                                 00637000
         AIF   (K'&EQUALS LT 2 OR K'&EQUALS GT 3).EQUERR                00638000
&EQUALSP SETC  '&EQUALS'                                                00639000
.EQUOK   ANOP  ,                                                        00640000
&EQA     SETB  ('&EQUALSP' EQ 'YES')                                    00641000
         AIF   ('&EQUALSP' EQ 'YES' OR '&EQUALSP' EQ 'NO').EQUEND       00642000
.EQUERR  MNOTE ' ''EQUALS=&EQUALS'' IS INVALID. SPECIFY ''YES'' OR ''NOX00643000
               '' '                                                     00644000
&EQUALSR SETB  1                                                        00645000
&CAT     SETB  1              CATASTROPHIC ERROR                        00646000
.EQUEND  ANOP  ,                                                        00647000
.* CHECK  TEST                                                          00648000
&CHECKP  SETC  'YES'         DEFAULT = YES                              00649000
         AIF   (T'&CHECK EQ 'O').CHKOK                                  00650000
         AIF   (K'&CHECK LT 2 OR K'&CHECK GT 3).CHKERR                  00651000
&CHECKP  SETC  '&CHECK'                                                 00652000
.CHKOK   ANOP  ,                                                        00653000
&CHKEQNO SETB  ('&CHECK' EQ 'NO')                                       00654000
         AIF   ('&CHECKP' EQ 'YES' OR '&CHECKP' EQ 'NO').CHKEND         00655000
.CHKERR  MNOTE ' ''CHECK=&CHECK'' IS INVALID. SPECIFY ''YES'' OR ''NO  X00656000
               '' '                                                     00657000
&CHECKR  SETB  1                                                        00658000
&CAT     SETB  1              CATASTROPHIC ERROR                        00659000
.CHKEND  ANOP  ,                                                        00660000
         AIF   (T'&EXPAND EQ 'O').ENDEXP                                00661000
&EXPP    SETC  '&EXPAND'                                                00662000
.ENDEXP  ANOP  ,                                                        00663000
.* CHECK STORAGE=                                                       00664000
&STORAGP SETC  '0K'          NO LIMIT SPECIFIED                         00665000
&VSTORE  SETC  '0'           NUMERIC PART OF STORAGE SPECIFICATION      00666000
&STORAGA SETA  &VSTORE       DITTO ABOVE                                00667000
         AIF   (T'&STORAGE EQ 'O').STOROK                               00668000
         AIF   (K'&STORAGE LT 2 OR K'&STORAGE GT 5).STORERR             00669000
         AIF   ('&STORAGE'(K'&STORAGE,1) NE 'K').STORERR                00670000
.* CHECK THE NUMERIC PART OF THE STORAGE SPECIFICATION                  00671000
&D1      SETC  '01234'       5 VALID DECIMAL DIGITS                     00672000
&D2      SETC  '56789'       THE NEXT 5 DECIMAL DIGITS                  00673000
&C       SETA  0             INITIALISE INDEX FOR &STORAGE              00674000
.NEXTC   ANOP  ,             LOOP THRU &STORAGE                         00675000
&C       SETA  &C+1          INDEX TO NEXT CHAR OF &STORAGE             00676000
         AIF   (&C GT (K'&STORAGE-1)).STORVAL ALL VALID                 00677000
&D       SETA  0             INITIALISE INDEX FOR DIGIT STRINGS         00678000
.NEXTD   ANOP  ,             LOOP THRU DECIMAL DIGITS                   00679000
&D       SETA  &D+1          INDEX TO NEXT CH OF DECIMAL STRINGS        00680000
         AIF   (&D GT 5).STORERR INVALID CHAR                           00681000
         AIF   ('&STORAGE'(&C,1) EQ '&D1'(&D,1)).NEXTC                  00682000
         AIF   ('&STORAGE'(&C,1) EQ '&D2'(&D,1)).NEXTC                  00683000
         AGO   .NEXTD        TRY NEXT DECIMAL DIGIT                     00684000
.STORVAL ANOP  ,             &STORAGE IS VALID NNNNK                    00685000
&STORAGP SETC  '&STORAGE'                                               00686000
&VSTORE  SETC  '&STORAGP'(1,K'&STORAGE-1)   NNNN OF NNNNK               00687000
&STORAGA SETA  &VSTORE        SET FOR RANGE CHECK                       00688000
         AIF   (&STORAGA EQ 0).STOROK  0K IS OK                         00689000
         AIF   (&STORAGA LT 30 OR &STORAGA GT 8000).STORERR             00690000
.STOROK  ANOP  ,             &STORAGP HOLDS VALID STORAGE SPECIFICATION 00691000
         AGO   .STORND       DONE                                       00692000
.STORERR MNOTE ' ''STORAGE=&STORAGE'' IS INVALID. SPECIFY WITHIN RANGE -00693000
               ''30K'' TO ''8000K''.'                                   00694000
&STORAGR SETB  1             PARAMETER ERROR                            00695000
&CAT     SETB  1             CATASTROPHIC ERROR                         00696000
.STORND  ANOP  ,                                                        00697000
.* CHECK RESERVE=                                               V73N001 00698000
&RESERVP SETC  '128K'        NO LIMIT SPECIFIED                 V73N001 00699000
&VRESER  SETC  '128'         NUMERIC PART OF STORAGE SPECIFICAT V73N001 00700000
&RESERVA SETA  &VRESER       DITTO ABOVE                        V73N001 00701000
         AIF   (T'&RESERVE EQ 'O').RESEOK                       V73N001 00702000
         AIF   (K'&RESERVE LT 2 OR K'&RESERVE GT 5).RESEERR     V73N001 00703000
         AIF   ('&RESERVE'(K'&RESERVE,1) NE 'K').RESEERR        V73N001 00704000
.* CHECK THE NUMERIC PART OF THE RESERVE SPECIFICATION          V73N001 00705000
&D1      SETC  '01234'       5 VALID DECIMAL DIGITS             V73N001 00706000
&D2      SETC  '56789'       THE NEXT 5 DECIMAL DIGITS          V73N001 00707000
&C       SETA  0             INITIALISE INDEX FOR &RESERVE      V73N001 00708000
.NEXTC1  ANOP  ,             LOOP THRU &RESERVE                 V73N001 00709000
&C       SETA  &C+1          INDEX TO NEXT CHAR OF &RESERVE     V73N001 00710000
         AIF   (&C GT (K'&RESERVE-1)).RESEVAL ALL VALID         V73N001 00711000
&D       SETA  0             INITIALISE INDEX FOR DIGIT STRINGS V73N001 00712000
.NEXTD1  ANOP  ,             LOOP THRU DECIMAL DIGITS           V73N001 00713000
&D       SETA  &D+1          INDEX TO NEXT CH OF DECIMAL STRINGSV73N001 00714000
         AIF   (&D GT 5).RESEERR INVALID CHAR                   V73N001 00715000
         AIF   ('&RESERVE'(&C,1) EQ '&D1'(&D,1)).NEXTC1         V73N001 00716000
         AIF   ('&RESERVE'(&C,1) EQ '&D2'(&D,1)).NEXTC1         V73N001 00717000
         AGO   .NEXTD1       TRY NEXT DECIMAL DIGIT             V73N001 00718000
.RESEVAL ANOP  ,             &RESERVE IS VALID NNNNK            V73N001 00719000
&RESERVP SETC  '&RESERVE'                                       V73N001 00720000
&VRESER  SETC  '&RESERVP'(1,K'&RESERVE-1)   NNNN OF NNNNK       V73N001 00721000
&RESERVA SETA  &VRESER        SET FOR RANGE CHECK               V73N001 00722000
         AIF   (&RESERVA LT 48 OR &RESERVA GT 8000).RESEERR     V73N001 00723000
.RESEOK  ANOP  ,             &RESERVP HOLDS VALID RESERVE SPECI V73N001 00724000
         AGO   .RESEND       DONE                               V73N001 00725000
.RESEERR MNOTE ' ''RESERVE=&RESERVE'' IS INVALID. SPECIFY WITHIN RANGE -00726000
               ''48K'' TO ''8000K''.'                           V73N001 00727000
&RESERVR SETB  1             PARAMETER ERROR                    V73N001 00728000
&CAT     SETB  1             CATASTROPHIC ERROR                 V73N001 00729000
.RESEND  ANOP  ,                                                V73N001 00730000
&SPEC    SETC  '00000000000000000000000000000000X' 32+1         V73N016 00731000
         AIF   (T'&SPECIAL EQ 'O').EXSPEC                       V73N016 00732000
&SP      SETA  1                                                        00733000
.SPLOOP  AIF   (&SP GT N'&SPECIAL).EXSPEC                       V73N016 00734000
         AIF   (T'&SPECIAL(&SP) NE 'N').SPERR                   V73N016 00735000
&SPTF    SETA  &SPECIAL(&SP)                                            00736000
         AIF   ((&SPTF GE 1) AND (&SPTF LE 32)).SPOK            V73N016 00737000
.SPERR   MNOTE 'SPECIAL PTF &SPECIAL(&SP) IS INVALID. MUST BE 1-32'     00738000
&SPECR   SETB  1             PARAMETER ERROR                    V73N016 00739000
&CAT     SETB  1             CATASTROFIC ERROR                  V73N016 00740000
         AGO   .NXTSP                                           V73N016 00741000
.SPOK    ANOP                                                   V73N016 00742000
&SPEC    SETC  '&SPEC'(1,&SPTF-1).'1'.'&SPEC'(&SPTF+1,33-&SPTF) V73N016 00743000
.NXTSP   ANOP                                                   V73N016 00744000
&SP      SETA  &SP+1                                            V73N016 00745000
         AGO   .SPLOOP                                          V73N016 00746000
.EXSPEC  ANOP                                                   V73N016 00747000
&SPEC    SETC  '&SPEC'(1,32)                                    V73N016 00748000
.* CHECK ALTSEQ=                                                V73N023 00749000
         AIF   (T'&ALTSEQ EQ 'O').ENDALT                        V73N023 00750000
&ALTSN   SETB  1                                                V73N023 00751000
&AA      SETA  1                                                V73N023 00752000
.ALTLP   AIF   (&AA GT N'&ALTSEQ).ENDALT                        V73N023 00753000
         AIF   (K'&ALTSEQ(&AA) NE 4).ALTERR                     V73N023 00754000
&CA      SETC  '&ALTSEQ(&AA)'                                   V73N023 00755000
&AB      SETA  1                                                V73N023 00756000
.ALTLP3  AIF   (&AB GT 4).ALTSKP                                V73N023 00757000
&AC      SETA  1                                                V73N023 00758000
.ALTLP2  AIF   (&AC GT 16).ALTERR                               V73N023 00759000
         AIF   ('&CA'(&AB,1) EQ '0123456789ABCDEF'(&AC,1)).ALSK V73N023 00760000
&AC      SETA  &AC+1                                            V73N023 00761000
         AGO   .ALTLP2                                          V73N023 00762000
.ALSK    ANOP                                                   V73N023 00763000
&AB      SETA  &AB+1                                            V73N023 00764000
         AGO   .ALTLP3                                          V73N023 00765000
.ALTERR  MNOTE 'ALTSEQ PARAMETER ''&ALTSEQ(&AA)'' ERROR. SHOULD BE 4 HEX00766000
               XADECIMAL CHARACTERS'                            V73N023 00767000
&ALTR    SETB  1                                                V73N023 00768000
&CAT     SETB  1                                                V73N023 00769000
.ALTSKP  ANOP                                                   V73N023 00770000
&AA      SETA  &AA+1                                            V73N023 00771000
         AGO   .ALTLP                                           V73N023 00772000
.ENDALT  ANOP                                                   V73N023 00773000
.* CHECK Y2PAST=                                               V82M002  00773004
&Y2      SETC  '80'           DEFAULT 80 YEARS                 V82M002  00773008
         AIF   (T'&Y2PAST EQ 'O').ENDY2P                       V82M002  00773012
         AIF   (T'&Y2PAST NE 'N').Y2PERR                       V82M002  00773016
&Y2      SETC  '&Y2PAST'                                       V82M002  00773020
         AIF   (&Y2 LT 00).Y2PERR                              V82M002  00773024
         AIF   (&Y2 LT 100).ENDY2P                             V82M002  00773028
         AIF   (&Y2 EQ 100).ENDY2P                             V82M002  00773032
         AIF   (&Y2 LT 1000).Y2PERR                            V82M002  00773036
         AIF   (&Y2 GT 3000).Y2PERR                            V82M002  00773040
         AGO   .ENDY2P                                         V82M002  00773044
.Y2PERR MNOTE 8,'Y2PAST ''&Y2PAST'' ERROR. MUST BE BETWEEN 00, 100 OR BX00773048
               ETWEEN 1000,3000'                               V82M002  00773052
.ENDY2P  ANOP                                                  V82M002  00773056
.* CHECK WKXTNTS=                                              V81M008  00773070
&XTNTS   SETA  25                                              V81M008  00773140
         AIF   (T'&WKXTNTS EQ 'O').ENDXTNT                     V81M008  00773210
         AIF   (T'&WKXTNTS NE 'N').XTNTERR                     V81M008  00773280
         AIF   (&WKXTNTS LT 1 OR &WKXTNTS GT 255).XTNTERR      V81M008  00773350
&XTNTS   SETA  &WKXTNTS                                        V81M008  00773420
         AGO   .ENDXTNT                                        V81M008  00773490
.XTNTERR MNOTE ' ''WKXTNTS=&WKXTNTS'' IS INVALID. SPECIFY WITHIN RANGE -00773560
               ''1'' TO ''255''.'                              V81M008  00773630
&XTNTR   SETB  1                                               V81M008  00773700
&CAT     SETB  1                                               V81M008  00773770
.ENDXTNT ANOP                                                  V81M008  00773840
.* CHECK DSPSIZE=                                              V90M001  00773850
&DSP     SETC  '0'            DEFAULT TO NO DATA SPACE         V90M001  00773860
         AIF   (T'&DSPSIZE EQ 'O').ENDDSP                      V90M001  00773870
&DSP     SETC  '-1'           DEFAULT TO MAX                   V90M001  00773880
         AIF   ('&DSPSIZE' EQ 'MAX').ENDDSP                    V90M001  00773890
         AIF   (T'&DSPSIZE NE 'N').DSPERR                      V90M001  00773900
&DSP     SETC  '&DSPSIZE'                                      V90M001  00773910
         AIF   (&DSP LT 0).DSPERR                              V90M001  00773920
         AIF   (&DSP GT 2048).DSPERR                           V90M001  00773930
         AGO   .ENDDSP                                         V90M001  00773940
.DSPERR MNOTE 8,'DSPSIZE ''&DSPSIZE'' ERROR. MUST BE ''MAX'', OR BETWEEX00773950
               N 0 AND 2048'                                   V90M001  00773960
.ENDDSP  ANOP                                                  V90M001  00773970
.* GEAR SYSTEM TO &MODEL                                                00774000
         AIF   (&MODELR).SYSTEND  CANNOT IF &MODEL INCORRECT            00775000
&S70     SETB  0             NOT A SYSTEM 370                           00776000
         AIF   (&M25).SYSTEND     A SYSTEM /360                         00777000
         AIF   (&M30).SYSTEND     A SYSTEM /360                         00778000
         AIF   (&M40).SYSTEND     A SYSTEM /360                         00779000
         AIF   (&M50).SYSTEND     A SYSTEM /360                         00780000
         AIF   (&M65).SYSTEND     A SYSTEM /360                         00781000
&S70     SETB  1             ELSE IT IS A 370 (FOR OUR PURPOSES)        00782000
.SYSTEND ANOP  ,                                                        00783000
.* CROSS-CHECK USER SPECIFIED PARAMETERS                       V72N499  00784000
.* DYNAMD=NO AND DYNALOC=(VVVVVV,N) IS AN ERROR                V72N499  00785000
         AIF   (&DYNAMDR OR &DYNALCR).OPALND  BYPASS IF ERROR  V72N499  00786000
         AIF   (NOT('&DYNAMDP' EQ 'NO' AND '&DYNALCP' EQ 'YES')).OPALND 00787000
         MNOTE '  ''DYNAMD=NO'' AND ''DYNALOC=(VVVVVV,N)'' IS INVALID. -00788000
               '' DYNAMD=YES MUST BE SPECIFIED FOR DYNALOC=(VVVVVV,N)''-00789000
               .  '                                            V72N499  00790000
&CAT     SETB  1              CATASTROPHIC ERROR               V72N499  00791000
.*                                                             V72N499  00792000
.OPALND  ANOP  ,                                               V72N499  00793000
.* IF ANY ERRORS                                                        00794000
         AIF   (&CAT).TERM    IF SPECIFICATION ERRORS                   00795000
         MNOTE '         GENERATION PARAMETERS'                         00796000
         MNOTE '               PHASE=&PHASEP'                           00797000
         MNOTE '               MODEL=&MODELP'                           00798000
         MNOTE '               OPT=&OPTP'                               00799000
         MNOTE '               MSG=&MSGP'                               00800000
         MNOTE '               DYNAMD=&DYNAMDP'                         00801000
         MNOTE '               DYNAMFI=&DYNFIP'                         00802000
         MNOTE '               DYNALOC=&DYNALOC'               V72N499  00803000
         MNOTE '               RC=&RCP'                        V72SPRC  00804000
         MNOTE '               PFIX=&PFIXP'                             00805000
         MNOTE '               OPSYS=&OPSYSP'                           00806000
         MNOTE '               DEFDTF=&DEFDTFP'                         00807000
         MNOTE '               PREOPEN=&PREOPP'                         00808000
         MNOTE '               WKASN=&WKASNP'                  V70N261  00809000
         MNOTE '               DISK=&DISK'                              00810000
         MNOTE '               VCM=&VCMP'                               00811000
         MNOTE '               EQUALS=&EQUALSP'                         00812000
         MNOTE '               CHECK=&CHECKP'                           00813000
         MNOTE '               STORAGE=&STORAGP'                        00814000
         MNOTE '               RESERVE=&RESERVP'               V73N001  00815000
         MNOTE '               SPECIAL=&SPECIAL'               V73N016  00816000
         MNOTE '               Y2PAST=&Y2PAST'                 V82M002  00816500
         MNOTE '               DSPSIZE=&DSPSIZE'               V90M001  00816700
.TERM    AIF   (&SYSNDX EQ 1).TND MUST BE FIRST AND ONLY MACRO CALLED   00817000
         MNOTE ' CASORT  MAY BE CALLED ONCE ONLY PER ASSEMBLY AND NO OT-00818000
               HER MACROS ARE PERMITTED WITH CASORT .'                  00819000
&CAT     SETB  1             CATASTROPHIC                               00820000
.TND     ANOP  ,                                                        00821000
         AIF   (NOT &CAT).GEN     IF NO CATASTROPHIC ERRORS             00822000
         MNOTE 16,'GENERATION TERMINATED-CORRECT ERRORS AND RE-RUN.'    00823000
         MEXIT ,                                                        00824000
***************** END OF EDITING ************************************** 00825000
.GEN     ANOP  ,             NOW GEN THE  MODULE                        00826000
         AIF   ('&EXPP' EQ 'FULL').FULLGN                               00827000
         PRINT ON,NOGEN,NODATA                                          00828000
.*                                                                      00829000
.* NOW GENERATE THE ROOT PHASE                                          00830000
.*                                                                      00831000
.FULLGN  ANOP  ,                                                        00832000
&ID      TITLE 'CASORT  - GENERATE CA-SORT ROOT PHASE.'                 00833000
.*                                                                      00834000
         AIF   (NOT &PHAB).NOPHAS IF NO PHASE STMT                      00835000
         PUNCH ' PHASE &PHASEP,+0  &VM ROOT PHASE'                      00836000
.NOPHAS  ANOP  ,                                                        00837000
         SPACE ,                                                        00838000
&FICSECT CSECT ,                                                        00839000
R0       EQU   0                                                        00840000
R1       EQU   1                                                        00841000
R11      EQU   11                                                       00842000
R12      EQU   12                                                       00843000
R13      EQU   13                                                       00844000
R14      EQU   14                                                       00845000
R15      EQU   15                                                       00846000
START    DC    0Y(0)         START OF CSECT                             00847000
         BALR  R15,0         LOAD BASE REGISTER                         00848000
         LA    R15,0(R15)    ZEROISE HI ORDER BYTE                      00849000
         BCTR  R15,0         BACK-OFF TO                                00850000
         BCTR  R15,0         ENTRY POINT                                00851000
         USING &FICSECT,R15  DEFINE BASE                                00852000
         LA    R1,0(,R1)     CLEAR UN-WANTED BITS              V81M001  00852050
         LA    R13,0(,R13)   CLEAR UN-WANTED BITS              V82M001  00852070
         LA    R14,0(,R14)   CLEAR UN-WANTED BITS              V81M001  00852100
*        AMODESW TEST        AMODE 31 CAPABLE ?                V81M001  00852150
         TM    X'241',X'02'  AMODE 31 CAPABLE ?                V81M001  00852200
         BZ    CONTINUE      NO, CONTINUE                      V81M001  00852250
         ST    R14,SAVER14   SAVE RETURN ADDRESS               V81M001  00852300
         BALR  R14,R0        SAVE POSSIBLE AMODE               V81M001  00852350
         LTR   R14,R14       RUNNING AMODE 31 ?                V81M001  00852400
         BM    SETRETAM      YES, SET FLAG AND CONTINUE        V81M001  00852450
         LA    R14,LOADR14   LOAD BRANCH ADDRESS               V81M001  00852500
         O     R14,HIGHBIT   SET FOR AMODE 31                  V81M001  00852550
*        BSM   R0,R14        BRANCH AND SET AMODE 31           V81M001  00852600
         DC    0H'0',X'0B0E' BRANCH AND SET AMODE 31           V81M001  00852650
HIGHBIT  DC    0F'0',X'80000000' CONSTANT FOR AMODE 31 SET     V81M001  00852700
SETRETAM DS    0H                                              V81M001  00852750
         OI    SAVER14,X'80' SET RETURN FOR AMODE 31           V81M001  00852800
LOADR14  DS    0H                                              V81M001  00852850
         L     R14,SAVER14   RELOAD RETURN ADDRESS             V81M001  00852900
CONTINUE DS    0H                                              V81M001  00852950
         STM   R14,R12,SAVER14 INITIALISE OUR SAVE AREA                 00853000
* IF CALLED, R1 POINTS TO PARAMETERS                                    00854000
* IF '// EXEC ....', R1 POINTS TO ENTRY POINT                           00855000
         CR    R1,R15        CALLED                                     00856000
         BE    NOTCALLD      NO                                         00857000
         STM   R14,R12,12(R13)    SAVE CALLER'S REGISTERS               00858000
         LA    R11,SAVE      POINT TO OUR SAVE AREA                     00859000
         ST    R11,8(R13)    FWD CHAIN FROM CALLER'S TO OUR SAVE AREA   00860000
         ST    R13,SAVEBWD   BWD CHAIN FROM OUR TO CALLER'S SAVE AREA   00861000
         ST    R1,SAVER1     SAVE POINTER TO PARAMETERS                 00862000
NOTCALLD DC    0Y(0)                                                    00863000
         LA    R13,SAVE      POINT TO OUR SAVE AREA                     00864000
* NOW LOAD THE SUCCEEDING PHASE                                         00865000
         LA    R1,PHASNAM    NEXT PHASE OF SORT                         00866000
         LA    R0,LOADPT     LOAD IT HERE                      V82M001  00868180
         SRL   R0,3          ALIGN TO                          V82M001  00868670
         SLL   R0,3          DOUBLEWORD BOUNDARY               V82M001  00869160
         SVC   4             LOAD IT                                    00870000
         C     R15,SAVER1    DID R1 POINT TO ENTRY POINT                00871000
         BNE   CALLED        NO, MUST POINT TO CALLING PARAMETERS       00872000
* FALL THRU IF '// EXEC ....'                                           00873000
         ST    R1,SAVER1     R1 NEEDS TO POINT TO NEXT ENTRY POINT      00874000
CALLED   DC    0Y(0)                                                    00875000
* PASS THE GENERATION PARAMETERS VIA R0                                 00876000
         LA    R0,GENPARMS   POINT TO GENERATION PARAMETERS             00877000
         ST    R0,SAVER0     SO LM WILL PICK IT UP                      00878000
         ST    R1,SAVER15    ENTRY POINT OF JUST-LOADED PHASE           00879000
         LA    R14,RETURN    RETURN ADDRESS AFTER CALL                  00880000
         LM    R15,R12,SAVER15 LOAD REGS TO PASS TO SORT                00881000
         DROP  R15           CAN NO LONGER SERVE AS BASE                00882000
         BR    R15           GO TO SORT, RETURN TO 'RETURN'             00883000
         ORG   &FICSECT+80   LEAVE 80 BYTES FOR LBLTYP                  00884000
         ORG   ,             AT LEAST 80 BYTES                          00885000
RETURN   DC    0Y(0)         RETURN FROM SORT, IF CALLED                00886000
         BALR  R14,0         SET BASE                                   00887000
         BCTR  R14,0         POINT TO                                   00888000
         BCTR  R14,0         RETURN ADDRESS                             00889000
         USING RETURN,R14    DEFINE BASE REG                            00890000
         L     R13,SAVEBWD   POINT TO CALLER'S SAVE AREA                00891000
         LTR   R13,R13       ANYTHING THERE                             00892000
         BNZ   RELOAD        YES, MUST HAVE BEEN CALLED                 00893000
         SVC   14            ALL DONE, RETURN TO JOB CONTROL            00894000
RELOAD   DC    0Y(0)         RELOAD CALLER'S REGS AND RETURN            00895000
         LM    R0,R12,20(R13)    RESTORE CALLER'S REGISTERS             00896000
         L     R14,12(R13)   RESTORE RETURN ADDRESS                     00897000
         DROP  R14           UNDEFINE                                   00898000
*        AMODESW TEST        AMODE 31 CAPABLE ?                V81M001  00899090
         TM    X'241',X'02'  AMODE 31 CAPABLE ?                V81M001  00899180
         BZR   R14           RETURN TO CALLER, R15 PASSES RETURV81M001  00899270
*        BSM   R0,R14        SET AMODE AND RETURN              V81M001  00899360
         DC    0H'0',X'0B0E' SET AMODE AND RETURN              V81M001  00899450
*                                                                       00900000
* PARAMETER TABLE- R0 PASSES THE ADDRESS TO CASMA001                    00901000
* NOTE- BECAUSE THE USER MAY ASSEMBLE THIS MACRO IN-HOUSE IT IS KEPT    00902000
* AS SIMPLE AS POSSIBLE. CONSEQUENTLY THERE ARE NO INNER MACROS OR      00903000
* COPY BOOKS.                                                           00904000
* THUS THE LAYOUT OF THE FOLLOWING TABLE IS ALSO DEFINED, IN PART,      00905000
* IN THE PPA AND, WHERE REFERENCED, IN CASMA001.                        00906000
*                                                                       00907000
         AIF   ('&EXPP' NE 'PART').NOEXP                                00908000
         PRINT GEN                                                      00909000
.NOEXP   ANOP  ,                                                        00910000
GENPARMS DC    0F'0'         ALIGN                                      00911000
* CASMA001 CHECKS THE FOLLOWING 16 BYTES TO ENSURE R0 POINTS            00912000
* TO A GENUINE PARAMETER TABLE                                          00913000
         DC    CL8'GENPARMS' IDENTIFY THE TABLE                         00914000
         DC    CL8'CASORT&VER&MOD'    IDENTIFY THE TABLE FURTHER        00915000
VSLIM    DC    A(&VSTORE*1024)    VS STORAGE LIMIT                      00916000
VSRES    DC    A(&VRESER*1024)    VS GETVIS MINIMAL RESERVE     V73NO01 00917000
PAR      DC    0CL8'0'                                                  00918000
PGCIS    DC    CL4'CA&Q'          PREFIX FOR PHASES                     00919000
LPHSX    DC    CL4' '                                                   00920000
DVER     DC    0F'0'                                                    00921000
MODS     DC    0AL3(0)                                                  00922000
SMCLT    DC    AL1(&SMCLT)   MVC TIME*4                                 00923000
SBYTM    DC    AL1(&SBYTM)   BYTE TIME*8                                00924000
SLSTM    DC    AL1(&SLSTM)   L/S*8                                      00925000
DEFDTF   DC    AL1(&DTFTYP+&PREOPA)   DEFAULT SORTIN/SORTOUT DTF TYPE   00926000
EXTENTS  DC    AL1(&XTNTS)   MAX NO. OF SORTWK EXTENTS         V81M008  00927290
DYNNUM   DC    AL1(&WKNO)    NO. OF SORTWK FILES FOR DYNALOC   V81M008  00927580
DYNPOOL  DC    CL6'&VOLSER'  DYNAM/D POOL-ID FOR DYNALOC       V72N499  00928000
ROOTLEN  DC    AL2(LOADPT-START)  LENGTH OF ROOT SECTION                00929000
&DISKC(1) SETC 'FF'                                                     00930000
         AIF   (NOT &DISKB(1)).GEN3340                                  00931000
&DISKC(1) SETC '04'                                                     00932000
.GEN3340 ANOP                                                           00933000
&DISKC(2) SETC 'FF'                                                     00934000
         AIF   (NOT &DISKB(2)).GEN3330                                  00935000
&DISKC(2) SETC '0C'                                                     00936000
.GEN3330 ANOP                                                           00937000
&DISKC(3) SETC 'FF'                                                     00938000
         AIF   (NOT &DISKB(3)).GEN3331                                  00939000
&DISKC(3) SETC '08'                                                     00940000
.GEN3331 ANOP                                                           00941000
&DISKC(4) SETC 'FF'                                                     00942000
         AIF   (NOT &DISKB(4)).GEN3350                                  00943000
&DISKC(4) SETC '10'                                                     00944000
.GEN3350 ANOP                                                           00945000
&DISKC(5) SETC 'FF'                                                     00946000
         AIF   (NOT &DISKB(5)).GEN3375                                  00947000
&DISKC(5) SETC '14'                                                     00948000
.GEN3375 ANOP                                                           00949000
&DISKC(6) SETC 'FF'                                                     00950000
         AIF   (NOT &DISKB(6)).GEN9345                                  00951000
&DISKC(6) SETC '18'                                                     00952000
.GEN9345 ANOP                                                           00953000
&DISKC(7) SETC 'FF'                                                     00954000
         AIF   (NOT &DISKB(7)).GEN3380                                  00955000
&DISKC(7) SETC '28'                                                     00956000
.GEN3380 ANOP                                                           00957000
&DISKC(8) SETC 'FF'                                                     00958000
         AIF   (NOT &DISKB(8)).GEN3390                                  00959000
&DISKC(8) SETC '1C'                                                     00960000
.GEN3390 ANOP                                                           00961000
&DISKC(9) SETC 'FF'                                                     00962000
         AIF   (NOT &DISKB(9)).GEN3310                                  00963000
&DISKC(9) SETC '20'                                                     00964000
.GEN3310 ANOP                                                           00965000
&DISKC(10) SETC 'FF'                                                    00966000
         AIF   (NOT &DISKB(10)).GEN3370                                 00967000
&DISKC(10) SETC '24'                                                    00968000
.GEN3370 ANOP                                                           00969000
         AIF   (NOT &DISKB(11)).GENEND                                  00970000
&DISKC(10) SETC '24'                                                    00971000
.GENEND  ANOP                                                           00972000
DVCTAB   DC    XL10'&DISKC(1).&DISKC(2).&DISKC(3).&DISKC(4).&DISKC(5).&X00973000
               DISKC(6).&DISKC(7).&DISKC(8).&DISKC(9).&DISKC(10)'       00974000
SCONFG   DC    AL1(S70*&S70+RMP*&RMP+RML*&RML+OPD*&OPD+VSY+PFX*&PFX+DYNX00975000
               *&DYN+CHKEQNO*&CHKEQNO)                          V73N001 00976000
S70      EQU   X'80' S/370                                              00977000
RMP      EQU   X'40' RUN MESSAGES TO SYSLST                             00978000
RML      EQU   X'20' RUN MESSAGES TO SYSLOG                             00979000
CHKEQNO  EQU   X'10' RCD COUNT CHECKING                                 00980000
OPD      EQU   X'08' OPT=D                                              00981000
VSY      EQU   X'04' DOS/VS SYSTEM - ALWAYS ON                 V73N001  00982000
PFX      EQU   X'02' PAGE FIXING                                        00983000
DYN      EQU   X'01' DYNAM/D INTERFACE ACTIVE                           00984000
*                                                                       00985000
SCONFG1  DC    AL1(VCMNA*&VCMNA+VCMLIMIT*&VCMLIMT+EQA*&EQA+MVT*&MVT+DFI-00986000
               *&DFI)                                          V72N499  00987000
VCMNA    EQU   X'80'              VCM NOT ALLOWED                       00988000
VCMLIMIT EQU   X'40'              VCM LIMITATION IN EFFECT              00989000
EQA      EQU   X'20'              EQUALS                                00990000
MVT      EQU   X'10'              MVT/VSE SYSTEM               V73N001  00991000
DFI      EQU   X'08'              DYNAMFI=YES                  V72CDYN  00992000
*        EQU   X'04'              (RESERVED)                   V72N499  00993000
*        EQU   X'02'              (RESERVED)                   V72N499  00994000
*        EQU   X'01'              (RESERVED)                   V72N499  00995000
*                                                                       00996000
SCONFG2 DC B'&WKASNB&DISKB(10)&DISKB(11).0&DYNALC&SPRC&INVCN&CHALN'     00997000
WKASN    EQU   X'80'              WKASNED WORK FILES           V70N261  00998000
WK3310   EQU   X'40'              3310 GENED IN DVC TAB        V70N267  00999000
WK3370   EQU   X'20'              3370 GENED IN DVC TAB        V70N267  01000000
*        EQU   X'10'              PCI SUPPORT FOR SORTWK                01001000
DYNALC   EQU   X'08'              DYNALOC=(VVVVVV,N)           V72N499  01002000
SPRC     EQU   X'04'              SET RC AT EOJ OR DUMP        V72SPRC  01003000
INVCNCL  EQU   X'02'         CANCEL ON ERROR FOR INVOKED SORTS V73N017  01004000
CHALT    EQU   X'01'              INTERPRET CH AS AQ           V73N023  01005000
*                                                              V70N260  01006000
SCONFG3  DC    B'&JCLPCTL&JCLPNON&INVPALL&INVPNON&ALTSN.000'            01007000
*                                                                       01008000
SPTFS    DC    B'&SPEC'           SPECIAL PTFS 1-32            V73N016  01009000
ALTAB    DC    256AL1(*-ALTAB)    ALSEQ TABLE                  V73N023  01010000
&AA      SETA  1                                               V73N023  01011000
.ALTLP4  AIF   (&AA GT N'&ALTSEQ).EXAL4                        V73N023  01012000
&CA      SETC  '&ALTSEQ(&AA)'(1,2)                             V73N023  01013000
         ORG   ALTAB+X'&CA'                                    V73N023  01014000
&CA      SETC  '&ALTSEQ(&AA)'(3,2)                             V73N023  01015000
         DC    X'&CA'                                          V73N023  01016000
&AA      SETA  &AA+1                                           V73N023  01017000
         AGO   .ALTLP4                                         V73N023  01018000
.EXAL4   ORG   ,                                               V73N023  01019000
Y2PAST   DC    AL2(&Y2)                                        V82M002  01019500
         DC    AL2(0)        RESERVED FOR FUTURE USE           V90M001  01019570
DSPSIZE  DC    AL4(&DSP)     DATA SPACE SIZE                   V90M001  01019640
GVSIZE   DC    AL4(0)        DATA SPACE SIZE                   V90M001  01019710
GVRLOW   DC    AL4(0)        DATA SPACE SIZE                   V90M001  01019780
GVRANY   DC    AL4(0)        DATA SPACE SIZE                   V90M001  01019850
         DC    3AL4(0)       RESERVED FOR FUTURE USE           V90M001  01019920
LSYS     EQU   *-VSLIM                                                  01020000
* END OF PARAMETER TABLE                                                01021000
SAVE     DC    9D'0'         SAVE REGS HERE                             01022000
SAVEBWD  EQU   SAVE+4        POINT TO CALLER'S SAVE AREA                01023000
SAVER0   EQU   SAVE+20       R0 SAVED HERE                              01024000
SAVER1   EQU   SAVE+24       R1 SAVED HERE                              01025000
SAVER14  EQU   SAVE+12       R14 SAVED HERE                             01026000
SAVER15  EQU   SAVE+16       R15 SAVED HERE                             01027000
*                                                                       01028000
PATCHL   EQU   (((*-&FICSECT+152)/256)+1)*256-(*-&FICSECT+152) V82M001  01029590
PATCH1   DC    (PATCHL)XL1'FF' PATCH AREA                      V82M001  01030180
PHASNAM  DC    CL8'CA&Q.A001'     THE NEXT PHASE TO LOAD                01031000
RECLVEC  DC    3D'0'         LRECL VECTORS FOR E15/E35         CO57762  01032000
LOADPT   DC    0D'0'         LOAD THE ABOVE-NAMED PHASE HERE            01033000
         MEND  ,                                                        01034000
