         COPY  DFHVSWA                                                  00001000
         EJECT                                                          00002000
         COPY  DFHTCTTE                                                 00003000
         COPY  DFHTIOA                                                  00004000
         PRINT  OFF                                                     00005000
         COPY  DFHCSADS                                                 00006000
         DFHTCA CICSYST=YES                                             00007000
         PRINT ON                                                       00008000
         TITLE 'INITIAL ENTRY FROM CICS'                                00009000
*********************************************************************   00010000
****                                                             ****   00011000
****        H E L P       --   C I C S  -- NON-ADAPTER SYSTEMS   ****   00012000
****                                                             ****   00013000
****            COMPUTER ASSOCIATES INTERNATIONAL INC.           ****   00014000
****           125 JERICHO TURNPIKE, JERICHO, L.I., N.Y.         ****   00015000
****                                                             ****   00016000
****                  COPYRIGHT -- 1981                          ****   00017000
*********************************************************************   00018000
         SPACE 1                                                        00019000
CASOHTP0 CSECT                                                          00020000
         USING *,R14                                                    00021000
         B     OVERID                                                   00022000
         DC    C'HELPTPI0 VM=1.0 '                                      00023000
OVERID   DS    0H                                                       00024000
         DROP  R14                                                      00025000
         USING CASOHTP0,BASE                                            00026000
         USING HELPUTLA,COMMBASE       ADDRESSABLITY TO COMM AREA       00027000
         LR    BASE,R14                LOAD BASE REGISTER               00028000
         L     TCTTEAR,TCAFCAAA        INITIAL SETUP STUFF              00029000
         LA    R4,UCPLEN                                                00030000
         STH   R4,TCASCNB              NUMBER OF BYTES TO GET           00031000
         MVI   TCASCIB,X'00'           BYTE TO INITIALIZE               00032000
         DFHSC TYPE=GETMAIN,CLASS=USER,COND=(NO,STUFAIL),INITIMG=YES    00033000
         L     COMMBASE,TCASCSA        GET ADDRESS                      00034000
         LA    COMMBASE,8(COMMBASE)    PAST STRG HEADER                 00035000
         LA    R4,ENTYPT                                                00036000
         ST    R4,UCSRVAD              SET SERVICE ENTRY                00037000
         LA    R4,1440                                                  00038000
         STH   R4,TCASCNB              NUMBER OF BYTES TO GET           00039000
         MVI   TCASCIB,X'00'           BYTE TO INITIALIZE               00040000
         DFHSC TYPE=GETMAIN,CLASS=USER,COND=(NO,STSFAIL),INITIMG=YES    00041000
         LA    R14,19                                                   00042000
         L     R1,TCASCSA              GET STORAGE ADDRESS              00043000
         LA    R1,8(R1)                                                 00044000
         LR    R6,R1                                                    00045000
SAVERL   DS    0H                                                       00046000
         LA    R2,72(R1)               GET NEXT IN CHAIN                00047000
         ST    R2,NEXT(R1)                                              00048000
         ST    R1,PREV(R2)                                              00049000
         LR    R1,R2                   ADJUST                           00050000
         BCT   R14,SAVERL                                               00051000
         L     R4,0(R12)               GET SYSTEM TCA ADDRESS           00052000
         BAL   R7,TD3270               SET UP INITIAL INPUT             00053000
         MVI   UCPPASA,X'7D'           SET ENTER KEY                    00054000
         L     R15,=V(CASOHLP0)                                         00055000
         LR    R2,R12                  SAVE R12 (TCA)                   00056000
         LR    R3,R13                  SAVE R13 (CSA)                   00057000
         LR    R13,R6                  SET UP SAVEAREA                  00058000
         LR    R4,COMMBASE             SET UP UTILITY AREA              00059000
         BALR  R14,R15                                                  00060000
         LM    R14,R13,12(R13)         GET REGS BACK                    00061000
         LR    R12,R2               GET  R12 (TCA)                      00062000
         LR    R13,R3               GET  R13 (CSA)                      00063000
EOJ      DS    0H                                                       00064000
         SH    R6,=H'8'                POINT TO SAA                     00065000
         ST    R6,TCASCSA              FREE SAVEAREA CHAIN              00066000
         DFHSC TYPE=FREEMAIN                                            00067000
         SH    COMMBASE,=H'8'                POINT TO SAA               00068000
         ST    COMMBASE,TCASCSA        FREE COMMUNICATION AREA          00069000
         DFHSC TYPE=FREEMAIN                                            00070000
PCRET    DS    0H                                                       00071000
         DFHPC TYPE=RETURN                                              00072000
STUFAIL  DS    0H                                                       00073000
         LA    R15,24                                                   00074000
         B     PCRET                                                    00075000
STSFAIL  DS    0H                                                       00076000
         ST    COMMBASE,TCASCSA        FREE COMMUNICATION AREA          00077000
         DFHSC TYPE=FREEMAIN                                            00078000
         LA    R15,28                                                   00079000
         B     PCRET                                                    00080000
         TITLE 'ENTRY POINT FROM ALL USERS'                             00081000
ENTYPT   EQU   *                                                        00082000
         STM   R14,R12,12(R13)         SAVE INCOMING REGISTERS          00083000
         LR    R15,R13                  SAVE R13 ADDRESS                00084000
         BALR  R1,R0                                                    00085000
         USING *,R1                                                     00086000
         L     BASE,=A(CASOHTP0)                                        00087000
         DROP  R1                                                       00088000
         USING CASOHTP0,BASE                                            00089000
CHASER   DS    0H                                                       00090000
         CLC   =F'0',PREV(R13)                                          00091000
         BE    HEREITIS                                                 00092000
         L     R13,PREV(R13)        FIND INITIAL SAVEAREA               00093000
         B     CHASER                                                   00094000
HEREITIS DS    0H                                                       00095000
         LM    R0,R14,20(R13)          GET ALL THE REGS                 00096000
         LR    R12,R2                  GET TCA BACK                     00097000
         LR    R13,R3                  GET CSA BACK                     00098000
         LR    R5,R15                  SAVE INCOMING SAVEAREA ADDRESS   00099000
         TM    UCSYIND,UCSYEOJ         IS IT OVER                       00100000
         BO    EOJ                     YES ITS OVER                     00101000
         LH    R2,UCREQCD              GET SERVICE ROUTINE PTR          00102000
         B     *+4(R2)                 GOT TO SERVICE ROUTINE           00103000
         B     STORGET            (0)  ALLOCATE STORAGE                 00104000
         B     STORFREE           (4)  RELEASE STORAGE                  00105000
         B     TERMINAL           (8)  TERMINAL SERVICE                 00106000
         B     TERMINAL           (12) TERMINAL SERVICE                 00107000
         B     INVALID            (16) INVALID      SERVICE             00108000
         B     READHELP           (20) READ HELP DATA                   00109000
         B     INVALID            (24) INVALID      SERVICE             00110000
         B     INVALID            (28) INVALID SERVICE                  00111000
         B     INVALID            (32) INVALID SERVICE                  00112000
         B     INVALID            (36) INVALID SERVICE                  00113000
         B     INVALID            (40) INVALID SERVICE                  00114000
         B     INVALID            (44) INVALID SERVICE                  00115000
         B     INVALID            (48) INVALID SERVICE                  00116000
         B     INVALID            (52) INVALID SERVICE                  00117000
         B     INVALID            (56) INVALID SERVICE                  00118000
         B     INVALID            (60) INVALID SERVICE                  00119000
         B     INVALID            (64) INVALID SERVICE                  00120000
         B     INVALID            (68) INVALID SERVICE                  00121000
         B     INVALID            (72) INVALID SERVICE                  00122000
INVALID  DS    0H                                                       00123000
         LA    R15,16                                                   00124000
         B     RESLEEP                                                  00125000
         TITLE 'STORAGE REQUEST HANDLER'                                00126000
STORGET  EQU   *                                                        00127000
         LH    R1,UCPSCLN+2            REQUESTED STRG LENGTH            00128000
         STH   R1,TCASCNB              NUMBER OF BYTES TO GET           00129000
         MVC   TCASCIB,UCPSCIC         BYTE TO INITIALIZE               00130000
         DFHSC TYPE=GETMAIN,CLASS=USER,COND=(NO,NOGOTS),INITIMG=YES     00131000
         L     R2,TCASCSA              ADDRESS OF AQUIRED STRG          00132000
         LA    R2,8(,R2)               POINT PAST STRG ACCTNG           00133000
         ST    R2,UCPSCAD              TELL REQUESTOR ADDRESS           00134000
         SR    R15,R15                 OK STORAGE                       00135000
         B     RESLEEP                 BACK TO USER                     00136000
NOGOTS   LA    R15,4                   SAY STORAGE GET FAILED           00137000
         XC    UCPSCAD(4),UCPSCAD      MAKE SURE NO STORAGE USED        00138000
         B     RESLEEP                                                  00139000
ABSTRG   DS    0H                                                       00140000
         LA    R15,32                                                   00141000
         B     EOJ                                                      00142000
STORFREE EQU   *                                                        00143000
         SR    R15,R15                 OK                               00144000
         L     R1,UCPSCAD              ADDR OF STRG TO BE FREED         00145000
         LTR   R1,R1                   BEWARE OF PROBLEMS               00146000
         BZ    RESLEEP                                                  00147000
         SH    R1,=H'8'                POINT TO STRG ACCTNG AREA        00148000
         LTR   R1,R1                                                    00149000
         BZ    RESLEEP                                                  00150000
         TM    0(R1),X'80'             CHECK IT OUT                     00151000
         BZ    RESLEEP                                                  00152000
         CLI   0(R1),X'88'             PROGRAM STORAGE                  00153000
         BE    STOFROK                 DONT DO DUPLICATE CHECK          00154000
         LH    R2,2(R1)                GET LENGTH                       00155000
         AR    R2,R1                   AND CHECK OUT STORAGE HEADER     00156000
         CLC   0(8,R1),0(R2)           IS IT =                          00157000
         BNE   RESLEEP                                                  00158000
STOFROK  EQU   *                                                        00159000
         ST    R1,TCASCSA              TELL CICS THE ADDRESS            00160000
         DFHSC TYPE=FREEMAIN                                            00161000
         SR    R15,R15                 OK RETCODE                       00162000
         B     RESLEEP                 BACK TO USER                     00163000
         TITLE 'HELP FILE READ REQUEST  '                               00164000
READHELP DS    0H                                                       00165000
         L     R4,56(R5)               GET HELPIOB (CALLER'S R9)        00166000
         USING HELPBLK,R4                                               00167000
         TM    HLPTYPE,HLPRELSE                                         00168000
         BO    FIOREL                                                   00169000
         MVI   CPLECD1,CPLNOTFD                                         00170000
         LH    R15,HLPKEYL             GET KEY LENGTH                   00171000
         LCR   R15,R15                 MAKE IT NEGATIVE                 00172000
         LA    R15,40(R15)             ADD TOTAL KEY LENGTH             00173000
         LTR   R15,R15                 NEED TO PAD IT????               00174000
         BZ    NOPAD                   ...NO                            00175000
         LA    R14,HLPKEY              GET KEY ADDRESS                  00176000
         AH    R14,HLPKEYL             ADD LENGTH                       00177000
         BCTR  R15,R0                  SET LENGTH FOR XC                00178000
         CH    R15,=H'20'                LENGTH GREATER THAN 20         00179000
         BL    PAD0                                                     00180000
         SH    R15,=H'20'                                               00181000
         EX    R15,PAD40                                                00182000
         XC    HLPKEY+20(20),HLPKEY+20                                  00183000
         B     NOPAD                                                    00184000
PAD0     DS    0H                                                       00185000
         EX    R15,PADKEY              CLEAR REST OF KEY                00186000
NOPAD    DS    0H                                                       00187000
         DFHFC TYPE=GET,DATASET=CAIHLPV,RDIDADR=HLPKEY,MODE=LOCATE,    X00188000
               NOTFND=NODATA,NORESP=RECOK,ILLOGIC=SETIOE,              X00189000
               IOERROR=SETIOE                                           00190000
         OI    HLPRETN,HLPIOER                                          00191000
         LA    R15,8                                                    00192000
         B     RESLEEP                                                  00193000
PADKEY   XC    0(1,R14),0(R14)                                          00194000
PAD40    MVC   0(1,R14),=CL20' '                                        00195000
SETIOE   DS    0H                                                       00196000
         MVC   CPLECD1,CPLIOER                                          00197000
         OI    HLPRETN,HLPIOER                                          00198000
         B     RELHLP                                                   00199000
NODATA   DS    0H                                                       00200000
         OI    HLPRETN,HLPNOTF                                          00201000
         B     RELHLP                                                   00202000
RECOK    DS    0H                                                       00203000
         L     VSWABAR,TCAFCAA         GET REC ADDRESS                  00204000
         L     R0,VSWAREA              GET REC                          00205000
         L     R1,VSWALEN              GET LENGTH                       00206000
         LA    R3,2048                                                  00207000
         LA    R2,HLPRDBF                                               00208000
         XC    0(12,R2),0(R2)          CLEAR HEADER                     00209000
         LA    R2,12(R2)               MAKE ROOM FOR HEADER STUFF       00210000
         MVCL  R2,R0                   MOVE RECORD                      00211000
         L     R1,VSWALEN              GET LENGTH                       00212000
         LA    R1,13(R1)               ADD FOR LENGTH AND HEADER        00213000
         LA    R3,HLPRDBF                                               00214000
         STH   R1,0(R3)                SET LENGTH                       00215000
         DFHFC TYPE=RELEASE                                             00216000
FIOREL   DS    0H                                                       00217000
         XC    CPLECD1,CPLECD1                                          00218000
         LA    R15,0                                                    00219000
         B     RESLEEP                                                  00220000
RELHLP   DS    0H                                                       00221000
         DFHFC TYPE=RELEASE                                             00222000
         LA    R15,4                                                    00223000
         B     RESLEEP                                                  00224000
         TITLE 'TERMINAL REQUEST HANDLER'                               00225000
TERMINAL EQU   *                       MAKE A LABEL                     00226000
         SR    R3,R3                   CLEAR R3                         00227000
         SR    R6,R6                   LIKEWISE R6                      00228000
         L     R4,UCPPRTA              TERMINAL REQUEST BUFFER          00229000
         LA    R4,0(R4)                CLEAN                            00230000
         CLI   1(R4),X'C2'             FREEKBD IS SPECIAL               00231000
         BE    WRWT                                                     00232000
         LH    R3,0(,R4)               TERMINAL REQUEST TYPE            00233000
         SLL   R3,2                    TIMES 4 FOR OFFSET               00234000
         B     *+0(R3)                 GOT TO ROUTINE                   00235000
         B     WT                      WAIT  ONLY                       00236000
         B     RD                      READ ONLY                        00237000
         B     RDWT                    READ-WAIT                        00238000
         B     WR                      WRITE ONLY                       00239000
         B     WRWT                    WRITE-WAIT                       00240000
         B     WRRD                    WRITE READ                       00241000
         B     WRRDWT                  WRITE-READ-WAIT                  00242000
         B     ER                      ERASE                            00243000
         B     ABLOGIC                 ERASE WAIT---ILLOGICAL FUNCTION  00244000
         B     ABLOGIC                 ERASE READ---ILLOGICAL FUNCTION  00245000
         B     ABLOGIC                 ERASE READ WAIT---ILLOGICAL FUNC 00246000
         B     ERWR                    ERASE WRITE                      00247000
         B     ERWRWT                  ERASE WRITE WAIT                 00248000
         B     ERWRRD                  ERASE WRITE READ                 00249000
         B     ERWRRDWT                ERASE WRITE READ WAIT            00250000
         EJECT                                                          00251000
ABLOGIC  DS    0H                                                       00252000
         LA    R15,20                                                   00253000
         B     EOJ                                                      00254000
WT       EQU   *                                                        00255000
         DFHTC TYPE=WAIT                                                00256000
         B     GOPGM                                                    00257000
         SPACE 2                                                        00258000
ER       EQU   *                                                        00259000
         DFHTC TYPE=ERASE                                               00260000
         B     GOPGM                                                    00261000
         SPACE 2                                                        00262000
RD       EQU   *                                                        00263000
         DFHTC TYPE=(READ,WAIT)                                         00264000
         BAL   R7,TD3270                                                00265000
         L     TIOABAR,TCTTEDA         ADDRESS OF INPUT BUFFER          00266000
         B     GOPGMR                  RETURN TO CALLER                 00267000
         SPACE 2                                                        00268000
WR       EQU   *                                                        00269000
         BAL   R7,BUILDOP              GO DO WRITE SETUP                00270000
         DFHTC TYPE=WRITE                                               00271000
         DFHTC TYPE=WAIT               WAIT FOR IO TO COMPLETE          00272000
         B     GOPGM                   RETURN TO CALLER                 00273000
         SPACE 2                                                        00274000
RDWT     EQU   *                       READ-WAIT                        00275000
         DFHTC TYPE=(READ,WAIT)                                         00276000
         BAL   R7,TD3270                                                00277000
         L     TIOABAR,TCTTEDA         TERM IO BUFFER ADDR TO REG       00278000
         B     GOPGMR                  RETURN TO CALLER                 00279000
         SPACE 2                                                        00280000
WRWT     EQU   *                       WRITE-WAIT                       00281000
         BAL   R7,BUILDOP              SET UP FOR WRITE                 00282000
         CLI   TIOACLCR,X'C2'                                           00283000
         BE    WTCTLC                                                   00284000
         DFHTC TYPE=(WRITE,WAIT)                                        00285000
         B     GOPGM                   RETURN TO CALLER                 00286000
WTCTLC   DFHTC TYPE=WRITE,CTLCHAR=YES                                   00287000
         DFHTC TYPE=WAIT               WAIT FOR IO TO COMPLETE          00288000
         B     GOPGM                                                    00289000
         SPACE 2                                                        00290000
WRRD     EQU   *                       WRITE-READ-(IMPLIED WAIT)        00291000
WRRDWT   EQU   *                       EQUAL FUNCTION (SPECIFIED WAIT)  00292000
         BAL   R7,BUILDOP              SET UP FOR TERMINAL WRITE        00293000
         DFHTC TYPE=(WRITE,WAIT)                                        00294000
RTID     DFHTC TYPE=(READ,WAIT)               READ NEW DATA             00295000
         BAL   R7,TD3270                                                00296000
         L     TIOABAR,TCTTEDA         TERM IO BUFFER ADDR TO REG       00297000
         B     GOPGMR                  RETURN TO CALLER                 00298000
         SPACE 2                                                        00299000
ERWR     EQU   *                       ERASE-WRITE                      00300000
         BAL   R7,BUILDOP              SET UP FOR TERMINAL WRITE        00301000
         DFHTC TYPE=(ERASE,WRITE)                                       00302000
         DFHTC TYPE=WAIT               WAIT FOR IO TO COMPLETE          00303000
         B     GOPGM                   RETURN TO CALLER                 00304000
         SPACE 2                                                        00305000
ERWRWT   EQU   *                       ERASE-WRITE-WAIT                 00306000
         BAL   R7,BUILDOP              SET UP FOR TERMINAL WRITE        00307000
         DFHTC TYPE=(ERASE,WRITE,WAIT)                                  00308000
         B     GOPGM                   RETURN TO CALLER                 00309000
         SPACE 2                                                        00310000
ERWRRD   EQU   *                       ERASE-WRITE-READ (IMPLIED WAIT)  00311000
ERWRRDWT EQU   *                       FUNCTIONAL EQUIVALENT--SPECIFIED 00312000
         BAL   R7,BUILDOP              SET UP FOR TERMINAL WRITE        00313000
         DFHTC TYPE=(ERASE,WRITE,READ,WAIT)                             00314000
         BAL   R7,TD3270                                                00315000
         L     TIOABAR,TCTTEDA         TERM IO BUFFER ADDR TO REG       00316000
         B     GOPGMR                  RETURN TO CALLER                 00317000
         TITLE 'BUILD TERMINAL OUTPUT BUFFER ROUTINE'                   00318000
BUILDOP  EQU   *                       SET UP TERMINAL WRITES           00319000
         MVC   TCASCNB,2(R4)           SCREEN LENGTH FOR GETMAIN        00320000
         NI    TCASCNB,X'7F'           CLEAR THE BIT                    00321000
         DFHSC TYPE=GETMAIN,CLASS=TERMINAL,INITIMG=00,COND=(NO,ABSTRG)  00322000
         L     TIOABAR,TCASCSA         ADDRESS STORAGE                  00323000
         MVC   TIOATDL(2),2(R4)        TELL CICS TERMINAL IO LENGTH     00324000
         NI    TIOATDL,X'7F'           CLEAR SAVE BIT                   00325000
         LH    R6,TIOATDL              GET LENGTH                       00326000
         ST    TIOABAR,TCTTEDA         TELL HIM SCREEN ADDRESS          00327000
CTIOA    CH    R6,=H'256'                                               00328000
         BNH   LASTMVC                                                  00329000
         MVC   TIOADBA(256),4(R4)                                       00330000
         LA    TIOABAR,256(,TIOABAR)                                    00331000
         LA    R4,256(,R4)                                              00332000
         SH    R6,=H'256'                                               00333000
         B     CTIOA                                                    00334000
LASTMVC  BCTR  R6,0                                                     00335000
         EX    R6,MVSCREEN                                              00336000
         L     R4,UCPPRTA              GET BUFFER ADDRESS AGAIN         00337000
         CLI   1(R4),X'C2'             CTLCHAR PRESENT                  00338000
         BNE   CDEL                                                     00339000
         MVI   TIOACLCR,X'C2'                                           00340000
CDEL     TM    2(R4),X'80'             NO DELETE BIT ON?                00341000
         BO    OUT7                    YES ... LEAVE IT                 00342000
         SH    R4,=H'8'                POINT TO ALLEGED STRG ACCTNG     00343000
         TM    0(R4),X'80'             SHOULD HAVE AT LEAST 8 BIT ON    00344000
         BNO   OUT7                    NO 8 BIT DON'T FREE IT           00345000
         CLC   2(2,R4),=X'0000'        IS THERE A LENGTH                00346000
         BE    OUT7                    L=0 DON'T FREE                   00347000
         LR    R6,R4                   VERIFY BOTH ACCTNG AREAS EQUAL   00348000
         AH    R6,2(R4)                POINT TO ENDING STRG ACCTNG AREA 00349000
         CLC   0(8,R4),0(R6)           ARE THEY THE SAME?               00350000
         BNE   OUT7                    NO ... LEAVE IT ALONE            00351000
         ST    R4,TCASCSA              PUT STRG ADDR INTO TCA           00352000
         DFHSC TYPE=FREEMAIN                                            00353000
OUT7     BR    R7                      GO BACK                          00354000
         SPACE 3                                                        00355000
MVSCREEN MVC   TIOADBA(0),4(R4)        MVC   EX FOR SCREEN BUFFERS      00356000
         TITLE '3270 BUFFER TO TRANS DATA'                              00357000
TD3270   EQU   *                                                        00358000
         L     TIOABAR,TCTTEDA                                          00359000
         LA    TIOABAR,8(TIOABAR)                                       00360000
         ST    TIOABAR,UCPRDRA                                          00361000
         BR    R7                      NOT PA 2   GO BACK               00362000
         TITLE 'RETURN TO CALLER ROUTINE'                               00363000
GOPGMR   EQU   *                       RETURN TO CALLER FROM READ       00364000
         LH    R2,TCTTECAD              GET RELATIVE CURSOR ADDRESS     00365000
         LA    R1,X'3F'                 CONVERT                         00366000
         NR    R1,R2                    RELATIVE                        00367000
         SRL   R2,6                     CURSOR ADDRESS                  00368000
         STC   R2,UCPUSER+20                                            00369000
         STC   R1,UCPUSER+21                                            00370000
         TR    UCPUSER+20(2),*+10                                       00371000
         B     *+4+X'40'                CONTINUE                        00372000
         DC    X'40C1C2C3C4C5C6C7C8C94A4B4C4D4E4F'                      00373000
         DC    X'50D1D2D3D4D5D6D7D8D95A5B5C5D5E5F'                      00374000
         DC    X'6061E2E3E4E5E6E7E8E96A6B6C6D6E6F'                      00375000
         DC    X'F0F1F2F3F4F5F6F7F8F97A7B7C7D7E7F'                      00376000
         MVC   UCPPASA(1),TCTTEAID     GIVE AID BYTE                    00377000
         CLI   UCPPASA,X'F1'           HELP PFKEY?                      00378000
         BE    PFHELP                  YES...GO TO HELP                 00379000
         L     R1,UCPRDRA              GET INPUT DATA                   00380000
         LH    R2,0(R1)                GET LENGTH OF INPUT DATA         00381000
         LTR   R2,R2                   IS IT SHORT READ                 00382000
         BZ    GOPGM                  ...YES IT IS                      00383000
         CH    R2,=H'100'              LESS THAN 100 BYTES              00384000
         BL    HLPSRCH                                                  00385000
         LA    R2,100                  LIMIT SEARCH TO 100              00386000
HLPSRCH  DS    0H                                                       00387000
         CLC   =X'11C1D6',0(R1)        IS IT COMMAND LINE????           00388000
         BE    HLPSRCH2                ...YES                           00389000
         LA    R1,1(,R1)               NEXT POSITION FOR SCAN           00390000
         BCT   R2,HLPSRCH              KEEP LOOKING                     00391000
         B     GOPGM                  ...RETURN                         00392000
HLPSRCH2 DS    0H                                                       00393000
         LA    R1,3(R1)                POINT TO DATA                    00394000
         LA    R2,10                   LIMIT SEARCH TO 10               00395000
HLPSRCH3 DS    0H                                                       00396000
         CLC   =C'HELP',0(R1)          IS IT HELP                       00397000
         BE    GOTOHELP                ...YES                           00398000
         CLC   =X'88859397',0(R1)      IS IT HELP (LOWER CASE)          00399000
         BE    GOTOHELP                ...YES                           00400000
         CLI   0(R1),X'40'             ANY OTHER KIND OF DATA?          00401000
         BH    GOPGM                   ...YES,GO AWAY                   00402000
         LA    R1,1(,R1)               NEXT POSITION                    00403000
         BCT   R2,HLPSRCH3             KEEP LOOKING                     00404000
         B     GOPGM                   NOT HELP,GO BACK                 00405000
PFHELP   DS    0H                                                       00406000
         MVC   UCPUSER(20),=CL20' '    CLEAR BUFFER                     00407000
         LA    R1,15(,R10)             POINT AT SCREEN ID               00408000
         LA    R2,UCPUSER                                               00409000
         LA    R3,20                                                    00410000
GETKEY   DS    0H                                                       00411000
         CLI   0(R1),X'40'                                              00412000
         BL    READB                                                    00413000
         MVC   0(1,R2),0(R1)                                            00414000
         LA    R1,1(,R1)                                                00415000
         LA    R2,1(,R2)                                                00416000
         BCT   R3,GETKEY                                                00417000
         B     READB                                                    00418000
GOTOHELP DS    0H                                                       00419000
         MVC   UCPUSER(20),=CL20' '    CLEAR BUFFER                     00420000
         MVC   UCPUSER(4),=C'HELP'     SET HELP KEY                     00421000
         OC    5(10,R1),5(R1)          ONLY HELP SPECIFIED?             00422000
         BZ    READB                   YES...BRANCH                     00423000
         MVC   UCPUSER(20),5(R1)       SAVE HELP KEY                    00424000
READB    DS    0H                                                       00425000
         DFHTC TYPE=(READB,WAIT)                                        00426000
         MVC   UCPPRTA,TCTTEDA         SAVE CURRENT PANEL               00427000
*                                                                       00428000
         MVC   TCASCNB,=H'52'          NUMBER OF BYTES                  00429000
         DFHSC TYPE=GETMAIN,CLASS=USER,INITIMG=00,COND=(NO,ABSTRG)      00430000
         L     TIOABAR,TCASCSA         DUMMY TIOA                       00431000
         ST    TIOABAR,TCTTEDA         PASS ADDRESS TO HELP             00432000
         MVC   TIOADBA(5),=CL5'HELP '                                   00433000
         MVC   TIOADBA+5(20),UCPUSER   GIVE HELP KEY                    00434000
         TM    TCTE32SF,TCTEWA+TCTEALW      ALTERNATE SCREEN SIZE?      00464100
         BNO   NOTMOD5                      NO...BRANCH                 00464200
         CLI   TCTEASCC,X'84'               132 COLUMNS?                00464300
         BNE   NOTMOD5                      NO...BRANCH                 00464400
         MVI   TIOADBA+30,C'5'              INDICATE MODEL 5            00464500
NOTMOD5  DS    0H                                                       00464600
*                                                                       00435000
         MVC   TCAPCPI,=CL8'CASOHLPA'                                   00436000
         DFHPC TYPE=LINK,COND=YES                                       00437000
         ST    TIOABAR,TCASCSA         ADDRESS TO FREE                  00438000
         DFHSC TYPE=FREEMAIN                                            00439000
WRITEB   EQU   *                                                        00440000
         L     R4,UCPPRTA              GET ADDRESS OF SAVED SCREEN      00441000
         LH    R6,8(R4)                SCREEN LENGTH FOR GETMAIN        00442000
         LA    R6,7(R6)                FOR MY STUFF                     00443000
         STH   R6,TCASCNB              CLEAR THE BIT                    00444000
         DFHSC TYPE=GETMAIN,CLASS=TERMINAL,INITIMG=00,COND=(NO,ABSTRG)  00445000
         L     TIOABAR,TCASCSA         ADDRESS STORAGE                  00446000
         STH   R6,TIOATDL              CLEAN UP 6                       00447000
         SH    R6,=H'7'                RESET LENGTH                     00448000
         ST    TIOABAR,TCTTEDA         TELL HIM SCREEN ADDRESS          00449000
         MVC   TIOADBA(3),=X'114040'   SETUP SBA @ R01,COL01            00450000
         LA    TIOABAR,3(TIOABAR)      ADJUST OP REG                    00451000
         LA    R4,12(R4)               POINT TO BUFFER DATA             00452000
CTIOAA   CH    R6,=H'256'                                               00453000
         BNH   LASTMVCA                                                 00454000
         MVC   TIOADBA(256),0(R4)                                       00455000
         LA    TIOABAR,256(,TIOABAR)                                    00456000
         LA    R4,256(,R4)                                              00457000
         SH    R6,=H'256'                                               00458000
         B     CTIOAA                                                   00459000
LASTMVCA BCTR  R6,0                                                     00460000
         EX    R6,MOVESCRN             MOVE THE LAST BIT                00461000
         ALR   TIOABAR,R6              POINT TO END-1                   00462000
         LA    TIOABAR,1(TIOABAR)      POINT TO END                     00463000
         L     R4,UCPPRTA                                               00464000
         MVC   TCASCSA,UCPPRTA         RELEASE SAVED BUFFER             00465000
         MVI   TIOADBA,X'11'           SET SBA FOR INSCUR               00466000
         MVC   TIOADBA+1(2),UCPUSER+20      GET CURSOR ADDRESS          00467000
         MVI   TIOADBA+3,X'13'         SET INSCUR                       00468000
         DFHSC TYPE=FREEMAIN                                            00469000
         DFHTC TYPE=(WRITE,WAIT)                                        00470000
         B     RD                      RETURN TO CALLER                 00471000
         SPACE 1                                                        00472000
MOVESCRN MVC   TIOADBA(0),0(R4)        MVC EX FOR SCREEN BUFFERS(HELP)  00473000
         SPACE 1                                                        00474000
GOPGM    EQU   *                       RETURN TO CALLER                 00475000
         SR    R15,R15                                                  00476000
RESLEEP  EQU   *                       RETURN TO CALLER                 00477000
         LR    R13,R5                  GET INCOMONG SAVEAREA            00478000
         ST    R15,16(R13)             GIVE RETCODE                     00479000
         LM    R14,R12,12(R13)         GET READY TO GO BACK             00480000
         BR    R14                     GO BACK                          00481000
         TITLE 'ABEND HANDLERS'                                         00482000
         LTORG                                                          00483000
         PRINT ON,DATA                                                  00484000
PATCH1   EQU   *                                                        00485000
         DC    250S(*)                                                  00486000
         SPACE 02                                                       00487000
         ORG   PATCH1                                                   00488000
         DC    250H'-1'                                                 00489000
         EJECT                                                          00490000
HELPUTLA DSECT                                                          00491000
         SPACE 1                                                        00492000
*********************************************************************** 00493000
****                                                               **** 00494000
****       NON -- ADAPTER UTILITY PARAMETER AREA DESCRIPTION       **** 00495000
****                CICS  ONLY    SYSTEMS                          **** 00496000
****                                                               **** 00497000
****            COMPUTER ASSOCIATES INTERNATIONAL INC.             **** 00498000
****           125 JERICHO TURNPIKE, JERICHO, L.I., N.Y.           **** 00499000
****                                                               **** 00500000
****                   COPYRIGHT - 1984                            **** 00501000
****                                                               **** 00502000
*********************************************************************** 00503000
         SPACE 1                                                        00504000
UCSRVAD  DS    A ......................ADDRESS OF SERVICE MODULE        00505000
UCEPRAD  DS    A ......................ADDRESS OF EXTERNAL 'PARM' (OS)  00506000
UCSYIND  DS    XL1 ....................SYSTEM CONFIGURATION INDICATORS  00507000
UCMOSVS  EQU   B'10000000' ----------->...RUNNING ON OS/VS1 OR OS/VS2   00508000
UCMSGIN  EQU   B'01000000' ----------->...COMMAND I/P FROM CONSOLE      00509000
UCDELETE EQU   B'00100000' ----------->...LINK FINISHED DELETE PROGRAM  00510000
UCFULLSC EQU   B'00010000' ----------->...I/O IS FULL SCREEN            00511000
UCSYEOJ  EQU   B'00001000' ----------->...EOJ OCCURING                  00512000
UCEURPN  EQU   B'00000100' ----------->...EUROPEAN DATE TYPE            00513000
UCSYSLC  DS    XL1 ....................SYSTEM LINE COUNT FOR SYSPRINT   00514000
UCREQCD  DS    XL2 ....................SERVICE REQUEST VECTOR           00515000
UCREQVC  EQU   UCREQCD+1 ..............(TO ALLOW 'MVI' OF REQUEST)      00516000
UCVFREE  EQU   0 --------------------->...ALLOCATE FREE-STORAGE         00517000
UCVFRET  EQU   4 --------------------->...RELEASE FREE-STORAGE          00518000
UCVCGET  EQU   8 --------------------->...READ A RECORD FROM SYSIN      00519000
UCVPPUT  EQU   12 -------------------->...WRITE A LINE TO SYSPRINT      00520000
UCVLINK  EQU   16 -------------------->...LINK A UTILITY SUBPROGRAM     00521000
UCVMESA  EQU   20 -------------------->...INVOKE MAIN SYSTEM ADAPTER    00522000
UCVOPNR  EQU   24 -------------------->...OPEN A DATA-SET               00523000
UCVTRDR  EQU   28 -------------------->...ISSUE TAPE READ REQUEST       00524000
UCVTWTR  EQU   32 -------------------->...ISSUE TAPE WRITE REQUEST      00525000
UCVCLSR  EQU   36 -------------------->...CLOSE A DATA-SET              00526000
UCVSRTI  EQU   40 -----S.R.A.M.------->...INITIALIZE SRAM STORAGE       00527000
UCVSRTO  EQU   44 -----S.R.A.M.------->...CALL SORT OPEN                00528000
UCVSRTC  EQU   48 -----S.R.A.M.------->...CALL SORT CLOSE               00529000
UCVSRTF  EQU   52 -----S.R.A.M.------->...CALL SORT FILL                00530000
UCVSRTG  EQU   56 -----S.R.A.M.------->...CALL SORT GET                 00531000
UCVSRTR  EQU   60 -----S.R.A.M.------->...CALL SORT RE-OPEN             00532000
         SPACE 1                                                        00533000
*--------------------------------------------------------------------*  00534000
* --- SERVICE RELATED FIELDS FOLLOW, INITIALIZED BY APPROPRIATE      *  00535000
*     PROCESSOR BEFORE RETURNING CONTROL TO THE UTILITY.             *  00536000
*                                                                    *  00537000
*                     REFERENCED BY..  CONTENTS......................*  00538000
UCPSCLN  DS    1F --> UCVFREE,UCVFRET  STORAGE ELEMENT LENGTH        *  00539000
UCPSCIC  EQU   UCPSCLN+1 ---> UCVFREE  STORAGE INITIALIZATION BYTE   *  00540000
UCPSCAD  DS    1F --> UCVFREE,UCVFRET  ADDRESS OF STORAGE ELEMENT    *  00541000
UCPRDRA  DS    1F --> UCVCGET          ADDRESS OF NEXT SYSIN RECORD  *  00542000
*                                      (SET TO '0' WHEN EOF OCCURS)  *  00543000
UCPPRTA  DS    1F ----------> UCVPPUT  ADDRESS OF NEXT SYSPRINT LINE *  00544000
UCPPASA  EQU   UCPPRTA  ----> UCVPPUT  SYSPRINT ASA CTLCHAR          *  00545000
UCPOCRA  DS    1F --> UCVTRDR,UCVTWTR  CURRENT OCRPL BLOCK ADDRESS   *  00546000
UCPPNAM  DS    CL8 -> UCVLINK          UTILITY SUBPROGRAM NAME ......*  00547000
         SPACE 1                                                        00548000
UCPUSER  DS    16F                     USER SCRATCH-PAD WORKAREA        00549000
UCPRDREX DS    F                       SYSIN RDR EXIT ADDRESS           00550000
UCPPRTEX DS    F                       SYSLST EXIT ADDRESS              00551000
UPPEND   EQU   *      ---END OF UTILITY COMMUNICATIONS AREA---          00552000
UCPLEN   EQU   UPPEND-UCSRVAD   LENGTH OF COMMUNICATIONS AREA           00553000
         EJECT                                                          00554000
ECBLIST  DS    A(*-*)                                                   00555000
         DS    A(*-*)                                                   00556000
         DS    A(*-*)                                                   00557000
ADAPTECB DS    F                                                        00558000
SERVECB  DS    F                                                        00559000
TERMECB  DS    F                                                        00560000
SUBSAVE  DS    CL128                                                    00561000
         ORG   SUBSAVE                                                  00562000
SUBNAME  DS    CL8                                                      00563000
SUBPSW   DS    CL8                                                      00564000
SAVEDR9  DS    F                                                        00565000
SAVEDRA  DS    F                                                        00566000
SAVEDRB  DS    F                                                        00567000
SAVEDRC  DS    F                                                        00568000
SAVEDRD  DS    F                                                        00569000
SAVEDRE  DS    F                                                        00570000
SAVEDRF  DS    F                                                        00571000
SAVEDR0  DS    F                                                        00572000
SAVEDR1  DS    F                                                        00573000
SAVEDR2  DS    F                                                        00574000
SAVEDR3  DS    F                                                        00575000
SAVEDR4  DS    F                                                        00576000
SAVEDR5  DS    F                                                        00577000
SAVEDR6  DS    F                                                        00578000
SAVEDR7  DS    F                                                        00579000
SAVEDR8  DS    F                                                        00580000
VSWABAR  EQU   7                                                        00581000
         EJECT                                                          00582000
PREV     EQU   4                                                        00583000
NEXT     EQU   8                                                        00584000
R0       EQU   0                                                        00585000
R1       EQU   1                                                        00586000
R2       EQU   2                                                        00587000
R3       EQU   3                                                        00588000
R4       EQU   4                                                        00589000
R5       EQU   5                                                        00590000
R6       EQU   6                                                        00591000
R7       EQU   7                                                        00592000
R8       EQU   8                                                        00593000
R9       EQU   9                                                        00594000
R10      EQU   10                                                       00595000
R11      EQU   11                                                       00596000
R12      EQU   12                                                       00597000
R13      EQU   13                                                       00598000
R14      EQU   14                                                       00599000
R15      EQU   15                                                       00600000
TCTTEAR  EQU   R11                                                      00601000
TIOABAR  EQU   R10                                                      00602000
BASE     EQU   R9                                                       00603000
COMMBASE EQU   R8                                                       00604000
BIT0     EQU   B'10000000'         EQUATE FOR TESTING/SETTING BIT 0     00605000
BIT1     EQU   B'01000000'         EQUATE FOR TESTING/SETTING BIT 1     00606000
BIT2     EQU   B'00100000'         EQUATE FOR TESTING/SETTING BIT 2     00607000
BIT3     EQU   B'00010000'         EQUATE FOR TESTING/SETTING BIT 3     00608000
BIT4     EQU   B'00001000'         EQUATE FOR TESTING/SETTING BIT 4     00609000
BIT5     EQU   B'00000100'         EQUATE FOR TESTING/SETTING BIT 5     00610000
BIT6     EQU   B'00000010'         EQUATE FOR TESTING/SETTING BIT 6     00611000
BIT7     EQU   B'00000001'         EQUATE FOR TESTING/SETTING BIT 7     00612000
         EJECT                                                          00613000
HELPBLK  DSECT                                                          00614000
HLPIOB   DS    0D                                                       00615000
HLPKEYL  DC    H'0'                    HELP KEY LENGTH                  00616000
HLPKEY   DC    CL20' '                  HELP DATA KEY                   00617000
HLPSUBK1 DC    XL2'00'                 SUB KEY 1                        00618000
HLPSUBK2 DC    XL2'00'                 SUB KEY 2                        00619000
HLPSUBK3 DC    XL2'00'                 SUB KEY 3                        00620000
HLPSUBK4 DC    XL2'00'                 SUB KEY 4                        00621000
HLPSUBK5 DC    XL2'00'                 SUB KEY 5                        00622000
HLPSUBK6 DC    XL2'00'                 SUB KEY 6                        00623000
HLPSUBK7 DC    XL2'00'                 SUB KEY 7                        00624000
HLPSUBK8 DC    XL2'00'                 SUB KEY 8                        00625000
HLPRECN  DC    XL4'00'                 RECORD NUMBER                    00626000
HLPTYPE  DC    XL1'0'                                                   00627000
HLPGET   EQU   B'10000000'             GET RECORD                       00628000
HLPSHOWL EQU   B'01000000'             SHOW LAST COMMAND                00629000
HLPRELSE EQU   B'00100000'             RELEASE STORAGE (DEQ DBASE)      00630000
HLPGNEXT EQU   B'00010000'             GET NEXT RECORD                  00631000
HLPRETN  DC    XL1'0'                                                   00632000
HLPNOTF  EQU   B'10000000'             NOT FOUND                        00633000
HLPEOF   EQU   B'01000000'             END OF DATA                      00634000
HLPFRST  EQU   B'00100000'             GOT DIR FLG                      00635000
HLPEOR   EQU   B'00010000'             END OF PANEL (RECORD)            00636000
HLPIOER  EQU   B'00001000'             IO ERROR                         00637000
HLPREC   DC    CL256' '                DATA LINE BUFFER                 00638000
HLPRECL  DC    H'0'                    DATA LINE LENGTH                 00639000
HDWRK    DC    D'0'                    DOUBLE WORD WORK AREA            00640000
HJCLBFR  DC    A(0)                    EXTRA BUFFER                     00641000
HLPRESV  DC    XL80'0'                 ***RESERVED                      00642000
RELOF    DC    F'0'                    RELOCATION SAVE                  00643000
CALRRETN DC    F'0'                    CALL  RETURN                     00644000
TBUFADR  DC    F'0'                    TERMINAL INPUT ADDESS            00645000
STRGADDR DC    F'0'                    GOTTEN STORAGE ADDRESS           00646000
CALLSAVE DC    3F'0'                   REG SAVE                         00647000
FLDCNT   DC    F'0'                    TERM INPUT FIELD COUNT           00648000
FLDLIST  DC    90H'0'                  TERM INPUT FIELD LIST            00649000
PUSHKEY  DC    X'00'                   TERMINAL KEY                     00650000
TRMODL   DC    C'2'                    TERMINAL MODEL                   00651000
         DS    0F                                                       00652000
HLPRDBF  DC    2060X'0'                HELP I/O BUFFER                  00653000
SUBKCTR  DC    F'0'                                                     00654000
BYTES2GO DC    F'0'                                                     00655000
RECPOS   DC    F'0'                                                     00656000
GFIRST   DC    X'00'                                                    00657000
SCRIDA   DC    CL20' '                                                  00658000
         DC    CL20' '                                                  00659000
SCRIDB   DC    CL4' '                                                   00660000
CMDFLG   DC    X'0'                                                     00661000
CREPEAT  EQU   B'10000000'             REPEAT LAST COMMAND              00662000
CKEEPC   EQU   B'01000000'             SAVE   LAST COMMAND              00663000
CMDTL    DC    H'0'                                                     00664000
CLAST    DC    CL66' '                 LAST COMMAND                     00665000
RBA      DC    F'0'                                                     00666000
IRBA     DC    F'0'                                                     00667000
*********************************************************************** 00668000
***      CATALOG MANAGEMENT PARAMETER LIST DSECT                    *** 00669000
*********************************************************************** 00670000
         SPACE 1                                                        00671000
CPL      DC    0D'0'               CATALOG MANAGEMENT PARAMETER LIST    00672000
CPLSANAM DC    CL8'CACNLOG0'            CATALOG MANAGEMENT MODULE NAME  00673000
CPLACACB DC    A(0)                     ADDR OF CATALOG ACCESS CNTL BLK 00674000
CPLIXKEY DC    A(0)                     ADDR OF INDEX KEY DATA V0500036 00675000
CPLIXRID DC    A(0)                     ADDR OF INDEX RECORD IDV0500036 00676000
CPLARBA  DC    A(0)                     ADDR OF RELATIVE BYTE ADDRESS   00677000
CPLLRBA  DC    A(0)                     RBA OF NEXT LOGICAL RECORD      00678000
         ORG   CPLLRBA                  RESET LOCATION COUNTER GB52M003 00679000
CPLIXRBA DC    A(0)                     ADDR OF RBA OF INDEX   V0500036 00680000
CPLNXTPL DC    A(0)                     ADDRESS OF NEXT PLIST IN CHAIN  00681000
CPLABUF  DC    A(0)                     ADDR OF USER'S BUFFER           00682000
CPLBUFLN DC    AL2(0)                   LENGTH OF USER'S BUFFER         00683000
CPLKEYLN DC    AL2(0)                   LENGTH OF KEY FOR GENERIC CALLS 00684000
CPLLRECL DC    AL2(0)                   LOGICAL RECORD LENGTH           00685000
CPLVOLSQ DC    AL2(0)                   VOLUME SEQUENCE NUMBER V0500036 00686000
         ORG   CPLVOLSQ                 EXTENT AND VOL OCCUPY SAME POS. 00687000
CPLEXTNT DC    AL2(0)                   EXTENT SEQUENCE NUMBER V0500036 00688000
         ORG   CPLVOLSQ                 RESET LOCATION COUNTER V0500013 00689000
CPLIXDSP DC    AL2(0)                   INDEX RECORD DISPLACEMEV0500036 00690000
CPLFILSQ DC    AL2(0)                   FILE SEQUENCE NUMBER            00691000
CPLVERSN DC    AL2(0)                   VERSION NUMBER                  00692000
CPLVAULT DC    CL1'A'                   VAULT IDENTIFICATION CHV0500036 00693000
         ORG   CPLVAULT                 RESET LOCATION COUNTER V0500036 00694000
CPLIXNUM DC    CL1'A'                   INDEX NUMBER           V0500036 00695000
CPLOPT1  DC    B'10000000'              PROCESSING OPTIONS     V0500036 00696000
CPLDSN   EQU   BIT0                     ACCESS BY DATASET NAME          00697000
CPLVOL   EQU   BIT1                     ACCESS BY VOLUME SERIAL NUMBER  00698000
CPLRBA   EQU   BIT2                     ACCESS BY RELATIVE BYTE ADDRESS 00699000
CPLSEQ   EQU   BIT3                     READ CATALOG SEQUENTIALLY       00700000
CPLGEN   EQU   BIT4                     GENERIC KEY SEARCH              00701000
CPLKGE   EQU   BIT5                     SEARCH KEY GREATER OR EQUAL TO  00702000
CPLBAT   EQU   BIT6                     ENQUEUE CATALOG FOR BATCH PROC. 00703000
CPLNUP   EQU   BIT7                     REQUEST IS NOT FOR UPDATE       00704000
CPLOPT2  DC    B'00000000'              PROCESSING OPTIONS     V0500036 00705000
CPLNOW   EQU   BIT0                     DO NOT WAIT FOR ENQUEUE0105DA77 00706000
CPLRVN   EQU   BIT1                     RETURN VERSION NUMBER  V0421063 00707000
CPLNOC   EQU   BIT2                     DO NOT COMPRESS INDEX  V0500039 00708000
CPLDASD  EQU   BIT3                     GETGBE DASD ONLY SEARCHV051M005 00709000
*        EQU   BIT4                     (RESERVED)                      00710000
*        EQU   BIT5                     (RESERVED)                      00711000
CPLRRD   EQU   BIT6                     RE-READ SPECIFIED RECORV0421007 00712000
CPLLOC   EQU   BIT7                     LOCATE MODE REQUEST             00713000
CPLIXPAD DC    CL1' '                   INDEX ENTRY PAD CHAR.  V0500036 00714000
CPLRTNCD DC    X'00'                    RETURN CODE IN REGISTER 15      00715000
CPLNOERR EQU   X'00'                         NO ERROR OCCURRED          00716000
CPLLOGER EQU   X'08'                         LOGICAL ERROR              00717000
CPLPHYER EQU   X'0C'                         PHYSICAL ERROR             00718000
CPLICPL  EQU   X'10'                         INVALID CPL ADDRESS        00719000
CPLECD1  DC    X'00'                    ERROR CODE BYTE 1               00720000
*                                         LOGIAL ERRORS                 00721000
CPLICACB EQU   X'04'                         INVALID ADDRESS OF CACB    00722000
CPLIFUNC EQU   X'08'                         INVALID FUNCTION CODE      00723000
CPLNOFRE EQU   X'0C'                         NO FREE STORAGE AVAILABLE  00724000
CPLIADSN EQU   X'10'                         INVALID ADDRESS OF DSN     00725000
CPLIAVOL EQU   X'14'                         INVALID ADDRESS OF VOLSER  00726000
CPLIARBA EQU   X'18'                         INVALID ADDRESS OF RBA     00727000
CPLINXPL EQU   X'1C'                         INVALID ADDRESS OF NEXTPL  00728000
CPLIABUF EQU   X'20'                         INVALID ADDRESS OF BUFFER  00729000
CPLIBFLN EQU   X'24'                         INVALID BUFFER LENGTH      00730000
CPLIKYLN EQU   X'28'                         INVALID KEY LENGTH         00731000
CPLILREC EQU   X'2C'                         INVALID LRECL              00732000
CPLIVOLS EQU   X'30'                         INVALID VOLUME SEQ. NO.    00733000
CPLIFILS EQU   X'34'                         INVALID FILE SEQUENCE NO.  00734000
CPLIVERS EQU   X'38'                         INVALID VERSION NUMBER     00735000
CPLIVALT EQU   X'3C'                         INVALID VAULT IDENTIFIER   00736000
CPLIOPTS EQU   X'40'                         INVALID CPL OPTIONS        00737000
CPLICOMB EQU   X'44'                         INVALID CPL/FUNCT COMB.    00738000
CPLITABL EQU   X'48'                         INVALID COMB. TABLE        00739000
CPLNOCAT EQU   X'4C'                         NO CATALOGS TO ACCESS      00740000
CPLENQF  EQU   X'50'                         ENQUEUE FAILED             00741000
CPLNOREC EQU   X'54'                         NO RECORD FOUND AT RBA     00742000
CPLNOPRE EQU   X'58'                         NO PREVIOUS GET OR ADD     00743000
CPLEOF   EQU   X'5C'                         LOGICAL END-OF-FILE        00744000
CPLNOTFD EQU   X'5C'                         RECORD NOT FOUND           00745000
CPLIRID  EQU   X'60'                         INVALID RECORD ID          00746000
CPLNOSPC EQU   X'64'                         NO SPACE TO ADD RECORD     00747000
CPLLNKER EQU   X'68'                         A LINK ALREADY EXISTS      00748000
CPLDUP   EQU   X'6C'                         DUPLICATE RECORD           00749000
CPLIDSN  EQU   X'70'                         INVALID DATASET NAME       00750000
CPLLENER EQU   X'74'                         BUFFER TOO SHORT FOR REC.  00751000
CPLGGAP  EQU   X'78'                         GENERATION GAP    V0421007 00752000
CPLOBTER EQU   X'7C'                         ERROR DURING OBTAIN FUNCT. 00753000
CPLDIRER EQU   X'80'                         INVALID DATASET INDEX REC. 00754000
CPLDBRER EQU   X'84'                         PRE-MATURE END-OF-CHAIN    00755000
CPLFLSER EQU   X'88'                         FILE SEQ. NOT FOUND        00756000
CPLNOVOL EQU   X'8C'                         NO MATCHING VOLUME FOUND   00757000
CPLVIRER EQU   X'90'                         INVALID VOLUME INDEX REC.  00758000
CPLVBRER EQU   X'94'                         PRE-MATURE END-OF-CHAIN    00759000
CPLAUDER EQU   X'98'                         AUDIT ERROR OCCURRED       00760000
CPLBADRC EQU   X'9C'                         AUDIT EXIT GAVE BAD RTNCD  00761000
CPLICCR  EQU   X'A0'                         INVALID CATALOG CNTRL REC. 00762000
CPLFMTER EQU   X'A4'                         RBA OUTSIDE FORMATV0421007 00763000
CPLSAVER EQU   X'A8'                         SAVER ERROR       V0421058 00764000
CPLIAIRB EQU   X'AC'                         INVALID INDEX RBA V0500013 00765000
CPLIIXDS EQU   X'B0'                         INVALID INDEX DISPV0500013 00766000
CPLIIXNO EQU   X'B4'                         INVALID INDEX NUM.GB52M007 00767000
*                                         PHYSICAL ERRORS               00768000
CPLIOER  EQU   X'04'                         AN I/O ERROR OCCURRED      00769000
CPLECD2  DC    X'00'                    ERROR CODE BYTE 2               00770000
CPLRTNID EQU   CPLECD2                  ERROR ROUTINE IDENT.   V0500021 00771000
CPLECD3  DC    X'00'                    ERROR CODE BYTE 3               00772000
CPLSARC  EQU   CPLECD3                  S/A ERROR RETURN CODE  V0500021 00773000
CPLLEN   EQU   (*-CPLSANAM+7)/8*8       LENGTH OF PARAMETER LIST        00774000
*********************************************************************** 00775000
***      CATALOG ACCESS CONTROL BLOCK DSECT                         *** 00776000
*********************************************************************** 00777000
         SPACE 1                                                        00778000
CACB     DC    0D'0'               CATALOG/AUDIT ACCESS CONTROL BLOCK   00779000
CACBID   DC    CL4'CACB'                CONTROL BLOCK ID                00780000
CACBDDNM DC    CL8'CAICATL'             DATA DEFINITION NAME   V0500035 00781000
CACBWORK DC    A(0)                     ADDRESS OF INTERNAL WORK AREAS  00782000
CACBCEL  DC    A(0)                     ADDRESS OF EXIT LIST            00783000
CACBBUFS DC    A(0)                     AMOUNT OF BUFFER SPACE          00784000
CACBBUFN DC    Y(0)                     NUMBER OF BUFFERS TO BE USED    00785000
CACBOPT0 DC    B'10000000'              ACCESS METHOD          V0500035 00786000
CACBCATL EQU   BIT0                          CATALOG MANAGEMENTV0500035 00787000
CACBAUDT EQU   BIT1                          AUDIT TRAIL       V0500035 00788000
CACBVTOC EQU   BIT2                          INDEXED VTOC      V0500035 00789000
CACBOPT1 DC    B'00000000'              PROCESSING OPTIONS     V0500035 00790000
CACBNAUD EQU   BIT0                          BYPASS AUDITTING  V0500035 00791000
CACBNENQ EQU   BIT1                          BYPASS ENQUEUE    V0500035 00792000
CACBNIX  EQU   BIT2                          NON-INDEXED       V0500049 00793000
CACBGCAT DC    AL1(0)                   GETCATLG OPTIONS       V0421051 00794000
         DC    X'00'                    (RESERVED)             V0500027 00795000
CACBFREE DC    H'0'                     % FREE SPACE IN INDEX  V0500027 00796000
CACBACAB DC    A(0)                     USER-SUPPLIED CAB      V0500046 00797000
         DC    7A(0),0D'0'              (RESERVED)             V0500046 00798000
CACBLEN  EQU   *-CACB                   LENGTH OF CACB                  00799000
HLPIOBE  EQU   *                                                        00800000
HLPIOBL  EQU   HLPIOBE-HLPIOB                                           00801000
