*% GOTO VIOPLS ;  /*   PL/S COMMENT COVERING ASSEMBLER CODE             00050000
      MACRO                                                             00100000
&NAME    VIO   &FC,                                                    *00150000
               &SIZE=,                                                 *00200000
               &SCOPE=,                                                *00250000
               &PROC=,                                                 *00300000
               &VIORB=,                                                *00350000
               &RBA=,                                          @D14BDFG*00400000
               &LEN=,                                          @D14BDFG*00450000
               &FROM=,                                         @D14BDFG*00500000
               &TO=,                                           @D14BDFG*00550000
               &MFG=                                           @D14BDFG 00600000
.*                                                                      00650000
         LCLA  &SVC                                                     00700000
         LCLA  &FCFLAG                                                  00750000
         LCLA  &RBAFLG                                                  00800000
         LCLA  &SIZFLG                                                  00850000
         LCLA  &SCOFLG                                                  00900000
         LCLA  &PROFLG                                                  00950000
         LCLA  &VIORBFL                                                 01000000
         LCLA  &LNKFLG                                                  01050000
         LCLC  &SIZVAL                                                  01100000
         LCLC  &LABEL                                                   01150000
         LCLC  &BADDR                                                   01200000
         LCLC  &TADDR                                                   01250000
.*                                                                      01300000
.*       IBM DISK OPERATING SYSTEM                                      01350000
*        SUPERVISOR - VIO - 5686-066-06                                 01400061
.*************************************************************          01450000
.*                                                           *          01500000
       AGO  .ZZZ                                             * @D31UDRP 01550000
*      LICENSED MATERIALS-PROPERTY OF IBM                    * @D31UDRP 01750000
*      THIS MACRO IS "RESTRICTED MATERIALS OF IBM"           * @D31UDRP 01775061
*      5686-066 (C) COPYRIGHT IBM CORP. 1977, 1995           * @D31UDRP 01800061
.*     SEE COPYRIGHT INSTRUCTIONS                            * @D31UDRP 01825061
.ZZZ   ANOP                                                  * @D31UDRP 01850000
.*************************************************************          01900000
.**** START OF SPECIFICATIONS ***************************************** 01950000
.*                                                                      02000000
.*01* MODULE-TYPE = MACRO                                               02050000
.*                                                                      02100000
.*01* DESCRIPTIVE NAME = VIO WORK AREA SERVICES                         02150000
.*                                                                      02200000
.*  STATUS           =  NEW MACRO - FIRST RELEASE AF 2.1                02250000
.*                                                                      02300000
.*  FUNCTION         =  FUNCTIONS SERVICED BY THIS MACRO ARE            02350000
.*                      .OPEN A VIO AREA      FC:OPEN                   02400000
.*                      .EXTEND A VIO AREA    FC:EXTND                  02450000
.*                      .CLOSE A VIO AREA     FC:CLOSE                  02500000
.*                      .ACCESSING A VIO      FC:POINT                  02550000
.*                      THE MACRO CHECKS THE USER SUPPLIED              02600000
.*                      OPERANDS AND GENERATES THE CODE NECESSARY       02650000
.*                      TO CALL THE REQUIRED FUNCTION.                  02700000
.*  NOTES            =  NONE                                            02750000
.*  DEPENDENCIES     =  NONE                                            02800000
.*  RESTRICTIONS     =  NONE                                            02850000
.*  REGISTER CONVENT.=  REGISTER 0,1 AND 15 USED                        02900000
.*  PATCH LABEL      =  NONE                                            02950000
.*  MACRO TYPE       =  BILINGUAL                                       03000000
.*  PROCESSOR        =  ASM  PL/S                                       03050000
.*  MACRO SIZE       =  SEE MACRO EXPANSION                             03100000
.*  ATTRIBUTES       =                                                  03150000
.*  ENTRY POINT      =  VIO                                             03200000
.*  PURPOSE          =  SEE FUNCTION                                    03250000
.*  LINKAGE          =  SEE INPUT                                       03300000
.*  CALLER           =                                                  03350000
.*  INPUT            =                                                  03400000
.*                                                                      03450000
.*  CALLING SEQUENCE  ASSEMBLER :                                       03500000
.*                                                                      03550000
.*        LABEL   VIO    (OPEN | CLOSE | EXTND | POINT )                03600000
.*                        ,SIZE=( NK | (R1) | (0))                      03650000
.*                        ,RBA=((R2) | (0))                             03700000
.*                       (,VIORB=((R3) | (1)))                          03750000
.*                       (,SCOPE=(STEP | JOB))                          03800000
.*                       (,PROC=(SYNCH | ASYNCH))                       03850000
.*                       OR                                             03900000
.*                       MOVE                                           03950000
.*                        ,LEN=( N1 | (R1))                             04000000
.*                        ,FROM=(NAME2 | (R2) | (R21,R22))              04050000
.*                        ,TO=(NAME3 | (R3) | (R31,R32))                04100000
.*                       (,MFG=(NAME | (R4) | (1)))                     04150000
.*                                                                      04200000
.*  CALLING SEQUENCE  PLS :                                             04250000
.*                                                                      04300000
.*      ? LABEL:  VIO    ((OPEN)|(CLOSE)|(EXTND)|(POINT))               04350000
.*                         SIZE((NK)|((R1))|(0))                        04400000
.*                         RBA(((R2))|(0))                              04450000
.*                        (VIORB(((R3))|(1)))                           04500000
.*                        (SCOPE((STEP)|(JOB)))                         04550000
.*                        (PROC((SYNCH)|(ASYNCH)));                     04600000
.*                       OR                                             04650000
.*                       (MOVE)                                         04700000
.*                         LEN((N1)|((R1)))                             04750000
.*                         FROM((NAME2)|((R2))|((R21,R22)))             04800000
.*                         TO((NAME3))|((R3))|((R31,R32)))              04850000
.*                        (MFG((NAME)|((R4))|((1))))                    04900000
.*                                                                      04950000
.*  FUNCTION RELATED OPERANDS :                                         05000000
.*                                                                      05050000
.*        -------------------------------------------------             05100000
.*        | OPER. | OPEN  | EXTND | POINT | CLOSE | MOVE  |             05150000
.*        -------------------------------------------------             05200000
.*        | SIZE  |  REQ  |  REQ  |  N/A  |  N/A  |  N/A  |             05250000
.*        | SCOPE |  OPT* |  N/A  |  N/A  |  OPT  |  N/A  |             05300000
.*        | PROC  |  OPT* |  N/A  |  N/A  |  N/A  |  N/A  |             05350000
.*        | VIORB |  N/A  |  OPT  |  OPT  |  OPT  |  N/A  |             05400000
.*        | RBA   |  N/A  |  N/A  |  REQ  |  N/A  |  N/A  |             05450000
.*        | LEN   |  N/A  |  N/A  |  N/A  |  N/A  |  REQ  |             05500000
.*        | FROM  |  N/A  |  N/A  |  N/A  |  N/A  |  REQ  |             05550000
.*        | TO    |  N/A  |  N/A  |  N/A  |  N/A  |  REQ  |             05600000
.*        | MFG   |  N/A  |  N/A  |  N/A  |  N/A  |  OPT  |             05650000
.*        -------------------------------------------------             05700000
.*                                                                      05750000
.*        *  IF OMITTED DEFAULT VALUES ARE SET (SEE BELOW)              05800000
.*                                                                      05850000
.*                     SIZE  : UNIT IS K-BYTES FOR ABSOLUTE AND         05900000
.*                             BYTES FOR REGISTER NOTATION.             05950000
.*                             OPEN                                     06000000
.*                             AMOUNT OF SPACE TO BE ALLOCATED.         06050000
.*                             EXTND                                    06100000
.*                             AMOUNT OF ADDITIONAL SPACE TO BE         06150000
.*                             ALLOCATED LOGICALLY CONTIGUOUS TO        06200000
.*                             THE TO THE EXISTING AREA.                06250000
.*                                                                      06300000
.*                     SCOPE : LIFETIME OF THE WORK AREA :              06350000
.*                             OPEN                                     06400000
.*                             STEP : WORK AREA IS DEALLOCATED          06450000
.*                                    AT END OF JOB STEP.               06500000
.*                             JOB  : WORK AREA IS DEALLOCATED          06550000
.*                                    AT END OF JOB.                    06600000
.*                             DEFAULT : STEP                           06650000
.*                             CLOSE                                    06700000
.*                             UNCONDITIONAL DEALLOCATION OF ALL        06750000
.*                             VIO WORK AREAS BELONGING TO THE          06800000
.*                             ISSUING PARTITION WITH TH SPECIFIED      06850000
.*                             LIFETIME (SYSTEM USAGE ONLY).            06900000
.*                             DEFAULT : ZERO                           06950000
.*                                                                      07000000
.*                     PROC  : PROCESSING MODE                          07050000
.*                             SYNCH  : AFTER A VIOPOINT, THE           07100000
.*                                      ISSUING TASK IS SET TO          07150000
.*                                      WAIT UNTIL THE BLOCK IS         07200000
.*                                      AVAILABLE.                      07250000
.*                             ASYNCH : AFTER A VIOPOINT, CONTROL       07300000
.*                                      RETURNS TO ISSUING TASK         07350000
.*                                      AND A WAIT OR WAITM MUST        07400000
.*                                      BE GIVEN BEFORE ACCESSING       07450000
.*                                      THE REQUESTED BLOCK.            07500000
.*                             DEFAULT  : SYNCH                         07550000
.*                                                                      07600000
.*                     VIORB : EXTND,POINT OR CLOSE                     07650000
.*                             VIORB POINTER OF THE WORK AREA TO        07700000
.*                             WHICH THE SPECIFIED FUNCTION IS          07750000
.*                             REQUESTED.IF OMITTED, REGISTER 1         07800000
.*                             MUST CONTAIN THE VIORB POINTER.          07850000
.*                                                                      07900000
.*                     RBA   : POINT                                    07950000
.*                             RELATIVE BYTE ADDRESS WITHIN THE VIO     08000000
.*                             AREA, TO WHICH ADDRESSABILITY IS         08050000
.*                             REQUESTED.                               08100000
.*                                                                      08150000
.*                     LEN   : MOVE                                     08200000
.*                             NUMBER OF CONTIGUOUS BYTES TO BE MOVED.  08250000
.*                             FOR ABSOLUTE NOTATION MAXIMUM IS 4095.   08300000
.*                                                                      08350000
.*                     FROM  : MOVE                                     08400000
.*                             ADDRES OF SOURCE DATA AREA.              08450000
.*                             IF SYMBOLIC OR SINGLE REGISTER NOTATION  08500000
.*                             IS USED, AN ADDRESS IN VIRTUAL STORAGE   08550000
.*                             IS ASSUMED. DOUBLE REGISTER NOTATION     08600000
.*                             MUST BE USED TO SPECIFY A VIO ADDRESS.   08650000
.*                             IN THIS CASE, R21 IS INTERPRETED AS THE  08700000
.*                             VIORB POINTER OF A VIO AREA AND R22 AS   08750000
.*                             AN OFFSET (RBA) WITHIN THE VIO AREA.     08800000
.*                                                                      08850000
.*                     TO    : MOVE                                     08900000
.*                             ADDRES OF TARGET AREA.                   08950000
.*                             NOTATION CONVENTION SEE FROM OPERAND.    09000000
.*                                                                      09050000
.*                     MFG   : MOVE                                     09100000
.*                             ADDRES OF A 20 BYTE AREA, IN WHICH THE   09150000
.*                             PARAMETER LIST IS TO BE BUILD. IF        09200000
.*                             OMITTED, AN INLINE PARAMETER LIST AREA   09250000
.*                             IS GENERATED.                            09300000
.*                                                                      09350000
.*  OUTPUT(COMPILER )=                                                  09400000
.*                                                                      09450000
.*  -----------------------------------------------------------------   09500000
.*  |  FC   | SIZE  | SCOPE | PROC  | VIORB |  RBA  |  SVC  |FC-CODE|   09550000
.*  -----------------------------------------------------------------   09600000
.*  | OPEN  | REG0  | PARML | PARML |  N/A  |  N/A  |  114  |  0/ 0 |   09650000
.*  | EXTND | REG0  |  N/A  |  N/A  | )REG1 |  N/A  |  114  |  1/ 1 |   09700000
.*  | CLOSE |  N/A  | *REG0 |  N/A  | )REG1 |  N/A  |  114  |  2/ 2 |   09750000
.*  | POINT |  N/A  |  N/A  |  N/A  | )REG1 |  REG0 |  107  | 72/48 |   09800000
.*  -----------------------------------------------------------------   09850000
.*                                                                      09900000
.*     . * IF OMITTED, REGISTER 0 IS CLEARED                            09950000
.*     . ) IF OMITTED, REGISTER 1 MUST BE LOADED BY THE CALLER          10000000
.*     . THE FUNCTION-CODE IS PASSED IN REGISTER 15                     10050000
.*     . THE PARAMETER-LIST FOR OPEN IS POINTED TO BY REGISTER 1        10100000
.*       AND HAS THE LAYOUT AS FOLLOWS :                                10150000
.*                                                                      10200000
.*           0 ---------------------------------                        10250000
.*             | SCOPE | PROC  |   RESERVED    |                        10300000
.*             ---------------------------------                        10350000
.*                                                                      10400000
.*     . SCOPE OPTION BYTE OR REGISTER 0 :                              10450000
.*             X'10' SCOPE = JOB SPECIFIED                              10500000
.*             X'08' SCOPE = STEP SPECIFIED (DEFAULT)                   10550000
.*     . PROCESSING OPTION BYTE :                                       10600000
.*             X'80' PROC = ASYNCH SPECIFIED                            10650000
.*             X'00' PROC = SYNCH SPECIFIED (DEFAULT)                   10700000
.*                                                                      10750000
.*     . MOVE :                                                         10800000
.*             REG13 ASSUMED TO CONTAIN THE ADDRESS OF A 72-BYTE        10850000
.*                   SAVE AREA                                          10900000
.*             REG14 LINK REGISTER                                      10950000
.*             REG15 ADDRESS OF MOVE ROUTINE FROM VIORB                 11000000
.*             REG1  ADDRESS OF PARAMETER LIST:                         11050000
.*                                                                      11100000
.*             LABEL   DC    A(0)       LEN SPECIFICATION               11150000
.*                     DC    A(0)       FROM SPECIFICATION OR ZERO      11200000
.*                     DC    A(0)       FROM SPECIFICATION              11250000
.*                     DC    A(0)       TO SPECIFICATION OR ZERO        11300000
.*                     DC    A(0)       TO SPECIFICATION                11350000
.*                                                                      11400000
.*  OUTPUT(EXECUTION)=  RETURN CODES IN REGISTER 15                     11450000
.*                      OPEN      0  SUCCESSFUL ALLOCATION              11500000
.*                                8  NO MORE SPACE AVAILABLE            11550000
.*                      EXTND     0  ADDITIONAL SPACE ALLOCATED         11600000
.*                                8  NO MORE SPACE AVAILABLE            11650000
.*                      CLOSE     0  SUCCESSFUL DEALLOCATION            11700000
.*                      POINT     RESULTS RETURN IN THE VIORB           11750000
.*                      MOVE      0  OPERATION SUCCESSFUL               11800000
.*                                8  UNRECOVERABLE ERROR                11850000
.*                               12  INVALID INPUT                      11900000
.*                                                                      11950000
.*  EXIT NORMAL      =  MACRO EXPANSION                                 12000000
.*                                                                      12050000
.*  EXIT ERROR       =  MNOTES INDICATING THE ERROR                     12100000
.*                                                                      12150000
.*  EXTERNAL REFEREN.=  NONE                                            12200000
.*  ROUTINES         =  NONE                                            12250000
.*  DATA AREAS       =  NONE                                            12300000
.*  CONTROL BLOCKS   =  NONE                                            12350000
.*  TABLES           =  NONE                                            12400000
.*  MACROS           =  NONE                                            12450000
.*  CHANGE ACTIVITIES=  NEW MACRO   FIRST RELEASE AF 2.1                12500000
.*  MODIFIED REGISTER=  NONE                                            12550000
.*                                                                      12600000
.*  PARAMETERLIST NOT CLEARED FIRST IF MFG IS SPECIFIED        @D61NDRP 12625061
.*  A000000-999999                                             @D14BDWK 12650000
.*                                                                      12700000
.** END OF SPECICATIONS *********************************************** 12750000
.*                                                                      12800000
.*--------------------------------------------------------------------- 12850000
.*       CHECK SPECIFIED FUNCTION                                       12900000
.*--------------------------------------------------------------------- 12950000
.*                                                                      13000000
         AIF   (T'&FC EQ 'O').MNOTE01         FUNCTION REQUIRED         13050000
         AIF   ('&FC' EQ 'MOVE').CHOPNIN      CHK INV.OPERANDS @D14BDFG 13100000
&SVC     SETA  114                            SET SVC NUMBER            13150000
         AIF   ('&FC' EQ 'OPEN').CHOPNIN      CHECK INVAL OPEN OPERANDS 13200000
&FCFLAG  SETA  1                              INDICATE SCOPE = JOB      13250000
         AIF   ('&FC' EQ 'EXTND').CHCLEIN     CHECK INVAL EXT OPERANDS  13300000
&FCFLAG  SETA  2                              INDICATE SCOPE = JOB      13350000
         AIF   ('&FC' EQ 'CLOSE').CHCLEIN     CHECK INVAL CLS OPERANDS  13400000
&SVC     SETA  107                            SET SVC NUMBER            13450000
&FCFLAG  SETA  72                             INDICATE SCOPE = JOB      13500000
         AIF   ('&FC' EQ 'POINT').CHPNTIN     CHECK INVAL PNT OPERANDS  13550000
         AGO   .MNOTE01                       FUNCTION UNKNOWN          13600000
.*                                                                      13650000
.*--------------------------------------------------------------------- 13700000
.*       CHECK IF INVALID OPERANDS SPECIFIED                            13750000
.*--------------------------------------------------------------------- 13800000
.*                                                                      13850000
.CHOPNIN ANOP                                                           13900000
         AIF   (T'&VIORB NE 'O').MNOTE02      VIORB OPERAND N/A         13950000
.CHCLEIN ANOP                                                           14000000
         AIF   (T'&RBA NE 'O').MNOTE03        RBA OPERAND N/A           14050000
.CHPNTIN ANOP                                                           14100000
         AIF   ('&FC' EQ 'MOVE').CHMOVIN      SKIP FOR MOVE             14150000
         AIF   (T'&LEN NE 'O').MNOTE14        LEN OPERAND N/A           14200000
         AIF   (T'&FROM NE 'O').MNOTE15       FROM OPERAND N/A          14250000
         AIF   (T'&TO NE 'O').MNOTE16         TO OPERAND N/A            14300000
         AIF   ('&FC' EQ 'OPEN').CHSIZE       CHECK SIZE OPERAND        14350000
.CHMOVIN ANOP                                                           14400000
         AIF   (T'&PROC NE 'O').MNOTE04       PROC OPERAND N/A          14450000
         AIF   ('&FC' EQ 'CLOSE').CHCLSSI     CONT. INVAL CLS OPERANDS  14500000
         AIF   (T'&SCOPE NE 'O').MNOTE05      SCOPE OPERAND N/A         14550000
         AIF   ('&FC' EQ 'EXTND').CHSIZE      CHECK SIZE OPERAND        14600000
.CHCLSSI ANOP                                                           14650000
         AIF   (T'&SIZE NE 'O').MNOTE06       SIZE OPERAND N/A          14700000
         AIF   ('&FC' EQ 'MOVE').CHLEN        CHK LEN OPERAND  @D14BDFG 14750000
         AIF   ('&FC' EQ 'CLOSE').CHVIORB     CHECK VIORB OPERAND       14800000
.*                                                                      14850000
.*--------------------------------------------------------------------- 14900000
.*       CHECK RBA OPERAND FOR FC=POINT                                 14950000
.*--------------------------------------------------------------------- 15000000
.*                                                                      15050000
.CHRBA   ANOP                                                           15100000
         AIF   (T'&RBA EQ 'O').MNOTE07        RBA OPERAND REQUIRED      15150000
         AIF   ('&RBA'(1,1) NE '(').MNOTE08   REG. NOTATION REQUIRED    15200000
         AIF   ('&RBA' EQ '(0)').CHVIORB      RBA ALLREADY LOADED       15250000
&RBAFLG  SETA  1                              INDICATE REGISTER VALUE   15300000
         AGO   .CHVIORB                                                 15350000
.*                                                                      15400000
.*--------------------------------------------------------------------- 15450000
.*       CHECK SIZE OPERAND FOR OPEN AND EXTND                          15500000
.*--------------------------------------------------------------------- 15550000
.*                                                                      15600000
.CHSIZE  ANOP                                                           15650000
         AIF   (T'&SIZE EQ 'O').MNOTE09       SIZE OPERAND REQUIRED     15700000
         AIF   ('&SIZE' EQ '(0)').SKIPSIZ     SIZE ALLREADY LOADED      15750000
         AIF   ('&SIZE'(1,1) EQ '(').REGSIZ   GET REGISTER              15800000
         AIF   ('&SIZE'(K'&SIZE,1) NE 'K').MNOTE10                      15850000
&SIZVAL  SETC  '&SIZE'(1,K'&SIZE-1)           GET SIZE VALUE            15900000
&SIZFLG  SETA  2                              INDICATE ABS.NOTATION     15950000
         AGO   .SKIPSIZ                       CHECK FC TO CONTINUE      16000000
.REGSIZ  ANOP                                                           16050000
&SIZFLG  SETA  1                              INDICATE REG.NOTATION     16100000
.SKIPSIZ ANOP                                                           16150000
         AIF   ('&FC' EQ 'OPEN').CHSCOPE      CHECK SCOPE FOR OPEN      16200000
.*                                                                      16250000
.*--------------------------------------------------------------------- 16300000
.*       CHECK VIORB OPERAND FOR FC=EXTND,POINT OR CLOSE                16350000
.*--------------------------------------------------------------------- 16400000
.*                                                                      16450000
.CHVIORB ANOP                                                           16500000
         AIF   (T'&VIORB EQ 'O').CHCLS        CHECK IF FC=CLOSE         16550000
         AIF   ('&VIORB' EQ '(1)').CHCLS      CHECK IF FC=CLOSE         16600000
         AIF   ('&VIORB'(1,1) NE '(').MNOTE11 REG. NOTATION REQUIRED    16650000
&VIORBFL SETA  1                              INDICATE VIORB TO LOAD    16700000
.CHCLS   ANOP                                                           16750000
         AIF   ('&FC' NE 'CLOSE').GENEXP      GENERATE CODE             16800000
.*                                                                      16850000
.*--------------------------------------------------------------------- 16900000
.*       CHECK SCOPE OPERAND FOR FUNCTION OPEN AND CLOSE                16950000
.*--------------------------------------------------------------------- 17000000
.*                                                                      17050000
.CHSCOPE ANOP                                                           17100000
         AIF   (T'&SCOPE EQ 'O').CHKCLS       USE DEFAULT SCOPE VALUE   17150000
&SCOFLG  SETA  8                              INDICATE SCOPE = STEP     17200000
         AIF   ('&SCOPE' EQ 'STEP').CHKCLS    USE DEFAULT SCOPE VALUE   17250000
         AIF   ('&SCOPE' NE 'JOB').MNOTE12    INVALID VALUE             17300000
&SCOFLG  SETA  16                             INDICATE SCOPE = JOB      17350000
.CHKCLS  ANOP                                                           17400000
         AIF   ('&FC' EQ 'CLOSE').GENEXP      GENERATE CODE             17450000
&SCOFLG  SETA  8                              OPEN AND SCOPE=OMITTED    17500000
.*                                                                      17550000
.*--------------------------------------------------------------------- 17600000
.*       CHECK PROC OPERAND                                             17650000
.*--------------------------------------------------------------------- 17700000
.*                                                                      17750000
.CHPROC  ANOP                                                           17800000
         AIF   (T'&PROC EQ 'O').GENEXP        USE DEFAULT VALUE         17850000
         AIF   ('&PROC' EQ 'SYNCH').GENEXP    SAME AS DEFAULT VALUE     17900000
         AIF   ('&PROC' NE 'ASYNCH').MNOTE13  INVALID VALUE             17950000
&PROFLG  SETA  128                            INDICATE PROC = ASYNCH    18000000
.*                                                                      18050000
.*--------------------------------------------------------------------- 18100000
.*       GENERATE MACRO EXPANSION FOR OPEN/EXTND/POINT/CLOSE   @D14BDFG 18150000
.*--------------------------------------------------------------------- 18200000
.*                                                                      18250000
.GENEXP  ANOP                                                           18300000
&NAME    DC    0H'0'                                                    18350000
         AIF   ('&FC' EQ 'POINT').GENRBA      POINT EXPANSION           18400000
         AIF   ('&FC' EQ 'CLOSE').GENVIOR     CLOSE EXPANSION           18450000
         AIF   (&SIZFLG EQ 0).CHPARM          CHECK FOR OPEN            18500000
         AIF   (&SIZFLG EQ 1).GENSREG         REGISTER NOTATION         18550000
         L     0,=F'&SIZVAL'            SIZE VALUE IN K-BYTES           18600000
         SLL   0,10                     SIZE VALUE IN BYTES             18650000
         AGO   .CHPARM                        CHECK FOR OPEN            18700000
.GENSREG ANOP                                                           18750000
         LR    0,&SIZE(1)               GET SIZE VALUE IN BYTES         18800000
.CHPARM  ANOP                                                           18850000
         AIF   ('&FC' EQ 'OPEN').GENPARM      GENERATE PARMLIST         18900000
         AGO   .GENVIOR                       GENERATE VIORB LOAD       18950000
.GENRBA  ANOP                                                           19000000
         AIF   (&RBAFLG EQ 0).GENVIOR         GENERATE VIORB LOAD       19050000
         LR    0,&RBA(1)                GET RBA VALUE                   19100000
.GENVIOR ANOP                                                           19150000
         AIF   (&VIORBFL EQ 0).GENSCOP        ALLREADY LOADED           19200000
         LR    1,&VIORB(1)              GET VIORB POINTER               19250000
.GENSCOP ANOP                                                           19300000
         AIF   ('&FC' NE 'CLOSE').SETFC       SET FUNCTION CODE         19350000
         AIF   (&SCOFLG EQ 0).GENSCOM         SCOPE OMITTED             19400000
         LA    0,&SCOFLG                INDICATE SCOPE                  19450000
         AGO   .SETFC                         SET FUNCTION CODE         19500000
.GENSCOM ANOP                                                           19550000
         SLR   0,0                      INDICATE SCOPE OMITTED          19600000
         AGO   .SETFC                         SET FUNCTION CODE         19650000
.GENPARM ANOP                                                           19700000
         BAL   1,*+8                                                    19750000
         DC    AL1(&SCOFLG)             SCOPE OPTION BYTE               19800000
         DC    AL1(&PROFLG)             PROCESSING OPTION BYTE          19850000
         DC    AL2(0)                   RESERVED                        19900000
.SETFC   ANOP                                                           19950000
         LA    15,&FCFLAG               SET FUNCTION CODE               20000000
         SVC   &SVC                     CALL SERVICE ROUTINE            20050000
         SPACE 2                                                        20100000
         MEXIT                                                          20150000
.*                                                             @D149DFG 20200000
.*-------------------------------------------------------------@D149DFG 20250000
.*       CHECK LEN, FROM AND TO OPERANDS                       @D149DFG 20300000
.*-------------------------------------------------------------@D149DFG 20350000
.*                                                             @D149DFG 20400000
.CHLEN   AIF   (T'&LEN EQ 'O').MNOTE20                         @D14BDFG 20450000
         AIF   (T'&FROM EQ 'O').MNOTE21                        @D14BDFG 20500000
         AIF   (N'&FROM EQ 1).CHTO                             @D14BDFG 20550000
         AIF   (N'&FROM GT 2).MNOTE22                          @D14BDFG 20600000
&LNKFLG  SETA  1                                               @D14BDFG 20650000
.CHTO    AIF   (T'&TO EQ 'O').MNOTE23                          @D14BDFG 20700000
         AIF   (N'&TO EQ 1).CHTOFIN                            @D14BDFG 20750000
         AIF   (N'&TO GT 2).MNOTE24                            @D14BDFG 20800000
&LNKFLG  SETA  2                                               @D14BDFG 20850000
.CHTOFIN AIF   (&LNKFLG EQ 0).MNOTE25                          @D14BDFG 20900000
.*                                                             @D149DFG 20950000
.*-------------------------------------------------------------@D149DFG 21000000
.*       MACRO EXPANSION FOR MOVE                              @D149DFG 21050000
.*-------------------------------------------------------------@D149DFG 21100000
.*                                                             @D149DFG 21150000
         AIF   (T'&MFG NE 'O').MFG                             @D14BDFG 21200000
&NAME    CNOP  0,4                                             @D14BDFG 21250000
&TADDR   SETC  '+IJBY'.'&SYSNDX'                               @D14BDFG 21300000
         AGO   .LEN                                            @D14BDFG 21350000
.MFG     AIF   ('&MFG'(1,1) EQ '(').MFGR                       @D14BDFG 21400000
&TADDR   SETC  '+'.'&MFG'                                      @D14BDFG 21450000
         XC    &MFG.(20),&MFG                                  @D61NDRP 21475061
         AGO   .LEN                                            @D14BDFG 21500000
.MFGR    ANOP                                                  @D14BDFG 21550000
&TADDR   SETC  '&MFG'                                          @D14BDFG 21600000
         XC    0(20,&MFG(1)),0&MFG                             @D61NDRP 21625061
.LEN     AIF   ('&LEN'(1,1) NE '(').LENA                       @D14BDFG 21650000
         ST    &LEN(1),0&TADDR    LENGTH OPERAND               @D14BDFG 21700000
         AGO   .FROM                                           @D14BDFG 21750000
.LENA    AIF   (T'&MFG EQ 'O').FROM                            @D14BDFG 21800000
         LA    0,&LEN             GET SPECIFIED LENGTH         @D14BDFG 21850000
         ST    0,0&TADDR          STORE IN PARAMETER LIST      @D14BDFG 21900000
.FROM    AIF   ('&FROM'(1,1) EQ '(').FROMR                     @D14BDFG 21950000
         AIF   (T'&MFG EQ 'O').TO                              @D14BDFG 22000000
         LA    0,&FROM            GET FROM ADDRESS             @D14BDFG 22050000
         ST    0,8&TADDR          STORE IN PARAMETER LIST      @D14BDFG 22100000
         AGO   .TO                                             @D14BDFG 22150000
.FROMR   AIF   (N'&FROM EQ 2).FROMR2                           @D14BDFG 22200000
         ST    &FROM(1),8&TADDR   STORE FROM ADDRESS           @D14BDFG 22250000
         AGO   .TO                                             @D14BDFG 22300000
.FROMR2  ANOP                                                  @D14BDFG 22350000
         ST    &FROM(1),4&TADDR   STORE FROM VIORB POINTER     @D14BDFG 22400000
         ST    &FROM(2),8&TADDR   STORE FROM RBA               @D14BDFG 22450000
         AIF   (&LNKFLG NE 1).TO                               @D14BDFG 22500000
         L     15,VIORBASR-VIORBADR(&FROM(1)) VIO MOVE SERVICE @D14BDWK 22550000
.TO      AIF   ('&TO'(1,1) EQ '(').TOR                         @D14BDFG 22600000
         AIF   (T'&MFG EQ 'O').PARL                            @D14BDFG 22650000
         LA    0,&TO              GET TO ADDRESS               @D14BDFG 22700000
         ST    0,16&TADDR         STORE IN PARAMETER LIST      @D14BDFG 22750000
         AGO   .PARL                                           @D14BDFG 22800000
.TOR     AIF   (N'&TO EQ 2).TOR2                               @D14BDFG 22850000
         ST    &TO(1),16&TADDR    STORE TO ADDRESS             @D14BDFG 22900000
         AGO   .PARL                                           @D14BDFG 22950000
.TOR2    ANOP                                                  @D14BDFG 23000000
         ST    &TO(1),12&TADDR    STORE TO VIORB POINTER       @D14BDFG 23050000
         ST    &TO(2),16&TADDR    STORE TO RBA                 @D14BDFG 23100000
         L     15,VIORBASR-VIORBADR(&TO(1)) VIO MOVE SERVICE   @D14BDWK 23150000
.PARL    AIF   (T'&MFG NE 'O').MFGL                            @D14BDFG 23200000
&BADDR   SETC  'IJBY'.'&SYSNDX'.'+20'                          @D14BDFG 23250000
         BAL   1,&BADDR           LOAD AND SKIP PARAM.LIST     @D14BDFG 23300000
&LABEL   SETC  'IJBY'.'&SYSNDX'                                @D14BDFG 23350000
         AIF   ('&LEN'(1,1) EQ '(').LENPR                      @D14BDFG 23400000
&LABEL   DC    A(&LEN)            LEN SPECIFICATION            @D14BDFG 23450000
         AGO   .FROMP                                          @D14BDFG 23500000
.LENPR   ANOP                                                  @D14BDFG 23550000
&LABEL   DC    A(0)               LEN SPECIFICATION            @D14BDFG 23600000
.FROMP   AIF   ('&FROM'(1,1) EQ '(').FROMPR                    @D14BDFG 23650000
         DC    A(0)                                            @D14BDFG 23700000
         DC    A(&FROM)           FROM ADDRESS                 @D14BDFG 23750000
         AGO   .TOP                                            @D14BDFG 23800000
.FROMPR  ANOP                                                  @D14BDFG 23850000
         DC    2A(0)              FROM SPECIFICATION           @D14BDFG 23900000
.TOP     AIF   ('&TO'(1,1) EQ '(').TOPR                        @D14BDFG 23950000
         DC    A(0)                                            @D14BDFG 24000000
         DC    A(&TO)             TO ADDRESS                   @D14BDFG 24050000
         AGO   .BALR                                           @D14BDFG 24100000
.TOPR    ANOP                                                  @D14BDFG 24150000
         DC    2A(0)              TO SPECIFICATION             @D14BDFG 24200000
         AGO   .BALR                                           @D14BDFG 24250000
.MFGL    AIF   ('&MFG'(1,1) EQ '(').MFGLR                      @D14BDFG 24300000
         LA    1,&MFG             POINT TO PARAMETER LIST      @D14BDFG 24350000
         AGO   .BALR                                           @D14BDFG 24400000
.MFGLR   AIF   ('&MFG' EQ '(1)').BALR                          @D14BDFG 24450000
         LR    1,&MFG(1)          POINT TO PARAMETER LIST      @D14BDFG 24500000
.BALR    ANOP                                                  @D14BDFG 24550000
         BALR  14,15              CALL VIO MOVE SERVICE        @D14BDFG 24600000
         MEXIT                                                 @D14BDFG 24650000
.*                                                                      24700000
.*--------------------------------------------------------------------- 24750000
.*       MNOTES                                                         24800000
.*--------------------------------------------------------------------- 24850000
.*                                                                      24900000
.MNOTE01 MNOTE 8,'SPECIFIED FUNCTION INVALID OR OMITTED '               24950000
         MEXIT                                                          25000000
.MNOTE02 MNOTE 8,'VIORB OPERAND INVALID FOR FUNCTION &FC '              25050000
         MEXIT                                                          25100000
.MNOTE03 MNOTE 8,'RBA OPERAND INVALID FOR FUNCTION &FC '                25150000
         MEXIT                                                          25200000
.MNOTE04 MNOTE 8,'PROC OPERAND INVALID FOR FUNCTION &FC '               25250000
         MEXIT                                                          25300000
.MNOTE05 MNOTE 8,'SCOPE OPERAND INVALID FOR FUNCTION &FC '              25350000
         MEXIT                                                          25400000
.MNOTE06 MNOTE 8,'SIZE OPERAND INVALID FOR FUNCTION &FC '               25450000
         MEXIT                                                          25500000
.MNOTE07 MNOTE 8,'RBA OPERAND REQUIRED FOR FUNCTION &FC '               25550000
         MEXIT                                                          25600000
.MNOTE08 MNOTE 8,'REGISTER NOTATION REQUIRED FOR RBA OPERAND '          25650000
         MEXIT                                                          25700000
.MNOTE09 MNOTE 8,'SIZE OPERAND REQUIRED FOR FUNCTION &FC '              25750000
         MEXIT                                                          25800000
.MNOTE10 MNOTE 8,'UNIT FOR SIZE OPERAND MUST BE K-BYTES '               25850000
         MEXIT                                                          25900000
.MNOTE11 MNOTE 8,'REGISTER NOTATION REQUIRED FOR VIORB OPERAND '        25950000
         MEXIT                                                          26000000
.MNOTE12 MNOTE 8,'SCOPE=&SCOPE IS INVALID '                             26050000
         MEXIT                                                          26100000
.MNOTE13 MNOTE 8,'PROC=&PROC IS INVALID '                               26150000
         MEXIT                                                 @D14BDFG 26200000
.MNOTE14 MNOTE 8,'LEN OPERAND INVALID FOR FUNCTION &FC '                26250000
         MEXIT                                                          26300000
.MNOTE15 MNOTE 8,'FROM OPERAND INVALID FOR FUNCTION &FC '               26350000
         MEXIT                                                          26400000
.MNOTE16 MNOTE 8,'TO OPERAND INVALID FOR FUNCTION &FC '                 26450000
         MEXIT                                                          26500000
.MNOTE20 MNOTE 8,'LEN OPERAND REQUIRED FOR FUNCTION &FC '      @D14BDFG 26550000
         MEXIT                                                 @D14BDFG 26600000
.MNOTE21 MNOTE 8,'FROM OPERAND REQUIRED FOR FUNCTION &FC '     @D14BDFG 26650000
         MEXIT                                                 @D14BDFG 26700000
.MNOTE22 MNOTE 8,'FROM=&FROM IS INVALID '                      @D14BDFG 26750000
         MEXIT                                                 @D14BDFG 26800000
.MNOTE23 MNOTE 8,'TO OPERAND REQUIRED FOR FUNCTION &FC '       @D14BDFG 26850000
         MEXIT                                                 @D14BDFG 26900000
.MNOTE24 MNOTE 8,'TO=&TO IS INVALID '                          @D14BDFG 26950000
         MEXIT                                                 @D14BDFG 27000000
.MNOTE25 MNOTE 8,'AT LEAST ONE VIO ADDRESS REQUIRED '          @D14BDFG 27050000
         MEND                                                           27100000
*                                                                       27150000
*---------------------------------------------------------------------- 27200000
*---------------------------------------------------------------------- 27250000
*        PL/S PART OF MACRO FOLLOWS                                     27300000
*---------------------------------------------------------------------- 27350000
*---------------------------------------------------------------------- 27400000
*                                      END OF PL/S COMMENT           */ 27450000
*%VIOPLS :  ;                                                           27500000
*%VIO: MACRO KEYS(SIZE,                                                 27550000
*              VIORB,                                                   27600000
*              RBA,                                                     27650000
*              SCOPE,                                                   27700000
*              PROC,                                                    27750000
*              LEN,                                                     27800000
*              FROM,                                                    27850000
*              TO,                                                      27900000
*              MFG);                                                    27950000
* /*-----------------------------------------------------------------*/ 28000000
* /*     LIST MACRO INVOCATION IN SOURCE                             */ 28050000
* /*-----------------------------------------------------------------*/ 28100000
*    ANS ('/* '||MACLABEL||' '||MACNAME||' '||MACLIST||' '||MACKEYS||   28150000
*         '*/') COL(MACLMAR);                                           28200000
* ANS ('/*                                               */')           28250000
* COL(MACLMAR);                                                         28300000
* ANS ('/*      SUPERVISOR - VIO - 5686-066-06           */')           28350061
* COL(MACLMAR);                                                         28400000
* ANS ('/*                                               */')           28450000
* COL(MACLMAR);                                                         28500000
* /*-----------------------------------------------------------------*/ 28550000
* /*     CHECK FUNCTION CODE                                         */ 28600000
* /*-----------------------------------------------------------------*/ 28650000
*    IF NUMBER(MACLIST) = 0 THEN       /*                            */ 28700000
*       GO TO MERR01;                  /* FUNCTION CODE REQUIRED     */ 28750000
*    IF NUMBER(MACLIST) ¬= 1 THEN      /*                            */ 28800000
*       GO TO MERR02;                  /* MORE THEN ONE POS.ARGUMENT */ 28850000
*    IF MACLIST(1) = 'POINT' THEN      /* GO CHECK INVALID OPERANDS  */ 28900000
*       GO TO CHPNTIN;                 /*    FOR POINT               */ 28950000
*    IF MACLIST(1) = 'EXTND' THEN      /*                            */ 29000000
*       GO TO CHCLEIN;                 /*    FOR EXTND               */ 29050000
*    IF MACLIST(1) = 'CLOSE' THEN      /*                            */ 29100000
*       GO TO CHCLEIN;                 /*    FOR CLOSE               */ 29150000
*    IF MACLIST(1) = 'OPEN' THEN       /*                            */ 29200000
*       GO TO CHMOPEN;                 /*    FOR OPEN                */ 29250000
*    IF MACLIST(1) ¬= 'MOVE' THEN      /*    AND MOVE                */ 29300000
*       GO TO MERR03;                  /* INVALID POSITIONAL ARGUMENT*/ 29350000
* /*-----------------------------------------------------------------*/ 29400000
* /*     CHECK IF INVALID OPERANDS SPECIFIED                         */ 29450000
* /*-----------------------------------------------------------------*/ 29500000
* CHMOPEN:                             /*                            */ 29550000
*    IF NUMBER(VIORB) ¬= 0 THEN        /*                            */ 29600000
*       GO TO MERR04;                  /* VIORB INVALID FOR SPEC. FC */ 29650000
* CHCLEIN:                             /*                            */ 29700000
*    IF NUMBER(RBA) ¬= 0 THEN          /*                            */ 29750000
*       GO TO MERR05;                  /* RBA INVALID FOR SPEC. FC   */ 29800000
* CHPNTIN:                             /*                            */ 29850000
*    IF MACLIST(1) = 'MOVE' THEN       /* SKIP REQUIRED OPERANDS     */ 29900000
*       GO TO CHMOVIN;                 /*    FOR MOVE                */ 29950000
*    IF NUMBER(LEN) ¬= 0 THEN          /*                            */ 30000000
*       GO TO MERR24;                  /* LEN INVALID FOR SPEC. FC   */ 30050000
*    IF NUMBER(FROM) ¬= 0 THEN         /*                            */ 30100000
*       GO TO MERR25;                  /* FROM INVALID FOR SPEC. FC  */ 30150000
*    IF NUMBER(TO) ¬= 0 THEN           /*                            */ 30200000
*       GO TO MERR26;                  /* TO INVALID FOR SPEC. FC    */ 30250000
*    IF MACLIST(1) = 'OPEN' THEN       /* GO CHECK REQUIRED OPERANDS */ 30300000
*       GO TO CHSIZE;                  /*    FOR OPEN                */ 30350000
* CHMOVIN:                             /*                            */ 30400000
*    IF NUMBER(PROC) ¬= 0 THEN         /*                            */ 30450000
*       GO TO MERR06;                  /* PROC INVALID FOR SPEC. FC  */ 30500000
*    IF MACLIST(1) = 'CLOSE' THEN      /*                            */ 30550000
*       GO TO CHCLSSI;                 /* SKIP SCOPE IF FC CLOSE     */ 30600000
*    IF NUMBER(SCOPE) ¬= 0 THEN        /*                            */ 30650000
*       GO TO MERR07;                  /* SCOPE INVALID FOR SPEC. FC */ 30700000
*    IF MACLIST(1) = 'EXTND' THEN      /* GO CHECK REUIRED OPERANDS  */ 30750000
*       GO TO CHSIZE;                  /*    FOR EXTND               */ 30800000
* CHCLSSI:                             /*                            */ 30850000
*    IF NUMBER(SIZE) ¬= 0 THEN         /*                            */ 30900000
*       GO TO MERR08;                  /* SIZE INVALID FOR SPEC. FC  */ 30950000
*    IF MACLIST(1) = 'CLOSE' THEN      /* GO CHECK OPTIONAL OPERANDS */ 31000000
*       GO TO CHVIORB;                 /*    FOR CLOSE               */ 31050000
*    IF MACLIST(1) = 'MOVE' THEN       /* GO CHECK REQUIRED OPERANDS */ 31100000
*       GO TO CHMOVE;                  /*    FOR MOVE                */ 31150000
* /*-----------------------------------------------------------------*/ 31200000
* /*     CHECK IF REQUIRED OPERANDS SPECIFIED                        */ 31250000
* /*-----------------------------------------------------------------*/ 31300000
*    IF NUMBER(RBA) = 0 THEN           /* RBA OPERAND REQUIRED       */ 31350000
*       GO TO MERR09;                  /* FOR SPECIFIED FUNCTION     */ 31400000
*    IF RBA(1) = '0' THEN              /* REGISTER 0 SPECIFIED       */ 31450000
*       GO TO CHVIORB;                 /*                            */ 31500000
*    IF RBA(1,1:1) = '(' THEN          /* REGISTER SPECIFICATION     */ 31550000
*       GO TO CHVIORB;                 /* REQUIRED                   */ 31600000
*    GO TO MERR10;                     /* BUT NOT SPECIFIED          */ 31650000
* CHSIZE:                              /*                            */ 31700000
*    IF NUMBER(SIZE) = 0 THEN          /* SIZE OPERAND REQUIRED      */ 31750000
*       GO TO MERR11;                  /* FOR SPECIFIED FUNCTION     */ 31800000
*    IF SIZE(1) = '0' THEN             /* REGISTER NOTATION FOR SIZE */ 31850000
*       GO TO CHSIZEN;                 /*                            */ 31900000
*    IF SIZE(1,1:1) = '(' THEN         /* REGISTER NOTATION FOR SIZE */ 31950000
*       GO TO CHSIZEN;                 /*                            */ 32000000
*    IF INDEX(SIZE,'K') = 0 THEN       /* SIZE MUST BE IN K-BYTES    */ 32050000
*       GO TO MERR12;                  /*                            */ 32100000
*    IF INDEX(SIZE,'K',2) ¬= 0 THEN    /* SIZE MUST BE IN K-BYTES    */ 32150000
*       GO TO MERR12;                  /*                            */ 32200000
* CHSIZEN:                             /*                            */ 32250000
*    IF MACLIST(1) = 'OPEN' THEN       /* GO CHECK OPTIONAL OPERANDS */ 32300000
*       GO TO CHSCOPO;                 /*    FOR OPEN                */ 32350000
* /*-----------------------------------------------------------------*/ 32400000
* /*     CHECK IF OPTIONAL OPERANDS VALID                            */ 32450000
* /*-----------------------------------------------------------------*/ 32500000
* CHVIORB:                             /*                            */ 32550000
*    IF NUMBER(VIORB) = 0 THEN         /* VIORB OPERAND OMITTED      */ 32600000
*       GO TO CHSCOPC;                 /*                            */ 32650000
*    IF VIORB(1) = '1' THEN            /* REGISTER 1 SPECIFIED       */ 32700000
*       GO TO CHSCOPC;                 /*                            */ 32750000
*    IF VIORB(1,1:1) ¬= '(' THEN       /* REGISTER SPECIFICATION     */ 32800000
*       GO TO MERR13;                  /* REQUIRED                   */ 32850000
* CHSCOPC:                             /*                            */ 32900000
*    IF MACLIST(1) ¬= 'CLOSE' THEN     /* END CHECK FOR PNT AND EXTND*/ 32950000
*       GO TO GENEXP;                  /*                            */ 33000000
* CHSCOPO:                             /*                            */ 33050000
*    IF NUMBER(SCOPE) ¬= 0 THEN        /*                            */ 33100000
*       IF SCOPE(1) ¬= 'JOB' &         /* INVALID STRING FOR SCOPE   */ 33150000
*          SCOPE(1) ¬= 'STEP' THEN     /* OPERAND                    */ 33200000
*          GO TO MERR14;               /*                            */ 33250000
*    ELSE;                             /*                            */ 33300000
*    IF MACLIST(1) = 'CLOSE' THEN      /* END CHECK FOR CLOSE        */ 33350000
*       GO TO GENEXP;                  /*                            */ 33400000
*    IF NUMBER(PROC) ¬= 0 THEN         /*                            */ 33450000
*       IF PROC(1) ¬= 'ASYNCH' &       /* INVALID STRING FOR PROC    */ 33500000
*          PROC(1) ¬= 'SYNCH' THEN     /* OPERAND                    */ 33550000
*          GO TO MERR15;               /*                            */ 33600000
*    ELSE;                             /*                            */ 33650000
* /*-----------------------------------------------------------------*/ 33700000
* /*     DECLARE NEEDED REGISTER                                     */ 33750000
* /*-----------------------------------------------------------------*/ 33800000
* GENEXP:                              /*                            */ 33850000
* ANS (MACLABEL) COL(MACLMAR);                                          33900000
*    IF MACLIST(1) = 'OPEN' | MACLIST(1) = 'EXTND' THEN  /*          */ 33950000
*       IF SIZE(1) = '0' THEN          /* SIZE ALLREADY LOADED       */ 34000000
*          GOTO GENREG1;               /* DONT DECLARE REGISTER 0    */ 34050000
*        ELSE;                         /*                            */ 34100000
*     ELSE;                            /*                            */ 34150000
*    IF MACLIST(1) = 'POINT' THEN      /*                            */ 34200000
*       IF RBA(1) = '0' THEN           /* RBA ALLREADY LOADED        */ 34250000
*          GOTO GENREG1;               /* DONT DECLARE REGISTER 0    */ 34300000
*        ELSE;                         /*                            */ 34350000
*     ELSE;                            /*                            */ 34400000
* ANS ('DCL VIO0'||MACINDEX||' REG(0) PTR(31);')RESCAN SKIP COL(10);    34450000
* ANS ('/* SPECIFY REGISTER 0        */') COL(41);                      34500000
* GENREG1:                             /*                            */ 34550000
*    IF MACLIST(1) ¬= 'OPEN' THEN      /*                            */ 34600000
*       IF NUMBER(VIORB) = 0 | VIORB(1) = '1' THEN   /*              */ 34650000
*          GOTO GENREGF;               /* DONT DECLARE REGISTER 1    */ 34700000
*        ELSE;                         /*                            */ 34750000
*     ELSE;                            /*                            */ 34800000
* ANS ('DCL VIO1'||MACINDEX||' REG(1) PTR(31);')RESCAN SKIP COL(10);    34850000
* ANS ('/* SPECIFY REGISTER 1        */') COL(41);                      34900000
* GENREGF:                             /*                            */ 34950000
* ANS ('DCL VIOF'||MACINDEX||' REG(15) PTR(31);')RESCAN SKIP COL(10);   35000000
* ANS ('/* SPECIFY REGISTER 15       */') COL(41);                      35050000
* /*-----------------------------------------------------------------*/ 35100000
* /*     RESTRICT GENERATED REGISTER                                 */ 35150000
* /*     IF THE MACRO IS CALLED WITHIN A DO OR DO WHILE LOOP AND THE */ 35200000
* /*     RESTRICTION IS DONE WITH DECLARE, PLS COMPILE SETS RC=4     */ 35250000
* /*-----------------------------------------------------------------*/ 35300000
*    IF MACLIST(1) = 'OPEN' | MACLIST(1) = 'EXTND' THEN  /*          */ 35350000
*       IF SIZE(1) = '0' THEN          /* SIZE ALLREADY LOADED       */ 35400000
*          GOTO RSTDR1;                /* REGISTER 0 NOT DECLARED    */ 35450000
*        ELSE;                         /*                            */ 35500000
*    IF MACLIST(1) = 'POINT' THEN      /*                            */ 35550000
*       IF RBA(1) = '0' THEN           /* RBA ALLREADY LOADED        */ 35600000
*          GOTO RSTDR1;                /* REGISTER 0 NOT DECLARED    */ 35650000
*        ELSE;                         /*                            */ 35700000
*     ELSE;                            /*                            */ 35750000
* ANS ('RFY VIO0'||MACINDEX||' RSTD;')RESCAN SKIP COL(10);              35800000
* RSTDR1:                              /*                            */ 35850000
*    IF MACLIST(1) ¬= 'OPEN' THEN      /*                            */ 35900000
*       IF NUMBER(VIORB) = 0 | VIORB(1) = '1' THEN   /*              */ 35950000
*          GOTO RSTDRF;                /* REGISTER 1 NOT DECLARED    */ 36000000
*        ELSE;                         /*                            */ 36050000
*     ELSE;                            /*                            */ 36100000
* ANS ('RFY VIO1'||MACINDEX||' RSTD;')RESCAN SKIP COL(10);              36150000
* RSTDRF:                              /*                            */ 36200000
* ANS ('RFY VIOF'||MACINDEX||' RSTD;')RESCAN SKIP COL(10);              36250000
* /*-----------------------------------------------------------------*/ 36300000
* /*     SET SIZE OPERAND FOR OPEN AND EXTND                         */ 36350000
* /*-----------------------------------------------------------------*/ 36400000
*    IF MACLIST(1) = 'CLOSE' THEN      /*                            */ 36450000
*       GOTO GENVRB;                   /* GENERATE SIZE OPERAND      */ 36500000
*    IF MACLIST(1) = 'POINT' THEN      /*                            */ 36550000
*       GOTO GENRBA;                   /* GENERATE RBA OPERAND       */ 36600000
*    IF SIZE(1) ¬= '0' THEN            /* SIZE ALLREADY LOADED       */ 36650000
*       IF SIZE(1,1:1) = '(' THEN      /* REGISTER NOTATION FOR SIZE */ 36700000
*          DO;                         /*                            */ 36750000
* ANS ('VIO0'||MACINDEX||' = '||SIZE(1)||';')RESCAN SKIP COL(10);       36800000
* ANS ('/* LOAD SIZE VALUE           */') COL(41);                      36850000
*          END;                        /*                            */ 36900000
*         ELSE                         /*                            */ 36950000
*          DO;                         /*                            */ 37000000
* ANS ('VIO0'||MACINDEX||' = '||SIZE(1,1:(INDEX(SIZE,'K')-2))||';')     37050000
* RESCAN SKIP COL(10);                                                  37100000
* ANS ('/* SIZE VALUE IN K-BYTES     */') COL(41);                      37150000
* ANS ('SLL(VIO0'||MACINDEX||',10);')RESCAN SKIP COL(10);               37200000
* ANS ('/* GET SIZE VALUE IN BYTES   */') COL(41);                      37250000
*          END;                        /*                            */ 37300000
*       ELSE;                          /*                            */ 37350000
*    IF MACLIST(1) = 'EXTND' THEN      /*                            */ 37400000
*       GOTO GENVRB;                   /* GENERATE VIORB OPERAND     */ 37450000
* /*-----------------------------------------------------------------*/ 37500000
* /*     GENERATE PARAMETER LIST FOR OPEN                            */ 37550000
* /*-----------------------------------------------------------------*/ 37600000
* ANS ('VIO1'||MACINDEX||' = ADDR(IJBY'||MACINDEX||');')RESCAN          37650000
* SKIP COL(10);                                                         37700000
* ANS ('/* POINT REG 1 TO PARMLIST   */') COL(41);                      37750000
* ANS ('DCL 1 IJBY'||MACINDEX||' BDY(WORD),') RESCAN SKIP COL(10);      37800000
* ANS ('/* VIORB PARAMETER LIST      */') COL(41);                      37850000
*    IF NUMBER(SCOPE) = 0 |            /* SCOPE OMITTED OR           */ 37900000
*       SCOPE(1) = 'STEP' THEN         /* SCOPE = STEP SPECIFIED     */ 37950000
*       ANS ('2 * FIXED(8) INIT(8),') RESCAN SKIP COL(15);              38000000
*      ELSE                            /* SCOPE = JOB SPECIFIED      */ 38050000
*       ANS ('2 * FIXED(8) INIT(16),') RESCAN SKIP COL(15);             38100000
*    ANS ('/* SCOPE OPTION BYTE         */') COL(41);                   38150000
*    IF NUMBER(PROC) = 0 |             /* PROC OMITTED OR            */ 38200000
*       PROC(1) = 'SYNCH' THEN         /* PROC = SYNCH SPECIFIED     */ 38250000
*       ANS ('2 * FIXED(8) INIT(0),') RESCAN SKIP COL(15);              38300000
*      ELSE                            /* SCOPE = JOB SPECIFIED      */ 38350000
*       ANS ('2 * FIXED(8) INIT(128),') RESCAN SKIP COL(15);            38400000
*    ANS ('/* PROCESSING OPTION BYTE    */') COL(41);                   38450000
* ANS ('2 * FIXED(16) INIT(0);') NORESCAN SKIP COL(15);                 38500000
* ANS ('/* RESERVED                  */') COL(41);                      38550000
* ANS ('VIOF'||MACINDEX||' = 0 ;')RESCAN SKIP COL(10);                  38600000
* ANS ('/* LOAD FUNCTION CODE        */') COL(41);                      38650000
*    GOTO GSVC114;                                                      38700000
* /*-----------------------------------------------------------------*/ 38750000
* /*     SET RBA OPERAND FOR POINT                                   */ 38800000
* /*-----------------------------------------------------------------*/ 38850000
* GENRBA:                              /*                            */ 38900000
*    IF RBA(1) ¬= '0' THEN             /* RBA ALLREADY LOADED        */ 38950000
*       DO;                            /*                            */ 39000000
* ANS ('VIO0'||MACINDEX||' = '||RBA(1)||';')RESCAN SKIP COL(10);        39050000
* ANS ('/* LOAD RBA                  */') COL(41);                      39100000
*       END;                           /*                            */ 39150000
* /*-----------------------------------------------------------------*/ 39200000
* /*     SET VIORB OPERAND FOR EXTND CLOSE OR POINT                  */ 39250000
* /*-----------------------------------------------------------------*/ 39300000
* GENVRB:                              /*                            */ 39350000
*    IF NUMBER(VIORB) ¬= 0 THEN        /* VIORB SPECIFIED            */ 39400000
*       IF VIORB(1) ¬= '1' THEN        /* VIORB ALLREADY LOADED      */ 39450000
*          DO;                         /*                            */ 39500000
* ANS ('VIO1'||MACINDEX||' = '||VIORB(1)||';')RESCAN SKIP COL(10);      39550000
* ANS ('/* LOAD POINTER TO VIORB     */') COL(41);                      39600000
*          END;                        /*                            */ 39650000
*        ELSE;                         /*                            */ 39700000
*     ELSE;                            /*                            */ 39750000
* /*-----------------------------------------------------------------*/ 39800000
* /*     SET FUNCTION CODE FOR EXTND                                 */ 39850000
* /*-----------------------------------------------------------------*/ 39900000
*    IF MACLIST(1) = 'EXTND' THEN      /* IF EXTND SKIP              */ 39950000
*       DO;                            /*                            */ 40000000
* ANS ('VIOF'||MACINDEX||' = 1 ;')RESCAN SKIP COL(10);                  40050000
* ANS ('/* SET FUNCTION CODE         */') COL(41);                      40100000
*       GOTO GSVC114;                  /*                            */ 40150000
*       END;                           /*                            */ 40200000
* /*-----------------------------------------------------------------*/ 40250000
* /*     SET FUNCTION CODE FOR POINT                                 */ 40300000
* /*-----------------------------------------------------------------*/ 40350000
*    IF MACLIST(1) = 'POINT' THEN      /*                            */ 40400000
*       DO;                            /*                            */ 40450000
* ANS ('VIOF'||MACINDEX||' = 72 ;')RESCAN SKIP COL(10);                 40500000
* ANS ('/* SET FUNCTION CODE         */') COL(41);                      40550000
*       GOTO GSVC107;                  /*                            */ 40600000
*       END;                           /*                            */ 40650000
* /*-----------------------------------------------------------------*/ 40700000
* /*     SET SCOPE VALUE FOR CLOSE                                   */ 40750000
* /*-----------------------------------------------------------------*/ 40800000
*    IF NUMBER(SCOPE) = 0 THEN         /* SCOPE OMITTED OR           */ 40850000
*       DO;                            /*                            */ 40900000
* ANS ('VIO0'||MACINDEX||' = 0 ;')RESCAN SKIP COL(10);                  40950000
* ANS ('/* INDICATE SCOPE OMITTED    */') COL(41);                      41000000
*       END;                           /*                            */ 41050000
*     ELSE                             /*                            */ 41100000
*       DO;                            /*                            */ 41150000
*       IF SCOPE(1) = 'STEP' THEN      /* SCOPE = STEP SPECIFIED     */ 41200000
*          DO;                         /*                            */ 41250000
* ANS ('VIO0'||MACINDEX||' = 8 ;')RESCAN SKIP COL(10);                  41300000
* ANS ('/* INDICATE SCOPE = STEP     */') COL(41);                      41350000
*          END;                        /*                            */ 41400000
*         ELSE                         /*                            */ 41450000
*          DO;                         /*                            */ 41500000
* ANS ('VIO0'||MACINDEX||' = 16 ;')RESCAN SKIP COL(10);                 41550000
* ANS ('/* INDICATE SCOPE = JOB      */') COL(41);                      41600000
*          END;                        /*                            */ 41650000
*       END;                           /*                            */ 41700000
* ANS ('VIOF'||MACINDEX||' = 2 ;')RESCAN SKIP COL(10);                  41750000
* ANS ('/* SET FUNCTION CODE         */') COL(41);                      41800000
* /*-----------------------------------------------------------------*/ 41850000
* /*     GENERATE SVC                                                */ 41900000
* /*-----------------------------------------------------------------*/ 41950000
* GSVC114:                                                              42000000
* ANS ('SVC(114);')RESCAN SKIP COL(10);                                 42050000
* ANS ('/* CALL FUNCTION             */') COL(41);                      42100000
* GOTO RESPEC;                         /*                            */ 42150000
* GSVC107:                                                              42200000
* ANS ('SVC(107);')RESCAN SKIP COL(10);                                 42250000
* ANS ('/* CALL FUNCTION             */') COL(41);                      42300000
* /*-----------------------------------------------------------------*/ 42350000
* /*     UNRESTRICT GENERATED REGISTER                               */ 42400000
* /*-----------------------------------------------------------------*/ 42450000
* RESPEC:                                                               42500000
*    IF MACLIST(1) = 'OPEN' | MACLIST(1) = 'EXTND' THEN  /*          */ 42550000
*       IF SIZE(1) = '0' THEN          /* SIZE ALLREADY LOADED       */ 42600000
*          GOTO RSTREG1;               /* REGISTER 0 NOT DECLARED    */ 42650000
*        ELSE;                         /*                            */ 42700000
*    IF MACLIST(1) = 'POINT' THEN      /*                            */ 42750000
*       IF RBA(1) = '0' THEN           /* RBA ALLREADY LOADED        */ 42800000
*          GOTO RSTREG1;               /* REGISTER 0 NOT DECLARED    */ 42850000
*        ELSE;                         /*                            */ 42900000
*     ELSE;                            /*                            */ 42950000
* ANS ('RFY VIO0'||MACINDEX||' UNRSTD;')RESCAN SKIP COL(10);            43000000
* RSTREG1:                             /*                            */ 43050000
*    IF MACLIST(1) ¬= 'OPEN' THEN      /*                            */ 43100000
*       IF NUMBER(VIORB) = 0 | VIORB(1) = '1' THEN   /*              */ 43150000
*          GOTO RSTREGF;               /* REGISTER 1 NOT DECLARED    */ 43200000
*        ELSE;                         /*                            */ 43250000
*     ELSE;                            /*                            */ 43300000
* ANS ('RFY VIO1'||MACINDEX||' UNRSTD;')RESCAN SKIP COL(10);            43350000
* RSTREGF:                             /*                            */ 43400000
* ANS ('RFY VIOF'||MACINDEX||' UNRSTD;')RESCAN SKIP COL(10);            43450000
* RETURN CODE(0);                      /* EXIT                       */ 43500000
* /*-----------------------------------------------------------------*/ 43550000
* /*     CHECK REQUIRED OPERANDS FOR MOVE                            */ 43600000
* /*-----------------------------------------------------------------*/ 43650000
* CHMOVE :                             /*                            */ 43700000
*    IF NUMBER(LEN) = 0 THEN           /* LEN OPERAND REQUIRED       */ 43750000
*       GO TO MERR16;                  /*                            */ 43800000
*    IF NUMBER(FROM) = 0 THEN          /* FROM OPERAND REQUIRED      */ 43850000
*       GO TO MERR17;                  /*                            */ 43900000
*    IF NUMBER(TO) = 0 THEN            /* TO OPERAND REQUIRED        */ 43950000
*       GO TO MERR18;                  /*                            */ 44000000
*    IF NUMBER(FROM) > 2 THEN          /*                            */ 44050000
*       GO TO MERR19;                  /* FROM OPERAND INVALID       */ 44100000
*    IF NUMBER(TO) > 2 THEN            /*                            */ 44150000
*       GO TO MERR20;                  /* TO OPERAND INVALID         */ 44200000
*    IF NUMBER(FROM) = 1 & NUMBER(TO) = 1 THEN   /*                  */ 44250000
*       GO TO MERR21;                  /* ONE VIO ADDRESS REQUIRED   */ 44300000
*    IF NUMBER(FROM) = 2 THEN          /*                            */ 44350000
*       IF FROM(1,1:1) ¬= '(' | FROM(2,1:1) ¬= '(' THEN  /*          */ 44400000
*          GO TO MERR22;               /* REGISTER NOTATION REQUIRED */ 44450000
*     ELSE;                            /*                            */ 44500000
*    IF NUMBER(TO) = 2 THEN            /*                            */ 44550000
*       IF TO(1,1:1) ¬= '(' | TO(2,1:1) ¬= '(' THEN  /*              */ 44600000
*          GO TO MERR23;               /* REGISTER NOTATION REQUIRED */ 44650000
*     ELSE;                            /*                            */ 44700000
* /*-----------------------------------------------------------------*/ 44750000
* /*     DECLARE NEEDED REGISTER                                     */ 44800000
* /*-----------------------------------------------------------------*/ 44850000
* ANS ('DCL VIO0'||MACINDEX||' REG(0) PTR(31);')RESCAN SKIP COL(10);    44900000
* ANS ('/* SPECIFY REGISTER 0        */') COL(41);                      44950000
* ANS ('DCL VIO1'||MACINDEX||' REG(1) PTR(31);')RESCAN SKIP COL(10);    45000000
* ANS ('/* SPECIFY REGISTER 1        */') COL(41);                      45050000
* ANS ('DCL VIOF'||MACINDEX||' REG(15) PTR(31);')RESCAN SKIP COL(10);   45100000
* ANS ('/* SPECIFY REGISTER 15       */') COL(41);                      45150000
*    ANS ('RFY VIO0'||MACINDEX||' RSTD;')RESCAN SKIP COL(10);           45200000
*    ANS ('RFY VIO1'||MACINDEX||' RSTD;')RESCAN SKIP COL(10);           45250000
*    ANS ('RFY VIOF'||MACINDEX||' RSTD;')RESCAN SKIP COL(10);           45300000
* /*-----------------------------------------------------------------*/ 45350000
* /*     BUILD PARAMETER LIST                                        */ 45400000
* /*-----------------------------------------------------------------*/ 45450000
*    IF NUMBER(MFG) = 0 THEN           /* SPECIFY INLINE PARAMETER   */ 45500000
*       DO;                            /* LIST                       */ 45550000
*        ANS ('DCL IJBY'||MACINDEX||'(5) FIXED(31);')                   45600000
*        RESCAN SKIP COL(10);                                           45650000
*        ANS ('/* VIO MOVE PARAMETER LIST   */') COL(41);               45700000
*       END;                           /*                            */ 45750000
*     ELSE                             /*                            */ 45800000
*       DO;                            /* LIST                       */ 45850000
*       IF MFG(1) = '1' THEN           /* REGISTER 1 ALLREADY LOADED */ 45900000
* ANS ('DCL IJBY'||MACINDEX||'(5) FIXED(31) BASED(VIO1'||MACINDEX||');' 45950000
* )RESCAN SKIP COL(10);                                                 46000000
*        ELSE                          /*                            */ 46050000
*          IF MFG(1,1:1) = '(' THEN    /* IF REGISTER NOTATION       */ 46100000
* ANS ('DCL IJBY'||MACINDEX||'(5) FIXED(31) BASED('||MFG(1)||');')      46150000
* RESCAN SKIP COL(10);                                                  46200000
*           ELSE                       /*                            */ 46250000
* ANS ('DCL IJBY'||MACINDEX||'(5) FIXED(31) BASED(ADDR('||MFG(1)||'));' 46300000
* )RESCAN SKIP COL(10);                                                 46350000
*        ANS ('/* VIO MOVE PARAMETER LIST   */') COL(41);               46400000
*       END;                           /*                            */ 46450000
* /*-----------------------------------------------------------------*/ 46500000
* /*     SET LEN-, FROM- AND TO FIELDS IN INLINE PARAMETER LIST      */ 46550000
* /*-----------------------------------------------------------------*/ 46600000
*  ANS ('IJBY'||MACINDEX||'(1) = '||LEN(1)||';')RESCAN SKIP COL(10);    46650000
*  ANS ('/* SET LENGTH                */') COL(41);                     46700000
*    IF NUMBER(FROM) = 1 THEN          /* FROM IS VIRTUAL ADDRESS    */ 46750000
*       DO;                            /*                            */ 46800000
*  ANS ('IJBY'||MACINDEX||'(2) = 0 ;')RESCAN SKIP COL(10);              46850000
*  ANS ('/* CLEAR UNUSED FROM FIELD   */') COL(41);                     46900000
*       IF FROM(1,1:1) = '(' THEN      /* IF REGISTER NOTATION       */ 46950000
*  ANS ('IJBY'||MACINDEX||'(3) = '||FROM(1)||';')RESCAN SKIP COL(10);   47000000
*        ELSE                          /*                            */ 47050000
*  ANS ('IJBY'||MACINDEX||'(3) = ADDR('||FROM(1)||');')                 47100000
*  RESCAN SKIP COL(10);                                                 47150000
*  ANS ('/* SET FROM ADDRESS          */') COL(41);                     47200000
*       END;                           /*                            */ 47250000
*     ELSE                             /*                            */ 47300000
*       DO;                            /*                            */ 47350000
*  ANS ('IJBY'||MACINDEX||'(2) = '||FROM(1)||';')RESCAN SKIP COL(10);   47400000
*  ANS ('/* SET FROM VIORB            */') COL(41);                     47450000
*  ANS ('IJBY'||MACINDEX||'(3) = '||FROM(2)||';')RESCAN SKIP COL(10);   47500000
*  ANS ('/* SET FROM RBA              */') COL(41);                     47550000
*       END;                           /*                            */ 47600000
*    IF NUMBER(TO) = 1 THEN            /* TO IS VIRTUAL ADDRESS      */ 47650000
*       DO;                            /*                            */ 47700000
*  ANS ('IJBY'||MACINDEX||'(4) = 0 ;')RESCAN SKIP COL(10);              47750000
*  ANS ('/* CLEAR UNUSED TO FIELD     */') COL(41);                     47800000
*       IF TO(1,1:1) = '(' THEN        /* IF REGISTER NOTATION       */ 47850000
*  ANS ('IJBY'||MACINDEX||'(5) = '||TO(1)||';')RESCAN SKIP COL(10);     47900000
*        ELSE                          /*                            */ 47950000
*  ANS ('IJBY'||MACINDEX||'(5) = ADDR('||TO(1)||');')                   48000000
*  RESCAN SKIP COL(10);                                                 48050000
*  ANS ('/* SET TO ADDRESS            */') COL(41);                     48100000
*       END;                           /*                            */ 48150000
*     ELSE                             /*                            */ 48200000
*       DO;                            /*                            */ 48250000
*  ANS ('IJBY'||MACINDEX||'(4) = '||TO(1)||';')RESCAN SKIP COL(10);     48300000
*  ANS ('/* SET TO VIORB              */') COL(41);                     48350000
*  ANS ('IJBY'||MACINDEX||'(5) = '||TO(2)||';')RESCAN SKIP COL(10);     48400000
*  ANS ('/* SET TO RBA                */') COL(41);                     48450000
*       END;                           /*                            */ 48500000
* /*-----------------------------------------------------------------*/ 48550000
* /*     GET ADDRESS OF MOVE ROUTINE                                 */ 48600000
* /*-----------------------------------------------------------------*/ 48650000
*    IF NUMBER(TO) = 1 THEN            /* TO IS VIRTUAL ADDRESS      */ 48700000
*       ANS ('RFY MAPVIORB BASED('||FROM(1)||');')RESCAN SKIP COL(10);  48750000
*     ELSE                             /*                            */ 48800000
*       ANS ('RFY MAPVIORB BASED('||TO(1)||');')RESCAN SKIP COL(10);    48850000
*    ANS ('/* POINT TO VIORB            */') COL(41);                   48900000
*    ANS ('VIOF'||MACINDEX||' = VIORBASR ;')RESCAN SKIP COL(10);        48950000
*    ANS ('/* GET MOVE ROUTINE ADDRESS  */') COL(41);                   49000000
* /*-----------------------------------------------------------------*/ 49050000
* /*     SET POINTER TO MOVE PARAMETER LIST                          */ 49100000
* /*-----------------------------------------------------------------*/ 49150000
*    IF NUMBER(MFG) = 0 THEN           /*                            */ 49200000
*       DO;                            /*                            */ 49250000
*        ANS ('VIO1'||MACINDEX||' = ADDR(IJBY'||MACINDEX||');')RESCAN   49300000
*        SKIP COL(10);                                                  49350000
*        ANS ('/* POINT TO PARAMETER LIST   */') COL(41);               49400000
*       END;                           /*                            */ 49450000
*     ELSE                             /*                            */ 49500000
*       DO;                            /*                            */ 49550000
*       IF MFG(1) ¬= '1' THEN          /* NOT REGISTER 1             */ 49600000
*          DO;                         /*                            */ 49650000
*          IF MFG(1,1:1) = '(' THEN    /* BUT REGISTER NOTATION      */ 49700000
*  ANS ('VIO1'||MACINDEX||' ='||MFG(1)||';')RESCAN SKIP COL(10);        49750000
*           ELSE                       /*                            */ 49800000
*  ANS ('VIO1'||MACINDEX||' = ADDR('||MFG(1)||');')RESCAN SKIP COL(10); 49850000
*  ANS ('/* POINT TO PARAMETER LIST   */') COL(41);                     49900000
*          END;                        /*                            */ 49950000
*        ELSE;                         /* REGISTER 1 ALLREADY LOADED */ 50000000
*       END;                           /*                            */ 50050000
* /*-----------------------------------------------------------------*/ 50100000
* /*     SET BAL INTERFACE                                           */ 50150000
* /*-----------------------------------------------------------------*/ 50200000
*    ANS ('GEN (BALR  14,15);')RESCAN SKIP COL(10);                     50250000
*    ANS ('/* BRANCH TO MOVE ROUTINE    */') COL(41);                   50300000
* /*-----------------------------------------------------------------*/ 50350000
* /*     UNRESTRICT GENERATED REGISTER                               */ 50400000
* /*-----------------------------------------------------------------*/ 50450000
*    ANS ('RFY VIO0'||MACINDEX||' UNRSTD;')RESCAN SKIP COL(10);         50500000
*    ANS ('/* UNRESTRICT REGISTER 0     */') COL(41);                   50550000
*    ANS ('RFY VIO1'||MACINDEX||' UNRSTD;')RESCAN SKIP COL(10);         50600000
*    ANS ('/* UNRESTRICT REGISTER 1     */') COL(41);                   50650000
*    ANS ('RFY VIOF'||MACINDEX||' UNRSTD;')RESCAN SKIP COL(10);         50700000
*    ANS ('/* UNRESTRICT REGISTER 15    */') COL(41);                   50750000
*    RETURN CODE(0);                   /* EXIT                       */ 50800000
* /*-----------------------------------------------------------------*/ 50850000
* /*     MACRO NOTES                                                 */ 50900000
* /*-----------------------------------------------------------------*/ 50950000
* MERR01 :                             /* INVALID STRING FOR SCOPE   */ 51000000
* ANS MSG('REQUIRED POSITIONAL ARGUMENT NOT SPECIFIED ;')RESCAN;        51050000
* ANS ('/* REQUIRED POSITIONAL ARGUMENT NOT SPECIFIED */') RESCAN       51100000
* COL(MACLMAR);                                                         51150000
* RETURN CODE(8);                      /* EXIT                       */ 51200000
* MERR02 :                             /* INVALID STRING FOR PROC    */ 51250000
* ANS MSG('MORE THEN ONE POSITIONAL ARGUMENT SPECIFIED ;')RESCAN;       51300000
* ANS ('/* MORE THEN ONE POSITIONAL ARGUMENT SPECIFIED */') RESCAN      51350000
* COL(MACLMAR);                                                         51400000
* RETURN CODE(8);                      /* EXIT                       */ 51450000
* MERR03 :                             /* INVALID STRING FOR PROC    */ 51500000
* ANS MSG('INVALID POSITIONAL ARGUMENT '||MACLIST(1)||' SPECIFIED ;')   51550000
* RESCAN;                                                               51600000
* ANS ('/* INVALID POSITIONAL ARGUMENT '||MACLIST(1)||' SPECIFIED*/')   51650000
* RESCAN COL(MACLMAR);                                                  51700000
* RETURN CODE(8);                      /* EXIT                       */ 51750000
* MERR04 :                             /* VIORB INVALID              */ 51800000
* ANS MSG('VIORB IS INVALID FOR FUNCTION '||MACLIST(1)||' ;')RESCAN;    51850000
* ANS ('/* VIORB IS INVALID FOR FUNCTION '||MACLIST(1)||' */')          51900000
* RESCAN COL(MACLMAR);                                                  51950000
* RETURN CODE(8);                      /* EXIT                       */ 52000000
* MERR05 :                             /* RBA INVALID                */ 52050000
* ANS MSG('RBA IS INVALID FOR FUNCTION '||MACLIST(1)||' ;')RESCAN;      52100000
* ANS ('/* RBA IS INVALID FOR FUNCTION '||MACLIST(1)||' */')            52150000
* RESCAN COL(MACLMAR);                                                  52200000
* RETURN CODE(8);                      /* EXIT                       */ 52250000
* MERR06 :                             /* PROC INVALID               */ 52300000
* ANS MSG('PROC IS INVALID FOR FUNCTION '||MACLIST(1)||' ;')RESCAN;     52350000
* ANS ('/* PROC IS INVALID FOR FUNCTION '||MACLIST(1)||' */')           52400000
* RESCAN COL(MACLMAR);                                                  52450000
* RETURN CODE(8);                      /* EXIT                       */ 52500000
* MERR07 :                             /* SCOPE INVALID              */ 52550000
* ANS MSG('SCOPE IS INVALID FOR FUNCTION '||MACLIST(1)||' ;')RESCAN;    52600000
* ANS ('/* SCOPE IS INVALID FOR FUNCTION '||MACLIST(1)||' */')          52650000
* RESCAN COL(MACLMAR);                                                  52700000
* RETURN CODE(8);                      /* EXIT                       */ 52750000
* MERR08 :                             /* SIZE INVALID               */ 52800000
* ANS MSG('SIZE IS INVALID FOR FUNCTION '||MACLIST(1)||' ;')RESCAN;     52850000
* ANS ('/* SIZE IS INVALID FOR FUNCTION '||MACLIST(1)||' */')           52900000
* RESCAN COL(MACLMAR);                                                  52950000
* RETURN CODE(8);                      /* EXIT                       */ 53000000
* MERR09 :                             /* RBA REQUIRED               */ 53050000
* ANS MSG('RBA OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' ;')       53100000
* RESCAN;                                                               53150000
* ANS ('/* RBA OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' */')      53200000
* RESCAN COL(MACLMAR);                                                  53250000
* RETURN CODE(8);                      /* EXIT                       */ 53300000
* MERR10 :                             /* RBA NOT REGISTER NOTATION  */ 53350000
* ANS MSG('RBA OPERAND NOT REGISTER NOTATION ;')RESCAN;                 53400000
* ANS ('/* RBA OPERAND NOT REGISTER NOTATION */')                       53450000
* RESCAN COL(MACLMAR);                                                  53500000
* RETURN CODE(8);                      /* EXIT                       */ 53550000
* MERR11 :                             /* RBA NOT REGISTER NOTATION  */ 53600000
* ANS MSG('SIZE OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' ;')      53650000
* RESCAN;                                                               53700000
* ANS ('/* SIZE OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' */')     53750000
* RESCAN COL(MACLMAR);                                                  53800000
* RETURN CODE(8);                      /* EXIT                       */ 53850000
* MERR12 :                             /* INVALID SIZE SPECIFICATION */ 53900000
* ANS MSG('UNIT FOR SIZE MUST BE K-BYTES ;')RESCAN;                     53950000
* ANS ('/* UNIT FOR SIZE MUST BE K-BYTES */')RESCAN COL(MACLMAR);       54000000
* RETURN CODE(8);                      /* EXIT                       */ 54050000
* MERR13 :                             /* VIORB NOT REGISTER NOTATION*/ 54100000
* ANS MSG('VIORB OPERAND NOT REGISTER NOTATION ;')RESCAN;               54150000
* ANS ('/* VIORB OPERAND NOT REGISTER NOTATION */')                     54200000
* RESCAN COL(MACLMAR);                                                  54250000
* RETURN CODE(8);                      /* EXIT                       */ 54300000
* MERR14 :                             /* INVALID STRING FOR SCOPE   */ 54350000
* ANS MSG(''||SCOPE||' IS INVALID FOR SCOPE OPERAND ;')RESCAN;          54400000
* ANS ('/* '||SCOPE||' IS INVALID FOR SCOPE OPERAND */') RESCAN         54450000
* COL(MACLMAR);                                                         54500000
* RETURN CODE(8);                      /* EXIT                       */ 54550000
* MERR15 :                             /* INVALID STRING FOR PROC    */ 54600000
* ANS MSG(''||PROC||' IS INVALID FOR PROC OPERAND ;')RESCAN;            54650000
* ANS ('/* '||PROC||' IS INVALID FOR PROC OPERAND */') RESCAN           54700000
* COL(MACLMAR);                                                         54750000
* RETURN CODE(8);                      /* EXIT                       */ 54800000
* MERR16 :                             /* LEN OPERAND REQUIRED       */ 54850000
* ANS MSG('LEN OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' ;')       54900000
* RESCAN;                                                               54950000
* ANS ('/* LEN OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' */')      55000000
* RESCAN COL(MACLMAR);                                                  55050000
* RETURN CODE(8);                      /* EXIT                       */ 55100000
* MERR17 :                             /* LEN OPERAND REQUIRED       */ 55150000
* ANS MSG('FROM OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' ;')      55200000
* RESCAN;                                                               55250000
* ANS ('/* FROM OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' */')     55300000
* RESCAN COL(MACLMAR);                                                  55350000
* RETURN CODE(8);                      /* EXIT                       */ 55400000
* MERR18 :                             /* LEN OPERAND REQUIRED       */ 55450000
* ANS MSG('TO OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' ;')        55500000
* RESCAN;                                                               55550000
* ANS ('/* TO OPERAND REQUIRED FOR FUNCTION '||MACLIST(1)||' */')       55600000
* RESCAN COL(MACLMAR);                                                  55650000
* RETURN CODE(8);                      /* EXIT                       */ 55700000
* MERR19 :                             /* INVALID STRING FOR PROC    */ 55750000
* ANS MSG(''||FROM||' IS INVALID FOR FROM OPERAND ;')RESCAN;            55800000
* ANS ('/* '||FROM||' IS INVALID FOR FROM OPERAND */') RESCAN           55850000
* COL(MACLMAR);                                                         55900000
* RETURN CODE(8);                      /* EXIT                       */ 55950000
* MERR20 :                             /* INVALID STRING FOR PROC    */ 56000000
* ANS MSG(''||TO||' IS INVALID FOR TO OPERAND ;')RESCAN;                56050000
* ANS ('/* '||TO||' IS INVALID FOR TO OPERAND */') RESCAN COL(MACLMAR); 56100000
* RETURN CODE(8);                      /* EXIT                       */ 56150000
* MERR21 :                             /* INVALID STRING FOR PROC    */ 56200000
* ANS MSG('AT LEAST ONE VIO ADDRESS REQUIRED ;')RESCAN;                 56250000
* ANS ('/* AT LEAST ONE VIO ADDRESS REQUIRED */') RESCAN COL(MACLMAR);  56300000
* RETURN CODE(8);                      /* EXIT                       */ 56350000
* MERR22 :                             /* INVALID STRING FOR PROC    */ 56400000
* ANS MSG('REGISTER NOTATION REQUIRED FOR FROM OPERAND ;')RESCAN;       56450000
* ANS ('/* REGISTER NOTATION REQUIRED FOR FROM OPERAND */')RESCAN       56500000
* COL(MACLMAR);                                                         56550000
* RETURN CODE(8);                      /* EXIT                       */ 56600000
* MERR23 :                             /* INVALID STRING FOR PROC    */ 56650000
* ANS MSG('REGISTER NOTATION REQUIRED FOR TO OPERAND ;')RESCAN;         56700000
* ANS ('/* REGISTER NOTATION REQUIRED FOR TO OPERAND */')RESCAN         56750000
* COL(MACLMAR);                                                         56800000
* RETURN CODE(8);                      /* EXIT                       */ 56850000
* MERR24 :                             /* LEN INVALID                */ 56900000
* ANS MSG('LEN IS INVALID FOR FUNCTION '||MACLIST(1)||' ;')RESCAN;      56950000
* ANS ('/* LEN IS INVALID FOR FUNCTION '||MACLIST(1)||' */')            57000000
* RESCAN COL(MACLMAR);                                                  57050000
* RETURN CODE(8);                      /* EXIT                       */ 57100000
* MERR25 :                             /* FROM INVALID               */ 57150000
* ANS MSG('FROM IS INVALID FOR FUNCTION '||MACLIST(1)||' ;')RESCAN;     57200000
* ANS ('/* FROM IS INVALID FOR FUNCTION '||MACLIST(1)||' */')           57250000
* RESCAN COL(MACLMAR);                                                  57300000
* RETURN CODE(8);                      /* EXIT                       */ 57350000
* MERR26 :                             /* TO INVALID                 */ 57400000
* ANS MSG('TO IS INVALID FOR FUNCTION '||MACLIST(1)||' ;')RESCAN;       57450000
* ANS ('/* TO IS INVALID FOR FUNCTION '||MACLIST(1)||' */')             57500000
* RESCAN COL(MACLMAR);                                                  57550000
* RETURN CODE(8);                      /* EXIT                       */ 57600000
*%END ;                                /*                            */ 57650000
