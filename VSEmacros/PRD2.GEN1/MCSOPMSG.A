*/**** START OF SPECIFICATIONS **************************************** 00049400
*                                                                     * 00098800
*                                                                     * 00148200
*01* MACRO NAME:  MCSOPMSG                              -90/11/29-<1> * 00197600
*                                                                     * 00247000
*01* PROPRIETARY STATEMENT:                                           * 00296400
*                                                                     * 00345800
*     5695-047                                                        * 00395200
*     THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                     * 00444600
*     (C) COPYRIGHT IBM CORP. 1991                                    * 00494000
*     LICENSED MATERIALS - PROPERTY OF IBM                            * 00543400
*                                                                     * 00592800
* STATUS= HBB4420                                                     * 00642200
*                                                                     * 00691600
*01* DESCRIPTIVE NAME:  MCS Operator Message Service                  * 00741000
*                                                                     * 00790400
*                                                                     * 00839800
*01* FUNCTION:                                                        * 00889200
*                                                                     * 00938600
*      The MCSOPMSG macro is used to retrieve the address and alet of * 00988000
*      a message when posted by Comm Task.  The message delivered via * 01037400
*      the GETMSG service can be qualified by search criteria such as * 01086800
*      CONSID, CART, and MASK, if so desired.  The RESUME service     * 01136200
*      allows queuing to this operator to be resumed, if the queuing  * 01185600
*      was previously disabled.                                       * 01235000
*                                                                     * 01284400
*01* INVOCATION REQUIREMENTS:                                         * 01333800
*                                                                     * 01383200
*                                                                     * 01432600
*      Execution Mode:   Task mode.                                   * 01482000
*                                                                     * 01531400
*      Authorization:    Supervisor state.  Any PSW key.              * 01580800
*                                                                     * 01630200
*      Addressing Mode:  31 bit addressing mode.                      * 01679600
*                                                                     * 01729000
*      ASC mode:         Access Register ASC mode.                    * 01778400
*                                                                     * 01827800
*      Serialization:    None.                                        * 01877200
*                                                                     * 01926600
*      Restrictions:     None.                                        * 01976000
*                                                                     * 02025400
*                                                                     * 02074800
*01* INVOCATION FORMAT:                                               * 02124200
*                                                                     * 02173600
*Ýxlabel¨  MCSOPMSG  Ð  REQUEST=RESUME                                * 02223000
*                    ¿ ,REQUEST=GETMSG                                * 02272400
*                        ÐÝ,CMDRESP=NO¨                               * 02321800
*                        ¿Ý,CMDRESP=YES                               * 02371200
*                             Ý,CART=»xcart|NULLº                     * 02420600
*                                 Ý,MASK=»xmask|NULLº¨¨¨              * 02470000
*                      ,CONSID=xconsid                                * 02519400
*                     Ý,RTNCODE=xrtncode¨                             * 02568800
*                     Ý,RSNCODE=xrsncode¨                             * 02618200
*                    ÐÝ,MF=S¨                                         * 02667600
*                    ÔÝ,MF=(L,xmfctrl»,xmfattr|0Dº)¨                  * 02717000
*                    ÔÝ,MF=(M,xmfctrl»,COMPLETE|NOCHECKº)¨            * 02766400
*                    ¿Ý,MF=(E,xmfctrl»,COMPLETE|NOCHECKº)¨            * 02815800
*                                                                     * 02865200
*                                                                     * 02914600
*      Where:                                                         * 02964000
*                                                                     * 03013400
*                                                                     * 03062800
*      Ýxlabel¨                                                       * 03112200
*          is an optional 1 to 8 alphanumeric character input string, * 03161600
*          starting in column 1, that is the assembler label on the   * 03211000
*          MCSOPMSG macro.                                            * 03260400
*          DEFAULT: Null label.                                       * 03309800
*                                                                     * 03359200
*                                                                     * 03408600
*                                                                     * 03458000
*      REQUEST=»RESUME|GETMSGº                                        * 03507400
*          is a required keyword input that indicates the type of     * 03556800
*          request being made.                                        * 03606200
*                                                                     * 03655600
*                                                                     * 03705000
*          REQUEST=RESUME                                             * 03754400
*              Indicates that queuing will resume.                    * 03803800
*                                                                     * 03853200
*          REQUEST=GETMSG                                             * 03902600
*              Indicates that a message is requested.                 * 03952000
*                                                                     * 04001400
*                                                                     * 04050800
*              ÝCMDRESP=»NO|YESº¨                                     * 04100200
*                  is an optional keyword input that indicates the    * 04149600
*                  type of message search being requested.            * 04199000
*                  DEFAULT: NO                                        * 04248400
*                                                                     * 04297800
*                                                                     * 04347200
*                  ÝCMDRESP=NO¨                                       * 04396600
*                      Indicates that the first message will be       * 04446000
*                      obtained.                                      * 04495400
*                                                                     * 04544800
*                  ÝCMDRESP=YES                                       * 04594200
*                      Indicates a search will occur.                 * 04643600
*                                                                     * 04693000
*                                                                     * 04742400
*                      ÝCART=»xcart|NULLº                             * 04791800
*                          is the name (RX-type), or address in       * 04841200
*                          register (2)-(12), of an optional 8        * 04890600
*                          character input that indicates the CART to * 04940000
*                          use to search for the next message.        * 04989400
*                          DEFAULT: NULL                              * 05038800
*                                                                     * 05088200
*                                                                     * 05137600
*                          ÝMASK=»xmask|NULLº¨¨¨                      * 05187000
*                              is the name (RX-type), or address in   * 05236400
*                              register (2)-(12), of an optional 8    * 05285800
*                              character input that indicates the     * 05335200
*                              mask to be ANDed with the CART.        * 05384600
*                              DEFAULT: NULL                          * 05434000
*                                                                     * 05483400
*                                                                     * 05532800
*                                                                     * 05582200
*                                                                     * 05631600
*                                                                     * 05681000
*                                                                     * 05730400
*                                                                     * 05779800
*                                                                     * 05829200
*      CONSID=xconsid                                                 * 05878600
*          is the name (RX-type), or address in register (2)-(12), of * 05928000
*          a required fullword input that specifies the 4 byte        * 05977400
*          console ID.                                                * 06026800
*                                                                     * 06076200
*                                                                     * 06125600
*                                                                     * 06175000
*      ÝRTNCODE=xrtncode¨                                             * 06224400
*          is the name (RX-type) of an optional fullword output       * 06273800
*          variable, or register (2)-(12), into which the return code * 06323200
*          is to be copied from GPR 15.                               * 06372600
*                                                                     * 06422000
*                                                                     * 06471400
*                                                                     * 06520800
*      ÝRSNCODE=xrsncode¨                                             * 06570200
*          is the name (RX-type) of an optional fullword output       * 06619600
*          variable, or register (2)-(12), into which the reason code * 06669000
*          is to be copied from GPR 0.                                * 06718400
*                                                                     * 06767800
*                                                                     * 06817200
*                                                                     * 06866600
*      ÝMF=»S|L|M|Eº¨                                                 * 06916000
*          is an optional keyword input which specifies the macro     * 06965400
*          form.                                                      * 07014800
*          DEFAULT: S                                                 * 07064200
*                                                                     * 07113600
*                                                                     * 07163000
*          ÝMF=S¨                                                     * 07212400
*              specifies the standard form of the macro.  The "S"     * 07261800
*              form generates code to put the parameters into an      * 07311200
*              in-line parameter list and invoke the desired service. * 07360600
*              Full checking for required macro keys is done along    * 07410000
*              with supplying defaults for optional parameters that   * 07459400
*              are not specified.                                     * 07508800
*                                                                     * 07558200
*          ÝMF=(L,xmfctrl»,xmfattr|0Dº)¨                              * 07607600
*              specifies the list form of the macro.  The "L" form    * 07657000
*              defines an area to be used for the parameter list.     * 07706400
*              Any other macro parameters are flagged as errors.      * 07755800
*                                                                     * 07805200
*            ,xmfctrl                                                 * 07854600
*              is a required input.  It is the name (RX-type) of a    * 07904000
*              storage area for the parameter list.                   * 07953400
*                                                                     * 08002800
*            »,xmfattr|0Dº                                            * 08052200
*              is an optional 60 character input  string that varies  * 08101600
*              from 1 to 60 characters, that contains any special     * 08151000
*              attributes for the parameter list.                     * 08200400
*              DEFAULT: 0D which indicates the parameter list is to   * 08249800
*              be aligned on a double word boundary.                  * 08299200
*                                                                     * 08348600
*          ÝMF(M,xmfctrl»,COMPLETE|NOCHECKº)¨                         * 08398000
*              specifies the modify form of the macro.  The "M" form  * 08447400
*              generates code to put the parameters into the          * 08496800
*              parameter list specified by xmfctrl.                   * 08546200
*                                                                     * 08595600
*            ,xmfctrl                                                 * 08645000
*              is a required input.  It is the name (RX-type), or     * 08694400
*              address in register (2)-(12), of a storage area for    * 08743800
*              the parameter list.                                    * 08793200
*                                                                     * 08842600
*            »,COMPLETE|NOCHECKº¨                                     * 08892000
*              is an optional keyword input which specifies the       * 08941400
*              degree of macro parameter syntax checking.             * 08990800
*              DEFAULT: COMPLETE                                      * 09040200
*                                                                     * 09089600
*                                                                     * 09139000
*              COMPLETE   Checking for required macro keys is done    * 09188400
*                        and defaults are supplied for optional       * 09237800
*                        parameters that were not specified (See      * 09287200
*                        Macro Usage Note 2).                         * 09336600
*                                                                     * 09386000
*              NOCHECK   Checking for required macro keys is not done * 09435400
*                        nor are defaults supplied for optional       * 09484800
*                        parameters that were not specified.          * 09534200
*                                                                     * 09583600
*                                                                     * 09633000
*          ÝMF=(E,xmfctrl»,COMPLETE|NOCHECKº)¨                        * 09682400
*              specifies the execute form of the macro.  The "E" form * 09731800
*              generates code to put the parameters into the          * 09781200
*              parameter list specified by xmfctrl and invoke the     * 09830600
*              desired service.                                       * 09880000
*                                                                     * 09929400
*            ,xmfctrl                                                 * 09978800
*              is a required input.  It is the name (RX-type), or     * 10028200
*              address in register (2)-(12), of a storage area for    * 10077600
*              the parameter list.                                    * 10127000
*                                                                     * 10176400
*            »,COMPLETE|NOCHECKº                                      * 10225800
*              is an optional keyword input which specifies the       * 10275200
*              degree of macro parameter syntax checking.             * 10324600
*              DEFAULT: COMPLETE                                      * 10374000
*                                                                     * 10423400
*                                                                     * 10472800
*              COMPLETE   Checking for required macro keys is done    * 10522200
*                        and defaults are supplied for optional       * 10571600
*                        parameters that were not specified (See      * 10621000
*                        Macro Usage Note 2).                         * 10670400
*                                                                     * 10719800
*              NOCHECK   Checking for required macro keys is not done * 10769200
*                        nor are defaults supplied for optional       * 10818600
*                        parameters that were not specified.          * 10868000
*                                                                     * 10917400
*                                                                     * 10966800
*                                                                     * 11016200
*                                                                     * 11065600
*01* RETURN CODES:                                                    * 11115000
*                                                                     * 11164400
*                                                                     * 11213800
*            0    Successful completion.                              * 11263200
*                                                                     * 11312600
*            4    Successful processing, but message queuing is       * 11362000
*                 disabled.  Or successful processing, but message    * 11411400
*                 queuing was already enabled.                        * 11460800
*                                                                     * 11510200
*            8    No messages available for specified search          * 11559600
*                 criteria.                                           * 11609000
*                                                                     * 11658400
*            12   No messages available for specified search          * 11707800
*                 criteria, and message queuing was disabled.         * 11757200
*                                                                     * 11806600
*            16   Invalid console ID.                                 * 11856000
*                                                                     * 11905400
*            20   Improper MCSOPMSG call.                             * 11954800
*                                                                     * 12004200
*            24   Internal Abend.                                     * 12053600
*                                                                     * 12103000
*                                                                     * 12152400
*01* REASON CODES:                                                    * 12201800
*                                                                     * 12251200
*       REASON    RETURN                                              * 12300600
*       CODE      CODE      DESCRIPTION                               * 12350000
*       ××××××××  ××××××××  ×××××××××××                               * 12399400
*                                                                     * 12448800
*                                                                     * 12498200
*              1  8         Queue is being fixed                      * 12547600
*                                                                     * 12597000
*              1  16        Console is not active                     * 12646400
*                                                                     * 12695800
*              2  16        Console was not activated by this address * 12745200
*                           space                                     * 12794600
*                                                                     * 12844000
*              1  20        Invalid parameter list                    * 12893400
*                                                                     * 12942800
*              2  20        Caller not in AR mode                     * 12992200
*                                                                     * 13041600
*              3  20        Another  MCSOPMSG  request is in progress * 13091000
*                           for this console.                         * 13140400
*                                                                     * 13189800
*                                                                     * 13239200
*01* MODULE TYPE:  ASSEM MACRO                                        * 13288600
*                                                                     * 13338000
*02*   PROCESSOR:  ASSEM                                              * 13387400
*                                                                     * 13436800
*01* COMPONENT:  SC1CK                                                * 13486200
*                                                                     * 13535600
*01* DISTRIBUTION LIBRARY: AMACLIB                                    * 13585000
*                                                                     * 13634400
*01* MACRO USAGE NOTES:                                               * 13683800
*                                                                     * 13733200
*                                                                     * 13782600
*    1.  Printing of the macro expansion is controlled by the ZPRINT  * 13832000
*        global macro variable.  Any value other than 'NO' will       * 13881400
*        result in the macro expansion being printed.  The default is * 13930800
*        'YES'.  The following examples illustrate how the ZPRINT     * 13980200
*        variable should be set.                                      * 14029600
*                                                                     * 14079000
*            &ZPRINT SETC 'YES'          &ZPRINT SETC 'NO'            * 14128400
*                                                                     * 14177800
*                                                                     * 14227200
*    2.  When using the NOCHECK option in conjunction with the Modify * 14276600
*        and/or  Execute  forms,  be  sure  that  it is preceded by a * 14326000
*        Modify   or  Execute  form  invocation  which  specifies  or * 14375400
*        defaults  to  the  COMPLETE  option.   This insures that the * 14424800
*        parameter list is initialized completely.                    * 14474200
*                                                                     * 14523600
*01* CHANGE ACTIVITY                                                  * 14533461
*                                                                     * 14543261
*    ADAPTED FOR VSE/ESA                                     @D61CDFG * 14553061
*                                                                     * 14562861
****** END OF SPECIFICATIONS *****************************************/ 14573000
*/********************************************************************* 14622400
         MACRO                                                          14671800
&XLABEL  MCSOPMSG &REQUEST=,&CMDRESP=,&CART=,&MASK=,&CONSID=,&RTNCODE=,*14721200
               &RSNCODE=,&MF=                                           14770600
.*                                                                      14820000
*              MACDATE -90/11/29-<1>                                    14869400
.*                                                                      14918800
.*******************************************************************    14968200
.***AB.02  GLOBAL VARIABLES TO CONTROL PRINT AND CODE GENERATION        15017600
.*******************************************************************    15067000
              GBLC  &ZPRINT     YES=PRINT NO=NO PRINT                   15116400
              GBLC  &ZTEST      YES=TEST NO=NO TEST                     15165800
              GBLC  &ZSYSTEM    PCCODE10, MVS, SAK, VM, XAX             15215200
.*                                                                      15264600
              GBLC  &ZMCSOPMSG  YES=MACRO USED AT LEAST ONCE            15314000
.*******************************************************************    15363400
.***AB.03  COMMONLY USED LOCAL MACRO VARIABLES                          15412800
.*******************************************************************    15462200
              LCLC  &ZMS        ERROR MESSAGE WORK AREA                 15511600
              LCLC  &ZCNDX      LAST THREE SYSNDX CHARACTERS            15561000
              LCLC  &ZCLNG      USED WHEN LENGTH IS NEEDED              15610400
              LCLC  &ZCGPR      USED WHEN VALUE IS IN A GPR             15659800
              LCLC  &ZCVAL      USED TO CONTAIN FIXED VALUE             15709200
              LCLA  &ZAWRK      USED AS A WORK AREA                     15758600
              LCLA  &ZASIZ      USED FOR SIZE OF VALUE                  15808000
              LCLA  &ZN         NUMERIC WORK VARIABLE                   15857400
              LCLC  &ZC         CHARACTER WORK VARIABLE                 15906800
              LCLA  &ZMACRET    MACRO RETURN CODE                       15956200
&ZMACRET      SETA  0           ASSUME NO ERRORS                        16005600
.*                                                                      16055000
              LCLC  &ZCSYSLIST(255)             NONXKEY, POS ARRAY      16104400
              LCLA  &ZASYSLNDX  WORK INDEX FOR ZCSYSLIST()              16153800
              LCLA  &ZPLLEN     PARAMETER LIST LENGTH                   16203200
.********************************************************************   16252600
.***AB.05  INVOKE MVS MACROS TO CONTROL CODE GENERATION                 16302000
.********************************************************************   16351400
              GBLC  &SYSSPLV    SP LEVEL 1,2,3 -SPLEVEL                 16400800
              GBLC  &SYSASCE    SYSTEM STATE P ANY AR-SYSSTATE          16450200
.*                                                                      16499600
              AIF   (K'&SYSASCE GT 0).ZSYS4     SYS STATE DEFINED       16549000
              AIF   (K'&SYSSPLV GT 0).ZSYS2     SP LEVEL DEFINED        16598400
              SPLEVEL  TEST                                             16647800
.ZSYS2        ANOP  ,                                                   16697200
              AIF   ('&SYSSPLV' GE '4').ZSYS3   FIRST VSE REL. @D61CDFG 16707061
              MNOTE 12,'MCSOPMSG NOT AVAILABLE ON VSE FOR SPLEVEL LESS X16716861
               THAN 4'                                         @D61CDFG 16726761
              MEXIT                                            @D61CDFG 16736661
              AIF   ('&SYSSPLV' EQ '1').ZSYS3   PRE SP 3.1              16746600
              AIF   ('&SYSSPLV' EQ '2').ZSYS3   PRE SP 3.1              16796000
              SYSSTATE TEST                                             16845400
              AGO   .ZSYS4                                              16894800
.ZSYS3        ANOP  ,                                                   16944200
&SYSASCE      SETC  'P'         ASSUME SYSSTATE PRIMARY                 16993600
.ZSYS4        ANOP  ,                                                   17043000
.*******************************************************************    17092400
.***AB.07  DEFINE ALL MACRO VARIABLES                                   17141800
.*******************************************************************    17191200
              LCLC  &XREQUEST   ++ VALUE                                17240600
              LCLC  &XCMDRESP   ++ VALUE                                17290000
              LCLC  &XCART      ++ NAME                                 17339400
              LCLC  &XMASK      ++ NAME                                 17388800
              LCLC  &XCONSID    ++ NAME                                 17438200
              LCLC  &XRTNCODE   ++ NAME                                 17487600
              LCLC  &XRSNCODE   ++ NAME                                 17537000
              LCLC  &XMF        ++ VALUE                                17586400
              LCLC  &XMFCTRL    ++ NAME                                 17635800
              LCLC  &XMFATTR    ++ VALUE                                17685200
              LCLC  &XMFSCK     ++ VALUE                                17734600
.*******************************************************************    17784000
.***AB.13  DEFINE MACRO VARIABLES FOR INPUT/OUTPUT PROCESSING           17833400
.*******************************************************************    17882800
              LCLC  &ZXREQUEST  ++ INPUT VALUE                          17932200
              LCLC  &ZXCMDRESP  ++ INPUT VALUE                          17981600
              LCLC  &ZXCART     ++ INPUT NAME                           18031000
              LCLC  &ZXMASK     ++ INPUT NAME                           18080400
              LCLC  &ZXCONSID   ++ INPUT NAME                           18129800
              LCLC  &ZXRTNCODE  ++ OUTPUT NAME                          18179200
              LCLC  &ZXRSNCODE  ++ OUTPUT NAME                          18228600
              LCLC  &ZXMF       ++ INPUT VALUE                          18278000
              LCLC  &ZXMFCTRL   ++ INPUT NAME                           18327400
              LCLC  &ZXMFATTR   ++ INPUT VALUE                          18376800
              LCLC  &ZXMFSCK    ++ INPUT VALUE                          18426200
.********************************************************************   18475600
.***AG.MF01 PROCESS MF MACRO FORMS                                      18525000
.********************************************************************   18574400
              ACTR  10000                                               18623800
.*------------------------------------------------------------------    18673200
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           18722600
&XMF          SETC  ''          INITIALIZE XVARIABLE                    18772000
.*-------------------------------------------------------------------   18821400
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           18870800
.ZG28         ANOP  ,                                                   18920200
              AIF   ('&MF(1)' NE 'S').ZG29                              18969600
&XMF          SETC  'S'         SET KEYWORD                             19019000
&XMFSCK       SETC  'COMPLETE'  SET XMFSCK                              19068400
              AIF   (N'&MF LE 1).ZG28A          CK NUM                  19117800
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           19167200
&ZMS          SETC  '&ZMS.&MF"'                                         19216600
&ZMS          SETC  '&ZMS "MF"'                                         19266000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 19315400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             19364800
.ZG28A        ANOP  ,                                                   19414200
.*-------------------------------------------------------------------   19463600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           19513000
.ZG29         ANOP  ,                                                   19562400
              AIF   ('&MF(1)' NE 'L').ZG36                              19611800
&XMF          SETC  'L'         SET KEYWORD                             19661200
              AIF   (N'&MF LE 3).ZG29A          CK NUM                  19710600
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           19760000
&ZMS          SETC  '&ZMS.&MF"'                                         19809400
&ZMS          SETC  '&ZMS "MF"'                                         19858800
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                19908200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             19957600
.ZG29A        ANOP  ,                                                   20007000
.*-------------------------------------------------------------------   20056400
.***AG.KKCTL08 -MF(L) SPECIAL CHECK                                     20105800
              AIF   (N'&SYSLIST NE 0).ZG29B     POSITIONALS?            20155200
              AIF   ('&REQUEST' NE '').ZG29B    KEYS?                   20204600
              AIF   ('&CMDRESP' NE '').ZG29B    KEYS?                   20254000
              AIF   ('&CART' NE '').ZG29B       KEYS?                   20303400
              AIF   ('&MASK' NE '').ZG29B       KEYS?                   20352800
              AIF   ('&CONSID' NE '').ZG29B     KEYS?                   20402200
              AIF   ('&RTNCODE' NE '').ZG29B    KEYS?                   20451600
              AIF   ('&RSNCODE' NE '').ZG29B    KEYS?                   20501000
              AGO    .ZG29C     INVOCATION OKAY                         20550400
.ZG29B        ANOP  ,                                                   20599800
&ZMS          SETC  'THE "L" FORM OF "MF" CANNOT'  *MFLA* MNOTE         20649200
&ZMS          SETC  '&ZMS HAVE ANY OTHER KEYWORDS OR'                   20698600
&ZMS          SETC  '&ZMS POSITIONAL PARAMETERS SPECIFIED'              20748000
              MNOTE 8,' &ZMS ON THE INVOCATION.'                        20797400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             20846800
.ZG29C        ANOP  ,                                                   20896200
.*-------------------------------------------------------------------   20945600
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   20995000
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           21044400
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           21093800
              AIF   (N'&MF(2) GT 1).ZG31B       MULTI PARMS             21143200
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           21192600
.ZG31B        AIF   (K'&MF(2) GT 0).ZG31C                               21242000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         21291400
&ZMS          SETC  'WHEN "L" IS SPECIFIED'     *KRQDA*                 21340800
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 21390200
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        21439600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             21489000
.ZG31C        ANOP  ,                                                   21538400
.*-------------------------------------------------------------------   21587800
.***AG.KCK01 NAME, OPT RQD INPUT, POS(2) -GPR NOT ALLOWED               21637200
              AIF   (K'&ZXMFCTRL LE 0).ZG31P    NOT I/O                 21686600
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG31P                      21736000
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         21785400
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           21834800
&ZMS          SETC  '&ZMS.&MF"'                                         21884200
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           21933600
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 2.'                   21983000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             22032400
.ZG31P        ANOP  ,                                                   22081800
.*-------------------------------------------------------------------   22131200
.***AG.KXVAR13 VALUE, OPT INPUT, POS(3) -XVARIABLE                      22180600
&ZXMFATTR     SETC  'INPUT'     SET IN/OUTPUT                           22230000
&XMFATTR      SETC  '0D'        SET DEFAULT                             22279400
              AIF   (K'&MF(3) LE 0).ZG34B       PARM                    22328800
&XMFATTR      SETC  '&MF(3,1)'  SET XVARIABLE                           22378200
              AIF   (N'&MF(3) GT 1).ZG34B       MULTI PARMS             22427600
&XMFATTR      SETC  '&MF(3)'    SET XVARIABLE                           22477000
.ZG34B        ANOP  ,                                                   22526400
.*-------------------------------------------------------------------   22575800
.***AG.KCK01 VALUE, OPT INPUT, POS(3) -GPR NOT ALLOWED                  22625200
              AIF   (K'&ZXMFATTR LE 0).ZG34P    NOT I/O                 22674600
              AIF   ('&XMFATTR'(1,1) NE '(').ZG34P                      22724000
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         22773400
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           22822800
&ZMS          SETC  '&ZMS.&MF"'                                         22872200
&ZMS          SETC  '&ZMS CONTAINS GPR NOTATION WHICH IS NOT'           22921600
              MNOTE 8,' &ZMS ALLOWED FOR ARGUMENT 3.'                   22971000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23020400
.ZG34P        ANOP  ,                                                   23069800
.*-------------------------------------------------------------------   23119200
.***AG.KCK03 VALUE, OPT INPUT, POS(3) -CHARACTER LENGTH                 23168600
              AIF   (K'&ZXMFATTR LE 0).ZG34S    NOT I/O                 23218000
              AIF   (K'&XMFATTR LE 60).ZG34S    LNG OK                  23267400
&ZXMFATTR     SETC  ''          RESET IN/OUTPUT                         23316800
&ZMS          SETC  '"MF='      *KLNGA* MNOTE                           23366200
&ZMS          SETC  '&ZMS.&MF"'                                         23415600
&ZMS          SETC  '&ZMS ARGUMENT 3 EXCEEDS THE MAXIMUM'               23465000
              MNOTE 8,' &ZMS LENGTH OF 60 CHARACTERS.'                  23514400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             23563800
.ZG34S        ANOP  ,                                                   23613200
.*-------------------------------------------------------------------   23662600
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           23712000
.ZG36         ANOP  ,                                                   23761400
              AIF   ('&MF(1)' NE 'M').ZG45                              23810800
&XMF          SETC  'M'         SET KEYWORD                             23860200
              AIF   (N'&MF LE 3).ZG36A          CK NUM                  23909600
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           23959000
&ZMS          SETC  '&ZMS.&MF"'                                         24008400
&ZMS          SETC  '&ZMS "MF"'                                         24057800
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                24107200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24156600
.ZG36A        ANOP  ,                                                   24206000
.*-------------------------------------------------------------------   24255400
.***AG.KKCTL09 -MF(M) OUTPUT KEYS SPECIFIED?                            24304800
              AIF   ('&RTNCODE' NE '').ZG36B    OUTPUT SPECIFIED?       24354200
              AGO    .ZG36C     INVOCATION OKAY                         24403600
.ZG36B        ANOP  ,                                                   24453000
&ZMS          SETC  'THE "M" FORM OF "MF" CANNOT'  *MFMOA* MNOTE        24502400
&ZMS          SETC  '&ZMS HAVE THE FOLLOWING OUTPUT KEY(S)'             24551800
&ZMS          SETC  '&ZMS SPECIFIED ON THE INVOCATION:'                 24601200
              MNOTE 8,' &ZMS "RTNCODE".'        INVALID KEY             24650600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             24700000
.ZG36C        ANOP  ,                                                   24749400
.*-------------------------------------------------------------------   24798800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   24848200
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           24897600
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           24947000
              AIF   (N'&MF(2) GT 1).ZG38B       MULTI PARMS             24996400
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           25045800
.ZG38B        AIF   (K'&MF(2) GT 0).ZG38C                               25095200
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         25144600
&ZMS          SETC  'WHEN "M" IS SPECIFIED'     *KRQDA*                 25194000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 25243400
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        25292800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             25342200
.ZG38C        ANOP  ,                                                   25391600
.*-------------------------------------------------------------------   25441000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              25490400
              AIF   (K'&ZXMFCTRL LE 0).ZG38R    NOT I/O                 25539800
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG38R                      25589200
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          25638600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG38P                        25688000
              AIF   (K'&ZCGPR GT 2).ZG38Q                               25737400
              AIF   ('&ZCGPR' EQ '0').ZG38Q                             25786800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       25836200
              AIF   (T'&ZCGPR NE 'N').ZG38Q     INVALID REG NAME        25885600
.ZG38P        ANOP  ,                                                   25935000
              AIF   (T'&ZCGPR NE 'N').ZG38R     NON NUMERIC             25984400
              AIF   ('&ZCGPR' LT '2').ZG38Q                             26033800
              AIF   ('&ZCGPR' LE '12').ZG38R                            26083200
.ZG38Q        ANOP  ,                                                   26132600
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           26182000
&ZMS          SETC  '&ZMS.&MF"'                                         26231400
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           26280800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    26330200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             26379600
.ZG38R        ANOP  ,                                                   26429000
.*-------------------------------------------------------------------   26478400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             26527800
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    26577200
.ZG42A   AIF   ('&MF(3)' NE 'COMPLETE').ZG43A                           26626600
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             26676000
.*-------------------------------------------------------------------   26725400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             26774800
.ZG43A   AIF   ('&MF(3)' NE 'NOCHECK').ZG44A                            26824200
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             26873600
.*-------------------------------------------------------------------   26923000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             26972400
.ZG44A        AIF   (K'&XMFSCK GT 0).ZG44C      KEYWORD                 27021800
              AIF   (K'&MF(3) LE 0).ZG44B                               27071200
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           27120600
&ZMS          SETC  '&ZMS.&MF"'                                         27170000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           27219400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 27268800
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           27318200
              MNOTE 8,' &ZMS OR "NOCHECK".'                             27367600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             27417000
.ZG44B        ANOP  ,                                                   27466400
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     27515800
.ZG44C        ANOP  ,                                                   27565200
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           27614600
.*-------------------------------------------------------------------   27664000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           27713400
.ZG45         ANOP  ,                                                   27762800
              AIF   ('&MF(1)' NE 'E').ZG54                              27812200
&XMF          SETC  'E'         SET KEYWORD                             27861600
              AIF   (N'&MF LE 3).ZG45A          CK NUM                  27911000
&ZMS          SETC  '"MF='      *KPOSA* MNOTE                           27960400
&ZMS          SETC  '&ZMS.&MF"'                                         28009800
&ZMS          SETC  '&ZMS "MF"'                                         28059200
              MNOTE 8,' &ZMS CAN HAVE ONLY 3 ARGUMENTS.'                28108600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28158000
.ZG45A        ANOP  ,                                                   28207400
.*-------------------------------------------------------------------   28256800
.***AG.KXVAR06 NAME, OPT RQD INPUT, POS(2) -XVARIABLE                   28306200
&ZXMFCTRL     SETC  'INPUT'     SET IN/OUTPUT                           28355600
&XMFCTRL      SETC  '&MF(2,1)'  SET XVARIABLE                           28405000
              AIF   (N'&MF(2) GT 1).ZG47B       MULTI PARMS             28454400
&XMFCTRL      SETC  '&MF(2)'    SET XVARIABLE                           28503800
.ZG47B        AIF   (K'&MF(2) GT 0).ZG47C                               28553200
&ZXMFCTRL     SETC  ''          RESET IN/OUTPUT                         28602600
&ZMS          SETC  'WHEN "E" IS SPECIFIED'     *KRQDA*                 28652000
&ZMS          SETC  '&ZMS FOR THE "MF" KEY, POSITIONAL'                 28701400
              MNOTE 8,' &ZMS ARG 2 IS REQUIRED.'                        28750800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             28800200
.ZG47C        ANOP  ,                                                   28849600
.*-------------------------------------------------------------------   28899000
.***AG.KCK02 NAME, OPT RQD INPUT, POS(2) -GPR OUT OF RANGE              28948400
              AIF   (K'&ZXMFCTRL LE 0).ZG47R    NOT I/O                 28997800
              AIF   ('&XMFCTRL'(1,1) NE '(').ZG47R                      29047200
&ZCGPR        SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)                          29096600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG47P                        29146000
              AIF   (K'&ZCGPR GT 2).ZG47Q                               29195400
              AIF   ('&ZCGPR' EQ '0').ZG47Q                             29244800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       29294200
              AIF   (T'&ZCGPR NE 'N').ZG47Q     INVALID REG NAME        29343600
.ZG47P        ANOP  ,                                                   29393000
              AIF   (T'&ZCGPR NE 'N').ZG47R     NON NUMERIC             29442400
              AIF   ('&ZCGPR' LT '2').ZG47Q                             29491800
              AIF   ('&ZCGPR' LE '12').ZG47R                            29541200
.ZG47Q        ANOP  ,                                                   29590600
&ZMS          SETC  '"MF='      *KGPRA* MNOTE                           29640000
&ZMS          SETC  '&ZMS.&MF"'                                         29689400
&ZMS          SETC  '&ZMS ARGUMENT 2 MUST SPECIFY A REGISTER'           29738800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    29788200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             29837600
.ZG47R        ANOP  ,                                                   29887000
.*-------------------------------------------------------------------   29936400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             29985800
&XMFSCK       SETC  ''          INITIALIZE XVARIABLE                    30035200
.ZG51A   AIF   ('&MF(3)' NE 'COMPLETE').ZG52A                           30084600
&XMFSCK       SETC  'COMPLETE'  SET KEYWORD                             30134000
.*-------------------------------------------------------------------   30183400
.***AG.KKWRD02 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             30232800
.ZG52A   AIF   ('&MF(3)' NE 'NOCHECK').ZG53A                            30282200
&XMFSCK       SETC  'NOCHECK'   SET KEYWORD                             30331600
.*-------------------------------------------------------------------   30381000
.***AG.KKWRD03 VALUE, OPT INPUT, ME KEYWORD -SINGLE KEYWORD             30430400
.ZG53A        AIF   (K'&XMFSCK GT 0).ZG53C      KEYWORD                 30479800
              AIF   (K'&MF(3) LE 0).ZG53B                               30529200
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           30578600
&ZMS          SETC  '&ZMS.&MF"'                                         30628000
&ZMS          SETC  '&ZMS ARGUMENT 3 IS AN UNKNOWN KEYWORD. '           30677400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 30726800
&ZMS          SETC  '&ZMS "COMPLETE"'           VALID KEYWORD           30776200
              MNOTE 8,' &ZMS OR "NOCHECK".'                             30825600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             30875000
.ZG53B        ANOP  ,                                                   30924400
&XMFSCK       SETC  'COMPLETE'  SET DEFAULT KEYWORD                     30973800
.ZG53C        ANOP  ,                                                   31023200
&ZXMFSCK      SETC  'INPUT'     SET IN/OUTPUT                           31072600
.*------------------------------------------------------------------    31122000
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           31171400
.ZG54         ANOP  ,                                                   31220800
&ZXMF         SETC  'INPUT'     SET IN/OUTPUT                           31270200
              AIF   (K'&XMF GT 0).ZG54E         VALID ARG               31319600
              AIF   (T'&MF EQ 'O').ZG54D        OMITTED                 31369000
&ZASYSLNDX    SETA  0                                                   31418400
.ZG54A        ANOP  ,           POSITIONAL MACRO KEY                    31467800
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        31517200
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG54C                    31566600
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'MF').ZG54A              31616000
.ZG54B        ANOP  ,                                                   31665400
&ZXMF         SETC  ''          RESET IN/OUTPUT                         31714800
&ZMS          SETC  'THE "MF" KEY'              *KOPTA* MNOTE           31764200
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             31813600
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    31863000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             31912400
              AGO   .ZG54E                                              31961800
.ZG54C        ANOP  ,                                                   32011200
&ZXMF         SETC  ''          RESET IN/OUTPUT                         32060600
&ZMS          SETC  '"MF='      *KUKWA* MNOTE                           32110000
&ZMS          SETC  '&ZMS.&MF"'                                         32159400
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           32208800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 32258200
&ZMS          SETC  '&ZMS "S",'                 VALID KEYWORD           32307600
&ZMS          SETC  '&ZMS "L",'                 VALID KEYWORD           32357000
&ZMS          SETC  '&ZMS "M",'                 VALID KEYWORD           32406400
              MNOTE 8,' &ZMS OR "E".'                                   32455800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             32505200
              AGO   .ZG54E                                              32554600
.ZG54D        ANOP  ,                                                   32604000
&XMF          SETC  'S'         SET DEFAULT KEYWORD                     32653400
&XMFSCK       SETC  'COMPLETE'  COMPLETE CHECKING                       32702800
.ZG54E        ANOP  ,                                                   32752200
.********************************************************************   32801600
.***AG.MF02  FULL MACRO SYNTAX CHECKING                                 32851000
.********************************************************************   32900400
              ACTR  10000                                               32949800
.*-------------------------------------------------------------------   32999200
.***AG.MF03 MF=(SLME)                                                   33048600
              AIF   ('&XMF' EQ 'L').ZGMFX                               33098000
              AIF   ('&XMFSCK' NE 'COMPLETE').ZGMFX                     33147400
.*------------------------------------------------------------------    33196800
.***AG.KKCTL01 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           33246200
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    33295600
.*-------------------------------------------------------------------   33345000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           33394400
.ZG3          ANOP  ,                                                   33443800
              AIF   (K'&REQUEST(1) LE 0).ZG3A                           33493200
              AIF   ('&REQUEST(1)' NE 'RESUME').ZG4                     33542600
&XREQUEST     SETC  'RESUME'    SET KEYWORD                             33592000
              AIF   (N'&REQUEST LE 1).ZG3A      CK NUM                  33641400
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           33690800
&ZMS          SETC  '&ZMS.&REQUEST"'                                    33740200
&ZMS          SETC  '&ZMS "REQUEST"'                                    33789600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 33839000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             33888400
.ZG3A         ANOP  ,                                                   33937800
.*------------------------------------------------------------------    33987200
.***AG.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           34036600
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             34086000
.ZG3A0        AIF   (K'&CMDRESP LE 0).ZG3A1     OK                      34135400
&ZCVAL        SETC '&ZCVAL CMDRESP'             INCORRECT KEY USED      34184800
.ZG3A1        AIF   (K'&CART LE 0).ZG3A2        OK                      34234200
&ZCVAL        SETC '&ZCVAL CART'                INCORRECT KEY USED      34283600
.ZG3A2        AIF   (K'&MASK LE 0).ZG3A3        OK                      34333000
&ZCVAL        SETC '&ZCVAL MASK'                INCORRECT KEY USED      34382400
.ZG3A3        AIF   (K'&ZCVAL LE 0).ZG3A4       OK                      34431800
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               34481200
&ZMS          SETC  '"REQUEST'  *KMEIA* MNOTE                           34530600
&ZMS          SETC  '&ZMS.=&REQUEST"'                                   34580000
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                34629400
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                34678800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             34728200
.ZG3A4        ANOP  ,                                                   34777600
.*-------------------------------------------------------------------   34827000
.***AG.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           34876400
.ZG4          ANOP  ,                                                   34925800
              AIF   ('&REQUEST(1)' NE 'GETMSG').ZG16                    34975200
&XREQUEST     SETC  'GETMSG'    SET KEYWORD                             35024600
              AIF   (N'&REQUEST LE 1).ZG4A      CK NUM                  35074000
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           35123400
&ZMS          SETC  '&ZMS.&REQUEST"'                                    35172800
&ZMS          SETC  '&ZMS "REQUEST"'                                    35222200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 35271600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             35321000
.ZG4A         ANOP  ,                                                   35370400
.*------------------------------------------------------------------    35419800
.***AG.KKCTL01 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           35469200
&XCMDRESP     SETC  ''          INITIALIZE XVARIABLE                    35518600
.*-------------------------------------------------------------------   35568000
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           35617400
.ZG7          ANOP  ,                                                   35666800
              AIF   (K'&CMDRESP(1) LE 0).ZG7A                           35716200
              AIF   ('&CMDRESP(1)' NE 'NO').ZG8                         35765600
&XCMDRESP     SETC  'NO'        SET KEYWORD                             35815000
              AIF   (N'&CMDRESP LE 1).ZG7A      CK NUM                  35864400
&ZMS          SETC  '"CMDRESP='                 *KPOSA* MNOTE           35913800
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    35963200
&ZMS          SETC  '&ZMS "CMDRESP"'                                    36012600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 36062000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36111400
.ZG7A         ANOP  ,                                                   36160800
.*------------------------------------------------------------------    36210200
.***AG.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           36259600
&ZCVAL        SETC ''           CLEAR ERROR KEY ACCUMULATOR             36309000
.ZG7A0        AIF   (K'&CART LE 0).ZG7A1        OK                      36358400
&ZCVAL        SETC '&ZCVAL CART'                INCORRECT KEY USED      36407800
.ZG7A1        AIF   (K'&MASK LE 0).ZG7A2        OK                      36457200
&ZCVAL        SETC '&ZCVAL MASK'                INCORRECT KEY USED      36506600
.ZG7A2        AIF   (K'&ZCVAL LE 0).ZG7A3       OK                      36556000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)                               36605400
&ZMS          SETC  '"CMDRESP'  *KMEIA* MNOTE                           36654800
&ZMS          SETC  '&ZMS.=&CMDRESP"'                                   36704200
&ZMS          SETC  '&ZMS DOES NOT ALLOW THE USE OF THE'                36753600
              MNOTE 8,' &ZMS FOLLOWING KEY(S) "&ZCVAL".'                36803000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             36852400
.ZG7A3        ANOP  ,                                                   36901800
.*-------------------------------------------------------------------   36951200
.***AG.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           37000600
.ZG8          ANOP  ,                                                   37050000
              AIF   ('&CMDRESP(1)' NE 'YES').ZG15                       37099400
&XCMDRESP     SETC  'YES'       SET KEYWORD                             37148800
              AIF   (N'&CMDRESP LE 1).ZG8A      CK NUM                  37198200
&ZMS          SETC  '"CMDRESP='                 *KPOSA* MNOTE           37247600
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    37297000
&ZMS          SETC  '&ZMS "CMDRESP"'                                    37346400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 37395800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37445200
.ZG8A         ANOP  ,                                                   37494600
.*----------------------------------------------------------------***   37544000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     37593400
              AIF   (N'&CART LE 1).ZG10A        CK NUM                  37642800
&ZMS          SETC  '"CART='    *KPOSA* MNOTE                           37692200
&ZMS          SETC  '&ZMS.&CART"'                                       37741600
&ZMS          SETC  '&ZMS "CART"'                                       37791000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 37840400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             37889800
.ZG10A        ANOP  ,                                                   37939200
.*-------------------------------------------------------------------   37988600
.***AG.KXVAR13 NAME, OPT INPUT, KEYS -XVARIABLE                         38038000
&ZXCART       SETC  'INPUT'     SET IN/OUTPUT                           38087400
&XCART        SETC  'NULL'      SET DEFAULT                             38136800
              AIF   (K'&CART(1) LE 0).ZG10B     PARM                    38186200
&XCART        SETC  '&CART(1)'  SET XVARIABLE                           38235600
              AIF   (N'&CART GT 1).ZG10B        MULTI PARMS             38285000
&XCART        SETC  '&CART'     SET XVARIABLE                           38334400
.ZG10B        ANOP  ,                                                   38383800
.*-------------------------------------------------------------------   38433200
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    38482600
              AIF   (K'&ZXCART LE 0).ZG10R      NOT I/O                 38532000
              AIF   ('&XCART' EQ 'NULL').ZG10R                          38581400
              AIF   ('&XCART'(1,1) NE '(').ZG10R                        38630800
&ZCGPR        SETC  '&XCART'(2,K'&XCART-2)                              38680200
              AIF   ('&ZCGPR'(1,1) NE '0').ZG10P                        38729600
              AIF   (K'&ZCGPR GT 2).ZG10Q                               38779000
              AIF   ('&ZCGPR' EQ '0').ZG10Q                             38828400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       38877800
              AIF   (T'&ZCGPR NE 'N').ZG10Q     INVALID REG NAME        38927200
.ZG10P        ANOP  ,                                                   38976600
              AIF   (T'&ZCGPR NE 'N').ZG10R     NON NUMERIC             39026000
              AIF   ('&ZCGPR' LT '2').ZG10Q                             39075400
              AIF   ('&ZCGPR' LE '12').ZG10R                            39124800
.ZG10Q        ANOP  ,                                                   39174200
&ZMS          SETC  '"CART='    *KGPRA* MNOTE                           39223600
&ZMS          SETC  '&ZMS.&CART"'                                       39273000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           39322400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    39371800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39421200
.ZG10R        ANOP  ,                                                   39470600
.*----------------------------------------------------------------***   39520000
.***AG.KXVAR05 NAME, OPT INPUT, KEYS -XVARIABLE KEY                     39569400
              AIF   (N'&MASK LE 1).ZG12A        CK NUM                  39618800
&ZMS          SETC  '"MASK='    *KPOSA* MNOTE                           39668200
&ZMS          SETC  '&ZMS.&MASK"'                                       39717600
&ZMS          SETC  '&ZMS "MASK"'                                       39767000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 39816400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             39865800
.ZG12A        ANOP  ,                                                   39915200
.*-------------------------------------------------------------------   39964600
.***AG.KXVAR17 NAME, OPT INPUT, KEYS -XVARIABLE                         40014000
&XMASK        SETC  'NULL'      SET DEFAULT                             40063400
              AIF   (K'&MASK(1) LE 0).ZG12C     PARM                    40112800
&XMASK        SETC  '&MASK(1)'  SET XVARIABLE                           40162200
              AIF   (N'&MASK GT 1).ZG12B        MULTI PARMS             40211600
&XMASK        SETC  '&MASK'     SET XVARIABLE                           40261000
.ZG12B        AIF   (K'&CART(1) GT 0).ZG12C     KEY                     40310400
&ZMS          SETC  '"MASK'     *KDEPA* MNOTE                           40359800
&ZMS          SETC  '&ZMS.=&MASK"'                                      40409200
&ZMS          SETC  '&ZMS CAN ONLY BE SPECIFIED IF'                     40458600
&ZMS          SETC  '&ZMS '                                             40508000
&ZMS          SETC  '&ZMS "CART"'                                       40557400
              MNOTE 8,' &ZMS IS ALSO SPECIFIED.'                        40606800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             40656200
.ZG12C        ANOP  ,                                                   40705600
&ZXMASK       SETC  'INPUT'     SET IN/OUTPUT                           40755000
.*-------------------------------------------------------------------   40804400
.***AG.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    40853800
              AIF   (K'&ZXMASK LE 0).ZG12R      NOT I/O                 40903200
              AIF   ('&XMASK' EQ 'NULL').ZG12R                          40952600
              AIF   ('&XMASK'(1,1) NE '(').ZG12R                        41002000
&ZCGPR        SETC  '&XMASK'(2,K'&XMASK-2)                              41051400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG12P                        41100800
              AIF   (K'&ZCGPR GT 2).ZG12Q                               41150200
              AIF   ('&ZCGPR' EQ '0').ZG12Q                             41199600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       41249000
              AIF   (T'&ZCGPR NE 'N').ZG12Q     INVALID REG NAME        41298400
.ZG12P        ANOP  ,                                                   41347800
              AIF   (T'&ZCGPR NE 'N').ZG12R     NON NUMERIC             41397200
              AIF   ('&ZCGPR' LT '2').ZG12Q                             41446600
              AIF   ('&ZCGPR' LE '12').ZG12R                            41496000
.ZG12Q        ANOP  ,                                                   41545400
&ZMS          SETC  '"MASK='    *KGPRA* MNOTE                           41594800
&ZMS          SETC  '&ZMS.&MASK"'                                       41644200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           41693600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    41743000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             41792400
.ZG12R        ANOP  ,                                                   41841800
.*------------------------------------------------------------------    41891200
.***AG.KKCTL04 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           41940600
.ZG15         ANOP  ,                                                   41990000
&ZXCMDRESP    SETC  'INPUT'     SET IN/OUTPUT                           42039400
              AIF   (K'&XCMDRESP GT 0).ZG15E    VALID ARG               42088800
              AIF   (T'&CMDRESP EQ 'O').ZG15D   OMITTED                 42138200
&ZASYSLNDX    SETA  0                                                   42187600
.ZG15A        ANOP  ,           POSITIONAL MACRO KEY                    42237000
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        42286400
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG15C                    42335800
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'CMDRESP').ZG15A         42385200
.ZG15B        ANOP  ,                                                   42434600
&ZXCMDRESP    SETC  ''          RESET IN/OUTPUT                         42484000
&ZMS          SETC  'THE "CMDRESP" KEY'         *KOPTA* MNOTE           42533400
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             42582800
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    42632200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             42681600
              AGO   .ZG15E                                              42731000
.ZG15C        ANOP  ,                                                   42780400
&ZXCMDRESP    SETC  ''          RESET IN/OUTPUT                         42829800
&ZMS          SETC  '"CMDRESP='                 *KUKWA* MNOTE           42879200
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    42928600
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           42978000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 43027400
&ZMS          SETC  '&ZMS "NO"'                 VALID KEYWORD           43076800
              MNOTE 8,' &ZMS OR "YES".'                                 43126200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             43175600
              AGO   .ZG15E                                              43225000
.ZG15D        ANOP  ,                                                   43274400
&XCMDRESP     SETC  'NO'        SET DEFAULT KEYWORD                     43323800
.ZG15E        ANOP  ,                                                   43373200
.*------------------------------------------------------------------    43422600
.***AG.KKCTL04 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           43472000
.ZG16         ANOP  ,                                                   43521400
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           43570800
              AIF   (K'&XREQUEST GT 0).ZG16E    VALID ARG               43620200
              AIF   (T'&REQUEST EQ 'O').ZG16D   OMITTED                 43669600
&ZASYSLNDX    SETA  0                                                   43719000
.ZG16A        ANOP  ,           POSITIONAL MACRO KEY                    43768400
&ZASYSLNDX    SETA  &ZASYSLNDX+1                                        43817800
              AIF   (&ZASYSLNDX GT N'&SYSLIST).ZG16C                    43867200
              AIF   ('&SYSLIST(&ZASYSLNDX)' NE 'REQUEST').ZG16A         43916600
.ZG16B        ANOP  ,                                                   43966000
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         44015400
&ZMS          SETC  'THE "REQUEST" KEY'         *KOPTA* MNOTE           44064800
&ZMS          SETC  '&ZMS MUST CONTAIN ONE'                             44114200
              MNOTE 8,' &ZMS (OR MORE) ARGUMENT(S).'                    44163600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44213000
              AGO   .ZG16E                                              44262400
.ZG16C        ANOP  ,                                                   44311800
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         44361200
&ZMS          SETC  '"REQUEST='                 *KUKWA* MNOTE           44410600
&ZMS          SETC  '&ZMS.&REQUEST"'                                    44460000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           44509400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 44558800
&ZMS          SETC  '&ZMS "RESUME"'             VALID KEYWORD           44608200
              MNOTE 8,' &ZMS OR "GETMSG".'                              44657600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             44707000
              AGO   .ZG16E                                              44756400
.ZG16D        ANOP  ,                                                   44805800
&XREQUEST     SETC  'RESUME'    SET DEFAULT KEYWORD                     44855200
.ZG16E        ANOP  ,                                                   44904600
.*------------------------------------------------------------------    44954000
.***AG.KKCTL05 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           45003400
              AIF   (K'&REQUEST(1) GT 0).ZG16F  PARM                    45052800
&XREQUEST     SETC  ''          ENSURE NULL KEYWORD                     45102200
&ZXREQUEST    SETC  ''          RESET IN/OUTPUT                         45151600
&ZMS          SETC  'THE'       *KRKWA* MNOTE                           45201000
&ZMS          SETC  '&ZMS "REQUEST" KEY AND ITS ARGUMENT ARE'           45250400
&ZMS          SETC  '&ZMS REQUIRED.'                                    45299800
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 45349200
&ZMS          SETC  '&ZMS "RESUME"'             VALID KEYWORD           45398600
              MNOTE 8,' &ZMS OR "GETMSG".'                              45448000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             45497400
.ZG16F        ANOP  ,                                                   45546800
.*----------------------------------------------------------------***   45596200
.***AG.KXVAR05 NAME, RQD INPUT, KEYS -XVARIABLE KEY                     45645600
              AIF   (N'&CONSID LE 1).ZG18A      CK NUM                  45695000
&ZMS          SETC  '"CONSID='  *KPOSA* MNOTE                           45744400
&ZMS          SETC  '&ZMS.&CONSID"'                                     45793800
&ZMS          SETC  '&ZMS "CONSID"'                                     45843200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 45892600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             45942000
.ZG18A        ANOP  ,                                                   45991400
.*-------------------------------------------------------------------   46040800
.***AG.KXVAR06 NAME, RQD INPUT, KEYS -XVARIABLE                         46090200
&ZXCONSID     SETC  'INPUT'     SET IN/OUTPUT                           46139600
&XCONSID      SETC  '&CONSID(1)'                SET XVARIABLE           46189000
              AIF   (N'&CONSID GT 1).ZG18B      MULTI PARMS             46238400
&XCONSID      SETC  '&CONSID'   SET XVARIABLE                           46287800
.ZG18B        AIF   (K'&CONSID(1) GT 0).ZG18C                           46337200
&ZXCONSID     SETC  ''          RESET IN/OUTPUT                         46386600
&ZMS          SETC  ' '         *KRQDA*                                 46436000
&ZMS          SETC  '&ZMS "CONSID" KEY AND ITS ARGUMENT'                46485400
              MNOTE 8,' &ZMS ARE REQUIRED.'                             46534800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             46584200
.ZG18C        ANOP  ,                                                   46633600
.*-------------------------------------------------------------------   46683000
.***AG.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    46732400
              AIF   (K'&ZXCONSID LE 0).ZG18R    NOT I/O                 46781800
              AIF   ('&XCONSID'(1,1) NE '(').ZG18R                      46831200
&ZCGPR        SETC  '&XCONSID'(2,K'&XCONSID-2)                          46880600
              AIF   ('&ZCGPR'(1,1) NE '0').ZG18P                        46930000
              AIF   (K'&ZCGPR GT 2).ZG18Q                               46979400
              AIF   ('&ZCGPR' EQ '0').ZG18Q                             47028800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       47078200
              AIF   (T'&ZCGPR NE 'N').ZG18Q     INVALID REG NAME        47127600
.ZG18P        ANOP  ,                                                   47177000
              AIF   (T'&ZCGPR NE 'N').ZG18R     NON NUMERIC             47226400
              AIF   ('&ZCGPR' LT '2').ZG18Q                             47275800
              AIF   ('&ZCGPR' LE '12').ZG18R                            47325200
.ZG18Q        ANOP  ,                                                   47374600
&ZMS          SETC  '"CONSID='  *KGPRA* MNOTE                           47424000
&ZMS          SETC  '&ZMS.&CONSID"'                                     47473400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           47522800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    47572200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             47621600
.ZG18R        ANOP  ,                                                   47671000
.*-------------------------------------------------------------------   47720400
.***AG.KMOUT01 BYPASS CHECK ON OUTPUT KEY PROCESSING -START             47769800
              AIF   ('&XMF' EQ 'M').ZG22        BYPASS IF MF=M          47819200
.*----------------------------------------------------------------***   47868600
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    47918000
              AIF   (N'&RTNCODE LE 1).ZG21A     CK NUM                  47967400
&ZMS          SETC  '"RTNCODE='                 *KPOSA* MNOTE           48016800
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    48066200
&ZMS          SETC  '&ZMS "RTNCODE"'                                    48115600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 48165000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             48214400
.ZG21A        ANOP  ,                                                   48263800
.*-------------------------------------------------------------------   48313200
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        48362600
              AIF   (K'&RTNCODE(1) LE 0).ZG21C  NO PARM                 48412000
&ZXRTNCODE    SETC  'OUTPUT'    SET OUTPUT                              48461400
&XRTNCODE     SETC  '&RTNCODE(1)'               SET XVARIABLE           48510800
              AIF   (N'&RTNCODE GT 1).ZG21C     MULTIPLE PARMS          48560200
&XRTNCODE     SETC  '&RTNCODE'  SET XVARIABLE                           48609600
.ZG21C        ANOP  ,                                                   48659000
.*-------------------------------------------------------------------   48708400
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   48757800
              AIF   (K'&ZXRTNCODE LE 0).ZG21R   NOT I/O                 48807200
              AIF   ('&XRTNCODE'(1,1) NE '(').ZG21R                     48856600
&ZCGPR        SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                        48906000
              AIF   ('&ZCGPR'(1,1) NE '0').ZG21P                        48955400
              AIF   (K'&ZCGPR GT 2).ZG21Q                               49004800
              AIF   ('&ZCGPR' EQ '0').ZG21Q                             49054200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       49103600
              AIF   (T'&ZCGPR NE 'N').ZG21Q     INVALID REG NAME        49153000
.ZG21P        ANOP  ,                                                   49202400
              AIF   (T'&ZCGPR NE 'N').ZG21R     NON NUMERIC             49251800
              AIF   ('&ZCGPR' LT '2').ZG21Q                             49301200
              AIF   ('&ZCGPR' LE '12').ZG21R                            49350600
.ZG21Q        ANOP  ,                                                   49400000
&ZMS          SETC  '"RTNCODE='                 *KGPRA* MNOTE           49449400
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    49498800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           49548200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    49597600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             49647000
.ZG21R        ANOP  ,                                                   49696400
.*-------------------------------------------------------------------   49745800
.***AG.KMOUT02 BYPASS CHECK ON OUTPUT KEY PROCESSING -END               49795200
.ZG22         ANOP  ,           END OF BYPASS CHECK                     49844600
.*----------------------------------------------------------------***   49894000
.***AG.KXVAR05 NAME, OPT OUTPUT, KEYS -XVARIABLE KEY                    49943400
              AIF   (N'&RSNCODE LE 1).ZG24A     CK NUM                  49992800
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           50042200
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    50091600
&ZMS          SETC  '&ZMS "RSNCODE"'                                    50141000
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 50190400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             50239800
.ZG24A        ANOP  ,                                                   50289200
.*-------------------------------------------------------------------   50338600
.***AG.KXVAR14 NAME, OPT OUTPUT, KEYS -XVARIABLE                        50388000
              AIF   (K'&RSNCODE(1) LE 0).ZG24C  NO PARM                 50437400
&ZXRSNCODE    SETC  'OUTPUT'    SET OUTPUT                              50486800
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           50536200
              AIF   (N'&RSNCODE GT 1).ZG24C     MULTIPLE PARMS          50585600
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           50635000
.ZG24C        ANOP  ,                                                   50684400
.*-------------------------------------------------------------------   50733800
.***AG.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   50783200
              AIF   (K'&ZXRSNCODE LE 0).ZG24R   NOT I/O                 50832600
              AIF   ('&XRSNCODE'(1,1) NE '(').ZG24R                     50882000
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        50931400
              AIF   ('&ZCGPR'(1,1) NE '0').ZG24P                        50980800
              AIF   (K'&ZCGPR GT 2).ZG24Q                               51030200
              AIF   ('&ZCGPR' EQ '0').ZG24Q                             51079600
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       51129000
              AIF   (T'&ZCGPR NE 'N').ZG24Q     INVALID REG NAME        51178400
.ZG24P        ANOP  ,                                                   51227800
              AIF   (T'&ZCGPR NE 'N').ZG24R     NON NUMERIC             51277200
              AIF   ('&ZCGPR' LT '2').ZG24Q                             51326600
              AIF   ('&ZCGPR' LE '12').ZG24R                            51376000
.ZG24Q        ANOP  ,                                                   51425400
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           51474800
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    51524200
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           51573600
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    51623000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             51672400
.ZG24R        ANOP  ,                                                   51721800
.******************************************************************     51771200
.***AH.P00 CHECK STANDALONE POSITIONAL VARIABLES                        51820600
.******************************************************************     51870000
              ACTR  10000                                               51919400
.*----------------------------------------------------------------***   51968800
.***AH.P02 EXTRA POSITIONALS                                            52018200
              AIF   (N'&SYSLIST LE 0).ZGLISTX   NO EXTRAS               52067600
&ZCVAL        SETC  ''          ERROR FIELD                             52117000
&ZAWRK        SETA  0           POSITIONAL NUMBER                       52166400
.ZGLIST2      ANOP  ,                                                   52215800
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         52265200
              AIF   (&ZAWRK GT N'&SYSLIST).ZGLIST3  DONE                52314600
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   52364000
              AGO   .ZGLIST2                                            52413400
.*                                                                      52462800
.ZGLIST3      ANOP  ,                                                   52512200
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             52561600
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           52611000
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     52660400
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              52709800
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      52759200
              MNOTE 8,' &ZMS ARE ALLOWED.'                              52808600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             52858000
.ZGLISTX      ANOP  ,                                                   52907400
&ZASYSLNDX    SETA  0                                                   52956800
.*-------------------------------------------------------------------   53006200
.***AG.MF04 MF=(SLME)                                                   53055600
.ZGMFX        ANOP  ,           END OF FULL SYNTAX CHECK                53105000
.********************************************************************   53154400
.***AE.MF01   PARTIAL MACRO SYNTAX CHECKING                             53203800
.********************************************************************   53253200
              ACTR  10000                                               53302600
.*-------------------------------------------------------------------   53352000
.***AE.MF01 MF=(SLME)                                                   53401400
              AIF   ('&XMF' EQ 'L').ZEMFX                               53450800
              AIF   ('&XMFSCK' NE 'NOCHECK').ZEMFX                      53500200
.********************************************************************   53549600
.***AE.KC00 INITIALIZE KEYWORD CONTROL VARIABLES                        53599000
.********************************************************************   53648400
&XREQUEST     SETC  ''          INITIALIZE XVARIABLE                    53697800
&XCMDRESP     SETC  ''          INITIALIZE XVARIABLE                    53747200
.*-------------------------------------------------------------------   53796600
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           53846000
              AIF   ('&REQUEST(1)' NE 'RESUME').ZE3A                    53895400
&XREQUEST     SETC  'RESUME'    SET KEYWORD                             53944800
              AIF   (N'&REQUEST LE 1).ZE3A      CK NUM                  53994200
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           54043600
&ZMS          SETC  '&ZMS.&REQUEST"'                                    54093000
&ZMS          SETC  '&ZMS "REQUEST"'                                    54142400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 54191800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             54241200
.ZE3A         ANOP  ,                                                   54290600
.*-------------------------------------------------------------------   54340000
.***AE.KKCTL02 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           54389400
              AIF   ('&REQUEST(1)' NE 'GETMSG').ZE4A                    54438800
&XREQUEST     SETC  'GETMSG'    SET KEYWORD                             54488200
              AIF   (N'&REQUEST LE 1).ZE4A      CK NUM                  54537600
&ZMS          SETC  '"REQUEST='                 *KPOSA* MNOTE           54587000
&ZMS          SETC  '&ZMS.&REQUEST"'                                    54636400
&ZMS          SETC  '&ZMS "REQUEST"'                                    54685800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 54735200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             54784600
.ZE4A         ANOP  ,                                                   54834000
.*-------------------------------------------------------------------   54883400
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           54932800
              AIF   ('&CMDRESP(1)' NE 'NO').ZE7A                        54982200
&XCMDRESP     SETC  'NO'        SET KEYWORD                             55031600
              AIF   (N'&CMDRESP LE 1).ZE7A      CK NUM                  55081000
&ZMS          SETC  '"CMDRESP='                 *KPOSA* MNOTE           55130400
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    55179800
&ZMS          SETC  '&ZMS "CMDRESP"'                                    55229200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 55278600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             55328000
.ZE7A         ANOP  ,                                                   55377400
.*-------------------------------------------------------------------   55426800
.***AE.KKCTL02 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           55476200
              AIF   ('&CMDRESP(1)' NE 'YES').ZE8A                       55525600
&XCMDRESP     SETC  'YES'       SET KEYWORD                             55575000
              AIF   (N'&CMDRESP LE 1).ZE8A      CK NUM                  55624400
&ZMS          SETC  '"CMDRESP='                 *KPOSA* MNOTE           55673800
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    55723200
&ZMS          SETC  '&ZMS "CMDRESP"'                                    55772600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 55822000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             55871400
.ZE8A         ANOP  ,                                                   55920800
.*----------------------------------------------------------------***   55970200
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          56019600
              AIF   (N'&CART LE 1).ZE10A        CK NUM                  56069000
&ZMS          SETC  '"CART='    *KPOSA* MNOTE                           56118400
&ZMS          SETC  '&ZMS.&CART"'                                       56167800
&ZMS          SETC  '&ZMS "CART"'                                       56217200
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 56266600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             56316000
.ZE10A        ANOP  ,                                                   56365400
.*-------------------------------------------------------------------   56414800
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     56464200
              AIF   (K'&CART(1) LE 0).ZE10B     NO PRM                  56513600
&ZXCART       SETC  'INPUT'     SET IN/OUTPUT                           56563000
&XCART        SETC  '&CART(1)'  SET XVARIABLE                           56612400
              AIF   (N'&CART GT 1).ZE10B        MULTIPLE PARMS          56661800
&XCART        SETC  '&CART'     SET XVARIABLE                           56711200
.ZE10B        ANOP  ,                                                   56760600
.*-------------------------------------------------------------------   56810000
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    56859400
              AIF   (K'&ZXCART LE 0).ZE10R      NOT I/O                 56908800
              AIF   ('&XCART'(1,1) NE '(').ZE10R                        56958200
&ZCGPR        SETC  '&XCART'(2,K'&XCART-2)                              57007600
              AIF   ('&ZCGPR'(1,1) NE '0').ZE10P                        57057000
              AIF   (K'&ZCGPR GT 2).ZE10Q                               57106400
              AIF   ('&ZCGPR' EQ '0').ZE10Q                             57155800
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       57205200
              AIF   (T'&ZCGPR NE 'N').ZE10Q     INVALID REG NAME        57254600
.ZE10P        ANOP  ,                                                   57304000
              AIF   (T'&ZCGPR NE 'N').ZE10R     NON NUMERIC             57353400
              AIF   ('&ZCGPR' LT '2').ZE10Q                             57402800
              AIF   ('&ZCGPR' LE '12').ZE10R                            57452200
.ZE10Q        ANOP  ,                                                   57501600
&ZMS          SETC  '"CART='    *KGPRA* MNOTE                           57551000
&ZMS          SETC  '&ZMS.&CART"'                                       57600400
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           57649800
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    57699200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             57748600
.ZE10R        ANOP  ,                                                   57798000
.*----------------------------------------------------------------***   57847400
.***AE.KXVAR03 NAME, OPT INPUT, KEYS -XVAR KEY                          57896800
              AIF   (N'&MASK LE 1).ZE12A        CK NUM                  57946200
&ZMS          SETC  '"MASK='    *KPOSA* MNOTE                           57995600
&ZMS          SETC  '&ZMS.&MASK"'                                       58045000
&ZMS          SETC  '&ZMS "MASK"'                                       58094400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 58143800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             58193200
.ZE12A        ANOP  ,                                                   58242600
.*-------------------------------------------------------------------   58292000
.***AE.KXVAR04 NAME, OPT INPUT, KEYS -XVAR ARGUMENT                     58341400
              AIF   (K'&MASK(1) LE 0).ZE12B     NO PRM                  58390800
&ZXMASK       SETC  'INPUT'     SET IN/OUTPUT                           58440200
&XMASK        SETC  '&MASK(1)'  SET XVARIABLE                           58489600
              AIF   (N'&MASK GT 1).ZE12B        MULTIPLE PARMS          58539000
&XMASK        SETC  '&MASK'     SET XVARIABLE                           58588400
.ZE12B        ANOP  ,                                                   58637800
.*-------------------------------------------------------------------   58687200
.***AE.KCK02 NAME, OPT INPUT, KEYS -GPR OUT OF RANGE                    58736600
              AIF   (K'&ZXMASK LE 0).ZE12R      NOT I/O                 58786000
              AIF   ('&XMASK'(1,1) NE '(').ZE12R                        58835400
&ZCGPR        SETC  '&XMASK'(2,K'&XMASK-2)                              58884800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE12P                        58934200
              AIF   (K'&ZCGPR GT 2).ZE12Q                               58983600
              AIF   ('&ZCGPR' EQ '0').ZE12Q                             59033000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       59082400
              AIF   (T'&ZCGPR NE 'N').ZE12Q     INVALID REG NAME        59131800
.ZE12P        ANOP  ,                                                   59181200
              AIF   (T'&ZCGPR NE 'N').ZE12R     NON NUMERIC             59230600
              AIF   ('&ZCGPR' LT '2').ZE12Q                             59280000
              AIF   ('&ZCGPR' LE '12').ZE12R                            59329400
.ZE12Q        ANOP  ,                                                   59378800
&ZMS          SETC  '"MASK='    *KGPRA* MNOTE                           59428200
&ZMS          SETC  '&ZMS.&MASK"'                                       59477600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           59527000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    59576400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             59625800
.ZE12R        ANOP  ,                                                   59675200
.*------------------------------------------------------------------    59724600
.***AE.KKCTL03 VALUE, OPT INPUT, ME KYWRDCTL -KEYWORD CONTROL           59774000
.ZE15         AIF   (K'&XCMDRESP GT 0).ZE15A    VALID                   59823400
              AIF   (K'&CMDRESP(1) LE 0).ZE15B                          59872800
&ZMS          SETC  '"CMDRESP='                 *KUKWA* MNOTE           59922200
&ZMS          SETC  '&ZMS.&CMDRESP"'                                    59971600
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           60021000
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 60070400
&ZMS          SETC  '&ZMS "NO"'                 VALID KEYWORD           60119800
              MNOTE 8,' &ZMS OR "YES".'                                 60169200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             60218600
              AGO   .ZE15B                                              60268000
.*                                                                      60317400
.ZE15A        ANOP  ,                                                   60366800
&ZXCMDRESP    SETC  'INPUT'     SET IN/OUTPUT                           60416200
.ZE15B        ANOP  ,                                                   60465600
.*------------------------------------------------------------------    60515000
.***AE.KKCTL03 VALUE, RQD INPUT, ME KYWRDCTL -KEYWORD CONTROL           60564400
.ZE16         AIF   (K'&XREQUEST GT 0).ZE16A    VALID                   60613800
              AIF   (K'&REQUEST(1) LE 0).ZE16B                          60663200
&ZMS          SETC  '"REQUEST='                 *KUKWA* MNOTE           60712600
&ZMS          SETC  '&ZMS.&REQUEST"'                                    60762000
&ZMS          SETC  '&ZMS ARGUMENT 1 IS AN UNKNOWN KEYWORD. '           60811400
&ZMS          SETC  '&ZMS VALID KEYWORD CHOICE(S) ARE:'                 60860800
&ZMS          SETC  '&ZMS "RESUME"'             VALID KEYWORD           60910200
              MNOTE 8,' &ZMS OR "GETMSG".'                              60959600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61009000
              AGO   .ZE16B                                              61058400
.*                                                                      61107800
.ZE16A        ANOP  ,                                                   61157200
&ZXREQUEST    SETC  'INPUT'     SET IN/OUTPUT                           61206600
.ZE16B        ANOP  ,                                                   61256000
.*----------------------------------------------------------------***   61305400
.***AE.KXVAR03 NAME, RQD INPUT, KEYS -XVAR KEY                          61354800
              AIF   (N'&CONSID LE 1).ZE18A      CK NUM                  61404200
&ZMS          SETC  '"CONSID='  *KPOSA* MNOTE                           61453600
&ZMS          SETC  '&ZMS.&CONSID"'                                     61503000
&ZMS          SETC  '&ZMS "CONSID"'                                     61552400
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 61601800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             61651200
.ZE18A        ANOP  ,                                                   61700600
.*-------------------------------------------------------------------   61750000
.***AE.KXVAR04 NAME, RQD INPUT, KEYS -XVAR ARGUMENT                     61799400
              AIF   (K'&CONSID(1) LE 0).ZE18B   NO PRM                  61848800
&ZXCONSID     SETC  'INPUT'     SET IN/OUTPUT                           61898200
&XCONSID      SETC  '&CONSID(1)'                SET XVARIABLE           61947600
              AIF   (N'&CONSID GT 1).ZE18B      MULTIPLE PARMS          61997000
&XCONSID      SETC  '&CONSID'   SET XVARIABLE                           62046400
.ZE18B        ANOP  ,                                                   62095800
.*-------------------------------------------------------------------   62145200
.***AE.KCK02 NAME, RQD INPUT, KEYS -GPR OUT OF RANGE                    62194600
              AIF   (K'&ZXCONSID LE 0).ZE18R    NOT I/O                 62244000
              AIF   ('&XCONSID'(1,1) NE '(').ZE18R                      62293400
&ZCGPR        SETC  '&XCONSID'(2,K'&XCONSID-2)                          62342800
              AIF   ('&ZCGPR'(1,1) NE '0').ZE18P                        62392200
              AIF   (K'&ZCGPR GT 2).ZE18Q                               62441600
              AIF   ('&ZCGPR' EQ '0').ZE18Q                             62491000
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       62540400
              AIF   (T'&ZCGPR NE 'N').ZE18Q     INVALID REG NAME        62589800
.ZE18P        ANOP  ,                                                   62639200
              AIF   (T'&ZCGPR NE 'N').ZE18R     NON NUMERIC             62688600
              AIF   ('&ZCGPR' LT '2').ZE18Q                             62738000
              AIF   ('&ZCGPR' LE '12').ZE18R                            62787400
.ZE18Q        ANOP  ,                                                   62836800
&ZMS          SETC  '"CONSID='  *KGPRA* MNOTE                           62886200
&ZMS          SETC  '&ZMS.&CONSID"'                                     62935600
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           62985000
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    63034400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             63083800
.ZE18R        ANOP  ,                                                   63133200
.*----------------------------------------------------------------***   63182600
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         63232000
              AIF   (N'&RTNCODE LE 1).ZE21A     CK NUM                  63281400
&ZMS          SETC  '"RTNCODE='                 *KPOSA* MNOTE           63330800
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    63380200
&ZMS          SETC  '&ZMS "RTNCODE"'                                    63429600
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 63479000
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             63528400
.ZE21A        ANOP  ,                                                   63577800
.*-------------------------------------------------------------------   63627200
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    63676600
              AIF   (K'&RTNCODE(1) LE 0).ZE21B  NO PRM                  63726000
&ZXRTNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           63775400
&XRTNCODE     SETC  '&RTNCODE(1)'               SET XVARIABLE           63824800
              AIF   (N'&RTNCODE GT 1).ZE21B     MULTIPLE PARMS          63874200
&XRTNCODE     SETC  '&RTNCODE'  SET XVARIABLE                           63923600
.ZE21B        ANOP  ,                                                   63973000
.*-------------------------------------------------------------------   64022400
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   64071800
              AIF   (K'&ZXRTNCODE LE 0).ZE21R   NOT I/O                 64121200
              AIF   ('&XRTNCODE'(1,1) NE '(').ZE21R                     64170600
&ZCGPR        SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                        64220000
              AIF   ('&ZCGPR'(1,1) NE '0').ZE21P                        64269400
              AIF   (K'&ZCGPR GT 2).ZE21Q                               64318800
              AIF   ('&ZCGPR' EQ '0').ZE21Q                             64368200
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       64417600
              AIF   (T'&ZCGPR NE 'N').ZE21Q     INVALID REG NAME        64467000
.ZE21P        ANOP  ,                                                   64516400
              AIF   (T'&ZCGPR NE 'N').ZE21R     NON NUMERIC             64565800
              AIF   ('&ZCGPR' LT '2').ZE21Q                             64615200
              AIF   ('&ZCGPR' LE '12').ZE21R                            64664600
.ZE21Q        ANOP  ,                                                   64714000
&ZMS          SETC  '"RTNCODE='                 *KGPRA* MNOTE           64763400
&ZMS          SETC  '&ZMS.&RTNCODE"'                                    64812800
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           64862200
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    64911600
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             64961000
.ZE21R        ANOP  ,                                                   65010400
.*----------------------------------------------------------------***   65059800
.***AE.KXVAR03 NAME, OPT OUTPUT, KEYS -XVAR KEY                         65109200
              AIF   (N'&RSNCODE LE 1).ZE24A     CK NUM                  65158600
&ZMS          SETC  '"RSNCODE='                 *KPOSA* MNOTE           65208000
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    65257400
&ZMS          SETC  '&ZMS "RSNCODE"'                                    65306800
              MNOTE 8,' &ZMS CAN HAVE ONLY 1 ARGUMENT.'                 65356200
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             65405600
.ZE24A        ANOP  ,                                                   65455000
.*-------------------------------------------------------------------   65504400
.***AE.KXVAR04 NAME, OPT OUTPUT, KEYS -XVAR ARGUMENT                    65553800
              AIF   (K'&RSNCODE(1) LE 0).ZE24B  NO PRM                  65603200
&ZXRSNCODE    SETC  'OUTPUT'    SET IN/OUTPUT                           65652600
&XRSNCODE     SETC  '&RSNCODE(1)'               SET XVARIABLE           65702000
              AIF   (N'&RSNCODE GT 1).ZE24B     MULTIPLE PARMS          65751400
&XRSNCODE     SETC  '&RSNCODE'  SET XVARIABLE                           65800800
.ZE24B        ANOP  ,                                                   65850200
.*-------------------------------------------------------------------   65899600
.***AE.KCK02 NAME, OPT OUTPUT, KEYS -GPR OUT OF RANGE                   65949000
              AIF   (K'&ZXRSNCODE LE 0).ZE24R   NOT I/O                 65998400
              AIF   ('&XRSNCODE'(1,1) NE '(').ZE24R                     66047800
&ZCGPR        SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                        66097200
              AIF   ('&ZCGPR'(1,1) NE '0').ZE24P                        66146600
              AIF   (K'&ZCGPR GT 2).ZE24Q                               66196000
              AIF   ('&ZCGPR' EQ '0').ZE24Q                             66245400
&ZCGPR        SETC  '&ZCGPR'(2,1)                                       66294800
              AIF   (T'&ZCGPR NE 'N').ZE24Q     INVALID REG NAME        66344200
.ZE24P        ANOP  ,                                                   66393600
              AIF   (T'&ZCGPR NE 'N').ZE24R     NON NUMERIC             66443000
              AIF   ('&ZCGPR' LT '2').ZE24Q                             66492400
              AIF   ('&ZCGPR' LE '12').ZE24R                            66541800
.ZE24Q        ANOP  ,                                                   66591200
&ZMS          SETC  '"RSNCODE='                 *KGPRA* MNOTE           66640600
&ZMS          SETC  '&ZMS.&RSNCODE"'                                    66690000
&ZMS          SETC  '&ZMS ARGUMENT 1 MUST SPECIFY A REGISTER'           66739400
              MNOTE 8,' &ZMS IN THE RANGE (2)-(12).'                    66788800
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             66838200
.ZE24R        ANOP  ,                                                   66887600
.******************************************************************     66937000
.***AF.P00 CHECK STANDALONE POSITIONAL VARIABLES                        66986400
.******************************************************************     67035800
              ACTR  10000                                               67085200
.*----------------------------------------------------------------***   67134600
.***AF.P02 EXTRA POSITIONALS                                            67184000
              AIF   (N'&SYSLIST LE 0).ZELISTX   NO EXTRAS               67233400
&ZCVAL        SETC  ''          ERROR FIELD                             67282800
&ZAWRK        SETA  0           POSITIONAL NUMBER                       67332200
.ZELIST2      ANOP  ,                                                   67381600
&ZAWRK        SETA  &ZAWRK+1    NEXT POSITIONAL                         67431000
              AIF   (&ZAWRK GT N'&SYSLIST).ZELIST3  DONE                67480400
&ZCVAL        SETC '&ZCVAL,&SYSLIST(&ZAWRK)'    EXTRA                   67529800
              AGO   .ZELIST2                                            67579200
.*                                                                      67628600
.ZELIST3      ANOP  ,                                                   67678000
&ZCVAL        SETC '&ZCVAL'(2,K'&ZCVAL-1)       STRIP COMMA             67727400
&ZMS          SETC  'POSITIONAL ARGUMENT(S),'   *PPOSA* MNOTE           67776800
&ZMS          SETC  '&ZMS "&ZCVAL"'                                     67826200
&ZMS          SETC  '&ZMS CANNOT BE USED.'                              67875600
&ZMS          SETC  '&ZMS NO POSITIONAL ARGUMENTS'                      67925000
              MNOTE 8,' &ZMS ARE ALLOWED.'                              67974400
&ZMACRET      SETA  8           SET MACRO ERROR RETURN CODE             68023800
.ZELISTX      ANOP  ,                                                   68073200
&ZASYSLNDX    SETA  0                                                   68122600
.*-------------------------------------------------------------------   68172000
.***AE.MF02 MF=(SLME)                                                   68221400
.ZEMFX        ANOP  ,           END OF PARTIAL SYNTAX CHECK             68270800
.*******************************************************************    68320200
.***AE.ZMR01 NO CODE GENERATED IF ERRORS DETECTED                       68369600
.*******************************************************************    68419000
              AIF   (&ZMACRET NE 0).ZLX2        ERROR DETECTED          68468400
.*******************************************************************    68517800
.***AE.01  START OF MCSOPMSG MACRO CODE                                 68567200
.*******************************************************************    68616600
              LCLC  &M0M0001                 LABEL NAME                 68666000
&M0M0001      SETC  '&XLABEL'                SET LABEL                  68715400
              AIF   (K'&XLABEL NE 0).XLAB2                              68764800
&M0M0001      SETC  'M00M&SYSNDX'            DEFAULT LABEL              68814200
.*                                                                      68863600
.XLAB2        ANOP  ,                                                   68913000
&M0M0001 DS    0H                             MCSOPMSG-1                68962400
.*******************************************************************    69011800
.***AE.PR01 PRINT CONTROLS, DEFAULT IS YES                              69061200
.*******************************************************************    69110600
              PUSH  PRINT                                               69160000
              AIF   ('&ZPRINT' NE 'NO').ZPRINTX  TURN PRINT ON          69209400
              PRINT OFF         ++ PR01                                 69258800
              AGO   .ZPRNTXX                                            69308200
.ZPRINTX      PRINT ON                                                  69357600
.ZPRNTXX      ANOP  ,                                                   69407000
.********************************************************************   69456400
.***AL.L01 INTERNAL ARRAY TO PRODUCE FORMATTED CODE                     69505800
.********************************************************************   69555200
                      LCLA  &ZOPN          LIST INSTRUCTION INDEX       69604600
                      LCLA  &ZOPN1         INVOCATION INDEX             69654000
                      LCLC  &ZOPL(4095)    LABEL                        69703400
                      LCLC  &ZOPO(4095)    OPERATION                    69752800
                      LCLC  &ZOPV(4095)    VALUE                        69802200
                      LCLC  &ZOPD(4095)    DESCRIPTION                  69851600
.*                                                                      69901000
&ZOPN                 SETA  0              INITIAL INST INDEX VALUE     69950400
.******************************************************************     69999800
.***AL.L10 MCSOPMSG FMT=LIST MF=S|L PARAMETERS                          70049200
.******************************************************************     70098600
                      AIF   ('&XMF' EQ 'L').ZLMFSL2                     70148000
                      AIF   ('&XMF' NE 'S').ZLMFSLX                     70197400
&XMFCTRL              SETC  '#Z'.'&SYSNDX'(2,3).'A'                     70246800
&XMFATTR              SETC  '0D'                                        70296200
.*                                                                      70345600
&ZOPN                 SETA  &ZOPN+1                                     70395000
&ZOPL(&ZOPN)          SETC  ' '                                         70444400
&ZOPO(&ZOPN)          SETC  'B'                                         70493800
&ZOPV(&ZOPN)          SETC  '&XMFCTRL.S'                                70543200
&ZOPD(&ZOPN)          SETC  '++ MCSOPMSG ARG PARMS'                     70592600
.*                                                                      70642000
&ZOPN                 SETA  &ZOPN+1                                     70691400
&ZOPL(&ZOPN)          SETC  ' '                                         70740800
&ZOPO(&ZOPN)          SETC  'SPACE'                                     70790200
&ZOPV(&ZOPN)          SETC  '1'                                         70839600
&ZOPD(&ZOPN)          SETC  ' '                                         70889000
.*                                                                      70938400
.ZLMFSL2              ANOP  ,                                           70987800
.*-------------------------------------------------------------------   71037200
.***AM.L01  MCSOPMSG FMT=LIST PARAMETERS                                71086600
&ZOPN                 SETA &ZOPN+1                                      71136000
&ZOPL(&ZOPN)          SETC '&XMFCTRL'                                   71185400
&ZOPO(&ZOPN)          SETC 'DS'                                         71234800
&ZOPV(&ZOPN)          SETC '&XMFATTR'                                   71284200
&ZOPD(&ZOPN)          SETC '++ MCSOPMSG PARM LIST'                      71333600
.*-------------------------------------------------------------------   71383000
.***AM.L09  XACRO CL4                                                   71432400
&ZOPN                 SETA &ZOPN+1                                      71481800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XACRO'                            71531200
&ZOPO(&ZOPN)          SETC 'DS'                                         71580600
&ZOPV(&ZOPN)          SETC 'CL4'                                        71630000
&ZOPD(&ZOPN)          SETC '++ CONSTANT  XACRO'                         71679400
.*-------------------------------------------------------------------   71728800
.***AM.L02 XVERSION XL1                                                 71778200
&ZOPN                 SETA &ZOPN+1                                      71827600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XVERSION'                         71877000
&ZOPO(&ZOPN)          SETC 'DS'                                         71926400
&ZOPV(&ZOPN)          SETC 'XL1'                                        71975800
&ZOPD(&ZOPN)          SETC '++ INPUT XVERSION'                          72025200
.*-------------------------------------------------------------------   72074600
.***AM.L05 XREQUEST XL1                                                 72124000
&ZOPN                 SETA &ZOPN+1                                      72173400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XREQUEST'                         72222800
&ZOPO(&ZOPN)          SETC 'DS'                                         72272200
&ZOPV(&ZOPN)          SETC 'XL1'                                        72321600
&ZOPD(&ZOPN)          SETC '++ &ZXREQUEST XREQUEST'                     72371000
.*                                                                      72420400
&ZOPN                 SETA  &ZOPN+1                                     72469800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._GETMSG'                          72519200
&ZOPO(&ZOPN)          SETC  'EQU'                                       72568600
&ZOPV(&ZOPN)          SETC  '1'                                         72618000
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              72667400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).GETMSG'                       72716800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      72766200
.*                                                                      72815600
&ZOPN                 SETA  &ZOPN+1                                     72865000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._RESUME'                          72914400
&ZOPO(&ZOPN)          SETC  'EQU'                                       72963800
&ZOPV(&ZOPN)          SETC  '2'                                         73013200
&ZOPD(&ZOPN)          SETC  '++ XREQUEST.'                              73062600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).RESUME'                       73112000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      73161400
.*-------------------------------------------------------------------   73210800
.***AM.L03 XCMDRESP BL.8                                                73260200
&ZOPN                 SETA &ZOPN+1                                      73309600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCMDRESP'                         73359000
&ZOPO(&ZOPN)          SETC 'DS'                                         73408400
&ZOPV(&ZOPN)          SETC 'BL.8'                                       73457800
&ZOPD(&ZOPN)          SETC '++ INPUT'                                   73507200
.*                                                                      73556600
&ZOPN                 SETA  &ZOPN+1                                     73606000
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCMDRESP_YES'                    73655400
&ZOPO(&ZOPN)          SETC  'EQU'                                       73704800
&ZOPV(&ZOPN)          SETC  'B''10000000'''                             73754200
&ZOPD(&ZOPN)          SETC  '++ XCMDRESP.'                              73803600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).YES'                          73853000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      73902400
.*                                                                      73951800
&ZOPN                 SETA  &ZOPN+1                                     74001200
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._XCMDRESP_NO'                     74050600
&ZOPO(&ZOPN)          SETC  'EQU'                                       74100000
&ZOPV(&ZOPN)          SETC  'B''01000000'''                             74149400
&ZOPD(&ZOPN)          SETC  '++ XCMDRESP.'                              74198800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).NO'                           74248200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      74297600
.*                                                                      74347000
&ZOPN                 SETA  &ZOPN+1                                     74396400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CMDRESP'                 74445800
&ZOPO(&ZOPN)          SETC  'EQU'                                       74495200
&ZOPV(&ZOPN)          SETC  'B''00100000'''                             74544600
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               74594000
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CMDRESP'                      74643400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      74692800
.*                                                                      74742200
&ZOPN                 SETA  &ZOPN+1                                     74791600
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_CART'                    74841000
&ZOPO(&ZOPN)          SETC  'EQU'                                       74890400
&ZOPV(&ZOPN)          SETC  'B''00010000'''                             74939800
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               74989200
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).CART'                         75038600
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      75088000
.*                                                                      75137400
&ZOPN                 SETA  &ZOPN+1                                     75186800
&ZOPL(&ZOPN)          SETC  '&XMFCTRL._KEYUSED_MASK'                    75236200
&ZOPO(&ZOPN)          SETC  'EQU'                                       75285600
&ZOPV(&ZOPN)          SETC  'B''00001000'''                             75335000
&ZOPD(&ZOPN)          SETC  '++ KEYUSED.'                               75384400
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN).MASK'                         75433800
&ZOPD(&ZOPN)          SETC  '&ZOPD(&ZOPN) KEYWORD'                      75483200
.*-------------------------------------------------------------------   75532600
.***AM.L09  XRSV0001 CL01                                               75582000
&ZOPN                 SETA &ZOPN+1                                      75631400
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0001'                         75680800
&ZOPO(&ZOPN)          SETC 'DS'                                         75730200
&ZOPV(&ZOPN)          SETC 'CL01'                                       75779600
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0001'                      75829000
.*-------------------------------------------------------------------   75878400
.***AM.L09  XCART CL8                                                   75927800
&ZOPN                 SETA &ZOPN+1                                      75977200
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCART'                            76026600
&ZOPO(&ZOPN)          SETC 'DS'                                         76076000
&ZOPV(&ZOPN)          SETC 'CL8'                                        76125400
&ZOPD(&ZOPN)          SETC '++ &ZXCART  XCART'                          76174800
.*-------------------------------------------------------------------   76224200
.***AM.L09  XMASK CL8                                                   76273600
&ZOPN                 SETA &ZOPN+1                                      76323000
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XMASK'                            76372400
&ZOPO(&ZOPN)          SETC 'DS'                                         76421800
&ZOPV(&ZOPN)          SETC 'CL8'                                        76471200
&ZOPD(&ZOPN)          SETC '++ &ZXMASK  XMASK'                          76520600
.*-------------------------------------------------------------------   76570000
.***AM.L09  XCONSID F                                                   76619400
&ZOPN                 SETA &ZOPN+1                                      76668800
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XCONSID'                          76718200
&ZOPO(&ZOPN)          SETC 'DS'                                         76767600
&ZOPV(&ZOPN)          SETC 'F'                                          76817000
&ZOPD(&ZOPN)          SETC '++ &ZXCONSID  XCONSID'                      76866400
.*-------------------------------------------------------------------   76915800
.***AM.L09  XRSV0002 CL04                                               76965200
&ZOPN                 SETA &ZOPN+1                                      77014600
&ZOPL(&ZOPN)          SETC '&XMFCTRL._XRSV0002'                         77064000
&ZOPO(&ZOPN)          SETC 'DS'                                         77113400
&ZOPV(&ZOPN)          SETC 'CL04'                                       77162800
&ZOPD(&ZOPN)          SETC '++ RESERVED  XRSV0002'                      77212200
.*-------------------------------------------------------------------   77261600
.***AM.L10 END OF MCSOPMSG LIST PARAMETERS                              77311000
&ZOPN                 SETA &ZOPN+1                                      77360400
&ZOPL(&ZOPN)          SETC '&XMFCTRL.L'                                 77409800
&ZOPO(&ZOPN)          SETC 'EQU'                                        77459200
&ZOPV(&ZOPN)          SETC '*-&XMFCTRL'                                 77508600
&ZOPD(&ZOPN)          SETC '++ LENGTH OF PLIST'                         77558000
.*                                                                      77607400
&ZOPN                 SETA &ZOPN+1                                      77656800
&ZOPL(&ZOPN)          SETC ' '                                          77706200
&ZOPO(&ZOPN)          SETC 'SPACE'                                      77755600
&ZOPV(&ZOPN)          SETC '1'                                          77805000
&ZOPD(&ZOPN)          SETC ' '                                          77854400
.*-------------------------------------------------------------------   77903800
.***AL.L12 MCSOPMSG FMT=LIST MF=S|L PARAMETERS                          77953200
                      AIF   ('&XMF' EQ 'L').ZMFLX  DONE IF MF=L         78002600
.*                                                                      78052000
&ZOPN                 SETA  &ZOPN+1                                     78101400
&ZOPL(&ZOPN)          SETC  '&XMFCTRL.S'                                78150800
&ZOPO(&ZOPN)          SETC  'DC'                                        78200200
&ZOPV(&ZOPN)          SETC  '0H''0'''                                   78249600
&ZOPD(&ZOPN)          SETC  '++ MCSOPMSG ARG PARMS'                     78299000
.*                                                                      78348400
.ZLMFSLX              ANOP  ,                                           78397800
.*-------------------------------------------------------------------   78447200
.***AL.L13 SET ZPLLEN TO ITS APPROPRIATE VALUE                          78496600
&ZPLLEN               SETA 32                                           78546000
.*                                                                      78595400
.******************************************************************     78644800
.***AI.L01 MCSOPMSG FMT=LIST FILL IN PARAMETER AREA                     78694200
.******************************************************************     78743600
                      ACTR  10000                                       78793000
&ZCVAL                SETC  'LA'           ASSUME XA MODE               78842400
                      AIF   ('&SYSASCE' EQ 'P').ZIMFXA  SYSTATE PRI     78891800
&ZCVAL                SETC  'LAE'          XAX MODE                     78941200
.ZIMFXA               ANOP ,                                            78990600
.*                                                                      79040000
                      AIF   ('&XMFCTRL'(1,1) NE '(').ZIMFN2  NOT GPR    79089400
&ZCGPR                SETC  '&XMFCTRL'(2,K'&XMFCTRL-2)  GET GPR         79138800
                      AIF   ('&ZCGPR' EQ 'GPR1').ZIMFNX                 79188200
                      AIF   ('&ZCGPR' EQ 'GPR01').ZIMFNX                79237600
                      AIF   ('&ZCGPR' EQ 'REG1').ZIMFNX                 79287000
                      AIF   ('&ZCGPR' EQ 'REG01').ZIMFNX                79336400
                      AIF   ('&ZCGPR' EQ 'R1').ZIMFNX                   79385800
                      AIF   ('&ZCGPR' EQ '1').ZIMFNX                    79435200
                      AIF   ('&ZCGPR' EQ '01').ZIMFNX                   79484600
&ZOPN                 SETA  &ZOPN+1                                     79534000
&ZOPL(&ZOPN)          SETC  ' '                                         79583400
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    79632800
&ZOPV(&ZOPN)          SETC  '1,0(,&ZCGPR)'                              79682200
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       79731600
                      AGO   .ZIMFNX                                     79781000
.*                                                                      79830400
.ZIMFN2               ANOP ,                                            79879800
&ZOPN                 SETA  &ZOPN+1                                     79929200
&ZOPL(&ZOPN)          SETC  ' '                                         79978600
&ZOPO(&ZOPN)          SETC  '&ZCVAL'                                    80028000
&ZOPV(&ZOPN)          SETC  '1,&XMFCTRL'                                80077400
&ZOPD(&ZOPN)          SETC  '++ LOCATE ARG PARMS'                       80126800
.ZIMFNX               ANOP ,                                            80176200
.********************************************************************   80225600
.***AI.L02 MCSOPMSG FMT=LIST INITIALIZE PARAMETER AREA                  80275000
.********************************************************************   80324400
.***AI.L03 MF=(SLME)                                                    80373800
                      AIF   ('&XMF' EQ 'L').ZIMFLX                      80423200
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFLX            80472600
.*                                                                      80522000
&ZOPN                 SETA  &ZOPN+1                                     80571400
&ZOPL(&ZOPN)          SETC  ' '                                         80620800
&ZOPO(&ZOPN)          SETC  'XC'                                        80670200
&ZOPV(&ZOPN)          SETC  '0(&ZPLLEN,1),0(1)'                         80719600
&ZOPD(&ZOPN)          SETC  '++ INITIALIZE'                             80769000
.ZIMFLX               ANOP  ,                                           80818400
.*-------------------------------------------------------------------   80867800
.***AI.L60 XACRO CL4                                                    80917200
&ZOPN                 SETA  &ZOPN+1                                     80966600
&ZOPL(&ZOPN)          SETC  ' '                                         81016000
&ZOPO(&ZOPN)          SETC  'MVC'                                       81065400
&ZOPV(&ZOPN)          SETC  '0(4,1),=CL4''MDR '''                       81114800
&ZOPD(&ZOPN)          SETC  '++ CL4 CONSTANT'                           81164200
.*-------------------------------------------------------------------   81213600
.***AI.L04B XVERSION XL1                                                81263000
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZIMFVX            81312400
&ZOPN                 SETA  &ZOPN+1                                     81361800
&ZOPL(&ZOPN)          SETC  ' '                                         81411200
&ZOPO(&ZOPN)          SETC  'MVI'                                       81460600
&ZOPV(&ZOPN)          SETC  '4(1),1'                                    81510000
&ZOPD(&ZOPN)          SETC  '++ INPUT XVERSION XL1'                     81559400
.ZIMFVX               ANOP  ,                                           81608800
.*-------------------------------------------------------------------   81658200
.***AI.L07 XREQUEST AL1                                                 81707600
&ZW                   SETC  ''                                          81757000
.*-------------------------------------------------------------------   81806400
.***AI.L15 XREQUEST "GETMSG" AL1                                        81855800
         AIF   ('&XREQUEST' NE 'GETMSG').ZI4A                           81905200
&ZW                   SETC  '1'                                         81954600
.ZI4A                 ANOP  ,                                           82004000
.*-------------------------------------------------------------------   82053400
.***AI.L15 XREQUEST "RESUME" AL1                                        82102800
         AIF   ('&XREQUEST' NE 'RESUME').ZI5A                           82152200
&ZW                   SETC  '2'                                         82201600
.ZI5A                 ANOP  ,                                           82251000
.*-------------------------------------------------------------------   82300400
.***AI.L17 XREQUEST AL1                                                 82349800
                      AIF   ('&ZW' NE '0').ZI5C                         82399200
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI5B              82448600
.ZI5C                 ANOP  ,                                           82498000
                      AIF   ('&ZW' EQ '').ZI5B                          82547400
.*                                                                      82596800
&ZOPN                 SETA  &ZOPN+1                                     82646200
&ZOPL(&ZOPN)          SETC  ' '                                         82695600
&ZOPO(&ZOPN)          SETC  'MVI'                                       82745000
&ZOPV(&ZOPN)          SETC  '5(1),&ZW'                                  82794400
&ZOPD(&ZOPN)          SETC  '++ &ZXREQUEST XREQUEST AL1'                82843800
.ZI5B                 ANOP  ,                                           82893200
.*-------------------------------------------------------------------   82942600
.***AI.L05 XCMDRESP BL1                                                 82992000
&ZW                   SETC  ''                                          83041400
&ZCLNG                SETC  ''             RESET BIT ON FLAG            83090800
&ZMS                  SETC  ''                                          83140200
&ZC                   SETC  ''                                          83189600
.*-------------------------------------------------------------------   83239000
.***AI.L08 XCMDRESP "YES"                                               83288400
.***      BL1'1XXXXXXX'                                                 83337800
         AIF   ('&XCMDRESP' NE 'YES').ZI7A                              83387200
&ZW                   SETC  '&ZW.1'                                     83436600
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              83486000
&ZMS                  SETC  '&ZMS.1'                                    83535400
                      AGO   .ZI7C                                       83584800
.*                                                                      83634200
.ZI7A                 ANOP  ,                                           83683600
&ZW                   SETC  '&ZW.0'                                     83733000
         AIF   ('&ZXCMDRESP' EQ '').ZI7B                                83782400
&ZMS                  SETC  '&ZMS.0'                                    83831800
&ZC                   SETC  'YES'          SET BIT OFF FLAG             83881200
                      AGO   .ZI7C                                       83930600
.*                                                                      83980000
.ZI7B                 ANOP  ,                                           84029400
&ZMS                  SETC  '&ZMS.1'                                    84078800
.ZI7C                 ANOP  ,                                           84128200
.*-------------------------------------------------------------------   84177600
.***AI.L08 XCMDRESP "NO"                                                84227000
.***      BL1'X1XXXXXX'                                                 84276400
         AIF   ('&XCMDRESP' NE 'NO').ZI8A                               84325800
&ZW                   SETC  '&ZW.1'                                     84375200
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              84424600
&ZMS                  SETC  '&ZMS.1'                                    84474000
                      AGO   .ZI8C                                       84523400
.*                                                                      84572800
.ZI8A                 ANOP  ,                                           84622200
&ZW                   SETC  '&ZW.0'                                     84671600
         AIF   ('&ZXCMDRESP' EQ '').ZI8B                                84721000
&ZMS                  SETC  '&ZMS.0'                                    84770400
&ZC                   SETC  'YES'          SET BIT OFF FLAG             84819800
                      AGO   .ZI8C                                       84869200
.*                                                                      84918600
.ZI8B                 ANOP  ,                                           84968000
&ZMS                  SETC  '&ZMS.1'                                    85017400
.ZI8C                 ANOP  ,                                           85066800
.*-------------------------------------------------------------------   85116200
.***AI.L08 XCMDRESP "CMDRESP"                                           85165600
.***      BL1'XX1XXXXX'                                                 85215000
         AIF   ('&CMDRESP' EQ '').ZI9A                                  85264400
&ZW                   SETC  '&ZW.1'                                     85313800
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              85363200
&ZMS                  SETC  '&ZMS.0'                                    85412600
                      AGO   .ZI9C                                       85462000
.*                                                                      85511400
.ZI9A                 ANOP  ,                                           85560800
&ZW                   SETC  '&ZW.0'                                     85610200
&ZMS                  SETC  '&ZMS.1'                                    85659600
.ZI9C                 ANOP  ,                                           85709000
.*-------------------------------------------------------------------   85758400
.***AI.L08 XCMDRESP "CART"                                              85807800
.***      BL1'XXX1XXXX'                                                 85857200
         AIF   ('&CART' EQ '').ZI10A                                    85906600
         AIF   ('&CART' EQ 'NULL').ZI10A                                85956000
&ZW                   SETC  '&ZW.1'                                     86005400
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              86054800
&ZMS                  SETC  '&ZMS.0'                                    86104200
                      AGO   .ZI10C                                      86153600
.*                                                                      86203000
.ZI10A                ANOP  ,                                           86252400
&ZW                   SETC  '&ZW.0'                                     86301800
&ZMS                  SETC  '&ZMS.1'                                    86351200
.ZI10C                ANOP  ,                                           86400600
.*-------------------------------------------------------------------   86450000
.***AI.L08 XCMDRESP "MASK"                                              86499400
.***      BL1'XXXX1XXX'                                                 86548800
         AIF   ('&MASK' EQ '').ZI11A                                    86598200
         AIF   ('&MASK' EQ 'NULL').ZI11A                                86647600
&ZW                   SETC  '&ZW.1000'                                  86697000
&ZCLNG                SETC  'YES'          SET BIT ON FLAG              86746400
&ZMS                  SETC  '&ZMS.0111'                                 86795800
                      AGO   .ZI11C                                      86845200
.*                                                                      86894600
.ZI11A                ANOP  ,                                           86944000
&ZW                   SETC  '&ZW.0000'                                  86993400
&ZMS                  SETC  '&ZMS.1111'                                 87042800
.ZI11C                ANOP  ,                                           87092200
.*-------------------------------------------------------------------   87141600
.***AI.L11 XCMDRESP BL1                                                 87191000
                      AIF   ('&XMFSCK' NE 'NOCHECK').ZI11D              87240400
                      AIF   ('&ZC' NE 'YES').ZI11D                      87289800
&ZOPN                 SETA  &ZOPN+1                                     87339200
&ZOPL(&ZOPN)          SETC  ' '                                         87388600
&ZOPO(&ZOPN)          SETC  'NI'                                        87438000
&ZOPV(&ZOPN)          SETC  '6(1),B''&ZMS'''                            87487400
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              87536800
.ZI11D                ANOP  ,                                           87586200
                      AIF   ('&ZCLNG' NE 'YES').ZI11E  ALL ZERO BITS    87635600
&ZOPN                 SETA  &ZOPN+1                                     87685000
&ZOPL(&ZOPN)          SETC  ' '                                         87734400
&ZOPO(&ZOPN)          SETC  'OI'                                        87783800
&ZOPV(&ZOPN)          SETC  '6(1),B''&ZW'''                             87833200
&ZOPD(&ZOPN)          SETC  '++ INPUT BL1'                              87882600
.ZI11E                ANOP  ,                                           87932000
.*-------------------------------------------------------------------   87981400
.***AI.L18  XCART CL8                                                   88030800
                      AIF   ('&XCART' NE 'NULL').ZI13  CK *             88080200
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI13  CK *        88129600
&ZXCART               SETC  ''             RESET INPUT/OUTPUT           88179000
.ZI13                 ANOP  ,                                           88228400
.*-------------------------------------------------------------------   88277800
.***AI.L25  XCART CL8                                                   88327200
                      AIF   ('&ZXCART' EQ '').ZI13E  NOT USED           88376600
                      AIF   ('&ZXCART' EQ 'OUTPUT').ZI13E               88426000
&ZCGPR                SETC  '&XCART'                                    88475400
                      AIF   ('&XCART' NE 'NULL').ZI13A                  88524800
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI13E             88574200
.*                                                                      88623600
&ZCGPR                SETC  '=XL8''00'''                                88673000
.ZI13A                ANOP  ,                                           88722400
.*                                                                      88771800
                      AIF   ('&XCART'(1,1) NE '(').ZI13B  NOT GPR       88821200
&ZCGPR   SETC  '0('.'&XCART'(2,K'&XCART-2).')'                          88870600
.ZI13B                ANOP  ,                                           88920000
.*                                                                      88969400
&ZOPN                 SETA  &ZOPN+1                                     89018800
&ZOPL(&ZOPN)          SETC  ' '                                         89068200
&ZOPO(&ZOPN)          SETC  'MVC'                                       89117600
&ZOPV(&ZOPN)          SETC  '8(8,1),&ZCGPR'                             89167000
&ZOPD(&ZOPN)          SETC  '++ &ZXCART XCART CL8'                      89216400
.*                                                                      89265800
.ZI13E                ANOP  ,                                           89315200
.*-------------------------------------------------------------------   89364600
.***AI.L18  XMASK CL8                                                   89414000
                      AIF   ('&XMASK' NE 'NULL').ZI14  CK *             89463400
                      AIF   ('&XMFSCK' NE 'COMPLETE').ZI14  CK *        89512800
&ZXMASK               SETC  ''             RESET INPUT/OUTPUT           89562200
.ZI14                 ANOP  ,                                           89611600
.*-------------------------------------------------------------------   89661000
.***AI.L25  XMASK CL8                                                   89710400
                      AIF   ('&ZXMASK' EQ '').ZI14E  NOT USED           89759800
                      AIF   ('&ZXMASK' EQ 'OUTPUT').ZI14E               89809200
&ZCGPR                SETC  '&XMASK'                                    89858600
                      AIF   ('&XMASK' NE 'NULL').ZI14A                  89908000
                      AIF   ('&XMFSCK' EQ 'COMPLETE').ZI14E             89957400
.*                                                                      90006800
&ZCGPR                SETC  '=XL8''00'''                                90056200
.ZI14A                ANOP  ,                                           90105600
.*                                                                      90155000
                      AIF   ('&XMASK'(1,1) NE '(').ZI14B  NOT GPR       90204400
&ZCGPR   SETC  '0('.'&XMASK'(2,K'&XMASK-2).')'                          90253800
.ZI14B                ANOP  ,                                           90303200
.*                                                                      90352600
&ZOPN                 SETA  &ZOPN+1                                     90402000
&ZOPL(&ZOPN)          SETC  ' '                                         90451400
&ZOPO(&ZOPN)          SETC  'MVC'                                       90500800
&ZOPV(&ZOPN)          SETC  '16(8,1),&ZCGPR'                            90550200
&ZOPD(&ZOPN)          SETC  '++ &ZXMASK XMASK CL8'                      90599600
.*                                                                      90649000
.ZI14E                ANOP  ,                                           90698400
.*-------------------------------------------------------------------   90747800
.***AI.L25  XCONSID F                                                   90797200
                      AIF   ('&ZXCONSID' EQ '').ZI15E  NOT USED         90846600
                      AIF   ('&ZXCONSID' EQ 'OUTPUT').ZI15E             90896000
&ZCGPR                SETC  '&XCONSID'                                  90945400
.*                                                                      90994800
                      AIF   ('&XCONSID'(1,1) NE '(').ZI15B  NOT GPR     91044200
&ZCGPR   SETC  '0('.'&XCONSID'(2,K'&XCONSID-2).')'                      91093600
                      AGO   .ZI15D                                      91143000
.ZI15B                ANOP  ,                                           91192400
.*                                                                      91241800
&ZC                   SETC  '&XCONSID'(1,1)                             91291200
                      AIF   (T'&ZC NE 'N').ZI15D                        91340600
&ZCGPR                SETC  '=FL4''&XCONSID'''                          91390000
.*                                                                      91439400
.ZI15D                ANOP  ,                                           91488800
.*                                                                      91538200
&ZOPN                 SETA  &ZOPN+1                                     91587600
&ZOPL(&ZOPN)          SETC  ' '                                         91637000
&ZOPO(&ZOPN)          SETC  'MVC'                                       91686400
&ZOPV(&ZOPN)          SETC  '24(4,1),&ZCGPR'                            91735800
&ZOPD(&ZOPN)          SETC  '++ &ZXCONSID XCONSID F'                    91785200
.*                                                                      91834600
.ZI15E                ANOP  ,                                           91884000
.*-------------------------------------------------------------------   91933400
&ZOPN1                SETA &ZOPN                                        91982800
.*-------------------------------------------------------------------   92032200
.***AI.C00 MF=M CHECK TO BYPASS INVOCATION                              92081600
                      AIF   ('&XMF' EQ 'M').ZMFLX  DONE IF MF=M         92131000
.*******************************************************************    92180400
.***  PROCESS MCSOPMSG OUTPUT PARAMETERS                                92229800
.*******************************************************************    92279200
                      ACTR  10000                                       92328600
.*******************************************************************    92378000
.***AO.X02  RETURN CODE PROCESSING                                      92427400
.*******************************************************************    92476800
                      AIF   (N'&RTNCODE LE 0).ZMRETX                    92526200
                      AIF   ('&XRTNCODE'(1,1) EQ '(').ZMRET2            92575600
                      AIF   ('&XRTNCODE' EQ 'GPR15').ZMRETX             92625000
                      AIF   ('&XRTNCODE' EQ 'REG15').ZMRETX             92674400
                      AIF   ('&XRTNCODE' EQ 'R15').ZMRETX               92723800
                      AIF   ('&XRTNCODE' EQ '15').ZMRETX                92773200
&ZOPN                 SETA  &ZOPN+1                                     92822600
&ZOPL(&ZOPN)          SETC  ' '                                         92872000
&ZOPO(&ZOPN)          SETC  'ST'                                        92921400
&ZOPV(&ZOPN)          SETC  '15,&XRTNCODE'                              92970800
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        93020200
                      AGO   .ZMRETX                                     93069600
.*                                                                      93119000
.ZMRET2               ANOP  ,                                           93168400
&ZCGPR                SETC  '&XRTNCODE'(2,K'&XRTNCODE-2)                93217800
                      AIF   ('&ZCGPR' EQ 'GPR15').ZMRETX                93267200
                      AIF   ('&ZCGPR' EQ 'REG15').ZMRETX                93316600
                      AIF   ('&ZCGPR' EQ 'R15').ZMRETX                  93366000
                      AIF   ('&ZCGPR' EQ '15').ZMRETX                   93415400
&ZOPN                 SETA  &ZOPN+1                                     93464800
&ZOPL(&ZOPN)          SETC  ' '                                         93514200
&ZOPO(&ZOPN)          SETC  'LR'                                        93563600
&ZOPV(&ZOPN)          SETC  '&ZCGPR,15'                                 93613000
&ZOPD(&ZOPN)          SETC  '++ SET RETURN CODE'                        93662400
.ZMRETX               ANOP  ,                                           93711800
.*******************************************************************    93761200
.***AO.X03  REASON CODE PROCESSING                                      93810600
.*******************************************************************    93860000
                      AIF   (N'&RSNCODE LE 0).ZMRSNX                    93909400
                      AIF   ('&XRSNCODE'(1,1) EQ '(').ZMRSN2            93958800
                      AIF   ('&XRSNCODE' EQ 'GPR0').ZMRSNX              94008200
                      AIF   ('&XRSNCODE' EQ 'GPR00').ZMRSNX             94057600
                      AIF   ('&XRSNCODE' EQ 'REG0').ZMRSNX              94107000
                      AIF   ('&XRSNCODE' EQ 'REG00').ZMRSNX             94156400
                      AIF   ('&XRSNCODE' EQ 'R0').ZMRSNX                94205800
                      AIF   ('&XRSNCODE' EQ '0').ZMRSNX                 94255200
                      AIF   ('&XRSNCODE' EQ '00').ZMRSNX                94304600
&ZOPN                 SETA  &ZOPN+1                                     94354000
&ZOPL(&ZOPN)          SETC  ' '                                         94403400
&ZOPO(&ZOPN)          SETC  'ST'                                        94452800
&ZOPV(&ZOPN)          SETC  '0,&XRSNCODE'                               94502200
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        94551600
                      AGO   .ZMRSNX                                     94601000
.*                                                                      94650400
.ZMRSN2               ANOP  ,                                           94699800
&ZCGPR                SETC  '&XRSNCODE'(2,K'&XRSNCODE-2)                94749200
                      AIF   ('&ZCGPR' EQ 'GPR0').ZMRSNX                 94798600
                      AIF   ('&ZCGPR' EQ 'GPR00').ZMRSNX                94848000
                      AIF   ('&ZCGPR' EQ 'REG0').ZMRSNX                 94897400
                      AIF   ('&ZCGPR' EQ 'REG00').ZMRSNX                94946800
                      AIF   ('&ZCGPR' EQ 'R0').ZMRSNX                   94996200
                      AIF   ('&ZCGPR' EQ '0').ZMRSNX                    95045600
                      AIF   ('&ZCGPR' EQ '00').ZMRSNX                   95095000
&ZOPN                 SETA  &ZOPN+1                                     95144400
&ZOPL(&ZOPN)          SETC  ' '                                         95193800
&ZOPO(&ZOPN)          SETC  'LR'                                        95243200
&ZOPV(&ZOPN)          SETC  '&ZCGPR,0'                                  95292600
&ZOPD(&ZOPN)          SETC  '++ SET REASON CODE'                        95342000
.ZMRSNX               ANOP  ,                                           95391400
.*******************************************************************    95440800
.***AO.X04  LABEL FOR MF=L PROCESSING                                   95490200
.*******************************************************************    95539600
.ZMFLX                ANOP  ,              MF=L PROCESSING              95589000
.*******************************************************************    95638400
.***AO.X05  FORMAT GENERATED INSTRUCTIONS                               95687800
.*******************************************************************    95737200
                      ACTR  10000                                       95786600
.*                                                                      95836000
                      LCLA  &ZLC           COLUMN POSITION              95885400
                      LCLA  &ZOPX          LIST TABLE INDEX             95934800
                      LCLC  &ZLL           LABEL                        95984200
                      LCLC  &ZLOP          OPERATION                    96033600
                      LCLC  &ZLV           VALUE                        96083000
                      LCLC  &ZLD           DESCRIPTION                  96132400
.*                                                                      96181800
&ZOPX                 SETA  1                                           96231200
.ZL2                  AIF   (&ZOPX GT &ZOPN1).ZLX  B IF DONE            96280600
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              96330000
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              96379400
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              96428800
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              96478200
                      AIF   (K'&ZLD LE 0).ZL5                           96527600
&ZLC                  SETA  35             COMMENT COLUMN               96577000
                      AIF   ('&ZLD'(1,1) NE '*').ZL3                    96626400
&ZLC                  SETA  33             COMMMENT COLUMN              96675800
.ZL3                  AIF   (K'&ZLV GE &ZLC-16-1).ZL4                   96725200
&ZLV                  SETC  '&ZLV'.' '                                  96774600
                      AGO   .ZL3                                        96824000
.*                                                                      96873400
.ZL4                  ANOP  ,                                           96922800
&ZLV                  SETC  '&ZLV'.' '                                  96972200
.ZL5                  ANOP  ,                                           97021600
&ZLV                  SETC  '&ZLV'.'&ZLD'                               97071000
.*                                                                      97120400
&ZLL     &ZLOP &ZLV                                                     97169800
.*                                                                      97219200
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               97268600
                      AGO   .ZL2           CONTINUE LOOPING             97318000
.*                                                                      97367400
.ZLX                  ANOP  ,                                           97416800
                      AIF   ('&XMF' EQ 'L').ZLINKX  MF=L                97466200
                      AIF   ('&XMF' EQ 'M').ZLINKX  MF=M                97515600
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  97565000
         L     15,16              GET ADDRESS OF CVT FROM PSA           97614400
         L     15,772(15)         GET ADDRESS OF SFT FROM CVT           97663800
         LA    14,6               GET MCSOPMSG INDEX INTO LINKAGE TABLE 97713200
         AL    14,100(15)         POINT REG14 TO MCSOPMSG ETD ENTRY     97762600
         PC    0(14)              PC TO MCSOPMSG SERVICE                97812000
.*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*  97861400
.ZLINKX               ANOP  ,                                           97910800
.*******************************************************************    97960200
.***AP.X01  FORMAT GENERATED CODE                                       98009600
.ZL21                 AIF   (&ZOPX GT &ZOPN).ZLX1  B IF DONE            98059000
&ZLL                  SETC  '&ZOPL(&ZOPX)'                              98108400
&ZLOP                 SETC  '&ZOPO(&ZOPX)'                              98157800
&ZLV                  SETC  '&ZOPV(&ZOPX)'                              98207200
&ZLD                  SETC  '&ZOPD(&ZOPX)'                              98256600
                      AIF   (K'&ZLD LE 0).ZL51                          98306000
&ZLC                  SETA  35             COMMENT COLUMN               98355400
                      AIF   ('&ZLD'(1,1) NE '*').ZL31                   98404800
&ZLC                  SETA  33             COMMENT COLUMN               98454200
.ZL31                 AIF   (K'&ZLV GE &ZLC-16-1).ZL41                  98503600
&ZLV                  SETC  '&ZLV'.' '                                  98553000
                      AGO   .ZL31                                       98602400
.*                                                                      98651800
.ZL41                 ANOP  ,                                           98701200
&ZLV                  SETC  '&ZLV'.' '                                  98750600
.ZL51                 ANOP  ,                                           98800000
&ZLV                  SETC  '&ZLV'.'&ZLD'                               98849400
.*                                                                      98898800
&ZLL     &ZLOP &ZLV                                                     98948200
.*                                                                      98997600
&ZOPX                 SETA  &ZOPX+1        NEXT STRUCTURE               99047000
                      AGO   .ZL21          CONTINUE LOOPING             99096400
.*                                                                      99145800
.ZLX1                 ANOP  ,                                           99195200
.*******************************************************************    99244600
.***AP.X02  END OF MCSOPMSG MACRO                                       99294000
&ZMCSOPMSG            SETC  'YES'          SET MCSOPMSG USED            99343400
         POP   PRINT                                                    99392800
*                                            MCSOPMSG-1                 99442200
         SPACE 1                                                        99491600
.ZLX2                 ANOP  ,                                           99541000
         MEND                                                           99590400
**********************************************************************/ 99639800
*/*PB.OC01 INVOKE MACRO---------------------------------------------*/  99689200
*%MCSOPMSG: MACRO KEYS(REQUEST,CMDRESP,CART,MASK,CONSID,RTNCODE,        99738600
*                 RSNCODE,MF);                                          99788000
*  ANS('?'||MACLABEL||' '||'MCSOPMSP '||MACLIST||                       99837400
*         ' '||MACKEYS||';') COL(MACLMAR);                              99886800
*%END MCSOPMSG;                                                         99936200
