*/********START OF SPECIFICATIONS*************************************/ 00050000
*/*                                                                  */ 00100000
*/* $MAC(RACINIT) COMP(SC1BN) PROD(RACF):                            */ 00150000
*/*                                                                  */ 00200000
*/* DESCRIPTIVE NAME = RACF USER INITIALIZATION INTERFACE            */ 00250000
*/*                                                                  */ 00300000
*/*                                                                  */ 00350000
*/***PROPRIETARY_STATEMENT********************************************/ 00400000
*/*                                                                  */ 00450000
*/*                                                                  */ 00700000
*/* LICENSED MATERIALS - PROPERTY OF IBM                             */ 00711100
*/* THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      */ 00722200
*/* 5655-068 (C) COPYRIGHT IBM CORP. 1980, 1993                      */ 00733300
*/* SEE COPYRIGHT INSTRUCTIONS                                       */ 00744400
*/*                                                                  */ 00755500
*/* STATUS= HBB5510                                                  */ 00766600
*/*                                                              @M6C*/ 00777700
*/***END_OF_PROPRIETARY_STATEMENT*************************************/ 00788800
*/*                                                                  */ 00800000
*/* FUNCTIONAL DESCRIPTION = THIS MACRO PROVIDES THE INTERFACE TO THE*/ 00850000
*/*         RACF USER INITIALIZATION SVC ROUTINE, IGC00131.  IT IS   */ 00900000
*/*         USABLE ONLY BY AUTHORIZED PROGRAMS AND MAY BE ISSUED BOTH*/ 00950000
*/*         IN BAL AND PL/S.                                         */ 01000000
*/*                                                                  */ 01050000
*/*         INPUT TO THE RACINIT SVC ROUTINE PROVIDED BY THIS MACRO  */ 01100000
*/*         CONSISTS OF THE ADDRESS OF A PARAMETER LIST IN REGISTER  */ 01150000
*/*         ONE.  OUTPUT CONSISTS OF A RETURN CODE IN  REG 15.       */ 01200000
*/*                                                                  */ 01250000
*/*         NOTE: THE LOC AND ENVIR=VERIFY KEYWORDS ARE AVAILABLE    */ 01300000
*/*         ONLY WHEN THE RACINIT MACRO IS INVOKED BY THE RACROUTE   */ 01350000
*/*         MACRO.  OTHERWISE, USE OF THIS KEYWORD PRODUCES AN       */ 01400000
*/*         MNOTE.                                               @L7A*/ 01450000
*/*                                                                  */ 01500000
*/* MACROS = IHBINNRA                                                */ 01550000
*/*                                                                  */ 01600000
*/* CHANGE ACTIVITY:                                                 */ 01650000
*/*   RACF VERSION 1 RELEASE 3                               @PC003PY*/ 01700000
*/*   OZ57241                                                @ZA57241*/ 01750000
*/*   $T1=UZ90211,SAF/RF15,810702,CNTDSD:                        @T1A*/ 01800000
*/*   $L6=HRF1602,RACF/160,830307,CNTDSD:                        @L6A*/ 01850000
*/*   UZ90283                                                @ZA90283*/ 01900000
*/*   UZ90284                                                @ZA90284*/ 01950000
*/*   UZ90285                                                @ZA90285*/ 02000000
*/*   $L7=HRF1702,RACF/170,840531,CNTDSD:                        @L7A*/ 02050000
*/*   OY09590                                                @YA09590*/ 02100000
*/*   $L8=HRF1802,RACF/180,870323,CNTDSD:                        @L8A*/ 02150000
*/*   $M1=MVSB1   RACF/190 880328 PDI_H1: MVS B1 SECURITY        @M1A*/ 02200000
*/*   $P1=PGW0002 RACF/190 880428 PDI_H1: SUPPORT FOR PGW0002    @P1A*/ 02250000
*/*   $M2=MVSB1   RACF/190 880428 PDV_Z1: MVS B1 SECURITY        @M2A*/ 02300000
*/*   $P2=PGW0012 RACF/190 880428 PDI_H1: SUPPORT FOR PGW0012    @P2A*/ 02350000
*/*   $P3=PGW0010 RACF/190 880615 PDI_H1: SUPPORT FOR PGW0010    @P3A*/ 02400000
*/*   $P4=PGW0020 RACF/190 880615 PDI_H1: SUPPORT FOR PGW0020    @P4A*/ 02450000
*/*   $D1=DCR0044 RACF/190 880615 PDPWB1: DCR 44                 @D1A*/ 02500000
*/*   $D2=DCR0045 RACF/190 890201 PDPWB1: DCR 45                 @D2A*/ 02550000
*/*   $D3=DGU0061 RACF/190 890201 PDRTS1: DCR 61                 @D3A*/ 02600000
*/*   $P5=PGW0058 RACF/190 890308 PDPWB1: SUPPORT FOR PGW0058    @P5A*/ 02650000
*/*   $D4=DGU0080 RACF/190 890310 PDI_H1: DCR 80                 @D4A*/ 02700000
*/*   $P6=PGW0059 RACF/190 890308 PDPWB1: SUPPORT FOR PGW0059    @P6A*/ 02750000
*/*   $P7=PGW0060 RACF/190 890412 PDI_H1: SUPPORT FOR PGW0060    @P7A*/ 02800000
*/*   $D5=DGU0091 RACF/190 890517 PDGTM1: DCRR # DGU0091         @D5A*/ 02850000
*/*   $D6=DGU0099 RACF/190 890614 PDGTM1: DCRR # DGU0099         @D6A*/ 02900000
*/*   $P8=PGP0401 RACF/190 890721 PDPWB1: SUPPORT FOR PGP0401    @P8A*/ 02950000
*/*   $P9=PGP0360 RACF/190 890721 PDB_S1: SUPPORT FOR PGP0360    @P9A*/ 03000000
*/*                   OY24122                                @YA24122*/ 03050000
*/*   $Q1=PGP0611 RACF/190 890920 PDB_S1: SUPPORT FOR PGP0611    @Q1A*/ 03100000
*/*   $D7=TI90003 RACF/190 891020 PDRTS1: DCRR # DGU0112         @D7A*/ 03150000
*/*   $M3=APPCSPE RACF/190 900625 PDFJH1: SUPPORT FOR MVS 4.2    @M3A*/ 03200000
*/*   $M4=APPC    RACF/192 900904 PDTGL:  SUPPORT FOR APPC       @M4A*/ 03250000
*/*   $M5=APPC    RACF/192 901008 PDTGL:  SUPPORT FOR APPC       @M5A*/ 03300000
*/*   $Q2=PJA0029 RACF/192 910524 PDPSB1: SUPPORT FOR PJA0029    @Q2A*/ 03330000
*/*   $01=OY47989 RACF/190 911012 PDDLR1: PE of OY43556          @01A*/ 03360000
*/*   $M6=OW04015 RACF/210 930426 PDKAF1: SUPPORT FOR RACF 2.1   @M6A*/ 03390000
*/*   $M7=OW10709 RACF/220 940510 PDJMV1: SUPPORT FOR RACF 2.2   @M7A*/ 03420000
*/*                                                                  */ 03450000
*/*                                                                  */ 03500000
*/* CHANGE DESCRIPTIONS:                                             */ 03550000
*/*   A000000-999999                                         @PC001PY*/ 03600000
*/*   A - SUPPORT FOR KEYWORDS NEW FOR MVS B1 SECURITY           @M1A*/ 03650000
*/*   A - SUPPORT FOR MF=M                                       @P1A*/ 03700000
*/*   A - SUPPORT FOR REMOTE= KEYWORD                            @M2A*/ 03750000
*/*   A - RELEASE 1.9 OR HIGHER FOR RELEASE 1.9 KEYWORDS         @P2A*/ 03800000
*/*   D - REGISTER BOUNDS CHECKING                               @P3A*/ 03850000
*/*   A - SKIP 1.9 KEYWORDS IF RELEASE=1.8                       @P4A*/ 03900000
*/*   A - SET REMOTE/TRUSTED SPECIFIED INDICATORS - DCR0044      @D1A*/ 03950000
*/*   A - ADD TOKNIN/TOKNOUT, REMOVE UTOKEN       - DCR0045      @D2A*/ 04000000
*/*   A - NEW SESSION FOR VERIFYX TO CREATE UNKNOWN USER TOKEN.  @D3A*/ 04050000
*/*   A - SUPPORT FOR SESSION=INTBATCH, EXTBATCH, RJEBATCH,      @D4A*/ 04100000
*/*       AND NJEBATCH                                               */ 04150000
*/*   A - DON'T GENERATE CONSTANTS IN THE MIDDLE OF THE PLIST    @P5A*/ 04200000
*/*   A - DON'T BAL INTO THE PLIST ON MF=S                       @P6A*/ 04250000
*/*   A - CORRECT ERROR MESSAGE FOR REQUEST=VERIFYX RELEASE=1.8  @P7A*/ 04300000
*/*   A - SUPPORT FOR SESSION=NJSYSOUT AND SESSION=NJEBATCH      @D5A*/ 04350000
*/*   C - CHANGE SESSION=NJEUNKN TO SESSION=TKNUNKWN             @D6A*/ 04400000
*/*   C - CORRECT CHANGE ACTIVITY FOR DCR 44 AND DCR 45          @P8A*/ 04450000
*/*   A - SUPPORT TO VALIDATE SUBPOOL                            @P9A*/ 04500000
*/*   C - '&RELEASE' TO '&RELEASE'(1,3) FOR LOGICAL COMPARISON   @Q1A*/ 04550000
*/*       WITH '1.9'                                             @Q1A*/ 04600000
*/*   A - SUPPORT FOR SESSION=INTXBM, EXTXBM, RJEXBM, & NJEXBM.  @D7A*/ 04650000
*/*   A - RACF 1.9 SPE - BASE APPC SUPPORT                       @M3A*/ 04700000
*/*   A - APPC SUPPORT                                           @M4A*/ 04750000
*/*   A - HAVE THE PRESENCE OF TOKNIN SET THE INDICATOR THAT A   @M5A*/ 04800000
*/*       PARAMETER HAS BEEN SPECIFIED THAT IS NOT COMPATIBLE    @M5A*/ 04850000
*/*       WITH SYSTEM=YES.                                       @M5A*/ 04900000
*/*   C - STATUS TO CORRECTLY CORRESPOND TO MVS LEVEL            @Q2A*/ 04925000
*/*   C - Ship code for cover letter error                       @01A*/ 04950000
*/*   A - ALLOW RELEASE=2.1 TO BE SPECIFIED                      @M6A*/ 04975000
*/*   A - ALLOW RELEASE=2.2 TO BE SPECIFIED                      @M7A*/ 05000000
*/* @D62CDHH: VSE/ESA COMPATIBILITY WITH MVS/ESA             @D62CDHH*/ 05025000
*/*                                                                  */ 05050000
*/*************END OF SPECIFICATIONS**********************************/ 05100000
*%/* BILINGUAL HEADER                                                   05150000
         MACRO                                                          05200000
&SYMBOL  RACINIT &USERID=,&START=,&PASSWRD=,&GROUP=,&INSTLN=,          *05250000
               &NEWPASS=,&ENVIR=,&MF=S,&PGMNAME=,&ACTINFO=,            *05300000
               &OIDCARD=,&TERMID=,&JOBNAME=,                           *05350000
               &APPL=,&ACEE=,&SMC=,&SUBPOOL=,&PASSCHK=,            @L6A*05400000
               &ENCRYPT=,&STAT=,&LOG=,&LOC=,&RELEASE=,             @L7A*05450000
               &TOKNIN=,                                           @D2C*05500000
               &TOKNOUT=,                                          @D2A*05550000
               &STOKEN=,                                           @M1A*05600000
               &SECLABL=,                                          @M1A*05650000
               &EXENODE=,                                          @M1A*05700000
               &SNODE=,                                            @M1A*05750000
               &SUSERID=,                                          @M1A*05800000
               &SGROUP=,                                           @M1A*05850000
               &POE=,                                              @M1A*05900000
               &LOGSTR=,                                           @M1A*05950000
               &SESSION=,                                          @M1A*06000000
               &REMOTE=,                                           @P3C*06050000
               &TRUSTED=,                                          @M4C*06100000
               &ENVRIN=,                                           @M4A*06150000
               &ENVROUT=                                           @M4A 06200000
         LCLA  &BIT0,&BIT1,&BIT2,&BIT3,&BIT4,&BIT5,&BIT6,&BIT7     @L6A 06250000
         LCLA  &BIX0,&BIX1,&BIX2,&BIX3,&BIX4,&BIX5,&BIX6,&BIX7     @L6A 06300000
         LCLB  &MFFLAG                                                  06350000
         LCLC  &NAME,&NAME2,&MVALUE                                @M1A 06400000
         LCLA  &OFFSET                                             @P4A 06450000
         LCLA  &PARMLEN                                        @YA24122 06500000
         LCLB  &RLVLCHK                                        @YA24122 06550000
.* DEFINE GLOBAL SET SYMBOLS                                       @T1A 06600000
         GBLB  &ICHRAC               ICHRAC - A FLAG WHICH, WHEN   @T1A 06650000
.*                                   ON, INDICATES THAT THIS MACRO @T1A 06700000
.*                                   IS BEING INVOKED INTERNALLY   @T1A 06750000
.*                                   BY THE RACROUTE MACRO.        @T1A 06800000
         GBLC  &ICHL                 SETS ADDRESSABILITY TO THE    @T1A 06850000
.*                                   PARAMETER LIST FOR THE        @T1A 06900000
.*                                   RACROUTE MACRO.               @T1A 06950000
         GBLC  &ICHRLVL              SYMBOL TO BRANCH TO WHEN      @L7A 07000000
.*                                   INCOMPATIBLE MACRO LEVEL.     @L7A 07050000
&NAME    SETC  'ICH0&SYSNDX'                                            07100000
&PARMLEN SETA  56                    DEFAULT LIST LENGTH       @YA24122 07150000
&OFFSET  SETA  60                    POINT BEYOND LIST         @YA24122 07200000
         AIF   ('&RELEASE(1)' EQ '').LENEND                        @Q1A 07250000
         AIF   ('&RELEASE(1)'(1,3) GE '1.9').LEN19                 @Q1C 07300000
         AGO   .LENEND                                             @P4A 07350000
.LEN19   ANOP                                                      @P4A 07400000
         AIF   ('&RELEASE(1)' NE '1.9').LEN192                     @M4C 07450000
&PARMLEN SETA  100                   SET TO 1.9 PLIST LENGTH   @YA24122 07500000
&OFFSET  SETA  104                   POINT BEYOND LIST             @P6C 07550000
.*                                                                 @M4A 07600000
.LEN192  ANOP                                                      @M4A 07650000
         AIF   ('&RELEASE(1)' NE '1.9.2').LEN210                   @M6C 07700000
&PARMLEN SETA  108                   SET TO 1.9.2. PLIST LENGTH    @M4A 07750000
&OFFSET  SETA  112                   POINT BEYOND LIST             @M4A 07800000
.*                                                                 @M4A 07850000
.LEN210  ANOP                                                      @M6A 07854500
         AIF   ('&RELEASE(1)' NE '2.1').LEN220                     @M7C 07859000
&PARMLEN SETA  108                   SET TO 2.1 PLIST LENGTH       @M6A 07863500
&OFFSET  SETA  112                   POINT BEYOND LIST             @M6A 07868000
.*                                                                 @M6A 07872500
.LEN220  ANOP                                                      @M6A 07877000
         AIF   ('&RELEASE(1)' NE '2.2').LENEND                     @M7A 07881500
&PARMLEN SETA  108                   SET TO 2.2 PLIST LENGTH       @M7A 07886000
&OFFSET  SETA  112                   POINT BEYOND LIST             @M7A 07890500
.*                                                                 @M7A 07895000
.LENEND  ANOP                                                      @P4A 07900000
.* PERFORM PARAMETER ANALYSIS AND DIAGNOSIS                             07950000
.* VALIDATE RELEASE PARAMETER                                      @L7A 08000000
         AIF   (&ICHRAC).RLVL01                                    @L7A 08050000
         AGO   .ERVSE1             NOT INVOKED BY RACROUTE     @D62CDHH 08075000
&ICHRLVL SETC  'ICH&SYSNDX.X'      CREATE LABEL FOR SVC BYPASS     @L7A 08100000
.RLVL01  ANOP                                                      @L7A 08150000
         AIF   ('&RELEASE' EQ '').ERLVL1R                          @L7A 08200000
         AIF   (N'&RELEASE GT 2).ERLVL1  INVALID RELEASE PARAMETER @L7A 08250000
         AIF   ('&RELEASE(1)' NE '1.6' AND '&RELEASE(1)' NE '1.7' AND  X08300000
               '&RELEASE(1)' NE '1.8' AND '&RELEASE(1)' NE '1.8.1' AND X08350000
               '&RELEASE(1)' NE '1.9' AND                              X08400000
               '&RELEASE(1)' NE '1.9.2' AND                            X08425000
               '&RELEASE(1)' NE '2.1'  AND                             X08450000
               '&RELEASE(1)' NE '2.2').ERLVL1                      @M7A 08475000
         AIF   (N'&RELEASE EQ 1).NORLVLC CHECK NOT SPECIFIED       @L7A 08500000
         AIF   ('&RELEASE(2)' NE 'CHECK').ERLVL1 INVALID VALUE     @L7A 08550000
         AIF   ('&MF(1)' NE 'E').ERLVL2 CHECK ONLY WITH MF=E       @L7A 08600000
&RLVLCHK SETB  1              INDICATE RELEASE-CHECK REQUESTED @YA24122 08650000
.ERLVL2R ANOP                                                      @L7A 08700000
.NORLVLC ANOP                                                      @L7A 08750000
.ERLVL1R ANOP                                                      @L7A 08800000
         AIF   ('&RELEASE(1)' EQ '').NOERR01                       @Q1A 08850000
         AIF   ('&RELEASE(1)'(1,3) GE '1.9' AND NOT &ICHRAC).ERR08 @Q1C 08900000
.NOERR01 ANOP                                                      @Q1A 08950000
.*                                                                 @L7A 09000000
.* PERFORM PARAMETER DIAGNOSIS                                          09050000
.*                                                                 @L7A 09100000
.* CHECK SPECIFIED PARAMETERS AGAINST RACF LEVEL                   @L7A 09150000
         AIF   ('&RELEASE(1)' GE '1.7').ERLVLAR                @YA09590 09200000
         AIF   (T'&LOC NE 'O' OR T'&LOG NE 'O' OR                      X09250000
               T'&STAT NE 'O' AND NOT &ICHRAC).ERLVLA              @L7A 09300000
.ERLVLAR ANOP                                                      @L7A 09350000
.* VALIDATE ENVIR PARAMETER                                             09400000
         AIF   ('&ENVIR' EQ 'DELETE' OR '&ENVIR' EQ '' OR              *09450000
               '&ENVIR' EQ 'CREATE' OR '&ENVIR' EQ 'CHANGE'  OR        *09500000
               '&ENVIR' EQ 'VERIFY').ERTN002                       @M1C 09550000
         AIF   ('&ENVIR' EQ 'VERIFYX').ERTN002                     @M1A 09600000
         AGO   .ERR002                                             @M1A 09650000
.ERTN002 ANOP                                                           09700000
.*  VERIFY ALLOWED ONLY IF RACINIT INVOKED FROM RACROUTE           @L6A 09750000
         AIF   ('&ENVIR' EQ 'VERIFY' AND NOT &ICHRAC).ERR07        @L6A 09800000
         AIF   ('&ENVIR' EQ 'VERIFYX' AND NOT &ICHRAC).ERR11       @M1A 09850000
&MVALUE  SETC  'REQUEST TYPE'                                      @P7C 09900000
         AIF   ('&ENVIR' NE 'VERIFYX').ERTN07                      @Q1A 09950000
         AIF   ('&RELEASE(1)' EQ '').ERR10                         @Q1A 10000000
         AIF   ('&RELEASE(1)'(1,3) LT '1.9').ERR10                 @Q1A 10050000
.ERTN07 ANOP   ,                                                   @L6A 10100000
         AIF   ('&SMC' NE 'YES' AND '&SMC' NE 'NO' AND                 *10150000
                '&SMC' NE '').ERR003                           @PC003PY 10200000
.ERTN003 ANOP                                                  @PC003PY 10250000
         AIF   ('&PASSCHK' NE 'YES' AND '&PASSCHK' NE 'NO' AND         *10300000
                '&PASSCHK' NE '').ERR004                       @PC003PY 10350000
.* VALIDATE STAT PARAMETER                                              10400000
.ERTN004 ANOP                                                  @PC003PY 10450000
         AIF   ('&STAT' NE 'ASIS' AND '&STAT' NE 'NO' AND              *10500000
               '&STAT' NE '').ERR005                               @L6A 10550000
.* VALIDATE ENCRYPT PARAMETER                                           10600000
.ERTN005 ANOP  ,                                                   @L6A 10650000
         AIF   ('&ENCRYPT' NE 'YES' AND                                *10700000
               '&ENCRYPT' NE '' AND                                    *10750000
               '&ENCRYPT' NE 'NO').ERR006                          @L6A 10800000
.* VALIDATE LOG PARAMETER                                          @L7A 10850000
.ERTN006 ANOP  ,                                                   @L6A 10900000
         AIF   ('&LOG' NE 'ASIS' AND '&LOG' NE 'ALL' AND               *10950000
               '&LOG' NE 'NONE' AND '&LOG' NE '').ERR007           @M4C 11000000
.ERTN007 ANOP  ,                                                   @L7A 11050000
.* VALIDATE LOC PARAMETER                                          @L7A 11100000
         AIF   ('&LOC' NE 'BELOW' AND '&LOC' NE 'ANY' AND '&LOC' NE    +11150000
               '').ERR008                                          @L7A 11200000
.ERTN008 ANOP  ,                                                   @L7A 11250000
.* LOC ALLOWED ONLY IF RACINIT INVOKED FROM RACROUTE               @L7A 11300000
         AIF   ('&LOC' NE '' AND NOT &ICHRAC).ERR009               @L7A 11350000
.ERTN009 ANOP  ,                                                   @L7A 11400000
.*------------------------------------------------------------*    @M2A 11450000
.* VALIDATE REMOTE= PARAMETER                                      @M2A 11500000
.*------------------------------------------------------------*    @M2A 11550000
         AIF   ('&REMOTE' NE 'YES' AND '&REMOTE' NE 'NO' AND           *11600000
               '&REMOTE' NE '').ERR012                             @M2A 11650000
.ERTN030 ANOP                                                      @M2A 11700000
.*------------------------------------------------------------*    @M1A 11750000
.* VALIDATE TRUSTED PARAMETER                                      @M1A 11800000
.*------------------------------------------------------------*    @M1A 11850000
         AIF   ('&TRUSTED' NE 'YES' AND '&TRUSTED' NE 'NO' AND         *11900000
               '&TRUSTED' NE '').ERR010                            @M1A 11950000
.ERTN010 ANOP                                                      @M1A 12000000
.*------------------------------------------------------------*    @M1A 12050000
.* VALIDATE SESSION PARAMETER                                      @M1A 12100000
.*------------------------------------------------------------*    @M1A 12150000
         AIF   ('&SESSION' EQ '').ERTN020                          @M1A 12200000
         AIF   ('&SESSION' NE 'SYSAS').SESS01                      @M1A 12250000
         AGO   .ERTN020                                            @M1A 12300000
.SESS01  ANOP                                                      @M1A 12350000
         AIF   ('&SESSION' NE 'COMMAND').SESS02                    @M1A 12400000
         AGO   .ERTN020                                            @M1A 12450000
.SESS02  ANOP                                                      @M1A 12500000
         AIF   ('&SESSION' NE 'CONSOPER').SESS03                   @M1A 12550000
         AGO   .ERTN020                                            @M1A 12600000
.SESS03  ANOP                                                      @M1A 12650000
         AIF   ('&SESSION' NE 'STARTED').SESS04                    @M1A 12700000
         AGO   .ERTN020                                            @M1A 12750000
.SESS04  ANOP                                                      @M1A 12800000
         AIF   ('&SESSION' NE 'MOUNT').SESS05                      @M1A 12850000
         AGO   .ERTN020                                            @M1A 12900000
.SESS05  ANOP                                                      @M1A 12950000
         AIF   ('&SESSION' NE 'TSO').SESS06                        @M1A 13000000
         AGO   .ERTN020                                            @D4D 13050000
.SESS06  ANOP                                                      @M1A 13100000
.SESS07  ANOP                                                      @M1A 13150000
         AIF   ('&SESSION' NE 'INTXBM').SESS7E                     @D7C 13200000
         AGO   .ERTN020                                            @M1A 13250000
.SESS7E  ANOP                                                      @D7A 13300000
         AIF   ('&SESSION' NE 'EXTXBM').SESS7R                     @D7A 13350000
         AGO   .ERTN020                                            @D7A 13400000
.SESS7R  ANOP                                                      @D7A 13450000
         AIF   ('&SESSION' NE 'RJEXBM').SESS7N                     @D7A 13500000
         AGO   .ERTN020                                            @D7A 13550000
.SESS7N  ANOP                                                      @D7A 13600000
         AIF   ('&SESSION' NE 'NJEXBM').SESS08                     @D7A 13650000
         AGO   .ERTN020                                            @D7A 13700000
.SESS08  ANOP                                                      @M1A 13750000
         AIF   ('&SESSION' NE 'RJEOPER').SESS09                    @M1A 13800000
         AGO   .ERTN020                                            @M1A 13850000
.SESS09  ANOP                                                      @M1A 13900000
         AIF   ('&SESSION' NE 'NJEOPER').SESS10                    @D3C 13950000
         AGO   .ERTN020                                            @D3A 14000000
.SESS10  ANOP                                                      @D3A 14050000
         AIF   ('&SESSION' NE 'TKNUNKWN').SESS11                   @D6C 14100000
         AGO   .ERTN020                                            @D4A 14150000
.SESS11  ANOP                                                      @D4A 14200000
         AIF   ('&SESSION' NE 'INTBATCH').SESS12                   @D4A 14250000
         AGO   .ERTN020                                            @D4A 14300000
.SESS12  ANOP                                                      @D4A 14350000
         AIF   ('&SESSION' NE 'EXTBATCH').SESS13                   @D4A 14400000
         AGO   .ERTN020                                            @D4A 14450000
.SESS13  ANOP                                                      @D4A 14500000
         AIF   ('&SESSION' NE 'RJEBATCH').SESS14                   @D4A 14550000
         AGO   .ERTN020                                            @D4A 14600000
.SESS14  ANOP                                                      @D4A 14650000
         AIF   ('&SESSION' NE 'NJEBATCH').SESS15                   @D5C 14700000
         AGO   .ERTN020                                            @D4A 14750000
.SESS15  ANOP                                                      @D5A 14800000
         AIF   ('&SESSION' NE 'NJSYSOUT').SESS16                   @M3C 14850000
         AGO   .ERTN020                                            @D4A 14900000
.SESS16  ANOP                                                      @M3A 14950000
         AIF   ('&SESSION' NE 'APPCTP').ERR011                     @M3A 15000000
.ERTN020 ANOP                                                      @M1A 15050000
         AIF   ('&TOKNIN&STOKEN&SECLABL&SNODE&SUSERID&SGROUP&POE&LOGSTR*15100000
               &EXENODE&SESSION&TOKNOUT' EQ '').ERTN021            @D2C 15150000
         AIF   (NOT &ICHRAC ).ERR08                                @P2A 15200000
         AIF   ('&RELEASE(1)' EQ '').ERR09                         @Q1A 15250000
         AIF   ('&RELEASE(1)'(1,3) LT '1.9').ERR09                 @Q1C 15300000
.ERTN021 ANOP                                                      @P2A 15350000
.* --------------------------------------------------------------- @P9A 15400000
.* VALIDATE THE VALUE OF THE SUBPOOL                               @P9A 15450000
.* --------------------------------------------------------------- @P9A 15500000
.*                                                                 @P9A 15550000
         AIF   ('&SUBPOOL' EQ '').NOSPCHK                          @P9A 15600000
         AIF   ('&SUBPOOL'(1,1) EQ '(').NOSPCHK                    @P9A 15650000
         AIF   (T'&SUBPOOL NE 'N').NOSPCHK                         @P9A 15700000
         AIF   ('&SUBPOOL' GT '255').ERR013                        @P9A 15750000
.ERTN013 ANOP                                                      @P9A 15800000
.NOSPCHK ANOP                                                      @P9A 15850000
.* --------------------------------------------------------------- @M4A 15900000
.* VALIDATE THE 1.9.2 KEYWORDS                                     @M4A 15950000
.* --------------------------------------------------------------- @M4A 16000000
         AIF   ('&ENVRIN&ENVROUT' EQ '').ERTN022                   @M4A 16050000
         AIF   (NOT &ICHRAC ).ERR08                                @M4A 16100000
         AIF   ('&RELEASE(1)' EQ '').ERR12                         @M4A 16150000
         AIF   ('&RELEASE(1)'(1,5) LT '1.9.2' AND                      X16183300
                '&RELEASE(1)'(1,1) LT '2').ERR12                   @M6C 16216600
.ERTN022 ANOP                                                      @M4A 16250000
         AIF   ('&LOG' NE 'NONE').ERTN023                          @M4A 16300000
         AIF   ('&RELEASE(1)' EQ '').ERR13                         @M4A 16350000
         AIF   ('&RELEASE(1)'(1,5) LT '1.9.2' AND                      X16383300
                '&RELEASE(1)'(1,1) LT '2').ERR13                   @M6C 16416600
.ERTN023 ANOP                                                      @M4A 16450000
.*                                                                 @P9A 16500000
.* REGISTER FORM OF ADDRESS PARAMETER NOT VALID WITH LIST FORM          16550000
         AIF   ('&MF' NE 'L').ERTN01                                    16600000
         AIF   ('&USERID' EQ '').RINT010                                16650000
         AIF   ('&USERID'(1,1) EQ '(').ERR01                            16700000
.RINT010 ANOP                                                           16750000
         AIF   ('&START' EQ '').RINT020                                 16800000
         AIF   ('&START'(1,1) EQ '(').ERR01                             16850000
.RINT020 ANOP                                                           16900000
         AIF   ('&PASSWRD' EQ '').RINT028                               16950000
         AIF   ('&PASSWRD'(1,1) EQ '(').ERR01                           17000000
.RINT028 ANOP                                                           17050000
         AIF   ('&INSTLN' EQ '').RINT030                                17100000
         AIF   ('&INSTLN'(1,1) EQ '(').ERR01                            17150000
.RINT030 ANOP                                                           17200000
         AIF   ('&GROUP' EQ '').RINT031                                 17250000
         AIF   ('&GROUP'(1,1) EQ '(').ERR01                             17300000
.RINT031 ANOP                                                           17350000
         AIF   ('&NEWPASS' EQ '').RINT032                               17400000
         AIF   ('&NEWPASS'(1,1) EQ '(').ERR01                           17450000
.RINT032 ANOP                                                           17500000
         AIF   ('&PGMNAME' EQ '').RINT033                               17550000
         AIF   ('&PGMNAME'(1,1) EQ '(').ERR01                           17600000
.RINT033 ANOP                                                           17650000
         AIF   ('&ACTINFO' EQ '').RINT034                      @PC002PY 17700000
         AIF   ('&ACTINFO'(1,1) EQ '(').ERR01                  @PC002PY 17750000
.RINT034 ANOP                                                  @PC002PY 17800000
         AIF   ('&OIDCARD' EQ '').RINT035                      @PC002PY 17850000
         AIF   ('&OIDCARD'(1,1) EQ '(').ERR01                  @PC002PY 17900000
.RINT035 ANOP                                                  @PC002PY 17950000
         AIF   ('&TERMID' EQ '').RINT036                       @PC002PY 18000000
         AIF   ('&TERMID'(1,1) EQ '(').ERR01                   @PC002PY 18050000
.RINT036 ANOP                                                  @PC002PY 18100000
         AIF   ('&JOBNAME' EQ '').RINT037                      @PM44591 18150000
         AIF   ('&JOBNAME'(1,1) EQ '(').ERR01                  @PM44591 18200000
.RINT037 ANOP                                                  @PM44591 18250000
         AIF   ('&APPL' EQ '').RINT038                         @PC003PY 18300000
         AIF   ('&APPL'(1,1) EQ '(').ERR01                     @PC003PY 18350000
.RINT038 ANOP                                                  @PC003PY 18400000
         AIF   ('&ACEE' EQ '').RINT039                         @PC003PY 18450000
         AIF   ('&ACEE'(1,1) EQ '(').ERR01                     @PC003PY 18500000
.RINT039 ANOP                                                  @PC003PY 18550000
         AIF   ('&SUBPOOL' EQ '').RINT03A                          @M1C 18600000
         AIF   ('&SUBPOOL'(1,1) EQ '(').ERR01                      @M1C 18650000
.RINT03A ANOP                                                      @M1A 18700000
         AIF   ('&TOKNIN' EQ '').RINT03B                           @D2C 18750000
         AIF   ('&TOKNIN'(1,1) EQ '(').ERR01                       @D2C 18800000
.RINT03B ANOP                                                      @M1A 18850000
         AIF   ('&STOKEN' EQ '').RINT03C                           @M1A 18900000
         AIF   ('&STOKEN'(1,1) EQ '(').ERR01                       @M1A 18950000
.RINT03C ANOP                                                      @M1A 19000000
         AIF   ('&SECLABL' EQ '').RINT03D                          @M1A 19050000
         AIF   ('&SECLABL'(1,1) EQ '(').ERR01                      @M1A 19100000
.RINT03D ANOP                                                      @M1A 19150000
         AIF   ('&EXENODE' EQ '').RINT03E                          @M1A 19200000
         AIF   ('&EXENODE'(1,1) EQ '(').ERR01                      @M1A 19250000
.RINT03E ANOP                                                      @M1A 19300000
         AIF   ('&SNODE' EQ '').RINT03F                            @M1A 19350000
         AIF   ('&SNODE'(1,1) EQ '(').ERR01                        @M1A 19400000
.RINT03F ANOP                                                      @M1A 19450000
         AIF   ('&SUSERID' EQ '').RINT03G                          @M1A 19500000
         AIF   ('&SUSERID'(1,1) EQ '(').ERR01                      @M1A 19550000
.RINT03G ANOP                                                      @M1A 19600000
         AIF   ('&SGROUP' EQ '').RINT03H                           @M1A 19650000
         AIF   ('&SGROUP'(1,1) EQ '(').ERR01                       @M1A 19700000
.RINT03H ANOP                                                      @M1A 19750000
         AIF   ('&POE' EQ '').RINT03I                              @M1A 19800000
         AIF   ('&POE'(1,1) EQ '(').ERR01                          @M1A 19850000
.RINT03I ANOP                                                      @M1A 19900000
         AIF   ('&LOGSTR' EQ '').RINT03J                           @M1A 19950000
         AIF   ('&LOGSTR'(1,1) EQ '(').ERR01                       @M1A 20000000
.RINT03J ANOP                                                      @P3D 20050000
         AIF   ('&TOKNOUT' EQ '').RINT03K                          @D2A 20100000
         AIF   ('&TOKNOUT'(1,1) EQ '(').ERR01                      @D2A 20150000
.RINT03K ANOP                                                      @D2A 20200000
         AIF   ('&ENVRIN' EQ '').RINT03L                           @M4A 20250000
         AIF   ('&ENVRIN'(1,1) EQ '(').ERR01                       @M4A 20300000
.RINT03L ANOP                                                      @M4A 20350000
         AIF   ('&ENVROUT' EQ '').RINT03M                          @M4A 20400000
         AIF   ('&ENVROUT'(1,1) EQ '(').ERR01                      @M4A 20450000
.RINT03M ANOP                                                      @M4A 20500000
.ERTN01  ANOP                                                           20550000
.ERTN02  ANOP                                                           20600000
.* CHECK FOR INVALID COMBINATIONS OF ENVIR PARAMETER                    20650000
         AIF   ('&ENVIR' EQ '' OR '&ENVIR' EQ 'CREATE').RINT080         20700000
         AIF   ('&ENVIR' EQ 'VERIFYX').RINT080                     @M1A 20750000
         AIF   ('&ENVIR' NE 'VERIFY').RINT072                      @L6A 20800000
&NAME2   SETC  'ACEE'                                              @L6A 20850000
         AIF   ('&ACEE' NE '').ERR05                               @L6A 20900000
         AGO   .RINT080                                            @L6A 20950000
.RINT072 ANOP  ,                                                   @L6A 21000000
&NAME2   SETC  'USERID'                                                 21050000
         AIF   ('&USERID' NE '').ERR05                                  21100000
&NAME2   SETC  'PASSWRD'                                                21150000
         AIF   ('&PASSWRD' NE '').ERR05                                 21200000
&NAME2   SETC  'START'                                                  21250000
         AIF   ('&START' NE '').ERR05                                   21300000
&NAME2   SETC  'NEWPASS'                                                21350000
         AIF   ('&NEWPASS' NE '').ERR05                                 21400000
&NAME2   SETC  'PGMNAME'                                       @PC002PY 21450000
         AIF   ('&PGMNAME' NE '').ERR05                        @PC002PY 21500000
&NAME2   SETC  'ACTINFO'                                       @PC002PY 21550000
         AIF   ('&ACTINFO' NE '').ERR05                        @PC002PY 21600000
&NAME2   SETC  'OIDCARD'                                       @PC002PY 21650000
         AIF   ('&OIDCARD' NE '').ERR05                        @PC002PY 21700000
&NAME2   SETC  'TERMID'                                        @PC002PY 21750000
         AIF   ('&TERMID' NE '').ERR05                         @PC002PY 21800000
&NAME2   SETC  'JOBNAME'                                       @PM44591 21850000
         AIF   ('&JOBNAME' NE '').ERR05                        @PM44591 21900000
&NAME2   SETC  'ENVRIN'                                            @M4A 21950000
         AIF   ('&ENVRIN' NE '').ERR05                             @M4A 22000000
&NAME2   SETC  'ENVROUT'                                           @M4A 22050000
         AIF   ('&ENVROUT' NE '').ERR05                            @M4A 22100000
&NAME2   SETC  'GROUP'                                                  22150000
         AIF   ('&ENVIR' EQ 'CHANGE').RINT080                           22200000
         AIF   ('&GROUP' NE '').ERR05                                   22250000
.RINT080 ANOP                                                           22300000
.ERTN05  ANOP                                                           22350000
.* PRODUCE LIST FORM IF REQUESTED                                       22400000
         AIF   ('&MF' NE 'L').RINT175                                   22450000
&SYMBOL  DS    0F                                                       22500000
&NAME    EQU   *                                                        22550000
.RINT090 ANOP                                                           22600000
.* PRODUCE LIST FORM                                                    22650000
&ICHL    DC    AL1(&PARMLEN)    LIST LENGTH                    @YA24122 22700000
         AIF   ('&SUBPOOL' EQ '').RINT091                      @PC003PY 22750000
         AIF   ('&SUBPOOL'(1,1) EQ '(').RINT091                @PC003PY 22800000
         DC    AL1(&SUBPOOL)  - SUBPOOL NUMBER                 @PC003PY 22850000
&BIT3    SETA  1                SUBPOOL SPECIFIED              @PC003PY 22900000
         AGO   .RINT092                                        @PC003PY 22950000
.RINT091 ANOP                                                  @PC003PY 23000000
         DC    AL1(0)           NO SUBPOOL SPECIFIED           @PC003PY 23050000
&BIT3    SETA  0                SUBPOOL NOT SPECIFIED          @PC003PY 23100000
.RINT092 ANOP                                                  @PC003PY 23150000
.* PRODUCE FLAG BYTE 0                                             @L7A 23200000
&BIT0    SETA  0                                                   @L7A 23250000
&BIT1    SETA  0                                                   @L7A 23300000
&BIT4    SETA  0                                                   @M4A 23350000
&BIT5    SETA  0                                                   @M4A 23400000
         AIF   ('&LOC' EQ '').RINT094                              @L7A 23450000
         AIF   ('&LOC' NE 'BELOW').RINT093                         @L7A 23500000
&BIT0    SETA  1               LOC=BELOW SPECIFIED                 @L7A 23550000
         AGO   .RINT094                                            @L7A 23600000
.RINT093 ANOP                                                      @L7A 23650000
&BIT1    SETA  1               LOC=ANY SPECIFIED                   @L7A 23700000
.RINT094 ANOP                                                      @L7A 23750000
.*                                                                 @M4A 23800000
.* CHECK FOR PARAMETERS THAT ARE NOT SUPPORTED FOR SYSTEM=YES.     @M4A 23850000
.* IF ANY ARE PRESENT SET A BIT TO INDICATE THIS.                  @M4A 23900000
.*                                                                 @M4A 23950000
         AIF   ('&NEWPASS&OIDCARD&STOKEN&SNODE&SUSERID&SGROUP&EXENODE&J*24000000
               OBNAME&REMOTE&TOKNIN' EQ '').RIN192A                @M5C 24050000
&BIT4    SETA  1                                                   @M4A 24100000
.RIN192A ANOP                                                      @M4A 24150000
.*                                                                 @M4A 24200000
.* CHECK FOR LOG=NONE                                              @M4A 24250000
.*                                                                 @M4A 24300000
         AIF   ('&LOG' NE 'NONE').RIN192B                          @M4A 24350000
&BIT5    SETA  1                                                   @M4A 24400000
.RIN192B ANOP                                                      @M4A 24450000
         DC    B'&BIT0&BIT1.00&BIT4&BIT5.00'                       @M4C 24500000
.* PRODUCE FLAG BYTE 1 FROM ENVIR PARAMETER                             24550000
&BIT0    SETA  0                                                        24600000
&BIT1    SETA  0                                                        24650000
&BIT2    SETA  0                                               @PC003PY 24700000
&BIT4    SETA  0                                               @PC003PY 24750000
&BIT5    SETA  0                                                   @L6A 24800000
&BIT6    SETA  0                                                   @L6A 24850000
&BIT7    SETA  0                                                   @L6A 24900000
         AIF   ('&ENVIR' EQ '' OR '&ENVIR' EQ 'CREATE').RINT101         24950000
&BIT1    SETA  1                                                        25000000
         AIF   ('&ENVIR' EQ 'CHANGE').RINT101                           25050000
&BIT0    SETA  1                                                        25100000
         AIF   ('&ENVIR' EQ 'VERIFY').RINT101                      @L6A 25150000
&BIT1    SETA  0                                                        25200000
         AIF   ('&ENVIR' EQ 'DELETE').RINT101                           25250000
&BIT0    SETA  0                                                        25300000
.RINT101 ANOP                                                           25350000
         AIF   ('&SMC' NE 'NO').RINT102                        @PC003PY 25400000
&BIT2    SETA  1                                               @PC003PY 25450000
.RINT102 ANOP                                                  @PC003PY 25500000
         AIF   ('&PASSCHK' NE 'NO').RINT103                    @PC003PY 25550000
&BIT4    SETA  1                                               @PC003PY 25600000
.RINT103 ANOP                                                  @PC003PY 25650000
         AIF   ('&STAT' NE 'NO').RINT104                           @L6A 25700000
&BIT5    SETA  1         STAT=NO SPECIFIED                         @L6A 25750000
.RINT104 ANOP  ,                                                   @L6A 25800000
         AIF   ('&ENCRYPT' NE 'NO').RINT105                        @L6A 25850000
&BIT7    SETA  1         ENCRYPT=NO SPECIFIED                      @L6A 25900000
.RINT105 ANOP  ,                                                   @L6A 25950000
         AIF   ('&LOG' NE 'ALL').RINT106                           @L7A 26000000
&BIT6    SETA  1         LOG=ALL SPECIFIED                         @L7A 26050000
.RINT106 ANOP  ,                                                   @L7A 26100000
         DC    B'&BIT0&BIT1&BIT2&BIT3&BIT4&BIT5&BIT6&BIT7'         @L6A 26150000
.* PRODUCE USERID ADDRESS                                               26200000
         AIF   ('&USERID' EQ '').RINT110                                26250000
         AIF   ('&USERID'(1,1) EQ '(').RINT110                          26300000
         DC    A(&USERID) -        USERID ADDRESS FIELD                 26350000
         AGO   .RINT120                                                 26400000
.RINT110 ANOP                                                           26450000
         DC    A(0) -              USERID ADDRESS FIELD                 26500000
.RINT120 ANOP                                                           26550000
.* PRODUCE PASSWORD  ADDRESS                                            26600000
         AIF   ('&PASSWRD' EQ '').RINT130                               26650000
         AIF   ('&PASSWRD'(1,1) EQ '(').RINT130                         26700000
         DC    A(&PASSWRD) -      PASSWORD ADDRESS FIELD                26750000
         AGO   .RINT140                                                 26800000
.RINT130 ANOP                                                           26850000
         DC    A(0) -             PASSWORD ADDRESS FIELD                26900000
.RINT140 ANOP                                                           26950000
.* PRODUCE START ADDRESS                                                27000000
         AIF   ('&START' EQ '').RINT150                                 27050000
         AIF   ('&START'(1,1) EQ '(').RINT150                           27100000
         DC    A(&START) -        PROCEDURE NAME ADDR FIELD             27150000
         AGO   .RINT160                                                 27200000
.RINT150 ANOP                                                           27250000
         DC    A(0) -             PROCEDURE NAME ADDR FIELD             27300000
.RINT160 ANOP                                                           27350000
         AIF   ('&INSTLN' EQ '').RINT161                                27400000
         AIF   ('&INSTLN'(1,1) EQ '(').RINT161                          27450000
         DC    A(&INSTLN) -       INSTALLATION PARAMETERS ADDRESS       27500000
         AGO   .RINT162                                                 27550000
.RINT161 ANOP                                                           27600000
         DC    A(0) -             INSTALLATION PARAMETERS ADDRESS       27650000
.RINT162 ANOP                                                           27700000
         AIF   ('&GROUP' EQ '').RINT163                                 27750000
         AIF   ('&GROUP'(1,1) EQ '(').RINT163                           27800000
         DC    A(&GROUP) -        GROUP ADDRESS FIELD                   27850000
         AGO   .RINT164                                                 27900000
.RINT163 ANOP                                                           27950000
         DC    A(0) -             GROUP ADDRESS FIELD                   28000000
.RINT164 ANOP                                                           28050000
         AIF   ('&NEWPASS' EQ '').RINT165                               28100000
         AIF   ('&NEWPASS'(1,1) EQ '(').RINT165                         28150000
         DC    A(&NEWPASS) -      NEW PASSWORD ADDRESS FIELD            28200000
         AGO   .RINT166                                                 28250000
.RINT165 ANOP                                                           28300000
         DC    A(0) -             NEW PASSWORD ADDRESS FIELD            28350000
.RINT166 ANOP                                                           28400000
         AIF   ('&PGMNAME' EQ '').RINT167                      @PC002PY 28450000
         AIF   ('&PGMNAME'(1,1) EQ '(').RINT167                @PC002PY 28500000
         DC    A(&PGMNAME) -      PGMNAME ADDRESS FIELD        @PC002PY 28550000
         AGO   .RINT168                                        @PC002PY 28600000
.RINT167 ANOP                                                  @PC002PY 28650000
         DC    A(0) -             PGMNAME ADDRESS FIELD        @PC002PY 28700000
.RINT168 ANOP                                                  @PC002PY 28750000
         AIF   ('&ACTINFO' EQ '').RINT169                      @PC002PY 28800000
         AIF   ('&ACTINFO'(1,1) EQ '(').RINT169                @PC002PY 28850000
         DC    A(&ACTINFO) -      ACTINFO ADDRESS FIELD        @PC002PY 28900000
         AGO   .RINT170                                        @PC002PY 28950000
.RINT169 ANOP                                                  @PC002PY 29000000
         DC    A(0) -             ACTINFO ADDRESS FIELD        @PC002PY 29050000
.RINT170 ANOP                                                  @PC002PY 29100000
         AIF   ('&OIDCARD' EQ '').RINT171                      @PC002PY 29150000
         AIF   ('&OIDCARD'(1,1) EQ '(').RINT171                @PC002PY 29200000
         DC    A(&OIDCARD) -      OIDCARD ADDRESS FIELD        @PC002PY 29250000
         AGO   .RINT172                                        @PC002PY 29300000
.RINT171 ANOP                                                  @PC002PY 29350000
         DC    A(0) -             OIDCARD ADDRESS FIELD        @PC002PY 29400000
.RINT172 ANOP                                                  @PC002PY 29450000
         AIF   ('&TERMID' EQ '').RINT173                       @PC002PY 29500000
         AIF   ('&TERMID'(1,1) EQ '(').RINT173                 @PC002PY 29550000
         DC    A(&TERMID) -       TERMID ADDRESS FIELD         @PC002PY 29600000
         AGO   .RINT174                                        @PC002PY 29650000
.RINT173 ANOP                                                  @PC002PY 29700000
         DC    A(0) -             TERMID ADDRESS FIELD         @PC002PY 29750000
.RINT174 ANOP                                                  @PC002PY 29800000
         AIF   ('&JOBNAME' EQ '').RINT17A                      @PM44591 29850000
         AIF   ('&JOBNAME'(1,1) EQ '(').RINT17A                @PM44591 29900000
         DC    A(&JOBNAME) -      JOBNAME ADDRESS FIELD        @PM44591 29950000
         AGO   .RINT17B                                        @PM44591 30000000
.RINT17A ANOP                                                  @PM44591 30050000
         DC    A(0) -             JOBNAME ADDRESS FIELD        @PM44591 30100000
.RINT17B ANOP                                                  @PM44591 30150000
         AIF   ('&APPL' EQ '').RINT17C                         @PC003PY 30200000
         AIF   ('&APPL'(1,1) EQ '(').RINT17C                   @PC003PY 30250000
         AIF   ('&APPL'(1,1) EQ '''').RINT17G                  @PC003PY 30300000
         DC    A(&APPL) -         APPL ADDRESS FIELD           @PC003PY 30350000
         AGO   .RINT17D                                        @PC003PY 30400000
.RINT17G ANOP                                                  @PC003PY 30450000
         DC    A(ICH1&SYSNDX)     APPL NAME ADDRESS            @PC003PY 30500000
         AGO   .RINT17D                                        @PC003PY 30550000
.RINT17C ANOP                                                  @PC003PY 30600000
         DC    A(0) -             APPL ADDRESS FIELD           @PC003PY 30650000
.RINT17D ANOP                                                  @PC003PY 30700000
         AIF   ('&ACEE' EQ '').RINT17E                         @PC003PY 30750000
         AIF   ('&ACEE'(1,1) EQ '(').RINT17E                   @PC003PY 30800000
         DC    A(&ACEE) -         ACEE ADDRESS FIELD           @PC003PY 30850000
         AGO   .RINT17F                                        @PC003PY 30900000
.RINT17E ANOP                                                  @PC003PY 30950000
         DC    A(0) -             ACEE ADDRESS FIELD           @PC003PY 31000000
.RINT17F ANOP                                                  @PC003PY 31050000
         AIF   ('&RELEASE(1)' EQ '').RINNO19                       @Q1A 31100000
         AIF   ('&RELEASE(1)'(1,3) LT '1.9').RINNO19               @Q1C 31150000
.* THE FOLLOWING IS PARAMETERS FOR THE UTOKEN                      @M1A 31200000
.* CHECK SESSION TYPE                                              @M1A 31250000
         AIF   ('&SESSION' EQ '').RINTSEC                          @M1A 31300000
         AIF   ('&SESSION' NE 'SYSAS').SESS10A                     @M1A 31350000
         DC    AL1(1)      SESSION = SYSTEM ADDRESS SPACE          @M1A 31400000
         AGO   .RINT10G                                            @M1A 31450000
.SESS10A ANOP                                                      @M1A 31500000
         AIF   ('&SESSION' NE 'COMMAND').SESS10B                   @M1A 31550000
         DC    AL1(2)      SESSION = COMMAND                       @M1A 31600000
         AGO   .RINT10G                                            @M1A 31650000
.SESS10B ANOP                                                      @M1A 31700000
         AIF   ('&SESSION' NE 'CONSOPER').SESS10D                  @M1A 31750000
         DC    AL1(3)      SESSION = CONSOPER                      @M1A 31800000
         AGO   .RINT10G                                            @M1A 31850000
.SESS10D ANOP                                                      @M1A 31900000
         AIF   ('&SESSION' NE 'STARTED').SESS10E                   @M1A 31950000
         DC    AL1(4)      SESSION = STARTED PROCEDURE             @M1A 32000000
         AGO   .RINT10G                                            @M1A 32050000
.SESS10E ANOP                                                      @M1A 32100000
         AIF   ('&SESSION' NE 'MOUNT').SESS10F                     @M1A 32150000
         DC    AL1(5)      SESSION = MOUNT                         @M1A 32200000
         AGO   .RINT10G                                            @M1A 32250000
.SESS10F ANOP                                                      @M1A 32300000
         AIF   ('&SESSION' NE 'TSO').SESS10G                       @M1A 32350000
         DC    AL1(6)      SESSION = TSO                           @M1A 32400000
         AGO   .RINT10G                                            @M1A 32450000
.SESS10G ANOP                                                      @M1A 32500000
         AIF   ('&SESSION' NE 'INTBATCH').SESS10H                  @D4C 32550000
         DC    AL1(7)      SESSION = INTERNAL BATCH JOB            @M1A 32600000
         AGO   .RINT10G                                            @M1A 32650000
.SESS10H ANOP                                                      @M1A 32700000
         AIF   ('&SESSION' NE 'INTXBM').SESS10I                    @D7C 32750000
         DC    AL1(8)      SESSION = INTERNAL XBM                  @D7C 32800000
         AGO   .RINT10G                                            @M1A 32850000
.SESS10I ANOP                                                      @M1A 32900000
         AIF   ('&SESSION' NE 'RJEOPER').SESS10J                   @M1A 32950000
         DC    AL1(9)      SESSION = RJEOPER                       @M1A 33000000
         AGO   .RINT10G                                            @M1A 33050000
.SESS10J ANOP                                                      @M1A 33100000
         AIF   ('&SESSION' NE 'NJEOPER').SESS10K                   @D3C 33150000
         DC    AL1(10)     SESSION = NJEOPER                       @M1A 33200000
         AGO   .RINT10G                                            @M1A 33250000
.SESS10K ANOP                                                      @D3A 33300000
         AIF   ('&SESSION' NE 'TKNUNKWN').SESS10L                  @D6C 33350000
         DC    AL1(11)     SESSION = NJE UNKNOWN USER              @D3A 33400000
         AGO   .RINT10G                                            @D3A 33450000
.SESS10L ANOP                                                      @D4A 33500000
         AIF   ('&SESSION' NE 'EXTBATCH').SESS10M                  @D4A 33550000
         DC    AL1(12)     SESSION = EXTERNAL BATCH                @D4A 33600000
         AGO   .RINT10G                                            @D4A 33650000
.SESS10M ANOP                                                      @D4A 33700000
         AIF   ('&SESSION' NE 'RJEBATCH').SESS10N                  @D4A 33750000
         DC    AL1(13)     SESSION = RJE JOB                       @D4A 33800000
         AGO   .RINT10G                                            @D4A 33850000
.SESS10N ANOP                                                      @D4A 33900000
         AIF   ('&SESSION' NE 'NJEBATCH').SESS10P                  @D5C 33950000
         DC    AL1(14)     SESSION = NJE JOB                       @D4A 34000000
         AGO   .RINT10G                                            @D4A 34050000
.SESS10P ANOP                                                      @D4A 34100000
         AIF   ('&SESSION' NE 'NJSYSOUT').SESS10Q                  @D7C 34150000
         DC    AL1(15)     SESSION = NJE SYSOUT                    @D5A 34200000
         AGO   .RINT10G                                            @D5A 34250000
.SESS10Q ANOP                                                      @D7A 34300000
         AIF   ('&SESSION' NE 'EXTXBM').SESS10R                    @D7A 34350000
         DC    AL1(16)     SESSION = EXTERNAL XBM                  @D7A 34400000
         AGO   .RINT10G                                            @D7A 34450000
.SESS10R ANOP                                                      @D7A 34500000
         AIF   ('&SESSION' NE 'RJEXBM').SESS10S                    @D7A 34550000
         DC    AL1(17)     SESSION = RJE XBM                       @D7A 34600000
         AGO   .RINT10G                                            @D7A 34650000
.SESS10S ANOP                                                      @D7A 34700000
         AIF   ('&SESSION' NE 'NJEXBM').SESS10T                    @M3C 34750000
         DC    AL1(18)     SESSION = NJE XBM                       @D7A 34800000
         AGO   .RINT10G                                            @D7A 34850000
.SESS10T ANOP                                                      @D7A 34900000
         AIF   ('&SESSION' NE 'APPCTP').RINTSEC                    @M3A 34950000
         DC    AL1(19)     SESSION = APPCTP                        @M3A 35000000
         AGO   .RINT10G                                            @M3A 35050000
.RINTSEC ANOP                                                      @M1A 35100000
         DC    AL1(0)      SESSION                                 @M1A 35150000
.RINT10G ANOP                                                      @M1A 35200000
.* CHECK FLAG BYTE                                                 @M1A 35250000
&BIT0    SETA  0           PART OF TRUSTED COMP BASE               @M1A 35300000
&BIT1    SETA  0           JOB FROM REMOTE NODE                    @M2A 35350000
&BIT2    SETA  0           TRUSTED KEYWORD SPECIFIED               @M1A 35400000
&BIT3    SETA  0           REMOTE KEYWORD SPECIFIED                @M2A 35450000
         AIF   ('&TRUSTED' NE 'YES').RINT10H                       @M1A 35500000
&BIT0    SETA  1                                                   @M1A 35550000
.RINT10H ANOP                                                      @M1A 35600000
         AIF   ('&REMOTE' NE 'YES').RINT10K                        @M2A 35650000
&BIT1    SETA  1                                                   @M2A 35700000
.RINT10K ANOP                                                      @M2A 35750000
         AIF   ('&TRUSTED' EQ '').RINT10L                          @D1A 35800000
&BIT2    SETA  1                                                   @D1A 35850000
.RINT10L ANOP                                                      @D1A 35900000
         AIF   ('&REMOTE' EQ '').RINT10M                           @D1A 35950000
&BIT3    SETA  1                                                   @D1A 36000000
.RINT10M ANOP                                                      @D1A 36050000
         DC    B'&BIT0&BIT1&BIT2&BIT3.0000'   FLAG2                @D1C 36100000
         DC    AL2(0)      FUTURE USE                              @M1A 36150000
.* PRODUCE SECLABL ADDRESS                                         @M1A 36200000
         AIF   ('&SECLABL' EQ '').RINT19E                          @M1A 36250000
         AIF   ('&SECLABL'(1,1) EQ '(').RINT19E                    @M1A 36300000
         DC    A(&SECLABL) -       SECLABL ADDRESS FIELD           @M1A 36350000
         AGO   .RINT19F                                            @M1A 36400000
.RINT19E ANOP                                                      @M1A 36450000
         DC    A(0) -              SECLABL ADDRESS FIELD           @M1A 36500000
.RINT19F ANOP                                                      @M1A 36550000
.* PRODUCE EXENODE ADDRESS                                         @M1A 36600000
         AIF   ('&EXENODE' EQ '').RINT19G                          @M1A 36650000
         AIF   ('&EXENODE'(1,1) EQ '(').RINT19G                    @M1A 36700000
         DC    A(&EXENODE) -       EXENODE ADDRESS FIELD           @M1A 36750000
         AGO   .RINT19H                                            @M1A 36800000
.RINT19G ANOP                                                      @M1A 36850000
         DC    A(0) -              EXENODE ADDRESS FIELD           @M1A 36900000
.RINT19H ANOP                                                      @M1A 36950000
.* PRODUCE SUSERID ADDRESS                                         @M1A 37000000
         AIF   ('&SUSERID' EQ '').RINT19I                          @M1A 37050000
         AIF   ('&SUSERID'(1,1) EQ '(').RINT19I                    @M1A 37100000
         DC    A(&SUSERID) -       SUSERID ADDRESS FIELD           @M1A 37150000
         AGO   .RINT19J                                            @M1A 37200000
.RINT19I ANOP                                                      @M1A 37250000
         DC    A(0) -              SUSERID ADDRESS FIELD           @M1A 37300000
.RINT19J ANOP                                                      @M1A 37350000
.* PRODUCE SNODE ADDRESS                                           @M1A 37400000
         AIF   ('&SNODE' EQ '').RINT19K                            @M1A 37450000
         AIF   ('&SNODE'(1,1) EQ '(').RINT19K                      @M1A 37500000
         DC    A(&SNODE) -         SNODE ADDRESS FIELD             @M1A 37550000
         AGO   .RINT19L                                            @M1A 37600000
.RINT19K ANOP                                                      @M1A 37650000
         DC    A(0) -              SNODE ADDRESS FIELD             @M1A 37700000
.RINT19L ANOP                                                      @M1A 37750000
.* PRODUCE SGROUP ADDRESS                                          @M1A 37800000
         AIF   ('&SGROUP' EQ '').RINT19M                           @M1A 37850000
         AIF   ('&SGROUP'(1,1) EQ '(').RINT19M                     @M1A 37900000
         DC    A(&SGROUP) -        SGROUP ADDRESS FIELD            @M1A 37950000
         AGO   .RINT19N                                            @M1A 38000000
.RINT19M ANOP                                                      @M1A 38050000
         DC    A(0) -              SGROUP ADDRESS FIELD            @M1A 38100000
.RINT19N ANOP                                                      @M1A 38150000
.* PRODUCE POE ADDRESS                                             @M1A 38200000
         AIF   ('&POE' EQ '').RINT19O                              @M1A 38250000
         AIF   ('&POE'(1,1) EQ '(').RINT19O                        @M1A 38300000
         DC    A(&POE) -           POE ADDRESS FIELD               @M1A 38350000
         AGO   .RINT19P                                            @M1A 38400000
.RINT19O ANOP                                                      @M1A 38450000
         DC    A(0) -              POE ADDRESS FIELD               @M1A 38500000
.RINT19P ANOP                                                      @M1A 38550000
.* PRODUCE INPUT TOKEN ADDRESS                                     @D2C 38600000
         AIF   ('&TOKNIN' EQ '').RINT19Q                           @D2C 38650000
         AIF   ('&TOKNIN'(1,1) EQ '(').RINT19Q                     @D2C 38700000
         DC    A(&TOKNIN) -        INPUT TOKEN ADDRESS             @D2C 38750000
         AGO   .RINT19R                                            @M1A 38800000
.RINT19Q ANOP                                                      @M1A 38850000
         DC    A(0) -              INPUT TOKEN ADDRESS             @M1A 38900000
.RINT19R ANOP                                                      @M1A 38950000
.* PRODUCE STOKEN ADDRESS                                          @M1A 39000000
         AIF   ('&STOKEN' EQ '').RINT19S                           @M1A 39050000
         AIF   ('&STOKEN'(1,1) EQ '(').RINT19S                     @M1A 39100000
         DC    A(&STOKEN) -        STOKEN ADDRESS FIELD            @M1A 39150000
         AGO   .RINT19T                                            @M1A 39200000
.RINT19S ANOP                                                      @M1A 39250000
         DC    A(0) -              STOKEN ADDRESS FIELD            @M1A 39300000
.RINT19T ANOP                                                      @M1A 39350000
.* PRODUCE LOGSTR ADDRESS                                          @M1A 39400000
         AIF   ('&LOGSTR' EQ '').RINT19U                           @M1A 39450000
         AIF   ('&LOGSTR'(1,1) EQ '(').RINT19U                     @M1A 39500000
         DC    A(&LOGSTR) -        LOGSTR ADDRESS FIELD            @M1A 39550000
         AGO   .RINT19V                                            @M1A 39600000
.RINT19U ANOP                                                      @M1A 39650000
         DC    A(0) -              LOGSTR ADDRESS FIELD            @M1A 39700000
.RINT19V ANOP                                                      @M1A 39750000
.* PRODUCE OUTPUT TOKEN ADDRESS                                    @D2A 39800000
         AIF   ('&TOKNOUT' EQ '').RINT19W                          @D2A 39850000
         AIF   ('&TOKNOUT'(1,1) EQ '(').RINT19W                    @D2A 39900000
         DC    A(&TOKNOUT) -       OUTPUT TOKEN ADDRESS            @D2A 39950000
         AGO   .RINT19X                                            @D2A 40000000
.RINT19W ANOP                                                      @M1A 40050000
         DC    A(0) -              OUTPUT TOKEN ADDRESS            @D2A 40100000
.RINT19X ANOP                                                      @D2A 40150000
         AIF   ('&RELEASE(1)' EQ '').RINNO19                       @M4A 40200000
         AIF   ('&RELEASE(1)'(1,5) LT '1.9.2' AND                      X40233300
                '&RELEASE(1)'(1,1) LT '2').RINNO19                 @M6C 40266600
.*                                                                 @M4A 40300000
.* CHECK FOR ENVRIN                                                @M4A 40350000
.*                                                                 @M4A 40400000
         AIF   ('&ENVRIN' EQ '').RIN192C                           @M4A 40450000
         AIF   ('&ENVRIN'(1,1) EQ '(').RIN192C                     @M4A 40500000
         DC    A(&ENVRIN) -         ENVRIN ADDRESS                 @M4A 40550000
         AGO   .RIN192D                                            @M4A 40600000
.RIN192C ANOP                                                      @M4A 40650000
         DC    A(0) -               ENVRIN ADDRESS                 @M4A 40700000
.RIN192D ANOP                                                      @M4A 40750000
.*                                                                 @M4A 40800000
.* CHECK FOR ENVROUT                                               @M4A 40850000
.*                                                                 @M4A 40900000
         AIF   ('&ENVROUT' EQ '').RIN192E                          @M4A 40950000
         AIF   ('&ENVROUT'(1,1) EQ '(').RIN192E                    @M4A 41000000
         DC    A(&ENVROUT) -        ENVROUT ADDRESS                @M4A 41050000
         AGO   .RIN192F                                            @M4A 41100000
.RIN192E ANOP                                                      @M4A 41150000
         DC    A(0) -               ENVROUT ADDRESS                @M4A 41200000
.RIN192F ANOP                                                      @M4A 41250000
.*                                                                 @M4A 41300000
.RINNO19 ANOP                                                      @M1A 41350000
.* IF APPL NAME SPECIFIED EXPLICITLY, PRODUCE IT BELOW LIST        @P5M 41400000
         AIF   ('&APPL' EQ '').RINT17H                             @P5M 41450000
         AIF   ('&APPL'(1,1) NE '''').RINT17H                      @P5M 41500000
ICH1&SYSNDX DC    CL8&APPL                                         @P5M 41550000
.RINT17H ANOP                                                      @P5M 41600000
         AIF   (&MFFLAG).RINT221                                        41650000
         MEXIT                                                          41700000
.RINT175 ANOP                                                           41750000
.* TEST FOR OTHER MACRO FORMS                                           41800000
         AIF   ('&MF' EQ 'S').RINT180                                   41850000
         AIF   ('&MF'(1,2) EQ '(E').RINT230                        @M1C 41900000
         AIF   ('&MF'(1,2) EQ '(M').RINT230                        @P1A 41950000
         AGO   .ERR04                                                   42000000
.ERTN04  ANOP                                                           42050000
.RINT180 ANOP                                                           42100000
.* PRODUCE STANDARD FORM                                                42150000
&MFFLAG  SETB  1     SET TRUE FOR MF=S PASS THROUGH LIST CODE           42200000
&SYMBOL  DS    0H                                                       42250000
.* PRODUCE CODE TO MODIFY INLINE LIST FORM                              42300000
         AIF   ('&SUBPOOL' EQ '').RINT189                               42350000
         AIF   ('&SUBPOOL'(1,1) NE '(').RINT189                         42400000
         STC   &SUBPOOL(1),&NAME+1 -   STORE SUBPOOL NUMBER             42450000
.RINT189 ANOP                                                           42500000
         AIF   ('&USERID' EQ '').RINT190                                42550000
         AIF   ('&USERID'(1,1) NE '(').RINT190                          42600000
         ST    &USERID(1),&NAME+4 -    STORE USERID ADDRESS             42650000
.RINT190 ANOP                                                           42700000
         AIF   ('&PASSWRD' EQ '').RINT200                               42750000
         AIF   ('&PASSWRD'(1,1) NE '(').RINT200                         42800000
         ST    &PASSWRD(1),&NAME+8 -    STORE PASSWORD ADDRESS          42850000
.RINT200 ANOP                                                           42900000
         AIF   ('&START' EQ '').RINT210                                 42950000
         AIF   ('&START'(1,1) NE '(').RINT210                           43000000
         ST    &START(1),&NAME+12 -    STORE PROC ADDRESS               43050000
.RINT210 ANOP                                                           43100000
         AIF   ('&INSTLN' EQ '').RINT215                                43150000
         AIF   ('&INSTLN'(1,1) NE '(').RINT215                          43200000
         ST    &INSTLN(1),&NAME+16 -  STORE INSTALLATION PARM ADDRESS   43250000
.RINT215 ANOP                                                           43300000
         AIF   ('&GROUP' EQ '').RINT216                                 43350000
         AIF   ('&GROUP'(1,1) NE '(').RINT216                           43400000
         ST    &GROUP(1),&NAME+20 -  STORE GROUP ADDRESS                43450000
.RINT216 ANOP                                                           43500000
         AIF   ('&NEWPASS' EQ '').RINT217                               43550000
         AIF   ('&NEWPASS'(1,1) NE '(').RINT217                         43600000
         ST    &NEWPASS(1),&NAME+24 - STORE NEW PASSWORD ADDRESS        43650000
.RINT217 ANOP                                                           43700000
         AIF   ('&PGMNAME' EQ '').RINT218                      @PC002PY 43750000
         AIF   ('&PGMNAME'(1,1) NE '(').RINT218                @PC002PY 43800000
         ST    &PGMNAME(1),&NAME+28 - STORE PGMNAME ADDRESS    @PC002PY 43850000
.RINT218 ANOP                                                  @PC002PY 43900000
         AIF   ('&ACTINFO' EQ '').RINT219                      @PC002PY 43950000
         AIF   ('&ACTINFO'(1,1) NE '(').RINT219                @PC002PY 44000000
         ST    &ACTINFO(1),&NAME+32 - STORE ACTINFO ADDRESS    @PC002PY 44050000
.RINT219 ANOP                                                  @PC002PY 44100000
         AIF   ('&OIDCARD' EQ '').RINT220                      @PC002PY 44150000
         AIF   ('&OIDCARD'(1,1) NE '(').RINT220                @PC002PY 44200000
         ST    &OIDCARD(1),&NAME+36 - STORE OIDCARD ADDRESS    @PC002PY 44250000
.RINT220 ANOP                                                  @PC002PY 44300000
         AIF   ('&TERMID' EQ '').RINT22A                       @PC002PY 44350000
         AIF   ('&TERMID'(1,1) NE '(').RINT22A                 @PC002PY 44400000
         ST    &TERMID(1),&NAME+40 - STORE TERMID ADDRESS      @PC002PY 44450000
.RINT22A ANOP                                                  @PC002PY 44500000
         AIF   ('&JOBNAME' EQ '').RINT22B                      @PM44591 44550000
         AIF   ('&JOBNAME'(1,1) NE '(').RINT22B                @PM44591 44600000
         ST    &JOBNAME(1),&NAME+44 - STORE JOBNAME ADDRESS    @PM44591 44650000
.RINT22B ANOP                                                  @PM44591 44700000
         AIF   ('&APPL' EQ '').RINT22C                         @PC003PY 44750000
         AIF   ('&APPL'(1,1) NE '(').RINT22C                   @PC003PY 44800000
         ST    &APPL(1),&NAME+48 - STORE APPL ADDRESS          @PC003PY 44850000
.RINT22C ANOP                                                  @PC003PY 44900000
         AIF   ('&ACEE' EQ '').RINT22D                         @PC003PY 44950000
         AIF   ('&ACEE'(1,1) NE '(').RINT22D                   @PC003PY 45000000
         ST    &ACEE(1),&NAME+52 - STORE ACEE ADDRESS          @PC003PY 45050000
.RINT22D ANOP                                                  @PC003PY 45100000
         AIF   ('&SECLABL' EQ '').RINT22G                          @M1A 45150000
         AIF   ('&SECLABL'(1,1) NE '(').RINT22G                    @M1A 45200000
         ST    &SECLABL(1),&NAME+60 - STORE SECLABL ADDRESS        @M1A 45250000
.RINT22G ANOP                                                      @M1A 45300000
         AIF   ('&EXENODE' EQ '').RINT22H                          @M1A 45350000
         AIF   ('&EXENODE'(1,1) NE '(').RINT22H                    @M1A 45400000
         ST    &EXENODE(1),&NAME+64 - STORE EXENODE ADDRESS        @M1A 45450000
.RINT22H ANOP                                                      @M1A 45500000
         AIF   ('&SUSERID' EQ '').RINT22I                          @M1A 45550000
         AIF   ('&SUSERID'(1,1) NE '(').RINT22I                    @M1A 45600000
         ST    &SUSERID(1),&NAME+68 - STORE SUSERID ADDRESS        @M1A 45650000
.RINT22I ANOP                                                      @M1A 45700000
         AIF   ('&SNODE' EQ '').RINT22J                            @M1A 45750000
         AIF   ('&SNODE'(1,1) NE '(').RINT22J                      @M1A 45800000
         ST    &SNODE(1),&NAME+72 - STORE SNODE ADDRESS            @M1A 45850000
.RINT22J ANOP                                                      @M1A 45900000
         AIF   ('&SGROUP' EQ '').RINT22K                           @M1A 45950000
         AIF   ('&SGROUP'(1,1) NE '(').RINT22K                     @M1A 46000000
         ST    &SGROUP(1),&NAME+76 - STORE SGROUP ADDRESS          @M1A 46050000
.RINT22K ANOP                                                      @M1A 46100000
         AIF   ('&POE' EQ '').RINT22L                              @M1A 46150000
         AIF   ('&POE'(1,1) NE '(').RINT22L                        @M1A 46200000
         ST    &POE(1),&NAME+80 - STORE POE ADDRESS                @M1A 46250000
.RINT22L ANOP                                                      @M1A 46300000
         AIF   ('&TOKNIN' EQ '').RINT22M                           @D2C 46350000
         AIF   ('&TOKNIN'(1,1) NE '(').RINT22M                     @D2C 46400000
         ST    &TOKNIN(1),&NAME+84 -  STORE INPUT TOKEN ADDRESS    @D2C 46450000
.RINT22M ANOP                                                      @M1A 46500000
         AIF   ('&STOKEN' EQ '').RINT22N                           @M1A 46550000
         AIF   ('&STOKEN'(1,1) NE '(').RINT22N                     @M1A 46600000
         ST    &STOKEN(1),&NAME+88 - STORE STOKEN ADDRESS          @M1A 46650000
.RINT22N ANOP                                                      @M1A 46700000
         AIF   ('&LOGSTR' EQ '').RINT22O                           @M1A 46750000
         AIF   ('&LOGSTR'(1,1) NE '(').RINT22O                     @M1A 46800000
         ST    &LOGSTR(1),&NAME+92 - STORE LOGSTR ADDRESS          @M1A 46850000
.RINT22O ANOP                                                      @M1A 46900000
         AIF   ('&TOKNOUT' EQ '').RINT22Q                          @D2A 46950000
         AIF   ('&TOKNOUT'(1,1) NE '(').RINT22Q                    @D2A 47000000
         ST    &TOKNOUT(1),&NAME+96 - STORE OUTPUT TOKEN ADDRESS   @D2A 47050000
.RINT22Q ANOP                                                      @D2A 47100000
         AIF   ('&ENVRIN' EQ '').RINT22R                           @M4A 47150000
         AIF   ('&ENVRIN'(1,1) NE '(').RINT22R                     @M4A 47200000
         ST    &ENVRIN(1),&NAME+100 - STORE ENVR D.S. ADDRESS      @M4A 47250000
.RINT22R ANOP                                                      @M4A 47300000
         AIF   ('&ENVROUT' EQ '').RINT22S                          @M4A 47350000
         AIF   ('&ENVROUT'(1,1) NE '(').RINT22S                    @M4A 47400000
         ST    &ENVROUT(1),&NAME+104 - STORE ENVR D.S. ADDRESS     @M4A 47450000
.RINT22S ANOP                                                      @M4A 47500000
.* LIST FORM MODIFICATION COMPLETE -PRODUCE LIST FORM WITH BAL AROUND   47550000
         CNOP  0,4            ALIGN LIST FORM                           47600000
         AIF   ('&APPL' EQ '').RINT22P                         @PC003PY 47650000
         AIF   ('&APPL'(1,1) NE '''').RINT22P                  @PC003PY 47700000
         BAL   1,ICH&SYSNDX.A POINT REG 1 AT LIST FORM             @P6C 47750000
&NAME    EQU   *                                                        47800000
         AGO   .RINT090  PRODUCE LIST FORM                     @PC003PY 47850000
.RINT22P ANOP                                                  @PC003PY 47900000
         BAL   1,ICH&SYSNDX.A POINT REG 1 AT LIST FORM             @P6C 47950000
&NAME    EQU   *                                                        48000000
         AGO   .RINT090   PRODUCE LIST FORM AND RETURN VIA MFFLAG       48050000
.RINT221 ANOP                                                           48100000
ICH&SYSNDX.A DS 0H                                                 @P6C 48150000
.***********************************************************       @T1A 48200000
.* IF THIS MACRO WAS INVOKED INTERNALLY BY THE RACROUTE            @T1A 48250000
.* MACRO, SIMPLY EXIT RATHER THAN GOING TO THE RACF ROUTINE.       @T1A 48300000
.***********************************************************       @T1A 48350000
         AIF   (&ICHRAC).RINT225                                   @T1A 48400000
         AIF   ('&MF'(1,2) EQ '(M').RINT225   SKIP SVC IF MF=M     @P1A 48450000
         L     15,16(0,0)            GET CVT ADDRESS                    48500000
         L     15,X'3E0'(0,15)       GET RACF CVT ADDRESS               48550000
         LTR   15,15                 RACF CVT EXIST                     48600000
         BZ    *+12                  NO, BRANCH TO SET RC               48650000
         TM    X'35'(15),X'80'       RACF ACTIVE                        48700000
         BNO   *+12                  YES, BRANCH                        48750000
         LA    15,32(0,0)            RACF NOT ACTIVE RET CODE           48800000
         B     *+6                   SKIP SVC                           48850000
         SVC   131                   ISSUE RACINIT SVC                  48900000
         AIF   (NOT &RLVLCHK).RINT225                          @YA24122 48950000
&ICHRLVL DS    0H                                              @YA24122 49000000
.ERVSE1R ANOP                        VSE EXIT ON ERROR         @D62CDHH 49025000
.RINT225 ANOP                                                      @T1A 49050000
         MEXIT                                                          49100000
.* STANDARD FORM COMPLETE- PRODUCE EXECUTE FORM IF REQUESTED            49150000
.RINT230 ANOP                                                           49200000
         AIF   (&ICHRAC).RINT23A                                   @T1A 49250000
&SYMBOL  IHBINNRA &MF(2)   LOAD REG1 WITH LIST ADDRESS                  49300000
         AGO   .RINT23B                                            @T1A 49350000
.**************************************************************    @T1A 49400000
.*  IF THIS MACRO WAS INVOKED INTERNALLY BY THE RACROUTE MACRO,    @T1A 49450000
.*  PICK UP THE ADDRESS OF THE RACINIT  PARAMETER LIST FROM THE    @T1A 49500000
.*  RACROUTE PARAMETER LIST.                                       @T1A 49550000
.**************************************************************    @T1A 49600000
.RINT23A ANOP                                                      @T1A 49650000
         A     1,36(1)               POINT REG1 AT RACINIT LIST    @T1A 49700000
.RINT23B ANOP                                                      @T1A 49750000
.* IF REQUESTED, CHECK SIZE OF LIST-FORM VS. EXECUTE-FORM      @YA24122 49800000
         AIF   (NOT &RLVLCHK).RINT23D                          @YA24122 49850000
         CLI   0(1),&PARMLEN             L-FORM LARGE ENOUGH   @YA24122 49900000
         BNL   *+12                      YES                   @YA24122 49950000
         LA    15,100              SET INCOMPATIBLE MACRO R.C. @YA24122 50000000
         B     &ICHRLVL                                        @YA24122 50050000
.RINT23D ANOP                                                  @YA24122 50100000
         AIF   ('&SUBPOOL' EQ '').RINT232                      @PC003PY 50150000
         AIF   ('&SUBPOOL'(1,1) EQ '(').RINT231                @PC003PY 50200000
         MVI   1(1),&SUBPOOL       - SET SUBPOOL NUMBER        @PC003PY 50250000
         AGO   .RINT232                                        @PC003PY 50300000
.RINT231 ANOP                                                  @PC003PY 50350000
         STC   &SUBPOOL(1),1(1) -   STORE SUBPOOL NUMBER       @PC003PY 50400000
.RINT232 ANOP                                                  @PC003PY 50450000
.* MODIFY LIST FLAG 0 FIELD AS REQUESTED                         @L7A   50500000
&BIT0    SETA  0                     LOC FLAG                    @L7A   50550000
&BIT1    SETA  0                     LOC FLAG                    @L7A   50600000
&BIT4    SETA  0                                                   @M4A 50650000
&BIT5    SETA  0                                                   @M4A 50700000
&BIX0    SETA  1                     LOC FLAG                    @L7A   50750000
&BIX1    SETA  1                     LOC FLAG                    @L7A   50800000
&BIX4    SETA  1                                                   @M4A 50850000
&BIX5    SETA  1                                                   @M4A 50900000
         AIF   ('&LOC' EQ '').RINT23E                              @M4C 50950000
&BIX0    SETA  0             LOC SPECIFIED                       @L7A   51000000
&BIX1    SETA  0             LOC SPECIFIED                       @L7A   51050000
         AIF   ('&LOC' NE 'BELOW').RINT23C                       @L7A   51100000
&BIT0    SETA  1             LOC=BELOW SPECIFIED                 @L7A   51150000
         AGO   .RINT23E                                            @M4C 51200000
.RINT23C ANOP  ,                                                 @L7A   51250000
&BIT1    SETA  1             LOC=ANY SPECIFIED                   @L7A   51300000
.RINT23E ANOP  ,                                                   @M4C 51350000
.*                                                                 @M4A 51400000
.* CHECK FOR PARAMETERS THAT ARE NOT SUPPORTED FOR SYSTEM=YES.     @M4A 51450000
.* IF ANY ARE PRESENT SET A BIT TO INDICATE THIS.                  @M4A 51500000
.*                                                                 @M4A 51550000
         AIF   ('&NEWPASS&OIDCARD&STOKEN&SNODE&SUSERID&SGROUP&EXENODE&J*51600000
               OBNAME&REMOTE&TOKNIN' EQ '').RINT23F                @M5C 51650000
&BIT4    SETA  1                                                   @M4A 51700000
.RINT23F ANOP                                                      @M4A 51750000
.*                                                                 @M4A 51800000
.* CHECK FOR LOG=NONE                                              @M4A 51850000
.*                                                                 @M4A 51900000
         AIF   ('&LOG' EQ '').RINT23G                              @M4A 51950000
&BIX5    SETA  0                                                   @M4A 52000000
         AIF   ('&LOG' NE 'NONE').RINT23G                          @M4A 52050000
&BIT5    SETA  1                                                   @M4A 52100000
.RINT23G ANOP                                                      @M4A 52150000
         AIF   ('&BIX0&BIX1&BIX4&BIX5' EQ '1111').RINT23N          @M4C 52200000
         NI    2(1),B'&BIX0&BIX1.11&BIX4&BIX5.11'                  @M4C 52250000
.RINT23N ANOP  ,                                                 @L7A   52300000
         AIF   ('&BIT0&BIT1&BIT4&BIT5' EQ '0000').RINT23O          @M4C 52350000
         OI    2(1),B'&BIT0&BIT1.00&BIT4&BIT5.00'                  @M4C 52400000
.RINT23O ANOP  ,                                                 @L7A   52450000
.* MODIFY LIST FLAG FIELD AS REQUESTED                                  52500000
&BIT0    SETA  0                     ENVIR FLAG                         52550000
&BIT1    SETA  0                     ENVIR FLAG                         52600000
&BIT2    SETA  0                     SMC FLAG                  @PC003PY 52650000
&BIT3    SETA  0                     SUBPOOL FLAG              @PC003PY 52700000
&BIT4    SETA  0                     PASSCHK FLAG              @PC003PY 52750000
&BIT5    SETA  0                     STAT FLAG                     @L6A 52800000
&BIT6    SETA  0                     LOG FLAG                      @L7A 52850000
&BIT7    SETA  0                     ENCRYPT FLAG                  @L6A 52900000
&BIX0    SETA  1                     ENVIR FLAG                @PC003PY 52950000
&BIX1    SETA  1                     ENVIR FLAG                @PC003PY 53000000
&BIX2    SETA  1                     NEGATIVE SMC FLAG         @PC003PY 53050000
&BIX3    SETA  1                     NEGATIVE SUBPOOL FLAG     @PC003PY 53100000
&BIX4    SETA  1                     NEGATIVE PASSCHK FLAG     @PC003PY 53150000
&BIX5    SETA  1                     NEGATIVE STAT FLAG            @L6A 53200000
&BIX6    SETA  1                     NEGATIVE LOG FLAG             @L7A 53250000
&BIX7    SETA  1                     NEGATIVE ENCRYPT FLAG         @L6A 53300000
         AIF   ('&ENVIR' EQ '' AND '&SMC' EQ '' AND '&SUBPOOL' EQ ''   *53350000
               AND '&PASSCHK' EQ '' AND '&STAT' EQ '' AND              *53400000
               '&ENCRYPT' EQ '' AND '&LOG' EQ '').RINT257          @L7A 53450000
         AIF   ('&ENVIR' EQ '').RINT251                                 53500000
&BIX0    SETA  0                     NEGATIVE ENVIR FLAG       @PC003PY 53550000
&BIX1    SETA  0                     NEGATIVE ENVIR FLAG       @PC003PY 53600000
         AIF   ('&ENVIR' EQ 'CREATE').RINT251                  @PC003PY 53650000
&BIT1    SETA  1                                               @PC003PY 53700000
         AIF   ('&ENVIR' EQ 'CHANGE').RINT251                  @PC003PY 53750000
&BIT0    SETA  1                                               @PC003PY 53800000
         AIF   ('&ENVIR' EQ 'VERIFY').RINT251                      @L6A 53850000
&BIT1    SETA  0                                               @PC003PY 53900000
         AIF   ('&ENVIR' EQ 'DELETE').RINT251                  @PC003PY 53950000
&BIT0    SETA  0                                               @PC003PY 54000000
.RINT251 ANOP                                                  @PC003PY 54050000
         AIF   ('&SMC' EQ '').RINT252                          @PC003PY 54100000
&BIX2    SETA  0                                               @PC003PY 54150000
         AIF   ('&SMC' NE 'NO').RINT252                        @PC003PY 54200000
&BIT2    SETA  1                     SMC FLAG                  @PC003PY 54250000
.RINT252 ANOP                                                  @PC003PY 54300000
         AIF   ('&SUBPOOL' EQ '').RINT253                      @PC003PY 54350000
&BIT3    SETA  1                     SMC FLAG                  @PC003PY 54400000
&BIX3    SETA  0                                               @PC003PY 54450000
.RINT253 ANOP                                                  @PC003PY 54500000
         AIF   ('&PASSCHK' EQ '').RINT254                      @PC003PY 54550000
&BIX4    SETA  0                                               @PC003PY 54600000
         AIF   ('&PASSCHK' NE 'NO').RINT254                    @PC003PY 54650000
&BIT4    SETA  1                     PASSCHK FLAG              @PC003PY 54700000
.RINT254 ANOP                                                  @PC003PY 54750000
         AIF   ('&STAT' EQ '').RINT255                             @L6A 54800000
&BIX5    SETA  0                                                   @L6A 54850000
         AIF   ('&STAT' NE 'NO').RINT255                           @L6A 54900000
&BIT5    SETA  1          STAT=NO SPECIFIED                        @L6A 54950000
.RINT255 ANOP                                                           55000000
         AIF   ('&ENCRYPT' EQ '').RINT256                          @L6A 55050000
&BIX7    SETA  0                                                   @L6A 55100000
         AIF   ('&ENCRYPT' NE 'NO').RINT256                        @L6A 55150000
&BIT7    SETA  1          ENCRYPT=NO SPECIFIED                     @L6A 55200000
.RINT256 ANOP  ,                                                   @L6A 55250000
         AIF   ('&LOG' EQ '').RINT25A                              @L7A 55300000
&BIX6    SETA  0                                                   @L7A 55350000
         AIF   ('&LOG' NE 'ALL').RINT25A                           @L7A 55400000
&BIT6    SETA  1          LOG=ALL SPECIFIED                        @L7A 55450000
.RINT25A ANOP                                                      @L7A 55500000
         NI    3(1),B'&BIX0&BIX1&BIX2&BIX3&BIX4&BIX5&BIX6&BIX7'    @L6A 55550000
         OI    3(1),B'&BIT0&BIT1&BIT2&BIT3&BIT4&BIT5&BIT6&BIT7'    @L6A 55600000
.RINT257 ANOP  ,                                                   @L6A 55650000
.* MODIFY ADDRESS PARAMETERS AS REQUIRED                                55700000
         AIF   ('&USERID' EQ '').RINT270                                55750000
         AIF   ('&USERID'(1,1) NE '(').RINT260                          55800000
         ST    &USERID(1),4(1) -   STORE USERID ADDRESS                 55850000
         AGO   .RINT270                                                 55900000
.RINT260 ANOP                                                           55950000
         LA    0,&USERID         MOVE USERID ADDRESS INTO               56000000
         ST    0,4(1) -             PARM LIST                           56050000
.RINT270 ANOP                                                           56100000
         AIF   ('&PASSWRD' EQ '').RINT290                               56150000
         AIF   ('&PASSWRD'(1,1) NE '(').RINT280                         56200000
         ST    &PASSWRD(1),8(1) -     STORE PASSWORD ADDRESS            56250000
         AGO   .RINT290                                                 56300000
.RINT280 ANOP                                                           56350000
         LA    0,&PASSWRD            MOVE PASSWORD ADDRESS              56400000
         ST    0,8(1) -        INTO PARM LIST                           56450000
.RINT290 ANOP                                                           56500000
         AIF   ('&START' EQ '').RINT310                                 56550000
         AIF   ('&START'(1,1) NE '(').RINT300                           56600000
         ST    &START(1),12(1) -    STORE PROC NAME ADDRESS             56650000
         AGO   .RINT310                                                 56700000
.RINT300 ANOP                                                           56750000
         LA    0,&START            MOVE PROCNAME ADDRESS INTO           56800000
         ST    0,12(1) -        INTO PARM LIST                          56850000
.RINT310 ANOP                                                           56900000
         AIF   ('&INSTLN' EQ '').RINT330                                56950000
         AIF   ('&INSTLN'(1,1) NE '(').RINT320                          57000000
         ST    &INSTLN(1),16(1)  -    SET INSTALLATION PARM ADDRESS     57050000
         AGO   .RINT330                                                 57100000
.RINT320 ANOP                                                           57150000
         LA    0,&INSTLN           MOVE INSTALLATION ADDRESS            57200000
         ST    0,16(1)              INTO PARM LIST                      57250000
.RINT330 ANOP                                                           57300000
         AIF   ('&GROUP' EQ '').RINT332                                 57350000
         AIF   ('&GROUP'(1,1) NE '(').RINT331                           57400000
         ST    &GROUP(1),20(1)    SET GROUP PARM ADDRESS                57450000
         AGO   .RINT332                                                 57500000
.RINT331 ANOP                                                           57550000
         LA    0,&GROUP           MOVE GROUP ADDRESS                    57600000
         ST    0,20(1)            INTO PARM LIST                        57650000
.RINT332 ANOP                                                           57700000
         AIF   ('&NEWPASS' EQ '').RINT334                               57750000
         AIF   ('&NEWPASS'(1,1) NE '(').RINT333                         57800000
         ST    &NEWPASS(1),24(1)  SET NEW PASSWORD ADDRESS              57850000
         AGO   .RINT334                                                 57900000
.RINT333 ANOP                                                           57950000
         LA    0,&NEWPASS         MOVE NEW PASSWORD ADDRESS             58000000
         ST    0,24(1)            INTO PARM LIST                        58050000
.RINT334 ANOP                                                           58100000
         AIF   ('&PGMNAME' EQ '').RINT336                      @PC002PY 58150000
         AIF   ('&PGMNAME'(1,1) NE '(').RINT335                @PC002PY 58200000
         ST    &PGMNAME(1),28(1)  SET PGMNAME ADDRESS          @PC002PY 58250000
         AGO   .RINT336                                        @PC002PY 58300000
.RINT335 ANOP                                                  @PC002PY 58350000
         LA    0,&PGMNAME         MOVE PGMNAME ADDRESS         @PC002PY 58400000
         ST    0,28(1)            INTO PARM LIST               @PC002PY 58450000
.RINT336 ANOP                                                  @PC002PY 58500000
         AIF   ('&ACTINFO' EQ '').RINT338                      @PC002PY 58550000
         AIF   ('&ACTINFO'(1,1) NE '(').RINT337                @PC002PY 58600000
         ST    &ACTINFO(1),32(1)  SET ACTINFO ADDRESS          @PC002PY 58650000
         AGO   .RINT338                                        @PC002PY 58700000
.RINT337 ANOP                                                  @PC002PY 58750000
         LA    0,&ACTINFO         MOVE ACTINFO ADDRESS         @PC002PY 58800000
         ST    0,32(1)            INTO PARM LIST               @PC002PY 58850000
.RINT338 ANOP                                                  @PC002PY 58900000
         AIF   ('&OIDCARD' EQ '').RINT340                      @PC002PY 58950000
         AIF   ('&OIDCARD'(1,1) NE '(').RINT339                @PC002PY 59000000
         ST    &OIDCARD(1),36(1) SET OIDCARD ADDRESS           @PC002PY 59050000
         AGO   .RINT340                                        @PC002PY 59100000
.RINT339 ANOP                                                  @PC002PY 59150000
         LA    0,&OIDCARD     MOVE OIDCARD ADDRESS             @PC002PY 59200000
         ST    0,36(1)            INTO PARM LIST               @PC002PY 59250000
.RINT340 ANOP                                                  @PC002PY 59300000
         AIF   ('&TERMID' EQ '').RINT342                       @PC002PY 59350000
         AIF   ('&TERMID'(1,1) NE '(').RINT341                 @PC002PY 59400000
         ST    &TERMID(1),40(1) SET TERMID ADDRESS             @PC002PY 59450000
         AGO   .RINT342                                        @PC002PY 59500000
.RINT341 ANOP                                                  @PC002PY 59550000
         LA    0,&TERMID      MOVE TERMID ADDRESS              @PC002PY 59600000
         ST    0,40(1)            INTO PARM LIST               @PC002PY 59650000
.RINT342 ANOP                                                  @PC002PY 59700000
         AIF   ('&JOBNAME' EQ '').RINT344                      @PM44591 59750000
         AIF   ('&JOBNAME'(1,1) NE '(').RINT343                @PM44591 59800000
         ST    &JOBNAME(1),44(1) SET JOBNAME ADDRESS           @PM44591 59850000
         AGO   .RINT344                                        @PM44591 59900000
.RINT343 ANOP                                                  @PM44591 59950000
         LA    0,&JOBNAME     MOVE JOBNAME ADDRESS             @PM44591 60000000
         ST    0,44(1)            INTO PARM LIST               @PM44591 60050000
.RINT344 ANOP                                                  @PM44591 60100000
         AIF   ('&APPL' EQ '').RINT346                         @PC003PY 60150000
         AIF   ('&APPL'(1,1) EQ '''').ERR06                    @PC003PY 60200000
         AIF   ('&APPL'(1,1) NE '(').RINT345                   @PC003PY 60250000
         ST    &APPL(1),48(1) SET APPL ADDRESS                 @PC003PY 60300000
         AGO   .RINT346                                        @PC003PY 60350000
.RINT345 ANOP                                                  @PC003PY 60400000
         LA    0,&APPL        MOVE APPL ADDRESS                @PC003PY 60450000
         ST    0,48(1)            INTO PARM LIST               @PC003PY 60500000
.ERTN06  ANOP                                                  @PC003PY 60550000
.RINT346 ANOP                                                  @PC003PY 60600000
         AIF   ('&ACEE' EQ '').RINT348                         @PC003PY 60650000
         AIF   ('&ACEE'(1,1) NE '(').RINT347                   @PC003PY 60700000
         ST    &ACEE(1),52(1) SET ACEE ADDRESS                 @PC003PY 60750000
         AGO   .RINT348                                        @PC003PY 60800000
.RINT347 ANOP                                                  @PC003PY 60850000
         LA    0,&ACEE        MOVE ACEE ADDRESS                @PC003PY 60900000
         ST    0,52(1)            INTO PARM LIST               @PC003PY 60950000
.RINT348 ANOP                                                  @PC003PY 61000000
         AIF   ('&SESSION' EQ '').SESS3ND                          @M1A 61050000
         AIF   ('&SESSION' NE 'SYSAS').SESS30A                     @M1A 61100000
         MVI   56(1),1       SESSION = SYSAS                       @M1A 61150000
         AGO   .SESS30K                                            @M1A 61200000
.SESS30A ANOP                                                      @M1A 61250000
         AIF   ('&SESSION' NE 'COMMAND').SESS30B                   @M1A 61300000
         MVI   56(1),2       SESSION = COMMAND                     @M1A 61350000
         AGO   .SESS30K                                            @M1A 61400000
.SESS30B ANOP                                                      @M1A 61450000
         AIF   ('&SESSION' NE 'CONSOPER').SESS30D                  @M1A 61500000
         MVI   56(1),3       SESSION = CONSOPER                    @M1A 61550000
         AGO   .SESS30K                                            @M1A 61600000
.SESS30D ANOP                                                      @M1A 61650000
         AIF   ('&SESSION' NE 'STARTED').SESS30E                   @M1A 61700000
         MVI   56(1),4       SESSION = STARTED                     @M1A 61750000
         AGO   .SESS30K                                            @M1A 61800000
.SESS30E ANOP                                                      @M1A 61850000
         AIF   ('&SESSION' NE 'MOUNT').SESS30F                     @M1A 61900000
         MVI   56(1),5       SESSION = MOUNT                       @M1A 61950000
         AGO   .SESS30K                                            @M1A 62000000
.SESS30F ANOP                                                      @M1A 62050000
         AIF   ('&SESSION' NE 'TSO').SESS30G                       @M1A 62100000
         MVI   56(1),6       SESSION = TSO                         @M1A 62150000
         AGO   .SESS30K                                            @M1A 62200000
.SESS30G ANOP                                                      @M1A 62250000
         AIF   ('&SESSION' NE 'INTBATCH').SESS30H                  @D4C 62300000
         MVI   56(1),7       SESSION = INTERNAL BATCH JOB          @M1A 62350000
         AGO   .SESS30K                                            @M1A 62400000
.SESS30H ANOP                                                      @M1A 62450000
         AIF   ('&SESSION' NE 'INTXBM').SESS30J                    @D7C 62500000
         MVI   56(1),8       SESSION = INTERNAL XBM                @D7C 62550000
         AGO   .SESS30K                                            @M1A 62600000
.SESS30J ANOP                                                      @M1A 62650000
         AIF   ('&SESSION' NE 'RJEOPER').SESS30L                   @M1A 62700000
         MVI   56(1),9       SESSION = RJEOPER                     @M1A 62750000
         AGO   .SESS30K                                            @M1A 62800000
.SESS30L ANOP                                                      @M1A 62850000
         AIF   ('&SESSION' NE 'NJEOPER').SESS30M                   @D3C 62900000
         MVI   56(1),10      SESSION = NJEOPER                     @M1A 62950000
         AGO   .SESS30K                                            @M1A 63000000
.SESS30M ANOP                                                      @D3A 63050000
         AIF   ('&SESSION' NE 'TKNUNKWN').SESS30N                  @D6C 63100000
         MVI   56(1),11      SESSION = NJE UNKNOWN USER            @D3A 63150000
         AGO   .SESS30K                                            @D3A 63200000
.SESS30N ANOP                                                      @D4A 63250000
         AIF   ('&SESSION' NE 'EXTBATCH').SESS30P                  @D4A 63300000
         MVI   56(1),12    SESSION = EXTERNAL BATCH                @D4A 63350000
         AGO   .SESS30K                                            @D4A 63400000
.SESS30P ANOP                                                      @D4A 63450000
         AIF   ('&SESSION' NE 'RJEBATCH').SESS30Q                  @D4A 63500000
         MVI   56(1),13    SESSION = RJE JOB                       @D4A 63550000
         AGO   .SESS30K                                            @D4A 63600000
.SESS30Q ANOP                                                      @D4A 63650000
         AIF   ('&SESSION' NE 'NJEBATCH').SESS30R                  @D5C 63700000
         MVI   56(1),14    SESSION = NJE JOB                       @D4A 63750000
         AGO   .SESS30K                                            @D5A 63800000
.SESS30R ANOP                                                      @D5A 63850000
         AIF   ('&SESSION' NE 'NJSYSOUT').SESS30S                  @D7C 63900000
         MVI   56(1),15    SESSION = NJE SYSOUT                    @D5A 63950000
         AGO   .SESS30K                                            @M4A 64000000
.SESS30S ANOP                                                      @D7A 64050000
         AIF   ('&SESSION' NE 'EXTXBM').SESS30T                    @D7A 64100000
         MVI   56(1),16    SESSION = EXTERNAL XBM                  @D7A 64150000
         AGO   .SESS30K                                            @M4A 64200000
.SESS30T ANOP                                                      @D7A 64250000
         AIF   ('&SESSION' NE 'RJEXBM').SESS30U                    @D7A 64300000
         MVI   56(1),17    SESSION = RJE XBM                       @D7A 64350000
         AGO   .SESS30K                                            @M4A 64400000
.SESS30U ANOP                                                      @D7A 64450000
         AIF   ('&SESSION' NE 'NJEXBM').SESS30V                    @M3C 64500000
         MVI   56(1),18    SESSION = NJE XBM                       @D7A 64550000
         AGO   .SESS30K                                            @M4A 64600000
.SESS30V ANOP                                                      @D7A 64650000
         AIF   ('&SESSION' NE 'APPCTP').SESS3ND                    @M3A 64700000
         MVI   56(1),19    SESSION = APPCTP                        @M3A 64750000
.SESS3ND ANOP                                                      @M1A 64800000
.SESS30K ANOP                                                     1@P9D 64850000
&BIT0    SETA  0                                                   @P3A 64900000
&BIT1    SETA  0                                                   @P3A 64950000
&BIT2    SETA  0                                                   @D1A 65000000
&BIT3    SETA  0                                                   @D1A 65050000
&BIX0    SETA  1                                                   @M1A 65100000
&BIX1    SETA  1                                                   @M2A 65150000
         AIF   ('&TRUSTED' EQ '').CHKRMT                           @D1C 65200000
&BIT2    SETA  1                  INDICATE TRUSTED WAS CODED       @D1A 65250000
         AIF   ('&TRUSTED' NE 'YES').RINT34A                       @M1A 65300000
&BIT0    SETA  1                                                   @M1A 65350000
         AGO   .CHKRMT                                             @P3A 65400000
.RINT34A ANOP                                                      @M1A 65450000
&BIX0    SETA  0                                                   @P3A 65500000
.CHKRMT  ANOP                                                      @P3A 65550000
         AIF   ('&REMOTE' EQ '').CHKTRU                            @D1C 65600000
&BIT3    SETA  1                  INDICATE REMOTE  WAS CODED       @D1A 65650000
         AIF   ('&REMOTE' NE 'YES').RINT34B                        @M2A 65700000
&BIT1    SETA  1                                                   @M2A 65750000
         AGO   .CHKTRU                                             @P3A 65800000
.RINT34B ANOP                                                      @M2A 65850000
&BIX1    SETA  0                                                   @P3A 65900000
.CHKTRU  ANOP                                                      @P3A 65950000
         AIF   (T'&TRUSTED NE 'O').RINT34G                         @P3A 66000000
         AIF   (T'&REMOTE NE 'O').RINT34G                          @P3A 66050000
         AGO   .RINT352                                            @P3A 66100000
.RINT34G ANOP                                                      @M1A 66150000
         AIF   ('&BIX0&BIX1.000000' EQ '11000000').RINTOR          @D1C 66200000
         NI    57(1),B'&BIX0&BIX1.110000'                          @D1C 66250000
.RINTOR  ANOP                                                      @P3A 66300000
         AIF   ('&BIT0&BIT1&BIT2&BIT3.0000' EQ '00000000').RINT352 @D1C 66350000
         OI    57(1),B'&BIT0&BIT1&BIT2&BIT3.0000'                  @D1C 66400000
.RINT352 ANOP                                                      @M1A 66450000
         AIF   ('&SECLABL' EQ '').RINT354                          @M1A 66500000
         AIF   ('&SECLABL'(1,1) NE '(').RINT353                    @M1A 66550000
         ST    &SECLABL(1),60(1)    - SECLABEL ADDRESS             @M1A 66600000
         AGO   .RINT354                                            @M1A 66650000
.RINT353 ANOP                                                      @M1A 66700000
         LA    0,&SECLABL     -MOVE SECLABL ADDRESS                @M1A 66750000
         ST    0,60(1)        -INTO PARM LIST                      @M1A 66800000
.RINT354 ANOP                                                      @M1A 66850000
         AIF   ('&EXENODE' EQ '').RINT356                          @M1A 66900000
         AIF   ('&EXENODE'(1,1) NE '(').RINT355                    @M1A 66950000
         ST    &EXENODE(1),64(1)    - EXENODE ADDRESS              @M1A 67000000
         AGO   .RINT356                                            @M1A 67050000
.RINT355 ANOP                                                      @M1A 67100000
         LA    0,&EXENODE     -MOVE EXENODE ADDRESS                @M1A 67150000
         ST    0,64(1)        -INTO PARM LIST                      @M1A 67200000
.RINT356 ANOP                                                      @M1A 67250000
         AIF   ('&SUSERID' EQ '').RINT358                          @M1A 67300000
         AIF   ('&SUSERID'(1,1) NE '(').RINT357                    @M1A 67350000
         ST    &SUSERID(1),68(1)    - SUSERID ADDRESS              @M1A 67400000
         AGO   .RINT358                                            @M1A 67450000
.RINT357 ANOP                                                      @M1A 67500000
         LA    0,&SUSERID     -MOVE SUSERID ADDRESS                @M1A 67550000
         ST    0,68(1)        -INTO PARM LIST                      @M1A 67600000
.RINT358 ANOP                                                      @M1A 67650000
         AIF   ('&SNODE' EQ '').RINT360                            @M1A 67700000
         AIF   ('&SNODE'(1,1) NE '(').RINT359                      @M1A 67750000
         ST    &SNODE(1),72(1)    - SNODE ADDRESS                  @M1A 67800000
         AGO   .RINT360                                            @M1A 67850000
.RINT359 ANOP                                                      @M1A 67900000
         LA    0,&SNODE       -MOVE SNODE ADDRESS                  @M1A 67950000
         ST    0,72(1)        -INTO PARM LIST                      @M1A 68000000
.RINT360 ANOP                                                      @M1A 68050000
         AIF   ('&SGROUP' EQ '').RINT362                           @M1A 68100000
         AIF   ('&SGROUP'(1,1) NE '(').RINT361                     @M1A 68150000
         ST    &SGROUP(1),76(1)    - SGROUP ADDRESS                @M1A 68200000
         AGO   .RINT362                                            @M1A 68250000
.RINT361 ANOP                                                      @M1A 68300000
         LA    0,&SGROUP      -MOVE SGROUP ADDRESS                 @M1A 68350000
         ST    0,76(1)        -INTO PARM LIST                      @M1A 68400000
.RINT362 ANOP                                                      @M1A 68450000
         AIF   ('&POE' EQ '').RINT364                              @M1A 68500000
         AIF   ('&POE'(1,1) NE '(').RINT363                        @M1A 68550000
         ST    &POE(1),80(1)    - POE ADDRESS                      @M1A 68600000
         AGO   .RINT364                                            @M1A 68650000
.RINT363 ANOP                                                      @M1A 68700000
         LA    0,&POE         -MOVE POE ADDRESS                    @M1A 68750000
         ST    0,80(1)        -INTO PARM LIST                      @M1A 68800000
.RINT364 ANOP                                                      @M1A 68850000
         AIF   ('&TOKNIN' EQ '').RINT366                           @D2C 68900000
         AIF   ('&TOKNIN'(1,1) NE '(').RINT365                     @D2C 68950000
         ST    &TOKNIN(1),84(1)   - INPUT TOKEN ADDRESS            @D2C 69000000
         AGO   .RINT366                                            @M1A 69050000
.RINT365 ANOP                                                      @M1A 69100000
         LA    0,&TOKNIN      -MOVE INPUT TOKEN ADDRESS            @D2C 69150000
         ST    0,84(1)        -INTO PARM LIST                      @M1A 69200000
.RINT366 ANOP                                                      @M1A 69250000
         AIF   ('&STOKEN' EQ '').RINT368                           @M1A 69300000
         AIF   ('&STOKEN'(1,1) NE '(').RINT367                     @M1A 69350000
         ST    &STOKEN(1),88(1)    - STOKEN ADDRESS                @M1A 69400000
         AGO   .RINT368                                            @M1A 69450000
.RINT367 ANOP                                                      @M1A 69500000
         LA    0,&STOKEN      -MOVE STOKEN ADDRESS                 @M1A 69550000
         ST    0,88(1)        -INTO PARM LIST                      @M1A 69600000
.RINT368 ANOP                                                      @M1A 69650000
         AIF   ('&LOGSTR' EQ '').RINT370                           @M1A 69700000
         AIF   ('&LOGSTR'(1,1) NE '(').RINT369                     @M1A 69750000
         ST    &LOGSTR(1),92(1)    - LOGSTR ADDRESS                @M1A 69800000
         AGO   .RINT370                                            @M1A 69850000
.RINT369 ANOP                                                      @M1A 69900000
         LA    0,&LOGSTR      -MOVE LOGSTR ADDRESS                 @M1A 69950000
         ST    0,92(1)        -INTO PARM LIST                      @M1A 70000000
.RINT370 ANOP                                                      @M1A 70050000
         AIF   ('&TOKNOUT' EQ '').RINT372                          @D2A 70100000
         AIF   ('&TOKNOUT'(1,1) NE '(').RINT371                    @D2A 70150000
         ST    &TOKNOUT(1),96(1)    - OUTPUT TOKEN ADDRESS         @D2A 70200000
         AGO   .RINT372                                            @D2A 70250000
.RINT371 ANOP                                                      @D2A 70300000
         LA    0,&TOKNOUT     -MOVE OUTPUT TOKEN ADDRESS           @D2A 70350000
         ST    0,96(1)        -INTO PARM LIST                      @D2A 70400000
.RINT372 ANOP                                                      @D2A 70450000
.*                                                                 @M4A 70500000
.* CHECK FOR ENVRIN                                                @M4A 70550000
.*                                                                 @M4A 70600000
         AIF   ('&ENVRIN' EQ '').RINT376                           @M4A 70650000
         AIF   ('&ENVRIN'(1,1) NE '(').RINT375                     @M4A 70700000
         ST    &ENVRIN(1),100(1)    - ENVR D.S. ADDRESS            @M4A 70750000
         AGO   .RINT376                                            @M4A 70800000
.RINT375 ANOP                                                      @M4A 70850000
         LA    0,&ENVRIN      -MOVE ENVR D.S. ADDRESS              @M4A 70900000
         ST    0,100(1)       -INTO PARM LIST                      @M4A 70950000
.RINT376 ANOP                                                      @M4A 71000000
.*                                                                 @M4A 71050000
.* CHECK FOR ENVROUT                                               @M4A 71100000
.*                                                                 @M4A 71150000
         AIF   ('&ENVROUT' EQ '').RINT378                          @M4A 71200000
         AIF   ('&ENVROUT'(1,1) NE '(').RINT377                    @M4A 71250000
         ST    &ENVROUT(1),104(1)   - ENVR D.S. ADDRESS            @M4A 71300000
         AGO   .RINT378                                            @M4A 71350000
.RINT377 ANOP                                                      @M4A 71400000
         LA    0,&ENVROUT     -MOVE ENVR D.S. ADDRESS              @M4A 71450000
         ST    0,104(1)       -INTO PARM LIST                      @M4A 71500000
.RINT378 ANOP                                                      @M4A 71550000
.*                                                                      71600000
.* PRODUCE SVC ENTRY CODE AND EXIT -LIST MODIFICATION DONE              71650000
         AGO   .RINT221                                                 71700000
.* DIAGNOSTICS   *.                                                     71750000
.ERR002  ANOP                                                           71800000
         MNOTE 8,'*** INVALID ENVIR PARAMETER ***'                      71850000
         AGO   .ERTN002                                                 71900000
.ERR003  ANOP                                                  @PC003PY 71950000
         MNOTE 8,'*** INVALID SMC PARAMETER ***'               @PC003PY 72000000
         AGO   .ERTN003                                        @PC003PY 72050000
.ERR004  ANOP                                                  @PC003PY 72100000
         MNOTE 8,'*** INVALID PASSCHK PARAMETER ***'           @PC003PY 72150000
         AGO   .ERTN004                                        @PC003PY 72200000
.ERR005  ANOP                                                      @L6A 72250000
         MNOTE 8,'*** INVALID STAT PARAMETER ***'                  @L6A 72300000
         AGO   .ERTN005                                            @L6A 72350000
.ERR006  ANOP                                                      @L6A 72400000
         MNOTE 8,'*** INVALID ENCRYPT PARAMETER ***'               @L6A 72450000
         AGO   .ERTN006                                            @L6A 72500000
.ERR007  ANOP                                                      @L7A 72550000
         MNOTE 8,'*** INVALID LOG PARAMETER ***'                   @L7A 72600000
         AGO   .ERTN007                                            @L7A 72650000
.ERR008  ANOP                                                      @L7A 72700000
         MNOTE 8,'*** INVALID LOC PARAMETER ***'                   @L7A 72750000
         AGO   .ERTN008                                            @L7A 72800000
.ERR009  ANOP                                                      @L7A 72850000
         MNOTE 8,'*** ''LOC'' ALLOWED ONLY IF RACINIT IS INVOKED FROM T+72900000
               HE RACROUTE MACRO ***'                              @L7A 72950000
         AGO   .ERTN009                                            @L7A 73000000
.ERR010  ANOP                                                      @M1A 73050000
         MNOTE 8,'*** INVALID TRUSTED PARAMETER ***'               @M1A 73100000
         AGO   .ERTN010                                            @M1A 73150000
.ERR011  ANOP                                                      @M1A 73200000
         MNOTE 8,'*** INVALID SESSION PARAMETER ***'               @M1A 73250000
         AGO   .ERTN020                                            @M1A 73300000
.ERR012  ANOP                                                      @M2A 73350000
         MNOTE 8,'*** INVALID REMOTE PARAMETER  ***'               @M2A 73400000
         AGO   .ERTN030                                            @M2A 73450000
.ERR013  ANOP                                                      @P9A 73500000
         MNOTE 8,'*** INVALID ''SUBPOOL'' PARAMETER ***'           @P9A 73550000
         AGO   .ERTN013                                            @P9A 73600000
.ERR01   ANOP                                                           73650000
         MNOTE 8,'*** REGISTER FORM OF ADDRESS PARAMETER NOT VALID WITH-73700000
                LIST FORM***'                                           73750000
         AGO   .ERTN01                                                  73800000
.ERR02   ANOP                                                           73850000
         MNOTE 8,'*** ONLY REGS 2-12 VALID FOR ADDRESSES***'            73900000
         AGO   .ERTN02                                                  73950000
.ERR04   ANOP                                                           74000000
         MNOTE 8,'*** INVALID MACRO FORM PARAMETER ***'                 74050000
         AGO   .ERTN04                                                  74100000
.ERR05   ANOP                                                           74150000
         MNOTE 8,'*** ENVIR INVALID WITH &NAME2 ***'                    74200000
         AGO   .ERTN05                                                  74250000
.ERR06   ANOP                                                           74300000
         MNOTE 8,'*** ''APPL'' FORM NOT ALLOWED WITH MF=E OR MF=M ***'  74350000
.*                                                                 @M4C 74400000
         AGO   .ERTN06                                                  74450000
.ERR07   ANOP                                                           74500000
         MNOTE 8,'*** ''VERIFY'' ALLOWED ONLY IF RACINIT IS INVOKED  FR*74550000
               OM THE RACROUTE MACRO ***'                      @L6A     74600000
         AGO   .ERTN07                                                  74650000
.ERR08   ANOP                                                           74700000
         MNOTE 8,'*** KEYWORDS  ALLOWED ONLY IF RACINIT IS INVOKED  FRO*74750000
               M THE RACROUTE MACRO ***'                           @M1A 74800000
         AGO   .ERTN01                                             @M1A 74850000
.ERR09   ANOP                                                           74900000
         MNOTE 8,'*** ''RELEASE'' INCOMPATIBLE WITH SPECIFIED KEYWORD(SX74950000
               ) ***'                                              @M1A 75000000
         AGO   .ERTN021                                            @P2A 75050000
.ERR10   ANOP                                                           75100000
         MNOTE 8,'*** ''RELEASE'' INCOMPATIBLE WITH &MVALUE  ***'  @M1A 75150000
         AGO   .ERTN01                                                  75200000
.ERR11   ANOP                                                           75250000
         MNOTE 8,'*** ''VERIFYX'' ALLOWED ONLY IF RACINIT IS INVOKED FR*75300000
               OM THE RACROUTE MACRO ***'                          @M1A 75350000
         AGO   .ERTN07                                                  75400000
.ERR12   ANOP                                                      @M4A 75450000
         MNOTE 8,'*** ''RELEASE'' INCOMPATIBLE WITH SPECIFIED KEYWORD(SX75500000
               ) ***'                                              @M4A 75550000
         AGO   .ERTN022                                            @M4A 75600000
.ERR13   ANOP                                                      @M4A 75650000
         MNOTE 8,'*** "LOG=NONE" IS SUPPORTED BY RELEASE 1.9.2 AND LATEX75700000
               R ONLY ***'                                         @M4A 75750000
         AGO   .ERTN023                                            @M4A 75800000
.ERVSE1  ANOP                                                  @D62CDHH 75810000
         MNOTE 8,'*** RACINIT CAN BE INVOKED ONLY VIA RACROUTE FOR VSE/-75820000
               ESA  ***'                                       @D62CDHH 75830000
         AGO   .ERVSE1R                                        @D62CDHH 75833300
.ERLVL1  MNOTE 8,'*** INCORRECT SPECIFICATION OF ''RELEASE'' ***'  @L7A 75850000
         AGO   .ERLVL1R                                            @L7A 75900000
.ERLVL2  MNOTE 4,'*** ''RELEASE-CHECK'' ONLY VALID WITH ''MF=E'' ***'  X75950000
                                                                   @L7A 76000000
         AGO   .ERLVL2R                                            @L7A 76050000
.ERLVLA  MNOTE 4,'*** ''RELEASE'' INCOMPATIBLE WITH SPECIFIED KEYWORD(SX76100000
               ) ***'                                              @L7A 76150000
         AGO   .ERLVLAR                                            @L7A 76200000
         MEND                                                           76250000
**/                                                                     76300000
*   RACINIT :                                                           76350000
* MACRO                                                                 76400000
*   KEYS(USERID,PASSWRD,NEWPASS,START,GROUP,INSTLN,ENVIR,MF,            76450000
*        PGMNAME,ACTINFO,OIDCARD,TERMID,JOBNAME,                        76500000
*        APPL,ACEE,SMC,SUBPOOL,PASSCHK,                                 76550000
*        STAT,ENCRYPT,LOG,LOC);  /*                              @L7A*/ 76600000
*        ANS('?'||MACLABEL||'RACINITP '||MACLIST||MACKEYS||';');        76650000
*%END;                                                                  76700000
