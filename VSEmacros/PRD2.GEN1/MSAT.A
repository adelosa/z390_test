         MACRO                                                          00050000
&NAME    MSAT  &ID=,                                                   *00100000
               &AREA=,                                                 *00150000
               &LEN=,                                                  *00200000
               &LOGUNIT=,                                              *00250000
               &CHNUNIT=,                                              *00300000
               &PID=,                                                  *00350000
               &MFG=,                                                  *00400000
               &PHYUNIT=,                                              *00450000
               &MODE=                                                   00500000
.*                                                                      00550000
         LCLA  &TID,&TMFG                                               00600000
         LCLA  &TOFF                                                    00650000
         LCLA  &TLEN                                                    00700000
         LCLA  &MFGLEN,&FLAGBYT                                @D21LDRP 00750000
         LCLB  &TLOG,&TCHN,&TPHY,&TPID                         @D14BDFG 00800000
         LCLB  &TAREA                                                   00850000
         LCLB  &TMODE                                          @D21LDRP 00900000
         LCLC  &TADDR,&BADDR                                            00950000
         LCLC  &LABEL                                                   01000000
.*                                                                      01050000
*********************************************************************** 01100000
*                                                                       01150000
.*       IBM VSE / ADVANCED FUNCTIONS                          @D31UDGN 01200000
*        SUPERVISOR - MSAT - 5686-007-06-C440                  @D31UDGN 01250000
.*                                                                      01300000
         AGO   .CPRIGHT                                                 01350000
.*                                                                      01400000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"           @D31UDGN 01450000
*        5686-007 (C) COPYRIGHT IBM CORP. 1979, 1989           @D31UDGN 01500000
*        ALL RIGHTS RESERVED                                   @D31UDGN 01550000
*        LICENSED MATERIALS - PROGRAM PROPERTY OF IBM          @D31UDGN 01600000
.*       SEE COPYRIGHT INSTRUCTIONS, G120-2083                 @D31UDGN 01650000
.*                                                                      01700000
.CPRIGHT ANOP                                                           01750000
.*                                                                      01800000
*                                                                       01850000
*********************************************************************** 01900000
.*                                                                      01950000
.**** START OF SPECIFICATIONS ***************************************** 02000000
.*                                                                      02050000
.*01* MODULE-TYPE = MACRO                                               02100000
.*                                                                      02150000
.*01* DESCRIPTIVE NAME = MANIPULATES ASSIGNMENT INFORMATION    @D149DFG 02200000
.*  STATUS           =  NEW MACRO - FIRST RELEASE VSE/AF REL.3.0        02250000
.*  FUNCTION         =  MACRO CHECKS USER GIVEN PARAMETERS FOR          02300000
.*                      MANIPULATION OF ASSIGNMENTS.           @D149DFG 02350000
.*  NOTES            =                                                  02400000
.*  DEPENDENCIES     =                                                  02450000
.*  RESTRICTIONS     =                                                  02500000
.*  REGISTER CONVENT.=  REGISTER 1 USED BY MACRO AS POINTER TO          02550000
.*                      PARAMETER LIST FOR SVC 112                      02600000
.*                      REGISTER 15 USED AS RETURNCODE REGISTER         02650000
.*                      REGISTER 0 USED BY MACRO FOR S-TYPE             02700000
.*                      NOTATION                                        02750000
.*  PATCH LABEL      =  NONE                                            02800000
.*  MACRO TYPE       =  ASSEM                                           02850000
.*  PROCESSOR        =  ASM                                             02900000
.*  MACRO SIZE       =                                                  02950000
.*  ATTRIBUTES       =                                                  03000000
.*  ENTRY POINT      =  MSAT                                            03050000
.*  PURPOSE          =  SEE FUNCTION                                    03100000
.*  LINKAGE          =                                                  03150000
.*  CALLER           =                                                  03200000
.*  INPUT            =   (CALLING SEQUENCE)                             03250000
.*        LABEL   MSAT     ID=INQ|ALT|ALP|DEL|NXT|PER|RSU|RTM|TEM|      03300000
.*                            XTM|RSA|RTL|RTP|CKU|NPM|NTM|DRL| @D149DFG 03350000
.*                            PST|PSP|DVU|DVR|RTL1             @D51ODGL 03400052
.*                         LOGUNIT=(NAME1 |(S,NAME1)| (R1) ),           03450000
.*                         CHNUNIT=(NAME2 |(S,NAME2)| (R2) ),           03500000
.*                         PHYUNIT=(NAME7 |(S,NAME7)| (R7) ),  @D149DFG 03550000
.*                         AREA=(NAME5 |(S,NAME5)| (R5) ),              03600000
.*                         LEN=(NAME6 | (R6) ),                         03650000
.*                         PID=(NAME3 |(S,NAME3)| (R3) ),               03700000
.*                         MFG=(NAME4 |(S,NAME4)| (R4) ),               03750000
.*                         MODE=('YES' |NAME8|(S,NAME8)|(R8) ) @D21LDRP 03800000
.*                                                                      03850000
.*                      OPERANDS :                                      03900000
.*                      ID = INDICATES REQUESTED INFORMATION            03950000
.*                      LOGUNIT = ADDR OF HALFWORD CONT. LOGICAL UNIT   04000000
.*                      CHNUNIT = ADDR OF HALFWORD CONTAINING PHYSICAL  04050000
.*                             UNIT('CUU')                              04100000
.*                      PHYUNIT = ADDR OF HALFWORD CONTAINING  @D149DFG 04150000
.*                             PUB INDEX                       @D149DFG 04200000
.*                      AREA = ADDRESS OF AREA WHERE RETRIEVED INFOR-   04250000
.*                             MATION IS TO BE RETURNED (RESTRICTED     04300000
.*                             TO ID=RTL|RTP).                          04350000
.*                      LEN = LENGTH OF AREA IN BYTES (RESTRICTED TO    04400000
.*                            ID=RTL|RTP).                              04450000
.*                      PID  = ADDR OF HALFWORD CONTAINING THE PIK      04500000
.*                             (DEFAULT : PIK OF PART. OF ISSUING PROG) 04550000
.*                      MFG  = ADDR OF 20 OR 24 BYTE WORKAREA WHERE THE 04600000
.*                             PARMLIST FOR SVC IS TO BE STORED.        04650000
.*                      MODE = ADDR OF 1 BYTE AREA CONTAINING  @D21LDRP 04700000
.*                                THE MODE BYTE                @D21LDRP 04750000
.*                             MODE='YES' INDIC. MODE HANDL.   @D21LDRP 04800000
.*                                                                      04850000
.*                      THE S-TYPE NOTATION (S,NAMEX) WILL GENERATE     04900000
.*                      A LA- AND ST-INSTRUCTION USING REGISTER 0.      04950000
.*                      EXCEPTION: MFG, S-TYPE IS ACCEPTED FOR EASEOF   05000000
.* USE, NOT BECAUSE DIFFERENT CODE IS GENERATED                         05050000
.*                                                                      05100000
.*                                                                      05150000
.*                                                                      05200000
.*  OUTPUT(ASSEMBLER)=  PARMLIST OF FOLLOWING FORMAT GENERATED          05250000
.*                                                                      05300000
.*           REG1 --> 0 -------------------------------------           05350000
.*                      |  ID    | FLAG   |       LEN       |  @D21LDRP 05400000
.*                    4 -------------------------------------           05450000
.*                      |         ADDR (LOGUNIT)            |           05500000
.*                    8 -------------------------------------           05550000
.*                      |         ADDR (CHANUNIT|PHYUNIT)   |  @D149DFG 05600000
.*                   12 -------------------------------------           05650000
.*                      |         ADDR (PIK)                |           05700000
.*                   16 -------------------------------------           05750000
.*                      |         ADDR (AREA)               |           05800000
.*                   20 -------------------------------------           05850000
.*                      |         ADDR (MODE) (OPTIONAL)    |  @D21LDRP 05900000
.*                      -------------------------------------           05950000
.*                                                                      06000000
.*                                                                      06050000
.*                    ID = X'00' FOR INQ                                06100000
.*                         X'01' FOR ALT                                06150000
.*                         X'02' FOR ALP                                06200000
.*                         X'03' FOR DEL                                06250000
.*                         X'04' FOR NXT                                06300000
.*                         X'05' FOR PER                                06350000
.*                         X'06' FOR RSU                                06400000
.*                         X'07' FOR RTM                                06450000
.*                         X'08' FOR TEM                                06500000
.*                         X'09' FOR XTM                                06550000
.*                         X'0A' FOR RSA                                06600000
.*                         X'0B' FOR RTL                                06650000
.*                         X'0C' FOR RTP                                06700000
.*                         X'0D' FOR CKU                                06750000
.*                         X'0E' FOR NPM                       @D149DFG 06800000
.*                         X'0F' FOR NTM                       @D149DFG 06850000
.*                         X'10' FOR DRL                       @D149DFG 06900000
.*                         X'11' FOR PST                       @D14BDFG 06950000
.*                         X'12' FOR PSP                       @D14BDFG 07000000
.*                         X'13' FOR DVU                       @D14BDFG 07050000
.*                         X'14' FOR DVR                       @D14BDFG 07100000
.*                         X'15' FOR RTL1                      @D51ODGL 07125052
.*                                                                      07150000
.*  OUTPUT(EXECUTION)=  ID = INQ                                        07200000
.*                      A RETURNCODE IS GIVEN INDICATING THE            07250000
.*                      TYPES OF STORED ASSIGNMENTS FOR THE             07300000
.*                      SPECIFIED LOGICAL UNIT                          07350000
.*                                                                      07400000
.*                      ID = ALT                                        07450000
.*                      THE PHYSICAL UNIT SPECIFIED IN CHNUNIT IS       07500000
.*                      IS STORED AS TEMPORARY,ALTERNATE UNIT           07550000
.*                                                                      07600000
.*                      ID = ALP                                        07650000
.*                      THE PHYSICAL UNIT SPECIFIED IN CHNUNIT IS       07700000
.*                      IS STORED AS PERMANENT,ALTERNATE UNIT           07750000
.*                                                                      07800000
.*                      ID = DEL                                        07850000
.*                      THE STORED PERMANENT ASSIGNMENT AND ALL         07900000
.*                      ALTERNATE ONES -IF ANY- ARE DELETED.            07950000
.*                      IF MODE='YES' IS SPECIFIED IN ADDITION,@D21LDRP 08000000
.*                      THE TEMP. MODE IS RESET FOR EACH       @D21LDRP 08050000
.*                      DELETED ASSIGNMENT                     @D21LDRP 08100000
.*                                                                      08150000
.*                      ID = NXT                                        08200000
.*                      THE CURRENT ASSIGNMENT IS STORED AS THE LAST    08250000
.*                      ALTERNATE ONE IN THE PERTINENT CHAIN            08300000
.*                      I.E. EITHER THE PERMANENT OR THE TEMPORARY      08350000
.*                      ONE. THE FIRST ALTERNATE IS MADE THE CURRENT    08400000
.*                      ONE IF THE DEVICE IS NOT DOWN. THE MODE BYTE IS 08450000
.*                      MOVED FROM THE ORIGINAL CURRENT TO THE NEW      08500000
.*                      CURRENT ONE. IF THE LOGUNIT IS SYSPCH/SYSLST    08550000
.*                      COMBINED TO SYSOUT THEN BOTH LUBS ARE UPDATED   08600000
.*                      WITH THE NEW CURRENT ASSIGNMENT FOUND FOR THE   08650000
.*                      LOGUNIT JUST PROCESSED.                         08700000
.*                                                                      08750000
.*                      ID = PER                                        08800000
.*                      THE CURRENT ASSIGNMENT (LUB VALUE) IS STORED    08850000
.*                      AS THE PERMANENT ASSIGNMENT.                    08900000
.*                                                                      08950000
.*                      ID = RSU                                        09000000
.*                      THE LUB OF LOGUNIT SPECIFIED IS RESET TO THE    09050000
.*                      STORED PERMANENT ASSIGNMENT OR UNASSIGN. ANY    09100000
.*                      TEMPORARY, ALTERNATE ASSIGNMENTS ARE DELETED.   09150000
.*                                                                      09200000
.*                      ID = RTM                                        09250000
.*                      THE LUB OF LOGUNIT SPECIFIED IS RESET TO THE    09300000
.*                      STORED TEMPORARY OR PERMANENT ASSIGNMENT.       09350000
.*                      RESTRICTED TO THE LOGICAL UNITS SYSRDR|SYSIPT.  09400000
.*                                                                      09450000
.*                      ID = TEM                                        09500000
.*                      THE LUB OF LOGUNIT SPECIFIED IS STORED IN       09550000
.*                      ADDITION TO THE PERMANENT ONE. THIS FUNCTION IS 09600000
.*                      RESTRICTED TO THE LOGICAL UNITS SYSRDR|SYSIPT.  09650000
.*                                                                      09700000
.*                      ID = XTM                                        09750000
.*                      THE LUB OF LOGUNIT SPECIFIED IS EXCHANGED WITH  09800000
.*                      THE STORED TEMPORARY ASSIGNMENT OR WITH THE     09850000
.*                      STORED PERMANENT ASSIGNMENT IF NO TEMPORARY     09900000
.*                      ONE EXISTS.                                     09950000
.*                                                                      10000000
.*                      ID = RSA                                        10050000
.*                      STARTING WITH THE LOGUNIT SPECIFIED THE LUBS    10100000
.*                      OF ALL HIGHER SYSTEM LOGICAL UNITS OR           10150000
.*                      PROGRAMMER LOGICAL UNITS OF THE SPECIFIED       10200000
.*                      PARTITION ARE RESET TO THE SAVED PERMANENT      10250000
.*                      ASSGN OR UNASSGN. ANY TEMPORARY ALTERNATE       10300000
.*                      ASSIGNMENTS ARE DELETED.                        10350000
.*                                                                      10400000
.*                      ID = RTL                                        10450000
.*                      FOR THE SPECIFIED LOGUNIT, THE CURRENT          10500000
.*                      ASSIGNMENT AND ALL STORED ASSIGNMENTS ARE       10550000
.*                      RETURNED TOGETHER WITH AN INDICATION OF         10600000
.*                      THEIR TYPE.                                     10650000
.*                      THE RTL SERVICES INDICATED THE FACT    @D51ODGL 10652252
.*                      THAT A LOGICAL UNIT WAS ASSIGNED IGNORE@D51ODGL 10654452
.*                      OR UNASSIGN BY RETURNING A VALUE OF    @D51ODGL 10656652
.*                      X'00FE' AND X'00FF' RESPECTIVELY.      @D51ODGL 10658852
.*                      IN CASE OF A MORE DEVICES SYSTEM, I.E. @D51ODGL 10661052
.*                      A SYSTEM GENERATED WITH AN IODEV=      @D51ODGL 10663252
.*                      PARAMETER > 254, THIS VALUE COULD NOT  @D51ODGL 10665452
.*                      BE MAINTAINED ANY MORE. IT WOULD BE    @D51ODGL 10667652
.*                      AMBIGUOUS, SINCE IT COULD ALSO DENOTE  @D51ODGL 10669852
.*                      THE PUB WITH A PUBINDEX OF X'00FE' OR  @D51ODGL 10672052
.*                      X'00FF'. HENCE:                        @D51ODGL 10674252
.*                      ID = RTL1                              @D51ODGL 10676452
.*                      WAS INTRODUCED. IT SUPPLIES THE SAME   @D51ODGL 10678652
.*                      INFORMATION AS THE RTL SERVICE, BUT    @D51ODGL 10680852
.*                      IGNORED IS ALWAYS INDICATED BY A       @D51ODGL 10683052
.*                      VALUE OF X'FFFE' AND UNASSIGNED BY     @D51ODGL 10685252
.*                      X'FFFF'. THE OLD RTL SERVICE IS        @D51ODGL 10687452
.*                      ONLY PERMITTED IN A TRANSPARENCY MODE  @D51ODGL 10689652
.*                      SUPERVISOR. IT WILL BE CANCELED IF THE @D51ODGL 10691852
.*                      IODEV PARAMETER OF SUPERVISOR GENERA-  @D51ODGL 10694052
.*                      TION WAS SPECIFIED BIGGER THAN 254.    @D51ODGL 10696252
.*                                                                      10700000
.*                      ID = RTP                                        10750000
.*                      STARTING WITH THE LOGUNIT SPECIFIED, THE        10800000
.*                      LUB INDEX OF ALL HIGHER SYSTEM LOGICAL          10850000
.*                      UNITS OR PROGRAMMER UNITS OF THE SPECIFIED      10900000
.*                      PARTITION BEING ASSIGNED TO CHNUNIT DEVICE      10950000
.*                      IS RETURNED TOGETHER WITH AN INDICATION OF      11000000
.*                      THE TYPE OF ASSIGNMENT.                         11050000
.*                                                                      11100000
.*                      ID = CKU                                        11150000
.*                      STARTING WITH LOGUNIT SPECIFIED ALL HIGHER      11200000
.*                      SYSTEM LOGICAL UNITS OR PROGRAMMER LOGICAL      11250000
.*                      UNITS OF THE SPECIFIED PARTITION ARE CHECKED    11300000
.*                      IF THEY ARE ASSIGNED TO THE CHNUNIT DEVICE.     11350000
.*                      A RETURNCODE INDICATING THE RESULT IS GIVEN.    11400000
.*                                                             @D149DFG 11450000
.*                      ID = NPM                               @D149DFG 11500000
.*                      ALL ASSIGNMENTS FOR LOGUNIT ARE        @D149DFG 11550000
.*                      DELETED AND SPECIFIED PHYUNIT IS       @D149DFG 11600000
.*                      NOTED AS CURRENT PERMANENT ASSIGNMENT  @D149DFG 11650000
.*                      IF MODE IS SPECIFIED, THE GIVEN MODE   @D21LDRP 11700000
.*                      IS SET IN ADDITION.                    @D21LDRP 11750000
.*                                                                      11800000
.*                      ID = NTM                               @D149DFG 11850000
.*                      ALL TEMPORARY ASSIGNMENTS FOR LOGUNIT  @D149DFG 11900000
.*                      ARE DELETED AND SPECIFIED PHYUNIT IS   @D149DFG 11950000
.*                      NOTED AS CURRENT TEMPORARY ASSIGNMENT  @D149DFG 12000000
.*                      IF MODE IS SPECIFIED, THE GIVEN MODE   @D21LDRP 12050000
.*                      IS SET IN ADDITION.                    @D21LDRP 12100000
.*                                                                      12150000
.*                      ID = DRL                               @D149DFG 12200000
.*                      ANY PERMANENT AND TEMPORARY ASSIGNMENT @D149DFG 12250000
.*                      FOR LOGUNIT TO SPECIFIED CHNUNIT IS    @D149DFG 12300000
.*                      CHANGED TO UA AND ALL ITS ALTERNATES   @D149DFG 12350000
.*                      DELETED. ANY ALTERNATE ASSIGNMENT TO   @D149DFG 12400000
.*                      SPECIFIED CHNUNIT IS DELETED.          @D149DFG 12450000
.*                                                             @D149DFG 12500000
.*                      ID = PST                               @D149DFG 12550000
.*                      SPECIFIED DEVICE FLAGGED AS DUMMY      @D149DFG 12600000
.*                      DEVICE FOR SPOOLING BY POWER.          @D149DFG 12650000
.*                      ASSIGNMENTS ARE LEFT UNCHANGED BUT     @D149DFG 12700000
.*                      DEVICE OWNERSHIP IS RESET.             @D149DFG 12750000
.*                                                             @D149DFG 12800000
.*                      ID = PSP                               @D149DFG 12850000
.*                      SPECIFIED DEVICE NO LONGER USED AS     @D149DFG 12900000
.*                      DUMMY DEVICE IN SPECIFIED PART.        @D149DFG 12950000
.*                      ALL ASSIGNMENTS ARE RESET TO UA.       @D149DFG 13000000
.*                                                             @D149DFG 13050000
.*                      ID = DVU                               @D149DFG 13100000
.*                      SPECIFIED DEVICE TO BE ACCESSED BY     @D149DFG 13150000
.*                      PHYSICAL ADDRESSING IN SPECIFIED       @D149DFG 13200000
.*                      PARTITION. DEVICE OWNERSHIP IS         @D149DFG 13250000
.*                      UPDATED AND 2-BYTES PUB-INDEX IS       @D149DFG 13300000
.*                      RETURNED INTO SPECIFIED AREA.          @D149DFG 13350000
.*                                                             @D149DFG 13400000
.*                      ID = DVR                               @D149DFG 13450000
.*                      PHYSICAL ADDRESSING TO SPECIFIED       @D149DFG 13500000
.*                      DEVICE IN SPECIFIED PARTITION IS       @D149DFG 13550000
.*                      RELEASED. DEVICE OWNERSHIP IS UPDATED  @D149DFG 13600000
.*                      AND SPECIFIED PHYUNIT FIELD IS CHANGED @D149DFG 13650000
.*                      TO X'FFFF'.                            @D149DFG 13700000
.*                                                                      13750000
.*                                                                      13800000
.*                                                                      13850000
.*  EXIT NORMAL      =  COMPILER :                                      13900000
.*                      PARMLIST GENERATED                              13950000
.*                      EXECUTION:                                      14000000
.*                      REGISTER 15  =  0                               14050000
.*  EXIT ERROR       =  COMPILER :                                      14100000
.*                      MNOTES INDICATING THE ERROR                     14150000
.*                      EXECUTION:                                      14200000
.*                      RETURN CODES IN REGISTER 15:                    14250000
.*                       4    NO STORED ASSIGNMENT FOUND                14300000
.*                       8    NO MORE SPACE AVAILABLE                   14350000
.*                      12    REQUEST INCOMPATIBLE WITH STATUS OF       14400000
.*                            STORED ASSIGNMENT (ALP,ALT).     @D149DFG 14450000
.*                            DEVICE ALREADY SPOOLED (PST) OR  @D149DFG 14500000
.*                            NOT SPOOLED (PSP) OR             @D149DFG 14550000
.*                            NOT IN USE (DVR).                @D149DFG 14600000
.*                      16    LOGICAL UNIT SPECIFIED NOT SUPPORTED FOR  14650000
.*                            THIS PARTITION.                           14700000
.*                      20    PHYSICAL UNIT SPECIFIED NOT SUPPORTED     14750000
.*                            IN SYSTEM.                                14800000
.*                      24    PARTITION IDENTIFIER SPECIFIED NOT        14850000
.*                            SUPPORTED IN SYSTEM.                      14900000
.*                      28    FUNCTION SPECIFIED NOT SUPPORTED.         14950000
.*                      32    USER AREA TOO SMALL                       15000000
.*                      36    SPECIFIED DEVICE ALREADY OWNED   @D149DFG 15050000
.*                      40    SPECIFIED DEVICE IS DOWN         @D149DFG 15100000
.*                                                                      15150000
.*  EXTERNAL REFEREN.=  NONE                                            15200000
.*  ROUTINES         =  SVC 112                                         15250000
.*  DATA AREAS       =  NONE                                            15300000
.*  CONTROL BLOCKS   =  NONE                                            15350000
.*  TABLES           =  OWN TABLE GENERATED                             15400000
.*  MACROS           =  NONE                                            15450000
.*  MODIFIED REGISTER=  REGISTER (0), 1 AND 15                          15500000
.*  CHANGE ACTIVITIES=                                                  15550000
.* A000000-999999                                              @D37BDJR 15600000
.*  EXTENSION FOR AF REL.4                                     @D14BDFG 15650000
.*  ALLOW MODE PARAMETER FOR ID=NPM|NTM|DEL      (SPE DY37265) @D21LDRP 15700000
.*                                                                      15750000
.*                                                                      15800000
.** END OF SPECICATIONS *********************************************** 15850000
.********************************************************************** 15900000
.*                                                                      15950000
.* CHECK VALIDITY OF ID OPERAND.                                        16000000
.*                                                                      16050000
.********************************************************************** 16100000
         AIF   (T'&ID EQ 'O').NOTE1                                     16150000
&TID     SETA  0                                                        16200000
         AIF   ('&ID' EQ 'INQ').CHIFIN                                  16250000
&TID     SETA  1                                                        16300000
         AIF   ('&ID' EQ 'ALT').CHIFIN                                  16350000
&TID     SETA  2                                                        16400000
         AIF   ('&ID' EQ 'ALP').CHIFIN                                  16450000
&TID     SETA  3                                                        16500000
         AIF   ('&ID' EQ 'DEL').CHIFIN                                  16550000
&TID     SETA  4                                                        16600000
         AIF   ('&ID' EQ 'NXT').CHIFIN                                  16650000
&TID     SETA  5                                                        16700000
         AIF   ('&ID' EQ 'PER').CHIFIN                                  16750000
&TID     SETA  6                                                        16800000
         AIF   ('&ID' EQ 'RSU').CHIFIN                                  16850000
&TID     SETA  7                                                        16900000
         AIF   ('&ID' EQ 'RTM').CHIFIN                                  16950000
&TID     SETA  8                                                        17000000
         AIF   ('&ID' EQ 'TEM').CHIFIN                                  17050000
&TID     SETA  9                                                        17100000
         AIF   ('&ID' EQ 'XTM').CHIFIN                                  17150000
&TID     SETA  10                                                       17200000
         AIF   ('&ID' EQ 'RSA').CHIFIN                                  17250000
&TID     SETA  11                                                       17300000
         AIF   ('&ID' EQ 'RTL').CHIFIN                                  17350000
&TID     SETA  12                                                       17400000
         AIF   ('&ID' EQ 'RTP').CHIFIN                                  17450000
&TID     SETA  13                                                       17500000
         AIF   ('&ID' EQ 'CKU').CHIFIN                                  17550000
&TID     SETA  14                                              @D14BDFG 17600000
         AIF   ('&ID' EQ 'NPM').CHIFIN                         @D14BDFG 17650000
&TID     SETA  15                                              @D14BDFG 17700000
         AIF   ('&ID' EQ 'NTM').CHIFIN                         @D14BDFG 17750000
&TID     SETA  16                                              @D14BDFG 17800000
         AIF   ('&ID' EQ 'DRL').CHIFIN                         @D14BDFG 17850000
&TID     SETA  17                                              @D14BDFG 17900000
         AIF   ('&ID' EQ 'PST').CHIFIN                         @D14BDFG 17950000
&TID     SETA  18                                              @D14BDFG 18000000
         AIF   ('&ID' EQ 'PSP').CHIFIN                         @D14BDFG 18050000
&TID     SETA  19                                              @D14BDFG 18100000
         AIF   ('&ID' EQ 'DVU').CHIFIN                         @D14BDFG 18150000
&TID     SETA  20                                              @D14BDFG 18200000
         AIF   ('&ID' EQ 'DVR').CHIFIN                         @D14BDFG 18250000
&TID     SETA  21                                              @D51ODGL 18266652
         AIF   ('&ID' EQ 'RTL1').CHIFIN                        @D51ODGL 18283252
.NOTE1   MNOTE 8,'ID=&ID INVALID, GENERATION SUPPRESSED'                18300000
         MEXIT                                                          18350000
.CHIFIN  ANOP                                                           18400000
&FLAGBYT SETA  0                                               @D21LDRP 18450000
.********************************************************************** 18500000
.*                                                                      18550000
.* CHECK LOGUNIT  OPERAND                                               18600000
.*                                                                      18650000
.********************************************************************** 18700000
         AIF   (&TID LT 17).CHLU                               @D14BDFG 18750000
         AIF   (&TID EQ 21).CHLU                               @D51ODGL 18775052
         AIF   (T'&LOGUNIT EQ 'O').CHLFIN                      @D14BDFG 18800000
         MNOTE 8,'LOGUNIT INVALID FOR ID=&ID, GENERATION SUPPRESSED'    18850000
         MEXIT                                                 @D14BDFG 18900000
.CHLU    AIF   (T'&LOGUNIT NE 'O').CHLFIN  LOGUNIT REQUIRED    @D14BDFG 18950000
         MNOTE 8,'LOGUNIT REQUIRED BUT MISSING,GENERATION SUPPRESSED'   19000000
         MEXIT                                                          19050000
.CHLFIN  ANOP                                                           19100000
.********************************************************************** 19150000
.*                                                                      19200000
.* CHECK CHNUNIT OPERAND.                                               19250000
.*                                                                      19300000
.********************************************************************** 19350000
         AIF   (&TID EQ 1 OR &TID EQ 2).CHPU                            19400000
         AIF   (&TID EQ 12 OR &TID EQ 13 OR &TID EQ 16).CHPU   @D14BDFG 19450000
         AIF   (&TID EQ 17 OR &TID EQ 18 OR &TID EQ 19).CHPU   @D14BDFG 19500000
         AIF   (T'&CHNUNIT EQ 'O').CHPUFIN                              19550000
         MNOTE 8,'CHNUNIT INVALID FOR ID=&ID, GENERATION SUPPRESSED'    19600000
         MEXIT                                                          19650000
.CHPU    AIF   (T'&CHNUNIT NE 'O').CHPUFIN                              19700000
         MNOTE 8,'CHNUNIT REQUIRED BUT MISSING,GENERATION SUPPRESSED'   19750000
         MEXIT                                                          19800000
.CHPUFIN ANOP                                                           19850000
.**************************************************************@D149DFG 19900000
.*                                                             @D149DFG 19950000
.* CHECK PHYUNIT OPERAND.                                      @D149DFG 20000000
.*                                                             @D149DFG 20050000
.**************************************************************@D149DFG 20100000
         AIF   (&TID EQ 14 OR &TID EQ 15 OR &TID EQ 20).CHPH   @D14BDFG 20150000
         AIF   (T'&PHYUNIT EQ 'O').CHPHFIN                     @D14BDFG 20200000
         MNOTE 8,'PHYUNIT INVALID FOR ID=&ID, GENERATION SUPPRESSED'    20250000
         MEXIT                                                 @D14BDFG 20300000
.CHPH    AIF   (T'&PHYUNIT NE 'O').CHPHFIN                     @D14BDFG 20350000
         MNOTE 8,'PHYUNIT REQUIRED BUT MISSING,GENERATION SUPPRESSED'   20400000
         MEXIT                                                 @D14BDFG 20450000
.CHPHFIN ANOP                                                  @D14BDFG 20500000
.**************************************************************@D219DRP 20550000
.*                                                             @D219DRP 20600000
.* CHECK MODE OPERAND.                                         @D219DRP 20650000
.*                                                             @D219DRP 20700000
.**************************************************************@D219DRP 20750000
&MFGLEN  SETA  20                  SET LENGTH OF PARAMETERLIST @D21LDRP 20800000
         AIF   (T'&MODE EQ 'O').CHMDFIN                        @D21LDRP 20850000
         AIF   (&TID EQ 3).CHMD01   ID=DEL                     @D21LDRP 20900000
&MFGLEN  SETA  &MFGLEN+4           SET LENGTH OF PARAMETERLIST @D21LDRP 20950000
&FLAGBYT SETA  &FLAGBYT+128        INDICATE MODE PARAM. PRESENT@D21LDRP 21000000
         AIF   (&TID EQ 14 OR &TID EQ 15).CHMDFIN ID=NTM|NPM   @D21LDRP 21050000
         MNOTE 8,'MODE INVALID FOR ID=&ID, GENERATION SUPPRESSED'       21100000
         MEXIT                                                 @D21LDRP 21150000
.CHMD01  ANOP                                                  @D21LDRP 21200000
         AIF   ('&MODE' EQ '''YES''').CHMD02                   @D21LDRP 21250000
         MNOTE 8,'MODE=&MODE INVALID FOR ID=&ID, GENERATION SUPPRESSED' 21300000
         MEXIT                                                 @D21LDRP 21350000
.CHMD02  ANOP                                                  @D21LDRP 21400000
&FLAGBYT SETA  &FLAGBYT+128        INDICATE MODE PRESENT       @D21LDRP 21450000
.CHMDFIN ANOP                                                  @D21LDRP 21500000
.********************************************************************** 21550000
.*                                                                      21600000
.* CHECK AREA AND LENGTH OPERANDS                                       21650000
.*                                                                      21700000
.********************************************************************** 21750000
         AIF   (&TID EQ 11 OR &TID EQ 12 OR &TID EQ 16).CHAR   @D14BDFG 21800000
         AIF   (&TID EQ 19 OR &TID EQ 21).CHAR                 @D51ODGL 21850052
         AIF   (T'&AREA EQ 'O').CHL1                                    21900000
         MNOTE 8,'AREA INVALID FOR ID=&ID, GENERATION SUPPRESSED'       21950000
         MEXIT                                                          22000000
.CHL1    AIF   (T'&LEN EQ 'O').CHARFIN                                  22050000
         MNOTE 8,'LEN INVALID FOR ID=&ID, GENERATION SUPPRESSED'        22100000
         MEXIT                                                          22150000
.CHAR    AIF   (T'&AREA NE 'O').CHL2                                    22200000
         MNOTE 8,'AREA REQUIRED BUT MISSING,GENERATION SUPPRESSED'      22250000
         MEXIT                                                          22300000
.CHL2    AIF   (&TID EQ 19).CHARFIN                            @D14BDFG 22350000
         AIF   (T'&LEN NE 'O').CHARFIN                         @D14BDFG 22400000
         MNOTE 8,'LEN REQUIRED BUT MISSING,GENERATION SUPPRESSED'       22450000
         MEXIT                                                          22500000
.CHARFIN ANOP                                                           22550000
.********************************************************************** 22600000
.*                                                                      22650000
.* CHECK IF USERAREA FOR PARAMETER-LIST GIVEN  (MFG=OPERAND)            22700000
.*                                                                      22750000
.********************************************************************** 22800000
         AIF   (T'&MFG EQ 'O').NOMFG       NO MFG-PARM,BUILD INLINECODE 22850000
&NAME    DS    0H                          MACRO ALIGNMENT              22900000
         AIF   ('&MFG'(1,3) EQ '(S,').SMFG  S-TYPE FORMAT               22950000
         AIF   ('&MFG'(1,1) EQ '(').RMFG   REGISTER FORMAT              23000000
&TMFG    SETA  1                           INDICATE VARIABLE            23050000
&TADDR   SETC  '+'.'&MFG'                  USERAREA ADDRESSED BY VAR.   23100000
         MVC   &MFG.(&MFGLEN),IJBY&SYSNDX  MOVE PARMLIST       @D21LDRP 23150000
         AGO   .CONT                                                    23200000
.SMFG    ANOP                                                           23250000
&TMFG    SETA  2                           INDICATE S-TYPE VARIABLE     23300000
&TADDR   SETC  '+'.'&MFG(2)'               USERAREA ADDRESSED BY VAR.   23350000
         MVC   &MFG(2).(&MFGLEN),IJBY&SYSNDX MOVE PARMLIST     @D21LDRP 23400000
         AGO   .CONT                                                    23450000
.RMFG    ANOP                                                           23500000
&TADDR   SETC  '&MFG'                      USERAREA ADDRESSED BY REG    23550000
         MVC   0(&MFGLEN,&MFG(1)),IJBY&SYSNDX MOVE PARMLIST    @D21LDRP 23600000
&TMFG    SETA  3                                                        23650000
         AIF   ('&MFG' EQ '(1)').CONT      REGISTER 1 GIVEN             23700000
&TMFG    SETA  4                           ANY REGISTER USED            23750000
         AGO   .CONT                                                    23800000
.********************************************************************** 23850000
.*                                                                      23900000
.*  END OF DIAGNOSTIC PATH.                                             23950000
.*  START OF CODE GENERATION.                                           24000000
.*                                                                      24050000
.********************************************************************** 24100000
.NOMFG   ANOP                                                           24150000
         CNOP  0,4                         MACRO ALIGNMENT              24200000
         AIF   (T'&NAME EQ 'O').NONAM      NO MACRO LABEL               24250000
&NAME    EQU   *                                                        24300000
.NONAM   ANOP                                                           24350000
&TADDR   SETC  '+IJBY'.'&SYSNDX'                                        24400000
.********************************************************************** 24450000
.*                                                                      24500000
.* EVALUATE AND SET LEN PARAMETER                                       24550000
.*                                                                      24600000
.********************************************************************** 24650000
.CONT    ANOP                                                           24700000
         AIF   (T'&LEN EQ 'O').LENFIN                                   24750000
&TOFF    SETA  2                                                        24800000
         AIF   ('&LEN'(1,1) EQ '(').RLEN    REGISTER FORM               24850000
&TLEN    SETA  1                                                        24900000
         AGO   .LENFIN                                                  24950000
.RLEN    ANOP                                                           25000000
         STH   &LEN(1),&TOFF.&TADDR         STORE LENGTH                25050000
.LENFIN  ANOP                                                           25100000
.********************************************************************** 25150000
.*                                                                      25200000
.* EVALUATE AND SET LOGUNIT PARAMETER                                   25250000
.*                                                                      25300000
.********************************************************************** 25350000
         AIF   (T'&LOGUNIT EQ 'O').LOGFIN  NO LOGUNIT          @D14BDFG 25400000
&TOFF    SETA  4                                                        25450000
         AIF   ('&LOGUNIT'(1,3) EQ '(S,').SLOG S-TYPE FORMAT            25500000
&TLOG    SETB  1                           INDICATE VARIABLE PARM       25550000
         AIF   ('&LOGUNIT'(1,1) NE '(').LOGFIN                          25600000
&TLOG    SETB  0                           RESET VARIABLE PARM          25650000
         ST    &LOGUNIT(1),&TOFF.&TADDR    STORE LOGUNIT ADDRESS        25700000
         AGO   .LOGFIN                                                  25750000
.SLOG    ANOP                              S-TYPE FORMAT                25800000
         LA    0,&LOGUNIT(2)               LOAD AND                     25850000
         ST    0,&TOFF.&TADDR              STORE LOG ADDRESS            25900000
.LOGFIN  ANOP                                                           25950000
.********************************************************************** 26000000
.*                                                                      26050000
.* EVALUATE AND SET CHNUNIT PARAMETER                                   26100000
.*                                                                      26150000
.********************************************************************** 26200000
         AIF   (T'&CHNUNIT EQ 'O').CHNFIN  NO CHNUNIT                   26250000
&TOFF    SETA  8                                                        26300000
         AIF   ('&CHNUNIT'(1,3) EQ '(S,').SCHN S-TYPE FORMAT            26350000
&TCHN    SETB  1                           INDICATE VARIABLE PARM       26400000
         AIF   ('&CHNUNIT'(1,1) NE '(').CHNFIN VARIABLE PARM            26450000
&TCHN    SETB  0                           RESET VARIABLE PARM          26500000
         ST    &CHNUNIT(1),&TOFF.&TADDR    STORE CHN-ADDRESS            26550000
         AGO   .CHNFIN                                                  26600000
.SCHN    ANOP                              S-TYPE FORMAT                26650000
         LA    0,&CHNUNIT(2)               LOAD AND                     26700000
         ST    0,&TOFF.&TADDR              STORE CHN ADDRESS            26750000
.CHNFIN  ANOP                                                           26800000
.**************************************************************@D149DFG 26850000
.*                                                             @D149DFG 26900000
.* EVALUATE AND SET PHYUNIT PARAMETER                          @D149DFG 26950000
.*                                                             @D149DFG 27000000
.**************************************************************@D149DFG 27050000
         AIF   (T'&PHYUNIT EQ 'O').PHYFIN  NO PHYUNIT          @D14BDFG 27100000
&TOFF    SETA  8                                               @D14BDFG 27150000
         AIF   ('&PHYUNIT'(1,3) EQ '(S,').SPHY S-TYPE FORMAT   @D14BDFG 27200000
&TPHY    SETB  1                       INDICATE VARIABLE PARM  @D14BDFG 27250000
         AIF   ('&PHYUNIT'(1,1) NE '(').PHYFIN VARIABLE PARM   @D14BDFG 27300000
&TPHY    SETB  0                       RESET VARIABLE PARM     @D14BDFG 27350000
         ST    &PHYUNIT(1),&TOFF.&TADDR    STORE PHY-ADDRESS   @D14BDFG 27400000
         AGO   .PHYFIN                                         @D14BDFG 27450000
.SPHY    ANOP                              S-TYPE FORMAT       @D14BDFG 27500000
         LA    0,&PHYUNIT(2)               LOAD AND            @D14BDFG 27550000
         ST    0,&TOFF.&TADDR              STORE PHY ADDRESS   @D14BDFG 27600000
.PHYFIN  ANOP                                                  @D14BDFG 27650000
.********************************************************************** 27700000
.*                                                                      27750000
.* EVALUATE AND SET PID PARAMETER                                       27800000
.*                                                                      27850000
.********************************************************************** 27900000
&TOFF    SETA  12                                                       27950000
         AIF   (T'&PID EQ 'O').PIDFIN                                   28000000
         AIF   ('&PID'(1,3) EQ '(S,').SPID S-TYPE FORMAT                28050000
&TPID    SETB  1                           INDICATE VARIABLE PARM       28100000
         AIF   ('&PID'(1,1) NE '(').PIDFIN                              28150000
&TPID    SETB  0                           INDICATE VARIABLE PARM       28200000
         ST    &PID(1),&TOFF.&TADDR        STORE ADDRESS OF PIK         28250000
         AGO   .PIDFIN                                                  28300000
.SPID    ANOP                              S-TYPE FORMAT                28350000
         LA    0,&PID(2)                   LOAD AND                     28400000
         ST    0,&TOFF.&TADDR              STORE PID ADDRESS            28450000
.PIDFIN  ANOP                                                           28500000
.********************************************************************** 28550000
.*                                                                      28600000
.* EVALUATE AND SET AREA PARAMETER                                      28650000
.*                                                                      28700000
.********************************************************************** 28750000
         AIF   (T'&AREA EQ 'O').ARFIN                                   28800000
&TOFF    SETA  16                                                       28850000
         AIF   ('&AREA'(1,3) EQ '(S,').SAREA S-TYPE FORMAT              28900000
&TAREA   SETB  1                           INDICATE VARIABLE PARM       28950000
         AIF   ('&AREA'(1,1) NE '(').ARFIN                              29000000
&TAREA   SETB  0                           RESET VARIABLE PARM          29050000
         ST    &AREA(1),&TOFF.&TADDR       STORE AREA ADDRESS  @D51ODGL 29100052
         AGO   .ARFIN                                                   29150000
.SAREA   ANOP                              S-TYPE FORMAT                29200000
         LA    0,&AREA(2)                  LOAD AND                     29250000
         ST    0,&TOFF.&TADDR                 STORE LOG ADDRESS         29300000
.ARFIN  ANOP                                                            29350000
.**************************************************************@D219DRP 29400000
.*                                                             @D219DRP 29450000
.* EVALUATE AND SET MODE PARAMETER                             @D219DRP 29500000
.*                                                             @D219DRP 29550000
.**************************************************************@D219DRP 29600000
         AIF   (T'&MODE EQ 'O' OR &TID EQ 3).MDFIN             @D21LDRP 29650000
&TOFF    SETA  20                                              @D21LDRP 29700000
         AIF   ('&MODE'(1,3) EQ '(S,').SMODE S-TYPE FORMAT     @D21LDRP 29750000
&TMODE   SETB  1                       INDICATE VARIABLE PARM  @D21LDRP 29800000
         AIF   ('&MODE'(1,1) NE '(').MDFIN                     @D21LDRP 29850000
&TMODE   SETB  0                           RESET VARIABLE PARM @D21LDRP 29900000
         ST    &MODE(1),&TOFF.&TADDR       STORE MODE BYTE ADDR@D21LDRP 29950000
         AGO   .MDFIN                                          @D21LDRP 30000000
.SMODE   ANOP                              S-TYPE FORMAT       @D21LDRP 30050000
         LA    0,&MODE(2)                  LOAD AND STORE      @D21LDRP 30100000
         ST    0,&TOFF.&TADDR                    MODE BYTE ADDR@D21LDRP 30150000
.MDFIN  ANOP                                                   @D21LDRP 30200000
.********************************************************************** 30250000
.*                                                                      30300000
.* GENERATE BRANCH INSTRUCTION                                          30350000
.*                                                                      30400000
.********************************************************************** 30450000
&BADDR   SETC  'IJBY'.'&SYSNDX'.'+&MFGLEN'                     @D21LDRP 30500000
         AIF   (&TMFG NE 0).BR1                                         30550000
         BAL   1,&BADDR                    LOAD PARMLIST ADDR & BRANCH  30600000
         AGO   .GENCON                                                  30650000
.BR1     ANOP                                                           30700000
         AIF   (&TMFG NE 1).BR2                                         30750000
         LA    1,&MFG                      LOAD PARMLIST ADDR.          30800000
         AGO   .BR4                                                     30850000
.BR2     ANOP                                                           30900000
         AIF   (&TMFG NE 2).BR3                                         30950000
         LA    1,&MFG(2)                   LOAD PARMLIST ADDR.          31000000
         AGO   .BR4                                                     31050000
.BR3     ANOP                                                           31100000
         AIF   (&TMFG EQ 3).BR4                                @D14BDFG 31150000
         LR    1,&MFG(1)                   LOAD PARMLIST ADDR.          31200000
.BR4     B     &BADDR                      BRANCH AROUND PARMLIST       31250000
.********************************************************************** 31300000
.*                                                                      31350000
.* GENERATE CONSTANTS                                                   31400000
.*                                                                      31450000
.********************************************************************** 31500000
.GENCON  ANOP                                                           31550000
&LABEL   SETC  'IJBY'.'&SYSNDX'                                         31600000
&LABEL   DC    AL1(&TID)                   ID-FLAG                      31650000
         DC    AL1(&FLAGBYT)               FLAG BYTE           @D21LDRP 31700000
         AIF   (&TLEN EQ 1).GC10                                        31750000
         AIF   (&TID EQ 19).GC15                               @D14BDFG 31800000
         DC    AL2(0)                      LENGTH OF AREA               31850000
         AGO   .GC20                                                    31900000
.GC10    ANOP                                                           31950000
         DC    AL2(&LEN)                   LENGTH OF AREA               32000000
         AGO   .GC20                                           @D14BDFG 32050000
.GC15    ANOP                                                  @D14BDFG 32100000
         DC    AL2(2)                                          @D14BDFG 32150000
.GC20    ANOP                                                           32200000
         AIF   (&TLOG).GC42                                             32250000
         DC    AL4(0)                      LOGICAL UNIT ADDRESS         32300000
         AGO   .GC43                                                    32350000
.GC42    ANOP                                                           32400000
         DC    AL4(&LOGUNIT)               LOGICAL UNIT ADDRESS         32450000
.GC43    ANOP                                                           32500000
         AIF   (&TCHN).GC44                                             32550000
         AIF   (&TPHY).GC45                                    @D14BDFG 32600000
         DC    AL4(0)                      PHYSICAL UNIT       @D14BDFG 32650000
         AGO   .GC50                                           @D14BDFG 32700000
.GC44    ANOP                                                           32750000
         DC    AL4(&CHNUNIT)               PHYSICAL UNIT ADDRESS        32800000
         AGO   .GC50                                           @D14BDFG 32850000
.GC45    ANOP                                                  @D14BDFG 32900000
         DC    AL4(&PHYUNIT)               PHYSICAL UNIT       @D14BDFG 32950000
.GC50    ANOP                                                           33000000
         AIF   (&TPID).GC51                                             33050000
         DC    AL4(0)                      POINTER TO PIK               33100000
         AGO   .CLREGF                                                  33150000
.GC51    ANOP                                                           33200000
         DC    AL4(&PID)                   POINTER TO PIK               33250000
.CLREGF  ANOP                                                           33300000
         AIF   (&TAREA).GC62                                            33350000
         DC    AL4(0)                      USER AREA ADDRESS            33400000
         AGO   .GC63                                                    33450000
.GC62    ANOP                                                           33500000
         DC    AL4(&AREA)                  USER AREA ADDRESS            33550000
.GC63    ANOP                                                           33600000
         AIF   (T'&MODE EQ 'O' OR &TID EQ 3).GC73              @D21LDRP 33650000
         AIF   (&TMODE).GC72                                   @D21LDRP 33700000
         DC    AL4(0)                      MODE BYTE ADDRESS   @D21LDRP 33750000
         AGO   .GC73                                           @D21LDRP 33800000
.GC72    ANOP                                                  @D21LDRP 33850000
         DC    AL4(&MODE)                  MODE BYTE ADDRESS   @D21LDRP 33900000
.GC73    ANOP                                                           33950000
         SVC   112                         CALL SVC ROUTINE             34000000
         MEND                                                        */ 34050000
