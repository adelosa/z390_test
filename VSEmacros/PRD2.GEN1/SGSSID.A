         MACRO                                                          00001016
         SGSSID                                                         00002016
         GBLB  &BGDEBUG                 DEBUG OPTION           @D37ZDWK 00003016
         GBLB  &SGSSID                  SUPPRINT               @D37ZDWK 00004016
         GBLB  &BG370                   /370 - MODE            @D35EDWK 00005016
         GBLB  &BGVM                    VMLE SUPPORT           @D36ZDWK 00006016
         GBLB  &BGXA                    VMESA OR ESA MODE      @D51SDGL 00007016
         GBLB  &BGFBA                   FBA DEVICES            @D35XDWK 00008016
         GBLA  &AGLCAT                  L'LIBRARY CONCAT.CHAIN @D36JDWK 00009016
         GBLB  &BGDSHR                  DASD SHARING SUPPORT   @D36SDWK 00010016
         LCLB  &BLEXX                   E-MODE                 @D35XDWK 00011016
         LCLB  &BLREL                   RELOCATING CHANNELS    @D36ZDWK 00012016
         LCLB  &BL4PG                   4 K PAGE SIZE          @DA33314 00013016
***************************************************************         00014016
*        SUPERVISOR - SGSSID - 5686-CF7-06                    *         00015018
*                                                             *         00016016
*        LICENSED MATERIALS - PROPERTY OF IBM                 *         00017016
*        "RESTRICTED MATERIALS OF IBM"                        *         00018016
*        5686-CF7                                             *         00019018
*        (C) COPYRIGHT IBM CORP. 1992, 2004                   *         00020018
*                                                             *         00030016
***************************************************************         00031016
.*                                                                      00032016
.* /* START OF SPECIFICATIONS ***************************************** 00033016
.*                                                                      00034016
.*01* MODULE TYPE = SUPERVISOR GENERATION MACRO                         00035016
.*                                                                      00036016
.*01* DESCRIPTIVE NAME = SVC X'69' (105) SUBSID SERVICE        @D149DWK 00037016
.*                                                                      00038016
.*01* NOTES = CHANGE ACTIVITIES                                @D149DWK 00039016
.*     SUBSID - ROUTINE HAS BEEN INCLUDED                      @D35CDFG 00040016
.*     SUBSID - SUPPORT EXPANDED FOR MVM NPDA                  @D14BDWK 00041016
.*     SUBSID FOR FTP                                          @D14BDWK 00042016
.*     SOEMI ADAPTION                                          @DA34091 00043016
.*     SUBSID REMOVE FUNCTION INCORR IF NOT FROM EOT           @DA34338 00044016
.*     VSE ENHANCEMENTS FOR SUBSYSTEMS                         @DA37324 00045016
.*     CORRECT SUBSYSTEM LIST WHEN PIK=TID                     @DY38583 00046016
.*     UNATTENDED NODE SUPPORT                                 @D13CDGN 00047016
.*     SOFTWARE RE-IPL (+ GIVE REIPL AUTHORIZATION)            @D31QDHB 00048016
.*     NEW SYSTEM LAYOUT                                       @D51MDRP 00049016
.*     MORE PARTITION SUPPORT                                  @D51IDIS 00050016
.*     MORE PARTITION SUPPORT                                  @D51IDGL 00051016
.*     SUBSYSTEM ENTRY FOR PSF/VSE                             @D51JDGL 00052016
.*     ERASE CICS 1.7 FROM SUBSYSTEM TABLE                     @D51HDGL 00053016
.*     ACCEPT PERFORMANCE TOOL VSPT AS SUBSYSTEM               @D51QDGL 00054016
.*     IJBSVMAC INDICATING RUNNING UNDER VM NOT SET            @DY38783 00055016
.*     INTRODUCE INDICATION IF RUNNING AN ESA OR               @D51SDGL 00056016
.*     VMESA SUPERVISOR, AND IF ACCESS REGS ARE                @D51SDGL 00057016
.*     AVAILABLE (IJBSESAS,IJBSACCR).                          @D51SDGL 00058016
.*     INTRODUCE SPDT                                          @D51EMGL 00059016
.*     ACCEPT DSNX ONCE PER PARTITION                          @D51IDGL 00060016
.*     IJBSTDAC INDICATING TURBO DISPATCHER ACTIVE             @DA43557 00061016
.*     INTRODUCE OSA                                           @DA44172 00062016
.*     SUBSYSTEM NAME FOR CICS V4                              @D64IDJK 00063016
.*     INTRODUCE NEW SUBSYSTEM DMF                             @D64XDMZ 00064016
.*     INTRODUCE NEW SUBSYSTEM SECS (SECURITY SERVER)          @D64ADMZ 00065016
.*     INTRODUCE NEW SUBSYSTEM TSER (VIRTUAL TAPE SERVER)      @D66VDAP 00066016
.*     MORE THAN 255 TASKS                                     @D66ODOW 00067016
.*                                                                      00068016
.**** END OF SPECIFICATIONS ***************************************** / 00069016
         DC    CL8'SGSSID'                                              00070016
         DC    CL8'VSE 3.1 '                                   @D68DDUL 00071018
         AIF   (NOT &SGSSID).NPRT010                           @D37ZDWK 00072016
         PRINT GEN                                             @D37ZDWK 00073016
.NPRT010 ANOP                                                  @D37ZDWK 00074016
         SPACE 2                                               @D369DWK 00075016
*--------------------------------------------------------------@D149DWK 00076016
*                                                              @D149DWK 00077016
*   SVC X'69' (105) SUBSYSTEM IDENTIFICATION SUPPORT           @D149DWK 00078016
*                                                              @D149DWK 00079016
*   FUNCTION      = MAINTAIN THE SUPERVISOR INTERNAL SUB-      @D149DWK 00080016
*                   SYSTEM LIST AREA (SSIDLIST), THE SUB-      @D149DWK 00081016
*                   SYSTEM COUNT AND STATUS FLAG WITHIN THE    @D149DWK 00082016
*                   PCB AND TCB AND HANDLE SUBSYSTEM           @D149DWK 00083016
*                   SPECIFIC PARAMETERS.                       @D149DWK 00084016
*                   FUNCTIONS SUPPORTED ARE :                  @D149DWK 00085016
*                   INQUIRY : SEARCH FOR AND COPY INDICATED    @D149DWK 00086016
*                             SUBSYSTEM LIST ENTRY TO THE      @D149DWK 00087016
*                             SPECIFIED WORK AREA.             @D149DWK 00088016
*                   NOTIFY  : VALIDATE AND MOVE OR UPDATE      @D139DGN 00089016
*                             SPECIFIED SUBSYSTEM INFORMATION  @D139DGN 00090016
*                             TO THE SUBSYSTEM LIST AREA AND   @D139DGN 00091016
*                             SET CORRESPONDING FLAGS.         @D139DGN 00092016
*                   REMOVE  : REMOVE SPECIFIED SUBSYSTEM       @D149DWK 00093016
*                             FROM THE SUBSYSTEM LIST AREA     @D149DWK 00094016
*                             AND RESET CORRESPONDING FLAGS.   @D149DWK 00095016
*                                                              @D149DWK 00096016
.*  NOTES         =  NONE                                      @D149DWK 00097016
.*  DEPENDENCIES  =  NONE                                      @D149DWK 00098016
.*  RESTRICTIONS  =  NOTIFY AND REMOVE ARE ONLY DONE FOR       @D149DWK 00099016
.*                   THE CURRENT PARTITION OR TASK.            @D149DWK 00100016
.*                   ONLY SUBSYSTEMS LISTED IN THE             @D149DWK 00101016
.*                   SUBSYSTEM NAME TABLE (SSTABLE) ARE        @D149DWK 00102016
.*                   SERVICED (SEE TABLES BELOW).              @D149DWK 00103016
.*                                                             @D149DWK 00104016
.*   SUBSYSTEMS ACCEPTED ARE :                                 @D149DWK 00105016
.* ----------------------------------------------------------- @D149DWK 00106016
.* | SUBSYSTEM | NAME | INTERNAL  | ACTIVE |     SPARM       | @D149DWK 00107016
.* |           | NAME | FLAG| IN  | PER    | EXTRN | INTRN   | @D149DWK 00108016
.* |---------------------------------------------------------| @D149DWK 00109016
.* | SUPERVISOR| SUP  |  -------  |  ----  |  ---  |  ----   | @D149DWK 00110016
.* | SPDT      | SPDT | 4000  PCB | PART   |  NO   |  NO     | @D51EMGL 00111016
.* | PSF/VSE   | PSF  | 2000  PCB | PART   |  NO   |  NO     | @D51JDGL 00112016
.* | DSNX      | DSNX | 1000  PCB | PART   |  NO   |  NO     | @D51IDGL 00113016
.* | ICKDSF    | ICK  | 0800  PCB | PART   |  NO   |  NO     | @D139DGN 00114016
.* | CUSTMIZAT | CUST | 0400  PCB | SYSTEM |  NO   |  NO     | @D139DGN 00115016
.* | NETVIEW   | NETV | 0200  PCB | PART   |  NO   |  NO     | @D139DGN 00116016
.* | NPDA      | NPDA | 0100  PCB | SYSTEM |  YES  | SYSCOM  | @D149DWK 00117016
.* | POWER     | PWR  | 0080  PCB | SYSTEM |  NO   |  TIB    | @D149DWK 00118016
.* | VTAM      | VTAM | 0040  PCB | SYSTEM |  NO   |  NO     | @D149DWK 00119016
.* | ICCF      | ICCF | 0020  PCB | SYSTEM |  NO   |  NO     | @D149DWK 00120016
.* | CICS 1.7  |      | 0010  PCB |   NO MORE ACCEPTED       | @D51HDGL 00121016
.* | CICS 2.X  |      | 0010  PCB |   NO MORE ACCEPTED       | @D51HDGL 00122016
.* | CICS 3.X  | CIC3 | 0010  PCB | PART   |  YES  |COMRG,TCB| @D52HDGL 00123016
.* | CICS 4.X  | CIC4 | 0010  PCB | PART   |  YES  |COMRG,TCB| @D64IDJK 00124016
.* | VM/VCNA   | VCNA | 0008  PCB | SYSTEM |  NO   |  NO     | @D149DWK 00125016
.* | OCCF      | OCCF | 0004  PCB | SYSTEM |  YES  | SYSCOM  | @D149DWK 00126016
.* | DS2       | ARI  | 0002  PCB | PART   |  NO   |  NO     | @D149DWK 00127016
.* | SSX       | SSX  | 0001  PCB | PART   |  NO   |  NO     | @DELETE  00128016
.* | PERF.TOOL | VSPT |   40  TCB | TASK   |  NO   |  NO     | @D51QDGL 00129016
.* | DL/1      | DLI  |   10  TCB | TASK   |  NO   |  NO     | @D149DWK 00130016
.* | SPF       | ISPF |   08  TCB | TASK   |  NO   |  NO     | @D149DWK 00131016
.* | FTP       | FTP  |   04  TCB | TASK   |  NO   |  NO     | @D149DWK 00132016
.* | SOEMI     | SOEM |   02  TCB | TASK   |  NO   |  NO     | @DA34091 00133016
.* | IN PCBSSFL4                                             | @D66VDAP 00134016
.* | SEC.SERVER| SECS |     01PCB | SYSTEM |  NO   |  NO     | @D64ADMZ 00134116
.* | TAPE SRVR.| TSER |     02PCB | SYSTEM |  NO   |  NO     | @D66VDAP 00134216
.* ----------------------------------------------------------- @D149DWK 00134316
.*                                                             @D149DWK 00134416
*   REGISTER CONV.=  REGISTER 0   INPUT/OUTPUT REGISTER        @D149DWK 00134516
*                    REGISTER 1   INPUT REGISTER               @D149DWK 00134616
*                    REGISTER 2-5 WORK REGISTER                @D149DWK 00134716
*                    REGISTER 6   DISPATCHER ADDRESS           @D149DWK 00134816
*                    REGISTER 7-9 WORK REGISTER                @D149DWK 00134916
*                    REGISTER 10  TCB POINTER                  @D149DWK 00135016
*                    REGISTER 12  BASE REGISTER                @D149DWK 00136016
*                    REGISTER 15  INPUT/OUTPUT REGISTER        @D149DWK 00137016
*                                                              @D149DWK 00138016
.*  PATCH LABEL   =  NONE                                      @D149DWK 00139016
.*  MACRO TYPE    =  ASSEMBLER                                 @D149DWK 00140016
.*  PROCESSOR     =  ASSEMBLER                                 @D149DWK 00141016
.*  MACRO SIZE    =                                            @D149DWK 00142016
.*  ATTRIBUTES    =  SERIALLY REUSABLE                         @D149DWK 00143016
.*  ENTRYPOINT    =  SSIDRT                                    @D149DWK 00144016
.*  PURPOSE       =  SEE FUNCTION                              @D149DWK 00145016
.*  LINKAGE       =                                            @D149DWK 00146016
.*  CALLER        =  SVC X'69' VIA SVC INTERRUPT HANDLER       @D149DWK 00147016
*   INPUT         =                                            @D149DWK 00148016
*                    REGISTER 0 CONTAINS THE FUNCTION CODE     @D149DWK 00149016
*                     1 FOR FUNCTION NOTIFY                    @D149DWK 00150016
*                     2 FOR FUNCTION REMOVE                    @D149DWK 00151016
*                     3 FOR FUNCTION INQUIRY                   @D149DWK 00152016
*                    REGISTER 1 CONTAINS FOR FUNCTION          @D149DWK 00153016
*                     NOTIFY : POINTER TO A BYTE STRING        @D149DWK 00154016
*                              DESCRIBED BY DSECT SSID         @D149DWK 00155016
*                              R15 IS NEGATIV FOR FUNCT UPDATE @D139DGN 00156016
*                     REMOVE : POINTER TO A 4 BYTE FIELD       @D149DWK 00157016
*                              CONTAINING THE SUBSYSTEM NAME   @D149DWK 00158016
*                     INQUIRY: POINTER TO A PARAMETER LIST     @D149DWK 00159016
*                              DESCRIBED BY DSECT SSIQPARM     @D149DWK 00160016
*                    REGISTER 15 POINTER TO A FIELD CON-       @D149DWK 00161016
*                               TAINING INFORMATION TO BE      @D149DWK 00162016
*                               PASSED TO A PREDEFINED FIELD   @D149DWK 00163016
*                               WITHIN THE SUPERVISOR.         @D149DWK 00164016
*                    REGISTER 6  DISPATCHER ADDRESS            @D149DWK 00165016
*                    REGISTER 8  TIB POINTER                   @D149DWK 00166016
*                    REGISTER 10 TCB POINTER                   @D149DWK 00167016
*   OUTPUT        =  REGISTER 15 CONTAINS THE RETURN CODE      @D149DWK 00168016
.*                   NOTIFY RETURN CODES (HEX) :               @D149DWK 00169016
.*                     0   INFORMATION STORED                  @D149DWK 00170016
.*                     4   SUBSYSTEM ALLREADY ACTIVE           @D149DWK 00171016
.*                     8   BYTE STRING TOO LONG                @D149DWK 00172016
.*                     C   INTERNAL SUBSYSTEM LIST AREA FULL   @D149DWK 00173016
.*                    10   SUBSYSTEM NAME UNKNOWN              @D149DWK 00174016
.*                   REMOVE RETURN CODES (HEX) :               @D149DWK 00175016
.*                     0   INFORMATION REMOVED                 @D149DWK 00176016
.*                     4   NO SUBSYSTEM ENTRY FOUND            @D149DWK 00177016
.*                   INQUIRY RETURN CODES (HEX) :              @D149DWK 00178016
.*                     0   INFORMATION RETURNED                @D149DWK 00179016
.*                     4   INFORMATION RETURNED BUT SAME       @D149DWK 00180016
.*                         SUBSYSTEM ACTIVE IN ANOTHER         @D149DWK 00181016
.*                         PARTITION.                          @D149DWK 00182016
.*                     8   RETURNED INFORMATION TRUNCATED      @D149DWK 00183016
.*                         WORK AREA IS TOO SHORT.             @D149DWK 00184016
.*                     C   RETURN CODE 4 AND 8                 @D149DWK 00185016
.*                    10   SUBSYSTEM NOT ACTIVE                @D149DWK 00186016
*                    REGISTER 0  CONTAINS                      @D149DWK 00187016
*                        PIK OR TID IN BYTES 0 AND 1           @D149DWK 00188016
*                        IF RC 4 OR C FROM INQUIRY             @D149DWK 00189016
*                        TOTAL SUBSYSTEM ENTRY LENGTH IN BYTES @D149DWK 00190016
*                        2 AND 3 IF RC 8 OR C FROM INQUIRY     @D149DWK 00191016
*                                                              @D149DWK 00192016
*   EXIT NORMAL   =  VIA RETCODE ROUTINE TO DISPATCHER         @D149DWK 00193016
*   EXIT ERROR    =  ILLEGAL SVC - ERR21 ROUTINE IN CASE OF    @D149DWK 00194016
*                    INVALID FUNTION CODE IN REGISTER 0        @D149DWK 00195016
.*  EXTERNAL REF. =  USER SPECIFIED WORK AREA                  @D149DWK 00196016
.*  ROUTINES      =  VALID,VALIDSVA,RPOST,RETCODE              @D149DWK 00197016
.*                   SSIDCNAM : CHECK SPECIFIED NAME           @D149DWK 00198016
.*                   SSIDSCAN : SEARCH SUBSYSTEM LIST AREA     @D149DWK 00199016
.*                              FOR SPECIFIED ENTRY            @D149DWK 00200016
.*  DATA AREAS    =  SSIDLIST : SUBSYSTEM LIST AREA            @D149DWK 00201016
.*                    ENTRY LAYOUT :                           @D149DWK 00202016
.*                   SSLED    DSECT,                           @D149DWK 00203016
.*                   SSLEDFLG DS XL2  0 RESERVED                        00204016
.*                                    1 INTERN.SUBSYSTEM FLAG  @D149DWK 00205016
.*                   SSLEDTID DS XL2  TASK ID OF NOTIFIER               00206016
.*                   SSLEDPIK DS XL2  PART.ID OF NOTIFIER      @D149DWK 00207016
.*                   SSLENAME DS XL4  SUBSYSTEM NAME           @D149DWK 00208016
.*                            DS XL3  SUBSYSTEM INFORMATION    @D149DWK 00209016
.*                   SSLEVARL DS XL1  LENGTH OF FOLLOWING      @D149DWK 00210016
.*                                    VARIABLE PART (MAX       @D149DWK 00211016
.*                                    24 BYTES) OR ZERO        @D149DWK 00212016
.*                                                             @D149DWK 00213016
.*                   STRING EXPECTED FOR NOTIFY :              @D149DWK 00214016
.*                   SSID     DSECT,                           @D149DWK 00215016
.*                   SSIDNAME DS XL4  SUBSYSTEM NAME           @D149DWK 00216016
.*                   SSIDVERS DS XL1  SUBSYSTEM INFORMATION    @D149DWK 00217016
.*                   SSIDREL  DS XL1  SUBSYSTEM INFORMATION    @D149DWK 00218016
.*                   SSIDMOD  DS XL1  SUBSYSTEM INFORMATION    @D149DWK 00219016
.*                   SSIDVARL DS XL1  LENGTH OF FOLLOWING      @D149DWK 00220016
.*                                    VARIABLE PART (MAX       @D149DWK 00221016
.*                                    24 BYTES) OR ZERO        @D149DWK 00222016
.*                                                             @D149DWK 00223016
.*                   PARAMETERLIST EXPECTED FOR INQUIRY :      @D149DWK 00224016
.*                   SSIQPARM DSECT,                           @D149DWK 00225016
.*                   SSIQNAME DS XL4  SUBSYSTEM NAME ADDRESS   @D149DWK 00226016
.*                   SSIQPART DS XL2  PARTITION ID (PIK)       @D149DWK 00227016
.*                   SSIQALEN DS XL2  LENGTH OF WORK AREA      @D149DWK 00228016
.*                   SSIQAREA DS XL4  WORK AREA ADDRESS        @D149DWK 00229016
.*                   SSIQLEN  EQU *-SSIQPARM LENGTH OF LIST    @D149DWK 00230016
.*                                                             @D149DWK 00231016
.*  CONTROL BLOCKS=  TCB, PCB, TID, SYSCOM, COMRG              @D149DWK 00232016
.*                                                             @D149DWK 00233016
.*  TABLES        =  SSTABLE (SUBSYSTEM NAME TABLE):           @D149DWK 00234016
.*                   SSTBENTR DSECT,  ENTRY LAYOUT             @D149DWK 00235016
.*                   SSTBNAME DS CL4  SUBSYSTEM NAME           @D149DWK 00236016
.*                   SSTBBITS DS XL2  INTERNAL SUBSYSTEM ID    @D149DWK 00237016
.*                   SSTBFLG1 DS XL1  SCAN ROUTINE INDEX       @D149DWK 00238016
.*                   SSTBSNAM EQU X'00' NAME SEARCH ONLY       @D149DWK 00239016
.*                   SSTBSPIK EQU X'01' NAME AND PIK SEARCH    @D149DWK 00240016
.*                   SSTBSTID EQU X'02' NAME AND TID SEARCH    @D149DWK 00241016
.*                   SSTBFLG2 DS XL1  FLAG ROUTINE INDEX       @D149DWK 00242016
.*                   SSTBPCBS EQU X'00' SET FLAG IN PCBSSFLG   @D149DWK 00243016
.*                   SSTBTCB3 EQU X'04' SET FLAG IN TCBFLAG3   @D149DWK 00244016
.*                   SSTBPCB1 EQU X'08' SET FLAG IN PCBSSFL1   @D149DWK 00245016
.*                   SSTBPCB4 EQU X'0C' SET FLAG IN PCBSSFL4   @D64ADMZ 00246016
.*                   SSTBFLG3 DS XL1  SPECIAL ROUTINE INDEX    @D149DWK 00247016
.*                   SSTBRES  DS XL1  RESERVED                 @D149DWK 00248016
.*                   SSTBNEXT DS XL1  1. BYTE NEXT ENTRY       @D149DWK 00249016
.*                                                             @D149DWK 00250016
.*  MACROS        =  NONE                                      @D149DWK 00251016
*                                                              @D149DWK 00252016
*--------------------------------------------------------------@D149DWK 00253016
         SPACE 1                                               @D149DWK 00254016
         USING DISP,R6            DISPATCHER BASE              @D35CDFG 00255016
         USING TCBADR,RA          TASK CONTROL BLOCK BASE      @D36IDWK 00256016
         SPACE 1                                               @D149DWK 00257016
         DC    C'SSIDRT'                                       #DEBUGGL 00258016
SSIDRT   DS    0H                                              @D14ZDWK 00259016
         USING *,RC                ENTRY ADDR = BASE ADDR      @D35XDGS 00260016
         L     R5,ASRQTAB          GET SRQTAB ADDRESS          @D61MPJK 00261016
         LA    R5,SRQSSID-SRQTAB(,R5) POINT TO WAIT QUEUE      @D61MPJK 00262016
         TM    RSCDESC-RQADR(R5),FREEBIT IS RESOURCE AVAILABLE @D66ODOW 00263016
         BNO   RESVCX              IF NOT, RESVC               @D66ODOW 00264016
         MVI   RID+D1,SSIDBND      INDICATE REQUESTED RESOURCE @D36IDWK 00265016
SSIDGTD  EQU   *                                               @D35CDFG 00266016
         SPACE 1                                               @D149DWK 00267016
*--------------------------------------------------------------@D149DWK 00268016
*        CHECK SECURITY SUPPORT AND EOT REQUEST                @D149DWK 00269016
*--------------------------------------------------------------@D149DWK 00270016
         SPACE 1                                               @D149DWK 00271016
         USING TIBADR,R8                                       @D37ZDWK 00272016
         TM    SSIDINF1,SSIDFTIN   FIRST TIME CALL OF SERVICE  @D14ZDWK 00273016
         BO    SSIDCREQ            NO                          @D14ZDWK 00274016
         TM    SYSFLAG2,X'01'      CALLED DURING IPL           @D14ZDWK 00275016
         BO    SSIDCREQ            YES                         @D14ZDWK 00276016
         OI    SSIDINF1,SSIDFTIN   INDICATE FIRST TIME CALLED  @D14ZDWK 00277016
         TM    IJBFLG07,IJBUNATT   UNATTENDED ENVIRONMENT      @D13CDGN 00278016
         BZ    SSIDSECU            NO, TEST SECURITY           @D13CDGN 00279016
         OI    SSIDFB02,X'20'      SET RUNNING UNATT ENVIRONM  @D13CDGN 00280016
SSIDSECU TM    SYSFLAG2,IJBSEC     SECURITY SUPPORT AVAILABLE  @D13CDGN 00281016
         BZ    SSIDVMAC            NO, CONTINUE                @D14ZDWK 00282016
         OI    SSIDFB03,X'80'      SET SECURITY SUPPORT        @D14ZDWK 00283016
SSIDVMAC TM    SUPFLAG,VMSYS       IF RUNNING UNDER VM         @DY38783 00284016
         BNO   SSIDACCR            NO                          @D51SDGL 00285016
         OI    SSIDFB01,X'01'      SET IJBSVMAC FLAG           @DY38783 00286016
SSIDACCR TM    SYSFLAG6,IJBAMODE   IF ACCESS REGS AVAILABLE    @D51SDGL 00287016
         BNO   SSIDTDAC            NO                          @DA43557 00288016
         OI    SSIDFB02,X'08'      SET IJBSACCR FLAG           @D51SDGL 00289016
SSIDTDAC TM    SUPFLAG,TDACT       IF TURBO DISPATCHER ACTIVE  @DA43557 00290016
         BNO   SSIDCREQ            NO                          @DA43557 00291016
         OI    SSIDFB02,X'02'      SET IJBSTDAC FLAG           @DA43557 00292016
SSIDCREQ DS    0H                                              @D52VDGL 00293016
         L     RA,TCBPTR           GET PCB ADDRESS             @D52VDGL 00294016
         TM    TCBEXFLG,TCBEXAM    RUNNING IN 31-BIT MODE      @D52VDGL 00295016
         BNO   SSIDSMOD            NO,                         @D52VDGL 00296016
         AMODESW SET,AMODE=31,WR=(R3) ENTER 31-BIT MODE        @D52VDGL 00297016
SSIDSMOD DS    0H                                              @D52VDGL 00298016
         STC   R0,SSIDFACT         SAVE CURRENT FUNCTION CODE  @DY38583 00299016
         TM    TIBFLAG1,EOTACT     EOT ACTIVE FOR CURR.TASK    @DY38583 00300016
         BZ    SSIDNORM            NO, DO NORMAL HANDLING      @D37ZDWK 00301016
         CLC   0(L4,R1),SSIDNONA   REQUESTOR EOT               @D37ZDWK 00302016
         BNE   SSIDNORM            NO, DO NORMAL HANDLING      @D37ZDWK 00303016
         SLR   R3,R3               CLEAR SUBSYSTEM NAME REG    @D36BDWK 00304016
         LA    R9,16               SET VALUE OTHER THAN ZERO   @D14CDWK 00305016
         B     SSIDRM00            GO TO REMOVE ROUTINE        @D14CDWK 00306016
         DROP  R8                  RELEASE TIB BASE            @D14BDWK 00307016
         SPACE 1                                               @D149DWK 00308016
*--------------------------------------------------------------@D149DWK 00309016
*        SELECT ACTION TO BE DONE                              @D149DWK 00310016
*--------------------------------------------------------------@D149DWK 00320016
         SPACE 1                                               @D149DWK 00321016
SSIDNORM BCTR  R0,0                DECREASE FUNCTION CODE      @D35XDWK 00322016
         LTR   R0,R0               WAS CODE VALID              @D66VDAP 00323016
         BM    ERR21               NO, ILLEGAL SVC             @D66VDAP 00323116
         CLM   R0,1,SSIDMAXR       ROUTE ID VALID              @D14ZDWK 00323216
         BH    ERR21               NO, ILLEGAL SVC             @D35EDWK 00323316
         LA    R3,SSIDBTAB         POINT TO BRANCH TABLE       @D14ZDWK 00323416
         SLL   R0,2                OFFSET IN BRANCH VECTOR TAB.@D35XDGS 00323516
         ALR   R3,R0               ADDRESS OF ROUTINE BRANCH   @D14ZDWK 00323616
         LR    R4,RF               SAVE SPECIAL PARAMETER      @D14ZDWK 00323716
         BR    R3                  GO TO ACTION ROUTINE        @D14ZDWK 00323816
SSIDBTAB B     SSIDNTFY          1 BRANCH TO NOTIFY ROUTINE    @D35XDGS 00323916
         B     SSIDREMV          2 BRANCH TO REMOVE ROUTINE    @D35XDGS 00324016
         B     SSIDINQU          3 BRANCH TO INQUIRY ROUTINE   @D35XDGS 00325016
         EJECT                                                 @D149DWK 00326016
*--------------------------------------------------------------@D149DWK 00327016
*        INQUIRY ROUTINE                                       @D149DWK 00328016
*--------------------------------------------------------------@D149DWK 00329016
         SPACE 1                                               @D149DWK 00330016
         USING SSIQPARM,R1         INQUIRY PARM LIST BASE      @D35XDGS 00340016
         SPACE 1                                               @D35XDGS 00341016
         DC    CL8'INQUIRY'                                    #DEBUGGL 00342016
         SPACE 1                                               @D149DWK 00343016
*        VALIDATE PARAMETER                                    @D149DWK 00344016
         SPACE 1                                               @D149DWK 00345016
SSIDINQU LR    R3,R1               COPY PARMLIST POINTER       @D35XDGS 00346016
         LA    R2,SSIQLEN-1(,R1)   GET LAST BYTE ADDRESS       @D35XDGS 00347016
         BAL   R8,VALIDSVA         VALIDATE PARAMETER LIST     @D35XDGS 00348016
*SGLINK  VALIDSVA,INPUT=(R1,R2,R6,R8),WORK=(R2,R5)             @D369DWK 00349016
         SLR   R2,R2               CLEAR REGISTER FOR ICM INST @DXXXXGN 00350016
         ICM   R2,3,SSIQALEN       GET LENGTH OF AREA          @DXXXXGN 00351016
         L     R1,SSIQAREA         GET AREA BEGIN ADDRESS      @D35XDGS 00352016
         LA    R2,0(R2,R1)         AREA END ADDRESS + 1        @D35XDGS 00353016
         BCTR  R2,0                REDUCE TO LAST BYTE ADDRESS @D35XDGS 00354016
         BAL   R8,VALID            VALIDATE AREA SPECIFICATION @D35XDGS 00355016
*SGLINK  VALID,INPUT=(R1,R2,R6,R8),WORK=R2,OUTPUT=R5           @D369DWK 00356016
         SPACE 1                                               @D149DWK 00357016
         LR    R1,R3               RESTORE PARMLIST PTR        @D14ZDWK 00358016
         L     R1,SSIQNAME         GET NAME ADDRESS            @D14ZDWK 00359016
         LA    R2,3(R1)            NAME ADDRESS IS 4 BYTES     @D14ZDWK 00360016
         BAL   R8,VALIDSVA         VALIDATE NAME FIELD         @D14ZDWK 00361016
*SGLINK  VALIDSVA,INPUT=(R1,R2,R6,R8),WORK=(R2,R5)             @D149DWK 00362016
*                                                              @D149DWK 00363016
*        SEARCH SSIDLIST FOR REQUESTED ENTRY                   @D149DWK 00364016
*                                                              @D149DWK 00365016
         LR    R1,R3               RESTORE PARMLIST POINTER    @D35XDGS 00366016
         SLR   R9,R9               INQUIRY FIRST TIME SEARCH   @D14CDWK 00367016
         L     R3,SSIQNAME         PUT SEARCH ARG IN REG       @D35XDGS 00368016
         L     R3,0(,R3)           VIA INDIRECT ADDRESSING     @D35XDGS 00369016
         LH    R0,SSIQPART         GET SEARCH OBJECT (PIK, TID)@D36ZDWK 00370016
         LA    R4,SSIDINE1         EXIT IF NOT FOUND           @D14CDWK 00371016
         BAL   R5,SSIDSCAN         GO TO SCAN ROUTINE          @D14CDWK 00372016
*SGLINK  SSIDSCAN,INPUT=(R0,R3,R4,R5,RC),OUTPUT=(R2,R9),WORK=R7         00373016
         USING SSLED,R2            SSID LIST ENTRY BASE        @D14ZDWK 00374016
         SLR   R8,R8               CLEAR REGISTER TO INSERT    @D14ZDWK 00375016
         IC    R8,SSLEVARL         VARYING LENGTH, ADD         @D14ZDWK 00376016
         LA    R8,SSLEFIXL-L'SSLEDHD1(R8) REQUIRED AREA LENGTH @D66ODOW 00377016
         LR    R7,R8               GET WORK LENGTH VALUE       @D14ZDWK 00378016
         CH    R8,SSIQALEN         CHECK AVAILABLE AREA        @D14ZDWK 00379016
         BNH   SSIDIN10            LENGTH                      @D14CDWK 00380016
         LH    R7,SSIQALEN         TOO SHORT,USE USER LNG      @D36ZDWK 00381016
         LA    RF,SSIDINLE         ERROR : AREA TOO SHORT      @D36ZDWK 00382016
SSIDIN10 BCTR  R7,0                INTERNAL LENGTH (L-1)       @D14CDWK 00383016
         L     R4,SSIQAREA         POINT TO USER AREA          @D35XDGS 00384016
         EX    R7,SSIDINMV         MOVE ENTRY INTO AREA        @D14CDWK 00385016
         DROP  R1                  RELEASE INQUIRY PARML.BASE  @D14CDWK 00386016
         SPACE 1                                               @D149DWK 00387016
*        SEARCH FOR SECOND ENTRY                               @D149DWK 00388016
         SPACE 1                                               @D149DWK 00389016
         AR    R2,R8               ADDRESS NEXT SSID LIST ENTRY@D14CDWK 00390016
         LA    R2,L'SSLEDHD1(R2)   CORRECT ADDRESS             @D66ODOW 00391016
         SLR   R0,R0               INDICATE NAME SEARCH ONLY   @D36ZDWK 00392016
         LTR   RF,RF               INVALID LENGTH INDICATED    @D36ZDWK 00393016
         BNZ   SSIDIN20            YES,SKIP                    @D14CDWK 00394016
         SLR   R8,R8               NO, CLEAR LENGTH            @D14ZDWK 00395016
SSIDIN20 LTR   R9,R9               SECOND ENTRY AVAILBALE      @D14CDWK 00396016
         BZ    SSIDIN25            NO                          @D14CDWK 00397016
         LR    R2,R9               POINT TO SSIDLIST ENTRY     @D14CDWK 00398016
         B     SSIDIN28            SKIP SECOND SCAN            @D14CDWK 00399016
SSIDIN25 LA    R4,SSIDIN40         EXIT IF NOT FOUND           @D14CDWK 00400016
         BAL   R5,SSIDSC00         SEARCH SEC. IDENTICAL NAME  @D14CDWK 00410016
*SGLINK  SSIDSC00,INPUT=(R0,R2,R3,R4,R5,RC),OUTPUT=(R2,R9),WORK=R7      00411016
SSIDIN28 ICM   R8,12,SSLEDPIK      GET PIK OF DUPLICATE ENTRY  @D14ZDWK 00412016
         LA    R0,SSIDINME         INDICATE DUPLICATE ENTRY    @D36ZDWK 00413016
         LTR   RF,RF               INVALID LENGTH INDICATED    @D36ZDWK 00414016
         BZ    SSIDIN30            NO, SKIP                    @D14CDWK 00415016
         LA    R0,SSIDINML         INDICATE BOTH CONDITIONS    @D36ZDWK 00416016
SSIDIN30 LR    R5,R6               SAVE PTR TO DISPATCHER      @D14CDWK 00417016
         LR    RF,R8               PREPARE RETURN VALUE        @D36ZDWK 00418016
         LA    R1,SVER00-SVEARA    RETURN VALUE IN GR 0        @D36BDWK 00419016
         BAL   R6,RETCODE          INSERT RETURN CODE          @D36BDWK 00420016
*SGLINK  RETCODE,INPUT=(R1,R6,RF),WORK=(RA)                    @D369DWK 00421016
         LR    R6,R5               RESTORE R6->DISPATCHER      @D36BDWK 00422016
         LR    RF,R0               RETURN CODE IN GR 15        @D36BDWK 00423016
         B     SSIDRTCD            RETURN WITH RET CODE        @D36BDWK 00424016
         SPACE 1                                               @D369DWK 00425016
SSIDIN40 LTR   RF,RF               INVALID LENGTH INDICATED    @D14CDWK 00426016
         BZ    SSIDRTRF            NO, RETURN NORMAL           @D37CDWK 00427016
         LR    R0,RF               SAVE RETURN CODE            @D36ZDWK 00428016
         B     SSIDIN30            SET RETURN VALUES           @D14CDWK 00429016
SSIDINE1 LA    RF,SSIDINNF         NAME NOT FOUND              @D14CDWK 00430016
         B     SSIDRTCD            RETURN WITH RET CODE        @D36BDWK 00431016
         SPACE 1                                               @D35XDGS 00432016
SSIDINMV MVC   0(1,R4),SSLEDPIK    EXECUTED MOVE INTO AREA     @D14CDWK 00433016
         DROP  R2                  RELEASE SSIDLIST ENTRY BASE @D14CDWK 00434016
         SPACE 1                                               @D149DWK 00435016
*--------------------------------------------------------------@D149DWK 00436016
*        NOTIFY ROUTINE                                        @D149DWK 00437016
*--------------------------------------------------------------@D149DWK 00438016
         SPACE 1                                               @D149DWK 00439016
         USING SSID,R1             PARMLIST BASE               @D14CDWK 00440016
         SPACE 1                                               @D149DWK 00441016
         DC    CL8'NOTIFY'                                     #DEBUGGL 00442016
         SPACE 1                                               @D149DWK 00443016
*        VALIDATE PARAMETER                                    @D149DWK 00444016
         SPACE 1                                               @D149DWK 00445016
SSIDNTFY LA    R2,SSIDFIXL-1(,R1)  ADDRESS LAST FIXED BYTE     @D35XDGS 00446016
         BAL   R8,VALIDSVA         VALIDATE FIXED PARAMETER    @D35XDGS 00447016
*SGLINK  VALIDSVA,INPUT=(R1,R2,R6,R8),WORK=(R2,R5)             @D369DWK 00448016
         SLR   R2,R2               ZERO REGISTER FOR IC        @D35XDGS 00449016
         IC    R2,SSIDVARL         GET VARIABLE LENGTH         @D35XDGS 00450016
         LA    R2,SSIDFIXL-1(R2,R1) ADDRESS LAST BYTE          @D35XDGS 00451016
         BAL   R8,VALIDSVA         VALIDATE TOTAL PARAMETER    @D35XDGS 00452016
*SGLINK  VALIDSVA,INPUT=(R1,R2,R6,R8),WORK=(R2,R5)             @D369DWK 00453016
         LTR   RF,R4               NO SPECIAL PARM OR UPDATE   @D36ZDWK 00454016
         BNP   SSIDNT00            SKIP VALIDATION             @DXXXXGN 00455016
         LR    R3,R1               SAVE PARMLIST BASE          @D14CDWK 00456016
         LR    R1,RF               LOAD REGISTERS              @D36ZDWK 00457016
         LR    R2,RF               NECESSARY FOR               @D36ZDWK 00458016
         LA    R2,3(R2)            VALIDATION                  @D36ZDWK 00459016
         BAL   R8,VALIDSVA         VALIDATE PARAMETER          @D36ZDWK 00460016
*SGLINK  VALIDSVA,INPUT=(R1,R2,R6,R8),WORK=(R2,R5)             @D36ZDWK 00470016
         LR    R1,R3               RESTORE PARMLIST BASE       @D14CDWK 00471016
         SPACE 1                                               @D149DWK 00472016
*        SUBSYSTEM NAME AND ENTRY CHECK                        @D149DWK 00473016
         SPACE 1                                               @D149DWK 00474016
SSIDNT00 EQU   *                                               @D14CDWK 00475016
         LA    R4,SSIDNTE1         RETURN ADDR.IF INVALID NAME @D14CDWK 00476016
         BAL   R5,SSIDCNAM         CHECK IF NAME VALID         @D14CDWK 00477016
*SGLINK  SSIDCNAM,INPUT=(R1,R4,R5,RC),OUTPUT=(R3,R9)           @D369DWK 00478016
         USING SSTBENTR,R9         SSID NAME TABLE ENTRY BASE  @D14CDWK 00479016
         SLR   R0,R0               INDICATE NAME SEARCH ONLY   @D14CDWK 00480016
         CLI   SSTBFLG1,SSTBSPIK   PIK OR TID TO BE SPECIFIED  @D14CDWK 00481016
         BL    SSIDNT20            NO                          @D14CDWK 00482016
         BH    SSIDNT10            TID IS SEARCH ARGUMENT TOO  @D14CDWK 00483016
         LH    R0,PIK              PIK IS SEARCH ARGUMENT TOO  @D14CDWK 00484016
         B     SSIDNT20                                        @D14BDWK 00485016
SSIDNT10 LH    R0,TID              TASK ID OF NOTIFIER         @D66ODOW 00486016
SSIDNT20 LTR   RF,RF               NOTIFY UPDATE REQUESTED     @D13CDGN 00487016
         BM    SSIDNT60            YES, GO UPDATE              @D13CDGN 00488016
         SPACE 1                                               @D139DGN 00489016
*--------------------------------------------------------------@D139DGN 00490016
*        CREATE SSIDLIST ENTRY                                 @D139DGN 00491016
*--------------------------------------------------------------@D139DGN 00492016
         LA    R5,SSIDNTE4         EXIT IF DUPLICATE ENTRY     @D13CDGN 00493016
         BAL   R4,SSIDSCAN         SEARCH IDENTICAL NAME ENTRY @D14CDWK 00494016
*SGLINK  SSIDSCAN,INPUT=(R0,R3,R4,R5,RC),OUTPUT=(R2,R9),WORK=R7         00495016
         USING SSLED,R2            SSID LIST ENTRY BASE        @D14ZDWK 00496016
         SLR   R7,R7               CLEAR TO INSERT             @D14ZDWK 00497016
         IC    R7,SSIDVARL         VARYING LENGTH AND          @D14ZDWK 00498016
         LA    R7,SSIDFIXL-1(,R7)  ADD FIXED PART              @D14ZDWK 00499016
         CH    R7,SSIDMAXL         SUPPLIED LENGTH VALID       @D35XDGS 00500016
         BH    SSIDNTE3            NO                          @D14CDWK 00510016
         L     R2,ASSIDFSP         GET FREE SPACE PTR          @D35XDGS 00511016
         LA    R3,SSLED0+1(R7)     ADD ENTRY LENGTH            @D35XDGS 00512016
         CL    R3,ASSIDEND         IF NEW ENTRY DOES NOT       @D35XDGS 00513016
         BNL   SSIDNTE2            FIT THEN SIGNAL : FULL      @D14CDWK 00514016
         EX    R7,SSIDNTMV         ELSE ADD ENTRY TO LIST      @D14CDWK 00515016
         ST    R3,ASSIDFSP         UPDATE FREE SPACE PTR       @D35XDGS 00516016
         MVC   SSLEDFLG,SSTBBITS   STORE SUBSYSTEM FLAG        @D14CDWK 00517016
         MVC   SSLEDTID,TID        STORE TASK ID OF NOTIFIER   @D66ODOW 00518016
         MVC   SSLEDPIK,PIK        STORE PIK OF NOTIFIER       @D14CDWK 00519016
         SPACE 1                                               @D149DWK 00520016
*        UPDATE CONTROL BLOCKS                                 @D149DWK 00521016
         SPACE 1                                               @D149DWK 00522016
         L     R8,PCBPTR           ADDRESS OF PCB              @D14CDWK 00523016
         USING PCBADR,R8           SYSTEM FLAG & COUNTER       @D14CDWK 00524016
         IC    R4,PCBSSCNT         GET CURRENT COUNTER         @D14CDWK 00525016
         LA    R4,1(,R4)           INCREMENT BY ONE            @D14CDWK 00526016
         STC   R4,PCBSSCNT         STORE NEW COUNTER VALUE     @D14CDWK 00527016
         SR    R4,R4               CLEAR FOR INSERT            @D64ADMZ 00528016
         IC    R4,SSTBFLG2         GET BRANCH INDEX            @D64ADMZ 00529016
         B     SSIDNTBR(R4)        BRANCH TO SELECTED ROUTINE  @D64ADMZ 00529116
SSIDNTBR B     SSIDNT30            UPDATE PCBSSFLG             @D64ADMZ 00529216
         B     SSIDNT35            UPDATE TCBFLAG3             @D64ADMZ 00529316
         B     SSIDNT40            UPDATE PCBSSFL1             @D64ADMZ 00529416
*        B     SSIDNT25            UPDATE PCBSSFL4             @D64ADMZ 00529516
SSIDNT25 OC    PCBSSFL4,SSTBBITS+1 SUBSYSTEM-ID IN PCBSSFL4    @D64ADMZ 00529616
         B     SSIDNT50                                        @D14CDWK 00529716
SSIDNT30 OC    PCBSSFLG,SSTBBITS+1 SUBSYSTEM-ID IN PCBSSFLG    @D14CDWK 00529816
         B     SSIDNT50                                        @D14CDWK 00529916
SSIDNT35 OC    TCBFLAG3,SSTBBITS+1 SUBSYSTEM-ID IN TCBFLAG3    @D14BDWK 00530016
         B     SSIDNT50                                        @D14CDWK 00531016
SSIDNT40 OC    PCBSSFL1,SSTBBITS+1 SUBSYSTEM-ID IN PCBSSFL1    @D14BDWK 00532016
         DROP  R8                  RELEASE PCB BASE            @D14CDWK 00533016
         SPACE 1                                               @D149DWK 00534016
SSIDNT50 LH    R0,PIK              RELOAD PIK OF NOTIFIER      @D14NDWK 00535016
         LA    R5,SSIDNTBT         BRANCHTABLE ADDRESS         @D14CDWK 00536016
         SLR   R4,R4               CLEAR REGISTER TO INSERT    @D14CDWK 00537016
         IC    R4,SSTBFLG3         INSERT TABLE OFFSET         @D14CDWK 00538016
         L     R5,0(R4,R5)         ADDRESS FOR SPECIAL HANDL.  @D14CDWK 00539016
         BR    R5                  OR EXIT                     @D14CDWK 00540016
         SPACE 1                                               @D139DGN 00541016
*--------------------------------------------------------------@D139DGN 00542016
*        UPDATE SSIDLIST ENTRY                                 @D139DGN 00543016
*--------------------------------------------------------------@D139DGN 00544016
SSIDNT60 LA    R4,SSIDNTE1         EXIT IF ENTRY NOT FOUND     @D13CDGN 00545016
         BAL   R5,SSIDSCAN         SEARCH IDENTICAL NAME ENTRY @D13CDGN 00546016
*SGLINK  SSIDSCAN,INPUT=(R0,R3,R4,R5,RC),OUTPUT=(R2,R9),WORK=R7         00547016
         USING SSLED,R2            SSID LIST ENTRY BASE        @D13CDGN 00548016
         SLR   R7,R7               CLEAR TO INSERT             @D13CDGN 00549016
         IC    R7,SSIDVARL         VARYING LENGTH AND          @D13CDGN 00550016
         LA    R7,SSIDFIXL-1(,R7)  ADD FIXED PART              @D13CDGN 00551016
         CLC   SSIDVARL,SSLEVARL   SUPPLIED LENGTH VALID       @D13CDGN 00552016
         BH    SSIDNTE3            NO                          @D13CDGN 00553016
         EX    R7,SSIDNTMV         UPDATE ENTRY WITHIN LIST    @D13CDGN 00554016
         L     R5,SSIDNTBT         NOTIFY RETURN ....          @D13CDGN 00555016
         BR    R5                  NO SPECIAL HANDLING         @D13CDGN 00556016
         SPACE 1                                               @D149DWK 00557016
SSIDNTMV MVC   SSLED0(0),SSID0     EXECUTED MOVE INTO LIST     @D14CDWK 00558016
         SPACE 1                                               @D149DWK 00559016
         DROP  R1                  RELEASE PARMLIST BASE       @D14CDWK 00560016
         DROP  R2                  RELEASE SSIDLIST ENTRY BASE @D14CDWK 00561016
         SPACE 1                                               @D149DWK 00562016
*        SPECIAL SUBSYSTEM HANDLING                            @D149DWK 00563016
         SPACE 1                                               @D149DWK 00564016
SSIDNTPW L     R8,TIBPTR           ADDRESS OF CURRENT TIB      @D14CDWK 00565016
         USING TIBADR,R8           TIB BASE                    @D14CDWK 00566016
         OI    TIBFLAG2,PWRMTASK   INDICATE POWER MAINTASK     @D14CDWK 00567016
         DROP  R8                  RELEASE TIB BASE            @D14CDWK 00568016
         STH   R0,IJBPWPIK         PIK OF POWER PARTITION      @D14NDFG 00569016
         L     R8,PCBPTR           ADDRESS OF CURRENT PCB      @D31QDMZ 00570016
         USING PCBADR,R8           ADDRESS PCB                 @D31QDMZ 00571016
         OI    PCBSSFL2,PCBARIPL   REIPL MACRO ALLOWED FOR SUBS@D31QDMZ 00572016
         DROP  R8                  RELEASE BASE                @D31QDMZ 00573016
         B     SSIDRTRF            RETURN                      @D14CDWK 00574016
SSIDNTVT STH   R0,IJBVTPIK         PIK OF VTAM PARTITION       @D14NDFG 00575016
         B     SSIDRTRF            RETURN                      @D14NDWK 00576016
SSIDNTIC STH   R0,IJBICPIK         PIK OF ICCF PARTITION       @D14NDFG 00577016
         OI    TCBFLAG3,ICCFMT     SET ICCF HIGH TASK INDICAT. @D52VDGL 00578016
         B     SSIDRTRF            RETURN                      @D14NDWK 00579016
SSIDNTC2 L     R8,CRADDR           GET ADDR OF COMREG          @D51HDGL 00580016
         USING COMREG,R8           COMREG BASE                 @D36ZDWK 00590016
         LTR   RF,RF               DOES SPARM EXIST            @D64ADUL 00591016
         BZ    SSIDNTC3            NO,                         @D64ADUL 00592016
         MVC   IJBAFCB,0(RF)       MOVE POINTER TO COMREG      @D36ZDWK 00593016
SSIDNTC3 DS    0H                                              @D64ADUL 00594016
         DROP  R8                  FORGET COMREG ADDRESS       @D36ZDWK 00595016
         B     SSIDRTRF            RETURN                      @D64XDMZ 00596016
         DROP  R9                                              @D64ADMZ 00597016
SSIDNTOC MVC   IJBOCFCM,0(RF)      MOVE POINTER TO SYSCOM      @D14CDWK 00598016
         L     R8,PCBPTR           ADDRESS OF CURRENT PCB      @D31QDMZ 00599016
         USING PCBADR,R8           ADDRESS PCB                 @D31QDMZ 00600016
         OI    PCBSSFL2,PCBARIPL   REIPL MACRO ALLOWED FOR SUBS@D31QDMZ 00601016
         DROP  R8                  RELEASE BASE                @D31QDMZ 00602016
         B     SSIDRTRF            RETURN                      @D37CDWK 00603016
SSIDNTNP L     R1,0(RF)            ENTRY POINT FOR NPDA        @D14CDWK 00604016
         LA    R2,3(R1)            ENTRY POINT IS 4 BYTES      @D14CDWK 00605016
         BAL   R8,VALID            VALIDATE ENTRY POINT        @D14CDWK 00606016
*SGLINK  VALID,INPUT=(R1,R2,R6,R8),WORK=(R2,R5)                @D149DWK 00607016
         MVC   IJBNPDA,0(RF)       MOVE POINTER TO SYSCOM      @D14CDWK 00608016
         B     SSIDRTRF            RETURN                      @D37CDWK 00609016
SSIDNTCU L     R8,PCBPTR           ADDRESS OF CURRENT PCB      @D31QDMZ 00610016
         USING PCBADR,R8           ADDRESS PCB                 @D31QDMZ 00611016
         OI    PCBSSFL2,PCBARIPL   REIPL MACRO ALLOWED FOR SUBS@D31QDMZ 00612016
         DROP  R8                  RELEASE BASE                @D31QDMZ 00613016
         B     SSIDRTRF            RETURN                      @D37CDWK 00614016
         SPACE 1                                               @D149DWK 00615016
SSIDNTDM DS    0H                  SPECIAL HANDLING FOR DMF    @D64XDMZ 00616016
         LR    R1,RF               VALIDATE AREA WHERE..       @D64XDMZ 00617016
         LR    R2,RF               .. PC ROUTINE ADDR AND ARR. @D64XDMZ 00618016
         LA    R2,7(,R2)           .. IS PASSED                @D64XDMZ 00619016
         BAL   R8,VALIDSVA                                     @D64XDMZ 00620016
*SGLINK  VALIDSVA,INPUT=(R1,R2,R6,R8),WORK=(R2,R5)             @D64XDMZ 00621016
         L     R2,0(,RF)           GET ADDR OF PC ROUTINE      @D64XDMZ 00622016
         L     R4,IJBCICSI         GET CICS INFO. BLOCK        @D64XDMZ 00623016
         L     R5,CICSDPCN-CICSINFO(R4) GET PC NUMBER FOR DMF  @D64XDMZ 00624016
         SRL   R5,8                REMOVE OFFSET IN ENTRY TABLE@D64XDMZ 00625016
         SLL   R5,2                OFFSET IN LINKAGE TABLE     @D64XDMZ 00626016
         L     R1,IJBDSICB         ADDR OF DATA SPACE CB       @D64XDMZ 00627016
         USING DSINFOTB,R1                                     @D64XDMZ 00628016
         L     R1,DSLINKTB         ADDR OF SYSTEM LINKAGE TABLE@D64XDMZ 00629016
         DROP  R1                  RELEASE DS CB               @D64XDMZ 00630016
         L     R1,0(R5,R1)         ADDR OF ENTRY TABLE         @D64XDMZ 00631016
         SRL   R1,4                REMOVE LENGTH OF ENTRY ..   @D64XDMZ 00632016
         SLL   R1,4                .. TABLE IN LAST 4 BITS     @D64XDMZ 00633016
         SR    R5,R5               GET INDEX  IN ..            @D64XDMZ 00634016
         ICM   R5,1,CICSDPCN+3-CICSINFO(R4) .. ENTRY TABLE ..  @D64XDMZ 00635016
         SLL   R5,5                .. OFFSET IN ENTRY TABLE    @D64XDMZ 00636016
         AR    R1,R5               ADDR OF ENTRY TABLE ENTRY   @D64XDMZ 00637016
         USING ETE,R1                                          @D64XDMZ 00638016
         ST    R2,ETEEPA           ADDR OF PC ROUTINE          @D64XDMZ 00639016
         SRL   R0,4                ASN = PIK/16                @D64XDMZ 00640016
         STH   R0,ETEASID          STORE IT IN ENTRY TABLE     @D64XDMZ 00641016
         L     R8,PCBPTR           GET PCB OF SUBSID ISSUER    @D64XDMZ 00642016
         USING PCBADR,R8                                       @D64XDMZ 00643016
         MVC   ETEASTE,PCBASTER    REAL ADDR OF ASTE           @D64XDMZ 00644016
         DROP  R8                  RELEASE PCB                 @D64XDMZ 00645016
         L     R1,ETEPARM          ADDR OF LATENT PARA. AREA   @D64XDMZ 00646016
         DROP  R1                  RELEASE ETE                 @D64XDMZ 00647016
         USING LPA,R1              ADDR LATENT PARA. AREA      @D64XDMZ 00648016
         L     R2,4(,RF)           GET ADDR OF ARR EXIT        @D64XDMZ 00649016
         ST    R2,LPARR            ADDR OF ARR IN LPA          @D64XDMZ 00650016
         DROP  R1                  RELEASE LPA                 @D64XDMZ 00651016
         B     SSIDRTRF            RETURN                      @D64XDMZ 00652016
         SPACE 1                                               @D149DWK 00653016
*        SET RETURN CODE                                       @D149DWK 00654016
         SPACE 1                                               @D149DWK 00655016
SSIDNTE1 LA    RF,SSIDNTCO         SUBSYSTEM NAME INVALID      @D14CDWK 00656016
         B     SSIDRTCD                                        @D35XDGS 00657016
         SPACE 1                                               @D35XDGS 00658016
SSIDNTE2 LA    RF,SSIDNTLO         SUBYSTEM LIST FULL          @D14CDWK 00659016
         B     SSIDRTCD                                        @D35XDGS 00660016
         SPACE 1                                               @D35XDGS 00661016
SSIDNTE3 LA    RF,SSIDNTLE         ENTRY TOO LONG              @D14CDWK 00662016
         B     SSIDRTCD                                        @D35XDGS 00663016
         SPACE 1                                               @D35XDGS 00664016
SSIDNTE4 LA    RF,SSIDNTDE         DUPLICATE ENTRY             @D14CDWK 00665016
         B     SSIDRTCD                                        @D35XDGS 00666016
         SPACE 1                                               @D149DWK 00667016
*--------------------------------------------------------------@D149DWK 00668016
*        REMOVE ROUTINE                                        @D149DWK 00669016
*--------------------------------------------------------------@D149DWK 00670016
         SPACE 1                                               @D149DWK 00680016
         USING SSID,R1             NAME FIELD BASE             @D14CDWK 00681016
         SPACE 1                                               @D149DWK 00682016
         DC    CL8'REMOVE'                                     #DEBUGGL 00683016
         SPACE 1                                               @D149DWK 00684016
*        VALIDATE PARAMETER                                    @D149DWK 00685016
         SPACE 1                                               @D149DWK 00686016
SSIDREMV LA    R2,L'SSIDNAME-1(,R1) GET LAST BYTE ADDRESS      @D35XDGS 00687016
         BAL   R8,VALIDSVA         VALIDATE PARAMETER          @D35XDGS 00688016
*SGLINK  VALIDSVA,INPUT=(R1,R2,R6,R8),WORK=(R2,R5)             @D369DWK 00689016
         SPACE 1                                               @D149DWK 00690016
*        SEARCH ENTRY TO BE REMOVED                            @D149DWK 00691016
         SPACE 1                                               @D149DWK 00692016
SSIDRM00 L     R8,PCBPTR           ADDRESS OF CURRENT PCB      @D14CDWK 00693016
         USING PCBADR,R8           PCB BASE                    @D14CDWK 00694016
         CLI   PCBSSCNT,X'00'      IF SUBSYSTEM COUNT ZERO     @D35XDGS 00695016
         BE    SSIDRMNO            THEN RETURN : NOT FOUND     @D14CDWK 00696016
         LTR   R3,R3               EOT REQUEST                 @D14CDWK 00697016
         BZ    SSIDRM20            YES                         @D14CDWK 00698016
         LA    R4,SSIDRMNO         EXIT IF NAME INVALID        @D14CDWK 00699016
         BAL   R5,SSIDCNAM         CHECK IF NAME VALID         @D14CDWK 00700016
*SGLINK  SSIDCNAM,INPUT=(R1,R4,R5,RC),OUTPUT=(R3,R9)                    00701016
         DROP  R1                  RELEASE NAME FIELD BASE     @D14CDWK 00702016
         USING SSTBENTR,R9         SSID NAME TABLE ENTRY BASE  @D14CDWK 00703016
         SPACE 1                                               @D149DWK 00704016
         LH    R0,PIK              CURRENT PIK                 @D14CDWK 00705016
         CLI   SSTBFLG1,SSTBSTID   TID TO BE SPECIFIED         @D14CDWK 00706016
         BNE   SSIDRM30            NO                          @D14CDWK 00707016
SSIDRM20 DS    0H                                              @D66ODOW 00708016
         LH    R0,TID              CURRENT TASK ID             @D66ODOW 00709016
SSIDRM30 LA    R4,SSIDRMNO         EXIT IF NO ENTRY FOUND      @D14CDWK 00710016
         BAL   R5,SSIDSCAN         SEARCH IDENTICAL NAME ENTRY @D14CDWK 00711016
*SGLINK  SSIDSCAN,INPUT=(R0,R3,R4,R5,RC),OUTPUT=(R2,R9),WORK=R7         00712016
         USING SSLED,R2            SSIDLIST ENTRY BASE         @D14CDWK 00713016
*                                                              @D149DWK 00714016
*        GET NAME TABLE ENTRY IF EOT REQUEST                   @D149DWK 00715016
*                                                              @D149DWK 00716016
         LTR   R3,R3               EOT REQUEST                 @D14CDWK 00717016
         BNZ   SSIDRM35            NO                          @D14CDWK 00718016
         LA    R1,SSLENAME         POINT TO SSIDLIST NAME FIELD@D14CDWK 00719016
         LA    R4,SYSERROR         EXIT IF NAME INVALID        @D14CDWK 00720016
         MVI   IJBHWORG,HWORG180   UNIQUE HARD WAIT ORIGINATOR @D31QDHB 00730016
         BAL   R5,SSIDCNAM         CHECK IF NAME VALID         @D14CDWK 00731016
*SGLINK  SSIDCNAM,INPUT=(R1,R4,R5,RC),OUTPUT=(R3,R9)                    00732016
         MVI   IJBHWORG,HWORG000   RESET  HARD WAIT ORIGINATOR @D31QDHB 00733016
         SLR   R3,R3               INDICATE EOT REQUEST        @D14CDWK 00734016
         SPACE 1                                               @D149DWK 00735016
*        UPDATE CONTROL BLOCKS                                 @D149DWK 00736016
         SPACE 1                                               @D149DWK 00737016
SSIDRM35 SLR   R7,R7               CLEAR REGISTER FOR IC       @D14CDWK 00738016
         SLR   R5,R5               CLEAR REGISTER FOR IC       @D64ADMZ 00739016
         IC    R7,PCBSSCNT         GET CURR COUNT VALUE        @D35XDGS 00740016
         BCTR  R7,0                DECREMENT COUNT BY ONE      @D14CDWK 00741016
         STC   R7,PCBSSCNT         STORE NEW VALUE             @D369DWK 00742016
         IC    R7,SSLEDFLG+1       CORRESPONDING FLAG TO RESET @D66ODOW 00743016
         X     R7,SSIDCMPL         COMPLEMENT FLAG BYTE        @D64ADMZ 00744016
         IC    R5,SSTBFLG2                                     @D64ADMZ 00745016
         B     SSIDRMBR(R5)        BRANCH TO SELECTED ROUTINE  @D64ADMZ 00746016
SSIDRMBR B     SSIDRM40            UPDATE PCBSSFLG             @D64ADMZ 00747016
         B     SSIDRM45            UPDATE TCBFLAG3             @D64ADMZ 00748016
         B     SSIDRM50            UPDATE PCBSSFL1             @D64ADMZ 00749016
*        B     SSIDRM25            UPDATE PCBSSFL4             @D64ADMZ 00750016
SSIDRM25 LA    R8,PCBSSFL4                                     @D64ADMZ 00751016
         B     SSIDRM60                                        @D64ADMZ 00752016
SSIDRM40 LA    R8,PCBSSFLG                                     @D64ADMZ 00752116
         B     SSIDRM60                                        @D64ADMZ 00752216
SSIDRM45 LA    R8,TCBFLAG3                                     @D64ADMZ 00752316
         B     SSIDRM60                                        @D14CDWK 00752416
SSIDRM50 LA    R8,PCBSSFL1                                     @D64ADMZ 00752516
         DROP  R8                  RELEASE PCB BASE            @D14CDWK 00752616
SSIDRM60 DS    0H                                              @D64ADMZ 00752716
         EX    R7,SSIDRMFL         RESET SUBSYSTEM FLAG        @D64ADMZ 00752816
         SPACE 1                                               @D149DWK 00752916
*        UPDATE SSID LIST                                      @D149DWK 00753016
         SPACE 1                                               @D149DWK 00754016
         LR    R1,R3               SAVE NAME FIELD             @D14CDWK 00755016
         SLR   R3,R3                                           @D14CDWK 00756016
         IC    R3,SSLEVARL         TAKE VARYING LENGTH         @D35XDGS 00757016
         LA    R3,SSLEFIXL(,R3)    CALCULATE ENTRY LENGTH      @D35XDGS 00758016
         LA    R4,0(R2,R3)         -> FOLLOWING ENTRY          @D35XDGS 00759016
         L     R5,ASSIDFSP         GET LIST END POINTER        @D35XDGS 00760016
         SLR   R5,R4               CALC SOURCE LENGTH          @D35XDGS 00761016
         LR    R3,R5               AND COPY AS TARGET LG       @D35XDGS 00762016
         LA    R7,0(R2,R5)         NEW END PTR VALUE           @D35XDGS 00763016
         ST    R7,ASSIDFSP         NEW FREE SPACE POINTER      @D14CDWK 00764016
         MVCL  R2,R4               ERASE OBSOLETE ENTRY        @D14BDWK*00765016
                                   BY LEFTSHIFT OF REMAIN-     @D35XDGS*00766016
                                   NING ENTRIES                @D35XDGS 00767016
         DROP  R2                  RELEASE SSIDLIST ENTRY BASE @D14CDWK 00768016
         SPACE 1                                               @D149DWK 00769016
         LA    R5,SSIDRMBT         BRANCHTABLE ADDRESS         @D14CDWK 00770016
         SLR   R4,R4               CLEAR REGISTER TO INSERT    @D14CDWK 00771016
         IC    R4,SSTBFLG3         INSERT TABLE OFFSET         @D14CDWK 00772016
         L     R5,0(R4,R5)         ADDRESS FOR SPECIAL HANDL.  @D14CDWK 00773016
         SLR   R0,R0               VALUE TO CLEAR SUBSID PIK   @D14NDFG 00774016
         BR    R5                  OR EXIT                     @D14CDWK 00775016
         SPACE 1                                               @D149DWK 00776016
         DROP  R9                  RELEASE SSID NAME TAB.ENTRY @D14CDWK 00777016
         SPACE 1                                               @D149DWK 00778016
SSIDRMFL NI    0(R8),X'00'         EXECUTED RESET SUBSID FLAG  @D149DWK 00779016
         SPACE 1                                               @D149DWK 00780016
*        SPECIAL SUBSYSTEM HANDLING                            @D149DWK 00790016
         SPACE 1                                               @D149DWK 00791016
SSIDRMPW L     R8,TIBPTR           ADDRESS OF CURRENT TIB      @D14CDWK 00792016
         USING TIBADR,R8           TIB BASE                    @D14CDWK 00793016
         NI    TIBFLAG2,X'FF'-PWRMTASK  RESET PWR MAINTASK IND.@D14CDWK 00794016
         DROP  R8                  RELEASE TIB                 @D14CDWK 00795016
         STH   R0,IJBPWPIK         RESET PIK OF POWER PART.    @D14NDFG 00796016
         B     SSIDRM90                                        @D14CDWK 00797016
SSIDRMVT STH   R0,IJBVTPIK         RESET PIK OF VTAM PART.     @D14NDFG 00798016
         B     SSIDRM90                                        @D14NDWK 00799016
SSIDRMIC STH   R0,IJBICPIK         RESET PIK OF ICCF PART.     @D14NDFG 00800016
         NI    TCBFLAG3,X'FF'-ICCFMT  RESET ICCF HIGHTASK IND. @D52VDGL 00801016
         B     SSIDRM90                                        @D14NDWK 00802016
SSIDRMC2 DS    0H                  FOR CICS REMOVAL            @D51HDGL 00803016
         L     R8,CRADDR           GET COMREG ADDRESS          @D36ZDWK 00804016
         USING COMREG,R8           ADDRESS COMREG              @D36ZDWK 00805016
         XC    IJBAFCB,IJBAFCB     DELETE POINTER              @D37ZDWK 00806016
         DROP  R8                  RELEASE COMREG              @D36ZDWK 00807016
         B     SSIDRM90                                        @D14CDWK 00808016
SSIDRMOC XC    IJBOCFCM,IJBOCFCM   CLEAR SYSCOM FIELD          @D14CDWK 00809016
*        LA    R5,SRQOCF           POINT TO OCCF WAIT QUEUE    @D61CSGL 00810016
*        BAL   RF,RPOST            POST ALL WAITING TASKS      @D61CSGL 00811016
*SGLINK  RPOST,INPUT=(R5,R6,RF),WORK=(R5,RE)                   @D37CDWK 00812016
         B     SSIDRM90                                        @D14CDWK 00813016
SSIDRMNP XC    IJBNPDA,IJBNPDA     CLEAR SYSCOM FIELD          @D14CDWK 00814016
         B     SSIDRM90                                        @D14CDWK 00815016
         SPACE 1                                               @D149DWK 00816016
SSIDRMDM DS    0H                  REMOVE FOR DMF              @D64XDMZ 00817016
         L     R4,IJBCICSI         GET CICS INFO. BLOCK        @D64XDMZ 00818016
         L     R5,CICSDPCN-CICSINFO(R4) GET PC NUMBER FOR DMF  @D64XDMZ 00819016
         SRL   R5,8                REMOVE OFFSET IN ENTRY TABLE@D64XDMZ 00820016
         SLL   R5,2                OFFSET IN LINKAGE TABLE     @D64XDMZ 00821016
         L     R3,IJBDSICB         ADDR OF DATA SPACE CB       @D64XDMZ 00822016
         USING DSINFOTB,R3                                     @D64XDMZ 00823016
         L     R3,DSLINKTB         ADDR OF SYSTEM LINKAGE TABLE@D64XDMZ 00824016
         DROP  R3                  RELEASE DS CB               @D64XDMZ 00825016
         L     R3,0(R5,R3)         ADDR OF ENTRY TABLE         @D64XDMZ 00826016
         SRL   R3,4                REMOVE LENGTH OF ENTRY..    @D64XDMZ 00827016
         SLL   R3,4                .. TABLE IN ADDRESS         @D64XDMZ 00828016
         SR    R5,R5               GET INDEX  IN ..            @D64XDMZ 00829016
         ICM   R5,1,CICSDPCN+3-CICSINFO(R4) .. ENTRY TABLE ..  @D64XDMZ 00830016
         SLL   R5,5                .. OFFSET IN ENTRY TABLE    @D64XDMZ 00831016
         AR    R3,R5               ADDR OF ENTRY TABLE ENTRY   @D64XDMZ 00832016
         SR    R2,R2                                           @D64XDMZ 00833016
         USING ETE,R3                                          @D64XDMZ 00834016
         STH   R2,ETEASID          PREVENT SPACE SWITCH        @D64XDMZ 00835016
         ST    R2,ETEASTE          CLEAR ASTE                  @D64XDMZ 00836016
         L     R2,ASUPAVTE         ADDR SUPAVTEX               @D64XDMZ 00837016
         USING SUPAVTEX,R2                                     @D64XDMZ 00838016
         MVC   ETEEPA,ALSTKERR     ADDR OF CANCEL ROUTINE..    @D64XDMZ 00839016
         DROP  R2                  RELEASE SUPAVTEX            @D64XDMZ 00840016
         L     R3,ETEPARM          ADDR OF LATENT PARA. AREA   @D64XDMZ 00841016
         DROP  R3                  RELEASE ETE                 @D64XDMZ 00842016
         USING LPA,R3              ADDR LATENT PARA. AREA      @D64XDMZ 00843016
         SR    R2,R2                                           @D64XDMZ 00844016
         ST    R2,LPARR            ARR NO LONGER AVAILABLE     @D64XDMZ 00845016
         DROP  R3                  RELEASE LPA                 @D64XDMZ 00846016
                                                                        00847016
*        B     SSIDRM90                                        @D14CDWK 00848016
SSIDRM90 LTR   R3,R1               EOT REQUEST                 @D14CDWK 00849016
         BZ    SSIDRM00            YES, CHECK AGAIN            @D14CDWK 00850016
         B     SSIDRTRF            NO, RETURN                  @D14CDWK 00851016
         SPACE 1                                               @D149DWK 00852016
         SPACE 1                                               @D149DWK 00853016
*        SET RETURN CODE                                       @D149DWK 00854016
         SPACE 1                                               @D149DWK 00855016
SSIDRMNO LA    RF,SSIDRMNF         INDICATE NAME NOT FOUND     @D14CDWK 00856016
         B     SSIDRTCD                                        @D14CDWK 00857016
         SPACE 1                                               @D149DWK 00858016
*--------------------------------------------------------------@D149DWK 00859016
*        RETURN WITH RETCODE                                   @D149DWK 00860016
*--------------------------------------------------------------@D149DWK 00861016
         SPACE 1                                               @D149DWK 00862016
SSIDRTRF SR    RF,RF               CLEAR RETURN CODE REGISTER  @D37ZDWK 00863016
SSIDRTCD EQU   *                   E X I T  WITH RET CODE      @D35XDGS 00864016
         AMODESW SET,AMODE=24,WR=(R1)                          @D52VDGL 00865016
         LA    R1,SVER0F-SVEARA    RETURN CODE IN GR 15        @D35XDGS 00866016
         B     RETCODE             RETURN WITH RET CODE        @D35XDGS 00867016
*SGLINK  RETCODE,INPUT=(R1,R6,RF),WORK=(RA)                    @D369DWK 00868016
         SPACE 1                                               @D149DWK 00869016
*--------------------------------------------------------------@D149DWK 00870016
*        CHECK IF VALID NAME SPECIFIED AND GET BRANCHTABLE     @D149DWK 00880016
*        ADDRESS FOR SPECIFIED SUBSYSTEM                       @D149DWK 00881016
*        INPUT  R1  SUBSID PARAMETER LIST                      @D149DWK 00882016
*               R4  RETURN ADDRESS ENTRY NOT FOUND             @D149DWK 00883016
*               R5  RETURN ADDRESS ENTRY FOUND                 @D149DWK 00884016
*        OUTPUT R3  SUBSYSTEM NAME                             @D149DWK 00885016
*               R9  POINTER SUBSYSTEM NAME TABLE ENTRY         @D149DWK 00886016
*--------------------------------------------------------------@D149DWK 00887016
***************************************************************         00888016
*  CODEBLOCK SSIDCNAM                                         *         00889016
*  FUNCTION: CHECK IF VALID NAME SPECIFIED AND GET BRANCHTABLE*         00890016
*    ADDRESS FOR SPECIFIED SUBSYSTEM                          *         00891016
*  ON ENTRY:                                                  *         00892016
*    R1 = SUBSID PARAMETER LIST                               *         00893016
*    R4 = RETURN ADDRESS FOR ENTRY NOT FOUND                  *         00894016
*    R5 = RETURN ADDRESS FOR ENTRY FOUND                      *         00895016
*  ON EXIT TO R4:                                             *         00896016
*    ...                                                      *         00897016
*  ON EXIT TO R5:                                             *         00898016
*    R3 = SUBSYSTEM NAME                                      *         00899016
*    R9 = PTR TO SUBSYSTEM NAME TABLE ENTRY                   *         00900016
***************************************************************         00901016
         SPACE 1                                               @D149DWK 00902016
         USING SSID,R1             NAME FIELD BASE             @D14CDWK 00903016
         DC    C'SSIDCNAM'                                     #DEBUGGL 00904016
*SGLINK  SSIDCNAM,INPUT=(R1,R4,R5,RC),OUTPUT=(R3,R9)                    00905016
SSIDCNAM DS    0H                                              @D14CDWK 00906016
         L     R3,SSIDNAME         LOAD SEARCH ARGUMENT        @D14CDWK 00907016
         LA    R9,SSTABLE          POINT TO TABLE              @D14CDWK 00908016
         USING SSTBENTR,R9         SSID NAME TABLE ENTRY BASE  @D14CDWK 00909016
SSIDCN10 CL    R3,SSTBNAME         SUBSYSTEM NAME MATCH        @D14CDWK 00910016
         BER   R5                  YES                         @D14CDWK 00911016
         LA    R9,SSTBNEXT         NO, POINT TO NEXT ENTRY     @D14CDWK 00912016
         CLI   SSTBNAME,X'FF'      END OF LIST                 @D14CDWK 00913016
         BNE   SSIDCN10            NO, GO ON SEARCHING         @D14CDWK 00914016
         BR    R4                  YES,UNKNOWN SUBSYSTEM NAME  @D14CDWK 00915016
         DROP  R1                  RELEASE NAME FIELD BASE     @D14CDWK 00916016
         DROP  R9                  RELEASE SSID NAME TAB.ENTRY @D14CDWK 00917016
         SPACE 1                                               @D149DWK 00918016
***************************************************************         00919016
*  CODEBLOCK SSIDSCAN                                         *         00920016
*  FUNCTION: SCAN SSIDLIST FOR SPECIFIED ENTRY                *         00921016
*  ON ENTRY:                                                  *         00922016
*    R0 = PIK OR TID, NAME SEARCH ONLY IF ZERO                *         00923016
*    R2 = POINTER TO ENTRY IN SSIDLIST WHERE TO START         *         00924016
*         SECOND ENTRY SEARCH (INQUIRY)                       *         00925016
*    R3 = SUBSYSTEM NAME, ZERO FOR EOT REQUEST                *         00926016
*    R4 = RETURN ADDRESS FOR ENTRY NOT FOUND                  *         00927016
*    R5 = RETURN ADDRESS FOR ENTRY FOUND                      *         00928016
*  ON EXIT TO R4:                                             *         00929016
*    ...                                                      *         00930016
*  ON EXIT TO R5:                                             *         00931016
*    R2 = POINTER TO SSIDLIST ENTRY                           *         00932016
*    R9 = POINTER TO SECOND ACTIVE ENTRY, IF ANY              *         00933016
***************************************************************         00934016
         SPACE 1                                               @D149DWK 00935016
         DC    C'SSIDSCAN'                                     #DEBUGGL 00936016
*SGLINK  SSIDSCAN,INPUT=(R0,R3,R4,R5,RC),OUTPUT=(R2,R9),WORK=R7         00937016
SSIDSCAN DS    0H                  SUBSYSTEM LIST SCAN         @D14CDWK 00938016
         L     R2,ASSIDBEG         POINT TO 1ST ENTRY          @D35XDGS 00939016
         USING SSLED,R2            SSIDLIST ENTRY BASE         @D14CDWK 00940016
SSIDSC00 EQU   *                   SECOND ENTRY SEARCH         @D14CDWK 00950016
         SLR   R7,R7               CLEAR REGISTER FOR IC       @D35XDGS 00960016
SSIDSC10 CL    R2,ASSIDFSP         TEST FOR END OF LIST        @D14CDWK 00961016
         BNLR  R4                  YES, NOT FOUND              @D14CDWK 00962016
         LTR   R3,R3               EOT REQUEST                 @DY38583 00963016
         BZ    SSIDSC30            YES, TEST TASK ID ONLY      @DY38583 00964016
         CLM   R3,15,SSLENAME      NAME MATCH                  @D66ODOW 00965016
         BNE   SSIDSC50            NO                          @DY38583 00966016
         LTR   R0,R0               PIK OR TID SEARCH REQUIRED  @DY38583 00967016
         BZR   R5                  TEST NAME ONLY, FOUND       @D14CDWK 00968016
         CLI   SSIDFACT,SSIDFINQ   INQUIRY FUNCTION ACTIVE     @DY38583 00969016
         BE    SSIDSC20            YES, PIK SEARCH ONLY        @DY38583 00970016
         USING SSTBENTR,R9         GET SS-NAME TABLE ADDRESSAB @DY38583 00971016
         CLI   SSTBFLG1,SSTBSTID   SUBSYSTEM TASK ID RELATED   @DY38583 00972016
         BE    SSIDSC30            YES, TEST FOR TASK ID       @DY38583 00973016
         DROP  R9                  RELEASE SS-NAME TABLE ADDR  @DY38583 00974016
SSIDSC20 EQU   *                                               @DY38583 00975016
         CH    R0,SSLEDPIK         PARTITION ID SAME           @D14CDWK 00976016
         BER   R5                  YES, FOUND                  @D14CDWK 00977016
         B     SSIDSC40            NO, CONTINUE                @DY38583 00978016
SSIDSC30 CH    R0,SSLEDTID         TASK ID SAME                @D66ODOW 00979016
         BER   R5                  YES, FOUND                  @D14CDWK 00980016
SSIDSC40 LTR   R9,R9               INQUIRY FIRST NAME FOUND    @DY38583 00981016
         BNZ   SSIDSC50            NO                          @DY38583 00982016
         LR    R9,R2               SAVE FIRST NAME OCCURENCE   @DY38583 00983016
SSIDSC50 IC    R7,SSLEVARL         BUMP TO NEXT ACTIVE         @DY38583 00984016
         LA    R2,SSLEFIXL(R7,R2)   SUBSYSTEM TABLE ENTRY      @D14CDWK 00985016
         B     SSIDSC10            CONTINUE SCAN               @D14CDWK 00986016
         SPACE 1                                               @D369DWK 00987016
         DROP  R2                  RELEASE SSIDLIST ENTRY BASE @D14CDWK 00988016
         SPACE 1                                               @D149DWK 00989016
*--------------------------------------------------------------@D149DWK 00990016
*        INTERNAL DATA                                         @D149DWK 00991016
*--------------------------------------------------------------@D149DWK 00992016
         SPACE 1                                               @D149DWK 00993016
         DC    C'ASSIDBEG'                                     #DEBUGGL 00994016
         DC    0F'0'               ALIGN TO FULL WORD          @D14CDWK 00995016
ASSIDBEG DC    A(SSIDLIST)         LIST BEGIN ADDRESS          @D35XDGS 00996016
ASSIDEND DC    A(SSIDLSTE)         LIST END ADDRESS (+1)       @D35XDGS 00997016
ASSIDFSP DC    A(SSIDLST1)         FREE SPACE POINTER          @D35XDGS 00998016
SSIDCMPL DC    X'FFFFFFFF'         COMPLEMENT VALUE            @D14CDWK 00999016
SSIDMAXL DC    H'32'               MAXIMUM SUBSID LENGTH       @D35XDGS 01000016
SSIDNONA DC    CL4' '              EOT DUMMY NAME              @D37ZDWK 01001016
SSIDMAXR DC    X'02'               MAX. ROUTE ID MINUS ONE     @D14ZDWK 01002016
SSIDINF1 DC    X'00'               INTERNAL SUBSID FLAG        @D14ZDWK 01003016
SSIDFTIN EQU   X'80'               0   INITIALISATION DONE     @D14ZDWK 01004016
*                                  1-7 RESERVED                @D14ZDWK 01005016
SSIDFACT DC    X'00'               CURRENT ACTIVE FUNCTION     @DY38583 01006016
SSIDFNOT EQU   X'01'                FUNCTION NOTIFY            @DY38583 01007016
SSIDFREM EQU   X'02'                FUNCTION REMOVE            @DY38583 01008016
SSIDFINQ EQU   X'03'                FUNCTION INQUIRY           @DY38583 01009016
         SPACE 2                                               @D35XDGS 01010016
SSTABLE  DC    0H'0'               SUBSYSTEM NAMES & FLAGS     @D35XDGS 01011016
*                                   TABLE                      @D35XDGS 01012016
SSTBSUP  DC    CL4'SUP '                                       @D36ZDWK 01013016
         DC    AL2(0)              NO SUBSYSTEM ID             @D36ZDWK 01014016
         DC    AL4(0)              NO SPECIAL HANDLING         @D14CDWK 01015016
SSTBPWR  DC    CL4'PWR '           SUBSYSTEM NAME FOR POWER    @D36IDWK 01016016
         DC    AL2(PWR)            SUBSYSTEM ID FOR POWER      @D36ZDWK 01017016
         DC    AL1(SSTBSNAM)       NAME SEARCH ONLY            @D14CDWK 01018016
         DC    AL1(SSTBPCBS)       FLAG IN PCBSSFLG            @D14CDWK 01019016
         DC    XL1'04'             BRANCH TABLE INDEX          @D14CDWK 01020016
         DC    XL1'00'             RESERVED                    @D14CDWK 01021016
SSTBVTAM DC    CL4'VTAM'           SUBSYSTEM NAME FOR VTAM     @D36ZDWK 01022016
         DC    AL2(VTAM)           SUBSYSTEM ID FOR VTAM       @D36ZDWK 01023016
         DC    AL1(SSTBSNAM)       NAME SEARCH ONLY            @D14CDWK 01024016
         DC    AL1(SSTBPCBS)       FLAG IN PCBSSFLG            @D14CDWK 01025016
         DC    XL1'18'             BRANCH TABLE INDEX          @D14CDWK 01026016
         DC    XL1'00'             RESERVED                    @D14CDWK 01027016
SSTBICCF DC    CL4'ICCF'           SUBSYSTEM NAME FOR ICCF     @D36ZDWK 01028016
         DC    AL2(ICCF)           SUBSYSTEM ID FOR ICCF       @D36ZDWK 01029016
         DC    AL1(SSTBSNAM)       NAME SEARCH ONLY            @D14CDWK 01030016
         DC    AL1(SSTBPCBS)       FLAG IN PCBSSFLG            @D14CDWK 01031016
         DC    XL1'1C'             BRANCH TABLE INDEX          @D14CDWK 01032016
         DC    XL1'00'             RESERVED                    @D14CDWK 01033016
SSTBCIC3 DC    CL4'CIC3'           SUBSYSTEM NAME FOR CICS     @D52HDGL 01034016
         DC    AL2(CICS)           SUBSYSTEM ID FOR CICS       @D52HDGL 01035016
         DC    AL1(SSTBSPIK)       NAME AND PIK SEARCH         @D52HDGL 01036016
         DC    AL1(SSTBPCBS)       FLAG IN PCBSSFLG            @D52HDGL 01037016
         DC    XL1'08'             BRANCH TABLE INDEX          @D52HDGL 01038016
         DC    XL1'00'             RESERVED                    @D52HDGL 01039016
SSTBCIC4 DC    CL4'CIC4'           SUBSYSTEM NAME FOR CICS V4  @D64IDJK 01040016
         DC    AL2(CICS)           SUBSYSTEM ID FOR CICS V4    @D64IDJK 01041016
         DC    AL1(SSTBSPIK)       NAME AND PIK SEARCH         @D64IDJK 01042016
         DC    AL1(SSTBPCBS)       FLAG IN PCBSSFLG            @D64IDJK 01043016
         DC    XL1'08'             BRANCH TABLE INDEX          @D64IDJK 01044016
         DC    XL1'00'             RESERVED                    @D64IDJK 01045016
SSTBOCCF DC    CL4'OCCF'           SUBSYSTEM NAME FOR OCCF     @D37CDWK 01046016
         DC    AL2(OCCF)           SUBSYSTEM ID FOR OCCF       @D37CDWK 01047016
         DC    AL1(SSTBSNAM)       NAME SEARCH ONLY            @D14CDWK 01048016
         DC    AL1(SSTBPCBS)       FLAG IN PCBSSFLG            @D14CDWK 01049016
         DC    XL1'0C'             BRANCH TABLE INDEX          @D14CDWK 01050016
         DC    XL1'00'             RESERVED                    @D14CDWK 01051016
SSTBDS2  DC    CL4'ARI '           SUBSYSTEM NAME FOR DS2      @D37CDWK 01052016
         DC    AL2(DS2)            SUBSYSTEM ID FOR DS2        @D37CDWK 01053016
         DC    AL1(SSTBSPIK)       NAME AND PIK SEARCH         @D14CDWK 01054016
         DC    AL1(SSTBPCBS)       FLAG IN PCBSSFLG            @D14CDWK 01055016
         DC    XL1'00'             BRANCH TABLE INDEX          @D14CDWK 01056016
         DC    XL1'00'             RESERVED                    @D14CDWK 01057016
SSTBDLI  DC    CL4'DLI '           SUBSYSTEM NAME FOR DL1      @D14BDWK 01058016
         DC    AL2(DLIMT)          SUBSYSTEM ID FOR DL1        @D14CDFG 01059016
         DC    AL1(SSTBSTID)       NAME AND TID SEARCH         @D14CDWK 01060016
         DC    AL1(SSTBTCB3)       FLAG IN TCBFLAG3            @D14CDWK 01061016
         DC    XL1'00'             BRANCH TABLE INDEX          @D14CDWK 01062016
         DC    XL1'00'             RESERVED                    @D14CDWK 01063016
SSTBISPF DC    CL4'ISPF'           SUBSYSTEM NAME FOR SPF      @D14BDWK 01064016
         DC    AL2(ISPFMT)         SUBSYSTEM ID FOR SPF        @D14BDWK 01065016
         DC    AL1(SSTBSTID)       NAME AND TID SEARCH         @D14CDWK 01066016
         DC    AL1(SSTBTCB3)       FLAG IN TCBFLAG3            @D14CDWK 01067016
         DC    XL1'00'             BRANCH TABLE INDEX          @D14CDWK 01068016
         DC    XL1'00'             RESERVED                    @D14CDWK 01069016
SSTBVCNA DC    CL4'VCNA'           SUBSYSTEM NAME AND ID FOR   @D37CDJB 01070016
         DC    AL2(VCNA)           SERVICE APPLICATION         @D37CDJB 01071016
         DC    AL1(SSTBSPIK)       NAME AND PIK SEARCH         @D14CDWK 01072016
         DC    AL1(SSTBPCBS)       FLAG IN PCBSSFLG            @D14CDWK 01073016
         DC    XL1'10'             BRANCH TABLE INDEX          @D14CDWK 01074016
         DC    XL1'00'             RESERVED                    @D14CDWK 01075016
SSTBNPDA DC    CL4'NPDA'           SUBSYSTEM NAME FOR NPDA     @D14BDWK 01076016
         DC    AL2(NPDA)           SUBSYSTEM ID FOR NPDA       @D14BDWK 01077016
         DC    AL1(SSTBSNAM)       NAME SEARCH ONLY            @D14CDWK 01078016
         DC    AL1(SSTBPCB1)       FLAG IN PCBSSFL1            @D14CDWK 01079016
         DC    XL1'14'             BRANCH TABLE INDEX          @D14CDWK 01080016
         DC    XL1'00'             RESERVED                    @D14CDWK 01081016
SSTBSSX  DC    CL4'SSX '           SUBSYSTEM NAME FOR SSX      @D14BDWK 01082016
         DC    AL2(SSX)            SUBSYSTEM ID FOR SSX        @D14BDWK 01083016
         DC    AL1(SSTBSPIK)       NAME AND PIK SEARCH         @D14CDWK 01084016
         DC    AL1(SSTBPCBS)       FLAG IN PCBSSFLG            @D14CDWK 01085016
         DC    XL1'00'             BRANCH TABLE INDEX          @D14CDWK 01086016
         DC    XL1'00'             RESERVED                    @D14CDWK 01087016
SSTBFTP  DC    CL4'FTP '           SUBSYSTEM NAME FOR FTP      @D14BDWK 01088016
         DC    AL2(FTPTSK)         SUBSYSTEM ID FOR FTP        @D14BDWK 01089016
         DC    AL1(SSTBSTID)       NAME AND TID SEARCH         @D14BDWK 01090016
         DC    AL1(SSTBTCB3)       FLAG IN TCBFLAG3            @D14BDWK 01091016
         DC    XL1'00'             BRANCH TABLE INDEX          @D14BDWK 01092016
         DC    XL1'00'             RESERVED                    @D14BDWK 01093016
SSTBSOEM DC    CL4'SOEM'           SUBSYSTEM NAME FOR SOEMI    @DA34091 01094016
         DC    AL2(SOEMI)          SUBSYSTEM ID FOR SOEMI      @DA34091 01095016
         DC    AL1(SSTBSTID)       NAME AND TID SEARCH         @DA34091 01096016
         DC    AL1(SSTBTCB3)       FLAG IN TCBFLAG3            @DA34091 01097016
         DC    XL1'00'             BRANCH TABLE INDEX          @DA34091 01098016
         DC    XL1'00'             RESREVED                    @DA34091 01099016
SSTBOSA  DC    CL4'OSA '           SUBSYSTEM NAME FOR OSA/SF   @DA44172 01100016
         DC    AL2(TCBVEND)        SUBSYSTEM ID FOR OSA/SF     @DA44172 01101016
         DC    AL1(SSTBSTID)       NAME AND TID SEARCH         @DA44172 01102016
         DC    AL1(SSTBTCB3)       FLAG IN TCBFLAG3            @DA44172 01103016
         DC    XL1'00'             BRANCH TABLE INDEX          @DA44172 01104016
         DC    XL1'00'             RESREVED                    @DA44172 01105016
SSTBNETV DC    CL4'NETV'           SUBSYSTEM NAME FOR NETVIEW  @DA37324 01106016
         DC    AL2(NETVIEW)        SUBSYSTEM ID FOR NETVIEW    @DA37324 01107016
         DC    AL1(SSTBSPIK)       NAME AND PIK SEARCH         @DA37324 01108016
         DC    AL1(SSTBPCB1)       FLAG IN PCBSSFL1            @DA37324 01109016
         DC    XL1'00'             BRANCH TABLE INDEX          @DA37324 01110016
         DC    XL1'00'             RESERVED                    @DA37324 01111016
SSTBCUST DC    CL4'CUST'           SUBSYSTEM NAME FOR CUSTOM.  @DA37324 01112016
         DC    AL2(CUSTOM)         SUBSYS. ID FOR CUSTOMIZAT.  @DA37324 01113016
         DC    AL1(SSTBSNAM)       NAME SEARCH ONLY            @DA37324 01114016
         DC    AL1(SSTBPCB1)       FLAG IN PCBSSFL1            @DA37324 01115016
         DC    XL1'20'             BRANCH TABLE INDEX          @D31QDMZ 01116016
         DC    XL1'00'             RESERVED                    @DA37324 01117016
SSTBICK  DC    CL4'ICK '           SUBSYSTEM NAME FOR ICKDSF   @D31LDGN 01118016
         DC    AL2(ICKDSF)         SUBSYSTEM ID FOR ICKDSF     @D31LDGN 01119016
         DC    AL1(SSTBSPIK)       NAME AND PIK SEARCH         @D31LDGN 01120016
         DC    AL1(SSTBPCB1)       FLAG IN PCBSSFL1            @D31LDGN 01121016
         DC    XL1'00'             BRANCH TABLE INDEX          @D31LDGN 01122016
         DC    XL1'00'             RESERVED                    @D31LDGN 01123016
SSTBDSNX DC    CL4'DSNX'           SUBSYSTEM NAME FOR DSNX     @D319DGL 01124016
         DC    AL2(DSNX)           SUBSYSTEM ID FOR DSNX       @D319DGL 01125016
         DC    AL1(SSTBSPIK)       NAME AND PIK SEARCH         @D51IDGL 01126016
         DC    AL1(SSTBPCB1)       FLAG IN PCBSSFL1            @D319DGL 01127016
         DC    XL1'00'             BRANCH TABLE INDEX          @D319DGL 01128016
         DC    XL1'00'             RESERVED                    @D319DGL 01129016
SSTBPSF  DC    CL4'PSF '           SUBSYSTEM NAME FOR PSF-VSE  @D51JDGL 01130016
         DC    AL2(PSFV)           SUBSYSTEM ID FOR PSF-VSE    @D51JDGL 01131016
         DC    AL1(SSTBSPIK)       NAME AND PIK SEARCH         @D51JDGL 01132016
         DC    AL1(SSTBPCB1)       FLAG IN PCBSSFL1            @D51JDGL 01133016
         DC    XL1'00'             BRANCH TABLE INDEX          @D51JDGL 01134016
         DC    XL1'00'             RESERVED                    @D51JDGL 01135016
SSTBVSPT DC    CL4'VSPT'           SUBSYSTEM NAME FOR EXPLORE  @D51QDGL 01136016
         DC    AL2(VSPT)           SUBSYSTEM ID FOR EXPLORE    @D51QDGL 01137016
         DC    AL1(SSTBSTID)       NAME AND TID SEARCH         @D51QDGL 01138016
         DC    AL1(SSTBTCB3)       FLAG IN TCBFLAG3            @D51QDGL 01139016
         DC    XL1'00'             BRANCH TABLE INDEX          @D51QDGL 01140016
         DC    XL1'00'             RESERVED                    @D51QDGL 01141016
SSTBGENS DC    CL4'SPDT'           GENERAL SYSTEM FUNCTION     @D51EMGL 01142016
         DC    AL2(IBMSYS)         NAME OF SUBSYSTEM FLAG      @D51EMGL 01143016
         DC    AL1(SSTBSPIK)       PERMITTED ONCE PER PARTITION@D51EMGL 01144016
         DC    AL1(SSTBPCB1)       FLAG IN PCBSSFL1            @D51EMGL 01145016
         DC    XL1'00'             BRANCH TABLE INDEX          @D51EMGL 01146016
         DC    XL1'00'             RESERVED                    @D51EMGL 01147016
SSTBDMF  DC    CL4'DMF '           SUBSYSTEM NAME FOR DMF      @D64XDMZ 01148016
         DC    AL2(DMF)            SUBSYSTEM ID FOR DMF        @D64XDMZ 01149016
         DC    AL1(SSTBSNAM)       NAME SEARCH ONLY            @D64XDMZ 01150016
         DC    AL1(SSTBTCB3)       FLAG IN TCBFLAG3            @D64XDMZ 01151016
         DC    XL1'24'             BRANCH TABLE INDEX          @D64XDMZ 01152016
         DC    XL1'00'             RESERVED                    @D14CDWK 01153016
SSTBSECS DC    CL4'SECS'           SUBSYSTEM NAME FOR SECS     @D64ADMZ 01154016
         DC    AL2(SECS)           SUBSYSTEM ID FOR SECS       @D64ADMZ 01154116
         DC    AL1(SSTBSNAM)       NAME SEARCH ONLY            @D64ADMZ 01154216
         DC    AL1(SSTBPCB4)       FLAG IN PCBSSFL4            @D64ADMZ 01154316
         DC    XL1'28'             BRANCH TABLE INDEX          @D64ADMZ 01154416
         DC    XL1'00'             RESERVED                    @D64ADMZ 01154516
SSTBTSER DC    CL4'TSER'           SUBSYSTEM NAME FOR TSER     @D66ADAP 01154616
         DC    AL2(TSER)           SUBSYSTEM ID FOR TAPE SERVER@D66ADAP 01154716
         DC    AL1(SSTBSNAM)       NAME SEARCH ONLY            @D66ADAP 01154816
         DC    AL1(SSTBPCB4)       FLAG IN PCBSSFL4            @D66ADAP 01154916
         DC    XL1'00'             BRANCH TABLE INDEX          @D66ADAP 01155016
         DC    XL1'00'             RESERVED                    @D66ADAP 01155116
SSTBEND  DC    X'FF'                                           @D14CDWK 01155216
         SPACE 1                                               @D149DWK 01155316
SSIDNTBT DC    A(SSIDRTRF)       0 NOTIFY: NO SPECIAL HANDLING @D14CDWK 01155416
         DC    A(SSIDNTPW)       4 NOTIFY: SPECIAL PWR  HANDL. @D14CDWK 01155516
         DC    A(SSIDNTC2)       8 NOTIFY: SPECIAL CICS HANDL. @D51HDGL 01155616
         DC    A(SSIDNTOC)       C NOTIFY: SPECIAL OCCF HANDL. @D14CDWK 01155716
         DC    A(SSIDRTRF)      10 NOTIFY: VCNA NO SPEC.HANDL. @D14CDWK 01155816
         DC    A(SSIDNTNP)      14 NOTIFY: SPECIAL NPDA HANDL. @D14BDWK 01155916
         DC    A(SSIDNTVT)      18 NOTIFY: SPECIAL VTAM HANDL. @D14NDWK 01156016
         DC    A(SSIDNTIC)      1C NOTIFY: SPECIAL ICCF HANDL. @D14NDWK 01157016
         DC    A(SSIDNTCU)      20 NOTIFY: SPECIAL CUST HANDL. @D31QDMZ 01158016
         DC    A(SSIDNTDM)      24 NOTIFY: SPECIAL DMF  HANDL. @D64XDMZ 01159016
         DC    A(SSIDRTRF)      28 NOTIFY: SPECIAL SECS HANDL. @D64ADMZ 01160016
         SPACE 1                                               @D149DWK 01161016
SSIDRMBT DC    A(SSIDRM90)       0 REMOVE: NO SPECIAL HANDLING @D14CDWK 01162016
         DC    A(SSIDRMPW)       4 REMOVE: SPECIAL PWR  HANDL. @D14CDWK 01163016
         DC    A(SSIDRMC2)       8 REMOVE: SPECIAL CICS HANDL. @D51HDGL 01164016
         DC    A(SSIDRMOC)       C REMOVE: SPECIAL OCCF HANDL. @D14CDWK 01165016
         DC    A(SSIDRM90)      10 REMOVE: RESERVED FOR VCNA   @D14CDWK 01166016
         DC    A(SSIDRMNP)      14 REMOVE: SPECIAL NPDA HANDL. @D14BDWK 01167016
         DC    A(SSIDRMVT)      18 REMOVE: SPECIAL VTAM HANDL. @D14NDWK 01168016
         DC    A(SSIDRMIC)      1C REMOVE: SPECIAL ICCF HANDL. @D14NDWK 01169016
         DC    A(SSIDRM90)      20 REMOVE: RESERVED FOR CUST . @D31QDMZ 01170016
         DC    A(SSIDRMDM)      24 REMOVE: SPECIAL DMF  HANDL. @D31QDMZ 01171016
         DC    A(SSIDRM90)      28 REMOVE: NO SPECIAL SECS HAN.@D64ADMZ 01172016
         SPACE 1                                               @D149DWK 01173016
*--------------------------------------------------------------@D149DWK 01174016
*        SUBSYSTEM LIST STARTING WITH SUPERVISOR ENTRY         @D149DWK 01175016
*--------------------------------------------------------------@D149DWK 01176016
         SPACE 1                                               @D149DWK 01177016
SSIDLIST DC    0D'0'               LIST AREA                   @D35XDGS 01178016
         DC    XL2'00'             FLAGS                       @D36ZDWK 01179016
         DC    XL2'00'             TASK-ID                     @D66ODOW 01180016
SSIDHDL  EQU   *-SSIDLIST          HEADER LENGTH               @D66ODOW 01181016
SSIDSUP  DC    XL2'00'             PARTITION-ID                @D36SDWK 01182016
         DC    CL4'SUP '           NAME                        @D36ZDWK 01183016
         DC    AL1(7)              VERSION NUMBER              @D68DDUL 01184018
         DC    AL1(1)              RELEASE NUMBER              @D68DDUL 01185018
         DC    AL1(0)              MODIFICATION NUMBER         @D64IDJK 01186016
         DC    AL1(SSIDVLE-SSIDFB01) LENGTH OF VARIABLE PART   @D14CDWK 01187016
SSIDENL  EQU   *-SSIDSUP           ENTRY LENGTH                @D66ODOW 01188016
&BLEXX   SETB  (NOT &BG370)                                    @D36ZDWK 01189016
&BLREL   SETB  (NOT &BG370 AND NOT &BGVM)                      @D36ZDWK 01190016
&BL4PG   SETB  (&BG370 OR &BGVM)                               @DA33314 01191016
SSIDFB01 DC    BL1'&BG370.&BLEXX.1&BGFBA.1&BLREL.&BGVM.0'      @D14CDWK 01192016
SSIDFB02 DC    BL1'1&BL4PG.0&BGXA.0000'     FLAGBYTE 2         @D52..GL 01193016
SSIDFB03 DC    BL1'0&BGDSHR.100000'         FLAGBYTE 3         @D14CDWK 01194016
SSIDFB04 DC    BL1'00000000'                FLAGBYTE 4 RESERV. @D14CDWK 01195016
         DC    H'&AGLCAT'          LENGTH OF LIB.CONCAT.CHAIN  @D36JDWK 01196016
SSIDVLE  EQU   *                   END OF VARIABLE PART        @D367DWK 01197016
SSIDLST1 DC    ((((SSTBEND-SSTABLE)/SSIDENL)+SSIDHDL)*36)C'.'  @D66ODOW 01198016
SSIDLSTE DC    X'FF'          END OF LIST AREA                 @D35XDGS 01199016
         SPACE 2                                               @D35CDFG 01200016
*        RETURN CODES IN GR 15                                 @D35XDGS 01201016
         SPACE 1                                               @D35XDGS 01202016
*                                  INQUIRY                     @D35XDGS 01203016
SSIDINME EQU   4                   MORE THAN ONE ACTIVE SUBSID @D36BDWK 01204016
SSIDINLE EQU   8                   AREA TOO SHORT,TRUNCATED    @D35XDGS 01205016
SSIDINML EQU   12                  CONDITION 4 AND 8           @D36BDWK 01206016
SSIDINNF EQU   16                  NAME NOT FOUND              @D35XDGS 01207016
SSIDINBL EQU   20                  BACKLEVEL SUPERVISOR        @D35XDGS 01208016
*                                  (RAISED BY MACRO CODE)      @D35XDGS 01209016
         SPACE 1                                               @D35XDGS 01210016
*                                  NOTIFY                      @D35XDGS 01211016
SSIDNTDE EQU   4                   NAME ALREADY IN LIST        @D35XDGS 01212016
SSIDNTLE EQU   8                   IDENTIFICATION TOO LONG     @D35XDGS 01213016
SSIDNTLO EQU   12                  SUBSID LIST FULL            @D35XDGS 01214016
SSIDNTCO EQU   16                  SUBSYSTEM NAME INVALID      @D36BDWK 01215016
         SPACE 1                                               @D35XDGS 01216016
*                                  REMOVE                      @D35XDGS 01217016
SSIDRMNF EQU   4                   NAME NOT FOUND              @D35XQGS 01218016
*                                                              @D51MDGL 01219016
*        DROP ALL REMAINING USINGS OF THE PREVIOUS CODE:       @D51MDGL 01220016
*                                                              @D51MDGL 01221016
         USING *,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15           @D51MDGL 01222016
         DROP    1,2,3,4,5,6,7,8,9,10,11,12,13,14,15           @D51MDGL 01223016
         EJECT                                                 @D35CDFG 01224016
***************************************************************         01225016
*  END OF CODE FOR SVC98, EXTRACT SERVICE                     *         01226016
***************************************************************         01227016
         AIF   (NOT &SGSSID).NPRT020                           @D37ZDWK 01228016
         PRINT NOGEN                                           @D37ZDWK 01229016
.NPRT020 MEXIT                                                 @D37ZDWK 01230016
         MEND                                                  @D34YDWK 01240016
