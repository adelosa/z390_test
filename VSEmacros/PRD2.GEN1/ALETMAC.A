*% GO TO ALEMPLS ;   /*                                                 00050052
      MACRO                                                             00100052
&NAME    ALETMAC  &FUNC=,         FUNCTION                             *00150052
               &ALET=,            DATA SPACE ALET                      *00200052
               &DSNAME=,          DATA SPACE NAME                      *00250052
               &OWNER=,           DATA SPACE OWNER                     *00275052
               &STOKEN=,          DATA SPACE STOKEN                    *00300052
               &SCBADR=,          POINTER TO SPACE CONTROL BLOCK       *00350052
               &TASK=,            TID OF TASK WHOES DU-AL IS SCANNED   *00400052
               &PART=,            PIK OF PART. WHOES PASN-AL IS SCANNED*00450052
               &SIZE=,            SIZE OF DATA SPACE                   *00462552
               &MFG=,             TO PARAMETER AREA                    *00525052
               &DSECT=,           REQUEST MAPPING OF INTERFACE AREA    *00550052
               &ROUTINE=          FAST PATH TO PROCESSING ROUTINE       00575052
.*                                                                      00600052
         LCLA  &TFUNC,&TMFG,&TOFF,&GO                                   00650052
         LCLA  &OFFSET            OFFSET INTO IJBALET DIRECT CALL       00700052
         LCLA  &RALET             ALET REQUESTED    (INPUT OR OUTPUT)   00800052
         LCLA  &RDSNAME           DSNAME REQUESTED  (INPUT OR OUTPUT)   00850052
         LCLB  &ROWNER            OWNER REQUESTED   (OUTPUT ONLY)       00875052
         LCLB  &RSTOKEN           STOKEN REQUESTED  (OUTPUT ONLY)       00900052
         LCLB  &RSCBADR           SCBADR REQUESTED  (OUTPUT ONLY)       00925052
         LCLB  &RSIZE             SIZE REQUESTED    (OUTPUT ONLY)       00950052
         LCLB  &RPART             PART REQUESTED    (INP. AND/OR OUTP.) 00975052
         LCLB  &ISTASK            TASK IS SPECIFIED                     01000052
         LCLB  &ISPART            PART IS SPECIFIED                     01050052
         LCLB  &ISROUT            ROUTINE IS SPECIFIED                  01066652
         LCLB  &NATASK            TASK IS NOT APPLICABLE                01083352
         LCLB  &NAPART            PART IS NOT APPLICABLE                01116652
         LCLB  &APROUT            ROUTINE IS APPLICABLE                 01133352
         LCLC  &TOPE,&TADDR,&TADDR8,&BADDR                              01150052
.*                                                                      01450052
***************************************************************         01500052
*                                                             *         01550052
.*       IBM VSE / ADVANCED FUNCTIONS                         *         01600052
*        SUPERVISOR - ALETMAC - 5686-032-DB6                  *         01650052
.*                                                                      01700052
         AGO   .CPRIGHT                                                 01750052
.*                                                                      01800052
*        LICENSED MATERIALS - PROGRAM PROPERTY OF IBM         *         01850052
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"          *         01900052
*        5686-032 (C) COPYRIGHT IBM CORP. 1991, 1993          *         01950052
*        SEE COPYRIGHT INSTRUCTIONS                           *         02000052
.*                                                                      02050052
.CPRIGHT ANOP                                                           02100052
*                                                             *         02150052
***************************************************************         02200052
.*                                                                      02250052
.**** START OF SPECIFICATIONS ***************************************** 02300052
.*                                                                      02350052
.*01* MODULE-TYPE = MACRO                                               02400052
.*                                                                      02450052
.*01* DESCRIPTIVE NAME = EXTRACT DATA SPACE INFORMATION                 02500052
.*  STATUS           =  NEW MACRO - FIRST RELEASE  5.2                  02550052
.*  FUNCTION         =  MACRO CHECKS USER GIVEN PARAMETERS FOR          02600052
.*                      RETRIEVAL OF DATA SPACE INFORMTION VIA CALL TO  02650052
.*                      MODULE IJBALET. A PARAMETER LIST IS BUILDT.     02700052
.*  NOTES            =                                                  02750052
.*  DEPENDENCIES     =                                                  02800052
.*  RESTRICTIONS     =                                                  02850052
.*  REGISTER CONVENT.=                                                  02900052
.*                      REGISTER 14 USED BY SENTER MACRO                02950052
.*                      REGISTER 15 USED BY SENTER MACRO                03000052
.*                      REGISTER 15 USED AS RETURNCODE REGISTER         03050052
.*                      REGISTER  0 USED AS WORK REGISTER               03100052
.*                      REGISTER  1 USED AS POINTER TO PARAMETER LIST   03150052
.*  PATCH LABEL      =  NONE                                            03200052
.*  MACRO TYPE       =  BILINGUAL                                       03250052
.*  PROCESSOR        =  ASM / PLX                                       03300052
.*  MACRO SIZE       =                                                  03350052
.*  ATTRIBUTES       =                                                  03400052
.*  ENTRY POINT      =  ALETMAC                                         03450052
.*  PURPOSE          =  SEE FUNCTION                                    03500052
.*  LINKAGE          =                                                  03550052
.*  CALLER           =                                                  03600052
.*  INPUT            =   (CALLING SEQUENCE)                             03650052
.*    1. ASM :                                                          03700052
.*  LABEL  ALETMAC FUNC=GETDSN|GETSTK|GETSCB|GETSIZE|GETALET|FREEALET   03740052
.*                         ALET=NAME1|(R1),                             03780052
.*                         DSNAME=NAME2|(R2),                           03820052
.*                         OWNER=NAME3|(R3),                            03860052
.*                         STOKEN=NAME4|(R4),                           03900052
.*                         SCBADR=NAME5|(R5),                           03950052
.*                         TASK=NAME6|(R6),                             04000052
.*                         PART=NAME7|(R7),                             04050052
.*                         SIZE=NAME8|(R8),                             04073352
.*                         MFG=NAME9|(R9),                              04119952
.*                         DSECT=YES|NO,                                04146652
.*                         ROUTINE=NAME10|(R10)                         04173352
.* 2. PLS :                                                             04200052
.*  ?LABEL: ALETMAC FUNC(GETDSN | GETSTK | GETSCB | GETSIZE | GETALET | 04233352
.*          FREEALET)                                                   04266652
.*                        ALET(NAME1 | (R1))                            04300052
.*                        DSNAME(NAME2 | (R2))                          04350052
.*                        OWNER(NAME3 | (R3))                           04381252
.*                        STOKEN(NAME4 | (R4))                          04412452
.*                        SCBADR((NAME5 | (R5))                         04443652
.*                        TASK(NAME6 | (R6))                            04474852
.*                        PART(NAME7 | (R7))                            04506052
.*                        SIZE(NAME8 | (R8))                            04537252
.*                        MFG(NAME9 | ADDR(NAME9) |(R9)                 04587252
.*                        DSECT(YES | NO) )                             04637252
.*                        ROUTINE(NAME10 | (R10));                      04700052
.*                                                                      04950052
.*                                                                      05000052
.* -------------------------------------------------------------------  05046452
.* | FUNC   | GETDSN | GETSTK | GETSCB | GETSIZE | GETALET | FREEALET|  05092852
.* -------------------------------------------------------------------  05139252
.* | ALET   |  R(I)  |   N/A  |  R(I)  |  R(I)  |  R(O)    |   N/A   |  05185652
.* | DSNAME |  R(O)  |   R(I) |  N/A   |  N/A   |  R(I)    |   N/A   |  05232052
.* | OWNER  |  R(O)  |   N/A  |  N/A   |  N/A   |  N/A     |   N/A   |  05278452
.* | STOKEN |  N/A   |   R(O) |  N/A   |  N/A   |  N/A     |   N/A   |  05324852
.* | SCBADR |  N/A   |   N/A  |   R(O) |  N/A   |  N/A     |   N/A   |  05371252
.* | TASK   |  N/A   |   O|M  |  N/A   |  N/A   |  N/A     |   N/A   |  05417652
.* | PART   |  N/A   |   O|M  |  N/A   |  N/A   |  R(I/O)  |   N/A   |  05464052
.* | SIZE   |  N/A   |   N/A  |  N/A   |  R(O)  |  N/A     |   N/A   |  05510452
.* | MFG    |   O    |    O   |   O    |   O    |   O      |    O    |  05556852
.* | ROUTINE|   O    |   N/A  |   O    |  N/A   |  N/A     |   N/A   |  05580052
.* -------------------------------------------------------------------  05603252
.*                                                                      05650052
.*                                                                      05700052
.*        R = REQUIRED                                                  05750052
.*            (I) AS INPUT PARAMETER                                    05762552
.*            (O) AS OUTPUT PARAMETER                                   05775052
.*            (I/O) AS INPUT/OUTPUT PARAMETER                           05787552
.*        M = MUTUAL EXCLUSIVE                                          05800052
.*        O = OPTIONAL                                                  05850052
.*        N/A = NOT APPLICABLE                                          05900052
.*                                                                      05912552
.*        * IF DSECT = YES IS SPECIFIED ALL OTHER OPERANDS ARE IGNORED  05925052
.*          ONLY DSECT = NO IS ALLOWED AS OPTIONAL OPERAND              05937552
.*                                                                      05950052
.*                                                                      06000052
.*  OUTPUT(ASSEMBLER)=                                                  06050052
.*                                                                      06100052
.*    REG1 --> 0 -----------------------                                06150052
.*               |FUNC|FLAGS| RESERVED |                                06200052
.*             4 -----------------------                                06250052
.*               |        ALET *       |                                06300052
.*             8 ----------------------------------------------         06350052
.*               |              DATA SPACE NAME *             |         06400052
.*            16 ----------------------------------------------         06450052
.*               |              STOKEN *                      |         06500052
.*            24 ----------------------------------------------         06550052
.*               |  TID *   |  PIK *   |                                06600052
.*            28 -----------------------                                06650052
.*               |         0           |                                06700052
.*               -----------------------                                06750052
.*               * DEPENDING ON WHAT WAS SPECIFIED                      06800052
.*                                                                      06850052
.*                                                                      06900052
.*              FUNCTION = X'01' FOR GETSDN                             06950052
.*                         X'02' FOR GETSTK                             07000052
.*                         X'03' FOR GETSCB                             07050052
.*                         X'04' FOR GETSIZE                            07062552
.*                         X'05' FOR GETALET                            07075052
.*                         X'06' FOR FREEALET                           07087552
.*                                                                      07100052
.*  OUTPUT(EXECUTION)= FUNC = GETSDN                                    07150052
.*                      8 BYTES DSNAME FOR SPCIFIED ALET                07200052
.*                      MOVED TO USER'S FIELD                           07250052
.*                      2 BYTES TASK ID OF DSNAME OWNER MOVED TO        07266652
.*                      USER'S FIELD OR REGISTER                        07283252
.*                                                                      07300052
.*                     FUNC = GETSTK                                    07350052
.*                      8 BYTES STOKEN FOR SPECIFIED DATA SPACE NAME    07400052
.*                      MOVED TO USER'S FIELD                           07450052
.*                                                                      07500052
.*                     FUNC = GETSCB                                    07550052
.*                      POINTER OF REQUESTED SPACE CONTROL BLOCK        07600052
.*                      MOVED TO USER'S FIELD OR REGISTER               07650052
.*                                                                      07700052
.*                     FUNC = GETSIZE                                   07705052
.*                      SIZE OF SPECIFIED DATA SPACE MOVED TO           07710052
.*                      USER'S FIELD OR REGISTER.                       07715052
.*                                                                      07720052
.*                     FUNC = GETALET                                   07725052
.*                      ALET OF SPECIFIED DATA SPACE IS MOVED TO        07730052
.*                      USER'S FIELD OR REGISTER.                       07735052
.*                      PID OF PARTITION HAVING ACCESS TO SPECIFIED     07740052
.*                      DATA SPACE IF MOVED TO USER'S FIELD OR REGISTER 07745052
.*                                                                      07746252
.*                     FUNC = FREEALET                                  07747452
.*                      ACCESS TO ALET DONE VIA GETALET IS RELEASED     07748652
.*                                                                      07750052
.*  EXIT NORMAL      =  COMPILER :                                      07800052
.*                      PARMLIST GENERATED                              07850052
.*                      EXECUTION:                                      07900052
.*                      REGISTER 15  =  0                               07950052
.*  EXIT ERROR       =  COMPILER :                                      08000052
.*                      MNOTES INDICATING THE ERROR                     08050052
.*                      EXECUTION:                                      08100052
.*                      REGISTER 15  =                                  08142852
.*                        04  REQUESTED DATA SPACE WAS NOT FOUND        08185652
.*                        08  INVALID FUNCTION, PARTITION OR TASK       08228452
.*                        0C  PSW KEY OF CALLER IS NOT ZERO,            08271252
.*                            FUNCTION IS NOT EXECUTED                  08314052
.*                        10  NO SYSTEM GETVIS IS AVAILABLE             08356852
.*                                                                      08400052
.*  EXTERNAL REFEREN.=                                                  08445652
.*                                                                      08491352
.*  ROUTINES         =  IJBALET                                         08500052
.*  DATA AREAS       =  NONE                                            08550052
.*  CONTROL BLOCKS   =  NONE                                            08600052
.*  TABLES           =  OWN TABLE GENERATED                             08650052
.*  MACROS           =  SENTER                                          08700052
.*  CHANGE ACTIVITIES=  NEW MACRO   FIRST RELEASE  5.2         @D52GDWS 08750052
.*                                                                      08800052
.*  LAST UPDATE      =  92/10/05                                        08850052
.*  MODIFIED REGISTER=  REGISTER 0,1,15                                 08900052
.*                                                                      08950052
.*                                                                      09000052
.** END OF SPECICATIONS *********************************************** 09050052
.********************************************************************** 09052052
.*                                                                      09054052
.* CHECK AND PROCESS DSECT OPERAND.                                     09056052
.*                                                                      09058052
.********************************************************************** 09060052
&TOPE    SETC  'DSECT'                                                  09062052
         AIF   (T'&DSECT EQ 'O').CHFUNC                                 09064052
         AIF   ('&DSECT' NE 'YES').CHDSECT                              09066052
ACLSADR  DSECT               MAPPING OF INTERNAL ALETMAC TABLE          09068052
ACLSFUNC DS    X             FUNCTION FIELD                             09070052
ACLSGDSN EQU   1             GETDSN FUNCTION CODE                       09072052
ACLSGSTK EQU   2             GETSTK FUNCTION CODE                       09074052
ACLSGSCB EQU   3             GETSCB FUNCTION CODE                       09076052
ACLSGSIZ EQU   4             GETSIZE FUNCTION CODE                      09076252
ACLSGALT EQU   5             GETALET FUNCTION CODE                      09076452
ACLSFALT EQU   6             FREEALET FUNCTION CODE                     09076652
ACLSFLGS DS    X             FLAG BYTE                                  09076852
ACLSSTSK EQU   X'80'         TASK IS SPECIFIED                          09077652
ACLSSPAR EQU   X'40'         PARTITION IS SPECIFIED                     09078452
ACLSFAST EQU   X'20'         ROUTINE PARAMETER WAS SPECIFIED            09078852
         DS    XL2           RESERVED                                   09079252
ACLSALET DS    XL4           DATA SPACE ALET                            09080052
ACLSDSNM DS    CL8           DATA SPACE NAME                            09082052
ACLSSTKN DS    CL8           DATA SPACE STOKEN                          09084052
ACLSTASK DS    XL2           TASK ID                                    09086052
ACLSPART DS    XL2           PARTITION ID                               09088052
ACLSOUT  DS    XL4           OUTPUT FIELD                               09090052
         AGO   .END                                                     09092052
.CHDSECT ANOP                                                           09094052
         AIF   ('&DSECT' NE 'NO').NOTE5                                 09096052
.********************************************************************** 09100052
.*                                                                      09150052
.* CHECK VALIDITY OF FUNC OPERAND.                                      09200052
.*                                                                      09250052
.********************************************************************** 09300052
.CHFUNC  ANOP                                                           09325052
&TOPE    SETC  'FUNC'                                                   09350052
         AIF   (T'&FUNC EQ 'O').NOTE1                                   09400052
         AIF   ('&FUNC' NE 'GETDSN').NGETDSN                            09450052
.**************************************************************         09500052
.*  FUNC = GETDSN                                             *         09550052
.*------------------------------------------------------------*         09600052
&TFUNC   SETA  1                  INDICATE GETSDN FOR OUTPUT            09650052
&RALET   SETA  2                  INDICATE ALET REQUESTED FOR INPUT     09700052
&RDSNAME SETA  1                  IND. DSNAME REQUESTED FOR OUTPUT      09750052
&ROWNER  SETB  1                  IND. OWNER REQUESTED FOR OUTPUT       09775052
&APROUT  SETB  1                  INDICATE ROUTINE MAY BE SPECIFIED     09781252
&NATASK  SETB  1                  INDICATE TASK NOT APPLICABLE          09787452
&NAPART  SETB  1                  INDICATE PART NOT APPLICABLE          09793652
         AGO   .CHALET                                                  09800052
.NGETDSN ANOP                                                           09850052
         AIF   ('&FUNC' NE 'GETSTK').NGETSTK                            09900052
.**************************************************************         09950052
.*  FUNC = GETSTK                                             *         10000052
.*------------------------------------------------------------*         10050052
&TFUNC   SETA  2                  INDICATE GETSTOKN                     10100052
&RDSNAME SETA  2                  IND. DSNAME REQUESTED FOR INPUT       10150052
&RSTOKEN SETB  1                  INDICATE STOKEN REQUIRED              10200052
         AGO   .CHALET                                                  10250052
.NGETSTK ANOP                                                           10300052
         AIF   ('&FUNC' NE 'GETSCB').NGETSCB                            10350052
.**************************************************************         10400052
.*  FUNC = GETSCB                                             *         10450052
.*------------------------------------------------------------*         10500052
&TFUNC   SETA  3                  INDICATE GETSCB                       10550052
&RALET   SETA  2                  INDICATE ALET REQUESTED FOR INPUT     10600052
&RSCBADR SETB  1                  INDICATE SCBADR REQUESTED             10650052
&APROUT  SETB  1                  INDICATE ROUTINE MAY BE SPECIFIED     10650652
&NATASK  SETB  1                  INDICATE TASK NOT APPLICABLE          10651252
&NAPART  SETB  1                  INDICATE PART NOT APPLICABLE          10651852
         AGO   .CHALET                                                  10652552
.NGETSCB ANOP                                                           10655052
         AIF   ('&FUNC' NE 'GETSIZE').NGETSIZ                           10657552
.**************************************************************         10660052
.*  FUNC = GETSIZE                                            *         10662552
.*------------------------------------------------------------*         10665052
&TFUNC   SETA  4                  INDICATE GETSIZE                      10667552
&RALET   SETA  2                  INDICATE ALET REQUESTED FOR INPUT     10670052
&RSIZE   SETB  1                  INDICATE SIZE REQUESTED               10672552
&NATASK  SETB  1                  INDICATE TASK NOT APPLICABLE          10673352
&NAPART  SETB  1                  INDICATE PART NOT APPLICABLE          10674152
         AGO   .CHALET                                                  10675052
.NGETSIZ ANOP                                                           10677552
         AIF   ('&FUNC' NE 'GETALET').NGETALE                           10680052
.**************************************************************         10682552
.*  FUNC = GETALET                                            *         10685052
.*------------------------------------------------------------*         10687552
&TFUNC   SETA  5                  INDICATE GETALET                      10690052
&RALET   SETA  1                  INDICATE ALET REQUESTED FOR OUTPUT    10692552
&RDSNAME SETA  2                  INDICATE DSNAME REQUESTED FOR INPUT   10695052
&RPART   SETB  1                  INDICATE PARTITION REQUESTED (I/O)    10697552
         AGO   .CHALET                                                  10697752
.NGETALE AIF   ('&FUNC' NE 'FREEALET').NOTE2                            10697952
.**************************************************************         10698152
.*  FUNC = FREEALET                                           *         10698352
.*------------------------------------------------------------*         10698552
&TFUNC   SETA  6                  INDICATE FREEALET                     10698752
&NATASK  SETB  1                  INDICATE TASK NOT APPLICABLE          10698952
&NAPART  SETB  1                  INDICATE PART NOT APPLICABLE          10699152
.********************************************************************** 10700052
.*                                                                      10750052
.* CHECK ALET OPERAND.                                                  10800052
.*                                                                      10850052
.********************************************************************** 10900052
.CHALET  ANOP                                                           10950052
&TOPE    SETC  'ALET'                                                   11000052
&GO      SETA  1                                                        11050052
         AIF   (T'&ALET EQ 'O' AND &RALET NE 0).NOTE1                   11100052
         AIF   (T'&ALET NE 'O' AND &RALET EQ 0).NOTE3                   11150052
.********************************************************************** 11200052
.*                                                                      11250052
.* CHECK DSNAME.                                                        11300052
.*                                                                      11350052
.********************************************************************** 11400052
.CHDSN   ANOP                                                           11450052
&TOPE    SETC  'DSNAME'                                                 11500052
&GO      SETA  2                                                        11550052
         AIF   (T'&DSNAME EQ 'O' AND &RDSNAME NE 0).NOTE1               11600052
         AIF   (T'&DSNAME NE 'O' AND &RDSNAME EQ 0).NOTE3               11650052
.********************************************************************** 11700052
.*                                                                      11750052
.* CHECK OWNER.                                                         11754552
.*                                                                      11759052
.********************************************************************** 11763552
.CHOWN   ANOP                                                           11768052
&TOPE    SETC  'OWNER'                                                  11772552
&GO      SETA  3                                                        11777052
         AIF   (T'&OWNER EQ 'O' AND &ROWNER).NOTE1                      11781552
         AIF   (T'&OWNER NE 'O' AND NOT &ROWNER).NOTE3                  11786052
.********************************************************************** 11790552
.*                                                                      11795052
.* CHECK STOKEN OPERAND                                                 11800052
.*                                                                      11850052
.********************************************************************** 11900052
.CHSTKN  ANOP                                                           11950052
&TOPE    SETC  'STOKEN'                                                 12000052
&GO      SETA  4                                                        12050052
         AIF   (T'&STOKEN EQ 'O' AND &RSTOKEN).NOTE1                    12100052
         AIF   (T'&STOKEN NE 'O' AND NOT &RSTOKEN).NOTE3                12150052
.********************************************************************** 12200052
.*                                                                      12250052
.* CHECK SCBADR OPERAND                                                 12300052
.*                                                                      12350052
.********************************************************************** 12400052
.CHSCBAD ANOP                                                           12450052
&TOPE    SETC  'SCBADR'                                                 12500052
&GO      SETA  5                                                        12550052
         AIF   (T'&SCBADR EQ 'O' AND &RSCBADR).NOTE1                    12600052
         AIF   (T'&SCBADR NE 'O' AND NOT &RSCBADR).NOTE3                12650052
.********************************************************************** 12654552
.*                                                                      12659052
.* CHECK SIZE OPERAND                                                   12663552
.*                                                                      12668052
.********************************************************************** 12672552
.CHSIZE  ANOP                                                           12677052
&TOPE    SETC  'SIZE'                                                   12681552
&GO      SETA  6                                                        12686052
         AIF   (T'&SIZE EQ 'O' AND &RSIZE).NOTE1                        12690552
         AIF   (T'&SIZE NE 'O' AND NOT &RSIZE).NOTE3                    12695052
.********************************************************************** 12700052
.*                                                                      12750052
.* CHECK TASK OPERAND.                                                  12800052
.*                                                                      12850052
.********************************************************************** 12900052
.CHTASK  ANOP                                                           12950052
&GO      SETA  7                                                        12962552
&TOPE    SETC  'TASK'                                                   12975052
         AIF   (T'&TASK NE 'O' AND &NATASK).NOTE3                       12987552
         AIF   (T'&TASK EQ 'O').CHPART                                  13000052
&ISTASK  SETB  1                          INDICATE TASK IS SPECIFIED    13050052
.********************************************************************** 13100052
.*                                                                      13150052
.* CHECK PART OPERAND.                                                  13200052
.*                                                                      13250052
.********************************************************************** 13300052
.CHPART  ANOP                                                           13350052
&GO      SETA  8                                                        13362552
&TOPE    SETC  'PART'                                                   13375052
         AIF   (T'&PART NE 'O' AND &NATASK).NOTE3                       13387552
         AIF   (T'&PART EQ 'O' AND &RPART).NOTE1                        13400052
         AIF   (T'&PART EQ 'O').CHROUT                                  13425052
         AIF   (&ISTASK).NOTE4            PART AND TASK - ERROR         13450052
&ISPART  SETB  1                          INDICATE PART IS SPECIFIED    13500052
.********************************************************************** 13537552
.*                                                                      13575052
.* CHECK ROUTINE OPERAND                                                13612552
.*                                                                      13650052
.********************************************************************** 13687552
.CHROUT  ANOP                                                           13725052
&GO      SETA  9                                                        13762552
&TOPE    SETC  'ROUTINE'                                                13800052
         AIF   (T'&ROUTINE NE 'O' AND NOT &APROUT).NOTE3                13837552
         AIF   (T'&ROUTINE EQ 'O').CHMFG                                13875052
&ISROUT  SETB  1                          INDICATE ROUTINE IS SPECIFIED 13912552
&OFFSET  SETA  8                          OFFSET INTO ROUTINE           13931252
.********************************************************************** 13950052
.*                                                                      14000052
.* CHECK IF USERAREA FOR PARAMETER-LIST GIVEN  (MFG=OPERAND)            14050052
.*                                                                      14100052
.********************************************************************** 14150052
.CHMFG   ANOP                                                           14200052
         AIF   (T'&MFG EQ 'O').NOMFG       NO MFG-PARM,BUILD INLINECODE 14250052
&NAME    DS    0H                          ALIGNMENT                    14300052
         AIF   ('&MFG'(1,1) EQ '(').RMFG   REGISTER FORMAT              14350052
&TADDR   SETC  '+'.'&MFG'                  USERAREA ADDRESSED BY VAR.   14400052
&TADDR8  SETC  '+'.'&MFG.(8)'              USERAREA ADDR. AND LENGTH 8  14433352
         MVC   &MFG.(32),IJBA&SYSNDX       MOVE PARMLIST                14466652
&TMFG    SETA  1                                                        14500052
         AGO   .HALET                                                   14550052
.RMFG    ANOP                                                           14600052
         AIF   ('&MFG' EQ '(1)').R1MFG     REGISTER  GIVEN              14650052
&TADDR   SETC  '&MFG'                      USERAREA ADDRESSED BY REG    14700052
&TADDR8  SETC  '(8,&MFG(1).)'              USERAREA ADDR. AND LENGTH 8  14733352
         MVC   0(32,&MFG(1)),IJBA&SYSNDX   MOVE PARMLIST                14766652
&TMFG    SETA  3                                                        14800052
         AGO   .HALET                                                   14850052
.R1MFG   ANOP                                                           14900052
&TADDR   SETC  '&MFG'                      USERAREA ADDRESSED BY REG1   14950052
&TADDR8  SETC  '(8,&MFG(1).)'            USERAREA ADDR. AND LENGTH 8    14983352
         MVC   0(32,&MFG(1)),IJBA&SYSNDX   MOVE PARMLIST                15016652
&TMFG    SETA  4                                                        15050052
         AGO   .HALET                                                   15100052
.NOMFG   ANOP                                                           15105552
         AIF   (T'&NAME EQ 'O').NONAM      NO MACRO LABEL               15111052
&NAME    EQU   *                                                        15116552
.NONAM   ANOP                                                           15122052
&TADDR   SETC  '+IJBA'.'&SYSNDX'                                        15127552
&TADDR8  SETC  '+IJBA'.'&SYSNDX'.'(8)'                                  15133052
&TMFG    SETA  0                                                        15138552
         AGO   .HALET                                                   15144052
.********************************************************************** 15150052
.*                                                                      15200052
.*  MACRO DIAGNOSTICS: MNOTES 1 TO 8                                    15250052
.*                                                                      15300052
.********************************************************************** 15350052
.NOTE1   MNOTE 8,'&TOPE-OPERAND NOT GIVEN,GENERATION SUPPRESSED'        15400052
         MEXIT                                                          15450052
.NOTE2   MNOTE 8,'INVALID &TOPE-OPERAND GIVEN,GENERATION SUPPRESSED'    15500052
         MEXIT                                                          15550052
.NOTE3   MNOTE 4,'&TOPE-OPERAND IGNORED FOR FUNC= &FUNC'                15600052
         AIF   (&GO EQ 1).CHDSN            CONT. AFTER ALET             15650052
         AIF   (&GO EQ 2).CHOWN            CONT. AFTER DSNAME           15683352
         AIF   (&GO EQ 3).CHSTKN           CONT. AFTER OWNER            15716652
         AIF   (&GO EQ 4).CHSCBAD          CONT. AFTER STOKEN           15749952
         AIF   (&GO EQ 5).CHSIZE           CONT. AFTER SCBADR           15783252
         AIF   (&GO EQ 6).CHTASK           CONT. AFTER SIZE             15816552
         AIF   (&GO EQ 7).CHPART           CONT. AFTER TASK             15827652
         AIF   (&GO EQ 8).CHROUT           CONT. AFTER PART             15835052
         AIF   (&GO EQ 9).CHMFG            CONT. AFTER ROUTINE          15842452
         MEXIT                                                          15850052
.NOTE4   MNOTE 8,'TASK AND PART-OPERAND GIVEN,GENERATION SUPPRESSED'    15900052
         MEXIT                                 MNOTE AND EXIT           15925052
.NOTE5   MNOTE 8,'UNKNOWN &TOPE-VALUE GIVEN,GENERATION SUPPRESSED'      15950052
         MEXIT                                 MNOTE AND EXIT           15975052
.********************************************************************** 16000052
.*                                                                      16050052
.*  END OF DIAGNOSTIC PATH, START OF CODE GENERATION                    16100052
.*                                                                      16150052
.********************************************************************** 16200052
.********************************************************************** 16600052
.*                                                                      16650052
.* CHECK AND SET ALET PARAMETER.                                        16700052
.*                                                                      16750052
.********************************************************************** 16800052
.HALET   ANOP                                                           16850052
         AIF   (&RALET NE 2).HDSNAME                                    16900052
&TOFF    SETA  4                                                        16950052
         AIF   ('&ALET'(1,1) EQ '(').RGALET   REGISTER FORM             17000052
         L     0,&ALET                     GET ALET                     17050052
         ST    0,&TOFF.&TADDR              SAVE ALET                    17100052
         AGO   .HDSNAME                                                 17150052
.RGALET  ANOP                                                           17200052
         ST    &ALET(1),&TOFF.&TADDR       STORE ALET                   17250052
         AGO   .HDSNAME                                                 17275052
.********************************************************************** 17300052
.*                                                                      17350052
.* CHECK AND SET DSNAME PARAMETER                                       17400052
.*                                                                      17450052
.********************************************************************** 17500052
.HDSNAME ANOP                                                           17550052
&TOFF    SETA  8                                                        17650052
         AIF   (&RDSNAME NE 2).HTASK       NOT NEEDED                   17675052
         AIF   ('&DSNAME'(1,1) EQ '(').RGDSNM    REGISTER FORM          17700052
         MVC   &TOFF.&TADDR8,&DSNAME       MOVE DSNAME INTO PARM LIST   17750052
         AGO   .HTASK                                                   17800052
.RGDSNM  ANOP                                                           17850052
         MVC   &TOFF.&TADDR8,0(&DSNAME(1).) MOVE DSNAME INTO PARM LIST  17900052
.********************************************************************** 17950052
.*                                                                      18000052
.* CHECK AND SET TASK PARAMETER.                                        18050052
.*                                                                      18100052
.********************************************************************** 18150052
.HTASK   ANOP                                                           18200052
&TOFF    SETA  24                                                       18250052
         AIF   (NOT &ISTASK).HNTASK                                     18300052
         AIF   ('&TASK'(1,1) EQ '(').RGTASK   REGISTER FORM             18350052
         LH    0,&TASK                     GET TASK                     18400052
         STH   0,&TOFF.&TADDR              SAVE TASK                    18450052
         AGO   .HPART                                                   18500052
.RGTASK  ANOP                                                           18550052
         STH   &TASK(1),&TOFF.&TADDR       STORE TASK                   18600052
         AGO   .HPART                                                   18650052
.HNTASK  ANOP                                                           18700052
         AIF   (T'&MFG NE 'O').HPART       MFG-PARM,NO CLEAR            18725052
         SLR   0,0                                                      18750052
         STH   0,&TOFF.&TADDR              CLEAR TASK FIELD             18800052
.********************************************************************** 18850052
.*                                                                      18900052
.* CHECK AND SET PART PARAMETER                                         18950052
.*                                                                      19000052
.********************************************************************** 19050052
.HPART   ANOP                                                           19100052
&TOFF    SETA  26                                                       19150052
         AIF   (NOT &ISPART).HNPART                                     19200052
         AIF   ('&PART'(1,1) EQ '(').RGPART   REGISTER FORM             19250052
         LH    0,&PART                     GET PART                     19300052
         STH   0,&TOFF.&TADDR              SAVE PART                    19350052
         AGO   .GENBR                                                   19400052
.RGPART  ANOP                                                           19450052
         STH   &PART(1),&TOFF.&TADDR       STORE PART                   19500052
         AGO   .GENBR                                                   19550052
.HNPART  ANOP                                                           19600052
         AIF   (NOT &ISTASK).HNPART1       TASK ALSO NOT SPECIFIED      19650052
         AIF   (T'&MFG NE 'O').HNPART1     MFG-PARM,NO CLEAR            19675052
         SLR   0,0                                                      19700052
.HNPART1 ANOP                                                           19750052
         AIF   (T'&MFG NE 'O').GENBR       MFG-PARM,NO CLEAR            19800052
         STH   0,&TOFF.&TADDR              CLEAR PART FIELD             19850052
.********************************************************************** 20500052
.*                                                                      20550052
.* GENERATE BRANCH INSTRUCTION                                          20600052
.*                                                                      20650052
.********************************************************************** 20700052
.GENBR   ANOP                                                           20750052
&BADDR   SETC  'IJBT'.'&SYSNDX'                                         20800052
         AIF   (&TMFG NE 0).BR1                                         20850052
         CNOP  0,4                         MACRO ALIGNMENT              20875052
         BAL   1,&BADDR                    LOAD PARMLIST ADDR & BRANCH  20900052
         AGO   .GENCON                                                  20950052
.BR1     ANOP                                                           21000052
         AIF   (&TMFG NE 1).BR2                                         21050052
         LA    1,&MFG                      LOAD PARMLIST ADDR.          21100052
         AGO   .BR3                                                     21150052
.BR2     ANOP                                                           21200052
         AIF   (&TMFG NE 2).BR3                                         21250052
         LR    1,&MFG(1)                   LOAD PARMLIST ADDR.          21300052
.BR3     B     &BADDR                      BRANCH AROUND PARMLIST       21350052
.********************************************************************** 21400052
.*                                                                      21450052
.* GENERATE CONSTANTS                                                   21500052
.*                                                                      21550052
.********************************************************************** 21600052
.GENCON  ANOP                                                           21650052
IJBA&SYSNDX DS    0F                                                    21677752
         DC    AL1(&TFUNC)                 FUNCTION BYTE                21705452
         DC    B'&ISTASK.&ISPART.&ISROUT.00000' FLAG BYTES              21733352
         DC    AL2(0)                      RESERVED                     21766652
         DC    AL4(0)                      DATA SPACE ALET              21800052
         DC    CL8'        '               DATA SPACE NAME              21850052
         DC    CL8'        '               DATA SPACE STOKEN            21900052
         DC    AL2(0)                      TASK ID                      21950052
         DC    AL2(0)                      PARTITION ID                 22000052
         DC    AL4(0)                      OUTPUT FIELD                 22500052
IJBS&SYSNDX DC   8F'0'                     SAVE AREA FOR REGS 2 - 9     22516652
IJBT&SYSNDX DS   0H                                                     22533252
.********************************************************************** 22550052
.*                                                                      22600052
.* CHECK AND USE ROUTINE PARAMETER IF SPECIFIED                         22603352
.*                                                                      22606652
.********************************************************************** 22609952
         AIF   (NOT &ISROUT).SENTER        NO ROUTINE ADDRESS SPECIFIED 22613252
         AIF   ('&ROUTINE'(1,1) EQ '(').RGROUT   REGISTER FORM          22616552
         L     15,&ROUTINE                 GET ROUTINE ADDRESS          22619852
         AGO   .CALLR                                                   22623152
.RGROUT  ANOP                                                           22626452
         LR    15,&ROUTINE(1)              GET ROUTINE ADDRESS          22629752
.CALLR   ANOP                                                           22633052
         STM    2,9,IJBS&SYSNDX-IJBA&SYSNDX.(1)                         22633852
*                                          SAVE REGISTERS R2 - R9       22634652
         LM     2,9,0(1)                   PASS PARAMETRS IN R2 - R9    22635452
         BAL   14,&OFFSET.(0,15)           CALL ROUTINE                 22636352
         AGO   .RETALET                                                 22639652
.********************************************************************** 22642952
.*                                                                      22646252
.* ISSUE SENTER MACRO                                                   22650052
.*                                                                      22700052
.********************************************************************** 22750052
.SENTER  ANOP                                                           22775052
         STM    2,9,IJBS&SYSNDX-IJBA&SYSNDX.(1)                         22781252
*                                          SAVE REGISTERS R2 - R9       22787452
         LM     2,9,0(1)                   PASS PARAMETRS IN R2 - R9    22793652
         SENTER ALET                                                    22800052
.********************************************************************** 23353852
.*                                                                      23357652
.* RETURN ALET                                                          23357852
.*                                                                      23358052
.********************************************************************** 23358252
.RETALET ANOP                                                           23358352
         STM    2,9,0(1)                   UPDATE PARAMETER LIST        23358452
         LM     2,9,IJBS&SYSNDX-IJBA&SYSNDX.(1)                         23358552
*                                          RESTORE REGISTERS R2 - R9    23358652
         AIF   (&RALET NE 1).ODSNAME       NO ALET REQUESTED            23358752
&TOFF    SETA  4                                                        23358852
         AIF   ('&ALET'(1,1) EQ '(').OGALET  REGISTER FORM              23358952
         L     0,&TOFF.&TADDR              GET ALET                     23359052
         ST    0,&ALET                     PUT INTO AREA OF USER        23359252
         AGO   .ODSNAME                                                 23359452
.OGALET  ANOP                                                           23359652
         L     &ALET(1),&TOFF.&TADDR       PUT SCBADR INTO USER REG.    23359852
.********************************************************************** 23360052
.*                                                                      23360252
.* RETURN DSNAME                                                        23361452
.*                                                                      23365252
.********************************************************************** 23369052
.ODSNAME ANOP                                                           23370952
&TOFF    SETA  8                                                        23372852
         AIF   (&RDSNAME NE 1).OOWNER      NOT ASKED FOR                23376652
         AIF   ('&DSNAME'(1,1) EQ '(').OGDSNAM  REGISTER FORM           23380452
         MVC   &DSNAME.(8),&TOFF.&TADDR    MOVE DSNAME FROM PARM LIST   23384252
         AGO   .OOWNER                                                  23388052
.OGDSNAM ANOP                                                           23391852
         MVC   0(8,&DSNAME(1).),&TOFF.&TADDR MOVE DSNAME FROM PARM LIST 23395652
.********************************************************************** 23395852
.*                                                                      23396052
.* RETURN OWNER                                                         23396252
.*                                                                      23396452
.********************************************************************** 23396652
.OOWNER  ANOP                                                           23396852
         AIF   (&ROWNER NE 1).OSTOKN       NO OWNER REQUESTED           23397052
&TOFF    SETA  28                                                       23397252
         AIF   ('&OWNER'(1,1) EQ '(').OGOWN    REGISTER FORM            23397452
         L     0,&TOFF.&TADDR              GET OWNER                    23397652
         STH   0,&OWNER                    PUT INTO AREA OF USER        23397852
         AGO   .OSTOKN                                                  23398052
.OGOWN   ANOP                                                           23398252
         L     &OWNER(1),&TOFF.&TADDR      PUT OWNER INTO USER REGISTER 23398452
.********************************************************************** 23399452
.*                                                                      23403252
.* RETURN STOKEN                                                        23407052
.*                                                                      23410852
.********************************************************************** 23414652
.OSTOKN  ANOP                                                           23418452
&TOFF    SETA  16                                                       23422252
         AIF   (NOT &RSTOKEN ).OSCBAD      NOT ASKED FOR                23426052
         AIF   ('&STOKEN'(1,1) EQ '(').OGSTOKN  REGISTER FORM           23429852
         MVC   &STOKEN.(8),&TOFF.&TADDR    MOVE STOKEN FROM PARM LIST   23433652
         AGO   .OSCBAD                                                  23437452
.OGSTOKN ANOP                                                           23441252
         MVC   0(8,&STOKEN(1).),&TOFF.&TADDR MOVE STOKEN FROM PARM LIST 23445052
.********************************************************************** 23450052
.*                                                                      23500052
.* RETURN SCBADR                                                        23550052
.*                                                                      23600052
.********************************************************************** 23650052
.OSCBAD  ANOP                                                           23675052
         AIF   (&RSCBADR NE 1).OSIZE       NO SCBADR REQUESTED          23700052
&TOFF    SETA  28                                                       23725052
         AIF   ('&SCBADR'(1,1) EQ '(').OGSCB    REGISTER FORM           23750052
         L     0,&TOFF.&TADDR              GET SCBADR                   23800052
         ST    0,&SCBADR                   PUT INTO AREA OF USER        23850052
         AGO   .OSIZE                                                   23851752
.OGSCB   ANOP                                                           23853452
         L     &SCBADR(1),&TOFF.&TADDR     PUT SCBADR INTO USER REG.    23855152
.********************************************************************** 23856852
.*                                                                      23858552
.* RETURN SIZE                                                          23860252
.*                                                                      23861952
.********************************************************************** 23863652
.OSIZE   ANOP                                                           23865352
         AIF   (NOT &RSIZE).OPART          NO SIZE REQUESTED            23867052
&TOFF    SETA  28                                                       23868752
         AIF   ('&SIZE'(1,1) EQ '(').OGSIZE   REGISTER FORM             23870452
         L     0,&TOFF.&TADDR              GET SIZE                     23872152
         ST    0,&SIZE                     PUT INTO AREA OF USER        23873852
         AGO   .OPART                                                   23875552
.OGSIZE  ANOP                                                           23877252
         L     &SIZE(1),&TOFF.&TADDR       PUT SIZE INTO USER REG.      23878952
.********************************************************************** 23880652
.*                                                                      23882352
.* RETURN PART                                                          23884052
.*                                                                      23885752
.********************************************************************** 23887452
.OPART   ANOP                                                           23889152
         AIF   (NOT &RPART).END            NO PART REQUESTED            23890852
&TOFF    SETA  26                                                       23892552
         AIF   ('&PART'(1,1) EQ '(').OGPART   REGISTER FORM             23894252
         LH    0,&TOFF.&TADDR              GET PART                     23895952
         STH   0,&PART                     PUT INTO AREA OF USER        23897652
         AGO   .END                                                     23900052
.OGPART  ANOP                                                           23937552
         SLR   &PART(1),&PART(1)           CLEAR USER REGISTER          23975052
         ICM   &PART(1),3,&TOFF.&TADDR     PUT SIZE INTO USER REG.      24012552
.END     ANOP                                                           24050052
         MEND                                                        */ 24100052
*%ALEMPLS:;                                                             24150052
*%ALETMAC:  MACRO  KEYS(FUNC,  /* FUNCTION                           */ 24200052
*                  ALET,       /* DATA SPACE ALET                    */ 24250052
*                  DSNAME,     /* DATA SPACE NAME                    */ 24300052
*                  OWNER,      /* DATA SPACE OWNER                   */ 24325052
*                  STOKEN,     /* DATA SPACE STOKEN                  */ 24350052
*                  SCBADR,     /* POINTER TO SPACE CONTROL BLOCK     */ 24400052
*                  TASK,       /* TID OF TASK WHOES DU-AL IS SCANNED */ 24450052
*                  PART,       /* PIK OF PART. WHOES PASN-AL IS SC.  */ 24500052
*                  SIZE,       /* SIZE OF DATA SPACE                 */ 24525052
*                  MFG,        /* POINTER TO PARAMETER AREA          */ 24550052
*                  DSECT,      /* REQUEST MAPPING OF INTERFACE AREA  */ 24583352
*                  ROUTINE);   /* FAST PATH TO PROCESSING ROUTINE    */ 24616652
* /*******************************************************************/ 24650052
* /*                                                                 */ 24700052
* /*  LIST MACRO INVOCATION IN SOURCE                                */ 24750052
* /*                                                                 */ 24800052
* /*******************************************************************/ 24850052
*    ANS ('/* '||MACLABEL||' '||MACNAME||' '||MACLIST||' '||MACKEYS||   24900052
*         '*/') COL(MACLMAR);                                           24950052
* ANS ('/*                                                  */')        25000052
* COL(MACLMAR);                                                         25050052
* ANS ('/*     SUPERVISOR - ALETMAC - 5745-SC-SUP(C44)      */')        25100052
* COL(MACLMAR);                                                         25150052
* ANS ('/*                                                  */')        25200052
* COL(MACLMAR);                                                         25250052
* /*******************************************************************/ 25300052
* /*                                                                 */ 25350052
* /*  PLS PART OF ALETMAC MACRO . DESCRIPTION SEE ASM PART           */ 25400052
* /*                                                                 */ 25450052
* /*******************************************************************/ 25500052
*    DCL (IKEY,ILIST,CMFG,CALET,CSIZE)CHAR;/*                        */ 25550052
*    DCL (CDSNAME,COWNER,CSTOKEN,CSCBADR)CHAR;    /* DCL FOR VALUES  */ 25600052
*    DCL (CTASK,CPART,CROUT)CHAR;                 /*                 */ 25640052
*    DCL (IFUNC,IALET,IDSNAME,ITASK,IPART)CHAR;/*  DCL FOR INTERNAL  */ 25680052
*    DCL (ISTOKEN,IOUT)CHAR;                   /*  USE               */ 25706652
*    DCL (IREG0,IREG1,IREG14,IREG15)CHAR;      /*  *                 */ 25733252
*    DCL (IFLD,IPHASE)CHAR;                    /*  *                 */ 25760052
*    DCL (TFUNC,IGO)FIXED;                     /*  *                 */ 25800052
*    DCL (ISTASK,ISPART,ISROUT)FIXED;          /*  *                 */ 25825052
*    DCL (NATASK,NAPART,APROUT)FIXED;          /*  *                 */ 25850052
*    DCL (ISMFG,RGDSNM,RGSTKN,RGRES)FIXED;     /*  *                 */ 25875052
*    DCL (RALET,RDSNAME,ROWNER,RSTOKEN,RSCBADR,RSIZE,RPART)FIXED;       25925052
*    DCL (ROFFSET)CHAR;                                                 25975052
* /*******************************************************************/ 26051452
* /*                                                                 */ 26052852
* /* CHECK DSECT OPERAND                                             */ 26054252
* /*                                                                 */ 26055652
* /*******************************************************************/ 26057052
*    IF NUMBER(DSECT) = 0  THEN           /* DSECT SPECIFIED        */ 26058452
*     IF DSECT(1) = 'YES' THEN             /* DSECT(YES) SPECIFIED   */ 26059352
*      DO;                                 /* YES                    */ 26060252
*        ANS ('DCL 1 ACLSADR  BASED BDY(WORD),') SKIP COL(10) NORESCAN; 26061252
*        ANS ('/* MAPPING OF ALETMAC TABLE  */')COL(41) NORESCAN;       26062652
*        ANS ('      2 ACLSFUNC CHAR(1),') SKIP COL(10) NORESCAN;       26064052
*        ANS ('/* FUNCTION FIELD            */')COL(41) NORESCAN;       26065452
*        ANS ('      2 ACLSFLGS BIT(8),') SKIP COL(10) NORESCAN;        26065652
*        ANS ('/* FLAG BYTE                 */')COL(41) NORESCAN;       26065852
*        ANS ('        3 ACLSSTSK BIT(1),') SKIP COL(10) NORESCAN;      26066052
*        ANS ('/* TASK IS SPECIFIED         */')COL(41) NORESCAN;       26066252
*        ANS ('        3 ACLSSPAR BIT(1),') SKIP COL(10) NORESCAN;      26066452
*        ANS ('/* PARTITION IS SPECIFIED    */')COL(41) NORESCAN;       26066652
*        ANS ('        3 ACLSFAST BIT(1),') SKIP COL(10) NORESCAN;      26066752
*        ANS ('/* ROUTINE PARM IS SPECIFIED */')COL(41) NORESCAN;       26066852
*        ANS ('        3 *        BIT(5),') SKIP COL(10) NORESCAN;      26066952
*        ANS ('/* RESERVED                  */')COL(41) NORESCAN;       26067052
*        ANS ('      2 *        CHAR(2),') SKIP COL(10) NORESCAN;       26067252
*        ANS ('/* RESERVED                  */')COL(41) NORESCAN;       26068252
*        ANS ('      2 ACLSALET PTR(31),') SKIP COL(10) NORESCAN;       26069652
*        ANS ('/* DATA SPACE ALET           */')COL(41) NORESCAN;       26071052
*        ANS ('      2 ACLSDSNM CHAR(8),') SKIP COL(10) NORESCAN;       26072452
*        ANS ('/* DATA SPACE NAME           */')COL(41) NORESCAN;       26073852
*        ANS ('      2 ACLSSTKN CHAR(8),') SKIP COL(10) NORESCAN;       26075252
*        ANS ('/* DATA SPACE STOKEN         */')COL(41) NORESCAN;       26076652
*        ANS ('      2 ACLSTASK FIXED(16),') SKIP COL(10) NORESCAN;     26078052
*        ANS ('/* TASK ID                   */')COL(41) NORESCAN;       26079452
*        ANS ('      2 ACLSPART FIXED(16),') SKIP COL(10) NORESCAN;     26080852
*        ANS ('/* PARTITION ID              */')COL(41) NORESCAN;       26082252
*        ANS ('      2 ACLSOUT  PTR(31);') SKIP COL(10) NORESCAN;       26083652
*        ANS ('/* OUTPUT FIELD              */')COL(41) NORESCAN;       26085052
*        ANS ('/*                           */') SKIP COL(41) NORESCAN; 26086452
*        ANS ('DCL ACLSGDSN CONSTANT(1);') SKIP COL(10) NORESCAN;       26087852
*        ANS ('/* GETDSN FUNCTION CODE      */')COL(41) NORESCAN;       26089252
*        ANS ('DCL ACLSGSTK CONSTANT(2);') SKIP COL(10) NORESCAN;       26090652
*        ANS ('/* GETSTK FUNCTION CODE      */')COL(41) NORESCAN;       26092052
*        ANS ('DCL ACLSGSCB CONSTANT(3);') SKIP COL(10) NORESCAN;       26093452
*        ANS ('/* GETSCB FUNCTION CODE      */')COL(41) NORESCAN;       26094852
*        ANS ('DCL ACLSGSIZ CONSTANT(4);') SKIP COL(10) NORESCAN;       26095052
*        ANS ('/* GETSIZE FUNCTION CODE     */')COL(41) NORESCAN;       26095252
*        ANS ('DCL ACLSGALT CONSTANT(5);') SKIP COL(10) NORESCAN;       26095452
*        ANS ('/* GETALET FUNCTION CODE     */')COL(41) NORESCAN;       26095652
*        ANS ('DCL ACLSFALT CONSTANT(6);') SKIP COL(10) NORESCAN;       26095852
*        ANS ('/* FREEALET FUNCTION CODE    */')COL(41) NORESCAN;       26096052
*        GOTO FINE;                                                     26096252
*      END;                                                             26097652
*     ELSE                                                              26097952
*      IF DSECT(1) = 'NO' THEN            /* INVALID DSECT VALUE    */ 26098252
*        DO;                               /* YES                    */ 26098552
*          IKEY = 'DSECT';                 /* SET NAME IN NOTE       */ 26098852
*          GO TO MERR5;                    /* ISSUE NOTE AND RETURN  */ 26099152
*        END;                              /*                        */ 26099452
* /*******************************************************************/ 26100052
* /*                                                                 */ 26150052
* /* CHECK GIVEN FUNCTION                                               26200052
* /*                                                                 */ 26250052
* /*******************************************************************/ 26300052
*    IF NUMBER(FUNC) = 0  THEN             /* FUNC GIVEN             */ 26350052
*      DO;                                 /* NO                     */ 26400052
*        IKEY = 'FUNC';                    /* SET PARM FOR MNOTE     */ 26450052
*        GO TO MERR1;                      /* WRITE MNOTE            */ 26500052
*      END;                                /*                        */ 26550052
*    IF FUNC(1) = 'GETDSN' THEN                                         26600052
*      DO;                                                              26650052
*        TFUNC = 1;                        /* SET FUNCTION CODE      */ 26700052
*        RALET = 2;                        /* ALET REQUESTED FOR INP.*/ 26750052
*        RDSNAME = 1;                      /* DSNAME REQ. FOR OUTPUT */ 26800052
*        ROWNER = 1;                       /* OWNER  REQ. FOR OUTPUT */ 26825052
*        APROUT = 1;                       /* ROUTINE IS APPLICABLE  */ 26831252
*        NATASK = 1;                       /* TASK NOT APPLICABLE    */ 26837452
*        NAPART = 1;                       /* PART NOT APPLICABLE    */ 26843652
*      END;                                                             26850052
*    IF FUNC(1) = 'GETSTK' THEN                                         26900052
*      DO;                                                              26950052
*        TFUNC = 2;                        /* SET FUNCTION CODE      */ 27000052
*        RDSNAME = 2;                      /* DSNAME REQ. FOR INPUT  */ 27050052
*        RSTOKEN = 1;                      /* STOKEN REQUESTED       */ 27100052
*      END;                                                             27150052
*    IF FUNC(1) = 'GETSCB' THEN                                         27200052
*      DO;                                                              27250052
*        TFUNC = 3;                        /* SET FUNCTION CODE      */ 27300052
*        RALET = 2;                        /* ALET REQUESTED FOR INP.*/ 27350052
*        RSCBADR = 1;                      /* SCBADR REQUESTED       */ 27400052
*        APROUT = 1;                       /* ROUTINE IS APPLICABLE  */ 27400852
*        NATASK = 1;                       /* TASK NOT APPLICABLE    */ 27401652
*        NAPART = 1;                       /* PART NOT APPLICABLE    */ 27402452
*      END;                                                             27403552
*    IF FUNC(1) = 'GETSIZE' THEN                                        27407052
*      DO;                                                              27410552
*        TFUNC = 4;                        /* SET FUNCTION CODE      */ 27414052
*        RALET = 2;                        /* ALET REQUESTED FOR INP.*/ 27417552
*        RSIZE = 1;                        /* SIZE REQUESTED         */ 27421052
*        NATASK = 1;                       /* TASK NOT APPLICABLE    */ 27422152
*        NAPART = 1;                       /* PART NOT APPLICABLE    */ 27423252
*      END;                                                             27424552
*    IF FUNC(1) = 'GETALET' THEN                                        27428052
*      DO;                                                              27431552
*        TFUNC = 5;                        /* SET FUNCTION CODE      */ 27435052
*        RALET = 1;                        /* ALET REQUESTED FOR OUTP*/ 27438552
*        RDSNAME = 2;                      /* DSNAME REQUESTED FOR IN*/ 27442052
*        RPART = 1;                        /* PART REQUESTED (I/O)   */ 27445552
*      END;                                                             27446152
*    IF FUNC(1) = 'FREEALET' THEN                                       27446752
*      DO;                                                              27447352
*        TFUNC = 6;                        /* SET FUNCTION CODE      */ 27447952
*        NATASK = 1;                       /* TASK NOT APPLICABLE    */ 27448552
*        NAPART = 1;                       /* PART NOT APPLICABLE    */ 27449152
*      END;                                                             27450052
*    IF TFUNC = 0 THEN                     /* NOT FOUND              */ 27500052
*      DO;                                                              27550052
*        IKEY = 'FUNC-';                   /* SET IKEY               */ 27600052
*        GO TO MERR2;                      /* WRITE NOTE             */ 27650052
*      END;                                /*                        */ 27900052
* /*******************************************************************/ 27950052
* /*                                                                 */ 28000052
* /*     CHECK ALET OPERAND.                                         */ 28050052
* /*                                                                 */ 28100052
* /*******************************************************************/ 28150052
*    IKEY = 'ALET-';                       /* IKEY FOR MSG           */ 28200052
*    IF NUMBER(ALET) = 0 THEN              /* IF OMITTED             */ 28250052
*      IF RALET > 0 THEN                   /* ALET REQUESTED         */ 28300052
*        GO TO MERR1;                      /* WRITE ERROR MESSAGE    */ 28350052
*      ELSE;                               /* ELSE DO NOTHING        */ 28400052
*    ELSE                                  /* IF PRESENT             */ 28450052
*      DO;                                                              28500052
*        IF RALET = 0 THEN                 /* ALET NOT NEEDED        */ 28550052
*          DO;                             /*                        */ 28600052
*            IGO = 1;                      /* SET BRANCHADR          */ 28650052
*            GO TO MERR3;                  /* WRITE WARNING          */ 28700052
*          END;                            /*                        */ 28750052
*        IF ALET(1,1:1) = '(' THEN         /* IF PARENS USED         */ 28800052
*          CALET = ALET(1,1);              /* SAVE WITHOUT           */ 28850052
*        ELSE                              /* OTHERWISE              */ 28900052
*          CALET = ALET(1);                /* SAVE ALET VALUE        */ 28950052
*      END;                                                             29000052
* /*******************************************************************/ 29050052
* /*                                                                 */ 29100052
* /*     CHECK DSNAME OPERAND                                        */ 29150052
* /*                                                                 */ 29200052
* /*******************************************************************/ 29250052
* CHDSN:                                   /* CHECK DSNAME OP.       */ 29300052
*    IKEY = 'DSNAME-';                     /* IKEY FOR MSG           */ 29350052
*    IF NUMBER(DSNAME) = 0 THEN            /* IF OMITTED             */ 29400052
*      IF RDSNAME > 0 THEN                 /* DSNAME REQUESTED       */ 29450052
*        GO TO MERR1;                      /* WRITE ERROR MESSAGE    */ 29500052
*      ELSE;                               /* ELSE DO NOTHING        */ 29550052
*    ELSE                                  /* IF PRESENT             */ 29600052
*      DO;                                                              29650052
*        IF RDSNAME = 0 THEN               /* DSNAME NOT NEEDED      */ 29700052
*          DO;                             /*                        */ 29750052
*            IGO = 2;                      /* SET BRANCHADR          */ 29800052
*            GO TO MERR3;                  /* WRITE WARNING          */ 29850052
*          END;                            /*                        */ 29900052
*        IF DSNAME(1,1:1) = '(' THEN       /* IF PARENS USED         */ 29950052
*          DO;                                                          29978552
*            CDSNAME = DSNAME(1,1);        /* SAVE WITHOUT           */ 30007052
*            RGDSNM = 1;                   /* INDICATE REGISTER FORM */ 30035552
*          END;                                                         30064052
*        ELSE                              /*                        */ 30092552
*          CDSNAME = DSNAME(1);            /* SAVE DSNAME ADDRESS    */ 30121052
*      END;                                                             30150052
* /*******************************************************************/ 30200052
* /*                                                                 */ 30250052
* /*     CHECK OWNER OPERAND                                         */ 30251952
* /*                                                                 */ 30253852
* /*******************************************************************/ 30255752
* CHOWNER:                                 /* CHECK OWNER OP.        */ 30257652
*    IKEY = 'OWNER-';                      /* IKEY FOR MSG           */ 30259552
*    IF NUMBER(OWNER) = 0 THEN             /* IF OMITTED             */ 30261452
*      IF ROWNER > 0 THEN                  /* DSNAME REQUESTED       */ 30263352
*        GO TO MERR1;                      /* WRITE ERROR MESSAGE    */ 30265252
*      ELSE;                               /* ELSE DO NOTHING        */ 30267152
*    ELSE                                  /* IF PRESENT             */ 30269052
*      DO;                                                              30270952
*        IF ROWNER = 0 THEN                /* DSNAME NOT NEEDED      */ 30272852
*          DO;                             /*                        */ 30274752
*            IGO = 3;                      /* SET BRANCHADR          */ 30276652
*            GO TO MERR3;                  /* WRITE WARNING          */ 30278552
*          END;                            /*                        */ 30280452
*        IF OWNER(1,1:1) = '(' THEN        /* IF PARENS USED         */ 30282352
*          DO;                                                          30284252
*            COWNER = OWNER(1,1);          /* SAVE WITHOUT           */ 30286152
*          END;                                                         30288052
*        ELSE                              /*                        */ 30289952
*          COWNER = OWNER(1);              /* SAVE DSNAME ADDRESS    */ 30291852
*      END;                                                             30293752
* /*******************************************************************/ 30295652
* /*                                                                 */ 30297552
* /*     CHECK STOKEN OPERAND                                        */ 30300052
* /*                                                                 */ 30350052
* /*******************************************************************/ 30400052
* CHSTKN:                                  /* CHECK STOKEN OP.       */ 30450052
*    IKEY = 'STOKEN-';                     /* IKEY FOR MSG           */ 30500052
*    IF NUMBER(STOKEN) = 0 THEN            /* IF OMITTED             */ 30550052
*      IF RSTOKEN = 1 THEN                 /* STOKEN REQUESTED       */ 30600052
*        GO TO MERR1;                      /* WRITE ERROR MESSAGE    */ 30650052
*      ELSE;                               /* ELSE DO NOTHING        */ 30700052
*    ELSE                                  /* IF PRESENT             */ 30750052
*      DO;                                                              30800052
*        IF RSTOKEN = 0 THEN               /* STOKEN NOT NEEDED      */ 30850052
*          DO;                             /*                        */ 30900052
*            IGO = 4;                      /* SET BRANCHADR          */ 30950052
*            GO TO MERR3;                  /* WRITE WARNING          */ 31000052
*          END;                            /*                        */ 31050052
*        IF STOKEN(1,1:1) = '(' THEN       /* IF PARENS USED         */ 31100052
*          DO;                                                          31120052
*            CSTOKEN = STOKEN(1,1);        /* SAVE WITHOUT           */ 31140052
*            RGSTKN = 1;                   /* SAVE WITHOUT           */ 31160052
*          END;                            /* OTHERWISE              */ 31180052
*        ELSE                              /* OTHERWISE              */ 31200052
*          CSTOKEN = STOKEN(1);            /* SAVE STOKEN ADDRESS    */ 31250052
*      END;                                                             31300052
* /*******************************************************************/ 31350052
* /*                                                                 */ 31400052
* /*     CHECK SCBADR OPERAND                                        */ 31450052
* /*                                                                 */ 31500052
* /*******************************************************************/ 31550052
* CHSCBAD:                                 /* CHECK SCBADR OP.       */ 31600052
*    IKEY = 'SCBADR-';                     /* IKEY FOR MSG           */ 31650052
*    IF NUMBER(SCBADR) = 0 THEN            /* IF OMITTED             */ 31700052
*      IF RSCBADR = 1 THEN                 /* SCBADR REQUESTED       */ 31750052
*        GO TO MERR1;                      /* WRITE ERROR MESSAGE    */ 31800052
*      ELSE;                               /* ELSE DO NOTHING        */ 31850052
*    ELSE                                  /* IF PRESENT             */ 31900052
*      DO;                                                              31950052
*        IF RSCBADR = 0 THEN               /* SCBADR NOT NEEDED      */ 32000052
*          DO;                             /*                        */ 32050052
*            IGO = 5;                      /* SET BRANCHADR          */ 32100052
*            GO TO MERR3;                  /* WRITE WARNING          */ 32150052
*          END;                            /*                        */ 32200052
*        IF SCBADR(1,1:1) = '(' THEN       /* IF PARENS USED         */ 32250052
*          CSCBADR = SCBADR(1,1);          /* SAVE WITHOUT           */ 32300052
*        ELSE                              /* OTHERWISE              */ 32350052
*          CSCBADR = SCBADR(1);            /* SAVE SCBADR VALUE      */ 32400052
*      END;                                                             32450052
* /*******************************************************************/ 32500052
* /*                                                                 */ 32550052
* /*     CHECK SIZE OPERAND.                                         */ 32552052
* /*                                                                 */ 32554052
* /*******************************************************************/ 32556052
* CHSIZE:                                                               32558052
*    IKEY = 'SIZE-';                       /* IKEY FOR MSG           */ 32560052
*    IF NUMBER(SIZE) = 0 THEN              /* IF OMITTED             */ 32562052
*      IF RSIZE = 1 THEN                   /* SIZE REQUESTED         */ 32564052
*        GO TO MERR1;                      /* WRITE ERROR MESSAGE    */ 32566052
*      ELSE;                               /* ELSE DO NOTHING        */ 32568052
*    ELSE                                  /* IF PRESENT             */ 32570052
*      DO;                                                              32572052
*        IF RSIZE = 0 THEN                 /* SIZE NOT NEEDED        */ 32574052
*          DO;                             /*                        */ 32576052
*            IGO = 6;                      /* SET BRANCHADR          */ 32578052
*            GO TO MERR3;                  /* WRITE WARNING          */ 32580052
*          END;                            /*                        */ 32582052
*        IF SIZE(1,1:1) = '(' THEN         /* IF PARENS USED         */ 32584052
*          CSIZE = SIZE(1,1);              /* SAVE WITHOUT           */ 32586052
*        ELSE                              /* OTHERWISE              */ 32588052
*          CSIZE = SIZE(1);                /* SAVE SIZE VALUE        */ 32590052
*      END;                                                             32592052
* /*******************************************************************/ 32594052
* /*                                                                 */ 32596052
* /*     CHECK TASK OPERAND                                          */ 32600052
* /*                                                                 */ 32650052
* /*******************************************************************/ 32700052
* CHTASK:                                  /* CHECK TASK OP.         */ 32750052
*    IKEY = 'TASK-';                       /* IKEY FOR MSG           */ 32775052
*    IF NUMBER(TASK) =0 THEN              /* TASK SPECIFIED         */ 32800052
*      DO;                                                              32850052
*        IF NATASK = 1 THEN                /* TASK NOT APPLICABLE    */ 32858352
*         DO;                                                           32866652
*           IGO = 7;                       /* SET BRANCHADR          */ 32874952
*           GO TO MERR3;                   /* WRITE WARNING          */ 32883252
*         END;                             /*                        */ 32891552
*        ISTASK = 1;                       /* INDICATE SPECIFICATION */ 32900052
*        IF TASK(1,1:1) = '(' THEN         /* IF PARENS USED         */ 32950052
*          CTASK = TASK(1,1);              /* SAVE WITHOUT           */ 33000052
*        ELSE                              /* OTHERWISE              */ 33050052
*          CTASK = TASK(1);                /* SAVE TASK VALUE        */ 33100052
*      END;                                                             33150052
* /*******************************************************************/ 33200052
* /*                                                                 */ 33250052
* /*     CHECK PART OPERAND                                          */ 33300052
* /*                                                                 */ 33350052
* /*******************************************************************/ 33400052
* CHPART:                                  /* CHECK PART OP.         */ 33405052
*    IKEY = 'PART-';                       /* IKEY FOR MSG           */ 33410052
*    IF NUMBER(PART) = 0 THEN              /* IF OMITTED             */ 33420052
*      IF RPART = 1 THEN                   /* PART REQUESTED         */ 33430052
*        GO TO MERR1;                      /* WRITE ERROR MESSAGE    */ 33440052
*    IF NUMBER(PART) =0 THEN              /* PART SPECIFIED         */ 33450052
*      DO;                                                              33500052
*        IF NAPART = 1 THEN                /* PART NOT APPLICABLE    */ 33502752
*         DO;                                                           33505452
*           IGO = 8;                       /* SET BRANCHADR          */ 33508152
*           GO TO MERR3;                   /* WRITE WARNING          */ 33510852
*         END;                             /*                        */ 33513552
*        IF ISTASK = 1 THEN                /* TASK ALSO SPECIFIED    */ 33516652
*          GOTO MERR4;                     /* WRITE ERROR MESSAGE    */ 33533252
*        ISPART = 1;                       /* INDICATE SPECIFICATION */ 33550052
*        IF PART(1,1:1) = '(' THEN         /* IF PARENS USED         */ 33600052
*          CPART = PART(1,1);              /* SAVE WITHOUT           */ 33650052
*        ELSE                              /* OTHERWISE              */ 33700052
*          CPART = PART(1);                /* SAVE PART VALUE        */ 33750052
*      END;                                                             33800052
* /*******************************************************************/ 33850052
* /*                                                                 */ 33900052
* /*     CHECK PART OPERAND                                          */ 33945252
* /*                                                                 */ 33990452
* /*******************************************************************/ 34035652
* CHROUT:                                  /* CHECK ROUTINE OP.      */ 34080852
*    IKEY = 'ROUTINE-';                    /* IKEY FOR MSG           */ 34126052
*    IF NUMBER(ROUTINE) =0 THEN           /* ROUTINE SPECIFIED      */ 34171252
*      DO;                                                              34216452
*        IF APROUT = 0 THEN                /* ROUTINE NOT APPLICABLE */ 34261652
*         DO;                                                           34306852
*           IGO = 9;                       /* SET BRANCHADR          */ 34352052
*           GO TO MERR3;                   /* WRITE WARNING          */ 34397252
*         END;                             /*                        */ 34442452
*        ISROUT = 1;                       /* INDICATE SPECIFICATION */ 34487652
*        ROFFSET = '8';                    /* OFFSET INTO ROUTINE    */ 34510252
*        IF ROUTINE(1,1:1) = '(' THEN      /* IF PARENS USED         */ 34532852
*          CROUT = ROUTINE(1,1);           /* SAVE WITHOUT           */ 34578052
*        ELSE                              /* OTHERWISE              */ 34623252
*          CROUT = ROUTINE(1);             /* SAVE PART VALUE        */ 34668452
*      END;                                                             34713652
* /*******************************************************************/ 34758852
* /*                                                                 */ 34804052
* /*     CHECK MFG OPERAND.                                          */ 34850052
* /*                                                                 */ 34900052
* /*******************************************************************/ 34950052
* CHMFG:                                   /* CHECK MFG OP.          */ 34975052
*    IF NUMBER(MFG) =0 THEN               /* OPERAND SPECIFIED      */ 35000052
*      DO;                                                              35050052
*        ISMFG = 1;                        /* INDICATE SPECIFICATION */ 35100052
*        IF MFG(1,1:1) = '(' THEN          /* NOTATION USED          */ 35150052
*            CMFG = MFG(1);                /* SAVE IT                */ 35200052
*        ELSE                              /*                        */ 35250052
*          DO;                             /*                        */ 35300052
*            IF INDEX(MFG(1),'ADDR(') = 0 THEN /* IF PRT EXPR.      */ 35350052
*              CMFG = MFG(1);              /* SAVE IT                */ 35400052
*            ELSE                          /* ELSE CREATE            */ 35450052
*              CMFG = 'ADDR('||MFG(1)||')';  /* PTR EXPRESSION       */ 35500052
*          END;                                                         35550052
*      END;                                                             35600052
*   GO TO SETDCL;                          /*                        */ 35650052
* /*******************************************************************/ 35700052
* /*                                                                 */ 35750052
* /*     MNOTE DECLARATIONS                                          */ 35800052
* /*                                                                 */ 35850052
* /*******************************************************************/ 35900052
* MERR1:                                   /* WRITE MNOTE FOR        */ 35950052
* ANS MSG('IKEY OPERAND NOT GIVEN,GENERATION SUPPRESSED;')RESCAN ;      36000052
* ANS ('/* '||IKEY||' OPERAND NOT GIVEN,GENERATION SUPPRESSED */')      36050052
* RESCAN COL(MACLMAR);                                                  36100052
* RETURN CODE(8);                          /* MISSING OPERAND        */ 36150052
* MERR2:                                   /* WRITE MNOTE            */ 36200052
* ANS MSG('INVALID IKEY OPERAND GIVEN,GENERATION SUPPRESSED;')RESCAN;   36250052
* ANS ('/* INVALID '||IKEY||' OPERAND GIVEN,GENERATION SUPPRESSED */')  36300052
*     RESCAN COL(MACLMAR);                                              36350052
* RETURN CODE(8);                          /* SEL AND SEP GIVEN      */ 36400052
* MERR3:                                   /* WRITE MNOTE FOR        */ 36450052
* IFUNC = FUNC(1);                         /* SET FUNC               */ 36650052
* ANS MSG('IKEY OPERAND IGNORED FOR FUNC=IFUNC;')RESCAN ;  /*        */ 36700052
* ANS ('/* '||IKEY||' OPERAND IGNORED FOR FUNC='||IFUNC||' */')         36750052
* RESCAN COL(MACLMAR);                                                  36800052
*  IF IGO = 1 THEN                         /*                        */ 36850052
*      GO TO CHDSN;                        /* CHECK DSNAME           */ 36900052
*  IF IGO = 2 THEN                         /*                        */ 36950052
*      GO TO CHOWNER;                      /* CHECK OWNER            */ 37000052
*  IF IGO = 3 THEN                         /*                        */ 37050052
*      GO TO CHSTKN;                       /* CHECK STOKEN           */ 37100052
*  IF IGO = 4 THEN                         /*                        */ 37150052
*      GO TO CHSCBAD;                      /* CHECK SCBADR           */ 37171452
*  IF IGO = 5 THEN                         /*                        */ 37192852
*      GO TO CHSIZE;                       /* CHECK SIZE             */ 37214252
*  IF IGO = 6 THEN                         /*                        */ 37235652
*      GO TO CHTASK;                       /* CHECK TASK             */ 37257052
*  IF IGO = 7 THEN                         /*                        */ 37261252
*      GO TO CHPART;                       /* CHECK PART             */ 37265452
*  IF IGO = 8 THEN                         /*                        */ 37269652
*      GO TO CHROUT;                       /* CHECK ROUTINE          */ 37271052
*  IF IGO = 9 THEN                         /*                        */ 37272452
*      GO TO CHMFG;                        /* CHECK MFG              */ 37273852
*  GO TO SETDCL;                           /* SET DCL                */ 37278452
* MERR4:                                   /* WRITE MNOTE FOR        */ 37300052
* ANS MSG('TASK AND PART OPERAND GIVEN GENERATION SUPPRESSED;')         37340052
* NORESCAN;                                                             37380052
* ANS ('/* TASK AND PART OPERAND GIVEN GENERATION SUPPRESSED */')       37420052
* NORESCAN COL(MACLMAR);                                                37460052
* RETURN CODE(8);                          /* SEL AND SEP GIVEN      */ 37466652
* MERR5:                                   /* WRITE MNOTE            */ 37473252
* ANS MSG('UNKNOWN IKEY VALUE GIVEN,GENERATION SUPPRESSED;')RESCAN;     37479852
* ANS ('/* UNKNOWN '||IKEY||' VALUE GIVEN,GENERATION SUPPRESSED */')    37486452
*     RESCAN COL(MACLMAR);                                              37493052
* RETURN CODE(8);                          /* SEL AND SEP GIVEN      */ 37500052
* /*******************************************************************/ 38200052
* /*                                                                 */ 38250052
* /* SET NAMES OF DCL FIELDS AND REGISTER WITH MACINDEX              */ 38300052
* /*                                                                 */ 38350052
* /*******************************************************************/ 38400052
* SETDCL:                                  /* NAME LIST              */ 38450052
*    ILIST  = 'ACLR'||MACINDEX;            /* SET NAME OF TABLE      */ 38500052
*    IREG0  = 'ACL0'||MACINDEX;            /* SET NAME OF REGISTER 0 */ 38515052
*    IREG1  = 'ACL1'||MACINDEX;            /* SET NAME OF REGISTER 1 */ 38530052
*    IREG14 = 'ACL4'||MACINDEX;            /* SET NAME OF REGISTER 14*/ 38545052
*    IREG15 = 'ACL5'||MACINDEX;            /* SET NAME OF REGISTER 15*/ 38560052
*    IFLD   = 'ACLX'||MACINDEX;            /* SET NAME OF DUMMY FIELD*/ 38590052
*    IPHASE = 'ACLY'||MACINDEX;            /* SET NAME OF ENTRY      */ 38620052
*    IFUNC  = 'ACLF'||MACINDEX;            /* SET NAME OF FUNC FIELD */ 38650052
*    IALET  = 'ACLA'||MACINDEX;            /* SET NAME OF ALET FIELD */ 38700052
*    IDSNAME= 'ACLN'||MACINDEX;            /* SET NAME OF DSNAME FLD.*/ 38750052
*    ITASK  = 'ACLT'||MACINDEX;            /* SET NAME OF TASK FIELD */ 38800052
*    IPART  = 'ACLP'||MACINDEX;            /* SET NAME OF PART FIELD */ 38850052
*    ISTOKEN= 'ACLS'||MACINDEX;            /* SET NAME OF STOKEN FLD.*/ 38900052
*    IOUT   = 'ACLO'||MACINDEX;            /* SET NAME OF OUTPUT FLD.*/ 38950052
*    IFLGS  = 'ACLL'||MACINDEX;            /* SET NAME OF FLAG BYTE  */ 38962552
*    ISTSK  = 'ACLK'||MACINDEX;            /* SET NAME OF TASK BIT   */ 38975052
*    ISPAR  = 'ACLI'||MACINDEX;            /* SET NAME OF PART BIT   */ 38981252
*    ISROU  = 'ACLB'||MACINDEX;            /* SET NAME OF ROUTINE BIT*/ 38993652
*    ISSAV  = 'ACSA'||MACINDEX;            /* SET NAME OF SAVE AREA  */ 38996852
* /*******************************************************************/ 39000052
* /*                                                                 */ 39050052
* /*  DECLARE PARAMETER LIST AND REGISTERS  AND SET ADDRESS          */ 39100052
* /*                                                                 */ 39150052
* /*******************************************************************/ 39200052
*    ANS ('DCL IREG0 REG(0) PTR(31);')RESCAN SKIP COL(10);              39250052
*    ANS ('/* ALETMAC PTR TO PARMLST    */')COL(41);                    39300052
*    ANS ('DCL IREG1 REG(1) PTR(31);')RESCAN SKIP COL(10);              39305552
*    ANS ('/* ALETMAC PTR TO PARMLST    */')COL(41);                    39311052
*    ANS ('DCL IREG14 REG(14) PTR(31);')RESCAN SKIP COL(10);            39316552
*    ANS ('/* ALETMAC RETURN CODE       */')COL(41);                    39322052
*    ANS ('DCL IREG15 REG(15) PTR(31);')RESCAN SKIP COL(10);            39327552
*    ANS ('/* ALETMAC RETURN CODE       */')COL(41);                    39333252
*    IF ISROUT = 1 THEN                                                 39335552
*      ANS ('RFY (IREG0,IREG1,IREG15)RSTD;')                            39337852
*            RESCAN SKIP COL(MACCOL);                                   39340152
*    ELSE                                                               39342452
*      ANS ('RFY (IREG0,IREG1,IREG14,IREG15)RSTD;')                     39344752
*            RESCAN SKIP COL(MACCOL);                                   39347052
*    RGRES = RGDSNM + RGSTKN;                                           39349852
*    IF RGRES = 0 THEN                    /* REGISTER SPECIFICATIONS*/ 39366452
*      DO;                                 /*                        */ 39383052
*      ANS ('DCL IFLD CHAR(8) BASED(*);')RESCAN SKIP COL(10);           39399652
*      ANS ('/* DUMMY FIELD      */') COL(50);                          39416252
*      END;                                  /*                      */ 39432852
*    IF NUMBER(MFG) = 0 THEN               /* MFG = 0 INLINE         */ 39450052
*    DO;                                   /*                        */ 39500052
*    ANS ('DCL 1 ILIST BDY(WORD),')RESCAN SKIP COL(10);                 39550052
*    ANS ('/* ALETMAC PARMLIST */') COL(50);                            39600052
*    END;                                  /*                        */ 39650052
*    ELSE                                  /* DECLARE BASED          */ 39700052
*    DO;                                   /*                        */ 39750052
*    ANS ('DCL 1 ILIST BASED(*),')RESCAN SKIP COL(10);                  39800052
*    ANS ('/* ALETMAC PARMLIST */') COL(50);                            39850052
*    END;                                  /*                        */ 39900052
*    ANS ('5 IFUNC  PTR(8),')RESCAN SKIP COL(15);                       39950052
*    ANS ('/* FUNCTION BYTE             */')COL(41);                    40000052
*    ANS ('5 IFLGS  PTR(8),')RESCAN SKIP COL(15);                       40010052
*    ANS ('/* FLAG BYTE                 */')COL(41);                    40020052
*    ANS ('  6 ISTSK BIT(1),')RESCAN SKIP COL(15);                      40030052
*    ANS ('/* TASK IS SPECIFIED         */')COL(41);                    40040052
*    ANS ('  6 ISPAR BIT(1),')RESCAN SKIP COL(15);                      40050052
*    ANS ('/* PARTITION IS SPECIFIED    */')COL(41);                    40060052
*    ANS ('  6 ISROU BIT(1),')RESCAN SKIP COL(15);                      40065052
*    ANS ('/* ROUTINE IS SPECIFIED    */')COL(41);                      40070052
*    ANS ('  6 *     BIT(5),') SKIP COL(15);                            40075052
*    ANS ('/* RESERVED                  */')COL(41);                    40080052
*    ANS ('5 *      CHAR(2),') SKIP COL(15);                            40090052
*    ANS ('/* RESERVED                  */')COL(41);                    40100052
*    ANS ('5 IALET PTR(31),')RESCAN SKIP COL(15);                       40150052
*    ANS ('/* DATA SPACE ALET           */')COL(41);                    40200052
*    ANS ('5 IDSNAME CHAR(8),')RESCAN SKIP COL(15);                     40250052
*    ANS ('/* DATA SPACE NAME           */')COL(41);                    40300052
*    ANS ('5 ISTOKEN CHAR(8),')RESCAN SKIP COL(15);                     40316652
*    ANS ('/* DATA SPACE STOKEN         */')COL(41);                    40333252
*    ANS ('5 ITASK FIXED(16),')RESCAN SKIP COL(15);                     40350052
*    ANS ('/* TASK ID                   */')COL(41);                    40400052
*    ANS ('5 IPART FIXED(16),')RESCAN SKIP COL(15);                     40450052
*    ANS ('/* PARTITION ID              */')COL(41);                    40500052
*    ANS ('5 IOUT PTR(31),')RESCAN SKIP COL(15);                        40550052
*    ANS ('/* OUTPUT FIELD              */')COL(41);                    40700052
*    ANS ('5 ISSAV(8) FIXED(32);')RESCAN SKIP COL(15);                  40750052
*    ANS ('/* SAVE AREA                 */')COL(41);                    40800052
*    ANS (MACLABEL) COL(MACCOL);                                        40850052
*    IF NUMBER(MFG) = 0 THEN               /* MFG = 0 INLINE         */ 40900052
*    DO;                                   /*                        */ 40950052
*    ANS ('IREG1=ADDR(ILIST);')RESCAN SKIP COL(MACCOL);                 41000052
*    ANS ('/* SET PARMLIST ADDR         */') COL(41);                   41050052
*    END;                                  /*                        */ 41100052
*   ELSE                                   /* CHECK MFG OPERAND      */ 41150052
*    DO;                                   /* IF REGISTER            */ 41200052
*    ANS ('IREG1 = CMFG;')RESCAN SKIP COL(MACCOL);                      41250052
*    ANS ('/* SET PARMLIST ADDR         */') COL(41);                   41300052
*    ANS ('RFY ILIST BASED(IREG1);')RESCAN SKIP COL(MACCOL);            41350052
*    ANS ('/* ADRESSABLE PARMLIST       */') COL(41);                   41400052
*    END;                                   /*                       */ 41450052
* /*******************************************************************/ 41500052
* /*                                                                 */ 41550052
* /*  SET FUNCTION IN PARAMETER LIST AND CLEAR FLAG BYTE             */ 41600052
* /*                                                                 */ 41650052
* /*******************************************************************/ 41700052
*    ANS ('IFUNC = TFUNC;')RESCAN SKIP COL(MACCOL);                     41750052
*    ANS ('/* SET FUNCTION IN PARM LIST */') COL(41);                   41800052
*    ANS ('IFLGS = 0;')RESCAN SKIP COL(MACCOL);                         41816652
*    ANS ('/* CLEAR FLAG BYTE           */') COL(41);                   41833252
* /*******************************************************************/ 41850052
* /*                                                                 */ 41900052
* /*  SET ALET OPERAND                                               */ 41950052
* /*                                                                 */ 42000052
* /*******************************************************************/ 42050052
*    IF RALET = 2 THEN DO;                 /* ALET REQUESTED FOR INP.*/ 42068752
*      ANS ('IALET = CALET;')RESCAN SKIP COL(MACCOL);                   42087452
*      ANS ('/* SET ALET PARAMETER        */') COL(41);                 42124952
*    END;                                  /*                        */ 42162452
* /*******************************************************************/ 42200052
* /*                                                                 */ 42250052
* /*  SET DSNAME OPERAND                                             */ 42300052
* /*                                                                 */ 42350052
* /*******************************************************************/ 42400052
*    IF RDSNAME = 2 THEN                   /* DSNAME INPUT SPECIFIED */ 42423552
*    DO;                                                                42447052
*      IF RGDSNM = 1 THEN                  /* REGISTER FORM          */ 42470552
*      DO;                                                              42494052
*        ANS ('IDSNAME = CDSNAME -> IFLD;')RESCAN SKIP COL(MACCOL);     42517552
*      END;                                                             42541052
*      ELSE                                                             42564552
*      DO;                                                              42588052
*        ANS ('IDSNAME = CDSNAME;')RESCAN SKIP COL(MACCOL);             42611552
*      END;                                                             42635052
*      ANS ('/* SET DSNAME PARAMETER      */') COL(41);                 42685052
*    END;                                  /*                        */ 42735052
* /*******************************************************************/ 43750052
* /*                                                                 */ 43800052
* /*  SET TASK OPERAND                                               */ 43850052
* /*                                                                 */ 43900052
* /*******************************************************************/ 43950052
*    IF ISTASK = 1 THEN DO;                /* TASK SPECIFIED         */ 44000052
*      ANS ('ITASK = CTASK;')RESCAN SKIP COL(MACCOL);                   44050052
*      ANS ('/* SET TASK PARAMETER        */') COL(41);                 44062552
*      ANS ('ISTSK = ''1''B;')RESCAN SKIP COL(MACCOL);                  44075052
*      ANS ('/* TASK ID IS SPECIFIED      */') COL(41);                 44087552
*    END;                                  /*                        */ 44100052
*    ELSE DO;                              /* TASK ZERO              */ 44150052
*      ANS ('ITASK = 0 ;')RESCAN SKIP COL(MACCOL);                      44200052
*      ANS ('/* SET TASK PARAMETER        */') COL(41);                 44250052
*    END;                                  /*                        */ 44300052
* /*******************************************************************/ 47250052
* /*                                                                 */ 47300052
* /*  SET PART OPERAND                                               */ 47350052
* /*                                                                 */ 47400052
* /*******************************************************************/ 47450052
*    IF ISPART = 1 THEN DO;                /* PART SPECIFIED         */ 47500052
*      ANS ('IPART = CPART;')RESCAN SKIP COL(MACCOL);                   47550052
*      ANS ('/* SET PART. PARAMETER       */') COL(41);                 47562552
*      ANS ('ISPAR = ''1''B;')RESCAN SKIP COL(MACCOL);                  47575052
*      ANS ('/* PART. ID IS SPECIFIED     */') COL(41);                 47587552
*    END;                                  /*                        */ 47600052
*    ELSE DO;                              /* PART ZERO              */ 47650052
*      ANS ('IPART = 0 ;')RESCAN SKIP COL(MACCOL);                      47700052
*      ANS ('/* SET PART. PARAMETER       */') COL(41);                 47725052
*    END;                                  /*                        */ 47750052
* /*******************************************************************/ 49150052
* /*                                                                 */ 49200052
* /*  CALL THE ROUTINE DIRECTLY IF ROUTINE ADDRESS SPECIFIED         */ 49233352
* /*  OTHERWISE ISSUE SENTER MACRO                                   */ 49266652
* /*                                                                 */ 49300052
* /*******************************************************************/ 49350052
*    IF ISROUT = 1 THEN                    /* ROUTINE IS SPECIFIED   */ 49360052
*     DO;                                                               49370052
*       ANS ('ISROU = ''1''B;')RESCAN SKIP COL(MACCOL);                 49380052
*       ANS ('/* ROUTINE IS SPECIFIED     */') COL(41);                 49390052
*       ANS ('IREG15 = CROUT;')RESCAN SKIP COL(MACCOL);                 49400052
*       ANS ('/* SET ROUTINE ADDRESS       */') COL(41);                49410052
*       ANS ('GEN(STM   2,9,'||ISSAV||'-'||ILIST||'(1) )                49410852
*                         REFS('||ISSAV||');')                          49411652
*                         RESCAN SKIP COL(MACCOL);                      49412452
*       ANS ('/* SAVE USER REGISTERS     */') COL(41);                  49413252
*       ANS ('GEN(LM    2,9,0(1));')NORESCAN SKIP                       49414052
*                                      COL(MACCOL);                     49414852
*       ANS ('/* LOAD PARAMETERS INTO REGS */') COL(41);                49415652
*       ANS ('GEN(BAL   14,'||ROFFSET||'(0,15));')RESCAN SKIP           49416652
*                                      COL(MACCOL);                     49423252
*       ANS ('/* CALL IJBALET              */') COL(41);                49430052
*     END;                                                              49440052
*    ELSE                                                               49450052
*     DO;                                                               49460052
*       ANS ('GEN(STM   2,9,'||ISSAV||'-'||ILIST||'(1) )                49461252
*                         REFS('||ISSAV||');')                          49462452
*                         RESCAN SKIP COL(MACCOL);                      49463652
*       ANS ('/* SAVE USER REGISTERS     */') COL(41);                  49464852
*       ANS ('GEN(LM    2,9,0(1));')NORESCAN SKIP                       49466052
*                                      COL(MACCOL);                     49467252
*       ANS ('/* LOAD PARAMETERS INTO REGS */') COL(41);                49468452
*       ANS ('GEN(SENTER ALET);')NORESCAN SKIP COL(MACCOL);             49470052
*       ANS ('/* CALL IJBALET VIA SENTER   */') COL(41);                49480052
*     END;                                                              49490052
*    ANS ('GEN(STM   2,9,0(1));')NORESCAN SKIP                          49491252
*                                      COL(MACCOL);                     49492452
*    ANS ('/* STORE REGS INTO USER PARM LIST   */') COL(41);            49493652
*    ANS ('GEN(LM    2,9,'||ISSAV||'-'||ILIST||'(1) )                   49494852
*                                    REFS('||ISSAV||');')               49496052
*                           RESCAN SKIP COL(MACCOL);                    49497252
*    ANS ('/* LOAD USER REGISTERS */') COL(41);                         49498452
* /*******************************************************************/ 49500052
* /*                                                                 */ 49550052
* /*  RETURN ALET PARAMETER                                          */ 49600052
* /*                                                                 */ 49650052
* /*******************************************************************/ 49700052
*    IF RALET = 1 THEN                     /* ALET SPECIFIED FOR OUTP*/ 49750052
*    DO;                                                                49800052
*      ANS ('CALET = IALET;')RESCAN SKIP COL(MACCOL);                   49850052
*      ANS ('/* RETURN ALET               */')COL(41);                  49900052
*    END;                                  /*                        */ 49950052
* /*******************************************************************/ 50100052
* /*                                                                 */ 50150052
* /*  RETURN DSNAME PARAMETER                                        */ 50200052
* /*                                                                 */ 50250052
* /*******************************************************************/ 50300052
*    IF RDSNAME = 1 THEN                   /* DSNAME OUTPUT SPECIFIED*/ 50307652
*    DO;                                                                50315252
*      IF RGDSNM = 1 THEN                  /* REGISTER FORM          */ 50322852
*      DO;                                                              50330452
*        ANS (' CDSNAME -> IFLD= IDSNAME;')RESCAN SKIP COL(MACCOL);     50338052
*      END;                                                             50345652
*      ELSE                                                             50353252
*      DO;                                                              50360852
*        ANS ('CDSNAME = IDSNAME;')RESCAN SKIP COL(MACCOL);             50368452
*      END;                                                             50376052
*      ANS ('/* RETURN DSNAME             */')COL(41);                  50383652
*    END;                                  /*                        */ 50384252
* /*******************************************************************/ 50384852
* /*                                                                 */ 50385452
* /*  RETURN OWNER PARAMETER                                         */ 50386052
* /*                                                                 */ 50386652
* /*******************************************************************/ 50387252
*    IF ROWNER = 1 THEN                    /* OWNER SPECIFIED        */ 50387852
*    DO;                                                                50388452
*      ANS ('COWNER = IOUT;')RESCAN SKIP COL(MACCOL);                   50389052
*      ANS ('/* RETURN OWNER              */')COL(41);                  50389652
*    END;                                  /*                        */ 50391252
* /*******************************************************************/ 50398852
* /*                                                                 */ 50406452
* /*  RETURN STOKEN PARAMETER                                        */ 50414052
* /*                                                                 */ 50421652
* /*******************************************************************/ 50429252
*    IF RSTOKEN = 1 THEN                   /* STOKEN SPECIFIED       */ 50436852
*    DO;                                                                50444452
*      IF RGSTKN = 1 THEN                  /* REGISTER FORM          */ 50452052
*      DO;                                                              50459652
*        ANS (' CSTOKEN -> IFLD= ISTOKEN;')RESCAN SKIP COL(MACCOL);     50467252
*      END;                                                             50474852
*      ELSE                                                             50482452
*      DO;                                                              50490052
*        ANS ('CSTOKEN = ISTOKEN;')RESCAN SKIP COL(MACCOL);             50497652
*      END;                                                             50505252
*      ANS ('/* RETURN STOKEN             */')COL(41);                  50512852
*    END;                                  /*                        */ 50520452
* /*******************************************************************/ 50528052
* /*                                                                 */ 50535652
* /*  RETURN PART PARAMETER                                          */ 50536252
* /*                                                                 */ 50536852
* /*******************************************************************/ 50537452
*    IF RPART = 1 THEN                     /* PART SPECIFIED FOR OUTP*/ 50538052
*    DO;                                                                50538652
*      ANS ('CPART = IPART;')RESCAN SKIP COL(MACCOL);                   50539252
*      ANS ('/* RETURN PART               */')COL(41);                  50539852
*    END;                                  /*                        */ 50540452
* /*******************************************************************/ 50541052
* /*                                                                 */ 50541652
* /*  RETURN SCBADR                                                  */ 50543252
* /*                                                                 */ 50550852
* /*******************************************************************/ 50558452
*    IF RSCBADR = 1 THEN                   /* ASCBADR REQUESTED      */ 50566052
*    DO;                                                                50573652
*      ANS ('CSCBADR = IOUT;')RESCAN SKIP COL(MACCOL);                  50581252
*      ANS ('/* RETURN SCBADR             */') COL(41);                 50588852
*    END;                                  /*                        */ 50596452
* /*******************************************************************/ 50604052
* /*                                                                 */ 50611652
* /*  RETURN SIZE                                                    */ 50612252
* /*                                                                 */ 50612852
* /*******************************************************************/ 50613452
*    IF RSIZE = 1 THEN                     /* SIZE REQUESTED         */ 50614052
*    DO;                                                                50614652
*      ANS ('CSIZE = IOUT;')RESCAN SKIP COL(MACCOL);                    50615252
*      ANS ('/* RETURN SIZE               */') COL(41);                 50615852
*    END;                                  /*                        */ 50616452
* /*******************************************************************/ 50617052
* /*                                                                 */ 50617652
* /*  RELEASE REGISTERS                                              */ 50619252
* /*                                                                 */ 50626852
* /*******************************************************************/ 50634452
*    IF ISROUT = 1 THEN                                                 50641952
*      ANS ('RFY (IREG0,IREG1,IREG15)UNRSTD;')                          50649452
*            RESCAN SKIP COL(MACCOL);                                   50656952
*    ELSE                                                               50664452
*      ANS ('RFY (IREG0,IREG1,IREG14,IREG15)UNRSTD;')                   50671952
*            RESCAN SKIP COL(MACCOL);                                   50679452
* FINE:                                                                 50687552
* MEND:  RETURN CODE(0);                   /*                        */ 50700052
*%END ;                                    /*                        */ 50750052
