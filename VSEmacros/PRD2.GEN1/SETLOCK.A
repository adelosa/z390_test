*%/*                                                                    00034300
         MACRO                                                          00068600
&NAME    SETLOCK &REQUEST,&TYPE=,&MODE=,&RELATED=,                     X00102901
               &REGS=,&BRANCH=,&LOCKHLD=                                00137201
*        OS/390 API - LOCK - 5686-066-14                                00167201
.**************************************************************         00205800
.*01*  MACRO NAME = SETLOCK                                             00240100
.*                                                                      00274400
.*01*  COPYRIGHT =                                                 @L4A 00308700
.*              LICENSED MATERIALS - PROPERTY OF IBM                    00362990
.*              "RESTRICTED MATERIALS OF IBM"                           00382980
.*              5686-066                                                00402970
.*              (C)COPYRIGHT IBM CORP. 1996                             00422960
.*                                                                      00480200
.*01*  STATUS = HBB4410                                            @L4A 00514500
.*                                                                      00548800
.*01*  FUNCTION = GENERATE THE LINKAGE TO SPIN AND SUSPEND              00583100
.*                LOCK MANAGER                                          00617400
.*                                                                      00651700
.*01*  COMPONENT = SC1C5 (SUPERVISOR CONTROL)                           00686000
.*                                                                      00720300
.*01*  MACLIB = AMACLIB                                                 00754600
.*                                                                      00788900
.*02*   NOTES =                                                         00823200
.*        AR-MODE INVOKERS:                                        @L3A 00857500
.*          SYSSTATE IS USED TO TEST FOR AN AR-MODE INVOKER.            00891800
.*          FOR INSTRUCTIONS SUCH AS LM WITH NO INDEX REGISTER, THE     00926100
.*            AR OF THE BASE REGISTER IS SET BEFOREHAND.                00960400
.*          PRIMARY MODE IS ENTERED BEFORE THE CALL, AND AR-MODE        00994700
.*            IS REENTERED AFTER THE CALL.                              01029000
.*          R14 HOLDS THE PSALITA RATHER THAN R13 TO CONFORM TO THE     01063300
.*            PL/AS SUPPORT.                                            01097600
.*          FOR REGS=SAVE, THE STM IS DONE OFF R13 SINCE AR13 MUST HAVE 01131900
.*            BEEN ESTABLISHED BY AN AR-MODE INVOKER.                   01166200
.*          FOR REGS=SAVE, UPON RETURN, SINCE AR13 IS NEEDED TO DO THE  01200500
.*            LM, BUT THE ADDRESS IS IN R15 WITH THE RETURN CODE IN     01234800
.*            R13, THE TWO REGS ARE SWAPPED BEFORE DOING THE LM.        01269100
.*            THIS SAVES A STORAGE REFERENCE.                           01303400
.*          FOR LM OF ONLY 2 REGS, RATHER THAN SETTING THE AR, 2 LOADS  01337700
.*            ARE DONE SPECIFYING INDEX RATHER THAN BASE REG.           01372000
.*        WHEN REGS=STDSAVE IS SPECIFIED, ONLY GENERAL REGISTERS 2-12   01406300
.*          ARE PRESERVED.  GENERAL REGISTERS 14,15,0, AND 1 ARE NOT    01440600
.*          RESTORED BECAUSE ACCESS REGISTERS 14,15,0, AND 1 MAY NOT    01474900
.*          BE COUNTED ON ACROSS THE MACRO CALL.                        01509200
.*                                                                      01543500
.*01*  SYNTAX  =                                                        01577800
.*                                                                      01612100
.* LABEL: SETLOCK                                                       01646400
.*                                                                      01680700
.*        OBTAIN                                                        01715000
.*                                                                      01749300
.*          ,TYPE=                                                      01783601
.*                                                                      02160900
.*                CMS                                                   02195201
.*                                                                      02229500
.*                LOCAL                                                 03224201
.*                                                                      03258500
.*                                                                      04939200
.*          ,MODE=COND                                                  04973501
.*                UNCOND                                                05042101
.*                                                                      05076400
.*        < ,REGS=SAVE                                                  05110700
.*                USE                                                   05145000
.*                STDSAVE  >                                            05179300
.*                                                                      05213600
.*        < ,RELATED=VALUE  >                                           05247900
.*                                                                      05282200
.*                                                                      05831000
.*        RELEASE                                                       05865300
.*                                                                      05899600
.*          ,TYPE=                                                      05933901
.*                                                                      06379800
.*                CMS                                                   06414100
.*                                                                      07408800
.*                LOCAL                                                 07443100
.*                                                                      07477400
.*                                                                      09363900
.*        < ,REGS=SAVE                                                  09398200
.*                USE                                                   09432500
.*                STDSAVE  >                                            09466800
.*                                                                      09501100
.*        < ,RELATED=VALUE  >                                           09535400
.*                                                                      09569700
.*                                                                      09604000
.*        TEST                                                          09638300
.*                                                                      09672600
.*          ,TYPE=                                                      09706901
.*                                                                      09741200
.*                ALOCAL   < ,LOCKHLD=(SYMBOLIC REG) >                  09775500
.*                                                                      09809800
.*                CMS                                                   10152800
.*                                                                      11833500
.*                LOCAL                                                 11867800
.*                                                                      11902100
.*       < ,BRANCH=(HELD,LABEL)                                         13445600
.*                 (NOTHELD,LABEL) >                                    13479901
.*                                                                      13514200
.*       < ,RELATED=VALUE >                                             13617100
.*                                                                      13651400
.*   NOTES:                                                             13685700
.*                                                                      13720000
.*                                                                @L9A  14371700
.*                                                                      14406000
.*01*   CHANGE ACTIVITY =                                               14440300
.*    OZ35343 - CHANGE REFERENCES TO PSA LOCATIONS TO USE EXPLICIT      14474600
.*              ADDRESSABILITY SO THAT A USING PSA,0 IS NOT NEEDED TO   14508900
.*              INVOKE THE MACRO                                        14543200
.*                                                                      14577500
.*  $L1=AR       HBB3310  850801  PD16H4:  ACCESS REGISTER SUPPORT      14611800
.*  $L2=DATASPAC HBB3310  860220  PD22XB:  AR-MODE INVOKER SUPPORT      14646100
.*  $L3=DATASPAC HBB3310  860903  PD16Q4:  RSMDS LOCK                   14680400
.*  $D1=DCR0031  HBB3310  860903  PD16Q4:  IOS LOCK                     14714700
.*  $P1=PC40381  HBB3310  861101  PD16H4:  LOAD PARMS BEFORE PSALITA    14749000
.*  $P2=PC40337  HBB3310  861229  PD16Q4:  TEST FOR LOCK PARM WHEN      14783300
.*                                         TYPE=HIER IS NOT SPECIFIED   14817600
.*                                         ON TEST OPTION               14851900
.*  $L4=LOCKR    HBB4410  880715  PD16BN:  ADD STDSAVE OPTION FOR       14886200
.*                                         REGS KEYWORD                 14920500
.*  $L5=COUPL    HBB4410  880715  PD16BN:  XCFDS,XCFRES,XCFQ LOCKS      14954800
.*  $L6=CLOCK    HBB4410  870831  PD16BN:  ETRSET LOCK                  14989100
.*  $L7=JUP03    HBB4410  880715  PD16BN:  BMFLSD LOCK                  15023400
.*  $L8=LOCKR    HBB4410  870831  PD16BN:  LOCK RESTRUCTURE             15057700
.*  $P3=PEO0033  HBB4410  871026  PD16BN:  ADD SPACE AFTER COMMA ON     15092000
.*                                         SETLOCK8 INVOCATION          15126300
.*  $P4=PHB1079  HBB4410  890313  PD16BN:  PUT OUT CORRECT MNOTE FOR    15160600
.*                                         OBTAIN,TYPE=ALL              15194900
.*  $L9=USERV    FBB4418  890626  PD16EJ:  UCB SERVICES SUPPORT         15229200
.*                                         IOSULUT SPIN LOCK ADDED      15263500
.*  @D64ADTN                        :VSE/ESA COMPATIBILITY WITH MVS/ESA 15280601
.*                                                                      15297800
.*                                                                      15332100
.**************************************************************@G50EPXS 15366400
.*                                                                      15400700
.*   CMSSMF LOCK SUPPORT                                       @G741PXT 15435000
.*   CML LOCK SUPPORT                                          @G387PXR 15469300
.*   DELETE IOSCAT,IOSLCH LOCKS                                @G860PXB 15503600
.*   CHANGES FOR SALLOC LOCK BREAKUP                           @G860PXA 15537900
.*   ADD CPU LOCK                                              @G860PXA 15572200
.*   CML TEST SUPPORT                                          @G382PXR 15606500
.*   ADD TEST SUPPORT FOR THE SALLOC LOCK BREAKUP              @G860PXA 15640800
.*   SUPPORT NEW INTERFACE FOR RELEASE ALL AND RELEASE REG     @G860PXA 15675100
.*   CPU TEST SUPPORT                                          @G860PXK 15709400
.*   ADD RSMCM LOCK                                            @G860PXJ 15743700
.*   ADD TEST SUPPORT FOR TYPE=HIER                            @G860PXA 15778000
.*   ADD "MODE=(COND,IN)" SUPPORT FOR CML LOCK OBTAIN              @L1A 15812300
.*   ADD RSMDS LOCK                                                @L3A 15846600
.*   ADD IOS LOCK                                                  @D1A 15880900
.*   ADD STDSAVE                                                   @L4A 15915200
.*   ADD XCFDS, XCFRES, AND XCFQ LOCKS                             @L5A 15949500
.*   ADD ETRSET LOCK                                               @L6A 15983800
.*   ADD BMFLSD LOCK                                               @L7A 16018100
.*   ADD LOCK RESTRUCTURE SUPPORT                                  @L8A 16052400
.*   ADD IOSULUT LOCK SUPPORT                                      @L9A 16086700
.*                                                                      16121000
.**************************************************************@G860PXK 16155300
.*                                                                      16189600
         GBLC  &SYSASCE             GLOBAL FOR SYSSTATE MACRO      @L2A 16223900
         SYSSTATE TEST              OBTAIN DEFAULT SYSASCE         @L2A 16258200
.********************************************************************** 16397400
.*   CHECK FOR UNSUPPORTED KEYWORDS IN THE VSE ENVIRONMENT   @D64ADTN * 16399401
.********************************************************************** 16401400
         LCLC  &ADDR                LOCAL SETTING AS DEFAULT   @D64ADIS 16401508
         LCLC  &ASCB                LOCAL SETTING AS DEFAULT   @D64ADIS 16401608
         LCLC  &DISABLE             LOCAL SETTING AS DEFAULT   @D64ADIS 16401708
         LCLC  &LOCK                LOCAL SETTING AS DEFAULT   @D64ADIS 16401808
         LCLC  &SCOPE               LOCAL SETTING AS DEFAULT   @D64ADIS 16401908
         LCLC  &WORKREG             LOCAL SETTING AS DEFAULT   @D64ADIS 16402008
         AIF   ('&TYPE' EQ 'CMS').VSECHK1                      @D64ADTN 16404401
         AIF   ('&TYPE' EQ 'LOCAL').VSECHK1                    @D64ADTN 16405901
         AIF   ('&TYPE' EQ 'ALOCAL').VSECHK1                   @D64ADTN 16407401
         AIF   (T'&TYPE EQ 'O').ERRTYPE                        @D64ADUL 16409601
         AGO   .ERRVSE1                                        @D64ADTN 16410401
.VSECHK1 ANOP                                                  @D64ADTN 16411901
         AIF   ('&MODE' EQ '(COND,IN)').ERRVSE2                @D64ADTN 16413401
         AIF   (T'&DISABLE NE 'O').ERRDIS2                     @D64ADTN 16415401
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @D64ADTN 16417401
         AIF   (T'&LOCK NE 'O').ERRVSE3                        @D64ADTN 16419401
         AIF   (T'&WORKREG NE 'O').ERRVSE4                     @D64ADTN 16421401
.********************************************************************** 16423400
.*   CHECK FOR UNSUPPORTED KEYWORDS IN THE VSE ENVIRONMENT   @D64ADTN * 16425401
.********************************************************************** 16427400
         GBLC  &MESSAGE                                                 16429700
         LCLA  &INDEX                                              @L8C 16464000
         LCLA  &OFSET,&MASK,&BYTE                                       16498300
         LCLA  &X,&FCN,&PSAPTR                                     @L8A 16532600
         LCLA  &COBT(44),&UOBT(44),&REL(44),&RELD(44)              @L9A 16566900
         LCLC  &MESSAG2,&REG1                                      @L8C 16601200
         LCLC  &LABEL                                              @L8C 16635500
         LCLC  &LKNAMES(44)                                        @L9A 16669800
         LCLC  &GNAME1,&GNAME2,&GNAME3,&GNAME4                     @L8A 16704100
.*                                                                      16738400
.*******************************************************************    16772700
.*                                                                 *    16807000
.*       LOCK NAMES                                                *    16841300
.*                                                                 *    16875600
.*******************************************************************    16909900
.*                                                                      16944200
&LKNAMES(1)  SETC 'DISP'                                           @L8A 16978500
&LKNAMES(2)  SETC 'RSMDS'                                          @L8A 17012800
&LKNAMES(3)  SETC 'IOSUCB'                                         @L8A 17047100
&LKNAMES(4)  SETC 'IOSLCH'                                         @L8A 17081400
&LKNAMES(5)  SETC 'IOSYNCH'                                        @L8A 17115700
&LKNAMES(6)  SETC 'TPNCB'                                          @L8A 17150000
&LKNAMES(7)  SETC 'TPDNCB'                                         @L8A 17184300
&LKNAMES(8)  SETC 'TPACBDEB'                                       @L8A 17218600
&LKNAMES(9)  SETC 'ASM'                                            @L8A 17252900
&LKNAMES(10) SETC 'SALLOC'                                         @L8A 17287200
&LKNAMES(11) SETC 'SRM'                                            @L8A 17321500
&LKNAMES(12) SETC 'CMS'                                            @L8A 17355800
&LKNAMES(13) SETC 'LOCAL'                                          @L8A 17390100
&LKNAMES(14) SETC 'SPIN'                                           @L8A 17424400
&LKNAMES(15) SETC 'CMSEQDQ'                                        @L8A 17458700
&LKNAMES(16) SETC 'CMSALL'                                         @L8A 17493000
&LKNAMES(17) SETC 'ALLCMSHELD'                                     @L8A 17527300
&LKNAMES(18) SETC 'CMSSMF'                                         @L8A 17561600
&LKNAMES(19) SETC 'CML'                                            @L8A 17595900
&LKNAMES(20) SETC 'TRACE_S'                                        @L8A 17630200
&LKNAMES(21) SETC 'TRACE_E'                                        @L8A 17664500
&LKNAMES(22) SETC 'VSMPAG'                                         @L8A 17698800
&LKNAMES(23) SETC 'RSM_S'                                          @L8A 17733100
&LKNAMES(24) SETC 'RSM_E'                                          @L8A 17767400
&LKNAMES(25) SETC 'RSMAD'                                          @L8A 17801700
&LKNAMES(26) SETC 'RSMXM'                                          @L8A 17836000
&LKNAMES(27) SETC 'RSMST'                                          @L8A 17870300
&LKNAMES(28) SETC 'ASMGL'                                          @L8A 17904600
&LKNAMES(29) SETC 'VSMFIX'                                         @L8A 17938900
&LKNAMES(30) SETC 'RSMGL'                                          @L8A 17973200
&LKNAMES(31) SETC 'CPU'                                            @L8A 18007500
&LKNAMES(32) SETC 'ALL'                                            @L8A 18041800
&LKNAMES(33) SETC '(REG)'                                          @L8A 18076100
&LKNAMES(34) SETC 'RSMCM'                                          @L8A 18110400
&LKNAMES(35) SETC 'IOS_S'                                          @L8A 18144700
&LKNAMES(36) SETC 'IOS_E'                                          @L8A 18179000
&LKNAMES(37) SETC 'BMFLSD'                                         @L7A 18213300
&LKNAMES(38) SETC 'ETRSET'                                         @L6A 18247600
&LKNAMES(39) SETC 'XCFDS'                                          @L5A 18281900
&LKNAMES(40) SETC 'XCFRES'                                         @L5A 18316200
&LKNAMES(41) SETC 'XCFQ_S'                                         @L5A 18350500
&LKNAMES(42) SETC 'XCFQ_E'                                         @L5A 18384800
&LKNAMES(43) SETC 'IOSULUT_S'                                      @L9A 18419100
&LKNAMES(44) SETC 'IOSULUT_E'                                      @L9A 18453400
.*                                                                      18487700
.*******************************************************************    18522000
.*                                                                 *    18556300
.*       CONDITIONAL OBTAIN LIT OFFSETS (DECIMAL)                  *    18590600
.*                                                                 *    18624900
.*******************************************************************    18659200
.*                                                                      18693500
&COBT(1)     SETA 0           DISPATCHER LOCK                      @L8A 18727800
&COBT(2)     SETA 48          RSMDS LOCK                           @L8A 18762100
&COBT(3)     SETA 96          IOSUCB LOCK                          @L8A 18796400
&COBT(4)     SETA 144         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 18830700
&COBT(5)     SETA 192         IOSYNCH LOCK                         @L8A 18865000
&COBT(6)     SETA 240         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 18899300
&COBT(7)     SETA 288         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 18933600
&COBT(8)     SETA 336         TPACBDEB LOCK                        @L8A 18967900
&COBT(9)     SETA 384         ASM LOCK                             @L8A 19002200
&COBT(10)    SETA 432         SALLOC LOCK                          @L8A 19036500
&COBT(11)    SETA 480         SRM LOCK                             @L8A 19070800
&COBT(12)    SETA 528         CMS LOCK                             @L8A 19105100
&COBT(13)    SETA 564         LOCAL LOCK                           @L8A 19139400
&COBT(14)    SETA -1          SPIN - USED FOR RELEASE ONLY         @L8A 19173700
&COBT(15)    SETA 612         CMSEQDQ LOCK                         @L8A 19208000
&COBT(16)    SETA -1          CMSALL - COND OBTAIN NOT SUPPORTED   @L8A 19242300
&COBT(17)    SETA -1          ALL CMS LOCKS HELD- FOR RELEASE ONLY @L8A 19276600
&COBT(18)    SETA 684         CMSSMF LOCK                          @L8A 19310900
&COBT(19)    SETA 720         CML LOCK                             @L8A 19345200
&COBT(20)    SETA 756         TRACE LOCK - SHARED ENTRY            @L8A 19379500
&COBT(21)    SETA 804         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 19413800
&COBT(22)    SETA 852         VSMPAG LOCK                          @L8A 19448100
&COBT(23)    SETA 900         RSM LOCK - SHARED ENTRY              @L8A 19482400
&COBT(24)    SETA 948         RSM LOCK - EXCLUSIVE ENTRY           @L8A 19516700
&COBT(25)    SETA 996         RSMAD LOCK                           @L8A 19551000
&COBT(26)    SETA 1044        RSMXM LOCK                           @L8A 19585300
&COBT(27)    SETA 1092        RSMST LOCK                           @L8A 19619600
&COBT(28)    SETA 1140        ASMGL LOCK                           @L8A 19653900
&COBT(29)    SETA 1188        VSMFIX LOCK                          @L8A 19688200
&COBT(30)    SETA 1236        RSMGL LOCK                           @L8A 19722500
&COBT(31)    SETA 1284        CPU LOCK                             @L8A 19756800
&COBT(32)    SETA -1          ALL - USED FOR RELEASE ONLY          @L8A 19791100
&COBT(33)    SETA -1          (REG) - USED FOR RELEASE ONLY        @L8A 19825400
&COBT(34)    SETA 1356        RSMCM LOCK                           @L8A 19859700
&COBT(35)    SETA 1420        IOS LOCK - SHARED ENTRY              @L8A 19894000
&COBT(36)    SETA 1468        IOS LOCK - EXCLUSIVE ENTRY           @L8A 19928300
&COBT(37)    SETA 0           BMFLSD LOCK                          @L7A 19962600
&COBT(38)    SETA 48          ETRSET LOCK                          @L6A 19996900
&COBT(39)    SETA 96          XCFDS LOCK                           @L5A 20031200
&COBT(40)    SETA 144         XCFRES LOCK                          @L5A 20065500
&COBT(41)    SETA 192         XCFQ LOCK - SHARED ENTRY             @L5A 20099800
&COBT(42)    SETA 240         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 20134100
&COBT(43)    SETA 292         IOSULUT LOCK - SHARED ENTRY          @L9A 20168400
&COBT(44)    SETA 340         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 20202700
.*                                                                      20237000
.*******************************************************************    20271300
.*                                                                 *    20305600
.*       UNCONDITIONAL OBTAIN LIT OFFSETS (DECIMAL)                *    20339900
.*                                                                 *    20374200
.*******************************************************************    20408500
.*                                                                      20442800
&UOBT(1)     SETA 12          DISPATCHER LOCK                      @L8A 20477100
&UOBT(2)     SETA 60          RSMDS LOCK                           @L8A 20511400
&UOBT(3)     SETA 108         IOSUCB LOCK                          @L8A 20545700
&UOBT(4)     SETA 156         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 20580000
&UOBT(5)     SETA 204         IOSYNCH LOCK                         @L8A 20614300
&UOBT(6)     SETA 252         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 20648600
&UOBT(7)     SETA 300         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 20682900
&UOBT(8)     SETA 348         TPACBDEB LOCK                        @L8A 20717200
&UOBT(9)     SETA 396         ASM LOCK                             @L8A 20751500
&UOBT(10)    SETA 444         SALLOC LOCK                          @L8A 20785800
&UOBT(11)    SETA 492         SRM LOCK                             @L8A 20820100
&UOBT(12)    SETA 540         CMS LOCK                             @L8A 20854400
&UOBT(13)    SETA 576         LOCAL LOCK                           @L8A 20888700
&UOBT(14)    SETA -1          SPIN - USED FOR RELEASE ONLY         @L8A 20923000
&UOBT(15)    SETA 624         CMSEQDQ LOCK                         @L8A 20957300
&UOBT(16)    SETA 648         CMSALL                               @L8A 20991600
&UOBT(17)    SETA -1          ALL CMS LOCKS HELD- FOR RELEASE ONLY @L8A 21025900
&UOBT(18)    SETA 696         CMSSMF LOCK                          @L8A 21060200
&UOBT(19)    SETA 732         CML LOCK                             @L8A 21094500
&UOBT(20)    SETA 768         TRACE LOCK - SHARED ENTRY            @L8A 21128800
&UOBT(21)    SETA 816         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 21163100
&UOBT(22)    SETA 864         VSMPAG LOCK                          @L8A 21197400
&UOBT(23)    SETA 912         RSM LOCK - SHARED ENTRY              @L8A 21231700
&UOBT(24)    SETA 960         RSM LOCK - EXCLUSIVE ENTRY           @L8A 21266000
&UOBT(25)    SETA 1008        RSMAD LOCK                           @L8A 21300300
&UOBT(26)    SETA 1056        RSMXM LOCK                           @L8A 21334600
&UOBT(27)    SETA 1104        RSMST LOCK                           @L8A 21368900
&UOBT(28)    SETA 1152        ASMGL LOCK                           @L8A 21403200
&UOBT(29)    SETA 1200        VSMFIX LOCK                          @L8A 21437500
&UOBT(30)    SETA 1248        RSMGL LOCK                           @L8A 21471800
&UOBT(31)    SETA 1284        CPU LOCK                             @L8A 21506100
&UOBT(32)    SETA -1          ALL - USED FOR RELEASE ONLY          @L8A 21540400
&UOBT(33)    SETA -1          (REG) - USED FOR RELEASE ONLY        @L8A 21574700
&UOBT(34)    SETA 1368        RSMCM LOCK                           @L8A 21609000
&UOBT(35)    SETA 1432        IOS LOCK - SHARED ENTRY              @L8A 21643300
&UOBT(36)    SETA 1480        IOS LOCK - EXCLUSIVE ENTRY           @L8A 21677600
&UOBT(37)    SETA 12          BMFLSD LOCK                          @L7A 21711900
&UOBT(38)    SETA 60          ETRSET LOCK                          @L6A 21746200
&UOBT(39)    SETA 108         XCFDS LOCK                           @L5A 21780500
&UOBT(40)    SETA 156         XCFRES LOCK                          @L5A 21814800
&UOBT(41)    SETA 204         XCFQ LOCK - SHARED ENTRY             @L5A 21849100
&UOBT(42)    SETA 252         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 21883400
&UOBT(43)    SETA 304         IOSULUT LOCK - SHARED ENTRY          @L9A 21917700
&UOBT(44)    SETA 352         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 21952000
.*                                                                      21986300
.*******************************************************************    22020600
.*                                                                 *    22054900
.*       RELEASE LIT OFFSETS (DECIMAL)                             *    22089200
.*                                                                 *    22123500
.*******************************************************************    22157800
.*                                                                      22192100
&REL(1)      SETA 24          DISPATCHER LOCK                      @L8A 22226400
&REL(2)      SETA 72          RSMDS LOCK                           @L8A 22260700
&REL(3)      SETA 120         IOSUCB LOCK                          @L8A 22295000
&REL(4)      SETA 168         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 22329300
&REL(5)      SETA 216         IOSYNCH LOCK                         @L8A 22363600
&REL(6)      SETA 264         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 22397900
&REL(7)      SETA 312         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 22432200
&REL(8)      SETA 360         TPACBDEB LOCK                        @L8A 22466500
&REL(9)      SETA 408         ASM LOCK                             @L8A 22500800
&REL(10)     SETA 456         SALLOC LOCK                          @L8A 22535100
&REL(11)     SETA 504         SRM LOCK                             @L8A 22569400
&REL(12)     SETA 552         CMS LOCK                             @L8A 22603700
&REL(13)     SETA 588         LOCAL LOCK                           @L8A 22638000
&REL(14)     SETA 600         SPIN - RELEASE ALL SPIN LOCKS HELD   @L8A 22672300
&REL(15)     SETA 636         CMSEQDQ LOCK                         @L8A 22706600
&REL(16)     SETA 660         CMSALL                               @L8A 22740900
&REL(17)     SETA 672         ALL CMS LOCKS HELD                   @L8A 22775200
&REL(18)     SETA 708         CMSSMF LOCK                          @L8A 22809500
&REL(19)     SETA 744         CML LOCK                             @L8A 22843800
&REL(20)     SETA 780         TRACE LOCK - SHARED ENTRY            @L8A 22878100
&REL(21)     SETA 828         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 22912400
&REL(22)     SETA 876         VSMPAG LOCK                          @L8A 22946700
&REL(23)     SETA 924         RSM LOCK - SHARED ENTRY              @L8A 22981000
&REL(24)     SETA 972         RSM LOCK - EXCLUSIVE ENTRY           @L8A 23015300
&REL(25)     SETA 1020        RSMAD LOCK                           @L8A 23049600
&REL(26)     SETA 1068        RSMXM LOCK                           @L8A 23083900
&REL(27)     SETA 1116        RSMST LOCK                           @L8A 23118200
&REL(28)     SETA 1164        ASMGL LOCK                           @L8A 23152500
&REL(29)     SETA 1212        VSMFIX LOCK                          @L8A 23186800
&REL(30)     SETA 1260        RSMGL LOCK                           @L8A 23221100
&REL(31)     SETA 1296        CPU LOCK                             @L8A 23255400
&REL(32)     SETA 1308        ALL - RELEASE ALL LOCKS HELD         @L8A 23289700
&REL(33)     SETA 1332        (REG) - RELEASE LOCKS SPECIFIED      @L8A 23324000
&REL(34)     SETA 1380        RSMCM LOCK                           @L8A 23358300
&REL(35)     SETA 1444        IOS LOCK - SHARED ENTRY              @L8A 23392600
&REL(36)     SETA 1492        IOS LOCK - EXCLUSIVE ENTRY           @L8A 23426900
&REL(37)     SETA 24          BMFLSD LOCK                          @L7A 23461200
&REL(38)     SETA 72          ETRSET LOCK                          @L6A 23495500
&REL(39)     SETA 120         XCFDS LOCK                           @L5A 23529800
&REL(40)     SETA 168         XCFRES LOCK                          @L5A 23564100
&REL(41)     SETA 216         XCFQ LOCK - SHARED ENTRY             @L5A 23598400
&REL(42)     SETA 264         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 23632700
&REL(43)     SETA 316         IOSULUT LOCK - SHARED ENTRY          @L9A 23667000
&REL(44)     SETA 364         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 23701300
.*                                                                      23735600
.*******************************************************************    23769900
.*                                                                 *    23804200
.*       RELEASE DISABLED LIT OFFSETS (DECIMAL)                    *    23838500
.*                                                                 *    23872800
.*******************************************************************    23907100
.*                                                                      23941400
&RELD(1)     SETA 36          DISPATCHER LOCK                      @L8A 23975700
&RELD(2)     SETA 84          RSMDS LOCK                           @L8A 24010000
&RELD(3)     SETA 132         IOSUCB LOCK                          @L8A 24044300
&RELD(4)     SETA 180         IOSLCH LOCK - NO LONGER SUPPORTED    @L8A 24078600
&RELD(5)     SETA 228         IOSYNCH LOCK                         @L8A 24112900
&RELD(6)     SETA 276         TPNCB LOCK - NO LONGER SUPPORTED     @L8A 24147200
&RELD(7)     SETA 324         TPDNCB LOCK - NO LONGER SUPPORTED    @L8A 24181500
&RELD(8)     SETA 372         TPACBDEB LOCK                        @L8A 24215800
&RELD(9)     SETA 420         ASM LOCK                             @L8A 24250100
&RELD(10)    SETA 468         SALLOC LOCK                          @L8A 24284400
&RELD(11)    SETA 516         SRM LOCK                             @L8A 24318700
&RELD(12)    SETA -1          CMS LOCK - DISABLED NOT SUPPORTED    @L8A 24353000
&RELD(13)    SETA -1          LOCAL LOCK - DISABLED NOT SUPPORTED  @L8A 24387300
&RELD(14)    SETA 600         SPIN - RELEASE ALL SPIN LOCKS HELD   @L8A 24421600
&RELD(15)    SETA -1          CMSEQDQ LOCK - DISABLED NOT SUPPORTED@L8A 24455900
&RELD(16)    SETA -1          CMSALL - DISABLED NOT SUPPORTED      @L8A 24490200
&RELD(17)    SETA -1          ALL CMS LOCKS HELD- DISABLED NOT     @L8A 24524500
.*                            SUPPORTED                                 24558800
&RELD(18)    SETA -1          CMSSMF LOCK - DISABLED NOT SUPPORTED @L8A 24593100
&RELD(19)    SETA -1          CML LOCK - DISABLED NOT SUPPORTED    @L8A 24627400
&RELD(20)    SETA 792         TRACE LOCK - SHARED ENTRY            @L8A 24661700
&RELD(21)    SETA 840         TRACE LOCK - EXCLUSIVE ENTRY         @L8A 24696000
&RELD(22)    SETA 888         VSMPAG LOCK                          @L8A 24730300
&RELD(23)    SETA 936         RSM LOCK - SHARED ENTRY              @L8A 24764600
&RELD(24)    SETA 984         RSM LOCK - EXCLUSIVE ENTRY           @L8A 24798900
&RELD(25)    SETA 1032        RSMAD LOCK                           @L8A 24833200
&RELD(26)    SETA 1080        RSMXM LOCK                           @L8A 24867500
&RELD(27)    SETA 1128        RSMST LOCK                           @L8A 24901800
&RELD(28)    SETA 1176        ASMGL LOCK                           @L8A 24936100
&RELD(29)    SETA 1224        VSMFIX LOCK                          @L8A 24970400
&RELD(30)    SETA 1272        RSMGL LOCK                           @L8A 25004700
&RELD(31)    SETA 1296        CPU LOCK                             @L8A 25039000
&RELD(32)    SETA 1320        ALL - RELEASE ALL LOCKS HELD         @L8A 25073300
&RELD(33)    SETA 1344        (REG) - RELEASE LOCKS SPECIFIED      @L8A 25107600
&RELD(34)    SETA 1392        RSMCM LOCK                           @L8A 25141900
&RELD(35)    SETA 1456        IOS LOCK - SHARED ENTRY              @L8A 25176200
&RELD(36)    SETA 1504        IOS LOCK - EXCLUSIVE ENTRY           @L8A 25210500
&RELD(37)    SETA 36          BMFLSD LOCK                          @L7A 25244800
&RELD(38)    SETA 84          ETRSET LOCK                          @L6A 25279100
&RELD(39)    SETA 132         XCFDS LOCK                           @L5A 25313400
&RELD(40)    SETA 180         XCFRES LOCK                          @L5A 25347700
&RELD(41)    SETA 228         XCFQ LOCK - SHARED ENTRY             @L5A 25382000
&RELD(42)    SETA 276         XCFQ LOCK - EXCLUSIVE ENTRY          @L5A 25416300
&RELD(43)    SETA 328         IOSULUT LOCK - SHARED ENTRY          @L9A 25450600
&RELD(44)    SETA 376         IOSULUT LOCK - EXCLUSIVE ENTRY       @L9A 25484900
.*                                                                      25519200
.*******************************************************************    25553500
.*                                                                      25587800
&LABEL   SETC  'IHA&SYSNDX'                                    @G860PXA 25622100
&GNAME1  SETC  'IHB'.'&SYSNDX'.'K'                                 @L8A 25656400
&GNAME2  SETC  'IHB'.'&SYSNDX'.'R'                                 @L8A 25690700
&GNAME3  SETC  'IHB'.'&SYSNDX'.'T'                                 @L8A 25725000
&GNAME4  SETC  'IHB'.'&SYSNDX'.'W'                                 @L8A 25759300
&INDEX   SETA  0                                                        25827900
         AIF   ('&REQUEST' EQ 'TEST').TEST                              25862200
.*                                                                      25896500
&FCN     SETA  0                                                   @L8A 25930800
.*                                                                      25965100
         AIF   ('&REQUEST' EQ 'OBTAIN').OBTAIN                          25999400
         AIF   ('&REQUEST' NE 'RELEASE').ERRREQ                    @L8C 26033700
.*                                                                      26068000
.*******************************************************************    26102300
.*                                                                 *    26136600
.*       RELEASE PROCESSING                                        *    26170900
.*                                                                 *    26205200
.*******************************************************************    26239500
.*                                                                      26273800
         AIF   (T'&BRANCH NE 'O').ERRBR                            @L8C 26308100
         AIF   (T'&WORKREG NE 'O').ERRWK                           @L8A 26342400
         AIF   (T'&LOCK NE 'O').NOLOCK                             @L8A 26376700
         AIF   (T'&LOCKHLD NE 'O').ERRLHLD                         @L8C 26411000
         AIF   (T'&TYPE EQ 'O').ERRTYPE                        @G387PXR 26445300
         AIF   (T'&MODE NE 'O').ERRMODE                        @G387PXR 26479600
         AIF   ('&TYPE' EQ 'ALOCAL').ERRALOC                   @G387PXR 26513900
         AIF   ('&DISABLE' EQ 'DISABLED').TESTSUP  TEST FOR SUSPEND REQ 26548200
         AIF   ('&DISABLE' NE '').ERRDIS1                          @L8C 26582500
.*                                                                      26616800
.*       RELEASE WITHOUT DISABLE                                   @L8A 26651100
.*                                                                      26685400
&FCN     SETA  3                                                   @L8A 26719700
         AGO   .REGS                                               @L8A 26754000
.*                                                                      26788300
.TESTSUP ANOP                      CHECK DISABLE INVALID CASES @G860PXA 26822600
         AIF   ('&TYPE'(1,3) EQ 'CMS').ERRDIS2                 @G741PXT 26856900
         AIF   ('&TYPE' EQ 'LOCAL').ERRDIS2                             26891200
         AIF   ('&TYPE' EQ 'CML').ERRDIS2                      @G387PXR 26925500
         AIF   ('&TYPE' EQ 'CPU').ERRDIS2                      @G860PXA 26959800
.*                                                                      26994100
.*       RELEASE DISABLED                                          @L8A 27028400
.*                                                                      27062700
&FCN     SETA  4                                                   @L8A 27097000
         AGO   .REGS                                               @L8A 27131300
.*                                                                      27165600
.*******************************************************************    27199900
.*                                                                 *    27234200
.*       OBTAIN PROCESSING                                         *    27268500
.*                                                                 *    27302800
.*******************************************************************    27337100
.*                                                                      27371400
.OBTAIN  ANOP                                                           27405700
         AIF   (T'&BRANCH NE 'O').ERRBR                                 27440000
         AIF   (T'&WORKREG NE 'O').ERRWK                           @L8A 27474300
         AIF   (T'&LOCK NE 'O').NOLOCK                             @L8A 27508600
         AIF   (T'&LOCKHLD NE 'O').ERRLHLD                         @L8C 27542900
         AIF   (T'&TYPE EQ 'O').ERRTYPE                        @G837PXR 27577200
         AIF   ('&TYPE' EQ 'ALOCAL').EROALOC                   @G837PXR 27611500
         AIF   ('&DISABLE' EQ '').OBTAIN2                               27645800
         AIF   ('&DISABLE' NE 'DISABLED').ERRDIS1                       27680100
.*                                                                      27714400
.* NOTE THAT ON AN OBTAIN, TYPE=CPU, DISABLED IS NOT SUPPORTED @G860PXA 27748700
.*                                                                      27783000
         AIF   ('&TYPE' EQ 'CPU').INVDIS                           @L8C 27817300
         AGO   .MODECK                                             @L8A 27851600
.*                                                                      27885900
.OBTAIN2 ANOP                                                           27920200
         AIF   ('&TYPE' NE 'CPU').MODECK                       @G860PXA 27954500
         AIF   (T'&MODE EQ 'O').COND                           @G860PXA 27988800
         MNOTE 0,'*** MODE IGNORED WITH TYPE=CPU'              @G860PXA 28023100
         AGO   .COND                                           @G860PXA 28057400
.*                                                                      28091700
.MODECK  ANOP                                                           28126000
         AIF   ('&MODE' EQ 'COND').COND                                 28160300
         AIF   ('&MODE' EQ 'UNCOND').UNCOND                             28194600
         AIF   ('&MODE' EQ '(COND,IN)').CONDIN                     @L1A 28228900
         AIF   ('&MODE' EQ '').NOMODE                              @L8C 28263200
         AGO   .MODERR                                             @L8C 28297500
.*                                                                      28331800
.*       UNCONDITIONAL OBTAIN                                      @L8A 28366100
.*                                                                      28400400
.UNCOND  ANOP                                                      @L8A 28434700
&FCN     SETA  2                                                   @L8A 28469000
         AGO   .REGS                                               @L8A 28503300
.*                                                                      28537600
.*       CONDITIONAL OBTAIN                                        @L8A 28571900
.*                                                                      28606200
.COND    ANOP                                                           28640500
         AIF   ('&DISABLE' EQ 'DISABLED').ERRDIS3                  @L8C 28674800
&FCN     SETA  1                                                   @L8A 28709100
.*                                                                      28743400
.REGS    ANOP                                                           28777700
         AIF   ('&REGS' EQ 'SAVE').TYPE SAVE IS VALID PARAMETER         28812000
         AIF   ('&REGS' EQ 'STDSAVE').TYPE STDSAVE IS VALID        @L4A 28846300
.*                                         PARAMETER                    28880600
         AIF   ('&REGS' EQ 'USE').TYPE  USE IS VALID PARAMETER          28914900
         AIF   ('&REGS' NE '').BADREGS  INDICATE REGS IS INVALID   @L8C 28949200
.*                                                                      28983500
.TYPE    ANOP                                                           29017800
&PSAPTR  SETA  0                                                   @L8A 29052100
&X       SETA  1              UPDATE INDEX TO DISP ENTRY           @L8C 29086400
         AIF   ('&TYPE' EQ 'DISP').CODE1                       @G387PXR 29120700
&X       SETA  2              UPDATE INDEX TO RSMDS ENTRY          @L8C 29155000
         AIF   ('&TYPE' EQ 'IOSCAT').INVTYP  NOT SUPPORTED     @G860PXB 29189300
         AIF   ('&TYPE' EQ 'RSMDS').CODEA                          @L3A 29223600
&X       SETA  3              UPDATE INDEX TO IOSUCB ENTRY         @L8C 29257900
         AIF   ('&TYPE' EQ 'IOSUCB').CODEA                              29292200
&X       SETA  4              UPDATE INDEX TO IOSLCH ENTRY         @L8C 29326500
         AIF   ('&TYPE' EQ 'IOSLCH').INVTYP  NOT SUPPORTED     @G860PXB 29360800
&X       SETA  5              UPDATE INDEX TO IOSYNCH ENTRY        @L8C 29395100
         AIF   ('&TYPE' EQ 'IOSYNCH').CODEA                             29429400
&X       SETA  6              UPDATE INDEX TO TPNCB ENTRY          @L8C 29463700
         AIF   ('&TYPE' EQ 'TPNCB').INVTYP   NOT SUPPORTED         @L8C 29498000
&X       SETA  7              UPDATE INDEX TO TPDNCB ENTRY         @L8C 29532300
         AIF   ('&TYPE' EQ 'TPDNCB').INVTYP  NOT SUPPORTED         @L8C 29566600
&X       SETA  8              UPDATE INDEX TO TPACBDEB ENTRY       @L8C 29600900
         AIF   ('&TYPE' EQ 'TPACBDEB').CODEA                            29635200
&X       SETA  9              UPDATE INDEX TO ASM ENTRY            @L8C 29669500
         AIF   ('&TYPE' EQ 'ASM').CODEA                                 29703800
&X       SETA  10             UPDATE INDEX TO SALLOC ENTRY         @L8C 29738100
         AIF   ('&TYPE' EQ 'SALLOC').CODE1                     @G387PXR 29772400
&X       SETA  11             UPDATE INDEX TO SRM ENTRY            @L8C 29806700
         AIF   ('&TYPE' EQ 'SRM').CODE1                        @G387PXR 29841000
&X       SETA  12             UPDATE INDEX TO CMS ENTRY            @L8C 29875300
         AIF   ('&TYPE' EQ 'CMS').CODE1                        @G387PXR 29909600
&X       SETA  13             UPDATE INDEX TO LOCAL ENTRY          @L8C 29943900
         AIF   ('&TYPE' EQ 'LOCAL').CODE1                      @G387PXR 29978200
&X       SETA  14             UPDATE INDEX TO SPIN ENTRY           @L8C 30012500
         AIF   ('&TYPE' EQ 'SPIN').CKSPNAL                     @G860PXA 30046800
&X       SETA  15             UPDATE INDEX TO CMSEQDQ ENTRY        @L8C 30081100
         AIF   ('&TYPE' EQ 'CMSEQDQ').CODE1                    @G387PXR 30115400
&X       SETA  16             UPDATE INDEX TO CMSALL ENTRY         @L8C 30149700
         AIF   ('&TYPE' EQ 'CMSALL').CKALL                     @G741PXT 30184000
&X       SETA  18             UPDATE INDEX TO CMSSMF ENTRY         @L8C 30218300
         AIF   ('&TYPE' EQ 'CMSSMF').CODE1                     @G387PXR 30252600
&X       SETA  19             UPDATE INDEX TO CML ENTRY            @L8C 30286900
         AIF   ('&TYPE' EQ 'CML').CODE                         @G387PXR 30321200
&X       SETA  20             UPDATE INDEX TO TRACE ENTRY          @L8C 30355500
         AIF   ('&TYPE' EQ 'TRACE').SCOPE                      @G860PXA 30389800
&X       SETA  22             UPDATE INDEX TO VSMPAG ENTRY         @L8C 30424100
         AIF   ('&TYPE' EQ 'VSMPAG').CODE1                     @G860PXA 30458400
&X       SETA  23             UPDATE INDEX TO RSM ENTRY            @L8C 30492700
         AIF   ('&TYPE' EQ 'RSM').SCOPE                        @G860PXA 30527000
&X       SETA  25             UPDATE INDEX TO RSMAD ENTRY          @L8C 30561300
         AIF   ('&TYPE' EQ 'RSMAD').CODEA                      @G860PXA 30595600
&X       SETA  26             UPDATE INDEX TO RSMXM ENTRY          @L8C 30629900
         AIF   ('&TYPE' EQ 'RSMXM').CODEA                      @G860PXA 30664200
&X       SETA  27             UPDATE INDEX TO RSMST ENTRY          @L8C 30698500
         AIF   ('&TYPE' EQ 'RSMST').CODEA                      @G860PXA 30732800
&X       SETA  28             UPDATE INDEX TO ASMGL ENTRY          @L8C 30767100
         AIF   ('&TYPE' EQ 'ASMGL').CODEA                      @G860PXA 30801400
&X       SETA  29             UPDATE INDEX TO VSMFIX ENTRY         @L8C 30835700
         AIF   ('&TYPE' EQ 'VSMFIX').CODE1                     @G860PXA 30870000
&X       SETA  30             UPDATE INDEX TO RSMGL ENTRY          @L8C 30904300
         AIF   ('&TYPE' EQ 'RSMGL').CODEA                      @G860PXA 30938600
&X       SETA  31             UPDATE INDEX TO CPU ENTRY            @L8C 30972900
         AIF   ('&TYPE' EQ 'CPU').CODE1                        @G860PXA 31007200
&X       SETA  32             UPDATE INDEX TO ALL ENTRY            @L8C 31041500
         AIF   ('&TYPE' EQ 'ALL').CKSPNAL                      @G860PXA 31075800
&X       SETA  33             UPDATE INDEX TO (REG) ENTRY          @L8C 31110100
         AIF   ('&TYPE'(1,1) EQ '(').CKSPNAL                       @L8C 31144400
&X       SETA  34             UPDATE INDEX TO RSMCM ENTRY          @L8C 31178700
         AIF   ('&TYPE' EQ 'RSMCM').CODEA                      @G860PXJ 31213000
&X       SETA  35             UPDATE INDEX TO IOS ENTRY            @L8C 31247300
         AIF   ('&TYPE' EQ 'IOS').SCOPE                            @D1A 31281600
&PSAPTR  SETA  1                                                   @L8A 31315900
&X       SETA  37             UPDATE INDEX TO BMFLSD ENTRY         @L7A 31350200
         AIF   ('&TYPE' EQ 'BMFLSD').CODEA                         @L7A 31384500
&X       SETA  38             UPDATE INDEX TO ETRSET ENTRY         @L6A 31418800
         AIF   ('&TYPE' EQ 'ETRSET').CODE1                         @L6A 31453100
&X       SETA  39             UPDATE INDEX TO XCFDS ENTRY          @L5A 31487400
         AIF   ('&TYPE' EQ 'XCFDS').CODEA                          @L5A 31521700
&X       SETA  40             UPDATE INDEX TO XCFRES ENTRY         @L5A 31556000
         AIF   ('&TYPE' EQ 'XCFRES').CODEA                         @L5A 31590300
&X       SETA  41             UPDATE INDEX TO XCFQ ENTRY           @L5A 31624600
         AIF   ('&TYPE' EQ 'XCFQ').SCOPE                           @L5A 31658900
&X       SETA  43             UPDATE INDEX TO IOSULUT ENTRY        @L9A 31693200
         AIF   ('&TYPE' EQ 'IOSULUT').SCOPE                        @L9A 31727500
         AIF   ('&TYPE' NE '').INVTYP  INDICATE TYPE IS INVALID         31761800
         AGO   .NOTYP                  INDICATE TYPE NOT SPECIFIED @L8A 31796100
.*                                                                      31830400
.CKSPNAL ANOP                                                  @G860PXA 31864700
         AIF   ('&REQUEST' NE 'RELEASE').INVTYP  TYPE SPIN|ALL|    @P4C 31899000
.*                                               (REG) ONLY VALID FOR   31933300
.*                                               RELEASE                31967600
         AIF   (T'&ADDR NE 'O').ERRAD                                   32001900
         AIF   ('&TYPE' EQ 'SPIN').RSPIN                                32036200
         AIF   ('&TYPE' EQ 'ALL').RALL                                  32070500
         AIF   ('&TYPE'(K'&TYPE,1) EQ ')').RREG                         32104800
         AGO   .INVTYP                 INDICATE TYPE IS INVALID    @L8A 32139100
.*                                                                      32173400
.CKALL   ANOP                                                  @G741PXT 32207700
         AIF   ('&MODE' EQ 'COND').CNOTSUP  COND IS NOT SUPPORTED  @L8C 32242000
.*                                          FOR CMSALL REQUEST          32276300
         AGO   .CODE1                                              @L8A 32310600
.*                                                                      32344900
.SCOPE   ANOP         CHECK LOCKS THAT REQUIRE SCOPE KEYWORD   @G860PXA 32379200
         AIF   (T'&SCOPE EQ 'O').SCOPREQ                       @G860PXA 32413500
         AIF   ('&SCOPE' EQ 'SHR').CODE1A                      @G860PXA 32447800
&X       SETA  (&X+1)       UPDATE TO EXCLUSIVE ENTRY              @L8C 32482100
         AIF   ('&SCOPE' NE 'EXCL').INVSCOP                        @L8C 32516400
         AGO   .CODE1A                                             @L8A 32550700
.*                                                                      32585000
.CODE1   ANOP         CHECK CASES WHERE SCOPE IS NOT ALLOWED   @G860PXA 32619300
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 32653600
.CODE1A  ANOP                                                  @G860PXA 32687900
         AIF   (T'&ASCB NE 'O').ERRASCB  ASCB VALID FOR CML    @G860PXA 32722200
.*                                       ONLY                           32756500
.CODE    ANOP                                                      @L8A 32790800
.*                                                                      32825100
.*       CHECK THE REQUEST                                              32859400
.*                                                                      32893700
         AIF   (&FCN GT 1).ISIT2                                   @L8A 32928000
&INDEX   SETA  &COBT(&X)       CONDITIONAL OBTAIN REQUEST          @L8A 32962300
         AGO   .CONTINU                                            @L8A 32996600
.ISIT2   ANOP                                                      @L8A 33030900
         AIF   (&FCN GT 2).ISIT3                                   @L8A 33065200
&INDEX   SETA  &UOBT(&X)       UNCONDITIONAL OBTAIN REQUEST        @L8A 33099500
         AGO   .CONTINU                                            @L8A 33133800
.ISIT3   ANOP                                                      @L8A 33168100
         AIF   (&FCN GT 3).ISIT4                                   @L8A 33202400
&INDEX   SETA  &REL(&X)        RELEASE WITHOUT DISABLE REQUEST     @L8A 33236700
         AGO   .CONTINU                                            @L8A 33271000
.ISIT4   ANOP                                                      @L8A 33305300
&INDEX   SETA  &RELD(&X)       RELEASE DISABLED REQUEST            @L8A 33339600
.*                                                                      33373900
.CONTINU ANOP                                                      @L8A 33408200
         AIF   ('&ADDR' NE '').ERRAD                                    33442500
         AIF   ('&REGS' EQ 'SAVE').SAVE1                                33476800
         AIF   ('&REGS' EQ 'STDSAVE').STD1                         @L4A 33511100
         AIF   ('&REGS' EQ 'USE').USE1                                  33545400
&NAME    DS    0H                                                  @P1A 33579700
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                                33614000
         AIF   ('&TYPE' EQ 'CML').LOAD                         @G387PXR 33648300
         AIF   (&PSAPTR EQ 0).OLDLIT1                              @L8A 33682600
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 33716900
         AGO   .ARCHK1              GO CHECK FOR AR-MODE           @L8A 33751200
.OLDLIT1 ANOP                                                      @L8A 33785500
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 33819800
.ARCHK1  ANOP                                                      @L8A 33854100
         AIF   ('&SYSASCE' EQ 'P').NOAR1                           @L2A 33888400
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 33922700
.NOAR1   ANOP                                                           33957000
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L2C 33991300
*                                   PARM LIST POINTER, AND LOCK RTN     34025600
*                                   ENTRY POINT.                        34059900
         AGO   .MNLCODE                                                 34094200
.*                                                                      34128500
.SAVE1   ANOP                                                           34162800
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS              34197100
         STM   11,14,0(13)          SAVE REGISTERS                 @L2C 34231400
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                                34265700
         AIF   ('&TYPE' EQ 'CML').LOAD                         @G387PXR 34300000
         AIF   (&PSAPTR EQ 0).OLDLIT2                              @L8A 34334300
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 34368600
         AGO   .ARCHK2                                             @L8A 34402900
.OLDLIT2 ANOP                                                      @L8A 34437200
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 34471500
.ARCHK2  ANOP                                                      @L8A 34505800
         AIF   ('&SYSASCE' EQ 'P').NOAR3                           @L2A 34540100
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 34574400
.NOAR3   ANOP                                                           34608700
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L2C 34643000
*                                   PARM LIST POINTER, AND LOCK RTN     34677300
*                                   ENTRY POINT.                        34711600
         AGO   .MNLCODE                                                 34745900
.*                                                                      34780200
.STD1    ANOP                                                      @L4A 34814500
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 34848800
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 34883100
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                           @L4A 34917400
         AIF   ('&TYPE' EQ 'CML').LOAD                             @L4A 34951700
         AIF   (&PSAPTR EQ 0).OLDLIT3                              @L8A 34986000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 35020300
         AGO   .ARCHK3                                             @L8A 35054600
.OLDLIT3 ANOP                                                      @L8A 35088900
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L4A 35123200
.ARCHK3  ANOP                                                      @L8A 35157500
         AIF   ('&SYSASCE' EQ 'P').NOAR4                           @L4A 35191800
         LAE   14,0(14,0)           GET ALET OF 0                  @L4A 35226100
.NOAR4   ANOP                                                      @L4A 35260400
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L4A 35294700
*                                   PARM LIST POINTER, AND LOCK RTN     35329000
*                                   ENTRY POINT.                        35363300
         AGO   .MNLCODE                                                 35397600
.*                                                                      35431900
.USE1    ANOP                                                           35466200
&NAME    LR    15,11                SAVE REGISTER 11                    35500500
         LR    0,12                 SAVE REGISTER 12                    35534800
         LR    1,13                 SAVE REGISTER 13                    35569100
         AIF   ('&TYPE' EQ 'LOCAL').LOAD                                35603400
         AIF   ('&TYPE' EQ 'CML').LOAD                         @G387PXR 35637700
         AIF   (&PSAPTR EQ 0).OLDLIT4                              @L8A 35672000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 35706300
         AGO   .ARCHK4                                             @L8A 35740600
.OLDLIT4 ANOP                                                      @L8A 35774900
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 35809200
.ARCHK4  ANOP                                                      @L8A 35843500
         AIF   ('&SYSASCE' EQ 'P').NOAR5                           @L2A 35877800
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 35912100
.NOAR5   ANOP                                                           35946400
         LM    11,13,&INDEX.(14)    LOAD ADDRESS OF THE LOCKWORD,  @L2C 35980700
*                                   PARM LIST POINTER, AND LOCK RTN     36015000
*                                   ENTRY POINT.                        36049300
         AGO   .MNLCODE                                                 36083600
.LOAD    ANOP                                                           36117900
         AIF   ('&TYPE' EQ 'CML').CODEB                                 36152200
.*                                                                      36186500
.*       TYPE IS LOCAL                                         @G387PXR 36220800
.*                                                                      36255100
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 36289400
         L     13,&INDEX.+8(14,0)   LOAD ADDRESS OF LOCK RTN       @L8C 36323700
         AGO   .MNLCODE                                                 36358000
.*                                                                      36392300
.CODEB   ANOP                                                  @G387PXR 36426600
.*                                                                      36460900
.*       TYPE IS CML                                                    36495200
.*                                                                      36529500
         AIF   (T'&ASCB EQ 'O').ASCBREQ                        @G387PXR 36563800
         AIF   ('&ASCB' EQ '(11)').CMLR11                      @G387PXR 36598100
         AIF   ('&ASCB'(1,1) EQ '(').ERREG2                    @G387PXR 36632400
         L     11,&ASCB                                            @L8C 36666700
.CMLR11  ANOP                                                  @G387PXR 36701000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 36735300
         L     13,&INDEX.+8(14,0)   LOAD ADDRESS OF LOCK RTN       @L8C 36769600
         AGO   .MNLCODE                                        @G387PXR 36803900
.*                                                                      36838200
.CODEA   ANOP                                                           36872500
.*                                                                      36906800
.*  SCOPE KEYWORD IS NOT ALLOWED FOR LOCKS IN THIS PATH       @G860PXA  36941100
.*                                                                      36975400
.*       CHECK THE REQUEST                                              37009700
.*                                                                      37044000
         AIF   (&FCN GT 1).CHECK2                                  @L8A 37078300
&INDEX   SETA  &COBT(&X)       CONDITIONAL OBTAIN REQUEST          @L8A 37112600
         AGO   .DOMORE                                             @L8A 37146900
.CHECK2  ANOP                                                      @L8A 37181200
         AIF   (&FCN GT 2).CHECK3                                  @L8A 37215500
&INDEX   SETA  &UOBT(&X)       UNCONDITIONAL OBTAIN REQUEST        @L8A 37249800
         AGO   .DOMORE                                             @L8A 37284100
.CHECK3  ANOP                                                      @L8A 37318400
         AIF   (&FCN GT 3).CHECK4                                  @L8A 37352700
&INDEX   SETA  &REL(&X)        RELEASE WITHOUT DISABLE REQUEST     @L8A 37387000
         AGO   .DOMORE                                             @L8A 37421300
.CHECK4  ANOP                                                      @L8A 37455600
&INDEX   SETA  &RELD(&X)       RELEASE DISABLED REQUEST            @L8A 37489900
.*                                                                      37524200
.DOMORE  ANOP                                                      @L8A 37558500
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 37592800
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G387PXR 37627100
.CODEA1  ANOP                      LOCK ADDRESS ALREADY LOADED @G387PXR 37661400
         AIF   ('&ADDR' EQ '(11)').MR11                        @G387PXR 37695700
         AIF   ('&ADDR' EQ '').ADDREQ                              @L8C 37730000
.ADRLA   ANOP                                                           37764300
         AIF   ('&ADDR'(1,1) EQ '(').ERREG1                             37798600
         AIF   ('&REGS' EQ 'SAVE').SAVE2                                37832900
         AIF   ('&REGS' EQ 'STDSAVE').STD2                         @L4A 37867200
         AIF   ('&REGS' EQ 'USE').USE2                                  37901500
&NAME    LA    11,&ADDR             LOCKWORD ADDRESS                    37935800
         AIF   (&PSAPTR EQ 0).OLDLIT5                              @L8A 37970100
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 38004400
         AGO   .ARCHK5                                             @L8A 38038700
.OLDLIT5 ANOP                                                      @L8A 38073000
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 38107300
.ARCHK5  ANOP                                                      @L8A 38141600
         AIF   ('&SYSASCE' EQ 'P').NOAR6                           @L2A 38175900
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 38210200
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 38244500
         AGO   .MNLCODE                                            @L2A 38278800
.NOAR6   ANOP                                                           38313100
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 38347400
*                                   RTN ENTRY POINT.                    38381700
         AGO   .MNLCODE                                                 38416000
.SAVE2   ANOP                                                           38450300
.*                                                                      38484600
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS              38518900
         STM   11,14,0(13)          SAVE REGISTERS                 @L2A 38553200
         LA    11,&ADDR             LOCKWORD ADDRESS                    38587500
         AIF   (&PSAPTR EQ 0).OLDLIT6                              @L8A 38621800
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 38656100
         AGO   .ARCHK6                                             @L8A 38690400
.OLDLIT6 ANOP                                                      @L8A 38724700
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 38759000
.ARCHK6  ANOP                                                      @L8A 38793300
         AIF   ('&SYSASCE' EQ 'P').NOAR9                           @L2A 38827600
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 38861900
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 38896200
         AGO   .MNLCODE                                            @L2A 38930500
.NOAR9   ANOP                                                           38964800
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 38999100
*                                   RTN ENTRY POINT.                    39033400
         AGO   .MNLCODE                                                 39067700
.*                                                                      39102000
.STD2    ANOP                                                      @L4A 39136300
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 39170600
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 39204900
         LA    11,&ADDR             LOCKWORD ADDRESS               @L4A 39239200
         AIF   (&PSAPTR EQ 0).OLDLIT7                              @L8A 39273500
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 39307800
         AGO   .ARCHK7                                             @L8A 39342100
.OLDLIT7 ANOP                                                      @L8A 39376400
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L4A 39410700
.ARCHK7  ANOP                                                      @L8A 39445000
         AIF   ('&SYSASCE' EQ 'P').NOAR10                          @L4A 39479300
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 39513600
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 39547900
         AGO   .MNLCODE                                            @L4A 39582200
.NOAR10  ANOP                                                      @L4A 39616500
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 39650800
*                                   RTN ENTRY POINT.                    39685100
         AGO   .MNLCODE                                                 39719400
.*                                                                      39753700
.USE2    ANOP                                                           39788000
&NAME    LR    15,11                SAVE REGISTER 11                    39822300
         LR    0,12                 SAVE REGISTER 12                    39856600
         LR    1,13                 SAVE REGISTER 13                    39890900
         LA    11,&ADDR             LOCKWORD ADDRESS                    39925200
         AIF   (&PSAPTR EQ 0).OLDLIT8                              @L8A 39959500
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 39993800
         AGO   .ARCHK8                                             @L8A 40028100
.OLDLIT8 ANOP                                                      @L8A 40062400
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 40096700
.ARCHK8  ANOP                                                      @L8A 40131000
         AIF   ('&SYSASCE' EQ 'P').NOAR11                          @L2A 40165300
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 40199600
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 40233900
         AGO   .MNLCODE                                            @L2A 40268200
.NOAR11  ANOP                                                           40302500
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 40336800
*                                   RTN ENTRY POINT.                    40371100
         AGO   .MNLCODE                                                 40405400
.*                                                                      40439700
.MR11    ANOP                                                           40474000
         AIF   ('&REGS' EQ 'SAVE').SAVE3                                40508300
         AIF   ('&REGS' EQ 'STDSAVE').STD3                         @L4A 40542600
         AIF   ('&REGS' EQ 'USE').USE3                                  40576900
         AIF   (&PSAPTR EQ 0).OLDLIT9                              @L8A 40611200
&NAME    L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 40645500
         AGO   .ARCHK9                                             @L8A 40679800
.OLDLIT9 ANOP                                                      @L8A 40714100
&NAME    L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 40748400
.ARCHK9  ANOP                                                      @L8A 40782700
         AIF   ('&SYSASCE' EQ 'P').NOAR13                          @L2A 40817000
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 40851300
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 40885600
         AGO   .MNLCODE                                            @L8C 40919900
.NOAR13  ANOP                                                           40954200
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 40988500
*                                   RTN ENTRY POINT.                    41022800
         AGO   .MNLCODE                                                 41057100
.*                                                                      41091400
.SAVE3   ANOP                                                           41125700
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS              41160000
         STM   11,14,0(13)          SAVE REGISTERS                 @L2A 41194300
         AIF   (&PSAPTR EQ 0).OLDLITA                              @L8A 41228600
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 41262900
         AGO   .ARCHKA                                             @L8A 41297200
.OLDLITA ANOP                                                      @L8A 41331500
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 41365800
.ARCHKA  ANOP                                                      @L8A 41400100
         AIF   ('&SYSASCE' EQ 'P').NOAR15                          @L2A 41434400
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 41468700
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 41503000
         AGO   .MNLCODE                                            @L2A 41537300
.NOAR15  ANOP                                                           41571600
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 41605900
*                                   RTN ENTRY POINT.                    41640200
         AGO   .MNLCODE                                                 41674500
.*                                                                      41708800
.STD3    ANOP                                                      @L4A 41743100
&NAME    LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 41777400
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 41811700
         AIF   (&PSAPTR EQ 0).OLDLITB                              @L8A 41846000
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 41880300
         AGO   .ARCHKB                                             @L8A 41914600
.OLDLITB ANOP                                                      @L8A 41948900
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L4A 41983200
.ARCHKB  ANOP                                                      @L8A 42017500
         AIF   ('&SYSASCE' EQ 'P').NOAR16                          @L4A 42051800
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 42086100
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 42120400
         AGO   .MNLCODE                                            @L4A 42154700
.NOAR16  ANOP                                                      @L4A 42189000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 42223300
*                                   RTN ENTRY POINT.                    42257600
         AGO   .MNLCODE                                                 42291900
.*                                                                      42326200
.USE3    ANOP                                                           42360500
&NAME    LR    15,11                SAVE REGISTER 11                    42394800
         LR    0,12                 SAVE REGISTER 12                    42429100
         LR    1,13                 SAVE REGISTER 13                    42463400
         AIF   (&PSAPTR EQ 0).OLDLITC                              @L8A 42497700
         L     14,PSALIT2-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 42532000
         AGO   .ARCHKC                                             @L8A 42566300
.OLDLITC ANOP                                                      @L8A 42600600
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 42634900
.ARCHKC  ANOP                                                      @L8A 42669200
         AIF   ('&SYSASCE' EQ 'P').NOAR17                          @L2A 42703500
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L8C 42737800
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L8C 42772100
         AGO   .MNLCODE                                            @L2A 42806400
.NOAR17  ANOP                                                           42840700
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM POINTER AND LOCK   @L8C 42875000
*                                   RTN ENTRY POINT.                    42909300
.*                                                                      42943600
.MNLCODE ANOP                                                           42977900
         AIF   ('&MODE' EQ 'UNCOND').BALCK                              43012200
.*                                                                      43046500
.MNLCOD2 ANOP                                                           43080800
         AIF   ('&SYSASCE' EQ 'P').NOAR36                          @L2A 43115100
         SAC   0                    PRIMARY MODE                   @L2A 43149400
.NOAR36  ANOP                                                           43183700
         AIF   (&PSAPTR EQ 0).NONOTE1                              @L8A 43218000
*        NOTE: THIS LOCK SUPPORTED IN 31-BIT AMODE ONLY            @L8A 43252300
.NONOTE1 ANOP                                                      @L8A 43286600
         BALR  14,13                BRANCH ENTER LOCK ROUTINE           43320900
         AIF   ('&SYSASCE' EQ 'P').NOAR37                          @L2A 43355200
         SAC   X'200'               AR MODE                        @L2A 43389500
.NOAR37  ANOP                                                           43423800
         AGO   .MNLCOD3                                                 43458100
.*                                                                      43492400
.BALCK   ANOP                                                           43526700
         AIF   ('&DISABLE' EQ '').MNLCOD2                               43561000
         AIF   ('&TYPE' EQ 'LOCAL').ERRDIS3                             43595300
         AIF   ('&TYPE' EQ 'CML').ERRDIS3                      @G387PXR 43629600
         AIF   ('&TYPE'(1,3) EQ 'CMS').ERRDIS3                 @G741PXT 43663900
         AIF   ('&SYSASCE' EQ 'P').NOAR42                          @L2A 43698200
         SAC   0                    PRIMARY MODE                   @L2A 43732500
.NOAR42  ANOP                                                           43766800
         AIF   (&PSAPTR EQ 0).NONOTE2                              @L8A 43801100
*                                                                       43835400
*        NOTE: THIS LOCK SUPPORTED IN 31-BIT AMODE ONLY            @L8A 43869700
.NONOTE2 ANOP                                                      @L8A 43904000
         BAL   14,4(0,13)           BRANCH TO LOCK RTN AT DISABLED      43938300
*                                   ENTRY POINT                         43972600
*        NOTE: YOU HAVE JUST SAID THAT YOU ARE DISABLED                 44006900
         AIF   ('&SYSASCE' EQ 'P').NOAR43                          @L2A 44041200
         SAC   X'200'               AR MODE                        @L2A 44075500
.NOAR43  ANOP                                                           44109800
.*                                                                      44144100
.MNLCOD3 ANOP                                                           44178400
         AIF   ('&REGS' EQ 'SAVE').SAVE4                                44212700
         AIF   ('&REGS' EQ 'STDSAVE').STD4                         @L4A 44247000
         AIF   ('&REGS' NE 'USE').ENDIT                                 44281300
         LR    11,15                RESTORE REGISTER 11                 44315600
         LR    15,13                PUT RETURN CODE IN REGISTER 15      44349900
         LR    12,0                 RESTORE REGISTER 12                 44384200
         LR    13,1                 RESTORE REGISTER 13                 44418500
         MEXIT                                                          44452800
.*                                                                      44487100
.SAVE4   ANOP                                                           44521400
.LMEXIT  LR    12,13                SWAP REGISTERS                 @L4C 44555700
         LR    13,15                               R13 AND         @L4C 44590000
         LR    15,12                                       R15     @L4C 44624300
         LM    11,14,0(13)          RESTORE REGS                   @L2C 44658600
         MEXIT                                                          44692900
.*                                                                      44727200
.STD4    ANOP                                                      @L4A 44761500
.LM1EXIT LR    12,13                SWAP REGISTERS                 @L4A 44795800
         LR    13,15                               R13 AND         @L4A 44830100
         LR    15,12                                       R15     @L4A 44864400
         LM    2,12,28(13)          RESTORE REGS PRESERVING        @L4A 44898700
*                                   THE RETURN CODE IN R15              44933000
         MEXIT                                                          44967300
.*                                                                      45001600
.*******************************************************************    45035900
.*       PROCESS "COND,IN" REQUEST FOR CML LOCK ONLY               *    45070200
.*******************************************************************    45104500
.*                                                                      45138800
.CONDIN  ANOP                                                      @L1A 45173100
         AIF   ('&TYPE' NE 'CML').CONDINC  COND,IN REQUEST VALID   @L1A 45207400
.*                                         ONLY FOR CML LOCK OBTAIN     45241700
.*                                                                      45276000
         AIF   (T'&DISABLE NE 'O').ERRDIS3 DISABLED IS NOT VALID   @L1A 45310300
.*                                         FOR CONDITIONAL OBTAIN       45344600
         AIF   (T'&SCOPE NE 'O').NOSCOPE   SCOPE IS INVALID        @L1A 45378900
.*                                                                      45413200
         AIF   (T'&ADDR NE 'O').ERRAD      ADDR IS INVALID         @L1A 45447500
.*                                                                      45481800
         AIF   (T'&ASCB EQ 'O').ASCBREQ    ASCB MUST BE SPECIFIED  @L1A 45516100
.*                                                                      45550400
         AIF   ('&ASCB' EQ '(11)').CONDIN0 ASCB=(11) IS OK         @L1A 45584700
         AIF   ('&ASCB'(1,1) EQ '(').ERREG2  ASCB MUST NOT BE A    @L1A 45619000
.*                                         REGISTER EXCEPT (11)         45653300
.*                                                                      45687600
.CONDIN0 ANOP                                                      @L1A 45721900
         AIF   (T'&NAME EQ 'O').CONDIN1    BRANCH IF LABEL WAS NOT @L1A 45756200
.*                                         SPECIFIED                    45790500
&NAME    DS    0H                                                  @L1A 45824800
.*                                                                      45859100
.CONDIN1 ANOP                                                      @L1A 45893400
         AIF   ('&REGS' EQ 'SAVE').CONDIN2                         @L1A 45927700
         AIF   ('&REGS' EQ 'STDSAVE').CONDIN2A                     @L4A 45962000
         AIF   ('&REGS' EQ 'USE').CONDIN3                          @L1A 45996300
         AIF   (T'&REGS EQ 'O').CONDIN4                            @L1A 46030600
.*                                                                      46064900
         AGO   .BADREGS                    REGS PARAMETER IS BAD   @L1A 46099200
.*                                                                      46133500
.*                                                                      46167800
.CONDIN2 ANOP                                                      @L1A 46202100
         LR    15,13                LOAD SAVE AREA ADDRESS         @L1A 46236400
         STM   11,14,0(13)          SAVE REGISTERS                 @L2C 46270700
         AGO   .CONDIN4                                                 46305000
.*                                                                      46339300
.CONDIN2A ANOP                                                     @L4A 46373600
         LR    15,13                LOAD SAVE AREA ADDRESS         @L4A 46407900
         STM   14,12,12(13)         SAVE REGISTERS                 @L4A 46442200
         AGO   .CONDIN4                                            @L4A 46476500
.*                                                                      46510800
.CONDIN3 ANOP                                                      @L1A 46545100
         LR    15,11                SAVE REGISTER 11               @L1A 46579400
         LR    0,12                 SAVE REGISTER 12               @L1A 46613700
         LR    1,13                 SAVE REGISTER 13               @L1A 46648000
.*                                                                      46682300
.CONDIN4 ANOP                                                      @L1A 46716600
         AIF   ('&ASCB' EQ '(11)').CONDIN4A BRANCH IF ASCB IN R11  @P1A 46750900
.*                                                                      46785200
         L     11,&ASCB             LOAD ASCB ADDRESS              @L1A 46819500
.*                                                                      46853800
.CONDIN4A ANOP                                                     @P1A 46888100
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @P1A 46922400
         L     13,1416(14,0)        LOCK ROUTINE ENTRY POINT       @L2C 46956700
.*                                                                      46991000
         AGO   .MNLCOD2                                            @L1A 47025300
.*                                                                      47059600
.*                                                                      47093900
.*******************************************************************    47128200
.*       BEGINNING OF RELEASE TYPE=(REG) PROCESSING                *    47162500
.*******************************************************************    47196800
.*                                                                      47231100
.RREG    ANOP                                                           47265400
         AIF   ('&DISABLE' EQ 'DISABLED').STDIS                    @L8C 47299700
&INDEX   SETA  &REL(&X)                    RELEASE LOCKS ENABLED   @L8A 47334000
         AGO   .ASCBS                                                   47368300
.*                                                                      47402600
.STDIS   ANOP                              RELEASE LOCKS DISABLED  @L8A 47436900
&INDEX   SETA  &RELD(&X)                                           @L8A 47471200
.*                                                                      47505500
.ASCBS   ANOP                                                      @L8A 47539800
         AIF   (T'&ASCB NE 'O').RREGASI                            @L8C 47574100
         AIF   (T'&LOCKHLD NE 'O').RREGLKH                         @L8C 47608400
.*                                                                      47642700
         AIF   ('&NAME' EQ '').RREGNN                              @L8C 47677000
&NAME    DC    0H'0'                                           @G860PXA 47711300
.RREGNN  ANOP                                                           47745600
         AIF   (T'&REGS EQ 'O').RREG4                          @G860PXA 47779900
         AIF   ('&REGS' EQ 'SAVE').RREG3                       @G860PXA 47814200
         AIF   ('&REGS' EQ 'STDSAVE').RREG3A                       @L4A 47848500
.*                                                                      47882800
.*  REGS=USE SPECIFIED                                                  47917100
.*                                                                      47951400
         LR    15,11                SAVE REG 11                @G860PXA 47985700
         LR    0,12                 SAVE REG 12                         48020000
         LR    1,13                 SAVE REG 13                         48054300
         AGO   .RREG4                                          @G860PXA 48088600
.*                                                                      48122900
.RREG3   ANOP                                                      @L8A 48157200
         LR    15,13                SAVE AREA ADDRESS          @G860PXA 48191500
         STM   11,14,0(13)          SAVE REGS 11 THRU 14           @L2C 48225800
         AGO   .RREG4                                              @L4A 48260100
.*                                                                      48294400
.RREG3A  ANOP                                                      @L8A 48328700
         LR    15,13                SAVE AREA ADDRESS              @L4A 48363000
         STM   14,12,12(13)         SAVE REGS 14 THRU 12           @L4A 48397300
.*                                                                      48431600
.RREG4   ANOP                                                      @L8A 48465900
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 48500200
         AIF   ('&SYSASCE' EQ 'P').NOAR35                          @L2A 48534500
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 48568800
.NOAR35  ANOP                                                      @L8A 48603100
         AIF   ('&TYPE' EQ '(11)').RREG50                      @ZMC0388 48637400
         LR    11,&TYPE(1)          PUT STRING IN PROPER REG   @G860PXA 48671700
.RREG50  ANOP                                                      @L8A 48706000
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM & EP ADDR          @L2C 48740300
         AIF   ('&SYSASCE' EQ 'P').NOAR46                          @L2A 48774600
         SAC   0                    PRIMARY MODE                   @L2A 48808900
.NOAR46  ANOP                                                      @L8A 48843200
         BALR  14,13                LINK TO LOCK RTN           @G387PXR 48877500
         AIF   ('&SYSASCE' EQ 'P').NOAR47                          @L2A 48911800
         SAC   X'200'               AR MODE                        @L2A 48946100
.NOAR47  ANOP                                                      @L8A 48980400
         AIF   (T'&REGS EQ 'O').RREG9                          @G860PXA 49014700
         AIF   ('&REGS' EQ 'SAVE').LMEXIT                          @L2C 49049000
         AIF   ('&REGS' EQ 'STDSAVE').LM1EXIT                      @L4A 49083300
.*                                                                      49117600
.*   REGS=USE SPECIFIED                                                 49151900
.*                                                                      49186200
         LR    11,15                RESTORE REG 11             @G860PXA 49220500
         LR    15,13                PUT RETURN CODE IN REG 15  @ZMC0683 49254800
         LR    12,0                 RESTORE REG 12             @G860PXA 49289100
         LR    13,1                 RESTORE REG 13             @G860PXA 49323400
.*                                                                      49357700
.RREG9   ANOP                                                      @L8A 49392000
         MEXIT                                                 @G860PXA 49426300
.*                                                                      49460600
.*******************************************************************    49494900
.*       BEGINNING OF RELEASE ALL PROCESSING                       *    49529200
.*******************************************************************    49563500
.*                                                                      49597800
.RALL    ANOP                                                           49632100
         AIF   ('&DISABLE' EQ 'DISABLED').SETDIS                   @L8C 49666400
&INDEX   SETA  &REL(&X)                    RELEASE ALL ENABLED     @L8A 49700700
         AGO   .ASCBCK                                             @L8A 49735000
.*                                                                      49769300
.SETDIS  ANOP                              RELEASE ALL DISABLED    @L8A 49803600
&INDEX   SETA  &RELD(&X)                                           @L8A 49837900
.*                                                                      49872200
.ASCBCK  ANOP                                                      @L8A 49906500
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 49940800
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                         @L8C 49975100
.*                                                                      50009400
         AIF   ('&NAME' EQ '').RALLNN                          @G860PXA 50043700
&NAME    DC    0H'0'                                                    50078000
.RALLNN  ANOP                                                      @L8A 50112300
         AIF   (T'&REGS EQ 'O').RALL4                          @G860PXA 50146600
         AIF   ('&REGS' EQ 'SAVE').RALL3                       @G860PXA 50180900
         AIF   ('&REGS' EQ 'STDSAVE').RALL3A                       @L4A 50215200
.*                                                                      50249500
.*  REGS=USE SPECIFIED                                                  50283800
.*                                                                      50318100
         LR    15,11                SAVE REG 11                @G860PXA 50352400
         LR    0,12                 SAVE REG 12                         50386700
         LR    1,13                 SAVE REG 13                         50421000
         AGO   .RALL4                                          @G860PXA 50455300
.*                                                                      50489600
.RALL3   ANOP                                                      @L8A 50523900
         LR    15,13                SAVE AREA ADDRESS          @G860PXA 50558200
         STM   11,14,0(13)          SAVE REGS 11 THRU 14           @L2C 50592500
         AGO   .RALL4                                              @L4A 50626800
.*                                                                      50661100
.RALL3A  ANOP                                                      @L8A 50695400
         LR    15,13                SAVE AREA ADDRESS              @L4A 50729700
         STM   14,12,12(13)         SAVE REGS 14 THRU 12           @L4A 50764000
.*                                                                      50798300
.RALL4   ANOP                                                      @L8A 50832600
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 50866900
         AIF   ('&SYSASCE' EQ 'P').NOAR33                          @L2A 50901200
         LAE   14,0(14,0)           GET ALET OF 0                  @L2A 50935500
.*                                                                      50969800
.NOAR33  ANOP                                                           51004100
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM & EP ADDR          @L2C 51038400
         AIF   ('&SYSASCE' EQ 'P').NOAR38                          @L2A 51072700
         SAC   0                    PRIMARY MODE                   @L2A 51107000
.*                                                                      51141300
.NOAR38  ANOP                                                           51175600
         BALR  14,13                LINK TO LOCK RTN           @G387PXR 51209900
         AIF   ('&SYSASCE' EQ 'P').NOAR39                          @L2A 51244200
         SAC   X'200'               AR MODE                        @L2A 51278500
.*                                                                      51312800
.NOAR39  ANOP                                                           51347100
         AIF   (T'&REGS EQ 'O').RALL9                          @G860PXA 51381400
         AIF   ('&REGS' EQ 'SAVE').LMEXIT                          @L2C 51415700
         AIF   ('&REGS' EQ 'STDSAVE').LM1EXIT                      @L4A 51450000
.*                                                                      51484300
.*  REGS=USE SPECIFIED                                                  51518600
.*                                                                      51552900
         LR    11,15                RESTORE REG 11             @G860PXA 51587200
         LR    15,13                PUT RETURN CODE IN REG 15  @ZMC0683 51621500
         LR    12,0                 RESTORE REG 12             @G860PXA 51655800
         LR    13,1                 RESTORE REG 13             @G860PXA 51690100
.*                                                                      51724400
.RALL9   ANOP                                                  @G860PXA 51758700
         MEXIT                                                          51793000
.*                                                                      51827300
.*******************************************************************    51861600
.*       BEGINNING OF RELEASE TYPE=SPIN PROCESSING                 *    51895900
.*******************************************************************    51930200
.*                                                                      51964500
.RSPIN   ANOP                                                           51998800
         AIF   ('&DISABLE' EQ 'DISABLED').SETDIS2                  @L8C 52033100
&INDEX   SETA  &REL(&X)           RELEASE SPIN LOCKS ENABLED       @L8A 52067400
         AGO   .NAMECK                                             @L8A 52101700
.*                                                                      52136000
.SETDIS2 ANOP                     RELEASE SPIN LOCKS DISABLED      @L8A 52170300
&INDEX   SETA  &RELD(&X)                                           @L8A 52204600
.*                                                                      52238900
.NAMECK  ANOP                                                      @L8A 52273200
         AIF   ('&NAME' EQ '').RSPINNN                                  52307500
&NAME    DC    0H'0'                                                    52341800
.RSPINNN AIF   (T'&REGS EQ 'O').RSPINC                                  52376100
         AIF   ('&REGS' EQ 'SAVE').RSPINS                               52410400
         AIF   ('&REGS' EQ 'STDSAVE').RSPINS1                      @L4A 52444700
         LR    15,11                SAVE REG 11                         52479000
         LR    0,12                 SAVE REG 12                         52513300
         LR    1,13                 SAVE REG 13                         52547600
         AGO   .RSPINC                                                  52581900
.RSPINS  ANOP                                                           52616200
         LR    15,13                SAVE AREA ADDRESS                   52650500
         STM   11,14,0(13)          SAVE REGS 11 THRU 14           @L2C 52684800
         AGO   .RSPINC                                             @L4A 52719100
.RSPINS1 ANOP                                                      @L4A 52753400
         LR    15,13                SAVE AREA ADDRESS              @L4A 52787700
         STM   14,12,12(13)         SAVE REGS 14 THRU 12           @L4A 52822000
.RSPINC  ANOP                                                           52856300
         AIF   (T'&DISABLE EQ 'O').RSPINE                      @ZMC0587 52890600
         MVI   PSAMPSW-PSA(0),X'00' INDICATE RETURN DISABLED   @ZMC0587 52924900
         AGO   .RSPINR                                         @ZMC0587 52959200
.RSPINE  ANOP                                                  @ZMC0587 52993500
         MVI   PSAMPSW-PSA(0),X'03' INDICATE RETURN ENABLED    @ZMC0587 53027800
.RSPINR  ANOP                                                  @ZMC0587 53062100
         L     14,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L2C 53096400
         AIF   ('&SYSASCE' EQ 'P').NOAR34                          @L2A 53130700
         L     12,&INDEX.+4(14,0)   OBTAIN PARM POINTER            @L2A 53165000
         L     13,&INDEX.+8(14,0)   OBTAIN ENTRY POINT             @L2A 53199300
         SAC   0                    PRIMARY MODE                   @L2A 53233600
         AGO   .AR34                                               @L2A 53267900
.NOAR34  ANOP                                                           53302200
         LM    12,13,&INDEX.+4(14)  OBTAIN PARM & EP ADDRESS       @L2C 53336500
.AR34    BALR  14,13                LINK TO LOCK MANAGER                53370800
         AIF   ('&SYSASCE' EQ 'P').NOAR41                          @L2A 53405100
         SAC   X'200'               AR MODE                        @L2A 53439400
.NOAR41  ANOP                                                           53473700
         AIF   (T'&REGS EQ 'O').RSPINX                                  53508000
         AIF   ('&REGS' EQ 'USE').RSPINU                                53542300
         AIF   ('&REGS' EQ 'STDSAVE').LM1EXIT  SAVE RETURN CODE,   @L4A 53576600
.*                                  RESTORE REGS 2 THRU 12              53610900
         AGO   .LMEXIT              SAVE RETURN CODE, RESTORE REGS @L4C 53645200
.*                                  11 THRU 14                          53679500
.RSPINX  MEXIT                                                          53713800
.RSPINU  ANOP                                                           53748100
         LR    11,15                RESTORE REG 11                      53782400
         LR    15,13                PUT RETURN CODE IN         @ZMC0683 53816700
*                                   REGISTER 15                @ZMC0683 53851000
         LR    12,0                 RESTORE REG 12                      53885300
         LR    13,1                 RESTORE REG 13                      53919600
         MEXIT                                                          53953900
.*                                                                      53988200
.************************************************************* @G860PXA 54022500
.* BEGINNING OF TEST SUPPORT                                   @G860PXA 54056800
.************************************************************* @G860PXA 54091100
.*                                                                      54125400
.TEST    ANOP                                                           54159700
         AIF   (T'&TYPE EQ 'O').ERRTYPE   TYPE REQUIRED       @G860PXA  54194000
         AIF   (T'&MODE NE 'O').INVMODE   MODE IS NOT VALID             54228300
         AIF   (T'&DISABLE NE 'O').NODIS  DISABLED IS NOT VALID         54262600
         AIF   ('&TYPE' EQ 'HIER').HIER01                         @L8A  54296900
         AIF   ('&TYPE' EQ 'ALL').TALLC                           @L8A  54331200
         AIF   ('&TYPE' EQ 'SPIN').SPIN01                         @L8A  54365500
         AGO   .TSTADR                                            @L8C  54399800
.*                                                                      54434100
.************************************************************* @G860PXA 54468400
.* BEGINNING OF TEST,TYPE=HIER PROCESSING                      @G860PXA 54502700
.************************************************************* @G860PXA 54537000
.*                                                                      54571300
.HIER01  ANOP                                                      @L8A 54605600
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 54639900
         AIF   (T'&ADDR NE 'O').ERRAD                          @G860PXA 54674200
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 54708500
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G860PXA 54742800
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 54777100
.*                                                                      54811400
         AIF   (T'&LOCK EQ 'O').TERR007                        @G860PXA 54845700
&X       SETA  1              UPDATE INDEX TO DISP ENTRY           @L8C 54880000
         AIF   ('&LOCK' EQ 'DISP').HIER02                      @G860PXA 54914300
&X       SETA  2              UPDATE INDEX TO RSMDS ENTRY          @L8C 54948600
         AIF   ('&LOCK' EQ 'RSMDS').HIER02                         @L3A 54982900
&X       SETA  3              UPDATE INDEX TO IOSUCB ENTRY         @L8C 55017200
         AIF   ('&LOCK' EQ 'IOSUCB').HIER02                    @G860PXA 55051500
&X       SETA  5              UPDATE INDEX TO IOSYNCH ENTRY        @L8C 55085800
         AIF   ('&LOCK' EQ 'IOSYNCH').HIER02                   @G860PXA 55120100
&X       SETA  8              UPDATE INDEX TO TPACBDEB ENTRY       @L8C 55154400
         AIF   ('&LOCK' EQ 'TPACBDEB').HIER02                  @G860PXA 55188700
&X       SETA  9              UPDATE INDEX TO ASM ENTRY            @L8C 55223000
         AIF   ('&LOCK' EQ 'ASM').HIER02                       @G860PXA 55257300
&X       SETA  10             UPDATE INDEX TO SALLOC ENTRY         @L8C 55291600
         AIF   ('&LOCK' EQ 'SALLOC').HIER02                    @G860PXA 55325900
&X       SETA  11             UPDATE INDEX TO SRM ENTRY            @L8C 55360200
         AIF   ('&LOCK' EQ 'SRM').HIER02                       @G860PXA 55394500
&X       SETA  20             UPDATE INDEX TO TRACE ENTRY          @L8C 55428800
         AIF   ('&LOCK' EQ 'TRACE').HIER02                     @G860PXA 55463100
&X       SETA  22             UPDATE INDEX TO VSMPAG ENTRY         @L8C 55497400
         AIF   ('&LOCK' EQ 'VSMPAG').HIER02                    @G860PXA 55531700
&X       SETA  23             UPDATE INDEX TO RSM ENTRY            @L8C 55566000
         AIF   ('&LOCK' EQ 'RSM').HIER02                       @G860PXA 55600300
&X       SETA  25             UPDATE INDEX TO RSMAD ENTRY          @L8C 55634600
         AIF   ('&LOCK' EQ 'RSMAD').HIER02                     @G860PXA 55668900
&X       SETA  26             UPDATE INDEX TO RSMXM ENTRY          @L8C 55703200
         AIF   ('&LOCK' EQ 'RSMXM').HIER02                     @G860PXA 55737500
&X       SETA  27             UPDATE INDEX TO RSMST ENTRY          @L8C 55771800
         AIF   ('&LOCK' EQ 'RSMST').HIER02                     @G860PXA 55806100
&X       SETA  28             UPDATE INDEX TO ASMGL ENTRY          @L8C 55840400
         AIF   ('&LOCK' EQ 'ASMGL').HIER02                     @G860PXA 55874700
&X       SETA  29             UPDATE INDEX TO VSMFIX ENTRY         @L8C 55909000
         AIF   ('&LOCK' EQ 'VSMFIX').HIER02                    @G860PXA 55943300
&X       SETA  30             UPDATE INDEX TO RSMGL ENTRY          @L8C 55977600
         AIF   ('&LOCK' EQ 'RSMGL').HIER02                     @G860PXA 56011900
&X       SETA  34             UPDATE INDEX TO RSMCM ENTRY          @L8C 56046200
         AIF   ('&LOCK' EQ 'RSMCM').HIER02                         @L3C 56080500
&X       SETA  35             UPDATE INDEX TO IOS ENTRY            @L8C 56114800
         AIF   ('&LOCK' EQ 'IOS').HIER02                           @L8C 56149100
&PSAPTR  SETA  1                                                   @L8A 56183400
&X       SETA  37             UPDATE INDEX TO BMFLSD ENTRY         @L7A 56217700
         AIF   ('&LOCK' EQ 'BMFLSD').HIER02                        @L7A 56252000
&X       SETA  38             UPDATE INDEX TO ETRSET ENTRY         @L6A 56286300
         AIF   ('&LOCK' EQ 'ETRSET').HIER02                        @L6A 56320600
&X       SETA  39             UPDATE INDEX TO XCFDS ENTRY          @L5A 56354900
         AIF   ('&LOCK' EQ 'XCFDS').HIER02                         @L5A 56389200
&X       SETA  40             UPDATE INDEX TO XCFRES ENTRY         @L5A 56423500
         AIF   ('&LOCK' EQ 'XCFRES').HIER02                        @L5A 56457800
&X       SETA  41             UPDATE INDEX TO XCFQ ENTRY           @L5A 56492100
         AIF   ('&LOCK' EQ 'XCFQ').HIER02                          @L9C 56526400
&X       SETA  43             UPDATE INDEX TO IOSULUT ENTRY        @L9A 56560700
         AIF   ('&LOCK' NE 'IOSULUT').TERR008                      @L9C 56595000
.HIER02  ANOP                                                           56629300
&INDEX   SETA  &COBT(&X)   GET INDEX INTO LIT, USED TO OBTAIN PARM @L8A 56663600
.*                         LIST ADDRESS FOR SPECIFIED LOCK              56697900
         AIF   (T'&BRANCH EQ 'O').CKWKRG  WORKREG SPECIFIED        @L8A 56732200
.*                                        WITHOUT BRANCH?               56766500
.*  BRANCH WAS SPECIFIED                                                56800800
.*                                                                      56835100
         AIF   (N'&BRANCH NE 2).TINVBR                         @G860PXA 56869400
         AIF   ('&BRANCH(1)' EQ 'HELD').HIER08                 @G860PXA 56903700
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND             @G860PXA 56938000
.*                                                                      56972300
.*  BRANCH OPERAND VALID                                                57006600
.*                                                                      57040900
.HIER08  ANOP                                                           57075200
         AIF   (T'&WORKREG EQ 'O').NOWKREG WORKREG REQUIRED WITH   @L8A 57109500
.*                                         BRANCH                       57143800
.*  WORKREG WAS SPECIFIED                                               57178100
.*                                                                      57212400
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 57246700
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 57281000
         AIF   ('&NAME' EQ '').NN1                                 @L8A 57315300
&NAME    DC    0H'0'                                               @L8A 57349600
.NN1     ANOP                                                      @L8A 57383900
         AGO   .GENCODE                   GENERATE CODE WITH       @L8A 57418200
.*                                        WORKREG                       57452500
.*  BRANCH WAS NOT SPECIFIED                                            57486800
.*                                                                      57521100
.CKWKRG  ANOP                                                      @L8A 57555400
         AIF   (T'&WORKREG NE 'O').WARNWK WORKREG IGNORED WITHOUT  @L8A 57589700
.*                                        BRANCH                        57624000
.WRNWKR  ANOP                                                      @L8A 57658300
         AIF   ('&NAME' EQ '').NN2                                 @L8A 57692600
&NAME    DC    0H'0'                                               @L8A 57726900
.NN2     ANOP                                                      @L8A 57761200
         AGO   .GENCOD2                   GENERATE CODE WITHOUT    @L8A 57795500
.*                                        WORKREG                       57829800
.GENCODE ANOP                             WORKREG SPECIFIED        @L8A 57864100
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 57898400
.*                                                                      57932700
.GENCOD2 ANOP                       WORKREG NOT SPECIFIED          @L8A 57967000
         IAC   15                   SET CONDITION CODE BASED ON    @L8A 58001300
*                                   ASC MODE TO BE USED BY THE IPM      58035600
*                                   INSTRUCTION WHICH FOLLOWS.          58069900
         SAC   0                    SAC TO PRIMARY FOR BAKR        @L8A 58104200
         LA    15,&GNAME1           RETURN ADDRESS FOR PR          @L8A 58138500
         BSM   15,0                 SET AMODE BIT FOR RETURN ADDR  @L8A 58172800
         BAKR  15,0                 SAVE STATUS ON THE LINKAGE     @L8A 58207100
*                                   STACK AND SET UP RETURN ADDRESS FOR 58241400
*                                   THE PR                              58275700
         IPM   0                    PUT IAC CC BITS INTO REG 0     @L8A 58310000
         SRL   0,20                 SHIFT IAC CC TO BITS 22-23     @L8A 58344300
         L     15,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 58378600
         AIF   (&PSAPTR EQ 1).NEWLIT                               @L8A 58412900
         L     12,&INDEX.+4(15,0)   PARM LIST ADDRESS FOR          @L8A 58447200
*                                   SPECIFIED LOCK                      58481500
         AGO   .EPA                                                @L8A 58515800
.NEWLIT  ANOP                                                      @L8A 58550100
         L     12,PSALIT2-PSA(0,0)  EXTENDED LOCK INTERFACE TABLE  @L8A 58584400
*                                   ADDRESS                             58618700
         L     12,&INDEX.+4(12,0)   PARM LIST ADDRESS FOR          @L8A 58653000
*                                   SPECIFIED LOCK                      58687300
.EPA     ANOP                                                      @L8A 58721600
         L     15,1524(15,0)        LOCK MANAGER ENTRY POINT       @L8A 58755900
*                                   ADDRESS                             58790200
         BASSM 14,15                BRANCH TO SERVICE RTN.         @L8A 58824500
         EREG  0,1                  RESTORE REGISTERS 0,1          @L8A 58858800
         PR                         RESTORE STATUS                 @L8A 58893100
&GNAME1  EQU   *                                                   @L8A 58927400
*                                                                       58961700
*    THE ASC-MODE OF THE CALLER HAS BEEN RESTORED TO GENERAL REGISTER   58996000
*    15 BY THE SERVICE ROUTINE FOR USE IN THE SAC INSTRUCTION.          59030300
*                                                                       59064600
         SAC   0(15)                RESTORE ORIGINAL ASC-MODE      @L8A 59098900
         ICM   15,B'1110',PSAFZERO-PSA(0) CLEAN RETURN CODE FROM   @L8A 59133200
*                                         LOCK MANAGER                  59167500
*                                                                  @L8A 59201800
         AIF   (T'&BRANCH EQ 'O').DONE                             @L8A 59236100
*                                                                       59270400
*    INSTRUCTIONS THAT CHANGE THE CONDITION CODE MAY NOT BE INSERTED    59304700
*    BETWEEN THE LTR AND THE RESULTING BRANCH WHICH IS GENERATED.       59339000
*                                                                       59373300
         LTR   15,15                                               @L8A 59407600
         LR    15,&WORKREG(1)       RESTORE GPR15                  @L8A 59441900
         AIF   ('&BRANCH(1)' EQ 'HELD').HIER10                     @L8A 59476200
         BZ    &BRANCH(2)           BRANCH NO HIGHER LOCKS HELD    @L8A 59510500
*                                   (R.C. IS 0)                         59544800
         MEXIT                                                     @L8A 59579100
.HIER10  ANOP                                                      @L8A 59613400
         BNZ   &BRANCH(2)           BRANCH HIGHER LOCKS HELD       @L8A 59647700
*                                   (R.C. IS 4)                         59682000
.DONE    ANOP                                                      @L8A 59716300
         MEXIT                                                          59750600
.*                                                                      59784900
.*************************************************************          59819200
.*   BEGINNING OF TEST,TYPE=ALL PROCESSING                   *          59853500
.*************************************************************          59887800
.*                                                                      59922100
.TALLC   ANOP                                                           59956400
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 59990700
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G387PXR 60025000
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G387PXR 60059300
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 60093600
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 60127900
         AIF   (T'&LOCK NE 'O').TERR009                            @L8A 60162200
         AIF   ('&BRANCH' EQ '').CKWREG5                           @L8A 60196500
.*                                                                      60230800
.*  BRANCH WAS SPECIFIED                                                60265100
.*                                                                      60299400
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 60333700
         AIF   ('&BRANCH(1)' EQ 'HELD').TALLC2                     @L8A 60368000
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 60402300
.*                                                                      60436600
.*  BRANCH OPERAND VALID                                                60470900
.*                                                                      60505200
.TALLC2  ANOP                                                      @L8A 60539500
         AIF   ('&WORKREG' EQ '').NOWKREG                          @L8A 60573800
.*                                                                      60608100
.*  WORKREG WAS SPECIFIED                                               60642400
.*                                                                      60676700
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 60711000
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 60745300
         AGO   .NN5                                                @L8A 60779600
.*                                                                      60813900
.*  BRANCH WAS NOT SPECIFIED                                            60848200
.*                                                                      60882500
.CKWREG5 ANOP                                                      @L8A 60916800
         AIF   (T'&WORKREG NE 'O').WARNWK5                         @L8A 60951100
.NN5     ANOP                                                      @L8A 60985400
         AIF   ('&NAME' EQ '').TALLCNA                             @L8A 61019700
&NAME    DC    0H'0'                                               @L8A 61054000
.TALLCNA ANOP                                                      @L8A 61088300
         AIF   (T'&BRANCH EQ 'O').SKPLD6                           @L8A 61122600
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 61156900
.*                                                                      61191200
.SKPLD6  ANOP                                                      @L8A 61225500
         L     15,PSACLHS-PSA(0,0)  LOAD CLHS FOR TESTING          @L8A 61259800
         LTR   15,15                ARE ANY LOCKS HELD?            @L8A 61294100
         AIF   (T'&BRANCH EQ 'O').TALLRC                                61328400
.*                                                                      61362700
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 61397000
         AIF   ('&BRANCH(1)' EQ 'HELD').TALLBH                          61431300
         BZ    &BRANCH(2)           BRANCH ON NOTHELD                   61465600
         MEXIT                                                          61499900
.*                                                                      61534200
.TALLBH  ANOP                                                           61568500
         BNZ   &BRANCH(2)           BRANCH ON HELD                      61602800
         MEXIT                                                          61637100
.*                                                                      61671400
.TALLRC  ANOP                                                           61705700
         BZ    *+12                 BRANCH ON NOTHELD                   61740000
         LA    15,0(0,0)            SET LOCKS HELD R.C.                 61774300
         B     &LABEL.D                                                 61808600
         LA    15,4(0,0)            SET LOCKS NOT HELD R.C.             61842900
&LABEL.D DC    0H'0'                                                    61877200
         MEXIT                                                          61911500
.*                                                                      61945800
.*************************************************************          61980100
.*   BEGINNING OF TEST,TYPE=SPIN PROCESSING                  *          62014400
.*************************************************************          62048700
.*                                                                      62083000
.SPIN01  ANOP                                                           62117300
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 62151600
         AIF   (T'&ADDR NE 'O').ERRAD                          @G860PXA 62185900
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 62220200
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G860PXA 62254500
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 62288800
         AIF   (T'&LOCK NE 'O').TERR009                            @L8A 62323100
         AIF   (T'&BRANCH EQ 'O').CKWREG                           @L8A 62357400
.*                                                                      62391700
.*  BRANCH WAS SPECIFIED                                                62426000
.*                                                                      62460300
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 62494600
         AIF   ('&BRANCH(1)' EQ 'HELD').SPIN02                     @L8A 62528900
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                      62563200
.*                                                                      62597500
.*  BRANCH OPERAND VALID                                                62631800
.*                                                                      62666100
.SPIN02  ANOP                                                           62700400
         AIF   ('&WORKREG' EQ '').NOWKREG                          @L8A 62734700
.*                                                                      62769000
.*  WORKREG WAS SPECIFIED                                               62803300
.*                                                                      62837600
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 62871900
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 62906200
         AIF   ('&NAME' EQ '').NN3                                 @L8A 62940500
&NAME    DC    0H'0'                                               @L8A 62974800
.NN3     ANOP                                                      @L8A 63009100
         AGO   .SPNCODE                    GENERATE CODE WITH      @L8A 63043400
.*                                         WORKREG                      63077700
.*  BRANCH WAS NOT SPECIFIED                                            63112000
.*                                                                      63146300
.CKWREG  ANOP                                                      @L8A 63180600
         AIF   (T'&WORKREG NE 'O').WARNWK2 WORKREG IGNORED WITHOUT @L8A 63214900
.WRNWKR2 ANOP                                                      @L8A 63249200
         AIF   ('&NAME' EQ '').NN4                                 @L8A 63283500
&NAME    DC    0H'0'                                               @L8A 63317800
.NN4     ANOP                                                      @L8A 63352100
         AGO   .SPNCOD2                    GENERATE CODE WITHOUT   @L8A 63386400
.*                                         WORKREG                      63420700
.SPNCODE ANOP                              WORKREG SPECIFIED       @L8A 63455000
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 63489300
.*                                                                      63523600
.SPNCOD2 ANOP                       WORKREG NOT SPECIFIED          @L8A 63557900
         IAC   15                   SET CONDITION CODE BASED ON    @L8A 63592200
*                                   ASC MODE TO BE USED BY THE IPM      63626500
*                                   INSTRUCTION WHICH FOLLOWS.          63660800
         SAC   0                    SAC TO PRIMARY FOR THE BAKR    @L8A 63695100
         LA    15,&GNAME3           RETURN ADDRESS FOR THE PR      @L8A 63729400
         BSM   15,0                 SET AMODE BIT FOR RETURN ADDR  @L8A 63763700
         BAKR  15,0                 SAVE STATUS ON THE LINKAGE     @L8A 63798000
*                                   STACK AND SET UP RETURN ADDRESS FOR 63832300
*                                   THE PR                              63866600
         IPM   0                    PUT IAC CC BITS INTO REG 0     @L8A 63900900
         SRL   0,20                 SHIFT IAC CC TO BITS 22-23     @L8A 63935200
         L     15,PSALITA-PSA(0,0)  LOCK INTERFACE TABLE ADDRESS   @L8A 63969500
         L     15,1528(15,0)        LOCK MANAGER ENTRY POINT       @L8A 64003800
*                                   ADDRESS                             64038100
         BASSM 14,15                BRANCH TO SERVICE RTN.         @L8A 64072400
         EREG  0,1                  RESTORE REGISTERS 0,1          @L8A 64106700
         PR                         RESTORE STATUS                 @L8A 64141000
&GNAME3  EQU   *                                                   @L8A 64175300
*                                                                       64209600
*    THE ASC-MODE OF THE CALLER HAS BEEN RESTORED TO GENERAL REGISTER   64243900
*    15 BY THE SERVICE ROUTINE FOR USE IN THE SAC INSTRUCTION.          64278200
*                                                                       64312500
         SAC   0(15)                RESTORE ORIGINAL ASC-MODE      @L8A 64346800
         ICM   15,B'1110',PSAFZERO-PSA(0)  CLEAN RETURN CODE FROM  @L8A 64381100
*                                          LOCK MANAGER                 64415400
*                                                                  @L8A 64449700
         AIF   (T'&BRANCH EQ 'O').STOP                             @L8A 64484000
*                                                                       64518300
*    INSTRUCTIONS THAT CHANGE THE CONDITION CODE MAY NOT BE INSERTED    64552600
*    BETWEEN THE LTR AND THE RESULTING BRANCH WHICH IS GENERATED.       64586900
*                                                                       64621200
         LTR   15,15                                               @L8A 64655500
         LR    15,&WORKREG(1)       RESTORE GPR15                  @L8A 64689800
         AIF   ('&BRANCH(1)' EQ 'NOTHELD').SPIN03                  @L8A 64724100
         BZ    &BRANCH(2)           BRANCH AT LEAST ONE SPIN LOCK  @L8A 64758400
*                                   WAS HELD   (R.C. IS 0)              64792700
         MEXIT                                                     @L8A 64827000
.SPIN03  ANOP                                                      @L8A 64861300
         BNZ   &BRANCH(2)           BRANCH NO SPIN LOCKS WERE      @L8A 64895600
*                                   HELD       (R.C. IS 4)              64929900
.STOP    ANOP                                                      @L8A 64964200
         MEXIT                                                          64998500
.*                                                                      65032800
.********************************************************************** 65067100
.* BEGINNING OF TEST,TYPE=USER-SPECIFIED LOCK & TYPE=(REG) PROCESSING * 65101400
.********************************************************************** 65135700
.*                                                                      65170000
.TSTADR  ANOP                                                           65204300
         AIF   (T'&LOCK NE 'O').TERR009                            @P2C 65238600
         AIF   (T'&ADDR EQ 'O').TSTTYPE                            @L8A 65272900
         AIF   ('&ADDR'(1,1) NE '(').TSTBADR                            65307200
         AIF   ('&ADDR'(K'&ADDR,1) NE ')').TSTBADR                 @L8C 65341500
.*                                                                      65375800
.TSTTYPE ANOP                                                  @G860PXA 65410100
&PSAPTR  SETA  0              CLHT SELECTED                        @L8A 65444400
&BYTE    SETA  0              CLHS BYTE 0 SELECTED             @G860PXA 65478700
&OFSET   SETA  96             CLHT ENTRY FOR CPU LOCK          @G860PXA 65513000
&MASK    SETA  128            CLHS POSITION FOR CPU LOCK       @G860PXA 65547300
         AIF   ('&TYPE' EQ 'CPU').TALOC                            @L8C 65581600
.*                                                             @G860PXA 65615900
&OFSET   SETA  80             CLHT ENTRY FOR RSM LOCK          @G860PXA 65650200
&MASK    SETA  8              CLHS POSITION FOR RSM LOCK       @G860PXA 65684500
         AIF   ('&TYPE' EQ 'RSM').TNMSYS1                          @L8C 65718800
.*                                                             @G860PXA 65753100
&OFSET   SETA  84             CLHT ENTRY FOR TRACE LOCK        @G860PXA 65787400
&MASK    SETA  4              CLHS POSITION FOR TRACE LOCK     @G860PXA 65821700
         AIF   ('&TYPE' EQ 'TRACE').TNMSYS1                        @L8C 65856000
.*                                                                 @D1A 65890300
&OFSET   SETA  88             CLHT ENTRY FOR IOS LOCK              @D1A 65924600
&MASK    SETA  2              CLHS POSITION FOR IOS LOCK           @D1A 65958900
         AIF   ('&TYPE' EQ 'IOS').TNMSYS1                          @L8C 65993200
.*                                                             @G860PXA 66027500
&BYTE    SETA  1              CLHS BYTE 1 SELECTED             @G860PXA 66061800
&OFSET   SETA  72             CLHT ENTRY FOR RSMCM LOCK        @G860PXJ 66096100
&MASK    SETA  16             CLHS POSITION FOR RSMCM LOCK     @G860PXJ 66130400
         AIF   ('&TYPE' EQ 'RSMCM').TNAMC1                         @L8C 66164700
.*                                                             @G860PXA 66199000
&OFSET   SETA  44             CLHT ENTRY FOR RSMGL LOCK        @ZMC0568 66233300
&MASK    SETA  8              CLHS POSITION FOR RSMGL LOCK     @G860PXJ 66267600
         AIF   ('&TYPE' EQ 'RSMGL').TNAMC1                         @L8C 66301900
.*                                                             @G860PXA 66336200
&OFSET   SETA  48             CLHT ENTRY FOR VSMFIX LOCK       @G860PXA 66370500
&MASK    SETA  4              CLHS POSITION FOR VSMFIX LOCK    @G860PXA 66404800
         AIF   ('&TYPE' EQ 'VSMFIX').TNMSYS1                       @L8C 66439100
.*                                                             @G860PXA 66473400
&OFSET   SETA  52             CLHT ENTRY FOR ASMGL LOCK        @G860PXA 66507700
&MASK    SETA  2              CLHS POSITION FOR ASMGL LOCK     @G860PXA 66542000
         AIF   ('&TYPE' EQ 'ASMGL').TNAMC1                         @L8C 66576300
.*                                                             @G860PXA 66610600
&OFSET   SETA  56             CLHT ENTRY FOR RSMST LOCK        @G860PXA 66644900
&MASK    SETA  1              CLHS POSITION FOR RSMST LOCK     @G860PXA 66679200
         AIF   ('&TYPE' EQ 'RSMST').TNAMC1                         @L8C 66713500
.*                                                             @G860PXA 66747800
&BYTE    SETA  2              CLHS BYTE 2 SELECTED             @G860PXA 66782100
&OFSET   SETA  60             CLHT ENTRY FOR RSMXM LOCK        @G860PXA 66816400
&MASK    SETA  128            CLHS POSITION FOR RSMXM LOCK     @G860PXA 66850700
         AIF   ('&TYPE' EQ 'RSMXM').TNAMC1                         @L8C 66885000
.*                                                             @G860PXA 66919300
&OFSET   SETA  64             CLHT ENTRY FOR RSMAD LOCK        @G860PXA 66953600
&MASK    SETA  64             CLHS POSITION FOR RSMAD LOCK     @G860PXA 66987900
         AIF   ('&TYPE' EQ 'RSMAD').TNAMC1                         @L8C 67022200
.*                                                             @G860PXA 67056500
&OFSET   SETA  68             CLHT ENTRY FOR VSMPAG LOCK       @G860PXA 67090800
&MASK    SETA  32             CLHS POSITION FOR VSMPAG LOCK    @G860PXA 67125100
         AIF   ('&TYPE' EQ 'VSMPAG').TNMSYS1                       @L8C 67159400
.*                                                             @G860PXA 67193700
&OFSET   SETA  0              CLHT ENTRY FOR DISP LOCK         @G860PXA 67228000
&MASK    SETA  16             CLHS POSITION FOR DISP LOCK      @G860PXA 67262300
         AIF   ('&TYPE' EQ 'DISP').TNMSYS1                         @L8C 67296600
.*                                                                      67330900
&OFSET   SETA  4              CLHT ENTRY FOR ASM LOCK                   67365200
&MASK    SETA  8              CLHS POSITION FOR ASM LOCK                67399500
         AIF   ('&TYPE' EQ 'ASM').TNAMC1                           @L8C 67433800
.*                                                                      67468100
&OFSET   SETA  8              CLHT ENTRY FOR SALLOC LOCK                67502400
&MASK    SETA  4              CLHS POSITION FOR SALLOC LOCK             67536700
         AIF   ('&TYPE' EQ 'SALLOC').TNMSYS1                       @L8C 67571000
.*                                                                      67605300
&OFSET   SETA  12             CLHT ENTRY FOR IOSYNCH LOCK               67639600
&MASK    SETA  2              CLHS POSITION FOR IOSYNCH LOCK            67673900
         AIF   ('&TYPE' EQ 'IOSYNCH').TNAMC1                       @L8C 67708200
.*                                                                      67742500
&OFSET   SETA  16             CLHT ENTRY FOR RSMDS LOCK                 67776800
&MASK    SETA  1              CLHS POSITION FOR RSMDS LOCK              67811100
         AIF   ('&TYPE' EQ 'IOSCAT').INVTYP                    @G860PXB 67845400
         AIF   ('&TYPE' EQ 'RSMDS').TNAMC1                         @L8C 67879700
.*                                                                      67914000
&BYTE    SETA  3              CLHS BYTE 3 SELECTED                      67948300
&OFSET   SETA  20             CLHT ENTRY FOR IOSUCB LOCK                67982600
&MASK    SETA  128            CLHS POSITION FOR IOSUCB LOCK             68016900
         AIF   ('&TYPE' EQ 'IOSUCB').TNAMC1                             68051200
.*                                                                      68085500
&OFSET   SETA  36             CLHT ENTRY FOR TPACBDEB LOCK              68119800
&MASK    SETA  8              CLHS POSITION FOR TPACBDEB LOCK           68154100
         AIF   ('&TYPE' EQ 'IOSLCH').INVTYP                    @G860PXB 68188400
         AIF   ('&TYPE' EQ 'TPNCB').INVTYP                         @L8C 68222700
         AIF   ('&TYPE' EQ 'TPDNCB').INVTYP                        @L8C 68257000
         AIF   ('&TYPE' EQ 'TPACBDEB').TNAMC1                      @L8C 68291300
.*                                                                      68325600
&OFSET   SETA  40             CLHT ENTRY FOR SRM LOCK                   68359900
&MASK    SETA  4              CLHS POSITION FOR SRM LOCK                68394200
         AIF   ('&TYPE' EQ 'SRM').TNMSYS1                          @L8C 68428500
.*                                                                      68462800
&OFSET   SETA  104            CLHT ENTRY FOR CMS LOCK                   68497100
&MASK    SETA  2              CLHS POSITION FOR CMS LOCK                68531400
         AIF   ('&TYPE' EQ 'CMS').TNMSYS1                          @L8C 68565700
.*                                                                      68600000
&OFSET   SETA  108            CLHT ENTRY FOR LOCAL LOCK                 68634300
&MASK    SETA  1              CLHS POSITION FOR LOCAL LOCK              68668600
         AIF   ('&TYPE' EQ 'LOCAL').TLOCAL                         @L8C 68702900
         AIF   ('&TYPE' EQ 'CML').TCMLCK                           @L8C 68737200
         AIF   ('&TYPE' EQ 'ALOCAL').TALOC                         @L8C 68771500
         AIF   ('&TYPE'(1,1) EQ '(').CKRTP                         @L8C 68805800
         AGO   .NEWLKS        TYPE IS NOT (REG)                    @L8A 68840100
.CKRTP   ANOP                                                      @L8A 68874400
         AIF   ('&TYPE'(K'&TYPE,1) EQ ')').TREGC                   @L8C 68908700
         AGO   .INVTYP                                             @L8A 68943000
.*                                                                      68977300
.NEWLKS  ANOP                                                      @L8A 69011600
&PSAPTR  SETA  1              ECLHT SELECTED                       @L8A 69045900
&BYTE    SETA  0              CLHSE BYTE 0 SELECTED                @L8A 69080200
&OFSET   SETA  0              ECLHT ENTRY FOR BMFLSD LOCK          @L7A 69114500
&MASK    SETA  128            CLHSE POSITION FOR BMFLSD LOCK       @L7A 69148800
         AIF   ('&TYPE' EQ 'BMFLSD').TNAMC2                        @L7A 69183100
.*                                                                 @L7A 69217400
&OFSET   SETA  4              ECLHT ENTRY FOR XCFDS LOCK           @L5A 69251700
&MASK    SETA  64             CLHSE POSITION FOR XCFDS LOCK        @L5A 69286000
         AIF   ('&TYPE' EQ 'XCFDS').TNAMC2                         @L5A 69320300
.*                                                                 @L5A 69354600
&OFSET   SETA  8              ECLHT ENTRY FOR XCFRES LOCK          @L5A 69388900
&MASK    SETA  32             CLHSE POSITION FOR XCFRES LOCK       @L5A 69423200
         AIF   ('&TYPE' EQ 'XCFRES').TNAMC2                        @L5A 69457500
.*                                                                 @L5A 69491800
&OFSET   SETA  12             ECLHT ENTRY FOR XCFQ LOCK            @L5A 69526100
&MASK    SETA  16             CLHSE POSITION FOR XCFQ LOCK         @L5A 69560400
         AIF   ('&TYPE' EQ 'XCFQ').TNMSYS2                         @L5A 69594700
.*                                                                 @L5A 69629000
&OFSET   SETA  16             ECLHT ENTRY FOR ETRSET LOCK          @L6A 69663300
&MASK    SETA  8              CLHSE POSITION FOR ETRSET LOCK       @L6A 69697600
         AIF   ('&TYPE' EQ 'ETRSET').TNMSYS2                       @L6A 69731900
.********************************************************************** 69766200
&BYTE    SETA  1              CLSHE BYTE 1 SELECTED                @L9A 69800500
&OFSET   SETA  36             ECLHT ENTRY FOR IOSULUT LOCK         @L9A 69834800
&MASK    SETA  64             CLHSE POSITION FOR IOSULUT LOCK      @L9A 69869100
         AIF   ('&TYPE' EQ 'IOSULUT').TNMSYS2                      @L9A 69903400
         AGO   .INVTYP                                                  69937700
.********************************************************************** 69972000
.*                                                                      70006300
.********************************************************************** 70040600
.***********  THIS SECTION IS FOR PRE-4.1.0 LOCK PROCESSING  ********** 70074900
.********************************************************************** 70109200
.*                                                                      70143500
.TNMSYS1 ANOP                                                           70177800
         AIF   (T'&ADDR NE 'O').ERRAD                          @G860PXA 70212100
         AIF   (NOT('&TYPE' EQ 'TRACE' OR '&TYPE' EQ 'RSM' OR '&TYPE'  +70246400
               EQ 'IOS')).TNAMC1                                   @D1C 70280700
.*                                                                      70315000
.*  CHECK PRE-4.1.0 SHR/EXCL LOCKS                                      70349300
.*                                                                      70383600
         AIF   (T'&SCOPE EQ 'O').TNAMC1A                       @G860PXA 70417900
.*                                                                      70452200
.*  SCOPE WAS SPECIFIED                                                 70486500
.*                                                                      70520800
         AIF   ('&SCOPE' NE 'SHR' AND '&SCOPE' NE 'EXCL').INVSCOP       70555100
         AGO   .TNAMC1A                                        @G860PXA 70589400
.*                                                                      70623700
.TNAMC1  ANOP                                                           70658000
         AIF   (T'&SCOPE NE 'O').NOSCOPE                       @G860PXA 70692300
.TNAMC1A ANOP                                                           70726600
         AIF   (T'&REGS NE 'O').NOREGS                             @L8C 70760900
         AIF   (T'&ASCB NE 'O').ERRASCB                        @G860PXA 70795200
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G860PXA 70829500
         AIF   (T'&BRANCH EQ 'O').TSTW                             @L8A 70863800
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 70898100
         AIF   ('&BRANCH(1)' EQ 'HELD').NAMCK                      @L8A 70932400
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 70966700
         AGO   .NAMCK                                              @L8A 71001000
.TSTW    ANOP                                                      @L8A 71035300
         AIF   (T'&WORKREG NE 'O').WARNWKA                         @L8A 71069600
.NAMCK   ANOP                                                      @L8A 71103900
         AIF   ('&NAME' EQ '').TNAMNN                                   71138200
&NAME    DC    0H'0'                                                    71172500
.TNAMNN  ANOP                                                           71206800
         AIF   (T'&BRANCH NE 'O').TNAMNB                                71241100
         SR    15,15                PRESET LOCK HELD RETURN CODE        71275400
.TNAMNB  ANOP                                                           71309700
         AIF   (T'&ADDR EQ 'O').TSCOPE3                        @G860PXA 71344000
.*                                                                      71378300
.*  MUST BE A CLASS LOCK WITH ADDR KEYWORD SPECIFIED                    71412600
.*                                                                      71446900
         C     &ADDR(1),PSACLHT-PSA+&OFSET.(0,0)  CHECK LKWD ADDR       71481200
*                                                 IN CLHT      @ZA35343 71515500
         AIF   (T'&BRANCH EQ 'O').TNAMARC                               71549800
         AIF   ('&BRANCH(1)' EQ 'HELD').TNAMABH                         71584100
         BNE   &BRANCH(2)           BRANCH ON NOTHELD                   71618400
         MEXIT                                                          71652700
.TNAMABH ANOP                                                           71687000
         BE    &BRANCH(2)           BRANCH ON HELD                      71721300
         MEXIT                                                          71755600
.TNAMARC ANOP                                                           71789900
         BE    *+8                                                      71824200
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN CODE       71858500
         MEXIT                                                          71892800
.*                                                                      71927100
.TSCOPE3 ANOP                                                           71961400
         AIF   (T'&SCOPE EQ 'O').TNAMTM                        @G860PXA 71995700
         AIF   ('&SCOPE' EQ 'EXCL').TEXCL1                     @G860PXA 72030000
.*                                                                      72064300
.************ PROCESS SCOPE=SHR REQUEST ********************** @G860PXA 72098600
.*                                                                      72132900
         TM    PSACLHT-PSA+&OFSET.(0),X'80' IS LOCK HELD SHR?  @G860PXA 72167200
         AIF   (T'&BRANCH EQ 'O').GOTOG                        @G860PXA 72201500
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOPE5                @G860PXA 72235800
.GOTOG   ANOP                                                  @G860PXA 72270100
         BO    &LABEL.G             BRANCH IF NOT HELD WITH    @G860PXA 72304400
*                                   REQUESTED SCOPE                     72338700
.*****************************************************************      72373000
.*  IF THE HIGH ORDER BIT OF THE LOCKWORD IN THE CLHT IS OFF,    *      72407300
.*  THE LOCK MAY OR MAY NOT BE HELD AS SHARED.  THE CORRECT BIT  *      72441600
.*  IN PSACLHS MUST BE INTERROGATED TO BE SURE.                  *      72475900
.*****************************************************************      72510200
         AGO   .TNAMTM1                                            @L8C 72544500
.TSCOPE5 ANOP                                                  @G860PXA 72578800
         BO    &BRANCH(2)           BRANCH ON NOT HELD         @G860PXA 72613100
.*                                                                      72647400
.TNAMTM1 ANOP                                                           72681700
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  TEST BIT IN        @G860PXA 72716000
*                                           CURRENT LOCK HELD STRING    72750300
         AIF   (T'&BRANCH EQ 'O').TNAMRC1                          @L8C 72784600
         AIF   ('&BRANCH(1)' EQ 'HELD').TNAMBH1                    @L8C 72818900
         BZ    &BRANCH(2)           BRANCH ON NOT HELD         @G860PXA 72853200
         MEXIT                                                     @L8A 72887500
.*                                                                      72921800
.TNAMBH1 ANOP                                                      @L8C 72956100
         BO    &BRANCH(2)           BRANCH ON HELD                 @L8A 72990400
&LABEL.G DC    0H'0'                BRANCH LABEL               @G860PXA 73024700
         MEXIT                                                          73059000
.TNAMRC1 ANOP                                                           73093300
         BO    *+8                  BRANCH HELD                         73127600
&LABEL.G DC    0H'0'                BRANCH LABEL               @G860PXA 73161900
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.     @G860PXA 73196200
         MEXIT                                                          73230500
.*                                                                      73264800
.************ PROCESS SCOPE=EXCL REQUEST *********************          73299100
.*                                                                      73333400
.TEXCL1  ANOP                                                  @G860PXA 73367700
         TM    PSACLHT-PSA+&OFSET.(0),X'80' IS LOCK HELD EXCL? @G860PXA 73402000
         AIF   (T'&BRANCH EQ 'O').TNAMRC2                      @G860PXA 73436300
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOPE6                @G860PXA 73470600
         BO    &BRANCH(2)           BRANCH ON HELD             @G860PXA 73504900
         MEXIT                                                          73539200
.*                                                                      73573500
.TSCOPE6 ANOP                                                           73607800
         BZ    &BRANCH(2)           BRANCH ON NOTHELD          @G860PXA 73642100
         MEXIT                                                          73676400
.*                                                                      73710700
.TNAMRC2 ANOP                                                           73745000
         BO    *+8                  BRANCH ON HELD                      73779300
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN   @G860PXA 73813600
*                                   CODE                                73847900
         MEXIT                                                          73882200
.*                                                                      73916500
.*************************************************************          73950800
.*******       PROCESS GARDEN VARIETY LOCK, OR         *******          73985100
.*******       CMS LOCK, OR                            *******          74019400
.*******       CLASS LOCK WITHOUT ADDR KEYWORD, OR     *******          74053700
.*******       SHR/EXCL LOCK WITHOUT SCOPE KEYWORD     *******          74088000
.*******       TEST REQUESTS                           *******          74122300
.*************************************************************          74156600
.*                                                                      74190900
.TNAMTM  ANOP                                                  @G860PXA 74225200
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  IS LOCK HELD?      @G860PXA 74259500
         AIF   (T'&BRANCH EQ 'O').TNAMRC3                      @G860PXA 74293800
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOPE9                @G860PXA 74328100
         BO    &BRANCH(2)           BRANCH ON HELD             @G860PXA 74362400
         MEXIT                                                          74396700
.*                                                                      74431000
.TSCOPE9 ANOP                                                           74465300
         BZ    &BRANCH(2)           BRANCH ON NOTHELD          @G860PXA 74499600
         MEXIT                                                          74533900
.*                                                                      74568200
.TNAMRC3 ANOP                                                           74602500
         BO    *+8                                                      74636800
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN   @G860PXA 74671100
*                                   CODE                                74705400
         MEXIT                                                          74739700
.*                                                                      74774000
.******************  END PRE-4.1.0 LOCK PROCESSING  ******************* 74808300
.*                                                                      74842600
.********************************************************************** 74876900
.***********  THIS SECTION IS FOR 4.1.0 LOCK PROCESSING  ************** 74911200
.********************************************************************** 74945500
.*                                                                      74979800
.TNMSYS2 ANOP                                                           75014100
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 75048400
         AIF   (NOT('&TYPE' EQ 'XCFQ' OR                               +75082700
               '&TYPE' EQ 'IOSULUT')).TNAMC2                       @L9C 75117000
.*                                                                      75151300
.*  CHECK SHR/EXCL LOCKS                                           @L8A 75185600
.*                                                                      75219900
         AIF   (T'&SCOPE EQ 'O').TNAMC2B                           @L8A 75254200
.*                                                                      75288500
.*  SCOPE WAS SPECIFIED                                            @L8A 75322800
.*                                                                      75357100
         AIF   ('&SCOPE' NE 'SHR' AND '&SCOPE' NE 'EXCL').INVSCOP  @L8A 75391400
         AGO   .TNAMC2B                                            @L8A 75425700
.*                                                                      75460000
.TNAMC2  ANOP                                                      @L8A 75494300
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 75528600
.TNAMC2B ANOP                                                      @L8A 75562900
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 75597200
         AIF   (T'&ASCB NE 'O').ERRASCB                            @L8A 75631500
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                         @L8A 75665800
         AIF   (T'&BRANCH EQ 'O').CKWREG1                          @L8A 75700100
.*                                                                      75734400
.*  BRANCH WAS SPECIFIED                                                75768700
.*                                                                      75803000
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 75837300
         AIF   ('&BRANCH(1)' EQ 'HELD').TNAM02                     @L8A 75871600
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                      75905900
.*                                                                      75940200
.*  BRANCH OPERAND VALID                                                75974500
.*                                                                      76008800
.TNAM02  ANOP                                                           76043100
         AIF   (T'&WORKREG EQ 'O').NOWKREG                         @L8A 76077400
.*                                                                      76111700
.*  WORKREG WAS SPECIFIED                                               76146000
.*                                                                      76180300
         AIF   (N'&WORKREG NE 1).TINVWK                            @L8A 76214600
         AIF   ('&WORKREG'(1,1) NE '(').NOTAREG                    @L8A 76248900
         AGO   .WRNWKRB                                            @L8A 76283200
.CKWREG1 ANOP                                                      @L8A 76317500
         AIF   (T'&WORKREG NE 'O').WARNWKB                         @L8A 76351800
.WRNWKRB ANOP                                                      @L8A 76386100
         AIF   ('&NAME' EQ '').TNAMNN2                             @L8A 76420400
&NAME    DC    0H'0'                                               @L8A 76454700
.TNAMNN2 ANOP                                                      @L8A 76489000
         AIF   (T'&ADDR EQ 'O').TSCOP32                            @L8A 76523300
.*                                                                      76557600
.*  MUST BE A CLASS LOCK WITH ADDR KEYWORD SPECIFIED                    76591900
.*                                                                      76626200
         AIF   (T'&BRANCH EQ 'O').NOLOAD1                          @L8A 76660500
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 76694800
.NOLOAD1 ANOP                                                      @L8A 76729100
         L     15,PSAECLTP-PSA(0)   ADDRESS OF ECLHT               @L8A 76763400
         C     &ADDR(1),&OFSET.(15,0) CHECK LKWD ADDR IN ECLHT     @L8A 76797700
         AIF   (T'&BRANCH EQ 'O').TNMARC2                          @L8A 76832000
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 76866300
         AIF   ('&BRANCH(1)' EQ 'HELD').TNMABH2                    @L8A 76900600
         BNE   &BRANCH(2)           BRANCH ON NOTHELD              @L8A 76934900
         MEXIT                                                     @L8A 76969200
.TNMABH2 ANOP                                                      @L8A 77003500
         BE    &BRANCH(2)           BRANCH ON HELD                 @L8A 77037800
         MEXIT                                                     @L8A 77072100
.TNMARC2 ANOP                                                      @L8A 77106400
         BE    *+12                                                @L8A 77140700
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN CODE  @L8A 77175000
         B     &LABEL.F                                            @L8A 77209300
         LA    15,0(0,0)            SET LOCK HELD RETURN CODE      @L8A 77243600
&LABEL.F DC    0H'0'                BRANCH LABEL                   @L8A 77277900
         MEXIT                                                     @L8A 77312200
.*                                                                      77346500
.TSCOP32 ANOP                                                      @L8A 77380800
         AIF   (T'&SCOPE EQ 'O').TNAMTMA                           @L8A 77415100
         AIF   ('&SCOPE' EQ 'EXCL').TEXCL2                         @L8A 77449400
.*                                                                      77483700
.************ PROCESS SCOPE=SHR REQUEST **********************          77518000
.*                                                                      77552300
         AIF   (T'&BRANCH EQ 'O').SKPLD                            @L8A 77586600
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 77620900
         AIF   ('&SYSASCE' EQ 'P').SKPLD                           @L8A 77655200
         CPYA  &WORKREG(1),15       SAVE AR15 VALUE                @L8A 77689500
.SKPLD   ANOP                                                      @L8A 77723800
         L     15,PSAECLTP-PSA(0)   ADDRESS OF ECLHT               @L8A 77758100
         AIF   ('&SYSASCE' EQ 'P').NOART1                          @L8A 77792400
         LAE   15,0(15,0)           GET ALET OF 0                  @L8A 77826700
.NOART1  ANOP                                                      @L8A 77861000
         TM    &OFSET.(15),X'80'    IS LOCK HELD SHR?              @L8A 77895300
         AIF   (T'&BRANCH NE 'O').NORC1                            @L8A 77929600
         LA    15,0(0,0)            PRESET SUCCESSFUL RETURN CODE  @L8A 77963900
         AGO   .GOTOG2                                             @L8A 77998200
.NORC1   ANOP                                                      @L8A 78032500
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 78066800
         AIF   ('&SYSASCE' EQ 'P').NOART2                          @L8A 78101100
         CPYA  15,&WORKREG(1)       RESTORE AR15 VALUE             @L8A 78135400
.NOART2  ANOP                                                      @L8A 78169700
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOP52                    @L8A 78204000
.GOTOG2  ANOP                                                      @L8A 78238300
         BO    &LABEL.L             BRANCH IF NOT HELD WITH        @L8A 78272600
*                                   REQUESTED SCOPE                     78306900
.*****************************************************************      78341200
.*  IF THE HIGH ORDER BIT OF THE LOCKWORD IN THE ECLHT IS OFF,   *      78375500
.*  THE LOCK MAY OR MAY NOT BE HELD AS SHARED.  THE CORRECT BIT  *      78409800
.*  IN PSACLHSE MUST BE INTERROGATED TO BE SURE.                 *      78444100
.*****************************************************************      78478400
         AGO   .TNMTM1B                                            @L8A 78512700
.TSCOP52 ANOP                                                      @L8A 78547000
         BO    &BRANCH(2)           BRANCH ON NOT HELD             @L8A 78581300
.*                                                                      78615600
.TNMTM1B ANOP                                                      @L8A 78649900
         TM    PSACLHSE-PSA+&BYTE.(0),&MASK IS LOCK REALLY HELD?   @L8A 78684200
         AIF   (T'&BRANCH EQ 'O').TNMRC12                          @L8A 78718500
         AIF   ('&BRANCH(1)' EQ 'HELD').TNMBH12                    @L8A 78752800
         BZ    &BRANCH(2)           BRANCH ON NOT HELD             @L8A 78787100
         MEXIT                                                     @L8A 78821400
.*                                                                      78855700
.TNMBH12 ANOP                                                      @L8A 78890000
         BO    &BRANCH(2)           BRANCH ON HELD                 @L8A 78924300
&LABEL.L DC    0H'0'                BRANCH LABEL                   @L8A 78958600
         MEXIT                                                     @L8A 78992900
.TNMRC12 ANOP                                                      @L8A 79027200
         BO    *+8                  BRANCH HELD                    @L8A 79061500
&LABEL.L DC    0H'0'                BRANCH LABEL                   @L8A 79095800
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.         @L8A 79130100
         MEXIT                                                     @L8A 79164400
.*                                                                      79198700
.************ PROCESS SCOPE=EXCL REQUEST *********************          79233000
.*                                                                      79267300
.TEXCL2  ANOP                                                      @L8A 79301600
         AIF   (T'&BRANCH EQ 'O').SKPLD1                           @L8A 79335900
         LR    &WORKREG(1),15       SAVE GPR15 VALUE               @L8A 79370200
         AIF   ('&SYSASCE' EQ 'P').SKPLD1                          @L8A 79404500
         CPYA  &WORKREG(1),15       SAVE AR15 VALUE                @L8A 79438800
.SKPLD1  ANOP                                                      @L8A 79473100
         L     15,PSAECLTP-PSA(0)   ADDRESS OF ECLHT               @L8A 79507400
         AIF   ('&SYSASCE' EQ 'P').NOART3                          @L8A 79541700
         LAE   15,0(15,0)           GET ALET OF 0                  @L8A 79576000
.NOART3  ANOP                                                      @L8A 79610300
         TM    &OFSET.(15),X'80'    IS LOCK HELD EXCL?             @L8A 79644600
         AIF   (T'&BRANCH NE 'O').NORC2                            @L8A 79678900
         LA    15,0(0,0)            PRESET LOCK HELD R.C.          @L8A 79713200
         AGO   .TNMRC22                                            @L8A 79747500
.NORC2   ANOP                                                      @L8A 79781800
         LR    15,&WORKREG(1)       RESTORE GPR15 VALUE            @L8A 79816100
         AIF   ('&SYSASCE' EQ 'P').NOART4                          @L8A 79850400
         CPYA  15,&WORKREG(1)       RESTORE AR15 VALUE             @L8A 79884700
.NOART4  ANOP                                                      @L8A 79919000
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOP62                    @L8A 79953300
         BO    &BRANCH(2)           BRANCH ON HELD                 @L8A 79987600
         MEXIT                                                     @L8A 80021900
.*                                                                      80056200
.TSCOP62 ANOP                                                      @L8A 80090500
         BZ    &BRANCH(2)           BRANCH ON NOTHELD              @L8A 80124800
         MEXIT                                                     @L8A 80159100
.*                                                                      80193400
.TNMRC22 ANOP                                                      @L8A 80227700
         BO    *+8                  BRANCH ON HELD                 @L8A 80262000
         LA    15,4(0,0)            SET LOCK NOT HELD RETURN CODE  @L8A 80296300
         MEXIT                                                     @L8A 80330600
.*                                                                      80364900
.************ PROCESS GARDEN VARIETY TEST REQUEST ************          80399200
.*                                                                      80433500
.TNAMTMA ANOP                                                      @L8A 80467800
         AIF   (T'&BRANCH NE 'O').NORC3                            @L8A 80502100
         SR    15,15                PRESET LOCK HELD R.C.          @L8A 80536400
.NORC3   ANOP                                                      @L8A 80570700
         TM    PSACLHSE-PSA+&BYTE.(0),&MASK IS LOCK HELD?          @L8A 80605000
         AIF   (T'&BRANCH EQ 'O').TNMRC32                          @L8A 80639300
         AIF   ('&BRANCH(1)' NE 'HELD').TSCOP92                    @L8A 80673600
         BO    &BRANCH(2)           BRANCH ON HELD                 @L8A 80707900
         MEXIT                                                     @L8A 80742200
.*                                                                      80776500
.TSCOP92 ANOP                                                      @L8A 80810800
         BZ    &BRANCH(2)           BRANCH ON NOTHELD              @L8A 80845100
         MEXIT                                                     @L8A 80879400
.*                                                                      80913700
.TNMRC32 ANOP                                                      @L8A 80948000
         BO    *+8                                                 @L8A 80982300
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.         @L8A 81016600
         MEXIT                                                     @L8A 81050900
.*                                                                      81085200
.*************************************************************          81119500
.*   BEGINNING OF TEST,TYPE=LOCAL LOCK PROCESSING            *          81153800
.*************************************************************          81188100
.*                                                                      81222400
.TLOCAL  ANOP                                                           81256700
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 81291000
         AIF   (T'&ASCB NE 'O').ERRASCB                            @L8A 81325300
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                         @L8A 81359600
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 81393900
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 81428200
         AIF   ('&NAME' EQ '').NN6                                 @L8A 81462500
&NAME    DC    0H'0'                                               @L8A 81496800
.NN6     ANOP                                                      @L8A 81531100
         AIF   (T'&BRANCH NE 'O').CHECKIT                          @L8C 81565400
.*                                                                      81599700
.*  BRANCH WAS NOT SPECIFIED                                            81634000
.*                                                                      81668300
         AIF   (T'&WORKREG NE 'O').WARNWKE                         @L8A 81702600
.WRNWKRE ANOP                                                      @L8A 81736900
         SR    15,15                PRESET LOCK HELD R.C.          @L8A 81771200
.*                                                                      81805500
.CHECKIT ANOP                                                      @L8A 81839800
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  IS LOCAL/CML HELD?     @L8C 81874100
         AIF   (T'&BRANCH EQ 'O').TLOCRC                       @G387PXR 81908400
         AIF   ('&BRANCH(1)' EQ 'HELD').TLOCBH                 @G387PXR 81942700
         BZ    &BRANCH(2)           BRANCH ON NOTHELD          @G387PXR 81977000
         AGO   .TLOCCL                                         @G387PXR 82011300
.*                                                                      82045600
.TLOCRC  ANOP                                                  @G387PXR 82079900
         BZ    &LABEL.A             BRANCH ON NOTHELD          @G387PXR 82114200
         AGO   .TLOCCL                                         @G387PXR 82148500
.*                                                                      82182800
.TLOCBH  ANOP                                                  @G387PXR 82217100
         BZ    &LABEL.B             BRANCH ON NOTHELD          @G387PXR 82251400
.*                                                                      82285700
.TLOCCL  ANOP                                                  @G387PXR 82320000
         CLC   PSALOCAL-PSA(4,0),PSAFZERO-PSA(0) IS LOCAL LOCK @ZMP0008 82354300
*                                                HELD?                  82388600
         AIF   (T'&BRANCH EQ 'O').TLOCRC1                      @G387PXR 82422900
         AIF   ('&BRANCH(1)' EQ 'HELD').TLOCBH1                @G387PXR 82457200
         BNE   &BRANCH(2)           BRANCH ON NOTHELD          @ZMP0008 82491500
         MEXIT                                                 @G387PXR 82525800
.*                                                                      82560100
.TLOCRC1 ANOP                                                  @G387PXR 82594400
         BE    *+8                  BRANCH ON HELD             @ZMP0008 82628700
&LABEL.A LA    15,4(0,0)            SET LOCK NOT HELD R.C.     @G387PXR 82663000
         MEXIT                                                 @G387PXR 82697300
.TLOCBH1 ANOP                                                  @G387PXR 82731600
         BE    &BRANCH(2)           BRANCH ON HELD             @ZMP0008 82765900
&LABEL.B DC    0H'0'                                           @G387PXR 82800200
         MEXIT                                                 @G387PXR 82834500
.*                                                                      82868800
.*************************************************************          82903100
.*   BEGINNING OF TEST,TYPE=(REG) PROCESSING                 *          82937400
.*************************************************************          82971700
.*                                                                      83006000
.TREGC   ANOP                                                           83040300
         AIF   (T'&WORKREG NE 'O').INVWKRG                         @L8A 83074600
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 83108900
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 83143200
         AIF   (T'&ASCB NE 'O').TREGCA                         @G387PXR 83177500
         AIF   (T'&LOCKHLD NE 'O').ERRLOCK                     @G387PXR 83211800
         AIF   (T'&REGS EQ 'O').CKB                                @L8A 83246100
         AIF   ('&REGS'(1,1) NE '(').BADREGS                            83280400
         AIF   ('&REGS'(K'&REGS,1) NE ')').BADREGS                      83314700
.CKB     ANOP                                                      @L8A 83349000
         AIF   (T'&BRANCH EQ 'O').TREGCNB                               83383300
         AIF   (T'&REGS EQ 'O').REGREQ                             @L8C 83417600
         AIF   ('&NAME' EQ '').TREGCNN                                  83451900
&NAME    DC    0H'0'                                                    83486200
.TREGCNN LR    &REGS(1),&TYPE(1)    SAVE INPUT STRING                   83520500
         N     &REGS(1),PSACLHS-PSA(0,0) COMPARE TO LOCKS HELD          83554800
*                                       STRING                 @ZA35343 83589100
         CR    &REGS(1),&TYPE(1)    ARE ALL SPECIFIED LOCKS HELD        83623400
         AIF   ('&BRANCH(1)' EQ 'HELD').TREGCBH                         83657700
         BNE   &BRANCH(2)           BRANCH NOT ALL HELD                 83692000
         MEXIT                                                          83726300
.TREGCBH BE    &BRANCH(2)           BRANCH ALL HELD                     83760600
         MEXIT                                                          83794900
.TREGCNB ANOP                                                           83829200
         AIF   ('&NAME' EQ '').TREGRNN                                  83863500
&NAME    DC    0H'0'                                                    83897800
.TREGRNN LR    15,&TYPE(1)          SAVE INPUT STRING                   83932100
&REG1    SETC  '&TYPE(1)'                                      @G387PXR 83966400
         AIF   (T'&REGS EQ 'O').TREGCNR                                 84000700
&REG1    SETC  '&REGS(1)'                                      @G387PXR 84035000
         LR    &REG1,&TYPE(1)       MOVE STRING IN WORK REG    @G387PXR 84069300
.TREGCNR N     &REG1,PSACLHS-PSA(0,0)   COMPARE TO LOCKS HELD  @G387PXR 84103600
*                                       STRING                 @ZA35343 84137900
         XR    15,&REG1             SET RC=0 IF ALL HELD       @G387PXR 84172200
         BZ    *+8                  EXIT ALL HELD                       84206500
         LA    15,4(0,0)            SET RC NOT ALL HELD                 84240800
         MEXIT                                                          84275100
.*                                                                      84309400
.*************************************************************          84343700
.*   BEGINNING OF TEST,TYPE=CML PROCESSING                   *          84378000
.*************************************************************          84412300
.*                                                                      84446600
.TCMLCK  ANOP                                                  @G387PXR 84480900
         AIF   (T'&REGS NE 'O').NOREGS                             @L8A 84515200
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 84549500
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 84583800
         AIF   (T'&BRANCH EQ 'O').TSTW2                            @L8A 84618100
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 84652400
         AIF   ('&BRANCH(1)' EQ 'HELD').CMLPROC                    @L8A 84686700
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 84721000
         AGO   .CMLPROC                                            @L8A 84755300
.*                                                                      84789600
.TSTW2   ANOP                                                      @L8A 84823900
         AIF   (T'&WORKREG NE 'O').WARNWKC                         @L8A 84858200
.*                                                                      84892500
.CMLPROC ANOP                                                      @L8A 84926800
         AIF   ('&NAME' EQ '').NONAME                              @L8A 84961100
&NAME    DC    0H'0'                                               @L8A 84995400
.NONAME  ANOP                                                      @L8A 85029700
         AIF   (T'&ASCB NE 'O').TCMLAS                         @G387PXR 85064000
         AIF   (T'&LOCKHLD NE 'O').TCMLREG                     @G387PXR 85098300
         AGO   .LKASREQ                                            @L8C 85132600
.*                                                                      85166900
.TCMLAS  ANOP                                                  @G387PXR 85201200
         AIF   (T'&LOCKHLD EQ 'O').TCMLASC                     @G387PXR 85235500
         AGO   .LKHINV                                             @L8C 85269800
.*                                                                      85304100
.TCMLREG ANOP                                                  @G387PXR 85338400
         AIF   ('&LOCKHLD'(1,1) NE '(').BLKHLD                 @G387PXR 85372700
         AIF   ('&LOCKHLD'(K'&LOCKHLD,1) NE ')').BLKHLD        @G387PXR 85407000
         AIF   (T'&BRANCH NE 'O').TCMLR                        @G387PXR 85441300
         SR    15,15                PRESET LOCK HELD R.C.      @G387PXR 85475600
.TCMLR   ANOP                                                           85509900
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 85544200
         AIF   (T'&BRANCH EQ 'O').TCMLRC                       @G387PXR 85578500
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLBH                 @G387PXR 85612800
         BZ    &BRANCH(2)           BRANCH CML NOT HELD        @G387PXR 85647100
         AGO   .TCMLRCL                                        @G387PXR 85681400
.TCMLRC  BZ    &LABEL.A             BRANCH CML NOT HELD        @G387PXR 85715700
         AGO   .TCMLRCL                                        @G387PXR 85750000
.TCMLBH  BZ    &LABEL.X             BRANCH CML NOT HELD        @G387PXR 85784300
.*                                                                      85818600
.TCMLRCL ANOP                                                  @G387PXR 85852900
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0) LOAD CLHT CML     @G387PXR 85887200
         LTR   &LOCKHLD(1),&LOCKHLD(1)       CML LOCK HELD?    @G387PXR 85921500
         AIF   (T'&BRANCH EQ 'O').TCMLRC1                      @G387PXR 85955800
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLRBH                @G387PXR 85990100
         BZ    &BRANCH(2)           BRANCH CML NOT HELD        @G387PXR 86024400
         MEXIT                                                 @G387PXR 86058700
.TCMLRC1 ANOP                                                  @G387PXR 86093000
         BNZ   *+8                  BRANCH - CML HELD          @G387PXR 86127300
&LABEL.A LA    15,4(0,0)            SET R.C.=4 NOT HELD        @G387PXR 86161600
         MEXIT                                                 @G387PXR 86195900
.TCMLRBH BNZ   &BRANCH(2)           BRANCH - LOCK HELD         @G387PXR 86230200
&LABEL.X DC    0H'0'                                           @G387PXR 86264500
         MEXIT                                                 @G387PXR 86298800
.*                                                                      86333100
.TCMLASC ANOP                                                  @G387PXR 86367400
         AIF   ('&ASCB'(1,1) NE '(').TCMLANV                   @G387PXR 86401700
         AIF   ('&ASCB'(K'&ASCB,1) NE ')').TCMLANV             @G387PXR 86436000
         AIF   (T'&BRANCH NE 'O').TCMLASA                      @G387PXR 86470300
         SR    15,15                PRESET LOCK HELD R.C.      @G387PXR 86504600
.TCMLASA ANOP                                                  @G387PXR 86538900
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 86573200
         AIF   (T'&BRANCH EQ 'O').TCMLARC                      @G387PXR 86607500
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLABH                @G387PXR 86641800
         BZ    &BRANCH(2)           BRANCH - LOCK NOT HELD     @G387PXR 86676100
         AGO   .TCMLACL                                        @G387PXR 86710400
.TCMLARC BZ    &LABEL.B             BRANCH - LOCK NOT HELD     @G387PXR 86744700
         AGO   .TCMLACL                                        @G387PXR 86779000
.TCMLABH BZ    &LABEL.C             BRANCH - LOCK NOT HELD     @G387PXR 86813300
.TCMLACL ANOP                                                  @G387PXR 86847600
         CLC   PSAFZERO-PSA(4,0),PSALOCAL-PSA(0)  CML LOCK     @ZMB0398 86881900
*                                                 HELD?        @ZMB0398 86916200
         BNE   &LABEL.D             YES CONTINUE CHECKS        @G382PXR 86950500
         CL    &ASCB(1),PSAAOLD-PSA(0,0)  ASCB SPECIFIED=HOME? @G382PXR 86984800
         AIF   (T'&BRANCH EQ 'O').TCMLAR1                      @G387PXR 87019100
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLAH1                @G387PXR 87053400
         BNE   &BRANCH(2)           BRANCH LOCK NOT HELD       @G387PXR 87087700
         B     &LABEL.C             BRANCH LOCK HELD           @G382PXR 87122000
         AGO   .TCMLAC1             CONTINUE CHECKS            @G382PXR 87156300
.TCMLAR1 ANOP                                                  @G382PXR 87190600
         BE    &LABEL.C             BRANCH LOCK HELD           @G382PXR 87224900
         B     &LABEL.B             BRANCH - SET R.C.          @G382PXR 87259200
         AGO   .TCMLAC1                                        @G382PXR 87293500
.TCMLAH1 ANOP                                                  @G382PXR 87327800
         BE    &BRANCH(2)           BRANCH  LOCK HELD          @G382PXR 87362100
         B     &LABEL.C             BRANCH  LOCK NOT HELD      @G382PXR 87396400
.TCMLAC1 ANOP                                                  @G382PXR 87430700
&LABEL.D CL    &ASCB(1),PSALOCAL-PSA(0,0)  CML LOCK HELD?      @G382PXR 87465000
         AIF   (T'&BRANCH EQ 'O').TCMLAR2                      @G382PXR 87499300
         AIF   ('&BRANCH(1)' EQ 'HELD').TCMLAH2                @G382PXR 87533600
         BNE   &BRANCH(2)           BRANCH NOT HELD            @G382PXR 87567900
         AGO   .TCMLEND             END OF CML CHECKS          @G382PXR 87602200
.TCMLAR2 ANOP                                                  @G382PXR 87636500
         BE    &LABEL.C             BRANCH LOCK HELD           @G382PXR 87670800
         AGO   .TCMLAR3                                        @G382PXR 87705100
.TCMLAH2 ANOP                                                  @G382PXR 87739400
         BE    &BRANCH(2)           BRANCH LOCK HELD           @G382PXR 87773700
         AGO   .TCMLEND                                        @G382PXR 87808000
.TCMLAR3 ANOP                                                  @G382PXR 87842300
&LABEL.B LA    15,4(0,0)            LOCK NOT HELD R.C.         @G382PXR 87876600
.TCMLEND ANOP                                                  @G382PXR 87910900
&LABEL.C DC    0H'0'                BRANCH LABEL               @G382PXR 87945200
         MEXIT                                                 @G387PXR 87979500
.*                                                                      88013800
.************************************************************* @G860PXK 88048100
.* BEGINNING OF TEST PROCESSING; TYPE = ALOCAL OR CPU        * @G860PXK 88082400
.************************************************************* @G860PXK 88116700
.*                                                                      88151000
.TALOC   ANOP                                                  @G860PXK 88185300
         AIF   (T'&ADDR NE 'O').ERRAD                              @L8A 88219600
         AIF   (T'&SCOPE NE 'O').NOSCOPE                           @L8A 88253900
         AIF   (T'&REGS NE 'O').REGINV4                            @L8A 88288200
.REGRET4 ANOP                                                      @L8A 88322500
         AIF   (T'&ASCB NE 'O').ERRASCB                            @L8A 88356800
         AIF   (T'&BRANCH EQ 'O').TSTCAL                           @L8A 88391100
         AIF   (N'&BRANCH NE 2).TINVBR                             @L8A 88425400
         AIF   ('&BRANCH(1)' EQ 'HELD').TALOCNN                    @L8A 88459700
         AIF   ('&BRANCH(1)' NE 'NOTHELD').INVCOND                 @L8A 88494000
         AGO   .TALOCNN                                            @L8A 88528300
.*                                                                      88562600
.TSTCAL  ANOP                                                      @L8A 88596900
         AIF   (T'&WORKREG NE 'O').WARNWKD                         @L8A 88631200
.TALOCNN ANOP                                                  @G387PXR 88665500
         AIF   ('&NAME' EQ '').TALCNN2                         @G387PXR 88699800
&NAME    DC    0H'0'                                           @G387PXR 88734100
.TALCNN2 ANOP                                                  @G387PXR 88768400
         AIF   (T'&LOCKHLD EQ 'O').TALOCBR                     @G387PXR 88802700
         AIF   ('&LOCKHLD'(1,1) NE '(').BLKHLD                 @G387PXR 88837000
         AIF   ('&LOCKHLD'(K'&LOCKHLD,1) NE ')').BLKHLD        @G387PXR 88871300
         AIF   (T'&BRANCH NE 'O').TALOC1                       @G387PXR 88905600
         LA    15,4(0,0)            PRESET NOT HELD R.C.       @G387PXR 88939900
.TALOC1  ANOP                                                  @G387PXR 88974200
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 89008500
         AIF   (T'&BRANCH EQ 'O').TALOCRC                      @G387PXR 89042800
         AIF   ('&BRANCH(1)' EQ 'HELD').TALOCHD                @G387PXR 89077100
         BZ    &BRANCH(2)           BRANCH NOT HELD            @G387PXR 89111400
         AIF   ('&TYPE' EQ 'CPU').TCPU1                        @G860PXK 89145700
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0)  LOAD ASCB ADDR   @ZM50156 89180000
*                                   OF LOCKED ADDR. SPACE      @G387PXR 89214300
         MEXIT                                                 @G387PXR 89248600
.TCPU1   ANOP                                                  @G860PXK 89282900
         L     &LOCKHLD(1),PSACPUL-PSA(0,0)   LOAD CPU LOCKS   @G860PXK 89317200
*                                   HELD CNT                            89351500
         MEXIT                                                 @G860PXK 89385800
.TALOCHD ANOP                                                  @G387PXR 89420100
         BZ    &LABEL.A             BRANCH NOT HELD            @G387PXR 89454400
         AIF   ('&TYPE' EQ 'CPU').TCPU2                        @G860PXK 89488700
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0)  LOAD ASCB ADDR   @ZM50156 89523000
*                                   OF LOCKED ADDR. SPACE      @G387PXR 89557300
         AGO   .TCPU2A                                         @G860PXK 89591600
.TCPU2   ANOP                                                  @G860PXK 89625900
         L     &LOCKHLD(1),PSACPUL-PSA(0,0)   LOAD CPU LOCKS   @G860PXK 89660200
*                                   HELD CNT                            89694500
.TCPU2A  ANOP                                                  @G860PXK 89728800
         B     &BRANCH(2)           BRANCH HELD                @G387PXR 89763100
&LABEL.A DC    0H'0'                BRANCH LABEL               @G387PXR 89797400
         MEXIT                                                 @G387PXR 89831700
.TALOCRC ANOP                                                  @G387PXR 89866000
         BZ    &LABEL.B             BRANCH NOT HELD            @G387PXR 89900300
         AIF   ('&TYPE' EQ 'CPU').TCPU3                        @G860PXK 89934600
         L     &LOCKHLD(1),PSALOCAL-PSA(0,0)  LOAD ASCB ADDR   @ZM50156 89968900
*                                   OF LOCKED ADDR. SPACE      @G387PXR 90003200
         AGO   .TCPU3A                                         @G860PXK 90037500
.TCPU3   ANOP                                                  @G860PXK 90071800
         L     &LOCKHLD(1),PSACPUL-PSA(0,0)   LOAD CPU LOCKS   @G860PXK 90106100
*                                   HELD CNT                            90140400
.TCPU3A  ANOP                                                  @G860PXK 90174700
         SLR   15,15                SET LOCK HELD R.C.         @G387PXR 90209000
&LABEL.B DC    0H'0'                BRANCH LABEL               @G387PXR 90243300
         MEXIT                                                 @G387PXR 90277600
.TALOCBR ANOP                                                  @G387PXR 90311900
.*                                                                      90346200
.* NOTE - TEST - NO LOCKHLD PARM SPECIFIED                     @G860PXK 90380500
.*                                                                      90414800
         AIF   (T'&BRANCH NE 'O').TALOC2                       @G387PXR 90449100
         SLR   15,15                PRESET LOCK HELD R.C.      @G387PXR 90483400
.TALOC2  ANOP                                                  @G387PXR 90517700
         TM    PSACLHS-PSA+&BYTE.(0),&MASK  CHECK LOCK HELD    @G387PXR 90552000
         AIF   (T'&BRANCH EQ 'O').TALOCR1                      @G387PXR 90586300
         AIF   ('&BRANCH(1)' EQ 'HELD').TALOCH1                @G387PXR 90620600
         BZ    &BRANCH(2)           BRANCH NOT HELD            @G387PXR 90654900
         MEXIT                                                 @G387PXR 90689200
.TALOCH1 ANOP                                                  @G387PXR 90723500
         BNZ   &BRANCH(2)           BRANCH HELD                @G387PXR 90757800
         MEXIT                                                 @G387PXR 90792100
.TALOCR1 ANOP                                                  @G387PXR 90826400
         BNZ   &LABEL.C             BRANCH HELD                @G860PXK 90860700
         LA    15,4(0,0)            SET LOCK NOT HELD R.C.     @G387PXR 90895000
&LABEL.C DC    0H'0'                BRANCH LABEL               @G387PXR 90929300
         MEXIT                                                 @G387PXR 90963600
.ENDIT   ANOP                                                           90997900
         MEXIT                                                 @G860PXD 91032200
.*                                                                      91066500
.*************************************************************          91100800
.*   MESSAGES ISSUED BY SETLOCK PROCESSING                   *          91135100
.*************************************************************          91169400
.*                                                                      91203700
.ADDREQ  ANOP                                                           91238000
.*       IHB001 ADDR OPERAND REQUIRED, NOT SPECIFIED                    91272300
         IHBERMAC 1006,ADDR                                             91306600
         MEXIT                                                          91340900
.ASCBREQ ANOP                                                  @G387PXR 91375200
.*       IHB001 ASCB OPERAND REQUIRED, NOT SPECIFIED           @G387PXR 91409500
         IHBERMAC 1006,ASCB                                    @G387PXR 91443800
         MEXIT                                                 @G387PXR 91478100
.BADREGS ANOP                                                      @L1A 91512400
.*       IHB002 INVALID REGS OPERAND SPECIFIED - XXX                    91546700
         IHBERMAC 1001,REGS,&REGS                                       91581000
         MEXIT                                                          91615300
.CNOTSUP ANOP                                                           91649600
         MNOTE 8,'*** &TYPE CONDITIONAL OBTAIN NOT SUPPORTED'  @G50EPXS 91683900
         MEXIT                                                 @G50EPXS 91718200
.CONDINC ANOP                                                      @L1A 91752500
.*       IHB280 MODE=(COND,IN) INVALID WITH TYPE=&TYPE             @L1A 91786800
&MESSAGE SETC 'MODE=(COND,IN)'                                     @L1A 91821100
&MESSAG2 SETC 'TYPE='.'&TYPE'                                      @L1A 91855400
         IHBERMAC 1020,&MESSAGE,&MESSAG2                           @L1A 91889700
         MEXIT                                                     @L1A 91924000
.EROALOC ANOP                                                  @G387PXR 91958300
.*       IHB280 ALOCAL INVALID WITH OBTAIN                     @G387PXR 91992600
         IHBERMAC 1020,ALOCAL,OBTAIN                           @G387PXR 92026900
         MEXIT                                                 @G387PXR 92061200
.ERRAD   ANOP                                                           92095500
.*       IHB280 ADDR INVALID WITH TYPE=XXX                              92129800
&MESSAGE SETC 'TYPE='.'&TYPE'                                           92164100
         IHBERMAC 1020,ADDR,&MESSAGE                                    92198400
         MEXIT                                                          92232700
.ERRALOC ANOP                                                  @G387PXR 92267000
.*       IHB280 ALOCAL INVALID WITH RELEASE                    @G387PXR 92301300
         IHBERMAC 1020,ALOCAL,RELEASE                          @G387PXR 92335600
         MEXIT                                                 @G387PXR 92369900
.ERRASCB ANOP                                                  @G387PXR 92404200
.*       IHB280 ASCB INVALID WITH TYPE=XXX                     @G387PXR 92438500
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G387PXR 92472800
         IHBERMAC 1020,ASCB,&MESSAGE                           @G387PXR 92507100
         MEXIT                                                 @G387PXR 92541400
.ERRBR   ANOP                                                           92575700
.*       IHB280 BRANCH INVALID WITH OBTAIN/RELEASE                      92610000
         IHBERMAC 1020,BRANCH,&REQUEST                                  92644300
         MEXIT                                                          92678600
.ERRDIS1 ANOP                                                  @G860PXA 92712900
.*       IHB244 INVALID POSIT-NL XXX OPERAND                            92747200
         IHBERMAC 1008,&DISABLE,1                                       92781500
         MEXIT                                                          92815800
.ERRDIS2 ANOP                                                           92850100
.*       IHB280 DISABLE INVALID WITH CMS/LOCAL/CML/CPU                  92884400
         IHBERMAC 1020,&DISABLE,&TYPE                                   92918700
         MEXIT                                                          92953000
.ERRDIS3 ANOP                                                           92987300
.*       IHB280 DISABLE INVALID WITH COND OR SUSPEND LOCK OBTAIN        93021600
&MESSAGE SETC 'COND OR SUSPEND LOCK OBTAIN'                             93055900
         IHBERMAC 1020,&DISABLE,&MESSAGE                                93090200
         MEXIT                                                          93124500
.ERREG1  ANOP                                                           93158800
.*       IHB280 REGISTER NOTATION INVALID WITH ADDR                     93193100
&MESSAGE SETC 'REGISTER NOTATION'                                       93227400
         IHBERMAC 1020,&MESSAGE,ADDR                                    93261700
         MEXIT                                                          93296000
.ERREG2  ANOP                                                  @G387PXR 93330300
.*       IHB280 REGISTER NOTATION INVALID WITH ASCB            @G387PXR 93364600
&MESSAGE SETC 'REGISTER NOTATION'                              @G387PXR 93398900
         IHBERMAC 1020,&MESSAGE,ASCB                           @G387PXR 93433200
         MEXIT                                                 @G387PXR 93467500
.ERRLHLD ANOP                                                      @L8A 93501800
.*       IHB280 LOCKHLD INVALID WITH OBTAIN/RELEASE                @L8A 93536100
         IHBERMAC 1020,LOCKHLD,&REQUEST                            @L8A 93570400
         MEXIT                                                     @L8A 93604700
.ERRLOCK ANOP                                                  @G387PXR 93639000
.*       IHB280 LOCKHLD INVALID WITH TYPE=XXX                  @G387PXR 93673300
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G387PXR 93707600
         IHBERMAC 1020,LOCKHLD,&MESSAGE                        @G387PXR 93741900
         MEXIT                                                 @G387PXR 93776200
.ERRMODE ANOP                                                           93810500
.*       IHB280 MODE INVALID WITH RELEASE                               93844800
         IHBERMAC 1020,MODE,RELEASE                                     93879100
         MEXIT                                                          93913400
.ERRREQ  ANOP                                                           93947700
         IHBERMAC 24                                                    93982000
         MEXIT                                                          94016300
.ERRTYPE ANOP                                                  @G387PXR 94050600
.*       IHB001 TYPE OPERAND REQUIRED, NOT SPECIFIED           @G387PXR 94084900
         IHBERMAC 1006,TYPE                                    @G387PXR 94119200
         MEXIT                                                 @G387PXR 94153500
.ERRWK   ANOP                                                           94187800
         MNOTE 12,'WORKREG KEYWORD IS NOT VALID WITH OBTAIN/RELEASE'    94222100
         MEXIT                                                          94256400
.INVCOND ANOP                                                           94290700
.*       IHB002 INVALID BRANCH OPERAND SPECIFIED - XXX                  94325000
         IHBERMAC 1001,BRANCH,&BRANCH(1)                                94359300
         MEXIT                                                          94393600
.INVDIS  ANOP                                                  @G860PXA 94427900
.*       IHB280 DISABLE INVALID WITH CPU                       @G860PXA 94462200
         IHBERMAC 1020,&DISABLE,&TYPE                          @G860PXA 94496500
         MEXIT                                                 @G860PXA 94530800
.INVMODE ANOP                                                           94565100
.*       IHB280 MODE INVALID WITH TEST                                  94599400
         IHBERMAC 1020,MODE,TEST                                        94633700
         MEXIT                                                          94668000
.INVSCOP ANOP                                                  @G860PXA 94702300
.*       IHB002 INVALID SCOPE OPERAND SPECIFIED - XXX          @G860PXA 94736600
         IHBERMAC 1001,SCOPE,&SCOPE                            @G860PXA 94770900
         MEXIT                                                 @G860PXA 94805200
.INVTYP  ANOP                                                           94839500
.*       IHB002 INVALID TYPE OPERAND SPECIFIED - XXX                    94873800
         IHBERMAC 1001,TYPE,&TYPE                                       94908100
         MEXIT                                                          94942400
.INVWKRG ANOP                                                      @L8A 94976700
.*       IHB280 WORKREG INVALID WITH TYPE=(REG)                    @L8A 95011000
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G387PXR 95045300
         IHBERMAC 1020,WORKREG,&MESSAGE                        @G387PXR 95079600
         MEXIT                                                 @G387PXR 95113900
.LKASREQ ANOP                                                  @G387PXR 95148200
.*       IHB001 LOCKHLD/ASCB OPERAND REQUIRED NOT SPECIFIED    @G387PXR 95182500
         IHBERMAC 1006,LOCKHLD/ASCB                            @G387PXR 95216800
         MEXIT                                                 @G387PXR 95251100
.LKHINV  ANOP                                                  @G387PXR 95285400
.*       IHB280 LOCKHLD INVALID WITH ASCB                      @G387PXR 95319700
         IHBERMAC 1020,LOCKHLD,ASCB                            @G387PXR 95354000
         MEXIT                                                 @G387PXR 95388300
.MODERR  ANOP                                                           95422600
.*       IHB002 INVALID MODE OPERAND SPECIFIED - XXX                    95456900
         IHBERMAC 1001,MODE,&MODE                                       95491200
         MEXIT                                                          95525500
.NODIS   ANOP                                                           95559800
.*       IHB280 DISABLED INVALID WITH TEST                              95594100
         IHBERMAC 1020,&DISABLE,TEST                                    95628400
         MEXIT                                                          95662700
.NOLOCK  ANOP                                                           95697000
         MNOTE 12,'LOCK KEYWORD IS NOT VALID WITH OBTAIN/RELEASE'       95731300
         MEXIT                                                          95765600
.NOMODE  ANOP                                                           95799900
.*       IHB001 MODE OPERAND REQUIRED, NOT SPECIFIED                    95834200
         IHBERMAC 1006,MODE                                             95868500
         MEXIT                                                          95902800
.NOREGS  ANOP                                                      @L8A 95937100
.*       IHB280 REGS INVALID WITH TYPE=XXX                         @L8A 95971400
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G860PXA 96005700
         IHBERMAC 1020,REGS,&MESSAGE                               @L8A 96040000
         MEXIT                                                     @L8A 96074300
.NOSCOPE ANOP                                                  @G860PXA 96108600
.*       IHB280 SCOPE INVALID WITH TYPE=XXX                    @G860PXA 96142900
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @G860PXA 96177200
         IHBERMAC 1020,SCOPE,&MESSAGE                          @G860PXA 96211500
         MEXIT                                                 @G860PXA 96245800
.NOTAREG ANOP                                                      @L8A 96280100
         MNOTE 12,'WORKREG REQUIRES A REGISTER OPERAND'            @L8A 96314400
         MEXIT                                                     @L8A 96348700
.NOTYP   ANOP                                                           96383000
.*       IHB001 TYPE OPERAND REQUIRED, NOT SPECIFIED                    96417300
         IHBERMAC 1006,TYPE                                             96451600
         MEXIT                                                          96485900
.NOWKREG ANOP                                                      @L8A 96520200
         MNOTE 12,'WORKREG IS REQUIRED WITH BRANCH'                @L8A 96554500
         MEXIT                                                          96588800
.REGINV4 ANOP                                                      @L8A 96623100
         MNOTE 0,'REGS IGNORED WITH SPECIFIED TYPE'                @L8A 96657400
         AGO .REGRET4                                              @L8A 96691700
.REGREQ  ANOP                                                      @L8A 96726000
.*       IHB001 WITH BRANCH OPTION OF TYPE=REG,REGS REQUIRED NOT SPECI- 96760300
.*       FIED                                                           96794600
&MESSAGE SETC  'WITH BRANCH OPTION OF TYPE='.'&TYPE'.', REGS'           96828900
         IHBERMAC 1006,&MESSAGE                                         96863200
         MEXIT                                                          96897500
.RREGASI ANOP                                                      @L8A 96931800
.*       IHB280 ASCB INVALID WITH TYPE=REG                         @L8A 96966100
&MESSAGE SETC 'TYPE='.'&TYPE'                                      @L8A 97000400
         IHBERMAC 1020,ASCB,&MESSAGE                               @L8A 97034700
         MEXIT                                                          97069000
.RREGLKH ANOP                                                      @L8A 97103300
.*       IHB280 LOCKHLD INVALID WITH TYPE=REG                      @L8A 97137600
&MESSAGE SETC 'TYPE='.'&TYPE'                                      @L8A 97171900
         IHBERMAC 1020,LOCKHLD,&MESSAGE                            @L8A 97206200
         MEXIT                                                          97240500
.SCOPREQ ANOP                                                  @G860PXA 97274800
.*       IHB001 SCOPE OPERAND REQUIRED, NOT SPECIFIED          @G860PXA 97309100
         IHBERMAC 1006,SCOPE                                   @G860PXA 97343400
         MEXIT                                                 @G860PXA 97377700
.BLKHLD  ANOP                                                  @G387PXR 97412000
.*       IHB002 INVALID LOCKHLD OPERAND SPECIFIED - XXX        @G387PXR 97446300
         IHBERMAC 1001,LOCKHLD,&LOCKHLD                        @G387PXR 97480600
         MEXIT                                                 @G387PXR 97514900
.TCMLANV ANOP                                                  @G387PXR 97549200
.*       IHB002  INVALID ASCB OPERAND SPECIFIED - XXX          @G387PXR 97583500
         IHBERMAC 1001,ASCB,&ASCB                              @G387PXR 97617800
         MEXIT                                                 @G387PXR 97652100
.TERR007 ANOP                                                  @G860PXA 97686400
.*       IHB001 LOCK OPERAND REQUIRED, NOT SPECIFIED           @G860PXA 97720700
         IHBERMAC 1006,LOCK                                    @G860PXA 97755000
         MEXIT                                                 @G860PXA 97789300
.TERR008 ANOP                                                  @G860PXA 97823600
.*       IHB002 INVALID LOCK OPERAND SPECIFIED                 @G860PXA 97857900
         IHBERMAC 1001,LOCK,&LOCK                              @G860PXA 97892200
         MEXIT                                                 @G860PXA 97926500
.TERR009 ANOP                                                      @L8A 97960800
.*       IHB280 LOCK INVALID WITH TYPE=XXX                         @L8A 97995100
&MESSAGE SETC 'TYPE='.'&TYPE'                                      @L8A 98029400
         IHBERMAC 1020,LOCK,&MESSAGE                               @L8A 98063700
         MEXIT                                                     @L8A 98098000
.TINVBR  ANOP                                                      @L8A 98132300
         MNOTE 12,'TWO BRANCH VALUES ARE REQUIRED'                 @L8A 98166600
         MEXIT                                                          98200900
.TINVWK  ANOP                                                      @L8A 98235200
         MNOTE 12,'ONE WORKREG VALUE IS REQUIRED'                  @L8A 98269500
         MEXIT                                                     @L8A 98303800
.TREGCA  ANOP                                                  @G387PXR 98338100
.*       IHB280 ASCB INVALID WITH TYPE=REG                     @G387PXR 98372400
&MESSAGE SETC   'TYPE='.'&TYPE'                                @G387PXR 98406700
         IHBERMAC 1020,ASCB,&MESSAGE                           @G387PXR 98441000
         MEXIT                                                 @G387PXR 98475300
.TSTBADR ANOP                                                           98509600
.*       IHB002 INVALID ADDR OPERAND SPECIFIED - XXX                    98543900
         IHBERMAC 1001,ADDR,&ADDR                                       98578200
         MEXIT                                                          98612500
.ERRVSE1 ANOP                                                  @D64ADTN 98614701
&MESSAGE SETC 'TYPE='.'&TYPE'                                  @D64ADTN 98616901
         IHBERMAC 1309,&MESSAGE        INVALID FOR VSE/ESA     @D64ADTN 98619101
         MEXIT                                                 @D64ADTN 98621301
.ERRVSE2 ANOP                                                  @D64ADTN 98623501
&MESSAGE SETC 'MODE='.'&MODE'          MODE=(COND,IN)          @D64ADTN 98625701
         IHBERMAC 1309,&MESSAGE        INVALID FOR VSE/ESA     @D64ADTN 98627901
         MEXIT                                                 @D64ADTN 98630101
.ERRVSE3 ANOP                                                  @D64ADTN 98632301
         IHBERMAC 1309,LOCK            INVALID FOR VSE/ESA     @D64ADTN 98634501
         MEXIT                                                 @D64ADTN 98636701
.ERRVSE4 ANOP                                                  @D64ADTN 98638901
         IHBERMAC 1309,WORKREG         INVALID FOR VSE/ESA     @D64ADTN 98641101
         MEXIT                                                 @D64ADTN 98643301
.WARNWK  ANOP                                                      @L8A 98646800
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 98681100
         AGO   .WRNWKR                                             @L8A 98715400
.WARNWK2 ANOP                                                      @L8A 98749700
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 98784000
         AGO   .WRNWKR2                                            @L8A 98818300
.WARNWK5 ANOP                                                      @L8A 98852600
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 98886900
         AGO   .NN5                                                @L8A 98921200
.WARNWKA ANOP                                                      @L8A 98955500
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 98989800
         AGO   .NAMCK                                              @L8A 99024100
.WARNWKB ANOP                                                      @L8A 99058400
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 99092700
         AGO   .WRNWKRB                                            @L8A 99127000
.WARNWKC ANOP                                                      @L8A 99161300
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 99195600
         AGO   .CMLPROC                                            @L8A 99229900
.WARNWKD ANOP                                                      @L8A 99264200
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 99298500
         AGO   .TALOCNN                                            @L8A 99332800
.WARNWKE ANOP                                                      @L8A 99367100
         MNOTE 0,'WORKREG IGNORED WITHOUT BRANCH'                  @L8A 99401400
         AGO   .WRNWKRE                                            @L8A 99435700
.LEVEL1  ANOP                                                  @G860PXD 99470000
&NAME    SETLOCK8 &REQUEST,TYPE=&TYPE,ADDR=&ADDR,MODE=&MODE,   @G860PXD-99504300
               RELATED=&RELATED,REGS=&REGS,BRANCH=&BRANCH,     @G860PXD-99538600
               ASCB=&ASCB,LOCKHLD=&LOCKHLD,&DISABLE,               @P3C-99572900
               LOCK=&LOCK,SCOPE=&SCOPE                             @P3C 99607200
         MEXIT                                                 @G860PXD 99641500
         MEND                                                           99675800
* */                                                                    99710100
*  SETLOCK :                                                            99744400
*  MACRO                                                                99778700
*  KEYS(TYPE,ADDR,MODE,DISABLED,ASCB,SCOPE,REGS,LOCK,      /*@ZMC0463*/ 99813000
*       BRANCH,LOCKHLD,WORKREG,RELATED);                   /*    @L8C*/ 99847300
*  ANS('?'||MACLABEL||'SETLOCKP '||MACLIST||MACKEYS||';');              99881600
*% END;                                                                 99915900
