         MACRO                                                          00050001
&NAME    GENSERV &OP,&FIELD=,&REG=,&BC=,&LAB=,&COMPF=,                 -00100001
               &PGONT=,&DAT=OFF,                                       -00137501
               &PSLVAL=,&PSLSTAT=(R3),&PSLOFF=(R4),                    -00175001
               &PFTE=,&IORE=,&VPTE=,                                   -00212501
               &RREG=,&VADD=,&ERR=,                                    -00250001
               &PIK=,&PCB=,                                            -00275001
               &SCB=,&EPA=,&WORKR=(R3,R4,R5),                          -00300001
               &BLVAL=,                                                -00325001
               &RPTE=                                                   00350001
.*                                                                      00400001
         GBLB    &BGDEBUG    DEBUG                                      00408301
         GBLA    &FRM        FORMAT                                     00412401
         LCLB    &BCR        COMPARE SPECIFIFIED                        00416601
         LCLB    &BTST       TEST REQUESTED                             00424901
         LCLB    &BCMP       COMPARE REUESTED                           00433201
         LCLA    &OPC        OPERATION                                  00450001
         LCLC    &PFTER      REGISTER FOR PFTE ADDRESS                  00500001
         LCLC    &RG         REGISTER VALUE - WORK                      00650001
         LCLC    &RRG        REGISTER VALUE - REAL OUTPUT               00700001
         LCLC    &VRG        REGISTER VALUE - VIRTUAL INPUT             00750001
         LCLC    &SPA        REGISTER VALUE - SCB POINTER               00800001
         LCLC    &WR1        WORKREGISTER                               00850001
         LCLC    &WR2        WORKREGISTER                               00900001
         LCLC    &WR3        WORKREGISTER                               00950001
         LCLC    &LB         LABEL / REGISTER                           01050001
         LCLC    &CBR        BRANCHCODE                                 01100001
         LCLC    &CCL        COMPARE OPCODE                             01150001
         LCLC    &CLO        LOAD  OPCODE                               01200001
         LCLC    &CST        STORE OPCODE                               01250001
         LCLC    &CAD        ADD   OPCODE                               01300001
         LCLC    &CSU        SUBTR OPCODE                               01350001
         LCLC    &PAR        PARAMETER                                  01400001
         LCLC    &PAR1       PARAMETER                                  01450001
         LCLC    &CF         COMPARE FIELD / REGISTER                   01500001
         LCLC    &CFLD       FIELD                                      01550001
.*                                                                      01600001
.*************************************************************          01850001
.* IBM DISK OPERATING SYSTEM                                            01900001
.* SUPERVISOR - GENSERV 5686-007-06                                     01950001
.*************************************************************          02000001
.*                                                           *          02050001
.*       LICENSED MATERIALS - PROPERTY OF IBM                *          02100001
.*       THIS MACRO IS "RESTRICTED MATERIALS OF IBM"         *          02150001
.*       5686-032 (C) COPYRIGHT IBM CORP. 1992               *          02200001
.*       SEE COPYRIGHT INSTRUCTIONS                          *          02250001
.*                                                           *          02300001
.*A000000-A999999                                            * @D52VDVB 02350001
.*************************************************************          02400001
         AIF   ( '&OP' EQ 'COUNT'  ).GENS000                            02425001
         AIF   ( '&OP' EQ 'LRADBG' ).GENS000                            02450001
         AIF   ( '&OP' EQ 'IPTE'   ).GENS000                            02500001
         AIF   ( '&OP' EQ 'RPTE'   ).GENS000                            02550001
         AIF   ( '&OP' EQ 'PSLOFFS').GENS000                            02562401
         AIF   ( '&OP' EQ 'PGONT'  ).GENS000                            02566601
         AIF   ( '&OP' EQ 'VPTE'   ).GENS000                            02574901
         AIF   ( '&OP' EQ 'PAGE'   ).GENS000                            02583201
         AIF   ( '&OP' EQ 'GETPCB' ).GENS000                            02591501
         AIF   ( T'&FIELD  EQ 'O' ).ERR010   FIELD NAME MISSING         02600001
.GENS000 ANOP                                                           02650001
.*-------------------------------------------------------------------*  02700001
.*   OPERATIONS:                                                     *  02750001
.*   -----------                                                     *  02800001
.*    TYPE A:  PMR SERVIVE AIDS                                      *  02850001
.*                                                                   *  02950001
.*       RPTE    (PFTE=(R1)|EPA=(R1) SCB=(R0)) RPTE(R2) WORK=(R3,R4,R5) 02960001
.*                                                                   *  02970001
.*       VPTE    PFTE=(R1) VPTE(R2) WORK=(R3) DAT=                   *  02980001
.*                                                                   *  02990001
.*       PAGE    PFTE=(R1) VADD(R2) WORK=(R3,R4) DAT=                *  03000001
.*                                                                   *  03010001
.*       GETPCB  PIK=(R1) PCB=(R2)                                   *  03020001
.*                                                                   *  03030001
.*       IPTE    (VADD=(R1)|EPA=(R1) SCB=(R2)) WORK=(R3,R4)          *  03040001
.*                                                                   *  03050001
.*       LRADBG  RREG=(R1) VADD=(R2) ERR=ERRORCONDITION              *  03100001
.*                                                                   *  03150001
.*       PGONT   IORE=(R1) PSLSTAT=(R3) PGONT=(R4) PSLVAL=(R5) DAT=  *  03283301
.*               | PSLVAL=(R3) PGONT=(R4) DAT=                       *  03305501
.*       PSLOFFS IORE=(R1) PSLOFF=(R2) WORKR(R3)                     *  03327701
.*                                                                   *  03350001
.*       COUNT   FIELD= REG=0  WORK=(R4) BLKVAL=(R3)                 *  03366601
.*                                                                   *  03383201
.*                                                                   *  03400001
.*    TYPE B:  FIELD SERVICES                                        *  03450001
.*                                                                   *  03500001
.*       SET0    FIELD=                                              *  03550001
.*                                                                   *  03600001
.*       SET1    FIELD=                                              *  03650001
.*                                                                   *  03700001
.*       GETF    FIELD= REG=0                                        *  03750001
.*                                                                   *  03800001
.*       PUTF    FIELD= REG=0                                        *  03850001
.*                                                                   *  03900001
.*       ADDF    FIELD= REG=0                                        *  03950001
.*                                                                   *  04000001
.*       SUBF    FIELD= REG=0                                        *  04050001
.*                                                                   *  04100001
.*       COMF    FIELD= REG=0  BC=BRC LAB=LABEL                      *  04116601
.*                                                                   *  04133201
.*       INCR    FIELD= REG=0                                        *  04150001
.*                                                                   *  04200001
.*       DECR    FIELD= REG=0                                        *  04250001
.*                                                                   *  04300001
.*       TEST    FIELD= REG=0  BC=BRC LAB=LABEL                      *  04350001
.*                                                                   *  04400001
.*       COMP    FIELD= REG=0  BC=    LAB=  COMPF=(FWORD|(R))        *  04450001
.*                                                                   *  04500001
.*       INCTEST FIELD= REG=0  BC=    LAB=                           *  04550001
.*                                                                   *  04600001
.*       DECTEST FIELD= REG=0  BC=    LAB=                           *  04650001
.*                                                                   *  04700001
.*       TESTINC FIELD= REG=0  BC=    LAB=                           *  04750001
.*                                                                   *  04800001
.*       TESTDEC FIELD= REG=0  BC=    LAB=                           *  04850001
.*                                                                   *  04900001
.*       INCOMP  FIELD= REG=0  BC=    LAB=  COMPF=                   *  04950001
.*                                                                   *  05000001
.*       DECOMP  FIELD= REG=0  BC=    LAB=  COMPF=                   *  05050001
.*                                                                   *  05100001
.*       COMPINC FIELD= REG=0  BC=    LAB=  COMPF=                   *  05150001
.*                                                                   *  05200001
.*       COMPDEC FIELD= REG=0  BC=    LAB=  COMPF=                   *  05250001
.*                                                                   *  05260000
.*    TYPE C:  DEBUG CALLS                                           *  05270000
.*                                                                   *  05280000
.*       DEBUG   FIELD= FCHENTRY                                     *  05290000
.*-------------------------------------------------------------------*  05300001
&BCR     SETB  0                                                        05350001
&BCMP    SETB  0                                                        05400001
&BTST    SETB  0                                                        05450001
&CFLD    SETC  '&FIELD'                                                 05500001
&CF      SETC  ' '                                                      05550001
&LB      SETC  ' '                                                      05600001
&RG      SETC  '0'                                                      05650001
&CBR     SETC  ' '                                                      05700001
&VRG     SETC  ' '                                                      05750001
.*                                                                      05800001
&OPC     SETA  1                         INCREASE                       05850001
         AIF   ('&OP' EQ 'INC').CHECKFM                  1              05900001
&OPC     SETA  &OPC+1                    INCREASE + TEST                05950001
         AIF   ('&OP' EQ 'INCTEST').SETTST               2              06000001
&OPC     SETA  &OPC+1                    INCREASE + COMPARE             06050001
         AIF   ('&OP' EQ 'INCOMP').SETCMP                3              06100001
&OPC     SETA  &OPC+1                    DECREASE                       06150001
         AIF   ('&OP' EQ 'DEC').CHECKFM                  4              06200001
&OPC     SETA  &OPC+1                    DECREASE + TEST                06250001
         AIF   ('&OP' EQ 'DECTEST').SETTST               5              06300001
&OPC     SETA  &OPC+1                    DECREASE + COMPARE             06350001
         AIF   ('&OP' EQ 'DECOMP').SETCMP                6              06400001
&OPC     SETA  &OPC+1                    COMPARE                        06450001
         AIF   ('&OP' EQ 'COMP').SETCMP                  7              06500001
&OPC     SETA  &OPC+1                    TEST                           06550001
         AIF   ('&OP' EQ 'TEST').SETTST                  8              06600001
&OPC     SETA  &OPC+1                    TEST + DECREASE                06650001
         AIF   ('&OP' EQ 'TESTDEC').SETTST               9              06700001
&OPC     SETA  &OPC+1                    COMPARE + DECREASE             06750001
         AIF   ('&OP' EQ 'COMPDEC').SETCMP              10              06800001
&OPC     SETA  &OPC+1                    TEST + INCREASE                06850001
         AIF   ('&OP' EQ 'TESTINC').SETTST              11              06900001
&OPC     SETA  &OPC+1                    COMPARE + INCREASE             06950001
         AIF   ('&OP' EQ 'COMPINC').SETCMP              12              07000001
&OPC     SETA  &OPC+1                    SET TO ZERO                    07050001
         AIF   ('&OP' EQ 'SET0'   ).CHECKFM             13              07100001
&OPC     SETA  &OPC+1                    SET TO ONE                     07150001
         AIF   ('&OP' EQ 'SET1'   ).CHECKFM             14              07200001
&OPC     SETA  &OPC+1                    GET CURRENT VALUE              07250001
         AIF   ('&OP' EQ 'GETF'   ).CHECKFM             15              07300001
&OPC     SETA  &OPC+1                    STORE CURRENT VALUE            07350001
         AIF   ('&OP' EQ 'PUTF'   ).CHECKFM             16              07400001
&OPC     SETA  &OPC+1                    ADD TO REGISTER                07450001
         AIF   ('&OP' EQ 'ADDF'   ).CHECKFM             17              07500001
&OPC     SETA  &OPC+1                    ADD TO REGISTER                07550001
         AIF   ('&OP' EQ 'SUBF'   ).CHECKFM             18              07600001
&OPC     SETA  &OPC+1                    ADD TO REGISTER                07605001
         AIF   ('&OP' EQ 'COMF'   ).SETTST              19              07610001
&OPC     SETA  50                                                       07615001
         AIF   ('&OP' EQ 'VPTE'   ).VPTECHK             50              07630001
&OPC     SETA  51                        RESERVED                       07652501
&OPC     SETA  52                        PRE PAGE OUT ENTRY / IORE      07675001
         AIF   ('&OP' EQ 'PGONT'  ).PGNTCHK             52              07690001
.*       SETA  53                        OCCUPIED BY PRE-PAGE-OUT       07705001
&OPC     SETA  54                        PAGE                           07720001
         AIF   ('&OP' EQ 'PAGE'   ).PAGECHK             54              07735001
&OPC     SETA  55                        PSLOFFSET                      07740001
         AIF   ('&OP' EQ 'PSLOFFS').POFFCHK             55              07745001
&OPC     SETA  60                        LRA AND CHECK                  07750001
         AIF   ('&OP' EQ 'LRADBG' ).LRADBG              60              07800001
&OPC     SETA  61                        IPTE EXTENSION                 07850001
         AIF   ('&OP' EQ 'IPTE'   ).IPTECHK             61              07900001
&OPC     SETA  62                        IPTE EXTENSION                 07950001
         AIF   ('&OP' EQ 'RPTE'   ).RPTECHK             62              08000001
&OPC     SETA  63                        GETPCB EXTENSION               08016601
         AIF   ('&OP' EQ 'GETPCB' ).GTPCBCK             63              08033201
&OPC     SETA  64                        FREE                           08035001
&OPC     SETA  65                        FREE                           08036801
&OPC     SETA  66                        FREE                           08038601
&OPC     SETA  67                        FREE                           08040401
&OPC     SETA  68                        FREE                           08042201
&OPC     SETA  69                        FREE                           08044001
&OPC     SETA  70                        COUNT BLOCKED PAGE I/O         08045801
         AIF   ('&OP' EQ 'COUNT'  ).COUNCHK             70              08047601
&OPC     SETA  71                        DEBUG                          08048400
         AIF   ('&OP' EQ 'DEBUG'  ).GENCODE             81              08049200
         AGO   .ERR000                                                  08050001
.*                                                                      08100001
         AIF   ( T'&NAME  EQ 'O').NONAME                                08150001
&NAME    DS    0H                                                       08200001
.NONAME  ANOP                                                           08250001
.*                                                                      08300001
.*--------------------------------------------------------------------* 08301001
.GTPCBCK ANOP                                                           08302001
&PAR     SETC  'PIK'                                                    08303001
         AIF   (T'&PIK   EQ 'O'   ).ERR130                              08304001
         AIF   ('&PIK'(1,1) NE '(').ERR030                              08305001
&PAR     SETC  'PCB'                                                    08306001
         AIF   (T'&PCB  EQ 'O'    ).ERR130                              08307001
         AIF   ('&PCB'(1,1) NE '(').ERR030                              08308001
&WR1     SETC  '&PIK'(2,K'&PIK-2)                                       08309001
&WR2     SETC  '&PCB'(2,K'&PCB-2)                                       08310001
         AGO   .GENCODE                                                 08311001
.*--------------------------------------------------------------------* 08312001
.PAGECHK ANOP                                                           08313001
&PAR     SETC  'PFTE'                                                   08314001
         AIF   (T'&PFTE  EQ 'O'    ).ERR130                             08315001
         AIF   ('&PFTE'(1,1) NE '(').ERR030                             08316001
&PAR     SETC  'VADD'                                                   08317001
         AIF   (T'&VADD  EQ 'O'    ).ERR130                             08318001
         AIF   ('&VADD'(1,1) NE '(').ERR030                             08319001
         AIF   ('&DAT' NE 'OFF' AND '&DAT' NE 'ON').ERR110              08320001
&VRG     SETC  '&VADD'(2,K'&VADD-2)                                     08321001
&RRG     SETC  '&PFTE'(2,K'&PFTE-2)                                     08322001
&WR1     SETC  '&WORKR(1)'                                              08323001
&WR2     SETC  '&WORKR(2)'                                              08324001
         AIF   ('&RRG'      EQ '&VRG'      ).ERR170                     08325001
         AIF   ('&WR1'      EQ '&VRG'      ).ERR170                     08326001
         AIF   ('&WR1'      EQ '&RRG'      ).ERR170                     08327001
         AIF   ('&WR2'      EQ '&VRG'      ).ERR170                     08328001
         AIF   ('&WR2'      EQ '&RRG'      ).ERR170                     08329001
         AIF   ('&WR2'      EQ '&WR1'      ).ERR170                     08330001
         AGO   .GENCODE                                                 08331001
.*--------------------------------------------------------------------* 08332001
.VPTECHK ANOP                                                           08333001
&PAR     SETC  'PFTE'                                                   08334001
         AIF   (T'&PFTE  EQ 'O' ).ERR130                                08335001
         AIF   ('&PFTE'(1,1) NE '(').ERR030                             08336001
&PAR     SETC  'VPTE'                                                   08337001
         AIF   (T'&VPTE  EQ 'O'    ).ERR130                             08338001
         AIF   ('&VPTE'(1,1) NE '(').ERR030                             08339001
         AIF   ('&DAT' NE 'OFF' AND '&DAT' NE 'ON' AND '&DAT' NE       *08339601
               'OFFON' ).ERR110             *                           08340201
&VRG     SETC  '&VPTE'(2,K'&VPTE-2)                                     08341001
&RRG     SETC  '&PFTE'(2,K'&PFTE-2)                                     08342001
&WR1     SETC  '&WORKR(1)'                                              08343001
         AIF   ('&RRG'      EQ '&VRG'      ).ERR170                     08344001
         AIF   ('&WR1'      EQ '&VRG'      ).ERR170                     08345001
         AIF   ('&WR1'      EQ '&RRG'      ).ERR170                     08346001
         AGO   .GENCODE                                                 08347001
.*--------------------------------------------------------------------* 08350001
.RPTECHK ANOP                                                           08400001
&PAR     SETC  'PFTE'                                                   08450001
&PAR1    SETC  'EPA'                                                    08500001
         AIF   (T'&PFTE  EQ 'O' AND T'&EPA EQ 'O').ERR140               08550001
         AIF   (T'&PFTE  NE 'O' AND T'&EPA NE 'O').ERR200               08600001
         AIF   (T'&PFTE  EQ 'O' ).RPTD000                               08650001
         AIF   ('&PFTE'(1,1) NE '(').ERR030                             08700001
         AGO   .RPTD010                                                 08750001
.RPTD000 ANOP                                                           08800001
&PAR     SETC  'EPA'                                                    08850001
&PAR1    SETC  'SCB'                                                    08900001
         AIF   (T'&SCB  EQ  'O'    ).ERR210                             08950001
         AIF   ('&EPA'(1,1) NE '(' ).ERR030                             09000001
&PAR     SETC  'SCB'                                                    09050001
         AIF   ('&SCB'(1,1) NE '(' ).ERR030                             09100001
&SPA     SETC  '&SCB'(2,K'&SCB-2)                                       09150001
.RPTD010 ANOP                                                           09200001
&PAR     SETC  'RPTE'                                                   09250001
         AIF   (T'&RPTE  EQ 'O'    ).ERR130                             09300001
         AIF   ('&RPTE'(1,1) NE '(').ERR030                             09350001
&RRG     SETC  '&RPTE'(2,K'&RPTE-2)                                     09400001
         AIF   (T'&PFTE  EQ 'O' ).RPTD020                               09450001
&VRG     SETC  '&PFTE'(2,K'&PFTE-2)                                     09500001
         AGO   .RPTD030                                                 09550001
.RPTD020 ANOP                                                           09600001
&VRG     SETC  '&EPA'(2,K'&EPA-2)                                       09650001
.RPTD030 ANOP                                                           09700001
&WR1     SETC  '&WORKR(1)'                                              10550001
&WR2     SETC  '&WORKR(2)'                                              10600001
&WR3     SETC  '&WORKR(3)'                                              10650001
         AIF   ( N'&WORKR NE  3            ).ERR170                     10652901
         AIF   ('&WORKR'(1,1) NE '('       ).ERR170                     10655801
         AIF   ('&WR1' EQ '&VRG'           ).ERR170                     10658701
         AIF   ('&WR2' EQ '&VRG'           ).ERR170                     10661601
         AIF   ('&WR3' EQ '&VRG'           ).ERR170                     10664501
         AIF   ('&WR1' EQ '&WR2'           ).ERR180                     10667401
         AIF   ('&WR2' EQ '&WR3'           ).ERR180                     10670301
         AIF   ('&WR1' EQ '&WR3'           ).ERR180                     10673201
         AIF   ('&WR1' EQ '&RRG'           ).ERR170                     10676101
         AIF   ('&WR2' EQ '&RRG'           ).ERR170                     10679001
         AIF   ('&WR3' EQ '&RRG'           ).ERR170                     10681901
         AIF   ('&WR1' EQ '&SPA'           ).ERR170                     10684801
         AIF   ('&WR2' EQ '&SPA'           ).ERR170                     10687701
         AIF   ('&WR3' EQ '&SPA'           ).ERR170                     10690601
         AIF   ('&SPA' EQ '&VRG'           ).ERR170                     10693501
.*                                                                      10696401
         AGO   .GENCODE                                                 10700001
.*--------------------------------------------------------------------* 10750001
.IPTECHK ANOP                                                           10800001
&PAR     SETC  'VADD'                                                   10850001
&PAR1    SETC  'EPA'                                                    10900001
         AIF   (T'&VADD  EQ 'O' AND T'&EPA EQ 'O').ERR140               10950001
         AIF   (T'&VADD  NE 'O' AND T'&EPA NE 'O').ERR200               11000001
         AIF   (T'&VADD  EQ 'O' ).IPTD000                               11050001
         AIF   ('&VADD'(1,1) NE '(').ERR030                             11100001
         AGO   .IPTD010                                                 11150001
.IPTD000 ANOP                                                           11200001
&PAR     SETC  'EPA'                                                    11250001
         AIF   ('&EPA'(1,1) NE '(').ERR030                              11300001
.IPTD010 ANOP                                                           11350001
         AIF   (T'&SCB      EQ 'O').ERR150                              11400001
&PAR     SETC  'SCB'                                                    11450001
         AIF   ('&SCB'(1,1) NE '(').ERR030                              11500001
&SPA     SETC  '&SCB'(2,K'&SCB-2)                                       11550001
         AIF   (T'&VADD  EQ   'O' ).IPTD020                             11600001
&VRG     SETC  '&VADD'(2,K'&VADD-2)                                     11650001
         AGO   .IPTD030                                                 11700001
.IPTD020 ANOP                                                           11750001
&VRG     SETC  '&EPA'(2,K'&EPA-2)                                       11800001
.IPTD030 ANOP                                                           11850001
&WR1     SETC  '&WORKR(1)'                                              12350001
&WR2     SETC  '&WORKR(2)'                                              12400001
         AIF   ('&WORKR'(1,1) NE '('       ).ERR170                     12406201
         AIF   ('&WR1' EQ '&VRG'           ).ERR170                     12412401
         AIF   ('&WR2' EQ '&VRG'           ).ERR170                     12418601
         AIF   ('&WR1' EQ '&WR2'           ).ERR180                     12424801
         AIF   ('&VRG' EQ '&RRG'           ).ERR190                     12431001
         AIF   ('&WR1' EQ '&RRG'           ).ERR170                     12437201
         AIF   ('&WR2' EQ '&RRG'           ).ERR170                     12443401
         AGO   .GENCODE                                                 12450001
.*                                                                      12475001
.*--------------------------------------------------------------------* 12500001
.LRADBG  ANOP                                                           12550001
&PAR     SETC  'VADD'                                                   12600001
         AIF   (T'&VADD  EQ 'O').ERR130                                 12650001
&PAR     SETC  'ERR'                                                    12700001
         AIF   (T'&ERR   EQ 'O').ERR130                                 12750001
&PAR     SETC  'RREG'                                                   12800001
         AIF   (T'&RREG  EQ 'O').ERR130                                 12850001
         AIF   ('&RREG'(1,1) NE '(').ERR030                             12900001
&CBR     SETC  '7'                             ERROR IF ADDRESSABLE     12950001
         AIF   ('&ERR' EQ 'ADDR'    ).LRAD10                            13000001
&CBR     SETC  '8'                             ERROR IF NOT ADDRESSABLE 13050001
         AIF   ('&ERR' EQ 'NADDR'   ).LRAD10                            13100001
&CBR     SETC  '11'                            ERROR IF SEGMENT X       13150001
         AIF   ('&ERR' EQ 'SEGX'    ).LRAD10                            13200001
&CBR     SETC  '4'                             ERROR IF NOT SEGMENT X   13250001
         AIF   ('&ERR' EQ 'NSEGX'   ).LRAD10                            13300001
&CBR     SETC  '13'                            ERROR IF PAGE X          13350001
         AIF   ('&ERR' EQ 'PAGX'    ).LRAD10                            13400001
&CBR     SETC  '2'                             ERROR IF NO PAGE X       13450001
         AIF   ('&ERR' NE 'NPAGX'   ).ERR140                            13500001
.LRAD10  ANOP                                                           13550001
&RRG     SETC  '&RREG'(2,K'&RREG-2)                                     13600001
         AIF   ('&VADD'(1,1) NE '(').GENCODE                            13650001
&VRG     SETC  '&VADD'(2,K'&VADD-2)                                     13700001
         AGO   .GENCODE                                                 13750001
.*--------------------------------------------------------------------* 13850001
.POFFCHK ANOP                                                           13852601
&PAR     SETC  'IORE'                                                   13855201
         AIF   (T'&IORE  EQ  'O'   ).ERR130                             13857801
         AIF   ('&IORE'(1,1) NE '(').ERR030                             13860401
&PAR     SETC  'PSLOFF'                                                 13863001
         AIF   (T'&PSLOFF   EQ 'O').ERR130                              13865601
         AIF   ('&PSLOFF'(1,1) NE '(').ERR030                           13868201
&PAR     SETC  'WORKR'                                                  13870801
         AIF   (T'&WORKR    EQ 'O').ERR130                              13873401
         AIF   ('&WORKR'(1,1) NE '(').ERR030                            13876001
&RRG     SETC  '&IORE'(2,K'&IORE-2)                                     13878601
&VRG     SETC  '&PSLOFF'(2,K'&PSLOFF-2)                                 13881201
&WR3     SETC  '&WORKR'(2,K'&WORKR-2)                                   13883801
         AIF   ('&RRG ' EQ '&WR3'        ).ERR190                       13886401
         AIF   ('&RRG ' EQ '&VRG'        ).ERR190                       13889001
         AIF   ('&VRG'  EQ '&WR3'        ).ERR190                       13891601
         AGO   .GENCODE                                                 13941601
.*--------------------------------------------------------------------* 13991601
.*                                                                      14041601
.COUNCHK ANOP                                                           14091601
         AIF   (T'&BLVAL  EQ 'O'    ).ERR130                            14141601
         AIF   ('&BLVAL'(1,1) NE '(').ERR030                            14191601
&VRG     SETC  '&BLVAL(1)'                                              14241601
         AIF   (T'&WORKR    EQ 'O').ERR130                              14291601
         AIF   ('&WORKR'(1,1) NE '(').ERR030                            14341601
&WR1     SETC  '&WORKR(1)'                                              14391601
         AIF   ('&VRG ' EQ '&WR1'        ).ERR190                       14441601
         AGO   .GENCODE                                                 16233301
.*--------------------------------------------------------------------* 16266601
.*                                                                      16300001
.PGNTCHK ANOP                                                           16324001
.*       AIF   ('&DAT' NE 'OFF' AND '&DAT' NE 'ON').ERR110              16348001
&PAR     SETC  'IORE'                                                   16372001
         AIF   (T'&IORE  EQ 'O'    ).PGNTCH2                            16396001
         AIF   ('&IORE'(1,1) NE '(').ERR030                             16420001
&PAR     SETC  'PSLSTAT'                                                16444001
         AIF   (T'&PSLSTAT   EQ 'O').ERR130                             16468001
         AIF   ('&PSLSTAT'(1,1) NE '(').ERR030                          16492001
&PAR     SETC  'PSLVAL'                                                 16516001
         AIF   (T'&PSLVAL    EQ 'O').ERR130                             16540001
         AIF   ('&PSLVAL'(1,1) NE '(').ERR030                           16564001
&PAR     SETC  'PGONT'                                                  16588001
         AIF   (T'&PGONT    EQ 'O' ).ERR130                             16612001
         AIF   ('&PGONT'(1,1) NE '(').ERR030                            16636001
&RRG     SETC  '&IORE'(2,K'&IORE-2)                                     16660001
&WR1     SETC  '&PSLSTAT'(2,K'&PSLSTAT-2)                               16684001
&WR2     SETC  '&PSLVAL'(2,K'&PSLVAL-2)                                 16708001
&WR3     SETC  '&PGONT'(2,K'&PGONT-2)                                   16732001
         AIF   ('&RRG ' EQ '&WR1'        ).ERR190                       16756001
         AIF   ('&RRG ' EQ '&WR2'        ).ERR190                       16780001
         AIF   ('&RRG ' EQ '&WR3'        ).ERR190                       16804001
         AIF   ('&WR1'  EQ '&WR2'        ).ERR190                       16828001
         AIF   ('&WR2'  EQ '&WR3'        ).ERR190                       16852001
         AGO   .GENCODE                                                 16876001
.*                                                                      16900001
.PGNTCH2 ANOP                                                           16904101
&PAR     SETC  'PSLVAL'                                                 16908201
         AIF   (T'&PSLVAL    EQ 'O').ERR130                             16912301
         AIF   ('&PSLVAL'(1,1) NE '(').ERR030                           16916401
&PAR     SETC  'PGONT'                                                  16920501
         AIF   (T'&PGONT    EQ 'O').ERR130                              16924601
         AIF   ('&PGONT'(1,1) NE '(').ERR030                            16928701
&WR1     SETC  '&PSLVAL'(2,K'&PSLVAL-2)                                 16932801
&WR3     SETC  '&PGONT'(2,K'&PGONT-2)                                   16936901
&OPC     SETA  53                                                       16941001
         AGO   .GENCODE                                                 16945101
.*--------------------------------------------------------------------* 16950001
.*                                                                      17000001
.SETTST  ANOP                                                           17050001
         AIF   (T'&BC  EQ 'O').ERR040                                   17100001
         AIF   (T'&LAB EQ 'O').ERR050                                   17150001
&BTST    SETB  1                                                        17200001
         AGO   .CHECKBC                                                 17250001
.SETCMP  ANOP                                                           17300001
         AIF   (T'&BC  EQ 'O').ERR040                                   17350001
         AIF   (T'&LAB EQ 'O').ERR050                                   17400001
         AIF   (T'&COMPF EQ 'O').ERR060                                 17450001
&BCMP    SETB  1                                                        17500001
.*                                                                      17550001
.CHECKBC ANOP                                                           17600001
.*                                                                      17650001
.CHECKFM ANOP                                                           17700001
         GENFIELD &CFLD                                                 17750001
.*                                                                      17800001
&CST     SETC  'ST'                                                     17850001
&CLO     SETC  'L'                                                      17900001
&CAD     SETC  'AL'                                                     17950001
&CSU     SETC  'SL'                                                     18000001
&CCL     SETC  'C'                                                      18025001
         AIF   (&FRM EQ 4 ).CHECKRG                                     18050001
&CST     SETC  'STH'                                                    18100001
&CLO     SETC  'LH'                                                     18150001
&CAD     SETC  'AH'                                                     18200001
&CSU     SETC  'SH'                                                     18250001
&CCL     SETC  'CH'                                                     18275001
         AIF   (&FRM EQ 2 ).CHECKRG                                     18300001
&CST     SETC  'STC'                                                    18350001
&CLO     SETC  'IC'                                                     18400001
         AIF   (&FRM NE 1 ).ERR020                                      18450001
.*                                                                      18500001
.CHECKRG ANOP                                                           18550001
         AIF   ( T'&REG  EQ 'O').CHECKCP                                18600001
&PAR     SETC  'REG'                                                    18650001
         AIF   ('&REG'(1,1) NE '(').ERR030                              18700001
&RG      SETC  '&REG'(2,K'&REG-2)                                       18750001
.*                                                                      18800001
.CHECKCP ANOP                                                           18850001
         AIF   (NOT &BCMP).CHECKBR                                      18900001
&CF      SETC  '&COMPF'                                                 18950001
&CCL     SETC  'CL'                                                     19000001
         AIF   ('&COMPF'(1,1) NE '(').CHECKLB                           19050001
&CF      SETC  '&COMPF'(2,K'&COMPF-2)                                   19100001
&CCL     SETC  'CLR'                                                    19150001
         AGO   .CHECKLB                                                 19200001
.*                                                                      19250001
.CHECKBR ANOP                                                           19300001
         AIF   (NOT &BTST).GENCODE                                      19350001
.CHECKLB ANOP                                                           19400001
&CBR     SETC  '&BC'                                                    19450001
&LB      SETC  '&LAB'                                                   19500001
         AIF   ('&LAB'(1,1) NE '(').GENCODE                             19550001
&LB      SETC  '&LAB'(2,K'&LAB-2)                                       19600001
&CBR     SETC  '&CBR'.'R'                                               19650001
.*                                                                      19700001
.*--------------------------------------------------------------------* 19750001
.*                                                                      19800001
.GENCODE ANOP                                                           19850001
         AIF   ( &OPC  LE  3      ).INCR1                               19900001
         AIF   ( &OPC  LE  6      ).DECR1                               19950001
         AIF   ( &OPC  LE  12     ).COMP0                               20000001
         AIF   ( &OPC  EQ  13     ).SET0                                20050001
         AIF   ( &OPC  EQ  14     ).SET1                                20100001
         AIF   ( &OPC  EQ  15     ).GETF                                20150001
         AIF   ( &OPC  EQ  16     ).PUTF                                20200001
         AIF   ( &OPC  EQ  17     ).ADDF                                20250001
         AIF   ( &OPC  EQ  18     ).SUBF                                20300001
         AIF   ( &OPC  EQ  19     ).COMF                                20308301
         AIF   ( &OPC  EQ  50     ).VPTEGEN                             20316601
         AIF   ( &OPC  EQ  52     ).PGONTG1                             20349801
         AIF   ( &OPC  EQ  53     ).PGONTG2                             20366401
         AIF   ( &OPC  EQ  54     ).PAGEGEN                             20383001
         AIF   ( &OPC  EQ  55     ).PSLOFFS                             20391501
         AIF   ( &OPC  EQ  60     ).LRADBUG                             20400001
         AIF   ( &OPC  EQ  61     ).IPTEGEN                             20450001
         AIF   ( &OPC  EQ  62     ).RPTEGEN                             20500001
         AIF   ( &OPC  EQ  63     ).GTPCBGN                             20525001
         AIF   ( &OPC  EQ  70     ).COUNTIO                             20537501
         AIF   ( &OPC  EQ  71     ).GENDEBG                             20543700
.*                                                                      20550001
.ERR000  ANOP                                                           20600001
         MNOTE 8,'INVALID OPERATION --- MACRO GENERATION SUPPRESSED '   20630001
         MEXIT                                                          20660001
.ERR005  ANOP                                                           20690001
         MNOTE 8,'INVALID OPERATION FOR 1 BYTE-FIELD '                  20720001
         MEXIT                                                          20750001
.*                                                                      20800001
.ERR010  ANOP                                                           20850001
         MNOTE 8,'MISSING FIELDNAME --- MACRO GENERATION SUPPRESSED '   20900001
         MEXIT                                                          20950001
.*                                                                      21000001
.ERR020  ANOP                                                           21050001
         MNOTE 8,'INVALID FIELDNAME --- MACRO GENERATION SUPPRESSED '   21100001
         MEXIT                                                          21150001
.*                                                                      21200001
.ERR030  ANOP                                                           21250001
         MNOTE 8,'REGISTER NOTATION REQUIRED FOR &PAR -  GENERATION SUP-21300001
               PRESSED '                                                21350001
         MEXIT                                                          21400001
.*                                                                      21450001
.ERR040  ANOP                                                           21500001
         MNOTE 8,'MISSING BRANCHCODE --- MACRO GENERATION SUPPRESSED '  21550001
         MEXIT                                                          21600001
.*                                                                      21650001
.ERR050  ANOP                                                           21700001
         MNOTE 8,'MISSING LABEL --- MACRO GENERATION SUPPRESSED '       21750001
         MEXIT                                                          21800001
.*                                                                      21850001
.ERR060  ANOP                                                           21900001
         MNOTE 8,'MISSING COMPARE FIELD - GENERATION SUPPRESSED '       21950001
         MEXIT                                                          22000001
.*                                                                      22050001
.ERR070  ANOP                                                           22100001
         MNOTE 8,'INVALID BRANCH CODE   - GENERATION SUPPRESSED '       22150001
         MEXIT                                                          22200001
.*                                                                      22250001
.ERR080  ANOP                                                           22300001
         MNOTE 8,'MISSING PFTE ADDRESS  - GENERATION SUPPRESSED '       22350001
         MEXIT                                                          22400001
.*                                                                      22450001
.ERR090  ANOP                                                           22500001
         MNOTE 8,'MISSING WORKREGISTER  - GENERATION SUPPRESSED '       22550001
         MEXIT                                                          22600001
.*                                                                      22650001
.ERR100  ANOP                                                           22700001
         MNOTE 8,'PSL ADDRESS / PSLVAL MISSING - GENERATION SUPPRESSED' 22750001
         MEXIT                                                          22800001
.*                                                                      22850001
.ERR110  ANOP                                                           22900001
         MNOTE 8,'INVALID DAT OPERAND  - GENERATION SUPPRESSED '        22950001
         MEXIT                                                          23000001
.*                                                                      23050001
.ERR120  ANOP                                                           23100001
         MNOTE 8,'MISSING REAL ADDRESS - GENERATION SUPPRESSED '        23150001
         MEXIT                                                          23200001
.*                                                                      23250001
.ERR130  ANOP                                                           23300001
         MNOTE 8,'MISSING PARAMETER &PAR - GENERATIOM SUPPRESSED'       23350001
         MEXIT                                                          23400001
.*                                                                      23450001
.ERR140  ANOP                                                           23500001
         MNOTE 8,'INVALID / MISSING PARAMETER &PAR OR &PAR1 - GENERATIO-23550001
               N SUPPRESSED'                                            23600001
         MEXIT                                                          23650001
.*                                                                      23700001
.ERR150  ANOP                                                           23750001
         MNOTE 8,'MISSING SCB ADDRESS - GENERATION SUPPRESSED '         23800001
         MEXIT                                                          23850001
.*                                                                      23900001
.ERR160  ANOP                                                           23950001
         MNOTE 8,'INVALID EPA PARAMETER - GENERATION SUPPRESSED '       24000001
         MEXIT                                                          24050001
.*                                                                      24100001
.ERR170  ANOP                                                           24150001
         MNOTE 8,'INCONSISTENT WORKR PARAMETER: REGISTER(S) USED BY OTH-24200001
               ER OPERANDS - GENERATION SUPPRESSED'                     24250001
         MEXIT                                                          24300001
.*                                                                      24350001
.ERR180  ANOP                                                           24400001
         MNOTE 8,'INCONSISTENT WORKR PARAMETER(S): REGISTERS NOT UNIQUE-24450001
               LY SPECIFIED - GENERATION SUPPRESSED '                   24500001
         MEXIT                                                          24550001
.*                                                                      24600001
.ERR190  ANOP                                                           24650001
         MNOTE 8,'INCONSISTENT PARAMETERS: - REGISTERS NOT UNIQUELY SPE-24700001
               CIFIED - GENERATION SUPPRESSED '                         24750001
         MEXIT                                                          24800001
.*                                                                      24850001
.ERR200  ANOP                                                           24900001
         MNOTE 8,'&PAR AND &PAR1 ARE EXCLUSIVE - GENERATION SUPPRESSED' 24950001
         MEXIT                                                          25000001
.*                                                                      25050001
.ERR210  ANOP                                                           25100001
         MNOTE 8,'&PAR PARAMETER REQUIRES &PAR1 PARAMETER - GENERATION -25150001
               SUPPRESSED'                                              25200001
         MEXIT                                                          25250001
.*                                                                      25300001
.* ---------------- SET TO ZERO ------------------------------*         25350001
.*                                                                      25400001
.SET0    AIF   ( T'&NAME  EQ 'O').SET010                                25450001
&NAME    DS    0H                                                       25500001
.SET010  AIF   (&FRM NE 1).SET020                                       25550001
.*     ---- BYTE      -------                                           25600001
         MVI   &FIELD,0                                                 25650001
         MEXIT                                                          25700001
.SET020  ANOP                                                           25750001
.*     ---- H / F WORD ------                                           25800001
         SLR   &RG,&RG                                                  25850001
         &CST  &RG,&FIELD                                               25900001
         MEXIT                                                          25950001
.*                                                                      26000001
.* ---------------- SET TO ONE  ------------------------------*         26050001
.*                                                                      26100001
.SET1    AIF   ( T'&NAME  EQ 'O').SET110                                26150001
&NAME    DS    0H                                                       26200001
.SET110  AIF   (&FRM NE 1).SET120                                       26250001
.*     ---- BYTE      -------                                           26300001
         MVI   &FIELD,1                                                 26350001
         MEXIT                                                          26400001
.SET120  ANOP                                                           26450001
.*     ---- H / F WORD ------                                           26500001
         LA    &RG,1(,0)                                                26550001
         &CST  &RG,&FIELD                                               26600001
         MEXIT                                                          26650001
.*                                                                      26700001
.* ---------------- GET VALUE FROM FIELD ---------------------*         26750001
.*                                                                      26800001
.GETF    AIF   ( T'&NAME  EQ 'O').GET10                                 26850001
&NAME    DS    0H                                                       26900001
.GET10   AIF   (&FRM NE 1).GET20                                        26950001
.*     ---- BYTE      -------                                           27000001
         SLR   &RG,&RG                                                  27050001
.GET20   ANOP                                                           27100001
.*     ---- H / F WORD  -------                                         27150001
         &CLO  &RG,&FIELD                                               27200001
         MEXIT                                                          27250001
.*                                                                      27300001
.* ---------------- PUT VALUE INTO FIELD ---------------------*         27350001
.*                                                                      27400001
.PUTF    AIF   ( &FRM EQ 1).ERR005                                      27433301
         AIF   ( T'&NAME  EQ 'O').PUT10                                 27466601
&NAME    DS    0H                                                       27500001
.PUT10   ANOP                                                           27550001
         &CST  &RG,&FIELD                                               27600001
         MEXIT                                                          27650001
.*                                                                      27700001
.* ---------------- ADD FIELD TO REGISTER --------------------*         27750001
.*                                                                      27800001
.ADDF    AIF   ( &FRM EQ 1).ERR005                                      27833301
         AIF   ( T'&NAME  EQ 'O').ADD10                                 27866601
&NAME    DS    0H                                                       27900001
.ADD10   ANOP                                                           27950001
         &CAD  &RG,&FIELD                                               28000001
         MEXIT                                                          28050001
.*                                                                      28100001
.* ---------------- SUB FIELD FROM REGISTER ------------------*         28150001
.*                                                                      28200001
.SUBF    AIF   ( &FRM EQ 1).ERR005                                      28233301
         AIF   ( T'&NAME  EQ 'O').SUB10                                 28266601
&NAME    DS    0H                                                       28300001
.SUB10   ANOP                                                           28350001
         &CSU  &RG,&FIELD                                               28400001
         MEXIT                                                          28404501
.*                                                                      28409001
.* ---------------- COMP FIELD AGAINST REGISTER --------------*         28413501
.*                                                                      28418001
.COMF    AIF   ( &FRM EQ 1).ERR005                                      28422501
         AIF   ( T'&NAME  EQ 'O').COM10                                 28427001
&NAME    DS    0H                                                       28431501
.COM10   ANOP                                                           28436001
         &CCL  &RG,&FIELD                                               28440501
         &CBR  &LB                                                      28445001
         MEXIT                                                          28450001
.*                                                                      28500001
.* ---------------- INCREASE ---------------------------------*         28550001
.*                                                                      28600001
.INCR1   AIF   ( T'&NAME  EQ 'O').INCR10                                28650001
&NAME    DS    0H                                                       28700001
.INCR10  AIF   (&FRM NE 1).INCR20                                       28750001
.*     ---- CLEAR BYTE ------                                           28800001
         SLR   &RG,&RG                                                  28850001
.INCR20  ANOP                                                           28900001
.*     ---- INCREASE  -------                                           28950001
         &CLO  &RG,&FIELD                                               29000001
         AL    &RG,F1                                                   29050001
         &CST  &RG,&FIELD                                               29100001
         AGO   .COMMON                                                  29150001
.*                                                                      29200001
.* ---------------- DECREASE ---------------------------------*         29250001
.*                                                                      29300001
.DECR1   AIF   ( T'&NAME  EQ 'O').DECR10                                29350001
&NAME    DS    0H                                                       29400001
.DECR10  AIF   (&FRM NE 1).DECR20                                       29450001
.*     ---- BYTE      -------                                           29500001
         SLR   &RG,&RG                                                  29550001
.DECR20  ANOP                                                           29600001
         &CLO  &RG,&FIELD                                               29650001
         BCTR  &RG,0                                                    29700001
         &CST  &RG,&FIELD                                               29750001
         AGO   .COMMON                                                  29800001
.*                                                                      29850001
.* ---------------- COMPARE ----------------------------------*         29900001
.COMP0   ANOP                                                           29950001
         AIF   ( T'&NAME  EQ 'O').COMP10                                30000001
&NAME    DS    0H                                                       30050001
.COMP10  AIF   (&FRM EQ 1).COMP0B                                       30100001
         AIF   (&FRM EQ 2).COMP0H                                       30150001
.*     ---- FULLWORD  -------                                           30200001
         L     &RG,&FIELD                                               30250001
         AGO   .COMMON                                                  30300001
.COMP0H  ANOP                                                           30350001
.*     ---- HALFWORD  -------                                           30400001
         LH    &RG,&FIELD                                               30450001
         AGO   .COMMON                                                  30500001
.COMP0B  ANOP                                                           30550001
.*     ---- BYTE      -------                                           30600001
         SLR   &RG,&RG                                                  30650001
         IC    &RG,&FIELD                                               30700001
.*                                                                      30750001
.* --- COMMON CHECK CODE ------------------------------------*          30800001
.*                                                                      30850001
.COMMON  ANOP                                                           30900001
         AIF   (NOT &BTST).COM100                                       30950001
         LTR   &RG,&RG                                                  31000001
         &CBR  &LB                                                      31050001
         AGO   .COMPTST                                                 31100001
.*                                                                      31150001
.COM100  ANOP                                                           31200001
         AIF   (NOT &BCMP).COMPTST                                      31250001
         &CCL  &RG,&CF                                                  31300001
.COM300  ANOP                                                           31350001
         &CBR  &LB                                                      31400001
.*                                                                      31450001
.* --- DECREASE / INCREASE AFTER CHECK  ---------------------*          31500001
.*                                                                      31550001
.COMPTST ANOP                                                           31600001
         AIF   (&OPC LE 8).MEXIT                                        31650001
         AIF   (&OPC LE 10).COMP100                                     31700001
         AL    &RG,F1                                                   31750001
         AGO   .COMP200                                                 31800001
.COMP100 ANOP                                                           31850001
         BCTR  &RG,0                                                    31900001
.COMP200 ANOP                                                           31950001
         &CST  &RG,&FIELD                                               32000001
.*                                                                      32050001
.MEXIT   ANOP                                                           32100001
         MEXIT                                                          32150001
.*                                                                      32200001
.PGONTG1 ANOP                                                           34800001
.*                                                                      34850001
.* --- ACCESS PREPGENT---------------------------------------*          34900001
.*                                                                      34950001
.*     GENSERV PGONT,IORE=(),PSLSTAT=(),PSLVAL=(),PGONT=(),DAT=         35000001
         AIF   (NOT &BGDEBUG).GENSX20                                   35025001
*        INPUT :  IORE      = PSEUDO TIB                                35050001
*        OUTPUT:  PSLSTAT   = ADDRESS OF POSL                           35100001
*                 PGONT     = ADDRESS OF RELATED PREPGENT               35150001
*                 PSLVAL    = VALUE OF PSLSTATE                         35200001
*        MODE  :  31 BIT, ANY                                           35250001
.GENSX20 ANOP                                                           35275001
.*                                                                      35300001
.*                                                                      35350001
.*       AIF   ('&DAT' EQ 'ON' ).GENSC20                                35400001
.**      AMODESW SET,DAT=ON       ENTER VIRTUAL MODE                    35450001
.*       AMODESW SET,DAT=ON       ENTER VIRTUAL MODE                    35500001
.GENSC20 ANOP                                                           35550001
         L     &WR1,TIBAALU-TIBADR(&RRG) ADDRESS OF POSLSTATE OF       -35600001
                                  ... CURRENT ALLOCATION UNIT           35650001
         SLR   &WR2,&WR2                                                35700001
         IC    &WR2,0(,&WR1)      GET POSLSTATE                        -35750001
                                      = INDEX IN PREPGOTB               35800001
         LR    &WR3,&WR2                                                35825001
         SLL   &WR3,PGOOFSH       OFFSET IN PREPGOTB                    35850001
         AL    &WR3,APREPGOT                                            35875001
.*       AIF   ('&DAT' EQ 'ON' ).GENSC25                                35900001
.**      AMODESW SET,DAT=OFF      ENTER REAL MODE                       35925001
.*       AMODESW SET,DAT=OFF      ENTER REAL MODE                       35950001
.GENSC25 ANOP                                                           35975001
.*                                                                      36000001
         MEXIT                                                          36050001
.*                                                                      36100001
.PGONTG2 ANOP                                                           36150001
.*                                                                      36200001
.*     GENSERV PGONT,PSLVAL=(),PGONT=()                                 36250001
*        INPUT :  PSLVAL    = VALUE OF POSLSTATE                        36300001
*        OUTPUT:  PGONT     = ADDRESS OF RELATED PREPGENT               36350001
*        MODE  :  31 BIT, ANY                                           36500001
.*                                                                      36550001
         LR    &WR3,&WR1                                                36600001
         SLL   &WR3,PGOOFSH       OFFSET IN PREPGOTB                    36650001
         AL    &WR3,APREPGOT      ADDRESS OF PREPGENT                   36700001
         MEXIT                                                          37200001
.*                                                                      37250001
.*----   COUNT BLOCKED PAGE I/O        -------------------------------* 37300001
.*                                                                      37350001
.*                                                                      37400001
.COUNTIO ANOP                                                           37450001
         AIF   ( T'&NAME  EQ 'O').COUNT10                               37500001
&NAME    DS    0H                                                       37550001
.COUNT10 ANOP                                                           37600001
         LR    &WR1,&VRG                                                37650001
         SLL   &WR1,2                                                   37700001
         L     &RG,&FIELD-4(&WR1)                                       37750001
         AL    &RG,F1                                                   37800001
         ST    &RG,&FIELD-4(&WR1)                                       37850001
         MEXIT                                                          37900001
.*                                                                      37950001
.*----   LRA  AND TEST IF ADDRESSIBLE  -------------------------------* 39000001
.*                                                                      39025001
.*                                                                      39050001
.LRADBUG ANOP                                                           39100001
         AIF   ( T'&NAME  EQ 'O').LRADB10                               39150001
&NAME    DS    0H                                                       39200001
.LRADB10 ANOP                                                           39250001
         AIF   ('&VRG' NE ' ').LRADB30                         @D52VDRP 39300001
         LRA   &RRG,&VADD         GET REAL ADDRESS        LRAX @D52VDRP 39350001
         AGO   .LRADB50                                        @D52VDRP 39400001
.LRADB30 ANOP                                                  @D52VDRP 39450001
         LRA   &RRG,0(,&VRG)      GET REAL ADDRESS        LRAX @D52VDRP 39500001
.LRADB50 ANOP                                                  @D52VDRP 39550001
         BC    &CBR,*+22          ---------->  IF OK           @D52VDRP 39600002
         STCM  R5,15,*+14         SAVE REG 15                  @D64ADOW 39601004
         LA    R5,*+6             ENTER 24 BIT MODE            @D64ADOW 39610002
         BSM   0,R5                                            @D64ADOW 39620002
         BAL   R5,PMRHWERR        HARD-WAIT OTHERWISE          @D52VDRP 39650001
***                               SAVE CC FROM LRA                      39651003
         DC    X'00000000'                                     @D64ADOW 39660001
         MEXIT                                                          39700001
.*                                                                      39750001
.*-------------------------------------------------------------         39775001
.IPTEGEN ANOP                                                           39800001
.*                                                                      39825001
.*   GENSERV IPTE,VADD=|EPA,SCB=,WORKR=(R3,R4)                          39863601
.* DOES IPTE FOR PAGE PROVIDED BY VADD IN THE SPACE IDENTFIED  @D52VDRP 39902201
.* BY SCB. IF IPTE INSTRUCTION IS NOT AVAILABLE, PTLB IS DONE  @D52VDRP 39940801
         AIF   (NOT &BGDEBUG).GENSX30                                   39979401
*    VADD = PAGE ADDR. WHOSE PTE HAS TO BE INVALIDATED         @D52VDRP 40018001
*    EPA  = EPA  ADDR. WHOSE PTE HAS TO BE INVALIDATED         @D52VDRP 40056601
*    SCB  = REAL ADDR OF SCB, THE PTE BELONGS TO               @D52VDRP 40095201
*    WORKR= WORKREGISTERS TO BE USED. MUST NOT BE EQUAL TO     @D52VDRP 40133801
*           VADD OR SCB                                        @D52VDRP 40172401
.GENSX30 ANOP                                                           40211001
.*-------------------------------------------------------------         40250001
.*DEL    TM    PMOPFLAG,PMOPIPTE  IPTE INSTRUCTION AVAILABLE   @D52VDRP 40300001
.*DEL    BZ    IPT3&SYSNDX        NO, DO PTLB                  @D52VDRP 40350001
         ST    &WR1,PMRSVGEN      SAVE USED REGISTERS          @KD40056 40400001
         ST    &WR2,PMRSVGEN+4                                 @KD40056 40450001
         ST    &VRG,PMRSVGEN+8                                 @KD40056 40500001
         LR    &WR1,&VRG          GET EPA/VIRT.ADDR.           @D52VDRP 40550001
         AIF   (T'&EPA  EQ 'O').NOEPA  ALREADY VIRT. ADDR.     @D52VDRP 40600001
         L     &WR2,IJBSMCOM      GET ADDRESS OF SMCOM         @D52VDRP 40650001
         TM    SCBFLG-SCBADR(&SPA),SCBSHA IS IT SHARED AREA    @D52VDRP 40700001
         BO    IPT1&SYSNDX        YES, BRANCH                  @D52VDRP 40750001
         TM    SCBFLG-SCBADR(&SPA),SCBDSP IS IT DATA SPACE AREA@D52VDRP 40766601
         BO    IPT2&SYSNDX        YES, BRANCH                  @D52VDRP 40783201
         A     &WR1,SMCPRPBG-SMCOM(&WR2) GET VIRT. ADDR.       @D52VDRP 40800001
         B     IPT2&SYSNDX                                     @D52VDRP 40850001
IPT1&SYSNDX C     &WR1,SMCPRPBG-SMCOM(&WR2)     SHARED_24 AREA @D52VDRP 40900001
         BL    IPT2&SYSNDX        YES, ADDR O.K.               @D52VDRP 40950001
         S     &WR1,SMCPRPBG-SMCOM(&WR2) GET VIRTUAL ADDRESS   @D52VDRP 41000001
         A     &WR1,SMCSVA31-SMCOM(&WR2) * IN SVA_31           @D52VDRP 41050001
IPT2&SYSNDX DS    0H                                           @D52VDRP 41100001
         LR    &VRG,&WR1          GET VIRT.ADDR. FOR IPTE      @D52VDRP 41150001
.NOEPA   ANOP                                                  @D52VDRP 41200001
         N     &WR1,PMSGMSK       GET OFFSET                   @D52VDRP 41250001
         SRL   &WR1,SNSHIFT-SNSTESH * IN SGT                   @D52VDRP 41300001
         L     &WR2,SCBRSTO-SCBADR(&SPA) GET REAL              @D52VDRP 41350001
         N     &WR2,PMCR1MSK         *   SGT ADDRESS           @D52VDRP 41400001
         AR    &WR2,&WR1          GET REAL ADDR OF STE         @D52VDRP 41450001
         L     &WR1,0(&WR2)       GET REAL PTE ADDR FOR IPTE   @D52VDRP 41500001
         IPTE  &WR1,&VRG          PURGE ENTRY IN X-LOOKASIDE B @D52VDVB 41550001
         L     &WR1,PMRSVGEN      RESTORE USED REGISTERS       @KD40056 41600001
         L     &WR2,PMRSVGEN+4                                 @KD40056 41650001
         L     &VRG,PMRSVGEN+8                                 @KD40056 41700001
.*DEL    B     IPT4&SYSNDX        SKIP PTLB INSTRUCTION        @D52VDRP 41750001
.*DELSYSNDX PTLB                  PURGE X-LOOKASIDE BUFFER     @D52VDRP 41800001
.*DELSYSNDX DS    0H                                           @D52VDRP 41850001
         MEXIT                                                          41900001
.*                                                                      41950001
.*------------------------------------------------------------*         41975001
.RPTEGEN ANOP                                                           42000001
.*                                                                      42025001
.*       GENSERV RPTE,PFTE=(R1)|(EPA=(R1),SCB=(R2))                     42063601
.*                    RPTE=(R0),WORKR=(R3,R4,R5)                        42102201
         AIF   (NOT &BGDEBUG).GENSX40                                   42140801
*    PFTE  = ADDR OF PFTE (INPUT) ... EXLUSIV                           42179401
*    EPA   = EPA          (INPUT) ...     OPERANDS                      42218001
*    SCB   = SCB PTR      (INPUT) ... REQUIRED FOR EPA                  42256601
*    RPTE  = REAL ADDR OF PTE BELONGING TO PFTEEPA# (OUTPUT)            42295201
*    WORKR = WORK REGISTERS (DEFAULT ARE R3,R4,R5)                      42333801
*    CODE HAS TO BE INVOKED IN AMODE(31),DATOF                          42372401
.GENSX40 ANOP                                                           42411001
.*------------------------------------------------------------*         42450001
         ST    &WR1,PMRSVGEN      SAVE  ....                   @KD40056 42500001
         ST    &WR2,PMRSVGEN+4    *   SPECIFIED                @KD40056 42550001
         ST    &WR3,PMRSVGEN+8    *    WORK-REGISTERS          @KD40056 42600001
         AIF   (T'&EPA  EQ 'O').NOEPA1                         @D52VD56 42650001
         LR    &WR1,&VRG          GET EPA                      @D52VDRP 42700001
         LR    &WR2,&SPA          GET ADDRESS OF CURRENT SCB   @D52VDRP 42750001
.NOEPA1  ANOP                                                  @D52VDRP 42800001
         AIF   (T'&PFTE  EQ 'O').EPA01                         @D52VDRP 42850001
         ICM   &WR1,7,PFTEEPA#-PFTE(&VRG) GET                  @D52VDRP 42900001
         SLL   &WR1,PNSHIFT         ....   EPA                 @D52VDRP 42950001
         L     &WR2,PFTESCB-PFTE(&VRG) GET SCB BELONGING TO EPA@D52VDRP 43000001
.EPA01   ANOP                                                  @D52VDRP 43050001
*        GENSERV LRADBG,RREG=(&WR2),VADD=(&WR2),ERR=NADDR      @D52VDRP 43100001
*                     GET REAL ADDRESS OF SCB                  @D52VDRP 43150001
         GENSERV LRADBG,RREG=(&WR2),VADD=(&WR2),ERR=NADDR      @D52VDRP 43200001
         L     &WR3,IJBSMCOM      GET ADDRESS OF SMCOM         @D52VDRP 43250001
         TM    SCBFLG-SCBADR(&WR2),SCBSHA IS IT SHARED AREA    @D52VDRP 43300001
         BO    GPT1&SYSNDX        YES, BRANCH                  @D52VDRP 43350001
         TM    SCBFLG-SCBADR(&WR2),SCBDSP IS IT DATA SPACE AREA@D52VDRP 43366601
         BO    GPT2&SYSNDX        YES, BRANCH                  @D52VDRP 43383201
         A     &WR1,SMCPRPBG-SMCOM(&WR3) GET VIRT. ADDR.       @D52VDRP 43400001
         B     GPT2&SYSNDX                                     @D52VDRP 43450001
GPT1&SYSNDX C     &WR1,SMCPRPBG-SMCOM(&WR3)  IN SHARED_24 AREA @D52VDRP 43500001
         BL    GPT2&SYSNDX        YES, ADDR O.K.               @D52VDRP 43550001
         S     &WR1,SMCPRPBG-SMCOM(&WR3) GET VIRTUAL ADDRESS   @D52VDRP 43600001
         A     &WR1,SMCSVA31-SMCOM(&WR3) * IN SVA_31           @D52VDRP 43650001
GPT2&SYSNDX DS    0H                                           @D52VDRP 43700001
         LR    &RRG,&WR1          SAVE VIRT. ADDRESS           @D52VDRP 43750001
         N     &WR1,PMSGMSK       GET OFFSET                   @D52VDRP 43800001
         SRL   &WR1,SNSHIFT-SNSTESH * IN SGT                   @D52VDRP 43850001
         L     &WR2,SCBRSTO-SCBADR(&WR2) GET REAL              @D52VDRP 43900001
         N     &WR2,PMCR1MSK         *   SGT ADDRESS           @D52VDRP 43950001
         AR    &WR2,&WR1          GET REAL ADDR OF STE         @D52VDRP 44000001
         L     &WR1,0(&WR2)       GET REAL ADDRESS             @D52VDRP 44050001
         N     &WR1,PMSTEMSK      * OF PAGE TABLE              @D52VDRP 44100001
         N     &RRG,PMSGDIS       GET OFFSET                   @D52VDRP 44150001
         N     &RRG,PMPAGMSK      *   IN                       @D52VDRP 44200001
         SRL   &RRG,PTSHIFT       *     PAGE TABLE             @D52VDRP 44250001
         AR    &RRG,&WR1          GET REAL ADDR OF PTE         @D52VDRP 44300001
         L     &WR1,PMRSVGEN      RESTORE ...                  @KD40056 44350001
         L     &WR2,PMRSVGEN+4    *   SPECIFIED                @KD40056 44400001
         L     &WR3,PMRSVGEN+8    *    WORK-REGISTERS          @KD40056 44450001
         MEXIT                                                          44500001
.*                                                                      44550001
.*------------------------------------------------------------*         44550601
.PAGEGEN ANOP                                                           44551201
.*                                                                      44551801
.*       GENSERV PAGE,PFTE=(R1),VADD=(R2),WORKR=(R3,R4),DAT=OFF         44552201
         AIF   (NOT &BGDEBUG).GENSX50                                   44552601
*   INPUT :   PFTE  = ADDR OF PFTE                                      44553001
*   OUTPUT:   VADD  = ADDR OF PAGE BELONGING TO PFTEEPA#                44553601
*   MODE  :   31 / DATOFF IS DEFAULT                                    44554201
.GENSX50 AANOP                                                          44554601
.*------------------------------------------------------------*         44555001
         AIF   ('&DAT' EQ 'OFF').GENSC50                                44555401
*        AMODESW SET,DAT=OFF      ENTER REAL MODE                       44556001
         AMODESW SET,DAT=OFF      ENTER REAL MODE                       44556601
.GENSC50 ANOP                                                           44557201
         ST    &WR1,PMRSVGEN      SAVE  ....                   @KD40056 44557801
         ST    &WR2,PMRSVGEN+4    *   SPECIFIED  REGS          @KD40056 44558401
         ICM   &VRG,7,PFTEEPA#-PFTE(&RRG) EPANR                         44559001
         SLL   &VRG,PNSHIFT       EPA ADDRESS                           44559601
         L     &WR1,PFTESCB-PFTE(&RRG) GET SCB BELONGING TO EPA         44560201
*        GENSERV LRADBG,RREG=(&WR1),VADD=(&WR1),ERR=NADDR               44560801
*                     GET REAL ADDRESS OF SCB                           44561401
         GENSERV LRADBG,RREG=(&WR1),VADD=(&WR1),ERR=NADDR               44562001
         L     &WR2,IJBSMCOM      GET ADDRESS OF SMCOM                  44562601
         TM    SCBFLG-SCBADR(&WR1),SCBSHA IS IT SHARED AREA             44563201
         BO    GPA1&SYSNDX        YES, BRANCH                           44563801
         TM    SCBFLG-SCBADR(&WR1),SCBDSP IS IT DATA SPACE AREA         44564001
         BO    GPA2&SYSNDX        YES, BRANCH                           44564201
         AL    &VRG,SMCPRPBG-SMCOM(&WR2) GET VIRT. ADDR.                44564401
         B     GPA2&SYSNDX                                              44565001
GPA1&SYSNDX CL    &VRG,SMCPRPBG-SMCOM(&WR2)  IN SHARED_24 AREA          44565601
         BL    GPA2&SYSNDX        YES, ADDR O.K.                        44566201
         SL    &VRG,SMCPRPBG-SMCOM(&WR2) GET VIRTUAL ADDRESS            44566801
         AL    &VRG,SMCSVA31-SMCOM(&WR2) * IN SVA_31                    44567401
GPA2&SYSNDX DS    0H                                                    44568001
         L     &WR1,PMRSVGEN      RELOAD ...                   @KD40056 44568601
         L     &WR2,PMRSVGEN+4    *   SPECIFIED REGS           @KD40056 44569201
         AIF   ('&DAT' EQ 'OFF').GENSC55                                44569801
*        AMODESW SET,DAT=ON       ENTER VIRTUAL MODE                    44570401
         AMODESW SET,DAT=ON       ENTER VIRTUAL MODE                    44571001
.GENSC55 ANOP                                                           44571601
         MEXIT                                                          44572201
.*                                                                      44572801
.*------------------------------------------------------------*         44573401
.VPTEGEN ANOP                                                           44574001
.*                                                                      44574601
.*       GENSERV VPTE,PFTE=(R1),VPTE=(R2),WORKR=(R3),DAT=OFF            44575001
         AIF   (NOT &BGDEBUG).GENSX60                                   44575401
*   INPUT :   PFTE  = ADDR OF PFTE                                      44575801
*   OUTPUT:   VPTE  = ADDR OF PTE BELONGING TO PFTEEPA#                 44576401
*   MODE  :   31 / DATOFF IS DEFAULT                                    44577001
.GENSX60 ANOP                                                           44577301
.*------------------------------------------------------------*         44577601
         AIF   ('&DAT' EQ 'OFF' OR '&DAT' EQ 'OFFON').GENSC60           44578201
*        AMODESW SET,DAT=OFF      ENTER REAL MODE                       44578801
         AMODESW SET,DAT=OFF      ENTER REAL MODE                       44579401
.GENSC60 ANOP                                                           44580001
         SLR   &VRG,&VRG                                                44580301
         ICM   &VRG,7,PFTEEPA#-PFTE(&RRG) EPANR                         44580601
         SLL   &VRG,PNRPTOSH       PTE OFFSET                           44581201
         L     &WR1,PFTESCB-PFTE(&RRG) GET SCB BELONGING TO EPA         44581801
*        AMODESW SET,DAT=ON                                             44582401
         AMODESW SET,DAT=ON                                             44583001
         AL    &VRG,SCBAPT-SCBADR(&WR1) PTE ADDRESS                     44583601
         AIF   ('&DAT' NE 'OFF').GENSC65                                44584201
*        AMODESW SET,DAT=OFF      ENTER REAL MODE                       44584801
         AMODESW SET,DAT=OFF      ENTER REAL MODE                       44585401
.GENSC65 ANOP                                                           44586001
         MEXIT                                                          44586601
.*------------------------------------------------------------*         44587201
.*                                                                      44587801
.GTPCBGN ANOP                                                           44588401
.*       GENSERV GETPCB,PIK=(R1),PCB=(R2)                               44588801
         AIF   (NOT &BGDEBUG).GENSX70                                   44589201
.*  INPUT :   PIK   = PIK OF PARTITION                                  44589601
.*  OUTPUT:   PCB   = ADDR OF PCB OF PARTITION IDENTIFIED BY PIK        44590001
.GENSX70 ANOP                                                           44590401
.*-------------------------------------------------------------*        44590801
         AIF   ('&WR1' EQ '&WR2').SGEN70                                44591401
         LR    &WR2,&WR1          GET PIK                               44592001
.SGEN70  ANOP                                                           44592601
         SRL   &WR2,2             PIK/4 = OFFSET OF PCB IN PCBATAB      44593201
         A     &WR2,APCBATAB      + BEGIN OF PCBATAB                    44593801
         ICM   &WR2,15,0(&WR2)    = ADDR OF REQUESTED PCB               44594401
         MEXIT                                                          44595001
.*                                                                      44595301
.*------------------------------------------------------------*         44595601
.*                                                                      44595801
.PSLOFFS ANOP                                                           44596001
.*       GENSERV PSLOFFS,IORE=(R1),PSLSTAT=(R2),PSLOFF=(R3),WORKR=(R4)  44596101
         AIF   (NOT &BGDEBUG).GENSX80                                   44596201
*   INPUT :   IORE   = ADDR OF CURRENT IORE                             44596401
*   OUTPUT:   PSLOFF = OFFSET OF PSLSTATE                               44596601
.GENSX80 ANOP                                                           44596701
.*-------------------------------------------------------------*        44596801
         L     &WR3,TIBPFSCB-TIBADR(&RRG)  SCB ADDR                     44597001
         L     &VRG,TIBAALU-TIBADR(&RRG)   PSLSTATE                     44597201
         SL    &VRG,SCBAPOSL-SCBADR(,&WR3) OFFSET IN POSL WITH HEADER   44597401
         LA    &WR3,PSLSTATE-PSLCB(,0)     HEADER LENGTH                44597601
         SLR   &VRG,&WR3          OFFSET OF POSLSTATE                   44597801
         MEXIT                                                          44598001
.*                                                                      44598201
.*-------------------------------------------------------------*        44598401
.*                                                                      44648400
.GENDEBG ANOP                                                  @D62ADVB 44698400
.*       GENSERV DEBUG,FIELD=FCHENTRY                          @D62ADVB 44748400
         AIF   ('&CFLD' NE 'FCHENTRY').GDEBG10                 @D62ADVB 44798400
         LM    R3,R5,DFWKPHNM      PARAMETER LIST              @D62ADVB 44848400
         LM    R7,R8,DFWKNAME      PHASE NAME                  @D62ADVB 44898400
         L     R2,DFWKSWRQ         REQUEST SWITCHES            @D62ADVB 44948400
.GDEBG10 ANOP                                                  @D62ADVB 44998400
         AIF   ('&CFLD' NE 'FCHEXIT' ).GDEBG20                 @D62ADVB 45048400
         LM    R7,R8,DFWKNAME      PHASENAME                   @D62ADVB 45098400
         LM    R3,R4,DFWKALIB      ADDR OF LIB- / SLIB DEF TAB @D62ADVB 45148400
         L     R5,DFWKRETC         RETURN CODE                 @D62ADVB 45198400
         L     R2,DFWKSWRQ         REQUEST SWITCHES            @D62ADVB 45248400
.GDEBG20 ANOP                                                  @D62ADVB 45298400
         AIF   ('&CFLD' NE 'GMCALL' ).GDEBG30                  @D62ADVB 45348400
         LM    R4,R5,XLDGMCALL                                 @D62ADVB 45398400
.GDEBG30 ANOP                                                  @D62ADVB 45448400
         AIF   ('&CFLD' NE 'GMRETN' ).GDEBG40                  @D62ADVB 45498400
         LM    R4,R5,XLDGMRETN                                 @D62ADVB 45548400
.GDEBG40 ANOP                                                  @D62ADVB 45598400
         AIF   ('&CFLD' NE 'FMCALL' ).GDEBG50                  @D62ADVB 45648400
         LM    R4,R5,XLDFMCALL                                 @D62ADVB 45698400
.GDEBG50 ANOP                                                  @D62ADVB 45748400
         AIF   ('&CFLD' NE 'FMRETN' ).GDEBG60                  @D62ADVB 45798400
         LM    R4,R5,XLDFMRETN                                 @D62ADVB 45848400
.GDEBG60 ANOP                                                  @D62ADVB 45898400
         DEBUG ALLREGS,XXDBGMC                                 @D62ADVB 45948400
         MEXIT                                                 @D62ADVB 45998400
.*-------------------------------------------------------------*        46048400
         MEND                                                           46098401
