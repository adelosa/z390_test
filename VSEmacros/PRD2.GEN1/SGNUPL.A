         MACRO                                                          00002701
         SGNUPL                                                         00005401
         GBLB  &SGNUPL                                                  00006701
         ACTR  200                                                      00008101
         AIF   (NOT &SGNUPL).NOPRINT                                    00010801
         PRINT GEN                                                      00013501
.NOPRINT ANOP                                                           00016201
*---------------------------------------------------------------------* 00018901
*                                                                       00021601
.*       IBM DISK OPERATING SYSTEM                                      00024301
*        SUPERVISOR - SGNUPL - 5686-066                                 00027001
.*                                                                      00029701
*        LICENSED MATERIALS - PROPERTY OF IBM                           00032401
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                    00035101
*        5686-066 (C) COPYRIGHT IBM CORP. 1995                          00037801
*        SEE COPYRIGHT INSTRUCTIONS                                     00040501
*                                                                       00043201
*  CHANGE ACTIVITIES:                                                   00043601
*     NEW MACRO FOR VSE/ESA 2.1.0                              @D61PDVB 00044001
*     FAMILY API                                               @D64ADVB 00044401
* A000000-999999                                               @D61PDVB 00044801
*                                                                       00045201
*---------------------------------------------------------------------* 00045901
         TITLE 'VSE/ESA - IEAVENLU: VSE SERVICE FUR NUCLKUP MACRO      *00064001
                 - 95/12/05 '                                           00077700
*-------------------------------------------------------------*         00091501
*    TABLE OF TABLE DESCRIPTORS FUR NUCLKUP SERVICE           *         00100801
*          TABLE FOR FIRST LEVEL SEARCH OF NUCLKUP            *         00110101
*    LAYOUT:                                                  *         00119401
*         HEADER                                              *         00128701
*            LKUHDTAB    ADDRESS OF FIRST TABLE ENTRY         *         00138001
*            LKUHDNUM    NUMBER OF TABLE ENTRIES              *         00147301
*            LKUHDLEN    LENGTH OF TABLE ENTRY                *         00156601
*         ENTRY                                               *         00165901
*            LKUTBLEN    LENGTH OF RELEVENT PART OF NAME      *         00175201
*            LKUTBCLC    RELEVENT PART OF NAME                *         00184501
*            LKUTBRES    -                                    *         00193801
*            LKUTBRID    ADDITIONAL RID                       *         00203101
*            LKUTBADR    ADDRESS OF RELATED SECOND LEVEL TABLE*         00221701
*                        ... OR ROUTINE NAME FOR INDIRECT ADDR*         00231001
*            LKURTADR    ADDRESS OF ROUTINE PROVIDING EP      *         00232000
*            LKURTNFD    ADDRESS OF ROUTINE HANDLING          *         00233000
*                        ... NOT FOUND CONDITION ON 2ND LEVEL *         00234000
*                        ... USED FOR SDL SCAN                *         00235000
*            THE FIRST THREE ENTRIES ARE SPECIAL ENTRIES      *         00236000
*            WHICH DO NOT SEARCH SDL, THE LAST ENTRY IS       *         00237000
*            THE OUTSIDE ENTRY AND SERACH IS DONE ON SVASDLL  *         00238000
*            FIRST AND THE ON SDL                             *         00239000
*-------------------------------------------------------------*         00240301
         SPACE 2                                                        00250001
NUCLTAB  DS    0D                                                       00253201
         DC    CL8'NUCLTAB '            MACRO IDENTIFICATION            00256401
         DC    CL4'DB60'                /*@@LVLID*/                     00259601
         DC    CL8'06/24/97'                                            00262801
*-------------------------------------------------------------*         00266001
LKU1STLV DS    0F                                                       00269201
LKUHDTAB DC    A(LKU1SENY)       ADDRESS OF FIRST TABLE ENTRY           00272401
LKUHDNUM DC    AL2(LKU1SLEN/LKU1SENL) NUMBER OF ENTRIES                 00275601
LKUHDLEN DC    AL2(LKU1SENL) LENGTH OF ENTRY                            00278801
LKUHDRES DC    XL4'0'            RESERVED                               00282001
*-------------------------------------------------------------*         00285201
LKU1SENY EQU   *                                                        00288401
LKUTBLEN DC    X'00'             370 LENGTH OF RELEVANT PART            00291601
LKUTBTID DC    X'00'             USER TASK                     @D64ADVB 00294801
LKUTBCLC DC    CL3'#  '          DISPATCHER SERVICES                    00298001
LKUTBRES DC    CL3'   '          RESERVED                               00301201
LKUTBFLG DS    0XL1              FLAG                                   00304401
LKUTBADR DC    A(LKU2DISP)       DISPATCHER 2ND LEVEL TABLE             00307601
LKURTADR DC    A(NUPLCEX)        ROUTINE PROVIDING EP          @D64ADVB 00309701
LKURTNFD DC    A(NUPLERR4)       ROUTINE IF NAME NOT FOUND     @D64ADVB 00311801
LKU1SENL EQU   *-LKU1SENY                                               00314001
*-------------------------------------------------------------*         00317201
         DC    X'02'             370 LENGTH OF RELEVANT PART            00320401
         DC    X'20'             SYSTEM TASK                            00323601
         DC    CL3'SRQ'          RESOURCE QUEUES                        00326800
         DC    CL3'   '          RESERVED                               00330001
         DC    A(LKU2RESQ)       RESOURCE DESCRIPTOR 2ND LV TAB         00333201
         DC    A(NUPLCEX)        ROUTINE PROVIDING             @D64ADVB 00335301
         DC    A(NUPLERR4)       ROUTINE NAME NOT FOUND        @D64ADVB 00337401
*-------------------------------------------------------------*         00339601
         DC    X'02'             370 LENGTH OF RELEVANT PART            00342801
         DC    X'00'             USER TASK                              00346001
         DC    CL3'CSR'          CELL POOL SERVICES                     00349201
         DC    CL3'   '          RESERVED                               00352401
         DC    A(CSREPOFF)       CELL POOL SERV 2ND LV TAB     @D64ADVB 00354201
         DC    A(NUPLCSR)        ROUTINE PROVIDING EP          @D64ADVB 00356001
         DC    A(NUPLERR4)       ROUTINE NAME NOT FOUND        @D64ADVB 00357801
*-------------------------------------------------------------*         00359600
LKU1SLEN EQU   *-LKU1SENY        LENGTH OF TABLE WITHOUT       @D64ADVB 00361401
*                                SDL CONSIDERATIONS            @D64ADVB 00363201
*-------------------------------------------------------------*         00365201
         DC    X'00'             370 LENGTH OF RELEVANT PART            00368401
         DC    X'00'             USER TASK                              00371601
         DC    CL3'   '          SDL                           @D64ADVB 00374801
         DC    CL3'   '          RESERVED                               00378001
         DC    A(SVASVDL)        SVASVDL                       @D64ADVB 00379901
         DC    A(NUPLCEX)        ROUTINE PROVIDING EP          @D64ADVB 00381801
         DC    A(NUPLSDL)        ROUTINE NAME NOT FOUND        @D64ADVB 00383701
         DC    A(0)              NAME HAS NO PREFIX            @D64ADVB 00385601
*-------------------------------------------------------------*         00387601
         SPACE 2                                                        00394001
*-------------------------------------------------------------*         00397201
*    TABLES OF ROUTINES NAMES FOR NUCLKUP SERVICE             *         00400401
*          TABLE FOR SECOND LEVEL SEARCH OF NUCLKUP           *         00403601
*    LAYOUT:                                                  *         00406801
*         ENTRY                                               *         00410001
*            LKU2NAME    NAME OF ROUTINE / RESOURCE DESCRIPTOR*         00413201
*            LKU2MADD    ADDRESSING MODE AND ENTRY POINT      *         00416401
*-------------------------------------------------------------*         00419601
         SPACE 2                                                        00422801
*-------------------------------------------------------------*         00426001
*    TABLE FOR DISPATCHER SERVICES                            *         00429201
*-------------------------------------------------------------*         00432401
LKU2DISP DS    0F                                                       00435601
LKU2NAME DC    CL8'#FREELTA'     ROUTINE NAME                           00438800
LKU2MADD DC    AL1(128)          MODE                                   00442001
         DC    AL3(FREELTA)      ADDRESS OF FREELTA            @D64ADVB 00445201
LKU2SENL EQU   *-LKU2DISP        LENGTH OF TABLE ENTRY                  00448401
*-------------------------------------------------------------*         00448701
         DC    CL8'#DELETE '     ROUTINE NAME                  @D64ADVB 00448901
         DC    AL1(128)          MODE                          @D64ADVB 00449101
         DC    AL3(MVSDELX)      ADDRESS OF DELETE-MVS         @D64ADVB 00449301
*-------------------------------------------------------------*@D64ADVB 00449501
         DC    CL8'#DISPMV '     ROUTINE NAME                  @D64ADVB 00449701
         DC    AL1(128)          MODE                          @D64ADVB 00449901
         DC    AL3(DISPMVS)      ADDRESS OF DISP MVS-SIMUL     @D64ADVB 00450001
*-------------------------------------------------------------*@D64ADVB 00450101
         DC    CL8'#DISPSER'     ROUTINE NAME                  @D64ADVB 00450201
         DC    AL1(128)          MODE                          @D64ADVB 00450301
         DC    AL3(DISPSERV)     ADDRESS OF DISP SERVICES      @D64ADVB 00450401
*-------------------------------------------------------------*@D64ADVB 00450501
         DC    CL8'#GETLTA '     ROUTINE NAME                           00450600
         DC    AL1(0)            MODE                                   00450800
         DC    AL3(GETLTA)       ADDRESS OF GETLTA                      00451001
*-------------------------------------------------------------*         00451201
         DC    CL8'#GETVIS '     ROUTINE NAME                  @D64ADVB 00451401
         DC    AL1(128)          MODE                          @D64ADVB 00451601
         DC    AL3(GETVIS)       ADDRESS OF GETVIS             @D64ADVB 00451801
*-------------------------------------------------------------*@D64ADVB 00452001
         DC    CL8'#FREEVIS'     ROUTINE NAME                  @D64ADVB 00452201
         DC    AL1(128)          MODE                          @D64ADVB 00452401
         DC    AL3(FREEVIS)      ADDRESS OF GREEVIS            @D64ADVB 00452601
*-------------------------------------------------------------*@D64ADVB 00452801
         DC    CL8'#LOAD   '     ROUTINE NAME                  @D64ADVB 00453001
         DC    AL1(128)          MODE                          @D64ADVB 00453201
         DC    AL3(MVSLOADX)     ADDRESS OF LOAD-MVS           @D64ADVB 00453401
*-------------------------------------------------------------*@D64ADVB 00453601
         DC    CL8'#IOPOST0'     ROUTINE NAME                           00453800
         DC    AL1(128)          MODE                                   00454001
         DC    AL3(IOPOST0)      ADDRESS OF IOPOST0                     00454201
*-------------------------------------------------------------*         00454401
         DC    CL8'#POSTIOP'     ROUTINE NAME                           00454800
         DC    AL1(128)          MODE                                   00458001
         DC    AL3(RPOSTIOP)     ADDRESS OF RPOSTIOP                    00461201
*-------------------------------------------------------------*         00464401
         DC    CL8'#RPOST  '     ROUTINE NAME                           00467600
         DC    AL1(128)          MODE                                   00470801
         DC    AL3(RPOST)        ADDRESS OF RPOST                       00474001
*-------------------------------------------------------------*         00477201
         DC    CL8'#RWAIT  '     ROUTINE NAME                           00480400
         DC    AL1(128)          MODE                                   00483601
         DC    AL3(RWAIT)        ADDRESS OF RWAIT                       00486801
*-------------------------------------------------------------*         00490001
         DC    CL8'#RESVCX '     ROUTINE NAME                           00493200
         DC    AL1(128)          MODE                                   00496401
         DC    AL3(RESVCX)       ADDRESS OF RESVCX                      00499601
*-------------------------------------------------------------*         00502801
         DC    CL8'#UNPOST '     ROUTINE NAME                           00506000
         DC    AL1(128)          MODE                                   00509201
         DC    AL3(UNPOST)       ADDRESS OF UNPOST                      00512401
*-------------------------------------------------------------*         00512700
         DC    CL8'#SREADY '     ROUTINE NAME SETREADY         @D64ADVB 00513001
         DC    AL1(128)          MODE                          @D64ADVB 00513301
         DC    AL3(SETREADY)     ADDRESS OF SETREADY           @D64ADVB 00513601
*-------------------------------------------------------------*@D64ADVB 00513901
         DC    CL8'#VALIDS '     ROUTINE NAME                  @D64ADVB 00514201
         DC    AL1(128)          MODE                          @D64ADVB 00514501
         DC    AL3(VALIDSVA)     ADDRESS OF VALIDSVA           @D64ADVB 00514801
*-------------------------------------------------------------*         00515601
         DC    X'FF'             END OF TABLE                 *         00518801
         SPACE 2                 SVASVDL                                00522001
*-------------------------------------------------------------*         00525201
*    TABLE FOR RESOURCE DESCRIPTORS                           *         00528401
*-------------------------------------------------------------*         00531601
         SPACE 2                                                        00534801
LKU2RESQ DS    0F                                                       00538001
         DC    CL8'SRQDOCB'      WAIT RESOURCE DESCRIPTOR               00541201
         DC    A(SRQDOCB)        ADDRESS RTR BUFSPACE RSC DESCR         00544401
*-------------------------------------------------------------*         00547601
         DC    CL8'SRQDOCQ'      WAIT RESOURCE DESCRIPTOR               00550801
         DC    A(SRQDOCQ)        ADDRESS RTR Q-ACCESS RSC DESCR         00554001
*-------------------------------------------------------------*         00557201
         DC    CL8'SRQG113'      WAIT RESOURCE DESCRIPTOR               00560401
         DC    A(SRQG113)        ADDRESS OF WAIT RESOURCE DESCR         00563601
*-------------------------------------------------------------*         00564401
         DC    CL8'SRQLTA'       WAIT RESOURCE DESCRIPTOR               00565201
         DC    A(SRQLTA)         ADDRESS OF SPD TASK RESC DESCR         00566001
*-------------------------------------------------------------*         00566801
         DC    CL8'SRQSPDT'      WAIT RESOURCE DESCRIPTOR               00570001
         DC    A(SRQSPDT)        ADDRESS OF SPD TASK RESC DESCR         00573201
*-------------------------------------------------------------*         00576401
         DC    CL8'SRQWAIT'      WAIT RESOURCE DESCRIPTOR               00579601
         DC    A(SRQWAIT)        ADDRESS OF IO WAIT RESRC DESCR         00582801
*-------------------------------------------------------------*         00583600
         DC    CL8'SRQXMS '      WAIT RESOURCE DESCRIPTOR      @D64ADVB 00585001
         DC    A(SRQXMS)         ADDRESS OF CROS MEM SERV RESRC@D64ADVB 00586401
*-------------------------------------------------------------*@D64ADVB 00587801
         DC    X'FF'             END OF TABLE                 *         00589201
         SPACE 2                 SVASVDL                                00592401
*-------------------------------------------------------------*         00595601
*    TABLE FOR OFFSET OF ENTRY POINTS OF CPOOL SERVICES       *         00598801
*-------------------------------------------------------------*         00602001
         SPACE 2                                                        00605201
BLDINX   EQU    1                                                       00608401
EXPINX   EQU    2                                                       00611601
CONINX   EQU    3                                                       00614801
ACTINX   EQU    4                                                       00618001
DACINX   EQU    5                                                       00621201
DISINX   EQU    6                                                       00624401
GETINX   EQU    7                                                       00627601
RGTINX   EQU    8                                                       00630801
FREINX   EQU    9                                                       00634001
RFRINX   EQU   10                                                       00637201
QPLINX   EQU   11                                                       00640401
QEXINX   EQU   12                                                       00643601
QCLINX   EQU   13                                                       00646801
*                                                                       00650001
CSREPOFF DS    0F                                                       00653201
         DC    CL8'CSRPBLD'      NAME OF CPOOL SERVICE                  00656401
         DC    A(BLDINX*4)       OFFSET CSRP-TABLE                      00659601
*-------------------------------------------------------------*         00662801
         DC    CL8'CSRPEXP'      NAME OF CPOOL SERVICE                  00666001
         DC    A(EXPINX*4)       OFFSET CSRP-TABLE                      00669201
*-------------------------------------------------------------*         00672401
         DC    CL8'CSRPCON'      NAME OF CPOOL SERVICE                  00675601
         DC    A(CONINX*4)       OFFSET CSRP-TABLE                      00678801
*-------------------------------------------------------------*         00682001
         DC    CL8'CSRPACT'      NAME OF CPOOL SERVICE                  00685201
         DC    A(ACTINX*4)       OFFSET CSRP-TABLE                      00688401
*-------------------------------------------------------------*         00691601
         DC    CL8'CSRPDAC'      NAME OF CPOOL SERVICE                  00694801
         DC    A(DACINX*4)       OFFSET CSRP-TABLE                      00698001
*-------------------------------------------------------------*         00701201
         DC    CL8'CSRPDIS'      NAME OF CPOOL SERVICE                  00704401
         DC    A(DISINX*4)       OFFSET CSRP-TABLE                      00707601
*-------------------------------------------------------------*         00710801
         DC    CL8'CSRPGET'      NAME OF CPOOL SERVICE                  00714001
         DC    A(GETINX*4)       OFFSET CSRP-TABLE                      00717201
*-------------------------------------------------------------*         00720401
         DC    CL8'CSRPRGT'      NAME OF CPOOL SERVICE                  00723601
         DC    A(RGTINX*4)       OFFSET CSRP-TABLE                      00726801
*-------------------------------------------------------------*         00730001
         DC    CL8'CSRPFRE'      NAME OF CPOOL SERVICE                  00733201
         DC    A(FREINX*4)       OFFSET CSRP-TABLE                      00736401
*-------------------------------------------------------------*         00739601
         DC    CL8'CSRPGFR'      NAME OF CPOOL SERVICE                  00742801
         DC    A(RFRINX*4)       OFFSET CSRP-TABLE                      00746001
*-------------------------------------------------------------*         00749201
         DC    CL8'CSRPQPL'      NAME OF CPOOL SERVICE                  00752401
         DC    A(QPLINX*4)       OFFSET CSRP-TABLE                      00755601
*-------------------------------------------------------------*         00758801
         DC    CL8'CSRPQEX'      NAME OF CPOOL SERVICE                  00762001
         DC    A(QEXINX*4)       OFFSET CSRP-TABLE                      00765201
*-------------------------------------------------------------*         00768401
         DC    CL8'CSRPQCL'      NAME OF CPOOL SERVICE                  00771601
         DC    A(QCLINX*4)       OFFSET CSRP-TABLE                      00774801
*-------------------------------------------------------------*         00778001
         DC    X'FF'             END OF TABLE                 *         00781201
         EJECT                                                          00784401
*---------------------------------------------------------------------* 00800001
*  ROUTINE NAME: IEAVENLU VSE/ESA VERSION 2 RELEASE 1                   00850001
*  ROUTINE PROLOGUE                                                     00900001
*        'VSE/ESA SERVICE FOR NUCLKUP MACRO '                           00950001
*                                                                       01000001
*  FUNCTION                                                             01050001
*     BY SPECIFICATION OF AN ROUTINE OR CONTROL BLOCK NAME,             01100001
*     THE SERVICE PROVIDES THE ADDRESS OF THE RELATED ENTRY POINT       01150001
*     OR THE RELATED CONTROL BLOCK.                                     01200001
*     THE SERVICES RUNS UNDER CONTROL OF THE REQUESTOR WITH             01250001
*     THE KEY OF THE REQUESTOR.                                         01300001
*                                                                       01350001
*     CALLED VIA:                                                       01400001
*     - NUCLKUP MACRO EXPANSION                                         01450001
*                                                                       01500001
*  AMODE = ANY                                                          01550001
*                                                                       01600001
*  RMODE = ANY                                                          01650001
*                                                                       01700001
*  MODE  = PRIMARY ( SECONDARY-, HOME-, AND AR-MODE NOT ALLOWED )       01750001
*                                                                       01800001
*  ENTRY POINT:  IJBNUPL                                                01850001
*                                                                       01900001
*  LINKAGE:  VIA NUCLKUP MACRO                                          01950001
*            SLR   0,0                                                  02000001
*            L     15,16(0,0)                                           02050001
*            L     15,CVTNUCLU-CVTMAP(,15)                              02100001
*            BASSM 14,15                                                02150001
*                                                                       02200001
*  INPUT:    R0  =   0                                                  02250001
*            R1  =   ADDRESS OF ROUTINE NAME                            02300001
*            R13 =   R13 + 16 ADDRESS OF 16 FWORD SAVE AREA             02350005
*                    (DON'T MODIFY BYTE O-15 OF AREA WHERE R13 POINTS   02360005
*                     TO)                                               02370005
*            R14 =   AMODE AND RETURN ADDRES                            02400001
*            R15 =   ENTRY POINT OF $IJBNUPL                            02450001
*                                                                       02500001
*  OUTPUT:   R0  =   AMODE AMD ENTRY POINT OF ROUTINE                   02550001
*            R15 =   RETURN CODE                                        02600001
*               0 = SUCCESSFUL COMPLETION                               02650001
*               4 = REQUEST NOT SATISFIED,  R0 = 0                      02700001
*               8 = REQUEST NOT SATISFIED, DUE TO INVALID               02750001
*                           TYPE OF REQUEST, R0 = 0                     02800001
*              12 = INVALID RID                                         02850001
*                                                                       02900001
*  EXIT: RETURN TO CALLER                                               02950001
*                                                                       03000001
*  ERROR EXIT:  NONE                                                    03050001
*                                                                       03100001
*---------------------------------------------------------------------* 03400001
*  REGISTER USAGE                                                       03450001
*                                                                       03500001
*              INPUT               OUTPUT           USED FOR            03550001
*              -----               ------           ---------           03600001
*                                                                       03650001
*        R0  - 0                   AMODE + EP                           03700001
*        R1  - ADDR OF ROUT.NAME   UNCHANGED                            03750001
*        R2  -                     UNCHANGED                            03800001
*        R3  -                     UNCHANGED                            03850001
*        R4  -                     UNCHANGED                            03900001
*        R5  -                     UNCHANGED                            03950001
*        R6  -                     UNCHANGED                            04000001
*        R7  - WORKREGISTER        UNCHANGED                            04050000
*        R8  - WORKREGISTER        UNCHANGED                            04100000
*        R9  - WORKREGISTER        UNCHANGED                            04150001
*        R10 - WORKREGISTER        UNCHANGED                            04200001
*        R11 - WORKREGISTER        UNCHANGED                            04250001
*        R12 - WORKREGISTER        UNCHANGED                            04300001
*        R13 - SAVE AREA ADDRESS   UNCHANGED                            04350001
*        R14 - RETURN REGISTER     RETURN REGISTER                      04400001
*        R15 - BASE REGISTER       RETURN CODE                          04450001
*                                                                       04500001
*                                                                       04550001
*  INTERNAL SUBROUTINES USED                                            04600001
*        NONE                                                           04650001
*                                                                       04700001
*---------------------------------------------------------------------* 04750001
         SPACE 2                                                        04800001
*---------------------------------------------------------------------* 05450001
*                                                                     * 05500001
*      NUCLKUP SERVICE ROUTINE                                        * 05550001
*                                                                     * 05600001
*---------------------------------------------------------------------* 05650001
         USING IEAVENLU,RF              ADDRESSIBILITY OF MODULE        05700000
         USING SYSS00,R0                ADDRESSIBILITY OF LOW CORE      05750001
NUPLBEG  DS    0D                                                       05850001
         DC    CL8'SGNUPL  '            MACRO IDENTIFICATION            05900001
         DC    CL4'4C50'                /*@@LVLID*/                     05950003
         DC    CL16'*** 97/08/04 ***'                                   06000003
         DC    C'        '              LAST APAR FIXED                 06050001
         SPACE 1                                                        06200001
*   CHECK FUNCTION CODE AND ENVIRONMENT                                 06250001
         SPACE 1                                                        06300001
IEAVENLU DS    0H                       MVS - ENTRY NAME                06375001
         LTR   R0,R0                    BYNAME REQUEST                  06400001
         BNZ   NUPLERR8                 NO, ------> ERROR EXIT          06450001
.*       LAE   R0,0(,RD)                GET TRANSLATION MODE            06500001
.*       LTR   R0,R0                    PRIMARY MODE OR AR MODE        *06550001
                                            WITH INACTIVE AR REG        06600001
.*       BNZ   NUPLERR8                 NO, ------> ERROR EXIT          06650001
         SPACE 1                                                        06700001
*   SAVE REGISTER AND DO 1ST LEVEL SCAN                                 06750001
         SPACE 1                                                        06800001
NUPL100  DS    0H                                                       06850001
         STM   R1,RE,16(RD)             ONLY R1-RE MUST BE SAV.@D64ADUL 06883303
         L     RC,ASYSCOM               GET SYSCOM                      06916601
         USING SYSCOM,RC                ADDRESSABILITY TO SYSCOM        06933201
         L     R9,NUCLKUTB              GET NUCLKUP DIRECTORY          *06950001
                                             (FIRST LEVEL TABLE)        07100001
         USING LKU1STLV,R9                                              07150001
         LH    RA,LKUHDNUM              NUMBER OF ENTRIES               07200001
         L     R9,LKUHDTAB              ADDRESS OF FIRST ENTRY          07250001
         USING LKU1SENY,R9                                              07300001
NUPL120  DS    0H                                                       07350001
         IC    RB,LKUTBLEN              LENGTH OF RELEVANT PART OF NAME 07400001
         EX    RB,NUPL1CLC              CHECK IF TABLE ENTRY HIT        07450001
         BE    NUPL140                  YES, --------->                 07500001
         LA    R9,LKU1SENL(,R9)         ADDRESS OF NEXT ENTRY           07550001
         BCT   RA,NUPL120               BR IF MORE TO CHECK -------->   07600001
*                                       SDL SEARCH VIA NEXT ENTRY       07650000
         SPACE 1                                                        07800001
*    CHECK CORRECT RID                                                  07850001
         SPACE 1                                                        07900001
NUPL140  DS    0H                                                       07950001
         TM    SYSFLAG2,IPLBIT          IPL IN PROGRESS                 07966601
         BO    NUPL200                  YES ------> OK                  07983201
         CLI   RID+1,GATEDRID           CURRENT RID = GATED ROUTINE     08000001
         BNL   NUPL200                  YES ------> OK                  08050001
         CLI   RID+1,REENTRID           CURRENT RID = REENTERABLE R.    08100001
         BE    NUPL200                  YES ------> OK                  08150001
         CLI   RID+1,USERTID            RID = TASK SUPPORTED            08200001
         BNE   NUPLERRC                 NO, ------> UNSUPPORTED RID     08250001
         CLI   LKUTBTID,X00             RID = ANY TASK SUPPORTED        08300001
         BE    NUPL200                  YES, ----->                     08350001
         CLC   IJBTIK,IJBHSTID          SYSTEM TASK                     08400001
         BH    NUPLERRC                 NO, ------> UNSUPPORTED RID     08450001
         DROP  RC                                                       08475001
         SPACE 1                                                        08500001
*   2ND LEVEL SEARCH ON ROUTINE TABLE                                   08550001
         SPACE 1                                                        08600001
NUPL200  DS    0H                                                       08650001
*        AMODESW SET,AMODE=31,WR=(RC)                                   08655501
         AMODESW SET,AMODE=31,WR=(RC)                                   08661001
         L     RA,LKURTNFD              ADDR ROUTINE HANDLING  @D64ADVB 08711001
*                                       ... NOT FOUND CONDITION@D64ADVB 08761001
         L     RC,LKURTADR              ADDR ROUTINE PROVIDING @D64ADVB 08811001
*                                       ... THE ENTRY POINT    @D64ADVB 08861001
         L     R8,LKUTBADR              ADDR OF ROUTINE TABLE  @D64ADVB 08911001
         USING SVASVDE,R8                                      @D64ADVB 08961001
NUPL240  DS    0H                                                       09200001
         CLI   SVASVPHN,XFF             END OF LIST REACHED             09250001
         BER   RA                       YES,----------> NOT FOUND       09275000
.*                                          FOR SPECIAL ENTRIES: RC=04  09300000
.*                                          FOR SDL SCAN: CALL BINSRCH  09325000
         CLC   SVASVPHN,0(R1)           MATCHING PHASE NAME             09350001
         BE    NUPL300                  YES,----------> FOUND           09400001
         LA    R8,LKU2SENL(,R8)         NEXT TABLE ENTRY                09450000
         B     NUPL240                  --------->                      09500001
         DROP  R8                                                       09525000
         SPACE 1                                                        09550001
*     GET ENTRY POINT -                                                 09566600
         SPACE 1                                                        09583201
NUPL300  DS    0H                                                       09600001
         BALR  RC,RC                    GET ENTRY POINT                 09650001
         SPACE 1                                                        09750001
*     PROVIDE ADDRESSING MODE                                           09800001
         SPACE 1                                                        09850001
NUPL400  DS    0H                                                       09875000
.*       N     RE,BIT0OMSK              GET AMODE OF CALLER             09918700
.*       O     RE,BIT0OFF                                               09962400
.*       NR    R0,RE                    PROVIDE ACTUAL MODE             10006100
         SLR   RF,RF                    RETURN CODE = 0                 10050001
         LM    R1,RE,16(RD)             RELOAD USER REGISTERS  @D64ADUL 10100003
*        AMODESW RETURN,REG=(RE)        =========>                      10150001
         AMODESW RETURN,REG=(RE)                                        10200001
         SPACE 2                                                        10204301
NUPL1CLC CLC   0(0,R1),LKUTBCLC                                         10222500
         DROP  R9                                                       10240701
         SPACE 2                                                        10241000
*---------------------------------------------------------------------* 10241300
*      SCAN SDL (NOT FOUND CONDITION ON SVASDLL)                        10241600
*---------------------------------------------------------------------* 10241900
         SPACE 1                                                        10242200
NUPLSDL  DS    0H                                              @D64ADVB 10242401
         TM    IJBSVAFL,SDLBUILT        HAS SVA BEEN BUILT     @D64ADVB 10242601
         BZ    NUPLERR4                 NO  --------->         @D64ADVB 10242801
         LR    RC,RF                    SAVE BASE              @D64ADVB 10243001
         LA    R0,SDLELEN               LENGTH OF ENTRY        @D64ADVB 10243201
         L     RA,TCBPTR                ADDR OF CURRENT TCB    @D64ADVB 10243401
         L     RB,AFCHDAT               ADDR OF FETCH DATA AREA@D64ADVB 10243601
         L     R9,AFETCH                BASE OF FETCH ROUTINE  @D64ADVB 10243801
         USING FETCH,R9                                        @D64ADVB 10244001
         BAL   R6,BINSRCH                                      @D64ADVB 10244201
*SGLINK  BINSRCH,INPUT=(R0,R1,R6,R9,RA,RB),OUTPUT=(R1,RF),     @D64ADVB 10244401
*              WORK=(R2,R3,R4,R5)                              @D64ADVB 10244601
         DROP  R9                                              @D64ADVB 10244801
         LTR   R0,RF                    PHASE FOUND IN SDL-SVA @D64ADVB 10245001
         LR    RF,RC                        ) RESET BASE (     @D64ADVB 10245201
         BNZ   NUPLERR4                 YES,  --------->       @D64ADVB 10245401
         USING INLCSDLE,R1                                     @D64ADVB 10245601
         USING TCBADR,RA                                       @D64ADVB 10246001
         TM    SDLEFLG,SDLEBAC+SDLEBNF  SDLE HAS VALID PHASE   @D64ADVB 10246401
         BNM   NUPLERR4                 NO,   --------->       @D64ADVB 10246801
         TM    SDLEFLG,SDLEBSV+SDLEBSE  SDLE IS PROVIDING SVA PHASE     10247200
         BNO   NUPLERR4                 NO,   --------->       @D64ADVB 10247601
         L     R0,SDLESVAP              ENTRY POINT IN SVA     @D64ADVB 10248201
         TM    SDLESWT,SDLEAM31         AMODE 31 ?             @D64ADVB 10248301
         BZ    NUPL400                  NO,   ---------->      @D64ADVB 10248401
         TM    SDLESWT,SDLEAM24         AMODE ANY ?            @D64ADVB 10248501
         BZ    NUPLSDLX                 NO,PHASE HAS AMODE 31  @D64ADVB 10248601
         TM    TCBEXFLG,TCBEXAM         AMODE=ANY,CALLER AMODE 31?      10248700
         BZ    NUPL400                  NO,  ----------->      @D64ADVB 10248801
NUPLSDLX DS    0H                                              @D64ADVB 10248901
         O     R0,BIT0OMSK              INDICATE  AMODE=31     @D64ADVB 10249001
         DROP  R1                                              @D64ADVB 10249101
         DROP  RA                                              @D64ADVB 10249201
         B     NUPL400                                         @D64ADVB 10249301
         SPACE 2                                                        10249400
*---------------------------------------------------------------------* 10249500
*      ROUTINES DETERMINING ENTRY POINTS                              * 10249700
*---------------------------------------------------------------------* 10250000
         SPACE 1                                                        10250300
NUPLCSR  DS    0H                                                       10250600
         USING SVASVDE,R8                                               10250900
         L     RA,SVASVENP              GET ENTRY POINT                 10251200
         DROP  R8                                                       10251500
         L     R8,CVTPTR                CVT ADDRESS                     10251800
         L     R8,CVTCSRT-CVTMAP(,R8)   ADDR OF CSRTABLE                10252100
         LTR   R8,R8                    ALREADY INITIALIZED             10252400
         BZ    NUPLERR4                 NO, ---------->     NOT FOUND   10255901
         L     R8,CPTBLOFF(,R8)         ADDRESS OF CSRCPTBL             10258900
         L     R0,0(RA,R8)              EP-ADDRESS OF CSR-SERVICE       10261900
         BR    RC                       RETURN TO MAINLINE ==========>  10265101
         SPACE 1                                                        10265701
NUPLCEX  DS    0H                                                       10266301
         USING SVASVDE,R8                                               10266900
         L     R0,SVASVENP              GET ENTRY POINT                 10267501
         DROP  R8                                                       10268100
         LTR   R0,R0                    ENTITY INITALIZED      @D64ADVB 10269301
         BNZR  RC                       RETURN TO MAIN =======>@D64ADVB 10270501
* -----> B     NUPLERRH                 ERROR  --------->      @D64ADVB 10271701
         SPACE 2                                                        10273101
*---------------------------------------------------------------------* 10277401
*                                                                     * 10281701
*      NUCLKUP ERROR EXITS                                            * 10286001
*                                                                     * 10290301
*---------------------------------------------------------------------* 10294601
         SPACE 2                                                        10300001
NUPLERRH DS    0H                                              @D64ADVB 10310001
         LA    R0,LKPRC10(,0)           RETURN CODE = 16       @D64ADVB 10320001
         B     NUPLERXX                 ---------->            @D64ADVB 10330001
         SPACE 2                                                        10340000
NUPLERR4 DS    0H                                                       10350001
         LA    R0,LKPRC04(,RF)          RETURN CODE = 4                 10400000
         B     NUPLERXX                 ---------->                     10450000
         SPACE 2                                                        10700001
NUPLERR8 DS    0H                                                       10750001
         LA    R0,LKPRC08(,0)           RETURN CODE = 8                 10800000
         B     NUPLERXX                 ---------->                     10850000
         SPACE 2                                                        11050001
NUPLERRC DS    0H                                                       11100001
         LA    R0,LKPRC0C(,0)           RETURN CODE = 12                11150000
NUPLERXT DS    0H                                                       11200000
         LM    R1,RE,16(RD)             RELOAD USER REGISTERS  @D64ADUL 11250004
NUPLERXX DS    0H                                                       11262500
         LR    RF,R0                    PROVIDE RC                      11275000
         SLR   R0,R0                    R0 = 0                          11287500
         BSM   0,RE                     ==========>  RETURN             11300001
         SPACE 2                                                        11450001
NUCLKUTB DC    A(LKU1STLV)                                              11500001
         DROP  RF                                                       11625001
*---------------------------------------------------------------------* 11650001
         EJECT                                                          11700001
*---------------------------------------------------------------------* 12350001
*                                                                       12400001
*     MAPPINGS, DSECTS AND EQUATES                                      12450001
*                                                                       12500001
*---------------------------------------------------------------------* 12550001
         SPACE 2                                                        12600001
*     RETURN CODES                                                      12650001
LKPRC00  EQU   0                        PROCESSING SUCCESSFUL           12700001
LKPRC04  EQU   4                        NOT FOUND                       12750001
LKPRC08  EQU   8                        INVALID TYPE OF REQUEST         12800001
LKPRC0C  EQU   12                       INVALID RID                     12850001
LKPRC10  EQU   16                       ENTITY NOT INITILAIZES @D64ADVB 12875001
         SPACE 1                                                        12900001
*     RID EQUATES                                                       12950001
GATEDRID EQU   X'40'                    LOWEST GATED ROUTINE ID         13000001
         SPACE 1                                                        13050001
*     CSRP DEPENDENCY                                                   13062501
CPTBLOFF EQU   X'0C'                    OFFSET IN CSRPTAB               13075001
*                                                                       13087501
         AIF   (NOT &SGNUPL).EDPRINT                                    13118701
         PRINT NOGEN                                                    13150001
.EDPRINT ANOP                                                           13200001
         MEND                                                           13250001
