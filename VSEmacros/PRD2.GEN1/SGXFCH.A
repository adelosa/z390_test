         MACRO                                                          00041200
         SGXFCH                                                         00082400
         GBLB  &SGXFCH                                                  00082532
*---------------------------------------------------------------------* 00123600
*                                                                       00164800
.*       IBM DISK OPERATING SYSTEM                                      00206000
*        SUPERVISOR - SGXFCH - 5686-066                                 00247200
.*                                                                      00288400
*        LICENSED MATERIALS - PROPERTY OF IBM                           00329600
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                    00370800
*        5686-066 (C) COPYRIGHT IBM CORP. 1996, 2001                    00412058
*        SEE COPYRIGHT INSTRUCTIONS                                     00453200
*                                                                       00494400
*---------------------------------------------------------------------* 00535600
         AIF   (NOT &SGXFCH).NOPRINT                                    00535732
         PRINT GEN                                                      00535831
.NOPRINT ANOP                                                           00535931
.* /* START OF SPECIFICATIONS ***************************************** 00576800
.*                                                                      00618000
.*01* MODULE-TYPE = SUPERVISOR GENERATION MACRO                         00659200
.*                                                                      00700400
.*01* DESCRIPTIVE NAME = PROGRAM MANAGEMENT ROUTINES FOR MVS API        00741600
.*                                                                      00782800
.*01* NOTES = CHANGE ACTIVITY                                           00824000
.*            NEW MODULE IN AF 6.4   - MVS PLATFORM            @D64ADVB 00865219
.*      MORE THAN 255 TASKS                                    @D66ODOW 00865359
.*                                                                      00906400
.* A000000-999999                                              @D64ADVB 00947619
.**** END OF SPECIFICATIONS ***************************************** / 00988800
         TITLE 'VSE SUPERVISOR    SGXFCH  -  MVS PLATFORM - LOAD/DELETE*01030000
               /BLDL SERVICES  06/25/98'                                01071257
*---------------------------------------------------------------------* 01112400
*     IHA PDS DSECT FROM MVS  (BLDL ENTRY FORMAT)                       01153600
*---------------------------------------------------------------------* 01194800
         SPACE 2                                                        01236000
         IHAPDS                                                         01277200
         SPACE 2                                                        01318400
BLDLEMVS EQU   PDSBCLN+1                                                01359600
BLDLEXLN EQU   BLDLEMVS+SDLELEN                                         01400800
         EJECT                                                          01442000
IJBSUP50 CSECT ,                                                        01483200
         DS    0D                                                       01524400
*---------------------------------------------------------------------* 01565600
*  ROUTINE NAME: MVSXLOAD  VSE/ESA VERSION 2 RELEASE 4                  01606814
*  ROUTINE PROLOGUE                                                     01648000
*        'VSE/ESA SERVICES FOR MVS PLATFORM: LOAD '                     01689200
*                                                                       01730400
*  FUNCTION:                                                            01771600
*     -  SIMULATES MVS-LOAD                                             01812800
*                                                                       01854000
*  CALLED VIA:                                                          01895200
*     - LOAD MACRO EXPANSION   (MVS SVC CODE X'7A')                     01936400
*                              (MVS SVC CODE X'08')                     01936514
*                                                                       01977600
*  AMODE = ANY                                                          02018800
*                                                                       02060000
*  MODE  = PRIMARY                                                      02101200
*                                                                       02142400
*  ENTRY POINT = MVSXLOAD                                               02183600
*                                                                       02224800
*  LINKAGE:  VIA SVC INTERRUPT HANDLER                                  02266000
*                                                                       02307200
*  INPUT: (SVC CODE X'7A')                                              02348414
*            R0  =   -                                                  02389600
*            R1  =   ADDRESS OF PARAMETER LIST                          02430800
*            R6  =   ADDRESS OF DISPATCHER                              02472000
*            R8  =   ADDRESS OF TIB                                     02513200
*            RA  =   ADDRESS OF TCB                                     02554400
*            RB  =   ADDRESS OF SAVE AREA (TCBSAVE)                     02595600
*            RF  =   FUNCTION CODE                                      02636800
*                                                                       02678000
*            PARAMETER LIST - MVS PLATFORM:                             02719200
*             A      ADDRESS OF EP/DE/EPLOC                             02760400
*             A      ADDRESS OF DCB - IF ANY                            02801600
*             XL1    PARAMETER LIST FORMAT                              02842800
*                           - CURRENTLY X'00'                           02884000
*             XL1    RESERVED                                           02925200
*             XL1    OPTION BYTE 1                                      02966400
*             X'80'  DE SPECIFIED                                       03007600
*             X'20'  ERRET SPECIFIED                                    03048800
*             X'10'  GLOBAL SPECIFIED                                   03090000
*             X'08'  GLOBAL-F SPECIFIED                                 03131200
*             X'04'  ADDR SPECIFIED                                     03172400
*             X'02'  OEM  SPECIFIED                                     03213600
*             X'01'  LOADPT SPECIFIED                                   03254800
*             XL1    OPTION BYTE 2                                      03296000
*             X'80'  ADRNAPF SPECIFIED                                  03337200
*             A      ADDR WHERE LOAD ADDR TO BE SAVED                   03378400
*                                                                       03419600
*  INPUT: (SVC CODE X'08')                                              03419714
*                                                                       03419814
*   R0 : ADDR(PHASENAME) (EP/EPLOC SPECIFIED)                           03419914
*   R0 : -ADDR(DE)       (DE SPECIFIED)                                 03420014
*                                                                       03430014
*   R1 : BIT 0=1 (ERRET SPECIFIED)                                      03440014
*        BIT 0=0 (ERRET NOT SPECIFIED)                                  03440114
*                                                                       03440214
*   R1 : BIT 1-31 (DCB ADDR)                                            03441014
*                                                                       03450014
*  OUTPUT:                                                              03460800
*            R0  =   ADDRESSING MODE, ENTRYPOINT ADDRESS                03502000
*            R1  =   AUTHORIZATION CODE, LENGTH OF PHASE (IN D)         03543200
*            R15 =   RETURN CODE                                        03584400
*                    = 0: SUCCESSFUL COMPLETION                         03625600
*                    /=0: REQUEST NOT SATISFIED                         03666800
*                    R15 CONTAINS REASON CODE                           03708000
*                    R1  CONTAINS SYSTEM COMPLETION CODE                03749200
*                    R0  CONTAINS SUBREASON CODE                        03790400
*                                                                       03831600
*  EXIT: RETURN TO DISPMVS                                              03872800
*                                                                       03914000
*  ERROR EXIT:                                                          03955200
*                                                                       03996400
*  CHANGE ACTIVITIES:                                                   04037600
*     NEW FOR VSE/ESA 2.4.0                                             04078825
*                                                                       04120000
*  INTERNAL SUBROUTINES:                                                04161200
*        CDLGOPEN                                                       04202400
*        CDLGCLOS                                                       04243600
*        XLDVALID                                                       04284800
*        XLDFIATE                                                       04326000
*        CDLFTCH                                                        04367200
*        XLDUPLLE                                                       04408400
*---------------------------------------------------------------------* 04449600
.* REGISTER USAGE FOR MVSXLOAD                                          04490800
.*                                                                      04532000
.*             INPUT            OUTPUT           USED AS                04573200
.*             -----            ------           -------                04614400
.*                                                                      04655600
.*       R0  -                  REASON CODE      WORK                   04696800
.*       R1  - PARAMETER LIST   UNCHANGED        WORK                   04738000
.*       R2  -                  UNCHANGED        WORK                   04779200
.*       R3  -                  UNCHANGED        WORK                   04820400
.*       R4  -                  UNCHANGED        WORK                   04861600
.*       R5  -                  UNCHANGED        WORK                   04902800
.*       R6  - ADDRES OD DISP   UNCHANGED        WORK                   04944000
.*       R7  -                  UNCHANGED                               04985200
.*       R8  - ADDRESS SA       UNCHANGED        LINK                   05026400
.*       R9  -                  UNCHANGED        LINK                   05067600
.*       R10 - ADDRESS TCB      UNCHANGED        ADDR TCB               05108800
.*       R11 - ADDRESS OF SA    UNCHANGED        ADDR SGAFCH            05150000
.*       R12 -                  UNCHANGED                               05191200
.*       R13 -                  UNCHANGED                               05232400
.*       R14 -                  UNCHANGED        BASE                   05273600
.*       R15 -                  RETURN CODE      WORK                   05314800
.*--------------------------------------------------------------------* 05356000
         SPACE 2                                                        05397200
MVSLODEL DS    0H                                                       05438400
         USING SVEARA,RB          ADDRESSIBILITY OF SA                  05479600
         USING TCBADR,RA          ADDRESSIBILITY OF TCB                 05520800
         USING DISP,R6            ADDRESSIBILITY OF DISP                05562000
         SPACE 1                                                        05603200
         DS    0D                 SERVICE ENTRE                         05644400
         DC    CL8'SGXFCH  '      EYECATCHER                            05685600
         DC    CL8'MVSLOAD'                                             05685758
         DC    CL8'        '      LAST APAR                             05726800
         DC    CL10'02/28/2001'    MM/DD/YY                             05754258
         SPACE 1                                                        05809200
*---------------------------------------------------------------------* 05850400
*     MVS LOAD - SVC X'7A'                                            * 05891635
*---------------------------------------------------------------------* 05932800
         SPACE 2                                                        05974000
MVSXLOAD DS    0H                 ENTRY POINT SVC I/F - SVC 74          06015200
         STM   RE,R1,DFCBSAV+OFSXRE SAVE USER'S REGS                    06056400
         L     RE,AMVSXLOD        BASE OF ROUTINE                       06097600
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             06138800
         CL    RF,MVSLDFCT        FUNCTION CODE = 9                     06180000
         BNE   ERR21              NO, ILLEGAL SVC                       06221220
         DROP  R6                 RESET BASE TO DISP                    06262400
         SLR   RD,RD                                                    06303600
         B     XLOD0080           --------->                            06344800
         SPACE 1                                                        06386000
*---------------------------------------------------------------------* 06427200
*     MVS LOAD - SVC X'08'                                            * 06468400
*---------------------------------------------------------------------* 06509600
MVSSLOAD DS    0H                 ENTRY POINT SVC I/F - SVC 8           06550800
         STM   RE,R1,DFCBSAV+OFSXRE SAVE USER'S REGS                    06592000
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             06633200
         L     RE,CDBASE          BASE OF CDLOAD                        06674400
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              06715600
         BAL   R8,CDLGCLOS        GATE CDLOAD                           06756800
*SGLINK CDLGCLOS,INPUT=(R6,R8,RE),WORK=(R2,R5),OUTPUT=()                06798000
         L     RE,AMVSXLOD        BASE OF ROUTINE                       06839200
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             06880400
         LA    R0,XMACLOD         PROVIDE ....                          06921600
         ST    R0,DFCBMACN        ....    CURRENT MACRO NAME            06962800
         XC    DFWKUSEN(DFWKX1LN),DFWKUSEN  CLEAR REQ. STATUS           07004000
         XC    DFWKRTUR,DFWKRTUR                                        07045200
         XC    DFWKPHNM(SDLELEN+DFWKPLEN),DFWKPHNM CLEAR AREA           07086400
         SPACE 1                                                        07127600
*---------------------------------------------------------------------* 07168800
*     VALIDATION OF PROVIDED REGISTER REFERENCIES                     * 07210000
*---------------------------------------------------------------------* 07251200
         SLR   R0,R0              SET 24-BIT MODE                       07292400
         TM    TCBEXFLG,TCBEXAM   REQUESTOR IN 31-BIT MODE              07333600
         BZ    XLOD0000           NO, ---------->                       07374800
         O     R0,BIT0OMSK        SET 31-BIT MODE                       07416000
XLOD0000 DS    0H                                                       07457200
*        AMODESW SET,AMODE=(R0),WR=(RF) GET MODE OF REQUESTOR           07498400
         AMODESW SET,AMODE=(R0),WR=(RF) GET MODE OF REQUESTOR           07539600
         LM    R1,R2,DFCBSAV+OFSXR0  R1=ADDR(PHASEN) OR -ADDR(DE)       07580814
*                                    R2=ADDR(DCB) PLUS ERRET INDIC.     07580914
         LTR   R2,R2              ERROR RETURN ADDRESS SPECIFIFIED      07622000
         BNM   XLOD0020           NO,  ---------->                      07663200
         LA    R2,0(,R2)          CLEAR HIGH ORDERED BIT/BYTE           07704400
         OI    DFWKOPT1,DFWKERET  INDICATE ERRET SPECIFIED              07745600
XLOD0020 DS    0H                                                       07786800
         LTR   R1,R1              DE SPECIFIED                          07828000
         BNM   XLOD0040           NO,  ---------->                      07869200
         OI    DFWKOPT1,DFWKDESP  INDICATE DE PROVIDED                  07910400
         LPR   R1,R1                                                    07951600
XLOD0040 DS    0H                                                       07992800
         MVI   DFWKRQFM,MVSCDLD   REQUEST: MVS-LOAD                     08034000
         STM   R1,R2,DFWKPHNM     PROVIDE ADDRESS OF PHASE NAME         08075200
*                                 ... AND DCB                           08116400
         L     R0,CRADDR          ADDR OF CURRENT COMREG                08157600
         ST    R0,DFWKCOMG        ....                                  08198800
*                                 ... PHASE NOT FOUND                   08322400
*     VALIDATION OF PHASENAME                                           08363600
         LA    R0,XKEYPAR(,0)     KEY/AREA VIOL. EPLOC 206-C0  @D64ADMZ 08363824
         L     R1,DFWKPHNM        LOW ADDRESS OF PARAMETER              08404800
         LA    R2,L'DFWKNAME-1(,R1) END ADDRESS FOR EP/EPLOC            08446000
         TM    DFWKOPT1,DFWKDESP  DE SPECIFIED                          08487200
         BZ    XLOD0050           NO, ---------->                       08528400
         LA    R0,XKEYDEN(,0)     KEY/AREA VIOLATION DE    206-C4       08569619
         LA    R2,PDSBCLN+SDLELEN-L'DFWKNAME(,R1) END ADDRESS FOR DE    08610819
*                                                              @D64ADMZ 08610919
XLOD0050 DS    0H                                                       08652000
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           08693200
         BAL   R9,XLDVALID        VALIDATE DE/EP/EPLOC                  08734400
*                                 CONTINUE IF O.K.                      08775600
         TM    0(R1),XFF          PHASE NAME STARTS WITH X'FF'          08775719
         BO    XLD80604           YES, ==========>                      08775819
         L     R1,DFWKADCB        LOW ADDRESS OF DCB                    08816800
         LTR   R1,R1              DCB AVAILABLE                         08858000
         BZ    XLOD0060           NO,  --------->                       08899200
         CL    R1,F1              DCB=1 IS USED TO INDICATE NON@D64ADMZ 08899319
*                                 DCB SEARCH CHAIN (CICS I/F)  @D64ADMZ 08899419
         BE    XLOD0055           SKIP VALID., ADDR IS INVALID @D64ADMZ 08899519
         LA    R0,XKEYDCB(,0)     KEY/AREA VIOL. DCB   206-C8  @D64ADMZ 08899624
         LA    R2,IALCLEN-1(,R1)  END ADDRESS FOR DCB                   08940400
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           08981600
         BAL   R9,XLDVALID        VALIDATE DCB                          09022800
*                                 CONTINUE IF O.K.                      09064000
XLOD0055 DS    0H                                              @D64ADMZ 09065019
         OI    DFWKSWRQ,DCBSRCH   SET DCB-SEARCH FLAG                   09105200
XLOD0060 DS    0H                                                       09146400
*        AMODESW  SET,AMODE=31,WR=(R3)  GET AMODE 31                    09187600
         AMODESW  SET,AMODE=31,WR=(R3)                                  09228800
         B     XLOD0160           ---------->                           09270000
         SPACE 1                                                        09311200
*---------------------------------------------------------------------* 09352400
*     BALR I/F                                                        * 09393600
*---------------------------------------------------------------------* 09434800
MVSLOADX DS    0H                                                       09476000
         STM   RE,R1,DFCBSAV+OFSXRE SAVE USER'S REGS                    09517200
         SLR   RF,RF                                                    09558400
         STM   RE,RC,12(RD)                                             09599600
         L     RB,TCBSAVE         GET TASK'S SA ADDRESS                 09640800
XLOD0080 DS    0H                                                       09682000
         ST    RD,DFWKRTUR        SAVE USER'S SA ADDR                   09723200
         XC    DFWKUSEN(DFWKX1LN),DFWKUSEN  CLEAR REQ. STATUS           09764400
         XC    DFWKNAME(SDLELEN-1),DFWKNAME CLEAR REQ. SDLE             09805600
*---------------------------------------------------------------------* 09846800
*     GET CDLOAD GATE                                                 * 09888000
*---------------------------------------------------------------------* 09929200
         L     RE,CDBASE          BASE OF CDLOAD                        09970400
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              10011600
         BAL   R8,CDLGCLOS        GATE CDLOAD                           10052800
*SGLINK CDLGCLOS,INPUT=(R6,R8,RE),WORK=(R2,R5),OUTPUT=()                10094000
         L     RE,AMVSXLOD        BASE OF ROUTINE                       10135200
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             10176400
         LA    R0,XMACLOD         PROVIDE ....                          10217600
         ST    R0,DFCBMACN        ....    CURRENT MACRO NAME            10258800
*---------------------------------------------------------------------* 10300000
*     VALIDATION OF PROVIDED AREAS                                    * 10341200
*---------------------------------------------------------------------* 10382400
         LTR   RD,RD              BALR I/F                              10423600
         BNZ   XLOD0110           YES, --------->                       10464800
         SLR   R0,R0              SET 24-BIT MODE                       10506000
         TM    TCBEXFLG,TCBEXAM   REQUESTOR IN 31-BIT MODE              10547200
         BZ    XLOD0100           NO, ---------->                       10588400
         O     R0,BIT0OMSK        SET 31-BIT MODE                       10629600
XLOD0100 DS    0H                                                       10670800
*        AMODESW SET,AMODE=(R0),WR=(RF) GET MODE OF REQUESTOR           10712000
         AMODESW SET,AMODE=(R0),WR=(RF) GET MODE OF REQUESTOR           10753200
XLOD0110 DS    0H                                                       10794400
*     VALIDATION OF PARAMETER LIST                                      10835600
         LA    R0,XKEYPAR(,0)     KEY VIOLAT PARM  206-C0               10876800
*        R1 POINTS TO PARAMETER LIST                                    10918000
         LA    R1,0(,R1)          CLEAR HIGH ORDERED BIT/BYTE           10959200
         LA    R2,FCHPLLEN(,R1)   END OF PARAMETER LIST                 11000400
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           11041600
         BAL   R9,XLDVALID        VALIDATE PARAMETER LIST               11082800
*                                 CONTINUE IF O.K.                      11124000
         MVC   DFWKPHNM(FCHPLLEN+1),0(R1)                               11165200
*                                 MOVE PARMLIST IN FCHWORK              11206400
*     VALIDATION OF LOADPT PARAMETER                                    11247600
         TM    DFWKOPT1,DFWKLDRX  LOADPT SPECIFIED                      11288800
         BZ    XLOD0120           NO, ---------->                       11330000
         L     R1,DFWKALDP        LOW ADDRESS OF PARAMETER              11371200
         LA    R2,3(,R1)          END ADDRESS FOR LOADPT                11412400
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           11453600
         BAL   R9,XLDVALID        VALIDATE ADDR OF LOADPOINT            11494800
*                                 CONTINUE IF O.K.                      11536000
*     VALIDATION OF DE/EP/EPLOC PARAMETER                               11577200
XLOD0120 DS    0H                                                       11618400
         L     R1,DFWKPHNM        LOW ADDRESS OF PARAMETER              11659600
         LA    R2,L'DFWKNAME-1(,R1) END ADDRESS FOR EP/EPLOC            11700800
         TM    DFWKOPT1,DFWKDESP  DE SPECIFIED                          11742000
         BZ    XLOD0130           NO, ---------->                       11783200
         LA    R0,XKEYDEN(,0)     KEY VIOLAT DE    206-C4               11824400
         LA    R2,SDLELEN-L'DFWKNAME(,R1) END ADDRESS FOR DE            11865600
XLOD0130 DS    0H                                                       11906800
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           11948000
         BAL   R9,XLDVALID        VALIDATE DE/EP/EPLOC                  11989200
*                                 CONTINUE IF O.K.                      12030400
*     VALIDATION OF DCB PARAMETER                                       12071600
         LA    R0,XKEYDCB(,0)     KEY VIOLAT DCB   206-C8               12112800
         L     R1,DFWKADCB        LOW ADDRESS OF PARAMETER              12154000
         LTR   R1,R1              DCB SPECIFIED                         12195200
         BZ    XLOD0140           NO, ---------->                       12236400
         CL    R1,F1              DCB=1 IS USED OT IND. NON DCB@D64ADMZ 12236719
         BE    XLOD0135           .. SEARCH CHAIN (CICS I/F)   @D64ADMZ 12236819
         LA    R2,IALCLEN-1(,R1)  END ADDRESS FOR DCB                   12277600
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           12318800
         BAL   R9,XLDVALID        VALIDATE DCB                          12360000
*                                 CONTINUE IF O.K.                      12401200
XLOD0135 DS    0H                                              @D64ADMZ 12401319
         OI    DFWKSWRQ,DCBSRCH   SET DCB-SEARCH FLAG                   12442400
XLOD0140 DS    0H                                                       12483600
*        AMODESW  SET,AMODE=31,WR=(R3)  GET AMODE 31                    12524800
         AMODESW  SET,AMODE=31,WR=(R3)                                  12566000
         SPACE 1                                                        12607200
*---------------------------------------------------------------------* 12648400
*     COPY PARAMETERS INTO TCB.FCHWORK AND PROVIDE STATUS OF REQUEST  * 12689600
*---------------------------------------------------------------------* 12730800
XLOD0160 DS    0H                                                       12772000
*DEL     LM    R0,R1,DFCBSAV+OFSXR0 GET USER'S REGS                     12813200
         CLC   TID,ARTIDH         SYSTEM TASK                  @D66ODOW 12854459
         BNL   XLOD0200           NO,  ---------->                      12895600
         OI    DFWKSWRQ,SYSAMASK+AUTHREQ   SYSTEM TASK                  12936800
XLOD0200 DS    0H                                                       12978000
         MVI   DFWKRQFM,MVSCDLD   REQUEST: MVS-LOAD                     13019200
*                                 ... MIGHT BE CHANGED LATER            13060400
         L     R0,CRADDR          ADDR OF CURRENT COMREG                13101600
         ST    R0,DFWKCOMG        ....                                  13142800
         L     R2,DFWKPHNM        ADDR OF DE/PHASENAME                  13184000
         TM    0(R2),XFF          PHASE NAME STARTS WITH X'FF'          13225200
         BO    XLD80604           YES, ==========>                      13266400
*                                 ... PHASE NOT FOUND                   13307600
         MVC   DFWKNAME(L'DFWKNAME),0(R2) COPY PHASENAME                13348800
         TM    DFWKOPT1,DFWKDESP  DE SPECIFIED (BLDLE FORMAT)           13390000
         BZ    XLOD0300           NO,  ---------->                      13431200
XLOD0210 DS    0H                                                       13472400
*     SOME MORE VERIFICATIONS OF PROVIDED DE                            13513600
         LA    R2,BLDLEMVS(,R2)   SKIP BLDLE MVS SIMULATION AND        *13554800
                                  ... ADJUST ON SDLE PART               13596000
         USING INLCSDLE,R2        SET BASE FOR SDLE                     13637200
         CLI   SDLEDEF1,X00       ATTR FIELD INITIALIZED                13678400
         BNE   XLOD0220           NO,  ---------->                      13719600
         CLI   SDLEFLG,X00        FLAGS INITIALIZED                     13760800
         BE    XLOD0250           OK,  ---------->                      13802000
         B     XLD206CC           ==========>      INV DE               13843200
XLOD0220 DS    0H                                                       13884400
         TM    SDLEDEF1,SDLEEDIR  ATTR FIELD INDICATES DIR              13925600
         BNO   XLD206CC           NO,  ==========> INV DE               13966800
         TM    SDLEFLG,SDLEBAC    DE ACTIVE                             14008000
         BNO   XLD206CC           NO,  ==========> INV DE               14049200
XLOD0250 DS    0H                                                       14090400
         MVC   DFWKEGEN(SDLELEN-L'DFWKNAME),DFWKEGEN-DFWKNAME(R2)       14131600
         DROP  R2                                                       14172800
XLOD0300 DS    0H                                                       14214000
         TM    DFWKOPT1,DFWKERET  ERROR RETURN ADDRESS SPECIF           14255200
         BZ    XLOD0320           NO,  ---------->                      14296400
         OI    DFWKSWRQ,GIVRETRC  INDICATE RETURN TO REQUESTOR          14337600
         SPACE 1                                                        14378800
*---------------------------------------------------------------------* 14420000
*     VALIDATION OF AUTHORITY                                         * 14461200
*---------------------------------------------------------------------* 14502400
XLOD0320 DS    0H                                                       14543600
*     CHECK AUTHORIZATION OF REQUESTOR                                  14584800
*        TESTAUTH                                                       14626000
         BAL   R9,XCHKAUT         CHECK AUTHORITY              @TEMPORA 14632800
*SGLINK XCHKAUT,INPUT=(R9,RA,RB,RE),WORK=(R5)                           14639600
         B     XLOD0400           AUTHORIZED PGM                        14646400
*        B     XLOD0350           UNAUTHERIZED PGM                      14653200
XLOD0350 DS    0H                                                       14660000
*     UNAUTHORIZED REQUESTOR MUST NOT SPECIFY GLOBAL/ADDR               14667200
         TM    DFWKOPT1,DFWKGLBY  GLOBAL SPECIFIED                      15038000
         BO    XLD20608           YES, ==========> GLB NO-AUTH          15079200
         TM    DFWKOPT1,DFWKADDR  ADDR SPECIFIED                        15120400
         BO    XLD2060C           YES, ==========> ADDR NO-AUTH         15161600
         TM    DFWKOPT2,DFWKNAPF  ADRNAPF SPECIFIED                     15175300
         BO    XLD2060C           YES, ==========> ADRNAPF NO-AUTH      15189000
*---------------------------------------------------------------------* 15202800
*     VALIDATION OF CONSISTENCY OF PARAMETERS                         * 15244000
*---------------------------------------------------------------------* 15285200
XLOD0400 DS    0H                                                       15326400
*        GENSERV DEBUG,FIELD=FCHENTRY                                   15367600
         GENSERV DEBUG,FIELD=FCHENTRY                                   15408800
*     OPT0 AND FORMAT MUST BE X'0'                                      15450000
         CLI   DFWKOPT0,X00       OPT0 HEX ZERO                         15491200
         BNE   XLD20620           NO,  ==========> INV MAC LEV          15532400
         CLI   DFWKPLFM,X00       FORMAT HEX ZERO                       15573600
         BNE   XLD20620           NO,  ==========> INV MAC LEV          15614800
*     OEM PARAMETER NOT SPECIFIED                                       15656000
         TM    DFWKOPT1,FCHPOEM   OEM SPECIFIED                         15697200
         BO    XLD20604           YES, ==========> UNSUPPORTED          15738400
         TM    DFWKOPT2,DFWKNAPF  ADRNAPF SPECIFIED                     15779600
         BO    XLOD0440           YES, ---------->                      15820800
         TM    DFWKOPT1,DFWKADDR  ADDR SPECIFIED                        15862000
         BZ    XLOD0450           NO   ---------->                      15912016
*     ADDR/ADRNAPF REQUIRES LOADPOINT ON D-BOUNDARY                     16397600
XLOD0440 DS    0H                                                       16438800
         L     R0,DFWKALDP                                              16480000
         LTR   R0,R0              LOADPOINT SPECIFIED                   16521200
         BZ    XLD20604           NO,  ==========> INCONSISTENT         16562400
         TM    DFWKALDP+3,X03     LOADPOINT ON D-BOUNDARY               16603600
         BNZ   XLD20618           NO,  ==========> NO D-BOUNDRY         16644800
*     GLOBAL AND ADDR/ADRNAPF ARE INCONSISTENT                          16686000
         TM    DFWKOPT1,DFWKGLBY  GLOBAL SPECIFIED                      16727200
         BO    XLD20604           YES, ==========> INCONSISTENT         16768400
*     LOADPT AND ADDR/ADRNAPF ARE INCONSISTENT                          16809600
         TM    DFWKOPT1,DFWKLDRX  RETURN OF LOADPOINT SPECIFIED         16850800
         BO    XLD20604           YES, ==========> INCONSISTENT         16892000
*     ADDR/ADRNAPF WITHOUT DCB PARAMETER                                16933200
         TM    DFWKSWRQ,DCBSRCH   DCB PARAMETER SPECIFIED               16974400
         BO    XLOD0700           YES, ----------> OK -                 17015600
*                                 .... PROCESS EXPLICIT LOAD            17056800
         B     XLD20604           NO , ==========> INCONSISTENT         17098000
         DROP  RB                 RESET BASE FOR USER'S SA              17139200
         SPACE 2                                                        17180400
*---------------------------------------------------------------------* 17221600
*                                                                     * 17262800
*     PROCESS LOAD WITH IMPLICIT GETMAIN                              * 17304000
*                                                                     * 17345200
*---------------------------------------------------------------------* 17386400
XLOD0450 DS    0H                                                       17427600
         TM    DFWKOPT1,DFWKGLBY  GLOBAL SPECIFIED                      17468800
         BZ    XLOD0460           NO, ----------->                      17510000
         MVI   DFWKRQFM,MVSCSALD  REQUEST: MVS-LOAD-CSA                 17551200
         SPACE 2                                                        17592400
XLOD0460 DS    0H                                                       17633600
*SGLINK XLDFIATE,INPUT=(R9,RA,RD),WORK=(R0,R2,R3,R4,R8,RC),            *17674800
               OUTPUT=(R5,RF)                                           17716000
         BAL   R9,XLDFIATE        SEARCH TCB-LLE CHAIN                  17757200
*                                 ...    ATE CHAIN                      17798400
*    PROVIDE DFWKLPNT, DFWKEPNT, DFWKEPLN                               17839600
         LTR   RF,RF              PHASE ALREADY AVAILABLE               17880800
         BZ    XLOD0600           YES,  ---------->                     17922000
*---------------------------------------------------------------------* 17963200
*    SCAN DIRECTORIES                                                 * 18004400
*---------------------------------------------------------------------* 18045600
         LA    R0,DFWKNAME        POINT TO DIR ENTRY                    18086800
         ST    R0,DFWKPHPT        STORE POINTER TO DIR ENTRY            18128000
         ST    R0,DFWKANAM        ...                                   18169200
         L     R6,DISPAD          GET DISPATCHER BASE                   18210400
         TM    DFWKOPT1,DFWKDESP  DE SPECIFIED                          18251600
         BZ    XLOD0480           NO,  ---------->                      18292800
         TM    DFWKESWT,SDLEBAC   ENTRY ACTIVE                          18334000
         BZ    XLOD0480           NO,  ---------->                      18375200
         TM    DFWKESWT,SDLEBNF   ENTRY FOUND                           18416400
         BZ    XLOD0500           YES, ---------->                      18457600
XLOD0480 DS    0H                                                       18498800
         MVI   DFWKFLAG,DENTRY+NTXTNTRY+SDLFORM+FLRETCOD                18540000
*                                 DE=YES TXT=NO AND SDL-FORMAT          18581200
         MVI   DFWKESWT,X00       CLEAR DIRECTORY ENTRY STATUS          18622400
         L     RE,CDBASE          BASE OF CDLOAD                        18663600
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              18704800
*SGLINK CDLFTCH,INPUT=(R0,R6,R8,RA,RE),WORK=(R1,R3,R4,R5,R7,R9,RB,RF)   18746000
         BAL   R8,CDLFTCH         EXECUTE FETCH CALL SEQUENCE           18787200
         L     RE,AMVSXLOD        BASE OF ROUTINE                       18828400
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             18869600
         LA    R0,DIRSTID(,0)                                           18910800
*     CHECK FOR ABEND CONDITION                                         18952000
*SGLINK XLDXRETC,INPUT=(R0,R9,RA,RE),WORK=(R4),OUTPUT=(RF)              18993200
         BAL   R9,XLDXRETC        TEST ON ERROR CONDITIONS              19034400
*                                 RETURN ONLY IF OK                     19075600
         OI    DFWKSWRQ,MORESRCH  INDICATE: CONTINUE SEARCH             19116800
.*DEL    TM    DFWKESWT,SDLEBSV+SDLEBPC SVA PHASE NOT FROM SYSLIB       19158000
.*DEL    BO    XLOD0480           NO, -----------> MORE SCAN,           19199200
.*DEL                       ... DO NOT CONSIDER PHASES IN SVA           19240400
.*DEL                       ... AND NOT IN SYSLIB                       19281600
.*                          -----> RESTRICTION DELETED 95-11-28         19322800
XLOD0500 DS    0H                                                       19364000
         TM    DFWKSWRQ,AUTHREQ   AUTHORIZED REQUEST                    19405200
         BNO   XLOD0520           NO,  ---------->                      19446400
         L     R2,DFWKALIB        ADDR OF LIB DEF TABLE                 19487600
         USING INLCLDTE,R2        SET BASE FOR LIB DEF TAB              19487734
         TM    LDTEINFO,LDTEPROT  APF PROTECTED LIBRARY ?????           19487834
         NOP   XLD3060C           NO,  ==========> 306-0C      @TEMPORA 19487934
         CLI   DFWKRQFM,MVSCSALD  CSA LOAD (GLOBAL REQUEST)             19652400
         BNE   XLOD0520           NO,  ---------->                      19679800
         TM    DFWKESWT,SDLEBSE+SDLESVPF PHASE SVA ELIGIBLE             19734800
         BZ    XLD30608           NO,  ==========> 306-08               19776000
         AGO   .XLD0510                                        @D....VB 19796600
         B     XLOD0520                ---------->                      19817200
XLOD0510 DS    0H                                                       19858400
         TM    DFWKSWRQ,PLLEFND   NONE SVA ELIGIBLE PHASE FOUND         19899600
         BZ    XLOD0520           NO,  ----------> TAKE THISONE         19940800
         TM    DFWKESWT,SDLEBSE+SDLESVPF PHASE SVA ELIGIBLE             19982000
         BZ    XLOD0480           NO,  ----------> MORE SCAN            20023200
.XLD0510 ANOP                                                  @D....VB 20043800
         DROP  R2                 RESET BASE FOR LIB-DEF-TAB            20064400
*---------------------------------------------------------------------* 20105600
*    PROVIDE ATE                                                      * 20146800
*---------------------------------------------------------------------* 20188000
XLOD0520 DS    0H                                                       20229200
         L     RE,CDBASE          BASE OF CDLOAD                        20270400
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              20311600
         BAL   R8,CDLFNATE        SCAN FOR FREE ATE                     20352800
*SGLINK CLFNATE,INPUT=(R8,RA,RE),WORK=(R0,R1,R3,R4),OUTPUT=(R5,RC,RF)   20394000
         L     RE,AMVSXLOD        BASE OF ROUTINE                       20435200
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             20476400
         LTR   RF,RF              FREE ENTRY FOUND                      20517600
         BNZ   XLD106C1           NO,  ---------->  106-0C              20558800
         USING ATENTRY,R5                                               20563300
         TM    DFWKESWT,SDLEBSV   SVA PHASE                             20567800
         BZ    XLOD0525           NO,  ---------->                      20572300
         MVI   ATSUBPOL,228       TAKE SUBPOOL 228 (FIXED)              20576800
         TM    DFWKESWT,SDLESVPF  SVA PHASE IS FIXED                    20581300
         BO    XLOD0565           FIXED, ----------->                   20585800
         MVI   ATSUBPOL,241       TAKE SUBPOOL 241 (CSA)                20590300
         B     XLOD0565           ----------->                          20594800
*---------------------------------------------------------------------* 20600000
*    GETMAIN STORAGE                                                  * 20641200
*---------------------------------------------------------------------* 20682400
XLOD0525 DS    0H                                                       20723600
         CLI   DFWKRQFM,MVSCDLD   MVS LOAD IN SPACE/PARTITION           20764800
         BNE   XLOD0530           NO, ---------->                       20806000
         MVI   ATSUBPOL,252       TAKE SUBPOOL 252                      20847200
         TM    DFWKESWT,SDLEBSE+SDLESVPF SVA ELIGIBLE + LIB PROTECTED   20897200
         BNZ   XLOD0540           YES, --------->                       20947200
         MVI   ATSUBPOL,251       TAKE SUBPOOL 251                      21053200
         B     XLOD0540                                                 21103200
XLOD0530 DS    0H                 MVS LOAD IN CSA                       21153200
         MVI   ATSUBPOL,228       TAKE SUBPOOL 228                      21218000
         TM    DFWKOPT1,DFWKGLBY+DFWKGLBF GLOBAL FIXED REQUEST          21300400
         BO    XLOD0540           YES, --------->                       21341600
         MVI   ATSUBPOL,241       TAKE SUBPOOL 241                      21382800
XLOD0540 DS    0H                                                       21432800
         L     RD,TCBSAVE                                               21482800
         USING SVEARA,RD                                                21482935
         STM   R9,RE,DFCBSAV+OFS9                                       21547600
         L     RC,TCBATCBE        GET ADDR TCBX                         21594200
         TM    TCBXSAUS-TCBXADR(RC),TCBXXSBU SAVE AREA FREE    @D64ADMZ 21594419
         BZ    XLOD0545          YES                           @D64ADMZ 21594519
         ST    R5,SGXREG5        SAVE R5                       @D64ADMZ 21594619
         BAL   R5,SYSERROR       NO, MUST NOT OCCUR            @D64ADMZ 21594719
XLOD0545 DS    0H                                                       21594803
         OI    TCBXSAUS-TCBXADR(RC),TCBXXSBU SAVE AREA IN USE  @D64ADMZ 21594919
         LA    RC,TCBXXSB-TCBXADR(,RC)                         @D64ADMZ 21640835
         MVC   0(12,RC),SVER0F    DESTROYED BY GETMAIN         @D64ADMZ 21640935
         MVC   12(4,RC),SVEPSW    SAVE FIRST PART OF PSW       @D64ADMZ 21641048
         NI    SVEPSWKY,X'FE'     DO GETMAIN IN SUP. STATE     @D64ADMZ 21642050
         SLR   R6,R6                                                    21780600
         ST    R6,SVER0F          CLEAR OPTION REGISTER                 21827200
         ST    R6,SVER01                                                21873800
         TM    DFWKEMVS,SDLERMOD  DOES PHASE HAS RMODE ANY              21920400
         BZ    XLOD0550           NO, RMODE 24                          21967000
         OI    SVER0F+D3,X'60'    YES, STORAGE CAN BE ANYWHERE          22013600
XLOD0550 DS    0H                                                       22060200
         OI    SVER0F+D3,X'10'    STORAGE MUST BE LOCATED BELOW         22106800
         MVC   SVER0F+D2(1),ATSUBPOL PROVIDE SUBPOOL ID                 22153400
         DROP  R5                                                       22200000
         L     R0,DFWKEPLN        LENGTH OF PHASE FOR STORAGE           22246600
         ST    R0,SVER00          SAVE LENGTH PARAMETER                 22293200
         L     R6,XLODSTOR        STORAGE ROUTINE                       22339800
*SGLINK GMFMSVC78,INPUT=(R6,RA),NOMODR=(R6,RA),                        *22386405
               WORK=(R0-R5,R7-R9,RB-RF),OUTPUT=()                       22386505
*        AMODESW CALL,REGS=(R6,R6) CALL STORAGE                         22433000
         AMODESW CALL,REGS=(R6,R6) CALL STORAGE                         22479600
XLODGM_RET DS  0H                 LABEL USED BY GETMAIN        @D64ADMZ 22479737
         L     RC,TCBATCBE        GET TCB EXTENSION                     22479805
         L     RD,TCBSAVE                                      @D64ADMZ 22479935
         NI    TCBXSAUS-TCBXADR(RC),XFF-TCBXXSBU  SAVE AREA FREE        22480035
         LA    RC,TCBXXSB-TCBXADR(RC)                          @D64ADMZ 22490035
         L     R0,SVER01          ADDRESS OF GETMAINED AREA             22526200
         L     RF,SVER0F          GET RETURN CODE                       22526305
         MVC   SVER0F(12),0(RC)   RESTORE ORIGINAL CONTENTS    @D64ADMZ 22526436
         MVC   SVEPSW(4),12(RC)   RESTORE FIRST PART OF PSW    @D64ADMZ 22526548
         LM    R9,RE,DFCBSAV+OFS9                                       22572800
         DROP  RD                 RESET BASE FOR USER'S SA              22619400
         L     R6,DISPAD          DISPATCHER ADDRESS                    22712600
         MVI   RID+1,REENTRID     RESET RID                             22759200
         LTR   RF,RF              TEST RETURN CODE OF GETVIS            22805805
         BZ    XLOD0560           OK                           @D64ADMZ 22852437
         LA    R8,SMERR0C         GETVIS ...                   @D64ADMZ 22852538
         CR    RF,R8              .. EXHAUSTED                 @D64ADMZ 22852638
         BE    XLD106C2           YES                          @D64ADMZ 22852738
         LA    R8,SMERR20         PFIX  ....                   @D64ADMZ 22852838
         CR    RF,R8              .. NOT POSSIBLE              @D64ADMZ 22852938
         BE    XLD106C3           YES                          @D64ADMZ 22853038
         B     XLD2C5201          INSUFF. AUTHORITY            @D64ADMZ 22853439
         SPACE 1                                                        22899000
*---------------------------------------------------------------------* 22948400
*    READ PHASE                                                       * 22989600
*---------------------------------------------------------------------* 23030800
XLOD0560 DS    0H                                                       23080800
         NI    DFWKESWT,XFF-SVAPHASE SVA COPY NOT CONSIDERED            23278000
         MVI   DFWKFLAG,DENTRY+SDLFORM+FLRETCOD                         23319200
.*                                SDLE HAS BEEN PROVIDED                23360400
         L     RE,CDBASE          BASE OF CDLOAD                        23401600
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              23442800
*SGLINK CDLFTCH,INPUT=(R0,R6,R8,RA,RE),WORK=(R1,R3,R4,R5,R7,R9,RB,RF)   23484000
         BAL   R8,CDLFTCH         EXECUTE FETCH CALL SEQUENCE           23525200
         L     RE,AMVSXLOD        BASE OF ROUTINE                       23566400
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             23607600
         LA    R0,PGMFTID(,0)                                           23648800
*     CHECK FOR ABEND CONDITION                                         23690000
*SGLINK XLDXRETC,INPUT=(R0,R9,RA,RE),WORK=(R4),OUTPUT=(RF)              23731200
         BAL   R9,XLDXRETC        TEST ON ERROR CONDITIONS              23772400
*                                 RETURN ONLY IF OK                     23813600
*---------------------------------------------------------------------* 23854800
*    BUILD  ATE                                                       * 23896000
*---------------------------------------------------------------------* 23937200
XLOD0565 DS    0H                                                       23957800
         L     RE,CDBASE          BASE OF CDLOAD                        23978400
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              24019600
*SGLINK CDLDATE,INPUT=(R8,RA,RE),WORK=(R0,R1,R3,RC,RF),OUTPUT=(R5)      24060800
         BAL   R8,CDLDATE         BUILD ATE                             24102000
         L     RE,AMVSXLOD        BASE OF ROUTINE                       24143200
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             24184400
         USING ATENTRY,R5         SET BASE FOR ATE                      24225600
         L     R2,DFWKALIB        ADDR OF LIB DEF TABLE                 24266800
         USING INLCLDTE,R2        SET BASE FOR LIB DEF TAB              24308000
         TM    LDTEINFO,LDTEPROT  APF PROTECTED LIBRARY ?????           24349200
         NOP   XLOD0570           NO,  ---------->             @TEMPORA 24390400
         DROP  R2                 RELEASE INLCLDTE                      24390534
         OI    ATPHFLAG,ATAPFMB   INDICATE APF MEMBER                   24431600
XLOD0570 DS    0H                                                       24439800
         TM    DFWKSWRQ,AUTHREQ   AUTHORIZED REQUEST                    24448000
         BZ    XLOD0580           NO,  ---------->                      24456200
         OI    ATPHFLAG,ATAUTHX   LOADED BY AUTHORIZED REQUEST          24464400
XLOD0580 DS    0H                                                       24489200
         CLI   DFWKRQFM,MVSCSALD  CSA LOAD                              24514000
         BNE   XLOD0600           NO,  ---------->                      24555200
         OI    ATPHFLG2,ATPHACSA  INDICATE CSA PHASE                    24596400
         DROP  R5                 RESET BASE FOR ATE                    24637600
         SPACE 1                                                        24678800
*---------------------------------------------------------------------* 24720000
*     UPDATE LLE                                                      * 24761200
*---------------------------------------------------------------------* 24802400
XLOD0600 DS    0H                                                       24843600
*SGLINK XLDUPLLE,INPUT=(R9,RA,RE),WORK=(R0-R5,R8,RB,RC,RF),OUTPUT=()    24884800
         BAL   R9,XLDUPLLE        INCREASE LLE USE COUNTER              24926000
         SPACE 1                                                        24967200
*---------------------------------------------------------------------* 25008400
*     PROVIDE AMODE, ENTRY POINT AND LOAD POINT                       * 25049600
*---------------------------------------------------------------------* 25090800
         L     R4,DFWKALLE        CURRENT PLLE                          25132000
         USING PLLENTRY,R4        SET BASE FOR LLE                      25173200
         L     R4,PLLEATE         RELATED ATE                           25214400
         USING ATENTRY,R4         SET BASE FOR ATE                      25255600
         L     R0,ATENTP          GET ENTRY POINT RY POINT              25296800
.* IF AMODE 31 IS SPECIFIED, SET BIT 0 IN SVER00 (EP)                   25338000
.* IF AMODE 24 IS SPECIFIED, DO NET SET BIT 0 IN SVER00                 25379200
.* IF AMODE ANY IS SPECIFIED, SET BIT 0 DEP. ON CALLER'S AMODE          25420400
         TM    ATPHATT,SDLEAM31   DOES PHASE HAS AMODE 31               25461600
         BZ    XLOD0640           NO,  -------->                        25502800
         TM    ATPHATT,SDLEAM24   DOES PHASE HAS AMODE ANY              25544000
         BZ    XLOD0620           NO,PHASE HAS AMODE 31                 25585200
         TM    TCBEXFLG,TCBEXAM   AMODE=ANY,CALLER IN AMODE 31?         25626400
         BZ    XLOD0640           NO,  -------->                        25667600
XLOD0620 DS    0H                                                       25708800
         O     R0,BIT0OMSK        SET BIT 0=1, INDIC. AMODE=31          25750000
XLOD0640 DS    0H                                                       25791200
         L     R1,ATPHSLEN        LENGTH OF PHASE                       25832400
         SRL   R1,3               ... IN D-WORDS                        25873600
         TM    ATPHFLAG,ATAPFMB   APF PROTECTED LIBRARY                 25914800
         DROP  R4                 RESET BASE FOR ATE                    25956000
         BZ    XLOD0920           NO,  ---------->                      25997200
         B     XLOD0900           YES, ---------->                      26038400
         EJECT                                                          26079600
*---------------------------------------------------------------------* 26120800
*                                                                     * 26162000
*     PROCESS LOAD WITH ADDR /ADRNAPF PARAMETER                       * 26203200
*                                                                     * 26244400
*---------------------------------------------------------------------* 26285600
         SPACE 2                                                        26326800
*---------------------------------------------------------------------* 26368000
*    SCAN DIRECTORIES                                                 * 26409200
*---------------------------------------------------------------------* 26450400
XLOD0700 DS    0H                                                       26491600
         MVI   DFWKRQFM,MVSLOAD   REQUEST: MVS-LOAD-ADDR                26532800
         LA    R0,DFWKNAME        POINT TO DIR ENTRY                    26574000
         ST    R0,DFWKPHPT        STORE POINTER TO DIR ENTRY            26615200
         ST    R0,DFWKANAM        ...                                   26656400
         L     R6,DISPAD          GET DISPATCHER BASE                   26697600
         TM    DFWKOPT1,DFWKDESP  DE SPECIFIED                          26738800
         BZ    XLOD0720           NO,  ---------->                      26780000
         TM    DFWKESWT,SDLEBAC   ENTRY ACTIVE                          26821200
         BZ    XLOD0720           NO,  ---------->                      26862400
         TM    DFWKESWT,SDLEBNF   ENTRY FOUND                           26903600
         BZ    XLOD0750           YES, ---------->                      26944800
XLOD0720 DS    0H                                                       26986000
         MVI   DFWKFLAG,DENTRY+NTXTNTRY+SDLFORM+FLRETCOD                27027200
*                                        TXT=NO AND SDL-FORMAT          27068400
         MVI   DFWKESWT,X00       CLEAR DIRECTORY ENTRY STATUS          27109600
         L     RE,CDBASE          BASE OF CDLOAD                        27150800
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              27192000
*SGLINK CDLFTCH,INPUT=(R0,R6,R8,RA,RE),WORK=(R1,R3,R4,R5,R7,R9,RB,RF)   27233200
         BAL   R8,CDLFTCH         EXECUTE FETCH CALL SEQUENCE           27274400
         L     RE,AMVSXLOD        BASE OF ROUTINE                       27315600
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             27356800
         LA    R0,DIRSTID(,0)     USED TO GET CORR. BRANCHTABLE@D64ADMZ 27398019
*     CHECK FOR ABEND CONDITION                                         27439200
*SGLINK XLDXRETC,INPUT=(R0,R9,RA,RE),WORK=(R4),OUTPUT=(RF)              27480400
         BAL   R9,XLDXRETC        TEST ON ERROR CONDITIONS              27521600
*                                 RETURN ONLY IF OK                     27562800
*---------------------------------------------------------------------* 27604000
*     CHECK FOR CONSISTANCY                                           * 27645200
*---------------------------------------------------------------------* 27686400
XLOD0750 DS    0H                                                       27727600
         TM    DFWKOPT2,DFWKNAPF  AUTHORIZED LIBRARY REQUESTED          27768800
         BZ    XLOD0780           NO,  ---------->                      27810000
         L     R2,DFWKALIB        ADDR OF LIB DEF TABLE                 27851200
         USING INLCLDTE,R2        SET BASE FOR LIB DEF TAB              27892400
         TM    LDTEINFO,LDTEPROT  APF PROTECTED LIBRARY ?????           27933600
         NOP   XLD3060C           NO,  ==========> 306-0C      @TEMPORA 27974800
         DROP  R2                 RESET BASE FOR LIB-DEF-TAB            28016000
*---------------------------------------------------------------------* 28057200
*    VALIDATE LOADPOINT OF PHASE                                      * 28098421
*---------------------------------------------------------------------* 28139600
XLOD0780 DS    0H                                                       28180800
         LA    R0,XNODADR(,0)     INVALID ADDR/ADRNAPF VALUEE ...       28180921
*                                 .. 206 - 18                  @D64ADMZ 28181021
         L     R1,DFWKALDP        ADDRESS OF PROVIDED STORAGE  @D64ADMZ 28181121
         L     R2,DFWKEPLN        PHASE LENGTH                 @D64ADMZ 28181221
         AR    R2,R1                                           @D64ADMZ 28181321
         BCTR  R2,0               END ADDRESS OF PHASE         @D64ADMZ 28181421
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           28181521
         BAL   R9,XLDVALID        VALIDATE DCB                 @D64ADMZ 28181621
*---------------------------------------------------------------------* 28182021
*    GET PHASE                                                        * 28183021
*---------------------------------------------------------------------* 28184021
         L     R0,DFWKALDP        ADDRESS OF PROVIDED STORAGE           28222000
         L     R6,DISPAD          GET DISPATCHER BASE                   28263200
         NI    DFWKESWT,XFF-SVAPHASE SVA COPY NOT CONSIDERED            28304400
         MVI   DFWKFLAG,DENTRY+SDLFORM+FLRETCOD LOAD PHASE              28345600
.*                                SDLE HAS BEEN PROVIDED                28386800
         L     RE,CDBASE          BASE OF CDLOAD                        28428000
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              28469200
*SGLINK CDLFTCH,INPUT=(R0,R6,R8,RA,RE),WORK=(R1,R3,R4,R5,R7,R9,RB,RF)   28510400
         BAL   R8,CDLFTCH         EXECUTE FETCH CALL SEQUENCE           28551600
         L     RE,AMVSXLOD        BASE OF ROUTINE                       28592800
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             28634000
         LA    R0,PGMFTID(,0)                                           28675200
*     CHECK FOR ABEND CONDITION                                         28716400
*SGLINK XLDXRETC,INPUT=(R0,R9,RA,RE),WORK=(R4),OUTPUT=(RF)              28757600
         BAL   R9,XLDXRETC        TEST ON ERROR CONDITIONS              28798800
*                                 RETURN ONLY IF OK                     28840000
*---------------------------------------------------------------------* 28881200
*     PROVIDE AMODE, ENTRY POINT AND LOAD POINT                       * 28922400
*---------------------------------------------------------------------* 28963600
XLOD0800 DS    0H                                                       29004800
         L     R0,DFWKEPNT        AMODE 24 AND ENTRY POINT              29046000
.* IF AMODE 31 IS SPECIFIED, SET BIT 0 IN SVER00 (EP)                   29087200
.* IF AMODE 24 IS SPECIFIED, DO NET SET BIT 0 IN SVER00                 29128400
.* IF AMODE ANY IS SPECIFIED, SET BIT 0 DEP. ON CALLER'S AMODE          29169600
         TM    DFWKEMVS,SDLEAM31  DOES PHASE HAS AMODE 24               29210800
         BZ    XLOD0820           YES, ----------> ALL DONE             29252000
         TM    DFWKEMVS,SDLEAM24  DOES PHASE HAS AMODE ANY              29293200
         BZ    XLOD0810           NO,  ----------> SET AMODE 31         29334400
         TM    TCBEXFLG,TCBEXAM   CALLER IN AMODE 31                    29375600
         BZ    XLOD0820           NO,  ----------> ALL DONE             29416800
XLOD0810 DS    0H                                                       29458000
         O     R0,BIT0OMSK        SET AMODE 31                          29499200
XLOD0820 DS    0H                                                       29540400
         L     R1,DFWKEPLN        LENGTH OF PHASE                       29581600
         SRL   R1,3               ... IN D-WORDS                        29622800
         L     R2,DFWKALIB        ADDR OF LIB DEF TABLE                 29664000
         USING INLCLDTE,R2        SET BASE FOR LIB DEF TAB              29705200
         TM    LDTEINFO,LDTEPROT  APF PROTECTED LIBRARY ?????           29746400
         NOP   XLOD0920           NO,  ---------->             @TEMPORA 29787600
         DROP  R2                 RELEASE INLCLDTE                      29787734
         SPACE 2                                                        29828800
*---------------------------------------------------------------------* 29870000
*     EXIT CODE                                                       * 29911200
*---------------------------------------------------------------------* 29952400
         SPACE 1                                                        29993600
XLOD0900 DS    0H                                                       30034800
         O     R1,XLODAPFL        INDICATE APF LIBRARY                  30076000
XLOD0920 DS    0H                                                       30117200
         SLR   RF,RF                                                    30158400
         STM   RF,R1,DFCBSAV+OFSXRF   SAVE RETURN-CODE, ENTRY           30199600
*                                 ...POINT, LENGTH IN D                 30240800
         TM    DFWKOPT1,DFWKLDRX  LOAD POINT REQUESTED                  30282000
         BZ    XLODEXIT           NO,  ---------->                      30323200
         L     R4,DFWKALDP        ADDR WHERE LP TO BE RETURNED          30364400
         L     R2,DFWKLPNT        GET LOADPOINT                         30405600
         ST    R2,0(,R4)          ....   LOADPT ADDR                    30446800
         SPACE 1                                                        30488000
XLODEXIT DS    0H                                                       30529200
*        GENSERV DEBUG,FIELD=FCHEXIT                                    30570400
         GENSERV DEBUG,FIELD=FCHEXIT                                    30611600
         SPACE 1                                                        30652800
*---------------------------------------------------------------------* 30694000
*     OPEN CDLOAD GATE                                                * 30735200
*---------------------------------------------------------------------* 30776400
         L     R6,DISPAD          GET DISPATCHER BASE                   30817600
         L     RE,CDBASE          BASE OF CDLOAD                        30858800
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              30900000
         BAL   R8,CDLGOPEN        OPEN CDLOAD-GATE                      30941200
*SGLINK CDLGOPEN,INPUT=(R6,R8,RE),WORK=(R2,R5,RE,RF),OUTPUT=()          30982400
         L     RE,AMVSXLOD        BASE OF ROUTINE              @D64ADMZ 30982655
         USING MVSXLOAD,RE                                     @D64ADMZ 30982756
         USING DISP,R6                                                  31023600
         L     RD,DFWKRTUR        GET SA ADDRESS                        31064800
         LTR   RD,RD              BALR I/F                              31106000
         BZ    XLODEXYT           NO,  ---------->                      31147200
.*                                BASE REGISTER FROM CDLOAD             31188400
         LM    RF,R1,DFCBSAV+OFSXRF RC, EP, LENGTH IN D                 31229600
         L     RE,12(,RD)         LOAD USER REG'S                       31270800
         LM    R2,RC,28(RD)       LOAD USER REG'S                       31312000
*        AMODESW RETURN,REG=(R7)  ==========> EXIT BALR I/F             31353200
         AMODESW RETURN,REG=(R7)                                        31394400
XLODEXYT DS    0H                                                       31435600
         L     RB,TCBSAVE         ADDRESS OF SAVE AREA                  31476800
         USING SVEARA,RB          ADDRESSABILITY OF SA                  31518000
         LM    RF,R1,DFCBSAV+OFSXRF                                     31559200
         STM   RF,R1,SVER0F       RC, EP, LENGTH IN D TO USER           31600400
         LA    RF,DISPMVS                                               31641600
*        AMODESW RETURN,REG=(RF)  ==========> EXIT DISPATCHER           31682800
         AMODESW RETURN,REG=(RF)                                        31724000
*---------------------------------------------------------------------* 31765200
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             31806400
XLODAPFL DS    0F                                                       31847600
         DC    XL4'01000000'      MASK FOR PROTECTED LIBRARY            31888800
MVSLDFCT DC    A(9)               FUNCTION CODE MVS LOAD                31930000
XMACLOD  DC    CL8'LOAD'                                                31971227
AMVSBLDL DC    A(MVSXBLDL)        ADDR OF MVS BLDL SERVICE              31971327
         DROP  R6                 RESET ADDR TO DISPATCHER              32012400
         DROP  RA                 RESET ADDR TO TCB                     32053600
         DROP  RB                 RESET ADDR TO USER SA                 32094800
         EJECT                                                          34031200
*---------------------------------------------------------------------* 34072400
*  ROUTINE NAME: MVSDELT   VSE/ESA VERSION 2 RELEASE 2                  34113600
*  ROUTINE PROLOGUE                                                     34154800
*         VSE/ESA SERVICES FOR MVS PLATFORM: DELETE                     34196000
*                                                                       34237200
*  FUNCTION:                                                            34278400
*     -  SIMULATES MVS-DELETE                                           34319600
*                                                                       34360800
*  CALLED VIA:                                                          34402000
*     - DELETE MACRO EXPANSION (MVS SVC CODE X'09')                     34443200
*                                                                       34484400
*  AMODE = ANY                                                          34525600
*                                                                       34566800
*  MODE  = PRIMARY                                                      34608000
*                                                                       34649200
*  ENTRY POINT = MVSXDELT                                               34690400
*                                                                       34731600
*  LINKAGE:  VIA SVC INTERRUPT HANDLER                                  34772800
*                                                                       34814000
*  INPUT:  ENTRY  MVSXDELT:                                             34855200
*            R0  =   ADDRESS OF PHASE NAME                              34896400
*            R6  =   ADDRESS OF DISPATCHER                              34937600
*            RA  =   ADDRESS OF TCB                                     34978800
*            RB  =   ADDRESS OF USER'S SA                               35020000
*                                                                       35061200
*  OUTPUT:                                                              35102400
*            RF  =   RETURN CODE                                        35143600
*                    = 0: SUCCESSFUL COMPLETION                         35184800
*                    = 4: REQUEST NOT SATISFIED                         35226000
*                         PHASE NOT IN STORAGE OR DELETE                35267200
*                         GIVEN FOR CSA PHASE BY UNAUTHORIZED           35308400
*                         REQUESTOR                                     35349600
*                                                                       35390800
*  EXIT: RETURN TO DISPMVS                                              35432000
*                                                                       35473200
*  ERROR EXIT: -                                                        35514400
*                                                                       35555600
*  CHANGE ACTIVITIES:                                                   35596800
*     NEW FOR VSE/ESA 2.2.0                                             35638000
*                                                                       35679200
* A000000-999999                                                        35720400
*                                                                       35761600
*---------------------------------------------------------------------* 35802800
*                                                                       35844000
*  INTERNAL SUBROUTINES USED:                                           35885200
*        CDLGCLOS   -   OCCUPY CDLOAD GATE                              35926400
*        CDLGOPEN   -   FREE CDLOAD GATE                                35967600
*        XLDFIATE   -   SEARCH LLE                                      36008800
*        XLDVALID   -   VALIDATE PARAMETER                              36050000
*        XLDDELLE   -   UPDATE USE COUNTERS, FREE AREAS                 36091200
*---------------------------------------------------------------------* 36132400
         SPACE 2                                                        36173600
         USING TCBADR,RA          ADDRESSIBILITY OF TCB                 36214800
         SPACE 1                                                        36256000
         DS    0D                 SERVICE ENTRE                         36297200
         DC    CL8'MVSDELET'      EYECATCHER                            36338400
         DC    CL8'11/07/96'                                            36379606
         SPACE 1                                                        36420800
MVSDELX  DS    0H                 ENTRY POINT BALR I/F                  36462000
*SGLINK MVSDELX,INPUT=(R0,R6,RA),WORK=(),OUTPUT=(RF)                    36503200
         SLR   RF,RF                                                    36544400
         STM   RE,RC,12(RD)                                             36585600
         L     RE,AMVSXLOD        BASE OF MVSXLOAD                      36626800
         USING MVSXLOAD,RE        ESTABLISH ADDR TO MVSXLOAD            36668000
         L     RB,TCBSAVE         GET TASK'S SA ADDRESS                 36709200
         B     XDEL0000                                                 36750400
MVSXDELT DS    0H                 ENTRY POINT SVC I/F                   36791600
*SGLINK MVSXDELT,INPUT=(R0,R6,RA,RB),WORK=(R0-RE),OUTPUT=(RF)           36832800
         SLR   RD,RD                                                    36874000
XDEL0000 DS    0H                                                       36915200
         ST    RD,DFWKRTUR                                              36956400
         LR    R1,R0              ADDR OF PHASENAME                     36997600
         STM   RE,R1,DFCBSAV+OFSXRE SAVE USER'S REGS                    37038800
*---------------------------------------------------------------------* 37080000
*     GET CDLOAD GATE                                                 * 37121200
*---------------------------------------------------------------------* 37162400
         L     RE,CDBASE          BASE OF CDLOAD                        37203600
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              37244800
         BAL   R8,CDLGCLOS        GATE CDLOAD                           37286000
*SGLINK CDLGCLOS,INPUT=(R6,R8,RE),WORK=(R2,R5),OUTPUT=()                37327200
         L     RE,AMVSXLOD        BASE OF MVSXLOAD                      37368400
         USING MVSXLOAD,RE        ESTABLISH ADDR TO MVSXLOAD            37409600
*---------------------------------------------------------------------* 37450800
*     VALIDATION OF PROVIDED AREAS                                    * 37492000
*---------------------------------------------------------------------* 37533200
         LA    R0,XMACDEL         PROVIDE ....                          37574400
         ST    R0,DFCBMACN        ....    CURRENT MACRO NAME            37615600
         LTR   RD,RD              BALR I/F                              37656800
         BNZ   XDEL0110           YES, --------->                       37698000
         SLR   R0,R0              SET 24-BIT MODE                       37739200
         TM    TCBEXFLG,TCBEXAM   REQUESTOR IN 31-BIT MODE              37780400
         BZ    XDEL0100           NO, ---------->                       37821600
         O     R0,BIT0OMSK        SET 31-BIT MODE                       37862800
XDEL0100 DS    0H                                                       37904000
*        AMODESW SET,AMODE=(R0),WR=(RF) GET MODE OF REQUESTOR           37945200
         AMODESW SET,AMODE=(R0),WR=(RF) GET MODE OF REQUESTOR           37986400
XDEL0110 DS    0H                                                       38027600
         LA    R1,0(,R1)          CLEAR HIGH ORDERED BIT/BYTE           38068800
         ST    R1,DFCBSAV+OFSXR0  SAVE ADDR TO EP/EPLOC/DE              38110000
*     VALIDATION OF PARAMETER LIST                                      38151200
         LA    R0,XKEYPAR(,0)     KEY VIOLAT PARM  206-C0               38192400
*     VALIDATION OF DE/EP/EPLOC PARAMETER                               38233600
*                                 R1 IS LOW ADDRESS                     38274800
         LA    R2,L'DFWKNAME-1(,R1) END ADDRESS FOR EP/EPLOC            38316000
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           38357200
         BAL   R9,XLDVALID        VALIDATE DE/EP/EPLOC                  38398400
*                                 CONTINUE IF O.K.                      38439600
         L     R0,TCBALLST                                              38480800
         LTR   R0,R0              ANY ACTIVE MVS-LOAD AT ALL            38522000
         BZ    XDELRC04           NO,  ---------->                      38563200
*        AMODESW  SET,AMODE=31,WR=(R3)  GET AMODE 31                    38604400
         AMODESW  SET,AMODE=31,WR=(R3)                                  38645600
         SPACE 1                                                        38686800
*---------------------------------------------------------------------* 38728000
*     COPY PARAMETERS INTO TCB.FCHWORK AND PROVIDE STATUS OF REQUEST  * 38769200
*---------------------------------------------------------------------* 38810400
         XC    DFWKUSEN(DFWKX1LN),DFWKUSEN  CLEAR REQ. STATUS           38851600
         XC    DFWKNAME(SDLELEN-1),DFWKNAME                             38892800
         XC    DFWKADCB(FCHPLLEN+1-4),DFWKADCB  CLEAR PARMLIST          38934000
         MVI   DFWKRQFM,MVSDELT   REQUEST: MVS-DELETE                   38975200
         SPACE 1                                                        39016400
*---------------------------------------------------------------------* 39057600
*     VALIDATION OF AUTHORITY                                         * 39098800
*---------------------------------------------------------------------* 39140000
         USING SVEARA,RB          ESTABLISH ADDR TO USER'S SA           39181200
*     CHECK AUTHORIZATION OF REQUESTOR                                  39222400
*        TESTAUTH                                                       39263600
         BAL   R9,XCHKAUT         CHECK AUTHORITY              @TEMPORA 39313600
*SGLINK XCHKAUT,S,INPUT=(R9,RA,RB,RE),WORK=(R5)                @TEMPORA 39363600
         NOP   XDEL0130           AUTHORIZED PGM               @TEMPORA 39413600
*        B     XDEL0130           NON AUTHOIZED PROGRAM        @TEMPORA 39463600
         DROP  RB                 RESET BASE TO USER'S SA               39593200
XDEL0130 DS    0H                                                       39634400
         CLC   TID,ARTIDH         SYSTEM TASK                  @D66ODOW 39675659
         BNL   XDEL0140           NO,  ---------->                      39716800
         OI    DFWKSWRQ,SYSAMASK+AUTHREQ   SYSTEM TASK                  39758000
         SPACE 1                                                        39799200
XDEL0140 DS    0H                                                       39840400
         CLI   0(R1),XFF          PHASE NAME STARTS WITH X'FF'          39881600
         BE    XDELRC04           YES, ---------->   NOT FOUND          39922800
         CLI   0(R1),X00          PHASE NAME STARTS WITH X'00'          39964000
         BE    XDELRC04           YES, ---------->   NOT FOUND          40005200
         L     R0,CRADDR          ADDR OF CURRENT COMREG                40046400
         ST    R0,DFWKCOMG        ....                                  40087600
         ST    R1,DFWKPHNM        BUILD PARMLIST                        40128800
         MVC   DFWKNAME(L'DFWKNAME),0(R1) COPY PHASENAME                40170000
*---------------------------------------------------------------------* 40211200
*     SEARCH PHASE ON LLE CHAIN                                       * 40252400
*---------------------------------------------------------------------* 40293600
XDEL0150 DS    0H                                                       40334800
*        GENSERV DEBUG,FIELD=FCHENTRY                                   40376000
         GENSERV DEBUG,FIELD=FCHENTRY                                   40417200
*---------------------------------------------------------------------* 40458400
*     ENTRY FROM DELETE-PHASE ALL                                     * 40499600
*---------------------------------------------------------------------* 40540800
XDELPHAS DS    0H                                                       40582000
*SGLINK XLDFIATE,INPUT=(R9,RA,RD),WORK=(R0,R2,R3,R4,R8,RC),            *40623200
               OUTPUT=(R5,RF)                                           40664400
         BAL   R9,XLDFIATE        SEARCH PHASE ON LLE-CHAIN             40705600
*                                 AND ANCHOR TABLE                      40746800
.*   NOTE: DFWKALLE AND DFWKANCS ARE SET TO REGARDED LLE /              40788000
.*         LLE TABLE                                                    40829200
.*         IN THIS CASE DFWKAATE ARE NOT SET                            40870400
         LTR   RF,RF              PHASE FOUND ON LLE OR ATE             40911600
         BNZ   XDELRC04           NO,  ==========>                      40952800
         L     R5,DFWKALLE        FOUND ON                              40994000
         LTR   R5,R5              ... LLE CHAIN                         41035200
         BZ    XDELRC04           NO,  ==========> NOT FOUND            41076400
         USING PLLENTRY,R5        BASE FOR LLE                          41117600
         L     R4,PLLEATE         GET RELATED ATE                       41158800
         USING ATENTRY,R4                                               41200000
         TM    ATPHFLG2,ATPHACSA  RESIDES PHASE IN CSA                  41241200
         BZ    XDEL0200           NO,  ---------->                      41282400
         TM    DFWKSWRQ,AUTHREQ   AUTHORIZED REQUEST                    41323600
         BZ    XDELRC04           NO,  ---------->                      41364800
         DROP  R5                 RESET BASE FOR LLE                    41406000
*---------------------------------------------------------------------* 41447200
*     DECREASE USE COUNTERS AND FREE ATE / LLE / PHASE-AREA           * 41488400
*---------------------------------------------------------------------* 41529600
XDEL0200 DS    0H                                                       41570800
         ST    R4,DFWKAATE        PROVIDE ADDR OF RELATED ATE           41612000
*                                 DECREASE USE COUNTERS...              41653200
*SGLINK XLDDELLE,INPUT=(R9,RA,RE),WORK=(R0-R5,R8,RB,RF),OUTPUT=()       41694400
         BAL   R9,XLDDELLE        ... IN LLE AND ATE                    41735600
*                                 ... DELETE LLE AND ATE                41776800
*                                 ... AND FREEVIS PHASE AREA            41818000
*                                 ... IF RELATED USE COUNT = 0          41859200
*---------------------------------------------------------------------* 41900400
*     EXIT CODE                                                       * 41941600
*---------------------------------------------------------------------* 41982800
         SPACE 1                                                        42024000
*        CLI   DFWKRQFM,MVSDALL   DELETE-ALL                            42065200
*        BE    XDELEXIT           YES, ---------->                      42106400
         SLR   RF,RF              RETURN CODE = 0                       42147600
XDELEXIT DS    0H                                                       42188800
         CLI   DFWKRQFM,MVSDALL   DELETE-ALL                            42230000
         BE    XPHADL80           YES, ==========> RETURN               42271200
         LR    R0,RF              SAVE RETURN CODE                      42312400
*---------------------------------------------------------------------* 42353600
*     OPEN CDLOAD GATE                                                * 42394800
*---------------------------------------------------------------------* 42436000
         L     RE,CDBASE          BASE OF CDLOAD                        42477200
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              42518400
         L     R6,DISPAD          GET DISPATCHER BASE                   42559600
         BAL   R8,CDLGOPEN        OPEN CDLOAD-GATE                      42600800
*SGLINK CDLGOPEN,INPUT=(R6,R8,RE),WORK=(R2,R5,RE,RF),OUTPUT=()          42642000
         L     RE,AMVSXLOD        BASE OF ROUTINE                       42683200
         USING MVSXLOAD,RE        ESTABLISH ADDR TO CDLOAD              42724400
         USING DISP,R6                                                  42765600
         L     RD,DFWKRTUR        GET SA ADDRESS                        42806800
         LTR   RD,RD              BALR I/F                              42848000
         BZ    XDELEXYT           NO,  ---------->                      42889200
         ST    R0,16(,RD)         PROVIDE RETURN CODE                   42930400
         LM    RE,RC,12(RD)       LOAD USER REG'S                       42971600
*        AMODESW RETURN,REG=(R7)  ==========> EXIT BALR I/F             43012800
         AMODESW RETURN,REG=(R7)                                        43054000
XDELEXYT DS    0H                                                       43095200
         L     RB,TCBSAVE         ADDR OF REQUESTOR'S SA                43136400
         USING SVEARA,RB          BASE FOR SA                           43177600
         ST    R0,SVER0F          PROVIDE RC                            43218800
         DROP  RB                 RELEASE BASE FOR USER SA              43260000
         LA    RF,DISPMVS                                               43301200
*        AMODESW RETURN,REG=(RF)  ==========> EXIT DISPATCHER           43342400
         AMODESW RETURN,REG=(RF)                                        43383600
         SPACE 2                                                        43424800
         USING MVSXLOAD,RE        ESTABLISH ADDR TO CDLOAD              43466000
*---------------------------------------------------------------------* 43507200
XDELRC04 DS    0H                                                       43548400
         LA    RF,XLDRC04(,0)     RC = 4                                43589600
         B     XDELEXIT           ---------->                           43630800
*---------------------------------------------------------------------* 43672000
         SPACE 1                                                        43713200
XMACDEL  DC    CL16'DELETE'                                             43754400
         DROP  R6                 RELEASE BASE FOR DISPATCHER           43795600
         DROP  RA                 RELEASE BASE FOR TCB                  43836800
         DROP  RE                 RELEASE BASE FOR MODULE BASE          43878000
         EJECT                                                          43919200
*---------------------------------------------------------------------* 43960400
*  ROUTINE NAME: PHADLALL   VSE/ESA VERSION 2 RELEASE 2                 44001600
*  ROUTINE PROLOGUE                                                     44042800
*         VSE/ESA SERVICES FOR MVS PLATFORM: DELETE ALL                 44084000
*                                                                       44125200
*  FUNCTION:                                                            44166400
*     -  DELETE ALL PHASES LOADED VIA MVS-LOAD                          44207600
*                                                                       44248800
*  CALLED VIA:                                                          44290000
*   -  END OF TASK PROCESSOR                                            44331260
*   DESCRIPTION OF DELETE PROCESSING IN OS/390                          44331360
*   A) A SINGLE TASK LOADS A MODULE.  THE MODULE WILL BE DELETED WHEN   44331460
*      WHEN THE TASK ENDS (OR WHEN AN EXPLICIT DELETE IS DONE)          44331560
*   B) MULTIPLE TASKS LOAD THE SAME MODULE. THE MODULE ONLY LOADED ONCE 44331660
*      PHYSICALLY AND THE JOB STEP TASK KEEPS A USAGE COUNT.            44331760
*      THE MODULE WILL BE PHYSICALLY DELETED WHEN THE USE COUNT GOES TO 44331960
*      ZERO WHICH WILL HAPPEN WHEN ALL OF THE LOADING SUBTASKS HAVE     44332060
*      EITHER TERMINATED OR ISSUED EXPLICIT DELETE REQUESTS.            44333060
*                                                                       44372400
*  AMODE = ANY                                                          44413600
*                                                                       44454800
*  MODE  = PRIMARY                                                      44496000
*                                                                       44537200
*  ENTRY POINT = PHADLALL                                               44578400
*                                                                       44619600
*  LINKAGE:  L      RF,APHADALL                                         44660800
*            AMODESW CALL,REGS=(RE,RF)                                  44702000
*                                                                       44743200
*  INPUT:                                                               44784400
*            R6  =   ADDRESS OF DISPATCHER                              44825600
*            RE  =   ADDRESS AND MODE OF RETURN                         44866800
*            RA  =   ADDRESS OF TCB                                     44908000
*                                                                       44949200
*  OUTPUT:                                                              44990400
*           -                                                           45031600
*                                                                       45072800
*  EXIT: RETURN TO CALLER                                               45114000
*                                                                       45155200
*  ERROR EXIT: -                                                        45196400
*                                                                       45237600
*  CHANGE ACTIVITIES:                                                   45278800
*     NEW FOR VSE/ESA 2.2.0                                             45320000
*                                                                       45361200
* A000000-999999                                                        45402400
*                                                                       45443600
*---------------------------------------------------------------------* 45484800
*                                                                       45526000
*  INTERNAL SUBROUTINES USED:                                           45567200
*        CDLGCLOS   -   OCCUPY CDLOAD GATE                              45608400
*        XDELPHAS   -   DELETE PHASE                                    45649600
*        CDLGOPEN   -   OPEN CDLOAD GATE                                45690800
*---------------------------------------------------------------------* 45732000
         SPACE 2                                                        45773200
         USING TCBADR,RA          ADDRESSIBILITY OF TCB                 45814400
         SPACE 1                                                        45855600
         DS    0D                 SERVICE ENTRE                         45896800
         DC    CL8'PHADLALL'      EYECATCHER                            45938000
         DC    CL8'11/07/96'                                            45979206
         SPACE 1                                                        46020400
PHADLALL DS    0H                 SERVICE ENTRY POINT                   46061600
         STM   RE,R6,DFWKEEPL                                           46102800
         L     RE,AMVSXLOD        BASE OF MVSXLOAD                      46144000
         USING MVSXLOAD,RE        ESTABLISH ADDR TO CDLOAD              46185200
         L     R1,TCBALLST        ADDR OF LLE LIST                      46226400
         LTR   R1,R1              ANY ENTRY AVAILABLE                   46267600
         BZ    XPHAEXIT           NO,  ---------->                      46308800
*---------------------------------------------------------------------* 46350000
*     GET CDLOAD GATE                                                 * 46391200
*---------------------------------------------------------------------* 46432400
         L     RE,CDBASE          BASE OF CDLOAD                        46473600
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              46514800
         BAL   R8,CDLGCLOS        GATE CDLOAD                           46556000
*SGLINK CDLGCLOS,INPUT=(R6,R8,RE),WORK=(R2,R5),OUTPUT=()                46597200
         L     RE,AMVSXLOD        BASE OF MVSXLOAD                      46638400
         USING MVSXLOAD,RE        ESTABLISH ADDR TO CDLOAD              46679600
*---------------------------------------------------------------------* 46720800
*     DELETE FIRST PHASE IN LLE CHAIN                                 * 46762000
*---------------------------------------------------------------------* 46803200
         LA    R0,XMACDALL        PROVIDE ....                          46844400
         ST    R0,DFCBMACN        ....    CURRENT MACRO NAME            46885600
         L     R0,CRADDR          ADDR OF CURRENT COMREG                46926800
         ST    R0,DFWKCOMG        ....                                  46968000
XPHALOOP DS    0H                                                       47009200
         LA    R1,ANCHHDRL(,R1)   GET ADDRESS OF ENTRY                  47050400
XPHADL00 DS    0H                                                       47091600
         CLI   0(R1),X00          PHASE ALREADY DELETED                 47132800
         BNE   XPHADL20           NO,  ---------->  TAKE IT             47174000
         LA    R1,PLLELEN(,R1)    NEXT ENTRY                            47215200
         B     XPHADL00                                                 47256400
XPHADL20 DS    0H                                                       47297600
         XC    DFWKUSEN(DFWKX1LN),DFWKUSEN  CLEAR REQ. STATUS           47338800
         XC    DFWKNAME(DFWKEEPL-DFWKNAME),DFWKNAME                     47380000
         XC    DFWKADCB(FCHPLLEN+1-4),DFWKADCB  CLEAR PARMLIST          47421200
         MVI   DFWKRQFM,MVSDALL   REQUEST: MVS-DELETE-ALL               47462400
         ST    R1,DFWKPHNM        BUILD PARMLIST                        47503600
         MVC   DFWKNAME(L'DFWKNAME),0(R1) COPY PHASENAME                47544800
         USING PLLENTRY,R1        PROVIDE ADDR TO PLLE                  47586000
*        GENSERV TEST,FIELD=PLLESYS,BC=BZ,LAB=XPHADL50                  47627200
         GENSERV TEST,FIELD=PLLESYS,BC=BZ,LAB=XPHADL50                  47668400
         DROP  R1                 RESET ADDR TO PLLE                    47709600
         MVI   DFWKSWRQ,AUTHREQ   INDICATE AUTHORIZED REQUEST           47750800
XPHADL50 DS    0H                                                       47792000
         B     XDELPHAS                                                 47833200
*SGLINK XDELPHAS,INPUT=(R1,RA,RB),WORK=(R0,R2-R5,R8,R9,RC,RF)           47874400
XPHADL80 DS    0H                                                       47915600
         L     R1,TCBALLST        ADDR OF LLE LIST                      47956800
         LTR   R1,R1              MORE TO DO                            47998000
         BNZ   XPHALOOP           YES, ---------->                      48039200
*---------------------------------------------------------------------* 48080400
*     OPEN CDLOAD GATE                                                * 48121600
*---------------------------------------------------------------------* 48162800
         L     RE,CDBASE          BASE OF CDLOAD                        48204000
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              48245200
         L     R6,DISPAD          GET DISPATCHER BASE                   48286400
         BAL   R8,CDLGOPEN        OPEN CDLOAD-GATE                      48327600
*SGLINK CDLGOPEN,INPUT=(R6,R8,RE),WORK=(R2,R5,RE,RF),OUTPUT=()          48368800
         SPACE 1                                                        48410000
XPHAEXIT DS    0H                                                       48451200
         LM    RE,R6,DFWKEEPL                                           48492400
*        AMODESW RETURN,REG=(RE)  ==========> RETURN TO CALLER          48533600
         AMODESW RETURN,REG=(RE)                                        48574800
*---------------------------------------------------------------------* 48616000
         USING MVSXLOAD,RE        ESTABLISH ADDR TO CDLOAD              48657200
XMACDALL DC    CL16'DELETE-ALL'                                         48698400
         DROP  RE                                                       48739600
         EJECT                                                          48780800
         EJECT                                                          59080800
*---------------------------------------------------------------------* 59082500
         DC    CL8'XFCHSUBR'                                            59083606
         DC    CL8'11/07/96'                                            59084706
         USING TCBADR,RA          SET BASE TO TCB                       59085900
         SPACE 2                                               @TEMPORA 59086700
         USING MVSXLOAD,RE        SET BASE OF ROUTINE                   59087600
*SGLINK XCHKAUT,S,INPUT=(R9,RA,RB,RE),WORK=(R5)                @TEMPORA 59089300
XCHKAUT  DS    0H                                              @TEMPORA 59091000
         USING SVEARA,RB          ADDRESSIBILITY OF SA         @TEMPORA 59092700
         TM    SVEPSWKY,X'01'     SUPERVISOR STATE             @TEMPORA 59094406
         BZ    XAUT0100           YES,  --------->             @TEMPORA 59096100
         TM    SVEPSWKY,X'F0'     KEY ZERO                     @TEMPORA 59097800
         BZ    XAUT0100           YES,  --------->             @TEMPORA 59099500
         L     R5,PCBPTR          CURRENT PCB                  @TEMPORA 59101200
         USING PCBADR,R5          PROVIDE ADDRESSABILITY TO PCB@TEMPORA 59102900
         TM    PCBSSFLG,VTAM+CICS PRIVILEGED SUBSYSTEMS        @TEMPORA 59104600
         BZ    4(,R9)             NO,  ==========>             @TEMPORA 59106300
         DROP  R5                 RESET ADDRESS TO PCB         @TEMPORA 59108000
XAUT0100 DS    0H                                              @TEMPORA 59109700
         OI    DFWKSWRQ,AUTHREQ   REQUESTOR AUTHORIZED         @TEMPORA 59111400
         BR    R9                 ==========>                  @TEMPORA 59113100
         DROP  RB                 RESET ADDR TO SA             @TEMPORA 59114800
         DROP  RA                 RELEASE BASE FOR TCB                  59116500
         DROP  RE                 RELEASE BASE FOR MODULE BASE          59118200
         EJECT                                                          59122000
*---------------------------------------------------------------------* 59163200
*  ROUTINE NAME: XLDVALID /XLDVALWT                                     59163900
*  FUNCTION:  VALIDATION OF REQUESTOR'S AREAS                           59164600
*  AMODE:     MODE OF REQUESTOR                                         59165300
*  MODE:                                                                59166000
*  ENTRY POINT: XLDVALID                                                59166700
*  LINKAGE:  BAL   R9,XLDVALID                                          59167400
*  INPUT:                                                               59168100
*            R0  =   ERROR INDICATOR, - IF ANY                          59168800
*                        OTHERWISE 0                                    59169500
*            R1  =   LOW ADDRESS OF AREA                                59170200
*            R2  =   HIGH ADDRESS OF AREA TO BE INVALIDATED             59170900
*            RA  =   TCB                                                59171600
*            RE  =   BASE                                               59172300
*            R9  =   RETURN ADDRESS                                     59173000
*                                                                       59173700
*  OUTPUT:    -                                                         59174400
*  EXIT:   OK    -  RETURN TO CALLER                                    59175100
*          ERROR -  ERROR EXIT ROUTINE                                  59175800
*---------------------------------------------------------------------* 59176500
         SPACE 2                                                        59177200
         USING TCBADR,RA                                                59177900
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             59178600
         DS    0D                                                       59179300
         DC    CL8'XLOADSUB'                                            59180006
         SPACE 1                                                        59180700
*SGLINK XLDVALID,S,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)         59181400
XLDVALID DS    0H                                                       59182100
         LH    R5,PIK             CURRENT PIK                           59182800
         L     R6,DISPAD          BASE OF DISPATCHER                    59183500
         USING DISP,R6            BROVIDE ADDRESSIBILITY                59184200
*SGLINK VALWRITE,INPUT=(R1,R2,R5,R6,R8),WORK=(R2,R8),OUTPUT=(R5)        59184900
         BAL   R8,VALWRITE                                              59185600
         B     XLDVALRX           ERROR  (INVALID ADDRESS RANGE)        59186300
         B     XLDVALRC           ERROR  (INVALID KEY)                  59187000
         BR    R9                 ==========>                           59187700
         SPACE 1                                                        59188400
*---------------------------------------------------------------------* 59189100
XLDVALRC DS    0H                                                       59189800
         L     R2,DFWKRTUR        GET SA ADDRESS                        59190500
         LTR   R2,R2              BALR I/F                              59191200
         BNZR  R9                 OK,  ==========>                      59191900
XLDVALRX DS    0H                                                       59192600
         L     RB,AFCHDAT         ADDRESS FETCH-DATA-AREA               59193300
         USING DFCB,RB            SET BASE FOR SGAFCH                   59194000
         L     RF,AXLODERX        GET BASE OF ERROR ROUTINE             59194700
         DROP  RB                 RELEASE BASE FOR SGAFCH               59195400
         BR    RF                 ==========>                           59196100
         SPACE 1                                                        59196800
*---------------------------------------------------------------------* 59197500
         DROP  R6                 RELEASE BASE TO DISP                  59198200
         DROP  RE                 RELEASE BASE FOR MODULE               59198900
         DROP  RA                 RELEASE BASE TO TCB                   59199600
         EJECT                                                          59200300
*---------------------------------------------------------------------* 59201000
*  ROUTINE NAME: XLDFIATE  VSE/ESA VERSION 2 RELEASE 2                  59204400
*                                                                       59245600
*  FUNCTION:                                                            59286800
*     -  SEARCH LLE CHAIN                                               59328000
*     -  SEARCH ANCHOR TABLE                                            59369200
*              FOR SPECIFIED PHASE NAME                                 59410400
*  AMODE = ANY                                                          59492800
*  MODE:                                                                59575200
*     -  PRIMARY ONLY                                                   59616400
*  ENTRY POINTS                                                         59698800
*     -  XLDFIATE                                                       59740000
*  LINKAGE SEQUENCE:                                                    59822400
*            BAL   R9,XLDFIATE                                          59863600
*  INPUT:                                                               59946000
*            RE  =   BASE OF MODULE                                     59987200
*            RA  =   ADDRESS OF TCB                                     60028400
*            R9  =   RETURN ADDRESS                                     60069600
*  OUTPUT:                                                              60152000
*       - IF LLE ALREADY ACTIVE:                                        60193200
*       - IF ATE ALREADY ACTIVE                                         60275600
*            R15 =   RETURN CODE                                        60358000
*                    = 0: PHASE FOUND                                   60399200
*                    = 4: PHASE NOT FOUND                               60440400
*            R5 =    ADDRESS OF ENTRY                                   60481600
*  EXIT: RETURN TO CALLER                                               60564000
*  ERROR EXITS:                                                         60646400
*---------------------------------------------------------------------* 60728800
.* REGISTER USAGE                                                       60770000
.*                                                                      60811200
.*             INPUT             OUTPUT           USED AS               60852400
.*             -----             ------           -------               60893600
.*                                                                      60934800
.*       R0  -                                    WORK                  60976000
.*       R1  -                   UNCHANGED                              61017200
.*       R2  -                                    WORK                  61058400
.*       R3  -                                    WORK                  61099600
.*       R4  -                                    WORK                  61140800
.*       R5  -                   ADDR OF ATE      WORK                  61182000
.*       R6  -                   UNCHANGED                              61223200
.*       R7  -                   UNCHANGED                              61264400
.*       R8  -                                    LINK                  61305600
.*       R9  - RETURN            UNCHANGED                              61346800
.*       R10 - ADDRESS TCB       UNCHANGED                              61388000
.*       R11 -                   UNCHANGED                              61429200
.*       R12 -                                    WORK                  61470400
.*       R13 -                   UNCHANGED                              61511600
.*       R14 - BASE              UNCHANGED                              61552800
.*       R15 -                   RETURN CODE                            61594000
.*                                                                      61635200
.*--------------------------------------------------------------------* 61676400
*  USED SUBROUTINES:                                                    61717600
*        CDLSCLLE                                                       61758800
*        CDLSCP                                                         61800000
*        XFIATCHK                                                       61841200
*---------------------------------------------------------------------* 61882400
         SPACE 2                                                        61923600
         USING MVSXLOAD,RE        SET BASE FOR ROUTINE                  62047200
         USING TCBADR,RA          SET BASE FOR TCB                      62088400
*SGLINK XLDFIATE,S,INPUT=(R9,RA,RD),WORK=(R0,R2,R3,R4,R8,RC),          *62138400
               OUTPUT=(R5,RF)                                           62188400
XLDFIATE DS    0H                 ROUTINE ENTRY POINT                   62294400
         SPACE 1                                                        62335600
*---------------------------------------------------------------------* 62376800
*     SEARCH LLE CHAIN                                                * 62418000
*---------------------------------------------------------------------* 62459200
         SPACE 1                                                        62500400
         L     RC,TCBALLST        ADDR OF LLE CHAIN                     62541600
         LTR   R1,RC              STILL EMPTY                           62582800
         BZ    XFIATATE           YES, ---------->                      62624000
*     SET UP TO CALL LLE SEARCH ROUTINE                                 62665200
XFIAT100 DS    0H                                                       62706400
         L     RE,CDBASE          BASE OF CDLOAD                        62747600
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              62788800
         BAL   R8,CDLSCLLE        SCAN LLE                              62830000
*SGLINK CDLSCLLE,INPUT=(R8,RA,RC,RE),WORK=(R0,R3,R4),OUTPUT=(R5,RC,RF)  62871200
         L     RE,AMVSXLOD        BASE OF ROUTINE                       62912400
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             62953600
         LTR   RF,RF              PHASE FOUND                           62994800
         BNZ   XFIATATE           NO,  ----------> SEARCH ATE           63036000
*     R5 POINTS TO LLE ENTRY                                            63077200
         LR    R4,R5                                                    63118400
         USING PLLENTRY,R4        SET BASE FOR LLE                      63159600
         L     R5,PLLEATE         ADDRESS OF RELATED ATE                63200800
         USING ATENTRY,R5         SET BASE FOR ATE                      63242000
         CLC   PLLENAME,ATPHSNME  SAME PHASE NAME                       63283200
PCKXDR10 DS    0H                                                       63324400
         BNE   XLD8062C           NO , ==========> 806-2C               63365600
*                                 INTERNAL ERROR, ATE DESTROYED         63406800
         OI    DFWKSWRQ,MORESRCH  INDICATE CONTINUE SEARCH              63448000
         CLI   DFWKRQFM,MVSDELT   MVS-DELETE REQUEST                    63489200
         BE    XFIAT110           YES, ---------->                      63530400
         CLI   DFWKRQFM,MVSDALL   MVS-DELETE ALL REQUEST                63571600
         BNE   XFIAT200           NO,  ---------->                      63612800
*---------------------------------------------------------------------* 63654000
*     HANDLE LLE FOR MVS-DELETE                                       * 63695200
*---------------------------------------------------------------------* 63736400
XFIAT110 DS    0H                                                       63777600
         LH    R3,PLLESYS         SYSTEM USAGE COUNT                    63818800
         TM    DFWKSWRQ,AUTHREQ   AUTHORIZED REQUEST                    63860000
         BO    XFIAT120           YES, ---------->                      63901200
         CH    R3,PLLECNT         USER USAGE COUNT HIGHER               63942400
         BL    XFIAT600           YES, ----------> OK                   63983600
         BE    XFIAT100           EQUAL, --------> SCAN MORE            64024800
         B     XLD8062C           LOWER, ========> 806-2C               64066000
XFIAT120 DS    0H                                                       64107200
         LTR   R3,R3              SYSTEM USAGE COUNT = 0                64148400
         BP    XFIAT600           NO,  ---------->                      64189600
         B     XFIAT100           YES, ----------> SCAN MORE            64230800
*---------------------------------------------------------------------* 64272000
*     HANDLE LLE FOR MVS-LOAD                                         * 64313200
*---------------------------------------------------------------------* 64354400
XFIAT200 DS    0H                                                       64395600
         BAL   R8,XFIATCHK                                              64436800
*SGLINK  XFIATCHK,INPUT=(R5,R8,RA,RE),WORK=(),OUTPUT=()                 64478000
         B     XFIAT100           MORE SEARCH                           64519200
         B     XFIAT600           LLE ENTRY USEABLE                     64560400
         DROP  R5                 RESET ADDR FOR ATE                    64601600
         DROP  R4                 RESET ADDR FOR LLE                    64642800
         SPACE 1                                                        64684000
*---------------------------------------------------------------------* 64725200
*     PHASE NOT FOUND IN LLE - SEARCH ATE                             * 64766400
*---------------------------------------------------------------------* 64807600
         SPACE 1                                                        64828200
XFIATATE DS    0H                                                       64848800
         NI    DFWKSWRQ,XFF-MORESRCH RESET CONTINUE SEARCH              64890000
*     SET UP TO CALL ATE SEARCH ROUTINE                                 64931200
         L     RC,DFWKCOMG        COMREG                                64972400
         USING COMREG,RC          SET BASE FOR COMREG                   65013600
         TM    OPTNBYTE,ANCHTBIT  ANCHOR TABLE INITIALIZED              65054800
         BZ    XFIATRC4           NO,  ---------->                      65096000
         L     RC,IJBGVCTL        ADDR ANCHOR TABLE HEADER              65137200
         DROP  RC                 RESET BASE  FOR COMREG                65178400
XFIAT400 DS    0H                                                       65219600
         L     RE,CDBASE          BASE OF CDLOAD                        65260800
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              65302000
*SGLINK CDLSCP,INPUT=(R8MRA,RC,RE),WORK=(R0,R3,R4),OUTPUT=(R5,RC,RF)    65343200
         BAL   R8,CDLSCP          SCAN ATE                              65384400
         L     RE,AMVSXLOD        BASE OF ROUTINE                       65425600
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             65466800
         LTR   RF,RF              PHASE FOUND                           65508000
         BNZ   XFIATRC4           NO,  ---------->                      65549200
*     R5 POINTS TO ATE                                                  65590400
         USING ATENTRY,R5                                               65631600
         OI    DFWKSWRQ,MORESRCH  INDICATE CONTINUE SEARCH              65672800
         CLI   DFWKRQFM,MVSDELT   MVS-DELETE REQUEST                    65714000
         BNE   XFIAT500           NO,  ---------->                      65755200
*---------------------------------------------------------------------* 65796400
*     HANDLE ATE FOR MVS-DELETE                                       * 65837600
*---------------------------------------------------------------------* 65878800
         LH    R3,ATLDSYS         SYSTEM USAGE COUNT                    65920000
         TM    DFWKSWRQ,AUTHREQ   AUTHORIZED REQUEST                    65961200
         BO    XFIAT410           YES, ---------->                      66002400
         CH    R3,ATLDCNT         USER USAGE COUNT HIGHER               66043600
         BL    XFIAT600           YES, ---------->                      66084800
         BE    XFIAT400           EQUAL, --------> SCAN MORE            66126000
         B     XLD8062C           LOWER, ========> 806-2C               66167200
XFIAT410 DS    0H                                                       66208400
         LTR   R3,R3              SYSTEM USAGE COUNT = 0                66249600
         BP    XFIAT600           NO,  ---------->                      66290800
         B     XFIAT400           YES, ----------> SCAN MORE            66332000
*---------------------------------------------------------------------* 66373200
*     HANDLE ATE FOR MVS-LOAD                                         * 66414400
*---------------------------------------------------------------------* 66455600
XFIAT500 DS    0H                                                       66496800
*SGLINK  XFIATCHK,INPUT=(R5,R8,RA,RE),WORK=(),OUTPUT=()                 66538000
         BAL   R8,XFIATCHK                                              66579200
         B     XFIAT400           MORE SEARCH                           66620400
*        B     XFIAT600           ATE ENTRY USEABLE                     66661600
*---------------------------------------------------------------------* 66744000
*     EXIT CODE                                                       * 66785200
*---------------------------------------------------------------------* 66826400
XFIAT600 DS    0H                                                       66847000
*     R5 CONTAINS ADDRESS OF  ATE                                       66867600
*     RF CONTAINS RETURN CODE X'0'                                      66908800
         NI    DFWKSWRQ,XFF-MORESRCH RESET CONTINUE SEARCH              66991200
         BR    R9                 RETURN  ==========>                   67032400
*---------------------------------------------------------------------* 67114800
XFIATRC4 DS    0H                                                       67156000
         SLR   R5,R5              NO ENTRY FOUND                        67197200
         LA    RF,XLDRC04(,0)     PROVIDE RC = 4                        67238400
         NI    DFWKSWRQ,XFF-MORESRCH RESET CONTINUE SEARCH              67279600
         BR    R9                 RETURN  ==========>                   67320800
*---------------------------------------------------------------------* 67362000
         DROP  RA                 RELEASE BASE FOR TCB                  67403200
         DROP  RE                 RELEASE BASE FOR MODULE               67444400
         EJECT                                                          67485600
*---------------------------------------------------------------------* 67526800
*  SUBROUTINE XFIATCHK                                                  67568000
*  FUNCTION:                                                            67609200
*     -   CHECK FOR CONSISTENCY BETWEEN FOUND PHASE AND REQUEST         67650400
*  ENTRY POINT:                                                         67691600
*     -  XFIATCHK                                                       67732800
*  LINKAGE SEQUENCE:                                                    67774000
*            BAL   R8,XFIATCHK                                          67815200
*            B     MORE TO SCAN                                         67856400
*            B     CHECK SUCCESFULL                                     67897600
*  INPUT:                                                               67938800
*            R5  =   CURRENT ATE                                        67980000
*            R8  =   RETURN ADDRESS                                     68021200
*            RE  =   BASE OF MODULE                                     68062400
*            RA  =   ADDRESS OF TCB                                     68103600
*  OUTPUT:                                                              68144800
*  EXIT: RETURN TO CALLER                                               68186000
*  ERROR EXITS: XLD30608, XLDD0600                                      68227200
*---------------------------------------------------------------------* 68268400
         SPACE 2                                                        68309600
*SGLINK  XFIATCHK,S,INPUT=(R5,R8,RA,RE),WORK=(),OUTPUT=()               68350800
         USING ATENTRY,R5         SET BASE FOR ATE                      68392000
         USING TCBADR,RA          SET BASE FOR TCB                      68433200
         USING MVSXLOAD,RE        SET BASE ROUTINE                      68474400
XFIATCHK DS    0H                                                       68515600
         CLI   ATSUBPOL,X00       COPY USABLE FOR MVSLOAD               68556800
         BE    0(,R8)             NO,  ==========> SCAN MORE            68598000
         TM    DFWKSWRQ,AUTHREQ   AUTHORIZED REQUEST                    68639200
         BZ    4(,R8)             NO,  ----------> OK                   68680400
.*    SUBPOOLS 252, 228 AND 241 ARE USABLE                              68721600
         OI    DFWKSWRQ,PLLEFND   INDICATE FOUND                        68762800
         TM    ATPHFLAG,ATAPFMB   APF PROTECTED LIBRARY                 68886400
         BZ    0(,R8)             NO,  ==========> SCAN MORE            68894600
         TM    ATPHFLAG,ATAUTHX   LOADED BY AUTHORIZED REQUEST          68902800
         BZ    0(,R8)             NO,  ==========> SCAN MORE            68911000
         CLI   ATSUBPOL,251       COPY USABLE FOR AUTH REQUEST          68919200
         BE    0(,R8)             NO,  ==========> SCAN MORE            68944000
         TM    DFWKOPT1,DFWKGLBY  GLOBAL SPECIFIED                      68968800
         BZ    4(,R8)             NO, ===========> OK                   69010000
         TM    ATPHFLG2,ATSVAELI  PHASE SVA ELIGIBLE                    69051200
         BZ    XLD30608           NO,  ==========> 306-08               69092400
         CLI   ATSUBPOL,252       COPY USABLE FOR GLOBAL                69133600
         BE    0(,R8)             NO,  ==========> SCAN MORE            69174800
         TM    DFWKOPT1,DFWKGLBF  GLOBAL-FIXED SPECIFIED                69216000
         BZ    4(,R8)             NO,  ----------> OK                   69257200
*              GLOBAL ONLY REQUEST MIGHT USE A FIXED COPY               69298400
         TM    ATPHFLG2,ATPFIXED  PHASE ALREADY FIXED                   69339600
         BO    4(,R8)             YES, ==========> OK                   69380800
         B     XLDD0600           NO,  ==========> D06                  69422000
         SPACE 1                                                        69463200
*---------------------------------------------------------------------* 69504400
         DROP  R5                 RESET ADDR FOR ATE                    69545600
         DROP  RA                 RELEASE BASE FOR TCB                  69586800
         DROP  RE                 RELEASE BASE FOR ROUTINE              69628000
         EJECT                                                          69669200
*---------------------------------------------------------------------* 69710400
*  ROUTINE NAME: XLDUPLLE  VSE/ESA VERSION 2 RELEASE 2                  69751600
*  FUNCTION:                                                            69834000
*     -  UPDATE LLE                                                     69875200
*        IF NOT YET BUILD THEN BUILD LLE, OTHERWISE INCREASE            69916400
*           USE COUNTERS                                                69957600
*  AMODE = ANY                                                          70040000
*  MODE  = PRIMARY                                                      70122400
*  ENTRY POINT = XLDUPLLE                                               70204800
*  LINKAGE SEQUENCE:                                                    70287200
*            BAL   R9,XLDUPLLE                                          70328400
*  INPUT:                                                               70410800
*            RE  =   BASE OF MODULE                                     70452000
*            RA  =   ADDRESS OF TCB                                     70493200
*            R9  =   RETURN ADDRESS                                     70534400
*  OUTPUT:                                                              70616800
*  EXIT: RETURN TO CALLER                                               70699200
*  ERROR EXITS: XLD8062C  -  INTERNAL ERROR                             70781600
*               XLD90604  -  USAGE COUNT OVERFLOW IN LLE                70822800
*               XLD90608  -  USAGE COUNT OVERFLOW IN ATE                70864000
*---------------------------------------------------------------------* 70946400
         SPACE 1                                                        70987600
*SGLINK XLDUPLLE,S,INPUT=(R9,RA,RE),WORK=(R0-R5,R8,RB,RC,RF),OUTPUT=()  71028800
         USING MVSXLOAD,RE        SET BASE ROUTINE                      71070000
         USING TCBADR,RA          SET BASE FOR TCB                      71111200
XLDUPLLE DS    0H                 ROUTINE ENTRY POINT                   71152400
         SLR   RF,RF                                                    71193600
         L     R5,DFWKALLE                                              71234800
         LTR   R5,R5              LLE ALREADY AVAILABLE                 71276000
         BNZ   XLDUP020           YES, ---------->                      71317200
*---------------------------------------------------------------------* 71358400
*     PROVIDE LLE                                                     * 71399600
*---------------------------------------------------------------------* 71440800
         L     RB,DFWKANCS        GET HEADER OF ATE                     71482000
         L     RE,CDBASE          BASE OF CDLOAD                        71523200
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              71564400
*SGLINK CDLFNLLE,INPUT=(R8,RA,RE),WORK=(R0-R4),OUTPUT=(R5,RC,RF)        71605600
         BAL   R8,CDLFNLLE        GET FREE LLE                          71646800
         L     RE,AMVSXLOD        BASE OF ROUTINE                       71688000
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             71729200
         LTR   RF,RF              FREE LLE                              71770400
         BNZ   XLDUPRST           NO,  ----------> RESET ATE            71811600
*     R5 POINTS TO LLE ENTRY                                            71852800
         USING PLLENTRY,R5        SET BASE FOR LLE                      71894000
         MVC   PLLENAME,DFWKNAME  PROVIDE PHASE NAME                    71935200
         L     R4,DFWKAATE                                              71976400
         ST    R4,PLLEATE         ... ADDR OF ATE                       72017600
         ST    RB,PLLEATHD        ... ADDR OF ANCHOR TABLE              72058800
         USING ATENTRY,R4         BASE FOR ATE                          72100000
         MVC   PLLEFLG1,ATPHFLAG  ... SPECIAL FLGS                      72141200
         USING ANCHTAB,RC         SET BASE FOR LLE HEADER               72182400
*     GENSERV  INC,FIELD=ANCHNOUE INCR NBR OF USED ENTRIES              72223600
      GENSERV  INC,FIELD=ANCHNOUE INCR NBR OF USED ENTRIES              72264800
         DROP  RC                 RESET BASE FOR LLE HEADER             72306000
*---------------------------------------------------------------------* 72347200
*     INCREASE USE COUNTS                                             * 72388400
*---------------------------------------------------------------------* 72429600
XLDUP020 DS    0H                                                       72470800
         L     R4,PLLEATE         GET RELATED ATE                       72512000
*     GENSERV  COMPINC,FIELD=PLLECNT,COMPF=XLD7F,BC=BE,LAB=XLD90604     72553200
*                                 INCREASE USE COUNT IN LLE             72594400
      GENSERV  COMPINC,FIELD=PLLECNT,COMPF=XLD7F,BC=BE,LAB=XLD90604     72635600
*     GENSERV  COMPINC,FIELD=ATLDCNT,COMPF=XLD7F,BC=BE,LAB=XLD90608     72676800
*                                 INCREASE USE COUNT IN ATE             72718000
      GENSERV  COMPINC,FIELD=ATLDCNT,COMPF=XLD7F,BC=BE,LAB=XLD90608     72759200
         TM    DFWKSWRQ,AUTHREQ   AUTHORIZED REQUEST                  B 72800400
         BZR   R9                 NO,  ==========> EXIT CALLER          72841600
*     GENSERV  INC,FIELD=PLLESYS  INCR SYSTEM COUNT IN LLE              72882800
      GENSERV  INC,FIELD=PLLESYS                                        72924000
*     GENSERV  INC,FIELD=ATLDSYS  INCR SYSTEM COUNT IN ATE              72965200
      GENSERV  INC,FIELD=ATLDSYS                                        73006400
         BR    R9                      ==========> EXIT CALLER          73047600
         SPACE 1                                                        73088800
         DROP  R5                 RELEASE BASE FOR LLE                  73130000
         SPACE 1                                                        73171200
*---------------------------------------------------------------------* 73212400
*     NO STORAGE FOR LLE --->  RESET ATE                              * 73253600
*---------------------------------------------------------------------* 73294800
         SPACE 1                                                        73336000
XLDUPRST DS    0H                                                       73377200
         L     R4,DFWKAATE        CURRENT ATE                           73418400
         USING ATENTRY,R4         SET BASE FOR ATE                      73459600
*      GENSERV TEST,FIELD=ATLDCNT,COMPF=XLD00,BC=BNE,LAB=XLD106C1       73500857
       GENSERV TEST,FIELD=ATLDCNT,COMPF=XLD00,BC=BNE,LAB=XLD106C1       73583257
*     DELETE ATE IF ATLDCNT = 0 AND FREE STORAGE AREA                   73624400
         TM    ATPHFLG2,ATSVAPHA  PHASE LOCATED IN SVA                  73638100
         BO    XLDUP050           YES, ----------> NO FREEMAIN          73651800
         STM   R9,RE,DFCBSAV+OFS9                                       73706800
         L     RD,TCBSAVE                                               73706951
         L     RC,TCBATCBE        GET ADDR TCBX                         73756800
         TM    TCBXSAUS-TCBXADR(RC),TCBXXSBU SAVE AREA FREE    @D64ADMZ 73756919
         BZ    XLDUP045          YES                           @D64ADMZ 73757019
         ST    R5,SGXREG5        SAVE R5                       @D64ADMZ 73758019
         BAL   R5,SYSERROR       NO, MUST NOT OCCUR            @D64ADMZ 73759019
XLDUP045 DS    0H                                                       73759103
         OI    TCBXSAUS-TCBXADR(RC),TCBXXSBU SAVE AREA IN USE  @D64ADMZ 73770019
         LA    RC,TCBXXSB-TCBXADR(,RC)                         @D64ADMZ 73806845
         USING SVEARA,RD                                                73806946
         MVC   0(12,RC),SVER0F   SVER0F-SVER01 DEST. BY GETMAIN@D64ADMZ 73807045
         MVC   12(4,RC),SVEPSW    SAVE FIRST PART OF PSW       @D64ADMZ 73808049
         NI    SVEPSWKY,X'FE'     DO FREEMAIN IN SUP STATE     @D64ADMZ 73809051
         SLR   R6,R6                                                    73956800
         ST    R6,SVER0F          CLEAR OPTION REGISTER                 74006800
         OI    SVER0F+D3,X'01'    FREEMAIN INDICATION                   74056812
         MVC   SVER0F+D2(1),ATSUBPOL PROVIDE SUBPOOL ID                 74106800
         L     R1,ATLOADP         GET LOAD POINT                        74156800
         L     R0,ATPHSLEN        ... LENGTH OF PHASE                   74206800
         STM   R0,R1,SVER00       ...  INTO SAVE AREA                   74256800
         DROP  R4                                                       74306800
         L     R6,XLODSTOR        STORAGE ROUTINE                       74356800
*SGLINK GMFMSVC78,INPUT=(R6,RA),NOMODR=(R6,RA),                        *74406805
               WORK=(R0-R5,R7-R9,RB-RF)                                 74456805
         BASSM R6,R6              CALL FREEMAIN                         74506851
         L     RC,TCBATCBE        GET ADDR OF TCB EXTENSION             74506903
         NI    TCBXSAUS-TCBXADR(RC),XFF-TCBXXSBU SAVE AREA FREE@D64ADMZ 74507019
         L     RD,TCBSAVE                                               74508005
         L     RF,SVER0F          GET RETURN CODE                       74509005
         LA    RC,TCBXXSB-TCBXADR(RC)                          @D64ADMZ 74509145
         MVC   SVER0F(12),0(RC)   RESTORE USER'S SVER0F-SVER01 @D64ADMZ 74509247
         MVC   SVEPSW(4),12(RC)   RESTORE FIRST PART OF PSW    @D64ADMZ 74509349
         DROP  RD                 RELEASE SAVE AREA                     74510005
         LM    R9,RE,DFCBSAV+OFS9                                       74556800
         L     R6,DISPAD          DISPATCHER ADDRESS                    74656800
         MVI   RID+1,REENTRID     RESET RID                             74706800
         LTR   RF,RF              RETURN CODE OF FREEMAIN OK            74756800
         BNZ   XLD8062C           NO, ---------->                       74806800
XLDUP050 DS    0H                                                       74856800
         L     RE,CDBASE          BASE OF CDLOAD                        74910400
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              74960400
*SGLINK CDDELATE,INPUT=(R8,RA,RE),WORK=(R0-R5,RC),OUTPUT=(RF)           75025200
         BAL   R8,CDDELATE        FREE ATE                              75066400
         L     RE,AMVSXLOD        BASE OF ROUTINE                       75107600
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             75148800
         LTR   RF,RF              FREE ATE                              75190000
         BNZ   XLD8062C           NO,  ==========> INTERNAL ERR         75231200
*                                 DUE TO FREEVIS ERROR                  75272400
         B     XLD106C1                ==========> NO GETVIS            75313600
*---------------------------------------------------------------------* 75354800
         SPACE 2                                                        75396000
         DROP  RA                 RELEASE BASE FOR TCB                  75478400
         DROP  RE                 RELEASE BASE FOR ROUTINE              75519600
         EJECT                                                          75560800
*---------------------------------------------------------------------* 75602000
*  ROUTINE NAME: XLDDELLE                                               75643233
*  FUNCTION:                                                            75725600
*     -  DECREASE USE COUNTERS                                          75766800
*        IF USE COUNTER IS EQUAL TO ZERON THEN DELETE LLE               75808000
*  AMODE = ANY                                                          75890400
*  MODE  = PRIMARY                                                      75972800
*  ENTRY POINT = XLDDELLE                                               76055200
*  LINKAGE SEQUENCE:                                                    76137600
*            BAL   R9,XLDDELLE                                          76178800
*  INPUT:                                                               76261200
*            RE  =   BASE OF MODULE                                     76302400
*            RA  =   ADDRESS OF TCB                                     76343600
*            R9  =   RETURN ADDRESS                                     76384800
*  OUTPUT:                                                              76467200
*  EXIT: RETURN TO CALLER                                               76549600
*  ERROR EXITS: XLD8062C  -  INTERNAL ERROR - FREEVIS FAILURE           76632000
*---------------------------------------------------------------------* 76714400
         SPACE 1                                                        76755600
*SGLINK XLDDELLE,S,INPUT=(R9,RA,RE),WORK=(R0-R5,R8,RB,RF),OUTPUT=()     76796800
         USING MVSXLOAD,RE        SET BASE FOR ROUTINE                  76838000
         USING TCBADR,RA          SET BASE FOR TCB                      76879200
XLDDELLE DS    0H                 ROUTINE ENTRY POINT                   76920400
         SLR   RF,RF                                                    76961600
         L     R5,DFWKALLE                                              77002800
*---------------------------------------------------------------------* 77044000
*     DECREASE USE COUNTS                                             * 77085200
*---------------------------------------------------------------------* 77126400
         USING PLLENTRY,R5        SET BASE FOR LLE                      77167600
         L     RB,PLLEATE         GET RELATED ATE                       77208800
         TM    DFWKSWRQ,AUTHREQ   AUTHORIZED REQUEST                    77250000
         BZ    XLDDE100           NO,  ---------->                      77291200
*      GENSERV COMPDEC,FIELD=PLLESYS,COMPF=XLD00,BC=BE,LAB=XLD8062C     77332400
*                                 DECREASE SYS COUNT IN LLE             77373600
       GENSERV COMPDEC,FIELD=PLLESYS,COMPF=XLD00,BC=BE,LAB=XLD8062C     77414800
         USING ATENTRY,RB         SET BASE FOR ATE                      77456000
*      GENSERV COMPDEC,FIELD=ATLDSYS,COMPF=XLD00,BC=BE,LAB=XLD8062C     77497200
*                                 DECREASE SYS COUNT IN ATE             77538400
       GENSERV COMPDEC,FIELD=ATLDSYS,COMPF=XLD00,BC=BE,LAB=XLD8062C     77579600
         DROP  RB                 RESET BASE FOR ATE                    77620800
XLDDE100 DS    0H                                                       77662000
*      GENSERV DECTEST,FIELD=PLLECNT,COMPF=XLD00,BC=BNE,LAB=XLDDE120    77703200
*                                 DECREASE USE COUNT IN LLE             77744400
       GENSERV DECTEST,FIELD=PLLECNT,COMPF=XLD00,BC=BNE,LAB=XLDDE120    77785600
*     DELETE PLLE  IF PLLECNT = 0                                       77826800
         L     R2,PLLEATHD        GET RELATED ANCHOR TABLE              77847400
         DROP  R5                 RELEASE PLLENTRY                      77847533
         L     RE,CDBASE          BASE OF CDLOAD                        77868000
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              77909200
.*   NOTE: DFWKALLE AND DFWKANCS ARE ACCORDINGLY SET                    77950400
*SGLINK CDDELLE,INPUT=(R8,RA,RE),WORK=(R0,R1,R3-R5,RC),OUTPUT=(RF)      77991600
         BAL   R8,CDDELLE         FREE LLE                              78032800
         L     RE,AMVSXLOD        BASE OF ROUTINE                       78074000
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             78115200
         LTR   RF,RF              FREE LLE                              78156400
         BNZ   XLD8062C           NO,  ==========> 806-2C               78197600
*                                 DUE TO FREEVIS ERROR                  78238800
XLDDE120 DS    0H                                                       78280000
         USING ATENTRY,RB         SET BASE FOR ATE                      78321200
*      GENSERV DECTEST,FIELD=ATLDCNT,COMPF=XLD00,BC=BNE,LAB=(R9)        78362400
*                                 DECREASE USE COUNT IN ATE             78403600
       GENSERV DECTEST,FIELD=ATLDCNT,COMPF=XLD00,BC=BNE,LAB=(R9)        78444800
*     DELETE ATE IF ATLDCNT = 0 AND FREE STORAGE AREA                   78486000
*                                 FREEMAIN                              78527200
.*   NOTE: DFWKAATE IS ALREADY SET TO RELATED ATE                       78568400
.*         BUT IS NECESSARY TO SET DFWKANCS                             78609600
         ST    R2,DFWKANCS        PROVIDE ANCHOR TABLE                  78634600
         TM    ATPHFLG2,ATSVAPHA  PHASE LOCATED IN SVA                  78659600
         BO    XLDDE180           YES, ----------> NO FREEMAIN          78684600
         L     RD,TCBSAVE                                               78709600
         USING SVEARA,RD                                                78774400
         STM   RD,R9,DFCBSAV                                   @D64ADMZ 78826840
         L     RC,TCBATCBE        GET ADDR TCBX                         78853000
         TM    TCBXSAUS-TCBXADR(RC),TCBXXSBU SAVE AREA FREE    @D64ADMZ 78854048
         BZ    XLDDE170          YES                           @D64ADMZ 78855019
         ST    R5,SGXREG5        SAVE R5                       @D64ADMZ 78856019
         BAL   R5,SYSERROR       NO, MUST NOT OCCUR            @D64ADMZ 78857019
XLDDE170 DS    0H                                              @D64ADMZ 78858019
         OI    TCBXSAUS-TCBXADR(RC),TCBXXSBU SAVE AREA USED    @D64ADMZ 78859019
         LA    RC,TCBXXSB-TCBXADR(,RC)                         @D64ADMZ 78879244
         MVC   0(12,RC),SVER0F    SAVE SVER0F - SVER01         @D64ADMZ 78879340
         MVC   12(4,RC),SVEPSW    SAVE PART OF PSW (KEY NEEDED)@D64ADMZ 78879441
         SLR   R6,R6                                                    78931600
         ST    R6,SVER0F          CLEAR OPTION REGISTER                 78957800
         OI    SVER0F+D3,X01      STORAGE REQUEST OF TYPE RELEASE       78984051
         MVC   SVER0F+D2(1),ATSUBPOL PROVIDE SUBPOOL ID                 79010200
         L     R1,ATLOADP         GET LOAD POINT IN GETVIS AREA         79401200
         LRA   R0,0(,R1)          GET REAL ADDR OF LOADPOINT   @D64ADMZ 79401442
         ISKE  R6,R0              GET KEY OF PAGE              @D64ADMZ 79401642
         SRL   R6,4               REM. REF, CHANGE, FTP BITS   @D64ADMZ 79401740
         SLL   R6,4               SHIFT KEY TO CORRECT POS.    @D64ADMZ 79401840
         NI    SVEPSWKY,X0E       PREPARE KEY AND SET SUP STATE@D64ADMZ 79401951
         MVC   XLDPSWKY+3(1),SVEPSWKY                          @D64ADMZ 79402054
         O     R6,XLDPSWKY        SET CORRECT KEY              @D64ADMZ 79402152
         STC   R6,SVEPSWKY        SAVE IN SAVE AREA            @D64ADMZ 79403051
         L     R0,ATPHSLEN        ... LENGTH OF PHASE                   79451200
         STM   R0,R1,SVER00       ...  INTO SAVE AREA                   79501200
         L     R6,XLODSTOR        STORAGE ROUTINE                       79501340
         DROP  RB                                                       79551200
         DROP  RD                 RELEASE SAVE AREA                     80010443
*SGLINK GMFMSVC78,INPUT=(R6,RA),NOMODR=(R6,RA),                        *80036605
               WORK=(R0-R5,R7-R9,RB-RF),OUTPUT=()                       80036705
*        AMODESW CALL,REGS=(R6,R6) CALL STORAGE                         80062800
         AMODESW CALL,REGS=(R6,R6) CALL STORAGE                         80089000
         L     RC,TCBATCBE        GET ADDR TCB EXTENSION       @D64ADMZ 80090019
         NI    TCBXSAUS-TCBXADR(RC),XFF-TCBXXSBU SAVE AREA FREE@D64ADMZ 80100019
         L     RD,TCBSAVE                                      @D64ADMZ 80100143
         USING SVEARA,RD                                       @D64ADMZ 80100243
         L     RF,SVER0F          GET RETURN CODE              @D64ADMZ 80100343
         LA    RC,TCBXXSB-TCBXADR(,RC)                         @D64ADMZ 80101044
         MVC   SVER0F(12),0(RC)   RESTORE SVER0F-SVER01        @D64ADMZ 80102043
         MVC   SVEPSW(4),12(RC)   RESTORE FIRST PART OF PSW    @D64ADMZ 80103043
         LR    RC,RF                                           @D64ADMZ 80104043
         DROP  RD                 RELEASE SAVE AREA            @D64ADMZ 80115319
         LM    RD,R9,DFCBSAV                                            80141443
         MVI   RID+1,REENTRID     RESET RID                             80193800
         LTR   RF,RC              TEST RETURN CODE OF FREEVIS           80220000
         BNZ   XLD8062C           NO, ---------->  HW X'FED'            80246200
XLDDE180 DS    0H                                                       80293100
         L     RE,CDBASE          BASE OF CDLOAD                        80340000
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              80381200
         BAL   R8,CDDELATE        FREE ATE                              80422400
*SGLINK CDDELATE,INPUT=(R8,RA,RE),WORK=(R0-R5,RC),OUTPUT=(RF)           80443000
         L     RE,AMVSXLOD        BASE OF ROUTINE                       80463600
         USING MVSXLOAD,RE        ESTABLISH ADDR TO ROUTINE             80504800
         LTR   RF,RF              FREE ATE                              80546000
         BNZ   XLD8062C           NO,  ==========> 806-2C               80587200
*                                 DUE TO FREEVIS ERROR                  80628400
         BR    R9                      ==========> EXIT CALLER          80710800
         SPACE 2                                                        80752000
*---------------------------------------------------------------------* 80793200
XLD7F    DS    0F                                                       80916800
         DC    XL4'00007FFF'                                            80958000
XLD00    DS    0F                                                       80999200
         DC    XL4'00000000'                                            81040400
XLDPSWKY DS    0F                                                       81040552
         DC    XL4'00000000'      USED FOR OR INSTRUCTION               81040652
         DROP  RA                 RELEASE BASE FOR TCB                  81081600
         DROP  RE                 RELEASE BASE FOR MODULE               81122800
         EJECT                                                          81164000
*---------------------------------------------------------------------* 81205200
*  MODULE  NAME: XLDXRETC                                               81246400
*  FUNCTION:  TRANSLATE VSE RETURN CODE INTO MVS RETURN CODE            81328800
*  AMODE:     MODE OF REQUESTOR                                         81411200
*  MODE:      PRIMARY                                                   81493600
*  ENTRY POINT: XLDXRETC                                                81576000
*  LINKAGE:                                                             81658400
*             BAL  R9,XLDXRETC                                          81699600
*  INPUT:    R0 :    TASK ID / 0 FOR BLDL                               81782000
*            R9 :    RETURN ADDRESS                                     81823200
*            RA :    ADDRESS OF TCB                                     81864400
*            RE :    BASE OF ROUTINE                                    81905600
*  OUTPUT:   RF :    RETURN CODE                                        81988000
*  EXIT:            IF FUNCTION OK, THEN RETURN TO CALLER               82070400
*  ERROR EXIT:      RELATED ERROR EXIT                                  82111600
*---------------------------------------------------------------------* 82152800
         SPACE 2                                                        82194000
*SGLINK XLDXRETC,S,INPUT=(R0,R9,RA,RE),WORK=(R4),OUTPUT=(RF)            82235200
XLDXRETC DS    0H                                                       82276400
         USING MVSXLOAD,RE        SET BASE FOR ROUTINE                  82317600
         USING TCBADR,RA          SET BASE FOR TCB                      82358800
         LA    R4,XLDTRBLD        BLDL SERVICE XTAB                     82400000
         LTR   R0,R0              BLDL SERVICE                          82441200
         BZ    XRETC100           YES, ---------->                      82482400
         LA    R4,XLDTRDIR        DIRECTORY SEARCH XTAB                 82523600
         CH    R0,XTIBDIRS        DIRECTORY SEARCH                      82564800
         BE    XRETC100           YES, ---------->                      82606000
         LA    R4,XLDTRPGM        PROGRAM FETCH XTAB                    82647200
XRETC100 DS    0H                                                       82688400
         L     RF,DFWKRETC        VSE ERROR CODE                        82729600
         ALR   R4,RF                                                    82770800
         L     R4,0(,R4)                                                82812000
         LTR   R4,R4              ANY MVS ERROR EXIT                    82853200
         BZR   R9                 NO,  ==========> EXIT CALLER          82894400
         BR    R4                 YES, ==========> EXIT ERROR           82935600
         DROP  RA                 RESET BASE FOT TCB                    82976800
         SPACE 1                                                        83018000
*---------------------------------------------------------------------* 83059200
         SPACE 2                                                        83100400
XLDTRBLD DS    0F                                                       83141600
         DC    A(0)         OK                                          83182800
         DC    A(0)         OK    RC = 4  --->  PHASE NOT FOUN          83224000
         DC    A(XBL00800)        RC = 8  --->  I/O ERROR               83265200
         DC    A(XBL00820)        RC =12  --->  INVALID LIB STR         83306400
         DC    A(XBL00824)        RC =16  --->  INVALID ADDRESS         83347600
         DC    A(XBL0082C)        RC =20  --->  INTERNAL ERROR          83388800
         DC    A(XBL0082C)        RC =24  --->  INTERNAL ERROR          83430000
         DC    A(XBL0082C)        RC =28  --->  INTERNAL ERROR          83471200
         DC    A(XBL0082C)        RC =32  --->  INTERNAL ERROR          83512400
         DC    A(XBL0082C)        RC =36  --->  INTERNAL ERROR          83553600
         DC    A(XBL00800)        RC =40  --->  RBA OUTSIDE EXT         83594800
         DC    A(XBL0082C)        RC =44  --->  INTERNAL ERROR          83636000
         DC    A(0)               RC =48  --->  RESERVED                83677200
*---------------------------------------------------------------------* 83718400
XLDTRDIR DS    0F                                                       83759600
         DC    A(0)                                                     83800800
         DC    A(XLD80604)        RC = 4  --->  PHASE NOT FOUN          83842000
         DC    A(XLD80608)        RC = 8  --->  I/O ERROR               83883200
         DC    A(XLD106E1)        RC =12  --->  INVALID LIB STR         83924400
         DC    A(XLD206C0)        RC =16  --->  INVALID ADDRESS         83965600
         DC    A(XLD8062C)        RC =20  --->  INTERNAL ERROR          84006800
         DC    A(XLD8062C)        RC =24  --->  INTERNAL ERROR          84048000
         DC    A(XLD8062C)        RC =28  --->  INTERNAL ERROR          84089200
         DC    A(XLD8062C)        RC =32  --->  INTERNAL ERROR          84130400
         DC    A(XLD8062C)        RC =36  --->  INTERNAL ERROR          84171600
         DC    A(XLD80608)        RC =40  --->  RBA OUTSIDE EXT         84212800
         DC    A(XLD8062C)        RC =44  --->  INTERNAL ERROR          84254000
         DC    A(0)               RC =48  --->  RESERVED                84295200
*---------------------------------------------------------------------* 84336400
XLDTRPGM DS    0F                                                       84377600
         DC    A(0)                                                     84418800
         DC    A(XLD10628)        RC = 4  --->  PHASE NOT FOUN          84460000
         DC    A(XLD106F1)        RC = 8  --->  I/O ERROR               84501200
         DC    A(XLD106E1)        RC =12  --->  INVALID LIB STR         84542400
         DC    A(XLD1060B)        RC =16  --->  INVALID ADDRESS         84583600
         DC    A(XLD10628)        RC =20  --->  SECURITY                84624800
         DC    A(XLD10628)        RC =24  --->  INTERNAL ERROR          84666000
         DC    A(XLD106C2)        RC =28  --->  NO STORAGE              84707200
         DC    A(XLD10628)        RC =32  --->  INTERNAL ERROR          84748400
         DC    A(XLD1060B)        RC =36  --->  RMODE VIOLAT            84789600
         DC    A(XLD106E2)        RC =40  --->  RBA OUTSIDE EXT         84830800
         DC    A(XLD106E3)        RC =44  --->  RLD OUTSIDE TXT         84872000
         DC    A(0)               RC =48  --->  RESERVED                84913200
*---------------------------------------------------------------------* 84954400
XTIBDIRS DC    H'08'              TASKID OF DIRECTORY SEARCH            84995600
XTIBPGMF DC    H'07'              TASKID OF PROGRAM FETCH               85036800
*---------------------------------------------------------------------* 85078000
SGXREG5  DC    F'0'              ORIGINAL CONTENTS OF R5       @D64ADMZ 85079019
         DS    0F                                                       85119200
XLODSTOR DC    A(GMFMSVC78+X'80000000')                                 85294300
         DROP  RE                 RELEASE BASE FOR MODULE               85325200
         EJECT                                                          85366400
*---------------------------------------------------------------------* 85407600
*     ERROR EXITS                                                     * 85448800
*---------------------------------------------------------------------* 85490000
         USING MVSXLOAD,RE        BASE FOR ERROR EXITS                  85531200
         USING TCBADR,RA          BASE FOR TCB                          85572400
XBL00800 DS    0H                                                       85613600
         LA    R0,XERBLIO(,0)     ERROR INDICATOR   008-00              85654800
         B     XLDSERRX           ERROR DURING BLDL                     85696000
*---------------------------------------------------------------------* 85737200
XBL0081C DS    0H                                                       85778400
         LA    R0,XERBLDE(,0)     ERROR INDICATOR   008-1C              85819600
         B     XLDSERRX           ERROR DURING BLDL                     85860800
*---------------------------------------------------------------------* 85902000
XBL00820 DS    0H                                                       85943200
         LA    R0,XERBLLB(,0)     ERROR INDICATOR   008-20              85984400
         B     XLDSERRX           ERROR DURING BLDL                     86025600
*---------------------------------------------------------------------* 86066800
XBL00824 DS    0H                                                       86108000
         LA    R0,XERBLAD(,0)     ERROR INDICATOR   008-24              86149200
         B     XLDSERRX           ERROR DURING BLDL                     86190400
*---------------------------------------------------------------------* 86231600
XBL0082C DS    0H                                                       86272800
         LA    R0,XERBLIN(,0)     ERROR INDICATOR   008-2C              86314000
         B     XLDSERRX           ERROR DURING BLDL                     86355200
*---------------------------------------------------------------------* 86396400
XLD1060B DS    0H                                                       86437600
         LA    R0,XERPGMF(,0)     ERROR INDICATOR   106-0B              86478800
         B     XLDSERRX           ERROR DURING PGM FETCH                86520000
*---------------------------------------------------------------------* 86561200
XLD106C1 DS    0H                                                       86602400
         LA    R0,XEXHSCB(,0)     ERROR INDICATOR   106-0C              86643600
         B     XLDSERRX           NO  STORAGE FOR CB-S                  86684800
*---------------------------------------------------------------------* 86726000
XLD106C2 DS    0H                                                       86767200
         LA    R0,XEXHPHA(,0)     ERROR INDICATOR   106-0C              86808400
         B     XLDSERRX           NO STORAGE FOR PHASE                  86849600
*---------------------------------------------------------------------* 86890800
XLD106C3 DS    0H                                                       86932000
         LA    R0,XNOTFIX(,0)     ERROR INDICATOR   106-0C              86973200
         B     XLDSERRX           NOT FIXED                             87014400
*---------------------------------------------------------------------* 87055600
XLD106E1 DS    0H                                                       87096800
         LA    R0,XINVLBK(,0)     ERROR INDICATOR   106-0E              87138000
         B     XLDSERRX           INV LIB STRUCTURE                     87179200
*---------------------------------------------------------------------* 87220400
XLD106E2 DS    0H                                                       87261600
         LA    R0,XINVRBA(,0)     ERROR INDICATOR   106-0E              87302800
         B     XLDSERRX           INV RBA                               87344000
*---------------------------------------------------------------------* 87385200
XLD106E3 DS    0H                                                       87426400
         LA    R0,XINVRLD(,0)     ERROR INDICATOR   106-0E              87467600
         B     XLDSERRX           INV RLD                               87508800
*---------------------------------------------------------------------* 87550000
XLD106F1 DS    0H                                                       87591200
         LA    R0,XIOPHAS(,0)     ERROR INDICATOR   106-0F              87632400
         B     XLDSERRX           I/O ERROR DURING PGM FETCH            87673600
*---------------------------------------------------------------------* 87714800
XLD106F2 DS    0H                                                       87756000
         LA    R0,XINVEXT(,0)     ERROR INDICATOR   106-0F              87797200
         B     XLDSERRX           INVALID EXTENT                        87838400
*---------------------------------------------------------------------* 87879600
XLD10628 DS    0H                                                       87920800
         LA    R0,XIEPGMF(,0)     ERROR INDICATOR   106-10              87962000
         B     XLDSERRX           INTERNAL ERROR IN PGM FETCH           88003200
*---------------------------------------------------------------------* 88044400
XLD20604 DS    0H                                                       88085600
         LA    R0,XCONFLO(,0)     ERROR INDICATOR   206-04              88126800
         B     XLDSERRX           CONFLICTING OPTIONS                   88168000
*---------------------------------------------------------------------* 88209200
XLD20608 DS    0H                                                       88250400
         LA    R0,XGLAUTH(,0)     ERROR INDICATOR   206-08              88291600
         B     XLDSERRX           GLOBAL BY UNAUTHORIZED REQ.           88332800
*---------------------------------------------------------------------* 88374000
XLD2060C DS    0H                                                       88415200
         LA    R0,XADAUTH(,0)     ERROR INDICATOR   206-0C              88456400
         B     XLDSERRX           ADDR/ADRNAPF BY UNAUTHORIZED          88497600
*---------------------------------------------------------------------* 88538800
XLD20618 DS    0H                                                       88580000
         LA    R0,XNODADR(,0)     ERROR INDICATOR   206-18              88621200
         B     XLDSERRX           LOAD ADDRESS NOT ON D                 88662400
*---------------------------------------------------------------------* 88703600
XLD20620 DS    0H                                                       88744800
         LA    R0,XINVOPT(,0)     ERROR INDICATOR   206-20              88786000
         B     XLDSERRX           INVALID MACRO LEVEL                   88827200
*---------------------------------------------------------------------* 88868400
XLD206C0 DS    0H                                                       88909600
         LA    R0,XKEYPAR(,0)     ERROR INDICATOR   206-C0              88950800
         B     XLDSERRX           INVALID KEY OF PARAMETER              88992000
*---------------------------------------------------------------------* 89033200
XLD206C4 DS    0H                                                       89074400
         LA    R0,XKEYDEN(,0)     ERROR INDICATOR   206-C4              89115600
         B     XLDSERRX           INVALID KEY OF DE                     89156800
*---------------------------------------------------------------------* 89198000
XLD206C8 DS    0H                                                       89239200
         LA    R0,XKEYDCB(,0)     ERROR INDICATOR   206-C8              89280400
         B     XLDSERRX           INVALID KEY OF DCB                    89321600
*---------------------------------------------------------------------* 89362800
XLD206CC DS    0H                                                       89404000
         LA    R0,XINVDEN(,0)     ERROR INDICATOR   206-CC              89445200
         B     XLDSERRX           PASSED DE INVALID                     89486400
*---------------------------------------------------------------------* 89560400
XLD30604 DS    0H                                                       89568800
         LA    R0,XGLNAPF(,0)     ERROR INDICATOR   306-04              89610000
         B     XLDSERRX           GLOBAL FOR PHASE IN NON APF           89651200
*                                        PROTECTED LIBRARY              89692400
*---------------------------------------------------------------------* 89733600
XLD30608 DS    0H                                                       89774800
         LA    R0,XGLNSVA(,0)     ERROR INDICATOR   306-08              89816000
         B     XLDSERRX           GLOBAL FOR NON REENTRANT PH           89857200
*---------------------------------------------------------------------* 89898400
XLD3060C DS    0H                                                       89939600
         LA    R0,XAUNAPF(,0)     ERROR INDICATOR   306-0C              89980800
         B     XLDSERRX           AUTHORIZED REQ FOR PHASE IN           90022000
*                                 NON APF PROTECTED LIBRARY             90063200
*---------------------------------------------------------------------* 90104400
XLD30624 DS    0H                                                       90145600
         LA    R0,XAUNSVA(,0)     ERROR INDICATOR   306-24              90186800
         B     XLDSERRX           AUTHORIZED REQUEST FOR                90228000
*                                 NON REENTRANT PHASE                   90269200
*---------------------------------------------------------------------* 90310400
XLD80604 DS    0H                                                       90351600
         TM    DFWKSWRQ,PLLEFND   NON SVA ELIGIBLE PHASE FOUND          90392800
         BO    XLD30624           YES, ---------->  306-24              90434000
         LA    R0,XPHANFD(,0)     ERROR INDICATOR   806-04              90475200
         B     XLDSERRX           PHASE NOT FOUND                       90516400
*---------------------------------------------------------------------* 90557600
XLD80608 DS    0H                                                       90598800
         LA    R0,XIODIRS(,0)     ERROR INDICATOR   806-08              90640000
         B     XLDSERRX           I/O ERROR DURING DIR READ             90681200
*---------------------------------------------------------------------* 90722400
XLD8060C DS    0H                                                       90763600
         LA    R0,XDCBNOP(,0)     ERROR INDICATOR   806-0C              90804800
         B     XLDSERRX           NO OPEN DCB                           90846000
*---------------------------------------------------------------------* 90887200
XLD80610 DS    0H                                                       90928400
         LA    R0,XADNDCB(,0)     ERROR INDICATOR   806-10              90969600
         B     XLDSERRX           ADDR BUT NO DCB SPECIFIED             91010800
*---------------------------------------------------------------------* 91052000
XLD8062C DS    0H                                                       91093200
         LA    R0,XIEDIRS(,0)     ERROR INDICATOR   806-2C              91134400
*                                 INTERNAL ERROR DIRECT. SEARCH         91175600
         B     XLDSERRX                                                 91216800
*---------------------------------------------------------------------* 91258000
XLD90604 DS    0H                                                       91299200
         LA    R0,XLLEUSE(,0)     ERROR INDICATOR   906-04              91340400
         B     XLDSERRX           LLE USE COUNT OVERFLOW                91381600
*---------------------------------------------------------------------* 91422800
XLD90608 DS    0H                                                       91464000
         LA    R0,XATEUSE(,0)     ERROR INDICATOR   906-08              91505200
         B     XLDSERRX           ATE USE COUNT OVERFLOW                91546400
*---------------------------------------------------------------------* 91587600
XLDD0600 DS    0H                                                       91628800
         LA    R0,XGLBINC(,0)     ERROR INDICATOR   D06-00              91670000
         B     XLDSERRX           GLOBAL INCONSISTANCY                  91711239
*---------------------------------------------------------------------* 91752400
XLD2C5201 DS    0H                                                      91752539
         LA    R0,XINSAUT(,0)     ERROR INDICATOR   2C5-201             91752639
*----->  B     XLDSERRX           INSUFFICIENT AUTHORITY                91752739
*---------------------------------------------------------------------* 91752839
         SPACE 2                                                        91793600
*---------------------------------------------------------------------* 91834800
XLDSERRX DS    0H                                                       91876000
         NI    DFWKSWRQ,XFF-MORESRCH RESET CONTINUE SEARCH              91917200
         L     RB,AFCHDAT                                               91958400
         USING DFCB,RB            SET BASE FOR SGAFCH                   91999600
         L     RF,AXLODERX        GET BASE OF ERROR ROUTINE             92040800
*SGLINK XLODERRT,INPUT=(R0,RA,RF),WORK=(),OUTPUT=()                     92082000
         BR    RF                 ==========>                           92123200
*---------------------------------------------------------------------* 92164400
         DROP  RB                 RESET BASE FOR SGAFCH                 92205600
         DROP  RE                 RESET BASE FOR SGXFCH                 92246800
         EJECT                                                          92288027
*---------------------------------------------------------------------* 92289027
*  ROUTINE NAME: MVSBLDL                                                92290027
*  ROUTINE PROLOGUE                                                     92300027
*        'VSE/ESA SERVICES FOR MVS PLATFORM: BLDL                       92310027
*                                                                       92320027
*  FUNCTION:                                                            92321027
*     -  SIMULATES MVS-BLDL                                             92322027
*                                                                       92323027
*  CALLED VIA:                                                          92324027
*     - BLDL   MACRO EXPANSION (MVS SVC CODE X'12')                     92325027
*                                                                       92326027
*  AMODE = ANY                                                          92327027
*                                                                       92328027
*  MODE  = PRIMARY                                                      92329027
*                                                                       92329127
*  ENTRY POINT = MVSXBLDL                                               92329227
*                                                                       92329327
*  LINKAGE:  VIA SVC INTERRUPT HANDLER                                  92329427
*                                                                       92329527
*  INPUT:                                                               92329627
*            R0  =   ADDRESS OF PHASE-LIST                              92329727
*            R1  =   ADDRESS OF LBDCB                                   92329827
*            R6  =   ADDRESS OF DISPATCHER                              92329927
*            RA  =   ADDRESS OF TCB                                     92330027
*            RC  =   ENTRY POINT OF BLDL ROUTINE                        92331027
*            RF  =   OPTIONS (NOT USED BY VSE)                          92332027
*                    0  -  CONNECT PDSE                                 92333027
*                    8  -  NOCONNECT PDSE                               92334027
*                                                                       92335027
*  OUTPUT:                                                              92336027
*            R15 =   RETURN CODE                                        92337027
*                    = 0: SUCCESSFUL COMPLETION                         92338027
*                    /=0: REQUEST NOT SATISFIED                         92339027
*                    R15 CONTAINS RETURN CODE                           92339127
*                    R0  CONTAINS REASON CODE                           92339227
*                                                                       92339327
*  EXIT: RETURN TO DISPMVS                                              92339427
*                                                                       92339527
*  REGISTER USAGE :                                                     92339627
*      RE  :  BASE REGISTER                                             92339727
*                                                                       92339827
*  ERROR EXIT: -                                                        92339927
*                                                                       92340027
*  CHANGE ACTIVITIES:                                                   92341027
*     NEW FOR VSE/ESA 2.4.0                                             92342027
*                                                                       92343027
* A000000-999999                                                        92344027
*                                                                       92345027
*---------------------------------------------------------------------* 92346027
*                                                                       92347027
*  INTERNAL SUBROUTINES USED:                                           92348027
*        CDLGCLOS   -   OCCUPY CDLOAD GATE                              92349027
*        CDLGOPEN   -   FREE CDLOAD GATE                                92349127
*        XLDFIATE   -   SEARCH LLE                                      92349227
*        XLDVALID   -   VALIDATE PARAMETER                              92349327
*        XLDDELLE   -   UPDATE USE COUNTERS, FREE AREAS                 92349427
*---------------------------------------------------------------------* 92349527
         SPACE 2                                                        92349627
         USING TCBADR,RA          SET BASE TO TCB                       92349727
         USING SVEARA,RB          SET BASE TO USER'S SA                 92349827
         SPACE 1                                                        92349927
         DS    0D                 SERVICE ENTRE                         92350027
         DC    CL8'MVSBLDL '      EYECATCHER                            92351027
         DC    CL8'11/07/96'                                            92352027
         SPACE 1                                                        92353027
MVSXBLDL DS    0H                 SERVICE ENTRY POINT                   92354027
         STM   RE,R1,DFCBSAV+OFSXRE SAVE USER'S REGS                    92355027
         LR    RE,RC              GET BASE OF BLDL ROUTINE     @D64ADMZ 92356027
         USING MVSXBLDL,RE                                     @D64ADMZ 92357027
         LR    R1,R0              SAVE ADDR OF BLDL LIST                92358027
         LA    R0,XMACBLDL        PROVIDE ....                          92359027
         ST    R0,DFCBMACN        ....    CURRENT MACRO NAME            92359127
         XC    DFWKUSEN(DFWKX1LN+DFWKPLEN),DFWKUSEN                     92359227
         MVI   DFWKRQFM,MVSBLDL   REQUEST: MVS-BLDL                     92359327
         OI    DFWKOPT1,DFWKERET  ERRET SPECIFIED                       92359427
         SLR   R0,R0              SET 24-BIT MODE                       92359527
         ST    R0,DFWKRTUR        RESET                                 92359627
         ST    R0,DFCBSAV+OFSXRF  ...                                   92359727
*---------------------------------------------------------------------* 92359827
*     VALIDATION OF PROVIDED AREAS                                    * 92359927
*---------------------------------------------------------------------* 92360027
         TM    TCBEXFLG,TCBEXAM   REQUESTOR IN 31-BIT MODE              92361027
         BZ    XBLDL100           NO, ---------->                       92362027
         O     R0,BIT0OMSK        SET 31-BIT MODE                       92363027
XBLDL100 DS    0H                                                       92364027
*        AMODESW SET,AMODE=(R0),WR=(RF) RUN IN MODE OF REQUESTOR        92365027
         AMODESW SET,AMODE=(R0),WR=(RF) RUN IN MODE OF REQUESTOR        92366027
*     VALIDATION OF BLDL ENTRY ADDRESS                                  92367027
         USING BLDLLIST,R1        SET BASE FOR BLDLLIST                 92368027
         LA    R1,0(,R1)          CLEAR HIGH ORDERED BIT/BYTE           92369027
*                                 R1 IS LOW ADDRESS                     92369127
         LA    R2,3(,R1)          END ADDRESS TO BE VALIDATED  @D64ADMZ 92369227
         LA    R0,XERBLIN(,0)     ERROR INDICATOR  008-24      @D64ADMZ 92369327
         L     RE,AMVSXLOD        BASE OF MVSXLOAD -MODULE     @D64ADMZ 92369427
         USING MVSXLOAD,RE        SET BASE OF ROUTINE          @D64ADMZ 92369527
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           92369627
         BAL   R9,XLDVALID        VALIDATE BLDL ADDRESS                 92369727
*     VALIDATION OF BLDL ENTRY LENGTH                                   92370027
         LA    R3,BLDLEXLN                                              92370127
         CH    R3,BLDLLEN         BLDLE SUFFICIENT LENGTH               92370227
         BH    XBL0081C           LOWER, ========> 008-1C               92370327
*     VALIDATION OF BLDL-LIST                                           92370527
         LH    R2,BLDLNUM         NUMBER OF ENTRIES                     92370627
         MH    R2,BLDLLEN         ... * LENGTH OF ENTRY                 92370727
         LA    R2,BLDLHDL-1(R1,R2) .. + LENGTH-1 OF HEADER              92370827
*                                 ... + START OF LIST                   92370927
*                                 ... = HIGH ADDRESS                    92371027
         DROP  R1                 RELEASE BASE FOR BLDLLIST             92371127
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           92371427
         BAL   R9,XLDVALID        BLDL LIST                             92371527
*                                 CONTINUE IF O.K.                      92371627
         L     RE,AMVSBLDL        GET ROUTINE BASE             @D64ADMZ 92371727
         USING MVSXBLDL,RE        SET BASE OF ROUTINE          @D64ADMZ 92371827
*                                                                       92371927
*     VALIDATION OF DCB PARAMETER                                       92372027
         L     R1,DFCBSAV+OFSXR1  LOW ADDRESS OF PARAMETER              92372127
         LTR   R1,R1              DCB PROVIDED                          92372227
         BZ    XBLD0100           NO,  ---------->                      92372327
         ST    R1,DFWKADCB        PROVIDE ADDR OF LIBR-DCB              92372427
         CL    R1,F1              DCB=1 IS USED TO INDICATE NON@D64ADMZ 92372527
*                                 DCB SEARCH CHAIN (CICS I/F)  @D64ADMZ 92372627
         BE    XBLD0100           SKIP VALID., ADDR IS INVALID @D64ADMZ 92372727
         LA    R0,XERBLDC(,0)     ERROR INDICATOR  008-28               92372827
         LA    R2,IALCLEN-1(,R1)  END ADDRESS FOR DCB                   92372927
         L     RE,AMVSXLOD        BASE OF MVSXLOAD -MODULE     @D64ADMZ 92373027
         USING MVSXLOAD,RE        SET BASE OF ROUTINE          @D64ADMZ 92373127
*SGLINK XLDVALID,INPUT=(R0,R1,R2,R9,RA,RE),WORK=(R2,R5,R6,R8)           92373227
         BAL   R9,XLDVALID        VALIDATE DCB                          92373327
*                                 CONTINUE IF O.K.                      92373427
         L     RE,AMVSBLDL        GET ROUTINE BASE             @D64ADMZ 92373527
         USING MVSXBLDL,RE        SET BASE OF ROUTINE          @D64ADMZ 92373627
         OI    DFWKSWRQ,DCBSRCH   SPECIFY DE-SEARCH VIA DCB    @D64ADMZ 92373727
XBLD0100 DS    0H                                                       92373827
*        AMODESW  SET,AMODE=31,WR=(R3)  GET AMODE 31                    92373927
         AMODESW  SET,AMODE=31,WR=(R3)                                  92374027
         SPACE 1                                                        92374127
*---------------------------------------------------------------------* 92374227
*     COPY PARAMETERS INTO TCB.FCHWORK AND PROVIDE STATUS OF REQUEST  * 92374327
*---------------------------------------------------------------------* 92374427
         OI    DFWKSWRQ,DENOTXT+GIVRETRC                                92374527
*              SPECIFY DE-SEARCH AND RETURN CODE                        92374627
         CLC   TID,ARTIDH         SYSTEM TASK                  @D66ODOW 92374759
         BNL   XBLDL120           NO,  ---------->                      92374927
         OI    DFWKSWRQ,SYSAMASK+AUTHREQ   SYSTEM TASK                  92375027
XBLDL120 DS    0H                                                       92375127
         L     R0,CRADDR          ADDR OF CURRENT COMREG                92375227
         ST    R0,DFWKCOMG        ....                                  92375327
         LM    R4,R5,DFCBSAV+OFSXR0 GET USER'S REGS                     92375427
         USING BLDLLIST,R4        SET BASE FOR BLDLLIST                 92375527
         LA    RC,BLDLHDL(,R4)    ADDR OF FIRST DE OF LIST              92375627
         SPACE 1                                                        92375727
         OI    DFWKOPT1,DFWKERET  ERRET SPECIFIED                       92375827
*---------------------------------------------------------------------* 92375927
*     PROCESS BLDL LIST                                               * 92376027
*---------------------------------------------------------------------* 92376127
         SPACE 1                                                        92376227
         SL    RC,XSDLELNG        ADJUST FOR LOOP                       92376327
*        GENSERV TEST,FIELD=BLDLNUM,LAB=XBLDEXIT,BC=BZ,REG=(RD)         92376427
         GENSERV TEST,FIELD=BLDLNUM,LAB=XBLDEXIT,BC=BZ,REG=(RD)         92376527
         DROP  R4                 RELEASE BASE FOR BLDLLIST             92376627
         LA    R1,DFWKPHNM        ADDR PARAMETER LIST                   92376727
         LA    R2,DFWKNAME        POINT TO DIR ENTRY                    92376827
         ST    R2,DFWKPHNM        STORE POINTER TO DIR ENTRY            92376927
         ST    R2,DFWKANAM        STORE POINTER TO DIR ENTRY            92377027
XBLDLOOP DS    0H                                                       92377127
         NI    DFWKSWRQ,XFF-MORESRCH                                    92377227
         AL    RC,XSDLELNG        ADDR OF NEXT DE                       92377327
         MVI   DFWKFLAG,DENTRY+NTXTNTRY+SDLFORM+FLRETCOD                92377427
         MVC   DFWKNAME(L'DFWKNAME),0(RC) GET PHASE NAME                92377527
*                                        TXT=NO AND SDL-FORMAT          92377627
XBLD0170 DS    0H                                                       92377727
         XC    DFWKEGEN(SDLELEN-L'DFWKNAME),DFWKEGEN                    92377827
*                                 CLEAR REST OF ENTRY                   92377927
         XC    L'DFWKNAME(BLDLEXLN-L'DFWKNAME,RC),L'DFWKNAME(RC)       *92378027
                                  CLEAR BLDL-ENTRY                      92378127
         MVI   DFWKESWT,HEX00     CLEAR DIRECTORY ENTRY STATUS          92378227
*        GENSERV DEBUG,FIELD=FCHENTRY                                   92378327
         GENSERV DEBUG,FIELD=FCHENTRY                                   92378427
         L     RE,CDBASE          BASE OF CDLOAD                        92378527
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              92378627
*SGLINK CDLFTCH,INPUT=(R0,R6,R8,RA,RE),WORK=(R1,R3,R4,R5,R7,R9,RB,RF)   92378727
         BAL   R8,CDLFTCH         GET SDLE-LIKE ENTRY                   92378827
         L     RE,AMVSXLOD        BASE OF MVSXLOAD -MODULE     @D64ADMZ 92378927
         USING MVSXLOAD,RE        SET BASE OF ROUTINE          @D64ADMZ 92379027
*     CHECK FOR ABEND CONDITION                                         92379127
         SLR   R0,R0              BLDLE INDICATION                      92379227
*SGLINK XLDXRETC,INPUT=(R0,R9,RA,RF),WORK=(R4),OUTPUT=()                92379327
         BAL   R9,XLDXRETC        TEST ON ERROR CONDITIONS              92379427
*                                 EXIT IN ERROR CASE                    92379527
         L     RE,AMVSBLDL        BASE OF BLDL ROUTINE         @D64ADMZ 92379627
         USING MVSXBLDL,RE        SET BASE OF ROUTINE          @D64ADMZ 92379727
         LTR   RF,RF              ALL OK,                               92379827
         BZ    XBLD0180           YES, --------->                       92379927
*     SPECIAL ACTION FOR PHASE NOT FOUND  RC=4                          92380027
         XC    DFWKALIB(8),DFWKALIB CLEAR ADDR LIB/SLIB DEFTAB          92380127
         ST    RF,DFCBSAV+OFSXRF  SAVE RETURN CODE                      92380227
         B     XBLD0300                ---------->                      92380327
XBLD0180 DS    0H                                                       92380427
         OI    DFWKSWRQ,MORESRCH                                        92380527
*     BUILD BLDLE / MVS SIMULATION + SDL FORMAT                         92380627
         USING PDS2,RC            SET ADDR TO BLDE/MVS-PART             92380727
         MVI   PDS2TTRP+2,XFF     INDICATE ENTRY FOUND                  92380827
         OI    PDS2ATR1,PDS2EXEC  SET EXECUTABLE INDICATION             92380927
         TM    DFWKESWT,SDLEBSE+SDLESVPF SVA ELIGIBLE PHASE             92381027
         BZ    XBLD0190           NO,  ---------->                      92381127
         OI    PDS2ATR1,PDS2RENT  SET REENTERABLE INDICATION            92381227
XBLD0190 DS    0H                                                       92381327
         L     R4,DFWKEPLN        PHASE LENGTH                          92381427
         STCM  R4,B'0111',PDS2STOR ... INTO BLDLE                       92381527
         IC    R4,DFWKEMVS        GET RMODE/AMODE                       92381627
         SRL   R4,1               ...                                   92381727
         LR    R9,R4              ...                                   92381827
         SRL   R9,2               ... ON BLDLE POSITION                 92381927
         OR    R4,R9              ...                                   92382027
         N     R4,XBLDLERA        ...                                   92382127
         STC   R4,PDS2FTB2        AND SAVE IT                           92382227
         TM    DFWKSWRQ,DCBSRCH   DCB PROVIDED                          92382327
         BO    XBLD0210           YES, ---------->                      92382427
         LA    R4,PDS2LLNK(,0)    SYSLIB INDICATION                     92382527
         TM    DFWKESWT,SDLEBPC   ON SYSLIB                             92382627
         BZ    XBLD0200           YES, ---------->                      92382727
         LA    R4,PDS2LJOB(,0)    JOB / PARTITION CHAIN INDICATION      92382827
XBLD0200 DS    0H                                                       92382927
         STC   R4,PDS2LIBF        PROVIDE LIBARRY INDICATION            92383027
XBLD0210 DS    0H                                                       92383127
         L     R4,DFWKEEPL        ENTRY POINT AT LINKEDIT TIME          92383227
         SL    R4,DFWKELPL        - LOAD POINT AT LINKEDIT              92383327
         STCM  R4,B'0111',PDS2EPA = OFFSET OF ENTRY POINT               92383427
         DROP  RC                 RESET ADDR TO BLDE/MVS-PART           92383527
         MVC   BLDLEMVS(SDLELEN,RC),DFWKNAME  PROVIDE SDLE PART        *92383627
                                  ...   INTO USER'S PHASE LIST          92383727
XBLD0300 DS    0H                                                       92383827
         BCT   RD,XBLDLOOP        MORE TO DO, ---------->               92383927
         SPACE 2                                                        92384027
*---------------------------------------------------------------------* 92384127
*     EXIT CODE                                                       * 92384227
*---------------------------------------------------------------------* 92384327
         SPACE 1                                                        92384427
XBLDEXIT DS    0H                                                       92384527
         SLR   R1,R1                                                    92384627
         L     RF,DFCBSAV+OFSXRF  GET RETURN CODE   (0/4)               92384727
         SLR   R0,R0              REASON CODE       (0)                 92384827
         L     RB,TCBSAVE         ADDR OF REQUESTOR'S SA                92384927
         USING SVEARA,RB          BASE FOR SA                           92385027
         STM   RF,R0,SVER0F       PROVIDE SYSTEM ABEND                  92385127
*                                 ...     REASON CODE                   92385227
         DROP  RB                 RELEASE BASE FOR USER SA              92385327
         USING DISP,R6            SET BASE FOR DISPATCHER               92385427
         LA    RF,DISPMVS                                               92385527
         DROP  R6                 RELEASE BASE FOR DISPATCHER           92385627
*        AMODESW RETURN,REG=(RF)  ==========> EXIT DISPATCHER           92385727
         AMODESW RETURN,REG=(RF)                                        92385827
         SPACE 2                                                        92385927
*---------------------------------------------------------------------* 92386027
XSDLELNG DC    A(BLDLEXLN)        LENGHT OF BLDL ENTRY (VSE ADAPTION)   92386127
XMACBLDL DC    CL8'BLDL'                                                92386227
XBLDLERA DC    XL4'00000013'                                            92386327
         DROP  RA                 RELEASE BASE FOR TCB                  92386427
         DROP  RE                 RELEASE BLDL ROUTINE BASE             92386527
         EJECT                                                          92386627
*---------------------------------------------------------------------* 92387000
*  MODULE  NAME: XLODERRT                                               92390000
*  FUNCTION:  ERROR EXIT ROUTINE FOR MVS PLATFORM                       92452800
*  AMODE:     MODE OF REQUESTOR                                         92535200
*  MODE:      PRIMARY                                                   92617600
*  ENTRY POINT:                                                         92700000
*  LINKAGE:   VIA BRANCH                                                92782400
*  INPUT:                                                               92864800
*            R0  =   ERROR INDICATION                                   92906000
*            RA  =   ADDRESS OF TCB                                     92947200
*            RF  =   BASE                                               92988400
*  OUTPUT:    -                                                         93112000
*  EXIT:   OK    -  RETURN TO CALLER                                    93194400
*          ERROR -  ERROR EXIT ROUTINE                                  93235600
*---------------------------------------------------------------------* 93276800
         SPACE 2                                                        93318000
XLODERRT DS    0H                                                       93359200
         USING XLODERRT,RF        ADDRESSABILITY OF BASE                93400400
         USING TCBADR,RA          ADDRESSABILITY OF TCB                 93400528
*        GENSERV DEBUG,FIELD=FCHEXIT                                    93441600
         GENSERV DEBUG,FIELD=FCHEXIT                                    93482800
*---------------------------------------------------------------------* 93524000
*     OPEN CDLOAD GATE                                                * 93565200
*---------------------------------------------------------------------* 93606400
         L     R6,DISPAD          GET DISPATCHER BASE                   93647600
         LR    RD,RF              SAVE RF                               93688800
         L     RE,CDBASE          BASE OF CDLOAD                        93730000
         USING CDLOAD,RE          ESTABLISH ADDR TO CDLOAD              93771200
         BAL   R8,CDLGOPEN        OPEN CDLOAD-GATE                      93812400
*SGLINK CDLGOPEN,INPUT=(R6,R8,RE),WORK=(R2,R5,RE,RF),OUTPUT=()          93853600
         DROP  RE                 RESET ADDR TO CDLOAD                  93894800
         LR    RF,RD              RESET RF                              93936000
         LA    R2,MVSXCMPL        ADDR OF TABLE OF REASON CODES         93977200
         ALR   R2,R0                                                    94018400
         LM    R3,R5,0(R2)        RELATED CODES                         94059600
         TM    DFWKOPT1,DFWKERET  ERRET SPECIFIED                       94100800
         BZ    XLODER30           NO, ---------->                       94142000
         SPACE 1                                                        94183200
         L     RD,DFWKRTUR        GET SA ADDRESS                        94224400
         LTR   RD,RD              BALR I/F                              94265600
         BZ    XLODER20           NO,  ---------->                      94306800
         STM   R3,R5,16(RD)       REASON / COMPLETION CODES             94348000
*                                 IN REGS 15, 0 , 1                     94389200
         LM    RE,RC,12(RD)       LOAD USER REG'S                       94430400
*        AMODESW RETURN,REG=(R7)  ==========> EXIT BALR I/F             94471600
         AMODESW RETURN,REG=(R7)                                        94512800
         SPACE 2                                                        94554000
XLODER20 DS    0H                                                       94595200
         L     RB,TCBSAVE         ADDR OF REQUESTOR'S SA                94636400
         USING SVEARA,RB          BASE FOR SA                           94677600
         STM   R3,R5,SVER0F       REASON / COMPLETION CODES             94718800
*                                 IN REGS 15, 0 , 1                     94760000
         DROP  RB                 RELEASE BASE FOR USER SA              94801200
         USING DISP,R6                                                  94842400
         LA    RF,DISPMVS                                               94883600
*        AMODESW RETURN,REG=(RF)  ==========> EXIT DISPATCHER           94924800
         AMODESW RETURN,REG=(RF)                                        94966000
         SPACE 2                                                        95007200
XLODER30 DS    0H                                                       95048400
         LA    R1,DFCBSAV         USE FETCHWORK AS MESSAGE AREA         95130800
         XC    0(64,R1),0(R1)     ... CLEAR AREA                        95172000
         LA    R0,L'CANC48FX+16   ... AND                               95213222
         ST    R0,0(,R1)          ... PROVIDE LENGTH                    95254400
         USING MAPDMPIF,R1                                              95295600
         ST    R3,CANC48RC        REASON CODE                           95336800
         ST    R4,CANC48RX        SUBREASON CODE                        95378000
         ST    R5,CANC48AB        SYSTEM COMPLETION CODE                95419200
         L     RB,DFCBMACN                                              95460400
         MVC   CANC48MN(16),0(RB) PROVIDE MACRO NAME                    95501600
         OI    CANC48FL,C48VALRS+C48VALSU+C48VALMC  INDICATE REASON .. *95501723
                                  SUBREASON CODE AND MACNAM    @D64ADMZ 95501823
         DROP  R1                 RELEASE MAPDMPIF             @D64ADMZ 95501934
         USING DISP,R6                                                  95542800
         L     R6,ADISPSER        BASE OF DISPSERV                      95584000
         LA    RB,ERR48E          CANCEL EXIT NUMBER                    95625200
         LA    R0,4(,0)           INDICATE: CANCEL USER                 95666400
*        AMODESW CALL,REGS=(R7,R6) =========> ERROR EXIT                95707600
         AMODESW CALL,REGS=(R7,R6) =========> ERROR EXIT                95748800
         DROP  R6                                                       95790000
*---------------------------------------------------------------------* 95831200
         EJECT                                                          95872400
*---------------------------------------------------------------------* 95913600
MVSXCMPL DS    0F                                                       95996000
LD000000 DC    A(0),A(0),A(0)                NULL                       96037200
LDERPGMF DC    A(X'0B'),A(X'0'),A(ABND106) ERROR DURING                 96078411
*                                              PROGRAM FETCH            96119600
XCMPLLEN EQU   *-MVSXCMPL                                               96160800
LDEXHSCB DC    A(X'0C'),A(X'04'),A(ABND106) STORAGE EXHAUSTED           96202011
*                                              CONTROL BLOCKS           96243200
LDEXHPHA DC    A(X'0C'),A(X'14'),A(ABND106) STORAGE EXHAUSTED           96284411
*                                              PHASE                    96325600
LDNOTFIX DC    A(X'0C'),A(X'18'),A(ABND106) STORAGE NOT FIXABL          96366811
LDINVRBA DC    A(X'0E'),A(X'20'),A(ABND106) ERROR IN RBA                96408011
LDINVLBK DC    A(X'0E'),A(X'24'),A(ABND106) INVALID LIB STRUCT          96449211
LDINVRLD DC    A(X'0E'),A(X'28'),A(ABND106) ERROR IN RLD                96490411
LDIOPHAS DC    A(X'0F'),A(X'40'),A(ABND106) I/O ERROR PGM FTCH          96531611
LDINVEXT DC    A(X'0F'),A(X'48'),A(ABND106) RBA NOT IN EXTENT           96572811
LDIEPGMF DC    A(X'28'),A(X'00'),A(ABND106) INT. ERROR PGMFTCH          96614011
LDCONFLO DC    A(X'04'),A(X'00'),A(ABND206) CONFLICTING OPT             96655211
LDGLAUTH DC    A(X'08'),A(X'00'),A(ABND206) GLOBAL FOR UNAUTH           96696411
LDADAUTH DC    A(X'0C'),A(X'00'),A(ABND206) ADDR FOR UNAUTH             96737611
LDLPTNOD DC    A(X'18'),A(X'00'),A(ABND206) ADDR LP NOT ON D            96778811
LDINVOPT DC    A(X'20'),A(X'00'),A(ABND206) INVALID OPTIONS             96820011
LDKEYPAR DC    A(X'C0'),A(X'00'),A(ABND206) INVALID ADDR PARM           96861211
LDKEYDEN DC    A(X'C4'),A(X'00'),A(ABND206) INVALID ADDR DE             96902411
LDKEYDCB DC    A(X'C8'),A(X'00'),A(ABND206) INVALID ADDR DCB            96943611
LDINVDEN DC    A(X'CC'),A(X'00'),A(ABND206) INVALID DIRENTRY            96984811
LDGLNAPF DC    A(X'04'),A(X'00'),A(ABND306)  GLOBAL - PHASE             97026011
*                                               NOT ON APF LIB          97067200
LDGLNSVA DC    A(X'08'),A(X'00'),A(ABND306)  GLOBAL - PHASE             97108411
*                                               NOT SVA-ELIG.           97149600
LDAUNAPF DC    A(X'0C'),A(X'00'),A(ABND306)  AUTH REQ -                 97190811
*                                               NOT ON APF LIB          97232000
LDAUNSVA DC    A(X'24'),A(X'00'),A(ABND306)  AUTH REQ -                 97273211
*                                               NOT SVA-ELIG.           97314400
LDPHANFD DC    A(X'04'),A(X'00'),A(ABND806)  PHASE NOT FOUND            97355611
LDIODIRS DC    A(X'08'),A(X'00'),A(ABND806)  I/O ERROR DURING           97396811
*                                              DIRECTORY SEARCH         97438000
LDDCBNOP DC    A(X'0C'),A(X'00'),A(ABND806)  DCB NOT OPEN               97479211
LDADNDCB DC    A(X'10'),A(X'00'),A(ABND806)  ADDR/ADRNAPF NEEDS         97520411
*                                              DCB PARAMETER            97561600
LDINVDCB DC    A(X'1C'),A(X'00'),A(ABND806)  DCB INCORRECT              97602811
LDIEDIRS DC    A(X'2C'),A(X'00'),A(ABND806)  INTERNAL ERROR             97644011
LDLLEUSE DC    A(X'04'),A(X'00'),A(ABND906)  LLE-USE-CNT OVERFL         97685211
LDATEUSE DC    A(X'08'),A(X'00'),A(ABND906)  ATE-USE-CNT OVERFL         97726411
LDGLBINC DC    A(X'00'),A(X'00'),A(ABNDD06)  GLOBAL - PHASE             97767611
*                      WITH DIFFERENT ATTRIBUTES ALREADY LOADED         97808800
LDINSAUT DC    A(RSFCH201),A(X'00'),A(ABND2C5) INSUFF.AUTH DUR. GETMAIN 97808939
BLERIOER DC    A(X'08'),A(X'00'),A(X'00')    I/O ERROR BLDL             97850000
BLERDELN DC    A(X'08'),A(X'1C'),A(X'00')    INVALID LENGTH OF BLDLE    97891200
BLERLIBS DC    A(X'08'),A(X'20'),A(X'00')    INVALID LIB STRUC          97932400
BLERINVA DC    A(X'08'),A(X'24'),A(X'00')    INV PARM ADDR              97973600
BLERIDCB DC    A(X'08'),A(X'28'),A(X'00')    INV DCB ADDR               98014800
BLERINTR DC    A(X'08'),A(X'2C'),A(X'00')    INTERNAL ERROR             98056000
         SPACE 2                                                        98097200
*---------------------------------------------------------------------* 98138400
XERBLIO  EQU   BLERIOER-MVSXCMPL              008-00                    98179600
XERBLDE  EQU   BLERDELN-MVSXCMPL              008-1C                    98220800
XERBLLB  EQU   BLERLIBS-MVSXCMPL              008-20                    98262000
XERBLIN  EQU   BLERINVA-MVSXCMPL              008-24                    98303200
XERBLDC  EQU   BLERIDCB-MVSXCMPL              008-28                    98344400
XERBLAD  EQU   BLERINTR-MVSXCMPL              008-2C                    98385600
XERPGMF  EQU   LDERPGMF-MVSXCMPL              106-0B-00                 98426800
XEXHSCB  EQU   LDEXHSCB-MVSXCMPL              106-0C-04                 98468000
XEXHPHA  EQU   LDEXHPHA-MVSXCMPL              106-0C-14                 98509200
XNOTFIX  EQU   LDNOTFIX-MVSXCMPL              106-0C-18                 98550400
XINVRBA  EQU   LDINVRBA-MVSXCMPL              106-0E-20                 98591600
XINVLBK  EQU   LDINVLBK-MVSXCMPL              106-0E-24                 98632800
XINVRLD  EQU   LDINVRLD-MVSXCMPL              106-0E-28                 98674000
XIOPHAS  EQU   LDIOPHAS-MVSXCMPL              106-0F-40                 98715200
XINVEXT  EQU   LDINVEXT-MVSXCMPL              106-0F-48                 98756400
XIEPGMF  EQU   LDIEPGMF-MVSXCMPL              106-10                    98797600
XCONFLO  EQU   LDCONFLO-MVSXCMPL              206-04                    98838800
XGLAUTH  EQU   LDGLAUTH-MVSXCMPL              206-08                    98880000
XADAUTH  EQU   LDADAUTH-MVSXCMPL              206-0C                    98921200
XNODADR  EQU   LDLPTNOD-MVSXCMPL              206-18                    98962400
XINVOPT  EQU   LDINVOPT-MVSXCMPL              206-20                    99003600
XKEYPAR  EQU   LDKEYPAR-MVSXCMPL              206-C0                    99044800
XKEYDEN  EQU   LDKEYDEN-MVSXCMPL              206-C4                    99086000
XKEYDCB  EQU   LDKEYDCB-MVSXCMPL              206-C8                    99127200
XINVDEN  EQU   LDINVDEN-MVSXCMPL              206-CC                    99168400
XGLNAPF  EQU   LDGLNAPF-MVSXCMPL              306-04                    99209600
XGLNSVA  EQU   LDGLNSVA-MVSXCMPL              306-08                    99250800
XAUNAPF  EQU   LDAUNAPF-MVSXCMPL              306-0C                    99292000
XAUNSVA  EQU   LDAUNSVA-MVSXCMPL              306-24                    99333200
XPHANFD  EQU   LDPHANFD-MVSXCMPL              806-04                    99374400
XIODIRS  EQU   LDIODIRS-MVSXCMPL              806-2C                    99415600
XDCBNOP  EQU   LDDCBNOP-MVSXCMPL              806-0C                    99456800
XADNDCB  EQU   LDADNDCB-MVSXCMPL              806-10                    99498000
XIEDIRS  EQU   LDIEDIRS-MVSXCMPL              806-2C                    99539200
XLLEUSE  EQU   LDLLEUSE-MVSXCMPL              906-04                    99580400
XATEUSE  EQU   LDATEUSE-MVSXCMPL              906-08                    99621600
XGLBINC  EQU   LDGLBINC-MVSXCMPL              D06-00                    99662800
XINSAUT  EQU   LDINSAUT-MVSXCMPL              2C5-201                   99662939
*---------------------------------------------------------------------* 99704000
         DROP  RF                  RELEASE BASE                         99745228
         DROP  RA                  RELEASE TCB                          99745333
         AIF   (NOT &SGXFCH).PRTGEN                                     99745433
         PRINT  NOGEN                                                   99745533
.PRTGEN  ANOP                                                           99745633
         MEND                                                           99786400
