         MACRO                                                          00050000
         SGAFCH                                                         00100000
         GBLB  &BGFSTAT                                        @D35ZDVB 00150000
         GBLB  &SGAFCH                                         @D37ZDVB 00350000
         GBLB  &BGDSHR                                         @D36SDVB 00400000
         GBLA  &AGAF1                          # SDL INDEX     @D35WDVB 00500000
*--------------------------------------------------------------@D35WDVB 00550000
*                                                              @D35WDVB 00600000
.*       IBM DISK OPERATING SYSTEM                             @D35WDVB 00650000
*        SUPERVISOR - SGAFCH - 5686-066                        @D61DDMZ 00700001
.*                                                             @D35WDVB 00750000
*        LICENSED MATERIALS - PROPERTY OF IBM                  @D35WDVB 00800000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"           @D31UDMZ 00850000
*        5686-066 (C) COPYRIGHT IBM CORP. 1977, 1996           @D62ADMZ 00900001
*        SEE COPYRIGHT INSTRUCTIONS                            @D31UDMZ 00950000
.*                                                             @D35WDVB 01000000
*                                                              @D35WDVB 01050000
*--------------------------------------------------------------@D35WDVB 01100000
&AGAF1   SETA  16                                              @D35WDVB 01150000
&BGFSTAT SETB  0                                               @D35ZDVB 01200000
         AIF   (NOT &SGAFCH).NOPRINT                           @D61NDVB 01250001
         PRINT GEN                                             @D37ZDVB 01300000
.NOPRINT ANOP                                                  @D37ZDVB 01350000
 TITLE 'DOS SUPERVISOR     SGAFCH     FETCH DATA SECTION  **01/15/97**' 01400006
         SPACE 2                                                        01450000
.* /* START OF SPECIFICATIONS ***************************************** 01500000
.*                                                                      01550000
.*01* MODULE NAME = SGAFCH                                              01600000
.*                                                                      01650000
.*01* MODULE TYPE = SUPERVISOR GENERATION MACRO                         01700000
.*                                                                      01750000
.*01* DESCRIPTIVE NAME = DATA SECTION FOR PROGRAM FETCH SERVICES        01800000
.*                                                                      01850000
.*01* CHANGE ACTIVITY = AS FOLLOWS                                      01900000
.*            NEW MACRO -- FIRST RELEASE 35                             01950000
.*              E - SUPPORT                                    @D35EDVB 02000000
.*              FBA - SUPPORT                                  @D35DDVB 02050000
.*              370 - SUPPORT                                  @D35CDVB 02100000
.*              ADVANCED FUNCTIONS                             @D35WDVB 02150000
.*              VMLE SUPPORT                                   @D35NDVB 02200000
.*            CHANGES OF REL 1.2                                        02250000
.*              MORE TASKS                                     @D36IDVB 02300000
.*              CONCATENATED LIBRARIES                         @D36JDVB 02350000
.*              DASD SHARING SUPPORT                           @D36SDVB 02400000
.*            CHANGES OF REL 2.1                               @D14CDVB 02450000
.*              2.1.3                                          @D21ZDVB 02500000
.*            WAITFFF AFTER SVC23 FOR PHASE NOT FOUND          @DA35102 02550000
.*            DTSECTAB CAN BE LOADED FROM A NON PROT. LIB.     @DA37284 02600000
.*            SUPPORT NEW LIBRARIAN TABLES AF 5.1.0            @D51IDMZ 02650000
.*            SUPPORT PFIX'D PHASES IN SVA                     @D51KDMZ 02700000
.*            REMOVE SUPPORT FOR PAGEABLE SGBFCH(NON PAG. NOW) @D51KDMZ 02750000
.*            31 BIT SUPPORT AF 5.2.0                          @D52VDMZ 02825001
.*            ECKD SUPPORT   VSE/ESA 2.1.                      @D61NDVB 02833300
.*            FAMILY API     VSE/ESA 2.4. (AF 6.4.0)           @D64ADVB 02841607
.*                                                                      02850000
.* A000000-999999                                              @D35CDVB 02900000
.**** END OF SPECIFICATIONS ******************************************/ 02950000
         SPACE 2                                                        03000000
*-------------------------------------------------------------*@D14CDVB 03050000
*    FCB  ----   COMMON DATA AREA FOR FETCH                             03100000
*-------------------------------------------------------------*@D14CDVB 03150000
         ENTRY DFCB                                            @D36ZDVB 03200000
         DS    0D                                              @D14CDVB 03250000
         DC    CL8'*SGAFCH*'                                   @D37ZDVB 03300000
         DC    CL8'DY37284 '       LAST APAR FIX               @DA35102 03350000
         DC    CL8'02/21/97'                     MM/DD/YY      @D64ADMZ 03400007
DFCB     DS    0F                                                       03550000
DAFETCH  DC    A(FETCH)               EP FOR FETCH BASE                 03587500
DAREAD   DC    A(FREAD+X'80000000')   EP FOR FETCH I/O LAYER   @D64ADVB 03625007
DARELLPT DC    A(RELLPT+X'80000000')  EP FOR RELLPT ROUTINE    @D64ADVB 03662507
DABLDCHN DC    A(BLDCHAIN)            EP FOR BLDCHAIN          @D64ADVB 03700007
DANXTCHN DC    A(NXTCHAIN)            EP FOR NXTCHAIN          @D64ADVB 03737507
DAMULT   DC    A(MULTIPHS+X'80000000') EP FOR MULTIPHS         @D64ADVB 03775007
DAGETTXT DC    A(FGETTXT+X'80000000') EP FOR PROGRAM FETCH     @D64ADVB 03812507
DAGETLOT DC    A(GETALOT)          EP FOR GETALOT              @D37CDVB 03850000
DASCNLIB DC    A(SCANLIB)          EP FOR SCANLIB SUBROUTINE   @D14CDVB 03900000
DALIBTAB DC    A(NLIBLBPT)         FETCH INTERNAL LIBR. TABLES @D14CDHD 03950000
         AIF   (NOT &BGDSHR).NOSHR62                           @D36SDVB 04000000
DAENQSLD DC    A(ENQSLD)           ADDR OF ROUTINE ENQUE       @D14CDHD 04050000
.NOSHR62 ANOP                                                           04100000
DASYSLIB DC    A(SYSLIB)           ADDR (SYSLIB_DEF_TAB)       @D14CDVB 04150000
DAFCHMOV DC    A(FCHMOVE+X'80000000')  ADDR FCHMOVE ROUTINE    @D61NDMZ 04200001
DFTEXRTN DC    A(FTCHEXIT+X'80000000') FETCH EXIT              @D64ADVB 04250007
DFTEX22  DC    A(ERR22)            CANCEL EXIT PHASE NOT FOUND @D14CDVB 04300000
DFTEX2B  DC    A(ERR2B)            CANCEL EXIT FETCH I/O ERROR @D14CDVB 04350000
DFTEX29  DC    A(ERR29)            CANCEL EXIT INVALID LIBRARY @D14CDVB 04400000
DFTEX25  DC    A(ERR25)            CANCEL EXIT INVALID ADDRESS @D14CDVB 04450000
DFTEX0B  DC    A(FNTFND4)          CANCEL EXIT SECURITY VIOLAT @D51IDMZ 04500001
DFTEX24  DC    A(FRC24EXT+X'80000000')                         @D64ADVB 04550007
DFTEX28  DC    A(ERR28)            CANCEL EXIT PHS DOESN'T FIT @D14CDBC 04600000
DFTEX32  DC    A(ERR3D)            CANCEL EXIT ERROR DURING PFX@D51KDMZ 04650000
DFTEX36  DC    A(ERR45)            CANCEL EXIT RMODE VIOLATION @D52VDMZ 04675001
DFTEX40  DC    A(ERR29)            RESERVED SIMULATION MVS LOAD@D64ADVB 04693707
DFTEX44  DC    A(ERR25)            RESERVED SIMULATION MVS LOAD@D64ADVB 04712407
DFTEX48  DC    A(0)                RESERVED                    @D64ADVB 04731107
DAFPGTAB DC    A(FPGTAB)           EP FOR FPGTAB  SUBROUTINE   @D14CDVB 04750000
DASYSTSK DC    A(FTCHTASK)         ADDR OF FTCHTASK ROUTINE    @D21ZDVB 04850000
DAUSTASK DC    A(USERTASK)         ADDR OF USERTASK ROUTINE    @D21ZDVB 04900000
DASGLOCK DC    A(SGLOCKCK+X'80000000') ADDR OF DEADLOCK CHECK  @D64ADMZ 04950009
DAFSECTS DC    A(FSECTEST+X'80000000') ADDR OD SECURITY  ROUT. @D64ADVB 04965607
DAFRESHA DC    A(FRESHADE+X'80000000') ADDR OF FREE SHADOW ENT @D64ADVB 04981207
DASCYSVC DC    A(SCYSVC+X'00000000')   ADDR OF SECURITY ROUTINE@D64ADVB 04984307
DAMONPHL DC    A(MONPHL+X'80000000') ADDR OF MONITOR LOAD REQ.R@D61NDMZ 04987501
AFTCHERX DC    A(DIRERRAD+X'80000000') ADDR OF ABEND EXIT      @D64ADVB 05037507
AXLDRETC DC    A(XLDXRETC+X'80000000') ADDR OF VSE-TO-MVS XLATE@D64ADVB 05087507
AXLODERX DC    A(XLODERRT+X'80000000') ADDR OF ERROR MODULE    @D64ADVB 05137507
*-------------------------------------------------------------*@D14CDVB 05750000
         SPACE 1                                                        05800000
NLIBOFFS DC    AL2(0)              OFFSET LIB DEF TAB(SYSLIB)  @D14CDVB 05850000
         DC    AL2(0)              OFFS SUBLIB DEF TAB(SYSLIB) @D14CDVB 05900000
         DC    AL2(0)              RESERVED                    @D14CDVB 05950000
         SPACE 2                                                        06000000
*-------------------------------------------------------------*@D14CDVB 06050000
*      SAVE ARAES                                                     * 06100000
*-------------------------------------------------------------*@D14CDVB 06150000
         SPACE 1                                                        06200000
DBASDIR  DS    0F                  LOCAL SAVEAREA FETCH BASE   @D36ZDVB 06250000
FMSKFF0  DC    XL4'FF000000'                                   @D36JDVB 06300000
         DC    F'0'                                            @D36JDVB 06350000
         DC    A(DREADDIR)                                              06400000
         DC    15F'0'                                                   06450000
*-------------------------------------------------------------*@D14CDVB 06500000
DBASTXT  DS    0F                  LOCAL SAVEAREA FOR FETCH    @D36JDVB 06550000
DFCBERRD DC    H'0'                ERROR COUNT FOR DIR TASK    @D36JDVB 06600000
DFCBERRP DC    H'0'                ERROR COUNT DOR PGM TASK    @D36JDVB 06650000
         DC    2F'0'                                           @D36JDVB 06700000
         DC    15F'0'                                          @D36JDVB 06750000
*-------------------------------------------------------------*@D14CDVB 06800000
DGETTXT  DS    0F                  LOCAL SAVEAREA FOR GETTXT   @D36ZDVB 06850000
         DC    A(0)                                                     06900000
         DC    F'0'                                            @D36ZDVB 06950000
         DC    A(DREADTXT)                                              07000000
         DC    15F'0'                                                   07050000
*-------------------------------------------------------------*@D14CDVB 07100000
DMULTSA  DS    0F                  LOCAL SAVEAREA FOR MULTPHAS @D36ZDVB 07150000
DFALGND  DC    XL4'00FFFFF8'       DOUBLE WORD ALIGNMENT                07200000
         DC    F'0'                                            @D36ZDVB 07250000
         DC    A(DREADDIR)                                              07300000
         DC    15F'0'                                                   07350000
*-------------------------------------------------------------*@D14CDVB 07400000
DREADDIR DS    0F                                              @D36ZDVB 07450000
DFALGNF  DC    XL4'00FFFFFC'       FULLWORD ALIGNMENT                   07500000
         DC    2F'0'                                           @D36JDVB 07550000
DSWRKAR  EQU   *                   TEMPORARY WORKAREA          @D14CDVB 07600000
         DC    15F'0'                                          @D36JDVB 07650000
*-------------------------------------------------------------*@D14CDVB 07700000
PSAVAR   DS    0F                  SAVE AREA FOR SUBROUTINES   @D14CDHD 07750000
         DC    16F'0'                                          @D14CDHD 07800000
*-------------------------------------------------------------*@D14CDVB 07850000
DREADTXT DS    0F                                              @D36JDVB 07900000
FMASK1K  DC    X'00003FF'          1K MASK                     @D14CDVB 07950000
         DC    2F'0'                                           @D36JDVB 08000000
         DC    15F'0'                                          @D36JDVB 08050000
*-------------------------------------------------------------*@D14CDVB 08100000
READRGHT DC    F'14'               ACCESS RIGHT BITS           @D14CDVB 08150000
*                                  X'08'  UPDATE               @D14CDVB 08200000
*                                  X'04'  WRITE                @D14CDVB 08250000
*                                  X'02'  READ                 @D14CDVB 08300000
FRELSTAT DC    XL4'C0000000'                                   @D14CDVB 08350000
*-------------------------------------------------------------*@D14CDVB 08400000
         SPACE 2                                                        08450000
*                                                              @D14CDHD 08500000
*  DTL TO LOCK A SUBLIBRARY                                    @D14CDHD 08550000
*                                                              @D14CDHD 08600000
*CLIBRES  DTL CONTROL=E,LOCKOPT=1,SCOPE=EXT,OWNER=TASK         @D14CDHD 08650000
CLIBRES  DTL NAME=" ",CONTROL=E,LOCKOPT=1,SCOPE=EXT,OWNER=TASK @D14CDHD 08700000
         SPACE 1                                               @D14CDHD 08750000
         AIF   (NOT &BGDSHR).NOSHR64                           @D36SDVB 08800000
RESAREA  DS    CL(RESNLEN)        AREA FOR RESOURCE NAME GENER-@D14CDHD*08850000
                                  TION, FORMAT OF INLCRESN              08900000
ARESAREA DC    A(RESAREA)         @RESOURCE NAME AREA          @D14CDHD 08950000
.NOSHR64 ANOP                                                           09000000
         SPACE 2                                                        09050000
*-------------------------------------------------------------*@D14CDVB 09100000
         SPACE 2                                                        09200000
*---- TFIX/TFREE TABLE FOR PROGRAM FETCH ---------------------*@D14CDVB 09250000
FTFXEND  DC    A(FTFXZER)          POINTER TO LAST ENTRY                09300000
FTFXPTR  DC    A(FTFXTAB)                                               09350000
FTFXSAV  DC    A(FTFXTAB)                                               09400000
FTFRSAV  DC    A(FTFXTAB)                                               09450000
FTFXTAB  DC    64XL8'00'           64*8-BYTE ENTRIES          @D52VDMZ  09500001
FTFXZER  DC    F'0'                LAST ENTRY - DELIMITER               09550000
FTENSAV  DC    F'0'                COUNTER                              09600000
         SPACE 2                                                        09650000
*---- PFIX/PFREE TABLE FOR PROGRAM FETCH ---------------------*@D51KDMZ 09700000
FPFXBEG  DC    A(0)                BEGIN OF AREA TO BE PFIXED  @D51KDMZ 09750000
FPFXLNG  DC    F'0'                LENGTH OF PFX'D AREA MINUS 1@D51KDMZ 09800000
FPFXEND  DC    X'FFFFFFFF'         END INDICATOR               @D51KDMZ 09850000
         SPACE 2                                                        09950000
*-------------------------------------------------------------*@D14CDVB 10000000
         SPACE 1                                                        10050000
*   SYSTEM SEARCHING CHAIN       -----------------------------*@D369DVB 10100000
         SPACE 1                                                        10150000
*-------------------------------------------------------------*@D369DVB 10200000
DSRCHN1  DS    0F                SYSTEM CHAIN                  @D36JDVB 10250000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 10300000
         DC    X'0'                                            @D36JDVB 10350000
         DC    X'80'             SDL INDICATION                @D14CDVB 10400000
         DC    X'0'              SCIL                          @D36JDVB 10450000
         DC    X'0'              NO SECOND LEVEL SEARCH        @D36JDVB 10500000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 10550000
         DC    X'0'                                            @D36JDVB 10600000
         DC    X'10'             DIRECTORY                     @D36JDVB 10650000
         DC    X'0'              SCIL                          @D36JDVB 10700000
         DC    X'0'              NO SECOND LEVEL SEARCH        @D36JDVB 10750000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 10800000
         DC    X'0'                                            @D36JDVB 10850000
         DC    X'10'             DIRECTORY                     @D36JDVB 10900000
         DC    X'08'             PCIL                          @D36JDVB 10950000
         DC    X'08'             SECOND LEVEL SEARCH ON JOB CH @D36JDVB 11000000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 11050000
         DC    X'0'                                            @D36JDVB 11100000
         DC    X'10'             DIRECTORY                     @D36JDVB 11150000
         DC    X'08'             PCIL                          @D36JDVB 11200000
         DC    X'04'             SECOND LEVEL SEARCH ON PAR.CH @D36JDVB 11250000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 11300000
         DC    X'0'                                            @D36JDVB 11350000
         DC    X'0C'             LNK INDICATION                @D36JDVB 11400000
         DC    X'08'             PCIL                          @D36JDVB 11450000
         DC    X'0C'             SND LEVEL SEARCH ON 'TO' LIBS @D36JDVB 11500000
*-------------------------------------------------------------*@D369DVB 11550000
         DC    X'FF'             END INDICATOR                 @D36JDVB 11600000
         SPACE 1                                                        11650000
*   USER SEARCHING CHAIN         -----------------------------*@D369DVB 11700000
         SPACE 1                                                        11750000
*-------------------------------------------------------------*@D369DVB 11800000
DSRCHN2  DS    0F                USER CHAIN                    @D36JDVB 11850000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 11900000
         DC    X'0'                                            @D36JDVB 11950000
         DC    X'0C'             LNK INDICATION                @D36JDVB 12000000
         DC    X'08'             PCIL                          @D36JDVB 12050000
         DC    X'0C'             SND LEVEL SEARCH ON 'TO' LIBS @D36JDVB 12100000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 12150000
         DC    X'0'                                            @D36JDVB 12200000
         DC    X'80'             SDL INDICATION                @D14CDVB 12250000
         DC    X'0'              SCIL                          @D36JDVB 12300000
         DC    X'0'              NO SECOND LEVEL SEARCH        @D36JDVB 12350000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 12400000
         DC    X'0'                                            @D36JDVB 12450000
         DC    X'10'             DIRECTORY                     @D36JDVB 12500000
         DC    X'08'             PCIL                          @D36JDVB 12550000
         DC    X'08'             SND LEVEL SEARCH ON JOB CHAIN @D36JDVB 12600000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 12650000
         DC    X'0'                                            @D36JDVB 12700000
         DC    X'10'             DIRECTORY                     @D36JDVB 12750000
         DC    X'08'             PCIL                          @D36JDVB 12800000
         DC    X'04'             SND LEVEL SEARCH ON PART CHAIN@D36JDVB 12850000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 12900000
         DC    X'0'                                            @D36JDVB 12950000
         DC    X'10'             DIRECTORY                     @D36JDVB 13000000
         DC    X'0'              SCIL                          @D36JDVB 13050000
         DC    X'0'              NO SECOND LEVEL SEARCH        @D36JDVB 13100000
*-------------------------------------------------------------*@D369DVB 13150000
         DC    X'FF'             END INDICATOR                 @D36JDVB 13200000
         SPACE 1                                                        13250000
*   TEST MODE SEARCHING CHAIN    -----------------------------*@D369DVB 13300000
         SPACE 1                                                        13350000
*-------------------------------------------------------------*@D369DVB 13400000
DSRCHN3  DS    0F                USER CHAIN                    @D36JDVB 13450000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 13500000
         DC    X'0'                                            @D36JDVB 13550000
         DC    X'0C'             LNK INDICATION                @D36JDVB 13600000
         DC    X'08'             PCIL                          @D36JDVB 13650000
         DC    X'0C'             SND LEVEL SEARCH ON 'TO' LIBS @D36JDVB 13700000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 13750000
         DC    X'0'                                            @D36JDVB 13800000
         DC    X'10'             DIRECTORY                     @D36JDVB 13850000
         DC    X'08'             PCIL                          @D36JDVB 13900000
         DC    X'08'             SND LEVEL SEARCH ON JOB CHAIN @D36JDVB 13950000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 14000000
         DC    X'0'                                            @D36JDVB 14050000
         DC    X'10'             DIRECTORY                     @D36JDVB 14100000
         DC    X'08'             PCIL                          @D36JDVB 14150000
         DC    X'04'             SND LEVEL SEARCH ON PART CHAIN@D36JDVB 14200000
*------------------------------- CHAIN ENTRY -----------------*@D369DVB 14250000
         DC    X'0'                                            @D36JDVB 14300000
         DC    X'10'             DIRECTORY                     @D36JDVB 14350000
         DC    X'0'              SCIL                          @D36JDVB 14400000
         DC    X'0'              NO SECOND LEVEL SEARCH        @D36JDVB 14450000
*-------------------------------------------------------------*@D369DVB 14500000
         DC    X'FF'             END INDICATOR                 @D36JDVB 14550000
         SPACE 1                                                        14600000
*   MVS SEARCHING CHAIN WITHOUT DCB SPECIFIED OR WITH          @D64ADMZ 14661207
*     DCB=1                                                    @D64ADMZ 14661308
         SPACE 1                                                        14662600
*-------------------------------------------------------------*@D64ADVB 14664007
DSRCHN4  DS    0F                MVS SEARCHING CHAIN           @D64ADVB 14665407
*------------------------------- CHAIN ENTRY -----------------*@D64ADVB 14666807
         DC    X'0'                                            @D64ADVB 14668207
         DC    X'10'             DIRECTORY                     @D64ADVB 14669607
         DC    X'08'             PCIL                          @D64ADVB 14671007
         DC    X'08'             SECOND LEVEL SEARCH ON JOB CH @D64ADVB 14672407
*------------------------------- CHAIN ENTRY -----------------*@D64ADVB 14673807
         DC    X'0'                                            @D64ADVB 14675207
         DC    X'10'             DIRECTORY                     @D64ADVB 14676607
         DC    X'08'             PCIL                          @D64ADVB 14678007
         DC    X'04'             SECOND LEVEL SEARCH ON PAR.CH @D64ADVB 14679407
*------------------------------- CHAIN ENTRY -----------------*@D64ADVB 14680807
         DC    X'0'                                            @D64ADVB 14682207
         DC    X'80'             SDL INDICATION                @D64ADVB 14683607
         DC    X'0'              SCIL                          @D64ADVB 14685007
         DC    X'0'              NO SECOND LEVEL SEARCH        @D64ADVB 14686407
*------------------------------- CHAIN ENTRY -----------------*@D64ADVB 14687807
         DC    X'0'                                            @D64ADVB 14689207
         DC    X'10'             DIRECTORY                     @D64ADVB 14690607
         DC    X'0'              SCIL                          @D64ADVB 14692007
         DC    X'0'              NO SECOND LEVEL SEARCH        @D64ADVB 14693407
*-------------------------------------------------------------*@D64ADVB 14694807
         DC    X'FF'             END INDICATOR                 @D64ADVB 14694907
         SPACE 1                                                        14696200
*-------------------------------------------------------------*@D64ADVB 14698107
*   MVS LIKE SEARCHING CHAIN WITH DCB:                        *@D64ADMZ 14698207
*      TASK CHAIN, SDL, SYSLIB                                *@D64ADMZ 14698307
         SPACE 1                                                        14698402
*-------------------------------------------------------------*@D369DVB 14698502
DSRCHN5  DS    0F                MVS SEARCHING CHAIN           @D64ADVB 14698607
*------------------------------- CHAIN ENTRY -----------------*@D64ADVB 14698707
         DC    X'0'                                            @D64ADVB 14698807
         DC    X'10'             DIRECTORY                     @D64ADVB 14698907
         DC    X'08'             PCIL                          @D64ADVB 14699007
         DC    X'10'             SECOND LEVEL SEARCH ON TASK CH@D64ADVB 14699107
*------------------------------- CHAIN ENTRY -----------------*@D64ADVB 14699207
         DC    X'0'                                            @D64ADVB 14699307
         DC    X'80'             SDL INDICATION                @D64ADVB 14699407
         DC    X'0'              SCIL                          @D64ADVB 14699507
         DC    X'0'              NO SECOND LEVEL SEARCH        @D64ADVB 14699607
*------------------------------- CHAIN ENTRY -----------------*@D64ADVB 14699707
         DC    X'0'                                            @D64ADVB 14699807
         DC    X'10'             DIRECTORY                     @D64ADVB 14699907
         DC    X'0'              SCIL                          @D64ADVB 14700007
         DC    X'0'              NO SECOND LEVEL SEARCH        @D64ADVB 14701007
         SPACE                                                          14702002
EOLBCHN  DC    X'FF'             END_OF_LB CHAIN INDICATION    @D14CDVB 14750000
         DC    XL3'FFFFFF'                                     @D14CDVB 14800000
*-------------------------------------------------------------*@D369DVB 14825000
         SPACE 2                                                        14850000
*----- AREA FOR DIRECTORY SEARCH TASK ------------------------*@D14CDVB 14900000
         SPACE 1                                                        14950000
ASCADR00 DC    A(SCTYPDR1)                                     @D14CDVB 15000000
         DC    A(SCTYPNX1)                                     @D14CDVB 15050000
SCTYPDR1 DC    A(SCNLB040)         NEXT ENTRY                  @D14CDVB 15100000
         DC    A(SCNLB040)         NEXT ENTRY                  @D14CDVB 15150000
         DC    A(SCNLNTFD)         NOT FOUND                   @D14CDVB 15200000
         DC    A(SCNLB030)         FOUND CONDITION             @D14CDVB 15250000
         DC    A(SCADDR10)                                     @D14CDVB 15300000
SCTYPDR2 DC    A(SCNLBERD)         NEXT ENTRY                  @D14CDVB 15350000
         DC    A(SCNLBERD)         NEXT ENTRY                  @D14CDVB 15400000
         DC    A(SCNLNTFD)         NOT FOUND                   @D14CDVB 15450000
         DC    A(SCNLB030)         FOUND CONDITION             @D14CDVB 15500000
         DC    A(SCADDR20)                                     @D14CDVB 15550000
SCDIRDR1 DC    A(SCNLB020)         NEXT TYPE ENTRY             @D14CDVB 15600000
         DC    A(SCNLB040)         NEXT ENTRY                  @D14CDVB 15650000
         DC    A(SCNLNTFD)         NOT FOUND                   @D14CDVB 15700000
         DC    A(SCNLBRET)         FOUND CONDITION             @D14CDVB 15750000
         DC    A(SCADDR20)                                     @D14CDVB 15800000
SCDIRDR2 DC    A(SCNLBERD)         ERROR                       @D14CDVB 15850000
         DC    A(SCNLB040)         NEXT ENTRY                  @D14CDVB 15900000
         DC    A(SCNLNTFD)         NOT FOUND                   @D14CDVB 15950000
         DC    A(SCNLBRET)         FOUND CONDITION             @D14CDVB 16000000
         DC    A(SCADDR10)                                     @D14CDVB 16050000
SCTYPNX1 DC    A(SCNLB040)         NEXT ENTRY                  @D14CDVB 16100000
         DC    A(SCNLB040)         NEXT ENTRY                  @D14CDVB 16150000
         DC    A(SCNLB050)         POSSIBLY FOUND CONDITION    @D21ZDVB 16200000
         DC    A(SCNLB030)         FOUND CONDITION             @D14CDVB 16250000
         DC    A(SCADNX10)                                     @D14CDVB 16300000
SCTYPNX2 DC    A(SCNLBERD)         ERROR                       @D14CDVB 16350000
         DC    A(SCNLBERD)         ERROR                       @D14CDVB 16400000
         DC    A(SCNLB030)         FOUND CONDITION             @D14CDVB 16450000
         DC    A(SCNLB030)         FOUND CONDITION             @D14CDVB 16500000
         DC    A(SCADNX20)                                     @D14CDVB 16550000
SCNDXDR1 DC    A(SCNLB020)         NEXT TYPE ENTRY             @D14CDVB 16600000
         DC    A(SCNLB040)         NEXT ENTRY                  @D14CDVB 16650000
         DC    A(SCNLBHMK)         FOUND CONDITION             @D14CDVB 16700000
         DC    A(SCNLBRET)         FOUND CONDITION             @D14CDVB 16750000
         DC    A(SCADNX20)                                     @D14CDVB 16800000
SCNDXDR2 DC    A(SCNLBERD)         ERROR                       @D14CDVB 16850000
         DC    A(SCNLBRET)         FOUND CONDITION             @D14CDVB 16900000
         DC    A(SCNLBRET)         FOUND CONDITION             @D14CDVB 16950000
         DC    A(SCNLBRET)         FOUND CONDITION             @D14CDVB 17000000
         DC    A(SCADNX20)                                     @D14CDVB 17050000
SCADDR10 DC    A(SCTYPDR2)                                     @D14CDVB 17100000
         DC    A(SCDIRDR1)                                     @D14CDVB 17150000
SCADDR20 DC    A(SCTYPDR2)                                     @D14CDVB 17200000
         DC    A(SCDIRDR2)                                     @D14CDVB 17250000
SCADNX10 DC    A(SCTYPNX2)                                     @D14CDVB 17300000
         DC    A(SCNDXDR1)                                     @D14CDVB 17350000
SCADNX20 DC    A(SCTYPNX2)                                     @D14CDVB 17400000
         DC    A(SCNDXDR2)                                     @D14CDVB 17450000
         SPACE 1                                                        17500000
*------ SDL INDEX --- FOR PREVENTION OF PAGE FAULTS ----------*@D35WDVB 17550000
         SPACE 1                                                        17600000
DISDLD   DC    F'0'                       START OF SDL         @D35WDVB 17650000
DISDLA   DS    0F                                              @D35WDVB 17700000
.FAFLP   ANOP                                                  @D35WDVB 17750000
         DC    XL8'FFFFFFFFFFFFFFFF'      )  INDEX NAME        @D35WDVB 17800000
         DC    XL4'0'                     )  INDEX POINTER     @D35WDVB 17850000
&AGAF1   SETA  &AGAF1-1                                        @D35WDVB 17900000
         AIF   (&AGAF1 NE 1).FAFLP                             @D35WDVB 17950000
DISDLB   DC    XL8'FFFFFFFFFFFFFFFF'                           @D35WDVB 18000000
         DC    XL4'0'                                          @D35WDVB 18050000
DISDLE   DC    A(DISDLB)                                       @D35WDVB 18100000
LSDLINDX EQU   DISDLE-DISDLB                                   @D35WDVB 18150000
*-------------------------------------------------------------*@D14CDVB 18200000
LINKNAME DC    CL7'LINKVIO'                                    @D14CDVB 18250000
         DC    CL1' '                                          @D14CDVB 18300000
HARDNAME DC    CL7'HRDWAIT'                                    @D14CDVB 18350000
         DC    CL1' '                                          @D14CDVB 18400000
CON$$BN  DC    CL3'$$B'                                        @D14CDVB 18450000
         DC    CL1' '                                          @D14CDVB 18500000
CONDTSEC DC    CL8'DTSECTAB'                                   @DA37284 18550000
CONPHASE DC    CL8'PHASE   '      CHECK FOR PHASE IN LOT ENTRY @D51IDMZ 18600000
         SPACE 2                                                        18650000
*-------------------------------------------------------------*@D14CDVB 18700000
         SPACE 1                                                        18750000
DSWKLBLK DC    F'0'                RELATIVE BLOCK ADDRESS      @D14CDVB 18800000
DSBEGIDR DC    A(FDIRBUF)          START ADDRESS OF IDRA       @D14CDVB 18950000
DSENDIDR DC    A(EFDIRBUF)         END ADDRESS OF IDRA         @D14CDVB 19000000
DSPHASID DS    0A                                              @D14BDBC 19050000
         DC    AL2(UPHAEIP1)       PHASE_ID OUT OF LIBRARIAN   @D14BDBC 19100000
         DC    AL2(UPHAEIP2)         -  TABLE                  @D14BDBC 19150000
DFCBSTDR DC    F'0'                USED AS ERROR INDICATION    @D14CDVB 19200000
*              RC ---  4           UNRECOVERABLE I/O ERROR     @D14CDVB 19250000
*              RC ---  8           UNRECOVERABLE I/O ERROR     @D14CDVB 19300000
*              RC --- 12           INTERNAL ERROR              @D14CDVB 19350000
*              RC --- 16           TFIX: I/F PROBLEM...        @D14CDVB 19400000
*                                        ... OR PAGE NOT TFIXED@D14CDVB 19450000
         SPACE 1                                                        19500000
*-------------------------------------------------------------*@D14CDVB 19550000
         SPACE 1                                                        19600000
*                                                              @D14CDHD 19650000
*  CCB OF  D I R  -  TASK                                      @D14CDHD 19700000
*                                                              @D14CDHD 19750000
         SPACE 1                                                        19800000
DFICBR   DS    0F                                              @D36JDVB 19850000
DFICBCCB CCB   SYSRES,DFICBCCB     I/O CONTROL BLOCK                    19900000
DFICBXND EQU   *                                                        19950000
         ORG   DFICBCCB+CCBCOM2-CCBADR                         @D37ZDVB 20000000
         DC    AL1(NRFRETRY)       RETRY ON RECORD NOT FOUND   @D37ZDVB 20050000
         ORG   DFICBCCB+CCBCLS-CCBADR                          @D37ZDVB 20100000
         DC    AL1(CCBPHYAD+XCPR)  PHYSICAL ADDRESSING         @D37ZDVB 20150000
         ORG   DFICBXND                                                 20200000
         SPACE 1                                                        20250000
*-------------------------------------------------------------*@D14CDVB 20300000
         SPACE 2                                                        20350000
*------- AREA FOR PROGRAM FETCH TASK--------------------------*@D14CDVB 20400000
         SPACE 1                                                        20450000
PFWKLTXT DC    F'0'                TEMPORARY LOAD POINT        @D36JDVB 20500000
PFWKETXT DC    F'0'                END OF PHASE                @D36JDVB 20550000
PFWKMTXT DC    F'0'                HIGHEST LOAD ADDR TFIXED    @D36JDVB 20600000
PFWKHTXT DC    F'0'                HIGHEST LOAD ADDRESS        @D36JDVB 20650000
PFWKCTXT DC    F'0'                CONTIGUOUS PART OF PHASE    @D14CDVB 20700000
         SPACE 1                                                        20750000
*-------------------------------------------------------------*@D14CDVB 20800000
PRLDCHN  DC    A(CRLDFBA)                                      @D14CDVB 20850000
         DC    A(FCCWRLD)                                      @D37ZDVB 20900000
         DC    A(CRLDRPS)                                      @D37ZDVB 20950000
         DC    A(CRLDECKD)                                     @D61NDVB 20966601
.*  ---------------------------->  NEW AVRTYPE EXTEND HERE     @D61NDVB 20983201
*-------------------------------------------------------------*@D14CDVB 21000000
PFWKRELF DC    F'0'                RELOCTAION FACTOR           @D36JDVB 21050000
PFWKNRLD DC    F'0'                ADDRESS OF NEXT RLD         @D36JDVB 21100000
PFWKPRLD DC    H'0'                NUMBER OF RLD TO PROCEES    @D14BDBC 21150000
PFWKARLD DC    H'0'                RESERVED                    @D14BDBC 21200000
*-------------------------------------------------------------*@D14CDVB 21250000
         SPACE 1                                                        21300000
*---- PFGENCB CCW GENERATION CONTROL BLOCK -------------------*@D14CDVB 21350000
         SPACE 1                                                        21400000
PFGENCB  DS    0F                                              @D14CDVB 21450000
PFBEGDIR DC    A(FDIRBUF)          @START OF DIRECTORY BUFFER  @D14CDHD 21500000
PFBEGRLD DC    A(FRLDBUF)          BEGIN OF RLD_BUFFER         @D14CDVB 21550000
PFENDRLD DC    A(ERLDBUF)          END   OF RLD_BUFFER         @D14CDVB 21600000
PFSTDBEG DC    A(FSTCCW)           START ADDRESS OF GEN AREA   @D14CDVB 21650000
PFSTDEND DC    A(ENDBUF)           END ADDRESS OF GEN AREA     @D14CDVB 21700000
PFBEGCIF DC    A(FCIFBUF)          @BUFFER TO READ LAST TXT-CIF@D14CDHD 21750000
         SPACE 2                                                        22000000
DFCBSTPF DC    F'0'                USED AS ERROR INDICATION    @D14CDVB 22050000
*              RC ---  4           UNRECOVERABLE I/O ERROR     @D14CDVB 22100000
*              RC ---  8           UNRECOVERABLE I/O ERROR     @D14CDVB 22150000
*              RC --- 12           INTERNAL ERROR              @D14CDVB 22200000
*              RC --- 16           TFIX: I/F PROBLEM...        @D14CDVB 22250000
*                                        ... OR PAGE NOT TFIXED@D14CDVB 22300000
         SPACE 1                                                        22350000
*-------------------------------------------------------------*@D14CDVB 22400000
         SPACE 1                                               @D14CDHD 22450000
*                                                              @D14CDHD 22500000
*  CCB OF  S U P  -  TASK                                      @D14CDHD 22550000
*                                                              @D14CDHD 22600000
         SPACE 1                                                        22650000
DFICBP   DS    0F                                              @D36JDVB 22700000
DFICBCB2 CCB   SYSRES,DFICBCB2     I/O CONTROL BLOCK           @D36JDVB 22750000
DFICBERR EQU   2                                               @D36JDVB 22800000
DFICBEOC EQU   3                                               @D36JDVB 22850000
DFICBCCW EQU   8                                               @D36JDVB 22900000
DFICBLUB EQU   7                                               @D36JDVB 22950000
DFICBNXT EQU   12                                              @D36JDVB 23000000
DFICBXD2 EQU   *                                               @D36JDVB 23050000
         ORG   DFICBCB2+CCBCOM2-CCBADR                         @D37ZDVB 23100000
         DC    AL1(NRFRETRY)       RETRY ON RECORD NOT FOUND   @D37ZDVB 23150000
         ORG   DFICBCB2+CCBCLS-CCBADR                          @D37ZDVB 23200000
         DC    AL1(CCBPHYAD+XCPR)  PHYSICAL ADDRESSING         @D37ZDVB 23250000
         ORG   DFICBXD2                                        @D36JDVB 23300000
         SPACE 2                                                        23350000
*-------------------------------------------------------------*@D14CDVB 23400000
         SPACE 1                                                        23450000
CC@      EQU   0                   CC VALUE                    @D61NDVB 23500001
HH@      EQU   CC@+2               HH VALUE                    @D14CDVB 23600000
R@       EQU   HH@+2               R VALUE                     @D14CDVB 23650000
SECT@    EQU   R@+1                SECTOR VALUE                @D14CDVB 23700000
         SPACE 1                                                        23950000
*-------------------------------------------------------------*@D14CDVB 24000000
         SPACE 2                                                        24050000
*----  FRPL  CONTROL BLOCK INFORMATION   ---------------------*@D14CDVB 24100000
         SPACE 1                                                        24150000
FBLDTXT  DC    F'4'                                            @D14CDVB 24200000
FBLDRLD  DC    F'8'                                            @D14CDVB 24250000
FBLDDIR  DC    F'12'                                           @D14CDVB 24300000
FRPLHIGH EQU   *                                               @D14CDVB 24350000
FBLDMLT  DC    F'16'                                           @D21ZDVB 24400000
         SPACE 1                                                        24450000
*-------------------------------------------------------------*@D14CDVB 24500000
         SPACE 2                                                        24550000
FRPLTAB  DS    0F                  FRPL TABLE                           24600000
DFCBERST DC    F'0'                USED AS ERROR INDICATION             24650000
*              RC ---  4           UNRECOVERABLE I/O ERROR FOR USER     24700000
*              RC ---  8           UNRECOVERABLE I/O ERROR FOR SYSTEM   24750000
*              RC --- 12           INTERNAL ERROR                       24800000
*              RC --- 16           TFIX: I/F PROBLEM...        @D149DVB 24850000
*                                        ... OR PAGE NOT TFIXED@D149DVB 24900000
*-------------------------------------------------------------*@D14CDVB 24950000
DSRPLTXT DC    A(FRPLTXT)          )  SAVE                              25000000
DSRPLRLD DC    A(FRPLRLD)          )    AREAS                           25050000
DSRPLDIR DC    A(FRPLDIR)          )      FOR                  @D21ZDVB 25100000
DSRPLMLT DC    A(FRPLMLT)          )          RPL POINTERS     @D21ZDVB 25150000
*-------------------------------------------------------------*@D14CDVB 25200000
         SPACE 1                                                        25250000
FRPLTXT  DS    0F                                                       25300000
         DC    H'4'                TEXT FRPL                            25350000
         DC    H'0'                OFFSET TO CHANNEL PGRM      @D14CDVB 25400000
         DC    H'0'                PHYSICAL BLOCKLENGTH        @D14CDVB 25450000
         DC    H'0'                LOGICAL RECORD LENGTH       @D14CDVB 25500000
         DC    A(PFRBATXT)         ADDRESS OF RBA              @D14CDVB 25550000
         DC    A(0)                ADDRESS OF INPUT AREA       @D14CDVB 25600000
         DC    A(0)                ADDRESS OF LBCIF            @D14CDVB 25650000
         DC    H'0'                NUMBER OF REQUESTED RECORDS @D14CDVB 25700000
         DC    H'0'                OPERATION FIELD             @D14CDVB 25750000
         DC    A(0)                ADDRESS OF DEF-EXTENT       @D61NDVB 25762501
         DC    A(0)                ADDRESS OF LOCATE           @D61NDVB 25775001
         DC    A(0)                ADDRESS OF SEEK             @D61NDVB 25787501
         DC    XL1'0'                                          @D14CDVB 25800000
         DC    XL1'0'                                          @D14CDVB 25850000
         DC    H'0'                                            @D14CDVB 25900000
         DC    A(0)                ADDRESS OF GENERATION MODEL @D14CDVB 25950000
         DC    A(0)                ADDRESS OF TIC              @D14CDVB 26000000
         DC    H'0'                                            @D14CDVB 26050000
         DC    H'0'                                            @D14CDVB 26100000
*-------------------------------------------------------------*@D61NDVB 26125001
FRPLRLD  DS    0F                  RLD FRPL                             26150000
         DC    H'8'                                                     26200000
         DC    H'0'                OFFSET TO CHANNEL PGRM      @D14CDVB 26250000
         DC    H'0'                PHYSICAL BLOCKLENGTH        @D14CDVB 26300000
         DC    H'0'                LOGICAL RECORD LENGTH       @D14CDVB 26350000
         DC    A(PFRBARLD)         ADDRESS OF RBA              @D14CDVB 26400000
         DC    A(FRLDBUF)          ADDRESS OF INPUT AREA       @D14CDVB 26450000
         DC    A(0)                ADDRESS OF LBCIF            @D14CDVB 26500000
         DC    H'1'                NUMBER OF REQUESTED RECORDS @D14CDVB 26550000
         DC    H'0'                                                     26600000
         DC    A(0)                ADDRESS OF DEF-EXTENT       @D61NDVB 26610001
         DC    A(0)                ADDRESS OF LOCATE           @D61NDVB 26620001
         DC    A(0)                ADDRESS OF SEEK             @D61NDVB 26630001
*-------------------------------------------------------------*@D61NDVB 26640001
FRPLDIR  DS    0F                  DIR FRPL                             26650000
         DC    H'12'                                           @D14CDVB 26700000
         DC    H'0'                OFFSET TO CHANNEL PGRM      @D14CDVB 26750000
         DC    H'0'                PHYSICAL BLOCKLENGTH        @D14CDVB 26800000
         DC    H'0'                LOGICAL RECORD LENGTH       @D14CDVB 26850000
         DC    A(DSRBADIR)         ADDRESS OF RBA              @D14CDVB 26900000
         DC    A(FDIRBUF)          ADDRESS OF INPUT AREA       @D14CDVB 26950000
         DC    A(0)                ADDRESS OF LBCIF            @D14CDVB 27000000
         DC    H'1'                NUMBER OF REQUESTED RECORDS @D14CDVB 27050000
         DC    H'0'                                            @D14CDVB 27100000
         DC    A(0)                ADDRESS OF DEF-EXTENT       @D61NDVB 27110001
         DC    A(0)                ADDRESS OF LOCATE           @D61NDVB 27120001
         DC    A(0)                ADDRESS OF SEEK             @D61NDVB 27130001
*-------------------------------------------------------------*@D61NDVB 27140001
FRPLMLT  DS    0F                  MLT FRPL                    @D21ZDVB 27150000
         SPACE 1                                                        27200000
*-------------------------------------------------------------*@D14CDVB 27250000
         SPACE 1                                                        27300000
PFRBATXT DC    F'0'                                            @D14CDVB 27350000
PFRBARLD DC    F'0'                                            @D14CDVB 27400000
DSRBADIR DC    F'0'                                            @D14CDVB 27450000
DSRBALMT DC    F'0'                                            @D21ZDVB 27500000
*-------------------------------------------------------------*@D14CDVB 27600000
         SPACE 2                                                        27650000
*------  DEFINE EXTENT DATA FOR FBA / ECKD -------------------*@D14CDVB 27700001
         SPACE 1                                                        28450000
PFDEFEXT DS    0F                                              @D14CDVB 28500000
         DC    X'40'               OPERATION BYTE  --- READ    @D14CDVB 28550000
         DC    XL3'0'              ARCHITECTED AS HEX'0'       @D36JDVB 28600000
PFEXTBL  DC    F'0'                PHYSICAL START ADDRESS (PBN)@D14CDVB 28650000
PFEXTBEG DC    F'0'                REL START ADDRESS OF EXTENT @D14CDVB 28700000
PFEXTEND DC    F'0'                REL END ADDRESS OF EXTENT   @D14CDVB 28750000
*-------------------------------------------------------------*@D14CDVB 28800000
PFDEFXEC DS    0F                                              @D61NDVB 28805501
         DC    X'00'               OPERATION BYTE  --- READ    @D61NDVB 28811001
         DC    X'C0'               GLOBAL ATTRIBUTES           @D61NDVB 28816501
         DC    AL2(MAXLENLB)       BLOCKSIZE                   @D61NDVB 28822001
         DC    H'0'                                            @D61NDVB 28824701
         DC    X'0'                                            @D61NDVB 28827401
         DC    X'40'               REGULAR DATA FORMAT         @D61NDVB 28830101
PFXECBEG DC    F'0'                START ADDRESS CCHH          @D61NDVB 28833001
PFXECEND DC    F'0'                END ADDRES    CCHH          @D61NDVB 28838501
*-------------------------------------------------------------*@D61NDVB 28844001
DSDEFEXT DS    0F                                              @D14CDVB 28850000
         DC    X'40'               OPERATION BYTE  --- READ             28900000
         DC    XL3'0'              ARCHITECTED AS HEX'0'                28950000
DSEXTBL  DC    F'0'                PHYSICAL START ADDRESS      @D14CDVB 29000000
DSEXTBEG DC    F'0'                RELATIVE START ADDRESS      @D14CDVB 29050000
DSEXTEND DC    F'0'                RELATIVE END ADDRESS        @D14CDVB 29100000
*-------------------------------------------------------------*@D14CDVB 29150000
DSDEFXEC DS    0F                                              @D61NDVB 29155501
         DC    X'00'               OPERATION BYTE  --- READ    @D61NDVB 29161001
         DC    X'C0'               GLOBAL ATTRIBUTES           @D61NDVB 29166501
         DC    AL2(MAXLENLB)       BLOCKSIZE                   @D61NDVB 29172001
         DC    H'0'                                            @D61NDVB 29174701
         DC    X'0'                                            @D61NDVB 29177401
         DC    X'40'               REGULAR DATA FORMAT         @D61NDVB 29180101
DSXECBEG DC    F'0'                START ADDRESS CCHH          @D61NDVB 29183001
DSXECEND DC    F'0'                END ADDRESS   CCHH          @D61NDVB 29188501
*-------------------------------------------------------------*@D61NDVB 29194001
         SPACE 2                                                        29200000
*------  LOCATE DATA   FBA -----------------------------------*@D14CDVB 29250001
         SPACE 1                                                        29300000
PFLOCTXT DS    0F                                              @D14CDVB 29350000
LOCOPBYT EQU   *-PFLOCTXT                                      @D14CDVB 29366601
         DC    XL2'0600'           OPERATION BYTE              @D14CDVB 29383201
NRBLCK   EQU   *-PFLOCTXT                                      @D14CDVB 29399801
         DC    H'0'                # FBA-BLOCKS                @D14CDVB 29416401
LGBLA    EQU   *-PFLOCTXT                                      @D14CDVB 29433001
         DC    F'0'                START ADDR: LOGICAL BLOCK # @D14CDVB 29450000
PFLOCRLD DS    0F                                              @D14CDVB 29500000
         DC    X'06000000'         OPERATION BYTE , #(BLOCKS)  @D14CDVB 29550000
         DC    F'0'                START ADDR: LOGICAL BLOCK # @D14CDVB 29600000
DSLOCLNK DS    0F                                              @D14CDVB 29650000
DSLOCDIR DS    0F                                              @D14CDVB 29700000
         DC    X'06000000'         OPERATION BYTE , #(BLOCKS)  @D14CDVB 29750000
         DC    F'0'                START ADDR: LOGICAL BLOCK # @D14CDVB 29800000
         SPACE 2                                               @D61NDVB 29821401
         SPACE 1                                                        29842801
*------  LOCATE DATA  ECKD   ---------------------------------*@D61NDVB 29864201
         SPACE 1                                                        29885601
PFLOCXET DS    0F                                              @D61NDVB 29907001
         DC    X'160000'           OPERATION BYTE              @D61NDVB 29928401
XLOCNBR  DC    X'01'               NUMBER OF RECORDS           @D61NDVB 29949801
XLOCSEEK DC    F'0'                SEEK  ADDRESS CCHH          @D61NDVB 29971201
XLOCCCHH DC    F'0'                SEARCH ADDRESS CCHHH        @D61NDVB 29992601
XLOCCHR  DC    X'0'                SEARCH ADDRESS      R       @D61NDVB 30014001
XLOCSEC  DC    X'0'                SECTOR VALUE                @D61NDVB 30035401
         DC    H'0'                TRANSFER LENGTH             @D61NDVB 30056801
PFLOCXER DS    0F                                              @D61NDVB 30078201
         DC    X'16000001'         OPERATION BYTE , #(BLOCKS)  @D61NDVB 30099601
         DC    F'0'                SEEK  ADDRESS CCHH          @D61NDVB 30121001
         DC    F'0'                SEARCH ADDRESS CCHHH        @D61NDVB 30142401
         DC    X'0'                SEARCH ADDRESS      R       @D61NDVB 30163801
         DC    X'0'                SECTOR VALUE                @D61NDVB 30185201
         DC    H'0'                TRANSFER LENGTH             @D61NDVB 30206601
DSLOCXEL DS    0F                                              @D61NDVB 30228001
DSLOCXED DS    0F                                              @D61NDVB 30249401
         DC    X'16000001'         OPERATION BYTE , #(BLOCKS)  @D61NDVB 30270801
         DC    F'0'                SEEK  ADDRESS CCHH          @D61NDVB 30292201
         DC    F'0'                SEARCH ADDRESS CCHHH        @D61NDVB 30313601
         DC    X'0'                SEARCH ADDRESS      R       @D61NDVB 30335001
         DC    X'0'                SECTOR VALUE                @D61NDVB 30356401
         DC    H'0'                TRANSFER LENGTH             @D61NDVB 30377801
*-------------------------------------------------------------*@D14CDVB 30400000
         SPACE 2                                                        30431201
*--------SEEK / SEARCH FOR CKD -------------------------------*@D21ZDVB 30462401
         SPACE 1                                                        30493601
DFICBCTX EQU   PFLOCXET+8          CKD - ADDRESS FOR TXT       @D61NDVB 30524801
DFICBCRL EQU   PFLOCXER+8          CKD - ADDRESS FOR RLD       @D61NDVB 30556001
DFICBCDR EQU   DSLOCXED+8          CKD - ADDRESS FOR DIR       @D61NDVB 30587201
FTBENTRY DC    AL2(FTBORNGL-FTBORNG1)                          @D61NDVB 30618401
         SPACE 1                                                        30650000
*------  FRPL  INITIALISATION TABLE --------------------------*@D14CDVB 30700000
         SPACE 1                                                        30750000
         DS    0F                                              @D14CDVB 30800000
FTBDEV   EQU   *-4                 FRPL INITIALISATION TABLE   @D14CDVB 30850000
         DC    A(FTBORNG1)         FBA TYPE DEVICES            @D14CDVB 30900000
         DC    A(FTBORNG2)         CKD WITHOUT RPS DEVICES     @D14CDVB 30950000
         DC    A(FTBORNG3)         CKD WITH RPS DEVICES        @D14CDVB 31000000
         DC    A(FTBORNG4)         ECKD DEVICES                @D61NDVB 31025001
.*  ---------------------------->  NEW AVRTYPE EXTEND HERE     @D61NDVB 31050001
*-------------------------------------------------------------*@D14CDVB 31075001
FTBORNG1 DS    0F                                              @D14CDVB 31100000
FTBACCW  DC    AL2(CTXTFBA-FCCWTXT) OFFSET TXT CCW STRING      @D14CDVB 31150000
FTBFLAG  DC    XL1'0'                                          @D61NDVB 31200001
FTBDATA  DC    AL1(RDFB)                                       @D14CDVB 31250000
FTBAMOD  DC    A(FMODFBA)          ADDRESS OF GENERATION MODEL @D14CDVB 31300000
FTBVADR  DC    A(FTICF)            ADDR. OF TIC                @D14CDVB 31350000
FTBADEXT DC    A(PFDEFEXT)                                     @D61NDVB 31364201
FTBADBBC EQU   FTBADEXT                                        @D61NDVB 31378401
FTBADLOC DC    A(PFLOCTXT)                                     @D61NDVB 31392601
FTBADCHR DC    A(0)                                            @D61NDVB 31406801
FTBORNGL EQU   *                                               @D61NDVB 31421001
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *@D61NDVB 31435201
         DC    AL2(CRLDFBA-FCCWRLD) OFFSET RLD CCW STRING      @D14CDVB 31450000
         DC    XL1'0'                                          @D61NDVB 31500001
         DC    AL1(RDFB)                                       @D14CDVB 31550000
         DC    A(FRLDF)                                        @D14CDVB 31600000
         DC    A(FRLDF)                                        @D14CDVB 31650000
         DC    A(PFDEFEXT)                                     @D61NDVB 31670001
         DC    A(PFLOCRLD)                                     @D61NDVB 31690001
         DC    A(0)                                            @D61NDVB 31710001
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *@D61NDVB 31730001
         DC    AL2(CDIRFBA-FCCWDIR) OFFSET OF CCW STRING       @D14CDVB 31750000
         DC    XL1'0'                                          @D61NDVB 31800001
         DC    AL1(RDFB)                                       @D14CDVB 31850000
         DC    A(FDIRF)                                        @D14CDVB 31900000
         DC    A(FDIRF)                                        @D14CDVB 31950000
         DC    A(DSDEFEXT)                                     @D61NDVB 31970001
         DC    A(DSLOCDIR)                                     @D61NDVB 31990001
         DC    A(0)                                            @D61NDVB 32010001
*-------------------------------------------------------------*@D14CDVB 32030001
FTBORNG2 DS    0F                                              @D14CDVB 32050000
         DC    AL2(0)              OFFSET TXT CCW STRING       @D14CDVB 32100000
         DC    AL2(READDATA)                                   @D14CDVB 32150000
         DC    A(FMODCKD)          ADDRESS OF GENERATION MODEL @D14CDVB 32200000
         DC    A(FTICN)            ADDRESS OF TIC              @D14CDVB 32250000
         DC    A(DFICBCTX-4)                                   @D61NDVB 32270001
         DC    A(0)                                            @D61NDVB 32290001
         DC    A(DFICBCTX)                                     @D61NDVB 32310001
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *@D61NDVB 32330001
         DC    AL2(0)              OFFSET RLD CCW STRING       @D14CDVB 32350000
         DC    H'0'                                            @D14CDVB 32400001
         DC    A(FRLDN)                                        @D14CDVB 32450000
         DC    A(FRLDN)                                        @D14CDVB 32500000
         DC    A(DFICBCRL-4)                                   @D61NDVB 32520001
         DC    A(0)                                            @D61NDVB 32540001
         DC    A(DFICBCRL)                                     @D61NDVB 32560001
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *@D61NDVB 32580001
         DC    AL2(0)              OFFSET DIR CCW STRING       @D14CDVB 32600000
         DC    H'0'                                            @D14CDVB 32650001
         DC    A(FDIRN)                                        @D14CDVB 32700000
         DC    A(FDIRN)                                        @D14CDVB 32750000
         DC    A(DFICBCDR-4)                                   @D61NDVB 32780001
         DC    A(0)                                            @D61NDVB 32810001
         DC    A(DFICBCDR)                                     @D61NDVB 32840001
*-------------------------------------------------------------*@D14CDVB 32870001
FTBORNG3 DS    0F                                              @D14CDVB 32900000
         DC    AL2(CTXTRPS-FCCWTXT) OFFSET TXT CCW STRING      @D14CDVB 32950000
         DC    AL2(READDATA)                                   @D14CDVB 33000001
         DC    A(FMODRPS)          ADDRESS OF GENERATION MODEL @D14CDVB 33050000
         DC    A(FTICR)                                        @D14CDVB 33100000
         DC    A(DFICBCTX-4)                                   @D61NDVB 33120001
         DC    A(0)                                            @D61NDVB 33140001
         DC    A(DFICBCTX)                                     @D61NDVB 33160001
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *@D61NDVB 33180001
         DC    AL2(CRLDRPS-FCCWRLD) OFFSET RLD CCW STRING      @D14CDVB 33200000
         DC    H'0'                                            @D14CDVB 33250001
         DC    A(FRLDR)                                        @D14CDVB 33300000
         DC    A(FRLDR)                                        @D14CDVB 33350000
         DC    A(DFICBCRL-4)                                   @D61NDVB 33370001
         DC    A(0)                                            @D61NDVB 33390001
         DC    A(DFICBCRL)                                     @D61NDVB 33410001
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *@D61NDVB 33430001
         DC    AL2(CDIRRPS-FCCWDIR) OFFSET DIR CCW STRING      @D14CDVB 33450000
         DC    H'0'                                            @D14CDVB 33500001
         DC    A(FDIRR)                                        @D14CDVB 33550000
         DC    A(FDIRR)                                        @D14CDVB 33600000
         DC    A(DFICBCDR-4)                                   @D61NDVB 33603201
         DC    A(0)                                            @D61NDVB 33606401
         DC    A(DFICBCDR)                                     @D61NDVB 33609601
*-------------------------------------------------------------*@D14CDVB 33612801
FTBORNG4 DS    0F                                              @D14CDVB 33616001
         DC    AL2(CTXTECKD-FCCWTXT) OFFSET TXT CCW STRING     @D61NDVB 33619201
         DC    XL1'2'              FLAGS                       @D61NDVB 33622401
         DC    AL1(READDATA)       OPCODE                      @D61NDVB 33625601
         DC    A(FMODECKD)         ADDRESS OF GENERATION MODEL @D61NDVB 33628801
         DC    A(FTICE)                                        @D61NDVB 33632001
         DC    A(PFDEFXEC)                                     @D61NDVB 33635201
         DC    A(PFLOCXET)                                     @D61NDVB 33638401
         DC    A(DFICBCTX)                                     @D61NDVB 33641601
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *@D61NDVB 33644801
         DC    AL2(CRLDECKD-FCCWRLD) OFFSET RLD CCW STRING     @D61NDVB 33648001
         DC    H'0'                FLAGS + DATA CHAINING       @D61NDVB 33651201
         DC    A(FRLDE)                                        @D61NDVB 33654401
         DC    A(FRLDE)                                        @D61NDVB 33657601
         DC    A(PFDEFXEC)                                     @D61NDVB 33660801
         DC    A(PFLOCXER)                                     @D61NDVB 33664001
         DC    A(DFICBCRL)                                     @D61NDVB 33667201
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *@D61NDVB 33670401
         DC    AL2(CDIRECKD-FCCWDIR) OFFSET DIR CCW STRING     @D61NDVB 33673601
         DC    H'0'                FLAGS + DATA CHAINING       @D61NDVB 33676801
         DC    A(FDIRE)                                        @D61NDVB 33680001
         DC    A(FDIRE)                                        @D61NDVB 33683201
         DC    A(DSDEFXEC)                                     @D61NDVB 33686401
         DC    A(DSLOCXED)                                     @D61NDVB 33689601
         DC    A(DFICBCDR)                                     @D61NDVB 33692801
.*  ---------------------------->  NEW AVRTYPE EXTEND HERE     @D61NDVB 33696001
         SPACE 2                                                        33700000
*-----SHIFTTAB -----------------------------------------------*@D14CDVB 33750000
         SPACE 1                                                        33800000
FSHIFTAB DC    X'09'               SHIFT FOR 512 BYTES         @D14CDVB 33850000
         DC    X'0A'               SHIFT FOR 1024 BYTES        @D14CDVB 33900000
         DC    X'0B'               SHIFT FOR 2048 BYTES        @D14CDVB 33950000
         DC    X'0'                PLACE_HOLDER                @D14CDVB 34000000
         DC    X'0C'               SHIFT FOR 4096 BYTES        @D14CDVB 34050000
         DC    XL3'0'              PLACE_HOLDER                @D14CDVB 34100000
         DC    X'0D'               SHIFT VALUE FOR 8192 BYTES  @D14CDVB 34150000
         SPACE 2                                                        34200000
*-------------------------------------------------------------*@D14CDVB 34250000
         SPACE 2                                                        34300000
*----CCW STRINGS  --------------------------------------------*@D14CDVB 34350000
         SPACE 1                                                        34400000
FCCWDIR  DS    0D                                              @D14CDVB 34450000
         CCW   SEEK,DFICBCDR-2,CC,6                            @D14CDVB 34500001
         CCW   SEARCH,DFICBCDR+CC@,CC+SLI,5                    @D14CDVB 34550000
FTICOP   CCW   TIC,*-8,0,0                                     @D14CDVB 34600000
FDIRN    CCW   READDATA,FDIRBUF,SLI,MAXLENLB                   @D14CDVB 34650000
         SPACE 1                                                        34700000
*-------------------------------------------------------------*@D14CDVB 34750000
         SPACE 1                                                        34800000
CDIRRPS  DS    0D                   LABEL OF RPS_CCW IF ANY    @D14CDVB 34850000
         CCW   SEEK,DFICBCDR-2,CC,6                            @D14CDVB 34900001
         CCW   STSECT,DFICBCDR+SECT@,CC,1                      @D14CDVB 35000000
         CCW   SEARCH,DFICBCDR+CC@,CC+SLI,5                    @D14CDVB 35050000
         CCW   TIC,*-8,0,0                                     @D14CDVB 35100000
         CCW   READDATA,FDIRBUF,SLI,MAXLENLB                   @D14CDVB 35150000
FDIRR    EQU   *-8                  LABEL FOR LRA - IF FBA_CCW @D14CDVB 35200001
         SPACE 1                                                        35300000
*-------------------------------------------------------------*@D14CDVB 35350000
         SPACE 1                                                        35400000
CDIRFBA  DS    0D                   LABEL FOR FBA_CCW - IF ANY @D14CDVB 35450000
         CCW   DEXT,DSDEFEXT,CC+SLI,16                         @D14CDVB 35500000
         CCW   LOCT,DSLOCDIR,CC+SLI,8                          @D14CDVB 35550000
         CCW   RDFB,FDIRBUF,SLI,MAXLENLB                       @D14CDVB 35600000
FDIRF    EQU   *-8                  LABEL FOR LRA - IF FBA_CCW @D14CDVB 35650000
         SPACE 1                                                        35700000
*-------------------------------------------------------------*@D14CDVB 35750000
         SPACE 1                                                        35800000
CDIRECKD DS    0D                   LABEL FOR ECKD - CCW       @D61NDVB 35805501
         CCW   DEXT,DSDEFXEC,CC+SLI,16                         @D61NDVB 35811001
         CCW   LOCTX,DSLOCXED,CC+SLI,16                        @D61NDVB 35816501
         CCW   READDATA,FDIRBUF,SLI,MAXLENLB                   @D61NDVB 35822001
FDIRE    EQU   *-8                  LABEL FOR LRA              @D61NDVB 35827501
         SPACE 1                                                        35833001
*-------------------------------------------------------------*@D14CDVB 35838501
         SPACE 1                                                        35844001
FCCWRLD  DS    0D                                              @D14CDVB 35850000
         CCW   SEEK,DFICBCRL-2,CC,6                            @D14CDVB 35900001
         CCW   SEARCH,DFICBCRL+CC@,CC+SLI,5                    @D14CDVB 35950000
         CCW   TIC,*-8,0,0                                     @D14CDVB 36000000
FRLDN    CCW   READDATA,FRLDBUF,SLI,MAXLENLB                   @D14CDVB 36050000
         SPACE 1                                                        36100000
*-------------------------------------------------------------*@D14CDVB 36150000
         SPACE 1                                                        36200000
CRLDRPS  DS    0D                   LABEL OF RPS_CCW - IF ANY  @D14CDVB 36250000
         CCW   SEEK,DFICBCRL-2,CC,6                            @D14CDVB 36300001
         CCW   STSECT,DFICBCRL+SECT@,CC,1                      @D14CDVB 36400000
         CCW   SEARCH,DFICBCRL+CC@,CC+SLI,5                    @D14CDVB 36450000
         CCW   TIC,*-8,0,0                                     @D14CDVB 36500000
         CCW   READDATA,FRLDBUF,SLI,MAXLENLB                   @D14CDVB 36550000
FRLDR    EQU   *-8                  LABEL FOR LRA - IF RPS_CCW @D14CDVB 36650000
         SPACE 1                                                        36700000
*-------------------------------------------------------------*@D14CDVB 36750000
         SPACE 1                                                        36800000
CRLDFBA  DS    0D                   LABEL OF FBA_CCW - IF ANY  @D14CDVB 36850000
         CCW   DEXT,PFDEFEXT,CC+SLI,16                         @D14CDVB 36900000
         CCW   LOCT,PFLOCRLD,CC+SLI,8                          @D14CDVB 36950000
         CCW   RDFB,FRLDBUF,SLI,MAXLENLB                       @D14CDVB 37000000
CRLDFBL  EQU   *-2                                             @D14CDVB 37050000
FRLDF    EQU   *-8                  LABEL FOR LRA - IF FBA_CCW @D14CDVB 37100000
         SPACE 1                                                        37150000
*-------------------------------------------------------------*@D14CDVB 37200000
         SPACE 1                                                        37250000
CRLDECKD DS    0D                   LABEL OF ECKD - CCW        @D61NDVB 37255001
         CCW   DEXT,PFDEFXEC,CC+SLI,16                         @D61NDVB 37260001
         CCW   LOCTX,PFLOCXER,CC+SLI,16                        @D61NDVB 37265001
         CCW   READDATA,FRLDBUF,SLI,MAXLENLB                   @D61NDVB 37270001
CRLDECL  EQU   *-2                                             @D61NDVB 37275001
FRLDE    EQU   *-8                  LABEL FOR LRA              @D61NDVB 37280001
         SPACE 1                                                        37285001
*-------------------------------------------------------------*@D14CDVB 37290001
         SPACE 1                                                        37295001
FCCWTXT  DS    0D                                              @D14CDVB 37300000
         CCW   SEEK,DFICBCTX-2,CC,6                            @D14CDVB 37350001
         CCW   SEARCH,DFICBCTX+CC@,CC+SLI,5                    @D14CDVB 37400000
         CCW   TIC,*-8,0,0                                     @D14CDVB 37450000
FTICN    CCW   TIC,FSTCCW,0,0                                  @D14CDVB 37500000
         SPACE 1                                                        37550000
*-------------------------------------------------------------*@D14CDVB 37600000
         SPACE 1                                                        37650000
CTXTRPS  DS    0D                   LABEL OF RPS_CCW - IF ANY  @D14CDVB 37700000
         CCW   SEEK,DFICBCTX-2,CC,6                            @D14CDVB 37750001
         CCW   STSECT,DFICBCTX+SECT@,CC,1                      @D14CDVB 37850000
         CCW   SEARCH,DFICBCTX+CC@,CC+SLI,5                    @D14CDVB 37900000
         CCW   TIC,*-8,0,0                                     @D14CDVB 37950000
FTICR    CCW   TIC,FSTCCW,0,0                                  @D14CDHD 38050000
         SPACE 1                                                        38100000
*-------------------------------------------------------------*@D14CDVB 38150000
         SPACE 1                                                        38200000
CTXTFBA  DS    0D                   LABEL OF FBA_CCW - IF ANY  @D14CDVB 38250000
         CCW   DEXT,PFDEFEXT,CC+SLI,16                         @D14CDVB 38300000
         CCW   LOCT,PFLOCTXT,CC+SLI,8                          @D14CDVB 38350000
FTICF    CCW   TIC,FSTCCW,0,0                                  @D14CDHD 38400000
         SPACE 1                                                        38450000
*-------------------------------------------------------------*@D14CDVB 38500000
         SPACE 1                                                        38506201
CTXTECKD DS    0D                   LABEL OF ECKD-CCW          @D61NDVB 38512401
         CCW   DEXT,PFDEFXEC,CC+SLI,16                         @D61NDVB 38518601
         CCW   LOCTX,PFLOCXET,CC+SLI,16                        @D61NDVB 38524801
FTICE    CCW   TIC,FSTCCW,0,0                                  @D61NDVB 38531001
         SPACE 1                                                        38537201
*-------------------------------------------------------------*@D14CDVB 38543401
FMODFBA  DS    0D                                              @D14CDVB 38550000
         CCW   RDFB,0,SLI+DCBIT,MAXLENLB  GENERATION MODEL FBA @D14CDVB 38600000
         CCW   TIC,CRLDFBA+8,0,0                               @D14CDHD 38650000
*-------------------------------------------------------------*@D14CDVB 38700000
FMODCKD  CCW   READDATA,0,CC+SLI,MAXLENLB )  GENERATION MODEL  @D14CDVB 38750000
         CCW   TIC,FCCWRLD,0,0          )        NORMAL CKD    @D14CDHD 38800000
*-------------------------------------------------------------*@D14CDVB 38850000
FMODRPS  DS    0D                                              @D14CDVB 38900000
         CCW   READDATA,0,CC+SLI,MAXLENLB )  GENERATION MODEL  @D14CDVB 39000000
         CCW   TIC,CRLDRPS,0,0            )        RPS CKD     @D14CDHD 39050000
*-------------------------------------------------------------*@D14CDVB 39100000
FMODECKD DS    0D                                              @D61NDVB 39120001
         CCW   READDATA,0,SLI+CC,MAXLENLB GENERATION MODEL     @D61NDVB 39140001
         CCW   TIC,CRLDECKD+8,0,0                  ECKD        @D61NDVB 39160001
*-------------------------------------------------------------*@D61NDVB 39180001
         SPACE 1                                                        39200000
         SPACE 1                                               @D35EDVB 39250000
*---- OFFSET TABLE --------------------------------------------@D35EDVB 39300000
          SPACE 1                                                       39350000
FOFFTAB  DS    0H                                              @D35EDVB 39400000
         DC    AL2(FSVC23-FOFFTAB) HANDLING ENTRY FOUND IN DIR @D35EDVB 39450000
         DC    AL2(FSVC23-FOFFTAB)                             @D37CDVB 39500000
FOFFSVC4 DC    AL2(FGTTXT-FOFFTAB) ENTRY FOUND FETCH PROGRAM   @D37CDVB 39550000
         DC    AL2(FNOTXT-FOFFTAB) ENTRY FOUND NO TEXT OPTION  @D35EDVB 39600000
         DC    AL2(FSVC51-FOFFTAB) HANDLING ENTRY FOUND IN DIR @D35EDVB 39650000
         DC    AL2(FSVC51-FOFFTAB)                             @D37CDVB 39700000
FOFFDIST EQU   *-FOFFSVC4                                      @D37CDVB 39750000
         DC    XL2'0'              UNUSED                      @DA33314 39800000
         DC    XL2'0'              UNUSED                      @DA33314 39850000
         DC    AL2(FSVC23-FOFFTAB) HANDLING ENTRY IN SVA       @D35EDVB 39900000
         DC    AL2(FSVC23-FOFFTAB)                             @D37CDVB 39950000
         DC    AL2(FPHSVA-FOFFTAB) PHASE IN SVA                @D35EDVB 40000000
         DC    AL2(FPHSVA-FOFFTAB) NO TEXT OPTION ENTRY IN SVA @D35EDVB 40050000
         DC    AL2(FSVC51-FOFFTAB) HANDLING ENTRY IN SVA       @D35EDVB 40100000
         DC    AL2(FSVC51-FOFFTAB)                             @D37CDVB 40150000
         DC    XL4'0'                                          @D37DDVB 40200000
         DC    AL2(FTCHEX05-FOFFTAB) SVC 23 -- NOT FOUND       @DA35102 40250000
         DC    AL2(FTCHEX05-FOFFTAB)                           @DA35102 40300000
         DC    AL2(FNTFND2-FOFFTAB) NORMAL -- NOT FOUND        @D14CDVB 40350000
         DC    AL2(FNTFND1-FOFFTAB) NO TEXT OPTION - NOT FOUND @D35EDVB 40400000
         DC    AL2(FSVC51N-FOFFTAB) SVC 51 -- NOT FOUND        @D14CDVB 40450000
         DC    AL2(FSVC51N-FOFFTAB) SVC 51 -- NOT FOUND        @D14CDVB 40500000
         DC    XL2'0'               UNUSED                     @DA33314 40550000
         DC    XL2'0'               UNUSED                     @DA33314 40600000
         DC    AL2(FNTFND1-FOFFTAB) SVC 23 -- ERROR            @D14CDVB 40650000
         DC    AL2(0)                                          @D14CDVB 40700000
         DC    AL2(FNTFND1-FOFFTAB) NORMAL  -- ERROR           @D14CDVB 40750000
         DC    AL2(FNTFND1-FOFFTAB) NO TEXT OPTION - ERROR     @D14CDVB 40800000
         DC    AL2(FNTFND1-FOFFTAB) SVC 51 -- ERROR            @D14CDVB 40850000
         DC    AL2(FNTFND1-FOFFTAB) SVC 51 -- ERROR            @D14CDVB 40900000
         SPACE 2                                               @D21ZDVB 40950000
*---- EXECUTABLE CODE, USDE BY DIFFERENT SUBROUTINES ----------@D52VDMZ 40954101
         USING DIRECTRY,R1                                     @D52VDMZ 40958201
LDVSE    L     R2,DIRACOPY        ADD(SVA_COPY(DE))            @D52VDMZ 40962301
ICMOLD   ICM   R2,7,DIRCOPY       ADD(SVA_COPY(DE))            @D52VDMZ 40966401
         SPACE 1                                               @D21ZDVB 40970501
CLILENTR CLI   DIRN,0             TEST FOR DIRECTORY ENTRY     @D52VDMZ 40974601
         SPACE 1                                               @D21ZDVB 40978701
STVSE    ST    R0,DIRACOPY        ADD(SVA_COPY(DE))            @D52VDMZ 40982801
STMOLD   STCM  R0,7,DIRCOPY       ADD(SVA_COPY(DE))            @D52VDMZ 40986901
         DROP  R1                                              @D52VDMZ 40991001
         SPACE 2                                               @D21ZDVB 40995101
         AIF   (NOT &BGDSHR).NDSHR60                           @D36SDVB 41000000
         SGSLDUP TAB=YES                                       @D36SDVB 41050000
         EJECT                                                 @D36SDVB 41100000
.NDSHR60 ANOP                                                  @D36SDVB 41150000
         AIF   (NOT &BGFSTAT).FSTATND                          @D35ZDVB 41200000
   TITLE 'DOS SUPERVISOR        SGAFCH         FETCH STATISTIC CODE '   41250000
*------  FETCH STATISTICS ---------------------------*@D14CDVB @D35ZDVB 41300000
         SPACE  2                                                       41350000
*------- CONTROL FIELDS -----------------------------*@D14CDVB @D35ZDVB 41400000
FACTIVNR DC    F'0'                NUMBER OF FETCH REQUESTS    @D35ZDVB 41450000
FDIRTSK# DC    F'0'                NUMBER OF DIR TASK REQ.     @D36ZDVB 41500000
FPGMTSK# DC    F'0'                NUMBER OF PGM TASK REQ.     @D36ZDVB 41550000
NDIRTSK# DC    F'0'                NUMBER OF NONE SATISFIED DIR        *41600000
                                             TASK REQUESTS     @D36ZDVB 41650000
NPGMTSK# DC    F'0'                NUMBER OF NONE SATISFIED PGM        *41700000
                                             TASK REQUESTS     @D36ZDVB 41750000
FNCT$BNR DC    F'0'                NUMBER OF NOT SATISFIED SVC2@D35ZDVB 41800000
FACT$BNR DC    F'0'                NUMBER OF SVC2  ACTIVATIONS @D35ZDVB 41850000
*-------------------------------------------------------------*@D36ZDVB 41900000
FACTREAL DC    F'0'                NUMBER OF FETCH (REAL MODE) @D35ZDVB 41950000
FRLDIONR DC    F'0'                NUMBER OF RLD I/OS          @D35ZDVB 42000000
FTXTIONR DC    F'0'                NUMBER OF TXT I/OS          @D35ZDVB 42050000
FACTTXT  DC    F'0'                NUMBER OF FETCH (TXT )      @D35ZDVB 42100000
*-------------------------------------------------------------*@D36ZDVB 42150000
FACTDIR  DC    F'0'                NUMBER OF FETCH (DIR )      @D35ZDVB 42200000
FDIRIONR DC    F'0'                NUMBER OF DIR I/OS          @D35ZDVB 42250000
*-------------------------------------------------------------*@D36ZDVB 42300000
F$CTREAL DC    F'0'                NUMBER OF FETCH (REAL MODE) @D35ZDVB 42350000
F$LDIONR DC    F'0'                NUMBER OF RLD I/OS          @D35ZDVB 42400000
F$XTIONR DC    F'0'                NUMBER OF TXT I/OS          @D35ZDVB 42450000
F$CTTXT  DC    F'0'                NUMBER OF FETCH (TXT )      @D35ZDVB 42500000
*-------------------------------------------------------------*@D36ZDVB 42550000
F$CTDIR  DC    F'0'                NUMBER OF FETCH (DIR )      @D35ZDVB 42600000
F$IRIONR DC    F'0'                NUMBER OF DIR I/OS          @D35ZDVB 42650000
*-------------------------------------------------------------*@D36ZDVB 42700000
FNTFIXNR DC    F'0'                NUMBER OF NOT SATISFIED TFIX@D35ZDVB 42750000
FGT64K   DC    F'0'                NUMBER OF PHASES GT THAN 64K@D35ZDVB 42800000
*-------------------------------------------------------------*@D36ZDVB 42850000
FAVRTFX  DC    F'0'                AVERAGE OF REQ TFIX PAGES   @D35ZDVB 42900000
FAVSTFX  DC    F'0'                AVERAGE OF SATISF TFIX PAGES@D35ZDVB 42950000
FAVRLIO  DC    F'0'                AVERAGE OF RLD I/OS         @D35ZDVB 43000000
FAVTXIO  DC    F'0'                AVERAGE OF TXT I/OS         @D35ZDVB 43050000
*-------------------------------------------------------------*@D36ZDVB 43100000
FAVDIRS  DC    F'0'                AVERAGE OF SEARCHED DIRECT  @D35ZDVB 43150000
FAVDRIO  DC    F'0'                AVERAGE OF DIR I/OS         @D35ZDVB 43200000
*-------------------------------------------------------------*@D36ZDVB 43250000
F$CRTFX  DC    F'0'                $ AVERG OF REQ TFIX PAGES   @D35ZDVB 43300000
F$CSTFX  DC    F'0'                $ AVERG OF SATISF TFIX PAGES@D35ZDVB 43350000
F$CRLIO  DC    F'0'                $ AVERG   RLD I/OS          @D35ZDVB 43400000
F$CTXIO  DC    F'0'                $ AVERAGE TXT I/OS          @D35ZDVB 43450000
*-------------------------------------------------------------*@D36ZDVB 43500000
F$CDIRS  DC    F'0'                $ AVERG OF SEARCHED DIRECT  @D35ZDVB 43550000
F$CDRIO  DC    F'0'                $ AVERG   DIR I/OS          @D35ZDVB 43600000
*-------------------------------------------------------------*@D36ZDVB 43650000
FLCRTFX  DC    F'0'                LOCAL V OF REQ TFIX PAGES   @D35ZDVB 43700000
FLCSTFX  DC    F'0'                LOCAL V OF SATISF TFIX PAGES@D35ZDVB 43750000
FLCRLIO  DC    F'0'                LOCAL V   RLD I/OS          @D35ZDVB 43800000
FLCTXIO  DC    F'0'                LOCAL V   TXT I/OS          @D35ZDVB 43850000
FLCTXTN  DC    F'0'                LOCAL V   TXT               @D35ZDVB 43900000
*-------------------------------------------------------------*@D36ZDVB 43950000
FLCDIRS  DC    F'0'                LOCAL V OF SEARCHED DIRECT  @D35ZDVB 44000000
FLCDRIO  DC    F'0'                LOCAL V   DIR I/OS          @D35ZDVB 44050000
*-------------------------------------------------------------*@D36ZDVB 44100000
DAVGSTAT DC    A(FAVGSTAT)         EP TO AVERAGE CALCULATION   @D35ZDVB 44150000
*-------------------------------------------------------------*@D36ZDVB 44200000
DSTATSAV DS    12F                                             @D36ZDVB 44250000
FLCSTAT$ DS    5F                                              @D35ZDVB 44300000
         EJECT                                                 @D35ZDVB 44350000
*--------------------------------------------------------------@D35ZDVB 44400000
*     STATISTICS MODULE                                        @D35ZDVB 44450000
*--------------------------------------------------------------@D35ZDVB 44500000
         SPACE 1                                                        44550000
FAVGSTAT DS    0H                                              @D35ZDVB 44600000
         USING DFCB,R11                                        @D36ZDVB 44650000
         STM   RE,R9,DSTATSAV      SAVE REGS OF CALLER         @D35ZDVB 44700000
         BALR  R9,0                BASE REG                    @D35ZDVB 44750000
         USING *,R9                )                           @D35ZDVB 44800000
         USING TCBADR,RA           ) ADDRESSIBILITY            @D36IDVB 44850000
         DROP  R6                                              @D14CDVB 44900000
         XR    R6,R6                                           @D35ZDVB 44950000
         LR    R1,R6                                           @D36ZDVB 45000000
         CLI   DFWKNAME,C'$'       REQUEST FOR $-PHASE         @D36JDVB 45050000
         BNE   *+8                                             @D35ZDVB 45100000
         LA    R6,6*4                                          @D35ZDVB 45150000
         CLI   TIDBYTE,DIRTID      DIRECTORY SEARCH TASKON     @D36ZDVB 45200000
         BE    FDIRSTAT            YES ----->                  @D36ZDVB 45250000
FPGMSTAT EQU   *                                               @D36ZDVB 45300000
         LA    R1,3                LOOP COUNTER                @D35ZDVB 45350000
         LA    R2,FRLDIONR-4(R6)   START OF LOOP               @D35ZDVB 45400000
         LA    R3,FLCRLIO-4        START OF LOOP               @D35ZDVB 45450000
FAVGLP1  EQU   *                                               @D35ZDVB 45500000
         LA    R2,4(R2)                                        @D35ZDVB 45550000
         LA    R3,4(R3)                                        @D35ZDVB 45600000
         L     R4,0(R2)                                        @D35ZDVB 45650000
         AL    R4,0(R3)            UPDATE TOTAL DIR            @D35ZDVB 45700000
         ST    R4,0(R2)                                        @D35ZDVB 45750000
         BCT   R1,FAVGLP1                                      @D35ZDVB 45800000
         SPACE 1                                                        45850000
         TM    DFCBSW1,REALMASK    REAL MODE                   @D35ZDVB 45900000
         BO    FAVCRL              YES-->                      @D35ZDVB 45950000
         LA    R7,FAVRTFX(R6)                                  @D35ZDVB 46000000
         L     R3,FACTTXT(R6)      CONSIDER NUMBER OF          @D35ZDVB 46050000
         SL    R3,FACTREAL(R6)        RELEVANT ACTIVATIONS     @D35ZDVB 46100000
         L     R1,FLCRTFX                                      @D36ZDVB 46150000
         BAL   LINK1,FAVGE                                     @D35ZDVB 46200000
         L     R1,FLCSTFX                                      @D36ZDVB 46250000
         LA    R7,FAVSTFX(R6)                                  @D35ZDVB 46300000
         BAL   LINK1,FAVGE                                     @D35ZDVB 46350000
         B     FAVCNT                                          @D35ZDVB 46400000
FAVCRL   L     R3,FACTREAL(R6)                                 @D35ZDVB 46450000
         LA    R3,1(R3)            DO NOT UPDATE VIRTUAL       @D35ZDVB 46500000
         ST    R3,FACTREAL(R6)            STATISTICS           @D35ZDVB 46550000
FAVCNT   EQU   *                                               @D36ZDVB 46600000
         L     R3,FRLDIONR(R6)                                 @D36ZDVB 46650000
         L     R1,FLCRLIO                                      @D36ZDVB 46700000
         LA    R7,FAVRLIO(R6)                                  @D36ZDVB 46750000
         BAL   LINK1,FAVGE                                     @D35ZDVB 46800000
         L     R3,FTXTIONR(R6)                                 @D36ZDVB 46850000
         L     R1,FLCTXIO                                      @D36ZDVB 46900000
         LA    R7,FAVTXIO(R6)                                  @D36ZDVB 46950000
         BAL   LINK1,FAVGE                                     @D35ZDVB 47000000
         B     FAVEXIT                                         @D36ZDVB 47050000
*-------------------------------------------------------------*@D36ZDVB 47100000
FDIRSTAT EQU   *                                               @D36ZDVB 47150000
FAVGLP2  EQU   *                                               @D36ZDVB 47200000
         L     R2,FACTDIR(R6)                                  @D36ZDVB 47250000
         AL    R2,FLCDIRS                                      @D36ZDVB 47300000
         ST    R2,FACTDIR(R6)                                  @D36ZDVB 47350000
         L     R2,FDIRIONR(R6)                                 @D36ZDVB 47400000
         AL    R2,FLCDRIO                                      @D36ZDVB 47450000
         ST    R2,FDIRIONR(R6)                                 @D36ZDVB 47500000
         LA    R7,FAVDIRS(R6)                                  @D36ZDVB 47550000
         L     R3,FACTDIR(R6)                                  @D36ZDVB 47600000
         L     R1,FLCDIRS                                      @D36ZDVB 47650000
         BAL   LINK1,FAVGE                                     @D36ZDVB 47700000
         L     R3,FDIRIONR(R6)     NUMBER OF DIR I/O           @D36ZDVB 47750000
         LA    R7,FAVDRIO(R6)                                  @D36ZDVB 47800000
         L     R1,FLCDRIO                                      @D36ZDVB 47850000
         BAL   LINK1,FAVGE         AVERAGE CALCULATION         @D36ZDVB 47900000
*-------------------------------------------------------------*@D36ZDVB 47950000
FAVEXIT  EQU   *                                               @D36ZDVB 48000000
         LM    RE,R9,DSTATSAV                                  @D35ZDVB 48050000
         BR    RE                                              @D35ZDVB 48100000
         SPACE 2                                                        48150000
*-------------------------------------------------------------*@D35ZDVB 48200000
*        SUBROUTINE TO CALULATE  AVERAGE VALUES                @D35ZDVB 48250000
*        STANDARD LINKAGE CONVENTIONS: R14=RETURN ADDRESS      @D35ZDVB 48300000
*                                      R13=SAVE AREA ADDRESS   @D35ZDVB 48350000
*        INPUT: R7=POINTER TO AVERAGE VALUE TO BE TO UPDTATED  @D35ZDVB 48400000
*               R3=NUMBER OF ACTIVATIONS                       @D35ZDVB 48450000
*-------------------------------------------------------------*@D35ZDVB 48500000
         SPACE 1                                                        48550000
FAVGE    DS    0H                                              @D35ZDVB 48600000
         STM   R2,R5,FLCSTAT$                                  @D35ZDVB 48650000
         LTR   R3,R3                                           @D35ZDVB 48700000
         BZ    FAVGRT2             NOTHING TO DO IF VALUE ZERO @D35ZDVB 48750000
         XR    R4,R4               CLEAR FOR DIVIDE            @D35ZDVB 48800000
         LTR   R1,R1               DO NOT CONSIDER IF ZERO     @D35ZDVB 48850000
         BZ    FAVGRT2                                         @D35ZDVB 48900000
         SLL   R1,8                                            @D35ZDVB 48950000
         L     R5,0(R7)            GET OLD AVERAGE VALUE       @D36ZDVB 49000000
         LR    R2,R3                                           @D35ZDVB 49050000
         BCTR  R2,0                NUMBER OF ACTIVATIONS - 1   @D35ZDVB 49100000
         LTR   R2,R2                                           @D35ZDVB 49150000
         BZ    FAVGRT3             SET LOCAL VALUE = AVERAGE   @D35ZDVB 49200000
         MR    R4,R2               )                           @D35ZDVB 49250000
         ALR   R5,R1               ) GET NEW AVERAGE           @D35ZDVB 49300000
         DR    R4,R3               )                           @D35ZDVB 49350000
FAVGRT1  ST    R5,0(R7)            SAVE NEW AVERAGE VALUE      @D36ZDVB 49400000
FAVGRT2  LM    R2,R5,FLCSTAT$                                  @D35ZDVB 49450000
         BR    LINK1                                           @D35ZDVB 49500000
FAVGRT3  ST    R1,0(R7)            SAVE LOCAL VALUE            @D36ZDVB 49550000
         B     FAVGRT2                                         @D35ZDVB 49600000
         DS    20F                 PATCH                       @D35ZDVB 49650000
         DROP  R9,RA,FCBPTR                                    @D36ZDVB 49700000
         EJECT                                                 @D35ZDVB 49750000
.FSTATND AIF   (NOT &SGAFCH).PRTGEN                            @D61NDVB 49800001
         PRINT  NOGEN                                          @D37ZDVB 49850000
.PRTGEN  ANOP                                                  @D37ZDVB 49900000
         MEND                                                           49950000
