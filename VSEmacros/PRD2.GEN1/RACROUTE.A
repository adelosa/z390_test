********************************************************************    00010003
*                                                                       00020003
*  $MAC(RACROUTE) COMP(SC1BN) PROD(RACF):                          @LAC 00030003
*                                                                       00040003
*  DESCRIPTIVE NAME:                                                    00050003
*    MACRO INTERFACE TO SAF ROUTER / RACF VM INTERFACE             @M2C 00060003
*                                                                       00070003
*  **PROPRIETARY_STATEMENT********************************************  00080003
*                                                                    *  00090003
*                                                                    *  00100003
*   LICENSED MATERIALS - PROPERTY OF IBM                             *  00110003
*   THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                      *  00120003
*   5655-068 (C) COPYRIGHT IBM CORP. 1976, 1993                      *  00130003
*   SEE COPYRIGHT INSTRUCTIONS                                       *  00140003
*                                                                    *  00150003
*   STATUS= HBB5510                                                  *  00160003
*                                                               @LAC *  00170003
*  **END_OF_PROPRIETARY_STATEMENT*************************************  00180003
*                                                                       00190003
*  FUNCTION:                                                            00200003
*    THE RACROUTE MACRO PROVIDES A STANDARD INTERFACE TO THE MVS        00210003
*    SYSTEM AUTHORIZATION FACILITY (SAF)                                00220003
*    (MODULE NAME - ICHSFR00)                                           00230003
*    THE RACROUTE MACRO PROVIDES A STANDARD INTERFACE TO THE       @M2A 00240003
*    RACF/VM SERVICE MACHINE IN THE VM ENVIRONMENT.                @D4C 00250003
*    FOR RELEASE 1.8.2, RACROUTE SUPPORTS ONLY AUTHORIZATION       @D4C 00260003
*    CHECKING.                                                     @D4C 00270003
*                                                                       00280003
*  INVOCATION:                                                          00290003
*    THE SAF ROUTER IS INVOKED BY THE RACROUTE MACRO VIA A              00300003
*    BRANCH-AND-LINK INSTRUCTION                                        00310003
*    RACF SERVICES IN THE VM ENVIRONMENT ARE INVOKED VIA THE       @M2A 00320003
*    DIAGNOSE FACILITY WHEN THE RELEASE OF 1.8.2 IS SPECIFIED.     @D4C 00330003
*                                                                       00340003
*    REQUIREMENTS FOR USE - 1) THE CALLER MUST HAVE REGISTER 13         00350003
*                              POINTING TO A SAVE AREA                  00360003
*                              (STANDARD LINKAGE)                       00370003
*                                                                       00380003
*  CHANGE ACTIVITY:                                                     00390003
*    $T0=UZ90211,SAF/RF15,811015,CNTDSD:                           @T0A 00400003
*    $L5=HRF1502,RACF/150,820223,CNTDSD:                           @L5A 00410003
*    $L6=HRF1602,RACF/160,830307,CNTDSD:                           @L6A 00420003
*    UZ90283                                                   @ZA90283 00430003
*    UZ90284                                                   @ZA90284 00440003
*    UZ90285                                                   @ZA90285 00450003
*    $L8=HRF1802,RACF/180,860820,CNTDSD:                           @L8A 00460003
*    $P1=HRF1802,RACF/180,870904,CNTDSD: PEQ0160                   @P1A 00470003
*    $M1=JRF1812,RACF/181,870904,RNH:                              @M1A 00480003
*    $M2=HRF1822,RACF/182,871103,JCD1:                             @M2A 00490003
*    $P2=HRF1822,RACF/182,880119,JCD1:                 PGV0001     @P2C 00500003
*    OY12773                                                   @YA12773 00510003
*    $M3=SP313    RACF/190 880328 PDVSZ1: MVS/SP 3.1.3             @M3A 00520003
*    $M4=SP313    RACF/190 880328 PDTGB1: MVS/SP 3.1.3             @M4A 00530003
*    $M5=SP313    RACF/190 880328 PDI_H1: MVS/SP 3.1.3             @M5A 00540003
*    $M6=SP313    RACF/190 880328 PDLCL1: MVS/SP 3.1.3             @M6A 00550003
*    $M7=SP313    RACF/190 880328 PDPWB1: MVS/SP 3.1.3             @M7A 00560003
*    $P3=PGW0002  RACF/190 880328 PDV_Z1: PTM PGW0002              @P3A 00570003
*    $M8=SP313    RACF/190 880328 PDV_Z1: MVS/SP 3.1.3             @M8A 00580003
*    $P4=PGW0015  RACF/190 880503 PDPWB1: PTM PGW0015              @P4A 00590003
*    $P5=PGW0018  RACF/190 880520 PDPWB1: PTM PGW0018              @P5A 00600003
*    $P6=PGW0017  RACF/190 880615 PDI_H1: PTM PGW0017              @P6A 00610003
*    $P7=PGW0025  RACF/190 880803 PDI_H1: PTM PGW0025              @P7A 00620003
*    $P8=PGW0031  RACF/190 880803 PDPWB1: PTM PGW0031              @P8A 00630003
*    $M9=SP313    RACF/190 880803 PDPWB1: MVS/SP 3.1.3             @M9A 00640003
*    $P9=PGW0035  RACF/190 880914 PDI_H1: PTM PGW0035              @P9A 00650003
*    $Q1=PGW0037  RACF/190 880914 PDI_H1: PTM PGW0037              @Q1A 00660003
*    $Q2=PGW0038  RACF/190 880914 PDI_H1: PTM PGW0038              @Q2A 00670003
*    $D1=DGU0025  RACF/190 881221 PDTGB1: DCR 25                   @D1A 00680003
*    $Q3=PGW0047  RACF/190 881221 PDRTS1: PTM PGW0047              @Q3A 00690003
*    $D2=DGU0045  RACF/190 890117 PDPWB1: DCR 45                   @D2A 00700003
*    $D3=DGU0049  RACF/190 890131 PDPWB1: DCR 49                   @D3A 00710003
*    $Q4=PGW0062  RACF/190 890308 PDPWB1: PTM PGW0062              @Q4A 00720003
*    $N1=VMSFS    RACF/190 881104 PDB_S1: SHARED FILE SYSTEM       @N1A 00730003
*    $N2=VM       RACF/190 881104 PDB_S1: VM SUPPORT               @N2A 00740003
*    $N3=RACSTAT  RACF/190 881104 PDB_S1: SUPPORT RACSTAT          @N3A 00750003
*    $D4=DGU0077  RACF/190 890502 PDJCD1: DCR 77                   @D4A 00760003
*    $Q5=PGP0451  RACF/190 890605 PDB_S1: PTM PGP0451              @Q5A 00770003
*              OY20345                                         @YA20345 00780003
*    $Q6=PGP0412  RACF/190 890719 PDRTS1: PTM PGP0412              @Q6A 00790003
*    $Q7=PGP0415  RACF/190 890719 PDI_H1: PTM PGP0415              @Q7A 00800003
*    $Q8=PGP0399  RACF/190 890815 PDB_S1: PTM PGP0399              @Q8A 00810003
*    $Q9=PGP0552  RACF/190 890915 PDB_S1: PTM PGP0552              @Q9A 00820003
*    $R1=PGP0611  RACF/190 890920 PDB_S1: PTM PGP0611              @R1A 00830003
*    $R2=PI90016  RACF/190 891215 PDB_S1: PTM PI90016              @R2A 00840003
*    $R3=PI90028  RACF/190 891220 PDB_S1: PTM PI90028              @R3A 00850003
*    $R4=PI90037  RACF/190 900321 PDJCD1: PTM PI90037(OY43012 AND  @R4A 00860003
*                                            OY47704)              @R4A 00870003
*    $N4=APPCSPE  RACF/190 900625 PDPSB1: OY39629                  @N4A 00880003
*    $N5=APPCSPE  RACF/190 900625 PDA7  : OY39629                  @N5A 00890003
*    $N6=APPC     RACF/192 900904 PDTGL : SUPPORT FOR APPC         @N6A 00900003
*    $R5=PJA0029  RACF/192 910524 PDPSB1: PTM PJA0029              @R5A 00910003
*    $01=OY47989  RACF/190 911012 PDDLR1: PE OF OY43556            @01A 00920003
*    $L9=HPCS     RACF/210 930429 PDMAS1: RELEASE 2.1 SUPPORT      @L9A 00930003
*    $LA=RELID    RACF/210 930507 PDKAF1: RELEASE 2.1 SUPPORT      @LAA 00940003
*    $D5=OW03465  RACF/210 940305 KDRB:   OW03465 (DCR 40)         @D5A 00950003
*    $LB=OW10709  RACF/220 940512 PDJMV1: RELEASE 2.2 SUPPORT      @LBA 00960003
*    $D6=OW10709  RACF/220 940826 PDSWD1: POSIT DCR 11 DO80011     @D6A 00970003
* @D64CDHH: VSE/ESA: Fix for hardwait if WORKA= not specified  @D64CDHH 00980003
* @D64CDHH: VSE/ESA: RELEASE default set to 1.9                @D64CDHH 00990003
*                                                                       01000003
*  CHANGE DESCRIPTIONS:                                                 01010003
*    A000000-999999                                                @T0A 01020003
*    A - SUPPORT FOR LOGSTR/RECVR/WRITER KEYWORDS AND MODIFY FORM  @M3A 01030003
*    A - SUPPORT FOR DIRAUTH AND TOKENMAP REQUESTS                 @M4A 01040003
*    A - SUPPORT FOR VERIFYX REQUEST                               @M5A 01050003
*    A - SUPPORT FOR SECLABL KEYWORD ON REQUEST=DEFINE             @M6A 01060003
*    A - SUPPORT FOR FILTER KEYWORD ON REQUEST=LIST                @M7A 01070003
*    C - FIX FOR MF=M AND RACKECK KEYWORDS                         @P3A 01080003
*    A - SUPPORT FOR TOKENXTR AND TOKENBLD REQUESTS AND REMOTE=    @M8A 01090003
*    D - BRANCH/MATCHGEN FROM RACXTRT UNTIL RACXTRT XMITS          @P4A 01100003
*    C - MATCHGEN KEYWORD ON RACXTRT TO MATCHGN                    @P5A 01110003
*    A - FIX FOR MF=S AND TOKNOUT MISSING                          @P6A 01120003
*    A - ISSUE MNOTE WHEN SUBPOOL SPECIFIED FOR TOKENXTR/MAP/BLD   @P7A 01130003
*    A - REQUEST TYPE 12 FOR BRANCH EXTRACT                        @P8A 01140003
*    A - SUPPORT FOR REQUEST=AUDIT                                 @M9A 01150003
*    A - FIX TO ALLOW ENCRYPT KEYWORD FOR VERIFYX REQUEST          @P9A 01160003
*    A - FIX FOR MF=E WHEN DECOUPL IS SPECIFIED                    @Q1A 01170003
*    C - FIX FOR MF=M WHEN DECOUPL IS SPECIFIED                    @Q2A 01180003
*    D - RACHECK WRITER KEYWORD (IMPLEMENTED VIA WRITER CLASS)     @D1A 01190003
*    A - SUPPORT FOR MF=E MSGRTRN AND MSGSP RACROUTE KEYWORDS      @Q3A 01200003
*    A - ADD TOKNIN/TOKNOUT KEYWORDS TO VERIFY/VERIFYX/TOKNBLD,    @D2A 01210003
*        REMOVE UTOKEN. DISALLOW NON-TOKEN RELATED KEYWORDS ON     @D2A 01220003
*        TOKNBLD REQUESTS.                                         @D2A 01230003
*    A - ADD FORMOUT KEYWORD FOR TOKENMAP REQUESTS                 @D3A 01240003
*    C - CORRECT ERROR MESSGAGE FOR NO TOKNOUT ON VERIFYX          @Q4A 01250003
*    A - SUPPORT LONG NAMES IN SHARED FILE SYSTEM, KEYWORDS             01260003
*        ENTITYX, NEWNAMX AND MENTX.                               @N1A 01270003
*    A - VM VERSION OF RACROUTE, SUPPORT KEYWORDS ECB1, ECB2,           01280003
*        POSTEXI, PREEXI AND USERWRD.                              @N2A 01290003
*    A - SUPPORT TO INVOKE THE MACRO RACSTAT                       @N3A 01300003
*    A - ROLLIN OF RACF 1.8.2 DCR 3 AND DCR 77 GENERAL AUDIT       @D4A 01310003
*    D - REMOVE THE KEYWORD ENTITYX IN THE CALL TO FRACHECK.       @Q5A 01320003
*    A - ERROR MESSAGE AND MNOTE FOR TOKENBLD(MF=S) WHEN THERE IS  @Q6A 01330003
*        NO TOKNOUT SPECIFIED.                                     @Q6A 01340003
*    A - MOVE ERROR MESSAGE TO THE RIGHT COLUMN. ALSO FIX THE      @Q7A 01350003
*        CHECKING FOR RELEASE WIHT THE MSGSUPP MSGSP MSGRTGN       @Q7A 01360003
*        KEYWORD.                                                       01370003
*    A - SUPPORT TO ENSURE THAT ALL THE INVALID KEYWORDS ARE       @Q8A 01380003
*        DISALLOWED. DELETE THE DUPLICATE CHECKS FOR THE INVALID   @Q8A 01390003
*        KEYWORDS AND UPDATE COMMENTS.                             @Q8A 01400003
*    A - SUPPORT TO DISALLOW SUBPOOL FOR REQUEST VERIFYX           @Q9A 01410003
*    C - '&RELEASE' TO '&RELEASE'(1,3) FOR LOGICAL COMPARISON      @R1A 01420003
*        WITH '1.9'                                                @R1A 01430003
*    C - CORRRECT SUPPORT FOR RELEASE 1.8.2                        @R2A 01440003
*    C - CORRRECT SUPPORT FOR RELEASE 1.8.2                        @R3A 01450003
*    C - CHANGE EXPANSION TO CHECK FOR ZERO SAF ROUTER ADDRESS          01460003
*        BEFORE CALLING SAF ROUTER                                 @R4A 01470003
*    C - ERROR MESSAGE ERR03 TO ACCEPT A VARIABLE PARAMETER        @N4A 01480003
*    A - FLAG SETTING IN ICHSAFP FOR RACF VERSION/RELEASE          @N4A 01490003
*    A - A SUPPORT FOR TOKENXTR/TOKENMAP IN CROSS MEMORY MODE      @N5A 01500003
*    A - SUPPORT FOR APPC                                          @N6A 01510003
*    C - STATUS TO CORRECTLY CORRESPOND TO MVS LEVEL               @R5A 01520003
*    C - Ship code for cover letter error                          @01A 01530003
*    A - ADD GLOBAL=YES FOR HPCS                                   @L9A 01540003
*    A - Allow RACF release 2.1 to be specified                    @LAA 01550003
*    A - Allow LOG keyword with REQUEST=FASTAUTH                   @D5A 01560003
*    A - Allow RACF release 2.2 to be specified                    @LBA 01570003
*    A - Add new keywords COPY and COPYLEN for REQUEST=STAT.       @D6A 01580003
*                                                                       01590003
********************************************************************    01600003
         MACRO                                                          01610003
&NAME    RACROUTE &REQUEST=,                                           *01620003
               &REQSTOR=,                                              *01630003
               &SUBSYS=,                                               *01640003
               &WORKA=,                                                *01650003
               &RELATED=,                                              *01660003
               &MF=S,      PARAMS BELOW ARE USED IN FOLLOWING MACROS:  *01670003
               &ACCLVL=,      RACHECK,RACDEF                       @L7A*01680003
               &ACEE=,  RACHECK/AUDIT/DEF/INIT/LIST/XTRT/TKSRV,FRACHECK*01690003
               &ACTINFO=,     RACINIT                                  *01700003
               &APPL=,   RACHECK,FRACHECK,RACLIST,RACINIT,SIGNON   @N6C*01710003
               &ATTR=,        RACHECK,FRACHECK                         *01720003
               &AUDIT=,       RACDEF                                   *01730003
               &BRANCH=,      RACXTRT                              @M5A*01740003
               &CATGORY=,     RACDEF                               @L7A*01750003
               &CHKAUTH=,     RACDEF                               @L5A*01760003
               &CLASS=,  RACHECK/AUDIT/DEF/LIST/XTRT/STAT,FRACHECK @M9C*01770003
               &DATA=,        RACDEF                                   *01780003
               &DECOUPL=,     ALL SERVICES                         @M3A*01790003
               &DDNAME=,      RACHECK,RACDEF                   @YA12773*01800003
               &DERIVE=,      RACXTRT                              @L8A*01810003
               &DSTYPE=,      RACHECK,RACDEF                           *01820003
               &ECB1=,        RACROUTE/VM                          @N2A*01830003
               &ECB2=,        RACROUTE/VM                          @N2A*01840003
               &ENCRYPT=,     RACINIT,RACXTRT                      @L6A*01850003
               &ENTITY=,      RACHECK,FRACHECK,RACDEF,RACXTRT      @L6A*01860003
               &ENTITYX=,     RACAUDIT,RACHECK,RACDEF,RACXTRT      @M9A*01870003
               &ENTRY=,       RACSTAT                              @N3A*01880003
               &COPY=,        RACSTAT                              @D6A*01890003
               &COPYLEN=,     RACSTAT                              @D6A*01900003
               &ENVIR=,       RACLIST,RACDEF,RACINIT               @P1C*01910003
               &ENVRIN=,      RACINIT,SIGNON                       @N6A*01920003
               &ENVROUT=,     RACINIT,SIGNON                       @N6A*01930003
               &ERASE=,       RACDEF                               @L7A*01940003
               &EVENT=,       RACAUDIT                             @M9A*01950003
               &EVQUAL=,      RACAUDIT                             @M9A*01960003
               &EXENODE=,     RACINIT                              @M5A*01970003
               &EXPDT=,       RACDEF                               @L7A*01980003
               &EXPDTX=,      RACDEF                               @L8A*01990003
               &FIELDS=,      RACXTRT                              @L6A*02000003
               &FILESEQ=,     RACHECK,RACDEF                       @L7A*02010003
               &FILTER=,      RACLIST                              @M7A*02020003
               &FLDACC=,      RACXTRT                              @L8A*02030003
               &FORMOUT=,     RACTKSRV                             @D3A*02040003
               &GENERIC=,     RACDEF,RACHECK,RACXTRT               @L8A*02050003
               &GLOBAL=,      RACLIST                              @L9A*02060003
               &GROUP=,       RACINIT,SIGNON                       @N6C*02070003
               &GROUPID=,     RACHECK                              @L8A*02080003
               &INSTLN=,      RACHECK,FRACHECK,RACLIST,RACDEF,RACINIT  *02090003
               &JOBNAME=,     RACINIT                                  *02100003
               &LEVEL=,       RACDEF                                   *02110003
               &LIST=,        RACLIST                                  *02120003
               &LOC=,         RACINIT,RACLIST                      @L7A*02130003
               &LOG=,         RACHECK,RACINIT,RACDAUTH             @L7A*02140003
               &LOGSTR=,      RACHECK,RACINIT,RACAUDIT             @M3A*02150003
               &LSTTYPE=,     SIGNON                               @N6A*02160003
               &MATCHGN=,     RACXTRT                              @P5A*02170003
               &MCLASS=,      RACDEF                               @L7A*02180003
               &MENTITY=,     RACDEF                                   *02190003
               &MENTX=,       RACDEF                               @N1A*02200003
               &MGENER=,      RACDEF                               @L7A*02210003
               &MGMTCLA=,     RACDEF                               @L8A*02220003
               &MSGRTRN=,     RACROUTE                             @L8A*02230003
               &MSGSP=,       RACROUTE                             @L8A*02240003
               &MSGSUPP=,     RACROUTE                             @P1A*02250003
               &MVOLSER=,     RACDEF                                   *02260003
               &NEWNAME=,     RACDEF                                   *02270003
               &NEWNAMX=,     RACDEF                               @N1A*02280003
               &NEWPASS=,     RACINIT                                  *02290003
               &NOTIFY=,      RACDEF                               @L7A*02300003
               &OIDCARD=,     RACINIT                                  *02310003
               &OLDVOL=,      RACHECK,RACDEF                           *02320003
               &OWNER=,       RACHECK,RACLIST,RACDEF                   *02330003
               &PASSCHK=,     RACINIT                                  *02340003
               &PASSWRD=,     RACINIT                                  *02350003
               &PGMNAME=,     RACINIT                                  *02360003
               &POE=,         RACINIT,SIGNON                       @N6C*02370003
               &POSTEXI=,     RACROUTE/VM                          @N2A*02380003
               &PREEXI=,      RACROUTE/VM                          @N2A*02390003
               &PROFILE=,     RACHECK                                  *02400003
               &RELEASE=1.9,  (ALL)                            @D64CDHH*02410003
               &RACFIND=,     RACHECK,RACDEF                       @L5A*02420003
               &RECVR=,       RACHECK                              @M3A*02430003
               &RESULT=,      RACAUDIT                             @D4A*02440003
               &REMOTE=,      RACINIT                              @M8A*02450003
               &RESOWN=,      RACDEF                               @L8A*02460003
               &RETPD=,       RACDEF                               @L7A*02470003
               &RTOKEN=,      RACDAUTH,RACHECK                     @M4A*02480003
               &SECLABL=,     RACDEF,RACINIT,SIGNON                @N6C*02490003
               &SECLVL=,      RACDEF                               @L7A*02500003
               &SEGDATA=,     RACXTRT                              @L8A*02510003
               &SEGMENT=,     RACXTRT                              @L8A*02520003
               &SESSION=,     RACINIT                              @M5A*02530003
               &SGROUP=,      RACINIT                              @M5A*02540003
               &SMC=,         RACINIT                                  *02550003
               &SNODE=,       RACINIT                              @M5A*02560003
               &SUSERID=,     RACINIT                              @M5A*02570003
               &SPECIAL=,     RACDEF                                   *02580003
               &START=,       RACINIT                                  *02590003
               &STAT=,        RACINIT                              @L6A*02600003
               &STATUS=,      RACHECK                              @L7A*02610003
               &STOKEN=,      RACINIT                              @M5A*02620003
               &STORCLA=,     RACDEF                               @L8A*02630003
               &SUBPOOL=,     RACLIST,RACINIT,RACXTRT              @L6A*02640003
               &SYSTEM=,      RACROUTE                             @N6A*02650003
               &TAPELBL=,     RACHECK,RACDEF                       @L7A*02660003
               &TERMID=,      RACINIT                                  *02670003
               &TOKNIN=,      RACTKSRV,RACINIT                     @M4A*02680003
               &TOKNOUT=,     RACTKSRV,RACINIT,SIGNON              @N6C*02690003
               &TRUSTED=,     RACINIT                              @M5A*02700003
               &TYPE=,        RACDEF,RACXTRT,SIGNON                @N6C*02710003
               &UACC=,        RACDEF                                   *02720003
               &UNIT=,        RACDEF                                   *02730003
               &USERID=,      RACINIT,RACHECK,SIGNON               @N6C*02740003
               &USERWRD=,     RACROUTE/VM                          @N2A*02750003
               &UTOKEN=,      RACHECK                              @M5A*02760003
               &VERBEXIT=,    SIGNON                               @N6A*02770003
               &VOLSER=,      RACHECK,RACDEF,RACXTRT               @L8A*02780003
               &WARNING=,     RACDEF                               @L6A*02790003
               &WKAREA=,      FRACHECK                             @N5C*02800003
               &XMREQ=        RACROUTE                             @N5A 02810003
.*  DEFINE LOCAL VARIABLES                                              02820003
         LCLA  &RQTYPE             USED TO CONTAIN NUMERIC VALUE        02830003
.*                                 FOR REQUEST TYPE                     02840003
         LCLC  &XTRAPRM      USED FOR ERR03 MNOTE                  @N4A 02850003
         LCLC  &NX                 USED TO CONTAIN SYSNDX FOR LABELS    02860003
         LCLA  &BITA0,&BITA1,&BITA2,&BITA3                     @YA20345 02870003
         LCLA  &BITA4,&BITA5,&BITA6,&BITA7                     @YA20345 02880003
         LCLA  &BITB0,&BITB1,&BITB2,&BITB3                     @YA20345 02890003
         LCLA  &BITB4,&BITB5,&BITB6,&BITB7                     @YA20345 02900003
         LCLA  &SP2                                            @YA20345 02910003
         LCLA  &BIT0,&BIT1,&BIT2,&BIT3,&BIT4,&BIT5,&BIT6,&BIT7     @L8A 02920003
         LCLA  &SP                                                 @L8A 02930003
.*  DEFINE GLOBAL VARIABLES                                             02940003
         GBLC  &ICHL               USED FOR ADDRESS OF RACF PARAM LIST  02950003
         GBLA  &ICHCT              ICHCT - A COUNTER USED TO KEEP       02960003
.*                                 TRACK OF WHERE IN THE PARAMETER      02970003
.*                                 LIST THE PARAMETER IS TO BE          02980003
.*                                 PLACED. ICHCT IS INITIALIZED TO      02990003
.*                                 THE FIRST FULLWORD IN THE LIST       03000003
.*                                 TO BE FILLED IN BY ICHMM,            03010003
.*                                 AND INCREMENTED BY THE INNER         03020003
.*                                 MACRO (ICHMM).                       03030003
         GBLB  &ICHLFS             ICHLFS - SET TO 1 IF RELEASE    @M2A 03040003
.*                                 IS EQUAL TO 1.8.2.              @M2A 03050003
.*                                 ICHLFS COMMUNICATES TO          @M2A 03060003
.*                                 THE RACHECK MACRO THAT THE      @M2A 03070003
.*                                 LIMITED FUNCTION RACROUTE       @M2A 03080003
.*                                 SUPPORT FOR VM HAS BEEN         @M2A 03090003
.*                                 SELECTED.                       @M2A 03100003
         GBLB  &ICHRAC             ICHRAC - A FLAG WHICH IS             03110003
.*                                 INITIALIZED IN THIS MACRO TO         03120003
.*                                 COMMUNICATE TO THE RACF MACRO        03130003
.*                                 THAT THE RACF MACRO IS BEING         03140003
.*                                 INVOKED AS AN INNER MACRO            03150003
.*                                 TO THE RACROUTE MACRO.               03160003
         GBLB  &ICHLIST            ICHLIST - A FLAG WHICH IS SET TO     03170003
.*                                 INDICATE THE FORMAT OF THE MACRO.    03180003
.*                                 FOR LIST FORMAT, ICHLIST IS ON       03190003
.*                                 FOR EXECUTE FORMAT, ICHLIST IS       03200003
.*                                 OFF. FOR STANDARD FORMAT, THERE      03210003
.*                                 ARE TWO PASSES DONE BY THE MACRO     03220003
.*                                 A LIST PASS AND AN EXECUTE PASS.     03230003
.*                                 INITIALLY, FOR STANDARD, THE         03240003
.*                                 FLAG  IS ON - FOR THE LIST PASS.     03250003
.*                                 IT IS THEN TURNED OFF FOR THE        03260003
.*                                 EXECUTE PASS.                        03270003
         GBLB  &ICHNTFY            ICHNTFY - A GLOBAL INDICATOR         03280003
.*                                 WHICH IS USED TO COMMUNICATE WITH    03290003
.*                                 ICHMM - THE INNER MACRO. IF ICHNTFY  03300003
.*                                 IS ON, THE INNER MACRO WILL NOT      03310003
.*                                 ISSUE ITS OWN MNOTE IF IT FINDS AN   03320003
.*                                 ERROR-IT WILL MERELY TURN ON THE     03330003
.*                                 ICHINER FLAG AS NOTIFICATION TO THE  03340003
.*                                 OUTER MACRO, WHICH WILL TAKE THE     03350003
.*                                 APPROPRIATE ACTION.                  03360003
.*                                 IF ICHNTFY IS OFF, THE INNER MACRO   03370003
.*                                 WILL TAKE ACTION ON ITS OWN,         03380003
.*                                 IE. ISSUE AN MNOTE WITH A SEVERITY   03390003
.*                                 CODE OF ITS CHOOSING.                03400003
         GBLB  &ICHINER            ICHINER - A GLOBAL INDICATOR         03410003
.*                                 WHICH IS USED BY ICHMM - AN INNER    03420003
.*                                 MACRO - TO TELL THE OUTER MACRO IF   03430003
.*                                 AN ERROR HAS BEEN DETECTED IN A      03440003
.*                                 PARAMETER.  IF ICHINER IS ON, AN     03450003
.*                                 ERROR HAS BEEN DETECTED.             03460003
         GBLC  &ICHMF              ICHMF - AN INDICATOR OF THE          03470003
.*                                 FORMAT - L, E, OR S.                 03480003
         GBLC  &ICHRLVL            SYMBOL TO WHICH INNER MACRO     @L7A 03490003
.*                                 WILL BRANCH IF AN ERROR IS      @L7A 03500003
.*                                 DETECTED IN 'RELEASE'           @L7A 03510003
.************************                                          @N1A 03520003
.* TEST THAT THE RACROUTE KEYWORDS FOR RELEASE 1.9 AND LATER ARE   @N1A 03530003
.* NOT SPECIFIED WITH PREVIOUS RELEASES.                           @N1A 03540003
.************************                                          @N1A 03550003
.*                                                                      03560003
         AIF   ('&RELEASE(1)' EQ '').ALLTST                        @R2C 03570003
         AIF   ('&RELEASE(1)'(1,3) GE '1.9').NO19TST               @D4C 03580003
.ALLTST  ANOP                                                      @D4A 03590003
         AIF   ('&XMREQ' NE '').ERR22A                             @N5A 03600003
.ERTN22A ANOP                                                      @N5C 03610003
         AIF   ('&DECOUPL' NE '').ERR23                            @N1A 03620003
.ERTN23  ANOP                                                      @N1A 03630003
         AIF   ('&ECB1' NE '').ERR24                               @N2A 03640003
.ERTN24  ANOP                                                      @N2A 03650003
         AIF   ('&ECB2' NE '').ERR25                               @N2A 03660003
.ERTN25  ANOP                                                      @N2A 03670003
         AIF   ('&USERWRD' NE '').ERR26                            @N2A 03680003
.ERTN26  ANOP                                                      @N2A 03690003
         AIF   ('&POSTEXI' NE '').ERR27                            @N2A 03700003
.ERTN27  ANOP                                                      @N2A 03710003
         AIF   ('&PREEXI' NE '').ERR28                             @N2A 03720003
.ERTN28  ANOP                                                      @N2A 03730003
.*                                                                 @N3A 03740003
.* REQUEST=STAT IS INVALID FOR BEFORE RELEASE 1.9                  @N3A 03750003
.*                                                                 @N3A 03760003
         AIF   ('&REQUEST' EQ 'STAT').ERR29                        @N2A 03770003
.ERTN29  ANOP                                                      @N2A 03780003
.NO19TST ANOP                                                      @N2A 03790003
.************************                                          @N6A 03800003
.* TEST THAT THE RACROUTE KEYWORDS FOR RELEASE 1.9.2 ARE NOT       @N6A 03810003
.* SPECIFIED WITH PREVIOUS RELEASES.                               @N6A 03820003
.************************                                          @N6A 03830003
         AIF   ('&RELEASE(1)' EQ '').DO192TS                       @N6A 03840003
         AIF   ('&RELEASE(1)'(1,5) GE '1.9.2' OR                       X03850003
                '&RELEASE(1)'(1,3) GT '1.9').NO192TS               @LAC 03860003
.DO192TS ANOP                                                      @N6A 03870003
         AIF   ('&REQUEST' EQ 'SIGNON').ERR33                      @N6A 03880003
         AIF   ('&SYSTEM' NE '').ERR34                             @N6A 03890003
.ERTN34  ANOP                                                      @N6A 03900003
         AIF   ('&ENVRIN&ENVROUT' NE '').ERR35                     @N6A 03910003
.ERTN35  ANOP                                                      @N6A 03920003
.NO192TS ANOP                                                      @N6A 03930003
.************************                                          @L9A 03940003
.* TEST THAT THE RACROUTE KEYWORDS FOR RELEASE 2.1 ARE NOT         @L9A 03950003
.* SPECIFIED WITH PREVIOUS RELEASES.                               @L9A 03960003
.************************                                          @L9A 03970003
         AIF   ('&RELEASE(1)' EQ '').DO21TS                        @L9A 03980003
         AIF   ('&RELEASE(1)'(1,3) GE '2.1').NO21TS                @L9A 03990003
.DO21TS  ANOP                                                      @L9A 04000003
         AIF   ('&GLOBAL' NE '').ERR37                             @L9A 04010003
.ERTN37  ANOP                                                      @L9A 04020003
.NO21TS  ANOP                                                      @L9A 04030003
.************************                                          @D6A 04040003
.* TEST THAT THE RACROUTE KEYWORDS FOR RELEASE 2.2 ARE NOT         @D6A 04050003
.* SPECIFIED WITH PREVIOUS RELEASES.                               @D6A 04060003
.************************                                          @D6A 04070003
         AIF   ('&RELEASE(1)' EQ '').DO22TS                        @D6A 04080003
         AIF   ('&RELEASE(1)'(1,3) GE '2.2').NO22TS                @D6A 04090003
.DO22TS  ANOP                                                      @D6A 04100003
         AIF   ('&COPY' NE '').ERR38                               @D6A 04110003
.ERTN38  ANOP                                                      @D6A 04120003
         AIF   ('&COPYLEN' NE '').ERR39                            @D6A 04130003
.ERTN39  ANOP                                                      @D6A 04140003
.NO22TS  ANOP                                                      @D6A 04150003
.************************                                               04160003
.*   INITIALIZE VARIABLES                                               04170003
.************************                                               04180003
&NX      SETC  '&SYSNDX'                                                04190003
&XTRAPRM SETC  'SPECIFIED REQUEST'                                 @N4A 04200003
&ICHL    SETC  'IHB&NX.C'                                               04210003
&ICHNTFY SETB  0                   WANT ICHMM TO ISSUE ERROR MSGS       04220003
&ICHINER SETB  0                   INITIALIZE ICHINER TO 0              04230003
&ICHRAC  SETB  1                   WILL CALL RACF INTERNALLY            04240003
&ICHRLVL SETC  'IHB&NX.E'          INNER MACRO RETURN LABEL        @L7A 04250003
.***********************************                                    04260003
.*   SET UP INDICATORS FOR MF FORMAT                                    04270003
.***********************************                                    04280003
.*  VALIDATE MF PARAMETER                                               04290003
         AIF   ('&MF' NE 'L' AND '&MF' NE 'S' AND '&MF'(1,2) NE        *04300003
               '(E' AND '&MF'(1,2) NE '(M').ERR01                  @M3C 04310003
.*************************************************************     @M3A 04320003
.*  TREAT M FORM JUST LIKE EXECUTE, BUT SKIP THE ROUTER CALL *     @M3A 04330003
.*************************************************************     @M3A 04340003
         AIF   ('&MF(1)' EQ 'E' OR '&MF(1)' EQ 'M').RTE0030        @M3C 04350003
.RTE0010 ANOP                                                           04360003
&ICHLIST SETB  1               MF LIST OR STANDARD                      04370003
         AIF   ('&MF' EQ 'L').RTE0020                                   04380003
&ICHMF   SETC  'S'             STANDARD FORM                            04390003
         AGO   .CONT01                                                  04400003
.RTE0020 ANOP                                                           04410003
&ICHMF   SETC  'L'             LIST FORM                                04420003
         AGO   .CONT01                                                  04430003
.RTE0030 ANOP                                                           04440003
&ICHLIST SETB  0               MF EXECUTE                               04450003
&ICHMF   SETC  'E'                                                      04460003
         AIF   ('&MF(2)' EQ '' OR N'&MF NE 2).ERR01                     04470003
.CONT01  ANOP                                                           04480003
.*                                                                 @M2A 04490003
.****************************************************              @M2A 04500003
.*  VALIDATE THE RELEASE INDICATOR IF SPECIFIED                    @D4C 04510003
.****************************************************              @M2A 04520003
         AIF   ('&RELEASE(1)' NE '1.8.2').RTE0050                  @D4C 04530003
&ICHLFS  SETB  1                VM EXPANSION, LFR SELECTED         @M2A 04540003
.RTE0040 ANOP                                                      @M2A 04550003
         AIF   ('&MF(1)' NE 'M').RTE0050                           @D4A 04560003
         AGO   .ERR01A                                             @D4A 04570003
.RTE0050 ANOP                                                      @M2A 04580003
.****************************************************              @M2A 04590003
.*  REQUEST AND WORKA ARE REQUIRED PARAMETERS                      @M2A 04600003
.****************************************************              @M2A 04610003
         AIF   ('&REQUEST' EQ '').ERR02                                 04620003
         AIF   ('&WORKA' EQ '' AND '&ICHMF' EQ 'S').ERR05               04630003
.*************************************************************     @M2A 04640003
.*  IF THE REQSTOR AND SUBSYS PARAMETERS ARE SPECIFIED             @M2A 04650003
.*  FOR THE LIMITED FUNCTION RACROUTE, FLAG THESE PARAMETERS       @M2A 04660003
.*  AS IGNORED.                                                    @M2A 04670003
.*************************************************************     @M2A 04680003
         AIF   ('&REQSTOR' NE '' AND &ICHLFS).ERR20                @M2A 04690003
.ERTN20  ANOP                                                      @M2A 04700003
         AIF   ('&SUBSYS' NE '' AND &ICHLFS).ERR21                 @M2A 04710003
.ERTN21  ANOP                                                      @M2A 04720003
.****************************************************                   04730003
.*   VALIDATE REQUEST PARAMETER AND SET CORRESPONDING                   04740003
.*   VALUE FOR THE PARAMETER LIST.                                      04750003
.****************************************************                   04760003
         AIF   ('&REQUEST' NE 'AUTH').RTE0100                           04770003
&RQTYPE  SETA  1                                                        04780003
&XTRAPRM SETC  'REQUEST=AUTH'                                      @N4A 04790003
.*                                                                 @N1A 04800003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 04810003
.*   REQUEST AUTH.                                                 @N1A 04820003
.*                                                                 @N1A 04830003
         AIF   ('&ACTINFO&AUDIT&DATA&ENVIR&GROUP&JOBNAME&LEVEL&LIST&MEN*04840003
               TITY&MVOLSER&NEWNAME&NEWPASS' NE '').ERR03               04850003
         AIF   ('&OIDCARD&PASSCHK&PASSWRD&PGMNAME&SMC&SPECIAL&START&SUB*04860003
               POOL&TERMID&TYPE&UACC&UNIT&WKAREA' NE '').ERR03     @L8A 04870003
         AIF   ('&CHKAUTH' NE '').ERR03                            @L5A 04880003
         AIF   ('&WARNING&STAT&ENCRYPT&FIELDS' NE '').ERR03        @L6A 04890003
         AIF   ('&SEGMENT&SEGDATA' NE '').ERR03                    @L8A 04900003
         AIF   ('&FLDACC&DERIVE' NE '').ERR03                      @L8A 04910003
         AIF   ('&EXPDT&RETPD&CATGORY&SECLVL&ERASE' NE '').ERR03   @L7A 04920003
         AIF   ('&MCLASS&MGENER&NOTIFY&LOC' NE '').ERR03           @L7A 04930003
         AIF   ('&RESOWN&STORCLA&MGMTCLA&EXPDTX' NE '').ERR03      @L8A 04940003
         AIF   ('&TOKNIN&TOKNOUT' NE '').ERR03                     @M5C 04950003
         AIF   ('&STOKEN&SECLABL&EXENODE&SNODE&SUSERID&SGROUP&POE&SESSI*04960003
               ON&TRUSTED' NE '').ERR03                            @M5A 04970003
         AIF   ('&FILTER' NE '').ERR03                             @M7A 04980003
         AIF   ('&REMOTE' NE '').ERR03                             @M8A 04990003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 05000003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 05010003
         AIF   ('&NEWNAMX&MENTX&ENTRY' NE '').ERR03                @N3C 05020003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 05030003
         AIF   ('&RESULT' NE '').ERR03                             @Q8A 05040003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 05050003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT' NE '').ERR03    @N6A 05060003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 05070003
         AIF   ('&COPY' NE '').ERR03                               @D6A 05080003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 05090003
.*                                                                 @N6A 05100003
.* TEST THE KEYWORDS THAT ARE EXTRANEOUS WHEN SYSTEM=YES IS        @N6A 05110003
.* SPECIFIED.                                                      @N6A 05120003
.*                                                                 @N6A 05130003
&XTRAPRM SETC  'REQUEST=AUTH, SYSTEM=YES'                          @N6A 05140003
         AIF   ('&SYSTEM' NE 'YES').CONT02                         @N6A 05150003
         AIF   ('&DSTYPE&OLDVOL&OWNER&PROFILE&USERID&VOLSER&GROUPID&RAC*05160003
               FIND&ACCLVL&GENERIC&FILESEQ&TAPELBL&STATUS&RECVR&RTOKEN&*05170003
               UTOKEN&LOGSTR&DDNAME&ENTITYX' NE '').ERR03          @N6A 05180003
         AGO   .CONT02                                                  05190003
.RTE0100 ANOP                                                           05200003
         AIF   ('&REQUEST' NE 'FASTAUTH').RTE0110                       05210003
         AIF   (&ICHLFS).ERR15                                     @D4C 05220003
&RQTYPE  SETA  2                                                        05230003
&XTRAPRM SETC  'REQUEST=FASTAUTH'                                  @N4A 05240003
.*                                                                 @N1A 05250003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 05260003
.*   REQUEST FASTAUTH.                                             @N1A 05270003
.*                                                                 @N1A 05280003
         AIF   ('&ACTINFO&AUDIT&DATA&DSTYPE&ENVIR&GROUP&JOBNAME&LEVEL&L*05290003
               IST&MENTITY&MVOLSER&NEWNAME' NE '').ERR03           @D5C 05300003
         AIF   ('&NEWPASS&OIDCARD&OLDVOL&OWNER&PASSCHK&PASSWRD&PGMNAME&*05310003
               PROFILE&SMC&SPECIAL&START&SUBPOOL&TERMID&TYPE&UACC&UNIT&*05320003
               USERID&VOLSER&GROUPID' NE '').ERR03                 @L8A 05330003
         AIF   ('&RACFIND&ACCLVL&CHKAUTH' NE '').ERR03             @L5A 05340003
         AIF   ('&WARNING&STAT&ENCRYPT&GENERIC&FIELDS' NE              *05350003
               '').ERR03                                           @L6A 05360003
         AIF   ('&SEGMENT&SEGDATA' NE '').ERR03                    @L8A 05370003
         AIF   ('&FLDACC&DERIVE' NE '').ERR03                      @L8A 05380003
         AIF   ('&FILESEQ&TAPELBL&STATUS&EXPDT&RETPD&SECLVL&ERASE&MCLAS*05390003
               S&MGENER&NOTIFY&LOC&CATGORY' NE '').ERR03           @L7A 05400003
         AIF   ('&RESOWN&STORCLA&MGMTCLA&EXPDTX' NE '').ERR03      @L8A 05410003
         AIF   ('&RECVR&RTOKEN&TOKNIN&TOKNOUT' NE '').ERR03        @D1C 05420003
         AIF   ('&UTOKEN&STOKEN&SECLABL&EXENODE&SNODE&SUSERID&SGROUP&PO*05430003
               E&LOGSTR&SESSION&TRUSTED' NE '').ERR03              @M5A 05440003
         AIF   ('&DDNAME' NE '').ERR03                         @YA12773 05450003
         AIF   ('&FILTER' NE '').ERR03                             @M7A 05460003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 05470003
         AIF   ('&REMOTE' NE '').ERR03                             @M8A 05480003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 05490003
         AIF   ('&NEWNAMX&MENTX&ENTRY' NE '').ERR03                @N3C 05500003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 05510003
         AIF   ('&RESULT&ENTITYX' NE '').ERR03                     @Q8A 05520003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 05530003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  05540003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 05550003
         AIF   ('&COPY' NE '').ERR03                               @D6A 05560003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 05570003
.*                                                                 @N6A 05580003
         AGO   .CONT02                                                  05590003
.RTE0110 ANOP                                                           05600003
         AIF   ('&REQUEST' NE 'LIST').RTE0120                           05610003
         AIF   (&ICHLFS).ERR16                                     @D4C 05620003
&RQTYPE  SETA  3                                                        05630003
&XTRAPRM SETC  'REQUEST=LIST'                                      @N4A 05640003
.*                                                                 @N1A 05650003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 05660003
.*   REQUEST LIST.                                                 @N1A 05670003
.*                                                                 @N1A 05680003
         AIF   ('&ACTINFO&ATTR&AUDIT&DATA&DSTYPE&ENTITY&GROUP&JOBNAME&L*05690003
               EVEL&LOG&MENTITY&MVOLSER&NEWNAME' NE '').ERR03           05700003
         AIF   ('&NEWPASS&OIDCARD&OLDVOL&PASSCHK&PASSWRD&PGMNAME&PROFIL*05710003
               E&SMC&SPECIAL&START&TERMID&TYPE&UACC&UNIT&USERID&VOLSER&*05720003
               WKAREA&GROUPID' NE '').ERR03                        @L8A 05730003
         AIF   ('&RACFIND&ACCLVL&CHKAUTH' NE '').ERR03             @L5A 05740003
         AIF   ('&WARNING&STAT&ENCRYPT&GENERIC&FIELDS'  NE             *05750003
               '').ERR03                                           @L6A 05760003
         AIF   ('&SEGMENT&SEGDATA' NE '').ERR03                    @L8A 05770003
         AIF   ('&FLDACC&DERIVE' NE '').ERR03                      @L8A 05780003
         AIF   ('&FILESEQ&TAPELBL&STATUS&EXPDT&RETPD&ERASE&SECLVL&MGENE*05790003
               R&MCLASS&NOTIFY&CATGORY' NE '').ERR03               @L7A 05800003
         AIF   ('&RESOWN&STORCLA&MGMTCLA&EXPDTX' NE '').ERR03      @L8A 05810003
         AIF   ('&LOGSTR&RECVR&REMOTE' NE '').ERR03                @D1C 05820003
         AIF   ('&RTOKEN&TOKNIN&TOKNOUT' NE '').ERR03              @M4A 05830003
         AIF   ('&UTOKEN&STOKEN&SECLABL&EXENODE&SNODE&SUSERID&SGROUP&PO*05840003
               E&SESSION&TRUSTED' NE '').ERR03                     @Q8C 05850003
         AIF   ('&DDNAME' NE '').ERR03                         @YA12773 05860003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 05870003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 05880003
         AIF   ('&NEWNAMX&MENTX&ENTITYX&ENTRY' NE '').ERR03        @N3C 05890003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 05900003
         AIF   ('&RESULT' NE '').ERR03                             @Q8A 05910003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  05920003
.*                                                                 @N6A 05930003
         AIF   ('&COPY' NE '').ERR03                               @D6A 05940003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 05950003
         AGO   .CONT02                                                  05960003
.RTE0120 ANOP                                                           05970003
         AIF   ('&REQUEST' NE 'DEFINE').RTE0130                         05980003
         AIF   (&ICHLFS).ERR17                                     @M2A 05990003
&RQTYPE  SETA  4                                                        06000003
&XTRAPRM SETC  'REQUEST=DEFINE'                                    @N4A 06010003
.*                                                                 @N1A 06020003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 06030003
.*   REQUEST DEFINE.                                               @N1A 06040003
.*                                                                 @N1A 06050003
         AIF   ('&ACTINFO&APPL&ATTR&GROUP&JOBNAME&LIST&LOG&NEWPASS&OIDC*06060003
               ARD&PASSCHK&PASSWRD&PGMNAME&PROFILE&SMC&START&SUBPOOL&TE*06070003
               RMID&USERID&WKAREA&GROUPID' NE '').ERR03            @P5C 06080003
         AIF   ('&STAT&ENCRYPT&FIELDS' NE '').ERR03                @L6A 06090003
         AIF   ('&SEGMENT&SEGDATA' NE '').ERR03                    @L8A 06100003
         AIF   ('&FLDACC&DERIVE' NE '').ERR03                      @L8A 06110003
         AIF   ('&STATUS&LOC&LOGSTR&RECVR' NE '').ERR03            @D1C 06120003
         AIF   ('&RTOKEN&TOKNIN&TOKNOUT' NE '').ERR03              @M4A 06130003
         AIF   ('&UTOKEN&STOKEN&EXENODE&SNODE&SUSERID&SGROUP&POE&SESSIO*06140003
               N&TRUSTED' NE '').ERR03                             @Q8C 06150003
         AIF   ('&FILTER' NE '').ERR03                             @M7A 06160003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 06170003
         AIF   ('&REMOTE' NE '').ERR03                             @M8A 06180003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 06190003
         AIF   ('&ENTRY' NE '').ERR03                              @N3A 06200003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 06210003
         AIF   ('&RESULT' NE '').ERR03                             @Q8A 06220003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 06230003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  06240003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 06250003
         AIF   ('&COPY' NE '').ERR03                               @D6A 06260003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 06270003
.*                                                                 @N6A 06280003
         AGO   .CONT02                                                  06290003
.RTE0130 ANOP                                                           06300003
         AIF   ('&REQUEST' NE 'VERIFY').RTE0140                    @L6A 06310003
         AIF   (&ICHLFS).ERR18                                     @D4C 06320003
&RQTYPE  SETA  5                                                        06330003
&XTRAPRM SETC  'REQUEST=VERIFY'                                    @N4A 06340003
.*                                                                 @N1A 06350003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 06360003
.*   REQUEST VERIFY.                                               @N1A 06370003
.*                                                                 @N1A 06380003
         AIF   ('&ATTR&AUDIT&CLASS&DATA&DSTYPE&ENTITY&LEVEL&LIST&MENTIT*06390003
               Y&MVOLSER&NEWNAME&OLDVOL&OWNER&PROFILE&SPECIAL&TYPE&UACC*06400003
               &UNIT&VOLSER&WKAREA&GROUPID' NE '').ERR03           @L8A 06410003
         AIF   ('&RACFIND&ACCLVL&CHKAUTH' NE '').ERR03             @L5A 06420003
         AIF   ('&WARNING&GENERIC&FIELDS' NE '').ERR03             @L6A 06430003
         AIF   ('&FILESEQ&TAPELBL&STATUS&EXPDT&RETPD&ERASE&SECLVL&MCLAS*06440003
               S&MGENER&NOTIFY&CATGORY' NE '').ERR03               @L7A 06450003
         AIF   ('&SEGMENT&SEGDATA' NE '').ERR03                    @L8A 06460003
         AIF   ('&FLDACC&DERIVE' NE '').ERR03                      @L8A 06470003
         AIF   ('&RESOWN&STORCLA&MGMTCLA&EXPDTX' NE '').ERR03      @L8A 06480003
         AIF   ('&DDNAME' NE '').ERR03                         @YA12773 06490003
         AIF   ('&RTOKEN&UTOKEN&RECVR' NE '').ERR03                @N4C 06500003
         AIF   ('&FILTER' NE '').ERR03                             @M7A 06510003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 06520003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 06530003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 06540003
         AIF   ('&NEWNAMX&MENTX&ENTITYX&ENTRY' NE '').ERR03        @N3C 06550003
         AIF   ('&RESULT' NE '').ERR03                             @Q8A 06560003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 06570003
         AIF   ('&RELEASE(1)' EQ '' AND '&TOKNOUT' NE '').ERR31    @N4C 06580003
         AIF   ('&RELEASE(1)' EQ '' AND '&TOKNOUT' EQ '').CONT02   @N4A 06590003
         AIF   ('&RELEASE(1)'(1,3) LT '1.9' AND '&TOKNOUT' NE '').ERR31*06600003
                                                                   @N4C 06610003
         AIF   ('&LSTTYPE&VERBEXIT' NE '').ERR03                   @N6A 06620003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 06630003
         AIF   ('&COPY' NE '').ERR03                               @D6A 06640003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 06650003
         AGO   .CONT02                                             @L6A 06660003
.RTE0140 ANOP  ,                                                   @L6A 06670003
         AIF   ('&REQUEST' NE 'EXTRACT').RTE0150                   @M4C 06680003
         AIF   (&ICHLFS).ERR19                                     @M2A 06690003
         AIF   ('&BRANCH' EQ 'YES').RTE0143                        @P8A 06700003
&RQTYPE  SETA  6                                                   @L6A 06710003
&XTRAPRM SETC  'REQUEST=EXTRACT'                                   @N4A 06720003
         AGO   .RTE0147                                            @P8A 06730003
.RTE0143 ANOP                                                      @P8A 06740003
&RQTYPE  SETA  12                                                  @P8A 06750003
&XTRAPRM SETC  'BRANCH=YES ON REQUEST=EXTRACT'                     @N4A 06760003
.RTE0147 ANOP                                                      @P8A 06770003
.*                                                                 @N1A 06780003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 06790003
.*   REQUEST EXTRACT.                                              @N1A 06800003
.*                                                                 @N1A 06810003
         AIF   ('&ACTINFO&ATTR&AUDIT&DATA&DSTYPE&LEVEL&LIST&LOG&MENTITY*06820003
               &MVOLSER&NEWNAME&OLDVOL&OWNER&PROFILE&SPECIAL&UACC&UNIT&*06830003
               WKAREA' NE '').ERR03                                @L8A 06840003
         AIF   ('&RACFIND&ACCLVL&CHKAUTH' NE '').ERR03                  06850003
         AIF   ('&WARNING' NE '').ERR03                                 06860003
         AIF   ('&APPL&ENVIR&GROUP&INSTLN&JOBNAME&NEWPASS&OIDCARD&PASSC*06870003
               HK&PASSWRD&PGMNAME&SMC&START&STAT&TERMID&USERID' NE     *06880003
               '').ERR03                                           @L6A 06890003
         AIF   ('&FILESEQ&TAPELBL&STATUS&EXPDT&RETPD&SECLVL&ERASE&MCLAS*06900003
               S&MGENER&NOTIFY&LOC&CATGORY&GROUPID' NE '').ERR03   @L8A 06910003
         AIF   ('&RESOWN&STORCLA&MGMTCLA&EXPDTX' NE '').ERR03      @L8A 06920003
         AIF   ('&RTOKEN&TOKNIN&LOGSTR&RECVR' NE '').ERR03         @D1C 06930003
         AIF   ('&UTOKEN&STOKEN&SECLABL&EXENODE&SNODE&SUSERID&SGROUP&PO*06940003
               E&SESSION&TRUSTED' NE '').ERR03                     @Q8C 06950003
         AIF   ('&DDNAME' NE '').ERR03                         @YA12773 06960003
         AIF   ('&FILTER' NE '').ERR03                             @M7A 06970003
         AIF   ('&REMOTE' NE '').ERR03                             @M8A 06980003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 06990003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 07000003
         AIF   ('&NEWNAMX&MENTX&ENTRY' NE '').ERR03                @N3C 07010003
         AIF   ('&RESULT' NE '').ERR03                             @Q8A 07020003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 07030003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  07040003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 07050003
         AIF   ('&COPY' NE '').ERR03                               @D6A 07060003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 07070003
.*                                                                 @N6A 07080003
         AGO   .CONT02                                                  07090003
.RTE0150 ANOP  ,                                                   @M4A 07100003
         AIF   ('&REQUEST' NE 'DIRAUTH').RTE0160                   @M4A 07110003
         AIF   (&ICHLFS).ERR13                                     @D4A 07120003
&RQTYPE  SETA  7                                                   @M4A 07130003
&XTRAPRM SETC  'REQUEST=DIRAUTH'                                   @N4A 07140003
.*                                                                 @N1A 07150003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 07160003
.*   REQUEST DIRAUTH.                                              @N1A 07170003
.*                                                                 @N1A 07180003
         AIF   ('&ACCLVL&ACEE&ACTINFO&APPL&ATTR&AUDIT&CATGORY&CHKAUTH&C*07190003
               LASS&DATA&DERIVE&DSTYPE&ENCRYPT&ENTITY&ENVIR&ERASE&EXPDT*07200003
               &EXPDTX&FIELDS&FILESEQ&FLDACC&GENERIC' NE '').ERR03 @M4A 07210003
         AIF   ('&GROUP&GROUPID&INSTLN&JOBNAME&LEVEL&LIST&LOC&LOGSTR&MC*07220003
               LASS&MENTITY&MGENER&MGMTCLA&MSGRTRN&MSGSP&MSGSUPP&MVOLSE*07230003
               R&NEWNAME&NEWPASS&NOTIFY&OIDCARD' NE '').ERR03      @M4A 07240003
         AIF   ('&OLDVOL&OWNER&PASSCHK&PASSWRD&PGMNAME&PROFILE&RACFIND&*07250003
               RESOWN&RETPD&SECLVL&SEGDATA&SEGMENT&SMC&SPECIAL&START&ST*07260003
               AT&STATUS&SUBPOOL&TAPELBL' NE '').ERR03             @M4A 07270003
         AIF   ('&TERMID&TYPE&UACC&UNIT&USERID&VOLSER&WARNING&WKAREA&TO*07280003
               KNIN&TOKNOUT&RECVR' NE '').ERR03                    @D1C 07290003
         AIF   ('&UTOKEN&STOKEN&SECLABL&EXENODE&SNODE&SUSERID&SGROUP&PO*07300003
               E&SESSION&TRUSTED' NE '').ERR03                     @Q8C 07310003
         AIF   ('&FILTER' NE '').ERR03                             @M7A 07320003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 07330003
         AIF   ('&REMOTE' NE '').ERR03                             @M8A 07340003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 07350003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 07360003
         AIF   ('&NEWNAMX&MENTX&ENTITYX&ENTRY' NE '').ERR03        @N3C 07370003
         AIF   ('&RESULT&STORCLA' NE '').ERR03                     @Q8A 07380003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 07390003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  07400003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 07410003
         AIF   ('&COPY' NE '').ERR03                               @D6A 07420003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 07430003
.*                                                                 @N6A 07440003
         AGO   .CONT02                                             @M4A 07450003
.RTE0160 ANOP  ,                                                   @M4A 07460003
         AIF   ('&REQUEST' NE 'TOKENMAP').RTE0170                  @M4A 07470003
         AIF   (&ICHLFS).ERR13A                                    @D4A 07480003
         AIF   ('&XMREQ' EQ 'YES').RTE0162                         @N5A 07490003
&RQTYPE  SETA  8                                                   @M4A 07500003
&XTRAPRM SETC  'REQUEST=TOKENMAP'                                  @N4A 07510003
         AGO   .RTE0164                                            @N5A 07520003
.RTE0162 ANOP                                                      @N5A 07530003
&RQTYPE  SETA  16                                                  @N5A 07540003
&XTRAPRM SETC  'XMREQ=YES ON REQUEST=TOKENMAP'                     @N5A 07550003
.RTE0164 ANOP                                                      @N5A 07560003
.*                                                                 @N1A 07570003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 07580003
.*   REQUEST TOKENMAP.                                             @N1A 07590003
.*                                                                 @N1A 07600003
         AIF   ('&ACCLVL&ACTINFO&APPL&ATTR&AUDIT&CATGORY&CHKAUTH&CLASS&*07610003
               DATA&DERIVE&DSTYPE&ENCRYPT&ENTITY&ENVIR&ERASE&EXPDT&EXPD*07620003
               TX&FIELDS&FILESEQ&FLDACC&GENERIC' NE '').ERR03      @M4A 07630003
         AIF   ('&GROUP&GROUPID&INSTLN&JOBNAME&LEVEL&LIST&LOC&LOGSTR&MC*07640003
               LASS&MENTITY&MGENER&MGMTCLA&MSGRTRN&MSGSP&MSGSUPP&MVOLSE*07650003
               R&NEWNAME&NEWPASS&NOTIFY&OIDCARD' NE '').ERR03      @M4A 07660003
         AIF   ('&OLDVOL&OWNER&PASSCHK&PASSWRD&PGMNAME&PROFILE&RACFIND&*07670003
               RESOWN&RETPD&SECLVL&SEGDATA&SEGMENT&SMC&SPECIAL&START&ST*07680003
               AT&STATUS&TAPELBL&TERMID&UACC' NE '').ERR03         @M4A 07690003
         AIF   ('&UNIT&USERID&VOLSER&WARNING&WKAREA' NE '').ERR03  @D1C 07700003
         AIF   ('&RECVR&RTOKEN&ACEE&TYPE&FILTER' NE '').ERR03      @D1C 07710003
         AIF   ('&UTOKEN&STOKEN&SECLABL&EXENODE&SNODE&SUSERID&SGROUP&PO*07720003
               E&SESSION&TRUSTED' NE '').ERR03                     @Q8C 07730003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 07740003
         AIF   ('&REMOTE' NE '').ERR03                             @M8A 07750003
         AIF   ('&SUBPOOL' NE '').ERR03                            @P7A 07760003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 07770003
         AIF   ('&NEWNAMX&MENTX&ENTITYX&ENTRY' NE '').ERR03        @N3C 07780003
         AIF   ('&RESULT&DDNAME&LOG&STORCLA' NE '').ERR03          @Q8A 07790003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  07800003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 07810003
         AIF   ('&COPY' NE '').ERR03                               @D6A 07820003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 07830003
.*                                                                 @N6A 07840003
         AGO   .CONT02                                             @M4A 07850003
.RTE0170 ANOP                                                      @M4A 07860003
         AIF   ('&REQUEST' NE 'VERIFYX').RTE0180                   @M5A 07870003
         AIF   (&ICHLFS).ERR13B                                    @D4A 07880003
&RQTYPE  SETA  9                                                        07890003
&XTRAPRM SETC  'REQUEST=VERIFYX'                                   @N4A 07900003
.*                                                                 @N1A 07910003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 07920003
.*   REQUEST VERIFYX.                                              @N1A 07930003
.*                                                                 @N1A 07940003
         AIF   ('&ATTR&AUDIT&CLASS&DATA&DSTYPE&ENTITY&LEVEL&LIST&MENTIT*07950003
               Y&MVOLSER&NEWNAME&OLDVOL&OWNER&PROFILE&SPECIAL&TYPE&UACC*07960003
               &UNIT&VOLSER&WKAREA&GROUPID' NE '').ERR03           @M5A 07970003
         AIF   ('&RACFIND&ACCLVL&CHKAUTH' NE '').ERR03             @M5A 07980003
         AIF   ('&WARNING&GENERIC&FIELDS' NE '').ERR03             @M5A 07990003
         AIF   ('&FILESEQ&TAPELBL&STATUS&EXPDT&RETPD&ERASE&SECLVL&MCLAS*08000003
               S&MGENER&NOTIFY&CATGORY' NE '').ERR03               @M5A 08010003
         AIF   ('&SEGMENT&SEGDATA' NE '').ERR03                    @M5A 08020003
         AIF   ('&FLDACC&DERIVE' NE '').ERR03                      @M5A 08030003
         AIF   ('&RESOWN&STORCLA&MGMTCLA&EXPDTX' NE '').ERR03      @M5A 08040003
         AIF   ('&RTOKEN&UTOKEN&RECVR' NE '').ERR03                @D2C 08050003
         AIF   ('&FILTER' NE '').ERR03                             @M7A 08060003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 08070003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 08080003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 08090003
         AIF   ('&NEWNAMX&MENTX&ENTITYX&ENTRY' NE '').ERR03        @N3C 08100003
         AIF   ('&SUBPOOL' NE '').ERR03                            @Q9A 08110003
         AIF   ('&RELEASE' EQ '').ERTN22                           @D4A 08120003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 08130003
         AIF   ('&ICHMF' EQ 'S' AND '&RELEASE'(1,3) GE '1.9' AND       *08140003
               '&TOKNOUT' EQ '').ERR22                            1@Q8D 08150003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 08160003
         AIF   ('&COPY' NE '').ERR03                               @D6A 08170003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 08180003
.ERTN22  ANOP                                                      @P6A 08190003
         AIF   ('&DDNAME&ENVIR&RESULT' NE '').ERR03                @R2M 08200003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  08210003
.*                                                                 @N6A 08220003
         AGO   .CONT02                                             @M5A 08230003
.RTE0180 ANOP                                                      @M4A 08240003
         AIF   ('&REQUEST' NE 'TOKENXTR').RTE0185                  @M8A 08250003
         AIF   (&ICHLFS).ERR13C                                    @D4A 08260003
         AIF   ('&XMREQ' EQ 'YES').RTE0184                         @N5A 08270003
&RQTYPE  SETA  10                                                  @M8A 08280003
&XTRAPRM SETC  'REQUEST=TOKENXTR'                                  @N4A 08290003
         AGO   .RTE0187                                            @N5A 08300003
.RTE0184 ANOP                                                      @N5A 08310003
&RQTYPE  SETA  17                                                  @N5A 08320003
&XTRAPRM SETC  'XMREQ=YES ON REQUEST=TOKENXTR'                     @N5A 08330003
.RTE0187 ANOP                                                      @N5A 08340003
.*                                                                 @N1A 08350003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 08360003
.*   REQUEST TOKENXTR.                                             @N1A 08370003
.*                                                                 @N1A 08380003
         AIF   ('&ATTR&AUDIT&CLASS&DATA&DSTYPE&ENTITY&LEVEL&LIST&MENTIT*08390003
               Y&MVOLSER&NEWNAME&OLDVOL&OWNER&PROFILE&SPECIAL&TYPE&UACC*08400003
               &UNIT&VOLSER&WKAREA&GROUPID' NE '').ERR03           @M8A 08410003
         AIF   ('&RACFIND&ACCLVL&CHKAUTH' NE '').ERR03             @M8A 08420003
         AIF   ('&WARNING&GENERIC&FIELDS' NE '').ERR03             @M8A 08430003
         AIF   ('&FILESEQ&TAPELBL&STATUS&EXPDT&RETPD&ERASE&SECLVL&MCLAS*08440003
               S&MGENER&NOTIFY&CATGORY' NE '').ERR03               @M8A 08450003
         AIF   ('&SEGMENT&SEGDATA' NE '').ERR03                    @M8A 08460003
         AIF   ('&FLDACC&DERIVE' NE '').ERR03                      @M8A 08470003
         AIF   ('&RESOWN&STORCLA&MGMTCLA&EXPDTX' NE '').ERR03      @M8A 08480003
         AIF   ('&RECVR&RTOKEN&ENCRYPT&FILTER&REMOTE' NE '').ERR03 @D1C 08490003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 08500003
         AIF   ('&SUBPOOL' NE '').ERR03                            @P7A 08510003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 08520003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 08530003
         AIF   ('&NEWNAMX&MENTX&ENTITYX&ENTRY' NE '').ERR03        @N3C 08540003
         AIF   ('&ACTINFO&DDNAME&ENVIR&EXENODE' NE '').ERR03       @Q8A 08550003
         AIF   ('&GROUP&INSTLN&JOBNAME&LOC&LOG' NE '').ERR03       @Q8A 08560003
         AIF   ('&LOGSTR&NEWPASS&OIDCARD&PASSCHK' NE '').ERR03     @Q8A 08570003
         AIF   ('&PASSWRD&PGMNAME&POE&RESULT' NE '').ERR03         @Q8A 08580003
         AIF   ('&SECLABL&SESSION&SGROUP&SMC&SNODE' NE '').ERR03   @Q8A 08590003
         AIF   ('&SUSERID&START&STAT&STOKEN&TERMID' NE '').ERR03   @Q8A 08600003
         AIF   ('&TRUSTED&USERID&UTOKEN' NE '').ERR03              @Q8A 08610003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  08620003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 08630003
         AIF   ('&COPY' NE '').ERR03                               @D6A 08640003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 08650003
.*                                                                 @N6A 08660003
         AGO   .CONT02                                             @M8A 08670003
.RTE0185 ANOP                                                      @M8A 08680003
         AIF   ('&REQUEST' NE 'TOKENBLD').RTE0190                  @M8A 08690003
         AIF   (&ICHLFS).ERR13D                                    @D4A 08700003
&RQTYPE  SETA  11                                                  @M8A 08710003
&XTRAPRM SETC  'REQUEST=TOKENBLD'                                  @N4A 08720003
.*                                                                 @N1A 08730003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 08740003
.*   REQUEST TOKENBLD.                                             @N1A 08750003
.*                                                                 @N1A 08760003
         AIF   ('&ATTR&AUDIT&CLASS&DATA&DSTYPE&ENTITY&LEVEL&LIST&MENTIT*08770003
               Y&MVOLSER&NEWNAME&OLDVOL&OWNER&PROFILE&SPECIAL&TYPE&UACC*08780003
               &UNIT&VOLSER&WKAREA&GROUPID' NE '').ERR03           @M8A 08790003
         AIF   ('&RACFIND&ACCLVL&CHKAUTH' NE '').ERR03             @M8A 08800003
         AIF   ('&WARNING&GENERIC&FIELDS' NE '').ERR03             @M8A 08810003
         AIF   ('&FILESEQ&TAPELBL&STATUS&EXPDT&RETPD&ERASE&SECLVL&MCLAS*08820003
               S&MGENER&NOTIFY&CATGORY' NE '').ERR03               @M8A 08830003
         AIF   ('&SEGMENT&SEGDATA' NE '').ERR03                    @M8A 08840003
         AIF   ('&FLDACC&DERIVE' NE '').ERR03                      @M8A 08850003
         AIF   ('&RESOWN&STORCLA&MGMTCLA&EXPDTX' NE '').ERR03      @M8A 08860003
         AIF   ('&RTOKEN&UTOKEN&RECVR' NE '').ERR03               1@Q8D 08870003
         AIF   ('&FILTER' NE '').ERR03                             @M8A 08880003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @P5A 08890003
         AIF   ('&SUBPOOL' NE '').ERR03                            @P7A 08900003
         AIF   ('&EVENT&EVQUAL' NE '').ERR03                       @M9A 08910003
         AIF   ('&ACEE&ACTINFO&APPL&ENCRYPT&INSTLN&JOBNAME&LOC&LOG&NEWP*08920003
               ASS&OIDCARD&PASSCHK&PASSWRD&PGMNAME&SMC&START&STAT&SUBPO*08930003
               OL&LOGSTR' NE '').ERR03                             @D2A 08940003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 08950003
         AIF   ('&NEWNAMX&MENTX&ENTITYX&ENTRY' NE '').ERR03        @N3C 08960003
         AIF   ('&DDNAME&ENVIR&RESULT' NE '').ERR03                @Q8A 08970003
         AIF   ('&RELEASE' EQ '').ERTN30                           @R1A 08980003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 08990003
         AIF   ('&ICHMF' EQ 'S' AND '&RELEASE(1)'(1,3) GE '1.9' AND    *09000003
               '&TOKNOUT' EQ '').ERR30                             @R1C 09010003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 09020003
         AIF   ('&COPY' NE '').ERR03                               @D6A 09030003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 09040003
.ERTN30  ANOP                                                      @Q6A 09050003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  09060003
.*                                                                 @N6A 09070003
         AGO   .CONT02                                             @M8A 09080003
.RTE0190 ANOP                                                      @M4A 09090003
         AIF   ('&REQUEST' NE 'AUDIT').RTE0200                     @M9A 09100003
         AIF   (&ICHLFS).ERR13E                                    @D4A 09110003
&RQTYPE  SETA  13                                                  @M9A 09120003
&XTRAPRM SETC  'REQUEST=AUDIT'                                     @N4A 09130003
.*                                                                 @N1A 09140003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N1A 09150003
.*   REQUEST AUDIT.                                                @N1A 09160003
.*                                                                 @N1A 09170003
         AIF   ('&ACCLVL&ACTINFO&APPL&ATTR&AUDIT&CATGORY&CHKAUTH&DATA&D*09180003
               ERIVE&DSTYPE&ENCRYPT&ENTITY&ENVIR&ERASE&EXPDT&EXPDTX&FIE*09190003
               LDS&FILESEQ&FLDACC&GENERIC' NE '').ERR03            @M9A 09200003
         AIF   ('&GROUP&GROUPID&INSTLN&JOBNAME&LEVEL&LIST&LOC&MCLASS&ME*09210003
               NTITY&MGENER&MGMTCLA&MSGRTRN&MSGSP&MSGSUPP&MVOLSER&NEWNA*09220003
               ME&NEWPASS&NOTIFY&OIDCARD' NE '').ERR03             @D4C 09230003
         AIF   ('&OLDVOL&OWNER&PASSCHK&PASSWRD&PGMNAME&PROFILE&RACFIND&*09240003
               RESOWN&RETPD&SECLVL&SEGDATA&SEGMENT&SMC&SPECIAL&START&ST*09250003
               AT&STATUS&SUBPOOL&TAPELBL' NE '').ERR03             @M9A 09260003
         AIF   ('&TERMID&TYPE&UACC&UNIT&USERID&VOLSER&WARNING&WKAREA&TO*09270003
               KNIN&TOKNOUT&RECVR' NE '').ERR03                    @D1C 09280003
         AIF   ('&UTOKEN&STOKEN&SECLABL&EXENODE&SNODE&SUSERID&SGROUP&PO*09290003
               E&SESSION&TRUSTED' NE '').ERR03                     @D4C 09300003
         AIF   ('&FILTER' NE '').ERR03                             @M9A 09310003
         AIF   ('&BRANCH&MATCHGN' NE '').ERR03                     @M9A 09320003
         AIF   ('&RTOKEN&LOG' NE '').ERR03                         @M9A 09330003
         AIF   ('&REMOTE' NE '').ERR03                             @M9A 09340003
         AIF   ('&FORMOUT' NE '').ERR03                            @D3A 09350003
         AIF   ('&NEWNAMX&MENTX&ENTRY' NE '').ERR03                @N3C 09360003
         AIF   ('&DDNAME&STORCLA' NE '').ERR03                     @Q8A 09370003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 09380003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  09390003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 09400003
         AIF   ('&COPY' NE '').ERR03                               @D6A 09410003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 09420003
.*                                                                 @N6A 09430003
         AGO   .CONT02                                             @M9A 09440003
.RTE0200 ANOP                                                      @M9A 09450003
         AIF   ('&REQUEST' NE 'STAT').RTE0205                      @N3A 09460003
         AIF   (&ICHLFS).ERR13F                                    @D4A 09470003
&RQTYPE  SETA  14                                                  @N3A 09480003
&XTRAPRM SETC  'REQUEST=STAT'                                      @N4A 09490003
.*                                                                 @N3A 09500003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N3A 09510003
.*   REQUEST STAT.                                                 @N4C 09520003
.*                                                                 @N3A 09530003
         AIF   ('&ACCLVL&ACEE&ACTINFO&APPL&ATTR' NE '').ERR03      @N3A 09540003
         AIF   ('&AUDIT&BRANCH&CATGORY&CHKAUTH' NE '').ERR03       @N3A 09550003
         AIF   ('&DATA&DDNAME' NE '').ERR03                        @D4C 09560003
         AIF   ('&DERIVE&DSTYPE&ENCRYPT&ENTITY' NE '').ERR03       @N3A 09570003
         AIF   ('&ENTITYX&ENVIR&ERASE&EVENT' NE '').ERR03          @N3A 09580003
         AIF   ('&EVQUAL&EXENODE&EXPDT&EXPDTX' NE '').ERR03        @N3A 09590003
         AIF   ('&FIELDS&FILESEQ&FILTER&FLDACC' NE '').ERR03       @N3A 09600003
         AIF   ('&GENERIC&GROUP&GROUPID&INSTLN' NE '').ERR03       @N3A 09610003
         AIF   ('&JOBNAME&LEVEL&LIST&LOC&LOG' NE '').ERR03         @N3A 09620003
         AIF   ('&LOGSTR&MATCHGN&MCLASS&MENTITY' NE '').ERR03      @N3A 09630003
         AIF   ('&MENTX&MGENER&MGMTCLA&MSGRTRN' NE '').ERR03       @N3A 09640003
         AIF   ('&MSGSP&MSGSUPP&MVOLSER&NEWNAME' NE '').ERR03      @N3A 09650003
         AIF   ('&NEWNAMX&NEWPASS&NOTIFY&OIDCARD' NE '').ERR03     @N3A 09660003
         AIF   ('&OLDVOL&OWNER&PASSCHK&PASSWRD' NE '').ERR03       @N3A 09670003
         AIF   ('&PGMNAME&POE&PROFILE&RACFIND' NE '').ERR03        @N3A 09680003
         AIF   ('&RECVR&REMOTE&RESOWN&RETPD' NE '').ERR03          @N3A 09690003
         AIF   ('&RTOKEN&SECLABL&SECLVL&SEGDATA' NE '').ERR03      @N3A 09700003
         AIF   ('&SEGMENT&SESSION&SGROUP&SMC' NE '').ERR03         @N3A 09710003
         AIF   ('&SNODE&SUSERID&SPECIAL&START' NE '').ERR03        @N3A 09720003
         AIF   ('&STAT&STATUS&STOKEN&STORCLA' NE '').ERR03         @N3A 09730003
         AIF   ('&SUBPOOL&TAPELBL&TERMID' NE '').ERR03             @D4C 09740003
         AIF   ('&TOKNIN&TOKNOUT&TRUSTED&TYPE' NE '').ERR03        @N3A 09750003
         AIF   ('&UACC&UNIT&USERID&UTOKEN&VOLSER' NE '').ERR03     @N3A 09760003
         AIF   ('&WARNING&WKAREA' NE '').ERR03                     @N3A 09770003
         AIF   ('&FORMOUT' NE '').ERR03                            @N3A 09780003
         AIF   ('&RESULT' NE '').ERR03                             @Q8A 09790003
         AIF   ('&XMREQ' NE '').ERR03                              @N5A 09800003
         AIF   ('&LSTTYPE&VERBEXIT&ENVRIN&ENVROUT&SYSTEM' NE '').ERR03  09810003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 09820003
.*                                                                 @N6A 09830003
         AGO   .CONT02                                             @N3A 09840003
.RTE0205 ANOP                                                      @N3A 09850003
         AIF   ('&REQUEST' NE 'SIGNON').RTE0208                    @N6A 09860003
&RQTYPE  SETA  15                                                  @N6A 09870003
&XTRAPRM SETC  'REQUEST=SIGNON'                                    @N6A 09880003
.*                                                                 @N6A 09890003
.*   TEST THE KEYWORDS WHICH ARE SPECIFIED AND ARE EXTRANEOUS FOR  @N6A 09900003
.*   REQUEST SIGNON.                                               @N6A 09910003
.*                                                                 @N6A 09920003
         AIF   ('&ACCLVL&ACTINFO&ATTR&AUDIT&BRANCH' NE '').ERR03   @N6A 09930003
         AIF   ('&CATGORY&CHKAUTH&CLASS&DATA' NE '').ERR03         @N6A 09940003
         AIF   ('&DDNAME&DERIVE&DSTYPE&ECB1&ECB2' NE '').ERR03     @N6A 09950003
         AIF   ('&ENCRYPT&ENTITY&ENTITYX&ENTRY&ENVIR' NE '').ERR03 @N6A 09960003
         AIF   ('&ERASE&EVENT&EVQUAL&EXENODE&EXPDT' NE '').ERR03   @N6A 09970003
         AIF   ('&EXPDTX&FIELDS&FILESEQ&FILTER' NE '').ERR03       @N6A 09980003
         AIF   ('&FLDACC&FORMOUT&GENERIC&GROUPID' NE '').ERR03     @N6A 09990003
         AIF   ('&INSTLN&JOBNAME&LEVEL&LIST&LOC&LOG' NE '').ERR03  @N6A 10000003
         AIF   ('&LOGSTR&MATCHGN&MCLASS&MENTITY' NE '').ERR03      @N6A 10010003
         AIF   ('&MENTX&MGENER&MGMTCLA&MSGRTRN&MSGSP' NE '').ERR03 @N6A 10020003
         AIF   ('&MSGSUPP&MVOLSER&NEWNAME&NEWNAMX' NE '').ERR03    @N6A 10030003
         AIF   ('&NEWPASS&NOTIFY&OIDCARD&OLDVOL' NE '').ERR03      @N6A 10040003
         AIF   ('&OWNER&PASSCHK&PASSWRD&PGMNAME' NE '').ERR03      @N6A 10050003
         AIF   ('&POSTEXI&PREEXI&PROFILE&RACFIND' NE '').ERR03     @N6A 10060003
         AIF   ('&RECVR&REMOTE&RESOWN&RETPD&RTOKEN' NE '').ERR03   @N6A 10070003
         AIF   ('&SECLVL&SEGDATA&SEGMENT&SESSION' NE '').ERR03     @N6A 10080003
         AIF   ('&SGROUP&SMC&SNODE&SUSERID&SPECIAL' NE'').ERR03    @N6A 10090003
         AIF   ('&START&STAT&STATUS&STOKEN&STORCLA' NE'').ERR03    @N6A 10100003
         AIF   ('&SUBPOOL&TAPELBL&TERMID&TOKNIN' NE '').ERR03      @N6A 10110003
         AIF   ('&TRUSTED&UACC&UNIT&USERWRD&UTOKEN' NE '').ERR03   @N6A 10120003
         AIF   ('&VOLSER&WARNING&WKAREA' NE '').ERR03              @N6A 10130003
         AIF   ('&XMREQ' NE '').ERR03                              @N6A 10140003
         AIF   ('&SYSTEM' NE '').ERR03                             @N6A 10150003
         AIF   ('&GLOBAL' NE '').ERR03                             @L9A 10160003
         AIF   ('&COPY' NE '').ERR03                               @D6A 10170003
         AIF   ('&COPYLEN' NE '').ERR03                            @D6A 10180003
         AGO   .CONT02                                             @N6A 10190003
.RTE0208 ANOP                                                      @N6A 10200003
         AGO   .ERR04                                              @M9A 10210003
.CONT02  ANOP                                                           10220003
.****************************************************                   10230003
.*   VALIDATE MESSAGE REQUEST PARAMETER  AND                            10240003
.*   MESSAGE SUBPOOL PARAMETER                                          10250003
.****************************************************                   10260003
         AIF   ('&XMREQ' EQ '').ERTN08Y                            @N5A 10270003
         AIF   ('&XMREQ' EQ 'NO').ERTN08Y                          @N5A 10280003
         AIF   ('&XMREQ' NE 'YES').ERR32                           @N5A 10290003
.ERTN08Y ANOP                                                      @N5A 10300003
&BIT0    SETA  0                                                   @L8A 10310003
         AIF   ('&MSGRTRN' EQ '').CONT06                           @P1C 10320003
         AIF   ('&MSGRTRN' EQ 'NO').CONT06                         @L8A 10330003
         AIF   ('&MSGRTRN' NE 'YES').ERR07                         @L8A 10340003
&BIT0    SETA  1                                                   @L8A 10350003
.ERTN07  ANOP                                                      @M3A 10360003
.CONT06  ANOP                                                      @L8A 10370003
&SP      SETA  0                                                   @Q3M 10380003
         AIF   ('&MSGSP' EQ '').CONT06A                            @Q3C 10390003
         AIF   (T'&MSGSP  NE 'N').ERR06                            @Q3M 10400003
         AIF   (&MSGSP  LT  0  OR   &MSGSP  GT  255).ERR06         @Q3M 10410003
&SP      SETA  &MSGSP                                              @Q3M 10420003
.CONT06A ANOP                                                      @Q3A 10430003
&BIT2    SETA  0                                                   @L8A 10440003
         AIF   ('&MSGSUPP' EQ '').CONT07                           @L8A 10450003
         AIF   ('&MSGSUPP' EQ 'NO').CONT07                         @L8A 10460003
         AIF   ('&MSGSUPP' NE 'YES').ERR08                         @L8A 10470003
&BIT2    SETA  1            INDICATE MESSAGE SUPPRESSION REQUESTED @L8A 10480003
.CONT07  ANOP                                                      @P1A 10490003
&BIT3    SETA  0            PRESET DECOUPL=NO                      @M3A 10500003
         AIF   ('&DECOUPL' EQ '').ERTN08A                          @M3A 10510003
         AIF   ('&DECOUPL' EQ 'NO').ERTN08A                        @M3A 10520003
         AIF   ('&DECOUPL' NE 'YES').ERR08A                        @M3A 10530003
&BIT3    SETA  1            INDICATE DECOUPLE=YES REQUESTED        @M3A 10540003
.ERTN08A ANOP               DECOUPL MNOTE RETURN                   @M2A 10550003
&BIT4    SETA  0            PRESET SYSTEM=NO                       @N6A 10560003
         AIF   ('&SYSTEM' EQ '').ERTN08X                           @N6A 10570003
         AIF   ('&SYSTEM' EQ 'NO').ERTN08X                         @N6A 10580003
         AIF   ('&SYSTEM' NE 'YES').ERR36                          @N6A 10590003
&BIT4    SETA  1            INDICATE SYSTEM=YES REQUESTED          @N6A 10600003
.ERTN08X ANOP               MNOTE RETURN                           @N6A 10610003
&BIT1    SETA  0                                                   @P1A 10620003
         AIF   ('&RELEASE' EQ '').CONT08                           @P1A 10630003
         AIF   ('&RELEASE(1)' EQ '1.8.2').CONT07A                  @Q7C 10640003
         AIF   ('&RELEASE(1)' GE '1.8').CONT07B                    @Q7C 10650003
         AGO   .CONT08                                             @M6C 10660003
.CONT07A ANOP                                                      @M6A 10670003
         AIF   (NOT &ICHLFS).CONT07B                               @M6C 10680003
         AIF   ('&MSGRTRN' NE '').ERR09A                           @M2A 10690003
.ERTN09A ANOP                                                      @M2A 10700003
         AIF   ('&MSGSUPP' NE '').ERR10A                           @M2A 10710003
.ERTN10A ANOP                                                      @M2A 10720003
         AIF   ('&MSGSP' NE '').ERR12A                             @M2A 10730003
.ERTN12A ANOP                                                      @M2A 10740003
         AGO   .CONT09                                             @M2A 10750003
.CONT07B ANOP                                                      @M6C 10760003
&BIT1    SETA  1            INDICATE RELEASE 1.8 OR LATER          @P1A 10770003
         AGO   .CONT09                                                  10780003
.CONT08  ANOP               CHECK FOR MSG OPERANDS WITHOUT RELEASE=1.8 +10790003
                            OR LATER                               @P1A 10800003
         AIF   ('&MSGRTRN' NE '').ERR09                            @P1A 10810003
         AIF   ('&MSGSUPP' NE '').ERR10                            @P1A 10820003
         AIF   ('&MSGSP' NE '').ERR12                                   10830003
.CONT09  ANOP               CHECK FOR RELEASE 1.8 OR LATER         @P1A 10840003
.**************************************************************         10850003
.*  BEGIN THE PARAMETER LIST AND ESTABLISH ADDRESSABILITY TO IT         10860003
.*  IN REGISTER 14 FOR MF=S AND MF=E.                                   10870003
.**************************************************************         10880003
.RTE0210 ANOP                                                           10890003
         AIF   ('&ICHMF' EQ 'E').RTE0230                                10900003
         AIF   ('&ICHMF' EQ 'L').RTE0220                                10910003
         CNOP  0,4                                                      10920003
&NAME    BAL   1,IHB&NX.B                                               10930003
         AGO   .RTE0221                                                 10940003
.RTE0220 ANOP                                                           10950003
&NAME    DS    0F                                                       10960003
.RTE0221 ANOP                                                           10970003
IHB&NX.A EQU   *                                                        10980003
         DC    F'0'                 RACF OR INSTALL EXIT RETURN CODE    10990003
         DC    F'0'                 RACF OR INSTALL EXIT REASON CODE    11000003
         AIF   ('&RELEASE' EQ '').REL17PL                          @D4A 11010003
         AIF   ('&RELEASE'(1,3) LT '1.9').REL17PL                  @D4C 11020003
         DC    AL2(104)             LENGTH OF LIST IN BYTES        @N2C 11030003
.*                                                                 @N4D 11040003
         AGO   .RTE0226                                            @N2A 11050003
.REL17PL ANOP                                                      @N2A 11060003
         DC    AL2(40)              LENGTH OF LIST IN BYTES             11070003
.*                                                                 @N4D 11080003
.RTE0226 ANOP                                                      @M2A 11090003
.*************************************************************     @N4A 11100003
.*  SET VERSION/RELEASE INDICATOR - REFERENCE ICHSAFP FOR LIST     @N4A 11110003
.*  OF VERSION/RELEASES AND THEIR CORRESPONDING CODES.  THE        @N4A 11120003
.*  VERSION/RELEASE INDICATOR WILL BE USED FOR DECOUPL VALIDATION. @N4A 11130003
.*************************************************************     @N4A 11140003
         AIF   ('&RELEASE' EQ '').RELNULL                          @N4A 11150003
         AIF   ('&RELEASE' EQ '1.9.2').REL192                      @N6A 11160003
         AIF   ('&RELEASE' EQ '2.1').REL21                         @LAA 11170003
         AIF   ('&RELEASE' EQ '2.2').REL22                         @LBA 11180003
         AIF   ('&RELEASE'(1,3) GT '2.2').FUTREL                   @LBC 11190003
.RELNULL ANOP                     RELEASE NOT SPECIFIED            @N4A 11200003
         DC    AL1(0)             SET VER/REL FLAG TO 1.9 OR PREV  @N4A 11210003
         AGO   .NXTPARM                                            @N4A 11220003
.REL192  ANOP                     RELEASE 1.9.2 SPECIFIED          @N6A 11230003
         DC    AL1(2)             SET VER/REL FLAG TO 1.9.2        @N6A 11240003
         AGO   .NXTPARM                                            @N6A 11250003
.REL21   ANOP                     RELEASE 2.1 SPECIFIED            @LAA 11260003
         DC    AL1(3)             SET VER/REL FLAG TO 2.1          @LAC 11270003
         AGO   .NXTPARM                                            @LAA 11280003
.REL22   ANOP                     RELEASE 2.2 SPECIFIED            @LBA 11290003
         DC    AL1(4)             SET VER/REL FLAG TO 2.2          @LBC 11300003
         AGO   .NXTPARM                                            @LBA 11310003
.*************************************************************     @N4A 11320003
.*  THE CODE BEFORE FUTREL SHOULD BE UPDATED TO                    @N4A 11330003
.*  CONTAIN A NEW FLAG CODE WITH EACH NEW VERSION/RELEASE          @N4A 11340003
.*************************************************************     @N4A 11350003
.FUTREL  ANOP                       WHEN THERE IS A NEW RELEASE    @N4A 11360003
         DC    AL1(255)             SET VER/REL FLAG TO NEXT CODE  @N4A 11370003
.NXTPARM ANOP                                                      @N4A 11380003
         DC    AL1(0)               RESERVED                       @N4C 11390003
         DC    AL2(&RQTYPE)         REQUEST BYTE                        11400003
         DC    B'&BIT0&BIT1&BIT2&BIT3&BIT4&BIT5&BIT6&BIT7'  FLAGS  @L8A 11410003
.*                                  MESSAGE RETURN                 @L8A 11420003
         DC    AL1(&SP)             MESSAGE SUBPOOL                @L8A 11430003
         AGO   .CONT03                                                  11440003
.RTE0230 ANOP                                                           11450003
&NAME    IHBINNRA &MF(2)                                                11460003
.CONT03  ANOP                                                           11470003
.*************************************************************          11480003
.*   USING THE INNER MACRO ICHMM , THE PARAMETERS ARE SET INTO          11490003
.*   THE PARAMETER LIST AT THE CORRECT OFFSETS.                         11500003
.*************************************************************          11510003
&ICHCT   SETA  8                    INITIALIZE PARAMETER COUNTER   @N5A 11520003
.******************************************************************@N5A 11530003
.* FOR MF=E OR M TOKENXTR WITH XMREQ SPECIFIED, SET REQTYPE        @N5A 11540003
.******************************************************************@N5A 11550003
         AIF   ('&ICHMF' NE 'E' OR &ICHLIST EQ 1).RTE0268          @N5A 11560003
         AIF   (&RQTYPE NE 10 AND &RQTYPE NE 17).RTE0268           @N5A 11570003
         AIF   (T'&XMREQ EQ 'O').RTE0268                           @N5A 11580003
         LA    15,&RQTYPE           REQUEST TYPE EXTRACT CODE      @N5A 11590003
         STH   15,12(1)                                            @N5A 11600003
.RTE0268 ANOP                                                      @N5A 11610003
&ICHCT   SETA 12                    INITIALIZE PARAMETER COUNTER   @N5A 11620003
.******************************************************************@N5A 11630003
.* FOR MF=E OR M TOKENMAP WITH XMREQ SPECIFIED, SET REQTYPE        @N5A 11640003
.******************************************************************@N5A 11650003
         AIF   ('&ICHMF' NE 'E' OR &ICHLIST EQ 1).RTE0269          @N5A 11660003
         AIF   (&RQTYPE NE 8 AND &RQTYPE NE 16).RTE0269            @N5A 11670003
         AIF   (T'&XMREQ EQ 'O').RTE0269                           @N5A 11680003
         LA    15,&RQTYPE           REQUEST TYPE EXTRACT CODE      @N5A 11690003
         STH   15,12(1)                                            @N5A 11700003
.RTE0269 ANOP                                                      @N5A 11710003
&ICHCT   SETA  4                    INITIALIZE PARAMETER COUNTER        11720003
.******************************************************************@P8A 11730003
.* FOR MF=E OR M EXTRACT WITH BRANCH SPECIFIED, SET REQTYPE        @P8A 11740003
.******************************************************************@P8A 11750003
         AIF   ('&ICHMF' NE 'E' OR &ICHLIST EQ 1).RTE0270          @P8A 11760003
         AIF   (&RQTYPE NE 12 AND &RQTYPE NE 6).RTE0270            @P8A 11770003
         AIF   (T'&BRANCH EQ 'O').RTE0270                          @P8A 11780003
         LA    15,&RQTYPE           REQUEST TYPE EXTRACT CODE      @P8A 11790003
         STH   15,12(1)                                            @P8A 11800003
.RTE0270 ANOP                                                      @P8A 11810003
         ICHMM &REQSTOR             REQUESTOR ADDRESS                   11820003
         ICHMM &SUBSYS              SUBSYSTEM ADDRESS                   11830003
         ICHMM &WORKA               WORK AREA ADDRESS                   11840003
         AIF   (NOT &ICHLIST).CONT04                                    11850003
         DC    A(0)                 MESSAGE RETURN ADDRESS              11860003
         DC    A(0)                 RESVD                               11870003
         DC    A(&ICHL-IHB&NX.A)    OFFSET TO RACF PARAMETER LIST       11880003
         AIF   ('&RELEASE' EQ '').CONT04A                          @D4A 11890003
         AIF   ('&RELEASE'(1,3) LT '1.9').CONT04A                  @D4C 11900003
         DC    F'0'                 SAF RETURN CODE                @N2C 11910003
         DC    F'0'                 SAF REASON CODE                @N2C 11920003
         DC    AL2(64)              EXTENSION LENGTH               @N2A 11930003
         DC    AL2(0)               RESVD                          @M2A 11940003
         DC    A(0)                 RETURN DATA ADDRESS            @N2A 11950003
         DC    A(0)                 FLAT PLIST ADDRESS             @N2A 11960003
.CONT04  ANOP                                                           11970003
&ICHCT   SETA  15                   INITIALIZE PARAMETER COUNTER   @D4C 11980003
         ICHMM &ECB1                ECB1 ADDRESS                   @N2A 11990003
         ICHMM &ECB2                ECB2 ADDRESS                   @N2A 12000003
         AIF   (NOT &ICHLIST).CONT04B                              @N2A 12010003
         DC    A(0)                 PREVIOUS FLAT PLIST ADDRESS    @N2A 12020003
         DC    A(0)                 NEXT FLAT PLIST ADDRESS        @N2A 12030003
         DC    A(0)                 ORIGINAL PLIST ADDRESS         @N2A 12040003
         DC    F'0'                 FLAT PLIST LENGTH              @N2A 12050003
.CONT04B ANOP                                                      @N2A 12060003
&ICHCT   SETA  21                   INITIALIZE PARAMETER COUNTER   @D4C 12070003
         ICHMM &USERWRD             USERWORD                       @N2A 12080003
         ICHMM &PREEXI              PRE-PROCESSING VM EXIT         @N2A 12090003
         ICHMM &POSTEXI             PRE-PROCESSING VM EXIT         @N2A 12100003
         AIF   (NOT &ICHLIST).CONT04A                              @D4C 12110003
         DC    A(0)                 ASYNCHRONOUS ECB ADDRESS       @N2A 12120003
         DC    A(0)                 USED IN VM ENVIRONMENT         @N2A 12130003
.CONT04A ANOP                                                      @M2A 12140003
.***************************************************************        12150003
.*  AT THIS POINT, THE LIST AND EXECUTE FORMS ARE COMPLETED.  IF        12160003
.*  THE LIST PASS OF THE STANDARD FORM HAS JUST BEEN COMPLETED,         12170003
.*  RETURN FOR AN EXECUTE PASS.                                         12180003
.***************************************************************        12190003
         AIF   ('&ICHMF' NE 'S').CONT05                                 12200003
         AIF   (NOT &ICHLIST).CONT05                                    12210003
&ICHLIST SETB  0                                                        12220003
IHB&NX.B DS    0H                                                       12230003
         AGO   .CONT03           DO EXECUTE PATH OF STANDARD FORM       12240003
.CONT05  ANOP                                                           12250003
         AIF   ('&ICHMF' NE 'E').NECONT                        @YA20345 12260003
.*  COMPLETE THE EXECUTE FORM WITH ALREADY VALIDATED KEYWORDS  @YA20345 12270003
         AIF   ('&MSGSP' EQ '').ECONT1                         @YA20345 12280003
         AIF   (T'&MSGSP  NE 'N').ERR06                        @YA20345 12290003
         AIF   (&MSGSP  LT  0  OR   &MSGSP  GT  255).ERR06     @YA20345 12300003
&SP2     SETA  &MSGSP                                          @YA20345 12310003
         MVI   15(1),&SP2           MESSAGE SUBPOOL            @YA20345 12320003
.ECONT1  ANOP                                                  @YA20345 12330003
.*  INITIALIZE BITS FOR KEYWORDS SPECIFIED ON EXECUTE FORM     @YA20345 12340003
&BITA0   SETA  1                                               @YA20345 12350003
&BITA1   SETA  1                                               @YA20345 12360003
&BITA2   SETA  1                                               @YA20345 12370003
&BITA3   SETA  1                                               @YA20345 12380003
&BITA4   SETA  1                                               @YA20345 12390003
&BITA5   SETA  1                                               @YA20345 12400003
&BITA6   SETA  1                                               @YA20345 12410003
&BITA7   SETA  1                                               @YA20345 12420003
&BITB0   SETA  0                                               @YA20345 12430003
&BITB1   SETA  0                                               @YA20345 12440003
&BITB2   SETA  0                                               @YA20345 12450003
&BITB3   SETA  0                                               @YA20345 12460003
&BITB4   SETA  0                                               @YA20345 12470003
&BITB5   SETA  0                                               @YA20345 12480003
&BITB6   SETA  0                                               @YA20345 12490003
&BITB7   SETA  0                                               @YA20345 12500003
.*  SET BITS AND GENERATE INSTRUCTIONS TO MODIFY LIST FORM     @YA20345 12510003
         AIF   ('&MSGRTRN' NE 'NO').ECONT2                     @YA20345 12520003
&BITA0   SETA  0                                               @YA20345 12530003
.ECONT2  ANOP                                                  @YA20345 12540003
         AIF   ('&MSGSUPP' NE 'NO').ECONT3                     @YA20345 12550003
&BITA2   SETA  0                                               @YA20345 12560003
.ECONT3  ANOP                                                  @YA20345 12570003
         AIF   ('&BITA0&BITA1&BITA2&BITA3&BITA4&BITA5&BITA6&BITA7' EQ  *12580003
               '11111111').ECONT4                              @YA20345 12590003
         NI    14(1),B'&BITA0&BITA1&BITA2&BITA3&BITA4&BITA5&BITA6&BITA7*12600003
               '                                               @YA20345 12610003
.ECONT4  ANOP                                                  @YA20345 12620003
         AIF   ('&MSGRTRN' NE 'YES').ECONT5                    @YA20345 12630003
&BITB0   SETA  1                                               @YA20345 12640003
.ECONT5  ANOP                                                  @YA20345 12650003
         AIF   ('&MSGSUPP' NE 'YES').ECONT6                    @YA20345 12660003
&BITB2   SETA  1                                               @YA20345 12670003
.ECONT6  ANOP                                                  @YA20345 12680003
         AIF   ('&RELEASE' EQ '').ECONT7                       @YA20345 12690003
         AIF   ('&RELEASE(1)' NE '1.8' AND '&RELEASE(1)' NE '1.8.1'    *12700003
               AND '&RELEASE(1)' NE '1.8.2').ECONT7            @YA20345 12710003
&BITB1   SETA  1                                               @YA20345 12720003
.ECONT7  ANOP                                                  @YA20345 12730003
         AIF   ('&BITB0&BITB1&BITB2&BITB3&BITB4&BITB5&BITB6&BITB7' EQ  *12740003
               '00000000').NECONT                              @YA20345 12750003
         OI    14(1),B'&BITB0&BITB1&BITB2&BITB3&BITB4&BITB5&BITB6&BITB7*12760003
               '                                               @YA20345 12770003
.*****************************************************                  12780003
.*  THE RACF MACRO CORRESPONDING TO THE REQUEST TYPE                    12790003
.*  IS INVOKED, PASSING TO IT THE RELEVANT PARAMETERS.                  12800003
.*****************************************************                  12810003
.NECONT  ANOP                                                  @YA20345 12820003
         AIF   ('&ICHMF' EQ 'L').RTE0400                                12830003
.*  SAVE ADDRESSABILITY TO RACROUTE LIST IN REGISTER 14                 12840003
         LR    14,1                 SAVE RACROUTE LIST ADDR             12850003
.RTE0400 ANOP                                                           12860003
         AIF   (&RQTYPE NE 1).RTE2                                      12870003
.RTE1    ANOP                                                           12880003
         RACHECK ACCLVL=&ACCLVL,                                   @L5A*12890003
               ACEE=&ACEE,                                             *12900003
               APPL=&APPL,                                             *12910003
               ATTR=&ATTR,                                             *12920003
               CLASS=&CLASS,                                           *12930003
               DDNAME=&DDNAME,                                 @YA12773*12940003
               DSTYPE=&DSTYPE,                                         *12950003
               ENTITY=&ENTITY,                                         *12960003
               ENTITYX=&ENTITYX,                                   @N1A*12970003
               FILESEQ=&FILESEQ,                                   @L7A*12980003
               GENERIC=&GENERIC,                                   @L6A*12990003
               GROUPID=&GROUPID,                                   @L8A*13000003
               INSTLN=&INSTLN,                                         *13010003
               LOG=&LOG,                                               *13020003
               LOGSTR=&LOGSTR,                                     @M3A*13030003
               OLDVOL=&OLDVOL,                                         *13040003
               OWNER=&OWNER,                                           *13050003
               PROFILE=&PROFILE,                                       *13060003
               RACFIND=&RACFIND,                                   @L5A*13070003
               RECVR=&RECVR,                                       @P3A*13080003
               RELEASE=&RELEASE,                                   @L7A*13090003
               RTOKEN=&RTOKEN,                                     @P3A*13100003
               STATUS=&STATUS,                                     @L7A*13110003
               TAPELBL=&TAPELBL,                                   @L7A*13120003
               USERID=&USERID,                                     @L8A*13130003
               UTOKEN=&UTOKEN,                                     @P3A*13140003
               VOLSER=&VOLSER,                                     @D1D*13150003
               MF=&MF                                                   13160003
         AGO   .RTE0410                                                 13170003
.RTE2    ANOP                                                           13180003
         AIF   (&RQTYPE NE 2).RTE3                                      13190003
         FRACHECK ACEE=&ACEE,                                          *13200003
               APPL=&APPL,                                             *13210003
               ATTR=&ATTR,                                             *13220003
               CLASS=&CLASS,                                           *13230003
               ENTITY=&ENTITY,                                     @Q5D*13240003
               INSTLN=&INSTLN,                                         *13250003
               RELEASE=&RELEASE,                                   @L7A*13260003
               WKAREA=&WKAREA,                                         *13270003
               LOG=&LOG,                                           @D5A*13280003
               MF=&MF                                                   13290003
         AGO   .RTE0410                                                 13300003
.RTE3    ANOP                                                           13310003
         AIF   (&RQTYPE NE 3).RTE4                                      13320003
         RACLIST ACEE=&ACEE,                                           *13330003
               APPL=&APPL,                                             *13340003
               CLASS=&CLASS,                                           *13350003
               ENVIR=&ENVIR,                                           *13360003
               GLOBAL=&GLOBAL,                                         *13370003
               INSTLN=&INSTLN,                                     @L9A*13380003
               LOC=&LOC,                                           @L7A*13390003
               LIST=&LIST,                                             *13400003
               FILTER=&FILTER,                                     @M7A*13410003
               OWNER=&OWNER,                                           *13420003
               RELEASE=&RELEASE,                                   @L7A*13430003
               SUBPOOL=&SUBPOOL,                                       *13440003
               MF=&MF                                                   13450003
         AGO   .RTE0410                                                 13460003
.RTE4    ANOP                                                           13470003
         AIF   (&RQTYPE NE 4).RTE5                                      13480003
         RACDEF ACCLVL=&ACCLVL,                                    @L7A*13490003
               ACEE=&ACEE,                                         @L7A*13500003
               AUDIT=&AUDIT,                                           *13510003
               CATGORY=&CATGORY,                                   @L7A*13520003
               CHKAUTH=&CHKAUTH,                                   @L5A*13530003
               CLASS=&CLASS,                                           *13540003
               DATA=&DATA,                                             *13550003
               DDNAME=&DDNAME,                                 @YA12773*13560003
               DSTYPE=&DSTYPE,                                         *13570003
               ENTITY=&ENTITY,                                         *13580003
               ENTITYX=&ENTITYX,                                   @N1A*13590003
               ENVIR=&ENVIR,                                       @L8A*13600003
               ERASE=&ERASE,                                       @L7A*13610003
               EXPDT=&EXPDT,                                       @L7A*13620003
               EXPDTX=&EXPDTX,                                     @L8A*13630003
               FILESEQ=&FILESEQ,                                   @L7A*13640003
               GENERIC=&GENERIC,                                   @L6A*13650003
               INSTLN=&INSTLN,                                         *13660003
               LEVEL=&LEVEL,                                           *13670003
               MCLASS=&MCLASS,                                     @L7A*13680003
               MENTITY=&MENTITY,                                       *13690003
               MENTX=&MENTX,                                       @N1A*13700003
               MGENER=&MGENER,                                     @L7A*13710003
               MGMTCLA=&MGMTCLA,                                   @L8A*13720003
               MVOLSER=&MVOLSER,                                       *13730003
               NEWNAME=&NEWNAME,                                       *13740003
               NEWNAMX=&NEWNAMX,                                   @N1A*13750003
               NOTIFY=&NOTIFY,                                     @L7A*13760003
               OLDVOL=&OLDVOL,                                         *13770003
               OWNER=&OWNER,                                           *13780003
               RACFIND=&RACFIND,                                   @L5A*13790003
               RELEASE=&RELEASE,                                   @L7A*13800003
               RESOWN=&RESOWN,                                     @L8A*13810003
               RETPD=&RETPD,                                       @L7A*13820003
               SECLABL=&SECLABL,                                   @M6A*13830003
               SECLVL=&SECLVL,                                     @L7A*13840003
               SPECIAL=&SPECIAL,                                       *13850003
               STORCLA=&STORCLA,                                   @L8A*13860003
               TAPELBL=&TAPELBL,                                   @L7A*13870003
               TYPE=&TYPE,                                             *13880003
               UACC=&UACC,                                             *13890003
               UNIT=&UNIT,                                             *13900003
               VOLSER=&VOLSER,                                         *13910003
               WARNING=&WARNING,                                   @L6A*13920003
               MF=&MF                                                   13930003
         AGO   .RTE0410                                                 13940003
.RTE5    ANOP                                                           13950003
         AIF   (&RQTYPE NE 5).RTE6                                 @L6A 13960003
         RACINIT ACEE=&ACEE,                                           *13970003
               ACTINFO=&ACTINFO,                                       *13980003
               APPL=&APPL,                                             *13990003
               ENCRYPT=&ENCRYPT,                                   @L6A*14000003
               ENVIR=&ENVIR,                                           *14010003
               GROUP=&GROUP,                                           *14020003
               INSTLN=&INSTLN,                                         *14030003
               JOBNAME=&JOBNAME,                                       *14040003
               LOC=&LOC,                                           @L7A*14050003
               LOG=&LOG,                                           @L7A*14060003
               NEWPASS=&NEWPASS,                                       *14070003
               OIDCARD=&OIDCARD,                                       *14080003
               PASSCHK=&PASSCHK,                                       *14090003
               PASSWRD=&PASSWRD,                                       *14100003
               PGMNAME=&PGMNAME,                                       *14110003
               RELEASE=&RELEASE,                                   @L7A*14120003
               SMC=&SMC,                                               *14130003
               START=&START,                                           *14140003
               STAT=&STAT,                                         @L6A*14150003
               SUBPOOL=&SUBPOOL,                                       *14160003
               TERMID=&TERMID,                                         *14170003
               USERID=&USERID,                                         *14180003
               TOKNIN=&TOKNIN,                                     @D2C*14190003
               TOKNOUT=&TOKNOUT,                                   @N4A*14200003
               STOKEN=&STOKEN,                                     @M5A*14210003
               SECLABL=&SECLABL,                                   @M5A*14220003
               EXENODE=&EXENODE,                                   @M5A*14230003
               SNODE=&SNODE,                                       @M5A*14240003
               SUSERID=&SUSERID,                                   @M5A*14250003
               SGROUP=&SGROUP,                                     @M5A*14260003
               POE=&POE,                                           @M5A*14270003
               LOGSTR=&LOGSTR,                                     @M5A*14280003
               SESSION=&SESSION,                                   @M5A*14290003
               TRUSTED=&TRUSTED,                                   @M5A*14300003
               REMOTE=&REMOTE,                                     @M8A*14310003
               ENVRIN=&ENVRIN,                                     @N6A*14320003
               ENVROUT=&ENVROUT,                                   @N6A*14330003
               MF=&MF                                                   14340003
         AGO   .RTE0410                                            @L6A 14350003
.RTE6    ANOP  ,                                                   @L8A 14360003
         AIF   (&RQTYPE NE 6 AND &RQTYPE NE 12).RTE7               @P8C 14370003
         RACXTRT ENTITY=&ENTITY,                                   @L6A*14380003
               ENTITYX=&ENTITYX,                                   @N1A*14390003
               ACEE=&ACEE,                                         @L6A*14400003
               ENCRYPT=&ENCRYPT,                                   @L6A*14410003
               FIELDS=&FIELDS,                                     @L6A*14420003
               RELEASE=&RELEASE,                                   @L7A*14430003
               SUBPOOL=&SUBPOOL,                                   @L6A*14440003
               TYPE=&TYPE,                                         @L6A*14450003
               CLASS=&CLASS,                                       @L8A*14460003
               SEGMENT=&SEGMENT,                                   @L8A*14470003
               SEGDATA=&SEGDATA,                                   @L8A*14480003
               VOLSER=&VOLSER,                                     @L8A*14490003
               GENERIC=&GENERIC,                                   @L8A*14500003
               DERIVE=&DERIVE,                                     @L8A*14510003
               FLDACC=&FLDACC,                                     @L8A*14520003
               BRANCH=&BRANCH,                                     @P4C*14530003
               MATCHGN=&MATCHGN,                                   @P5C*14540003
               MF=&MF                                              @L6A 14550003
         AGO   .RTE0410                                            @M4A 14560003
.RTE7    ANOP  ,                                                   @M4A 14570003
         AIF   (&RQTYPE NE 7).RTE8                                 @M4A 14580003
         RACDAUTH RTOKEN=&RTOKEN,                                  @M4A*14590003
               LOG=&LOG,                                           @M4A*14600003
               RELEASE=&RELEASE,                                   @M4A*14610003
               MF=&MF                                              @P3C 14620003
         AGO   .RTE0410                                            @M4A 14630003
.RTE8    ANOP  ,                                                   @M4A 14640003
         AIF   (&RQTYPE NE 8 AND &RQTYPE NE 10 AND &RQTYPE NE 16 AND   *14650003
               &RQTYPE NE 17).RTE9                                 @N5C 14660003
         RACTKSRV TOKNIN=&TOKNIN,                                  @M4A*14670003
               ACEE=&ACEE,                                         @M3A*14680003
               TOKNOUT=&TOKNOUT,                                   @M4A*14690003
               FORMOUT=&FORMOUT,                                   @D3A*14700003
               RELEASE=&RELEASE,                                   @M4A*14710003
               MF=&MF                                              @P3C 14720003
         AGO   .RTE0410                                            @M4A 14730003
.RTE9    ANOP  ,                                                   @M5A 14740003
         AIF   (&RQTYPE NE 9 AND &RQTYPE NE 11).RTE10              @M9C 14750003
         RACINIT ENVIR=VERIFYX,                                    @M5A*14760003
               ACEE=&ACEE,                                         @M5A*14770003
               ACTINFO=&ACTINFO,                                   @M5A*14780003
               APPL=&APPL,                                         @M5A*14790003
               ENCRYPT=&ENCRYPT,                                   @M5A*14800003
               GROUP=&GROUP,                                       @M5A*14810003
               INSTLN=&INSTLN,                                     @M5A*14820003
               JOBNAME=&JOBNAME,                                   @M5A*14830003
               LOC=&LOC,                                           @M5A*14840003
               LOG=&LOG,                                           @M5A*14850003
               NEWPASS=&NEWPASS,                                   @M5A*14860003
               OIDCARD=&OIDCARD,                                   @M5A*14870003
               PASSCHK=&PASSCHK,                                   @M5A*14880003
               PASSWRD=&PASSWRD,                                   @M5A*14890003
               PGMNAME=&PGMNAME,                                   @M5A*14900003
               RELEASE=&RELEASE,                                   @M5A*14910003
               SMC=&SMC,                                           @M5A*14920003
               START=&START,                                       @M5A*14930003
               STAT=&STAT,                                         @M5A*14940003
               SUBPOOL=&SUBPOOL,                                   @M5A*14950003
               TERMID=&TERMID,                                     @M5A*14960003
               USERID=&USERID,                                     @M5A*14970003
               TOKNIN=&TOKNIN,                                     @D2C*14980003
               TOKNOUT=&TOKNOUT,                                   @D2C*14990003
               STOKEN=&STOKEN,                                     @M5A*15000003
               SECLABL=&SECLABL,                                   @M5A*15010003
               EXENODE=&EXENODE,                                   @M5A*15020003
               SNODE=&SNODE,                                       @M5A*15030003
               SUSERID=&SUSERID,                                   @M5A*15040003
               SGROUP=&SGROUP,                                     @M5A*15050003
               POE=&POE,                                           @M5A*15060003
               LOGSTR=&LOGSTR,                                     @M5A*15070003
               SESSION=&SESSION,                                   @M5A*15080003
               TRUSTED=&TRUSTED,                                   @M5A*15090003
               REMOTE=&REMOTE,                                     @M8A*15100003
               MF=&MF                                              @P3C 15110003
.RTE10   ANOP  ,                                                   @M9A 15120003
         AIF   (&RQTYPE NE 13).RTE11                               @M9A 15130003
         RACAUDIT ENTITYX=&ENTITYX,                                @M9A*15140003
               ACEE=&ACEE,                                         @M9A*15150003
               CLASS=&CLASS,                                       @M9A*15160003
               EVENT=&EVENT,                                       @M9A*15170003
               EVQUAL=&EVQUAL,                                     @M9A*15180003
               RELEASE=&RELEASE,                                   @M9A*15190003
               RESULT=&RESULT,                                     @D4A*15200003
               LOGSTR=&LOGSTR,                                     @D4A*15210003
               MF=&MF                                              @M9A 15220003
         AGO   .RTE0410                                            @M4A 15230003
.RTE11   ANOP                                                      @M8A 15240003
         AIF   (&RQTYPE NE 14).RTE12                               @N3A 15250003
         RACSTAT ENTRY=&ENTRY,                                     @N3A*15260003
               COPY=&COPY,                                         @D6A*15270003
               COPYLEN=&COPYLEN,                                   @D6A*15280003
               CLASS=&CLASS,                                       @N3A*15290003
               RELEASE=&RELEASE,                                   @N3A*15300003
               MF=&MF                                              @N3A 15310003
         AGO   .RTE0410                                            @N3A 15320003
.RTE12   ANOP                                                      @N3A 15330003
         AIF   (&RQTYPE NE 15).RTE13                               @N6A 15340003
         IRRSGNON TYPE=&TYPE,                                      @N6A*15350003
               APPL=&APPL,                                         @N6A*15360003
               POE=&POE,                                           @N6A*15370003
               LSTTYPE=&LSTTYPE,                                   @N6A*15380003
               RELEASE=&RELEASE,                                   @N6A*15390003
               USERID=&USERID,                                     @N6A*15400003
               GROUP=&GROUP,                                       @N6A*15410003
               SECLABL=&SECLABL,                                   @N6A*15420003
               VERBEXIT=&VERBEXIT,                                 @N6A*15430003
               TOKNOUT=&TOKNOUT,                                   @N6A*15440003
               ACEE=&ACEE,                                         @N6A*15450003
               ENVRIN=&ENVRIN,                                     @N6A*15460003
               ENVROUT=&ENVROUT,                                   @N6A*15470003
               MF=&MF                                              @N6A 15480003
         AGO   .RTE0410                                            @N6A 15490003
.RTE13   ANOP                                                      @N6A 15500003
.RTE0410 ANOP                                                           15510003
         AIF   ('&ICHMF' EQ 'L').EROUTE                                 15520003
         AIF   ('&ICHMF' EQ 'E').DCUP01                          @Q2M   15530003
         AIF   ('&MF(1)' EQ 'M').DCUP01                          @Q2M   15540003
         AGO   .MFEM10                    NOT MF=E OR MF=M       @Q3C   15550003
.* MODIFY DECOUPL FLAG FIELD AS REQUESTED                        @Q2M   15560003
.DCUP01  ANOP  ,                                                 @Q2M   15570003
         AIF   ('&DECOUPL' EQ '').DCUP10                         @Q2M   15580003
         AIF   ('&DECOUPL' NE 'YES').DCUP20                      @Q2M   15590003
         OI    14(14),B'00010000' DECOUPL=YES SPECIFIED          @Q2M   15600003
         AGO   .DCUP10                                           @Q2M   15610003
.DCUP20  ANOP  ,                                                 @Q2M   15620003
         NI    14(14),B'11101111' DECOUPL=NO SPECIFIED           @Q2M   15630003
.DCUP10  ANOP  ,                                                 @Q2M   15640003
.* MODIFY SYSTEM FLAG FIELD AS REQUESTED                         @N6A   15650003
.SYST01  ANOP                                                    @N6A   15660003
         AIF   ('&SYSTEM' EQ '').SYST10                          @N6A   15670003
         AIF   ('&SYSTEM' NE 'YES').SYST20                       @N6A   15680003
         OI    14(14),B'00001000' SYSTEM=YES SPECIFIED           @N6A   15690003
         AGO   .SYST10                                           @N6A   15700003
.SYST20  ANOP                                                    @N6A   15710003
         NI    14(14),B'11110111' SYSTEM=NO SPECIFIED            @N6A   15720003
.SYST10  ANOP                                                    @N6A   15730003
.* MODIFY MSGRTRN FLAG FIELD AS REQUESTED                        @Q3A   15740003
.MRTN01  ANOP  ,                                                 @Q3A   15750003
         AIF   ('&MSGRTRN' EQ '').MRTN20                         @Q3A   15760003
         AIF   ('&MSGRTRN' NE 'YES').MRTN10                      @Q3A   15770003
         OI    14(14),B'10000000' MSGRTRN=YES SPECIFIED          @Q3A   15780003
         AGO   .MRTN20                                           @Q3A   15790003
.MRTN10  ANOP  ,                                                 @Q3A   15800003
         NI    14(14),B'01111111' MSGRTRN=NO SPECIFIED           @Q3A   15810003
.MRTN20  ANOP  ,                                                 @Q3A   15820003
.* MODIFY MSGSUPP FLAG FIELD AS REQUESTED                        @Q3A   15830003
.MSUP01  ANOP  ,                                                 @Q3A   15840003
         AIF   ('&MSGSUPP' EQ '').MSUP20                         @Q3A   15850003
         AIF   ('&MSGSUPP' NE 'YES').MSUP10                      @Q3A   15860003
         OI    14(14),B'00100000' MSGSUPP=YES SPECIFIED          @Q3A   15870003
         AGO   .MSUP20                                           @Q3A   15880003
.MSUP10  ANOP  ,                                                 @Q3A   15890003
         NI    14(14),B'11011111' MSGSUPP=NO SPECIFIED           @Q3A   15900003
.MSUP20  ANOP  ,                                                 @Q3A   15910003
.* MODIFY MSGSP FIELD AS REQUESTED                               @Q3A   15920003
.MSPL01  ANOP  ,                                                 @Q3A   15930003
         AIF   ('&MSGSP' EQ '').MSPL20                           @Q3A   15940003
.MSPL10  ANOP  ,                                                 @Q3A   15950003
         MVI   15(14),&SP         MSGSP  SPECIFIED               @Q3A   15960003
.MSPL20  ANOP  ,                                                 @Q3A   15970003
.MFEM10  ANOP  ,                          NOT MF=E OR MF=M       @Q3A   15980003
         AIF   ('&MF(1)' EQ 'M').EROUTE                            @M3A 15990003
         AIF   (NOT &ICHLFS).RTE0420                              4@R2D 16000003
         L     15,24(0,14)          WORKAREA  ADDRS                @M2A 16010003
         XC    0(64,15),0(15)       CLEAR WORKAREA                 @M2A 16020003
         MVI   3(15),64             STORE WORK AREA LENGTH         @M2A 16030003
         MVC   4(1,15),8(1)         MOVE ATTR                      @M2A 16040003
         LR    0,1                                                 @M2A 16050003
         L     1,40(1)              POINT TO CLASS                 @M2A 16060003
         LTR   1,1                  CLASS SPECIFIED                @M2A 16070003
         BZ    *+10                                                @M2A 16080003
         MVC   7(9,15),0(1)         MOVE CLASS TO WORKAREA         @M2A 16090003
         LR    1,0                                                 @M2A 16100003
         L     1,60(1)              POINT TO USERID                @M2A 16110003
         LTR   1,1                  TEST IF USERID SPECIFIED       @M2A 16120003
         BZ    *+10                                                @M2A 16130003
         MVC   16(8,15),0(1)        MOVE USERID TO WORKAREA        @M2A 16140003
         LR    1,0                                                 @M2A 16150003
         L     1,36(1)              POINT TO ENTITY ADDRESS        @M2A 16160003
         LTR   1,1                  TEST IF ENTITY SPECIFIED       @M2A 16170003
         BZ    *+10                                                @M2A 16180003
         MVC   24(39,15),0(1)       MOVE ENTITY NAME               @M2A 16190003
         LR    1,15                 POINT TO WORKAREA              @M2A 16200003
         LA    15,32                SET DIAGNOSE SUBFUNCTION CODE  @M2A 16210003
         LA    0,64                 SET BUFFER LENGTH              @M2A 16220003
         DC    XL1'83',XL1'1F',XL2'00A0' ISSUE DIAGNOSE X'A0'      @M2A 16230003
.*                                                                 @M2A 16240003
.* SAVE THE RETURN CODE IN THE RACROUTE PARAMETER LIST             @M2A 16250003
.*                                                                 @M2A 16260003
         LA    0,84                                                @M2A 16270003
         CLR   0,15                                                @M2A 16280003
         BNE   *+12                                                @M2A 16290003
         LA    15,642                                              @D4C 16300003
         B     IHB&NX.G                                            @M2A 16310003
         LA    0,255                CHECK FOR SEVER                @M2A 16320003
         CLR   0,15                                                @M2A 16330003
         BNE   *+8                                                 @M2A 16340003
         LA    15,12                SEVER RETURN CODE              @R3C 16350003
         B     IHB&NX.G                                           2@R3D 16360003
IHB&NX.G DS    0F                                                  @M2A 16370003
         ST    15,0(14)             SAVE RACF RETURN CODE          @M2A 16380003
         XR    0,0                                                 @M2A 16390003
         XC    4(4,14),4(14)                                       @M2A 16400003
         AGO   .EROUTE                                             @M2A 16410003
.RTE0420 ANOP                                                      @M2A 16420003
         LR    1,14                 RESTORE ADDRESSABILITY TO PARM LIST 16430003
         L     15,16(0,0)           GET CVT ADDRESS            @D64CDHH 16440003
         TM    X'74'(15),X'A8'      EXECUTING ON VSE/ESA ?     @D64CDHH 16450003
         BNO   *+16                 NO, SKIP VSE LOGIC         @D64CDHH 16460003
         ICM   15,B'1111',24(1)     LOAD WORKAREA ADDRESS      @D64CDHH 16470003
         BNZ   *+8                  IT IS SPECIFIED            @D64CDHH 16480003
*        VSE/ESA:  FORCE OPERATION EXCEPTION IF REQUIRED       @D64CDHH 16490003
*                  PARAMETER WORKA= WAS NOT SPECIFIED          @D64CDHH 16500003
         DC    X'00000000'          WORKA MISSING - TERMINATE  @D64CDHH 16510003
         L     15,16(0,0)           ADDRESS OF CVT                      16520003
         ICM   15,B'1111',248(15)   ADDRESS OF SAF VECTOR TABLE         16530003
         BNZ   IHB&NX.D                                                 16540003
         LA    15,4                 SAF ROUTER NOT AVAILABLE IN SYSTEM  16550003
         B     IHB&NX.E                                                 16560003
IHB&NX.D DS    0H                                                       16570003
         ICM   15,B'1111',12(15)    PICK UP ADDRESS OF SAF ROUTER  @R4C 16580003
         BNZ   IHB&NX.H                                            @R4A 16590003
         LA    15,4                 SAF ROUTER NOT AVAILABLE       @R4A 16600003
         B     IHB&NX.E                                                 16610003
IHB&NX.H DS    0H                                                  @R4A 16620003
         BALR  14,15                BRANCH TO SAF ROUTER                16630003
IHB&NX.E DS    0H                                                       16640003
         AGO   .EROUTE                                                  16650003
.*****************                                                      16660003
.*  ERROR MESSAGES                                                      16670003
.*****************                                                      16680003
.ERR01   ANOP                                                           16690003
         MNOTE 12,'*** INVALID VALUE FOR MF PARAMETER'                  16700003
         AGO   .EROUTE                                                  16710003
.ERR01A  ANOP                                                      @M2A 16720003
         MNOTE 12,'*** MF=M IS NOT VALID WHEN RELEASE=1.8.2 IS SPECIFIE*16730003
               D'                                                  @D4A 16740003
         AGO   .EROUTE                                             @D4C 16750003
.ERR02   ANOP                                                           16760003
         MNOTE 12,'*** REQUEST PARAMETER MISSING'                       16770003
         AGO   .EROUTE                                                  16780003
.ERR03   ANOP                                                           16790003
         MNOTE 08,'*** EXTRANEOUS PARAMETERS IGNORED FOR &XTRAPRM' @N4C 16800003
         AGO   .CONT02                                                  16810003
.ERR04   ANOP                                                           16820003
         MNOTE 12,'*** INVALID VALUE FOR REQUEST PARAMETER'             16830003
         AGO   .EROUTE                                                  16840003
.ERR05   ANOP                                                           16850003
         MNOTE 12,'*** WORKA PARAMETER MISSING'                         16860003
         AGO   .EROUTE                                                  16870003
.ERR06   ANOP                                                           16880003
         MNOTE 12,'*** INVALID VALUE FOR "MSGSP" PARAMETER: "&MSGSP"'   16890003
         AGO   .EROUTE                                             @P1A 16900003
.ERR07   ANOP                                                      @P1A 16910003
         MNOTE 12,'*** INVALID VALUE FOR "MSGRTRN" PARAMETER: "&MSGRTRN+16920003
               "'                                                  @P1A 16930003
         AGO   .ERTN07                                             @M3C 16940003
.ERR08   ANOP                                                      @P1A 16950003
         MNOTE 12,'*** INVALID VALUE FOR "MSGSUPP" PARAMETER: "&MSGSUPP+16960003
               "'                                                  @P1A 16970003
         AGO   .CONT07                                             @M3C 16980003
.ERR08A  ANOP                                                      @M3A 16990003
         MNOTE 12,'*** INVALID VALUE FOR "DECOUPL" PARAMETER: "&DECOUPL+17000003
               "'                                                  @M3A 17010003
         AGO   .ERTN08A                                            @M3A 17020003
.ERR09   ANOP                                                      @P1A 17030003
         MNOTE 12,'*** RELEASE=1.8 (OR LATER) MUST BE CODED TO USE THE +17040003
               "MSGRTRN" PARAMETER'                                @M4C 17050003
         AGO   .EROUTE                                             @P1A 17060003
.ERR09A  ANOP                                                      @M2A 17070003
         MNOTE 4,'*** "MSGRTRN" PARAMETER IS IGNORED WITH RELEASE=1.8.2+17080003
                SPECIFIED'                                         @D4A 17090003
         AGO   .ERTN09A                                            @M2A 17100003
.ERR10   ANOP                                                      @P1A 17110003
         MNOTE 12,'*** RELEASE=1.8 (OR LATER) MUST BE CODED TO USE THE +17120003
               "MSGSUPP" PARAMETER'                                @M4C 17130003
         AGO   .EROUTE                                             @P1A 17140003
.ERR10A  ANOP                                                      @M2A 17150003
         MNOTE 4,'*** "MSGSUPP" PARAMETER IS IGNORED WITH RELEASE=1.8.2+17160003
                SPECIFIED'                                         @D4A 17170003
         AGO   .ERTN10A                                            @M2A 17180003
.ERR12   ANOP                                                      @P1A 17190003
         MNOTE 12,'*** RELEASE=1.8 (OR LATER) MUST BE CODED TO USE THE +17200003
               "MSGSP" PARAMETER'                                  @M4C 17210003
         AGO   .EROUTE                                                  17220003
.ERR12A  ANOP                                                      @M2A 17230003
         MNOTE 4,'*** "MSGSP" PARAMETER IS IGNORED WITH RELEASE=1.8.2 S+17240003
               PECIFIED'                                           @D4C 17250003
         AGO   .ERTN12A                                            @M2A 17260003
.ERR13   ANOP                                                      @M2A 17270003
         MNOTE 12,'*** REQUEST=DIRAUTH IS INVALID IF RELEASE=1.8.2 IS S+17280003
               PECIFIED'                                           @D4C 17290003
         AGO   .EROUTE                                             @M2A 17300003
.ERR13A  ANOP                                                      @D4A 17310003
         MNOTE 12,'*** REQUEST=TOKENMAP IS INVALID IF RELEASE=1.8.2 IS +17320003
               SPECIFIED'                                          @D4A 17330003
         AGO   .EROUTE                                             @D4A 17340003
.ERR13B  ANOP                                                      @D4A 17350003
         MNOTE 12,'*** REQUEST=VERIFYX IS INVLAID IF RELEASE=1.8.2 IS S+17360003
               PECIFIED'                                           @D4A 17370003
         AGO   .EROUTE                                             @D4A 17380003
.ERR13C  ANOP                                                      @D4A 17390003
         MNOTE 12,'*** REQUEST=TOKENXTR IS INVALID IF RELEASE=1.8.2 IS +17400003
               SPECIFIED'                                          @D4A 17410003
         AGO   .EROUTE                                             @D4A 17420003
.ERR13D  ANOP                                                      @D4A 17430003
         MNOTE 12,'*** REQUEST=TOKENBLD IS INVALID IF RELEASE=1.8.2 IS +17440003
               SPECIFIED'                                          @D4A 17450003
         AGO   .EROUTE                                             @D4A 17460003
.ERR13E  ANOP                                                      @D4A 17470003
         MNOTE 12,'*** REQUEST=AUDIT IS INVALID IF RELEASE=1.8.2 IS SPE+17480003
               CIFIED'                                             @D4A 17490003
         AGO   .EROUTE                                             @D4A 17500003
.ERR13F  ANOP                                                      @D4A 17510003
         MNOTE 12,'*** REQUEST=STAT IS INVALID IF RELEASE=1.8.2 IS SPEC+17520003
               IFIED'                                              @D4A 17530003
         AGO   .EROUTE                                             @D4A 17540003
.ERR15   ANOP                                                      @M2A 17550003
         MNOTE 12,'*** REQUEST=FASTAUTH IS INVALID IF RELEASE=1.8.2 IS +17560003
               SPECIFIED'                                          @D4C 17570003
         AGO   .EROUTE                                             @M2A 17580003
.ERR16   ANOP                                                      @M2A 17590003
         MNOTE 12,'*** REQUEST=LIST IS INVALID IF RELEASE=1.8.2 IS SPEC+17600003
               IFIED'                                              @D4C 17610003
         AGO   .EROUTE                                             @M2A 17620003
.ERR17   ANOP                                                      @M2A 17630003
         MNOTE 12,'*** REQUEST=DEFINE IS INVALID IF RELEASE=1.8.2 IS SP+17640003
               ECIFIED'                                            @D4C 17650003
         AGO   .EROUTE                                             @M2A 17660003
.ERR18   ANOP                                                      @M2A 17670003
         MNOTE 12,'*** REQUEST=VERIFY IS INVALID IF RELEASE=1.8.2 IS SP+17680003
               ECIFIED'                                            @D4A 17690003
         AGO   .EROUTE                                             @M2A 17700003
.ERR19   ANOP                                                      @M2A 17710003
         MNOTE 12,'*** REQUEST=EXTRACT IS INVALID IF RELEASE=1.8.2 IS S+17720003
               PECIFIED'                                           @D4C 17730003
         AGO   .EROUTE                                             @M2A 17740003
.ERR20   ANOP                                                      @M2A 17750003
         MNOTE 4,'*** "REQSTOR" IS IGNORED WHEN RELEASE=1.8.2 IS SPECIF+17760003
               IED'                                                @D4C 17770003
         AGO   .ERTN20                                             @M2A 17780003
.ERR21   ANOP                                                      @M2A 17790003
         MNOTE 4,'*** "SUBSYS" IS IGNORED WHEN RELEASE=1.8.2 IS SPECIFI+17800003
               ED'                                                 @D4C 17810003
         AGO   .ERTN21                                             @M2A 17820003
.ERR22   ANOP                                                      @P6A 17830003
         MNOTE 8,'*** "TOKNOUT" IS A REQUIRED PARAMETER FOR VERIFYX REQ+17840003
               UEST ***'                                           @Q4C 17850003
         AGO   .ERTN22                                             @P6A 17860003
.ERR22A  ANOP                                                      @N5A 17870003
         MNOTE 8,'*** "XMREQ" IS A SUPPORTED BY RELEASE 1.9 AND LATER O+17880003
               NLY ***'                                            @N5A 17890003
         AGO   .ERTN22A                                            @N5A 17900003
.ERR23   ANOP                                                      @N1A 17910003
         MNOTE 8,'*** "DECOUPL" IS SUPPORTED BY RELEASE 1.9 AND LATER O+17920003
               NLY ***'                                            @N1A 17930003
         AGO   .ERTN23                                             @N1A 17940003
.ERR24   ANOP                                                      @N2A 17950003
         MNOTE 8,'*** "ECB1" IS SUPPORTED BY RELEASE 1.9 AND LATER ONLY+17960003
                ***'                                               @N2A 17970003
         AGO   .ERTN24                                             @N2A 17980003
.ERR25   ANOP                                                      @N2A 17990003
         MNOTE 8,'*** "ECB2" IS SUPPORTED BY RELEASE 1.9 AND LATER ONLY+18000003
                ***'                                               @N2A 18010003
         AGO   .ERTN25                                             @N2A 18020003
.ERR26   ANOP                                                      @N2A 18030003
         MNOTE 8,'*** "USERWRD" IS SUPPORTED BY RELEASE 1.9 AND LATER O+18040003
               NLY ***'                                            @N2A 18050003
         AGO   .ERTN26                                             @N2A 18060003
.ERR27   ANOP                                                      @N2A 18070003
         MNOTE 8,'*** "POSTEXI" IS SUPPORTED BY RELEASE 1.9 AND LATER O+18080003
               NLY ***'                                            @N2A 18090003
         AGO   .ERTN27                                             @N2A 18100003
.ERR28   ANOP                                                      @N2A 18110003
         MNOTE 8,'*** "PREEXI" IS SUPPORTED BY RELEASE 1.9 AND LATER ON+18120003
               LY ***'                                             @N2A 18130003
         AGO   .ERTN28                                             @N2A 18140003
.ERR29   ANOP                                                      @N3A 18150003
         MNOTE 8,'*** "REQUEST=STAT" IS SUPPORTED BY RELEASE 1.9 AND LA+18160003
               TER ONLY ***'                                       @N3A 18170003
         AGO   .ERTN29                                             @N3A 18180003
.ERR30   ANOP                                                      @Q6A 18190003
         MNOTE 8,'*** "TOKNOUT" IS A REQUIRED PARAMETER FOR TOKENBLD RE+18200003
               QUEST ***'                                          @Q6A 18210003
         AGO   .ERTN30                                             @Q6A 18220003
.ERR31   ANOP                                                      @N4A 18230003
         MNOTE 8,'*** "TOKNOUT" KEYWORD IN COMBINATION WITH "REQUEST=VE+18240003
               RIFY" IS SUPPORTED BY RELEASE 1.9 AND LATER ONLY ***'   +18250003
                                                                   @N4A 18260003
         AGO   .CONT02                                             @N4A 18270003
.ERR32   ANOP                                                      @N5A 18280003
         MNOTE 12,'*** INVALID VALUE FOR "XMREQ"  PARAMETER: "&XMREQ"  +18290003
               ***'                                                @N5A 18300003
         AGO   .ERTN08Y                                            @N5A 18310003
.ERR33   ANOP                                                      @N6A 18320003
         MNOTE 8,'*** "REQUEST=SIGNON" IS SUPPORTED BY RELEASE 1.9.2 AN+18330003
               D LATER ONLY ***'                                   @N6A 18340003
         AGO   .EROUTE                                             @N6A 18350003
.ERR34   MNOTE 8,'*** "SYSTEM" KEYWORD IS SUPPORTED BY RELEASE 1.9.2 AN+18360003
               D LATER ONLY ***'                                   @N6A 18370003
         AGO   .ERTN34                                             @N6A 18380003
.ERR35   MNOTE 8,'*** "ENVRIN/ENVROUT" KEYWORDS ARE SUPPORTED BY RELEAS+18390003
               E 1.9.2 AND LATER ONLY ***'                         @N6A 18400003
         AGO   .ERTN35                                             @N6A 18410003
.ERR36   MNOTE 12,'*** INVALID VALUE FOR "SYSTEM" PARAMETER: "&SYSTEM" +18420003
               ***'                                                @N6A 18430003
         AGO   .ERTN08X                                            @N6A 18440003
.ERR37   MNOTE 8,'*** "GLOBAL" KEYWORD IS SUPPORTED BY RELEASE 2.1 AND +18450003
               LATER ONLY ***'                                     @L9A 18460003
         AGO   .ERTN37                                             @L9A 18470003
.ERR38   MNOTE 8,'*** "COPY" KEYWORD IS SUPPORTED BY RELEASE 2.2 AND LA+18480003
               TER ONLY ***'                                       @D6A 18490003
         AGO   .ERTN38                                             @D6A 18500003
.ERR39   MNOTE 8,'*** "COPYLEN" KEYWORD IS SUPPORTED BY RELEASE 2.2 AND+18510003
                LATER ONLY ***'                                    @D6A 18520003
         AGO   .ERTN39                                             @D6A 18530003
.EROUTE  ANOP                                                           18540003
.* RESET GLOBALS                                                        18550003
&ICHRAC  SETB  0                                                        18560003
&ICHL    SETC  ''                                                       18570003
&ICHLFS  SETB  0                                                   @M2A 18580003
         MEND                                                           18590003
