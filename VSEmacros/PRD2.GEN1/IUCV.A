         MACRO                                                          00050000
&LBL     IUCV  &FCN,          FUNCTION                                 $00100000
               &ALL=,         ALL OPTION                               $00150000
               &ANSBUF=,      ANSWER BUFFER                            $00200000
               &ANSLEN=,      LENGTH OF ANSWER BUFFER                  $00250000
               &ANSLIST=,     ANSWER LIST OPTION                       $00300000
               &BUFFER=,      MESSAGE BUFFER                           $00350000
               &BUFLEN=,      LENGTH OF MESSAGE BUFFER                 $00400000
               &BUFLIST=,     BUFFER LIST OPTION                       $00450000
               &CONTROL=,     CONTROL OPTION                           $00500000
               &COMSRV=,      COMMUNICATION SERVER OPTION              $00550000
               &CP=,          LINKAGE OPTION                           $00600000
               &DATA=,        DATA TYPE OPTION                         $00650000
               &FCNCD=,       CP SYSTEM SERVICE CODE                   $00700000
               &LOGDATA=,     LOG_DATA OPTION                          $00750000
               &MASK=,        ENABLE MASK                              $00800000
               &MF=,          MACRO FORM OPTION                        $00850000
               &MSGID=,       MESSAGE IDENTIFICATION                   $00900000
               &MSGLIM=,      MESSAGE LIMIT                            $00950000
               &MSGTAG=,      MESSAGE TAG                              $01000000
               &PATHID=,      PATH IDENTIFICATION                      $01050000
               &PRMDATA=,     PARMETER LIST DATA OPTION                $01100000
               &PRMLIST=,     PARMETER LIST                            $01150000
               &PRMMSG=,      PARAMETER LIST MESSAGE                   $01200000
               &PRTY=,        PRIORITY OPTOIN                          $01250000
               &QUIESCE=,     QUIESCE OPTION                           $01300000
               &SRCCLS=,      SOURCE MESSAGE CLASS                     $01350000
               &TRGCLS=,      TARGET MESSAGE CLASS                     $01400000
               &TYPE=,        ONE-WAY MESSAGE OPTION                   $01450000
               &USERDTA=,     USER DATA                                $01500000
               &USERID=,      USER IDENTIFICATION                      $01550000
               &VMBLOK=       VMBLOK OPTION                             01600000
         LCLA  &IUCVERR,&BITC,&BITD                                     01650000
         LCLC  &MAP,&BITS,&BITSF,&SV                                    01700000
         LCLC  &BITS2,&BITS2F                                  @V6RCGLD 01750000
         LCLC  &WK1,&WK2                                       @V6DJ1G1 01800000
.**************************************************************         01850000
.*                                                            *         01900000
.*       IBM DISK OPERATING SYSTEM                            *         01950000
.*       SUPERVISOR - IUCV                                    *         02000000
         AGO  .ZZZ                                            *         02050000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"          *         02100000
*        5686-007 (C) COPYRIGHT IBM CORP. 1982, 1989          *         02150000
*        ALL RIGHTS RESERVED                                  *         02200000
*        LICENSED MATERIALS-PROPERTY OF IBM                   *         02250000
.*       SEE COPYRIGHT INSTRUCTIONS, G120-2083                *         02300000
.ZZZ     ANOP                                                 *         02350000
.* A000000-999999                                             *@D31BDUL 02400000
.* CODE COPIED FROM VM/SP FOR APPCVM SUPPORT - LEVEL VM/SP 6  *@D31BDUL 02450000
.*                                                            *         02500000
.**************************************************************         02550000
.*** START OF SPECIFICATIONS **********************************         02600000
.*                                                            *         02650000
.*01* MODULE-TYPE = PROGRAM INTERFACE MACRO                   *         02700000
.*                                                            *         02750000
.*01* DESCRIPTIVE NAME = IUCV SERVICE REQUEST MACRO           *         02800000
.*                                                            *         02850000
.*** END OF SPECIFICATIONS ************************************         02900000
.*.6******************************************************************* 02950000
.*                                                                      03000000
.* MACRO NAME -           *----------------*                            03050000
.*                        *      IUCV      *                            03100000
.*                        *----------------*                            03150000
.*                                                                      03200000
.* COPYRIGHT -                                                          03250000
.*                                                                      03300000
.*       "CONTAINS    RESTRICTED   MATERIALS   OF   IBM"                03350000
.*       (C) COPYRIGHT  IBM  CORPORATION      1980, 1986,1988           03400000
.*       LICENSED MATERIALS -  PROGRAM PROPERTY OF I B M                03450000
.*       SEE COPYRIGHT      INSTRUCTIONS: FORM G120-2083                03500000
.*                                                                      03550000
.* STATUS -                                                             03600000
.*                                                                      03650000
.*       VM/SYSTEM PRODUCT - 5664-167                                   03700000
.*                                                                      03750000
.* FUNCTION -                                                           03800000
.*                                                                      03850000
.*       THE IUCV MACRO INITIALIZES THE PARAMETER LIST AND PROVIDES     03900000
.*       LINKAGE FOR THE IUCV FUNCTIONS.                                03950000
.*                                                                      04000000
.* SYNTAX OF THE MACRO -                                                04050000
.*                                                                      04100000
.*       IUCV      &FCN=NNNNNNNN,               REQUIRED                04150000
.*                 &ALL=YES/NO,                 OPTIONAL                04200000
.*                 &ANSBUF=LABEL/(REG),         OPTIONAL                04250000
.*                 &ANSLEN=LABEL/(REG),         OPTIONAL                04300000
.*                 &ANSLIST=LABEL/(REG),        OPTIONAL                04350000
.*                 &BUFFER=LABEL/(REG),         OPTIONAL                04400000
.*                 &BUFLEN=LABEL/(REG),         OPTIONAL                04450000
.*                 &BUFLIST=LABEL/(REG),        OPTIONAL                04500000
.*                 &CONTROL=YES/NO,             OPTIONAL                04550000
.*                 &COMSRV=YES/NO,              RESTRICTED              04600000
.*                 &CP=YES/NO,                  OPTIONAL                04650000
.*                 &DATA=BUFFER/PRMMSG,         OPTIONAL                04700000
.*                 &FCNCD=TERM/(REG),           OPTIONAL                04750000
.*                 &LOGDATA=YES/NO,             OPTIONAL                04800000
.*                 &MASK=TERM/(REG),            OPTIONAL                04850000
.*                 &MF=L,                       OPTIONAL                04900000
.*                 &MSGID=LABEL/(REG),          OPTIONAL                04950000
.*                 &MSGLIM=LABEL/(REG),         OPTIONAL                05000000
.*                 &MSGTAG=LABEL/(REG),         OPTIONAL                05050000
.*                 &PATHID=LABEL/(REG),         OPTIONAL                05100000
.*                 &PRMDATA=YES/NO,             OPTIONAL                05150000
.*                 &PRMLIST=LABEL/(REG),        OPTIONAL                05200000
.*                 &PRMMSG=LABEL/(REG),         OPTIONAL                05250000
.*                 &PRTY=YES/NO,                OPTIONAL                05300000
.*                 &QUIESCE=YES/NO,             OPTIONAL                05350000
.*                 &SRCCLS=LABEL/(REG),         OPTIONAL                05400000
.*                 &TRGCLS=LABEL/(REG),         OPTIONAL                05450000
.*                 &TYPE=1WAY/2WAY,             OPTIONAL                05500000
.*                 &USERDTA=LABEL,(REG),        OPTIONAL                05550000
.*                 &USERID=LABEL,(REG),         OPTIONAL                05600000
.*                 &VMBLOK=USER/SYSTEM          OPTIONAL                05650000
.*                                                                      05700000
.* NOTES -                                                              05750000
.*                                                                      05800000
.*       MNOTES -                                                       05850000
.*                                                                      05900000
.*       MNOTE 8,'TOO MANY POSITIONAL PARMS SPECIFIED'                  05950000
.*       MNOTE 8,'FUNCTION CODE NOT SPECIFIED'                          06000000
.*       MNOTE 8,'&FCN IS NOT A VALID FUNCTION'                         06050000
.*       MNOTE 8,'XXXXX= IS NOT ALLOWED ON THE &FCN FUNCTION'           06100000
.*       MNOTE 8,'XXXXX=YYYYY INVALID'                                  06150000
.*       MNOTE 8,'XXXXX= MUST BE ONE OR TWO SUB PARMS'                  06200000
.*       MNOTE 8,'XXXXX= LENGTH (2ND SUB PARM) MUST BE 2 OR 4'          06250000
.*       MNOTE 8,'PRMLIST= IS REQUIRED'                                 06300000
.*       MNOTE 8,'XXXXX=YYYYY INVALID WITH ZZZZZ='                      06350000
.*       MNOTE 8,'XXXXX=YYYYY INVALID WITH ZZZZZ=UUUUU'                 06400000
.*       MNOTE 8,'XXXXX= INVALID WITH ZZZZZ='                           06450000
.*       MNOTE 8,'XXXXX= INVALID WITH ZZZZZ=UUUUU'                      06500000
.*       MNOTE 8,'&FCN INVALID WITH ZZZZZ=UUUUU'                        06550000
.*       MNOTE 8,'XXXXX= VALID ONLY WITH ZZZZZ=UUUUU'                   06600000
.*                                                                      06650000
.* OPERATION -                                                          06700000
.*                                                                      06750000
.*       1. CHECK POSITIONAL PARAMETERS                                 06800000
.*       2. VERIFY THE REQUESTED FUNCTION AND SET THE FUNCTION MAP      06850000
.*       3. VALIDATE THE OPTIONS SPECIFIED                              06900000
.*       4. IF INVALID OPTIONS WERE FOUND, THEN EXIT                    06950000
.*       5. GENERATE THE CODE TO FILL IN THE PARAMETER LIST             07000000
.*       6. IF THE MACRO FORM IS LIST ONLY, THEN EXIT                   07050000
.*       7. GENERATE THE LINKAGE TO PERFORM THE IUCV FUNCTION           07100000
.*                                                                      07150000
.* CHANGE ACTIVITY -                                                    07200000
.*                                                                      07250000
.*       THE S&D CODE OF EACH ADDED/CHANGED LINE WILL BE UPDATED TO     07300000
.*       REFLECT SERVICE AND NEW DEVELOPMENT IN THIS MODULE.            07350000
.*                                                                      07400000
.*.$******************************************************************* 07450000
.*                                                                      07500000
.*                                                                      07550000
.*--------------------------------------------------------------------- 07600000
.*       CHECK POSITIONAL PARAMETERS                                    07650000
.*--------------------------------------------------------------------- 07700000
.*                                                                      07750000
         AIF   (N'&SYSLIST LE 1).EXTOK                         @V6BD29E 07800000
         MNOTE 8,'TOO MANY POSITIONAL PARMS SPECIFIED'                  07850000
.*                                                             @V6BD29E 07900000
&IUCVERR SETA  1                                               @V6BD29E 07950000
.EXTOK   ANOP                                                  @V6BD29E 08000000
         AIF   (T'&FCN NE 'O').FCNOK                                    08050000
         MNOTE 8,'FUNCTION CODE NOT SPECIFIED'                          08100000
         MEXIT                                                          08150000
.*                                                                      08200000
.*--------------------------------------------------------------------- 08250000
.*       VERIFY THE REQUESTED FUNCTION AND SET THE FUNCTION MAP         08300000
.*--------------------------------------------------------------------- 08350000
.*                                                                      08400000
.* NOTE:                                                                08450000
.*       THE MAPPING VARIABLE GENERATED IN THE FOLLOWING SECTION        08500000
.*       CONTAINS THE FUNCTION CODE OF THE IUCV FUNCTION REQUESTED      08550000
.*       AND A MAP OF THE ARGUMENTS REQUIRED AND ALLOWED FOR THIS       08600000
.*       FUNCTION.  THE FUNCTION CODE IS CARRIED AS POSITIONS 1         08650000
.*       AND 2, THE REST REFLECT THE ARGUMENTS REQUIRED AND ALLOWED.    08700000
.*                                                                      08750000
.*    POS 03 - ALL=       0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         08800000
.*    POS 04 - ANSBUF=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         08850000
.*    POS 05 - ANSLEN=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         08900000
.*    POS 06 - BUFFER=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         08950000
.*    POS 07 - BUFLEN=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09000000
.*    POS 08 - CP=        0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09050000
.*    POS 09 - FCNCD=     0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09100000
.*    POS 10 - MASK=      0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09150000
.*    POS 11 - MSGID=     0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09200000
.*    POS 12 - MSGLIM=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09250000
.*    POS 13 - MSGTAG=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09300000
.*    POS 14 - PATHID=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09350000
.*    POS 15 - PRMLIST=   0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09400000
.*    POS 16 - PRTY=      0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09450000
.*    POS 17 - QUIESCE=   0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09500000
.*    POS 18 - SRCCLS=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09550000
.*    POS 19 - TRGCLS=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09600000
.*    POS 20 - TYPE=      0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09650000
.*    POS 21 - USERDTA=   0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09700000
.*    POS 22 - USERID=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09750000
.*    POS 23 - VMBLOK=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09800000
.*    POS 24 - MF=        0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09850000
.*    POS 25 - PRMDATA=   0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09900000
.*    POS 26 - DATA=      0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         09950000
.*    POS 27 - PRMMSG=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         10000000
.*    POS 28 - BUFLIST=   0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         10050000
.*    POS 29 - ANSLIST=   0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         10100000
.*    POS 30 - CONTROL=   0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         10150000
.*    POS 31 - COMSRV=    0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         10200000
.*    POS 32 - LOGDATA=   0=NOT ALLOWED, 1=REQUIRED, 2=OPTIONAL         10250000
.*                                                                      10300000
.FCNOK   ANOP                                                           10350000
         AIF   ('&FCN' NE 'QUERY').NOT0001                              10400000
&MAP     SETC  '00000000000000000000000000000000'              @V6RCGGS 10450000
         AGO   .CKOUT                                                   10500000
.NOT0001 ANOP                                                           10550000
         AIF   ('&FCN' NE 'TESTMSG').NOT0002                            10600000
&MAP     SETC  '01000000000000000000000000000000'              @V6RCGGS 10650000
         AGO   .CKOUT                                                   10700000
.NOT0002 ANOP                                                           10750000
         AIF   ('&FCN' NE 'RTRVBFR').NOT0003                            10800000
&MAP     SETC  '02000002000000000000002000000000'              @V6RCGGS 10850000
         AGO   .CKOUT                                                   10900000
.NOT0003 ANOP                                                           10950000
         AIF   ('&FCN' NE 'DESCRIBE').NOT0004                           11000000
&MAP     SETC  '03000002000000100000002200000000'              @V6RCGGS 11050000
         AGO   .CKOUT                                                   11100000
.NOT0004 ANOP                                                           11150000
         AIF   ('&FCN' NE 'SEND').NOT0005                               11200000
&MAP     SETC  '04022222000022120222002202222000'              @V6RCGGS 11250000
         AGO   .CKOUT                                                   11300000
.NOT0005 ANOP                                                           11350000
         AIF   ('&FCN' NE 'RECEIVE').NOT0006                            11400000
&MAP     SETC  '05000222002002100020002200020000'              @V6RCGGS 11450000
         AGO   .CKOUT                                                   11500000
.NOT0006 ANOP                                                           11550000
         AIF   ('&FCN' NE 'REPLY').NOT0007                              11600000
&MAP     SETC  '06022002002002120020002202202000'              @V6RCGGS 11650000
         AGO   .CKOUT                                                   11700000
.NOT0007 ANOP                                                           11750000
         AIF   ('&FCN' NE 'TESTCMPL').NOT0008                           11800000
&MAP     SETC  '07000002002002100200002200000000'              @V6RCGGS 11850000
         AGO   .CKOUT                                                   11900000
.NOT0008 ANOP                                                           11950000
         AIF   ('&FCN' NE 'REJECT').NOT0009                             12000000
&MAP     SETC  '08000002002002100020002200000000'              @V6RCGGS 12050000
         AGO   .CKOUT                                                   12100000
.NOT0009 ANOP                                                           12150000
         AIF   ('&FCN' NE 'PURGE').NOT0010                              12200000
&MAP     SETC  '09000002002002100200002200000000'              @V6RCGGS 12250000
         AGO   .CKOUT                                                   12300000
.NOT0010 ANOP                                                           12350000
         AIF   ('&FCN' NE 'ACCEPT').NOT0011                             12400000
&MAP     SETC  '10000002000202122000202220000022'              @V6RCGGS 12450000
         AGO   .CKOUT                                                   12500000
.NOT0011 ANOP                                                           12550000
         AIF   ('&FCN' NE 'CONNECT').NOT0012                            12600000
&MAP     SETC  '11000002200200122000222220000200'              @V6RCGGS 12650000
         AGO   .CKOUT                                                   12700000
.NOT0012 ANOP                                                           12750000
         AIF   ('&FCN' NE 'DCLBFR').NOT0013                             12800000
&MAP     SETC  '12000202000000100000002200000200'              @V6RCGGS 12850000
         AGO   .CKOUT                                                   12900000
.NOT0013 ANOP                                                           12950000
         AIF   ('&FCN' NE 'QUIESCE').NOT0014                            13000000
&MAP     SETC  '13200002000002100000202200000000'              @V6RCGGS 13050000
         AGO   .CKOUT                                                   13100000
.NOT0014 ANOP                                                           13150000
         AIF   ('&FCN' NE 'RESUME').NOT0015                             13200000
&MAP     SETC  '14200002000002100000202200000000'              @V6RCGGS 13250000
         AGO   .CKOUT                                                   13300000
.NOT0015 ANOP                                                           13350000
         AIF   ('&FCN' NE 'SEVER').NOT0016                              13400000
&MAP     SETC  '15200002000002100000202200000000'              @V6RCGGS 13450000
         AGO   .CKOUT                                                   13500000
.NOT0016 ANOP                                                           13550000
         AIF   ('&FCN' NE 'SETMASK').NOT0017                            13600000
&MAP     SETC  '16000000020000100000000200000000'              @V6RCGGS 13650000
         AGO   .CKOUT                                                   13700000
.NOT0017 ANOP                                                           13750000
         AIF   ('&FCN' NE 'SETCMASK').NOT017A                  @V6GN6KD 13800000
&MAP     SETC  '17000000020000100000000200000000'              @V6RCGGS 13850000
         AGO   .CKOUT                                          @V6GN6KD 13900000
.NOT017A ANOP                                                  @V6GN6KD 13950000
         MNOTE 8,'&FCN IS NOT A VALID FUNCTION'                         14000000
         MEXIT                                                          14050000
.*                                                                      14100000
.*--------------------------------------------------------------------- 14150000
.*       VALIDATE THE ALL OPTION                                        14200000
.*--------------------------------------------------------------------- 14250000
.*                                                                      14300000
.CKOUT   ANOP                                                           14350000
         AIF   (T'&ALL EQ 'O').END0018                                  14400000
         AIF   ('&MAP'(3,1) NE '0').CHK0018                             14450000
         MNOTE 8,'ALL= IS NOT ALLOWED ON THE &FCN FUNCTION'             14500000
&IUCVERR SETA  1                                                        14550000
         AGO   .END0018                                                 14600000
.CHK0018 ANOP                                                           14650000
         AIF   ('&ALL' EQ 'YES').END0018                                14700000
         AIF   ('&ALL' EQ 'NO').END0018                                 14750000
         MNOTE 8,'ALL=&ALL INVALID'                                     14800000
&IUCVERR SETA  1                                                        14850000
.END0018 ANOP                                                           14900000
.*                                                                      14950000
.*--------------------------------------------------------------------- 15000000
.*       VALIDATE THE ANSWER BUFFER PARAMETER                           15050000
.*--------------------------------------------------------------------- 15100000
.*                                                                      15150000
         AIF   (T'&ANSBUF EQ 'O').END0019                               15200000
         AIF   ('&MAP'(4,1) NE '0').END0019                             15250000
         MNOTE 8,'ANSBUF= IS NOT ALLOWED ON THE &FCN FUNCTION'          15300000
&IUCVERR SETA  1                                                        15350000
.END0019 ANOP                                                           15400000
.*                                                                      15450000
.*--------------------------------------------------------------------- 15500000
.*       VALIDATE THE ANSWER LENGTH PARAMETER                           15550000
.*--------------------------------------------------------------------- 15600000
.*                                                                      15650000
         AIF   (T'&ANSLEN EQ 'O').END0020                               15700000
         AIF   ('&MAP'(5,1) NE '0').CHK0020                    @V6DJ1G1 15750000
         MNOTE 8,'ANSLEN= IS NOT ALLOWED ON THE &FCN FUNCTION'          15800000
&IUCVERR SETA  1                                                        15850000
         AGO   .END0020                                                 15900000
.CHK0020 ANOP                                                  @V6DJ1G1 15950000
         AIF   (N'&ANSLEN EQ 1).END0020                        @V6DJ1G1 16000000
         AIF   (N'&ANSLEN EQ 2).CK20020                        @V6DJ1G1 16050000
         MNOTE 8,'ANSLEN= MUST BE ONE OR TWO SUB PARMS'                 16100000
.*                                                             @V6DJ1G1 16150000
&IUCVERR SETA  1                                               @V6DJ1G1 16200000
         AGO   .END0020                                        @V6DJ1G1 16250000
.CK20020 ANOP                                                  @V6DJ1G1 16300000
&WK2     SETC  '&ANSLEN(2)'                                    @V6DJ1G1 16350000
         AIF   ('&WK2' EQ '2').END0020                         @V6DJ1G1 16400000
         AIF   ('&WK2' EQ '4').END0020                         @V6DJ1G1 16450000
         MNOTE 8,'ANSLEN= LENGTH (2ND SUB PARM) MUST BE 2 OR 4'         16500000
&IUCVERR SETA  1                                               @V6DJ1G1 16550000
.END0020 ANOP                                                           16600000
.*                                                                      16650000
.*--------------------------------------------------------------------- 16700000
.*       VALIDATE THE BUFFER PARAMETER                                  16750000
.*--------------------------------------------------------------------- 16800000
.*                                                                      16850000
         AIF   (T'&BUFFER EQ 'O').END0021                               16900000
         AIF   ('&MAP'(6,1) NE '0').END0021                             16950000
         MNOTE 8,'BUFFER= IS NOT ALLOWED ON THE &FCN FUNCTION'          17000000
&IUCVERR SETA  1                                                        17050000
.END0021 ANOP                                                           17100000
.*                                                                      17150000
.*--------------------------------------------------------------------- 17200000
.*       VALIDATE THE BUFFER LENGTH PARAMETER                           17250000
.*--------------------------------------------------------------------- 17300000
.*                                                                      17350000
         AIF   (T'&BUFLEN EQ 'O').END0022                               17400000
         AIF   ('&MAP'(7,1) NE '0').CHK0022                    @V6DJ1G1 17450000
         MNOTE 8,'BUFLEN= IS NOT ALLOWED ON THE &FCN FUNCTION'          17500000
&IUCVERR SETA  1                                                        17550000
         AGO   .END0022                                                 17600000
.CHK0022 ANOP                                                  @V6DJ1G1 17650000
         AIF   (N'&BUFLEN EQ 1).END0022                        @V6DJ1G1 17700000
         AIF   (N'&BUFLEN EQ 2).CK20022                        @V6DJ1G1 17750000
         MNOTE 8,'BUFLEN= MUST BE ONE OR TWO SUB PARMS'                 17800000
.*                                                             @V6DJ1G1 17850000
&IUCVERR SETA  1                                               @V6DJ1G1 17900000
         AGO   .END0022                                        @V6DJ1G1 17950000
.CK20022 ANOP                                                  @V6DJ1G1 18000000
&WK2     SETC  '&BUFLEN(2)'                                    @V6DJ1G1 18050000
         AIF   ('&WK2' EQ '2').END0022                         @V6DJ1G1 18100000
         AIF   ('&WK2' EQ '4').END0022                         @V6DJ1G1 18150000
         MNOTE 8,'BUFLEN= LENGTH (2ND SUB PARM) MUST BE 2 OR 4'         18200000
&IUCVERR SETA  1                                                        18250000
.END0022 ANOP                                                           18300000
.*                                                                      18350000
.*--------------------------------------------------------------------- 18400000
.*       VALIDATE THE LINKAGE OPTION                                    18450000
.*--------------------------------------------------------------------- 18500000
.*                                                                      18550000
         AIF   (T'&CP EQ 'O').END0023                                   18600000
         AIF   ('&MAP'(8,1) NE '0').CHK0023                             18650000
         MNOTE 8,'CP= IS NOT ALLOWED ON THE &FCN FUNCTION'              18700000
&IUCVERR SETA  1                                                        18750000
         AGO   .END0023                                                 18800000
.CHK0023 ANOP                                                           18850000
         AIF   ('&CP' EQ 'YES').END0023                                 18900000
         AIF   ('&CP' EQ 'NO').END0023                                  18950000
         MNOTE 8,'CP=&CP INVALID'                                       19000000
&IUCVERR SETA  1                                                        19050000
.END0023 ANOP                                                           19100000
.*                                                                      19150000
.*--------------------------------------------------------------------- 19200000
.*       VALIDATE THE CP SYSTEM SERVICE CODE                            19250000
.*--------------------------------------------------------------------- 19300000
.*                                                                      19350000
         AIF   (T'&FCNCD EQ 'O').END0024                                19400000
         AIF   ('&MAP'(9,1) NE '0').END0024                             19450000
         MNOTE 8,'FCNCD= IS NOT ALLOWED ON THE &FCN FUNCTION'           19500000
&IUCVERR SETA  1                                                        19550000
.END0024 ANOP                                                           19600000
.*                                                                      19650000
.*--------------------------------------------------------------------- 19700000
.*       VALIDATE THE ENABLE MASK                                       19750000
.*--------------------------------------------------------------------- 19800000
.*                                                                      19850000
         AIF   (T'&MASK EQ 'O').END0025                                 19900000
         AIF   ('&MAP'(10,1) NE '0').END0025                            19950000
         MNOTE 8,'MASK= IS NOT ALLOWED ON THE &FCN FUNCTION'            20000000
&IUCVERR SETA  1                                                        20050000
.END0025 ANOP                                                           20100000
.*                                                                      20150000
.*--------------------------------------------------------------------- 20200000
.*       VALIDATE THE MESSAGE ID PARAMETER                              20250000
.*--------------------------------------------------------------------- 20300000
.*                                                                      20350000
         AIF   (T'&MSGID EQ 'O').END0026                                20400000
         AIF   ('&MAP'(11,1) NE '0').END0026                            20450000
         MNOTE 8,'MSGID= IS NOT ALLOWED ON THE &FCN FUNCTION'           20500000
&IUCVERR SETA  1                                                        20550000
.END0026 ANOP                                                           20600000
.*                                                                      20650000
.*--------------------------------------------------------------------- 20700000
.*       VALIDATE THE MESSAGE LIMIT PARAMETER                           20750000
.*--------------------------------------------------------------------- 20800000
.*                                                                      20850000
         AIF   (T'&MSGLIM EQ 'O').END0027                               20900000
         AIF   ('&MAP'(12,1) NE '0').END0027                            20950000
         MNOTE 8,'MSGLIM= IS NOT ALLOWED ON THE &FCN FUNCTION'          21000000
&IUCVERR SETA  1                                                        21050000
.END0027 ANOP                                                           21100000
.*                                                                      21150000
.*--------------------------------------------------------------------- 21200000
.*       VALIDATE THE MESSAGE TAG PARAMETER                             21250000
.*--------------------------------------------------------------------- 21300000
.*                                                                      21350000
         AIF   (T'&MSGTAG EQ 'O').END0028                               21400000
         AIF   ('&MAP'(13,1) NE '0').END0028                            21450000
         MNOTE 8,'MSGTAG= IS NOT ALLOWED ON THE &FCN FUNCTION'          21500000
&IUCVERR SETA  1                                                        21550000
.END0028 ANOP                                                           21600000
         AIF   (T'&PATHID EQ 'O').END0029                               21650000
         AIF   ('&MAP'(14,1) NE '0').END0029                            21700000
         MNOTE 8,'PATHID= IS NOT ALLOWED ON THE &FCN FUNCTION'          21750000
&IUCVERR SETA  1                                                        21800000
.END0029 ANOP                                                           21850000
.*                                                                      21900000
.*--------------------------------------------------------------------- 21950000
.*       VALIDATE THE PARAMETER LIST PARAMETER                          22000000
.*--------------------------------------------------------------------- 22050000
.*                                                                      22100000
         AIF   (T'&PRMLIST EQ 'O').OMT0030                              22150000
         AIF   ('&MAP'(15,1) NE '0').END0030                            22200000
         MNOTE 8,'PRMLIST= IS NOT ALLOWED ON THE &FCN FUNCTION'         22250000
&IUCVERR SETA  1                                                        22300000
         AGO   .END0030                                                 22350000
.OMT0030 AIF   ('&MAP'(15,1) NE '1').END0030                            22400000
         MNOTE 8,'PRMLIST= IS REQUIRED'                                 22450000
&IUCVERR SETA  1                                                        22500000
.END0030 ANOP                                                           22550000
.*                                                                      22600000
.*--------------------------------------------------------------------- 22650000
.*       VALIDATE THE PRIORITY OPTION                                   22700000
.*--------------------------------------------------------------------- 22750000
.*                                                                      22800000
         AIF   (T'&PRTY EQ 'O').END0031                                 22850000
         AIF   ('&MAP'(16,1) NE '0').CHK0031                            22900000
         MNOTE 8,'PRTY= IS NOT ALLOWED ON THE &FCN FUNCTION'            22950000
&IUCVERR SETA  1                                                        23000000
         AGO   .END0031                                                 23050000
.CHK0031 ANOP                                                           23100000
         AIF   ('&PRTY' EQ 'YES').END0031                               23150000
         AIF   ('&PRTY' EQ 'NO').END0031                                23200000
         MNOTE 8,'PRTY=&PRTY INVALID'                                   23250000
&IUCVERR SETA  1                                                        23300000
.END0031 ANOP                                                           23350000
.*                                                                      23400000
.*--------------------------------------------------------------------- 23450000
.*       VALIDATE THE QUIESCE OPTION                                    23500000
.*--------------------------------------------------------------------- 23550000
.*                                                                      23600000
         AIF   (T'&QUIESCE EQ 'O').END0032                              23650000
         AIF   ('&MAP'(17,1) NE '0').CHK0032                            23700000
         MNOTE 8,'QUIESCE= IS NOT ALLOWED ON THE &FCN FUNCTION'         23750000
&IUCVERR SETA  1                                                        23800000
         AGO   .END0032                                                 23850000
.CHK0032 ANOP                                                           23900000
         AIF   ('&QUIESCE' EQ 'YES').END0032                            23950000
         AIF   ('&QUIESCE' EQ 'NO').END0032                             24000000
         MNOTE 8,'QUIESCE=&QUIESCE INVALID'                             24050000
&IUCVERR SETA  1                                                        24100000
.END0032 ANOP                                                           24150000
.*                                                                      24200000
.*--------------------------------------------------------------------- 24250000
.*       VALIDATE THE SOURCE CLASS PARAMETER                            24300000
.*--------------------------------------------------------------------- 24350000
.*                                                                      24400000
         AIF   (T'&SRCCLS EQ 'O').END0033                               24450000
         AIF   ('&MAP'(18,1) NE '0').END0033                            24500000
         MNOTE 8,'SRCCLS= IS NOT ALLOWED ON THE &FCN FUNCTION'          24550000
&IUCVERR SETA  1                                                        24600000
.END0033 ANOP                                                           24650000
.*                                                                      24700000
.*--------------------------------------------------------------------- 24750000
.*       VALIDATE THE TARGET CLASS PARAMETER                            24800000
.*--------------------------------------------------------------------- 24850000
.*                                                                      24900000
         AIF   (T'&TRGCLS EQ 'O').END0034                               24950000
         AIF   ('&MAP'(19,1) NE '0').END0034                            25000000
         MNOTE 8,'TRGCLS= IS NOT ALLOWED ON THE &FCN FUNCTION'          25050000
&IUCVERR SETA  1                                                        25100000
.END0034 ANOP                                                           25150000
.*                                                                      25200000
.*--------------------------------------------------------------------- 25250000
.*       VALIDATE THE ONE-WAY MESSAGE OPTION                            25300000
.*--------------------------------------------------------------------- 25350000
.*                                                                      25400000
         AIF   (T'&TYPE EQ 'O').END0035                                 25450000
         AIF   ('&MAP'(20,1) NE '0').CHK0035                            25500000
         MNOTE 8,'TYPE= IS NOT ALLOWED ON THE &FCN FUNCTION'            25550000
&IUCVERR SETA  1                                                        25600000
         AGO   .END0035                                                 25650000
.CHK0035 ANOP                                                           25700000
         AIF   ('&TYPE' EQ '1WAY').END0035                              25750000
         AIF   ('&TYPE' EQ '2WAY').END0035                              25800000
         MNOTE 8,'TYPE=&TYPE INVALID'                                   25850000
&IUCVERR SETA  1                                                        25900000
.END0035 ANOP                                                           25950000
.*                                                                      26000000
.*--------------------------------------------------------------------- 26050000
.*       VALIDATE THE USER DATA PARAMETER                               26100000
.*--------------------------------------------------------------------- 26150000
.*                                                                      26200000
         AIF   (T'&USERDTA EQ 'O').END0036                              26250000
         AIF   ('&MAP'(21,1) NE '0').END0036                            26300000
         MNOTE 8,'USERDTA= IS NOT ALLOWED ON THE &FCN FUNCTION'         26350000
&IUCVERR SETA  1                                                        26400000
.END0036 ANOP                                                           26450000
.*                                                                      26500000
.*--------------------------------------------------------------------- 26550000
.*       VALIDATE THE USER ID PARAMETER                                 26600000
.*--------------------------------------------------------------------- 26650000
.*                                                                      26700000
         AIF   (T'&USERID EQ 'O').END0037                               26750000
         AIF   ('&MAP'(22,1) NE '0').END0037                            26800000
         MNOTE 8,'USERID= IS NOT ALLOWED ON THE &FCN FUNCTION'          26850000
&IUCVERR SETA  1                                                        26900000
.END0037 ANOP                                                           26950000
.*                                                                      27000000
.*--------------------------------------------------------------------- 27050000
.*       VALIDATE THE VMBLOK OPTION                                     27100000
.*--------------------------------------------------------------------- 27150000
.*                                                                      27200000
         AIF   (T'&VMBLOK EQ 'O').END0038                               27250000
         AIF   ('&MAP'(23,1) NE '0').CHK0038                            27300000
         MNOTE 8,'VMBLOK= IS NOT ALLOWED ON THE &FCN FUNCTION'          27350000
&IUCVERR SETA  1                                                        27400000
         AGO   .END0038                                                 27450000
.CHK0038 ANOP                                                           27500000
         AIF   ('&VMBLOK' EQ 'SYSTEM').END0038                          27550000
         AIF   ('&VMBLOK' EQ 'USER').END0038                            27600000
         MNOTE 8,'VMBLOK=&VMBLOK INVALID'                               27650000
&IUCVERR SETA  1                                                        27700000
.END0038 ANOP                                                           27750000
.*                                                                      27800000
.*--------------------------------------------------------------------- 27850000
.*       VALIDATE THE MACRO FORM OPTION                                 27900000
.*--------------------------------------------------------------------- 27950000
.*                                                                      28000000
         AIF   (T'&MF EQ 'O').END038A                          @V6K00L5 28050000
         AIF   ('&MAP'(24,1) NE '0').CHK038A                   @V6GN6KD 28100000
         MNOTE 8,'MF= IS NOT ALLOWED ON THE &FCN FUNCTION'              28150000
.*                                                             @V6GN6KD 28200000
&IUCVERR SETA  1                                               @V6GN6KD 28250000
         AGO   .END038A                                        @V6GN6KD 28300000
.CHK038A ANOP                                                  @V6GN6KD 28350000
         AIF   ('&MF' EQ 'L').END038A                          @V6GN6KD 28400000
         MNOTE 8,'MF=&MF INVALID'                                       28450000
.*                                                             @V6GN6KD 28500000
&IUCVERR SETA  1                                               @V6GN6KD 28550000
.END038A ANOP                                                  @V6GN6KD 28600000
.*                                                                      28650000
.*--------------------------------------------------------------------- 28700000
.*       VALIDATE THE PARAMETER LIST DATA OPTION                        28750000
.*--------------------------------------------------------------------- 28800000
.*                                                                      28850000
         AIF   (T'&PRMDATA EQ 'O').END039A                     @V6K00L5 28900000
         AIF   ('&MAP'(25,1) NE '0').CHK039A                   @V6GN6KD 28950000
         MNOTE 8,'PRMDATA= IS NOT ALLOWED ON THE &FCN FUNCTION'         29000000
.*                                                             @V6GN6KD 29050000
&IUCVERR SETA  1                                               @V6GN6KD 29100000
         AGO   .END039A                                        @V6GN6KD 29150000
.CHK039A ANOP                                                  @V6GN6KD 29200000
         AIF   ('&PRMDATA' EQ 'YES').END039A                   @V6GN6KD 29250000
         AIF   ('&PRMDATA' EQ 'NO').END039A                    @V6GN6KD 29300000
         MNOTE 8,'PRMDATA=&PRMDATA INVALID'                             29350000
.*                                                             @V6GN6KD 29400000
&IUCVERR SETA  1                                               @V6GN6KD 29450000
.END039A ANOP                                                  @V6GN6KD 29500000
.*                                                                      29550000
.*--------------------------------------------------------------------- 29600000
.*       VALIDATE THE DATA TYPE OPTION                                  29650000
.*--------------------------------------------------------------------- 29700000
.*                                                                      29750000
         AIF   (T'&DATA EQ 'O').END040A                        @V6K00L5 29800000
         AIF   ('&MAP'(26,1) NE '0').CHK040A                   @V6GN6KD 29850000
         MNOTE 8,'DATA= IS NOT ALLOWED ON THE &FCN FUNCTION'            29900000
.*                                                             @V6GN6KD 29950000
&IUCVERR SETA  1                                               @V6GN6KD 30000000
         AGO   .END040A                                        @V6GN6KD 30050000
.CHK040A ANOP                                                  @V6GN6KD 30100000
         AIF   ('&DATA' EQ 'BUFFER').END040A                   @V6GN6KD 30150000
         AIF   ('&DATA' EQ 'PRMMSG').END040A                   @V6GN6KD 30200000
         MNOTE 8,'DATA= &DATA INVALID'                                  30250000
.*                                                             @V6GN6KD 30300000
&IUCVERR SETA  1                                               @V6GN6KD 30350000
.END040A ANOP                                                  @V6GN6KD 30400000
.*                                                                      30450000
.*--------------------------------------------------------------------- 30500000
.*       VALIDATE THE PARAMETER LIST MESSAGE PARAMETER                  30550000
.*--------------------------------------------------------------------- 30600000
.*                                                                      30650000
         AIF   (T'&PRMMSG EQ 'O').END041A                      @V6K00L5 30700000
         AIF   ('&MAP'(27,1) NE '0').END041A                   @V6GN6KD 30750000
         MNOTE 8,'PRMMSG= IS NOT ALLOWED ON THE &FCN FUNCTION'          30800000
.*                                                             @V6GN6KD 30850000
&IUCVERR SETA  1                                               @V6GN6KD 30900000
.END041A ANOP                                                  @V6GN6KD 30950000
.*                                                                      31000000
.*--------------------------------------------------------------------- 31050000
.*       VALIDATE THE BUFFER LIST OPTION                                31100000
.*--------------------------------------------------------------------- 31150000
.*                                                                      31200000
         AIF   (T'&BUFLIST EQ 'O').END042B                     @V6KR3L5 31250000
         AIF   ('&MAP'(28,1) NE '0').CHK042B                   @V6KR3L5 31300000
         MNOTE 8,'BUFLIST= IS NOT ALLOWED ON THE &FCN FUNCTION'         31350000
.*                                                             @V6KR3L5 31400000
&IUCVERR SETA  1                                               @V6KR3L5 31450000
         AGO   .END042B                                        @V6KR3L5 31500000
.CHK042B ANOP                                                  @V6KR3L5 31550000
         AIF   ('&BUFLIST' EQ 'YES').END042B                   @V6KR3L5 31600000
         AIF   ('&BUFLIST' EQ 'NO').END042B                    @V6KR3L5 31650000
         MNOTE 8,'BUFLIST=&BUFLIST INVALID'                             31700000
.*                                                             @V6KR3L5 31750000
&IUCVERR SETA  1                                               @V6KR3L5 31800000
.END042B ANOP                                                  @V6KR3L5 31850000
.*                                                                      31900000
.*--------------------------------------------------------------------- 31950000
.*       VALIDATE THE ANSWER LIST OPTION                                32000000
.*--------------------------------------------------------------------- 32050000
.*                                                                      32100000
         AIF   (T'&ANSLIST EQ 'O').END043B                     @V6KR3L5 32150000
         AIF   ('&MAP'(29,1) NE '0').CHK043B                   @V6M00L5 32200000
         MNOTE 8,'ANSLIST= IS NOT ALLOWED ON THE &FCN FUNCTION'         32250000
.*                                                             @V6KR3L5 32300000
&IUCVERR SETA  1                                               @V6KR3L5 32350000
         AGO   .END043B                                        @V6KR3L5 32400000
.CHK043B ANOP                                                  @V6KR3L5 32450000
         AIF   ('&ANSLIST' EQ 'YES').END043B                   @V6KR3L5 32500000
         AIF   ('&ANSLIST' EQ 'NO').END043B                    @V6KR3L5 32550000
         MNOTE 8,'ANSLIST=&ANSLIST INVALID'                             32600000
.*                                                             @V6KR3L5 32650000
&IUCVERR SETA  1                                               @V6KR3L5 32700000
.END043B ANOP                                                  @V6KR3L5 32750000
.*                                                                      32800000
.*--------------------------------------------------------------------- 32850000
.*       VALIDATE THE CONTROL OPTION                                    32900000
.*--------------------------------------------------------------------- 32950000
.*                                                                      33000000
         AIF   (T'&CONTROL EQ 'O').END044                      @V6MU3ND 33050000
         AIF   ('&MAP'(30,1) NE '0').CHK044                    @V6MU3ND 33100000
         MNOTE 8,'CONTROL= IS NOT ALLOWED ON THE &FCN FUNCTION'         33150000
.*                                                             @V6MU3ND 33200000
&IUCVERR SETA  1                                               @V6MU3ND 33250000
         AGO   .END044                                         @V6MU3ND 33300000
.CHK044  ANOP                                                  @V6MU3ND 33350000
         AIF   ('&CONTROL' EQ 'YES').END044                    @V6MU3ND 33400000
         AIF   ('&CONTROL' EQ 'NO').END044                     @V6MU3ND 33450000
         MNOTE 8,'CONTROL=&CONTROL INVALID'                    @V6MU3ND 33500000
&IUCVERR SETA  1                                               @V6MU3ND 33550000
.END044  ANOP                                                  @V6MU3ND 33600000
.*                                                                      33650000
.*--------------------------------------------------------------------- 33700000
.*       VALIDATE THE COMSRV OPTION                                     33750000
.*--------------------------------------------------------------------- 33800000
.*                                                                      33850000
         AIF   (T'&COMSRV EQ 'O').END045                       @V6RCGLD 33900000
         AIF   ('&MAP'(31,1) NE '0').CHK045                    @V6RCGLD 33950000
         MNOTE 8,'COMSRV= IS NOT ALLOWED ON THE &FCN FUNCTION'          34000000
.*                                                             @V6RCGLD 34050000
&IUCVERR SETA  1                                               @V6RCGLD 34100000
         AGO   .END045                                         @V6RCGLD 34150000
.CHK045  ANOP                                                  @V6RCGLD 34200000
         AIF   ('&COMSRV' EQ 'YES').END045                     @V6RCGLD 34250000
         AIF   ('&COMSRV' EQ 'NO').END045                      @V6RCGLD 34300000
         MNOTE 8,'COMSRV=&COMSRV INVALID'                      @V6RCGLD 34350000
&IUCVERR SETA  1                                               @V6RCGLD 34400000
.END045  ANOP                                                  @V6RCGLD 34450000
.*                                                                      34500000
.*--------------------------------------------------------------------- 34550000
.*       VALIDATE THE LOGDATA OPTION                                    34600000
.*--------------------------------------------------------------------- 34650000
.*                                                                      34700000
         AIF   (T'&LOGDATA EQ 'O').END046                      @V6RCGGS 34750000
         AIF   ('&MAP'(32,1) NE '0').CHK046                    @V6RCGGS 34800000
         MNOTE 8,'LOGDATA= IS NOT ALLOWED ON THE &FCN FUNCTION'         34850000
.*                                                             @V6RCGGS 34900000
&IUCVERR SETA  1                                               @V6RCGGS 34950000
         AGO   .END046                                         @V6RCGGS 35000000
.CHK046  ANOP                                                  @V6RCGGS 35050000
         AIF   ('&LOGDATA' EQ 'YES').END046                    @V6RCGGS 35100000
         AIF   ('&LOGDATA' EQ 'NO').END046                     @V6RCGGS 35150000
         MNOTE 8,'LOGDATA=&LOGDATA INVALID'                    @V6RCGGS 35200000
&IUCVERR SETA  1                                               @V6RCGGS 35250000
.END046  ANOP                                                  @V6RCGGS 35300000
.*                                                                      35350000
.*--------------------------------------------------------------------- 35400000
.*       VALIDATE THE USAGE OF THE PARAMETER LIST DATA OPTION           35450000
.*--------------------------------------------------------------------- 35500000
.*                                                                      35550000
         AIF   ('&FCN' EQ 'SEND').CKTEST                       @V6GN6KD 35600000
         AIF   ('&FCN' EQ 'REPLY').CKTEST1                     @V6GN6KD 35650000
         AGO   .END042A                                        @V6GN6KD 35700000
.CKTEST  ANOP                                                  @V6GN6KD 35750000
         AIF   ('&DATA' EQ 'PRMMSG').CKBUF                     @V6GN6KD 35800000
         AIF   ('&DATA' EQ 'BUFFER').CKPRM                     @V6GN6KD 35850000
         AGO   .END042A                                        @V6GN6KD 35900000
.CKTEST1 ANOP                                                  @V6GN6KD 35950000
         AIF   ('&DATA' EQ 'PRMMSG').CKANS                     @V6GN6KD 36000000
         AIF   ('&DATA' EQ 'BUFFER').CKPRM                     @V6GN6KD 36050000
         AGO   .END042A                                        @V6GN6KD 36100000
.CKBUF   ANOP                                                  @V6GN6KD 36150000
         AIF   (T'&BUFFER EQ 'O').CKLEN                        @V6GN6KD 36200000
         MNOTE 8,'DATA=PRMMSG INVALID WITH BUFFER='                     36250000
.*                                                             @V6GN6KD 36300000
&IUCVERR SETA  1                                               @V6GN6KD 36350000
.CKLEN   ANOP                                                  @V6GN6KD 36400000
         AIF   (T'&BUFLEN EQ 'O').END042A                      @V6GN6KD 36450000
         MNOTE 8,'DATA=PRMMSG INVALID WITH BUFLEN='                     36500000
.*                                                             @V6GN6KD 36550000
&IUCVERR SETA  1                                               @V6GN6KD 36600000
         AGO   .END042A                                        @V6GN6KD 36650000
.CKANS   ANOP                                                  @V6GN6KD 36700000
         AIF   (T'&ANSBUF EQ 'O').CKALEN                       @V6GN6KD 36750000
         MNOTE 8,'DATA=PRMMSG INVALID WITH ANSBUF='                     36800000
.*                                                             @V6GN6KD 36850000
&IUCVERR SETA  1                                               @V6GN6KD 36900000
.CKALEN  ANOP                                                  @V6GN6KD 36950000
         AIF   (T'&ANSLEN EQ 'O').END042A                      @V6GN6KD 37000000
         MNOTE 8,'DATA=PRMMSG INVALID WITH ANSLEN='                     37050000
.*                                                             @V6GN6KD 37100000
&IUCVERR SETA  1                                               @V6GN6KD 37150000
         AGO   .END042A                                        @V6GN6KD 37200000
.CKPRM   ANOP                                                  @V6GN6KD 37250000
         AIF   (T'&PRMMSG EQ 'O').END042A                      @V6GN6KD 37300000
         MNOTE 8,'DATA=BUFFER INVALID WITH PRMMSG='                     37350000
.*                                                             @V6GN6KD 37400000
&IUCVERR SETA  1                                               @V6GN6KD 37450000
.END042A ANOP                                                  @V6GN6KD 37500000
         AIF   ('&FCN' EQ 'SEND').TSTBUF                       @V6GN6KD 37550000
         AIF   ('&FCN' EQ 'REPLY').TSTANS                      @V6GN6KD 37600000
         AGO   .END043A                                        @V6GN6KD 37650000
.TSTBUF  ANOP                                                  @V6GN6KD 37700000
         AIF   (T'&PRMMSG EQ 'O').END043A                      @V6GN6KD 37750000
         AIF   (T'&BUFFER NE 'O').ERBUF                        @V6GN6KD 37800000
         AIF   (T'&BUFLEN NE 'O').ERLEN                        @V6GN6KD 37850000
         AIF   (T'&ANSBUF NE 'O').END043A                      @V6GN6KD 37900000
         AIF   (T'&ANSLEN NE 'O').END043A                      @V6GN6KD 37950000
         AGO   .END043A                                        @V6GN6KD 38000000
.TSTANS  ANOP                                                  @V6GN6KD 38050000
         AIF   (T'&PRMMSG EQ 'O').END043A                      @V6GN6KD 38100000
         AIF   (T'&ANSBUF NE 'O').ERABUF                       @V6GN6KD 38150000
         AIF   (T'&ANSLEN NE 'O').ERALEN                       @V6GN6KD 38200000
         AGO   .END043A                                        @V6GN6KD 38250000
.ERBUF   ANOP                                                  @V6GN6KD 38300000
         MNOTE 8,'PRMMSG= INVALID WITH BUFFER='                         38350000
.*                                                             @V6GN6KD 38400000
&IUCVERR SETA  1                                               @V6GN6KD 38450000
         AIF   (T'&BUFLEN EQ 'O').END043A                      @V6GN6KD 38500000
.ERLEN   ANOP                                                  @V6GN6KD 38550000
         MNOTE 8,'PRMMSG= INVALID WITH BUFLEN='                         38600000
.*                                                             @V6GN6KD 38650000
&IUCVERR SETA  1                                               @V6GN6KD 38700000
         AGO   .END043A                                        @V6GN6KD 38750000
.ERABUF  ANOP                                                  @V6GN6KD 38800000
         MNOTE 8,'PRMMSG= INVALID WITH ANSBUF='                         38850000
.*                                                             @V6GN6KD 38900000
&IUCVERR SETA  1                                               @V6GN6KD 38950000
         AIF   (T'&ANSLEN EQ 'O').END043A                      @V6GN6KD 39000000
.ERALEN  ANOP                                                  @V6GN6KD 39050000
         MNOTE 8,'PRMMSG= INVALID WITH ANSLEN='                         39100000
.*                                                             @V6GN6KD 39150000
&IUCVERR SETA  1                                               @V6GN6KD 39200000
.END043A ANOP                                                  @V6GN6KD 39250000
.*                                                                      39300000
.*--------------------------------------------------------------------- 39350000
.*       VALIDATE THE USAGE OF THE ONE-WAY MESSAGE OPTION               39400000
.*--------------------------------------------------------------------- 39450000
.*                                                                      39500000
         AIF   ('&FCN' NE 'SEND').NSEND                                 39550000
         AIF   ('&TYPE' NE '1WAY').NSEND                                39600000
         AIF   (T'&ANSBUF EQ 'O').ABFOK                                 39650000
         MNOTE 8,'ANSBUF= INVALID WITH TYPE=1WAY'                       39700000
&IUCVERR SETA  1                                                        39750000
.ABFOK   ANOP                                                           39800000
         AIF   (T'&ANSLEN EQ 'O').ABLENOK                      @V6KR3L5 39850000
         MNOTE 8,'ANSLEN= INVALID WITH TYPE=1WAY'                       39900000
&IUCVERR SETA  1                                                        39950000
.ABLENOK ANOP                                                           40000000
         AIF   ('&ANSLIST' NE 'YES').NSEND                     @V6KR3L5 40050000
         MNOTE 8,'ANSLIST=YES INVALID WITH TYPE=1WAY'                   40100000
.*                                                             @V6KR3L5 40150000
&IUCVERR SETA  1                                               @V6KR3L5 40200000
.NSEND   ANOP                                                           40250000
.*                                                                      40300000
.*--------------------------------------------------------------------- 40350000
.*       VALIDATE THE USAGE OF THE ALL OPTION                           40400000
.*--------------------------------------------------------------------- 40450000
.*                                                                      40500000
         AIF   ('&FCN' EQ 'QUIESCE').CKALL                              40550000
         AIF   ('&FCN' EQ 'RESUME').CKALL                               40600000
         AIF   ('&FCN' EQ 'SEVER').CKALL                                40650000
         AGO   .NALL                                                    40700000
.CKALL   ANOP                                                           40750000
         AIF   ('&ALL' NE 'YES').NALL                                   40800000
         AIF   (T'&PATHID EQ 'O').NALL                                  40850000
         MNOTE 8,'PATHID= INVALID WITH ALL=YES'                         40900000
&IUCVERR SETA  1                                                        40950000
.NALL    ANOP                                                           41000000
.*                                                                      41050000
.*--------------------------------------------------------------------- 41100000
.*       VALIDATE THE USAGE OF THE LINKAGE OPTION                       41150000
.*--------------------------------------------------------------------- 41200000
.*                                                                      41250000
         AIF   ('&CP' EQ 'NO').NCP                                      41300000
         AIF   (T'&CP EQ 'O').NCP                                       41350000
         AIF   ('&FCN' EQ 'SETMASK').BADFCN                             41400000
         AIF   ('&FCN' EQ 'SETCMASK').BADFCN                   @V6GN6KD 41450000
         AIF   ('&FCN' EQ 'TESTMSG').BADFCN                             41500000
         AIF   ('&FCN' EQ 'QUERY').BADFCN                               41550000
         AGO   .CPMORE                                                  41600000
.BADFCN  ANOP                                                           41650000
         MNOTE 8,'&FCN INVALID WITH CP=YES'                             41700000
&IUCVERR SETA  1                                                        41750000
.CPMORE  ANOP                                                           41800000
         AIF   (T'&MSGTAG EQ 'O').ENDCP                                 41850000
         MNOTE 8,'MSGTAG= INVALID WITH CP=YES'                          41900000
.*                                                             @V6K00G1 41950000
&IUCVERR SETA  1                                                        42000000
         AGO   .ENDCP                                                   42050000
.NCP     ANOP                                                           42100000
.*                                                                      42150000
.*--------------------------------------------------------------------- 42200000
.*       VALIDATE THE USAGE OF THE VMBLOK OPTION                        42250000
.*--------------------------------------------------------------------- 42300000
.*                                                                      42350000
         AIF   (T'&VMBLOK EQ 'O').NOVMB                                 42400000
         MNOTE 8,'VMBLOK= VALID ONLY WITH CP=YES'                       42450000
.*                                                             @V6K00G1 42500000
&IUCVERR SETA  1                                                        42550000
.NOVMB   ANOP                                                           42600000
.*                                                                      42650000
.*--------------------------------------------------------------------- 42700000
.*       VALIDATE THE USAGE OF THE CP SYSTEM SERVICE CODE               42750000
.*--------------------------------------------------------------------- 42800000
.*                                                                      42850000
         AIF   (T'&FCNCD EQ 'O').NFCNCD                                 42900000
         AIF   ('&CP' EQ 'YES').NFCNCD                                  42950000
         MNOTE 8,'FCNCD= VALID ONLY WITH CP=YES'                        43000000
.*                                                             @V6K00G1 43050000
&IUCVERR SETA  1                                                        43100000
.NFCNCD  ANOP                                                           43150000
.ENDCP   ANOP                                                           43200000
.*                                                                      43250000
.*--------------------------------------------------------------------- 43300000
.*       VALIDATE THE USAGE OF THE BUFFER LIST OPTION                   43350000
.*--------------------------------------------------------------------- 43400000
.*                                                                      43450000
         AIF   ('&FCN' NE 'SEND').NBLIST                       @V6KR3L5 43500000
         AIF   ('&BUFLIST' NE 'YES').NBLIST                    @V6KR3L5 43550000
         AIF   ('&DATA' NE 'PRMMSG').CKPRMSG                   @V6KR3L5 43600000
         MNOTE 8,'DATA=PRMMSG INVALID WITH BUFLIST=YES'                 43650000
.*                                                             @V6KR3L5 43700000
&IUCVERR SETA  1                                               @V6KR3L5 43750000
.CKPRMSG ANOP                                                  @V6KR3L5 43800000
         AIF   (T'&PRMMSG EQ 'O').NBLIST                       @V6KR3L5 43850000
         MNOTE 8,'PRMMSG= INVALID WITH BUFLIST=YES'                     43900000
.*                                                             @V6KR3L5 43950000
&IUCVERR SETA  1                                               @V6KR3L5 44000000
.NBLIST  ANOP                                                  @V6KR3L5 44050000
.*                                                                      44100000
.*--------------------------------------------------------------------- 44150000
.*       VALIDATE THE USAGE OF THE ANSWER LIST OPTION                   44200000
.*--------------------------------------------------------------------- 44250000
.*                                                                      44300000
         AIF   ('&FCN' NE 'REPLY').NALIST                      @V6KR3L5 44350000
         AIF   ('&ANSLIST' NE 'YES').NALIST                    @V6KR3L5 44400000
         AIF   ('&DATA' NE 'PRMMSG').CPARMSG                   @V6KR3L5 44450000
         MNOTE 8,'DATA=PRMMSG INVALID WITH ANSLIST=YES'                 44500000
.*                                                             @V6KR3L5 44550000
&IUCVERR SETA  1                                               @V6KR3L5 44600000
.CPARMSG ANOP                                                  @V6KR3L5 44650000
         AIF   (T'&PRMMSG EQ 'O').NALIST                       @V6KR3L5 44700000
         MNOTE 8,'PRMMSG= INVALID WITH ANSLIST=YES'                     44750000
.*                                                             @V6KR3L5 44800000
&IUCVERR SETA  1                                               @V6KR3L5 44850000
.NALIST  ANOP                                                  @V6KR3L5 44900000
.*                                                                      44950000
.*--------------------------------------------------------------------- 45000000
.*       VALIDATE THE USAGE OF THE CONTROL OPTION                       45050000
.*--------------------------------------------------------------------- 45100000
.*                                                                      45150000
         AIF   ('&FCN' NE 'CONNECT').NCNTRL                    @V6MRFND 45200000
         AIF   ('&CONTROL' NE 'YES').NCNTRL                    @V6MU3ND 45250000
         AIF   ('&CP' NE 'YES').NCNTRL                         @V6MU3ND 45300000
         MNOTE 8,'CP=YES INVALID WITH CONTROL=YES'             @V6MU3ND 45350000
&IUCVERR SETA  1                                               @V6MU3ND 45400000
.NCNTRL  ANOP                                                  @V6MU3ND 45450000
.*                                                                      45500000
.*--------------------------------------------------------------------- 45550000
.*       VALIDATE THE USAGE OF THE COMSRV OPTION                        45600000
.*--------------------------------------------------------------------- 45650000
.*                                                                      45700000
         AIF   ('&FCN' NE 'ACCEPT').NCOMSRV                    @V6RCGLD 45750000
         AIF   ('&COMSRV' NE 'YES').NCOMSRV                    @V6RCGLD 45800000
         AIF   (T'&CP EQ 'O').COMS1                            @V6RCGLD 45850000
         AIF   ('&CP' EQ 'NO').COMS1                           @V6RCGLD 45900000
         MNOTE 8,'CP=YES INVALID WITH COMSRV=YES'                       45950000
.*                                                             @V6RCGLD 46000000
&IUCVERR SETA  1                                               @V6RCGLD 46050000
.COMS1   ANOP                                                  @V6RCGLD 46100000
         AIF   (T'&MSGLIM EQ 'O').COMS2                        @V6RCGLD 46150000
         MNOTE 8,'MSGLIM= INVALID WITH COMSRV=YES'                      46200000
.*                                                             @V6RCGLD 46250000
&IUCVERR SETA  1                                               @V6RCGLD 46300000
.COMS2   ANOP                                                  @V6RCGLD 46350000
         AIF   (T'&PRTY EQ 'O').COMS3                          @V6RCGLD 46400000
         MNOTE 8,'PRTY= INVALID WITH COMSRV=YES'                        46450000
.*                                                             @V6RCGLD 46500000
&IUCVERR SETA  1                                               @V6RCGLD 46550000
.COMS3   ANOP                                                  @V6RCGLD 46600000
         AIF   (T'&PRMDATA EQ 'O').COMS4                       @V6RCGLD 46650000
         MNOTE 8,'PRMDATA= INVALID WITH COMSRV=YES'                     46700000
.*                                                             @V6RCGLD 46750000
&IUCVERR SETA  1                                               @V6RCGLD 46800000
.COMS4   ANOP                                                  @V6RCGLD 46850000
         AIF   (T'&QUIESCE EQ 'O').COMS5                       @V6RCGLD 46900000
         MNOTE 8,'QUIESCE= INVALID WITH COMSRV=YES'                     46950000
.*                                                             @V6RCGLD 47000000
&IUCVERR SETA  1                                               @V6RCGLD 47050000
.COMS5   ANOP                                                  @V6RCGLD 47100000
         AIF   (T'&USERDTA EQ 'O').NCOMSRV                     @V6RCGLD 47150000
         MNOTE 8,'USERDTA= INVALID WITH COMSRV=YES'                     47200000
.*                                                             @V6RCGLD 47250000
&IUCVERR SETA  1                                               @V6RCGLD 47300000
.NCOMSRV ANOP                                                  @V6RCGLD 47350000
.*                                                                      47400000
.*--------------------------------------------------------------------- 47450000
.*       VALIDATE THE USAGE OF THE LOGDATA OPTION                       47500000
.*--------------------------------------------------------------------- 47550000
.*                                                                      47600000
         AIF   ('&FCN' NE 'ACCEPT').NLOGDAT                    @V6RCGGS 47650000
         AIF   ('&LOGDATA' NE 'YES').NLOGDAT                   @V6RCGGS 47700000
         AIF   (T'&CP EQ 'O').LDAT1                            @V6RCGGS 47750000
         AIF   ('&CP' EQ 'NO').LDAT1                           @V6RCGGS 47800000
         MNOTE 8,'CP=YES INVALID WITH LOGDATA=YES'                      47850000
.*                                                             @V6RCGGS 47900000
&IUCVERR SETA  1                                               @V6RCGGS 47950000
.LDAT1   ANOP                                                  @V6RCGGS 48000000
         AIF   (T'&MSGLIM EQ 'O').LDAT2                        @V6RCGGS 48050000
         MNOTE 8,'MSGLIM= INVALID WITH LOGDATA=YES'                     48100000
.*                                                             @V6RCGGS 48150000
&IUCVERR SETA  1                                               @V6RCGGS 48200000
.LDAT2   ANOP                                                  @V6RCGGS 48250000
         AIF   (T'&PRTY EQ 'O').LDAT3                          @V6RCGGS 48300000
         MNOTE 8,'PRTY= INVALID WITH LOGDATA=YES'                       48350000
.*                                                             @V6RCGGS 48400000
&IUCVERR SETA  1                                               @V6RCGGS 48450000
.LDAT3   ANOP                                                  @V6RCGGS 48500000
         AIF   (T'&PRMDATA EQ 'O').LDAT4                       @V6RCGGS 48550000
         MNOTE 8,'PRMDATA= INVALID WITH LOGDATA=YES'                    48600000
.*                                                             @V6RCGGS 48650000
&IUCVERR SETA  1                                               @V6RCGGS 48700000
.LDAT4   ANOP                                                  @V6RCGGS 48750000
         AIF   (T'&QUIESCE EQ 'O').LDAT5                       @V6RCGGS 48800000
         MNOTE 8,'QUIESCE= INVALID WITH LOGDATA=YES'                    48850000
.*                                                             @V6RCGGS 48900000
&IUCVERR SETA  1                                               @V6RCGGS 48950000
.LDAT5   ANOP                                                  @V6RCGGS 49000000
         AIF   (T'&USERDTA EQ 'O').NLOGDAT                     @V6RCGGS 49050000
         MNOTE 8,'USERDTA= INVALID WITH LOGDATA=YES'                    49100000
.*                                                             @V6RCGGS 49150000
&IUCVERR SETA  1                                               @V6RCGGS 49200000
.NLOGDAT ANOP                                                  @V6RCGGS 49250000
.*                                                                      49300000
.*--------------------------------------------------------------------- 49350000
.*       IF INVALID OPTIONS WERE FOUND, THEN EXIT                       49400000
.*--------------------------------------------------------------------- 49450000
.*                                                                      49500000
         AIF   (&IUCVERR EQ 0).NOERRS                                   49550000
&IUCVERR SETA  0                                                        49600000
         MEXIT                                                          49650000
.NOERRS  ANOP                                                           49700000
         AIF   ('&LBL' EQ '').NOLBL                                     49750000
&LBL     DS    0H                                                       49800000
.NOLBL   ANOP                                                           49850000
.*                                                                      49900000
.*--------------------------------------------------------------------- 49950000
.*       WE NOW BEGIN TO SET UP THE FLAGS FOR IPFLAGS1 AND IPFLAGS2.    50000000
.*       THE FLAGS TO SET IN IPFLAGS1 AND IPFLAGS2 ARE CONTAINED IN     50050000
.*       &BITS AND &BITS2 RESPECTIVELY.  THE FLAGS TO RESET IN          50100000
.*       IPFLAGS1 AND IPFLAGS2 ARE CONTAINED IN &BITSF AND &BITS2F      50150000
.*       RESPECTIVELY.                                                  50200000
.*--------------------------------------------------------------------- 50250000
.*                                                                      50300000
.*                                                                      50350000
.*--------------------------------------------------------------------- 50400000
.*       SET THE OPTION FLAG FOR THE ALL OPTION                         50450000
.*--------------------------------------------------------------------- 50500000
.*                                                                      50550000
         AIF   ('&ALL' NE 'YES').OFF0039                                50600000
&BITS    SETC  'IPALL'                                                  50650000
&BITC    SETA  1                                                        50700000
         AGO   .END0039                                                 50750000
.OFF0039 ANOP                                                           50800000
         AIF   (T'&ALL EQ 'O').END0039                                  50850000
&BITSF   SETC  'IPALL'                                                  50900000
&BITD    SETA  1                                                        50950000
.END0039 ANOP                                                           51000000
.*                                                                      51050000
.*--------------------------------------------------------------------- 51100000
.*       GENERATE THE CODE FOR THE ANSWER BUFFER PARAMETER              51150000
.*--------------------------------------------------------------------- 51200000
.*                                                                      51250000
         AIF   (T'&ANSBUF EQ 'O').END0040                               51300000
         AIF   ('&ANSBUF'(1,1) EQ '(').REG0040                          51350000
         LA    0,&ANSBUF           GET ADDRESS OF AREA                  51400000
         ST    0,IPBFADR2          STORE IT IN THE PARM LIST            51450000
         AGO   .END0040                                                 51500000
.REG0040 ANOP                                                           51550000
         ST    &ANSBUF(1),IPBFADR2 STORE ADDRESS IN PARM LIST           51600000
.END0040 ANOP                                                           51650000
.*                                                                      51700000
.*--------------------------------------------------------------------- 51750000
.*       GENERATE THE CODE FOR THE ANSWER LENGTH PARAMETER              51800000
.*--------------------------------------------------------------------- 51850000
.*                                                                      51900000
         AIF   (T'&ANSLEN EQ 'O').END0041                               51950000
         AIF   (N'&ANSLEN EQ 2).TWO0041                        @V6DJ1G1 52000000
         XC    IPBFLN2F(2),IPBFLN2F CLEAR HIGH ORDER 2 BYTES            52050000
.*                                                             @V6DJ1G1 52100000
         AIF   ('&ANSLEN'(1,1) EQ '(').REG0041                          52150000
         MVC   IPBFLN2,&ANSLEN     ANSWER LENGTH TO PARMLIST            52200000
.*                                                             @V6DJ1G1 52250000
         AGO   .END0041                                                 52300000
.REG0041 ANOP                                                  @V6DJ1G1 52350000
         STH   &ANSLEN(1),IPBFLN2  ANSWER LENGTH TO PARMLIST            52400000
.*                                                             @V6DJ1G1 52450000
         AGO   .END0041                                        @V6DJ1G1 52500000
.TWO0041 ANOP                                                  @V6DJ1G1 52550000
&WK1     SETC  '&ANSLEN(1)'                                    @V6DJ1G1 52600000
&WK2     SETC  '&ANSLEN(2)'                                    @V6DJ1G1 52650000
         AIF   ('&WK2' EQ '2').TW20041                         @V6DJ1G1 52700000
         AIF   ('&WK1'(1,1) EQ '(').RG40041                    @V6DJ1G1 52750000
         MVC   IPBFLN2F,&WK1       ANSWER LENGTH TO PARMLIST            52800000
.*                                                             @V6DJ1G1 52850000
         AGO   .END0041                                        @V6DJ1G1 52900000
.RG40041 ANOP                                                  @V6DJ1G1 52950000
.*K1     SETC  '&WK1'(2,K'&WK1-2)                              @V6DJ1G1 53000000
&WK1     SETC  '&WK1'(2,K'&ANSLEN(1)-2)                        @D31BDUL 53050000
         ST    &WK1,IPBFLN2F       ANSWER LENGTH TO PARMLIST            53100000
.*                                                             @V6DJ1G1 53150000
         AGO   .END0041                                        @V6DJ1G1 53200000
.TW20041 ANOP                                                  @V6DJ1G1 53250000
         XC    IPBFLN2F(2),IPBFLN2F CLEAR HIGH ORDER 2 BYTES            53300000
.*                                                             @V6DJ1G1 53350000
         AIF   ('&WK1'(1,1) EQ '(').RG20041                    @V6DJ1G1 53400000
         MVC   IPBFLN2,&WK1        ANSWER LENGTH TO PARMLIST            53450000
.*                                                             @V6DJ1G1 53500000
         AGO   .END0041                                        @V6DJ1G1 53550000
.RG20041 ANOP                                                  @V6DJ1G1 53600000
.*K1     SETC  '&WK1'(2,K'&WK1-2)                              @V6DJ1G1 53650000
&WK1     SETC  '&WK1'(2,K'&ANSLEN(1)-2)                        @D31BDUL 53700000
         STH   &WK1,IPBFLN2        ANSWER LENGTH TO PARMLIST            53750000
.*                                                             @V6DJ1G1 53800000
.END0041 ANOP                                                           53850000
.*                                                                      53900000
.*--------------------------------------------------------------------- 53950000
.*       GENERATE THE CODE FOR THE BUFFER PARAMETER                     54000000
.*--------------------------------------------------------------------- 54050000
.*                                                                      54100000
         AIF   (T'&BUFFER EQ 'O').END0042                               54150000
         AIF   ('&BUFFER'(1,1) EQ '(').REG0042                          54200000
         LA    0,&BUFFER           GET ADDRESS OF BUFFER                54250000
         ST    0,IPBFADR1          BUFFER ADDRESS TO PARMLIST           54300000
         AGO   .END0042                                                 54350000
.REG0042 ANOP                                                           54400000
         ST    &BUFFER(1),IPBFADR1 BUFFER ADDRESS TO PARMLIST           54450000
.END0042 ANOP                                                           54500000
.*                                                                      54550000
.*--------------------------------------------------------------------- 54600000
.*       GENERATE THE CODE FOR THE BUFFER LENGTH PARAMETER              54650000
.*--------------------------------------------------------------------- 54700000
.*                                                                      54750000
         AIF   (T'&BUFLEN EQ 'O').END0043                               54800000
         AIF   (N'&BUFLEN EQ 2).TWO0043                        @V6DJ1G1 54850000
         XC    IPBFLN1F(2),IPBFLN1F CLEAR HIGH ORDER 2 BYTES            54900000
.*                                                             @V6DJ1G1 54950000
         AIF   ('&BUFLEN'(1,1) EQ '(').REG0043                          55000000
         MVC   IPBFLN1,&BUFLEN     BUFFER LENGTH TO PARMLIST            55050000
.*                                                             @V6DJ1G1 55100000
         AGO   .END0043                                                 55150000
.REG0043 ANOP                                                  @V6DJ1G1 55200000
         STH   &BUFLEN(1),IPBFLN1  BUFFER LENGTH TO PARMLIST            55250000
.*                                                             @V6DJ1G1 55300000
         AGO   .END0043                                        @V6DJ1G1 55350000
.TWO0043 ANOP                                                  @V6DJ1G1 55400000
&WK1     SETC  '&BUFLEN(1)'                                    @V6DJ1G1 55450000
&WK2     SETC  '&BUFLEN(2)'                                    @V6DJ1G1 55500000
         AIF   ('&WK2' EQ '2').TW20043                         @V6DJ1G1 55550000
         AIF   ('&WK1'(1,1) EQ '(').RG40043                    @V6DJ1G1 55600000
         MVC   IPBFLN1F,&WK1       BUFFER LENGTH TO PARMLIST            55650000
.*                                                             @V6DJ1G1 55700000
         AGO   .END0043                                        @V6DJ1G1 55750000
.RG40043 ANOP                                                  @V6DJ1G1 55800000
.*K1     SETC  '&WK1'(2,K'&WK1-2)                              @V6DJ1G1 55850000
&WK1     SETC  '&WK1'(2,K'&BUFLEN(1)-2)                        @D31BDUL 55900000
         ST    &WK1,IPBFLN1F       BUFFER LENGTH TO PARMLIST            55950000
.*                                                             @V6DJ1G1 56000000
         AGO   .END0043                                        @V6DJ1G1 56050000
.TW20043 ANOP                                                  @V6DJ1G1 56100000
         XC    IPBFLN1F(2),IPBFLN1F CLEAR HIGH ORDER 2 BYTES            56150000
.*                                                             @V6DJ1G1 56200000
         AIF   ('&WK1'(1,1) EQ '(').RG20043                    @V6DJ1G1 56250000
         MVC   IPBFLN1,&WK1        BUFFER LENGTH TO PARMLIST            56300000
.*                                                             @V6DJ1G1 56350000
         AGO   .END0043                                        @V6DJ1G1 56400000
.RG20043 ANOP                                                  @V6DJ1G1 56450000
.*K1     SETC  '&WK1'(2,K'&WK1-2)                              @V6DJ1G1 56500000
&WK1     SETC  '&WK1'(2,K'&BUFLEN(1)-2)                        @D31BDUL 56550000
         STH   &WK1,IPBFLN1        BUFFER LENGTH TO PARMLIST            56600000
.*                                                             @V6DJ1G1 56650000
.END0043 ANOP                                                           56700000
.*                                                                      56750000
.*--------------------------------------------------------------------- 56800000
.*       GENERATE THE CODE FOR THE CP SYSTEM SERVICE CODE               56850000
.*--------------------------------------------------------------------- 56900000
.*                                                                      56950000
         AIF   (T'&FCNCD EQ 'O').END0044                                57000000
         AIF   ('&FCNCD'(1,1) EQ '(').REG0044                           57050000
         MVI   IPFCNCD,&FCNCD      CP CODE TO PARMLIST                  57100000
.*                                                             @V6K00G1 57150000
         AGO   .END0044                                                 57200000
.REG0044 ANOP                                                           57250000
         STC   &FCNCD(1),IPFCNCD   CP CODE TO PARMLIST                  57300000
.*                                                             @V6K00G1 57350000
.END0044 ANOP                                                           57400000
.*                                                                      57450000
.*--------------------------------------------------------------------- 57500000
.*       GENERATE THE CODE FOR THE ENABLE MASK                          57550000
.*--------------------------------------------------------------------- 57600000
.*                                                                      57650000
         AIF   (T'&MASK EQ 'O').END0045                                 57700000
         AIF   ('&MASK'(1,1) EQ '(').REG0045                            57750000
         MVC   IPMASK(1),&MASK     MASK TO PARMLIST                     57800000
         AGO   .END0045                                                 57850000
.REG0045 STC   &MASK(1),IPMASK     MASK IN PARMLIST                     57900000
.END0045 ANOP                                                           57950000
.*                                                                      58000000
.*--------------------------------------------------------------------- 58050000
.*       GENERATE THE CODE FOR THE MESSAGE ID                           58100000
.*--------------------------------------------------------------------- 58150000
.*                                                                      58200000
         AIF   (T'&MSGID EQ 'O').END0046                                58250000
         AIF   ('&MSGID'(1,1) EQ '(').REG0046                           58300000
         MVC   IPMSGID(4),&MSGID   MESSAGE ID TO PARMLIST               58350000
         AGO   .CHK0046                                                 58400000
.REG0046 ST    &MSGID(1),IPMSGID   MESSAGE ID TO PARMLIST               58450000
.CHK0046 ANOP                                                           58500000
         AIF   ('&FCN' EQ 'TESTCMPL').FLG0046                           58550000
         AIF   ('&FCN' EQ 'REJECT').FLG0046                             58600000
         AIF   ('&FCN' EQ 'RECEIVE').FLG0046                            58650000
         AIF   ('&FCN' EQ 'PURGE').FLG0046                              58700000
         AGO   .END0046                                                 58750000
.FLG0046 ANOP                                                           58800000
         AIF   (&BITC NE 1).FST0046                                     58850000
&BITS    SETC  '&BITS'.'+'.'IPFGMID'                                    58900000
         AGO   .END0046                                                 58950000
.FST0046 ANOP                                                           59000000
&BITS    SETC  'IPFGMID'                                                59050000
.SET0046 ANOP                                                           59100000
&BITC    SETA 1                                                         59150000
.END0046 ANOP                                                           59200000
.*                                                                      59250000
.*--------------------------------------------------------------------- 59300000
.*       GENERATE THE CODE FOR THE MESSAGE LIMIT                        59350000
.*--------------------------------------------------------------------- 59400000
.*                                                                      59450000
         AIF   (T'&MSGLIM EQ 'O').END0047                               59500000
         AIF   ('&MSGLIM'(1,1) EQ '(').REG0047                          59550000
         MVC   IPMSGLIM(2),&MSGLIM MESSAGE LIMIT TO PARMLIST            59600000
         AGO   .END0047                                                 59650000
.REG0047 STH   &MSGLIM(1),IPMSGLIM MESSAGE LIMIT TO PARMLIST            59700000
.END0047 ANOP                                                           59750000
.*                                                                      59800000
.*--------------------------------------------------------------------- 59850000
.*       GENERATE THE CODE FOR THE MESSAGE TAG                          59900000
.*--------------------------------------------------------------------- 59950000
.*                                                                      60000000
         AIF   (T'&MSGTAG EQ 'O').END0048                               60050000
         AIF   ('&MSGTAG'(1,1) EQ '(').REG0048                          60100000
         MVC   IPMSGTAG(4),&MSGTAG MESSAGE TAG TO PAMLIST               60150000
         AGO   .END0048                                                 60200000
.REG0048 ST    &MSGTAG(1),IPMSGTAG MESSAGE TAG TO PARMLIST              60250000
.END0048 ANOP                                                           60300000
.*                                                                      60350000
.*--------------------------------------------------------------------- 60400000
.*       GENERATE THE CODE FOR THE PATH ID                              60450000
.*--------------------------------------------------------------------- 60500000
.*                                                                      60550000
         AIF   (T'&PATHID EQ 'O').END0049                               60600000
         AIF   ('&PATHID'(1,1) EQ '(').REG0049                          60650000
         MVC   IPPATHID(2),&PATHID PATH ID TO PARMLIST                  60700000
         AGO   .CHK0049                                                 60750000
.REG0049 STH   &PATHID(1),IPPATHID PATH ID TO PARMLIST                  60800000
.CHK0049 ANOP                                                           60850000
         AIF   ('&FCN' EQ 'TESTCMPL').FLG0049                           60900000
         AIF   ('&FCN' EQ 'REJECT').FLG0049                             60950000
         AIF   ('&FCN' EQ 'RECEIVE').FLG0049                            61000000
         AIF   ('&FCN' EQ 'PURGE').FLG0049                              61050000
         AGO   .END0049                                                 61100000
.FLG0049 ANOP                                                           61150000
         AIF   (&BITC NE 1).FST0049                                     61200000
&BITS    SETC  '&BITS'.'+'.'IPFGPID'                                    61250000
         AGO   .END0049                                                 61300000
.FST0049 ANOP                                                           61350000
&BITS    SETC  'IPFGPID'                                                61400000
.SET0049 ANOP                                                           61450000
&BITC    SETA 1                                                         61500000
.END0049 ANOP                                                           61550000
.*                                                                      61600000
.*--------------------------------------------------------------------- 61650000
.*       SET THE OPTION FLAG FOR THE PRIORITY OPTION                    61700000
.*--------------------------------------------------------------------- 61750000
.*                                                                      61800000
         AIF   ('&PRTY' NE 'YES').OFF0050                               61850000
         AIF   (&BITC NE 1).FST0050                                     61900000
&BITS    SETC  '&BITS'.'+'.'IPPRTY'                                     61950000
         AGO   .SET0050                                                 62000000
.FST0050 ANOP                                                           62050000
&BITS    SETC  'IPPRTY'                                                 62100000
.SET0050 ANOP                                                           62150000
&BITC    SETA  1                                                        62200000
         AGO   .END0050                                                 62250000
.OFF0050 ANOP                                                           62300000
         AIF   (T'&PRTY EQ 'O').END0050                                 62350000
         AIF   (&BITD NE 1).FSF0050                                     62400000
&BITSF   SETC  '&BITSF'.'+'.'IPPRTY'                                    62450000
         AGO   .STF0050                                                 62500000
.FSF0050 ANOP                                                           62550000
&BITSF   SETC  'IPPRTY'                                                 62600000
.STF0050 ANOP                                                           62650000
&BITD    SETA  1                                                        62700000
.END0050 ANOP                                                           62750000
.*                                                                      62800000
.*--------------------------------------------------------------------- 62850000
.*       SET THE OPTION FLAG FOR THE BUFFER LIST OPTION                 62900000
.*--------------------------------------------------------------------- 62950000
.*                                                                      63000000
         AIF   ('&BUFLIST' NE 'YES').OFF050A                   @V6KR3L5 63050000
         AIF   (&BITC NE 1).FST050A                            @V6KR3L5 63100000
&BITS    SETC  '&BITS'.'+'.'IPBUFLST'                          @V6KR3L5 63150000
         AGO   .SET050A                                        @V6KR3L5 63200000
.FST050A ANOP                                                  @V6KR3L5 63250000
&BITS    SETC  'IPBUFLST'                                      @V6KR3L5 63300000
.SET050A ANOP                                                  @V6KR3L5 63350000
&BITC    SETA  1                                               @V6KR3L5 63400000
         AGO   .END050A                                        @V6KR3L5 63450000
.OFF050A ANOP                                                  @V6KR3L5 63500000
         AIF   (T'&BUFLIST EQ 'O').END050A                     @V6KR3L5 63550000
         AIF   (&BITD NE 1).FSF050A                            @V6KR3L5 63600000
&BITSF   SETC  '&BITSF'.'+'.'IPBUFLST'                         @V6KR3L5 63650000
         AGO   .STF050A                                        @V6KR3L5 63700000
.FSF050A ANOP                                                  @V6KR3L5 63750000
&BITSF   SETC  'IPBUFLST'                                      @V6KR3L5 63800000
.STF050A ANOP                                                  @V6KR3L5 63850000
&BITD    SETA  1                                               @V6KR3L5 63900000
.END050A ANOP                                                  @V6KR3L5 63950000
.*                                                                      64000000
.*--------------------------------------------------------------------- 64050000
.*       SET THE OPTION FLAG FOR THE ANSWER LIST OPTION                 64100000
.*--------------------------------------------------------------------- 64150000
.*                                                                      64200000
         AIF   ('&ANSLIST' NE 'YES').OFF050B                   @V6KR3L5 64250000
         AIF   (&BITC NE 1).FST050B                            @V6KR3L5 64300000
&BITS    SETC  '&BITS'.'+'.'IPANSLST'                          @V6KR3L5 64350000
         AGO   .SET050B                                        @V6KR3L5 64400000
.FST050B ANOP                                                  @V6KR3L5 64450000
&BITS    SETC  'IPANSLST'                                      @V6KR3L5 64500000
.SET050B ANOP                                                  @V6KR3L5 64550000
&BITC    SETA  1                                               @V6KR3L5 64600000
         AGO   .END050B                                        @V6KR3L5 64650000
.OFF050B ANOP                                                  @V6KR3L5 64700000
         AIF   (T'&ANSLIST EQ 'O').END050B                     @V6KR3L5 64750000
         AIF   (&BITD NE 1).FSF050B                            @V6KR3L5 64800000
&BITSF   SETC  '&BITSF'.'+'.'IPANSLST'                         @V6KR3L5 64850000
         AGO   .STF050B                                        @V6KR3L5 64900000
.FSF050B ANOP                                                  @V6KR3L5 64950000
&BITSF   SETC  'IPANSLST'                                      @V6KR3L5 65000000
.STF050B ANOP                                                  @V6KR3L5 65050000
&BITD    SETA  1                                               @V6KR3L5 65100000
.END050B ANOP                                                  @V6KR3L5 65150000
.*                                                                      65200000
.*--------------------------------------------------------------------- 65250000
.*       SET THE OPTION FLAG FOR THE QUIESCE OPTION                     65300000
.*--------------------------------------------------------------------- 65350000
.*                                                                      65400000
         AIF   ('&QUIESCE' NE 'YES').OFF0051                            65450000
         AIF   (&BITC NE 1).FST0051                                     65500000
&BITS    SETC  '&BITS'.'+'.'IPQUSCE'                                    65550000
         AGO   .SET0051                                                 65600000
.FST0051 ANOP                                                           65650000
&BITS    SETC  'IPQUSCE'                                                65700000
.SET0051 ANOP                                                           65750000
&BITC    SETA  1                                                        65800000
         AGO   .END0051                                                 65850000
.OFF0051 ANOP                                                           65900000
         AIF   (T'&QUIESCE EQ 'O').END0051                              65950000
         AIF   (&BITD NE 1).FSF0051                                     66000000
&BITSF   SETC  '&BITSF'.'+'.'IPQUSCE'                                   66050000
         AGO   .STF0051                                                 66100000
.FSF0051 ANOP                                                           66150000
&BITSF   SETC  'IPQUSCE'                                                66200000
.STF0051 ANOP                                                           66250000
&BITD    SETA  1                                                        66300000
.END0051 ANOP                                                           66350000
.*                                                                      66400000
.*--------------------------------------------------------------------- 66450000
.*       SET THE OPTION FLAG FOR THE CONTROL OPTION                     66500000
.*--------------------------------------------------------------------- 66550000
.*                                                                      66600000
         AIF   ('&CONTROL' NE 'YES').OFF051A                   @V6MU3ND 66650000
         AIF   (&BITC NE 1).FST051A                            @V6MU3ND 66700000
&BITS    SETC  '&BITS'.'+'.'IPCNTRL'                           @V6MU3ND 66750000
         AGO   .SET051A                                        @V6MU3ND 66800000
.FST051A ANOP                                                  @V6MU3ND 66850000
&BITS    SETC  'IPCNTRL'                                       @V6MU3ND 66900000
.SET051A ANOP                                                  @V6MU3ND 66950000
&BITC    SETA  1                                               @V6MU3ND 67000000
         AGO   .END051A                                        @V6MU3ND 67050000
.OFF051A ANOP                                                  @V6MU3ND 67100000
         AIF   (T'&CONTROL EQ 'O').END051A                     @V6MU3ND 67150000
         AIF   (&BITD NE 1).FSF051A                            @V6MU3ND 67200000
&BITSF   SETC  '&BITSF'.'+'.'IPCNTRL'                          @V6MU3ND 67250000
         AGO   .STF051A                                        @V6MU3ND 67300000
.FSF051A ANOP                                                  @V6MU3ND 67350000
&BITSF   SETC  'IPCNTRL'                                       @V6MU3ND 67400000
.STF051A ANOP                                                  @V6MU3ND 67450000
&BITD    SETA  1                                               @V6MU3ND 67500000
.END051A ANOP                                                  @V6MU3ND 67550000
.*                                                                      67600000
.*--------------------------------------------------------------------- 67650000
.*       GENERATE THE CODE FOR THE SOURCE CLASS                         67700000
.*--------------------------------------------------------------------- 67750000
.*                                                                      67800000
         AIF   (T'&SRCCLS EQ 'O').END0052                               67850000
         AIF   ('&SRCCLS'(1,1) EQ '(').REG0052                          67900000
         MVC   IPSRCCLS(4),&SRCCLS SOURCE CLASS TO PARMLIST             67950000
         AGO   .CHK0052                                                 68000000
.REG0052 ST    &SRCCLS(1),IPSRCCLS SOURCE CLASS TO PARMLIST             68050000
.CHK0052 ANOP                                                           68100000
         AIF   ('&FCN' EQ 'TESTCMPL').FLG0052                           68150000
         AIF   ('&FCN' EQ 'PURGE').FLG0052                              68200000
         AGO   .END0052                                                 68250000
.FLG0052 ANOP                                                           68300000
         AIF   (&BITC NE 1).FST0052                                     68350000
&BITS    SETC  '&BITS'.'+'.'IPFGMCL'                                    68400000
         AGO   .END0052                                                 68450000
.FST0052 ANOP                                                           68500000
&BITS    SETC  'IPFGMCL'                                                68550000
.SET0052 ANOP                                                           68600000
&BITC    SETA 1                                                         68650000
.END0052 ANOP                                                           68700000
.*                                                                      68750000
.*--------------------------------------------------------------------- 68800000
.*       SET THE OPTION FLAG FOR THE PARAMETER LIST DATA OPTION         68850000
.*--------------------------------------------------------------------- 68900000
.*                                                                      68950000
         AIF   (T'&PRMDATA EQ 'O').END052A                     @V6GN6KD 69000000
         AIF   ('&PRMDATA' NE 'YES').OFF052A                   @V6GN6KD 69050000
         AIF   (&BITC NE 1).FST052A                            @V6GN6KD 69100000
&BITS    SETC  '&BITS'.'+'.'IPRMDATA'                          @V6GN6KD 69150000
         AGO   .SET052A                                        @V6GN6KD 69200000
.FST052A ANOP                                                  @V6GN6KD 69250000
&BITS    SETC  'IPRMDATA'                                      @V6GN6KD 69300000
.SET052A ANOP                                                  @V6GN6KD 69350000
&BITC    SETA  1                                               @V6GN6KD 69400000
         AGO   .END052A                                        @V6GN6KD 69450000
.OFF052A ANOP                                                  @V6GN6KD 69500000
         AIF   (&BITD NE 1).FSF052A                            @V6GN6KD 69550000
&BITSF   SETC  '&BITSF'.'+'.'IPRMDATA'                         @V6GN6KD 69600000
         AGO   .STF052A                                        @V6GN6KD 69650000
.FSF052A ANOP                                                  @V6GN6KD 69700000
&BITSF   SETC  'IPRMDATA'                                      @V6GN6KD 69750000
.STF052A ANOP                                                  @V6GN6KD 69800000
&BITD    SETA  1                                               @V6GN6KD 69850000
.END052A ANOP                                                  @V6GN6KD 69900000
.*                                                                      69950000
.*--------------------------------------------------------------------- 70000000
.*       SET THE OPTION FLAG FOR THE DATA TYPE OPTION                   70050000
.*--------------------------------------------------------------------- 70100000
.*                                                                      70150000
         AIF   (T'&DATA EQ 'O').END053A                        @V6GN6KD 70200000
         AIF   ('&DATA' NE 'PRMMSG').OFF053A                   @V6GN6KD 70250000
         AIF   (&BITC NE 1).FST053A                            @V6GN6KD 70300000
&BITS    SETC  '&BITS'.'+'.'IPRMDATA'                          @V6GN6KD 70350000
         AGO   .SET053A                                        @V6GN6KD 70400000
.FST053A ANOP                                                  @V6GN6KD 70450000
&BITS    SETC  'IPRMDATA'                                      @V6GN6KD 70500000
.SET053A ANOP                                                  @V6GN6KD 70550000
&BITC    SETA  1                                               @V6GN6KD 70600000
         AGO   .END053A                                        @V6GN6KD 70650000
.OFF053A ANOP                                                  @V6GN6KD 70700000
         AIF   (&BITD NE 1).FSF053A                            @V6GN6KD 70750000
&BITSF   SETC  '&BITSF'.'+'.'IPRMDATA'                         @V6GN6KD 70800000
         AGO   .STF053A                                        @V6GN6KD 70850000
.FSF053A ANOP                                                  @V6GN6KD 70900000
&BITSF   SETC  'IPRMDATA'                                      @V6GN6KD 70950000
.STF053A ANOP                                                  @V6GN6KD 71000000
&BITD    SETA  1                                               @V6GN6KD 71050000
.END053A ANOP                                                  @V6GN6KD 71100000
.*                                                                      71150000
.*--------------------------------------------------------------------- 71200000
.*       GENERATE THE CODE FOR THE TARGET CLASS                         71250000
.*--------------------------------------------------------------------- 71300000
.*                                                                      71350000
         AIF   (T'&TRGCLS EQ 'O').END0053                               71400000
         AIF   ('&TRGCLS'(1,1) EQ '(').REG0053                          71450000
         MVC   IPTRGCLS(4),&TRGCLS TARGET CLASS TO PARMLIST             71500000
         AGO   .CHK0053                                                 71550000
.REG0053 ST    &TRGCLS(1),IPTRGCLS TARGET CLASS TO PARMLIST             71600000
.CHK0053 ANOP                                                           71650000
         AIF   ('&FCN' EQ 'REJECT').FLG0053                             71700000
         AIF   ('&FCN' EQ 'RECEIVE').FLG0053                            71750000
         AGO   .END0053                                                 71800000
.FLG0053 ANOP                                                           71850000
         AIF   (&BITC NE 1).FST0053                                     71900000
&BITS    SETC  '&BITS'.'+'.'IPFGMCL'                                    71950000
         AGO   .END0053                                                 72000000
.FST0053 ANOP                                                           72050000
&BITS    SETC  'IPFGMCL'                                                72100000
.SET0053 ANOP                                                           72150000
&BITC    SETA 1                                                         72200000
.END0053 ANOP                                                           72250000
.*                                                                      72300000
.*--------------------------------------------------------------------- 72350000
.*       SET THE OPTION FLAG FOR THE ONE-WAY MESSAGE OPTION             72400000
.*--------------------------------------------------------------------- 72450000
.*                                                                      72500000
         AIF   ('&TYPE' NE '1WAY').OFF0054                              72550000
         AIF   (&BITC NE 1).FST0054                                     72600000
&BITS    SETC  '&BITS'.'+'.'IPNORPY'                                    72650000
         AGO   .SET0054                                                 72700000
.FST0054 ANOP                                                           72750000
&BITS    SETC  'IPNORPY'                                                72800000
.SET0054 ANOP                                                           72850000
&BITC    SETA  1                                                        72900000
         AGO   .END0054                                                 72950000
.OFF0054 ANOP                                                           73000000
         AIF   (T'&TYPE EQ 'O').END0054                                 73050000
         AIF   (&BITD NE 1).FSF0054                                     73100000
&BITSF   SETC  '&BITSF'.'+'.'IPNORPY'                                   73150000
         AGO   .STF0054                                                 73200000
.FSF0054 ANOP                                                           73250000
&BITSF   SETC  'IPNORPY'                                                73300000
.STF0054 ANOP                                                           73350000
&BITD    SETA  1                                                        73400000
.END0054 ANOP                                                           73450000
.*                                                                      73500000
.*--------------------------------------------------------------------- 73550000
.*       GENERATE THE CODE FOR THE USER DATA                            73600000
.*--------------------------------------------------------------------- 73650000
.*                                                                      73700000
         AIF   (T'&USERDTA EQ 'O').END0055                              73750000
         AIF   ('&USERDTA'(1,1) EQ '(').REG0055                         73800000
         MVC   IPUSER(16),&USERDTA USER DATA TO PARMLIST                73850000
         AGO   .END0055                                                 73900000
.REG0055 ANOP                                                           73950000
         MVC   IPUSER(16),0(&USERDTA(1)) USER DATA TO PARMLIST          74000000
.END0055 ANOP                                                           74050000
         AIF   (T'&USERID EQ 'O').END0056                               74100000
         AIF   ('&USERID'(1,1) EQ '(').REG0056                          74150000
         MVC   IPVMID(8),&USERID   USER DATA TO PARMLIST                74200000
         AGO   .END0056                                                 74250000
.REG0056 ANOP                                                           74300000
         MVC   IPVMID(8),0(&USERID(1)) USER DATA TO PARMLIST            74350000
.END0056 ANOP                                                           74400000
.*                                                                      74450000
.*--------------------------------------------------------------------- 74500000
.*       GENERATE THE CODE FOR THE PARAMETER LIST MESSAGE               74550000
.*--------------------------------------------------------------------- 74600000
.*                                                                      74650000
         AIF   (T'&PRMMSG EQ 'O').END0057                      @V6GN6KD 74700000
         AIF   ('&PRMMSG'(1,1) EQ '(').REG0057                 @V6GN6KD 74750000
         MVC   IPRMMSG,&PRMMSG     PARMLIST DATA TO PARMLIST            74800000
.*                                                             @V6GN6KD 74850000
         AGO   .END0057                                        @V6GN6KD 74900000
.REG0057 ANOP                                                  @V6GN6KD 74950000
         MVC   IPRMMSG,0(&PRMMSG(1)) PARMLIST DATA TO PARMLIST          75000000
.*                                                             @V6GN6KD 75050000
.END0057 ANOP                                                  @V6GN6KD 75100000
.*                                                                      75150000
.*--------------------------------------------------------------------- 75200000
.*       SET THE OPTION FLAG FOR THE COMSRV OPTION (IPFLAGS2)           75250000
.*--------------------------------------------------------------------- 75300000
.*                                                                      75350000
         AIF   (T'&COMSRV EQ 'O').END0058                      @V6RCGLD 75400000
         AIF   ('&COMSRV' EQ 'NO').OFF0058                     @V6RCGLD 75450000
&BITS2   SETC  '&BITS2'.'+'.'IPCOMSRV'                         @V6RCGLD 75500000
         AGO   .END0058                                        @V6RCGLD 75550000
.OFF0058 ANOP                                                  @V6RCGLD 75600000
&BITS2F  SETC  '&BITS2F'.'+'.'IPCOMSRV'                        @V6RCGLD 75650000
.END0058 ANOP                                                  @V6RCGLD 75700000
.*                                                                      75750000
.*--------------------------------------------------------------------- 75800000
.*       SET THE OPTION FLAG FOR THE LOGDATA OPTION (IPFLAGS2)          75850000
.*--------------------------------------------------------------------- 75900000
.*                                                                      75950000
         AIF   (T'&LOGDATA EQ 'O').END0059                     @V6RCGGS 76000000
         AIF   ('&LOGDATA' EQ 'NO').OFF0059                    @V6RCGGS 76050000
&BITS2   SETC  '&BITS2'.'+'.'IPLOGDOK'                         @V6RCGGS 76100000
         AGO   .END0059                                        @V6RCGGS 76150000
.OFF0059 ANOP                                                  @V6RCGGS 76200000
&BITS2F  SETC  '&BITS2F'.'+'.'IPLOGDOK'                        @V6RCGGS 76250000
.END0059 ANOP                                                  @V6RCGGS 76300000
.*                                                                      76350000
.*--------------------------------------------------------------------- 76400000
.*       GENERATE THE CODE FOR THE OPTIONS FLAG IPFLAGS2                76450000
.*--------------------------------------------------------------------- 76500000
.*                                                                      76550000
.*       AIF   (K'&BITS2 EQ 0).NOBITS2                         @V6RCGLD 76600000
         AIF   ('&BITS2' EQ '').NOBITS2                        @D31BDUL 76650000
.*ITS2   SETC  '&BITS2'(2,K'&BITS2-1)                          @V6RCGLD 76700000
&BITS2   SETC  '0'.'&BITS2'                                    @D31BDUL 76750000
         OI    IPFLAGS2,&BITS2                                          76800000
.NOBITS2 ANOP                                                  @V6RCGLD 76850000
.*       AIF   (K'&BITS2F EQ 0).NOBIT2F                        @V6RCGLD 76900000
         AIF   ('&BITS2F' EQ '').NOBIT2F                       @D31BDUL 76950000
.*ITS2F  SETC  '&BITS2F'(2,K'&BITS2F-1)                        @V6RCGLD 77000000
&BITS2F  SETC  '0'.'&BITS2F'                                   @D31BDUL 77050000
         NI    IPFLAGS2,X'FF'-(&BITS2F)                                 77100000
.NOBIT2F ANOP                                                  @V6RCGLD 77150000
.*                                                                      77200000
.*--------------------------------------------------------------------- 77250000
.*       GENERATE THE CODE FOR THE OPTIONS FLAG IPFLAGS1                77300000
.*--------------------------------------------------------------------- 77350000
.*                                                                      77400000
         AIF   (&BITC EQ 0).NOBITS                                      77450000
         OI    IPFLAGS1,&BITS                                           77500000
&BITC    SETA  0                                                        77550000
&BITS    SETC  ''                                                       77600000
.NOBITS  ANOP                                                           77650000
         AIF   (&BITD EQ 0).NOBITSF                                     77700000
         NI    IPFLAGS1,X'FF'-(&BITSF)                                  77750000
&BITD    SETA  0                                                        77800000
&BITSF   SETC  ''                                                       77850000
.NOBITSF ANOP                                                           77900000
         AIF   ('&MF' NE 'L').OK                               @V6GN6KD 77950000
         MEXIT                                                 @V6GN6KD 78000000
.OK      ANOP                                                  @V6GN6KD 78050000
.*                                                                      78100000
.*--------------------------------------------------------------------- 78150000
.*       GENERATE THE LINKAGE TO PERFORM THE IUCV FUNCTION              78200000
.*--------------------------------------------------------------------- 78250000
.*                                                                      78300000
&SV      SETC  '&MAP'(1,2)                                              78350000
         LA    0,&SV               GET FUNCTION CODE                    78400000
         AIF   ('&CP' EQ 'YES').CP                                      78450000
         AIF   (T'&PRMLIST EQ 'O').NOPARMS                              78500000
         AIF   ('&PRMLIST'(1,1) EQ '(').OPREG                           78550000
         DC    X'B2F0',S(&PRMLIST) GENERATE IUCV INSTRUCTION            78600000
         MEXIT                                                          78650000
.OPREG   ANOP                                                           78700000
         DC    X'B2F0',S(0&PRMLIST) GENERATE IUCV INSTRUCTION           78750000
         MEXIT                                                          78800000
.NOPARMS ANOP                                                           78850000
         DC    X'B2F00000'         GENERATE IUCV INSTRUCTION            78900000
         MEXIT                                                          78950000
.CP      ANOP                                                           79000000
         AIF   (T'&PRMLIST EQ 'O').GENCALL                              79050000
         AIF   ('&PRMLIST'(1,1) EQ '(').CPREG                           79100000
         LA    1,&PRMLIST          GET ADDRESS OF PARMLIST              79150000
         AGO   .GENCALL                                                 79200000
.CPREG   ANOP                                                           79250000
         AIF   ('&PRMLIST(1)' EQ '1').GENCALL                           79300000
         LR    1,&PRMLIST(1)       GET ADDRESS OF PARMLIST              79350000
.GENCALL ANOP                                                           79400000
         AIF   ('&VMBLOK' EQ 'USER').ENTRY2                             79450000
         CALL  DMKIUACP            IUCV ENTRY POINT - SYSTEM VMBLOK     79500000
         MEXIT                                                          79550000
.ENTRY2  ANOP                                                           79600000
         CALL  DMKIUACU            IUCV ENTRY POINT - USER VMBLOK       79650000
         MEND                                                           79700000
