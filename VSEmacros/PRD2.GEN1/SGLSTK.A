         MACRO                                                          00010070
         SGLSTK &TYPE=                                                  00020070
.************************************************************           00030070
*                                                           *           00040070
*        LICENSED MATERIALS - PROPERTY OF IBM               *           00050070
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"        *           00060070
*        5686-066 (C) COPYRIGHT IBM CORP. 1994, 2001        *           00070070
*        SEE COPYRIGHT INSTRUCTIONS                         *           00080070
*                                                           *           00090070
.************************************************************           00100070
         GBLA  &AGPSIZB           PAGE SIZE IN BYTES                    00110070
         GBLA  &NPART             NUMBER OF PART.SPECIFIED              00120070
         GBLB  &BGDEBUG                                                 00130070
         GBLB  &DISP              PRINT CONTROL SWITCH                  00140070
         GBLB  &IOTAB             PRINT OPTION                          00150070
         GBLC  &CGP(12)                                                 00160070
         GBLC  &P(13)             PARTITION IDENTIFIER                  00170070
         GBLC  &CGN(32)           NAMES OF SYSTEM TASKS                 00180070
         GBLC  &CGS(32)           NAMES OF SYS.TASKS,PRTY ORDR.         00190070
         GBLC  &CGSEGM            PART TO BE ASSEMBLED                  00200070
         GBLC  &SID(14)           SPACE IDS                             00210070
         LCLA  &NSYST             MAX.NUMBER OF SYSTEM TASKS            00220070
         LCLA  &LCSYST            ACTUAL NUMB.OF SYST.TASKS-1           00230070
         LCLA  &X                 PARTITION INDEX                       00240070
         LCLA  &Y                 WORK FIELD                            00250070
         LCLC  &C                                                       00260070
&NSYST   SETA  32                                                       00270070
         ACTR  11000                                                    00280070
         AIF   (NOT &BGDEBUG OR NOT &IOTAB).NOPRT00                     00290070
         PRINT GEN                 PRINT MODULE                         00300070
.NOPRT00 ANOP                                                           00310070
.**************************************************************         00320070
.*                                                            *         00330070
.* CHANGE ACTIVITIES AS FOLLOWS                               *         00340070
.*                                                            *         00350070
.**  A000000-999999                                           *         00360070
.*                                                            *         00370070
.**************************************************************         00380070
.*                                                                      00390070
         DS    0F                                                       00400070
         DC    CL8'SGLSTK'                                              00410070
         DC    CL10'DY45712   '  LAST APAR/DEVELOPMENT CHANGE           00420070
         AIF   ('&TYPE' EQ 'CODE').CODE000                     @D61PDOW 00430070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         00440070
*                                                             *         00450070
*        MAPPING SYSTEM FUNCTION TABLE                        *         00460070
*                                                             *         00470070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         00480070
         EJECT                                                 @D61PDOW 00490070
SFTADR   DS     0D               FORCE BOUNDARY OF SFT         @D61PDOW 00500070
         MAPSFT OS=VSE,DSECT=NO                                @D61PDOW 00510070
         SPACE                                                          00520070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00530070
*  FOR ALL SYSTEM TASKS: GENERATE LINKAGE STACK WITH ONE STATUS ENTRY * 00540070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00550070
         SPACE 1                                                        00560070
&X       SETA  0                                                        00570070
.SLSTK   ANOP                                                           00580070
&X       SETA  &X+1                                                     00590070
         AIF   ('&CGN(&X)' EQ '').NOLSTK                                00600070
&C       SETC  '&CGN(&X)'                                               00610070
         DS    0D                FORCE DOUBLE WORD BOUNDARY    @D61PDOW 00620070
&C.LSTCK DS    0CL16             LINKAGE STACK FOR SYS TASK    @D61PDOW 00630070
         DC    X'00000000'       HEADER ENTRY                  @D61PDOW 00640070
         DC    X'00000000'                                     @D61PDOW 00650070
&C.LSTHD DC    AL1(LSTKHENT)     ENTRY TYPE IS HEADER          @D61PDOW 00660070
         DC    X'00'             SECTION IDENTIFICATION        @D61PDOW 00670070
         DC    AL2(L'&C.STAT)    REMAINING FREE SPACE          @D61PDOW 00680070
         DC    X'00000000'                                     @D61PDOW 00690070
         SPACE 1                                                        00700070
&C.STAT  DC    XL168'00'         ONE STATUS ENTRY              @D64XDOW 00710070
*                                                                       00720070
         DS    0CL16                                           @D61PDOW 00730070
         DC    X'00000000'       TRAILOR ENTRY                 @D61PDOW 00740070
         DC    X'00000000'                                     @D61PDOW 00750070
         DC    AL1(LSTKTENT)     ENTRY TYPE IS TRAILOR         @D61PDOW 00760070
         DC    X'00000000000000'                                        00770070
*                                                                       00780070
.NOLSTK  AIF   (&X LT &NSYST).SLSTK                                     00790070
         SPACE 2                                                        00800070
         DS    0D                FORCE DOUBLE WORD BOUNDARY    @D61PDOW 00810070
BGLSTCK  DS    0CL16             LINKAGE STACK FOR BG          @D61PDOW 00820070
         DC    X'00000000'       HEADER ENTRY                  @D61PDOW 00830070
         DC    X'00000000'                                     @D61PDOW 00840070
BGLSTHD  DC    AL1(LSTKHENT)     ENTRY TYPE IS HEADER          @D61PDOW 00850070
         DC    X'00'             SECTION IDENTIFICATION        @D61PDOW 00860070
         DC    AL2(L'BGSTAT)     REMAINING FREE SPACE          @D64XDOW 00870070
         DC    X'00000000'                                     @D61PDOW 00880070
         SPACE                                                          00890070
BGSTAT   DC    XL168'00'         ONE STATUS ENTRY              @D64XDOW 00900070
*                                                                       00910070
         DS    0CL16                                           @D61PDOW 00920070
         DC    X'00000000'       TRAILOR ENTRY                 @D61PDOW 00930070
         DC    X'00000000'                                     @D61PDOW 00940070
         DC    AL1(LSTKTENT)     ENTRY TYPE IS TRAILOR         @D61PDOW 00950070
         DC    X'00000000000000'                                        00960070
         SPACE                                                          00970070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         00980070
*  ALLOCATE ESA ACCESS REGISTER TABLES                                  00990070
*                                                                       01000070
*  THE SYSASTE AND BGASTE MUST BE GENERATED SINCE THEY ARE USED         01010070
*  DURING IPL.                                                          01020070
*  DURING SVC 43 PROCESSING THE ASTES ARE ALLOCATED WITHIN THE ASN      01030070
*  SECOND TABLES. THE SYSASTE AND BGASTE ARE NO LONGER USED THEN.       01040070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         01050070
         SPACE 2                                               @D51KDTP 01060070
         ORG   *+((((*-SYSS00+63)/64)*64)-(*-SYSS00)) 64 BYTE  @D64XDMZ 01070070
ASTE$AR  DC    A(ARAUTHT+X'80000000')                          @D64XDMZ 01080070
         DC    X'0000'            AX VALUE                     @D64XDMZ 01090070
         DC    AL2((L'ARAUTHT/4-1)*16) LENGTH-1 OF SYSTEM      @D64XDMZ 01100070
***                               AUTHORITY TABLE IN UNITS OF 4 BYTES   01110070
***                               AT POSITION 0-11                      01120070
         DC    X'00000000'        SEGMENT TABLE                @D64XDMZ 01130070
         DC    A(SLINKTAB+(L'SLINKTAB/128-1)+X'80000000')      @D64XDMZ 01140070
         DC    4F'0'                                           @D64XDMZ 01150070
ARAUTHT  DC    X'3000000000000000'                             @D64XDMZ 01160070
         DC    6F'0'              REMAINDER OF ASTE            @D64XDMZ 01170070
         SPACE                                                          01180070
         ORG   *+((((*-SYSS00+63)/64)*64)-(*-SYSS00)) 64 BYTE  @D51KDTP 01190070
         SPACE                                                          01200070
ASTE$BG  DC    A(BGAUTHT+X'80000000')                          @D64XDMZ 01210070
         DC    X'0000'            AX VALUE                     @D64XDMZ 01220070
         DC    AL2((L'BGAUTHT/4-1)*16) LENGTH-1 OF BG-AUTH TABL@D64XDMZ 01230070
         DC    X'00000000'                                     @D61PDOW 01240070
         DC    A(SLINKTAB+(L'SLINKTAB/128-1)+X'80000000')      @D61PDOW 01250070
         DC    4F'0'                                           @D64XDMZ 01260070
BGAUTHT  DC    X'3000000000000000'                             @D64XDMZ 01270070
         DC    6F'0'              REMAINDER OF ASTE            @D64XDMZ 01280070
*                                                                       01290070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         01300070
*                                                             *         01310070
*        ENTRY TABLES FOR SYSTEM FUNCTIONS                    *         01320070
*                                                             *         01330070
*        NOTE : SOME SYSTEM FUNCTIONS ASSUME THAT THE         *         01340070
*               ENTRY TABLES FOR SYSTEM FUNCTIONS RESIDE IN   *         01350070
*               AN AREA WHERE VIRTUAL ADDR IS EQ TO REAL ADDR *         01360070
*                                                             *         01370070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         01380070
         ORG   *+((((*-SYSS00+63)/64)*64)-(*-SYSS00)) FORCE    @D61PDOW 01390070
***                             ... 64 BYTE BOUNDARY                    01400070
ENTTAB00 DS    0CL640        LX=000                            @D61PDOW 01410070
         DS    0CL32            EX=00 LXRES                    @D61ADMZ 01420070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D61ADMZ 01430070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 01440070
XLREADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 01450070
         DC     A(XMLARA00)                                    @D64ADOW 01460070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 01470070
         DC     H'0'                RESERVED                   @D61ADMZ 01480070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 01490070
***                                 ... ENTRY KEY REPLACES PSW-KEY      01500070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 01510070
         DC     H'0'                RESERVED                   @D61ADMZ 01520070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 01530070
         DC     2A(0)               RESERVED                   @D64ADMZ 01540070
*                                                                       01550070
         DS    0CL32            EX=01 LXFRE                    @D61ADMZ 01560070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D61ADMZ 01570070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 01580070
XLFRADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 01590070
         DC     A(XMLARA01)                                    @D64ADOW 01600070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 01610070
         DC     H'0'                RESERVED                   @D61ADMZ 01620070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 01630070
***                                 ... ENTRY KEY REPLACES PSW-KEY      01640070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 01650070
         DC     H'0'                RESERVED                   @D61ADMZ 01660070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 01670070
         DC     2A(0)               RESERVED                   @D64ADMZ 01680070
*                                                                       01690070
         DS    0CL32            EX=02 ETCRE                    @D61ADMZ 01700070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D61ADMZ 01710070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 01720070
XECRADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 01730070
         DC     A(XMLARA02)                                    @D64ADOW 01740070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 01750070
         DC     H'0'                RESERVED                   @D61ADMZ 01760070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 01770070
***                                 ... ENTRY KEY REPLACES PSW-KEY      01780070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 01790070
         DC     H'0'                RESERVED                   @D61ADMZ 01800070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 01810070
         DC     2A(0)               RESERVED                   @D64ADMZ 01820070
*                                                                       01830070
         DS    0CL32            EX=03 ETDES                    @D61ADMZ 01840070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D61ADMZ 01850070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 01860070
XEDEADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 01870070
         DC     A(XMLARA03)                                    @D64ADOW 01880070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 01890070
         DC     H'0'                RESERVED                   @D61ADMZ 01900070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 01910070
***                                 ... ENTRY KEY REPLACES PSW-KEY      01920070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 01930070
         DC     H'0'                RESERVED                   @D61ADMZ 01940070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 01950070
         DC     2A(0)               RESERVED                   @D64ADMZ 01960070
*                                                                       01970070
         DS    0CL32            EX=04 ETCON                    @D61ADMZ 01980070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D61ADMZ 01990070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 02000070
XECOADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 02010070
         DC     A(XMLARA04)                                    @D64ADOW 02020070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 02030070
         DC     H'0'                RESERVED                   @D61ADMZ 02040070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 02050070
***                                 ... ENTRY KEY REPLACES PSW-KEY      02060070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 02070070
         DC     H'0'                RESERVED                   @D61ADMZ 02080070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 02090070
         DC     2A(0)               RESERVED                   @D64ADMZ 02100070
*                                                                       02110070
         DS    0CL32            EX=05 ETDIS                    @D61ADMZ 02120070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D61ADMZ 02130070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 02140070
XEDIADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 02150070
         DC     A(XMLARA05)                                    @D64ADOW 02160070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 02170070
         DC     H'0'                RESERVED                   @D61ADMZ 02180070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 02190070
***                                 ... ENTRY KEY REPLACES PSW-KEY      02200070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 02210070
         DC     H'0'                RESERVED                   @D61ADMZ 02220070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 02230070
         DC     2A(0)               RESERVED                   @D64ADMZ 02240070
*                                                                       02250070
         DS    0CL32            EX=06 AXRES                    @D61ADMZ 02260070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D61ADMZ 02270070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 02280070
XAREADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 02290070
         DC     A(XMLARA06)                                    @D64ADOW 02300070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 02310070
         DC     H'0'                RESERVED                   @D61ADMZ 02320070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 02330070
***                                 ... ENTRY KEY REPLACES PSW-KEY      02340070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 02350070
         DC     H'0'                RESERVED                   @D61ADMZ 02360070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 02370070
         DC     2A(0)               RESERVED                   @D64ADMZ 02380070
*                                                                       02390070
         DS    0CL32            EX=07 AXFRE                    @D61ADMZ 02400070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D61ADMZ 02410070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 02420070
XAFRADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 02430070
         DC     A(XMLARA07)                                    @D64ADOW 02440070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 02450070
         DC     H'0'                RESERVED                   @D61ADMZ 02460070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 02470070
***                                 ... ENTRY KEY REPLACES PSW-KEY      02480070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 02490070
         DC     H'0'                RESERVED                   @D61ADMZ 02500070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 02510070
         DC     2A(0)               RESERVED                   @D64ADMZ 02520070
*                                                                       02530070
         DS    0CL32            EX=08 AXEXT                    @D61ADMZ 02540070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D61ADMZ 02550070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 02560070
XAEXADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 02570070
         DC     A(XMLARA08)                                    @D64ADOW 02580070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 02590070
         DC     H'0'                RESERVED                   @D61ADMZ 02600070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 02610070
***                                 ... ENTRY KEY REPLACES PSW-KEY      02620070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 02630070
         DC     H'0'                RESERVED                   @D61ADMZ 02640070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 02650070
         DC     2A(0)               RESERVED                   @D64ADMZ 02660070
*                                                                       02670070
         DS    0CL32            EX=09         NOT SUPPORTED    @D64XDMZ 02680070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61PDOW 02690070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 02700070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61PDOW 02710070
         DC     A(0)                NO ENTRY PARAMETER         @D61PDOW 02720070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 02730070
         DC     H'0'                RESERVED                   @D61PDOW 02740070
         DC     B'10010000'         STACKING PC &              @D61PDOW 02750070
***                                 ... ENTRY KEY REPLACES PSW-KEY      02760070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 02770070
         DC     H'0'                RESERVED                   @D61PDOW 02780070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 02790070
         DC     2A(0)               RESERVED                   @D61PDOW 02800070
*                                                                       02810070
         DS    0CL32            EX=0A ATSET                    @D64XDMZ 02820070
         DC     B'1000000000000000' ONLY KEY 0 USER ALLOWED    @D64XDMZ 02830070
         DC     H'0'                NO SPACE SWITCHING         @D64XDMZ 02840070
XATSADR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D64XDMZ 02850070
         DC     A(XMLARA0A)                                    @D64ADOW 02860070
         DC     H'0'                DON'T MODIFY CR 3          @D64XDMZ 02870070
         DC     H'0'                RESERVED                   @D64XDMZ 02880070
         DC     B'10010000'         STACKING PC &              @D64XDMZ 02890070
***                                 ... ENTRY KEY REPLACES PSW-KEY      02900070
         DC     B'00000000'         ENTRY KEY                  @D64XDMZ 02910070
         DC     H'0'                RESERVED                   @D64XDMZ 02920070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D64XDMZ 02930070
         DC     2A(0)               RESERVED                   @D64ADMZ 02940070
*                                                                       02950070
&X       SETA  11                                              @D61PDOW 02960070
.ENTT000 ANOP                                                  @D61PDOW 02970070
         DS    0CL32            EX=0B - EX=0C NOT SUPPORTED    @D64XDMZ 02980070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61PDOW 02990070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 03000070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61PDOW 03010070
         DC     A(0)                NO ENTRY PARAMETER         @D61PDOW 03020070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 03030070
         DC     H'0'                RESERVED                   @D61PDOW 03040070
         DC     B'10010000'         STACKING PC &              @D61PDOW 03050070
***                                 ... ENTRY KEY REPLACES PSW-KEY      03060070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 03070070
         DC     H'0'                RESERVED                   @D61PDOW 03080070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 03090070
         DC     2A(0)               RESERVED                   @D61PDOW 03100070
&X       SETA  &X+1             INCREASE LOOP COUNTER          @D61PDOW 03110070
         AIF   (&X LE 12).ENTT000                              @D61PDOW 03120070
*                                                                       03130070
         DS    0CL32            EX=0D   ALESERV ADD            @D61PDOW 03140070
         DC     B'0111111111111111' ONLY USER TASK MAY ISSUE PC@D61PDOW 03150070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 03160070
ALEADDR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61PDOW 03170070
         DC     A(ALEALPA1)         ADDR LATENT PARAMETER AREA @D61PDOW 03180070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 03190070
         DC     H'0'                RESERVED                   @D61PDOW 03200070
         DC     B'10010000'         STACKING PC &              @D61PDOW 03210070
***                                 ... ENTRY KEY REPLACES PSW-KEY      03220070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 03230070
         DC     H'0'                RESERVED                   @D61PDOW 03240070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 03250070
         DC     2A(0)               RESERVED                   @D64ADMZ 03260070
*                                                                       03270070
         DS    0CL32            EX=0E   ALESERV DELETE         @D61PDOW 03280070
         DC     B'0111111111111111' ONLY USER TASK MAY ISSUE PC@D61PDOW 03290070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 03300070
ALEADDR2 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61PDOW 03310070
         DC     A(ALEALPA2)         ADDR LATENT PARAMETER AREA @D61PDOW 03320070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 03330070
         DC     H'0'                RESERVED                   @D61PDOW 03340070
         DC     B'10010000'         STACKING PC &              @D61PDOW 03350070
***                                 ... ENTRY KEY REPLACES PSW-KEY      03360070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 03370070
         DC     H'0'                RESERVED                   @D61PDOW 03380070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 03390070
         DC     2A(0)               RESERVED                   @D64ADMZ 03400070
*                                                                       03410070
         DS    0CL32            EX=0F   ALESERV EXTRACT        @D61PDOW 03420070
         DC     B'0111111111111111' ONLY USER TASK MAY ISSUE PC@D61PDOW 03430070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 03440070
ALEADDR3 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61PDOW 03450070
         DC     A(ALEALPA3)         ADDR LATENT PARAMETER AREA @D61PDOW 03460070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 03470070
         DC     H'0'                RESERVED                   @D61PDOW 03480070
         DC     B'10010000'         STACKING PC &              @D61PDOW 03490070
***                                 ... ENTRY KEY REPLACES PSW-KEY      03500070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 03510070
         DC     H'0'                RESERVED                   @D61PDOW 03520070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 03530070
         DC     2A(0)               RESERVED                   @D64ADMZ 03540070
*                                                                       03550070
         DS    0CL32            EX=10   ALESERV SEARCH         @D61PDOW 03560070
         DC     B'0111111111111111' ONLY USER TASK MAY ISSUE PC@D61PDOW 03570070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 03580070
ALEADDR4 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61PDOW 03590070
         DC     A(ALEALPA4)         ADDR LATENT PARAMETER AREA @D61PDOW 03600070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 03610070
         DC     H'0'                RESERVED                   @D61PDOW 03620070
         DC     B'10010000'         STACKING PC &              @D61PDOW 03630070
***                                 ... ENTRY KEY REPLACES PSW-KEY      03640070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 03650070
         DC     H'0'                RESERVED                   @D61PDOW 03660070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 03670070
         DC     2A(0)               RESERVED                   @D64ADMZ 03680070
*                                                                       03690070
         DS    0CL32            EX=11 - EX=13 NOT SUPPORTED    @D61PDOW 03700070
&X       SETA  17                                              @D61PDOW 03710070
.ENTT010 ANOP                                                  @D61PDOW 03720070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61PDOW 03730070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 03740070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61PDOW 03750070
         DC     A(0)                NO ENTRY PARAMETER         @D61PDOW 03760070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 03770070
         DC     H'0'                RESERVED                   @D61PDOW 03780070
         DC     B'10010000'         STACKING PC &              @D61PDOW 03790070
***                                 ... ENTRY KEY REPLACES PSW-KEY      03800070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 03810070
         DC     H'0'                RESERVED                   @D61PDOW 03820070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 03830070
         DC     2A(0)               RESERVED                   @D61PDOW 03840070
&X       SETA  &X+1             INCREASE LOOP COUNTER          @D61PDOW 03850070
         AIF   (&X LE 19).ENTT010                              @D61PDOW 03860070
***                                                                     03870070
***                                                                     03880070
ENTTAB03 DS    0CL1152       LX=003                            @D61ADMZ 03890070
         DS    0CL32            EX=00 PC FOR REXX              @D61NDMZ 03900070
REXXPC#  EQU   X'300'                                          @D65CDOW 03901070
.*                                  IF THE CORRESPONDING MVS FUNCTION   03901170
.*                                  IS PORTED TO VSE SELECT ANOTHER     03901270
.*                                  PC NUMBER                           03901370
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61NDMZ 03901470
         DC     H'0'                NO SPACE SWITCHING         @D61NDMZ 03901570
ARXQADR1 DC     A(LSTKERR)          CANCEL PC ISSUER           @D61NDMZ 03901670
         DC     A(RELARA00)                                    @D64ADOW 03901770
         DC     H'0'                DON'T MODIFY CR 3          @D61NDMZ 03901870
         DC     H'0'                RESERVED                   @D61NDMZ 03901970
         DC     B'10010000'         STACKING PC &              @D61NDMZ 03902070
***                                 ... ENTRY KEY REPLACES PSW-KEY      03903070
         DC     B'00000000'         ENTRY KEY                  @D61NDMZ 03904070
         DC     H'0'                RESERVED                   @D61NDMZ 03905070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61NDMZ 03906070
         DC     2A(0)               RESERVED                   @D64ADMZ 03907070
*                                                                       03908070
         DS    0CL32            EX=01 PC FOR DMF               @D64XDMZ 03909070
DMFPC#   EQU   X'301'                                          @D65CDOW 03910070
.*                                  IF THE CORRESPONDING MVS FUNCTION   03920070
.*                                  IS PORTED TO VSE SELECT ANOTHER     03930070
.*                                  PC NUMBER                           03940070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D64XDMZ 03950070
         DC     H'0'                ASN OF DMF PARTITION       @D64XDMZ 03960070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D64XDMZ 03970070
         DC     A(DMFALPA)          ADDR OF LATENT PARA. AREA  @D64XDMZ 03980070
         DC     B'1111111111111111' ENTRY KEY MASK             @D64XDMZ 03990070
         DC     H'0'                RESERVED                   @D61NDMZ 04000070
         DC     B'10010011'         STACKING PC &              @D64XDMZ 04010070
***                                 ... ENTRY KEY REPLACES PSW-KEY      04020070
***                                 ... AR MODE, SASN = NEW             04030070
         DC     B'00000000'         ENTRY KEY                  @D61NDMZ 04040070
         DC     H'0'                RESERVED                   @D61NDMZ 04050070
         DC     A(0)                ASTER OF DMF PARTITION     @D64XDMZ 04060070
         DC     2A(0)               RESERVED                   @D64ADMZ 04070070
*                                                                       04080070
&X       SETA  2                                               @D61ADMZ 04090070
.ENTT050 ANOP                                                  @D61ADMZ 04100070
         DS    0CL32            EX=02 - EX=0A NOT SUPPORTED    @D61ADMZ 04110070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61ADMZ 04120070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 04130070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61ADMZ 04140070
         DC     A(0)                NO ENTRY PARAMETER         @D61ADMZ 04150070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 04160070
         DC     H'0'                RESERVED                   @D61ADMZ 04170070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 04180070
***                                 ... ENTRY KEY REPLACES PSW-KEY      04190070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 04200070
         DC     H'0'                RESERVED                   @D61ADMZ 04210070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 04220070
         DC     2A(0)               RESERVED                   @D61ADMZ 04230070
*                                                                       04240070
&X       SETA  &X+1             INCREASE LOOP COUNTER          @D61ADMZ 04250070
         AIF   (&X LE 10).ENTT050                              @D64XDMZ 04260070
*                                                                       04270070
         DS    0CL32            EX=0B   STORAGE OBTAIN         @D61ADMZ 04280070
         DC     B'0111111111111111' ONLY USER TASK MAY ISSUE PC@D61ADMZ 04290070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 04300070
STOROBT  DC     A(GMFMPC+X'80000000') ENTRY OF STORAGE OBTAIN  @D61ADKH 04310070
         DC     A(STORLPA1)         LATENT PARAMETER AREA      @D64XDMZ 04320070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 04330070
         DC     H'0'                RESERVED                   @D61ADMZ 04340070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 04350070
***                                 ... ENTRY KEY REPLACES PSW-KEY      04360070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 04370070
         DC     H'0'                RESERVED                   @D61ADMZ 04380070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 04390070
         DC     2A(0)               RESERVED                   @D64ADMZ 04400070
*                                                                       04410070
         DS    0CL32            EX=0C - EX=0E NOT SUPPORTED    @D61ADMZ 04420070
*                                                                       04430070
&X       SETA  12                                              @D61ADMZ 04440070
.ENTT060 ANOP                                                  @D61ADMZ 04450070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61ADMZ 04460070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 04470070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61ADMZ 04480070
         DC     A(0)                NO ENTRY PARAMETER         @D61ADMZ 04490070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 04500070
         DC     H'0'                RESERVED                   @D61ADMZ 04510070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 04520070
***                                 ... ENTRY KEY REPLACES PSW-KEY      04530070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 04540070
         DC     H'0'                RESERVED                   @D61ADMZ 04550070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 04560070
         DC     2A(0)               RESERVED                   @D61ADMZ 04570070
&X       SETA  &X+1             INCREASE LOOP COUNTER          @D61ADMZ 04580070
         AIF   (&X LE 14).ENTT060                              @D61ADMZ 04590070
*                                                                       04600070
         DS    0CL32            EX=0F   ESTAEX                 @D61ADMZ 04610070
         DC     B'1111111111111111' ALL TASKS MAY ISSUE PC     @D61ADMZ 04620070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 04630070
ESTAEXAD DC     A(ESTAEXBG+X'80000000') ENTRY OF ESTAEX IN     @D64ADOW 04640070
***                                 ...31BIT MODE AND SUPERVISOR STATE  04650070
         DC     A(ESTALP0F)         LATENT PARAMETER AREA      @D61ADMZ 04660070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 04670070
         DC     H'0'                RESERVED                   @D61ADMZ 04680070
         DC     B'10010000'         STACKING PC &              @D61NDMZ 04690070
***                                 ... ENTRY KEY REPLACES PSW-KEY      04700070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 04710070
         DC     H'0'                RESERVED                   @D61ADMZ 04720070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 04730070
         DC     2A(0)               RESERVED                   @D64ADMZ 04740070
*                                                                       04750070
         DS    0CL32            EX=10   NOT SUPPORTED          @D61ADMZ 04760070
         DC     B'1111111111111111' ALL TASKS                  @D61ADMZ 04770070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 04780070
         DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61ADMZ 04790070
         DC     A(0)                NO ENTRY PARAMETER         @D61ADMZ 04800070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 04810070
         DC     H'0'                RESERVED                   @D61ADMZ 04820070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 04830070
***                                 ... ENTRY KEY REPLACES PSW-KEY      04840070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 04850070
         DC     H'0'                RESERVED                   @D61ADMZ 04860070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 04870070
         DC     2A(0)               RESERVED                   @D61ADMZ 04880070
*                                                                       04890070
         DS    0CL32            EX=11   STORAGE RELEASE        @D61ADMZ 04900070
         DC     B'0111111111111111' ONLY USER TASK MAY ISSUE PC@D61ADMZ 04910070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 04920070
STORREL  DC     A(GMFMPC+X'80000000') ENTRY OF STORAGE RELEASE @D61ADKH 04930070
         DC     A(STORLPA2)         LATENT PARAMETER AREA      @D64XDMZ 04940070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 04950070
         DC     H'0'                RESERVED                   @D61ADMZ 04960070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 04970070
***                                 ... ENTRY KEY REPLACES PSW-KEY      04980070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 04990070
         DC     H'0'                RESERVED                   @D61ADMZ 05000070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 05010070
         DC     2A(0)               RESERVED                   @D64ADMZ 05020070
***                                                                     05030070
         DS    0CL32            EX=12 - EX=20 NOT SUPPORTED    @D61ADMZ 05040070
&X       SETA  18                                              @D61ADMZ 05050070
.ENTT070 ANOP                                                  @D61ADMZ 05060070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61ADMZ 05070070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 05080070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61ADMZ 05090070
         DC     A(0)                NO ENTRY PARAMETER         @D61ADMZ 05100070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 05110070
         DC     H'0'                RESERVED                   @D61ADMZ 05120070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 05130070
***                                 ... ENTRY KEY REPLACES PSW-KEY      05140070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 05150070
         DC     H'0'                RESERVED                   @D61ADMZ 05160070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 05170070
         DC     2A(0)               RESERVED                   @D61ADMZ 05180070
&X       SETA  &X+1             INCREASE LOOP COUNTER          @D61ADMZ 05190070
         AIF   (&X LE 32).ENTT070                              @D61ADMZ 05200070
***                                                                     05210070
*                                                                       05220070
         DS    0CL32            EX=21   TIME                   @D61ADVB 05230070
         DC     B'0111111111111111' ONLY USER TASK MAY ISSUE PC@D61ADVB 05240070
         DC     H'0'                NO SPACE SWITCHING         @D61ADVB 05250070
         DC     A(X'80000000'+MVSPCTIM) ENTRY FOR TIME PROCESS @D61ADVB 05260070
         DC     A(TIMELPA)          LATENT PARAMETER AREA      @D64XDMZ 05270070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADVB 05280070
         DC     H'0'                RESERVED                   @D61ADVB 05290070
         DC     B'10010000'         STACKING PC &              @D61ADVB 05300070
***                                 ... ENTRY KEY REPLACES PSW-KEY      05310070
         DC     B'00000000'         ENTRY KEY                  @D61ADVB 05320070
         DC     H'0'                RESERVED                   @D61ADVB 05330070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADVB 05340070
         DC     2A(0)               RESERVED                   @D64ADMZ 05350070
*                                                              @D61ADVB 05360070
         DS    0CL32            EX=22 - EX=23 NOT SUPPORTED    @D61ADMZ 05370070
&X       SETA  34                                              @D61ADMZ 05380070
.ENTT075 ANOP                                                  @D61ADMZ 05390070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61ADMZ 05400070
         DC     H'0'                NO SPACE SWITCHING         @D61ADMZ 05410070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61ADMZ 05420070
         DC     A(0)                NO ENTRY PARAMETER         @D61ADMZ 05430070
         DC     H'0'                DON'T MODIFY CR 3          @D61ADMZ 05440070
         DC     H'0'                RESERVED                   @D61ADMZ 05450070
         DC     B'10010000'         STACKING PC &              @D61ADMZ 05460070
***                                 ... ENTRY KEY REPLACES PSW-KEY      05470070
         DC     B'00000000'         ENTRY KEY                  @D61ADMZ 05480070
         DC     H'0'                RESERVED                   @D61ADMZ 05490070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61ADMZ 05500070
         DC     2A(0)               RESERVED                   @D61ADMZ 05510070
*                                                                       05520070
&X       SETA  &X+1             INCREASE LOOP COUNTER          @D61ADMZ 05530070
         AIF   (&X LE 35).ENTT075                              @D61ADMZ 05540070
***                                                                     05550070
ENTTAB04 DS    0CL256        LX=004                            @D61PDOW 05560070
         DS    0CL32            EX=00   NOT SUPPORTED          @D61PDOW 05570070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61PDOW 05580070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 05590070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61PDOW 05600070
         DC     A(0)                NO ENTRY PARAMETER         @D61PDOW 05610070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 05620070
         DC     H'0'                RESERVED                   @D61PDOW 05630070
         DC     B'10010000'         STACKING PC &              @D61PDOW 05640070
***                                 ... ENTRY KEY REPLACES PSW-KEY      05650070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 05660070
         DC     H'0'                RESERVED                   @D61PDOW 05670070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 05680070
         DC     2A(0)               RESERVED                   @D61PDOW 05690070
*                                                                       05700070
         DS    0CL32            EX=01   MCSOPER                @D61PDOW 05710070
         DC     B'1111111111111111' ALL TASK CAN ISSUE PC      @D61PDOW 05720070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 05730070
PCMADDR1 DC     A(PCMCSOP)          ROUTINE ADDR               @D61PDOW 05740070
         DC     A(PCMALPA1)         ADD LATENT PARAMETER AREA  @D61PDOW 05750070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 05760070
         DC     H'0'                RESERVED                   @D61PDOW 05770070
         DC     B'10010000'         STACKING PC &              @D61PDOW 05780070
***                                 ... ENTRY KEY REPLACES PSW-KEY      05790070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 05800070
         DC     H'0'                RESERVED                   @D61PDOW 05810070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 05820070
         DC     2A(0)               RESERVED                   @D64ADMZ 05830070
*                                                                       05840070
         DS    0CL32            EX=02 - EX=05 NOT SUPPORTED    @D61PDOW 05850070
&X       SETA  2                                               @D61PDOW 05860070
.ENTT020 ANOP                                                  @D61PDOW 05870070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61PDOW 05880070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 05890070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61PDOW 05900070
         DC     A(0)                NO ENTRY PARAMETER         @D61PDOW 05910070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 05920070
         DC     H'0'                RESERVED                   @D61PDOW 05930070
         DC     B'10010000'         STACKING PC &              @D61PDOW 05940070
***                                 ... ENTRY KEY REPLACES PSW-KEY      05950070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 05960070
         DC     H'0'                RESERVED                   @D61PDOW 05970070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 05980070
         DC     2A(0)               RESERVED                   @D61PDOW 05990070
&X       SETA  &X+1             INCREASE LOOP COUNTER          @D61PDOW 06000070
         AIF   (&X LE    5).ENTT020                            @D61PDOW 06010070
*                                                                       06020070
         DS    0CL32            EX=06   MCSOPMSG               @D61PDOW 06030070
         DC     B'1111111111111111' ALL TASK CAN ISSUE PC      @D61PDOW 06040070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 06050070
PCMADDR2 DC     A(PCMCSMG)          ROUTINE ADDR               @D61PDOW 06060070
         DC     A(PCMALPA2)         ADDR LATENT PARAMETER AREA @D64XDMZ 06070070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 06080070
         DC     H'0'                RESERVED                   @D61PDOW 06090070
         DC     B'10010000'         STACKING PC &              @D61PDOW 06100070
***                                 ... ENTRY KEY REPLACES PSW-KEY      06110070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 06120070
         DC     H'0'                RESERVED                   @D61PDOW 06130070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 06140070
         DC     2A(0)               RESERVED                   @D64ADMZ 06150070
*                                                                       06160070
         DS    0CL32            EX=07   NOT SUPPORTED          @D61PDOW 06170070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61PDOW 06180070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 06190070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61PDOW 06200070
         DC     A(0)                NO ENTRY PARAMETER         @D61PDOW 06210070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 06220070
         DC     H'0'                RESERVED                   @D61PDOW 06230070
         DC     B'10010000'         STACKING PC &              @D61PDOW 06240070
***                                 ... ENTRY KEY REPLACES PSW-KEY      06250070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 06260070
         DC     H'0'                RESERVED                   @D61PDOW 06270070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 06280070
         DC     2A(0)               RESERVED                   @D61PDOW 06290070
**                                                                      06300070
**                                                                      06310070
ENTTAB09 DS    0CL128        LX=009                            @D61PDOW 06320071
         DS    0CL32            EX=00   DSPSERV                @D61PDOW 06330070
         DC     B'0111111111111111' ONLY USER TASK MAY ISSUE PC@D61PDOW 06340070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 06350070
DSPADDR1 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61PDOW 06360070
         DC     A(DSPALPA1)         ADDR LATENT PARAEMETER AREA@D61PDOW 06370070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 06380070
         DC     H'0'                RESERVED                   @D61PDOW 06390070
         DC     B'10010000'         STACKING PC &              @D61PDOW 06400070
***                                 ... ENTRY KEY REPLACES PSW-KEY      06410070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 06420070
         DC     H'0'                RESERVED                   @D61PDOW 06430070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 06440070
         DC     2A(0)               RESERVED                   @D64ADMZ 06450070
*                                                                       06460070
         DS    0CL32            EX=01 - EX=02 NOT SUPPORTED    @D61PDOW 06470070
&X       SETA  1                                               @D61PDOW 06480070
.ENTT030 ANOP                                                  @D61PDOW 06490070
         DC     B'1111111111111111' ALLOWED FOR ALL TASKS      @D61PDOW 06500070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 06510070
         DC     A(LSTKERR)          CANCEL PC ISSUER           @D61PDOW 06520070
         DC     A(0)                NO ENTRY PARAMETER         @D61PDOW 06530070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 06540070
         DC     H'0'                RESERVED                   @D61PDOW 06550070
         DC     B'10010000'         STACKING PC &              @D61PDOW 06560070
***                                 ... ENTRY KEY REPLACES PSW-KEY      06570070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 06580070
         DC     H'0'                RESERVED                   @D61PDOW 06590070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 06600070
         DC     2A(0)               RESERVED                   @D61PDOW 06610070
&X       SETA  &X+1             INCREASE LOOP COUNTER          @D61PDOW 06620070
         AIF   (&X LE    2).ENTT030                            @D61PDOW 06630070
*                                                                       06640070
         DS    0CL32            EX=03   DSPSERV                @D61PDOW 06650070
         DC     B'0111111111111111' ONLY USER TASK MAY ISSUE PC@D61PDOW 06660070
         DC     H'0'                NO SPACE SWITCHING         @D61PDOW 06670070
DSPADDR2 DC     A(LSTKERR)          OVERLAYED AT SVALOAD       @D61PDOW 06680070
         DC     A(DSPALPA2)         ADDR LATENT PARAMETER AREA @D61PDOW 06690070
         DC     H'0'                DON'T MODIFY CR 3          @D61PDOW 06700070
         DC     H'0'                RESERVED                   @D61PDOW 06710070
         DC     B'10010000'         STACKING PC &              @D61PDOW 06720070
***                                 ... ENTRY KEY REPLACES PSW-KEY      06730070
         DC     B'00000000'         ENTRY KEY                  @D61PDOW 06740070
         DC     H'0'                RESERVED                   @D61PDOW 06750070
         DC     A(0)                ASTE = 0 AS NO SPACE SWITCH@D61PDOW 06760070
         DC     2A(0)               RESERVED                   @D64ADMZ 06770070
*                                                                       06780070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         06790070
*                                                             *         06800070
*        LATENT PARAMETER AREAS FOR SYSTEM FUNCTIONS          *         06810070
*                                                             *         06820070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         06830070
*                                                                       06840070
XMLARA00 DS    0F             AREA FOR LXRES                   @D64ADMZ 06850070
         DC    XL4'00'                                         @D64XDMZ 06860070
         DC    A(0)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 06870070
         DC    XL8'00'                                         @D64XDMZ 06880070
*                                                                       06890070
XMLARA01 DS    0F             AREA FOR LXFRE                   @D64ADMZ 06900070
         DC    XL4'00'                                         @D64XDMZ 06910070
         DC    A(1)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 06920070
         DC    XL8'00'                                         @D64XDMZ 06930070
*                                                                       06940070
XMLARA02 DS    0F             AREA FOR ETCRE                   @D64ADMZ 06950070
         DC    XL4'00'                                         @D64XDMZ 06960070
         DC    A(2)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 06970070
         DC    XL8'00'                                         @D64XDMZ 06980070
*                                                                       06990070
XMLARA03 DS    0F             AREA FOR ETDES                   @D64ADMZ 07000070
         DC    XL4'00'                                         @D64XDMZ 07010070
         DC    A(3)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07020070
         DC    XL8'00'                                         @D64XDMZ 07030070
*                                                                       07040070
XMLARA04 DS    0F             AREA FOR ETCON                   @D64ADMZ 07050070
         DC    XL4'00'                                         @D64XDMZ 07060070
         DC    A(4)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07070070
         DC    XL8'00'                                         @D64XDMZ 07080070
*                                                                       07090070
XMLARA05 DS    0F             AREA FOR ETDIS                   @D64ADMZ 07100070
         DC    XL4'00'                                         @D64XDMZ 07110070
         DC    A(5)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07120070
         DC    XL8'00'                                         @D64XDMZ 07130070
*                                                                       07140070
XMLARA06 DS    0F             AREA FOR AXRES                   @D64ADMZ 07150070
         DC    XL4'00'                                         @D64XDMZ 07160070
         DC    A(6)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07170070
         DC    XL8'00'                                         @D64XDMZ 07180070
*                                                                       07190070
XMLARA07 DS    0F             AREA FOR AXFRE                   @D64ADMZ 07200070
         DC    XL4'00'                                         @D64XDMZ 07210070
         DC    A(7)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07220070
         DC    XL8'00'                                         @D64XDMZ 07230070
*                                                                       07240070
XMLARA08 DS    0F             AREA FOR AXEXT                   @D64ADMZ 07250070
         DC    XL4'00'                                         @D64XDMZ 07260070
         DC    A(8)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07270070
         DC    XL8'00'                                         @D64XDMZ 07280070
*                                                                       07290070
XMLARA0A DS    0F             AREA FOR ATSET                   @D64ADMZ 07300070
         DC    XL4'00'                                         @D64XDMZ 07310070
         DC    A(9)               CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07320070
         DC    XL8'00'                                         @D64XDMZ 07330070
*                                                                       07340070
*                                                                       07350070
ALEALPA1 DS    0F             AREA FOR ALESERV ADD             @D64XDMZ 07360070
         DC    X'0000000D'         PC NUMBER                   @D64XDMZ 07370070
         DC    A(10)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07380070
         DC    XL8'00'                                         @D64XDMZ 07390070
*                                                                       07400070
ALEALPA2 DS    0F             AREA FOR ALESERV DELETE          @D64XDMZ 07410070
         DC    X'0000000E'         PC NUMBER                   @D64XDMZ 07420070
         DC    A(11)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07430070
         DC    XL8'00'                                         @D64XDMZ 07440070
*                                                                       07450070
ALEALPA3 DS    0F             AREA FOR ALESERV EXTRACT         @D64XDMZ 07460070
         DC    X'0000000F'         PC NUMBER                   @D64XDMZ 07470070
         DC    A(12)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07480070
         DC    XL8'00'                                         @D64XDMZ 07490070
*                                                                       07500070
ALEALPA4 DS    0F             AREA FOR ALESERV SEARCH          @D64XDMZ 07510070
         DC    X'00000010'         PC NUMBER                   @D64XDMZ 07520070
         DC    A(13)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07530070
         DC    XL8'00'                                         @D64XDMZ 07540070
*                                                                       07550070
STORLPA1 DS    0F             AREA FOR STORAGE OBTAIN          @D64XDMZ 07560070
         DC    A(GMFMENTRY)                                    @D64XDMZ 07570070
         DC    A(14)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07580070
         DC    XL8'00'                                         @D64XDMZ 07590070
*                                                                       07600070
ESTALP0F DS    0F             AREA FOR ESTAEX                  @D64ADMZ 07610070
         DC    XL4'00'                                         @D64XDMZ 07620070
         DC    A(15)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07630070
         DC    XL8'00'                                         @D64XDMZ 07640070
*                                                                       07650070
*                                                                       07660070
STORLPA2 DS    0F             AREA FOR STORAGE RELEASE         @D64XDMZ 07670070
         DC    A(GMFMENTRY)        ENTRY PARAMETER             @D64XDMZ 07680070
         DC    A(16)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07690070
         DC    XL8'00'                                         @D64XDMZ 07700070
*                                                                       07710070
TIMELPA  DS    0F             AREA FOR TIME                    @D64XDMZ 07720070
         DC    A(SVC34)            ENTRY PARAMETER             @D64XDMZ 07730070
         DC    A(17)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07740070
         DC    XL8'00'                                         @D64XDMZ 07750070
*                                                                       07760070
PCMALPA1 DS    0F             AREA FOR MCSOPER                 @D64XDMZ 07770070
         DC    A(SGDOC)            ENTRY PARAMETER             @D64XDMZ 07780070
         DC    A(18)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07790070
         DC    XL8'00'                                         @D64XDMZ 07800070
*                                                                       07810070
PCMALPA2 DS    0F             AREA FOR MCSOPMSG                @D64XDMZ 07820070
         DC    A(SGDOC)            ENTRY PARAMETER             @D64XDMZ 07830070
         DC    A(19)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07840070
         DC    XL8'00'                                         @D64XDMZ 07850070
*                                                                       07860070
DSPALPA1 DS    0F             AREA FOR DSPSERV                 @D64XDMZ 07870070
         DC    X'00000900'         PC NUMBER                   @D64XDMZ 07880070
         DC    A(20)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07890070
         DC    XL8'00'                                         @D64XDMZ 07900070
*                                                                       07910070
DSPALPA2 DS    0F             AREA FOR DSPSERV                 @D64XDMZ 07920070
         DC    X'00000903'         PC NUMBER                   @D64XDMZ 07930070
         DC    A(21)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07940070
         DC    XL8'00'                                         @D64XDMZ 07950070
*                                                                       07960070
DMFALPA  DS    0F             AREA FOR DMF                     @D64XDMZ 07970070
         DC    XL4'00'                                         @D64XDMZ 07980070
         DC    A(22)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 07990070
         DC    XL8'00'                                         @D64XDMZ 08000070
*                                                                       08010070
RELARA00 DS    0F             AREA FOR REXX                    @D64XDMZ 08020070
         DC    XL4'00'                                         @D64XDMZ 08030070
         DC    A(23)              CNTR FOR PERFORMANCE MEASUREM@D64XDMZ 08040070
         DC    XL8'00'                                         @D64XDMZ 08050070
*                                                                       08060070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08070070
*        DUMMY  DUCT AND SYSTEM DUCT                          *         08080070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08090070
         ORG   *+((((*-SYSS00+63)/64)*64)-(*-SYSS00))          @D61CSOW 08100070
SYSDUCT  DC    16X'0',A(SYSALIST+(L'SYSALIST/128-1)),8X'0',A(SYSALIST),X08110070
               32X'0'                                          @D61CSOW 08120070
         ORG   *+((((*-SYSS00+63)/64)*64)-(*-SYSS00))          @D64XDMZ 08130070
DMYDUCT  DC    16X'0',A(DMYALIST+(L'DMYALIST/128-1)),8X'0',A(DMYALIST),X08140070
               32X'0'                                          @D64XDMZ 08150070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08160070
*        DUMMY ACCESS LIST                                    *         08170070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08180070
         ORG   *+((((*-SYSS00+127)/128)*128)-(*-SYSS00))       @D64XDMZ 08190070
DMYALIST DS    0CL128                                          @D64XDMZ 08200070
         DC    16X'80000000000000000000000000000000'           @D64XDMZ 08210070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08220070
*                                                             *         08230070
*        SYSTEM ACCESS LIST                                   *         08240070
*                                                             *         08250070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08260070
.**  NUMBER OF AL ENTRIES MUST BE A MULTIPLE OF 8 AND >= MAX # OF PART  08270070
         ORG   *+((((*-SYSS00+127)/128)*128)-(*-SYSS00))       @D61CSOW 08280070
SYSALIST DS    0CL3456           216*16                        @D61CSOW 08290070
         DC    3X'81000000000000000000000000000000'            @D61CSOW 08300070
&X       SETA  1                 LOOP COUNTER                  @D61PDOW 08310070
.SYSD010 ANOP                                                  @D61PDOW 08320070
         DC    X'8100',AL2(SYSEAX),X'000000000000000000000000' @D61CSOW 08330070
&X       SETA  &X+1             INCREASE LOOP COUNTER          @D61PDOW 08340070
         AIF   (&X LE  213).SYSD010                            @D61PDOW 08350070
*                                                                       08360070
*                                                                       08370070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08380070
*                                                             *         08390070
*        SYSTEM LINKAGE TABLE                                 *         08400070
*                                                             *         08410070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08420070
         ORG   *+((((*-SYSS00+127)/128)*128)-(*-SYSS00)) FORCE @D61PDOW 08430070
SLINKTAB DS    0CL128           ... 128 BYTE BOUNDARY          @D61PDOW 08440070
         DC    A(ENTTAB00+L'ENTTAB00/128-1)                    @D61PDOW 08450070
         DC    X'80000000'      INVALID ENTRY (INDEX 01)       @D61PDOW 08460070
         DC    X'80000000'      INVALID ENTRY (INDEX 02)       @D61PDOW 08470070
         DC    A(ENTTAB03+L'ENTTAB03/128-1)                    @D61ADMZ 08480070
         DC    A(ENTTAB04+L'ENTTAB04/128-1)                    @D61PDOW 08490070
         DC    X'80000000'      INVALID ENTRY (INDEX 05)       @D61PDOW 08500070
         DC    X'80000000'      INVALID ENTRY (INDEX 06)       @D61PDOW 08510070
         DC    X'80000000'      INVALID ENTRY (INDEX 07)       @D61PDOW 08520070
         DC    X'80000000'      INVALID ENTRY (INDEX 08)       @D61PDOW 08530070
         DC    A(ENTTAB09+L'ENTTAB09/128-1)                    @D61PDOW 08540070
         DC    X'80000000'      INVALID ENTRY (INDEX 0A)       @D61PDOW 08550070
         DC    X'80000000'      INVALID ENTRY (INDEX 0B)       @D61PDOW 08560070
         DC    X'80000000'      INVALID ENTRY (INDEX 0C)       @D61PDOW 08570070
         DC    X'80000000'      INVALID ENTRY (INDEX 0D)       @D61PDOW 08580070
         DC    X'80000000'      INVALID ENTRY (INDEX 0E)       @D61PDOW 08590070
         DC    X'80000000'      INVALID ENTRY (INDEX 0F)       @D61PDOW 08600070
         DC    X'80000000'      INVALID ENTRY (INDEX 10)       @D61PDOW 08610070
         DC    X'80000000'      INVALID ENTRY (INDEX 11)       @D61PDOW 08620070
         DC    X'80000000'      INVALID ENTRY (INDEX 12)       @D61PDOW 08630070
         DC    X'80000000'      INVALID ENTRY (INDEX 13)       @D61PDOW 08640070
         DC    X'80000000'      INVALID ENTRY (INDEX 14)       @D61PDOW 08650070
         DC    X'80000000'      INVALID ENTRY (INDEX 15)       @D61PDOW 08660070
         DC    X'80000000'      INVALID ENTRY (INDEX 16)       @D61PDOW 08670070
         DC    X'80000000'      INVALID ENTRY (INDEX 17)       @D61PDOW 08680070
         DC    X'80000000'      INVALID ENTRY (INDEX 18)       @D61PDOW 08690070
         DC    X'80000000'      INVALID ENTRY (INDEX 19)       @D61PDOW 08700070
         DC    X'80000000'      INVALID ENTRY (INDEX 1A)       @D61PDOW 08710070
         DC    X'80000000'      INVALID ENTRY (INDEX 1B)       @D61PDOW 08720070
         DC    X'80000000'      INVALID ENTRY (INDEX 1C)       @D61PDOW 08730070
         DC    X'80000000'      INVALID ENTRY (INDEX 1D)       @D61PDOW 08740070
         DC    X'80000000'      INVALID ENTRY (INDEX 1E)       @D61PDOW 08750070
         DC    X'80000000'      INVALID ENTRY (INDEX 1F)       @D61PDOW 08760070
         AGO   .MEND                                                    08770070
.CODE000 ANOP                                                           08780070
         SPACE 3                                                        08790070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08800070
*                                                             *         08810070
*        SYSTEM TABLE UPDATE ROUTINE                          *         08820070
*              THIS ROUTINE IS CALLED BY FETCH WHENEVER       *         08830070
*              A PHASE IS LOADED INTO SVA.                    *         08840070
.*             ALL ADDR'S IN LSTKTAB HAVE TO POINT BELOW 16MB *         08850070
.*             NO PAGE FAULT ALLOWED IN THIS ROUTINE          *         08860070
*                                                             *         08870070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         08880070
         USING *,RF             ESTABLISH ROUTINE BASE         @D61PDOW 08890070
         USING TCBADR,RA        ESTABLISH ADDRESSABILITY TO TCB@D61PDOW 08900070
LSTKUSVA DS    0H               UPDATE ETE, CVT ETC BECAUSE    @D61PDOW 08910070
***                             ... SVA PHASE IS LOADED OR REPLACED     08920070
*SGLINK  S,INPUT=(R0,R1,R8,RA,RF)                                       08930070
         STM   R3,R4,LSTKSAV    FREE UP WORK REGISTER          @D61PDOW 08940070
         LA    R3,LSTKTAB       GET TABLE ADDR                 @D61PDOW 08950070
LSTKUS10 CLI   0(R3),X'FF'      END OF TABLE                   @D61PDOW 08960070
         BE    LSTKUS90         YES, --->                      @D61PDOW 08970070
         CLC   0(8,R3),DFWKNAME OUR PHASE                      @D61PDOW 08980070
         LA    R3,8(,R3)        GO TO FIRST ADDR               @D61PDOW 08990070
         BNE   LSTKUS60                                        @D61PDOW 09000070
LSTKUS20 TM    0(R3),X'7F'      NEXT PHASE NAME OR END         @D61PDOW 09010070
***                             ... (ADDRESS IS BELOW 16 MB)            09020070
         BNZ   LSTKUS90         YES, UPDATE COMPLETE           @D61PDOW 09030070
         L     R4,0(,R3)        GET ADDR TO PC-ENTRY           @D61PDOW 09040070
         N     R4,LSTKFFFE      MAKE ADDRESS (RESET BIT31)     @D65CDOW 09050070
         ST    R0,0(,R4)        STORE NEW ENTRY TO ETE         @D61PDOW 09060070
         TM    3(R3),X01        PROBLEM STATE REQUIRED         @D65CDOW 09070070
         BNO   LSTKUS30         NO --->                        @D65CDOW 09080070
         OI    3(R4),X01        FORCE PROBLEM STATE IN ETE              09090070
LSTKUS30 DS    0H                                              @D65CDOW 09100070
         USING INLCSDLE,R1                                     @D61PDOW 09110070
         TM    SDLESWT,SDLEAM31 AMODE=31 OR AMODE=ANY          @D61PDOW 09120070
         BZ    LSTKUS40         NO, --->                       @D61PDOW 09130070
         TM    SDLESWT,SDLEAM24 AMODE=ANY                      @D61PDOW 09140070
         DROP  R1                                              @D61PDOW 09150070
         BO    LSTKUS40         YES --->                       @D61PDOW 09160070
         OI    0(R4),X'80'      FORCE 31 BIT MODE              @D61PDOW 09170070
LSTKUS40 DS    0H                                              @D61PDOW 09180070
         LA    R3,4(,R3)        BUMP TO NEXT ADDR              @D61PDOW 09190070
         B     LSTKUS20                                        @D61PDOW 09200070
LSTKUS60 DS    0H                                              @D61PDOW 09210070
         LA    R3,4(,R3)        BUMP TO NEXT ADDR              @D61PDOW 09220070
         TM    0(R3),X'7F'      NEXT PHASE NAME OR END         @D61PDOW 09230070
         BZ    LSTKUS60         NO, SKIP NEXT ADDR             @D61PDOW 09240070
         B     LSTKUS10         YES,                           @D61PDOW 09250070
LSTKUS90 LM    R3,R4,LSTKSAV    RESTORE WORK REGISTER          @D61PDOW 09260070
         BR    R8               RETURN                         @D61PDOW 09270070
         DROP  RA               TCB                            @D61PDOW 09280070
         DROP  RF               RTN BASE                       @D61PDOW 09290070
*                                                                       09300070
LSTKSAV  DC    2A(0)            SAVE AREA                      @D61PDOW 09310070
LSTKFFFE DC    X'FFFFFFFE'                                     @D65CDOW 09320070
*                                                                       09330070
***      FOLLOWING TABLE (USED BY RTN LSTKUSVA) CONSISTS OF A           09340070
***            8-BYTE PHASE NAME                                        09350070
***            ONE OR SEVERAL 4-BYTE ADDRESSES WITH BIT31 ON INDICATING 09360070
***            ...PROBLEM STATE AND BIT31 OFF INDICATING SUPERVISOR     09361070
***            ...STATE REQUIRED IN ROUTINE CALLED WITH PC.             09362070
***            ...THE ADDR POINTS TO THE PC ENTRY ADDR IN THE ETE       09363070
***            ...WHICH HAS TO BE REPLACED BY THE REAL ROUTINE ADDR.    09364070
*                                                                       09365070
LSTKTAB  DC    C'$IJBALE '      PHASE NAME ALESERV             @D61PDOW 09366070
         DC    A(ALEADDR1+0)                                   @D61PDOW 09367070
         DC    A(ALEADDR2+0)                                   @D61PDOW 09368070
         DC    A(ALEADDR3+0)                                   @D61PDOW 09369070
         DC    A(ALEADDR4+0)                                   @D61PDOW 09370070
*                                                                       09380070
         DC    C'$IJBDSP '      PHASE NAME DSPSERV             @D61PDOW 09390070
         DC    A(DSPADDR1+0)                                   @D61PDOW 09400070
         DC    A(DSPADDR2+0)                                   @D61PDOW 09410070
*                                                                       09420070
         DC    C'CSRTABLE'      PHASE NAME WTO                 @D61PDOW 09430070
         DC    A(CVTCSRT+0)                                    @D61PDOW 09440070
*                                                                       09450070
         DC    C'$IJBXLRE'      PHASE NAME LXRES               @D61ADMZ 09460070
         DC    A(XLREADR1+0)                                   @D61ADMZ 09470070
*                                                                       09480070
         DC    C'$IJBXLFR'      PHASE NAME LXFRE               @D61ADMZ 09490070
         DC    A(XLFRADR1+0)                                   @D61ADMZ 09500070
*                                                                       09510070
         DC    C'$IJBXECR'      PHASE NAME ETCRE               @D61ADMZ 09520070
         DC    A(XECRADR1+0)                                   @D61ADMZ 09530070
*                                                                       09540070
         DC    C'$IJBXEDE'      PHASE NAME ETDES               @D61ADMZ 09550070
         DC    A(XEDEADR1+0)                                   @D61ADMZ 09560070
*                                                                       09570070
         DC    C'$IJBXECO'      PHASE NAME ETCON               @D61ADMZ 09580070
         DC    A(XECOADR1+0)                                   @D61ADMZ 09590070
*                                                                       09600070
         DC    C'$IJBXEDI'      PHASE NAME ETDIS               @D61ADMZ 09610070
         DC    A(XEDIADR1+0)                                   @D61ADMZ 09620070
*                                                                       09630070
         DC    C'$IJBXARE'      PHASE NAME AXRES               @D61ADMZ 09640070
         DC    A(XAREADR1+0)                                   @D61ADMZ 09650070
*                                                                       09660070
         DC    C'$IJBXAFR'      PHASE NAME AXFRE               @D61ADMZ 09670070
         DC    A(XAFRADR1+0)                                   @D61ADMZ 09680070
*                                                                       09690070
         DC    C'$IJBXAEX'      PHASE NAME AXEXT               @D61ADMZ 09700070
         DC    A(XAEXADR1+0)                                   @D61ADMZ 09710070
*                                                                       09720070
         DC    C'$IJBXATS'      PHASE NAME ATSET               @D64XDMZ 09730070
         DC    A(XATSADR1+0)                                   @D64XDMZ 09740070
*                                                                       09750070
         DC    C'ARXQPC  '      PHASE NAME REXX SERVICES       @D61NDMZ 09760070
         DC    A(ARXQADR1+0)                                   @D61NDMZ 09770070
*                                                                       09780070
         DC    C'IJBTVAL '      PHASE NAME TOKEN VALID. RTN    @D65ADMZ 09790070
         DC    A(IJBATVAL+0)                                   @D65ADMZ 09800070
*                                                                       09810070
         DC    X'FF'            END INDICATOR                  @D61PDOW 09811070
         SPACE 3                                                        09812070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         09813070
*                                                             *         09814070
*        CANCEL DUE TO INVALID PC NUMBER                      *         09815070
*              THE ENTRY POINT IS CONTAINED IN ALL            *         09816070
*              ETE'S WHERE THE RELATED PC NUMBER              *         09816170
*              IS NOT SUPPORTED                               *         09816270
*                                                             *         09816370
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         09816470
LSTKERR  DS    0H               CANCEL USER WITH INVALID       @D61PDOW 09816570
***                             ... PC NUMBER                  @D61PDOW 09816670
         BASR  R9,0             SET UP BASE                    @D66ODOW 09816770
         USING *,R9             ESTABLISH ADDRESSABILITY       @D61PDOW 09816870
         SAC   0                ENTER PRIMARY MODE             @DY45712 09816970
         L     R6,ADISPSER      ADDR OF DISP SERVICES          @D61PDOW 09817070
         LA    R0,8             SAVE STATUS IN TASK SAVE AREA  @D61PDOW 09818070
*        AMODESW CALL,REGS=(R7,R6)                                      09819070
         BASSM R7,R6            CALL DISPSERV                  @D64ADOW 09820070
***                                                            @D61PDOW 09830070
         L     RA,TCBPTR                                       @D64ADOW 09840070
         USING TCBADR,RA                                       @D64ADOW 09850070
         L     RB,TCBSAVE                                      @D64ADOW 09860070
         USING SVEARA,RB                                       @D64ADOW 09870070
         L     R7,SVEPSW2       GET ADDR BEHIND PC INSTRUCTION @D64ADOW 09880070
         TM    SVEPSWKY,PPBIT   IS CALLER IN PROBLEM STATE     @D64ADOW 09890070
         BZ    LSTKERR5         NO, --->                       @D64ADOW 09900070
         AL    R7,F1            INDICATE PROBLEM STATE         @D64ADOW 09910070
LSTKERR5 DS    0H                                              @D64ADOW 09920070
         ST    R7,SVER0E        SETUP RE                       @D64ADOW 09930070
         XC    SVER0F,SVER0F    SET PROPER RETURN CODE         @D64ADOW 09940070
         DROP  RA                                              @D64ADOW 09950070
         DROP  RB                                              @D64ADOW 09960070
         LA    RB,ERR47E        LOAD CANCEL CODE               @D61PDOW 09970070
         LA    R1,LSTKCCOD      CANCEL INFO (ABEND CODE)       @D61PDOW 09980070
         LA    R0,4             REQ CANCEL SERVICE             @D61PDOW 09990070
*        AMODESW CALL,REGS=(R7,R6) CANCEL USER                          10000070
         BASSM R7,R6                                           @D64ADOW 10010070
         DROP  R9                                              @D61PDOW 10020070
LSTKCCOD DC    A(L'LSTKMSG1)    DEFINE INPUT FOR CANCEL RTN    @D61PDOW 10030070
LSTKMSG1 DC    C'XXXXNUCLEUS'   ABEND INFORAMATION             @D61PDOW 10040070
         ORG   LSTKMSG1         INSERT CORRECT REASON CODE     @D61PDOW 10050070
         DC    A(NUCRSN03)                                     @D64ADOW 10060070
         ORG   ,                                               @D61PDOW 10070070
         SPACE 3                                                        10080070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         10090070
*                                                             *         10100070
*        IGNORE CALL OF SVA PHASES DURING IPL                 *         10110070
*           IF RE IS RETURN ADDR                              *         10120070
*                                                             *         10130070
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         10140070
LSTKRET  DS    0H         HARDWAIT WHEN IJBLSTK NOT AVAILABLE  @D61PDOW 10150070
DSPDRET  DS    0H         CONTINUE WHEN IJBDSPD NOT AVAILABLE  @D67CDOW 10151070
*        AMODESW RETURN,REG=(RE)                                        10160070
         AMODESW RETURN,REG=(RE)                               @D61PDOW 10170070
.MEND    ANOP                                                  @D61PDOW 10180070
         MEND                                                        EM 10190070
