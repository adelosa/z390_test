         MACRO                                                 @V6MVFM0 00050000
&LABEL   APPCVM &FCN,         FUNCTION                                 $00100000
               &ALTID=,       ALTERNATE USERID                         $00150000
               &ANSBUF=,      ANSWER BUFFER                            $00200000
               &ANSLEN=,      LENGTH OF ANSWER BUFFER                  $00250000
               &ANSLIST=,     ANSWER LIST OPTION                       $00300000
               &BUFFER=,      MESSAGE BUFFER                           $00350000
               &BUFLEN=,      LENGTH OF MESSAGE BUFFER                 $00400000
               &BUFLIST=,     BUFFER LIST OPTION                       $00450000
               &CODE=,        ERROR/SEVER CODE                         $00500000
               &CONTROL=,     CONTROL OPTION                           $00550000
               &DIRECT=,      DIRECT OPTION                            $00600000
               &FLUSH=,       FLUSH OPTION                             $00650000
               &FMH5=,        FMH5 OPTION                              $00700000
               &LOGDATA=,     LOG_DATA OPTION                          $00750000
               &MF=,          MACRO FORM OPTION                        $00800000
               &PATHID=,      PATH IDENTIFICATION                      $00850000
               &PRMLIST=,     PARAMETER LIST                           $00900000
               &RECEIVE=,     RECEIVE OPTION OF SEND                   $00950000
               &RETURN=,      RETURN OPTION                            $01000000
               &RESID=,       RESOURCE ID                              $01050000
               &SYNCLVL=,     SYNCHRONIZATION LEVEL                    $01100000
               &TYPE=,        TYPE OPTION                              $01150000
               &WAIT=         WAIT OPTION                      @V6MVFM0 01200000
         LCLA  &IUCVERR                                        @V6MVFM0 01250000
         LCLC  &MAP,&FCODE                                     @V6MVFM0 01300000
         LCLC  &BITS1,&BITS1F,&BITS2,&BITS2F                   @V6MVFM0 01350000
         LCLC  &SNDCODE                                        @V6MVFM0 01400000
         LCLC  &IPBUF,&IPLEN                                   @V6MVFM0 01450000
.**************************************************************         01500000
.*                                                            *         01550000
.*       IBM DISK OPERATING SYSTEM                            *         01600000
.*       SUPERVISOR - APPCVM                                  *         01650000
         AGO  .ZZZ                                            *         01700000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"          *         01750000
*        5686-007 (C) COPYRIGHT IBM CORP. 1989                *         01800000
*        ALL RIGHTS RESERVED                                  *         01850000
*        LICENSED MATERIALS-PROPERTY OF IBM                   *         01900000
.*       SEE COPYRIGHT INSTRUCTIONS, G120-2083                *         01950000
.ZZZ     ANOP                                                 *         02000000
.* A000000-999999                                             *@D31BDUL 02050000
.* CODE COPIED FROM VM/SP FOR APPCVM SUPPORT - LEVEL VM/SP 6  *@D31BDUL 02100000
.*                                                            *         02150000
.**************************************************************         02200000
.*** START OF SPECIFICATIONS **********************************         02250000
.*                                                            *         02300000
.*01* MODULE-TYPE = PROGRAM INTERFACE MACRO                   *         02350000
.*                                                            *         02400000
.*01* DESCRIPTIVE NAME = APPC/VM SERVICE REQUEST MACRO        *         02450000
.*                                                            *         02500000
.*** END OF SPECIFICATIONS ************************************         02550000
.*.6******************************************************************* 02600000
.*                                                                      02650000
.* MACRO NAME -           *----------------*                            02700000
.*                        *     APPCVM     *                            02750000
.*                        *----------------*                            02800000
.*                                                                      02850000
.* COPYRIGHT -                                                          02900000
.*                                                                      02950000
.*       "CONTAINS    RESTRICTED   MATERIALS   OF   IBM"                03000000
.*       (C) COPYRIGHT  IBM  CORPORATION            1986                03050000
.*       LICENSED MATERIAL  -  PROGRAM PROPERTY OF I B M                03100000
.*       REFER TO COPYRIGHT INSTRUCTIONS: FORM G120-2083                03150000
.*                                                                      03200000
.* STATUS -                                                             03250000
.*                                                                      03300000
.*       VM/SYSTEM PRODUCT - 5664-167                                   03350000
.*                                                                      03400000
.* FUNCTION -                                                           03450000
.*                                                                      03500000
.*       THE APPCVM MACRO INITIALIZES THE PARAMETER LIST AND PROVIDES   03550000
.*       LINKAGE FOR THE APPC/VM FUNCTIONS.                             03600000
.*                                                                      03650000
.* SYNTAX OF THE MACRO -                                                03700000
.*                                                                      03750000
.*       APPCVM    CONNECT,                                             03800000
.*                 &PRMLIST=LABEL/(REG),        REQUIRED                03850000
.*                 &MF=L,                       OPTIONAL                03900000
.*                 &CONTROL=YES/NO,             OPTIONAL                03950000
.*                 &RESID=LABEL/(REG),          OPTIONAL                04000000
.*                 &SYNCLVL=NONE/CONFIRM,       OPTIONAL                04050000
.*                 &TYPE=BASIC/MAPPED,          OPTIONAL                04100000
.*                 &FMH5=YES/NO,                OPTIONAL                04150000
.*                 &WAIT=YES/NO,                OPTIONAL                04200000
.*                 &ALTID=LABEL/(REG),          OPTIONAL                04250000
.*                 &BUFFER=LABEL/(REG),         OPTIONAL                04300000
.*                 &BUFLEN=LABEL/(REG),         OPTIONAL                04350000
.*                 &RETURN=ALLOCD/IMMED,        OPTIONAL                04400000
.*                 &LOGDATA=YES/NO              OPTIONAL                04450000
.*                                                                      04500000
.*       APPCVM    RECEIVE,                                             04550000
.*                 &PRMLIST=LABEL/(REG),        REQUIRED                04600000
.*                 &MF=L,                       OPTIONAL                04650000
.*                 &PATHID=LABEL/(REG),         OPTIONAL                04700000
.*                 &BUFFER=LABEL/(REG),         OPTIONAL                04750000
.*                 &BUFLEN=LABEL/(REG),         OPTIONAL                04800000
.*                 &BUFLIST=YES/NO,             OPTIONAL                04850000
.*                 &WAIT=YES/NO                 OPTIONAL                04900000
.*                                                                      04950000
.*       APPCVM    SENDCNF,                                             05000000
.*                 &PRMLIST=LABEL/(REG),        REQUIRED                05050000
.*                 &MF=L,                       OPTIONAL                05100000
.*                 &PATHID=LABEL/(REG),         OPTIONAL                05150000
.*                 &TYPE=NORMAL/SEVER/PREPRECV  REQUIRED                05200000
.*                 &WAIT=YES/NO                 OPTIONAL                05250000
.*                                                                      05300000
.*       APPCVM    SENDCNFD,                                            05350000
.*                 &PRMLIST=LABEL/(REG),        REQUIRED                05400000
.*                 &MF=L,                       OPTIONAL                05450000
.*                 &PATHID=LABEL/(REG)          OPTIONAL                05500000
.*                                                                      05550000
.*       APPCVM    SENDDATA,                                            05600000
.*                 &PRMLIST=LABEL/(REG),        REQUIRED                05650000
.*                 &MF=L,                       OPTIONAL                05700000
.*                 &PATHID=LABEL/(REG),         OPTIONAL                05750000
.*                 &RECEIVE=YES/NO,             REQUIRED                05800000
.*                 &ANSBUF=LABEL/(REG),         OPTIONAL                05850000
.*                 &ANSLEN=LABEL/(REG),         OPTIONAL                05900000
.*                 &ANSLIST=YES/NO,             OPTIONAL                05950000
.*                 &BUFFER=LABEL/(REG),         OPTIONAL                06000000
.*                 &BUFLEN=LABEL/(REG),         OPTIONAL                06050000
.*                 &BUFLIST=YES/NO,             OPTIONAL                06100000
.*                 &WAIT=YES/NO,                OPTIONAL                06150000
.*                 &FLUSH=YES/NO                OPTIONAL                06200000
.*                                                                      06250000
.*       APPCVM    SENDERR,                                             06300000
.*                 &PRMLIST=LABEL/(REG),        REQUIRED                06350000
.*                 &MF=L,                       OPTIONAL                06400000
.*                 &PATHID=LABEL/(REG),         OPTIONAL                06450000
.*                 &TYPE=PROG/SVC,              OPTIONAL                06500000
.*                 &CODE=LABEL/(REG),           OPTIONAL                06550000
.*                 &WAIT=YES/NO,                OPTIONAL                06600000
.*                 &BUFLIST=YES/NO,             OPTIONAL                06650000
.*                 &BUFFER=LABEL/(REG),         OPTIONAL                06700000
.*                 &BUFLEN=LABEL/(REG)          OPTIONAL                06750000
.*                 &DIRECT=SEND/RECEIVE         OPTIONAL                06800000
.*                                                                      06850000
.*       APPCVM    SENDREQ,                                             06900000
.*                 &PRMLIST=LABEL/(REG),        REQUIRED                06950000
.*                 &MF=L,                       OPTIONAL                07000000
.*                 &PATHID=LABEL/(REG)          OPTIONAL                07050000
.*                                                                      07100000
.*       APPCVM    SEVER,                                               07150000
.*                 &PRMLIST=LABEL/(REG),        REQUIRED                07200000
.*                 &MF=L,                       OPTIONAL                07250000
.*                 &PATHID=LABEL/(REG),         OPTIONAL                07300000
.*                 &TYPE=NORMAL/ABEND,          REQUIRED                07350000
.*                 &CODE=LABEL/(REG),           OPTIONAL                07400000
.*                 &WAIT=YES/NO,                OPTIONAL                07450000
.*                 &BUFLIST=YES/NO,             OPTIONAL                07500000
.*                 &BUFFER=LABEL/(REG),         OPTIONAL                07550000
.*                 &BUFLEN=LABEL/(REG)          OPTIONAL                07600000
.*                                                                      07650000
.* NOTES -                                                              07700000
.*                                                                      07750000
.*       MNOTES -                                                       07800000
.*                                                                      07850000
.*       MNOTE 8,'TOO MANY POSITIONAL PARMS SPECIFIED'                  07900000
.*       MNOTE 8,'&FCN IS NOT A VALID FUNCTION'                         07950000
.*       MNOTE 8,'FUNCTION NOT SPECIFIED'                               08000000
.*       MNOTE 8,'XXXXX= IS NOT ALLOWED ON THE &FCN FUNCTION'           08050000
.*       MNOTE 8,'XXXXX=YYYYY IS INVALID'                               08100000
.*       MNOTE 8,'XXXXX=YYYYY IS INVALID ON THE &FCN FUNCTION'          08150000
.*       MNOTE 8,'XXXXX=YYYYY IS REQUIRED ON THE &FCN FUNCTION'         08200000
.*       MNOTE 8,'XXXXX= IS INVALID WITH RECEIVE=NO'                    08250000
.*       MNOTE 8,'CODE= IS INVALID ON SEVER TYPE=NORMAL'                08300000
.*       MNOTE 8,'XXXXX= AND YYYYY= ARE CONFLICTING PARAMETERS'         08350000
.*       MNOTE 8,'XXXX=UUUU AND YYYY=ZZZ ARE CONFLICTING PARAMETERS'    08400000
.*                                                                      08450000
.* OPERATION -                                                          08500000
.*                                                                      08550000
.*       1. CHECK POSITIONAL PARAMETERS                                 08600000
.*       2. VERIFY THE REQUESTED FUNCTION AND SET THE FUNCTION MAP      08650000
.*       3. VALIDATE THE OPTIONS SPECIFIED                              08700000
.*       4. IF INVALID OPTIONS WERE FOUND, THEN EXIT                    08750000
.*       5. GENERATE THE CODE TO FILL IN THE PARAMETER LIST             08800000
.*       6. IF THE MACRO FORM IS LIST ONLY, THEN EXIT                   08850000
.*       7. GENERATE THE LINKAGE TO PERFORM THE IUCV FUNCTION           08900000
.*                                                                      08950000
.* CHANGE ACTIVITY -                                                    09000000
.*                                                                      09050000
.*       THE S&D CODE OF EACH ADDED/CHANGED LINE WILL BE UPDATED TO     09100000
.*       REFLECT SERVICE AND NEW DEVELOPMENT IN THIS MODULE.            09150000
.*                                                                      09200000
.*.$******************************************************************* 09250000
.*                                                                      09300000
.*                                                                      09350000
.*--------------------------------------------------------------------- 09400000
.*       CHECK POSITIONAL PARAMETERS                                    09450000
.*--------------------------------------------------------------------- 09500000
.*                                                                      09550000
         AIF   (N'&SYSLIST LE 1).CHKOMIT                       @V6MVFM0 09600000
         MNOTE 8,'TOO MANY POSITIONAL PARMS SPECIFIED'         @V6MVFM0 09650000
&IUCVERR SETA  1                                               @V6MVFM0 09700000
.CHKOMIT ANOP                                                  @V6MVFM0 09750000
         AIF   (T'&FCN NE 'O').FCNOK                           @V6MVFM0 09800000
         MNOTE 8,'FUNCTION NOT SPECIFIED'                      @V6MVFM0 09850000
         MEXIT                                                 @V6MVFM0 09900000
.*                                                                      09950000
.*--------------------------------------------------------------------- 10000000
.*       VERIFY THE REQUESTED FUNCTION AND SET THE FUNCTION MAP         10050000
.*--------------------------------------------------------------------- 10100000
.*                                                                      10150000
.* NOTE:                                                                10200000
.*       THE MAPPING VARIABLE GENERATED IN THE FOLLOWING SECTION        10250000
.*       CONTAINS THE FUNCTION CODE OF THE IUCV FUNCTION REQUESTED      10300000
.*       AND A MAP OF THE ARGUMENTS REQUIRED AND ALLOWED FOR THIS       10350000
.*       FUNCTION.  THE FUNCTION CODE IS CARRIED AS POSITIONS 1         10400000
.*       AND 2.  THE VALUE OF THE REMAINING POSITIONS INDICATE          10450000
.*       WHETHER OR NOT THE CORRESPONDING PARAMETER IS                  10500000
.*                  NOT ALLOWED  =  0                                   10550000
.*                  REQUIRED     =  1                                   10600000
.*                  OPTIONAL     =  2                                   10650000
.*                                                                      10700000
.*              PARAMETER       POSITION                                10750000
.*                                                                      10800000
.*              ALTID=              3                                   10850000
.*              ANSBUF=             4                                   10900000
.*              ANSLEN=             5                                   10950000
.*              ANSLIST=            6                                   11000000
.*              BUFFER=             7                                   11050000
.*              BUFLEN=             8                                   11100000
.*              BUFLIST=            9                                   11150000
.*              CODE=              10                                   11200000
.*              RESERVED           11                                   11250000
.*              CONTROL=           12                                   11300000
.*              RESERVED           13                                   11350000
.*              MF=                14                                   11400000
.*              PATHID=            15                                   11450000
.*              PRMLIST=           16                                   11500000
.*              RECEIVE=           17                                   11550000
.*              RESID=             18                                   11600000
.*              SYNCLVL=           19                                   11650000
.*              TYPE=              20                                   11700000
.*              WAIT=              21                                   11750000
.*              FMH5=              22                                   11800000
.*              FLUSH=             23                                   11850000
.*              RETURN=            24                                   11900000
.*              LOGDATA=           25                                   11950000
.*              DIRECT=            26                                   12000000
.*                                                                      12050000
.FCNOK   ANOP                                                  @V6MVFM0 12100000
         AIF   ('&FCN' NE 'SENDCNF').NOT04A                    @V6MVFM0 12150000
&MAP     SETC  '04000000000002210001200000'                    @V6RCGGS 12200000
         AGO   .CKALTID                                        @V6MVFM0 12250000
.NOT04A  ANOP                                                  @V6MVFM0 12300000
         AIF   ('&FCN' NE 'SENDCNFD').NOT04B                   @V6MVFM0 12350000
&MAP     SETC  '04000000000002210000000000'                    @V6RCGGS 12400000
         AGO   .CKALTID                                        @V6MVFM0 12450000
.NOT04B  ANOP                                                  @V6MVFM0 12500000
         AIF   ('&FCN' NE 'SENDDATA').NOT04C                   @V6MVFM0 12550000
&MAP     SETC  '04022222200002211000202000'                    @V6RCGGS 12600000
         AGO   .CKALTID                                        @V6MVFM0 12650000
.NOT04C  ANOP                                                  @V6MVFM0 12700000
         AIF   ('&FCN' NE 'SENDERR').NOT04D                    @V6MVFM0 12750000
&MAP     SETC  '04000022220002210002200002'                    @V6RCGGS 12800000
         AGO   .CKALTID                                        @V6MVFM0 12850000
.NOT04D  ANOP                                                  @V6MVFM0 12900000
         AIF   ('&FCN' NE 'SENDREQ').NOT04E                    @V6MVFM0 12950000
&MAP     SETC  '04000000000002210000000000'                    @V6RCGGS 13000000
         AGO   .CKALTID                                        @V6MVFM0 13050000
.NOT04E  ANOP                                                  @V6MVFM0 13100000
         AIF   ('&FCN' NE 'RECEIVE').NOT05                     @V6MVFM0 13150000
&MAP     SETC  '05000022200002210000200000'                    @V6RCGGS 13200000
         AGO   .CKALTID                                        @V6MVFM0 13250000
.NOT05   ANOP                                                  @V6MVFM0 13300000
         AIF   ('&FCN' NE 'CONNECT').NOT11                     @V6MVFM0 13350000
&MAP     SETC  '11200022000202010222220220'                    @V6RCGGS 13400000
         AGO   .CKALTID                                        @V6MVFM0 13450000
.NOT11   ANOP                                                  @V6MVFM0 13500000
         AIF   ('&FCN' NE 'SEVER').NOT15                       @V6MVFM0 13550000
&MAP     SETC  '15000022220002210001200000'                    @V6RCGGS 13600000
         AGO   .CKALTID                                        @V6MVFM0 13650000
.NOT15   ANOP                                                  @V6MVFM0 13700000
         MNOTE 8,'&FCN IS NOT A VALID FUNCTION'                @V6MVFM0 13750000
         MEXIT                                                 @V6MVFM0 13800000
.*                                                                      13850000
.*--------------------------------------------------------------------- 13900000
.*       VALIDATE THE ALTID PARAMETER                                   13950000
.*--------------------------------------------------------------------- 14000000
.*                                                                      14050000
.CKALTID ANOP                                                  @V6MVFM0 14100000
         AIF   (T'&ALTID EQ 'O').ENDALTI                       @V6MVFM0 14150000
         AIF   ('&MAP'(3,1) NE '0').ENDALTI                    @V6MVFM0 14200000
         MNOTE 8,'ALTID= IS NOT ALLOWED ON THE &FCN FUNCTION'  @V6MVFM0 14250000
&IUCVERR SETA  1                                               @V6MVFM0 14300000
.ENDALTI ANOP                                                  @V6MVFM0 14350000
.*                                                                      14400000
.*--------------------------------------------------------------------- 14450000
.*       VALIDATE THE ANSWER BUFFER PARAMETER                           14500000
.*--------------------------------------------------------------------- 14550000
.*                                                                      14600000
         AIF   (T'&ANSBUF EQ 'O').ENDANSB                      @V6MVFM0 14650000
         AIF   ('&MAP'(4,1) NE '0').ENDANSB                    @V6MVFM0 14700000
         MNOTE 8,'ANSBUF= IS NOT ALLOWED ON THE &FCN FUNCTION' @V6MVFM0 14750000
&IUCVERR SETA  1                                               @V6MVFM0 14800000
.ENDANSB ANOP                                                  @V6MVFM0 14850000
.*                                                                      14900000
.*--------------------------------------------------------------------- 14950000
.*       VALIDATE THE ANSWER LENGTH PARAMETER                           15000000
.*--------------------------------------------------------------------- 15050000
.*                                                                      15100000
         AIF   (T'&ANSLEN EQ 'O').ENDANSL                      @V6MVFM0 15150000
         AIF   ('&MAP'(5,1) NE '0').ENDANSL                    @V6MVFM0 15200000
         MNOTE 8,'ANSLEN= IS NOT ALLOWED ON THE &FCN FUNCTION' @V6MVFM0 15250000
&IUCVERR SETA  1                                               @V6MVFM0 15300000
.ENDANSL ANOP                                                  @V6MVFM0 15350000
.*                                                                      15400000
.*--------------------------------------------------------------------- 15450000
.*       VALIDATE THE ANSWER LIST OPTION                                15500000
.*--------------------------------------------------------------------- 15550000
.*                                                                      15600000
         AIF   (T'&ANSLIST EQ 'O').ENDALST                     @V6MVFM0 15650000
         AIF   ('&MAP'(6,1) NE '0').CHKALST                    @V6MVFM0 15700000
         MNOTE 8,'ANSLIST= IS NOT ALLOWED ON THE &FCN FUNCTION'        $15750000
                                                               @V6MVFM0 15800000
&IUCVERR SETA  1                                               @V6MVFM0 15850000
         AGO   .ENDALST                                        @V6MVFM0 15900000
.CHKALST ANOP                                                  @V6MVFM0 15950000
         AIF   ('&ANSLIST' EQ 'YES').ENDALST                   @V6MVFM0 16000000
         AIF   ('&ANSLIST' EQ 'NO').ENDALST                    @V6MVFM0 16050000
         MNOTE 8,'ANSLIST=&ANSLIST IS INVALID'                 @V6MVFM0 16100000
&IUCVERR SETA  1                                               @V6MVFM0 16150000
.ENDALST ANOP                                                  @V6MVFM0 16200000
.*                                                                      16250000
.*--------------------------------------------------------------------- 16300000
.*       VALIDATE THE BUFFER PARAMETER                                  16350000
.*--------------------------------------------------------------------- 16400000
.*                                                                      16450000
         AIF   (T'&BUFFER EQ 'O').ENDBUFA                      @V6MVFM0 16500000
         AIF   ('&MAP'(7,1) NE '0').ENDBUFA                    @V6MVFM0 16550000
         MNOTE 8,'BUFFER= IS NOT ALLOWED ON THE &FCN FUNCTION' @V6MVFM0 16600000
&IUCVERR SETA  1                                               @V6MVFM0 16650000
.ENDBUFA ANOP                                                  @V6MVFM0 16700000
.*                                                                      16750000
.*--------------------------------------------------------------------- 16800000
.*       VALIDATE THE BUFFER LENGTH PARAMETER                           16850000
.*--------------------------------------------------------------------- 16900000
.*                                                                      16950000
         AIF   (T'&BUFLEN EQ 'O').ENDBUFL                      @V6MVFM0 17000000
         AIF   ('&MAP'(8,1) NE '0').ENDBUFL                    @V6MVFM0 17050000
         MNOTE 8,'BUFLEN= IS NOT ALLOWED ON THE &FCN FUNCTION' @V6MVFM0 17100000
&IUCVERR SETA  1                                               @V6MVFM0 17150000
.ENDBUFL ANOP                                                  @V6MVFM0 17200000
.*                                                                      17250000
.*--------------------------------------------------------------------- 17300000
.*       VALIDATE THE BUFFER LIST OPTION                                17350000
.*--------------------------------------------------------------------- 17400000
.*                                                                      17450000
         AIF   (T'&BUFLIST EQ 'O').ENDBLST                     @V6MVFM0 17500000
         AIF   ('&MAP'(9,1) NE '0').CHKBLST                    @V6MVFM0 17550000
         MNOTE 8,'BUFLIST= IS NOT ALLOWED ON THE &FCN FUNCTION'        $17600000
                                                               @V6MVFM0 17650000
&IUCVERR SETA  1                                               @V6MVFM0 17700000
         AGO   .ENDBLST                                        @V6MVFM0 17750000
.CHKBLST ANOP                                                  @V6MVFM0 17800000
         AIF   ('&BUFLIST' EQ 'YES').ENDBLST                   @V6MVFM0 17850000
         AIF   ('&BUFLIST' EQ 'NO').ENDBLST                    @V6MVFM0 17900000
         MNOTE 8,'BUFLIST=&BUFLIST IS INVALID'                 @V6MVFM0 17950000
&IUCVERR SETA  1                                               @V6MVFM0 18000000
.ENDBLST ANOP                                                  @V6MVFM0 18050000
.*                                                                      18100000
.*--------------------------------------------------------------------- 18150000
.*       VALIDATE THE CODE PARAMETER                                    18200000
.*--------------------------------------------------------------------- 18250000
.*                                                                      18300000
         AIF   (T'&CODE EQ 'O').ENDCODE                        @V6MVFM0 18350000
         AIF   ('&MAP'(10,1) NE '0').ENDCODE                   @V6MVFM0 18400000
         MNOTE 8,'CODE= IS NOT ALLOWED ON THE &FCN FUNCTION'   @V6MVFM0 18450000
&IUCVERR SETA  1                                               @V6MVFM0 18500000
.ENDCODE ANOP                                                  @V6MVFM0 18550000
.*                                                                      18600000
.*--------------------------------------------------------------------- 18650000
.*       VALIDATE THE CONTROL OPTION                                    18700000
.*--------------------------------------------------------------------- 18750000
.*                                                                      18800000
         AIF   (T'&CONTROL EQ 'O').ENDCNTR                     @V6MVFM0 18850000
         AIF   ('&MAP'(12,1) NE '0').CHKCNTR                   @V6MVFM0 18900000
         MNOTE 8,'CONTROL= IS NOT ALLOWED ON THE &FCN FUNCTION'        $18950000
                                                               @V6MVFM0 19000000
&IUCVERR SETA  1                                               @V6MVFM0 19050000
         AGO   .ENDCNTR                                        @V6MVFM0 19100000
.CHKCNTR ANOP                                                  @V6MVFM0 19150000
         AIF   ('&CONTROL' EQ 'YES').ENDCNTR                   @V6MVFM0 19200000
         AIF   ('&CONTROL' EQ 'NO').ENDCNTR                    @V6MVFM0 19250000
         MNOTE 8,'CONTROL=&CONTROL IS INVALID'                 @V6MVFM0 19300000
&IUCVERR SETA  1                                               @V6MVFM0 19350000
.ENDCNTR ANOP                                                  @V6MVFM0 19400000
.*                                                                      19450000
.*--------------------------------------------------------------------- 19500000
.*       VALIDATE THE MACRO FORM OPTION                                 19550000
.*--------------------------------------------------------------------- 19600000
.*                                                                      19650000
         AIF   (T'&MF EQ 'O').ENDMF                            @V6MVFM0 19700000
         AIF   ('&MAP'(14,1) NE '0').CHKMF                     @V6MVFM0 19750000
         MNOTE 8,'MF= IS NOT ALLOWED ON THE &FCN FUNCTION'     @V6MVFM0 19800000
&IUCVERR SETA  1                                               @V6MVFM0 19850000
         AGO   .ENDMF                                          @V6MVFM0 19900000
.CHKMF   ANOP                                                  @V6MVFM0 19950000
         AIF   ('&MF' EQ 'L').ENDMF                            @V6MVFM0 20000000
         MNOTE 8,'MF=&MF IS INVALID'                           @V6MVFM0 20050000
&IUCVERR SETA  1                                               @V6MVFM0 20100000
.ENDMF   ANOP                                                  @V6MVFM0 20150000
.*                                                                      20200000
.*--------------------------------------------------------------------- 20250000
.*       VALIDATE THE PATHID PARAMETER                                  20300000
.*--------------------------------------------------------------------- 20350000
.*                                                                      20400000
         AIF   (T'&PATHID EQ 'O').ENDPATH                      @V6MVFM0 20450000
         AIF   ('&MAP'(15,1) NE '0').ENDPATH                   @V6MVFM0 20500000
         MNOTE 8,'PATHID= IS NOT ALLOWED ON THE &FCN FUNCTION' @V6MVFM0 20550000
&IUCVERR SETA  1                                               @V6MVFM0 20600000
.ENDPATH ANOP                                                  @V6MVFM0 20650000
.*                                                                      20700000
.*--------------------------------------------------------------------- 20750000
.*       VALIDATE THE PARAMETER LIST PARAMETER                          20800000
.*--------------------------------------------------------------------- 20850000
.*                                                                      20900000
         AIF   (T'&PRMLIST EQ 'O').REQPLST                     @V6MVFM0 20950000
         AIF   ('&MAP'(16,1) NE '0').ENDPLST                   @V6MVFM0 21000000
         MNOTE 8,'PRMLIST= IS NOT ALLOWED ON THE &FCN FUNCTION'        $21050000
                                                               @V6MVFM0 21100000
&IUCVERR SETA  1                                               @V6MVFM0 21150000
         AGO   .ENDPLST                                        @V6MVFM0 21200000
.REQPLST ANOP                                                  @V6MVFM0 21250000
         AIF   ('&MAP'(16,1) NE '1').ENDPLST                   @V6MVFM0 21300000
         MNOTE 8,'PRMLIST= IS REQUIRED ON THE &FCN FUNCTION'   @V6MVFM0 21350000
&IUCVERR SETA  1                                               @V6MVFM0 21400000
.ENDPLST ANOP                                                  @V6MVFM0 21450000
.*                                                                      21500000
.*--------------------------------------------------------------------- 21550000
.*       VALIDATE THE RECEIVE OPTION                                    21600000
.*--------------------------------------------------------------------- 21650000
.*                                                                      21700000
         AIF   (T'&RECEIVE EQ 'O').CKRECV                      @V6MVFM0 21750000
         AIF   ('&MAP'(17,1) NE '0').CHKRECV                   @V6MVFM0 21800000
         MNOTE 8,'RECEIVE= IS NOT ALLOWED ON THE &FCN FUNCTION'        $21850000
                                                               @V6MVFM0 21900000
&IUCVERR SETA  1                                               @V6MVFM0 21950000
         AGO   .ENDRECV                                        @V6MVFM0 22000000
.CHKRECV ANOP                                                  @V6MVFM0 22050000
         AIF   ('&RECEIVE' EQ 'YES').ENDRECV                   @V6MVFM0 22100000
         AIF   ('&RECEIVE' EQ 'NO').ENDRECV                    @V6MVFM0 22150000
         MNOTE 8,'RECEIVE=&RECEIVE IS INVALID'                 @V6MVFM0 22200000
&IUCVERR SETA  1                                               @V6MVFM0 22250000
         AGO   .ENDRECV                                        @V6MVFM0 22300000
.CKRECV  ANOP                                                  @V6MVFM0 22350000
         AIF   ('&MAP'(17,1) NE '1').ENDRECV                   @V6MVFM0 22400000
         MNOTE 8,'RECEIVE= IS REQUIRED ON THE &FCN FUNCTION'   @V6MVFM0 22450000
&IUCVERR SETA  1                                               @V6MVFM0 22500000
.ENDRECV ANOP                                                  @V6MVFM0 22550000
.*                                                                      22600000
.*--------------------------------------------------------------------- 22650000
.*       VALIDATE THE RESID PARAMETER                                   22700000
.*--------------------------------------------------------------------- 22750000
.*                                                                      22800000
         AIF   (T'&RESID EQ 'O').ENDRESI                       @V6MVFM0 22850000
         AIF   ('&MAP'(18,1) NE '0').ENDRESI                   @V6MVFM0 22900000
         MNOTE 8,'RESID= IS NOT ALLOWED ON THE &FCN FUNCTION'  @V6MVFM0 22950000
&IUCVERR SETA  1                                               @V6MVFM0 23000000
.ENDRESI ANOP                                                  @V6MVFM0 23050000
.*                                                                      23100000
.*--------------------------------------------------------------------- 23150000
.*       VALIDATE THE SYNCLVL OPTION                                    23200000
.*--------------------------------------------------------------------- 23250000
.*                                                                      23300000
         AIF   (T'&SYNCLVL EQ 'O').ENDSYNC                     @V6MVFM0 23350000
         AIF   ('&MAP'(19,1) NE '0').CHKSYNC                   @V6MVFM0 23400000
         MNOTE 8,'SYNCLVL= IS NOT ALLOWED ON THE &FCN FUNCTION'        $23450000
                                                               @V6MVFM0 23500000
&IUCVERR SETA  1                                               @V6MVFM0 23550000
         AGO   .ENDSYNC                                        @V6MVFM0 23600000
.CHKSYNC ANOP                                                  @V6MVFM0 23650000
         AIF   ('&SYNCLVL' EQ 'NONE').ENDSYNC                  @V6MVFM0 23700000
         AIF   ('&SYNCLVL' EQ 'CONFIRM').ENDSYNC               @V6MVFM0 23750000
         MNOTE 8,'SYNCLVL=&SYNCLVL IS INVALID'                 @V6MVFM0 23800000
&IUCVERR SETA  1                                               @V6MVFM0 23850000
.ENDSYNC ANOP                                                  @V6MVFM0 23900000
.*                                                                      23950000
.*--------------------------------------------------------------------- 24000000
.*       VALIDATE THE TYPE OPTIONS                                      24050000
.*--------------------------------------------------------------------- 24100000
.*                                                                      24150000
         AIF   (T'&TYPE EQ 'O').CHKTYPE                        @V6MVFM0 24200000
         AIF   ('&MAP'(20,1) NE '0').CNFTYPE                   @V6MVFM0 24250000
         MNOTE 8,'TYPE= IS NOT ALLOWED ON THE &FCN FUNCTION'   @V6MVFM0 24300000
&IUCVERR SETA  1                                               @V6MVFM0 24350000
         AGO   .ENDTYPE                                        @V6MVFM0 24400000
.CNFTYPE ANOP                                                  @V6MVFM0 24450000
         AIF   ('&FCN' NE 'SENDCNF').SEVTYPE                   @V6MVFM0 24500000
         AIF   ('&TYPE' EQ 'NORMAL').ENDTYPE                   @V6MVFM0 24550000
         AIF   ('&TYPE' EQ 'SEVER').ENDTYPE                    @V6MVFM0 24600000
         AIF   ('&TYPE' EQ 'PREPRECV').ENDTYPE                 @V6RCGET 24650000
         MNOTE 8,'TYPE=&TYPE IS INVALID ON THE &FCN FUNCTION'  @V6MVFM0 24700000
&IUCVERR SETA  1                                               @V6MVFM0 24750000
         AGO   .ENDTYPE                                        @V6MVFM0 24800000
.SEVTYPE ANOP                                                  @V6MVFM0 24850000
         AIF   ('&FCN' NE 'SEVER').CONTYPE                     @V6RCGET 24900000
         AIF   ('&TYPE' EQ 'NORMAL').ENDTYPE                   @V6MVFM0 24950000
         AIF   ('&TYPE' EQ 'ABEND').ENDTYPE                    @V6MVFM0 25000000
         MNOTE 8,'TYPE=&TYPE IS INVALID ON THE &FCN FUNCTION'  @V6MVFM0 25050000
&IUCVERR SETA  1                                               @V6MVFM0 25100000
         AGO   .ENDTYPE                                        @V6MVFM0 25150000
.CONTYPE ANOP                                                  @V6RCGET 25200000
         AIF   ('&FCN' NE 'CONNECT').ERRTYPE                   @V6RCGET 25250000
         AIF   ('&TYPE' EQ 'BASIC').ENDTYPE                    @V6RCGET 25300000
         AIF   ('&TYPE' EQ 'MAPPED').ENDTYPE                   @V6RCGET 25350000
         MNOTE 8,'TYPE=&TYPE IS INVALID ON THE &FCN FUNCTION'  @V6RCGET 25400000
&IUCVERR SETA  1                                               @V6RCGET 25450000
         AGO   .ENDTYPE                                        @V6RCGET 25500000
.ERRTYPE ANOP                                                  @V6RCGET 25550000
         AIF   ('&TYPE' EQ 'PROG').ENDTYPE                     @V6RCGET 25600000
         AIF   ('&TYPE' EQ 'SVC').ENDTYPE                      @V6RCGET 25650000
         MNOTE 8,'TYPE=&TYPE IS INVALID ON THE &FCN FUNCTION'  @V6RCGET 25700000
&IUCVERR SETA  1                                               @V6RCGET 25750000
         AGO   .ENDTYPE                                        @V6RCGET 25800000
.CHKTYPE ANOP                                                  @V6MVFM0 25850000
         AIF   ('&MAP'(20,1) NE '1').ENDTYPE                   @V6MVFM0 25900000
         MNOTE 8,'TYPE= IS REQUIRED ON THE &FCN FUNCTION'      @V6MVFM0 25950000
&IUCVERR SETA  1                                               @V6MVFM0 26000000
.ENDTYPE ANOP                                                  @V6MVFM0 26050000
.*                                                                      26100000
.*--------------------------------------------------------------------- 26150000
.*       VALIDATE THE WAIT OPTION                                       26200000
.*--------------------------------------------------------------------- 26250000
.*                                                                      26300000
         AIF   (T'&WAIT EQ 'O').ENDWAIT                        @V6MVFM0 26350000
         AIF   ('&MAP'(21,1) NE '0').CHKWAIT                   @V6MVFM0 26400000
         MNOTE 8,'WAIT= IS NOT ALLOWED ON THE &FCN FUNCTION'   @V6MVFM0 26450000
&IUCVERR SETA  1                                               @V6MVFM0 26500000
         AGO   .ENDWAIT                                        @V6MVFM0 26550000
.CHKWAIT ANOP                                                  @V6MVFM0 26600000
         AIF   ('&WAIT' EQ 'YES').ENDWAIT                      @V6MVFM0 26650000
         AIF   ('&WAIT' EQ 'NO').ENDWAIT                       @V6MVFM0 26700000
         MNOTE 8,'WAIT=&WAIT IS INVALID'                       @V6MVFM0 26750000
&IUCVERR SETA  1                                               @V6MVFM0 26800000
.ENDWAIT ANOP                                                  @V6MVFM0 26850000
.*                                                                      26900000
.*--------------------------------------------------------------------- 26950000
.*       VALIDATE THE FMH5 OPTION                                       27000000
.*--------------------------------------------------------------------- 27050000
.*                                                                      27100000
         AIF   (T'&FMH5 EQ 'O').ENDFMH5                        @V6RCGLD 27150000
         AIF   ('&MAP'(22,1) NE '0').CHKFMH5                   @V6RCGLD 27200000
         MNOTE 8,'FMH5= IS NOT ALLOWED ON THE &FCN FUNCTION'   @V6RCGLD 27250000
&IUCVERR SETA  1                                               @V6RCGLD 27300000
         AGO   .ENDFMH5                                        @V6RCGLD 27350000
.CHKFMH5 ANOP                                                  @V6RCGLD 27400000
         AIF   ('&FMH5' EQ 'YES').ENDFMH5                      @V6RCGLD 27450000
         AIF   ('&FMH5' EQ 'NO').ENDFMH5                       @V6RCGLD 27500000
         MNOTE 8,'FMH5=&FMH5 IS INVALID'                       @V6RCGLD 27550000
&IUCVERR SETA  1                                               @V6RCGLD 27600000
.ENDFMH5 ANOP                                                  @V6RCGLD 27650000
.*                                                                      27700000
.*--------------------------------------------------------------------- 27750000
.*       VALIDATE THE FLUSH OPTION                                      27800000
.*--------------------------------------------------------------------- 27850000
.*                                                                      27900000
         AIF   (T'&FLUSH EQ 'O').ENDFLSH                       @V6RCGGS 27950000
         AIF   ('&MAP'(23,1) NE '0').CHKFLSH                   @V6RCGGS 28000000
         MNOTE 8,'FLUSH= IS NOT ALLOWED ON THE &FCN FUNCTION'  @V6RCGGS 28050000
&IUCVERR SETA  1                                               @V6RCGGS 28100000
         AGO   .ENDFLSH                                        @V6RCGGS 28150000
.CHKFLSH ANOP                                                  @V6RCGGS 28200000
         AIF   ('&FLUSH' EQ 'YES').ENDFLSH                     @V6RCGGS 28250000
         AIF   ('&FLUSH' EQ 'NO').ENDFLSH                      @V6RCGGS 28300000
         MNOTE 8,'FLUSH=&FLUSH IS INVALID'                     @V6RCGGS 28350000
&IUCVERR SETA  1                                               @V6RCGGS 28400000
.ENDFLSH ANOP                                                  @V6RCGGS 28450000
.*                                                                      28500000
.*--------------------------------------------------------------------- 28550000
.*       VALIDATE THE RETURN OPTION                                     28600000
.*--------------------------------------------------------------------- 28650000
.*                                                                      28700000
         AIF   (T'&RETURN EQ 'O').ENDRTRN                      @V6RCGGS 28750000
         AIF   ('&MAP'(24,1) NE '0').CHKRTRN                   @V6RCGGS 28800000
         MNOTE 8,'RETURN= IS NOT ALLOWED ON THE &FCN FUNCTION' @V6RCGGS 28850000
&IUCVERR SETA  1                                               @V6RCGGS 28900000
         AGO   .ENDRTRN                                        @V6RCGGS 28950000
.CHKRTRN ANOP                                                  @V6RCGGS 29000000
         AIF   ('&RETURN' EQ 'ALLOCD').ENDRTRN                 @V6RCGGS 29050000
         AIF   ('&RETURN' EQ 'IMMED').ENDRTRN                  @V6RCGGS 29100000
         MNOTE 8,'RETURN=&RETURN IS INVALID'                   @V6RCGGS 29150000
&IUCVERR SETA  1                                               @V6RCGGS 29200000
.ENDRTRN ANOP                                                  @V6RCGGS 29250000
.*                                                                      29300000
.*--------------------------------------------------------------------- 29350000
.*       VALIDATE THE LOGDATA OPTION                                    29400000
.*--------------------------------------------------------------------- 29450000
.*                                                                      29500000
         AIF   (T'&LOGDATA EQ 'O').ENDLDAT                     @V6RCGGS 29550000
         AIF   ('&MAP'(25,1) NE '0').CHKLDAT                   @V6RCGGS 29600000
         MNOTE 8,'LOGDATA= IS NOT ALLOWED ON THE &FCN FUNCTION'@V6RCGGS 29650000
&IUCVERR SETA  1                                               @V6RCGGS 29700000
         AGO   .ENDLDAT                                        @V6RCGGS 29750000
.CHKLDAT ANOP                                                  @V6RCGGS 29800000
         AIF   ('&LOGDATA' EQ 'YES').ENDLDAT                   @V6RCGGS 29850000
         AIF   ('&LOGDATA' EQ 'NO').ENDLDAT                    @V6RCGGS 29900000
         MNOTE 8,'LOGDATA=&LOGDATA IS INVALID'                 @V6RCGGS 29950000
&IUCVERR SETA  1                                               @V6RCGGS 30000000
.ENDLDAT ANOP                                                  @V6RCGGS 30050000
.*                                                                      30100000
.*--------------------------------------------------------------------- 30150000
.*       VALIDATE THE DIRECT OPTION                                     30200000
.*--------------------------------------------------------------------- 30250000
.*                                                                      30300000
         AIF   (T'&DIRECT EQ 'O').ENDDIR                       @V6RCGGS 30350000
         AIF   ('&MAP'(26,1) NE '0').CHKDIR                    @V6RCGGS 30400000
         MNOTE 8,'DIRECT= IS NOT ALLOWED ON THE &FCN FUNCTION' @V6RCGGS 30450000
&IUCVERR SETA  1                                               @V6RCGGS 30500000
         AGO   .ENDDIR                                         @V6RCGGS 30550000
.CHKDIR  ANOP                                                  @V6RCGGS 30600000
         AIF   ('&DIRECT' EQ 'SEND').ENDDIR                    @V6RCGGS 30650000
         AIF   ('&DIRECT' EQ 'RECEIVE').ENDDIR                 @V6RCGGS 30700000
         MNOTE 8,'DIRECT=&DIRECT IS INVALID'                   @V6RCGGS 30750000
&IUCVERR SETA  1                                               @V6RCGGS 30800000
.ENDDIR  ANOP                                                  @V6RCGGS 30850000
.*                                                                      30900000
.*--------------------------------------------------------------------- 30950000
.*       CHECK FOR CONFLICTING OPTIONS                                  31000000
.*--------------------------------------------------------------------- 31050000
.*                                                                      31100000
.*                                                                      31150000
.*--------------------------------------------------------------------- 31200000
.*       CHECK FOR RECEIVE=NO AND ANY MENTION OF AN ANSWER BUFFER       31250000
.*--------------------------------------------------------------------- 31300000
.*                                                                      31350000
         AIF   ('&RECEIVE' NE 'NO').NORCNFL                    @V6MVFM0 31400000
         AIF   (T'&ANSBUF EQ 'O').RCNFL1                       @V6MVFM0 31450000
         MNOTE 8,'ANSBUF= IS INVALID WITH RECEIVE=NO'          @V6MVFM0 31500000
&IUCVERR SETA  1                                               @V6MVFM0 31550000
.RCNFL1  ANOP                                                  @V6MVFM0 31600000
         AIF   (T'&ANSLEN EQ 'O').RCNFL2                       @V6MVFM0 31650000
         MNOTE 8,'ANSLEN= IS INVALID WITH RECEIVE=NO'          @V6MVFM0 31700000
&IUCVERR SETA  1                                               @V6MVFM0 31750000
.RCNFL2  ANOP                                                  @V6MVFM0 31800000
         AIF   (T'&ANSLIST EQ 'O').NORCNFL                     @V6MVFM0 31850000
         MNOTE 8,'ANSLIST= IS INVALID WITH RECEIVE=NO'         @V6MVFM0 31900000
&IUCVERR SETA  1                                               @V6MVFM0 31950000
.NORCNFL ANOP                                                  @V6MVFM0 32000000
.*                                                                      32050000
.*--------------------------------------------------------------------- 32100000
.*       CHECK FOR SEVER TYPE=NORMAL AND CODE                           32150000
.*--------------------------------------------------------------------- 32200000
.*                                                                      32250000
         AIF   ('&FCN' NE 'SEVER').NOSCNFL                     @V6MVFM0 32300000
         AIF   ('&TYPE' NE 'NORMAL').NOSCNFL                   @V6MVFM0 32350000
         AIF   (T'&CODE EQ 'O').NOSCNFL                        @V6MVFM0 32400000
         MNOTE 8,'CODE= IS INVALID ON SEVER TYPE=NORMAL'       @V6MVFM0 32450000
&IUCVERR SETA  1                                               @V6MVFM0 32500000
.NOSCNFL ANOP                                                  @V6MVFM0 32550000
.*                                                                      32600000
.*--------------------------------------------------------------------- 32650000
.*       CHECK FOR SEVER TYPE=NORMAL AND:  BUFLIST, BUFFER OR BUFLEN    32700000
.*--------------------------------------------------------------------- 32750000
.*                                                                      32800000
         AIF   ('&FCN' NE 'SEVER').NOSTBUF                     @V6RCGGS 32850000
         AIF   ('&TYPE' NE 'NORMAL').NOSTBUF                   @V6RCGGS 32900000
         AIF   (T'&BUFLIST EQ 'O').CHKBFR                      @V6RCGGS 32950000
         MNOTE 8,'BUFLIST= IS INVALID ON SEVER TYPE=NORMAL'    @V6RCGGS 33000000
&IUCVERR SETA  1                                               @V6RCGGS 33050000
.CHKBFR  AIF   (T'&BUFFER EQ 'O').CHKBFLN                      @V6RCGGS 33100000
         MNOTE 8,'BUFFER= IS INVALID ON SEVER TYPE=NORMAL'     @V6RCGGS 33150000
&IUCVERR SETA  1                                               @V6RCGGS 33200000
.CHKBFLN AIF   (T'&BUFLEN EQ 'O').NOSTBUF                      @V6RCGGS 33250000
         MNOTE 8,'BUFLEN= IS INVALID ON SEVER TYPE=NORMAL'     @V6RCGGS 33300000
&IUCVERR SETA  1                                               @V6RCGGS 33350000
.NOSTBUF ANOP                                                  @V6RCGGS 33400000
.*                                                                      33450000
.*--------------------------------------------------------------------- 33500000
.*       CHECK FOR SENDERR WITH TYPE AND CODE                           33550000
.*--------------------------------------------------------------------- 33600000
.*                                                                      33650000
         AIF   ('&FCN' NE 'SENDERR').NOERCON                   @V6RCGET 33700000
         AIF   (T'&CODE EQ 'O').NOERCON                        @V6RCGET 33750000
         AIF   (T'&TYPE EQ 'O').NOERCON                        @V6RCGET 33800000
         MNOTE 8,'CODE= AND TYPE= ARE CONFLICTING PARAMETERS'  @V6RCGET 33850000
&IUCVERR SETA  1                                               @V6RCGET 33900000
.NOERCON ANOP                                                  @V6RCGET 33950000
.*                                                                      34000000
.*--------------------------------------------------------------------- 34050000
.*       CHECK FOR THE CONFLICTING OPTION:  RECEIVE=YES AND FLUSH=YES   34100000
.*--------------------------------------------------------------------- 34150000
.*                                                                      34200000
         AIF   (T'&RECEIVE EQ 'O').NOFLERR                     @V6RCGGS 34250000
         AIF   (T'&FLUSH EQ 'O').NOFLERR                       @V6RCGGS 34300000
         AIF   ('&RECEIVE' NE 'YES').NOFLERR                   @V6RCGGS 34350000
         AIF   ('&FLUSH' NE 'YES').NOFLERR                     @V6RCGGS 34400000
         MNOTE 8,'FLUSH=YES AND RECEIVE=YES ARE CONFLICTING PARAMETERS'$34450000
                                                               @V6RCGGS 34500000
&IUCVERR SETA  1                                               @V6RCGGS 34550000
.NOFLERR ANOP                                                  @V6RCGGS 34600000
.*                                                                      34650000
.*--------------------------------------------------------------------- 34700000
.*       CHECK FOR THE CONFLICTING OPTION:  DIRECT= AND CODE=           34750000
.*       BOTH SPECIFIED ON SENDERR                                      34800000
.*--------------------------------------------------------------------- 34850000
.*                                                                      34900000
         AIF   (T'&DIRECT EQ 'O').NODIERR                      @V6RCGGS 34950000
         AIF   (T'&CODE EQ 'O').NODIERR                        @V6RCGGS 35000000
         MNOTE 8,'CODE= AND DIRECT= ARE CONFLICTING PARAMETERS'        $35050000
                                                               @V6RCGGS 35100000
&IUCVERR SETA  1                                               @V6RCGGS 35150000
.NODIERR ANOP                                                  @V6RCGGS 35200000
.*                                                                      35250000
.*--------------------------------------------------------------------- 35300000
.*       IF INVALID OPTIONS WERE FOUND, THEN EXIT                       35350000
.*--------------------------------------------------------------------- 35400000
.*                                                                      35450000
         AIF   (&IUCVERR EQ 0).NOERRS                          @V6MVFM0 35500000
         MEXIT                                                 @V6MVFM0 35550000
.NOERRS  ANOP                                                  @V6MVFM0 35600000
         AIF   ('&LABEL' EQ '').NOLABEL                        @V6MVFM0 35650000
&LABEL   DS    0H                                              @V6MVFM0 35700000
.NOLABEL ANOP                                                  @V6MVFM0 35750000
.*                                                                      35800000
.*--------------------------------------------------------------------- 35850000
.*       WE NOW BEGIN TO SET UP THE FLAGS FOR IPFLAGS1 AND IPFLAGS2.    35900000
.*       THE FLAGS TO SET IN IPFLAGS1 AND IPFLAGS2 ARE CONTAINED IN     35950000
.*       &BITS1 AND &BITS2 RESPECTIVELY.  THE FLAGS TO RESET IN         36000000
.*       IPFLAGS1 AND IPFLAGS2 ARE CONTAINED IN &BITS1F AND &BITS2F     36050000
.*       RESPECTIVELY.                                                  36100000
.*--------------------------------------------------------------------- 36150000
.*                                                                      36200000
.*                                                                      36250000
.*--------------------------------------------------------------------- 36300000
.*       SET THE ANSWER LIST FLAG                                       36350000
.*--------------------------------------------------------------------- 36400000
.*                                                                      36450000
         AIF   (T'&ANSLIST EQ 'O').ALSTEND                     @V6MVFM0 36500000
         AIF   ('&ANSLIST' EQ 'NO').ALSTNO                     @V6MVFM0 36550000
&BITS1   SETC  '&BITS1'.'+'.'IPANSLST'                         @V6MVFM0 36600000
         AGO   .ALSTEND                                        @V6MVFM0 36650000
.ALSTNO  ANOP                                                  @V6MVFM0 36700000
&BITS1F  SETC  '&BITS1F'.'+'.'IPANSLST'                        @V6MVFM0 36750000
.ALSTEND ANOP                                                  @V6MVFM0 36800000
.*                                                                      36850000
.*--------------------------------------------------------------------- 36900000
.*       SET THE APPC FLAG.                                             36950000
.*--------------------------------------------------------------------- 37000000
.*                                                                      37050000
         AIF   ('&FCN'(1,4) EQ 'SEND').APPCSND                 @V6MVFM0 37100000
         AIF   ('&FCN' EQ 'CONNECT').APPC1                     @V6MVFM0 37150000
         AIF   ('&FCN' EQ 'RECEIVE').APPC1                     @V6MVFM0 37200000
         AIF   ('&FCN' NE 'SEVER').APPCEND                     @V6MVFM0 37250000
.APPC1   ANOP                                                  @V6MVFM0 37300000
&BITS1   SETC  '&BITS1'.'+'.'IPAPPC'                           @V6MVFM0 37350000
         AGO   .APPCEND                                        @V6MVFM0 37400000
.APPCSND ANOP                                                  @V6MVFM0 37450000
&BITS1   SETC  '&BITS1'.'+'.'IPAPPCSN'                         @V6MVFM0 37500000
.APPCEND ANOP                                                  @V6MVFM0 37550000
.*                                                                      37600000
.*--------------------------------------------------------------------- 37650000
.*       SET THE BUFFER LIST FLAG                                       37700000
.*--------------------------------------------------------------------- 37750000
.*                                                                      37800000
         AIF   (T'&BUFLIST EQ 'O').BLSTEND                     @V6MVFM0 37850000
         AIF   ('&BUFLIST' EQ 'NO').BLSTNO                     @V6MVFM0 37900000
&BITS1   SETC  '&BITS1'.'+'.'IPBUFLST'                         @V6MVFM0 37950000
         AGO   .BLSTEND                                        @V6MVFM0 38000000
.BLSTNO  ANOP                                                  @V6MVFM0 38050000
&BITS1F  SETC  '&BITS1F'.'+'.'IPBUFLST'                        @V6MVFM0 38100000
.BLSTEND ANOP                                                  @V6MVFM0 38150000
.*                                                                      38200000
.*--------------------------------------------------------------------- 38250000
.*       SET THE COMSRV FLAG IF ALTID WAS SPECIFIED ON CONNECT.         38300000
.*--------------------------------------------------------------------- 38350000
.*                                                                      38400000
         AIF   (T'&ALTID EQ 'O').ENDCSRV                       @V6MVFM0 38450000
&BITS2   SETC  '&BITS2'.'+'.'IPCOMSRV'                         @V6MVFM0 38500000
.ENDCSRV ANOP                                                  @V6MVFM0 38550000
.*                                                                      38600000
.*--------------------------------------------------------------------- 38650000
.*       SET THE COMSRV FLAG IF CODE WAS SPECIFIED ON SENDERR.          38700000
.*--------------------------------------------------------------------- 38750000
.*                                                                      38800000
         AIF   ('&FCN' NE 'SENDERR').ENDCSR1                   @V6MVFM0 38850000
         AIF   (T'&CODE EQ 'O').ENDCSR1                        @V6MVFM0 38900000
&BITS2   SETC  '&BITS2'.'+'.'IPCOMSRV'                         @V6MVFM0 38950000
.ENDCSR1 ANOP                                                  @V6MVFM0 39000000
.*                                                                      39050000
.*--------------------------------------------------------------------- 39100000
.*       SET THE CONTROL FLAG.                                          39150000
.*--------------------------------------------------------------------- 39200000
.*                                                                      39250000
         AIF   (T'&CONTROL EQ 'O').CNTREND                     @V6MVFM0 39300000
         AIF   ('&CONTROL' EQ 'NO').CNTRNO                     @V6MVFM0 39350000
&BITS1   SETC  '&BITS1'.'+'.'IPCNTRL'                          @V6MVFM0 39400000
         AGO   .CNTREND                                        @V6MVFM0 39450000
.CNTRNO  ANOP                                                  @V6MVFM0 39500000
&BITS1F  SETC  '&BITS1F'.'+'.'IPCNTRL'                         @V6MVFM0 39550000
.CNTREND ANOP                                                  @V6MVFM0 39600000
.*                                                                      39650000
.*--------------------------------------------------------------------- 39700000
.*       SET THE SYNCLVL FLAG                                           39750000
.*--------------------------------------------------------------------- 39800000
.*                                                                      39850000
         AIF   (T'&SYNCLVL EQ 'O').SYNCEND                     @V6MVFM0 39900000
         AIF   ('&SYNCLVL' EQ 'NONE').SYNCNON                  @V6MVFM0 39950000
&BITS2   SETC  '&BITS2'.'+'.'IPLVLCF'                          @V6MVFM0 40000000
         AGO   .SYNCEND                                        @V6MVFM0 40050000
.SYNCNON ANOP                                                  @V6MVFM0 40100000
&BITS2F  SETC  '&BITS2F'.'+'.'IPLVLCF'                         @V6MVFM0 40150000
.SYNCEND ANOP                                                  @V6MVFM0 40200000
.*                                                                      40250000
.*--------------------------------------------------------------------- 40300000
.*       SET THE TYPE FLAG FOR CONNECT.                                 40350000
.*--------------------------------------------------------------------- 40400000
.*                                                                      40450000
         AIF   ('&FCN' NE 'CONNECT').CTYPEND                   @V6RCGET 40500000
         AIF   (T'&TYPE EQ 'O').CTYPEND                        @V6RCGET 40550000
         AIF   ('&TYPE' EQ 'BASIC').CTYPBAS                    @V6RCGET 40600000
&BITS2   SETC  '&BITS2'.'+'.'IPMAPPED'                         @V6RCGET 40650000
         AGO   .CTYPEND                                        @V6RCGET 40700000
.CTYPBAS ANOP                                                  @V6RCGET 40750000
&BITS2F  SETC  '&BITS2F'.'+'.'IPMAPPED'                        @V6RCGET 40800000
.CTYPEND ANOP                                                  @V6RCGET 40850000
.*                                                                      40900000
.*--------------------------------------------------------------------- 40950000
.*       SET THE TYPE FLAG FOR SENDERR.                                 41000000
.*--------------------------------------------------------------------- 41050000
.*                                                                      41100000
         AIF   ('&FCN' NE 'SENDERR').STYPEND                   @V6RCGET 41150000
         AIF   (T'&TYPE EQ 'O').STYPEND                        @V6RCGET 41200000
         AIF   ('&TYPE' EQ 'PROG').STYPPRG                     @V6RCGET 41250000
&BITS2   SETC  '&BITS2'.'+'.'IPTYPSVC'                         @V6RCGET 41300000
         AGO   .STYPEND                                        @V6RCGET 41350000
.STYPPRG ANOP                                                  @V6RCGET 41400000
&BITS2F  SETC  '&BITS2F'.'+'.'IPTYPSVC'                        @V6RCGET 41450000
.STYPEND ANOP                                                  @V6RCGET 41500000
.*                                                                      41550000
.*--------------------------------------------------------------------- 41600000
.*       SET THE WAIT FLAG.                                             41650000
.*--------------------------------------------------------------------- 41700000
.*                                                                      41750000
         AIF   (T'&WAIT EQ 'O').WAITEND                        @V6MVFM0 41800000
         AIF   ('&WAIT' EQ 'NO').WAITNO                        @V6MVFM0 41850000
&BITS2   SETC  '&BITS2'.'+'.'IPWAIT'                           @V6MVFM0 41900000
         AGO   .WAITEND                                        @V6MVFM0 41950000
.WAITNO  ANOP                                                  @V6MVFM0 42000000
&BITS2F  SETC  '&BITS2F'.'+'.'IPWAIT'                          @V6MVFM0 42050000
.WAITEND ANOP                                                  @V6MVFM0 42100000
.*                                                                      42150000
.*--------------------------------------------------------------------- 42200000
.*       SET THE FMH5 FLAG.                                             42250000
.*--------------------------------------------------------------------- 42300000
.*                                                                      42350000
         AIF   (T'&FMH5 EQ 'O').FMH5END                        @V6RCGLD 42400000
         AIF   ('&FMH5' EQ 'NO').FMH5NO                        @V6RCGLD 42450000
&BITS2   SETC  '&BITS2'.'+'.'IPFMH5'                           @V6RCGLD 42500000
         AGO   .FMH5END                                        @V6RCGLD 42550000
.FMH5NO  ANOP                                                  @V6RCGLD 42600000
&BITS2F  SETC  '&BITS2F'.'+'.'IPFMH5'                          @V6RCGLD 42650000
.FMH5END ANOP                                                  @V6RCGLD 42700000
.*                                                                      42750000
.*--------------------------------------------------------------------- 42800000
.*       SET THE FLUSH FLAG.                                            42850000
.*--------------------------------------------------------------------- 42900000
.*                                                                      42950000
         AIF   (T'&FLUSH EQ 'O').FLSHEND                       @V6RCGGS 43000000
         AIF   ('&FLUSH' EQ 'NO').FLSHNO                       @V6RCGGS 43050000
&BITS2   SETC  '&BITS2'.'+'.'IPFLUSH'                          @V6RCGGS 43100000
         AGO   .FLSHEND                                        @V6RCGGS 43150000
.FLSHNO  ANOP                                                  @V6RCGGS 43200000
&BITS2F  SETC  '&BITS2F'.'+'.'IPFLUSH'                         @V6RCGGS 43250000
.FLSHEND ANOP                                                  @V6RCGGS 43300000
.*                                                                      43350000
.*--------------------------------------------------------------------- 43400000
.*       SET THE RETURN FLAG.                                           43450000
.*--------------------------------------------------------------------- 43500000
.*                                                                      43550000
         AIF   (T'&RETURN EQ 'O').RTRNEND                      @V6RCGGS 43600000
         AIF   ('&RETURN' EQ 'ALLOCD').RTRIMM                  @V6RCGGS 43650000
&BITS2   SETC  '&BITS2'.'+'.'IPIMMED'                          @V6RCGGS 43700000
         AGO   .RTRNEND                                        @V6RCGGS 43750000
.RTRIMM  ANOP                                                  @V6RCGGS 43800000
&BITS2F  SETC  '&BITS2F'.'+'.'IPIMMED'                         @V6RCGGS 43850000
.RTRNEND ANOP                                                  @V6RCGGS 43900000
.*                                                                      43950000
.*--------------------------------------------------------------------- 44000000
.*       SET THE LOGDATA FLAG.                                          44050000
.*--------------------------------------------------------------------- 44100000
.*                                                                      44150000
         AIF   (T'&LOGDATA EQ 'O').LDATEND                     @V6RCGGS 44200000
         AIF   ('&LOGDATA' EQ 'NO').LDATNO                     @V6RCGGS 44250000
&BITS2   SETC  '&BITS2'.'+'.'IPLOGDOK'                         @V6RCGGS 44300000
         AGO   .LDATEND                                        @V6RCGGS 44350000
.LDATNO  ANOP                                                  @V6RCGGS 44400000
&BITS2F  SETC  '&BITS2F'.'+'.'IPLOGDOK'                        @V6RCGGS 44450000
.LDATEND ANOP                                                  @V6RCGGS 44500000
.*                                                                      44550000
.*--------------------------------------------------------------------- 44600000
.*       SET THE DIRECT FLAG.                                           44650000
.*--------------------------------------------------------------------- 44700000
.*                                                                      44750000
         AIF   (T'&DIRECT EQ 'O').DIREND                       @V6RCGGS 44800000
         AIF   ('&DIRECT' EQ 'SEND').DIRSND                    @V6RCGGS 44850000
&BITS2   SETC  '&BITS2'.'+'.'IPCHGDIR'                         @V6RCGGS 44900000
         AGO   .DIREND                                         @V6RCGGS 44950000
.DIRSND  ANOP                                                  @V6RCGGS 45000000
&BITS2F  SETC  '&BITS2F'.'+'.'IPCHGDIR'                        @V6RCGGS 45050000
.DIREND  ANOP                                                  @V6RCGGS 45100000
.*                                                                      45150000
.*--------------------------------------------------------------------- 45200000
.*       WE NOW BEGIN GENERATING CODE:                                  45250000
.*--------------------------------------------------------------------- 45300000
.*                                                                      45350000
.*                                                                      45400000
.*--------------------------------------------------------------------- 45450000
.*       GENERATE THE CODE FOR THE PATH ID                              45500000
.*--------------------------------------------------------------------- 45550000
.*                                                                      45600000
         AIF   (T'&PATHID EQ 'O').PATHEND                      @V6MVFM0 45650000
         AIF   ('&PATHID'(1,1) EQ '(').PATHREG                 @V6MVFM0 45700000
         MVC   IPPATHID,&PATHID PATH ID TO PARM LIST                    45750000
         AGO   .PATHEND                                        @V6MVFM0 45800000
.PATHREG ANOP                                                  @V6MVFM0 45850000
         STH   &PATHID(1),IPPATHID PATH ID TO PARM LIST                 45900000
.PATHEND ANOP                                                  @V6MVFM0 45950000
.*                                                                      46000000
.*--------------------------------------------------------------------- 46050000
.*       GENERATE THE CODE FOR SETTING IPFLAGS1                         46100000
.*--------------------------------------------------------------------- 46150000
.*                                                                      46200000
.*       AIF   (K'&BITS1 EQ 0).NOBITS1                         @V6MVFM0 46250000
         AIF   ('&BITS1' EQ '').NOBITS1                        @D31BDUL 46300000
.*ITS1   SETC  '&BITS1'(2,K'&BITS1-1)                          @V6MVFM0 46350000
&BITS1   SETC  '0'.'&BITS1'                                    @D31BDUL 46400000
         OI    IPFLAGS1,&BITS1                                          46450000
.NOBITS1 ANOP                                                  @V6MVFM0 46500000
.*                                                                      46550000
.*--------------------------------------------------------------------- 46600000
.*       GENERATE THE CODE FOR RESETTING IPFLAGS1                       46650000
.*--------------------------------------------------------------------- 46700000
.*                                                                      46750000
.*       AIF   (K'&BITS1F EQ 0).NOBIT1F                        @V6MVFM0 46800000
         AIF   ('&BITS1F' EQ '').NOBIT1F                       @D31BDUL 46850000
.*ITS1F  SETC  '&BITS1F'(2,K'&BITS1F-1)                        @V6MVFM0 46900000
&BITS1F  SETC  '0'.'&BITS1F'                                   @D31BDUL 46950000
         NI    IPFLAGS1,X'FF'-(&BITS1F)                                 47000000
.NOBIT1F ANOP                                                  @V6MVFM0 47050000
.*                                                                      47100000
.*--------------------------------------------------------------------- 47150000
.*       GENERATE THE CODE FOR ERROR/SEVER CODE                         47200000
.*--------------------------------------------------------------------- 47250000
.*                                                                      47300000
         AIF   (T'&CODE EQ 'O').CODEEND                        @V6MVFM0 47350000
         AIF   ('&CODE'(1,1) EQ '(').CODEREG                   @V6MVFM0 47400000
         MVC   IPCODE,&CODE        ERROR/SEVER CODE TO PARM LIST        47450000
         AGO   .CODEEND                                        @V6MVFM0 47500000
.CODEREG ANOP                                                  @V6MVFM0 47550000
         STH   &CODE(1),IPCODE     ERROR/SEVER CODE TO PARM LIST        47600000
.CODEEND ANOP                                                  @V6MVFM0 47650000
.*                                                                      47700000
.*--------------------------------------------------------------------- 47750000
.*       GENERATE THE CODE FOR SETTING IPFLAGS2                         47800000
.*--------------------------------------------------------------------- 47850000
.*                                                                      47900000
.*       AIF   (K'&BITS2 EQ 0).NOBITS2                         @V6MVFM0 47950000
         AIF   ('&BITS2' EQ '').NOBITS2                        @D31BDUL 48000000
.*ITS2   SETC  '&BITS2'(2,K'&BITS2-1)                          @V6MVFM0 48050000
&BITS2   SETC  '0'.'&BITS2'                                    @D31BDUL 48100000
         OI    IPFLAGS2,&BITS2                                          48150000
.NOBITS2 ANOP                                                  @V6MVFM0 48200000
.*                                                                      48250000
.*--------------------------------------------------------------------- 48300000
.*       GENERATE THE CODE FOR RESETTING IPFLAGS2                       48350000
.*--------------------------------------------------------------------- 48400000
.*                                                                      48450000
.*       AIF   (K'&BITS2F EQ 0).NOBIT2F                        @V6MVFM0 48500000
         AIF   ('&BITS2F' EQ '').NOBIT2F                       @D31BDUL 48550000
.*ITS2F  SETC  '&BITS2F'(2,K'&BITS2F-1)                        @V6MVFM0 48600000
&BITS2F  SETC  '0'.'&BITS2F'                                   @D31BDUL 48650000
         NI    IPFLAGS2,X'FF'-(&BITS2F)                                 48700000
.NOBIT2F ANOP                                                  @V6MVFM0 48750000
.*                                                                      48800000
.*--------------------------------------------------------------------- 48850000
.*       GENERATE THE CODE FOR THE SEND OPTION CODE                     48900000
.*--------------------------------------------------------------------- 48950000
.*                                                                      49000000
         AIF   ('&FCN'(1,4) NE 'SEND').SENDEND                 @V6MVFM0 49050000
         AIF   ('&FCN' NE 'SENDCNF').SENDCK1                   @V6MVFM0 49100000
&SNDCODE SETC  'IPCNFRM'                                       @V6MVFM0 49150000
         AIF   ('&TYPE' EQ 'NORMAL').SENDSET                   @V6MVFM0 49200000
&SNDCODE SETC  'IPCNFSEV'                                      @V6MVFM0 49250000
         AIF   ('&TYPE' EQ 'SEVER').SENDSET                    @V6RCGET 49300000
&SNDCODE SETC  'IPPREPRC'                                      @V6RCGET 49350000
         AGO   .SENDSET                                        @V6MVFM0 49400000
.SENDCK1 ANOP                                                  @V6MVFM0 49450000
         AIF   ('&FCN' NE 'SENDDATA').SENDCK2                  @V6MVFM0 49500000
&SNDCODE SETC  'IPDATA'                                        @V6MVFM0 49550000
         AIF   ('&RECEIVE' EQ 'NO').SENDSET                    @V6MVFM0 49600000
&SNDCODE SETC  'IPSNDRCV'                                      @V6MVFM0 49650000
         AGO   .SENDSET                                        @V6MVFM0 49700000
.SENDCK2 ANOP                                                  @V6MVFM0 49750000
&SNDCODE SETC  'IPCNFRMD'                                      @V6MVFM0 49800000
         AIF   ('&FCN' EQ 'SENDCNFD').SENDSET                  @V6MVFM0 49850000
&SNDCODE SETC  'IPERROR'                                       @V6MVFM0 49900000
         AIF   ('&FCN' EQ 'SENDERR').SENDSET                   @V6MVFM0 49950000
&SNDCODE SETC  'IPREQSND'                                      @V6MVFM0 50000000
.SENDSET ANOP                                                  @V6MVFM0 50050000
         MVI   IPSENDOP,&SNDCODE   SEND OPTION CODE TO PARM LIST        50100000
.SENDEND ANOP                                                  @V6MVFM0 50150000
.*                                                                      50200000
.*--------------------------------------------------------------------- 50250000
.*       GENERATE THE CODE FOR THE SEVER OPTION CODE                    50300000
.*--------------------------------------------------------------------- 50350000
.*                                                                      50400000
         AIF   ('&FCN' NE 'SEVER').SEVREND                     @V6MVFM0 50450000
&SNDCODE SETC  'IPSNORM'                                       @V6MVFM0 50500000
         AIF   ('&TYPE' EQ 'NORMAL').SEVRSET                   @V6MVFM0 50550000
&SNDCODE SETC  'IPSABEND'                                      @V6MVFM0 50600000
.SEVRSET ANOP                                                  @V6MVFM0 50650000
         MVI   IPSENDOP,&SNDCODE   SEVER OPTION CODE TO PARM LIST       50700000
.SEVREND ANOP                                                  @V6MVFM0 50750000
.*                                                                      50800000
.*--------------------------------------------------------------------- 50850000
.*       GENERATE THE CODE FOR THE BUFFER PARAMETER                     50900000
.*--------------------------------------------------------------------- 50950000
.*                                                                      51000000
         AIF   (T'&BUFFER EQ 'O').BUFAEND                      @V6MVFM0 51050000
&IPBUF   SETC  'IPBFADR1'                                      @V6MVFM0 51100000
         AIF   ('&FCN' NE 'CONNECT').BUFNOCN                   @V6MVFM0 51150000
&IPBUF   SETC  'IPBFADR2'                                      @V6MVFM0 51200000
.BUFNOCN ANOP                                                  @V6MVFM0 51250000
         AIF   ('&BUFFER'(1,1) EQ '(').BUFAREG                 @V6MVFM0 51300000
         LA    0,&BUFFER           GET ADDRESS OF BUFFER                51350000
         ST    0,&IPBUF            BUFFER ADDRESS TO PARM LIST @V6MVFM0 51400000
         AGO   .BUFAEND                                        @V6MVFM0 51450000
.BUFAREG ANOP                                                  @V6MVFM0 51500000
         ST    &BUFFER(1),&IPBUF   BUFFER ADDRESS TO PARM LIST @V6MVFM0 51550000
.BUFAEND ANOP                                                  @V6MVFM0 51600000
.*                                                                      51650000
.*--------------------------------------------------------------------- 51700000
.*       GENERATE THE CODE FOR THE BUFFER LENGTH PARAMETER              51750000
.*--------------------------------------------------------------------- 51800000
.*                                                                      51850000
         AIF   (T'&BUFLEN EQ 'O').BUFLEND                      @V6MVFM0 51900000
&IPLEN   SETC  'IPBFLN1F'                                      @V6MVFM0 51950000
         AIF   ('&FCN' NE 'CONNECT').BFLNOCN                   @V6MVFM0 52000000
&IPLEN   SETC  'IPBFLN2F'                                      @V6MVFM0 52050000
.BFLNOCN ANOP                                                  @V6MVFM0 52100000
         AIF   ('&BUFLEN'(1,1) EQ '(').BUFLREG                 @V6MVFM0 52150000
         MVC   &IPLEN,&BUFLEN      BUFFER LENGTH TO PARM LIST  @V6MVFM0 52200000
         AGO   .BUFLEND                                        @V6MVFM0 52250000
.BUFLREG ANOP                                                  @V6MVFM0 52300000
         ST    &BUFLEN(1),&IPLEN   BUFFER LENGTH TO PARM LIST  @V6MVFM0 52350000
.BUFLEND ANOP                                                  @V6MVFM0 52400000
.*                                                                      52450000
.*--------------------------------------------------------------------- 52500000
.*       GENERATE THE CODE FOR THE ANSWER BUFFER PARAMETER              52550000
.*--------------------------------------------------------------------- 52600000
.*                                                                      52650000
         AIF   (T'&ANSBUF EQ 'O').ANSBEND                      @V6MVFM0 52700000
         AIF   ('&ANSBUF'(1,1) EQ '(').ANSBREG                 @V6MVFM0 52750000
         LA    0,&ANSBUF           GET ADDRESS OF AREA                  52800000
         ST    0,IPBFADR2          STORE IT IN THE PARM LIST            52850000
         AGO   .ANSBEND                                        @V6MVFM0 52900000
.ANSBREG ANOP                                                  @V6MVFM0 52950000
         ST    &ANSBUF(1),IPBFADR2 STORE ADDRESS IN PARM LIST           53000000
.ANSBEND ANOP                                                  @V6MVFM0 53050000
.*                                                                      53100000
.*--------------------------------------------------------------------- 53150000
.*       GENERATE THE CODE FOR THE ANSWER LENGTH PARAMETER              53200000
.*--------------------------------------------------------------------- 53250000
.*                                                                      53300000
         AIF   (T'&ANSLEN EQ 'O').ANSLEND                      @V6MVFM0 53350000
         AIF   ('&ANSLEN'(1,1) EQ '(').ANSLREG                 @V6MVFM0 53400000
         MVC   IPBFLN2F,&ANSLEN    ANSWER LENGTH TO PARM LIST           53450000
         AGO   .ANSLEND                                        @V6MVFM0 53500000
.ANSLREG ANOP                                                  @V6MVFM0 53550000
         ST    &ANSLEN(1),IPBFLN2F ANSWER LENGTH TO PARM LIST           53600000
.ANSLEND ANOP                                                  @V6MVFM0 53650000
.*                                                                      53700000
.*--------------------------------------------------------------------- 53750000
.*       GENERATE THE CODE FOR THE ALTID PARAMETER                      53800000
.*--------------------------------------------------------------------- 53850000
.*                                                                      53900000
         AIF   (T'&ALTID EQ 'O').ALTIEND                       @V6MVFM0 53950000
         AIF   ('&ALTID'(1,1) EQ '(').ALTIREG                  @V6MVFM0 54000000
         MVC   IPVMID,&ALTID       ALTERNATE USERID TO PARM LIST        54050000
         AGO   .ALTIEND                                        @V6MVFM0 54100000
.ALTIREG ANOP                                                  @V6MVFM0 54150000
         MVC   IPVMID,0(&ALTID(1)) ALTERNATE USERID TO PARM LIST        54200000
.ALTIEND ANOP                                                  @V6MVFM0 54250000
.*                                                                      54300000
.*--------------------------------------------------------------------- 54350000
.*       GENERATE THE CODE FOR THE RESID PARAMETER                      54400000
.*--------------------------------------------------------------------- 54450000
.*                                                                      54500000
         AIF   (T'&RESID EQ 'O').RESIEND                       @V6MVFM0 54550000
         AIF   ('&RESID'(1,1) EQ '(').RESIREG                  @V6MVFM0 54600000
         MVC   IPRESID,&RESID      RESOURCE ID TO PARAMETER LIST        54650000
         AGO   .RESIEND                                        @V6MVFM0 54700000
.RESIREG ANOP                                                  @V6MVFM0 54750000
         MVC   IPRESID,0(&RESID(1)) RESOURCE ID TO PARAMETER LIST       54800000
.RESIEND ANOP                                                  @V6MVFM0 54850000
.*                                                                      54900000
.*--------------------------------------------------------------------- 54950000
.*       IF MF=L WAS SPECIFIED, THEN EXIT NOW                           55000000
.*--------------------------------------------------------------------- 55050000
.*                                                                      55100000
         AIF   ('&MF' NE 'L').OK                               @V6MVFM0 55150000
         MEXIT                                                 @V6MVFM0 55200000
.OK      ANOP                                                  @V6MVFM0 55250000
.*                                                                      55300000
.*--------------------------------------------------------------------- 55350000
.*       GENERATE THE LINKAGE TO PERFORM THE IUCV FUNCTION              55400000
.*--------------------------------------------------------------------- 55450000
.*                                                                      55500000
&FCODE   SETC  '&MAP'(1,2)                                     @V6MVFM0 55550000
         LA    0,&FCODE            GET FUNCTION CODE                    55600000
         AIF   (T'&PRMLIST EQ 'O').NOPARMS                     @V6MVFM0 55650000
         AIF   ('&PRMLIST'(1,1) EQ '(').PARMREG                @V6MVFM0 55700000
         DC    X'B2F0',S(&PRMLIST) GENERATE IUCV INSTRUCTION            55750000
         MEXIT                                                 @V6MVFM0 55800000
.PARMREG ANOP                                                  @V6MVFM0 55850000
         DC    X'B2F0',S(0&PRMLIST) GENERATE IUCV INSTRUCTION           55900000
         MEXIT                                                 @V6MVFM0 55950000
.NOPARMS ANOP                                                  @V6MVFM0 56000000
         DC    X'B2F00000'         GENERATE IUCV INSTRUCTION            56050000
         MEXIT                                                 @V6MVFM0 56100000
         MEND                                                  @V6MVFM0 56150000
