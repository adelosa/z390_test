*%GOTO PLSMLAMB;                      /* BEGIN OF PLS COMMENT           00050000
         MACRO                                                          00100000
&LABEL1  INLMLAMB &MF=,                                                X00150000
               &AREA=,                                                 X00200000
               &SBUFADR=,                                              X00250000
               &SBUFLEN=,                                              X00300000
               &EXITLST=,                                              X00350000
               &GETVIS=,                                               X00400000
               &ERROR=,                                                X00450000
               &EXTEND=,                                               X00500000
               &LOCK=,                                                 X00550000
               &LSTAREA=,                                              X00600000
               &LSTLEN=,                                               X00650000
               &LOGAREA=,                                              X00700000
               &LOGLEN=,                                               X00750000
               &MSGID=,                                                X00800000
               &MSGPAR1=,                                              X00850000
               &MSGPAR2=,                                              X00900000
               &MSGPAR3=,                                              X00950000
               &MSGPAR4=,                                              X01000000
               &SYSLST=,                                               X01050000
               &SYSLOG=                                                 01100000
.*                                                                      01150000
.*                                                                      01200000
         GBLB  &LBRACMP            CONTROL GENERATION OF DSECTS         01250000
         GBLC  &FC                 FUNCTION CODE PASSED BY LBRACCES     01300000
         GBLB  &SYNERR             SYNTAX ERROR IN INLCLAMB OR INLMLAMB 01350000
         GBLB  &INNER              INLMLAMB CALLED AS INNER MACRO       01400000
         GBLA  &LBR0SCO            CONTROL GENERATION OF SYSCOM DSECT   01450000
         GBLA  &LAMBSPD            CONTROL GENERATION OF SUBPOOL ID     01500000
         LCLC  &REG                PREPARE STRING FOR ST INSTRUCTION    01550000
         LCLC  &PARM               PREPARE OPTION CODES                 01600000
         LCLB  &SYNER1             SYNTAX ERROR IN INLMLAMB             01650000
         LCLB  &REGERR             REGISTER NOTATION INVALID            01700000
         LCLA  &K1                 TEMPORARY COUNT FIELD                01750000
         LCLA  &K1LCK              TEMPORARY COUNT FIELD                01800000
.*                                                                      01850000
.*                                                                      01900000
.* IBM DISK OPERATING SYSTEM                                            01950000
.*                                                                      02000000
         AIF   (&INNER).NOCOM                                           02050000
         SPACE                                                          02100000
*  LIBRARIAN - INLMLAMB - 5666-301-06-H07 - VERSION 84-01-05            02150000
         SPACE                                                          02200000
.NOCOM   ANOP                                                           02250000
.*                                                                      02300000
.*                                                                      02350000
.*************************************************************          02400000
.*        5666-301 (C) COPYRIGHT IBM CORP 1984               *          02450000
.*        LICENSED MATERIAL - PROGRAM PROPERTY OF IBM        *          02500000
.*        REFER TO COPYRIGHT INSTRUCTIONS                    *          02550000
.*                 FORM NUMBER G120-2083                     *          02600000
.*************************************************************          02650000
.*                                                                      02700000
.* A000000-999999                                              @D14LDFB 02750000
.*                                                                      02800000
         AGO   .ENDPCP                                                  02850000
*/*   MODULE INLMLAMB - LIBRARIAN MACRO INLMLAMB                        02900000
*/**                                                                    02950000
*/****  START OF SPECIFICATIONS  *************************************  03000000
*/**                                                                    03050000
*/**  MACRO NAME:  INLMLAMB                                             03100000
*/**                                                                    03150000
*/**  MACRO TYPE:  EXTERNAL LIBRARIAN MACRO, BILINGUAL                  03200000
*/**                                                                    03250000
*/**  DESCRIPTIVE NAME:  MACRO FOR LIBRARIAN ACCESS METHOD BLOCK        03300000
*/**                                                                    03350000
*/**  SYNTAX OF MACRO:                                                  03400000
*/**                                                                    03450000
*/**     ASSEMBLER:                                                     03500000
*/**                                                                    03550000
*/** <LABEL> INLMLAMB MF = DCL | GEN | MOD | MAP                        03600000
*/**                  <,AREA = NAME | (R)>                              03650000
*/**                  <,SBUFADR = NAME | (R)>                           03700000
*/**                  <,SBUFLEN = NAME | (R)>                           03750000
*/**                  <,GETVIS = PARTITION | SYSTEM>                    03800000
*/**                  <,ERROR = RETURN | CANCEL>                        03850000
*/**                  <,EXTEND = YES | NO>                              03900000
*/**                  <,LOCK = WAIT | RETURN>                           03950000
*/**                  <,LSTAREA= NAME | (R)>                            04000000
*/**                  <,LSTLEN= NAME | (R)>                             04050000
*/**                  <,LOGAREA = NAME | (R)>                           04100000
*/**                  <,SYSLST = NAME | (R)>                            04150000
*/**                  <,SYSLOG = NAME | (R)>                            04200000
*/**                                                                    04250000
*/**            FOR LIBRARIAN INTERNAL USE ONLY:                        04300000
*/**                  <,EXITLST = NAME | (R)>                           04350000
*/**                  <,MSGID = NAME | (R)>                             04400000
*/**                  <,MSGPAR1= NAME | (R)>                            04450000
*/**                  <,MSGPAR2= NAME | (R)>                            04500000
*/**                  <,MSGPAR3= NAME | (R)>                            04550000
*/**                  <,MSGPAR4= NAME | (R)>                            04600000
*/**                                                                    04650000
*/**     PLS:                                                           04700000
*/**                                                                    04750000
*/** ? <LABEL:> INLMLAMB MF(DCL | GEN | MOD | MAP)                      04800000
*/**                     <AREA(NAME | (R))>                             04850000
*/**                     <SBUFADR(NAME | (R))>                          04900000
*/**                     <SBUFLEN(NAME | (R))>                          04950000
*/**                     <GETVIS(PARTITION | SYSTEM)>                   05000000
*/**                     <ERROR(RETURN | CANCEL)>                       05050000
*/**                     <EXTEND(YES | NO)>                             05100000
*/**                     <LOCK(WAIT | RETURN)>                          05150000
*/**                     <LSTAREA(NAME | (R))>                          05200000
*/**                     <LSTLEN(NAME | (R))>                           05250000
*/**                     <LOGAREA(NAME | (R))>                          05300000
*/**                     <LOGLEN(NAME | (R))>                           05350000
*/**                     <SYSLST(NAME | (R))>                           05400000
*/**                     <SYSLOG(NAME | (R))>                           05450000
*/**                                                                    05500000
*/**             FOR LIBRARIAN INTERNAL USE ONLY:                       05550000
*/**                     <EXITLST(NAME | (R))>                          05600000
*/**                     <MSGID(NAME | (R))>                            05650000
*/**                     <MSGPAR1(NAME | (R))>                          05700000
*/**                     <MSGPAR2(NAME | (R))>                          05750000
*/**                     <MSGPAR3(NAME | (R))>                          05800000
*/**                     <MSGPAR4(NAME | (R))>                          05850000
*/**                                                                    05900000
*/**                     ;                                              05950000
*/*   EJECT                                                             06000000
*/**  INPUT:    SPECIFICATION OF MACRO                                  06050000
*/**                                                                    06100000
*/**  OUTPUT:   FOR MF = DCL                                            06150000
*/**            THE CONTROL BLOCK IS DEFINED INLINE AND THE             06200000
*/**            THE SPECIFIED PARAMETERS ARE FILLED IN.                 06250000
*/**            NON-SPECIFIED PARAMETERS ARE CLEARED.                   06300000
*/**                                                                    06350000
*/**            FOR MF = GEN                                            06400000
*/**            THE SPECIFIED PARAMETERS ARE FILLED INTO                06450000
*/**            THE CONTROL BLOCK DEFINED BY 'AREA'.                    06500000
*/**            NON-SPECIFIED PARAMETERS ARE CLEARED.                   06550000
*/**                                                                    06600000
*/**            FOR MF = MOD                                            06650000
*/**            THE SPECIFIED PARAMETERS ARE FILLED INTO                06700000
*/**            THE CONTROL BLOCK DEFINED BY 'AREA'.                    06750000
*/**            NON-SPECIFIED PARAMETERS REMAIN UNCHANGED.              06800000
*/**                                                                    06850000
*/**            FOR MF = MAP                                            06900000
*/**            ON THE FIRST CALL OF A                                  06950000
*/**            INLMLAMB MACRO IN A MODULE THE FOLLOWING                07000000
*/**            MAPS ARE PROVIDED WITH THE INDICATED NAMES:             07050000
*/**                                                                    07100000
*/**              SYSCOM     SYSTEM COMMUNICATION REGION                07150000
*/**              INLCLPT    LIBRARY POINTER TABLE                      07200000
*/**              INLCLAMB   LIBRARY REQUEST PARAMETER LIST             07250000
*/**                                                                    07300000
*/**            OTHERWISE, NO OUTPUT WILL BE GENERATED.                 07350000
*/**                                                                    07400000
*/**  FUNCTION:                                                         07450000
*/**                                                                    07500000
*/**                                                                    07550000
*/**  THE CONTROL BLOCK INLCLAMB                                        07600000
*/**  IS DEFINED AND FILLED UP WITH THE SPECIFIED                       07650000
*/**  PARAMETERS.                                                       07700000
*/***                                                                   07750000
*/**  REGISTER USAGE FOR INLMLAMB MACRO (ONLY FOR MF=GEN|MOD):          07800000
*/**                                                                    07850000
*/**    REG  0   USED FOR CONTROL BLOCK MODIFICATION                    07900000
*/**    REG  1   USED TO ADDRESS THE CONTROL BLOCK                      07950000
*/**    REG 14   USED FOR CONTROL BLOCK MODIFICATION                    08000000
*/**    REG 15   USED FOR CONTROL BLOCK MODIFICATION                    08050000
*/**                                                                    08100000
*/**  RETURN CODES FROM LANGUAGE PROCESSOR:                             08150000
*/**     0       MACRO EXPANSION SUCCESSFUL                             08200000
*/**     4       PARAMETERS HAVE BEEN IGNORED DUE TO CONFLICTS          08250000
*/**     8       INVALID PARAMETERS SPECIFIED                           08300000
*/**                                                                    08350000
*/**  NOTES:                                                            08400000
*/**                                                                    08450000
*/**     CHANGE ACTIVITIES:                                             08500000
*/**                                                                    08550000
*/**        SUPPORT OF VSE LIBRARIAN                                    08600000
*/**        PLS3 TO PLX/370 CONVERSION (FOR MSHP)       @D66GDMK        08610003
*/**                                                                    08650000
*/**     <...> DENOTES, THAT THIS PARAMETER IS OPTIONAL.                08700000
*/**                                                                    08750000
*/*   EJECT                                                             08800000
*/**  PARAMETER DESCRIPTION:                                            08850000
*/**                                                                    08900000
*/**    MF       SPECIFIES THE MAIN FUNCTION TO BE EXECUTED:            08950000
*/**               DCL    DEFINES THE STORAGE FOR THE CONTROL           09000000
*/**                      BLOCK AND                                     09050000
*/**                      SETS UP INFORMATION IN IT AS SPECIFIED        09100000
*/**                      BY THE OTHER PARAMETERS.(STATIC ALLOCATION,   09150000
*/**                      I.E. INLINE CONTROL BLOCK GENERATION)         09200000
*/**                      NON-SPECIFIED PARAMETERS ARE CLEARED.         09250000
*/**                      REGISTER NOTATION IS NOT ALLOWED              09300000
*/**                      FOR MF=DCL. A LABEL IS REQUIRED FOR           09350000
*/**                      FOR MF=DCL. AREA IS IGNORED FOR MF=DCL.       09400000
*/**               GEN    GENERATES THE CONTROL BLOCK                   09450000
*/**                      IN THE SPECIFIED AREA                         09500000
*/**                      AND SETS UP INFORMATION AS SPECIFIED BY       09550000
*/**                      THE OTHER PARAMETERS.(DYNAMIC ALLOCATION,     09600000
*/**                      I.E. STORAGE ADDRESSED BY AREA IS             09650000
*/**                      FILLED UP WITH THE SPECIFIED PARA-            09700000
*/**                      METERS). NON-SPECIFIED PARAMETERS             09750000
*/**                      ARE CLEARED.                                  09800000
*/**               MOD    MODIFIES THE CONTROL BLOCK IN THE             09850000
*/**                      SPECIFIED AREA AND SETS UP INFOR-             09900000
*/**                      MATION AS SPECIFIED BY THE OTHER              09950000
*/**                      PARAMETERS.(DYNAMIC ALLOCATION,               10000000
*/**                      I.E. STORAGE ADDRESSED BY AREA IS             10050000
*/**                      FILLED UP WITH THE SPECIFIED PARA-            10100000
*/**                      METERS). NON-SPECIFIED PARAMETERS             10150000
*/**                      REMAIN UNCHANGED.                             10200000
*/**               MAP    PROVIDES THE ABOVE SPECIFIED MAPS,            10250000
*/**                      UNLESS THEY HAVE BEEN GENERATED BY            10300000
*/**                      A PREVIOUS INLMLAMB OR OTHER LIBRARIAN        10350000
*/**                      MACRO IN THE MODULE.                          10400000
*/**                                                                    10450000
*/**   SBUFADR            SPECIFIES THE AREA, OBTAINED BY THE USER,     10500000
*/**                      WHERE THE SHARED BUFFER POOL IS INITIALIZED.  10550000
*/**                      THE SHARED BUFFER POOL IS PREREQUISITE FOR    10600000
*/**                      ANY TYPE OF INDEX I/O ON A LIBRARY (FOR       10650000
*/**                      LIBRARY DESCRIPTOR, SUBLIBRARY INDEX, MEMBER  10700000
*/**                      INDEX READ/WRITE).                            10750000
*/**                                                                    10800000
*/**  SBUFLEN             SPECIFIES A CONSTANT VALUE OF THE LENGTH OF   10850000
*/**                      THE SHARED BUFFER POOL.  THE LENGTH SHOULD    10900000
*/**                      BE APPROXIMATELY 5K (TO ALLOW FOR THREE       10950000
*/**                      LIBRARY BLOCKS OF 1K EACH PLUS OVERHEAD FOR   11000000
*/**                      BUFFER AND I/O CONTROL BLOCKS) IN CASE OF     11050000
*/**                      FUNCTIONS WHICH WRITE TO THE LIBRARY AND      11100000
*/**                      1.5 K (FOR ONE LIBRARY BLOCK BUFFER) IN THE   11150000
*/**                      CASE OF READ-ONLY FUNCTIONS.                  11200000
*/**                                                                    11250000
*/**  EXITLST             SPECIFIES A TABLE OF ADDRESSES USED AS        11300000
*/**                      EXITS AT CERTAIN EVENTS.  (NOT AVAILABLE      11350000
*/**                      FOR LEVEL 2 INTERFACE USER).                  11400000
*/**                                                                    11450000
*/**  GETVIS              PARTITION: ANY GETVIS REQUEST OF THE          11500000
*/**                                 LIBRARIAN SERVICES WILL BE         11550000
*/**                                 SATISFIED OUT OF THE PARTITION.    11600000
*/**                      SYSTEM:    ANY GETVIS REQUEST OF THE          11650000
*/**                                 LIBRARIAN SERVICES WILL BE         11700000
*/**                                 SATISFIED OUT OF THE SVA           11750000
*/**                                 (SYSTEM GETVIS AREA).              11800000
*/**                      (PARTITION IS THE DEFAULT VALUE.)             11850000
*/**                                                                    11900000
*/**  ERROR               RETURN:    IN ERROR CASES THE CONTROL         11950000
*/**                                 IS GIVEN BACK TO THE CALLER.       12000000
*/**                      CANCEL:    IN ERROR CASES WITHIN LIBRARIAN    12050000
*/**                                 SERVICES THE TASK WILL BE          12100000
*/**                                 CANCELED.                          12150000
*/**                      (RETURN IS THE DEFAULT VALUE.)                12200000
*/**                                                                    12250000
*/**  EXTEND              YES:       A LIBRARY IN VSAM MANAGED SPACE    12300000
*/**                                 WITH SECONDARY ALLOCATION IS       12350000
*/**                                 AUTOMATICALLY EXTENDED WHEN THE    12400000
*/**                                 SPACE IS EXHAUSTED (DEFAULT).      12450000
*/**                      NO:        NO EXTENSION IN VSAM MANAGED SPACE 12500000
*/**                                                                    12550000
*/**  LOCK                WAIT:      IF A RESOURCE IS ALREADY LOCKED,   12600000
*/**                                 THE SERVICE WILL WAIT UNTIL IT IS  12650000
*/**                                 FREED (DEFAULT).                   12700000
*/**                      RETURN:    IF A RESOURCE IS LOCKED, THE       12750000
*/**                                 SERVICE WILL RETURN.               12800000
*/**                                                                    12850000
*/**  LSTAREA             SPECIFIES THE MESSAGE BUFFER FOR SYSLST.      12900000
*/**                      THE BUFFER IS OBTAINED BY THE USER.           12950000
*/**                                                                    13000000
*/**  LSTLEN              GIVES THE (CONSTANT) LENGTH OF THE MESSAGE    13050000
*/**                      BUFFER FOR SYSLST. MAXIMUM SUPPORTED LENGTH   13100001
*/**                      IS 121 BYTES.                                 13150001
*/**                                                                    13200000
*/**  LOGAREA             SPECIFIES THE MESSAGE BUFFER FOR SYSLOG.      13250000
*/**                      THE BUFFER IS OBTAINED BY THE USER.           13300000
*/**                                                                    13350000
*/**  LOGLEN              GIVES THE (CONSTANT) LENGTH OF THE MESSAGE    13400000
*/**                      BUFFER FOR SYSLOG. MINIMUM IS 80 BYTES.       13450000
*/**                                                                    13500000
*/**  SYSLST              SPECIFIES THE DTF FOR SYSLST.                 13550000
*/**                      (IF SYSLST IS MISSING, BUT LSTAREA IS         13600000
*/**                      SPECIFIED, THE MESSAGE MODULE RETURNS         13650000
*/**                      THE REQUESTED MESSAGE IN THE BUFFER           13700000
*/**                      WITHOUT WRITING IT ON SYSLST).                13750000
*/**                                                                    13800000
*/**  SYSLOG              SPECIFIES THE DTF FOR SYSLOG.                 13850000
*/**                      (IF SYSLOG IS MISSING, BUT LOGAREA IS         13900000
*/**                      SPECIFIED, THE MESSAGE MODULE RETURNS         13950000
*/**                      THE REQUESTED MESSAGE IN THE BUFFER           14000000
*/**                      WITHOUT WRITING IT ON SYSLOG).                14050000
*/**                                                                    14100000
*/**  MSGID               GIVES THE NUMBER OF THE MESSAGE WHICH         14150000
*/**                      IS REQUESTED FROM THE MESSAGE ROUTINE.        14200000
*/**                      IT IS POSSIBLE TO SPECIFY UP TO 4 VARIABLE    14250000
*/**                      PARTS WITH THE MSGID WHICH ARE INSERTED       14300000
*/**                      INTO THE MESSAGE.                             14350000
*/**                                                                    14400000
*/**  MSGPAR1             VARIABLE MESSAGE PARTS, EACH OF WHICH HAS     14450000
*/**  MSGPAR2             THE STRUCTURE:                                14500000
*/**  MSGPAR3                    1 MSGPAR                               14550000
*/**  MSGPAR4                      2 MSGLEN BIN(8)  --- LENGTH          14600000
*/**                               2 MSGTXT CHAR(*) --- INSERTION TEXT  14650000
*/**                                                                    14700000
*/**  (MSGID, MSGPAR1, MSGPAR2, MSGPAR3, MSGPAR4 ARE FOR THE USE OF     14750000
*/**  THE LIBRARIAN PROGRAM).                                           14800000
*/**                                                                    14850000
*/**  (LSTAREA, LSTLEN, LOGAREA, LOGLEN, SYSLST, SYSLOG, MSGID,         14900000
*/**  MSGPAR1, MSGPAR2, MSGPAR3, MSGPAR4 FORM THE INTERFACE             14950000
*/**  PARAMETERS TO THE MESSAGE MODULE.)                                15000000
*/*  SPACE 5                                                            15050000
*/** VALID PARAMETERS FOR 'MF=DCL':                                     15100000
*/**      SBUFADR  *                                                    15150000
*/**      SBUFLEN  *                                                    15200000
*/**      EXITLST *                                                     15250000
*/**      GETVIS                                                        15300000
*/**      ERROR                                                         15350000
*/**      EXTEND                                                        15400000
*/**      LOCK                                                          15450000
*/**      LSTAREA *                * NO REGISTER NOTATION               15500000
*/**      LSTLEN   *                                                    15550000
*/**      LOGAREA  *                                                    15600000
*/**      LOGLEN   *                                                    15650000
*/**      MSGID    *                                                    15700000
*/**      MSGPAR1 *                                                     15750000
*/**      MSGPAR2 *                                                     15800000
*/**      MSGPAR3 *                                                     15850000
*/**      MSGPAR4 *                                                     15900000
*/**      SYSLST   *                                                    15950000
*/**      SYSLOG   *                                                    16000000
*/**                                                                    16050000
*/** VALID PARAMETERS FOR 'MF=GEN|MOD':                                 16100000
*/**      AREA                                                          16150000
*/**      SBUFADR                                                       16200000
*/**      SBUFLEN                                                       16250000
*/**      LSTAREA                  * NO REGISTER NOTATION               16300000
*/**      LSTLEN                                                        16350000
*/**      LOGAREA                                                       16400000
*/**      LOGLEN                                                        16450000
*/**      GETVIS                                                        16500000
*/**      ERROR                                                         16550000
*/**      EXTEND                                                        16600000
*/**      LOCK                                                          16650000
*/**      MSGID                                                         16700000
*/**      MSGPAR1                                                       16750000
*/**      MSGPAR2                                                       16800000
*/**      MSGPAR3                                                       16850000
*/**      MSGPAR4                                                       16900000
*/**      EXITLST                                                       16950000
*/**      SYSLST                                                        17000000
*/**      SYSLOG                                                        17050000
*/**                                                                    17100000
*/****  END OF SPECIFICATIONS  *************************************    17150000
*/** VALID PARAMETERS FOR 'MF=MAP':                                     17200000
*/**      NONE                                                          17250000
*/*   EJECT                                                             17300000
*/*   ENDMODULE INLMLAMB                                                17350000
.ENDPCP  ANOP                                                           17400000
.*                                                                      17450000
.*       DO NOT GENERATE DSECT FOR SYSCOM, IF &LBR0SCO = 1              17500000
.*                                                                      17550000
         AIF   (&LBR0SCO NE 0).NOSYSCO                                  17600000
SYSCOM   SYSCOM                    DSECT FOR SYSCOM                     17650000
&LBR0SCO SETA  1                                                        17700000
         EJECT                                                          17750000
.NOSYSCO ANOP                                                           17800000
         INLCLPT DSECT=YES,        DSECT FOR                           X17850000
               TABLE=YES,            LIBRARY POINTER TABLE AND         X17900000
               ROW=YES,              LIBRARY POINTER TABLE ROW         X17950000
               FCODE=YES             FUNCTION CODES                     18000000
         EJECT                                                          18050000
         INLCLAMB                  DSECT FOR CONTROL BLOCK              18100000
         EJECT                                                          18150000
&SYSECT  CSECT                     RESUME CSECT                         18200000
         AIF   ('&MF' NE 'MAP').CHKPARM                                 18250000
.*                                                                      18300000
.*       FOR MF=MAP NO OTHER PARAMETERS ARE VALID                       18350000
.*                                                                      18400000
&K1      SETA  (K'&AREA+K'&SBUFADR+K'&SBUFLEN+K'&EXITLST)               18450000
&K1      SETA  (&K1+K'&SYSLST+K'&SYSLOG+K'&LSTAREA+K'&LSTLEN)           18500000
&K1      SETA  (&K1+K'&LOGAREA+K'&LOGLEN+K'&MSGID+K'&MSGPAR1)           18550000
&K1      SETA  (&K1+K'&MSGPAR2+K'&MSGPAR3+K'&MSGPAR4)                   18600000
&K1      SETA  (&K1+K'&GETVIS+K'&ERROR+K'&EXTEND+K'&LOCK)               18650000
         AIF   (&K1 EQ 0).TERM                                          18700000
         MNOTE 4,'ALL OTHER PARAMETERS IGNORED FOR MF=MAP'              18750000
.TERM    ANOP                                                           18800000
         MEXIT                                                          18850000
.*                                                                      18900000
.*       CHECK MAIN FUNCTION                                            18950000
.*                                                                      19000000
.CHKPARM ANOP                                                           19050000
         AIF   (T'&MF NE 'O').CHECKMF                                   19100000
         AIF   ('&MF' NE '').CHECKMF                                    19150000
         MNOTE 8,'MF IS NOT SPECIFIED, GENERATION SUPPRESSED'           19200000
.*       SYNTAX CHECK CONTINUES                                         19250000
&SYNER1  SETB  1                                                        19300000
         AGO   .VALMF                                                   19350000
.CHECKMF ANOP                                                           19400000
         AIF   ('&MF' EQ 'DCL').VALMF                                   19450000
         AIF   ('&MF' EQ 'GEN').VALMF                                   19500000
         AIF   ('&MF' EQ 'MOD').VALMF                                   19550000
         AIF   ('&MF' EQ 'MAP').VALMF                                   19600000
         MNOTE 8,'MF REQUEST IS INVALID, GENERATION SUPPRESSED'         19650000
.*       SYNTAX CHECK CONTINUES                                         19700000
&SYNER1  SETB  1                                                        19750000
.VALMF   ANOP                                                           19800000
.*                                                                      19850000
.*       CROSS CHECKING FOR MF=DCL: AREA AND REGISTER NOTATION INVALID  19900000
.*                                                                      19950000
.*       CHECK IF AREA IS SPECIFIED FOR MF=DCL                          20000000
.*                                                                      20050000
         AIF   ('&MF' NE 'DCL').CHKMDGN                                 20100000
         AIF   (T'&AREA EQ 'O').VALDCL                                  20150000
         AIF   ('&AREA' EQ '').VALDCL                                   20200000
         MNOTE 4,'AREA IGNORED FOR MF=DCL'                              20250000
.*       SYNTAX CHECK CONTINUES                                         20300000
.VALDCL  ANOP                                                           20350000
.*                                                                      20400000
.*       CHECK REGISTER NOTATION FOR SBUFADR                            20450000
.*                                                                      20500000
         AIF   (T'&SBUFADR EQ 'O').CHKRDT                               20550000
         AIF   ('&SBUFADR' EQ '').CHKRDT                                20600000
         AIF   ('&SBUFADR'(1,1) NE '(').CHKRDT                          20650000
&REGERR  SETB  1                                                        20700000
.CHKRDT  ANOP                                                           20750000
.*                                                                      20800000
.*       CHECK REGISTER NOTATION FOR SBUFLEN                            20850000
.*                                                                      20900000
         AIF   (T'&SBUFLEN EQ 'O').CHKRLN                               20950000
         AIF   ('&SBUFLEN' EQ '').CHKRLN                                21000000
         AIF   ('&SBUFLEN'(1,1) NE '(').CHKRLN                          21050000
&REGERR  SETB  1                                                        21100000
.CHKRLN  ANOP                                                           21150000
.*                                                                      21200000
.*       CHECK REGISTER NOTATION FOR EXITLST                            21250000
.*                                                                      21300000
         AIF   (T'&EXITLST EQ 'O').CHKRXL                               21350000
         AIF   ('&EXITLST' EQ '').CHKRXL                                21400000
         AIF   ('&EXITLST'(1,1) NE '(').CHKRXL                          21450000
&REGERR  SETB  1                                                        21500000
.CHKRXL  ANOP                                                           21550000
.*                                                                      21600000
.*       CHECK REGISTER NOTATION FOR SYSLST                             21650000
.*                                                                      21700000
         AIF   (T'&SYSLST EQ 'O').CHKRIO                                21750000
         AIF   ('&SYSLST' EQ '').CHKRIO                                 21800000
         AIF   ('&SYSLST'(1,1) NE '(').CHKRIO                           21850000
&REGERR  SETB  1                                                        21900000
.CHKRIO  ANOP                                                           21950000
.*                                                                      22000000
.*       CHECK REGISTER NOTATION FOR SYSLOG                             22050000
.*                                                                      22100000
         AIF   (T'&SYSLOG EQ 'O').CHKRYO                                22150000
         AIF   ('&SYSLOG' EQ '').CHKRYO                                 22200000
         AIF   ('&SYSLOG'(1,1) NE '(').CHKRYO                           22250000
&REGERR  SETB  1                                                        22300000
.CHKRYO  ANOP                                                           22350000
.*                                                                      22400000
.*       CHECK REGISTER NOTATION FOR LSTAREA                            22450000
.*                                                                      22500000
         AIF   (T'&LSTAREA EQ 'O').CHKML                                22550000
         AIF   ('&LSTAREA' EQ '').CHKML                                 22600000
         AIF   ('&LSTAREA'(1,1) NE '(').CHKML                           22650000
&REGERR  SETB  1                                                        22700000
.CHKML   ANOP                                                           22750000
.*                                                                      22800000
.*       CHECK REGISTER NOTATION FOR LSTLEN                             22850000
.*                                                                      22900000
         AIF   (T'&LSTLEN EQ 'O').CHKLSA                                22950000
         AIF   ('&LSTLEN' EQ '').CHKLSA                                 23000000
         AIF   ('&LSTLEN'(1,1) NE '(').CHKLSA                           23050000
&REGERR  SETB  1                                                        23100000
.CHKLSA  ANOP                                                           23150000
.*                                                                      23200000
.*       CHECK REGISTER NOTATION FOR LOGAREA                            23250000
.*                                                                      23300000
         AIF   (T'&LOGAREA EQ 'O').CHKMLS                               23350000
         AIF   ('&LOGAREA' EQ '').CHKMLS                                23400000
         AIF   ('&LOGAREA'(1,1) NE '(').CHKMLS                          23450000
&REGERR  SETB  1                                                        23500000
.CHKMLS  ANOP                                                           23550000
.*                                                                      23600000
.*       CHECK REGISTER NOTATION FOR LOGLEN                             23650000
.*                                                                      23700000
         AIF   (T'&LOGLEN EQ 'O').CHKMID                                23750000
         AIF   ('&LOGLEN' EQ '').CHKMID                                 23800000
         AIF   ('&LOGLEN'(1,1) NE '(').CHKMID                           23850000
&REGERR  SETB  1                                                        23900000
.CHKMID  ANOP                                                           23950000
.*                                                                      24000000
.*       CHECK REGISTER NOTATION FOR MSGID                              24050000
.*                                                                      24100000
         AIF   (T'&MSGID EQ 'O').CHKMP1                                 24150000
         AIF   ('&MSGID' EQ '').CHKMP1                                  24200000
         AIF   ('&MSGID'(1,1) NE '(').CHKMP1                            24250000
&REGERR  SETB  1                                                        24300000
.CHKMP1  ANOP                                                           24350000
.*                                                                      24400000
.*       CHECK REGISTER NOTATION FOR MSGPAR1                            24450000
.*                                                                      24500000
         AIF   (T'&MSGPAR1 EQ 'O').CHKMP2                               24550000
         AIF   ('&MSGPAR1' EQ '').CHKMP2                                24600000
         AIF   ('&MSGPAR1'(1,1) NE '(').CHKMP2                          24650000
&REGERR  SETB  1                                                        24700000
.CHKMP2  ANOP                                                           24750000
.*                                                                      24800000
.*       CHECK REGISTER NOTATION FOR MSGPAR2                            24850000
.*                                                                      24900000
         AIF   (T'&MSGPAR2 EQ 'O').CHKMP3                               24950000
         AIF   ('&MSGPAR2' EQ '').CHKMP3                                25000000
         AIF   ('&MSGPAR2'(1,1) NE '(').CHKMP3                          25050000
&REGERR  SETB  1                                                        25100000
.CHKMP3  ANOP                                                           25150000
.*                                                                      25200000
.*       CHECK REGISTER NOTATION FOR MSGPAR3                            25250000
.*                                                                      25300000
         AIF   (T'&MSGPAR3 EQ 'O').CHKMP4                               25350000
         AIF   ('&MSGPAR3' EQ '').CHKMP4                                25400000
         AIF   ('&MSGPAR3'(1,1) NE '(').CHKMP4                          25450000
&REGERR  SETB  1                                                        25500000
.CHKMP4  ANOP                                                           25550000
.*                                                                      25600000
.*       CHECK REGISTER NOTATION FOR MSGPAR4                            25650000
.*                                                                      25700000
         AIF   (T'&MSGPAR4 EQ 'O').NOREG                                25750000
         AIF   ('&MSGPAR4' EQ '').NOREG                                 25800000
         AIF   ('&MSGPAR4'(1,1) NE '(').NOREG                           25850000
&REGERR  SETB  1                                                        25900000
.NOREG   ANOP                                                           25950000
         AIF   (NOT &REGERR).CHKFILN                                    26000000
         MNOTE 8,'NO REGISTER NOTATION FOR MF=DCL, GENERATION SUPPRESSEX26050000
               D'                                                       26100000
.*       SYNTAX CHECK CONTINUES                                         26150000
&SYNER1  SETB  1                                                        26200000
.CHKFILN ANOP                                                           26250000
         AIF   (T'&GETVIS EQ 'O').CHKERR                                26300000
         AIF   ('&GETVIS' EQ '').CHKERR                                 26350000
         AIF   ('&GETVIS' EQ 'PARTITION').CHKERR                        26400000
         AIF   ('&GETVIS' EQ 'SYSTEM').CHKERR                           26450000
         MNOTE 8,'GETVIS PARAMETER IS INVALID, GENERATION SUPPRESSED'   26500000
.*       SYNTAX CHECK CONTINUES                                         26550000
&SYNER1  SETB  1                                                        26600000
.CHKERR  ANOP                                                           26650000
         AIF   (T'&ERROR  EQ 'O').CHKXTND                               26700000
         AIF   ('&ERROR'  EQ '').CHKXTND                                26750000
         AIF   ('&ERROR'  EQ 'RETURN').CHKXTND                          26800000
         AIF   ('&ERROR'  EQ 'CANCEL').CHKXTND                          26850000
         MNOTE 8,'ERROR  PARAMETER IS INVALID, GENERATION SUPPRESSED'   26900000
.*       SYNTAX CHECK CONTINUES                                         26950000
&SYNER1  SETB  1                                                        27000000
.CHKXTND ANOP                                                           27050000
         AIF   (T'&EXTEND EQ 'O').CHKLOCK                               27100000
         AIF   ('&EXTEND' EQ '').CHKLOCK                                27150000
         AIF   ('&EXTEND' EQ 'YES').CHKLOCK                             27200000
         AIF   ('&EXTEND' EQ 'NO').CHKLOCK                              27250000
         MNOTE 8,'EXTEND PARAMETER IS INVALID, GENERATION SUPPRESSED'   27300000
.*       SYNTAX CHECK CONTINUES                                         27350000
&SYNER1  SETB  1                                                        27400000
.CHKLOCK ANOP                                                           27450000
         AIF   (T'&LOCK   EQ 'O').CHKMDGN                               27500000
         AIF   ('&LOCK'   EQ '').CHKMDGN                                27550000
         AIF   ('&LOCK'   EQ 'RETURN').CHKMDGN                          27600000
         AIF   ('&LOCK'   EQ 'WAIT').CHKMDGN                            27650000
         MNOTE 8,'LOCK   PARAMETER IS INVALID, GENERATION SUPPRESSED'   27700000
.*       SYNTAX CHECK CONTINUES                                         27750000
&SYNER1  SETB  1                                                        27800000
.CHKMDGN ANOP                                                           27850000
         AIF ('&MF' EQ 'DCL').CHKSYN                                    27900000
         AIF (T'&AREA NE 'O').CHKSYN                                    27950000
         AIF ('&AREA' NE '').CHKSYN                                     28000000
         AIF (&INNER).CHKSYN                                            28050000
         MNOTE 8,'AREA MUST BE SPECIFIED FOR MF=GEN|MOD, GENERATION SUPX28100000
               PRESSED'                                                 28150000
&SYNER1  SETB  1                                                        28200000
.CHKSYN  ANOP                                                           28250000
.*       CHECK DEPENDENCY BETWEEN MSGID, MSGPAR1,2,3,4                  28300000
.CHKDEP  ANOP                                                           28350000
         AIF (T'&MSGID EQ 'O').NOMID                                    28400000
         AIF ('&MSGID' EQ '').NOMID                                     28450000
         AIF (T'&MSGPAR1 EQ 'O').NOPART1                                28500000
         AIF ('&MSGPAR1' EQ '').NOPART1                                 28550000
         AIF (T'&MSGPAR2 EQ 'O').NOPART2                                28600000
         AIF ('&MSGPAR2' EQ '').NOPART2                                 28650000
         AIF (T'&MSGPAR3 EQ 'O').NOPART3                                28700000
         AIF ('&MSGPAR3' EQ '').NOPART3                                 28750000
         AGO .CHKSYNE                                                   28800000
.NOMID   ANOP                                                           28850000
         AIF (T'&MSGPAR1 EQ 'O').NOPART1                                28900000
         AIF ('&MSGPAR1' EQ '').NOPART1                                 28950000
&SYNER1  SETB1                                                          29000000
.NOPART1 ANOP                                                           29050000
         AIF (T'&MSGPAR2 EQ 'O').NOPART2                                29100000
         AIF ('&MSGPAR2' EQ '').NOPART2                                 29150000
&SYNER1  SETB1                                                          29200000
.NOPART2 ANOP                                                           29250000
         AIF (T'&MSGPAR3 EQ 'O').NOPART3                                29300000
         AIF ('&MSGPAR3' EQ '').NOPART3                                 29350000
&SYNER1  SETB1                                                          29400000
.NOPART3 ANOP                                                           29450000
         AIF (T'&MSGPAR4 EQ 'O').CHKSYNE                                29500000
         AIF ('&MSGPAR4' EQ '').CHKSYNE                                 29550000
&SYNER1  SETB1                                                          29600000
         MNOTE 8,'MESSAGE PARTS INCORRECTLY SPECIFIED'                  29650000
.*       GENERATION OF CODE IS SUPPRESSED IF A SYNTAX ERROR WAS         29700000
.*       FOUND INLMLAMB                                                 29750000
.*                                                                      29800000
.CHKSYNE ANOP                                                           29850000
         AIF   (NOT (&SYNER1 OR &SYNERR)).CHKGEN                        29900000
         AIF   (NOT &INNER).NOSYNER                                     29950000
&SYNERR  SETB  1                                                        30000000
.NOSYNER ANOP                                                           30050000
         MEXIT                                                          30100000
.CHKGEN  ANOP                                                           30150000
         AIF   ('&MF' EQ 'GEN' OR '&MF' EQ 'MOD').CHKGEN1               30200000
         AIF   ('&LABEL1' NE '').GENCB                                  30250000
         MNOTE 8,'NO LABEL FOR MF=DCL, GENERATION SUPPRESSED'           30300000
         MEXIT                                                          30350000
.GENCB   ANOP                                                           30400000
.*                                                                      30450000
.*       GENERATE INLINE CONTROL BLOCK WITH DC'S                        30500000
.*                                                                      30550000
&LABEL1  DS    0F                                                       30600000
         DC    XL72'0'               SAVE AREA                          30650000
         DC    CL4'LAMB'             TABLE ID                           30700000
         DC    CL4' '                HEADER                             30750000
         DC    F'0'                  ADDR OF SVA SERVICES               30800000
.*                                                                      30850000
.*       SBUFADR                                                        30900000
.*                                                                      30950000
         AIF   (T'&SBUFADR EQ 'O').NOINFO                               31000000
         AIF   ('&SBUFADR' EQ '').NOINFO                                31050000
         DC    A(&SBUFADR)            ADDRESS OF SHARED BUFFER          31100000
         AGO   .CHKSLN                                                  31150000
.NOINFO  ANOP                                                           31200000
         DC    F'0'                   ADDRESS OF SHARED BUFFER          31250000
.CHKSLN  ANOP                                                           31300000
.*                                                                      31350000
.*       SBUFLEN                                                        31400000
.*                                                                      31450000
         AIF   (T'&SBUFLEN EQ 'O').NOSBLN                               31500000
         AIF   ('&SBUFADR' EQ '').NOSBLN                                31550000
         DC    AL4(&SBUFLEN)          LENGTH OF SHARED BUFFER           31600000
         AGO   .CHKLST                                                  31650000
.NOSBLN  ANOP                                                           31700000
         DC    F'0'                   LENGTH OF SHARED BUFFER           31750000
.CHKLST  ANOP                                                           31800000
.*                                                                      31850000
.*       SYSLST                                                         31900000
.*                                                                      31950000
         AIF   (T'&SYSLST EQ 'O').NOLST                                 32000000
         AIF   ('&SYSLST' EQ '').NOLST                                  32050000
         DC    A(&SYSLST)             DTF FOR SYSLST                    32100000
         AGO   .CHKLOG                                                  32150000
.NOLST   ANOP                                                           32200000
         DC    F'0'                   DTF FOR SYSLST                    32250000
.CHKLOG  ANOP                                                           32300000
.*                                                                      32350000
.*       SYSLOG                                                         32400000
.*                                                                      32450000
         AIF   (T'&SYSLOG EQ 'O').NOLOG                                 32500000
         AIF   ('&SYSLOG' EQ '').NOLOG                                  32550000
         DC    A(&SYSLOG)             DTF FOR SYSLOG                    32600000
         AGO   .CHKIOAS                                                 32650000
.NOLOG   ANOP                                                           32700000
         DC    F'0'                   DTF FOR SYSLOG                    32750000
.CHKIOAS ANOP                                                           32800000
.*                                                                      32850000
.*       LSTAREA                                                        32900000
.*                                                                      32950000
         AIF   (T'&LSTAREA EQ 'O').NOIOAS                               33000000
         AIF   ('&LSTAREA' EQ '').NOIOAS                                33050000
         DC    A(&LSTAREA)            LSTAREA                           33100000
         AGO   .CHKIOLS                                                 33150000
.NOIOAS  ANOP                                                           33200000
         DC    F'0'                   LSTAREA                           33250000
.CHKIOLS ANOP                                                           33300000
.*                                                                      33350000
.*       LSTLEN                                                         33400000
.*                                                                      33450000
         AIF   (T'&LSTLEN EQ 'O').NOMLN                                 33500000
         AIF   ('&LSTLEN' EQ '').NOMLN                                  33550000
         DC    AL4(&LSTLEN)           LSTLEN                            33600000
         AGO   .MLNADR                                                  33650000
.NOMLN   ANOP                                                           33700000
         DC    F'0'                   LSTLEN                            33750000
.MLNADR  ANOP                                                           33800000
.*                                                                      33850000
.*       LOGAREA                                                        33900000
.*                                                                      33950000
         AIF   (T'&LOGAREA EQ 'O').NOIOAO                               34000000
         AIF   ('&LOGAREA' EQ '').NOIOAO                                34050000
         DC    A(&LOGAREA)            LOGAREA                           34100000
         AGO   .CHKIOLO                                                 34150000
.NOIOAO  ANOP                                                           34200000
         DC    F'0'                   LOGAREA                           34250000
.CHKIOLO ANOP                                                           34300000
.*                                                                      34350000
.*       LOGLEN                                                         34400000
.*                                                                      34450000
         AIF   (T'&LOGLEN EQ 'O').NOOLN                                 34500000
         AIF   ('&LOGLEN' EQ '').NOOLN                                  34550000
         DC    AL4(&LOGLEN)           LOGLEN                            34600000
         AGO   .OLNADR                                                  34650000
.NOOLN   ANOP                                                           34700000
         DC    F'0'                   LOGLEN                            34750000
.OLNADR  ANOP                                                           34800000
.*                                                                      34850000
.*       MSGID                                                          34900000
.*                                                                      34950000
         AIF   (T'&MSGID EQ 'O').NOID                                   35000000
         AIF   ('&MSGID' EQ '').NOID                                    35050000
         DC    AL4(&MSGID)            MSGID                             35100000
         AGO   .CHKPT1                                                  35150000
.NOID    ANOP                                                           35200000
         DC    F'0'                   MSGID                             35250000
.CHKPT1  ANOP                                                           35300000
.*                                                                      35350000
.*       MSGPAR1                                                        35400000
.*                                                                      35450000
         AIF   (T'&MSGPAR1 EQ 'O').NOPT1                                35500000
         AIF   ('&MSGPAR1' EQ '').NOPT1                                 35550000
         DC    A(&MSGPAR1)            MSGPAR1                           35600000
         AGO   .CHKPT2                                                  35650000
.NOPT1   ANOP                                                           35700000
         DC    F'0'                   MSGPAR1                           35750000
.CHKPT2  ANOP                                                           35800000
.*                                                                      35850000
.*       MSGPAR2                                                        35900000
.*                                                                      35950000
         AIF   (T'&MSGPAR2 EQ 'O').NOPT2                                36000000
         AIF   ('&MSGPAR2' EQ '').NOPT2                                 36050000
         DC    A(&MSGPAR2)            MSGPAR2                           36100000
         AGO   .CHKPT3                                                  36150000
.NOPT2   ANOP                                                           36200000
         DC    F'0'                   MSGPAR2                           36250000
.CHKPT3  ANOP                                                           36300000
.*                                                                      36350000
.*       MSGPAR3                                                        36400000
.*                                                                      36450000
         AIF   (T'&MSGPAR3 EQ 'O').NOPT3                                36500000
         AIF   ('&MSGPAR3' EQ '').NOPT3                                 36550000
         DC    A(&MSGPAR3)            MSGPAR3                           36600000
         AGO   .CHKPT4                                                  36650000
.NOPT3   ANOP                                                           36700000
         DC    F'0'                   MSGPAR3                           36750000
.CHKPT4  ANOP                                                           36800000
.*                                                                      36850000
.*       MSGPAR4                                                        36900000
.*                                                                      36950000
         AIF   (T'&MSGPAR4 EQ 'O').NOPT4                                37000000
         AIF   ('&MSGPAR4' EQ '').NOPT4                                 37050000
         DC    A(&MSGPAR4)            MSGPAR4                           37100000
         AGO   .CHKPT5                                                  37150000
.NOPT4   ANOP                                                           37200000
         DC    F'0'                   MSGPAR4                           37250000
.CHKPT5  ANOP                                                           37300000
.*                                                                      37350000
.*       EXITLST                                                        37400000
.*                                                                      37450000
         AIF   (T'&EXITLST EQ 'O').NOXTL                                37500000
         AIF   ('&EXITLST' EQ '').NOXTL                                 37550000
         DC    A(&EXITLST)            EXITLST                           37600000
         AGO   .SETFLG                                                  37650000
.NOXTL   ANOP                                                           37700000
         DC    F'0'                   EXITLST                           37750000
.SETFLG  ANOP                                                           37800000
         AIF   (T'&ERROR EQ 'O').SETERR0                                37850000
         AIF   ('&ERROR' EQ '').SETERR0                                 37900000
         AIF   ('&ERROR' NE 'CANCEL').SETERR0                           37950000
&PARM    SETC  '01'                                                     38000000
         AGO   .SETLOCK                                                 38050000
.SETERR0 ANOP                                                           38100000
&PARM    SETC  '00'                                                     38150000
.SETLOCK ANOP                                                           38200000
&PARM    SETC  '&PARM'.'000'                                            38250000
         AIF   ('&LOCK' EQ 'O').SETFAI0                                 38300000
         AIF   ('&LOCK' EQ '').SETFAI0                                  38350000
         AIF   ('&LOCK' NE 'RETURN').SETFAI0                            38400000
&PARM    SETC  '&PARM'.'1'                                              38450000
         AGO   .SETXTND                                                 38500000
.SETFAI0 ANOP                                                           38550000
&PARM    SETC  '&PARM'.'0'                                              38600000
.SETXTND ANOP                                                           38650000
         AIF   ('&EXTEND' EQ 'O').SETXTN0                               38700000
         AIF   ('&EXTEND' EQ '').SETXTN0                                38750000
         AIF   ('&EXTEND' NE 'NO').SETXTN0                              38800000
&PARM    SETC  '&PARM'.'1'                                              38850000
         AGO   .SETSVIS                                                 38900000
.SETXTN0 ANOP                                                           38950000
&PARM    SETC  '&PARM'.'0'                                              39000000
.SETSVIS ANOP                                                           39050000
         AIF   (T'&GETVIS EQ 'O').SETPVIS                               39100000
         AIF   ('&GETVIS' EQ '').SETPVIS                                39150000
         AIF   ('&GETVIS' NE 'SYSTEM').SETPVIS                          39200000
&PARM    SETC  '&PARM'.'1'                                              39250000
         AGO   .XTLADR                                                  39300000
.SETPVIS ANOP                                                           39350000
&PARM    SETC  '&PARM'.'0'                                              39400000
.XTLADR  ANOP                                                           39450000
         DC    B'&PARM'               SWITCH BYTE 1                     39500000
         DC    X'00'                  SWITCH BYTE 2                     39550000
         DC    H'0'                   RESERVED                          39600000
         DC    H'0'                   RESERVED                          39650000
         DC    H'0'                   RESERVED                          39700000
         CRSPID NAME=INLG             SUBPOOL ID FOR AUTOMATIC STORAGE  39750000
         DC    F'0'                   RESERVED                          39800000
         DC    F'0'                   RESERVED                          39850000
         DC    F'0'                   RESERVED                          39900000
         DC    F'0'                   RESERVED                          39950000
         DC    F'0'                   RESERVED                          40000000
         MEXIT                                                          40050000
.CHKGEN1 ANOP                                                           40100000
.*                                                                      40150000
.*       DYNAMIC GENERATION OR MODIFICATION OF CONTROL BLOCK            40200000
.*                                                                      40250000
         AIF   ('&LABEL1' EQ '').NOLAB                                  40300000
&LABEL1  DS    0H                                                       40350000
.NOLAB   ANOP                                                           40400000
.*                                                                      40450000
.*       ADDRESSING OF CONTROL BLOCK VIA REGISTER 1                     40500000
.*                                                                      40550000
         AIF   ('&AREA' EQ '(1)').USING1                                40600000
         AIF   ('&AREA'(1,1) NE '(').NRAR                               40650000
&REG     SETC  '&AREA'(2,K'&AREA-2)                                     40700000
         LR    AMBACCR1,&REG         ADDRESS OF CONTROL BLOCK           40750000
         AGO   .USING1                                                  40800000
.NRAR    ANOP                                                           40850000
         LA    AMBACCR1,&AREA        ADDRESS OF CONTROL BLOCK           40900000
.USING1  ANOP                                                           40950000
         USING INLCLAMB,AMBACCR1     ADDRESSABILITY FOR CONTROL BLOCK   41000000
         AIF   ('&MF' NE 'GEN').NOTGEN                                  41050000
.*                                                                      41100000
.*       FOR MF=GEN THE CONTROL BLOCK MUST BE CLEARED                   41150000
.*                                                                      41200000
         XC    INLCLAMB(LAMBLNG),INLCLAMB CLEAR CONTROL BLOCK           41250000
         B     *+8                                                      41300000
LAMB&SYSNDX DC CL4'LAMB'                                                41350000
         MVC   LAMBID,LAMB&SYSNDX                                       41400000
.NOTGEN  ANOP                                                           41450000
.*                                                                      41500000
.*       INSERT SBUFADR, IF SPECIFIED                                   41550000
.*                                                                      41600000
         AIF   (T'&SBUFADR EQ 'O').CHKSLN1                              41650000
         AIF   ('&SBUFADR' EQ '').CHKSLN1                               41700000
         AIF   ('&SBUFADR'(1,1) NE '(').NRSLN1                          41750000
&REG     SETC  '&SBUFADR'(2,K'&SBUFADR-2)                               41800000
         ST    &REG,LAMBSBUF         INSERT SBUFADR                     41850000
         NI    LAMBSW2,X'FF'-LAMBSBIN                                   41900000
         AGO   .CHKSLN1                                                 41950000
.NRSLN1  ANOP                                                           42000000
         LA    AMBACCR0,&SBUFADR                                        42050000
         ST    AMBACCR0,LAMBSBUF     INSERT SBUFADR                     42100000
         NI    LAMBSW2,X'FF'-LAMBSBIN                                   42150000
.CHKSLN1 ANOP                                                           42200000
.*                                                                      42250000
.*       INSERT SBUFLEN, IF SPECIFIED                                   42300000
.*                                                                      42350000
         AIF   (T'&SBUFLEN EQ 'O').CHKDTF1                              42400000
         AIF   ('&SBUFLEN' EQ '').CHKDTF1                               42450000
         AIF   ('&SBUFLEN'(1,1) NE '(').NRSLEN                          42500000
&REG     SETC  '&SBUFLEN'(2,K'&SBUFLEN-2)                               42550000
         ST    &REG,LAMBLBUF         INSERT SBUFLEN                     42600000
         AGO   .CHKDTF1                                                 42650000
.NRSLEN  ANOP                                                           42700000
         LA    AMBACCR0,&SBUFLEN                                        42750000
         ST    AMBACCR0,LAMBLBUF     INSERT SBUFLEN                     42800000
.CHKDTF1 ANOP                                                           42850000
.*                                                                      42900000
.*       INSERT SYSLST, IF SPECIFIED                                    42950000
.*                                                                      43000000
         AIF   (T'&SYSLST EQ 'O').CHKLOG1                               43050000
         AIF   ('&SYSLST' EQ '').CHKLOG1                                43100000
         AIF   ('&SYSLST'(1,1) NE '(').NRLST                            43150000
&REG     SETC  '&SYSLST'(2,K'&SYSLST-2)                                 43200000
         ST    &REG,LAMBLST          INSERT SYSLST                      43250000
         AGO   .CHKLOG1                                                 43300000
.NRLST   ANOP                                                           43350000
         LA    AMBACCR0,&SYSLST                                         43400000
         ST    AMBACCR0,LAMBLST      INSERT SYSLST                      43450000
.CHKLOG1 ANOP                                                           43500000
.*                                                                      43550000
.*       INSERT SYSLOG, IF SPECIFIED                                    43600000
.*                                                                      43650000
         AIF   (T'&SYSLOG EQ 'O').CHKIOA1                               43700000
         AIF   ('&SYSLOG' EQ '').CHKIOA1                                43750000
         AIF   ('&SYSLOG'(1,1) NE '(').NRLOG                            43800000
&REG     SETC  '&SYSLOG'(2,K'&SYSLOG-2)                                 43850000
         ST    &REG,LAMBLOG          INSERT SYSLOG                      43900000
         AGO   .CHKIOA1                                                 43950000
.NRLOG   ANOP                                                           44000000
         LA    AMBACCR0,&SYSLOG                                         44050000
         ST    AMBACCR0,LAMBLOG      INSERT SYSLOG                      44100000
.CHKIOA1 ANOP                                                           44150000
.*                                                                      44200000
.*       INSERT LSTAREA, IF SPECIFIED                                   44250000
.*                                                                      44300000
         AIF   (T'&LSTAREA EQ 'O').CHKMLN1                              44350000
         AIF   ('&LSTAREA' EQ '').CHKMLN1                               44400000
         AIF   ('&LSTAREA'(1,1) NE '(').NRMLN                           44450000
&REG     SETC  '&LSTAREA'(2,K'&LSTAREA-2)                               44500000
         ST    &REG,LAMBLSTA         INSERT LSTAREA                     44550000
         AGO   .CHKMLN1                                                 44600000
.NRMLN   ANOP                                                           44650000
         LA    AMBACCR0,&LSTAREA                                        44700000
         ST    AMBACCR0,LAMBLSTA     INSERT LSTAREA                     44750000
.CHKMLN1 ANOP                                                           44800000
.*                                                                      44850000
.*       INSERT LSTLEN, IF SPECIFIED                                    44900000
.*                                                                      44950000
         AIF   (T'&LSTLEN EQ 'O').CHKIOA2                               45000000
         AIF   ('&LSTLEN' EQ '').CHKIOA2                                45050000
         AIF   ('&LSTLEN'(1,1) NE '(').NRMLE                            45100000
&REG     SETC  '&LSTLEN'(2,K'&LSTLEN-2)                                 45150000
         ST    &REG,LAMBLSTL         INSERT LSTLEN                      45200000
         AGO   .CHKIOA2                                                 45250000
.NRMLE   ANOP                                                           45300000
         LA    AMBACCR0,&LSTLEN                                         45350000
         ST    AMBACCR0,LAMBLSTL     INSERT LSTLEN                      45400000
.CHKIOA2 ANOP                                                           45450000
.*                                                                      45500000
.*       INSERT LOGAREA, IF SPECIFIED                                   45550000
.*                                                                      45600000
         AIF   (T'&LOGAREA EQ 'O').CHKMLN2                              45650000
         AIF   ('&LOGAREA' EQ '').CHKMLN2                               45700001
         AIF   ('&LOGAREA'(1,1) NE '(').NRMLN2                          45750000
&REG     SETC  '&LOGAREA'(2,K'&LOGAREA-2)                               45800000
         ST    &REG,LAMBLOGA         INSERT LOGAREA                     45850000
         AGO   .CHKMLN2                                                 45900000
.NRMLN2  ANOP                                                           45950000
         LA    AMBACCR0,&LOGAREA                                        46000000
         ST    AMBACCR0,LAMBLOGA     INSERT LOGAREA                     46050000
.CHKMLN2 ANOP                                                           46100000
.*                                                                      46150000
.*       INSERT LOGLEN, IF SPECIFIED                                    46200000
.*                                                                      46250000
         AIF   (T'&LOGLEN EQ 'O').CHKXTL2                               46300000
         AIF   ('&LOGLEN' EQ '').CHKXTL2                                46350000
         AIF   ('&LOGLEN'(1,1) NE '(').NRMLE2                           46400000
&REG     SETC  '&LOGLEN'(2,K'&LOGLEN-2)                                 46450000
         ST    &REG,LAMBLOGL         INSERT LOGLEN                      46500000
         AGO   .CHKXTL2                                                 46550000
.NRMLE2  ANOP                                                           46600000
         LA    AMBACCR0,&LOGLEN                                         46650000
         ST    AMBACCR0,LAMBLOGL     INSERT LOGLEN                      46700000
.CHKXTL2 ANOP                                                           46750000
.*                                                                      46800000
.*       INSERT MSGID, IF SPECIFIED                                     46850000
.*                                                                      46900000
         AIF   (T'&MSGID EQ 'O').CHKMGP1                                46950000
         AIF   ('&MSGID' EQ '').CHKMGP1                                 47000000
         XC    LAMBMSG1,LAMBMSG1                                        47050000
         XC    LAMBMSG2,LAMBMSG2                                        47100000
         XC    LAMBMSG3,LAMBMSG3                                        47150000
         XC    LAMBMSG4,LAMBMSG4                                        47200000
         AIF   ('&MSGID'(1,1) NE '(').NRMLID                            47250000
&REG     SETC  '&MSGID'(2,K'&MSGID-2)                                   47300000
         ST    &REG,LAMBMID          INSERT MSGID                       47350000
         AGO   .CHKMGP1                                                 47400000
.NRMLID  ANOP                                                           47450000
         LA    AMBACCR0,&MSGID                                          47500000
         ST    AMBACCR0,LAMBMID      INSERT MSGID                       47550000
.CHKMGP1 ANOP                                                           47600000
.*                                                                      47650000
.*       INSERT MSGPAR1, IF SPECIFIED                                   47700000
.*                                                                      47750000
         AIF   (T'&MSGPAR1 EQ 'O').CHKMGP2                              47800000
         AIF   ('&MSGPAR1' EQ '').CHKMGP2                               47850000
         AIF   ('&MSGPAR1'(1,1) NE '(').NRMLP1                          47900000
&REG     SETC  '&MSGPAR1'(2,K'&MSGPAR1-2)                               47950000
         ST    &REG,LAMBMSG1         INSERT MSGPAR1                     48000000
         AGO   .CHKMGP2                                                 48050000
.NRMLP1  ANOP                                                           48100000
         LA    AMBACCR0,&MSGPAR1                                        48150000
         ST    AMBACCR0,LAMBMSG1     INSERT MSGPAR1                     48200000
.CHKMGP2 ANOP                                                           48250000
.*                                                                      48300000
.*       INSERT MSGPAR2, IF SPECIFIED                                   48350000
.*                                                                      48400000
         AIF   (T'&MSGPAR2 EQ 'O').CHKMGP3                              48450000
         AIF   ('&MSGPAR2' EQ '').CHKMGP3                               48500000
         AIF   ('&MSGPAR2'(1,1) NE '(').NRMLP2                          48550000
&REG     SETC  '&MSGPAR2'(2,K'&MSGPAR2-2)                               48600000
         ST    &REG,LAMBMSG2         INSERT MSGPAR2                     48650000
         AGO   .CHKMGP3                                                 48700000
.NRMLP2  ANOP                                                           48750000
         LA    AMBACCR0,&MSGPAR2                                        48800000
         ST    AMBACCR0,LAMBMSG2     INSERT MSGPAR2                     48850000
.CHKMGP3 ANOP                                                           48900000
.*                                                                      48950000
.*       INSERT MSGPAR3, IF SPECIFIED                                   49000000
.*                                                                      49050000
         AIF   (T'&MSGPAR3 EQ 'O').CHKMGP4                              49100000
         AIF   ('&MSGPAR3' EQ '').CHKMGP4                               49150000
         AIF   ('&MSGPAR3'(1,1) NE '(').NRMLP3                          49200000
&REG     SETC  '&MSGPAR3'(2,K'&MSGPAR3-2)                               49250000
         ST    &REG,LAMBMSG3         INSERT MSGPAR3                     49300000
         AGO   .CHKMGP4                                                 49350000
.NRMLP3  ANOP                                                           49400000
         LA    AMBACCR0,&MSGPAR3                                        49450000
         ST    AMBACCR0,LAMBMSG3     INSERT MSGPAR3                     49500000
.CHKMGP4 ANOP                                                           49550000
.*                                                                      49600000
.*       INSERT MSGPAR4, IF SPECIFIED                                   49650000
.*                                                                      49700000
         AIF   (T'&MSGPAR4 EQ 'O').CHKMGP5                              49750000
         AIF   ('&MSGPAR4' EQ '').CHKMGP5                               49800000
         AIF   ('&MSGPAR4'(1,1) NE '(').NRMLP4                          49850000
&REG     SETC  '&MSGPAR4'(2,K'&MSGPAR4-2)                               49900000
         ST    &REG,LAMBMSG4         INSERT MSGPAR4                     49950000
         AGO   .CHKMGP5                                                 50000000
.NRMLP4  ANOP                                                           50050000
         LA    AMBACCR0,&MSGPAR4                                        50100000
         ST    AMBACCR0,LAMBMSG4     INSERT MSGPAR4                     50150000
.CHKMGP5 ANOP                                                           50200000
.*                                                                      50250000
.*       INSERT GETVIS,  IF SPECIFIED                                   50300000
.*                                                                      50350000
         AIF   (T'&GETVIS  EQ 'O').CHKERR1                              50400000
         AIF   ('&GETVIS'  EQ '').CHKERR1                               50450000
         AIF   ('&GETVIS'  EQ 'PARTITION').SETPVS1                      50500000
         OI    LAMBSW1,LAMBSVIS       SYSTEM GETVIS REQUIRED            50550000
         AGO   .CHKERR1                                                 50600000
.SETPVS1 ANOP                                                           50650000
         NI    LAMBSW1,X'FF'-LAMBSVIS      PARTITION GETVIS             50700000
.CHKERR1 ANOP                                                           50750000
.*                                                                      50800000
.*       INSERT ERROR,   IF SPECIFIED                                   50850000
.*                                                                      50900000
         AIF   (T'&ERROR   EQ 'O').CHKXTN1                              50950000
         AIF   ('&ERROR'  EQ '').CHKXTN1                                51000000
         AIF   ('&ERROR'  EQ 'RETURN').SETRET1                          51050000
         OI    LAMBSW1,LAMBERR             ERROR = CANCEL               51100000
         AGO   .CHKXTN1                                                 51150000
.SETRET1 ANOP                                                           51200000
         NI    LAMBSW1,X'FF'-LAMBERR       ERROR = RETURN               51250000
.CHKXTN1 ANOP                                                           51300000
.*                                                                      51350000
.*       INSERT EXTEND,  IF SPECIFIED                                   51400000
.*                                                                      51450000
         AIF   (T'&EXTEND  EQ 'O').CHKFAI1                              51500000
         AIF   ('&EXTEND' EQ '').CHKFAI1                                51550000
         AIF   ('&EXTEND' EQ 'YES').SETYES1                             51600000
         OI    LAMBSW1,LAMBXTND            EXTEND = NO                  51650000
         AGO   .CHKFAI1                                                 51700000
.SETYES1 ANOP                                                           51750000
         NI    LAMBSW1,X'FF'-LAMBXTND      EXTEND = YES                 51800000
.CHKFAI1 ANOP                                                           51850000
.*                                                                      51900000
.*       INSERT LOCK,    IF SPECIFIED                                   51950000
.*                                                                      52000000
         AIF   (T'&LOCK    EQ 'O').CHKEXT1                              52050000
         AIF   ('&LOCK'   EQ '').CHKEXT1                                52100000
         AIF   ('&LOCK' EQ   'WAIT').SETWAI1                            52150000
         OI    LAMBSW1,LAMBLOCK            LOCK = RETURN                52200000
         AGO   .CHKEXT1                                                 52250000
.SETWAI1 ANOP                                                           52300000
         NI    LAMBSW1,X'FF'-LAMBLOCK      LOCK = WAIT                  52350000
.CHKEXT1 ANOP                                                           52400000
.*                                                                      52450000
.*       INSERT EXITLST, IF SPECIFIED                                   52500000
.*                                                                      52550000
         AIF   (T'&EXITLST EQ 'O').CHKMF1                               52600000
         AIF   ('&EXITLST' EQ '').CHKMF1                                52650000
         AIF   ('&EXITLST'(1,1) NE '(').NRXTL                           52700000
&REG     SETC  '&EXITLST'(2,K'&EXITLST-2)                               52750000
         ST    &REG,LAMBEXTL         INSERT EXITLST                     52800000
         AGO   .CHKMF1                                                  52850000
.NRXTL   ANOP                                                           52900000
         LA    AMBACCR0,&EXITLST                                        52950000
         ST    AMBACCR0,LAMBEXTL     INSERT EXITLST                     53000000
.CHKMF1  ANOP                                                           53050000
         AIF (&LAMBSPD NE 0).NOSPID                                     53100000
         B    *+12                                                      53150000
LAMBCRSP CRSPID NAME=INLG                                               53200000
         MVC   LAMBSPID(4),LAMBCRSP                                     53250000
&LAMBSPD SETA  1                                                        53300000
.NOSPID  ANOP                                                           53350000
         DROP  AMBACCR1                                                 53400000
         MEND                             END OF PLS COMMENT         */ 53450000
*%PLSMLAMB:;                                                            53500000
*%INLMLAMB: MACRO KEYS(MF,                                              53550000
*                      AREA,                                            53600000
*                      SBUFADR,                                         53650000
*                      SBUFLEN,                                         53700000
*                      EXITLST,                                         53750000
*                      GETVIS,                                          53800000
*                      ERROR,                                           53850000
*                      EXTEND,                                          53900000
*                      LOCK,                                            53950000
*                      SYSLST,                                          54000000
*                      SYSLOG,                                          54050000
*                      LSTAREA,                                         54100000
*                      LSTLEN,                                          54150000
*                      LOGAREA,                                         54200000
*                      LOGLEN,                                          54250000
*                      MSGID,                                           54300000
*                      MSGPAR1,                                         54350000
*                      MSGPAR2,                                         54400000
*                      MSGPAR3,                                         54450000
*                      MSGPAR4);                                        54500000
* /*******************************************************************/ 54550000
* /*  PLS PART OF INLMLAMB MACRO, DESCRIPTION SEE ASM PART           */ 54600000
* /*******************************************************************/ 54650000
* DCL (SYNERR,                        /* SYNTAX ERROR IN MACRO       */ 54700000
*      INNER,                         /* INLMLAMB IS INNER MACRO     */ 54750000
*      RC,                            /* RETURN CODE                 */ 54800000
*      LBRACMP,                       /* CONTROLS GENERATION OF MAPS */ 54850000
*      LBR0SCO)                       /* CONTROLS DSECT OF SYSCOM    */ 54900000
*      FIXED EXTERNAL;                                                  54950000
* DCL (FC,                            /* MAIN FUNCTION OF MACRO      */ 55000000
*      TAREA)                         /* ADDRESS OF CONTROL BLOCK    */ 55050000
*      CHARACTER EXTERNAL;                                              55100000
* DCL (IN,IN1,TLABEL,TINFO,TBYTE,TERR,TVIS) CHARACTER;                  55150000
* DCL (COL1,COLA,COLB,COLC,COLD,RCL,SYNER1,REGERR,RCWARN,RCERR,         55200000
*      CHAREA) FIXED;                                                   55250000
* COL1 = MACGLMAR;                                                      55300000
* COLA = MACLMAR;                                                       55350000
* COLB = COLA+13;                                                       55400000
* COLC = COLB+10;                                                       55450000
* COLD = COLC+12;                                                       55500000
* RCWARN = 4;                                                           55550000
* RCERR = 8;                                                            55600000
* TRUE = '''1''B';                                                      55650000
* RCL = 0;                                                              55700000
* IN = MACLABEL||' '||MACNAME||' '||MACLIST||' '||MACKEYS;              55750000
* IN1 = ' LIBRARIAN - INLMLAMB - 5666-301-06-H07 - VERSION 84-01-05';   55800000
* /*******************************************************************/ 55850000
* /*  DO NOT GENERATE ANY MAPS OR EQUATES, IF LBRACMP = 1            */ 55900000
* /*******************************************************************/ 55950000
*    IF MF(1) = 'MAP' THEN                                              56000000
*       DO;                                                             56050000
*       ANS (COMMENT(IN)) COL(COLA) SKIP RESCAN;                        56100000
*       ANS (COMMENT(IN1)) COL(COLA) SKIP RESCAN;                       56150000
*       END;                                                            56200000
*    ANS ('? INLCLPT BASED(YES) TABLE(YES) ROW(YES) FCODE(YES);')       56250000
*           COL(COLA) SKIP RESCAN;                                      56300000
*    ANS ('? INLCLAMB;') COL(COLA) SKIP RESCAN;                         56350000
* /*******************************************************************/ 56400000
* /*  DO NOT GENERATE DSECT FOR SYSCOM, IF LBR0SCO = 1               */ 56450000
* /*******************************************************************/ 56500000
*    IF LBR0SCO = 0 THEN                                                56550000
*       DO;                                                             56600000
*       ANS ('%INCLUDE SYSLIB(SYSCOM) NOSEGMENT;')        /* @D66GDMK*/ 56650004
*                                        COL(COLA) SKIP;  /* @D66GDMK*/ 56660004
*       LBR0SCO = 1;                                                    56800000
*       END;                                                            56850000
* /*******************************************************************/ 56900000
* /*  FOR MF(MAP) NO OTHER PARAMETERS ARE VALID                      */ 56950000
* /*******************************************************************/ 57000000
* IF MF(1) = 'MAP' THEN                                                 57050000
*    DO;                                                                57100000
*    IF NUMBER(AREA) +                                                  57150000
*       NUMBER(LOGAREA) + NUMBER(SBUFADR) + NUMBER(SBUFLEN) +           57200000
*       NUMBER(LSTAREA) + NUMBER(LSTLEN) + NUMBER(MSGID)    +           57250000
*       NUMBER(MSGPAR1) + NUMBER(MSGPAR2) + NUMBER(MSGPAR3) +           57300000
*       NUMBER(MSGPAR4) + NUMBER(GETVIS) + NUMBER(ERROR) +              57350000
*       NUMBER(EXTEND) + NUMBER(LOCK) +                                 57400000
*       NUMBER(SYSLST) + NUMBER(SYSLOG) +                               57450000
*       NUMBER(LOGLEN) + NUMBER(EXITLST) = 0 THEN                      57500000
*       DO;                                                             57550000
*       ANS MSG ('ALL OTHER PARAMETERS IGNORED FOR MF(MAP)')            57600000
*                 SKIP COL(COLA);                                       57650000
*       RCL = RCWARN;                                                   57700000
*       END;                                                            57750000
*    GOTO MEND;                                                         57800000
*    END;                                                               57850000
* IF INNER = 0 THEN                                                     57900000
*    DO;                                                                57950000
*    ANS (COMMENT(IN)) COL(COLA) SKIP RESCAN;                           58000000
*    ANS (COMMENT(IN1)) COL(COLA) SKIP RESCAN;                          58050000
*    RC = 0;                                                            58100000
*    END;                                                               58150000
* /*******************************************************************/ 58200000
* /*  CHECK MAIN FUNCTION                                            */ 58250000
* /*******************************************************************/ 58300000
* IF NUMBER(MF) = 0 THEN                                                58350000
*    DO;                                                                58400000
*    ANS MSG ('MF IS NOT SPECIFIED, GENERATION SUPPRESSED')             58450000
*                                      COL(COLA) SKIP;                  58500000
* /*  SYNTAX CHECK CONTINUES                                         */ 58550000
*    RCL = RCERR;                                                       58600000
*    SYNER1 = 1;                                                        58650000
*    GOTO VALMF;                                                        58700000
*    END;                                                               58750000
* IF MF(1) = 'DCL' THEN                                                 58800000
*    GOTO VALMF;                                                        58850000
* IF MF(1) = 'GEN' THEN                                                 58900000
*    GOTO VALMF;                                                        58950000
* IF MF(1) = 'MOD' THEN                                                 59000000
*    GOTO VALMF;                                                        59050000
* ANS MSG ('MF REQUEST IS INVALID, GENERATION SUPPRESSED')              59100000
*                                     COL(COLA) SKIP;                   59150000
* /*  SYNTAX CHECK CONTINUES                                         */ 59200000
* RCL = RCERR;                                                          59250000
* SYNER1 = 1;                                                           59300000
* VALMF:;                                                               59350000
* /*******************************************************************/ 59400000
* /*  CROSS CHECKING FOR MF(DCL): AREA AND REGISTER NOTATION INVALID */ 59450000
* /*******************************************************************/ 59500000
* IF MF(1) = 'DCL' THEN                                                 59550000
*    DO;                                                                59600000
* /*******************************************************************/ 59650000
* /*  CHECK IF AREA IS SPECIFIED FOR MF(DCL)                         */ 59700000
* /*******************************************************************/ 59750000
*    IF NUMBER(AREA) = 0 THEN                                          59800000
*       DO;                                                             59850000
*       ANS MSG ('AREA IGNORED FOR MF(DCL)')                            59900000
*                 SKIP COL(COLA);                                       59950000
* /*  SYNTAX CHECK CONTINUES                                         */ 60000000
*       RCL = RCWARN;                                                   60050000
*       END;                                                            60100000
* /*******************************************************************/ 60150000
* /*  CHECK REGISTER NOTATION FOR SYSLST                             */ 60200000
* /*******************************************************************/ 60250000
*    IF NUMBER(SYSLST) > 0 THEN                                         60300000
*    DO;                                                                60350000
*       IF SYSLST(1,1:1) = '(' THEN                                     60400000
*          REGERR = 1;                                                  60450000
*    END;                                                               60500000
* /*******************************************************************/ 60550000
* /*  CHECK REGISTER NOTATION FOR SYSLOG                             */ 60600000
* /*******************************************************************/ 60650000
*    IF NUMBER(SYSLOG) > 0 THEN                                         60700000
*    DO;                                                                60750000
*       IF SYSLOG(1,1:1) = '(' THEN                                     60800000
*          REGERR = 1;                                                  60850000
*    END;                                                               60900000
* /*******************************************************************/ 60950000
* /*  CHECK REGISTER NOTATION FOR LOGAREA                            */ 61000000
* /*******************************************************************/ 61050000
*    IF NUMBER(LOGAREA) > 0 THEN                                        61100000
*    DO;                                                                61150000
*       IF LOGAREA(1,1:1) = '(' THEN                                    61200000
*          REGERR = 1;                                                  61250000
*    END;                                                               61300000
* /*******************************************************************/ 61350000
* /*  CHECK REGISTER NOTATION FOR LOGLEN                             */ 61400000
* /*******************************************************************/ 61450000
*    IF NUMBER(LOGLEN) > 0 THEN                                         61500000
*    DO;                                                                61550000
*       IF LOGLEN(1,1:1) = '(' THEN                                     61600000
*          REGERR = 1;                                                  61650000
*    END;                                                               61700000
* /*******************************************************************/ 61750000
* /*  CHECK REGISTER NOTATION FOR LSTAREA                            */ 61800000
* /*******************************************************************/ 61850000
*    IF NUMBER(LSTAREA) > 0 THEN                                        61900000
*    DO;                                                                61950000
*       IF LSTAREA(1,1:1) = '(' THEN                                    62000000
*          REGERR = 1;                                                  62050000
*    END;                                                               62100000
* /*******************************************************************/ 62150000
* /*  CHECK REGISTER NOTATION FOR LSTLEN                             */ 62200000
* /*******************************************************************/ 62250000
*    IF NUMBER(LSTLEN) > 0 THEN                                         62300000
*    DO;                                                                62350000
*       IF LSTLEN(1,1:1) = '(' THEN                                     62400000
*          REGERR = 1;                                                  62450000
*    END;                                                               62500000
* /*******************************************************************/ 62550000
* /*  CHECK REGISTER NOTATION FOR MSGID                              */ 62600000
* /*******************************************************************/ 62650000
*    IF NUMBER(MSGID) > 0 THEN                                          62700000
*    DO;                                                                62750000
*       IF MSGID(1,1:1) = '(' THEN                                      62800000
*          REGERR = 1;                                                  62850000
*    END;                                                               62900000
* /*******************************************************************/ 62950000
* /*  CHECK REGISTER NOTATION FOR MSGPAR1                            */ 63000000
* /*******************************************************************/ 63050000
*    IF NUMBER(MSGPAR1) > 0 THEN                                        63100000
*    DO;                                                                63150000
*       IF MSGPAR1(1,1:1) = '(' THEN                                    63200000
*          REGERR = 1;                                                  63250000
*    END;                                                               63300000
* /*******************************************************************/ 63350000
* /*  CHECK REGISTER NOTATION FOR MSGPAR2                            */ 63400000
* /*******************************************************************/ 63450000
*    IF NUMBER(MSGPAR2) > 0 THEN                                        63500000
*    DO;                                                                63550000
*       IF MSGPAR2(1,1:1) = '(' THEN                                    63600000
*          REGERR = 1;                                                  63650000
*    END;                                                               63700000
* /*******************************************************************/ 63750000
* /*  CHECK REGISTER NOTATION FOR MSGPAR3                            */ 63800000
* /*******************************************************************/ 63850000
*    IF NUMBER(MSGPAR3) > 0 THEN                                        63900000
*    DO;                                                                63950000
*       IF MSGPAR3(1,1:1) = '(' THEN                                    64000000
*          REGERR = 1;                                                  64050000
*    END;                                                               64100000
* /*******************************************************************/ 64150000
* /*  CHECK REGISTER NOTATION FOR MSGPAR4                            */ 64200000
* /*******************************************************************/ 64250000
*    IF NUMBER(MSGPAR4) > 0 THEN                                        64300000
*    DO;                                                                64350000
*       IF MSGPAR4(1,1:1) = '(' THEN                                    64400000
*          REGERR = 1;                                                  64450000
*    END;                                                               64500000
* /*******************************************************************/ 64550000
* /*  CHECK REGISTER NOTATION FOR EXITLST                            */ 64600000
* /*******************************************************************/ 64650000
*    IF NUMBER(EXITLST) > 0 THEN                                        64700000
*    DO;                                                                64750000
*       IF EXITLST(1,1:1) = '(' THEN                                    64800000
*          REGERR = 1;                                                  64850000
*    END;                                                               64900000
* /*******************************************************************/ 64950000
* /*  CHECK REGISTER NOTATION FOR SBUFADR                            */ 65000000
* /*******************************************************************/ 65050000
*    IF NUMBER(SBUFADR) > 0 THEN                                        65100000
*    DO;                                                                65150000
*       IF SBUFADR(1,1:1) = '(' THEN                                    65200000
*          REGERR = 1;                                                  65250000
*    END;                                                               65300000
* /*******************************************************************/ 65350000
* /*  CHECK REGISTER NOTATION FOR SBUFLEN                            */ 65400000
* /*******************************************************************/ 65450000
*    IF NUMBER(SBUFLEN) > 0 THEN                                        65500000
*    DO;                                                                65550000
*       IF SBUFLEN(1,1:1) = '(' THEN                                    65600000
*          REGERR = 1;                                                  65650000
*    END;                                                               65700000
* /*  SYNTAX CHECK CONTINUES                                         */ 65750000
*    IF REGERR = 1 THEN                                                 65800000
*       DO;                                                             65850000
*       ANS MSG ('NO REGISTER NOTATION FOR MF(DCL),' ||                 65900000
*            ' GENERATION SUPPRESSED')                                  65950000
*            COL(COLA) SKIP;                                            66000000
* /*  SYNTAX CHECK CONTINUES                                         */ 66050000
*       RCL = RCERR;                                                    66100000
*       SYNER1 = 1;                                                     66150000
*       END;                                                            66200000
*    END;                                                               66250000
* ELSE                                                                  66300000
*    DO;                                                                66350000
*       IF NUMBER(AREA) = 0 THEN                                        66400000
*          DO;                                                          66450000
*          ANS MSG('AREA MUST BE SPECIFIED FOR MF(GEN|MOD),'            66500000
*               ||' GENERATION SUPPRESSED') COL(COLA) SKIP;             66550000
*          RCL = RCERR;                                                 66600000
*          SYNER1 = 1;                                                  66650000
*          END;                                                         66700000
*    END;                                                               66750000
*                                                                       66800000
* /*******************************************************************/ 66850000
* /*      CHECK GETVIS PARAMETER                                     */ 66900000
* /*******************************************************************/ 66950000
*   IF NUMBER(GETVIS) > 0 THEN                                          67000000
*   DO;                                                                 67050000
*     IF GETVIS(1) = 'PARTITION' & GETVIS(1) = 'SYSTEM' THEN          67100000
*     DO;                                                               67150000
*       SYNER1 = 1;                                                     67200000
*       ANS MSG('GETVIS PARAMETER MUST SPECIFY PARTITION | SYSTEM')     67250000
*           COL(COLA) SKIP;                                             67300000
*     END;                                                              67350000
*   END;                                                                67400000
*                                                                       67450000
* /*******************************************************************/ 67500000
* /*      CHECK ERROR  PARAMETER                                     */ 67550000
* /*******************************************************************/ 67600000
*   IF NUMBER(ERROR)  > 0 THEN                                          67650000
*   DO;                                                                 67700000
*     IF ERROR(1) = 'RETURN' & ERROR(1) = 'CANCEL' THEN               67750000
*     DO;                                                               67800000
*       SYNER1 = 1;                                                     67850000
*       ANS MSG('ERROR PARAMETER MUST SPECIFY RETURN | CANCEL')         67900000
*           COL(COLA) SKIP;                                             67950000
*     END;                                                              68000000
*   END;                                                                68050000
*                                                                       68100000
* /*******************************************************************/ 68150000
* /*      CHECK EXTEND PARAMETER                                     */ 68200000
* /*******************************************************************/ 68250000
*   IF NUMBER(EXTEND) > 0 THEN                                          68300000
*   DO;                                                                 68350000
*     IF EXTEND(1)= 'YES' & EXTEND(1)= 'NO' THEN                      68400000
*     DO;                                                               68450000
*       SYNER1 = 1;                                                     68500000
*       ANS MSG('EXTEND PARAMETER MUST SPECIFY YES | NO')               68550000
*           COL(COLA) SKIP;                                             68600000
*     END;                                                              68650000
*   END;                                                                68700000
*                                                                       68750000
* /*******************************************************************/ 68800000
* /*      CHECK LOCK   PARAMETER                                     */ 68850000
* /*******************************************************************/ 68900000
*   IF NUMBER(LOCK) > 0 THEN                                            68950000
*   DO;                                                                 69000000
*     IF LOCK(1)= 'WAIT' & LOCK(1) = 'RETURN' THEN                    69050000
*     DO;                                                               69100000
*       SYNER1 = 1;                                                     69150000
*       ANS MSG('LOCK PARAMETER MUST SPECIFY WAIT | RETURN')            69200000
*           COL(COLA) SKIP;                                             69250000
*     END;                                                              69300000
*   END;                                                                69350000
*                                                                       69400000
*                                                                       69450000
* /*******************************************************************/ 69500000
* /*  GENERATION OF CODE IS SUPPRESSED, IF A SYNTAX ERROR WAS FOUND  */ 69550000
* /*  IN INLMLAMB MACRO                                              */ 69600000
* /*******************************************************************/ 69650000
* IF SYNER1 = 1 THEN                                                    69700000
*    SYNERR = 1;                                                        69750000
* IF SYNERR = 1 THEN                                                    69800000
*    GOTO MEND;                                                         69850000
* IF MF(1) = 'DCL' THEN                                                 69900000
*    DO;                                                                69950000
*    IF MACLABEL = '' THEN                                              70000000
*       DO;                                                             70050000
*       ANS MSG ('NO LABEL FOR MF(DCL), GENERATION SUPPRESSED')         70100000
*         COL(COLA) SKIP;                                               70150000
*       RCL = 8;                                                        70200000
*       GOTO MEND;                                                      70250000
*       END;                                                            70300000
* /*******************************************************************/ 70350000
* /*  GENERATE INLINE CONTROL BLOCK WITH DCL'S                       */ 70400000
* /*******************************************************************/ 70450000
*    TLABEL = MACLABEL(1:(LENGTH(MACLABEL)-1));                         70500000
*    ANS ('DCL ') COL(COLA) SKIP;                                       70550000
*    ANS ('1 TLABEL STATIC LOCAL BDY(WORD),')                           70600000
*         COL(COLA) SKIP RESCAN;                                        70650000
* /*******************************************************************/ 70700000
* /*  SAVE AREA                                                      */ 70750000
* /*******************************************************************/ 70800000
*    ANS ('2 * CHAR(72)') COL(COLA+1) SKIP;                             70850000
*       ANS ('INIT(''''B),') COL(COLB);                                 70900000
*    ANS ('/* LAMB HEADER               */') COL(COLD);                 70950000
* /*******************************************************************/ 71000000
* /*  HEADER                                                         */ 71050000
* /*******************************************************************/ 71100000
*    ANS ('2 * CHAR(8) ') COL(COLA+1) SKIP;                             71150000
*       ANS ('INIT(''LAMB''),') COL(COLB);                              71200000
*    ANS ('/* LAMB HEADER               */') COL(COLD);                 71250000
* /*******************************************************************/ 71300000
* /*  RESERVED                                                       */ 71350000
* /*******************************************************************/ 71400000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             71450000
*       ANS ('INIT(0),') COL(COLB);                                     71500000
*    ANS ('/* RESERVED                  */') COL(COLD);                 71550000
* /*******************************************************************/ 71600000
* /*  SBUFADR                                                        */ 71650000
* /*******************************************************************/ 71700000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             71750000
*    IF NUMBER(SBUFADR) = 0 THEN                                        71800000
*       ANS ('INIT(0),') COL(COLB);                                     71850000
*    ELSE                                                               71900000
*       ANS ('INIT(ADDR'||SBUFADR||'),') COL(COLB) RESCAN;              71950000
*    ANS ('/* ADDRESS OF SHARED  BUFFER    */') COL(COLD);              72000000
* /*******************************************************************/ 72050000
* /*  SBUFLEN                                                        */ 72100000
* /*******************************************************************/ 72150000
*    ANS ('2 * BIN(31) ') COL(COLA+1) SKIP;                             72200000
*    IF NUMBER(SBUFLEN) = 0 THEN                                        72250000
*       ANS ('INIT(0),') COL(COLB);                                     72300000
*    ELSE                                                               72350000
*       ANS ('INIT'||SBUFLEN||',') COL(COLB) RESCAN;                    72400000
*    ANS ('/* LENGTH OF SHARED BUFFER AREA */') COL(COLD);              72450000
* /*******************************************************************/ 72500000
* /*  SYSLST                                                         */ 72550000
* /*******************************************************************/ 72600000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             72650000
*    IF NUMBER(SYSLST) = 0 THEN                                         72700000
*       ANS ('INIT(0),') COL(COLB);                                     72750000
*    ELSE                                                               72800000
*       ANS ('INIT(ADDR'||SYSLST||'),') COL(COLB) RESCAN;               72850000
*    ANS ('/* ADDRESS OF DTF FOR SYSLST    */') COL(COLD);              72900000
* /*******************************************************************/ 72950000
* /*  SYSLOG                                                         */ 73000000
* /*******************************************************************/ 73050000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             73100000
*    IF NUMBER(SYSLOG) = 0 THEN                                         73150000
*       ANS ('INIT(0),') COL(COLB);                                     73200000
*    ELSE                                                               73250000
*       ANS ('INIT(ADDR'||SYSLOG||'),') COL(COLB) RESCAN;               73300000
*    ANS ('/* ADDRESS OF DTF FOR SYSLOG    */') COL(COLD);              73350000
* /*******************************************************************/ 73400000
* /*  LSTAREA                                                        */ 73450000
* /*******************************************************************/ 73500000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             73550000
*    IF NUMBER(LSTAREA) = 0 THEN                                        73600000
*       ANS ('INIT(0),') COL(COLB);                                     73650000
*    ELSE                                                               73700000
*       ANS ('INIT(ADDR'||LSTAREA||'),') COL(COLB) RESCAN;              73750000
*    ANS ('/* ADDRESS OF LSTAREA  */') COL(COLD);                       73800000
* /*******************************************************************/ 73850000
* /*  LSTLEN                                                         */ 73900000
* /*******************************************************************/ 73950000
*    ANS ('2 * BIN(31) ') COL(COLA+1) SKIP;                             74000000
*    IF NUMBER(LSTLEN) = 0 THEN                                         74050000
*       ANS ('INIT(0),') COL(COLB);                                     74100000
*    ELSE                                                               74150000
*       ANS ('INIT'||LSTLEN||',') COL(COLB) RESCAN;                     74200000
*    ANS ('/* LENGTH  OF LSTAREA   */') COL(COLD);                      74250000
* /*******************************************************************/ 74300000
* /*   LOGAREA                                                       */ 74350000
* /*******************************************************************/ 74400000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             74450000
*    IF NUMBER(LOGAREA) = 0 THEN                                        74500000
*       ANS ('INIT(0),') COL(COLB);                                     74550000
*    ELSE                                                               74600000
*       ANS ('INIT(ADDR'||LOGAREA||'),') COL(COLB) RESCAN;              74650000
*    ANS ('/* ADDRESS OF LOGAREA  */') COL(COLD);                       74700000
* /*******************************************************************/ 74750000
* /*  LOGLEN                                                        */  74800000
* /*******************************************************************/ 74850000
*    ANS ('2 * BIN(31) ') COL(COLA+1) SKIP;                             74900000
*    IF NUMBER(LOGLEN) = 0 THEN                                         74950000
*       ANS ('INIT(0),') COL(COLB);                                     75000000
*    ELSE                                                               75050000
*       ANS ('INIT'||LOGLEN||',') COL(COLB) RESCAN;                     75100000
*    ANS ('/* LENGTH  OF LOGAREA   */') COL(COLD);                      75150000
* /*******************************************************************/ 75200000
* /*  MSGID                                                         */  75250000
* /*******************************************************************/ 75300000
*    ANS ('2 * BIN(31) ') COL(COLA+1) SKIP;                             75350000
*    IF NUMBER(MSGID) = 0 THEN                                          75400000
*       ANS ('INIT(0),') COL(COLB);                                     75450000
*    ELSE                                                               75500000
*       ANS ('INIT'||MSGID||',') COL(COLB) RESCAN;                      75550000
*    ANS ('/* MESSAGE ID NUMBER    */') COL(COLD);                      75600000
* /*******************************************************************/ 75650000
* /*   MSGPAR1                                                       */ 75700000
* /*******************************************************************/ 75750000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             75800000
*    IF NUMBER(MSGPAR1) = 0 THEN                                        75850000
*       ANS ('INIT(0),') COL(COLB);                                     75900000
*    ELSE                                                               75950000
*       ANS ('INIT(ADDR'||MSGPAR1||'),') COL(COLB) RESCAN;              76000000
*    ANS ('/* ADDRESS OF MSG PART 1 */') COL(COLD);                     76050000
* /*******************************************************************/ 76100000
* /*   MSGPAR2                                                       */ 76150000
* /*******************************************************************/ 76200000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             76250000
*    IF NUMBER(MSGPAR2) = 0 THEN                                        76300000
*       ANS ('INIT(0),') COL(COLB);                                     76350000
*    ELSE                                                               76400000
*       ANS ('INIT(ADDR'||MSGPAR2||'),') COL(COLB) RESCAN;              76450000
*    ANS ('/* ADDRESS OF MSG PART 2 */') COL(COLD);                     76500000
* /*******************************************************************/ 76550000
* /*   MSGPAR3                                                       */ 76600000
* /*******************************************************************/ 76650000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             76700000
*    IF NUMBER(MSGPAR3) = 0 THEN                                        76750000
*       ANS ('INIT(0),') COL(COLB);                                     76800000
*    ELSE                                                               76850000
*       ANS ('INIT(ADDR'||MSGPAR3||'),') COL(COLB) RESCAN;              76900000
*    ANS ('/* ADDRESS OF MSG PART 3 */') COL(COLD);                     76950000
* /*******************************************************************/ 77000000
* /*   MSGPAR4                                                       */ 77050000
* /*******************************************************************/ 77100000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             77150000
*    IF NUMBER(MSGPAR4) = 0 THEN                                        77200000
*       ANS ('INIT(0),') COL(COLB);                                     77250000
*    ELSE                                                               77300000
*       ANS ('INIT(ADDR'||MSGPAR4||'),') COL(COLB) RESCAN;              77350000
*    ANS ('/* ADDRESS OF MSG PART 4 */') COL(COLD);                     77400000
* /*******************************************************************/ 77450000
* /*  EXITLST                                                        */ 77500000
* /*******************************************************************/ 77550000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             77600000
*    IF NUMBER(EXITLST) = 0 THEN                                        77650000
*       ANS ('INIT(0),') COL(COLB);                                     77700000
*    ELSE                                                               77750000
*       ANS ('INIT(ADDR'||EXITLST||'),') COL(COLB) RESCAN;              77800000
*    ANS ('/* ADDRESS OF EXIT LIST  */') COL(COLD);                     77850000
* /*******************************************************************/ 77900000
* /*  ERROR, GETVIS                                                  */ 77950000
* /*******************************************************************/ 78000000
*    ANS ('2 * BIT(8)  ') COL(COLA+1) SKIP;                             78050000
*    IF NUMBER(ERROR) = 0 THEN                                          78100000
*       TERR = '0';                                                     78150000
*    ELSE IF ERROR(1) = 'CANCEL' THEN                                   78200000
*            TERR = '1';                                                78250000
*         ELSE TERR = '0';                                              78300000
*    IF NUMBER(EXTEND)= 0 THEN                                          78350000
*       TXTN = '0';                                                     78400000
*    ELSE IF EXTEND(1)= 'NO' THEN                                       78450000
*            TXTN = '1';                                                78500000
*         ELSE TXTN = '0';                                              78550000
*    IF NUMBER(LOCK) = 0 THEN                                           78600000
*       TFAI = '0';                                                     78650000
*    ELSE IF LOCK(1) = 'RETURN' THEN                                    78700000
*            TFAI = '1';                                                78750000
*         ELSE TFAI = '0';                                              78800000
*    IF NUMBER(GETVIS) = 0 THEN                                         78850000
*       TVIS = '0';                                                     78900000
*    ELSE                                                               78950000
*     IF GETVIS(1) = 'SYSTEM' THEN                                      79000000
*        TVIS = '1';                                                    79050000
*     ELSE                                                              79100000
*        TVIS = '0';                                                    79150000
*    ANS('INIT(''0'||TERR||'000'||TFAI||TXTN||TVIS||'''B),')            79200000
*     COL(COLB) RESCAN;                                                 79250000
*    ANS ('/* SWITCH BYTE 1         */') COL(COLD);                     79300000
* /*******************************************************************/ 79350000
* /*  RESERVED                                                       */ 79400000
* /*******************************************************************/ 79450000
*    ANS ('2 * BIT(24) ') COL(COLA+1) SKIP;                             79500000
*       ANS ('INIT(0),') COL(COLB);                                     79550000
*    ANS ('/* RESERVED                  */') COL(COLD);                 79600000
*    ANS ('2 * BIN(15) ') COL(COLA+1) SKIP;                             79650000
*       ANS ('INIT(0),') COL(COLB);                                     79700000
*    ANS ('/* RESERVED                  */') COL(COLD);                 79750000
*    ANS ('2 * BIN(15) ') COL(COLA+1) SKIP;                             79800000
*       ANS ('INIT(0),') COL(COLB);                                     79850000
*    ANS ('/* RESERVED                  */') COL(COLD);                 79900000
*    ANS ('2 * CHAR(4) ') COL(COLA+1) SKIP;                             79950000
*       ANS ('INIT(''INLG''),') COL(COLB);                              80000000
*    ANS ('/* SUBPOOL ID                */') COL(COLD);                 80050000
*    ANS ('2 * CHAR(4) ') COL(COLA+1) SKIP;                             80100000
*       ANS ('INIT(''0''B),') COL(COLB);                                80150000
*    ANS ('/* SUBPOOL ID                */') COL(COLD);                 80200000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             80250000
*       ANS ('INIT(0),') COL(COLB);                                     80300000
*    ANS ('/* RESERVED                  */') COL(COLD);                 80350000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             80400000
*       ANS ('INIT(0),') COL(COLB);                                     80450000
*    ANS ('/* RESERVED                  */') COL(COLD);                 80500000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             80550000
*       ANS ('INIT(0),') COL(COLB);                                     80600000
*    ANS ('/* RESERVED                  */') COL(COLD);                 80650000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             80700000
*       ANS ('INIT(0),') COL(COLB);                                     80750000
*    ANS ('/* RESERVED                  */') COL(COLD);                 80800000
*    ANS ('2 * PTR(31) ') COL(COLA+1) SKIP;                             80850000
*       ANS ('INIT(0);') COL(COLB);                                     80900000
*    ANS ('/* RESERVED                  */') COL(COLD);                 80950000
*    END;                                                               81000000
* ELSE                                                                  81050000
*    DO;                                                                81100000
* /*******************************************************************/ 81150000
* /*  DYNAMIC GENERATION OR MODIFICATION OF CONTROL BLOCK            */ 81200000
* /*******************************************************************/ 81250000
* /*******************************************************************/ 81300000
* /*  ADDRESSING OF CONTROL BLOCK                                    */ 81350000
* /*******************************************************************/ 81400000
*    IF MACLABEL = '' THEN                                             81450000
*       ANS (MACLABEL||';') SKIP COL(COLA);                             81500000
*    ANS ('RFY AMBACCR1 RSTD;')                                         81550000
*         COL(COLA) SKIP RESCAN;                                        81600000
*    IF AREA(1,1:1) = '(' THEN                                          81650000
*       ANS ('AMBACCR1 = '||AREA(1,1)||';')SKIP COL(COLA) RESCAN;       81700000
*    ELSE                                                               81750000
*       ANS ('AMBACCR1 = ADDR'||AREA||';') SKIP COL(COLA) RESCAN;       81800000
*    ANS ('/* REGISTER 1 POINTS TO CONTROL BLOCK */') COL(COLD);        81850000
*    ANS ('RFY INLCLAMB BASED(AMBACCR1);')                              81900000
*         COL(COLA) SKIP RESCAN;                                        81950000
*    IF MF(1) = 'GEN' THEN                                              82000000
*       DO;                                                             82050000
* /*******************************************************************/ 82100000
* /*  FOR MF(GEN) THE CONTROL BLOCK MUST BE CLEARED                  */ 82150000
* /*******************************************************************/ 82200000
*       ANS ('INLCLAMB = ''''B;') COL(COLA) SKIP;                       82250000
*       ANS ('/* CLEAR CONTROL BLOCK */') COL(COLD);                    82300000
*       ANS ('LAMBID = ''LAMB'';') COL(COLA) SKIP;                      82350000
*       ANS ('/* INSERT ID           */') COL(COLD);                    82400000
* /*******************************************************************/ 82450000
* /*  FOR MF(GEN) INSERT SUBPOOL ID FOR AUTOMATIC GETVIS SPACE       */ 82500000
* /*******************************************************************/ 82550000
*       ANS ('LAMBSPID(1:4) = ''INLG'';') COL(COLA) SKIP;               82600000
*       ANS ('/* INSERT SUBPOOL ID   */') COL(COLD);                    82650000
*       ANS ('GENERATE REFS(LAMBSPID,IJBTIK);') COL(COLA) SKIP;         82700002
*   ANS(' ASYSCOM  15') COL(COL1+9) SKIP;                               82750000
*   ANS(' USING SYSCOM,15') COL(COL1+9) SKIP;                           82800000
*   ANS(' MVC   LAMBSPID+4(2,1),IJBTIK') COL(COL1+9) SKIP;              82850000
*   ANS(' DROP  15') COL(COL1+9) SKIP;                                  82900000
*       ANS (MACCONC||'ENDGEN;') COL(COLA) SKIP RESCAN;                 82950000
*      END;                                                             83000000
* /*******************************************************************/ 83050000
* /*  INSERT LSTAREA, IF SPECIFIED                                   */ 83100000
* /*******************************************************************/ 83150000
*    IF NUMBER(LSTAREA) = 0 THEN                                        83200000
*       GOTO CHKMLN1;                                                   83250000
*    IF LSTAREA(1,1:1) = '(' THEN                                       83300000
*       TINFO = LSTAREA(1,1);                                           83350000
*    ELSE                                                               83400000
*       TINFO = 'ADDR('||LSTAREA(1)||')';                               83450000
*    ANS ('LAMBLSTA = '||TINFO||';') COL(COLA) SKIP RESCAN;             83500000
*    ANS ('/* INSERT LSTAREA*/') COL(COLD);                             83550000
*    CHKMLN1:;                                                          83600000
* /*******************************************************************/ 83650000
* /*  INSERT LSTLEN, IF SPECIFIED                                   */  83700000
* /*******************************************************************/ 83750000
*    IF NUMBER(LSTLEN) = 0 THEN                                         83800000
*       GOTO CHKLGA1;                                                   83850000
*    IF LSTLEN(1,1:1) = '(' THEN                                        83900000
*       TINFO = LSTLEN(1,1);                                            83950000
*    ELSE                                                               84000000
*       TINFO = LSTLEN(1);                                              84050000
*    ANS ('LAMBLSTL = '||TINFO||';') COL(COLA) SKIP RESCAN;             84100000
*    ANS ('/* INSERT LSTLEN */') COL(COLD);                             84150000
*    CHKLGA1:;                                                          84200000
* /*******************************************************************/ 84250000
* /*  INSERT LOGAREA,  IF SPECIFIED                                  */ 84300000
* /*******************************************************************/ 84350000
*    IF NUMBER(LOGAREA) = 0 THEN                                        84400000
*       GOTO CHKLGL1;                                                   84450000
*    IF LOGAREA(1,1:1) = '(' THEN                                       84500000
*       TINFO = LOGAREA(1,1);                                           84550000
*    ELSE                                                               84600000
*       TINFO = 'ADDR('||LOGAREA(1)||')';                               84650000
*    ANS ('LAMBLOGA = '||TINFO||';') COL(COLA) SKIP RESCAN;             84700000
*    ANS ('/* INSERT LOGAREA*/') COL(COLD);                             84750000
*    CHKLGL1:;                                                          84800000
* /*******************************************************************/ 84850000
* /*  INSERT LOGLEN, IF SPECIFIED                                   */  84900000
* /*******************************************************************/ 84950000
*    IF NUMBER(LOGLEN) = 0 THEN                                         85000000
*       GOTO CHKMID1;                                                   85050000
*    IF LOGLEN(1,1:1) = '(' THEN                                        85100000
*       TINFO = LOGLEN(1,1);                                            85150000
*    ELSE                                                               85200000
*       TINFO = LOGLEN(1);                                              85250000
*    ANS ('LAMBLOGL = '||TINFO||';') COL(COLA) SKIP RESCAN;             85300000
*    ANS ('/* INSERT LOGLEN */') COL(COLD);                             85350000
*    CHKMID1:;                                                          85400000
* /*******************************************************************/ 85450000
* /*  INSERT MSGID,  IF SPECIFIED                                   */  85500000
* /*******************************************************************/ 85550000
*    IF NUMBER(MSGID) = 0 THEN                                          85600000
*       GOTO CHKMP11;                                                   85650000
*    IF MSGID(1,1:1) = '(' THEN                                         85700000
*       TINFO = MSGID(1,1);                                             85750000
*    ELSE                                                               85800000
*       TINFO = MSGID(1);                                               85850000
*    ANS ('LAMBMID = '||TINFO||';') COL(COLA) SKIP RESCAN;              85900000
*    ANS ('/* INSERT MSG ID */') COL(COLD);                             85950000
*    CHKMP11:;                                                          86000000
* /*******************************************************************/ 86050000
* /*  INSERT MSGPAR1, IF SPECIFIED                                   */ 86100000
* /*******************************************************************/ 86150000
*    IF NUMBER(MSGPAR1) = 0 THEN                                        86200000
*       GOTO CHKMP21;                                                   86250000
*    IF MSGPAR1(1,1:1) = '(' THEN                                       86300000
*       TINFO = MSGPAR1(1,1);                                           86350000
*    ELSE                                                               86400000
*       TINFO = 'ADDR('||MSGPAR1(1)||')';                               86450000
*    ANS ('LAMBMSG1 = '||TINFO||';') COL(COLA) SKIP RESCAN;             86500000
*    ANS ('/* INSERT MSG PART 1*/') COL(COLD);                          86550000
*    CHKMP21:;                                                          86600000
* /*******************************************************************/ 86650000
* /*  INSERT MSGPAR2, IF SPECIFIED                                   */ 86700000
* /*******************************************************************/ 86750000
*    IF NUMBER(MSGPAR2) = 0 THEN                                        86800000
*       GOTO CHKMP31;                                                   86850000
*    IF MSGPAR2(1,1:1) = '(' THEN                                       86900000
*       TINFO = MSGPAR2(1,1);                                           86950000
*    ELSE                                                               87000000
*       TINFO = 'ADDR('||MSGPAR2(1)||')';                               87050000
*    ANS ('LAMBMSG2 = '||TINFO||';') COL(COLA) SKIP RESCAN;             87100000
*    ANS ('/* INSERT MSG PART 2*/') COL(COLD);                          87150000
*    CHKMP31:;                                                          87200000
* /*******************************************************************/ 87250000
* /*  INSERT MSGPAR3, IF SPECIFIED                                   */ 87300000
* /*******************************************************************/ 87350000
*    IF NUMBER(MSGPAR3) = 0 THEN                                        87400000
*       GOTO CHKMP41;                                                   87450000
*    IF MSGPAR3(1,1:1) = '(' THEN                                       87500000
*       TINFO = MSGPAR3(1,1);                                           87550000
*    ELSE                                                               87600000
*       TINFO = 'ADDR('||MSGPAR3(1)||')';                               87650000
*    ANS ('LAMBMSG3 = '||TINFO||';') COL(COLA) SKIP RESCAN;             87700000
*    ANS ('/* INSERT MSG PART 3*/') COL(COLD);                          87750000
*    CHKMP41:;                                                          87800000
* /*******************************************************************/ 87850000
* /*  INSERT MSGPAR4, IF SPECIFIED                                   */ 87900000
* /*******************************************************************/ 87950000
*    IF NUMBER(MSGPAR4) = 0 THEN                                        88000000
*       GOTO CHKXTL1;                                                   88050000
*    IF MSGPAR4(1,1:1) = '(' THEN                                       88100000
*       TINFO = MSGPAR4(1,1);                                           88150000
*    ELSE                                                               88200000
*       TINFO = 'ADDR('||MSGPAR4(1)||')';                               88250000
*    ANS ('LAMBMSG4 = '||TINFO||';') COL(COLA) SKIP RESCAN;             88300000
*    ANS ('/* INSERT MSG PART 4*/') COL(COLD);                          88350000
*    CHKXTL1:;                                                          88400000
* /*******************************************************************/ 88450000
* /*  INSERT EXITLST, IF SPECIFIED                                   */ 88500000
* /*******************************************************************/ 88550000
*    IF NUMBER(EXITLST) = 0 THEN                                        88600000
*       GOTO CHKDTF1;                                                   88650000
*    IF EXITLST(1,1:1) = '(' THEN                                       88700000
*       TINFO = EXITLST(1,1);                                           88750000
*    ELSE                                                               88800000
*       TINFO = 'ADDR('||EXITLST(1)||')';                               88850000
*    ANS ('LAMBEXTL = '||TINFO||';') COL(COLA) SKIP RESCAN;             88900000
*    ANS ('/* INSERT EXITLST */') COL(COLD);                            88950000
*    CHKDTF1:;                                                          89000000
* /*******************************************************************/ 89050000
* /*  INSERT SYSLST, IF SPECIFIED                                    */ 89100000
* /*******************************************************************/ 89150000
*    IF NUMBER(SYSLST) = 0 THEN                                         89200000
*       GOTO CHKLOG1;                                                   89250000
*    IF SYSLST(1,1:1) = '(' THEN                                        89300000
*       TINFO = SYSLST(1,1);                                            89350000
*    ELSE                                                               89400000
*       TINFO = 'ADDR('||SYSLST(1)||')';                                89450000
*    ANS ('LAMBLST = '||TINFO||';') COL(COLA) SKIP RESCAN;              89500000
*    ANS ('/* INSERT SYSLST */') COL(COLD);                             89550000
*    CHKLOG1:;                                                          89600000
* /*******************************************************************/ 89650000
* /*  INSERT SYSLOG, IF SPECIFIED                                    */ 89700000
* /*******************************************************************/ 89750000
*    IF NUMBER(SYSLOG) = 0 THEN                                         89800000
*       GOTO CHKSBF1;                                                   89850000
*    IF SYSLOG(1,1:1) = '(' THEN                                        89900000
*       TINFO = SYSLOG(1,1);                                            89950000
*    ELSE                                                               90000000
*       TINFO = 'ADDR('||SYSLOG(1)||')';                                90050000
*    ANS ('LAMBLOG = '||TINFO||';') COL(COLA) SKIP RESCAN;              90100000
*    ANS ('/* INSERT SYSLOG */') COL(COLD);                             90150000
*    CHKSBF1:;                                                          90200000
* /*******************************************************************/ 90250000
* /*  INSERT SBUFADR IF SPECIFIED                                    */ 90300000
* /*******************************************************************/ 90350000
*    IF NUMBER(SBUFADR) = 0 THEN                                        90400000
*       GOTO CHKSTO1;                                                   90450000
*    IF SBUFADR(1,1:1) = '(' THEN                                       90500000
*       TPBUF = SBUFADR(1,1);                                           90550000
*    ELSE                                                               90600000
*       TPBUF = 'ADDR('||SBUFADR(1)||')';                               90650000
*    ANS ('LAMBSBUF = '||TPBUF||';') COL(COLA) SKIP RESCAN;             90700000
*    ANS ('/* INSERT SBUFADR */') COL(COLD);                            90750000
*    ANS ('LAMBSBIN = ''0''B;') COL(COLA) SKIP RESCAN;                  90800000
*    ANS ('/* RESET INIT FLAG*/') COL(COLD);                            90850000
*    CHKSTO1:;                                                          90900000
* /*******************************************************************/ 90950000
* /*  INSERT SBUFLEN IF SPECIFIED                                    */ 91000000
* /*******************************************************************/ 91050000
*    IF NUMBER(SBUFLEN) = 0 THEN                                        91100000
*       GOTO CHKRCL1;                                                   91150000
*    IF SBUFLEN(1,1:1) = '(' THEN                                       91200000
*       TPBLN = SBUFLEN(1,1);                                           91250000
*    ELSE                                                               91300000
*       TPBLN = SBUFLEN(1);                                             91350000
*    ANS ('LAMBLBUF = '||TPBLN||';') COL(COLA) SKIP RESCAN;             91400000
*    ANS ('/* INSERT SBUFLEN */') COL(COLD);                            91450000
*    CHKRCL1:;                                                          91500000
* /*******************************************************************/ 91550000
* /*  INSERT GETVIS  IF SPECIFIED                                    */ 91600000
* /*******************************************************************/ 91650000
*    IF NUMBER(GETVIS) = 0 THEN                                         91700000
*       GOTO CHKERR1;                                                   91750000
*    IF GETVIS(1) = 'SYSTEM' THEN                                       91800000
*       ANS ('LAMBSVIS = ''1''B;') COL(COLA) SKIP RESCAN;               91850000
*    ELSE                                                               91900000
*       ANS ('LAMBSVIS = ''0''B;') COL(COLA) SKIP RESCAN;               91950000
*    ANS ('/* INSERT GETVIS  */') COL(COLD);                            92000000
*    CHKERR1:;                                                          92050000
* /*******************************************************************/ 92100000
* /*  INSERT ERROR   IF SPECIFIED                                    */ 92150000
* /*******************************************************************/ 92200000
*    IF NUMBER(ERROR) = 0 THEN                                          92250000
*       GOTO CHKXTN1;                                                   92300000
*    IF ERROR(1) = 'CANCEL' THEN                                        92350000
*       ANS ('LAMBERR = ''1''B;') COL(COLA) SKIP RESCAN;                92400000
*    ELSE                                                               92450000
*       ANS ('LAMBERR = ''0''B;') COL(COLA) SKIP RESCAN;                92500000
*    ANS ('/* INSERT ERROR   */') COL(COLD);                            92550000
*    CHKXTN1:;                                                          92600000
* /*******************************************************************/ 92650000
* /*  INSERT EXTEND  IF SPECIFIED                                    */ 92700000
* /*******************************************************************/ 92750000
*    IF NUMBER(EXTEND)= 0 THEN                                          92800000
*       GOTO CHKFAI1;                                                   92850000
*    IF EXTEND(1)= 'NO' THEN                                            92900000
*       ANS ('LAMBXTND = ''1''B;') COL(COLA) SKIP RESCAN;               92950000
*    ELSE                                                               93000000
*       ANS ('LAMBXTND = ''0''B;') COL(COLA) SKIP RESCAN;               93050000
*    ANS ('/* INSERT EXTEND  */') COL(COLD);                            93100000
*    CHKFAI1:;                                                          93150000
* /*******************************************************************/ 93200000
* /*  INSERT LOCK    IF SPECIFIED                                    */ 93250000
* /*******************************************************************/ 93300000
*    IF NUMBER(LOCK) = 0 THEN                                           93350000
*       GOTO CHKXIT1;                                                   93400000
*    IF LOCK(1) = 'RETURN' THEN                                         93450000
*       ANS ('LAMBLOCK = ''1''B;') COL(COLA) SKIP RESCAN;               93500000
*    ELSE                                                               93550000
*       ANS ('LAMBLOCK = ''0''B;') COL(COLA) SKIP RESCAN;               93600000
*    ANS ('/* INSERT LOCK    */') COL(COLD);                            93650000
*    CHKXIT1:;                                                          93700000
*  ANS ('RFY (AMBACCR1,INLCLAMB);')                                     93750000
*        COL(COLA) SKIP;                                                93800000
*  END;                                                                 93850000
* MEND:;                                                                93900000
* FC = '';                                                              93950000
* /*******************************************************************/ 94000000
* /*  AVOID TWO RETURN CODES, IF INLMLAMB WAS CALLED AS INNER MACRO  */ 94050000
* /*******************************************************************/ 94100000
* IF INNER = 1 THEN                                                     94150000
*    DO;                                                                94200000
*    IF RC < RCL THEN                                                   94250000
*       RC = RCL;                                                       94300000
*    RCL = 0;                                                           94350000
*    END;                                                               94400000
* RETURN CODE(RCL);                                                     94450000
* %END;                                                                 94500000
