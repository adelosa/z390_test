      MACRO                                                             00050000
&MNAME   MODFLD  &FIELD=,                                              *00100000
               &CUU=,                                                  *00110017
               &LU=,                                                   *00120017
               &NEWVAL=,                                               *00150000
               &PART=,                                                 *00151017
               &PU=,                                                   *00152017
               &RETURN=,                                               *00153017
               &TASK=                                                   00200017
.*                                                                      00400000
.* ----------------------------------- LOCAL PARAMETERS        @D51MDGL 00450000
         LCLA  &FUNCT,&FUNCT2,&FUNCT3  FUNCTION CODES          @D51MDGL 00500000
         LCLA  &PARAM,&POSCNT,&POSSIB  COUNTER VARIABLES       @D51MDGL 00550000
         LCLC  &PARCOM                 PARAMETER STATUS        @D51MDGL 00600000
         LCLC  &PATT,&PATT2,&PATT3     OPERAND COMBINATIONS    @D51MDGL 00650000
         LCLC  &REG(6),&REG2(6),&REG3(6) USAGE OF REGISTERS    @D51MDGL 00700000
         LCLC  &PARNAM(6)              SUPPORT FOR MESSAGES    @D51MDGL 00750000
.*                                                                      00800000
***************************************************************         00850000
*                                                                       00900000
         AGO   .CPRIGHT                                                 01100000
.*                                                                      01150000
*        LICENSED MATERIALS - PROGRAM PROPERTY OF IBM                   01200000
*        THIS MACRO IS "RESTRICTED MATERIALS OF IBM"                    01250000
*        5686-066 (C) COPYRIGHT IBM CORP. 1979, 2000                    01300017
*        SEE COPYRIGHT INSTRUCTIONS                                     01350000
.*                                                                      01400000
.CPRIGHT ANOP                                                           01450000
*                                                                       01500000
***************************************************************         01550000
.*                                                                      01600000
.*                                                                      01650000
.**** START OF SPECIFICATIONS ***************************************** 01700000
.*                                                                      01750000
.*01* MODULE-TYPE = MACRO                                               01800000
.*                                                                      01850000
.*01* DESCRIPTIVE NAME = MODIFY A TASK RELATED FIELD                    01900000
.*                                                                      01950000
.*  STATUS           =  NEW MACRO - FIRST RELEASE 35.0                  02000000
.*                      EXTENDED RELEASE 1.2                   @D369DWK 02050000
.*                      EXTENDED RELEASE 1.3                   @D379DWK 02100000
.*                      EXTENDED RELEASE 2.1                   @D149DWK 02150000
.*                      EXTENDED RELEASE 4.1.1                 @D31LDMZ 02200000
.*                      EXTENDED RELEASE 5.1.0                 @D51IDGL 02250000
.*  FUNCTION         =  THE MACRO CHECKS THE USER SUPPLIED              02300000
.*                      OPERANDS AND LOADS THE NECESSARY                02350000
.*                      REGISTERS FOR SVC 107.                          02400000
.*  NOTES            =                                                  02450000
.*  DEPENDENCIES     =                                                  02500000
.*  RESTRICTIONS     =                                                  02550000
.*  REGISTER CONVENT.=  ON ENTRY TO SVC 107, R0 CONTAINS THE OLD,       02600000
.*                      R1 THE NEW VALUE WHEREVER APPLICABLE.           02650000
.*                      REGISTER 15 CONTAINS THE FUNCTION CODE.         02700000
.*  PATCH LABEL      =  NONE                                            02750000
.*  MACRO TYPE       =  ASSEMBLER                                       02800000
.*  PROCESSOR        =  ASM                                             02850000
.*  MACRO SIZE       =                                                  02900000
.*  ATTRIBUTES       =                                                  02950000
.*  ENTRY POINT      =  MODFLD                                          03000000
.*  PURPOSE          =  SEE FUNCTION                                    03050000
.*  LINKAGE          =                                                  03100000
.*  CALLER           =                                                  03150000
.*  INPUT            =   (CALLING SEQUENCE)                             03200000
.*                                                             @.....GL 03250000
.*        LABEL   MODFLD   FIELD=NAME1,                                 03300000
.*                         NEWVAL=(NAME2 | (R2) )                       03350000
.*                         TASK=(NAME3 | (R3) )                @D369DWK 03400000
.*                         PART=(NAME3 | (R3) )                @D369DWK 03450000
.*                         PU=(NAME3 | (R3) )                  @D149DWK 03500000
.*                         LU=(NAME3 | (R3) )                  @D149DWK 03550000
.*                         CUU=(NAME3 | (R3) )                 @D149DWK 03575000
.*                                                                      03600000
.*                OPERANDS :                                            03650000
.*                 FIELD = SYMBOLIC IDENTIFICATION OF THE               03700000
.*                         FIELD TO BE MODIFIED.                        03750000
.*                                                                      03800000
.*  --------------------------------------------------------            03834600
.*  | FIELD:   | FUNC.|           VALID PARAMETERS         |            03869200
.*  |          | CODE |NEWVAL | PART | TASK | PU | LU | CUU|            03903800
.*  --------------------------------------------------------            03938400
.*  | SYSRESW  |  0F  |  RQ   |  IN  |  OP  | IN | IN | IN |            03973000
.*  | CNCLCODE |  10  |  RQ   |  IN  |  OP  | IN | IN | IN |            04007600
.*  | VTAMOPEN |  11  |  RQ   |  IN  |  OP  | IN | IN | IN |            04042200
.*  | VTAMDISP |  12  |  RQ   |  IN  |  OP  | IN | IN | IN |            04076800
.*  | SAVAR    |  1C  |  RQ   |  IN  |  OP  | IN | IN | IN |            04111400
.*  | CNCLALL  |  1D  |  RQ   |  IN  |  OP  | IN | IN | IN |            04146000
.*  | ICCFPP   |  22  |  RQ   |  IN  |  OP  | IN | IN | IN |            04180600
.*  | ICCFRO   |  23  |  RQ   |  IN  |  OP  | IN | IN | IN |            04215200
.*  | ACLOSE   |  24  |  RQ   |  OP  |  IN  | IN | IN | IN |            04249800
.*  | VSAMOPEN |  27  |  RQ   |  OP  |  IN  | IN | IN | IN |            04284400
.*  | OPENSVA  |  2C  |  RQ   |  IN  |  OP  | IN | IN | IN |            04319000
.*  | ICCFSVC  |  2D  |  RQ   |  IN  |  OP  | IN | IN | IN |            04353600
.*  | DLIBLK   |  3A  |  RQ   |  IN  |  IN  | IN | IN | IN |            04353716
.*  | IPANCH   |  3C  |  RQ   |  IN  |  IN  | IN | IN | IN |            04353816
.*  | MOUNTFLG |  4C  |  RQ   |  IN  |  IN  | RQ | IN | IN |            04388200
.*  | MSECS    |  53  |  RQ   |  IN  |  IN  | IN | IN | IN |            04422800
.*  | PERBIT   |  57  |  RQ   |  OP  |  IN  | IN | IN | IN |            04457400
.*  | RUNMODE  |  5A  |  RQ   |  IN  |  IN  | IN | IN | IN |            04492000
.*  | SASCOPE  |  5B  |  RQ   |  IN  |  IN  | IN | IN | IN |            04526600
.*  | PASCOPE  |  5C  |  RQ   |  IN  |  IN  | IN | IN | IN |            04561200
.*  | DB2      |  5E  |  IN   |  IN  |  IN  | IN | IN | IN |            04561319
.*  | LIBRSERV |  61  |  RQ   |  IN  |  OP  | IN | IN | IN |            04595800
.*  | RIPLAUTH |  6A  |  RQ   |  IN  |  IN  | IN | IN | IN |            04630400
.*  | SCSICUU  |  72  |  IN   |  IN  |  IN  | IN | IN | RQ |            04630520
.*  | COPYOWN  |  92  |  RQ   |  IN  |  IN  | RQ | IN | IN |            04665000
.*  | RESETOWN |  93  |  IN   |  OP  |  IN  | RQ | IN | IN |            04699600
.*  | VSPTFLG  |  94  |  RQ   |  IN  |  IN  | IN | IN | IN |            04734200
.*  | SASCOPE1 |  95  |  RQ   |  IN  |  IN  | IN | IN | IN |            04768800
.*  | PASCOPE1 |  96  |  RQ   |  IN  |  IN  | IN | IN | IN |            04803400
.*  | PUBDEVTY |  A4  |  RQ   |  IN  |  IN  | RQ | IN | IN |            04838000
.*  | MNTRSTMP |  A5  |  IN   |  OP  |  IN  | IN | IN | RQ |            04872600
.*  | MNTRSPRM |  A6  |  IN   |  OP  |  IN  | IN | IN | RQ |            04907200
.*  | MNTRSFRC |  A7  |  IN   |  RQ  |  IN  | IN | IN | RQ |            04941800
.*  | MNTRLTMP |  A8  |  IN   |  OP  |  IN  | IN | IN | RQ |            04976400
.*  | MNTRLPRM |  A9  |  IN   |  OP  |  IN  | IN | IN | RQ |            05011000
.*  | MNTRLTPA |  AA  |  IN   |  IN  |  IN  | RQ | IN | IN |            05045600
.*  | MNTRLPRA |  AD  |  IN   |  IN  |  IN  | RQ | IN | IN |            05080200
.*  | CELANCH  |  A0  |  RQ   |  IN  |  IN  | IN | IN | IN |            05114800
.*  | MNTINFO  |  B1  |  RQ   |  IN  |  IN  | IN | IN | RQ |            05149400
.*  | RXEOJPTR |  B3  |  RQ   |  IN  |  IN  | IN | IN | IN |            05184000
.*  | RID      |  B6  |  RQ   |  IN  |  IN  | IN | IN | IN |            05218600
.*  | IPWSEGM  |  B8  |  IN   |  IN  |  IN  | IN | IN | IN |            05218703
.*  | MODE     |  BA  |  RQ   |  RQ  |  IN  | IN | RQ | IN |            05218804
.*  | MODE     |  BB  |  RQ   |  IN  |  IN  | RQ | IN | IN |            05218904
.*  | PMODE    |  BC  |  RQ   |  RQ  |  IN  | IN | RQ | IN |            05219007
.*  | PMODE    |  BD  |  RQ   |  IN  |  IN  | RQ | IN | IN |            05219107
.*  | ACEEPTR  |  C0  |  RQ   |  IN  |  IN  | IN | IN | IN |            05220014
.*  | SYSAL    |  C2  |  RQ   |  RQ  |  IN  | IN | IN | IN |            05230010
.*  --------------------------------------------------------            05253200
.*     OP = OPTIONAL                                                    05287800
.*     IN = INVALID                                                     05322400
.*     IG = IGNORED                                                     05357000
.*     RQ = REQUIRED                                                    05391600
.*                                                                      05426200
.*               NEWVAL = NAME OF A 4 BYTE FIELD OR A REGISTER          05460800
.*                        CONTAINING THE NEW VALUE TO BE USED           05495400
.*                        FOR THE MODIFICATION                          05530000
.*                                                                      05564600
.*                TASK  = NAME OF A 2 BYTE FIELD OR A REGISTER          05600000
.*                        CONTAINING THE TASK ID TO WHICH THE           05650000
.*                        FIELD BELONGS.                                05700000
.*                        DEFAULT : THE REQUESTORS TASK ID              05750000
.*                                                                      05800000
.*                PART  = NAME OF A 2 BYTE FIELD OR REGISTER   @D369DWK 05850000
.*                        CONTAINING THE PARTITION TO WHICH    @D369DWK 05900000
.*                        THE FIELD BELONGS.                   @D369DWK 05950000
.*                        DEFAULT : PIK OF REQUESTOR           @D369DWK 06000000
.*                                                             @D369DWK 06050000
.*                PU    = NAME OF A 2 BYTE FIELD OR REGISTER   @D149DWK 06100000
.*                        CONTAINING THE PHYSICAL UNIT NUMBER  @D149DWK 06150000
.*                        OF THE DEVICE TO WHICH THE FIELD     @D149DWK 06200000
.*                        BELONGS.                             @D149DWK 06250000
.*                                                             @D149DWK 06300000
.*                LU    = NAME OF A 2 BYTE FIELD OR A REGISTER @D149DWK 06350000
.*                        CONTAINING THE LOGICAL UNIT (FORMAT  @D149DWK 06400000
.*                        AS IN CCB )                          @D149DWK 06450000
.*                                                             @D149DWK 06500000
.*               CUU    = NAME OF A 2 BYTE FIELD OR A REGISTER @52CASGL 06550000
.*                        CONTAINING THE CUU OF THE DEVICE     @52CASGL 06600000
.*                                                                      06700000
.*  MACROS GENERATING SVC 107 :                                @D149DWK 06750000
.*         GETFLD,   MODFLD,   TREADY,   TSTOP,   RLOCK,       @D149DWK 06800000
.*         SRCHFLD,  DEVUSE,   DEVREL,   SENTER,  SLEAVE,      @D149DWK 06850000
.*         VIOPOINT                                            @D149DWK 06900000
.*                                                                      06950000
.* ====> CHECK SUPERVISOR GENERATION MACRO SGTINF FOR HIGHEST  @D149DWK 07000000
.* ====> FUNCTION CODE USED WHEN EXTENDING MODFLD              @D149DWK 07050000
.*                                                                      07100000
.*  OUTPUT(EXECUTION)=  DESIGNATED FIELD UPDATED IN THE CORRESPONDING   07150000
.*                      CONTROL BLOCK.                                  07200000
.*                                                                      07250000
.*  EXIT NORMAL      =  COMPILER :                                      07300000
.*                      MACRO EXPANSION                                 07350000
.*                      EXECUTION:                                      07400000
.*                      CONTROL RETURNED TO USER                        07450000
.*                                                                      07500000
.*  EXIT ERROR       =  COMPILER :                                      07550000
.*                      MNOTES INDICATING THE ERROR                     07600000
.*                      EXECUTION:                                      07650000
.*                      NO RETURN CODE SET                              07700000
.*                                                                      07750000
.*                      ILLEGAL SVC IS FORCED WHEN                      07800000
.*                      - REQUESTOR HAS NOT KEY ZERO                    07850000
.*                      - PASSED PARAMETERS INVALID                     07900000
.*                                                                      07950000
.*  EXTERNAL REFEREN.=  NONE                                            08000000
.*  ROUTINES         =  SVC 107 (SUPERVISOR GENERATION MACRO SGTINF)    08050000
.*  DATA AREAS       =  NONE                                            08100000
.*  CONTROL BLOCKS   =  NONE                                            08150000
.*  TABLES           =  NONE                                            08200000
.*  MACROS           =  NONE                                            08250000
.*  CHANGE ACTIVITIES=  NEW MACRO   FIRST RELEASE 35.0                  08300000
.*  CHANGE 01        =  EXTENSION FOR RELEASE 1.2              @D369DWK 08350000
.*  CHANGE 02        =  EXTENSION FOR RELEASE 1.3              @D379DWK 08400000
.*  CHANGE 03        =  EXTENSION FOR RELEASE 2.1              @D149DWK 08450000
.*  CHANGE 04        =  EXTENSION FOR RELEASE 4.1.1            @D31LDMZ 08500000
.*  CHANGE 05           MORE PARTITIONS 5.1.0                  @D51MDGL 08550000
.*                      NEW LOGIC FUNCTIONS ARE NOW DESCRIBED  @D51MDGL 08600000
.*                      BY THEIR OPERAND COMBINATIONS AND THE  @D51MDGL 08650000
.*                      USED REGISTERS.                        @D51MDGL 08700000
.*  CHANGE 06        =  ADD DLIBLK FIELD                       @DY45299 08701016
.*  CHANGE 07        =  ADD IPANCH FIELD                       @D25IDAP 08710016
.*  CHANGE 08        =  ADD SCSICUU FIELD                      @D28ADAP 08720020
.*  MODIFIED REGISTER=  REGISTER 0, 1 AND 15                            08750000
.*                                                                      08800000
.*  A000000-999999                                             @D352DWK 08850000
.*                                                                      08900000
.** END OF SPECICATIONS *********************************************** 08950000
.*                                                                      09000000
.*                                                                      09050000
.*============================================================ @D51MDGL 09100000
.* DECLARATION OF ALL VALID FUNCTIONS AND THEIR ALLOWED        @D51MDGL 09150000
.* COMBINATION OF PARAMETERS, USING THE FOLLOWING CONVENTION   @D51MDGL 09200000
.*     FUNCT ..... CODE SUPPLIED IN REG 15 FOR HANDLING OF SVC @D51MDGL 09250000
.*     PATT ...... STRING OF ALLOWED PARAMETER COMBINATIONS    @D51MDGL 09300000
.*                 THE SEQ.IS: NEWVAL, PART, TASK, PU, LU, CUU @D25IDAP 09360015
.*                   O - PARAMETER MUST BE OBMITTED            @D51MDGL 09400016
.*                   P - PARAMETER OPTIONAL                    @D51MDGL 09450000
.*                   R - PARAMETER REQUIRED                    @D51MDGL 09500000
.*                   I - PARAMETER WILL BE IGNORED             @D51MDGL 09550000
.*                   = - THIS ALWAYS TERMINATES THE CHECKING   @D51MDGL 09600000
.*                       AND ALLOWS DIFFERENT LENGTHS FOR PATT @D51MDGL 09650000
.*     REG ....... DENOTES THE REGISTERS TO USE FOR THE GIVEN  @D51MDGL 09700000
.*                 PARAMETERS. (REG(1)- NEWVAL;(2)- PART ETC.) @D51MDGL 09750000
.*                   X - PARAMETER NOT ALLOWED (DEFAULT)       @D51MDGL 09800000
.*                   N - LOAD REGISTER N (N=0..15)             @D51MDGL 09850000
.*     POSSIB .... COUNTER FOR THE DIFFERENT ALTERNATIVES      @D51MDGL 09900000
.*                 VALID WITH AN GIVEN FIELDNAME (INITIAL = 1) @D51MDGL 09950000
.* IN THE CASE, THAT THERE ARE SEVERAL DIFFERENT FUNCTION      @D51MDGL 10000000
.* CODES AND PARAMETERS, ASSIGN THE FUNCT2 ... ALTERNATE       @D51MDGL 10050000
.* PARAMETERS. ONLY THE HIGHEST NUMBERED POSIBILITY WILL       @D51MDGL 10100000
.* PRODUCE AN ERROR MESSAGE, ALL OTHER MESSAGES ARE SUPPRESSED @D51MDGL 10150000
.*============================================================ @D51MDGL 10200000
.*----------------------------------------                     @D51MDGL 10250000
.* INITIALISATION OF THE LOCAL PARAMETERS                      @D51MDGL 10300000
.*----------------------------------------                     @D51MDGL 10350000
&POSCNT  SETA  1                                               @D51MDGL 10400000
&POSSIB  SETA  1                                               @D51MDGL 10450000
&REG(1)  SETC 'X'   SET REGISTER NUMBER TO HAND OVER NEWVAL    @D51MDGL 10500000
&REG(2)  SETC 'X'                                    PART      @D51MDGL 10550000
&REG(3)  SETC 'X'                                    TASK      @D51MDGL 10600000
&REG(4)  SETC 'X'                                    PU        @D51MDGL 10650000
&REG(5)  SETC 'X'                                    LU        @D51MDGL 10700000
&REG(6)  SETC 'X'                                    CUU       @D51MDGL 10725000
&REG2(1) SETC 'X'                                              @D51MDGL 10750000
&REG2(2) SETC 'X'                                              @D51MDGL 10800000
&REG2(3) SETC 'X'                                              @D51MDGL 10850000
&REG2(4) SETC 'X'                                              @D51MDGL 10900000
&REG2(5) SETC 'X'                                              @D51MDGL 10950000
&REG2(6) SETC 'X'                                              @D51MDGL 10975000
&REG3(1) SETC 'X'                                              @D51MDGL 11000000
&REG3(2) SETC 'X'                                              @D51MDGL 11050000
&REG3(3) SETC 'X'                                              @D51MDGL 11100000
&REG3(4) SETC 'X'                                              @D51MDGL 11150000
&REG3(5) SETC 'X'                                              @D51MDGL 11200000
&REG3(6) SETC 'X'                                              @D51MDGL 11225000
&PARNAM(1) SETC 'NEWVAL'                                       @D51MDGL 11250000
&PARNAM(2) SETC 'PART'                                         @D51MDGL 11300000
&PARNAM(3) SETC 'TASK'                                         @D51MDGL 11350000
&PARNAM(4) SETC 'PU'                                           @D51MDGL 11400000
&PARNAM(5) SETC 'LU'                                           @D51MDGL 11450000
&PARNAM(6) SETC 'CUU'                                          @D51MDGL 11475000
.* CHECK IF THERE IS A GIVEN FIELD VALUE FIRST                 @D51MDGL 11500000
         AIF   (T'&FIELD EQ 'O').NOTE02          NO FIELD      @D51MDGL 11550000
.* -------                                                     @D51MDGL 11600000
         AIF   ('&FIELD' NE 'SYSRESW').FUN10        SYSRESW    @D51MDGL 11650000
&FUNCT   SETA  15                                              @D51MDGL 11700000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 11750000
&REG(1)  SETC  '1'                                             @D51MDGL 11800000
&REG(3)  SETC  '0'                                             @D51MDGL 11850000
         AGO   .CHECK                                          @D51MDGL 11900000
.* -------                                                     @D51MDGL 11950000
.FUN10   AIF   ('&FIELD' NE 'CNCLCODE').FUN11       CNCLCODE   @D51MDGL 12000000
&FUNCT   SETA  16                                              @D51MDGL 12050000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 12100000
&REG(1)  SETC  '1'                                             @D51MDGL 12150000
&REG(3)  SETC  '0'                                             @D51MDGL 12200000
         AGO   .CHECK                                          @D51MDGL 12250000
.* -------                                                     @D51MDGL 12300000
.FUN11   AIF   ('&FIELD' NE 'VTAMOPEN').FUN12                  @D51MDGL 12350000
&FUNCT   SETA  17                                              @D51MDGL 12400000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 12450000
&REG(1)  SETC  '1'                                             @D51MDGL 12500000
&REG(3)  SETC  '0'                                             @D51MDGL 12550000
         AGO   .CHECK                                          @D51MDGL 12600000
.* -------                                                     @D51MDGL 12650000
.FUN12   AIF   ('&FIELD' NE 'VTAMDISP').FUN1C                  @D51MDGL 12700000
&FUNCT   SETA  18                                              @D51MDGL 12750000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 12800000
&REG(1)  SETC  '1'                                             @D51MDGL 12850000
&REG(3)  SETC  '0'                                             @D51MDGL 12900000
         AGO   .CHECK                                          @D51MDGL 12950000
.* -------                                                     @D51MDGL 13000000
.FUN1C   AIF   ('&FIELD' NE 'SAVAR').FUN1D                     @D51MDGL 13050000
&FUNCT   SETA  28                                              @D51MDGL 13100000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 13150000
&REG(1)  SETC  '1'                                             @D51MDGL 13200000
&REG(3)  SETC  '0'                                             @D51MDGL 13250000
         AGO   .CHECK                                          @D51MDGL 13300000
.* -------                                                     @D51MDGL 13350000
.FUN1D   AIF   ('&FIELD' NE 'CNCLALL').FUN22                   @D51MDGL 13400000
&FUNCT   SETA  29                                              @D51MDGL 13450000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 13500000
&REG(1)  SETC  '1'                                             @D51MDGL 13550000
&REG(3)  SETC  '0'                                             @D51MDGL 13600000
         AGO   .CHECK                                          @D51MDGL 13650000
.* -------                                                     @D51MDGL 13700000
.FUN22   AIF   ('&FIELD' NE 'ICCFPP').FUN23                    @D51MDGL 13750000
&FUNCT   SETA  34                                              @D51MDGL 13800000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 13850000
&REG(1)  SETC  '1'                                             @D51MDGL 13900000
&REG(3)  SETC  '0'                                             @D51MDGL 13950000
         AGO   .CHECK                                          @D51MDGL 14000000
.* -------                                                     @D51MDGL 14050000
.FUN23   AIF   ('&FIELD' NE 'ICCFRO').FUN24                    @D51MDGL 14100000
&FUNCT   SETA  35                                              @D51MDGL 14150000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 14200000
&REG(1)  SETC  '1'                                             @D51MDGL 14250000
&REG(3)  SETC  '0'                                             @D51MDGL 14300000
         AGO   .CHECK                                          @D51MDGL 14350000
.* -------                                                     @D51MDGL 14400000
.FUN24   AIF   ('&FIELD' NE 'ACLOSE').FUN27                    @D51MDGL 14450000
&FUNCT   SETA  36                                              @D51MDGL 14500000
&PATT    SETC  'RPOOOO='                                       @D51MDGL 14550000
&REG(1)  SETC  '1'                                             @D51MDGL 14600000
&REG(2)  SETC  '0'                                             @D51MDGL 14650000
         AGO   .CHECK                                          @D51MDGL 14700000
.* -------                                                     @D51MDGL 14750000
.FUN27   AIF   ('&FIELD' NE 'VSAMOPEN').FUN2C                  @D51MDGL 14800000
&FUNCT   SETA  39                                              @D51MDGL 14850000
&PATT    SETC  'RPOOOO='                                       @D51MDGL 14900000
&REG(1)  SETC  '1'                                             @D51MDGL 14950000
&REG(2)  SETC  '0'                                             @D51MDGL 15000000
         AGO   .CHECK                                          @D51MDGL 15050000
.* -------                                                     @D51MDGL 15100000
.FUN2C   AIF   ('&FIELD' NE 'OPENSVA').FUN2D                   @D51MDGL 15150000
&FUNCT   SETA  44                                              @D51MDGL 15200000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 15250000
&REG(1)  SETC  '1'                                             @D51MDGL 15300000
&REG(3)  SETC  '0'                                             @D51MDGL 15350000
         AGO   .CHECK                                          @D51MDGL 15400000
.* -------                                                     @D51MDGL 15450000
.FUN2D   AIF   ('&FIELD' NE 'ICCFSVC').FUN3A                   @DY45299 15500016
&FUNCT   SETA  45                                              @D51MDGL 15550000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 15600000
&REG(1)  SETC  '1'                                             @D51MDGL 15650000
&REG(3)  SETC  '0'                                             @D51MDGL 15700000
         AGO   .CHECK                                          @D51MDGL 15750000
.* -------                                                     @D51MDGL 15751016
.FUN3A   AIF   ('&FIELD' NE 'DLIBLK').FUN3C                    @DY45299 15752016
&FUNCT   SETA  58                                              @DY45299 15753016
&PATT    SETC  'ROOOOO='                                       @DY45299 15754016
&REG(1)  SETC  '1'                                             @DY45299 15755016
         AGO   .CHECK                                          @DY45299 15756016
.* -------                                                     @D51MDGL 15760015
.FUN3C   AIF   ('&FIELD' NE 'IPANCH').FUN4C                    @D25IDAP 15770015
&FUNCT   SETA  60                                              @D25IDAP 15780015
&PATT    SETC  'ROOOOO='                                       @D25IDAP 15790015
&REG(1)  SETC  '1'                                             @D25IDAP 15791015
         AGO   .CHECK                                          @D25IDAP 15792015
.* -------                                                     @D51MDGL 15800000
.FUN4C   AIF   ('&FIELD' NE 'MOUNTFLG').FUN53                  @D51MDGL 15850000
&FUNCT   SETA  76                                              @D51MDGL 15900000
&PATT    SETC  'ROOPOO='                                       @D51MDGL 15950000
&REG(1)  SETC  '1'                                             @D51MDGL 16000000
&REG(4)  SETC  '0'                                             @D51MDGL 16050000
         AGO   .CHECK                                          @D51MDGL 16100000
.* -------                                                     @D51MDGL 16150000
.FUN53   AIF   ('&FIELD' NE 'MSECS').FUN57                     @D51MDGL 16200000
&FUNCT   SETA  83                                              @D51MDGL 16250000
&PATT    SETC  'ROOOOO='                                       @D51MDGL 16300000
&REG(1)  SETC  '1'                                             @D51MDGL 16350000
         AGO   .CHECK                                          @D51MDGL 16400000
.* -------                                                     @D51MDGL 16450000
.FUN57   AIF   ('&FIELD' NE 'PERBIT').FUN5A                    @D51MDGL 16500000
&FUNCT   SETA  87                                              @D51MDGL 16550000
&PATT    SETC  'RPOOOO='                                       @D51MDGL 16600000
&REG(1)  SETC  '1'                                             @D51MDGL 16650000
&REG(2)  SETC  '0'                                             @D51MDGL 16700000
         AGO   .CHECK                                          @D51MDGL 16750000
.* -------                                                     @D51MDGL 16800000
.FUN5A   AIF   ('&FIELD' NE 'RUNMODE').FUN5B                   @D51MDGL 16850000
&FUNCT   SETA  90                                              @D51MDGL 16900000
&PATT    SETC  'ROOOOO='                                       @D51MDGL 16950000
&REG(1)  SETC  '1'                                             @D51MDGL 17000000
         AGO   .CHECK                                          @D51MDGL 17050000
.* -------                                                     @D51MDGL 17100000
.FUN5B   AIF   ('&FIELD' NE 'SASCOPE').FUN5C                   @D51MDGL 17150000
&FUNCT   SETA  91                                              @D51MDGL 17200000
&PATT    SETC  'ROOOOO='                                       @D51MDGL 17250000
&REG(1)  SETC  '1'                                             @D51MDGL 17300000
         AGO   .CHECK                                          @D51MDGL 17350000
.* -------                                                     @D51MDGL 17400000
.FUN5C   AIF   ('&FIELD' NE 'PASCOPE').FUN5E                   @D65CDOW 17450018
&FUNCT   SETA  92                                              @D51MDGL 17500000
&PATT    SETC  'ROOOOO='                                       @D51MDGL 17550000
&REG(1)  SETC  '1'                                             @D51MDGL 17600000
         AGO   .CHECK                                          @D51MDGL 17650000
.* -------                                                     @D51MDGL 17660018
.FUN5E   AIF   ('&FIELD' NE 'DB2').FUN61                       @D65CDOW 17670018
&FUNCT   SETA  94                                              @D65CDOW 17680018
&PATT    SETC  '0OOOOO='                                       @D65CDOW 17690018
         AGO   .CHECK                                          @D65CDOW 17692018
.* -------                                                     @D51MDGL 17700000
.FUN61   AIF   ('&FIELD' NE 'LIBRSERV').FUN6A                  @D51MDGL 17750000
&FUNCT   SETA  97                                              @D51MDGL 17800000
&PATT    SETC  'ROPOOO='                                       @D51MDGL 17850000
&REG(1)  SETC  '1'                                             @D51MDGL 17900000
&REG(3)  SETC  '0'                                             @D51MDGL 17950000
         AGO   .CHECK                                          @D51MDGL 18000000
.* -------                                                     @D51MDGL 18050000
.FUN6A   AIF   ('&FIELD' NE 'RIPLAUTH').FUN72                  @D51MDGL 18100020
&FUNCT   SETA  106                                             @D51MDGL 18150000
&PATT    SETC  'ROOOOO='                                       @D51MDGL 18200000
&REG(1)  SETC  '1'                                             @D51MDGL 18250000
         AGO   .CHECK                                          @D51MDGL 18300000
.* -------                                                     @D28ADAP 18310020
.FUN72   AIF   ('&FIELD' NE 'SCSICUU').FUN92                   @D28ADAP 18320020
&FUNCT   SETA  114                                             @D28ADAP 18330021
&PATT    SETC  '0OOOOR='                                       @D28ADAP 18340020
&REG(6)  SETC  '0'                                             @D28ADAP 18341020
         AGO   .CHECK                                          @D51MDGL 18342020
.* -------                                                     @D51MDGL 18350000
.FUN92   AIF   ('&FIELD' NE 'COPYOWN').FUN93                   @D51IDGL 18400000
&FUNCT   SETA  146                                             @D51IDGL 18450000
&PATT    SETC  'ROOROO='                                       @D51IDGL 18500000
&REG(1)  SETC  '1'                                             @D51IDGL 18550000
&REG(4)  SETC  '0'                                             @D51IDGL 18600000
         AGO   .CHECK                                          @D51IDGL 18650000
.* -------                                                     @D51MDGL 18700000
.FUN93   AIF   ('&FIELD' NE 'RESETOWN').FUN94                  @D51IDGL 18750000
&FUNCT   SETA  147                                             @D51IDGL 18800000
&PATT    SETC  'OPOROO='                                       @D51IDGL 18850000
&REG(2)  SETC  '1'                                             @D51IDGL 18900000
&REG(4)  SETC  '0'                                             @D51IDGL 18950000
         AGO   .CHECK                                          @D51IDGL 19000000
.* -------                                                     @D51MDGL 19050000
.FUN94   AIF   ('&FIELD' NE 'VSPTFLG').FUN95                   @VSPT.GL 19100000
&FUNCT   SETA  148                                             @VSPT.GL 19150000
&PATT    SETC  'ROOOOO='                                       @VSPT.GL 19200000
&REG(1)  SETC  '1'                                             @VSPT.GL 19250000
         AGO   .CHECK                                          @VSPT.GL 19300000
.* -------                                                     @D51IDGL 19350000
.FUN95   AIF   ('&FIELD' NE 'SASCOPE1').FUN96                  @D51IDGL 19400000
&FUNCT   SETA  149                                             @D51IDGL 19450000
&PATT    SETC  'ROOOOO='                                       @D51IDGL 19500000
&REG(1)  SETC  '1'                                             @D51IDGL 19550000
         AGO   .CHECK                                          @D51IDGL 19600000
.* -------                                                     @D51IDGL 19650000
.FUN96   AIF   ('&FIELD' NE 'PASCOPE1').FUNA5                  @D51IDGL 19700000
&FUNCT   SETA  150                                             @D51IDGL 19750000
&PATT    SETC  'ROOOOO='                                       @D51IDGL 19800000
&REG(1)  SETC  '1'                                             @D51IDGL 19850000
         AGO   .CHECK                                          @D51IDGL 19900000
.* -------                                                     @D51IDGL 19901300
.FUNA5   AIF   ('&FIELD' NE 'MNTRSTMP').FUNA6                  @52CASGL 19902600
&FUNCT   SETA  165                                             @52CASGL 19903900
&PATT    SETC  'OPOOOR='                                       @52CASGL 19905200
&REG(2)  SETC  '1'                                             @52CASGL 19905800
&REG(6)  SETC  '0'                                             @52CASGL 19906500
         AGO   .CHECK                                          @52CASGL 19907800
.* -------                                                     @52CASGL 19909100
.FUNA6   AIF   ('&FIELD' NE 'MNTRSPRM').FUNA7                  @52CASGL 19910400
&FUNCT   SETA  166                                             @52CASGL 19911700
&PATT    SETC  'OPOOOR='                                       @52CASGL 19913000
&REG(2)  SETC  '1'                                             @52CASGL 19913600
&REG(6)  SETC  '0'                                             @52CASGL 19914300
         AGO   .CHECK                                          @52CASGL 19915600
.* -------                                                     @52CASGL 19916900
.FUNA7   AIF   ('&FIELD' NE 'MNTRSFRC').FUNA8                  @52CASGL 19918200
&FUNCT   SETA  167                                             @52CASGL 19919500
&PATT    SETC  'OROOOR='                                       @52CASGL 19920800
&REG(2)  SETC  '1'                                             @52CASGL 19922100
&REG(6)  SETC  '0'                                             @52CASGL 19923400
         AGO   .CHECK                                          @52CASGL 19924700
.* -------                                                     @52CASGL 19926000
.FUNA8   AIF   ('&FIELD' NE 'MNTRLTMP').FUNA9                  @52CASGL 19927300
&FUNCT   SETA  168                                             @52CASGL 19928600
&PATT    SETC  'OPOOOR='                                       @52CASGL 19929900
&REG(2)  SETC  '1'                                             @52CASGL 19930500
&REG(6)  SETC  '0'                                             @52CASGL 19931200
         AGO   .CHECK                                          @52CASGL 19932500
.* -------                                                     @52CASGL 19933800
.FUNA9   AIF   ('&FIELD' NE 'MNTRLPRM').FUNAA                  @52CASGL 19935100
&FUNCT   SETA  169                                             @52CASGL 19936400
&PATT    SETC  'OPOOOR='                                       @52CASGL 19937700
&REG(2)  SETC  '1'                                             @52CASGL 19938300
&REG(6)  SETC  '0'                                             @52CASGL 19939000
         AGO   .CHECK                                          @52CASGL 19940300
.* -------                                                     @52CASGL 19941600
.FUNAA   AIF   ('&FIELD' NE 'MNTRLTPA').FUNAD                  @52CASGL 19942900
&FUNCT   SETA  170                                             @52CASGL 19944200
&PATT    SETC  'OOOROO='                                       @52CASGL 19945500
&REG(4)  SETC  '1'                                             @52CASGL 19946800
         AGO   .CHECK                                          @52CASGL 19946900
.* -------                                                     @52CASGL 19947000
.FUNAD   AIF   ('&FIELD' NE 'MNTRLPRA').FUNA0                  @52CASGL 19947100
&FUNCT   SETA  173                                             @52CASGL 19947200
&PATT    SETC  'OOOROO='                                       @52CASGL 19947300
&REG(4)  SETC  '1'                                             @52CASGL 19947400
         AGO   .CHECK                                          @52CASGL 19947500
.* -------                                                     @52CASGL 19947600
.FUNA0   AIF   ('&FIELD' NE 'CELANCH' ).FUNB1                  @52CASGL 19947700
&FUNCT   SETA  160                                             @52CASGL 19947800
&PATT    SETC  'ROOOOO='                                       @52CASGL 19947900
&REG(1)  SETC  '1'                                             @52CASGL 19948000
         AGO   .CHECK                                          @52CASGL 19948100
.* -------                                                     @52CASGL 19948300
.FUNB1   AIF   ('&FIELD' NE 'MNTINFO' ).FUNB3                  @52CASGL 19948500
&FUNCT   SETA  177                                             @52CASGL 19948700
&PATT    SETC  'ROOOOR='                                       @52CASGL 19948900
&REG(1)  SETC  '1'                                             @52CASGL 19949100
&REG(6)  SETC  '0'                                             @52CASGL 19949300
         AGO   .CHECK                                          @52CASGL 19949500
.* -------                                                     @52CASGL 19955800
.FUNB3   AIF   ('&FIELD' NE 'RXEOJPTR').FUNB6                  @D61EDOW 19962100
&FUNCT   SETA  179                                             @52CASGL 19968400
&PATT    SETC  'ROOOOO='                                       @52CASGL 19974700
&REG(1)  SETC  '1'                                             @52CASGL 19981000
         AGO   .CHECK                                          @52CASGL 19987300
.* -------                                                     @52CASGL 19988200
.FUNB6   AIF   ('&FIELD' NE 'RID').FUNB8                       @D62ADMK 19989101
&FUNCT   SETA  182                                             @52CASGL 19990000
&PATT    SETC  'ROOOOO='                                       @52CASGL 19990900
&REG(1)  SETC  '1'                                             @52CASGL 19991800
         AGO   .CHECK                                          @52CASGL 19992700
.* -------                                                     @52CASGL 19992803
.FUNB8   AIF   ('&FIELD' NE 'IPWSEGM').FUNBA                   @D62ADMK 19992903
&FUNCT   SETA  184                                             @D62ADMK 19993003
&PATT    SETC  '0OOOOO='                                       @D62ADMK 19993103
&REG(1)  SETC  '1'                                             @52CASGL 19993204
         AGO   .CHECK                                          @52CASGL 19993304
.* -------                                                     @D51IDGL 19993404
.FUNBA   AIF   ('&FIELD' NE 'MODE').FUNBC           MODE       @D62ADMK 19993504
&POSSIB  SETA  2                                               @D62ADMK 19993604
&FUNCT2  SETA  186                                             @D62ADMK 19993704
&PATT2   SETC  'RROORO='                                       @D62ADMK 19993804
&REG2(1) SETC  '1'                                             @D62ADMK 19993904
&REG2(2) SETC  '0'                                             @D62ADMK 19994004
&REG2(5) SETC  '2'                                             @D62ADMK 19994104
.* -------                                                     @D62ADMK 19994204
&FUNCT   SETA  187                                             @D62ADMK 19994304
&PATT    SETC  'ROOROO='                                       @D62ADMK 19994404
&REG(1)  SETC  '1'                                             @D62ADMK 19994503
&REG(4)  SETC  '0'                                             @D62ADMK 19994604
         AGO   .CHECK                                          @D62ADMK 19994703
.* -------                                                     @D62ADMK 19994803
.FUNBC   AIF   ('&FIELD' NE 'PMODE').FUNC0          PMODE      @D64ADMK 19994907
&POSSIB  SETA  2                                               @D63ADMK 19995007
&FUNCT2  SETA  188                                             @D63ADMK 19995107
&PATT2   SETC  'RROORO='                                       @D63ADMK 19995207
&REG2(1) SETC  '1'                                             @D63ADMK 19995307
&REG2(2) SETC  '0'                                             @D63ADMK 19995407
&REG2(5) SETC  '2'                                             @D63ADMK 19995507
.* -------                                                     @D63ADMK 19995607
&FUNCT   SETA  189                                             @D63ADMK 19995707
&PATT    SETC  'ROOROO='                                       @D63ADMK 19995807
&REG(1)  SETC  '1'                                             @D62ADMK 19995907
&REG(4)  SETC  '0'                                             @D63ADMK 19996007
         AGO   .CHECK                                          @D62ADMK 19996113
.* -------                                                     @D63ADMK 19996207
.FUNC0   AIF   ('&FIELD' NE 'ACEEPTR').FUNC2       ACEEPTR     @D64ADMK 19996314
&FUNCT   SETA  192                                             @D64ADMK 19996407
&PATT    SETC  'ROOOOO='                                       @D64ADMK 19996507
&REG(1)  SETC  '1'                                             @D64ADMK 19996607
         AGO   .CHECK                                          @D64ADMK 19996711
.* -------                                                     @D64ADMK 19997007
.FUNC2   AIF   ('&FIELD' NE 'SYSAL').FUNXXX                    @D64ADMK 19998010
&FUNCT   SETA  194                                             @D64ADMK 19999010
&PATT    SETC  'RROOOO='                                       @D64ADMK 19999110
&REG(1)  SETC  '1'                                             @D64ADMK 19999210
&REG(2)  SETC  '0'                                             @D64ADMK 19999312
         AGO   .CHECK                                          @D64ADMK 19999410
.* -------                                                     @D64ADMK 19999510
.FUNXXX  ANOP                                       -NEXT-     @D51MDGL 20000000
.* =========================================================== @D51MDGL 20050000
.* INSERT ADDITIONAL FUNCTIONS HERE. DON'T FORGET TO DEFINE    @D51MDGL 20100000
.* THE CORRRECT SEQUENCE LABELS FOR THE MACRO PROCESSING.      @D51MDGL 20150000
.* =========================================================== @D51MDGL 20200000
.* -------                                                     @D51MDGL 20250000
         AGO   .NOTE01             INVALID FIELD VALUE, ABEND! @D51MDGL 20300000
.*----------------------------------                           @D51MDGL 20350000
.* ERROR MESSAGES AND EXIT OF MACRO                            @D51MDGL 20400000
.*----------------------------------                           @D51MDGL 20450000
.NOTE01  MNOTE 8,'&FIELD IS AN INVALID FIELD OPERAND'          @D51MDGL 20500000
         MEXIT                                                 @D51MDGL 20550000
.NOTE02  MNOTE 8,'REQUIRED FIELD OPERAND NOT SPECIFIED'        @D51MDGL 20600000
         MEXIT                                                 @D51MDGL 20650000
.NOTE03  AIF   (&POSCNT LT &POSSIB).NXTMODL                    @D51MDGL 20700000
         MNOTE 8,'&PARNAM(&PARAM) IS INVALID FOR FIELD=&FIELD' @D51MDGL 20750000
         MEXIT                                                 @D51MDGL 20800000
.NOTE04  AIF   (&POSCNT LT &POSSIB).NXTMODL                    @D51MDGL 20850000
         MNOTE 8,'&PARNAM(&PARAM) IS REQUIRED FOR FIELD=&FIELD'      AH 20900000
         MEXIT                                                 @D51MDGL 20950000
.*-----------------------------------------------------------  @D51MDGL 21000000
.* CHECK FOR ACTUAL SUPLIED PARAMETERS AND CREATE STRING FOR   @D51MDGL 21050000
.* VALIDATION OF THE PARAMETER COMBINATION                     @D51MDGL 21100000
.*-----------------------------------------------------------  @D51MDGL 21150000
.CHECK   AIF   (T'&NEWVAL EQ 'O').NONEWVA        NO NEWVAL     @D51MDGL 21200000
&PARCOM  SETC  'S'                               S.....        @D51MDGL 21250016
         AGO   .PAR2                                           @D51MDGL 21300000
.NONEWVA ANOP                                                  @D51MDGL 21350000
&PARCOM  SETC  'O'                               O.....        @D51MDGL 21400016
.* -------                                                     @D51MDGL 21450000
.PAR2    AIF   (T'&PART EQ 'O').NOPART           NO PART       @D51MDGL 21500000
&PARCOM  SETC  '&PARCOM.S'                       XS....        @D51MDGL 21550016
         AGO   .PAR3                                           @D51MDGL 21600000
.NOPART  ANOP                                                  @D51MDGL 21650000
&PARCOM  SETC  '&PARCOM.O'                       XO....        @D51MDGL 21700016
.* -------                                                     @D51MDGL 21750000
.PAR3    AIF   (T'&TASK EQ 'O').NOTASK           NO TASKID     @D51MDGL 21800000
&PARCOM  SETC  '&PARCOM.S'                       XXS...        @D51MDGL 21850016
         AGO   .PAR4                                           @D51MDGL 21900000
.NOTASK  ANOP                                                  @D51MDGL 21950000
&PARCOM  SETC  '&PARCOM.O'                       XXO...        @D51MDGL 22000016
.* -------                                                     @D51MDGL 22050000
.PAR4    AIF   (T'&PU EQ 'O').NOPU               NO PU         @D51MDGL 22100000
&PARCOM  SETC  '&PARCOM.S'                       XXXS..        @D51MDGL 22150016
         AGO   .PAR5                                           @D51MDGL 22200000
.NOPU    ANOP                                                  @D51MDGL 22250000
&PARCOM  SETC  '&PARCOM.O'                       XXXO..        @D51MDGL 22300016
.* -------                                                     @D51MDGL 22350000
.PAR5    AIF   (T'&LU EQ 'O').NOLU               NO LU         @D51MDGL 22400000
&PARCOM  SETC  '&PARCOM.S'                       XXXXS.        @D51MDGL 22450016
         AGO   .PAR6                                           @D51MDGL 22500000
.NOLU    ANOP                                                  @D51MDGL 22550000
&PARCOM  SETC  '&PARCOM.O'                       XXXXO.        @D51MDGL 22600016
.* -------                                                     @D51MDGL 22650000
.PAR6    AIF   (T'&CUU EQ 'O').NOCUU             NO CUU        @52CASGL 22657100
&PARCOM  SETC  '&PARCOM.S'                       XXXXXS        @52CASGL 22664216
         AGO   .PAREND                                         @52CASGL 22671300
.NOCUU   ANOP                                                  @52CASGL 22678400
&PARCOM  SETC  '&PARCOM.O'                       XXXXXO        @52CASGL 22685516
.* -------                                                     @52CASGL 22692600
.PAREND  ANOP MNOTE 'COMBINATION OF PARAMETERS = &PARCOM'      @D51MDGL 22700000
         AGO   .CHECK2                                         @D51MDGL 22750000
.*---------------------------------------------------------    @D51MDGL 22800000
.* CHECK IF THERE IS ANOTHER ALTERNATE POSSIBILITY FOR THE     @D51MDGL 22850000
.* ACCEPTANCE OF THE ACTUAL PARAMETERS (CONTINUE FOR MORE      @D51MDGL 22900000
.* THAN TWO ALTERNATIVES)                                      @D51MDGL 22950000
.*---------------------------------------------------------    @D51MDGL 23000000
.NXTMODL ANOP MNOTE 'NO SOLUTION FOR THIS PARAMETERS'          @D51MDGL 23050000
         AIF (&POSCNT EQ 2).THIRD                              @D51MDGL 23100000
.SECOND  ANOP                                                  @D51MDGL 23150000
&FUNCT   SETA  &FUNCT2                  THE FUNCTION CODE      @D51MDGL 23200000
&PATT    SETC  '&PATT2'                                        @D51MDGL 23250000
&REG(1)  SETC  '&REG2(1)'               AND THE REGISTERS      @D51MDGL 23300000
&REG(2)  SETC  '&REG2(2)'                                      @D51MDGL 23350000
&REG(3)  SETC  '&REG2(3)'                                      @D51MDGL 23400000
&REG(4)  SETC  '&REG2(4)'                                      @D51MDGL 23450000
&REG(5)  SETC  '&REG2(5)'                                      @D51MDGL 23500000
&REG(6)  SETC  '&REG2(6)'                                      @D51MDGL 23525000
         AGO   .CONTINU                                        @D51MDGL 23550000
.THIRD   ANOP                                                  @D51MDGL 23600000
&FUNCT   SETA  &FUNCT3                  THE FUNCTION CODE      @D51MDGL 23650000
&PATT    SETC  '&PATT3'                                        @D51MDGL 23700000
&REG(1)  SETC  '&REG3(1)'               AND THE REGISTERS      @D51MDGL 23750000
&REG(2)  SETC  '&REG3(2)'                                      @D51MDGL 23800000
&REG(3)  SETC  '&REG3(3)'                                      @D51MDGL 23850000
&REG(4)  SETC  '&REG3(4)'                                      @D51MDGL 23900000
&REG(5)  SETC  '&REG3(5)'                                      @D51MDGL 23950000
&REG(6)  SETC  '&REG3(6)'                                      @D51MDGL 23975000
.CONTINU ANOP                                                  @D51MDGL 24000000
&POSCNT  SETA  &POSCNT+1                CHECK NEXT POSSIBILITY @D51MDGL 24050000
.*-------------------------------------------------------      @D51MDGL 24100000
.* CHECK THAT THE ACTUAL PARAMETER COMBINATION IS VALID        @D51MDGL 24150000
.* TEST AS MANY OPERANDS AS ARE SPECIFIED IN THE PATTERN       @D51MDGL 24200000
.* OF THE FUNCTION DEFINITION. THIS ALLOWS TO INCREASE         @D51MDGL 24250000
.* THE NUMBER OF PARAMETERS WITHOUT CHANGING EXISTING          @D51MDGL 24300000
.* DEFINITIONS (NEW PARAMETERS WILL BE IGNORED).               @D51MDGL 24350000
.*-------------------------------------------------------      @D51MDGL 24400000
.CHECK2  ANOP MNOTE 'MATCH INPUT &PARCOM WITH PATTERN &PATT'   @D51MDGL 24450000
         AIF   ('&PARCOM' EQ '&PATT').GENCODE                  @D51MDGL 24500000
&PARAM   SETA  1                                               @D51MDGL 24550000
.LOOPS   ANOP MNOTE 'CHECK &PARAM.. PARAMETER'  CHECK PARAMS   @D51MDGL 24600000
         AIF  ('&PARCOM'(&PARAM,1) EQ '&PATT'(&PARAM,1)).LOOPE @D51MDGL 24650000
         AIF   ('&PARCOM'(&PARAM,1) EQ 'S').SUPLY              @D51MDGL 24700000
         AIF   ('&PATT'(&PARAM,1) EQ 'R').NOTE04      REQUIRED @D51MDGL 24750000
         AGO   .LOOPE                                          @D51MDGL 24800000
.SUPLY   ANOP  MNOTE '&PARAM.. PARAMETER SUPPLIED'             @D51MDGL 24850000
         AIF   ('&PATT'(&PARAM,1) EQ 'R').LOOPE       REQUIRED @D51MDGL 24900000
         AIF   ('&PATT'(&PARAM,1) EQ 'P').LOOPE       OPTIONAL @D51MDGL 24950000
         AIF   ('&PATT'(&PARAM,1) EQ 'O').NOTE03      OMITTED  @D51MDGL 25000000
.LOOPE   ANOP                                                  @D51MDGL 25050000
&PARAM   SETA  &PARAM+1                                        @D51MDGL 25100000
.*       AIF   (&PARAM LE K'&PATT).LOOPS            OS-VERSION @D51MDGL 25150000
         AIF   ('&PATT'(&PARAM,1) NE '=').LOOPS    DOS- "      @D51MDGL 25200000
.*-----------------------------------------------------------  @D51MDGL 25250000
.* SOLVE CONFLICTS OF MULTIPLE USE OF REGISTERS. IF OPERANDS   @D51MDGL 25300000
.* ARE SUPPLIED IN REGISTERS, WHICH ARE USED INTERNAL, THEY    @D51MDGL 25350000
.* THEY MIGHT BE OVERWRITTEN.                                  @D51MDGL 25400000
.* PROVIDE ERROR MESSAGE AND REFUSE GENERATION.                @D51MDGL 25450000
.*-----------------------------------------------------------  @D51MDGL 25500000
.GENCODE ANOP                                                  @D51MDGL 25550000
&PARAM   SETA  1                                               @D51MDGL 25600000
.CHKLOPS AIF   ('&REG(&PARAM)' EQ 'X').CHKLOPE    NOT ALLOWED  @D51MDGL 25650000
.* BECAUSE NEWVAL IS LOADED LAST, IT NEEDS TEST AGAINST ALL    @D51MDGL 25700000
.* OTHER PARAMETERS. NONE OF THEM MAY USE THE ACTUAL REGISTER, @D51MDGL 25750000
.* NOW CONTAINING THE VALUE FOR NEWVAL                         @D51MDGL 25800000
.CHKNEWV AIF   (&PARAM LE 1).CHKLOPE                           @D51MDGL 25850000
         AIF   ('&REG(&PARAM)' NE '&NEWVAL(1)').CHKPART        @D51MDGL 25900000
         MNOTE 8,'REGISTER &NEWVAL(1) MUST NOT BE USED FOR NEWVAL'   HA 25950000
         MEXIT                                                 @D51MDGL 26000000
.CHKPART AIF   (&PARAM LE 2).CHKLOPE                           @D51MDGL 26050000
         AIF   ('&REG(&PARAM)' NE '&PART(1)').CHKTASK          @D51MDGL 26100000
         MNOTE 8,'REGISTER &PART(1) MUST NOT BE USED FOR PART (PIK)' HA 26150000
         MEXIT                                                 @D51MDGL 26200000
.CHKTASK AIF   (&PARAM LE 3).CHKLOPE         ...               @D51MDGL 26250000
         AIF   ('&REG(&PARAM)' NE '&TASK(1)').CHKPU            @D51MDGL 26300000
         MNOTE 8,'REGISTER &TASK(1) MUST NOT BE USED FOR TASK ID'    HA 26350000
         MEXIT                                                 @D51MDGL 26400000
.CHKPU   AIF   (&PARAM LE 4).CHKLOPE         ...               @D51MDGL 26450000
         AIF   ('&REG(&PARAM)' NE '&PU(1)').CHKLU              @D51MDGL 26500000
         MNOTE 8,'REGISTER &PU(1) MUST NOT BE USED FOR PU INDEX'     HA 26550000
         MEXIT                                                 @D51MDGL 26600000
.CHKLU   AIF   (&PARAM LE 5).CHKLOPE         ...               @D51MDGL 26650000
         AIF   ('&REG(&PARAM)' NE '&LU(1)').CHKLOPE            @D51MDGL 26700000
         MNOTE 8,'REGISTER &LU(1) MUST NOT BE USED FOR LU INDEX'     HA 26750000
         MEXIT                                                 @D51MDGL 26800000
.CHKCUU  AIF   (&PARAM LE 6).CHKLOPE         ...               @52CASGL 26810000
         AIF   ('&REG(&PARAM)' NE '&CUU(1)').CHKLOPE           @52CASGL 26820000
         MNOTE 8,'REGISTER &CUU(1) MUST NOT BE USED FOR CUU'   @52CASGL 26830000
         MEXIT                                                 @52CASGL 26840000
.CHKLOPE ANOP                                                  @D51MDGL 26850000
&PARAM   SETA  &PARAM+1                                        @D51MDGL 26900000
         AIF   (&PARAM LT 7).CHKLOPS                           @D51MDGL 26950000
.*-------------------------------------------------------------@D51MDGL 27000000
.* GENERATE THE CODE FOR THIS CALL                             @D51MDGL 27050000
.*-------------------------------------------------------------@D51MDGL 27100000
         AIF   (T'&MNAME EQ 'O').OMITLBL                       @D51MDGL 27150000
&MNAME   DC    0H'0'                          MODFLD &FUNCT    @D51MDGL 27200016
.OMITLBL ANOP                                                  @D51MDGL 27250000
.* CUU =============                                           @52CASGL 27253100
.DOCUU   AIF   ('&PATT'(6,1) EQ 'I').IGNCUU                    @52CASGL 27256200
         AIF   ('&REG(6)' EQ 'X').ENDCUU      CUU NOT ALLOWED  @52CASGL 27259300
         AIF   ('&PARCOM'(6,1) EQ 'O').OMITCUU                 @52CASGL 27262400
         AIF   ('&CUU'(1,1) EQ '(').REGCUU                     @52CASGL 27265500
         LH    &REG(6),&CUU               LOAD CUU VALUE       @52CASGL 27268600
         AGO   .ENDCUU                                         @52CASGL 27271700
.REGCUU  AIF   ('&REG(6)' EQ '&CUU(1)').ENDCUU  REG.ALREADY OK @52CASGL 27274800
         LR    &REG(6),&CUU(1)            LOAD CUU VALUE       @52CASGL 27277900
         AGO   .ENDCUU                                         @52CASGL 27281000
.IGNCUU  AIF   ('&PARCOM'(6,1) EQ 'O').ENDCUU                  @52CASGL 27284100
         MNOTE 1,'CUU OPERAND IGNORED FOR FIELD=&FIELD'        @52CASGL 27287200
         AGO   .ENDCUU                                         @52CASGL 27290300
.OMITCUU SLR   &REG(6),&REG(6)            DEFAULT CUU VAL. (0) @52CASGL 27293400
.ENDCUU  ANOP                                                  @52CASGL 27296500
.* LU ==============                                           @D51MDGL 27300000
.DOLU    AIF   ('&PATT'(5,1) EQ 'I').IGNLU                     @D51MDGL 27350000
         AIF   ('&REG(5)' EQ 'X').ENDLU        LU NOT ALLOWED  @D51MDGL 27400000
         AIF   ('&PARCOM'(5,1) EQ 'O').OMITL                   @D51MDGL 27450000
         AIF   ('&LU'(1,1) EQ '(').REGLU                       @D51MDGL 27500000
         LH    &REG(5),&LU                LOAD LUB INDEX       @D51MDGL 27550000
         AGO   .ENDLU                                          @D51MDGL 27600000
.REGLU   AIF   ('&REG(5)' EQ '&LU(1)').ENDLU   REG. ALREADY OK @D51MDGL 27650000
         LR    &REG(5),&LU(1)             LOAD LUB INDEX       @D51MDGL 27700000
         AGO   .ENDLU                                          @D51MDGL 27750000
.IGNLU   AIF   ('&PARCOM'(5,1) EQ 'O').ENDLU                   @D51MDGL 27800000
         MNOTE 1,'LU OPERAND IGNORED FOR FIELD=&FIELD'         @D51MDGL 27850000
         AGO   .ENDLU                                          @D51MDGL 27900000
.OMITL   SLR   &REG(5),&REG(5)            DEFAULT LU INDEX (0) @D51MDGL 27950000
.ENDLU   ANOP                                                  @D51MDGL 28000000
.* PU ==============                                           @D51MDGL 28050000
.DOPU    AIF   ('&PATT'(4,1) EQ 'I').IGNPU                     @D51MDGL 28100000
         AIF   ('&REG(4)' EQ 'X').ENDPU   PU NOT ALLOWED       @D51MDGL 28150000
         AIF   ('&PARCOM'(4,1) EQ 'O').OMITPU                  @D51MDGL 28200000
         AIF   ('&PU'(1,1) EQ '(').REGPU                       @D51MDGL 28250000
         LH    &REG(4),&PU                LOAD PUB INDEX       @D51MDGL 28300000
         AGO   .ENDPU                                          @D51MDGL 28350000
.REGPU   AIF   ('&REG(4)' EQ '&PU(1)').ENDPU                   @D51MDGL 28400000
         LR    &REG(4),&PU(1)             LOAD PUB INDEX       @D51MDGL 28450000
         AGO   .ENDPU                                          @D51MDGL 28500000
.IGNPU   AIF   ('&PARCOM'(4,1) EQ 'O').ENDPU                   @D51MDGL 28550000
         MNOTE 1,'PU OPERAND IGNORED FOR FIELD=&FIELD'         @D51MDGL 28600000
         AGO   .ENDPU                                          @D51MDGL 28650000
.OMITPU  SLR   &REG(4),&REG(4)            DEFAULT PU INDEX (0) @D51MDGL 28700000
.ENDPU   ANOP                                                  @D51MDGL 28750000
.* TASK ============                                           @D51MDGL 28800000
.DOTASK  AIF   ('&PATT'(3,1) EQ 'I').IGNTSK                    @D51MDGL 28850000
         AIF   ('&REG(3)' EQ 'X').ENDTASK TASK NOT ALLOWED     @D51MDGL 28900000
         AIF   ('&PARCOM'(3,1) EQ 'O').OMITT                   @D51MDGL 28950000
         AIF   ('&TASK'(1,1) EQ '(').REGT                      @D51MDGL 29000000
         LH    &REG(3),&TASK                LOAD TASK ID       @D51MDGL 29050000
         AGO   .ENDTASK                                        @D51MDGL 29100000
.REGT    AIF   ('&REG(3)' EQ '&TASK(1)').ENDTASK               @D51MDGL 29150000
         LR    &REG(3),&TASK(1)             LOAD TASK ID       @D51MDGL 29200000
         AGO   .ENDTASK                                        @D51MDGL 29250000
.IGNTSK  AIF   ('&PARCOM'(3,1) EQ 'O').ENDTASK                 @D51MDGL 29300000
         MNOTE 1,'TASK OPERAND IGNORED FOR FIELD=&FIELD'       @D51MDGL 29350000
         AGO   .ENDTASK                                        @D51MDGL 29400000
.OMITT   SLR   &REG(3),&REG(3)            DEFAULT TASK ID (0)  @D51MDGL 29450000
.ENDTASK ANOP                                                  @D51MDGL 29500000
.* PART ============                                           @D51MDGL 29550000
.DOPART  AIF   ('&PATT'(2,1) EQ 'I').IGNPRT                    @D51MDGL 29600000
         AIF   ('&REG(2)' EQ 'X').ENDPART PART NOT ALLOWED     @D51MDGL 29650000
         AIF   ('&PARCOM'(2,1) EQ 'O').OMITP                   @D51MDGL 29700000
         AIF   ('&PART'(1,1) EQ '(').REGPRT                    @D51MDGL 29750000
         LH    &REG(2),&PART                LOAD PART ID       @D51MDGL 29800000
         AGO   .ENDPART                                        @D51MDGL 29850000
.REGPRT  AIF   ('&REG(2)' EQ '&PART(1)').ENDPART ALREADY LOADED@....... 29900000
         LR    &REG(2),&PART(1)             LOAD PART ID       @D51MDGL 29950000
         AGO   .ENDPART                                        @D51MDGL 30000000
.IGNPRT  AIF   ('&PARCOM'(2,1) EQ 'O').ENDPART                 @D51MDGL 30050000
         MNOTE 1,'PART OPERAND IGNORED FOR FIELD=&FIELD'       @D51MDGL 30100000
         AGO   .ENDPART                                        @D51MDGL 30150000
.OMITP   SLR   &REG(2),&REG(2)            DEFAULT PART ID (0)  @D51MDGL 30200000
.ENDPART ANOP                                                  @D51MDGL 30250000
.* NEWVAL===========                                           @D51MDGL 30300000
.DONEWVA AIF   ('&PATT'(1,1) EQ 'I').IGNNEW                    @D51MDGL 30350000
         AIF   ('&REG(1)' EQ 'X').ENDNEWV NEWVAL NOT ALLOWED   @D51MDGL 30400000
         AIF   ('&PARCOM'(1,1) EQ 'O').OMITNEW                 @D51MDGL 30450000
         AIF   ('&NEWVAL'(1,1) EQ '(').REGLO                   @D51MDGL 30500000
         L     &REG(1),&NEWVAL              LOAD NEW VALUE     @D51MDGL 30550000
         AGO   .ENDNEWV                                        @D51MDGL 30600000
.REGLO   AIF   ('&REG(1)' EQ '&NEWVAL(1)').ENDNEWV             @D51MDGL 30650000
         LR    &REG(1),&NEWVAL(1)           LOAD NEW VALUE     @D51MDGL 30700000
         AGO   .ENDNEWV                                        @D51MDGL 30750000
.IGNNEW  AIF   ('&PARCOM'(1,1) EQ 'O').ENDNEWV                 @D51MDGL 30800000
         MNOTE 1,'NEWVAL OPERAND IGNORED FOR FIELD=&FIELD'     @D51MDGL 30850000
         AGO   .ENDNEWV                                        @D51MDGL 30900000
.OMITNEW SLR   &REG(1),&REG(1)            DEFAULT NEWVAL       @D51MDGL 30950000
.ENDNEWV ANOP                                                  @D51MDGL 31000000
.********************************************************************** 31050000
.*                                                                      31100000
.*  GENERATE FUNCTION CODE AND SVC                                      31150000
.*                                                                      31200000
.********************************************************************** 31250000
.COMPLT  ANOP                                                  @D61NDGL 31263600
         AIF   ('&RETURN' NE 'YES').NORET                      @D61NDGL 31277200
         ICM   15,15,*+8                  GET FUNCTION CODE    @D61NDGL 31290816
         B     *+8                        SKIP CONSTANT        @D61NDGL 31304416
         DC    X'80',AL3(&FUNCT)          INDICATE RETURN=YES  @D61NDGL 31318016
         SVC   107                        HANDLE REQUEST       @D61NDGL 31331600
         MEXIT                                                 @D61NDGL 31345200
.NORET   ANOP                                                  @D61NDGL 31358800
         LA    15,&FUNCT.(,0)             LOAD FUNCTION CODE   @D61NDGL 31372400
         SVC   107                        HANDLE REQUEST                31386000
         MEND                                                        */ 31400000
