*********************************************************************
* Copyright 2006 Automated Software Tools Corporation               *
* This source code is part of z390 assembler/emulator package       *
* The z390 package is distributed under GNU general public license  *
* Author - Don Higgins                                              *
* Date   - 12/09/06                                                 *
*********************************************************************
* TEST DFP DECIMAL FLOATING POINT
*********************************************************************
* Maintenance:
* 12/09/06 RPI 407 ADD ADTR, SDTR, MDTR, DDTR, CDTR, CSDTR
* 12/15/06 RPI 406 ADD REMAINING DFP INSTRUCTIONS            
*********************************************************************
         PRINT DATA
TESTDFP1 RT1   MAIN
DD1      DC    DD'0'
ED1      DC    ED'0'
LD1      DC    LD'0'
PL16     DC    PL16'0'
         RT1   START
* B3D0 MDTR
         LD    2,=DD'30'
         LD    3,=DD'20'
         MDTR  1,2,3
         STD   1,DD1
         RT1   CCE,DD1,=DD'600'
         LD    2,=DD'-30'
         LD    3,=DD'-20'
         MDTR  1,2,3
         STD   1,DD1
         RT1   CCE,DD1,=DD'600'
* B3D1 DDTR
         LD    2,=DD'600'
         LD    3,=DD'20'
         DDTR  1,2,3
         STD   1,DD1
         RT1   CCE,DD1,=DD'30'
         LD    2,=DD'10'
         LD    3,=DD'3'
         DDTR  1,2,3
         STD   1,DD1
         RT1   CCE,DD1,=DD'3.333333333333333'
* B3D2 ADTR
         LD    2,=DD'1234567890123456'
         LD    3,=DD'1111111111111111'
         ADTR  1,2,3
         RT1   CC2
         STD   1,DD1
         RT1   CCE,DD1,=DD'2345679001234567'
         LD    2,=DD'1'
         LD    3,=DD'2'
         ADTR  1,2,3
         RT1   CC2
         STD   1,DD1
         RT1   CCE,DD1,=DD'3'
         LD    2,=DD'1.1'
         LD    3,=DD'2.2'
         ADTR  1,2,3
         RT1   CC2
         STD   1,DD1
         RT1   CCE,DD1,=DD'3.3'
         LD    2,=DD'1'
         LD    3,=DD'-1'
         ADTR  1,2,3
         RT1   CC0
         STD   1,DD1
         RT1   CCE,DD1,=DD'0'
         LD    2,=DD'1'
         LD    3,=DD'-2'
         ADTR  1,2,3
         RT1   CC1
         STD   1,DD1
         RT1   CCE,DD1,=DD'-1'
* B3D3 SDTR
         LD    2,=DD'1234567890123456'
         LD    3,=DD'1111111111111111'
         SDTR  1,2,3
         RT1   CC2
         STD   1,DD1
         RT1   CCE,DD1,=DD'123456779012345'
         LD    2,=DD'1'
         LD    3,=DD'1'
         SDTR  1,2,3
         RT1   CC0
         STD   1,DD1
         RT1   CCE,DD1,=DD'0'
         LD    2,=DD'0'
         LD    3,=DD'1'
         SDTR  1,2,3
         RT1   CC1
         STD   1,DD1
         RT1   CCE,DD1,=DD'-1'
* B3D8 MXTR
         LX    4,=LD'30'
         LX    5,=LD'20'
         MXTR  1,4,5
         STX   1,LD1
         RT1   CCE,LD1,=LD'600'
         LX    4,=LD'-30'
         LX    5,=LD'-20'
         MXTR  1,4,5
         STX   1,LD1
         RT1   CCE,LD1,=LD'600'
* B3D9 DXTR
         LX    4,=LD'600'
         LX    5,=LD'20'
         DXTR  1,4,5
         STX   1,LD1
         RT1   CCE,LD1,=LD'30'
         LX    4,=LD'10'
         LX    5,=LD'3'
         DXTR  1,4,5
         STX   1,LD1
         RT1   CCE,LD1,=LD'3.333333333333333333333333333333333'
* B3DA AXTR
         LX    4,=LD'1234567890123456789012345678901234'
         LX    5,=LD'1111111111111111111111111111111111'
         AXTR  1,4,5
         RT1   CC2
         STX   1,LD1
         RT1   CCE,LD1,=LD'2345679001234567900123456790012345'
         LX    4,=LD'1'
         LX    5,=LD'2'
         AXTR  1,4,5
         RT1   CC2
         STX   1,LD1
         RT1   CCE,LD1,=LD'3'
         LX    4,=LD'1.1'
         LX    5,=LD'2.2'
         AXTR  1,4,5
         RT1   CC2
         STX   1,LD1
         RT1   CCE,LD1,=LD'3.3'
         LX    4,=LD'1'
         LX    5,=LD'-1'
         AXTR  1,4,5
         RT1   CC0
         STX   1,LD1
         RT1   CCE,LD1,=LD'0'
         LX    4,=LD'1'
         LX    5,=LD'-2'
         AXTR  1,4,5
         RT1   CC1
         STX   1,LD1
         RT1   CCE,LD1,=LD'-1'
* B3DB SXTR
         LX    4,=LD'1234567890123456789012345678901234'
         LX    5,=LD'1111111111111111111111111111111111'
         SXTR  1,4,5
         RT1   CC2
         STX   1,LD1
         RT1   CCE,LD1,=LD'123456779012345677901234567790123'
         LX    4,=LD'1'
         LX    5,=LD'1'
         SXTR  1,4,5
         RT1   CC0
         STX   1,LD1
         RT1   CCE,LD1,=LD'0'
         LX    4,=LD'0'
         LX    5,=LD'1'
         SXTR  1,4,5
         RT1   CC1
         STX   1,LD1
         RT1   CCE,LD1,=LD'-1'
* B3E3 CSDTR
         LD    1,=DD'1'
         CSDTR 0,1,0
         CG    0,=PL8'1'
         RT1   CCE 
         CSDTR 0,1,1
         CG    0,=XL8'000000000000001F'
         RT1   CCE 
         LD    1,=DD'-1'
         CSDTR 0,1,0
         CG    0,=PL8'-1'
         RT1   CCE 
         CSDTR 0,1,1
         CG    0,=XL8'000000000000001D'
         RT1   CCE 
         LD    1,=DD'123456789012345'
         CSDTR 0,1,0
         CG    0,=PL8'123456789012345'
         RT1   CCE 
* B3E4 CDTR
         LD    1,=DD'1'
         LD    2,=DD'2'
         CDTR  1,2
         RT1   CC1
         LD    1,=DD'1'
         LD    2,=DD'1'
         CDTR  1,2
         RT1   CC0
         LD    1,=DD'2'
         LD    2,=DD'1'
         CDTR  1,2
         RT1   CC2
* B3E5 EEDTR
         LD    2,=DD'1'
         EEDTR 1,2
         CG    1,=FD'398'
         RT1   CC0
         LD    2,=DD'10'
         EEDTR 1,2
         CG    1,=FD'399'
         RT1   CC0
         LD    2,=DD'.1'
         EEDTR 1,2
         CG    1,=FD'397'
         RT1   CC0
* B3EB CSXTR
         LX    1,=LD'1'
         CSXTR 0,1,0
         CG    0,=FL8'0'
         RT1   CCE
         CG    1,=PL8'1'
         RT1   CCE 
         CSXTR 0,1,1
         CG    0,=FL8'0'
         RT1   CCE
         CG    1,=XL8'000000000000001F'
         RT1   CCE 
         LX    1,=LD'-1'
         CSXTR 0,1,0
         CG    0,=FL8'0'
         RT1   CCE
         CG    1,=PL8'-1'
         RT1   CCE 
         CSXTR 0,1,1
         CG    0,=FL8'0'
         RT1   CCE
         CG    1,=XL8'000000000000001D'
         RT1   CCE 
         LX    1,=LD'1234567890123456789012345678901'
         CSXTR 0,1,0
         STMG  0,1,PL16
         CP    PL16,=PL16'1234567890123456789012345678901'
         RT1   CCE 
* B3ED EEXTR
         LX    4,=LD'1'
         EEXTR 1,4
         CG    1,=FD'6176'
         RT1   CC0
         LX    4,=LD'10'
         EEXTR 1,4
         CG    1,=FD'6177'
         RT1   CC0
         LX    4,=LD'.1'
         EEXTR 1,4
         CG    1,=FD'6175'
         RT1   CC0
         RT1   END
         END         
