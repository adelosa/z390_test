*********************************************************************
* Copyright 2005 Automated Software Tools Corporation               *
* This source code is part of z390 assembler/emulator package       *
* The z390 package is distributed under GNU general public license  *
* Author - Don Higgins                                              *
* Date   - 09/30/05                                                 *
*********************************************************************
         TITLE 'TESTFP1 - UNIT TEST HFP AND BFP FLOATING PT INSTR'
* THIS PROGRAM INCLUDES UNIT TESTS OF EACH HFP AND BFP INSTR
* ADDED TO EZ390.JAVA J2SE 390 EMULATOR.
* RT1 MACRO USED TO AUTOMATE CODE GENERATED FOR MAINLINE
* AND TEST PSW CC ROUTINES. THE MACROS DEFINE NEW BASE REG
* FOR EACH TEST SO THEY CAN EXTEND FOR ANY LENGTH.
*
* SEE TESTINS2 FOR OTHER INSTR UNIT TESTS
*********************************************************************
* 11/20/05 RPI106 CORRECT MASK ALIGNMENT FOR SPM
* 02/08/06 RPI185 ADD MAYR, MYR, MAY, MY 
*********************************************************************
         MACRO
&N       LX    &R1,&S2   LOAD  LH/LB
         LA    15,&S2
         LD    &R1,0(15)
         LD    &R1+1,8(15)
         MEND
         MACRO
&N       STX   &R1,&S2   STORE LH/LB
         LA    15,&S2
         STD   &R1,0(15)
         STD   &R1+1,8(15)
         MEND
TESTFP1  RT1   MAIN
         EQUREGS
FPCREG   DS    F 
FPCDXC   EQU   FPCREG+2 REASON CODES FOR 0C7 DATA EXCEPTIONS
PWORK    DS    D
PWORK16  DS    XL16
WORD     DS    F
DWORD    DS    D
BYTE     DS    X
LWORK    DS    XL16
EBMIN    DC    EB'1.2E-38'    SEE POP BFP 19-5 (MATCH EZ390 VALUES)
EBMAX    DC    EB'3.4E+38'                                      
DBMIN    DC    DB'2.2E-308'
DBMAX    DC    DB'1.79E+308'  (1.8 too big for double?)
LBMIN    DC    LB'3.4E-4932'
LBMAX    DC    LB'1.2E+4932'
EHMIN    DC    EH'5.4E-79'    SEE POP HFP 18-4
EHMAX    DC    EH'7.2E+75'
DHMIN    DC    DH'5.4E-79'
DHMAX    DC    DH'7.2E+75'
LHMIN    DC    LH'5.4E-79'
LHMAX    DC    LH'7.2E+75'
         RT1   START
         RT1   CCE,=DB'0',=X'0000000000000000'  
         RT1   CCE,=DB'1',=X'3FF0000000000000'
         RT1   CCE,=DB'10',=X'4024000000000000'
         RT1   CCE,=DB'-1',=X'BFF0000000000000'
         RT1   CCE,=DB'-10',=X'C024000000000000'
         RT1   CCE,=DB'3E-1',=X'3FD3333333333333'
         RT1   CCE,=DH'0',=X'4000000000000000'          
         RT1   CCE,=DH'1',=X'4110000000000000'
         RT1   CCE,=DH'10',=X'41A0000000000000'
         RT1   CCE,=DH'-1',=X'C110000000000000'
         RT1   CCE,=DH'-10',=X'C1A0000000000000'
         RT1   CCE,=DH'3E-1',=X'404CCCCCCCCCCCCD'
         RT1   CCE,=EB'0',=X'00000000'          
         RT1   CCE,=EB'1',=X'3F800000'
         RT1   CCE,=EB'10',=X'41200000'
         RT1   CCE,=EB'-1',=X'BF800000'
         RT1   CCE,=EB'-10',=X'C1200000'
         RT1   CCE,=EH'0',=X'40000000'          
         RT1   CCE,=EH'1',=X'41100000'
         RT1   CCE,=EH'10',=X'41A00000'
         RT1   CCE,=EH'-1',=X'C1100000'
         RT1   CCE,=EH'-10',=X'C1A00000'
         RT1   CCE,=LB'0',=X'00000000000000000000000000000000'  
         RT1   CCE,=LB'1',=X'3FFF0000000000000000000000000000'
         RT1   CCE,=LB'10',=X'40024000000000000000000000000000'
         RT1   CCE,=LB'-1',=X'BFFF0000000000000000000000000000'
         RT1   CCE,=LB'-10',=X'C0024000000000000000000000000000'
         RT1   CCE,=LH'0',=X'40000000000000004000000000000000'  
         RT1   CCE,=LH'1',=X'41100000000000004000000000000000'
         RT1   CCE,=LH'10',=X'41A00000000000004000000000000000'
         RT1   CCE,=LH'-1',=X'C1100000000000004000000000000000'
         RT1   CCE,=LH'-10',=X'C1A00000000000004000000000000000'
         RT1   CCE,=LH'3E-1',=X'404CCCCCCCCCCCCC32CCCCCCCCCCCCCD'
* 20   LPDR
         LD    R1,=DH'-1'
         LD    R2,=DH'1'
         LPDR  R0,R1
         RT1   CCH
         CDR   R0,R2
         RT1   CCE
         LD    R1,=DH'0'
         LD    R2,=DH'0'
         LPDR  R0,R1
         RT1   CCE
         CDR   R0,R2
         RT1   CCE
* 21   LNDR
         LD    R1,=DH'1'
         LD    R2,=DH'-1'
         LNDR  R0,R1
         RT1   CCL
         CDR   R0,R2
         RT1   CCE
         LD    R1,=DH'0'
         LD    R2,=DH'0'
         LNDR  R0,R1
         RT1   CCE
         CDR   R0,R2
         RT1   CCE
* 22   LTDR
         LD    R1,=DH'1'
         LD    R2,=DH'1'
         LTDR  R0,R1
         RT1   CCH
         CDR   R0,R2
         RT1   CCE
         LD    R1,=DH'0'
         LD    R2,=DH'0'
         LTDR  R0,R1
         RT1   CCE
         CDR   R0,R2
         RT1   CCE
         LD    R1,=DH'-1'
         LD    R2,=DH'-1'
         LTDR  R0,R1
         RT1   CCL
         CDR   R0,R2
         RT1   CCE
* 23   LCDR
         LD    R1,=DH'-1'
         LD    R2,=DH'1'
         LCDR  R0,R1
         RT1   CCH
         CDR   R0,R2
         RT1   CCE
         LD    R1,=DH'0'
         LD    R2,=DH'0'
         LCDR  R0,R1
         RT1   CCE
         CDR   R0,R2
         RT1   CCE
         LD    R1,=DH'1'
         LD    R2,=DH'-1'
         LCDR  R0,R1
         RT1   CCL
         CDR   R0,R2
         RT1   CCE
* 24   HDR
         LD    R1,=DH'2'
         LD    R2,=DH'1'
         HDR   R0,R1
         CDR   R0,R2
         RT1   CCE
         LD    R1,=DH'0'
         LD    R2,=DH'0'
         HDR   R0,R1
         CDR   R0,R2
         RT1   CCE
         LD    R1,=DH'-2'
         LD    R2,=DH'-1'
         HDR   R0,R1
         CDR   R0,R2
         RT1   CCE
* 25   LDXR
         LX    R2,=LH'123'
         LDXR  R0,R2
         CD    R0,=DH'123'
         RT1   CCE
* 26   MXR
         LX    R0,=LH'20'
         LX    R2,=LH'30'
         LX    R4,=LH'600'
         MXR   R0,R2
         CXR   R0,R4
         RT1   CCE
         LX    R0,=LH'10'
         LX    R2,=LH'-20'
         LX    R4,=LH'-200'
         MXR   R0,R2
         CXR   R0,R4
         RT1   CCE
         LX    R0,=LH'-0.5'
         LX    R2,=LH'-0.5'
         LX    R4,=LH'.25'
         MXR   R0,R2
         CXR   R0,R4
         RT1   CCE
* 27   MXDR
         LD    R0,=DH'20'
         LD    R2,=DH'30'
         LX    R4,=LH'600'
         MXDR  R0,R2
         CXR   R0,R4
         RT1   CCE
         LD    R0,=DH'10'
         LD    R2,=DH'-20'
         LX    R4,=LH'-200'
         MXDR  R0,R2
         CXR   R0,R4
         RT1   CCE
         LD    R0,=DH'-0.5'
         LD    R2,=DH'-0.5'
         LX    R4,=LH'.25'
         MXDR  R0,R2
         CXR   R0,R4
         RT1   CCE
* 28   LDR
         LD    R1,=DH'123'
         LDR   R0,R1
         CD    R0,=DH'123'
         RT1   CCE
* 29   CDR
         LD    R0,=DH'1'
         LD    R1,=DH'-2'
         CDR   R0,R1
         RT1   CCH
         LD    R0,=DH'2'
         LD    R1,=DH'2'
         CDR   R0,R1
         RT1   CCE
         LD    R0,=DH'-2'
         LD    R1,=DH'4'
         CDR   R0,R1
         RT1   CCL
* 2A   ADR
         LD    R0,=DH'3'
         LD    R1,=DH'2'
         ADR   R0,R1
         RT1   CCH
         CD    R0,=DH'5'
         RT1   CCE
         LD    R0,=DH'1'
         LD    R1,=DH'-2'
         ADR   R0,R1
         RT1   CCL
         CD    R0,=DH'-1'
         RT1   CCE
         LD    R0,=DH'1'
         LD    R1,=DH'-1'
         ADR   R0,R1
         RT1   CCE
         CD    R0,=DH'0'
         RT1   CCE
* 2B   SDR
         LD    R0,=DH'3'
         LD    R1,=DH'2'
         SDR   R0,R1
         RT1   CCH
         CD    R0,=DH'1'
         RT1   CCE
         LD    R0,=DH'1'
         LD    R1,=DH'2'
         SDR   R0,R1
         RT1   CCL
         CD    R0,=DH'-1'
         RT1   CCE
         LD    R0,=DH'1'
         LD    R1,=DH'1'
         SDR   R0,R1
         RT1   CCE
         CD    R0,=DH'0'
         RT1   CCE
* 2C   MDR
         LD    R0,=DH'2'
         LD    R1,=DH'3'
         MDR   R0,R1
         CD    R0,=DH'6'
         RT1   CCE
         ESPIE SET,MDR1,12 HFP OVERFLOW
         LD    R0,DHMAX
         LD    R1,=DH'1'
         MDR   R0,R1
         RT1   ABORT
MDR1     ESPIE RESET
* 2D   DDR
         LD    R0,=DH'3'
         LD    R1,=DH'2'
         DDR   R0,R1
         CD    R0,=DH'1.5'
         RT1   CCE
         ESPIE SET,DDR1,15 TRAP HFP DIVIDE
         LD    R0,=DH'1'
         LD    R1,=DH'0'
         DDR   R0,R1
         RT1   ABORT
DDR1     ESPIE RESET
* 2E   AWR
         LD    R0,=DH'3'
         LD    R1,=DH'2'
         AWR   R0,R1
         RT1   CCH
         CD    R0,=DH'5'
         RT1   CCE
         LD    R0,=DH'1'
         LD    R1,=DH'-2'
         AWR   R0,R1
         RT1   CCL
         CD    R0,=DH'-1'
         RT1   CCE
         LD    R0,=DH'1'
         LD    R1,=DH'-1'
         AWR   R0,R1
         RT1   CCE
         CD    R0,=DH'0'
         RT1   CCE
* 2F   SWR
         LD    R0,=DH'3'
         LD    R1,=DH'2'
         SWR   R0,R1
         RT1   CCH
         CD    R0,=DH'1'
         RT1   CCE
         LD    R0,=DH'1'
         LD    R1,=DH'2'
         SWR   R0,R1
         RT1   CCL
         CD    R0,=DH'-1'
         RT1   CCE
         LD    R0,=DH'1'
         LD    R1,=DH'1'
         SWR   R0,R1
         RT1   CCE
         CD    R0,=DH'0'
         RT1   CCE
* 30   LPER
         LE    R1,=EH'-1'
         LE    R2,=EH'1'
         LPER  R0,R1
         RT1   CCH
         CER   R0,R2
         RT1   CCE
         LE    R1,=EH'0'
         LE    R2,=EH'0'
         LPER  R0,R1
         RT1   CCE
         CER   R0,R2
         RT1   CCE
* 31   LNER
         LE    R1,=EH'1'
         LE    R2,=EH'-1'
         LNER  R0,R1
         RT1   CCL
         CER   R0,R2
         RT1   CCE
         LE    R1,=EH'0'
         LE    R2,=EH'0'
         LNER  R0,R1
         RT1   CCE
         CER   R0,R2
         RT1   CCE
* 32   LTER
         LE    R1,=EH'1'
         LE    R2,=EH'1'
         LTER  R0,R1
         RT1   CCH
         CER   R0,R2
         RT1   CCE
         LE    R1,=EH'0'
         LE    R2,=EH'0'
         LTER  R0,R1
         RT1   CCE
         CER   R0,R2
         RT1   CCE
         LE    R1,=EH'-1'
         LE    R2,=EH'-1'
         LTER  R0,R1
         RT1   CCL
         CER   R0,R2
         RT1   CCE
* 33   LCER
         LE    R1,=EH'-1'
         LE    R2,=EH'1'
         LCER  R0,R1
         RT1   CCH
         CER   R0,R2
         RT1   CCE
         LE    R1,=EH'0'
         LE    R2,=EH'0'
         LCER  R0,R1
         RT1   CCE
         CER   R0,R2
         RT1   CCE
         LE    R1,=EH'1'
         LE    R2,=EH'-1'
         LCER  R0,R1
         RT1   CCL
         CER   R0,R2
         RT1   CCE
* 34   HER
         LE    R1,=EH'2'
         LE    R2,=EH'1'
         HER   R0,R1
         CER   R0,R2
         RT1   CCE
         LE    R1,=EH'0'
         LE    R2,=EH'0'
         HER   R0,R1
         CER   R0,R2
         RT1   CCE
         LE    R1,=EH'-2'
         LE    R2,=EH'-1'
         HER   R0,R1
         CER   R0,R2
         RT1   CCE
* 35   LEDR
         LD    R1,=DH'123'
         LEDR  R0,R1
         CE    R0,=EH'123'
         RT1   CCE
* 36   AXR
         LX    R0,=LH'1'
         LX    R2,=LH'2'
         LX    R4,=LH'3'
         AXR   R0,R2
         RT1   CCH
         CXR   R0,R4
         RT1   CCE
         LX    R0,=LH'1'
         LX    R2,=LH'-2'
         LX    R4,=LH'-1'
         AXR   R0,R2
         RT1   CCL
         CXR   R0,R4
         RT1   CCE
         LX    R0,=LH'-1'
         LX    R2,=LH'1'
         LX    R4,=LH'0'
         AXR   R0,R2
         RT1   CCE
         CXR   R0,R4
         RT1   CCE
* 37   SXR
         LX    R0,=LH'1'
         LX    R2,=LH'-2'
         LX    R4,=LH'3'
         SXR   R0,R2
         RT1   CCH
         CXR   R0,R4
         RT1   CCE
         LX    R0,=LH'1'
         LX    R2,=LH'2'
         LX    R4,=LH'-1'
         SXR   R0,R2
         RT1   CCL
         CXR   R0,R4
         RT1   CCE
         LX    R0,=LH'1'
         LX    R2,=LH'1'
         LX    R4,=LH'0'
         SXR   R0,R2
         RT1   CCE
         CXR   R0,R4
         RT1   CCE
* 38   LER
         LE    R1,=EH'123'
         LER   R0,R1
         CE    R0,=EH'123'
         RT1   CCE
* 39   CER
         LE    R0,=EH'1'
         LE    R1,=EH'-2'
         CER   R0,R1
         RT1   CCH
         LE    R0,=EH'2'
         LE    R1,=EH'2'
         CER   R0,R1
         RT1   CCE
         LE    R0,=EH'-2'
         LE    R1,=EH'4'
         CER   R0,R1
         RT1   CCL
* 3A   AER
         LE    R0,=EH'3'
         LE    R1,=EH'2'
         AER   R0,R1
         RT1   CCH
         CE    R0,=EH'5'
         RT1   CCE
         LE    R0,=EH'1'
         LE    R1,=EH'-2'
         AER   R0,R1
         RT1   CCL
         CE    R0,=EH'-1'
         RT1   CCE
         LE    R0,=EH'1'
         LE    R1,=EH'-1'
         AER   R0,R1
         RT1   CCE
         CE    R0,=EH'0'
         RT1   CCE
* 3B   SER
         LE    R0,=EH'3'
         LE    R1,=EH'2'
         SER   R0,R1
         RT1   CCH
         CE    R0,=EH'1'
         RT1   CCE
         LE    R0,=EH'1'
         LE    R1,=EH'2'
         SER   R0,R1
         RT1   CCL
         CE    R0,=EH'-1'
         RT1   CCE
         LE    R0,=EH'1'
         LE    R1,=EH'1'
         SER   R0,R1
         RT1   CCE
         CE    R0,=EH'0'
         RT1   CCE
* 3C   MDER
         LE    R0,=EH'2'
         LE    R1,=EH'3'
         MDER  R0,R1
         CD    R0,=DH'6'
         RT1   CCE
* 3D   DER
         LE    R0,=EH'3'
         LE    R1,=EH'2'
         DER   R0,R1
         CE    R0,=EH'1.5'
         RT1   CCE
         ESPIE SET,DER1,15 TRAP HFP DIVIDE
         LE    R0,=EH'1'
         LE    R1,=EH'0'
         DER   R0,R1
         RT1   ABORT
DER1     ESPIE RESET
* 3E   AUR
         LE    R0,=EH'3'
         LE    R1,=EH'2'
         AUR   R0,R1
         RT1   CCH
         CE    R0,=EH'5'
         RT1   CCE
         LE    R0,=EH'1'
         LE    R1,=EH'-2'
         AUR   R0,R1
         RT1   CCL
         CE    R0,=EH'-1'
         RT1   CCE
         LE    R0,=EH'1'
         LE    R1,=EH'-1'
         AUR   R0,R1
         RT1   CCE
         CE    R0,=EH'0'
         RT1   CCE
* 3F   SUR
         LE    R0,=EH'3'
         LE    R1,=EH'2'
         SUR   R0,R1
         RT1   CCH
         CE    R0,=EH'1'
         RT1   CCE
         LE    R0,=EH'1'
         LE    R1,=EH'2'
         SUR   R0,R1
         RT1   CCL
         CE    R0,=EH'-1'
         RT1   CCE
         LE    R0,=EH'1'
         LE    R1,=EH'1'
         SUR   R0,R1
         RT1   CCE
         CE    R0,=EH'0'
         RT1   CCE
* 60   STD
         LD    R0,=DH'1'
         STD   R0,DWORD
         CLC   DWORD,=X'4110000000000000'
         RT1   CCE
* 67   MXD
         LD    R0,=DH'2'
         MXD   R0,=DH'3'
         LX    R2,=LH'6'
         CXR   R0,R2
         RT1   CCE
* 68   LD
         LD    R0,=DH'1'
         AD    R0,=DH'1'
         RT1   CCH
         STD   R0,DWORD
         CLC   DWORD,=X'4120000000000000'
         RT1   CCE
* 69   CD
         LD    R0,=DH'1'
         CD    R0,=X'4110000000000000'
         RT1   CCE
         LD    R0,=DH'-1'
         CD    R0,=DH'0'
         RT1   CCL
         LD    R0,=DH'1'
         CD    R0,=DH'0'
         RT1   CCH
* 6A   AD
         LD    R0,=DH'3'
         AD    R0,=DH'2'
         RT1   CCH
         CD    R0,=DH'5'
         RT1   CCE
         LD    R0,=DH'1'
         AD    R0,=DH'-2'
         RT1   CCL
         CD    R0,=DH'-1'
         RT1   CCE
         LD    R0,=DH'1'
         AD    R0,=DH'-1'
         RT1   CCE
         CD    R0,=DH'0'
         RT1   CCE
* 6B   SD
         LD    R0,=DH'3'
         SD    R0,=DH'2'
         RT1   CCH
         CD    R0,=DH'1'
         RT1   CCE
         LD    R0,=DH'1'
         SD    R0,=DH'2'
         RT1   CCL
         CD    R0,=DH'-1'
         RT1   CCE
         LD    R0,=DH'1'
         SD    R0,=DH'1'
         RT1   CCE
         CD    R0,=DH'0'
         RT1   CCE
* 6C   MD 
         LD    R0,=DH'2'
         MD    R0,=DH'3'
         CD    R0,=DH'6'
         RT1   CCE
* 6D   DD
         LD    R0,=DH'3'
         DD    R0,=DH'2'
         CD    R0,=DH'1.5'
         RT1   CCE
         ESPIE SET,DD1,15 TRAP HFP DIVIDE
         LD    R0,=DH'1'
         DD    R0,=DH'0'
         RT1   ABORT
DD1      ESPIE RESET
* 6E   AW
         LD    R0,=DH'3'
         AW    R0,=DH'2'
         RT1   CCH
         CD    R0,=DH'5'
         RT1   CCE
         LD    R0,=DH'1'
         AW    R0,=DH'-2'
         RT1   CCL
         CD    R0,=DH'-1'
         RT1   CCE
         LD    R0,=DH'1'
         AW    R0,=DH'-1'
         RT1   CCE
         CD    R0,=DH'0'
         RT1   CCE
* 6F   SW
         LD    R0,=DH'3'
         SW    R0,=DH'2'
         RT1   CCH
         CD    R0,=DH'1'
         RT1   CCE
         LD    R0,=DH'1'
         SW    R0,=DH'2'
         RT1   CCL
         CD    R0,=DH'-1'
         RT1   CCE
         LD    R0,=DH'1'
         SW    R0,=DH'1'
         RT1   CCE
         CD    R0,=DH'0'
         RT1   CCE
* 70   STE
         LE    R0,=EH'1'
         STE   R0,WORD
         CLC   WORD,=X'41100000'
         RT1   CCE
* 78   LE
         LE    R0,=EH'1'
         AE    R0,=EH'1'
         RT1   CCH
         STE   R0,WORD
         CLC   WORD,=X'41200000'
         RT1   CCE
* 79   CE
         LE    R0,=EH'1'
         CE    R0,=X'41100000'
         RT1   CCE
         LE    R0,=EH'-1'
         CE    R0,=EH'0'
         RT1   CCL
         LE    R0,=EH'1'
         CE    R0,=EH'0'
         RT1   CCH
* 7A   AE
         LE    R0,=EH'3'
         AE    R0,=EH'2'
         RT1   CCH
         CE    R0,=EH'5'
         RT1   CCE
         LE    R0,=EH'1'
         AE    R0,=EH'-2'
         RT1   CCL
         CE    R0,=EH'-1'
         RT1   CCE
         LE    R0,=EH'1'
         AE    R0,=EH'-1'
         RT1   CCE
         CE    R0,=EH'0'
         RT1   CCE
         ESPIE SET,AE1,12 HFP OVERFLOW
         LE    R0,EHMAX
         AE    R0,EHMAX
         RT1   ABORT
AE1      ESPIE RESET
         WTO   'ESPIE HFP OVERFLOW OK'
* 7B   SE
         LE    R0,=EH'3'
         SE    R0,=EH'2'
         RT1   CCH
         CE    R0,=EH'1'
         RT1   CCE
         LE    R0,=EH'1'
         SE    R0,=EH'2'
         RT1   CCL
         CE    R0,=EH'-1'
         RT1   CCE
         LE    R0,=EH'1'
         SE    R0,=EH'1'
         RT1   CCE
         CE    R0,=EH'0'
         RT1   CCE
         ESPIE SET,SE1,13 HFP UNDERFLOW
         LE    R0,EHMIN
         AE    R0,EHMIN
         SE    R0,EHMIN
         RT1   ABORT
SE1      ESPIE RESET
         WTO   'ESPIE HFP UNDERFLOW OK'
         ESPIE SET,SE2,14 HFP MANTISSA SIGNIFANCE
         LE    R0,EHMIN
         SE    R0,EHMIN
         RT1   ABORT
SE2      ESPIE RESET
         WTO   'ESPIE HFP SIGNIFICANCE OK'
         IPM   0
         NILH  0,X'0E00'
         SPM   0  TURN OFF HFP SIG. MASK BIT AGAIN
* 7C   MDE
         LE    R0,=EH'2'
         MDE   R0,=EH'3'
         STD   R0,DWORD
         CLC   DWORD,=DH'6'
         RT1   CCE
* 7D   DE
         LE    R0,=EH'3'
         DE    R0,=EH'2'
         STE   R0,WORD
         CLC   WORD,=EH'1.5'
         RT1   CCE
         ESPIE SET,DE1,15 HFP DIVIDE
         LE    R0,=EH'1'
         DE    R0,=EH'0'
         RT1   ABORT
DE1      ESPIE RESET
         WTO   'ESPIE HFP DIVIDE OK'
* 7E   AU
         LE    R0,=EH'3'
         AU    R0,=EH'2'
         RT1   CCH
         CE    R0,=EH'5'
         RT1   CCE
         LE    R0,=EH'1'
         AU    R0,=EH'-2'
         RT1   CCL
         CE    R0,=EH'-1'
         RT1   CCE
         LE    R0,=EH'1'
         AU    R0,=EH'-1'
         RT1   CCE
         CE    R0,=EH'0'
         RT1   CCE
* 7F   SU
         LE    R0,=EH'3'
         SU    R0,=EH'2'
         RT1   CCH
         CE    R0,=EH'1'
         RT1   CCE
         LE    R0,=EH'1'
         SU    R0,=EH'2'
         RT1   CCL
         CE    R0,=EH'-1'
         RT1   CCE
         LE    R0,=EH'1'
         SU    R0,=EH'1'
         RT1   CCE
         CE    R0,=EH'0'
         RT1   CCE
* B22D DXR
         LX    R0,=LH'6'
         LX    R2,=LH'2'
         LX    R4,=LH'3'
         DXR   R0,R2
         CXR   R0,R4
         RT1   CCE
         LX    R0,=LH'1'
         LX    R2,=LH'-2'
         LX    R4,=LH'-0.5'
         DXR   R0,R2
         CXR   R0,R4
         RT1   CCE
         LX    R0,=LH'-1'
         LX    R2,=LH'-0.5'
         LX    R4,=LH'2'
         DXR   R0,R2
         CXR   R0,R4
         RT1   CCE
         ESPIE SET,DXR1,15 HFP DIVIDE
         LX    R0,=LH'1'
         LX    R2,=LH'0'
         DXR   R0,R2
         RT1   ABORT
DXR1     ESPIE RESET
* B244 SQDR
         LD    R1,=DH'4'
         SQDR  R0,R1
         CD    R0,=DH'2'
         RT1   CCE
* B245 SQER
         LE    R1,=EH'4'
         SQER  R0,R1
         CE    R0,=EH'2'
         RT1   CCE
* B300 LPEBR
         LE    R1,=EB'-1'
         LE    R2,=EB'1'
         LPEBR R0,R1
         RT1   CCH
         CEBR  R0,R2
         RT1   CCE
         LE    R1,=EB'0'
         LE    R2,=EB'0'
         LPEBR R0,R1
         RT1   CCE
         CEBR  R0,R2
         RT1   CCE
* B301 LNEBR
         LE    R1,=EB'1'
         LE    R2,=EB'-1'
         LNEBR R0,R1
         RT1   CCL
         CEBR  R0,R2
         RT1   CCE
         LE    R1,=EB'0'
         LE    R2,=EB'0'
         LNEBR R0,R1
         RT1   CCE
         CEBR  R0,R2
         RT1   CCE
* B302 LTEBR
         LE    R1,=EB'1'
         LE    R2,=EB'1'
         LTEBR R0,R1
         RT1   CCH
         CEBR  R0,R2
         RT1   CCE
         LE    R1,=EB'0'
         LE    R2,=EB'0'
         LTEBR R0,R1
         RT1   CCE
         CEBR  R0,R2
         RT1   CCE
         LE    R1,=EB'-1'
         LE    R2,=EB'-1'
         LTEBR R0,R1
         RT1   CCL
         CEBR  R0,R2
         RT1   CCE
* B303 LCEBR
         LE    R1,=EB'-1'
         LE    R2,=EB'1'
         LCEBR R0,R1
         RT1   CCH
         CEBR  R0,R2
         RT1   CCE
         LE    R1,=EB'0'
         LE    R2,=EB'0'
         LCEBR R0,R1
         RT1   CCE
         CEBR  R0,R2
         RT1   CCE
         LE    R1,=EB'1'
         LE    R2,=EB'-1'
         LCEBR R0,R1
         RT1   CCL
         CEBR  R0,R2
         RT1   CCE
* B304 LDEBR
         LE    R1,=EB'1'
         LE    R1,=EB'1'
         LE    R0,=EB'0'
         LE    R0,=EB'0'
         LDEBR R0,R1
         CDB   R0,=DB'1'
         RT1   CCE
* B305 LXDBR
         LX    R0,=LB'0'
         LD    R2,=DB'1'
         LXDBR R0,R2
         LX    R4,=LB'1'
         CXBR  R0,R4
         RT1   CCE
* B306 LXEBR
         LX    R0,=LB'0'
         LE    R2,=EB'1'
         LXEBR R0,R2
         LX    R4,=LB'1'
         CXBR  R0,R4
         RT1   CCE
* B307 MXDBR
         LD    R0,=DB'20'
         LD    R2,=DB'30'
         LX    R4,=LB'600'
         MXDBR R0,R2
         CXBR  R0,R4
         RT1   CCE
         LD    R0,=DB'10'
         LD    R2,=DB'-20'
         LX    R4,=LB'-200'
         MXDBR R0,R2
         CXBR  R0,R4
         RT1   CCE
         LD    R0,=DB'-0.5'
         LD    R2,=DB'-0.5'
         LX    R4,=LB'.25'
         MXDBR R0,R2
         CXBR  R0,R4
         RT1   CCE
* B308 KEBR
         LE    R0,=EB'-1'
         LE    R1,=EB'1'
         KEBR  R0,R1
         RT1   CCL
         LE    R0,=EB'1'
         LE    R1,=EB'1'
         KEBR  R0,R1
         RT1   CCE
         LE    R0,=EB'1'
         LE    R1,=EB'-1'
         KEBR  R0,R1
         RT1   CCH
         ESPIE SET,KEBR1,7  BFP OVERFLOW FPCDXC=20               
         LE    R0,=EB'1'
         LE    R1,EBMAX
         KEBR  R0,R1 
         RT1   ABORT
KEBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'20'
         RT1   CCE
         ESPIE SET,KEBR2,7  BFP UNDERFLOW FPCDXC=10               
         LE    R0,EBMIN
         LE    R1,=EB'1'
         KEBR  R0,R1 
         RT1   ABORT
KEBR2    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'10'
         RT1   CCE
* B309 CEBR
         LE    R0,=EB'-1'
         LE    R1,=EB'1'
         CEBR  R0,R1
         RT1   CCL
         LE    R0,=EB'1'
         LE    R1,=EB'1'
         CEBR  R0,R1
         RT1   CCE
         LE    R0,=EB'1'
         LE    R1,=EB'-1'
         CEBR  R0,R1
         RT1   CCH
* B30A AEBR
         LE    R0,=EB'3'
         LE    R2,=EB'2'
         AEBR  R0,R2
         RT1   CCH
         CEB   R0,=EB'5'
         RT1   CCE
         LE    R0,=EB'1'
         LE    R2,=EB'-2'
         AEBR  R0,R2
         RT1   CCL
         CEB   R0,=EB'-1'
         RT1   CCE
         LE    R0,=EB'1'
         LE    R2,=EB'-1'
         AEBR  R0,R2
         RT1   CCE
         CEB   R0,=EB'0'
         RT1   CCE
         ESPIE SET,AEBR1,7  BFP OVERFLOW FPCDXC=20               
         LE    R0,EBMAX
         LE    R1,EBMAX
         AEBR  R0,R1 
         RT1   ABORT
AEBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'20'
         RT1   CCE
         WTO   'ESPIE BFP EB OVERFLOW OK'
* B30B SEBR
         LE    R0,=EB'3'
         LE    R2,=EB'2'
         SEBR  R0,R2
         RT1   CCH
         CEB   R0,=EB'1'
         RT1   CCE
         LE    R0,=EB'1'
         LE    R2,=EB'2'
         SEBR  R0,R2
         RT1   CCL
         CEB   R0,=EB'-1'
         RT1   CCE
         LE    R0,=EB'1'
         LE    R2,=EB'1'
         SEBR  R0,R2
         RT1   CCE
         CEB   R0,=EB'0'
         RT1   CCE
         ESPIE SET,SEBR1,7  BFP UNDERFLOW FPCDXC=10               
         LE    R0,EBMIN
         LE    R1,EBMIN
         AEBR  R0,R1 
         SEBR  R0,R1
         RT1   ABORT
SEBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'10'
         RT1   CCE
         WTO   'ESPIE BFP EB UNDERFLOW OK'
         STFPC FPCREG
         OI    FPCREG,X'08' TURN ON BFP SIGNIFICANCE MASK IN FPC REG
         LFPC  FPCREG
         ESPIE SET,SEBR2,7  BFP SIGNIFICANCE FPCDXC=08               
         LE    R0,EBMIN
         LE    R1,EBMIN
         SEBR  R0,R1
         RT1   ABORT
SEBR2    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'08'
         RT1   CCE
         WTO   'ESPIE BFP EB SIGNIFICANCE OK'
         XI    FPCREG,X'08' TURN IT BACK OFF
         LFPC  FPCREG
* B30C MDEBR
         LE    R0,=EB'2'
         LE    R2,=EB'3'
         MDEBR R0,R2
         CDB   R0,=DB'6'
         RT1   CCE
* B30D DEBR
         LE    R0,=EB'3'
         LE    R2,=EB'2'
         DEBR  R0,R2
         CEB   R0,=EB'1.5'
         RT1   CCE
         ESPIE SET,DEBR1,7  BFP DIVIDE FPCDXC=40               
         LE    R0,=EB'1'
         LE    R2,=EB'0'
         DEBR  R0,R2
         RT1   ABORT
DEBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'40'
         RT1   CCE
         WTO   'ESPIE BFP EB DIVIDE OK'
* B30E MAEBR
         LE    R1,=EB'1'
         LE    R3,=EB'2'
         LE    R2,=EB'3'
         MAEBR R1,R3,R2
         CEB   R1,=EB'7'
         RT1   CCE
* B30F MSEBR
         LE    R0,=EB'1'
         LE    R1,=EB'2'
         LE    R2,=EB'3'
         MSEBR R0,R1,R2
         CEB   R0,=EB'-5'
         RT1   CCE
* B310 LPDBR
         LD    R1,=DB'-1'
         LD    R2,=DB'1'
         LPDBR R0,R1
         RT1   CCH
         CDBR  R0,R2
         RT1   CCE
         LD    R1,=DB'0'
         LD    R2,=DB'0'
         LPDBR R0,R1
         RT1   CCE
         CDBR  R0,R2
         RT1   CCE
* B311 LNDBR
         LD    R1,=DB'1'
         LD    R2,=DB'-1'
         LNDBR R0,R1
         RT1   CCL
         CDBR  R0,R2
         RT1   CCE
         LD    R1,=DB'0'
         LD    R2,=DB'0'
         LNDBR R0,R1
         RT1   CCE
         CDBR  R0,R2
         RT1   CCE
* B312 LTDBR
         LD    R1,=DB'1'
         LD    R2,=DB'1'
         LTDBR R0,R1
         RT1   CCH
         CDBR  R0,R2
         RT1   CCE
         LD    R1,=DB'0'
         LD    R2,=DB'0'
         LTDBR R0,R1
         RT1   CCE
         CDBR  R0,R2
         RT1   CCE
         LD    R1,=DB'-1'
         LD    R2,=DB'-1'
         LTDBR R0,R1
         RT1   CCL
         CDBR  R0,R2
         RT1   CCE
* B313 LCDBR
         LD    R1,=DB'-1'
         LD    R2,=DB'1'
         LCDBR R0,R1
         RT1   CCH
         CDBR  R0,R2
         RT1   CCE
         LD    R1,=DB'0'
         LD    R2,=DB'0'
         LCDBR R0,R1
         RT1   CCE
         CDBR  R0,R2
         RT1   CCE
         LD    R1,=DB'1'
         LD    R2,=DB'-1'
         LCDBR R0,R1
         RT1   CCL
         CDBR  R0,R2
         RT1   CCE
* B214 SQDBR
         LD    R1,=DB'4'
         SQDBR R0,R1
         CDB   R0,=DB'2'
         RT1   CCE
* B215 SQEBR
         LE    R1,=EB'4'
         SQEBR R0,R1
         CEB   R0,=EB'2'
         RT1   CCE
* B316 SQXBR
         LX    R2,=LB'4'
         SQXBR R0,R2
         LX    R4,=LB'2'
         CXBR  R0,R4
         RT1   CCE
         LX    R2,=LB'2'
         SQXBR R0,R2
         MXBR  R0,R0
         SXBR  R0,R2
         LPXBR R0,R0
         LX    R4,=LB'1E-34'
         CXBR  R0,R4
         RT1   CCL
* B317 MEEBR
         LE    R0,=EB'2'
         LE    R1,=EB'3'
         MEEBR R0,R1
         CEB   R0,=EB'6'
         RT1   CCE
* B318 KDBR
         LD    R0,=DB'-1'
         LD    R1,=DB'1'
         KDBR  R0,R1
         RT1   CCL
         LD    R0,=DB'1'
         LD    R1,=DB'1'
         KDBR  R0,R1
         RT1   CCE
         LD    R0,=DB'1'
         LD    R1,=DB'-1'
         KDBR  R0,R1
         RT1   CCH
         ESPIE SET,KDBR1,7  BFP OVERFLOW FPCDXC=20               
         LD    R0,=DB'1'
         LD    R1,DBMAX
         KDBR  R0,R1 
         RT1   ABORT
KDBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'20'
         RT1   CCE
         ESPIE SET,KDBR2,7  BFP UNDERFLOW FPCDXC=10               
         LD    R0,DBMIN
         LD    R1,=DB'1'
         KDBR  R0,R1 
         RT1   ABORT
KDBR2    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'10'
         RT1   CCE
* B319 CDBR
         LD    R0,=DB'-1'
         LD    R1,=DB'1'
         CDBR  R0,R1
         RT1   CCL
         LD    R0,=DB'1'
         LD    R1,=DB'1'
         CDBR  R0,R1
         RT1   CCE
         LD    R0,=DB'1'
         LD    R1,=DB'-1'
         CDBR  R0,R1
         RT1   CCH
* B31A ADBR
         LD    R0,=DB'3'
         LD    R2,=DB'2'
         ADBR  R0,R2
         RT1   CCH
         CDB   R0,=DB'5'
         RT1   CCE
         LD    R0,=DB'1'
         LD    R2,=DB'-2'
         ADBR  R0,R2
         RT1   CCL
         CDB   R0,=DB'-1'
         RT1   CCE
         LD    R0,=DB'1'
         LD    R2,=DB'-1'
         ADBR  R0,R2
         RT1   CCE
         CDB   R0,=DB'0'
         RT1   CCE
         ESPIE SET,ADBR1,7  BFP OVERFLOW FPCDXC=20               
         LD    R0,DBMAX
         LD    R1,DBMAX
         ADBR  R0,R1 
         RT1   ABORT
ADBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'20'
         RT1   CCE
         WTO   'ESPIE BFP DB OVERFLOW OK'
* B31B SDBR
         LD    R0,=DB'3'
         LD    R2,=DB'2'
         SDBR  R0,R2
         RT1   CCH
         CDB   R0,=DB'1'
         RT1   CCE
         LD    R0,=DB'1'
         LD    R2,=DB'2'
         SDBR  R0,R2
         RT1   CCL
         CDB   R0,=DB'-1'
         RT1   CCE
         LD    R0,=DB'1'
         LD    R2,=DB'1'
         SDBR  R0,R2
         RT1   CCE
         CDB   R0,=DB'0'
         RT1   CCE
         ESPIE SET,SDBR1,7  BFP UNDERFLOW FPCDXC=10               
         LD    R0,DBMIN
         LD    R1,DBMIN
         ADBR  R0,R1 
         SDBR  R0,R1
         RT1   ABORT
SDBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'10'
         RT1   CCE
         WTO   'ESPIE BFP DB UNDERFLOW OK'
         STFPC FPCREG
         OI    FPCREG,X'08' TURN ON BFP SIGNIFICANCE MASK IN FPC REG
         LFPC  FPCREG
         ESPIE SET,SDBR2,7  BFP SIGNIFICANCE FPCDXC=08               
         LD    R0,DBMIN
         LD    R1,DBMIN
         SDBR  R0,R1
         RT1   ABORT
SDBR2    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'08'
         RT1   CCE
         WTO   'ESPIE BFP DB SIGNIFICANCE OK'
         XI    FPCREG,X'08' TURN IT BACK OFF
         LFPC  FPCREG
* B31C MDBR
         LD    R0,=DB'2'
         LD    R2,=DB'3'
         MDBR  R0,R2
         CDB   R0,=DB'6'
         RT1   CCE
* B31D DDBR
         LD    R0,=DB'3'
         LD    R2,=DB'2'
         DDBR  R0,R2
         CDB   R0,=DB'1.5'
         RT1   CCE
         ESPIE SET,DDBR1,7  BFP DIVIDE FPCDXC=40                   
         LD    R0,=DB'1'
         LD    R2,=DB'0'
         DDBR  R0,R2
         RT1   ABORT
DDBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'40'
         RT1   CCE
         WTO   'ESPIE BFP DB DIVIDE OK'
* B31E MADBR
         LD    R0,=DB'1'
         LD    R1,=DB'2'
         LD    R2,=DB'3'
         MADBR R0,R1,R2
         CDB   R0,=DB'7'
         RT1   CCE
* B31F MSDBR
         LD    R0,=DB'1'
         LD    R1,=DB'2'
         LD    R2,=DB'3'
         MSDBR R0,R1,R2
         CDB   R0,=DB'-5'
         RT1   CCE
* B324 LDER
         LE    R1,=EH'1'
         LE    R0,=EH'0'
         LDER  R0,R1
         CD    R0,=DH'1'
         RT1   CCE
* B325 LXDR
         LD    R2,=DH'1'
         LXDR  R0,R2
         LX    R4,=LH'1'
         CXR   R0,R4
         RT1   CCE
* B326 LXER
         LE    R2,=EH'123'
         LXER  R0,R2
         LX    R4,=LH'123'
         CXR   R0,R4
         RT1   CCE
* B32E MAER
         LE    R0,=EH'1'
         LE    R1,=EH'2'
         LE    R2,=EH'3'
         MAER  R0,R1,R2
         CE    R0,=EH'7'
         RT1   CCE
* B32F MSER
         LE    R0,=EH'1'
         LE    R1,=EH'2'
         LE    R2,=EH'3'
         MSER  R0,R1,R2
         CE    R0,=EH'-5'
         RT1   CCE
* B336 SQXR
         LX    R2,=LH'4'
         SQXR  R0,R2
         LX    R4,=LH'2'
         CXR   R0,R4
         RT1   CCE
         LX    R2,=LH'2'
         SQXR  R0,R2
         MXR   R0,R0
         SXR   R0,R2
         LPXR  R0,R0
         LX    R4,=LH'1E-34'
         CXR   R0,R4
         RT1   CCL
* B337 MEER
         LE    R0,=EH'2'
         LE    R1,=EH'3'
         MEER  R0,R1
         CE    R0,=EH'6'
         RT1   CCE
* B33A MAYR Z9 MULTIPLY AND ADD L > E
         LX    R0,=L'10'
         LD    R2,=D'2'
         LD    R3,=D'3'
         MAYR  R0,R2,R3
         LX    R4,=LH'16'
         CXR   R0,R4
         RT1   CCE
* B33B MYR Z9 MULTIPLY L > E
         LD    R2,=D'2'
         LD    R3,=D'3'
         MYR   R0,R2,R3
         LX    R4,=LH'6'
         CXR   R0,R4
         RT1   CCE
* B33E MADR
         LD    R0,=DH'1'
         LD    R1,=DH'2'
         LD    R2,=DH'3'
         MADR  R0,R1,R2
         CD    R0,=DH'7'
         RT1   CCE
* B33F MSDR
         LD    R0,=DH'1'
         LD    R1,=DH'2'
         LD    R2,=DH'3'
         MSDR  R0,R1,R2
         CD    R0,=DH'-5'
         RT1   CCE
* B340 LPXBR
         LX    R2,=LB'-1'
         LX    R4,=LB'1'
         LPXBR R0,R2
         RT1   CCH
         CXBR  R0,R4
         RT1   CCE
         LX    R2,=LB'0'
         LX    R4,=LB'0'
         LPXBR R0,R2
         RT1   CCE
         CXBR  R0,R4
         RT1   CCE
* B341 LNXBR
         LX    R2,=LB'1'
         LX    R4,=LB'-1'
         LNXBR R0,R2
         RT1   CCL
         CXBR  R0,R4
         RT1   CCE
         LX    R2,=LB'0'
         LX    R4,=LB'0'
         LNXBR R0,R2
         RT1   CCE
         CXBR  R0,R4
         RT1   CCE
* B342 LTXBR
         LX    R2,=LB'1'
         LX    R4,=LB'1'
         LTXBR R0,R2
         RT1   CCH
         CXBR  R0,R4
         RT1   CCE
         LX    R2,=LB'0'
         LX    R4,=LB'0'
         LTXBR R0,R2
         RT1   CCE
         CXBR  R0,R4
         RT1   CCE
         LX    R2,=LB'-1'
         LX    R4,=LB'-1'
         LTXBR R0,R2
         RT1   CCL
         CXBR  R0,R4
         RT1   CCE
* B343 LCXBR
         LX    R2,=LB'-1'
         LX    R4,=LB'1'
         LCXBR R0,R2
         RT1   CCH
         CXBR  R0,R4
         RT1   CCE
         LX    R2,=LB'0'
         LX    R4,=LB'0'
         LCXBR R0,R2
         RT1   CCE
         CXBR  R0,R4
         RT1   CCE
         LX    R2,=LB'1'
         LX    R4,=LB'-1'
         LCXBR R0,R2
         RT1   CCL
         CXBR  R0,R4
         RT1   CCE
* B344 LEDBR
         LD    R1,=DB'123'
         LEDBR R0,R1
         CEB   R0,=EB'123'
         RT1   CCE
* B345 LDXBR
         LX    R2,=LB'123'
         LDXBR R0,R2
         CDB   R0,=DB'123'
         RT1   CCE
* B346 LEXBR
         LX    R2,=LB'123'
         LEXBR R0,R2
         CEB   R0,=EB'123'
         RT1   CCE
* B347 FIXBR
         LX    R2,=LB'1.5'
         FIXBR R0,0,R2
         LX    R4,=LB'1.0'
         CXBR  R0,R4
         RT1   CCE
* B348 KXBR
         LX    R0,=LB'-1'
         LX    R2,=LB'1'
         KXBR  R0,R2
         RT1   CCL
         LX    R0,=LB'1'
         LX    R2,=LB'1'
         KXBR  R0,R2
         RT1   CCE
         LX    R0,=LB'1'
         LX    R2,=LB'-1'
         KXBR  R0,R2
         RT1   CCH
         ESPIE SET,KXBR1,7  BFP OVERFLOW FPCDXC=20               
         LX    R0,=LB'1'
         LX    R2,LBMAX
         KXBR  R0,R2 
         RT1   ABORT
KXBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'20'
         RT1   CCE
         ESPIE SET,KXBR2,7  BFP UNDERFLOW FPCDXC=10               
         LX    R0,LBMIN
         LX    R2,=LB'1'
         KXBR  R0,R2 
         RT1   ABORT
KXBR2    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'10'
         RT1   CCE
* B349 CXBR
         LX    R0,=LB'-1'
         LX    R2,=LB'1'
         CXBR  R0,R2
         RT1   CCL
         LX    R0,=LB'1'
         LX    R2,=LB'1'
         CXBR  R0,R2
         RT1   CCE
         LX    R0,=LB'1'
         LX    R2,=LB'-1'
         CXBR  R0,R2
         RT1   CCH
* B34A AXBR
         LX    R0,=LB'3'
         LX    R2,=LB'2'
         AXBR  R0,R2
         RT1   CCH
         LX    R2,=LB'5'
         CXBR  R0,R2
         RT1   CCE
         LX    R0,=LB'1'
         LX    R2,=LB'-2'
         AXBR  R0,R2
         RT1   CCL
         LX    R2,=LB'-1'
         CXBR  R0,R2      
         RT1   CCE
         LX    R0,=LB'1'
         LX    R2,=LB'-1'
         AXBR  R0,R2
         RT1   CCE
         LX    R2,=LB'0'
         CXBR  R0,R2      
         RT1   CCE
         ESPIE SET,AXBR1,7  BFP OVERFLOW FPCDXC=20               
         LX    R0,LBMAX
         LX    R2,LBMAX
         AXBR  R0,R2 
         RT1   ABORT
AXBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'20'
         RT1   CCE
         WTO   'ESPIE BFP LB OVERFLOW OK'
* B34B SXBR
         LX    R0,=LB'3'
         LX    R2,=LB'2'
         SXBR  R0,R2
         RT1   CCH
         LX    R2,=LB'1'
         CXBR  R0,R2    
         RT1   CCE
         LX    R0,=LB'1'
         LX    R2,=LB'2'
         SXBR  R0,R2
         RT1   CCL
         LX    R2,=LB'-1'
         CXBR  R0,R2       
         RT1   CCE
         LX    R0,=LB'1'
         LX    R2,=LB'1'
         SXBR  R0,R2
         RT1   CCE
         LX    R2,=LB'0'
         CXBR  R0,R2    
         RT1   CCE
         ESPIE SET,SXBR1,7  BFP UNDERFLOW FPCDXC=10               
         LX    R0,LBMIN
         LX    R2,LBMIN
         AXBR  R0,R2 
         SXBR  R0,R2
         RT1   ABORT
SXBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'10'
         RT1   CCE
         WTO   'ESPIE BFP LB UNDERFLOW OK'
         STFPC FPCREG
         OI    FPCREG,X'08' TURN ON BFP SIGNIFICANCE MASK IN FPC REG
         LFPC  FPCREG
         ESPIE SET,SXBR2,7  BFP SIGNIFICANCE FPCDXC=08               
         LX    R0,LBMIN
         LX    R2,LBMIN
         SXBR  R0,R2
         RT1   ABORT
SXBR2    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'08'
         RT1   CCE
         WTO   'ESPIE BFP LB SIGNIFICANCE OK'
         XI    FPCREG,X'08' TURN IT BACK OFF
         LFPC  FPCREG
* B34C MXBR
         LX    R0,=LB'2'
         LX    R2,=LB'3'
         MXBR  R0,R2
         LX    R2,=LB'6'
         CXBR  R0,R2     
         RT1   CCE
* B34D DXBR
         LX    R0,=LB'3'
         LX    R2,=LB'2'
         DXBR  R0,R2
         LX    R2,=LB'1.5'
         CXBR  R0,R2
         RT1   CCE
         ESPIE SET,DXBR1,7  BFP DIVIDE FPCDXC=40                   
         LX    R0,=LB'1'
         LX    R2,=LB'0'
         DXBR  R0,R2
         RT1   ABORT
DXBR1    ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'40'
         RT1   CCE
         WTO   'ESPIE BFP LB DIVIDE OK'
* B350 TBEDR
         LD    R1,=DH'123'
         TBEDR R0,0,R1
         CEB   R0,=EB'123'
         RT1   CCE
* B351 TBDR
         LD    R1,=DH'123'
         TBDR  R0,0,R1
         CDB   R0,=DB'123'
         RT1   CCE
* B353 DIEBR
         LE    R1,=EB'7'
         LE    R2,=EB'2'
         DIEBR R1,R3,R2,0
         RT1   CCE
         CEB   R1,=EB'1'
         RT1   CCE
         CEB   R3,=EB'3'
         RT1   CCE
* B357 FIEBR
         LE    R2,=EB'1.5'
         FIEBR R1,0,R2
         CEB   R1,=EB'1.0'
* B358 THDER
         LD    R1,=EB'123'
         THDER R0,R1
         CD    R0,=DH'123'
         RT1   CCE
* B359 THDR
         LD    R1,=DB'123'
         THDR  R0,R1
         CD    R0,=DH'123'
         RT1   CCE
* B35B DIDBR
         LD    R1,=DB'7'
         LD    R2,=DB'2'
         DIDBR R1,R3,R2,0
         RT1   CCE
         CDB   R1,=DB'1'
         RT1   CCE
         CDB   R3,=DB'3'
         RT1   CCE
* B35F FIDBR
         LD    R2,=DB'1.5'
         FIDBR R1,0,R2
         CDB   R1,=DB'1.0'
* B360 LPXR
         LX    R2,=LH'-1'
         LX    R4,=LH'1'
         LPXR  R0,R2
         RT1   CCH
         CXR   R0,R4
         RT1   CCE
         LX    R2,=LH'0'
         LX    R4,=LH'0'
         LPXR  R0,R2
         RT1   CCE
         CXR   R0,R4
         RT1   CCE
* B361 LNXR
         LX    R2,=LH'1'
         LX    R4,=LH'-1'
         LNXR  R0,R2
         RT1   CCL
         CXR   R0,R4
         RT1   CCE
         LX    R2,=LH'0'
         LX    R4,=LH'0'
         LNXR  R0,R2
         RT1   CCE
         CXR   R0,R4
         RT1   CCE
* B362 LTXR
         LX    R2,=LH'1'
         LX    R4,=LH'1'
         LTXR  R0,R2
         RT1   CCH
         CXR   R0,R4
         RT1   CCE
         LX    R2,=LH'0'
         LX    R4,=LH'0'
         LTXR  R0,R2
         RT1   CCE
         CXR   R0,R4
         RT1   CCE
         LX    R2,=LH'-1'
         LX    R4,=LH'-1'
         LTXR  R0,R2
         RT1   CCL
         CXR   R0,R4
         RT1   CCE
* B363 LCXR
         LX    R2,=LH'-1'
         LX    R4,=LH'1'
         LCXR  R0,R2
         RT1   CCH
         CXR   R0,R4
         RT1   CCE
         LX    R2,=LH'0'
         LX    R4,=LH'0'
         LCXR  R0,R2
         RT1   CCE
         CXR   R0,R4
         RT1   CCE
         LX    R2,=LH'1'
         LX    R4,=LH'-1'
         LCXR  R0,R2
         RT1   CCL
         CXR   R0,R4
         RT1   CCE
* B365 LXR
         LX    R2,=LH'123'
         LXR   R0,R2
         CXR   R0,R2       
         RT1   CCE
* B366 LEXR
         LX    R2,=LH'123'
         LEXR  R0,R2
         CE    R0,=EH'123'
         RT1   CCE
* B367 FIXR
         LX    R2,=LH'1.5'
         FIXR  R0,R2
         LX    R4,=LH'1.0'
         CXR   R0,R4
         RT1   CCE
* B369 CXR
         LX    R0,=LH'1'
         STX   R0,LWORK
         CLC   LWORK,=X'41100000000000004000000000000000'
         RT1   CCE
         LX    R2,=X'41100000000000004000000000000000'
         CXR   R0,R2
         RT1   CCE
         LX    R0,=LH'1'
         LX    R2,=LH'2'
         CXR   R0,R2
         RT1   CCL
         LX    R0,=LH'2'
         LX    R2,=LH'1'
         CXR   R0,R2
         RT1   CCH
* B374 LZER
         LE    R1,=EH'1'
         LZER  R1
         CE    R1,=EH'0'
         RT1   CCE
* B375 LZDR
         LD    R1,=DH'1'
         LZDR  R1
         CD    R1,=DH'0'
         RT1   CCE
* B376 LZXR
         LX    R2,=LH'1'
         LZXR  R2
         LX    R4,=LH'0'
         CXR   R2,R4    
         RT1   CCE
* B377 FIER
         LE    R2,=EH'1.5'
         FIER  R1,R2
         CE    R1,=EH'1.0'
         RT1   CCE
* B37F FIDR
         LD    R2,=DH'1.5'
         FIDR  R1,R2
         CD    R1,=DH'1.0'
         RT1   CCE
* B394 CEFBR
         L     R2,=F'123'
         CEFBR R0,R2
         CEB   R0,=EB'123'
         RT1   CCE
* B395 CDFBR
         L     R2,=F'123'
         CDFBR R0,R2
         CDB   R0,=DB'123'
         RT1   CCE
* B396 CXFBR
         L     R2,=F'123'
         CXFBR R0,R2
         LX    R4,=LB'123'
         CXBR  R0,R4        
         RT1   CCE
* B398 CFEBR
         LE    R2,=EB'123'
         CFEBR R0,0,R2
         C     R0,=F'123'
         RT1   CCE
* B399 CFDBR
         LD    R2,=DB'123'
         CFDBR R0,0,R2
         C     R0,=F'123'
         RT1   CCE
* B39A CFXBR
         LX    R2,=LB'123'
         CFXBR R0,0,R2
         C     R0,=F'123'   
         RT1   CCE
* B3A4 CEGBR
         LG    R2,=FL8'123'
         CEGBR R0,R2
         CEB   R0,=EB'123'
         RT1   CCE
* B3A5 CDGBR
         LG    R2,=FL8'123'
         CDGBR R0,R2
         CDB   R0,=DB'123'
         RT1   CCE
* B3A4 CXGBR
         LG    R2,=FL8'123'
         CXGBR R0,R2
         LX    R4,=LB'123'
         CXBR  R0,R4        
         RT1   CCE
* B3A8 CGEBR
         LE    R2,=EB'123'
         CFEBR R0,0,R2
         CG    R0,=FL8'123'
         RT1   CCE
* B3A9 CGDBR
         LD    R2,=DB'123'
         CGDBR R0,0,R2
         CG    R0,=FL8'123'
         RT1   CCE
* B3AA CGXBR
         LX    R2,=LB'123'
         CGXBR R0,0,R2
         CG    R0,=FL8'123'   
         RT1   CCE
* B3B4 CEFR
         L     R2,=F'123'
         CEFR  R0,R2
         CE    R0,=EH'123'
         RT1   CCE
* B3B5 CDFR
         L     R2,=F'123'
         CDFR  R0,R2
         CD    R0,=DH'123'
         RT1   CCE
* B3B6 CXFR
         L     R2,=F'123'
         CXFR  R0,R2
         LX    R4,=LH'123'
         CXR   R0,R4        
         RT1   CCE
* B3B8 CFER
         LE    R2,=EH'123'
         CFER  R0,0,R2
         C     R0,=F'123'
         RT1   CCE
* B3B9 CFDR
         LD    R2,=DH'123'
         CFDR  R0,0,R2
         C     R0,=F'123'
         RT1   CCE
* B3BA CFXR
         LX    R2,=LH'123'
         CFXR  R0,0,R2
         C     R0,=F'123'   
         RT1   CCE
* B3C4 CEGR
         LG    R2,=FL8'123'
         CEGR  R0,R2
         CE    R0,=EH'123'
         RT1   CCE
* B3C5 CDGR
         LG    R2,=FL8'123'
         CDGR  R0,R2
         CD    R0,=DH'123'
         RT1   CCE
* B3C6 CXGR
         LG    R2,=FL8'123'
         CXGR  R0,R2
         LX    R4,=LH'123'
         CXR   R0,R4        
         RT1   CCE
* B3C8 CGER
         LE    R2,=EH'123'
         CFER  R0,0,R2
         CG    R0,=FL8'123'
         RT1   CCE
* B3C9 CGDR
         LD    R2,=DH'123'
         CGDR  R0,0,R2
         CG    R0,=FL8'123'
         RT1   CCE
* B3CA CGXR
         LX    R2,=LH'123'
         CGXR  R0,0,R2
         CG    R0,=FL8'123'   
         RT1   CCE
* ED04 LDEB
         LE    R0,=EB'0'
         LDEB  R0,=EB'1'
         CDB   R0,=DB'1'
         RT1   CCE
* ED05 LXDB 
         LX    R0,=LB'0'
         LXDB  R0,=DB'1'
         LX    R4,=LB'1'
         CXBR  R0,R4
         RT1   CCE
* ED06 LXEB 
         LX    R0,=LB'0'
         LXEB  R0,=EB'1'
         LX    R4,=LB'1'
         CXBR  R0,R4
         RT1   CCE
* ED07 MXDB
         LD    R0,=DB'20'
         MXDB  R0,=DB'30'
         LX    R4,=LB'600'
         CXBR  R0,R4
         RT1   CCE
         LD    R0,=DB'10'
         MXDB  R0,=DB'-20'
         LX    R4,=LB'-200'
         CXBR  R0,R4
         RT1   CCE
         LD    R0,=DB'-0.5'
         MXDB  R0,=DB'-0.5'
         LX    R4,=LB'.25'
         CXBR  R0,R4
         RT1   CCE
* ED08 KEB
         LE    R0,=EB'-1'
         KEB   R0,=EB'1'
         RT1   CCL
         LE    R0,=EB'1'
         KEB   R0,=EB'1'
         RT1   CCE
         LE    R0,=EB'1'
         KEB   R0,=EB'-1'
         RT1   CCH
         ESPIE SET,KEB1,7  BFP OVERFLOW FPCDXC=20               
         LE    R0,=EB'1'
         KEB   R0,EBMAX
         RT1   ABORT
KEB1     ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'20'
         RT1   CCE
         ESPIE SET,KEB2,7  BFP UNDERFLOW FPCDXC=10               
         LE    R0,EBMIN
         KEB   R0,=EB'1' 
         RT1   ABORT
KEB2     ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'10'
         RT1   CCE
* ED09 CEB
         LE    R0,=EB'1'
         CEB   R0,=X'3F800000'
         RT1   CCE
         LE    R0,=EB'-1'
         CEB   R0,=EB'0'
         RT1   CCL
         LE    R0,=EB'1'
         CEB   R0,=EB'0'
         RT1   CCH
* ED0A AEB
         LE    R0,=EB'3'
         AEB   R0,=EB'2'
         RT1   CCH
         CEB   R0,=EB'5'
         RT1   CCE
         LE    R0,=EB'1'
         AEB   R0,=EB'-2'
         RT1   CCL
         CEB   R0,=EB'-1'
         RT1   CCE
         LE    R0,=EB'1'
         AEB   R0,=EB'-1'
         RT1   CCE
         CEB   R0,=EB'0'
         RT1   CCE
* ED0B SEB
         LE    R0,=EB'3'
         SEB   R0,=EB'2'
         RT1   CCH
         CEB   R0,=EB'1'
         RT1   CCE
         LE    R0,=EB'1'
         SEB   R0,=EB'2'
         RT1   CCL
         CEB   R0,=EB'-1'
         RT1   CCE
         LE    R0,=EB'1'
         SEB   R0,=EB'1'
         RT1   CCE
         CEB   R0,=EB'0'
         RT1   CCE
* ED0C MDEB
         LE    R0,=EB'2'
         MDEB  R0,=EB'3'
         CDB   R0,=DB'6'
         RT1   CCE
* ED0D DEB
         LE    R0,=EB'3'
         DEB   R0,=EB'2'
         CEB   R0,=EB'1.5'
         RT1   CCE
         ESPIE SET,DEB1,7  BFP DIVIDE FPCDXC=40                       
         LE    R0,=EB'1'
         DEB   R0,=EB'0'
         RT1   ABORT
DEB1     ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'40'
         RT1   CCE
* ED0E MAEB 
         LE    R1,=EB'1'
         LE    R3,=EB'3'
         MAEB  R1,R3,=EB'2'
         CEB   R1,=EB'7'
         RT1   CCE
* ED0F MSEB 
         LE    R0,=EB'1'
         LE    R1,=EB'2'
         MSEB  R0,R1,=EB'3'
         CEB   R0,=EB'-5'
         RT1   CCE
* ED14 SQEB
         SQEB  R0,=EB'4'
         CEB   R0,=EB'2'
         RT1   CCE
* ED15 SQDB
         SQDB  R0,=DB'4'
         CDB   R0,=DB'2'
         RT1   CCE
* ED17 MEEB
         LE    R0,=EB'2'
         MEEB  R0,=EB'3'
         CEB   R0,=EB'6'
         RT1   CCE
* ED18 KDB
         LD    R0,=DB'-1'
         KDB   R0,=DB'1'
         RT1   CCL
         LD    R0,=DB'1'
         KDB   R0,=DB'1'
         RT1   CCE
         LD    R0,=DB'1'
         KDB   R0,=DB'-1'
         RT1   CCH
         ESPIE SET,KDB1,7  BFP OVERFLOW FPCDXC=20               
         LD    R0,=DB'1'
         KDB   R0,DBMAX
         RT1   ABORT
KDB1     ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'20'
         RT1   CCE
         ESPIE SET,KDB2,7  BFP UNDERFLOW FPCDXC=10               
         LD    R0,DBMIN
         KDB   R0,=DB'1' 
         RT1   ABORT
KDB2     ESPIE RESET
         STFPC FPCREG
         CLI   FPCDXC,X'10'
         RT1   CCE
* ED19 CDB
         LD    R0,=DB'1'
         CDB   R0,=X'3FF0000000000000'
         RT1   CCE
         LD    R0,=DB'-1'
         CDB   R0,=DB'0'
         RT1   CCL
         LD    R0,=DB'1'
         CDB   R0,=DB'0'
         RT1   CCH
* ED1A ADB
         LD    R0,=DB'3'
         ADB   R0,=DB'2'
         RT1   CCH
         CDB   R0,=DB'5'
         RT1   CCE
         LD    R0,=DB'1'
         ADB   R0,=DB'-2'
         RT1   CCL
         CDB   R0,=DB'-1'
         RT1   CCE
         LD    R0,=DB'1'
         ADB   R0,=DB'-1'
         RT1   CCE
         CDB   R0,=DB'0'
         RT1   CCE
* ED1B SDB
         LD    R0,=DB'3'
         SDB   R0,=DB'2'
         RT1   CCH
         CDB   R0,=DB'1'
         RT1   CCE
         LD    R0,=DB'1'
         SDB   R0,=DB'2'
         RT1   CCL
         CDB   R0,=DB'-1'
         RT1   CCE
         LD    R0,=DB'1'
         SDB   R0,=DB'1'
         RT1   CCE
         CDB   R0,=DB'0'
         RT1   CCE
* ED1C MDB
         LD    R0,=DB'2'
         MDB   R0,=DB'3'
         CDB   R0,=DB'6'
         RT1   CCE
* ED1D DDB
         LD    R0,=DB'3'
         DDB   R0,=DB'2'
         CDB   R0,=DB'1.5'
         RT1   CCE
* ED1E MADB
         LD    R0,=DB'1'
         LD    R1,=DB'2'
         MADB  R0,R1,=DB'3'
         CDB   R0,=DB'7'
         RT1   CCE
* ED1F MSDB
         LD    R0,=DB'1'
         LD    R1,=DB'2'
         MSDB  R0,R1,=DB'3'
         CDB   R0,=DB'-5'
         RT1   CCE
* ED24 LDE 
         LDE   R0,=EH'123'
         CD    R0,=DH'123'
         RT1   CCE
* ED25 LXD 
         LXD   R0,=DH'123'
         LX    R4,=LH'123'
         CXR   R0,R4
         RT1   CCE
* ED26 LXE 
         LXE   R0,=EH'123'
         LX    R4,=LH'123'
         CXR   R0,R4
         RT1   CCE
* ED2E MAE 
         LE    R0,=EH'1'
         LE    R1,=EH'2'
         MAE   R0,R1,=EH'3'
         CE    R0,=EH'7'
         RT1   CCE
* ED2F MSE 
         LE    R0,=EH'1'
         LE    R1,=EH'2'
         MSE   R0,R1,=EH'3'
         CE    R0,=EH'-5'
         RT1   CCE
* ED34 SQE
         SQE   R0,=EH'4'
         CE    R0,=EH'2'
         RT1   CCE
* ED35 SQD
         SQD   R0,=DH'4'
         CD    R0,=DH'2'
         RT1   CCE
* ED37 MEE 
         LE    R0,=EH'2'
         MEE   R0,=EH'3'
         CE    R0,=EH'6'
         RT1   CCE
* ED3A MAY Z9 MULTIPLY AND ADD L > E
         LX    R0,=L'10'
         LD    R3,=D'3'
         MAY   R0,R3,=D'2'
         LX    R4,=LH'16'
         CXR   R0,R4
         RT1   CCE
* ED3B MY Z9 MULTIPLY L > E
         LD    R3,=D'3'
         MY    R0,R3,=D'2'
         LX    R4,=LH'6'
         CXR   R0,R4
         RT1   CCE
* ED3E MAD 
         LD    R0,=DH'1'
         LD    R1,=DH'2'
         MAD   R0,R1,=DH'3'
         CD    R0,=DH'7'
         RT1   CCE
* ED3F MSD
         LD    R0,=DH'1'
         LD    R1,=DH'2'
         MSD   R0,R1,=DH'3'
         CD    R0,=DH'-5'
         RT1   CCE
* ED64 LEY
         LEY   R0,=EH'1'
         AE    R0,=EH'1'
         RT1   CCH
         STE   R0,WORD
         CLC   WORD,=X'41200000'
         RT1   CCE
* ED65 LDY
         LDY   R0,=DH'1'
         AD    R0,=DH'1'
         RT1   CCH
         STD   R0,DWORD
         CLC   DWORD,=X'4120000000000000'
         RT1   CCE
* ED66 STEY
         LE    R0,=EH'1'
         STEY  R0,WORD
         CLC   WORD,=X'41100000'
         RT1   CCE
* ED67 STDY
         LD    R0,=DH'1'
         STDY  R0,DWORD
         CLC   DWORD,=X'4110000000000000'
         RT1   CCE
         RT1   END
         END         
